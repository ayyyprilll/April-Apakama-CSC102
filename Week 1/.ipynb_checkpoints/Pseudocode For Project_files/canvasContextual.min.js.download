(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[15],{1660:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1661:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomPropName=void 0,function(e){e.Fields="Fields",e.Filter="Filter"}(t.CustomPropName||(t.CustomPropName={}))},1662:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1663:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1664:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1665:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityType=void 0,function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TuringQnA="TuringQnA"}(t.EntityType||(t.EntityType={}))},1666:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractionMode=void 0,function(e){e.Disabled="Disabled",e.Predictive="Predictive",e.UserInitiated="UserInitiated"}(t.InteractionMode||(t.InteractionMode={}))},1667:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1668:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1669:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1670:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1671:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1672:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1673:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1674:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1675:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1676:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResultStatus=void 0,function(e){e[e.Success=0]="Success",e[e.NoResults=1]="NoResults",e[e.Cancelled=2]="Cancelled",e[e.Timeout=3]="Timeout",e[e.UnexpectedError=4]="UnexpectedError",e[e.EarlyExit=5]="EarlyExit"}(t.ResultStatus||(t.ResultStatus={}))},1677:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFlagResultList=t.isSystemInitiatedResultList=t.isUserInitiatedResultList=t.isEccResultList=t.isFlagResult=t.isUserInitiatedResult=t.isSystemInitiatedResult=t.isPredictionAnnotation=t.isEccResult=void 0;var o=n(957);t.isEccResult=function(e){return o.EccAnnotation.typeGuard(e)};t.isPredictionAnnotation=function(e){return o.PredictionAnnotationBase.typeGuard(e)};t.isSystemInitiatedResult=function(e){return(0,t.isPredictionAnnotation)(e)||o.NudgeAnnotation.typeGuard(e)};t.isUserInitiatedResult=function(e){return o.UserInitiatedAnnotation.typeGuard(e)};t.isFlagResult=function(e){return o.FlagAnnotation.typeGuard(e)};t.isEccResultList=function(e){return(null==e?void 0:e.length)>0&&o.EccAnnotation.typeGuard(e[0])};t.isUserInitiatedResultList=function(e){return(null==e?void 0:e.length)>0&&o.UserInitiatedAnnotation.typeGuard(e[0])};t.isSystemInitiatedResultList=function(e){return(null==e?void 0:e.length)>0&&(0,t.isSystemInitiatedResult)(e[0])};t.isFlagResultList=function(e){return(null==e?void 0:e.length)>0&&o.FlagAnnotation.typeGuard(e[0])}},1678:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionConfig=t.ClientConfig=t.PredictionConfig=t.NudgeConfig=t.FlagConfig=t.EccConfig=t.ScopeConfig=t.BestMatchConfig=t.FeatureConfig=t.EccFeatureConfig=t.EccEntityConfig=t.EntityConfig=t.CustomProp=void 0;var o=n(83),i=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_CustomProp"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.CustomProp=i;var r=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EntityConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EntityConfig=r;var s=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccEntityConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EntityConfig"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccEntityConfig=s;var a=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccFeatureConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccFeatureConfig=a;var l=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FeatureConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.FeatureConfig=l;var c=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_BestMatchConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.BestMatchConfig=c;var u=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ScopeConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ScopeConfig=u;var p=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccFeatureConfig"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccConfig=p;var d=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.FlagConfig=d;var g=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.NudgeConfig=g;var h=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.PredictionConfig=h;var f=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ClientConfig=f;var m=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionConfig"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SessionConfig=m},1679:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShutdownSignal=t.ClientConfigSignal=t.StartupSignal=t.InteractionModeSignal=t.ControlSignal=void 0;var o=n(83),i=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ControlSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ControlSignal=i;var r=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_InteractionModeSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.InteractionModeSignal=r;var s=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_StartupSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.StartupSignal=s;var a=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfigSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ClientConfigSignal=a;var l=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ShutdownSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ShutdownSignal=l},1680:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityList=void 0;var o=n(83),i=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EntityList"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EntityList=i},1681:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalResult=t.EntityResult=t.AddressResult=void 0;var o=n(83),i=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_AddressResult"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ResultInfo"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.AddressResult=i;var r=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EntityResult"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ResultInfo"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EntityResult=r;var s=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_LocalResult"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ResultInfo"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.LocalResult=s},1682:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimeResult=void 0;var o=n(83),i=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_TimeResult"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ResultInfo"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.TimeResult=i},1683:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModelInfo=void 0;var o=n(83),i=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ModelInfo"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ModelInfo=i},1684:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModelMetadata=void 0;var o=n(83),i=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ModelMetadata"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ModelMetadata=i},1685:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserInitiatedRequestClient=t.UserInitiatedRequest=t.UserInitiatedRequestBase=t.SystemInitiatedRequestHybrid=t.SystemInitiatedRequestClient=t.SystemInitiatedRequest=t.SystemInitiatedRequestBase=t.SessionStartRequest=t.FlagRequest=t.Request=void 0;var o=n(83),i=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_Request"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.Request=i;var r=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.FlagRequest=r;var s=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionStartRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SessionStartRequest=s;var a=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedRequestBase=a;var l=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedRequest=l;var c=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedRequestClient=c;var u=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedRequestHybrid=u;var p=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedRequestBase=p;var d=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedRequest=d;var g=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedRequestClient=g},1686:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlagResultAnnotation=t.SystemInitiatedResultAnnotationHybrid=t.SystemInitiatedResultAnnotationClient=t.SystemInitiatedResultAnnotation=t.SystemInitiatedResultAnnotationBase=t.UserInitiatedResultAnnotationHybrid=t.UserInitiatedResultAnnotationClient=t.UserInitiatedResultAnnotation=t.UserInitiatedResultAnnotationBase=t.EccResultAnnotationHybrid=t.EccResultAnnotationClient=t.EccResultAnnotation=t.EccResultAnnotationBase=t.UxTreatments=void 0;var o=n(83),i=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UxTreatments"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UxTreatments=i;var r=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccResultAnnotationBase=r;var s=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccResultAnnotation=s;var a=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccResultAnnotationClient=a;var l=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccResultAnnotationHybrid=l;var c=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedResultAnnotationBase=c;var u=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedResultAnnotation=u;var p=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedResultAnnotationClient=p;var d=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedResultAnnotationHybrid=d;var g=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedResultAnnotationBase=g;var h=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedResultAnnotation=h;var f=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedResultAnnotationClient=f;var m=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.SystemInitiatedResultAnnotationHybrid=m;var y=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.FlagResultAnnotation=y},1687:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResultInfo=t.BestMatchInfo=t.IconInfo=void 0;var o=n(83),i=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_IconInfo"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.IconInfo=i;var r=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_BestMatchInfo"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.BestMatchInfo=r;var s=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ResultInfo"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.ResultInfo=s},1688:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DebugInfo=void 0;var o=n(83),i=function(){function e(t){o.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_DebugInfo"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.DebugInfo=i},1697:function(e,t,n){var o={"./af-ZA/canvas-contextual.json":[1070,23],"./am-ET/canvas-contextual.json":[1071,25],"./ar-SA/canvas-contextual.json":[1072,27],"./as-IN/canvas-contextual.json":[1073,29],"./az-Latn-AZ/canvas-contextual.json":[1074,31],"./be-BY/canvas-contextual.json":[1075,32],"./bg-BG/canvas-contextual.json":[1076,34],"./bn-BD/canvas-contextual.json":[1077,35],"./bn-IN/canvas-contextual.json":[1078,37],"./bs-Latn-BA/canvas-contextual.json":[1079,39],"./ca-ES/canvas-contextual.json":[1080,41],"./ca-Es-VALENCIA/canvas-contextual.json":[1081,43],"./chr-Cher-US/canvas-contextual.json":[1082,44],"./cs-CZ/canvas-contextual.json":[1083,46],"./cy-GB/canvas-contextual.json":[1084,48],"./da-DK/canvas-contextual.json":[1085,50],"./de-DE/canvas-contextual.json":[1086,52],"./el-GR/canvas-contextual.json":[1087,54],"./en-GB/canvas-contextual.json":[1088,56],"./en-US/canvas-contextual.json":[1089,57],"./es-ES/canvas-contextual.json":[1090,59],"./es-MX/canvas-contextual.json":[1091,61],"./et-EE/canvas-contextual.json":[1092,63],"./eu-ES/canvas-contextual.json":[1093,65],"./fa-IR/canvas-contextual.json":[1094,67],"./fi-FI/canvas-contextual.json":[1095,69],"./fil-PH/canvas-contextual.json":[1096,71],"./fr-CA/canvas-contextual.json":[1097,73],"./fr-FR/canvas-contextual.json":[1098,75],"./ga-IE/canvas-contextual.json":[1099,77],"./gd-gb/canvas-contextual.json":[1100,79],"./gl-ES/canvas-contextual.json":[1101,81],"./gu-IN/canvas-contextual.json":[1102,83],"./ha-Latn-NG/canvas-contextual.json":[1103,84],"./he-IL/canvas-contextual.json":[1104,86],"./hi-IN/canvas-contextual.json":[1105,88],"./hr-HR/canvas-contextual.json":[1106,90],"./hu-HU/canvas-contextual.json":[1107,92],"./hy-AM/canvas-contextual.json":[1108,94],"./id-ID/canvas-contextual.json":[1109,96],"./is-IS/canvas-contextual.json":[1110,98],"./it-IT/canvas-contextual.json":[1111,100],"./ja-JP/canvas-contextual.json":[1112,102],"./ka-GE/canvas-contextual.json":[1113,104],"./kk-KZ/canvas-contextual.json":[1114,106],"./km-KH/canvas-contextual.json":[1115,108],"./kn-IN/canvas-contextual.json":[1116,110],"./ko-KR/canvas-contextual.json":[1117,112],"./kok-IN/canvas-contextual.json":[1118,114],"./ky-KG/canvas-contextual.json":[1119,115],"./lb-LU/canvas-contextual.json":[1120,117],"./lo-LA/canvas-contextual.json":[1121,119],"./lt-LT/canvas-contextual.json":[1122,121],"./lv-LV/canvas-contextual.json":[1123,123],"./mi-NZ/canvas-contextual.json":[1124,125],"./mk-MK/canvas-contextual.json":[1125,127],"./ml-IN/canvas-contextual.json":[1126,129],"./mn-MN/canvas-contextual.json":[1127,130],"./mr-IN/canvas-contextual.json":[1128,132],"./ms-MY/canvas-contextual.json":[1129,134],"./mt-MT/canvas-contextual.json":[1130,136],"./nb-NO/canvas-contextual.json":[1131,138],"./ne-NP/canvas-contextual.json":[1132,140],"./nl-NL/canvas-contextual.json":[1133,142],"./nn-NO/canvas-contextual.json":[1134,144],"./or-IN/canvas-contextual.json":[1135,146],"./pa-IN/canvas-contextual.json":[1136,148],"./pl-PL/canvas-contextual.json":[1137,150],"./prs-AF/canvas-contextual.json":[1138,151],"./pt-BR/canvas-contextual.json":[1139,153],"./pt-PT/canvas-contextual.json":[1140,155],"./qps-ploc/canvas-contextual.json":[1141,156],"./qps-ploca/canvas-contextual.json":[1142,157],"./qps-plocm/canvas-contextual.json":[1143,158],"./quz-PE/canvas-contextual.json":[1144,160],"./ro-RO/canvas-contextual.json":[1145,162],"./ru-RU/canvas-contextual.json":[1146,164],"./sd-Arab-PK/canvas-contextual.json":[1147,165],"./si-LK/canvas-contextual.json":[1148,166],"./sk-SK/canvas-contextual.json":[1149,168],"./sl-SI/canvas-contextual.json":[1150,170],"./sq-AL/canvas-contextual.json":[1151,172],"./sr-Cyrl-BA/canvas-contextual.json":[1152,174],"./sr-Cyrl-RS/canvas-contextual.json":[1153,176],"./sr-Latn-RS/canvas-contextual.json":[1154,178],"./sv-SE/canvas-contextual.json":[1155,180],"./sw-KE/canvas-contextual.json":[1156,181],"./ta-IN/canvas-contextual.json":[1157,183],"./te-IN/canvas-contextual.json":[1158,185],"./th-TH/canvas-contextual.json":[1159,187],"./tk-TM/canvas-contextual.json":[1160,188],"./tr-TR/canvas-contextual.json":[1161,190],"./tt-RU/canvas-contextual.json":[1162,192],"./ug-CN/canvas-contextual.json":[1163,194],"./uk-UA/canvas-contextual.json":[1164,196],"./ur-PK/canvas-contextual.json":[1165,198],"./uz-Latn-UZ/canvas-contextual.json":[1166,200],"./vi-VN/canvas-contextual.json":[1167,202],"./zh-CN/canvas-contextual.json":[1168,204],"./zh-TW/canvas-contextual.json":[1169,206]};function i(e){if(!n.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],i=t[0];return n.e(t[1]).then((function(){return n.t(i,3)}))}i.keys=function(){return Object.keys(o)},i.id=1697,e.exports=i},2757:function(e,t,n){"use strict";var o,i;n.r(t),function(e){e[e.Unknown=0]="Unknown",e[e.Inference=1]="Inference"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.VoiceDictationBadge=1]="VoiceDictationBadge",e[e.VoiceDictationPhrase=2]="VoiceDictationPhrase"}(i||(i={}));var r,s,a,l=n(5),c=n(23),u=n(1198),p=n(2375),d=n(1373),g=n(632),h=n(1374),f=n(1447),m=n(2426),y=n(143),b=n(1441),v=n(110),S=n(2847),x=n(2589);!function(e){e.Location="Location",e.Person="Person",e.SatoriEntity="SatoriEntity",e.Topic="Topic",e.File="File"}(r||(r={})),function(e){e[e.Retry=0]="Retry",e[e.ClearSearch=1]="ClearSearch"}(s||(s={})),function(e){e[e.Undefined=0]="Undefined",e[e.ClassicAttachment=1]="ClassicAttachment",e[e.OneDriveForBusiness=2]="OneDriveForBusiness",e[e.SharepointOnline=3]="SharepointOnline"}(a||(a={}));var C=n(4),T=n.n(C),w=n(105),O=n(462),k=n(1690),A={background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#F0F0F0"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},text:{resting:"#201F1E",disabled:"#707070"},altText:{resting:"#605E5C"},action:"#0078D4",highlighting:"#F5F5F5",branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},shimmer:{shimmerColor:"#F3F2F1",shimmerWaveColor:"#EDEBE9"},scroll:{thumbColor:"#bdbdbd"},focusRing:"#323130",searchBox:{borderColor:{resting:"#D1D1D1",hover:"#D1D1D1"},borderBottomColor:"#616161",iconColor:"#424242"},tooltip:{directionHint:1}},I={headerMarginVertical:4,itemBorderRadius:4,itemIconSize:24,itemHeight:40,menuHeight:252},j={flexibleSize:!0,borderRadius:4,height:40},_={width:24,height:24,minWidth:24};function M(e,t){var n=Object.assign(Object.assign({},e.background),{disabled:void 0}),o=Object.assign({},e.text),i=e.altText?Object.assign({},e.altText):void 0,r=void 0;return t&&(e.highlighting&&(n.resting=e.highlighting,r=e.highlightingBorderColor),o.hover&&(o.resting=o.hover),(null==i?void 0:i.hover)&&(i.resting=i.hover)),{background:n,title:o,subtitle:i,focusRing:"transparent",border:r,tooltip:e.tooltip}}function D(e,t){var n=Object.assign(Object.assign({},e.background),{disabled:void 0}),o=void 0;return t&&e.highlighting&&(n.resting=e.highlighting,o=e.highlightingBorderColor),{background:n,title:{resting:e.action},subtitle:e.altText,focusRing:"transparent",border:o}}function E(e,t,n){var o,i;return{fontWeight:O.a.SemiBold,fontFamily:k.a,fontSize:n.xsmall,marginVertical:null!==(o=t.headerMarginVertical)&&void 0!==o?o:4,paddingHorizontal:8,cssColor:e.text.resting,lineHeight:null!==(i=t.headerLineHeight)&&void 0!==i?i:20}}function R(e,t,n){var o,i,r;return{fontWeight:O.a.Normal,fontFamily:k.a,fontSize:n.xsmall,marginTop:0,marginBottom:null!==(o=t.headerMarginVertical)&&void 0!==o?o:4,paddingHorizontal:8,cssColor:null!==(r=null===(i=e.altText)||void 0===i?void 0:i.resting)&&void 0!==r?r:"#605e5c"}}function B(e,t){return{fontWeight:O.a.Normal,fontFamily:k.a,fontSize:t.small,cssColor:e.text.disabled}}function N(e,t){return{fontSize:t.small,fontFamily:k.a,cssColor:e.action}}function L(e,t){var n=Object.assign(Object.assign({},e.background),{disabled:void 0});return t&&e.highlighting&&(n.resting=e.highlighting),{background:n,title:{resting:e.action},focusRing:"transparent"}}function P(e,t){var n={backgroundColor:e.background.resting};return t&&(n.borderColor="#E1DFDD",n.borderWidth={bottom:1},n.borderStyle="solid"),n}function F(e){var t;return{focusRing:null!==(t=e.focusRing)&&void 0!==t?t:"#323130"}}var H,z=n(158),U=n(1182),W=n(635),G=n(636);!function(e){e[e.Default=0]="Default",e[e.Vertical=1]="Vertical",e[e.Horizontal=2]="Horizontal"}(H||(H={}));var q=n(2411),V=n(1449);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function K(e,t){return(K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=$(e);if(t){var i=$(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return J(this,n)}}function J(e,t){if(t&&("object"===Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K(e,t)}(r,e);var t,n,o,i=X(r);function r(){var e;return Q(this,r),(e=i.apply(this,arguments)).focusZoneRef=C.createRef(),e}return t=r,(n=[{key:"render",value:function(){return C.createElement(q.a,{direction:this.getDirection(),componentRef:this.focusZoneRef},this.props.children)}},{key:"focus",value:function(){this.focusZoneRef.current&&this.focusZoneRef.current.focus()}},{key:"getDirection",value:function(){switch(this.props.direction){case H.Horizontal:return V.a.horizontal;case H.Vertical:return V.a.vertical;default:return V.a.bidirectional}}}])&&Y(t.prototype,n),o&&Y(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(C.PureComponent),te=n(2062);var ne=n(125);Object(ne.a)([{rawString:".customScrollBar_48097862{scrollbar-width:none}.customScrollBar_48097862::-webkit-scrollbar{display:none}.customScrollBar_48097862 .scrollbarContainer_48097862{position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:6px;top:4px;right:3px;overflow:hidden}.customScrollBar_48097862 .scrollbarContainer_48097862 .scrollbarThumb_48097862{position:absolute;width:3px;border-radius:6px;background:var(--thumb-color);opacity:.7}.customScrollBar_48097862 .scrollbarContainer_48097862 .scrollbarThumb_48097862:hover{width:5px}@media screen and (-ms-high-contrast: active),(forced-colors: active){.customScrollBar_48097862 .scrollbarContainer_48097862 .scrollbarThumb_48097862{background:highlight !important}}"}]);function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var o,i,r=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(o=n.next()).done)&&(r.push(o.value),!t||r.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ie(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var re=C.memo((function(e){var t,n,o,i,r,s,a=oe(C.useState(!1),2),l=a[0],c=a[1],u=oe(C.useState(20),2),p=u[0],d=u[1],g=oe(C.useState((null===(t=e.style)||void 0===t?void 0:t.paddingScrollTop)?e.style.paddingScrollTop:0),2),h=g[0],f=g[1],m=oe(C.useState(0),2),y=m[0],b=m[1],v=C.useRef({delta:{x:0,y:0},isMovingThumb:!1}),S=C.useRef(null),x=C.useRef(null),T=function(){var t,n;if(S.current){var o=e.style,i=S.current,r=i.clientHeight,s=i.scrollHeight;return{clientHeight:r,contentHeight:s,viewableRatio:(r-(null!==(t=null==o?void 0:o.paddingTop)&&void 0!==t?t:0)-(null!==(n=null==o?void 0:o.paddingBottom)&&void 0!==n?n:0))/s}}return{clientHeight:0,contentHeight:0,viewableRatio:0}},w=(o=function(){if(S.current){var e=v.current.delta.y;v.current.delta={x:0,y:0};var t=T(),n=t.clientHeight,o=t.contentHeight;S.current.scroll({top:S.current.scrollTop+e/n*o})}},i=100,r=!1,function(){r||(o(),r=!0,setTimeout((function(){r=!1}),i))}),O=(null===(n=e.style)||void 0===n?void 0:n.paddingScrollTop)?e.style.paddingScrollTop:0,k={scrollableContainer:{scroll:function(){if(S.current){var e=T().viewableRatio;f(Math.max(e*S.current.scrollTop,O))}},mouseMove:function(e){v.current.isMovingThumb&&(e.movementX||e.movementY)&&(v.current.delta.x+=e.movementX,v.current.delta.y+=e.movementY,w())},mouseUp:function(){v.current.isMovingThumb=!1,v.current.delta={x:0,y:0}}},scrollbarContainer:{mouseDown:function(e){if(S.current&&x.current){var t=T(),n=t.clientHeight,o=t.contentHeight,i=e.clientY-x.current.getBoundingClientRect().top;S.current.scroll({top:i/n*o})}}},scrollbarThumb:{mouseDown:function(e){e.stopPropagation(),v.current.isMovingThumb=!0}}},A=e.scrollTo;switch(C.useEffect((function(){if(S.current){var t=S.current,n=t.clientHeight,o=t.scrollHeight>n;if(o!==l){var i=e.onScrollStatusChange;i&&i(o),c(o)}}})),C.useEffect((function(){return function(){if(S.current&&e.scrollTo){var t=e.scrollTo,n=t.top,o=t.bottom,i=Math.max(n-6,0);o<=S.current.scrollTop+S.current.offsetHeight&&i>=S.current.scrollTop||S.current.scroll({top:i,behavior:"smooth"})}}()}),[null==A?void 0:A.top,null==A?void 0:A.bottom]),C.useEffect((function(){return function(){if(S.current){var e=T(),t=e.clientHeight,n=e.viewableRatio;d(Math.round(n*t)),b(t)}}()})),e.scrollDirection){case"horizontal":s={overflowY:"hidden",overflowX:"auto",display:"flex",flexDirection:"row"};break;case"both":s={overflowY:"auto",overflowX:"auto",display:"block",flexDirection:"row"};break;case"vertical":default:s={overflowY:"auto",overflowX:"hidden",display:"block",flexDirection:"column"}}var I,j,_,M,D,E,R,B=l&&"horizontal"!==e.scrollDirection?C.createElement("div",{style:{height:y,opacity:e.hidden?0:1},className:"scrollbarContainer_48097862",ref:x,onMouseDown:k.scrollbarContainer.mouseDown},C.createElement("div",{style:{height:p,top:h},className:"scrollbarThumb_48097862",onMouseDown:k.scrollbarThumb.mouseDown})):void 0;return C.createElement("div",{style:(I=s,D=Object.assign({},I),E=e.style,R=e.theme,E&&(E.paddingHorizontal&&(D.paddingRight=E.paddingHorizontal,D.paddingLeft=E.paddingHorizontal),E.paddingTop&&(D.paddingTop=E.paddingTop),E.paddingBottom&&(D.paddingBottom=E.paddingBottom),E.borderRadius&&(D.borderRadius=E.borderRadius)),R&&R.thumbColor&&(D=Object.assign(Object.assign({},D),(j={},_="--thumb-color",M=R.thumbColor,_ in j?Object.defineProperty(j,_,{value:M,enumerable:!0,configurable:!0,writable:!0}):j[_]=M,j))),D),className:"customScrollBar_48097862",ref:S,onScroll:k.scrollableContainer.scroll,onMouseMove:k.scrollableContainer.mouseMove,onMouseUp:k.scrollableContainer.mouseUp},e.children,B)})),se=function(e){return"option"+e},ae=function(e){return e&&"actions"in e?e.actions:[]},le=function(e){var t;if(e)return Object.assign(Object.assign({},e),{background:null!==(t=e.footerButtonBackground)&&void 0!==t?t:e.background,header:"",subheader:"",dialogText:"",iconText:"",contextText:"",errorText:"",border:"",separator:"",focusRing:"",link:"",linkPressed:""})},ce=n(2658);function ue(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function de(e,t,n,o){if(n&&o){var i,r=ue(o);try{for(r.s();!(i=r.n()).done;){var s=i.value;switch(s.decorationType){case ce.a.Spelling:var a=n.substr(s.start,s.length);return t===z.c.RepeatedWord?e("contextAccessibilityLabelForRepeatedWord").replace("{0}",a).replace("{1}",n):e("contextAccessibilityLabelForSpelling").replace("{0}",a).replace("{1}",n);case ce.a.Grammar:var l=n.substr(s.start,s.length);return e("contextAccessibilityLabelForGrammar").replace("{0}",l).replace("{1}",n);case ce.a.Refinement:var c=n.substr(s.start,s.length);return e("contextAccessibilityLabelForRefinement").replace("{0}",c).replace("{1}",n);case ce.a.Modification:var u=n.substr(s.start,s.length);return e("contextAccessibilityLabelForCorrection").replace("{0}",u).replace("{1}",n)}}}catch(e){r.e(e)}finally{r.f()}}}var ge=n(2659),he=n(1210),fe=n(2660),me=n(1176);function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Se(e,t){return(Se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Te(e);if(t){var i=Te(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return Ce(this,n)}}function Ce(e,t){if(t&&("object"===ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var we=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Se(e,t)}(r,e);var t,n,o,i=xe(r);function r(){return be(this,r),i.apply(this,arguments)}return t=r,(n=[{key:"render",value:function(){return C.createElement("table",{style:this.getTableStyle(),"aria-label":this.props.accessibilityLabel},this.props.children)}},{key:"getTableStyle",value:function(){var e={borderCollapse:"collapse"};return this.props.style&&this.props.style.marginVertical&&(e.marginBottom=this.props.style.marginVertical,e.marginTop=this.props.style.marginVertical),e}}])&&ve(t.prototype,n),o&&ve(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(C.PureComponent);function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ae(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ie(e,t){return(Ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Me(e);if(t){var i=Me(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return _e(this,n)}}function _e(e,t){if(t&&("object"===Oe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Me(e){return(Me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var De=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ie(e,t)}(r,e);var t,n,o,i=je(r);function r(){return ke(this,r),i.apply(this,arguments)}return t=r,(n=[{key:"render",value:function(){return this.props.header?C.createElement("th",{style:this.getTableCellStyle(),"aria-label":this.props.accessibilityLabel},this.props.children):C.createElement("td",{style:this.getTableCellStyle(),"aria-label":this.props.accessibilityLabel},this.props.children)}},{key:"getTableCellStyle",value:function(){var e={};return this.props.style&&this.props.style.paddingVertical&&(e.paddingBottom=this.props.style.paddingVertical,e.paddingTop=this.props.style.paddingVertical),this.props.style&&this.props.style.paddingHorizontal&&(e.paddingLeft=this.props.style.paddingHorizontal,e.paddingRight=this.props.style.paddingHorizontal),this.props.style&&this.props.style.paddingStart&&(e.paddingInlineStart=this.props.style.paddingStart),this.props.style&&this.props.style.paddingEnd&&(e.paddingInlineEnd=this.props.style.paddingEnd),this.props.style&&this.props.style.marginVertical&&(e.marginBottom=this.props.style.marginVertical,e.marginTop=this.props.style.marginVertical),this.props.style&&this.props.style.marginHorizontal&&(e.marginLeft=this.props.style.marginHorizontal,e.marginRight=this.props.style.marginHorizontal),this.props.style&&this.props.style.verticalAlign&&(e.verticalAlign=this.props.style.verticalAlign),this.props.style&&this.props.style.horizontalAlign&&(e.textAlign=this.props.style.horizontalAlign),e}}])&&Ae(t.prototype,n),o&&Ae(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(C.PureComponent);function Ee(e){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Be(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ne(e,t){return(Ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Fe(e);if(t){var i=Fe(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return Pe(this,n)}}function Pe(e,t){if(t&&("object"===Ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Fe(e){return(Fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var He,ze=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ne(e,t)}(r,e);var t,n,o,i=Le(r);function r(){return Re(this,r),i.apply(this,arguments)}return t=r,(n=[{key:"render",value:function(){return C.createElement("tr",null,this.props.children)}}])&&Be(t.prototype,n),o&&Be(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(C.PureComponent);function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ge(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}function Ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function qe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ve(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ze(e,t){return(Ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Ke(e);if(t){var i=Ke(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return Ye(this,n)}}function Ye(e,t){if(t&&("object"===Ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e){e[e.Exposition=0]="Exposition",e[e.Example=1]="Example"}(He||(He={}));var Xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ze(e,t)}(r,e);var t,n,o,i=Qe(r);function r(){return qe(this,r),i.apply(this,arguments)}return t=r,(n=[{key:"render",value:function(){var e=this.parseExplanationText(this.getExplanationText()),t=this.getDefinition(),n=t&&t.explanationTitle||"";return C.createElement(ge.a,null,C.createElement(fe.a,{componentStackStyle:w.I(this.props.style,this.props.theme),stackAlignment:G.b.Stretch,stackDirection:G.c.TopToBottom,header:n,headerStyle:w.K(this.props.theme,this.props.fontTable),focusable:!0},this.renderExplanationText(e),this.renderAccessibleColorsLearningTip()))}},{key:"renderAccessibleColorsLearningTip",value:function(){if(this.props.definition.critiqueType!==z.c.AccColorChecker)return null;var e={height:16,width:16},t={type:"ErrorBadge",primaryColor:"#E41323",style:e},n={type:"Completed",primaryColor:"#0B6A0B",style:e},o={backgroundColor:"#CCCCCC",borderRadius:2,height:24,marginVertical:4,marginStart:10,paddingHorizontal:15},i={width:"50%"};return C.createElement(W.a,null,C.createElement(W.a,{direction:G.c.LeftToRight},C.createElement(W.a,{style:i},C.createElement(he.a,{text:this.props.strings.critiqueExplanation("explanationTableBefore"),style:w.L(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})),C.createElement(W.a,{style:i},C.createElement(he.a,{text:this.props.strings.critiqueExplanation("explanationTableAfter"),style:w.L(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0}))),C.createElement(W.a,{direction:G.c.LeftToRight},C.createElement(W.a,{style:i},C.createElement(W.a,{direction:G.c.LeftToRight},C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Center,style:{height:32}},C.createElement(me.a,Object.assign({},t))),C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Center,style:o},C.createElement(he.a,{text:this.props.strings.critiqueExplanation("exampleText"),style:{cssColor:"#BECFFA",fontSize:this.props.fontTable.xsmall,fontWeight:O.a.SemiBold},accessibilityRole:"text",accessibilityHidden:!0}))),C.createElement(W.a,{direction:G.c.LeftToRight},C.createElement(W.a,{style:{width:26}}),C.createElement(he.a,{text:this.props.strings.critiqueExplanation("poorContrast"),style:w.J(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0}))),C.createElement(W.a,{style:i},C.createElement(W.a,{direction:G.c.LeftToRight},C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Center,style:{height:32}},C.createElement(me.a,Object.assign({},n))),C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Center,style:o},C.createElement(he.a,{text:this.props.strings.critiqueExplanation("exampleText"),style:{cssColor:"#002EA3",fontSize:this.props.fontTable.xsmall,fontWeight:O.a.SemiBold},accessibilityRole:"text",accessibilityHidden:!0}))),C.createElement(W.a,{direction:G.c.LeftToRight},C.createElement(W.a,{style:{width:26}}),C.createElement(he.a,{text:this.props.strings.critiqueExplanation("goodContrast"),style:w.J(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})))))}},{key:"getDefinition",value:function(){return this.props.definition}},{key:"getExplanationText",value:function(){var e=this.getDefinition();return e&&e.explanation?e.explanation.replace("\\r\\n","\r\n"):""}},{key:"parseExplanationText",value:function(e){var t,n=[],o=[],i=null,r=!0,s=!1,a=0,l=0,c=0,u=this.props.strings.critiqueExplanation("explanationTableBefore"),p=this.props.strings.critiqueExplanation("explanationTableAfter"),d=We(e.split("\r\n"));try{for(d.s();!(t=d.n()).done;){var g=t.value;if(0!==g.length)if("•"===g[0]){var h=g.indexOf(":"),f=g.substr(2,h-1),m=g.substr(h+2);r?(u=f,i=this.renderBeforeText(m,l++),r=!1,s=!0):s?(p=f,o.push(C.createElement(ze,{key:a++},this.renderTableHeaderText(u,l++,0===o.length,!0),this.renderTableHeaderText(p,c++,0===o.length,!1))),o.push(C.createElement(ze,{key:a++},i,this.renderAfterText(m,c++))),i=null,s=!1):(o.push(C.createElement(ze,{key:a++},this.renderPlaceholder(l++),this.renderExampleSeparator(c++))),o.push(C.createElement(ze,{key:a++},this.renderPlaceholder(l++),this.renderAfterText(m,c++))))}else o.length>0&&(n.push(this.renderCurrentTable(o)),o=[]),n.push(this.renderExplanationNonExampleText(g));else i=null,r=!0,s=!1}}catch(e){d.e(e)}finally{d.f()}return o.length>0&&(n.push(this.renderCurrentTable(o)),o=[]),n}},{key:"analyzeExampleText",value:function(e){var t={trimmedText:e,emphasisStart:-1,emphasisLength:-1},n=e.indexOf("{ul}");if(-1!==n){var o=e.indexOf("{ul 0}",n);if(-1!==o){var i=n+"{ul}".length,r=o-i;t.trimmedText=e.substr(0,n)+e.substr(i,r)+e.substr(o+"{ul 0}".length),t.emphasisStart=n,t.emphasisLength=r}}return t}},{key:"renderTableHeaderText",value:function(e,t,n,o){var i=o?w.E():w.D();return n?C.createElement(De,{header:!0,key:t,style:i},C.createElement(he.a,{text:e,style:w.L(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})):C.createElement(De,{key:t,style:i}," ")}},{key:"renderCurrentTable",value:function(e){return{explanationPartType:He.Example,data:e}}},{key:"getDecorationType",value:function(e){switch(e){case z.c.Grammar:return z.e.Grammar;case z.c.Refinement:return z.e.Refinement;default:return z.e.None}}},{key:"renderBeforeText",value:function(e,t){return this.renderExampleText(e,t,this.getDecorationType(this.getDefinition().critiqueType),this.props.strings.critiqueExplanation("explanationTableBefore"),!0)}},{key:"renderAfterText",value:function(e,t){return this.renderExampleText(e,t,z.e.Modification,this.props.strings.critiqueExplanation("explanationTableAfter"),!1)}},{key:"renderExampleText",value:function(e,t,n,o,i){var r=[],s=this.analyzeExampleText(e);-1!==s.emphasisStart&&-1!==s.emphasisLength&&r.push({start:s.emphasisStart,length:s.emphasisLength,decorationType:n});var a=o+" "+de(this.props.strings.textFormatting,this.getDefinition().critiqueType,s.trimmedText,r),l=i?w.E():w.D();return C.createElement(De,{key:t,style:l},C.createElement(he.a,{text:s.trimmedText,style:w.J(this.props.theme,this.props.fontTable),formatting:Object(ce.b)(e.length,this.props.theme,r),accessibilityRole:"text",accessibilityLabel:a}))}},{key:"renderExampleSeparator",value:function(e){return C.createElement(De,{key:e,style:w.D()},C.createElement(he.a,{text:this.props.strings.critiqueExplanation("explanationTableSeparator"),style:w.M(this.props.theme,this.props.fontTable),accessibilityRole:"text"}))}},{key:"renderPlaceholder",value:function(e){return C.createElement(De,{key:e,style:w.E()})}},{key:"renderExplanationNonExampleText",value:function(e){return{explanationPartType:He.Exposition,data:[C.createElement(he.a,{key:0,text:e,style:w.N(this.props.theme,this.props.fontTable),accessibilityRole:"text"})]}}},{key:"renderExplanationText",value:function(e){var t,n=[],o=We(e);try{for(o.s();!(t=o.n()).done;){var i=t.value;switch(i.explanationPartType){case He.Exposition:i.data[0]&&n.push(i.data[0]);break;case He.Example:n.push(C.createElement(we,{style:w.F(),accessibilityLabel:this.props.strings.critiqueExplanation("explanationTableAccessibilityLabel")},i.data))}}}catch(e){o.e(e)}finally{o.f()}return n}}])&&Ve(t.prototype,n),o&&Ve(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(C.PureComponent),Je=n(1689),$e={type:"Text",textColor:"#616161"},et={type:"Icon",iconColor:"#616161"},tt={type:"IconButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#616161",disabled:"#BDBDBD"},focusRing:"#323130"},nt={type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"};function ot(e,t){var n=Object.assign({},e);return t&&(null==n?void 0:n.hover)&&(n.resting=n.hover),n}function it(e){return("Icon"===(null==e?void 0:e.type)?e:et).iconColor}function rt(e){return{oneOfManyChoiceButtonAccessibilityLabelAugment:e("oneOfManyChoiceButtonAccessibilityLabelAugment"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function st(e){return{defaultOverflowButtonAccessibilityLabel:e("defaultOverflowButtonAccessibilityLabel"),oneOfManyChoiceButtonAccessibilityLabelAugment:e("oneOfManyChoiceButtonAccessibilityLabelAugment"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function at(e){return{defaultSplitButtonOverflowAccessibilityLabel:e("defaultSplitButtonOverflowAccessibilityLabel"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function lt(e,t,n,o,i,r,s,a,l,c,u){var p=pt(e),d=void 0!==a;if(void 0===a||!(a<0||a>=p.length)){var g=d?p[a]:void 0,h=i.filter((function(t){return yt(e,t,g)})).filter((function(t){return ft(e,n,t)})).map((function(t){return Ct(e,n,o,t)}));if(!d&&yt(e,z.a.ShowMenu)&&(h.length>0&&h.push({type:"separator",key:"separator"}),h.push(Ct(e,n,o,z.a.ShowMenu))),0!==h.length)return{tooltip:d||r?void 0:s,items:h,onClick:function(e){if(c){var t=parseInt(e.key,10);c(t,a)}},style:d?{}:w.x,theme:w.eb(t,u),itemTheme:w.B(t,void 0,!0),strings:st(n.common),accessibilityLabel:s,automationLabelType:"CritiqueActionButton",automationId:l||"",appearFocused:u}}}function ct(e,t,n,o,i,r,s,a,l,c,u,p,d,g,h,f,m,y,b){var v=mt(n),S=void 0!==v?{type:v,filled:h}:void 0,x={onClick:function(){null==g||g(n,void 0,r)},title:s,titleStyle:a,tooltip:l,disabled:bt(e,n),style:o,theme:w.B(t,void 0,h,m),accessibilityLabel:ht(e,i,n),automationLabel:null!=c?c:xt(n,d),badgeProps:p,icon:S,htmlId:f,onPositionChange:b,uiAnchorId:y};return C.createElement(U.a,Object.assign({ref:u},x,{key:n.toString()}))}function ut(e,t,n,o,i,r,s){if(e.showDictationCommandUx&&!o){var a=function(e,t,n,o){var i=dt(e,t).filter((function(e){return e.action===n&&e.suggestionIndex===o}));return i.length>0?i[0].badgeId:void 0}(e,t,i,r);if(void 0!==a)return{text:a.toString(),theme:n,style:s}}}function pt(e){var t=e.maximumSuggestions||w.Bb;return e.suggestions?e.suggestions.length>t?e.suggestions.slice(0,t):e.suggestions:[]}function dt(e,t){var n,o=gt(e,t),i=[],r=1;return o?o.forEach((function(e,t){i.push({action:e,badgeId:r++,suggestionIndex:t})})):null===(n=pt(e))||void 0===n||n.forEach((function(t,n){bt(e,z.a.Accept,t)||i.push({action:z.a.Accept,badgeId:r++,suggestionIndex:n})})),i}function gt(e,t){switch(e.critiqueType){case z.c.RepeatedWord:return[z.a.Accept];case z.c.SimilarityChecker:return(yt(e,z.a.MoreSources)?[z.a.IntextCitation,z.a.FullCitation,z.a.MoreSources]:[z.a.IntextCitation,z.a.FullCitation]).filter((function(n){return ft(e,t,n)}))}return e.isContentPending||e.isBehindPaywall?[]:void 0}function ht(e,t,n){switch(n){case z.a.Previous:case z.a.Next:if(e.wrapAroundNavigation&&void 0!==e.critiqueSetSize&&e.critiqueSetSize>1){var o=e.critiqueSetSize.toString(10);return n===z.a.Previous?t.critique("previousIssueWithCount").replace("{0}",o):t.critique("nextIssueWithCount").replace("{0}",o)}return n===z.a.Previous?t.critique("previousIssue"):t.critique("nextIssue")}return ft(e,t,n)}function ft(e,t,n){switch(n){case z.a.ReadAloud:return t.critique("readAloud");case z.a.SpellOut:return t.critique("spellOut");case z.a.ChangeAll:return t.critique("changeAll");case z.a.AddToAutoCorrect:return t.critique("addToAutoCorrect");case z.a.AutoCorrectOptions:return t.critique("autoCorrectOptions");case z.a.IgnoreOnce:return t.critique("ignoreOnce");case z.a.IgnoreAll:return t.critique("ignoreAll");case z.a.IgnoreRule:return t.critique("ignoreRule");case z.a.AddToDictionary:return t.critique("addToDictionary");case z.a.Options:return t.critique("options");case z.a.ShowExplanation:return t.critique("footerExplanationButtonAccessibilityLabel");case z.a.ManageLanguages:return t.critique("manageLanguages");case z.a.Next:return t.critique("nextIssue");case z.a.Previous:return t.critique("previousIssue");case z.a.ToggleContext:return e.showContext?t.critique("hideContext"):t.critique("showContext");case z.a.ToggleDescription:return e.critiqueType===z.c.Spelling?e.showDescription?t.critique("hideSynonyms"):t.critique("showSynonyms"):e.critiqueType===z.c.NeuralRewrite?e.showDescription?t.critique("hideExplanationButtonText"):t.critique("showExplanationButtonText"):void 0;case z.a.ReadContext:return t.critique("readAloudOriginalSentenceAccessibilityLabel");case z.a.ShowMenu:return t.critique("showMenuButtonText");case z.a.Feedback:return t.critique("giveFeedbackButtonText");case z.a.Dismiss:return t.common("cancelButton");case z.a.OpenEditorPane:return t.critique("accessibilityLabelForEditorButton");case z.a.LearnMore:return t.critique("learnMore");case z.a.IntextCitation:return t.critique("addInTextCitation");case z.a.FullCitation:return t.critique("copyFullCitation");case z.a.MoreSources:return t.critique("moreSources");case z.a.Accessibility:return t.critique("accAssistant");case z.a.OpenColorPicker:return t.critique("moreColors");case z.a.TurnOffAccChecker:return t.critique("turnOffAccChecker");case z.a.Allow:return t.critique("allowAccIssue");case z.a.AllowAll:return t.critique("allowAllAccIssues");case z.a.Accept:case z.a.AddOnFooterAction:case z.a.Report:case z.a.RejectHoverIn:case z.a.RejectHoverOut:case z.a.AcceptHoverIn:case z.a.AcceptHoverOut:case z.a.Reject:case z.a.OpenCustomDictionary:case z.a.SourceSelected:case z.a.ApplyColor:case z.a.GoPremium:case z.a.RevealSuggestions:case z.a.RefreshSummary:case z.a.UndoInsertSummarization:case z.a.Overflow:return}}function mt(e){switch(e){case z.a.Allow:return"Ignore";case z.a.AllowAll:return"IgnoreAll";case z.a.IgnoreOnce:return"Ignore";case z.a.IgnoreAll:return"IgnoreAll";case z.a.AddToDictionary:return"AddToDictionary";case z.a.ShowExplanation:return"ShowExplanation";case z.a.Next:return"Next";case z.a.Previous:return"Previous";case z.a.ReadContext:return"ReadAloud";case z.a.Feedback:return"GiveFeedback";case z.a.Dismiss:return"Cancel";case z.a.OpenEditorPane:return"Editor";case z.a.ManageLanguages:return"LocaleLanguage";case z.a.Options:return"EditorSettings";case z.a.IntextCitation:return"Plus";case z.a.FullCitation:return"Copy";case z.a.Accessibility:return"Accessibility";case z.a.OpenColorPicker:return"Color";case z.a.TurnOffAccChecker:return"Hide";case z.a.RevealSuggestions:return"Wand"}}function yt(e,t,n){switch(t){case z.a.Previous:case z.a.Next:return vt(e)&&St(e,t);case z.a.ToggleContext:if(void 0===e.contextText)return!1;break;case z.a.ReadContext:var o=mt(t);if(void 0===o||!me.a.shouldRender({type:o}))return!1;break;case z.a.IgnoreOnce:if(e.critiqueType===z.c.SimilarityChecker)return!0;break;case z.a.Accessibility:case z.a.OpenColorPicker:case z.a.Allow:case z.a.AllowAll:return!0;case z.a.Feedback:case z.a.TurnOffAccChecker:if(e.critiqueType===z.c.AccColorChecker)return!0}return St(e,t,n)}function bt(e,t,n){switch(t){case z.a.Next:case z.a.Previous:return!vt(e)||!St(e,t)||!e.wrapAroundNavigation&&(t===z.a.Previous?e.critiquePosition<=0:e.critiquePosition>=e.critiqueSetSize-1);case z.a.Dismiss:case z.a.Accessibility:case z.a.OpenColorPicker:case z.a.Allow:case z.a.AllowAll:case z.a.Overflow:return!1;default:return!St(e,t,n)}}function vt(e){return void 0!==e.critiquePosition&&void 0!==e.critiqueSetSize&&e.critiquePosition>=0&&e.critiqueSetSize>0}function St(e,t,n){var o=e.actions,i=n?n.actions:o;return!!i&&i.indexOf(t)>=0}function xt(e,t){switch(e){case z.a.Previous:return"CritiqueNavButton_Left_".concat(t);case z.a.Next:return"CritiqueNavButton_Right_".concat(t);case z.a.Dismiss:return"CritiqueCloseButton_".concat(t);case z.a.OpenEditorPane:return"EditorPaneOpenButton_".concat(t)}return"undefined"}function Ct(e,t,n,o){var i=ft(e,t,o);return{type:"item",key:o.toString(),title:i,titleStyle:w.db(n,i.length),iconType:mt(o)}}var Tt=function(e){var t=e.brandingMode,n=e.theme;switch(t){case z.b.Text:var o=e.strings,i=e.fontTable,r=o.critique("microsoftEditorBranding"),s=function(e,t){var n="Text"===(null==e?void 0:e.type)?e:$e;return{fontWeight:O.a.SemiBold,fontSize:t.xsmall,cssColor:n.textColor}}(n,i),a=o.critique("microsoftEditorBrandingAccessibilityLabel"),l=C.createElement(he.a,{text:r,accessibilityLabel:a,style:s});return wt(l);case z.b.Icon:return wt(C.createElement(me.a,{type:"Editor",primaryColor:it(n)}));case z.b.MonochromeIcon:return wt(C.createElement(me.a,{type:"EditorSingleColor",primaryColor:it(n)}));case z.b.IconButton:return Ot(e);case z.b.IconAndTextButton:return kt(e);default:return C.createElement(C.Fragment,null)}},wt=function(e){return C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Center,style:{paddingHorizontal:6,paddingVertical:6}},e)},Ot=function(e){var t=e.definition,n=e.strings,o=e.theme,i=e.automationId,r=e.onAction,s=e.fontTable,a=e.htmlId,l=e.appearFocused,c=e.isDisabled,u=e.onPositionChange,p=e.showPreviewTooltipForBranding,d=function(e,t){var n,o="IconButton"===(null==e?void 0:e.type)?e:tt,i=ot(o.icon,t);return Object.assign(Object.assign({},o),{background:Object.assign(Object.assign({},o.background),{resting:t&&null!==(n=o.background.hover)&&void 0!==n?n:o.background.resting}),title:i,icon:i,border:t?o.focusRing:void 0})}(o,l),g=function(e){return{textAlign:Je.a.Center,borderRadius:4,iconFontSize:e.xsmall}}(s),h=p?n.critique("editorButtonCiqPreviewTooltipContent"):n.critique("editorButtonTooltipContent");return C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Stretch},At(t,d,g,n,void 0,void 0,h,i,r,a,c,u))},kt=function(e){var t,n=e.definition,o=e.strings,i=e.theme,r=e.automationId,s=e.onAction,a=e.fontTable,l=e.htmlId,c=e.appearFocused,u=e.isDisabled,p=e.onPositionChange,d=e.showPreviewTooltipForBranding,g=function(e,t){var n,o="IconAndTextButton"===(null==e?void 0:e.type)?e:nt;return Object.assign(Object.assign({},o),{background:Object.assign(Object.assign({},o.background),{resting:t&&null!==(n=o.background.hover)&&void 0!==n?n:o.background.resting}),title:ot(o.title,t),icon:ot(o.icon,t),border:t?o.focusRing:void 0})}(i,c),h=function(e){return{textAlign:Je.a.Center,borderRadius:2,iconFontSize:e.xlarge,paddingHorizontal:7,paddingBottom:0,textHorizontalPadding:0,iconTextSpacing:3}}(a),f=o.critique("editorButtonText"),m=(t=a,{fontWeight:O.a.SemiBold,fontFamily:k.a,fontSize:t.small}),y=d?o.critique("editorButtonCiqPreviewTooltipContent"):o.critique("editorButtonTooltipContent");return C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Stretch},At(n,g,h,o,f,m,y,r,s,l,u,p))},At=function(e,t,n,o,i,r,s,a,l,c,u,p){var d=mt(z.a.OpenEditorPane),g=void 0!==d?{type:d}:void 0,h={onClick:function(){null==l||l(z.a.OpenEditorPane,void 0,void 0)},title:i,titleRootStyle:r,tooltip:s,disabled:u,style:n,theme:t,accessibilityLabel:ht(e,o,z.a.OpenEditorPane),automationLabel:xt(z.a.OpenEditorPane,a),icon:g,htmlId:c,onPositionChange:p};return C.createElement(U.a,Object.assign({},h,{key:z.a.OpenEditorPane.toString()}))};function It(e){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _t(e,t){return(_t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Rt(e);if(t){var i=Rt(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return Dt(this,n)}}function Dt(e,t){if(t&&("object"===It(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Et(e)}function Et(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rt(e){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Bt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_t(e,t)}(r,e);var t,n,o,i=Mt(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=i.call(this,e)).shouldFocusButtonOnUpdate=!1,t.buttonRef=C.createRef(),t.buttonId="FlyoutAnchor"+r.ids,r.ids+=1,t.handleClick=t.handleClick.bind(Et(t)),t.closeCallout=t.closeCallout.bind(Et(t)),t.onAccessibilityExpandCollapse=t.onAccessibilityExpandCollapse.bind(Et(t)),t.state={calloutVisible:!1},t}return t=r,(n=[{key:"render",value:function(){var e=this.renderButton();if(this.state.calloutVisible){var t={role:"document",target:"#"+this.buttonId,isBeakVisible:!1,ariaLabel:this.props.calloutAccessibilityLabel,setInitialFocus:!0,onDismiss:this.closeCallout},n=C.createElement(b.a,Object.assign({},t),this.props.children);return C.createElement("div",{id:this.buttonId,style:{display:"flex"}},e,n)}return e}},{key:"componentDidUpdate",value:function(){var e;this.shouldFocusButtonOnUpdate&&(null===(e=this.buttonRef.current)||void 0===e||e.focus(),this.shouldFocusButtonOnUpdate=!1)}},{key:"renderButton",value:function(){var e=Object.assign(Object.assign({},this.props.buttonProps),{onClick:this.handleClick,accessibilityState:this.state.calloutVisible,accessibilityRole:"overflow"});return this.state.calloutVisible&&e.theme&&e.theme.background.hover&&(e.theme=Object.assign(Object.assign({},e.theme),{background:Object.assign(Object.assign({},e.theme.background),{resting:e.theme.background.hover})})),C.createElement(U.a,Object.assign({},e,{onAccessibilityExpandCollapse:this.onAccessibilityExpandCollapse,ref:this.buttonRef}))}},{key:"handleClick",value:function(){this.props.buttonProps.onClick&&this.props.buttonProps.onClick(),this.setState((function(e){return{calloutVisible:!e.calloutVisible}}))}},{key:"closeCallout",value:function(){this.shouldFocusButtonOnUpdate=!0,this.setState((function(e){return{calloutVisible:!1}}))}},{key:"onAccessibilityExpandCollapse",value:function(e){"expand"===e&&this.state.calloutVisible||"collapse"===e&&!this.state.calloutVisible||this.handleClick()}}])&&jt(t.prototype,n),o&&jt(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(C.PureComponent);Bt.ids=0;var Nt=n(634);function Lt(e){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ft(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ht(e,t){return(Ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function zt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Wt(e);if(t){var i=Wt(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return Ut(this,n)}}function Ut(e,t){if(t&&("object"===Lt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Wt(e){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ht(e,t)}(r,e);var t,n,o,i=zt(r);function r(){return Pt(this,r),i.apply(this,arguments)}return t=r,(n=[{key:"getAccessibilityLabel",value:function(){return this.props.accessibilityLabel||this.props.title||this.props.strings&&this.props.strings.defaultOverflowButtonAccessibilityLabel}},{key:"renderButton",value:function(e,t,n,o,i){var r,s,a,l,c;return C.createElement(U.a,{ref:i,key:t,title:this.props.title,icon:{type:null!==(s=null===(r=this.props.icon)||void 0===r?void 0:r.type)&&void 0!==s?s:"Overflow",filled:(null===(a=this.props.icon)||void 0===a?void 0:a.filled)||n},tooltip:null!==(l=this.props.tooltip)&&void 0!==l?l:null===(c=this.props.strings)||void 0===c?void 0:c.defaultOverflowButtonAccessibilityLabel,disabled:this.props.disabled,hidden:this.props.hidden,refusesKeyboardFocus:this.props.refusesKeyboardFocus,style:this.getStyle(),theme:this.getCompositeButtonTheme(),strings:this.props.strings,onClick:e,onHoverIn:this.props.onHoverIn,onHoverOut:this.props.onHoverOut,onFocus:this.props.onFocus,onBlur:this.props.onBlur,accessibilityLabel:this.getAccessibilityLabel(),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,accessibilityRole:"overflow",accessibilityState:n,onAccessibilityExpandCollapse:o,automationLabel:"".concat(this.props.automationLabelType,"_").concat(this.props.title||"OverFlow","_").concat(this.props.automationId),appearFocused:this.props.appearFocused})}},{key:"getCompositeButtonTheme",value:function(){return this.props.theme?this.props.theme:Nt.a.defaultTheme}},{key:"getStyle",value:function(){var e=this.props.style;return e&&void 0!==e.paddingHorizontal?e:Object.assign(Object.assign({},e),{paddingHorizontal:8})}}])&&Ft(t.prototype,n),o&&Ft(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(C.PureComponent),qt=n(1692);function Vt(e){return void 0!==e.iconType?{type:e.iconType,filled:!0}:void 0}function Zt(e,t,n){var o,i={paddingHorizontal:8,flexibleSize:!0,iconFontSize:20};return!t||n||(i.paddingStart=8+Object(me.b)(null===(o=e.icon)||void 0===o?void 0:o.fontSize)),i}var Qt=function(e){var t=[];if(e.items){var n=e.items.filter((function(e){return"item"===e.type})),o=n.some((function(e){var t=Vt(e);return!!t&&me.a.shouldRender(t)})),i=1;t.push(e.items.map((function(t){switch(t.type){case"item":return function(e,t,n,o,i,r){var s=Vt(t),a=e.itemTheme,l=e.automationLabelType,c=e.automationId;return C.createElement(U.a,{key:t.key,title:t.title,titleStyle:t.titleStyle,onClick:function(){return n(t)},disabled:t.disabled,theme:a,accessibilityRole:"menuitem",automationLabel:"".concat(l,"_").concat(t.title,"_").concat(c),icon:s,style:Zt(e,r,void 0!==t.iconType),accessibilityPositionInSet:o,accessibilitySetSize:i})}(e,t,e.onItemClick,i++,n.length,o);case"separator":return C.createElement(qt.a,{key:t.key,color:e.theme&&e.theme.separator});default:return null}})))}return C.createElement(W.a,{style:e.style,align:G.b.Stretch},t)};function Yt(e){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Xt(){return(Xt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=Jt(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function Jt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=on(e)););return e}function $t(e,t){return($t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function en(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=on(e);if(t){var i=on(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return tn(this,n)}}function tn(e,t){if(t&&("object"===Yt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return nn(e)}function nn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function on(e){return(on=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rn(e){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function an(e,t){return(an=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ln(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=un(e);if(t){var i=un(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return cn(this,n)}}function cn(e,t){if(t&&("object"===rn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function un(e){return(un=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&an(e,t)}(r,e);var t,n,o,i=ln(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=i.call(this,e)).buttonId="OverflowMenu"+r.ids,r.ids+=1,t}return t=r,(n=[{key:"render",value:function(){return C.createElement("div",{id:this.buttonId,style:{display:"flex"}},this.renderAnchorButtonAndMaybeCallout())}},{key:"shouldFocusButtonOnDismiss",value:function(){return!0}},{key:"renderCallout",value:function(e,t,n){return function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(n),C.createElement(b.a,{key:e,role:"menu",target:"#"+this.buttonId,isBeakVisible:!1,onDismiss:t,setInitialFocus:!0},C.createElement(q.a,{isCircularNavigation:!0,handleTabKey:V.b.all},this.renderCalloutItems()))}}])&&sn(t.prototype,n),o&&sn(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$t(e,t)}(r,e);var t,n,o,i=en(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=i.call(this,e)).state={menuOpen:!1},t.buttonRef=C.createRef(),t.onMenuDismiss=t.onMenuDismiss.bind(nn(t)),t.onButtonClick=t.onButtonClick.bind(nn(t)),t.onItemClick=t.onItemClick.bind(nn(t)),t.onAccessibilityExpandCollapse=t.onAccessibilityExpandCollapse.bind(nn(t)),t}return t=r,(n=[{key:"openMenu",value:function(){this.state.menuOpen||(this.setState({menuOpen:!0}),this.handleMenuOpen())}},{key:"focus",value:function(){this.buttonRef.current&&!this.buttonRef.current.props.refusesKeyboardFocus&&this.buttonRef.current.focus()}},{key:"performAccessibilityExpandCollapse",value:function(e){this.onAccessibilityExpandCollapse(e)}},{key:"renderAnchorButtonAndMaybeCallout",value:function(){var e=this.renderButton(this.onButtonClick,"button",this.state.menuOpen,this.onAccessibilityExpandCollapse,this.buttonRef),t=this.state.menuOpen?this.renderCallout("callout",this.onMenuDismiss,this.buttonRef):void 0;return t?[e,t]:[e]}},{key:"renderCalloutItems",value:function(e){return C.createElement(Qt,Object.assign({},this.props,{style:e,onItemClick:this.onItemClick}))}},{key:"getCompositeButtonTheme",value:function(){var e=Object.assign({},Xt(on(r.prototype),"getCompositeButtonTheme",this).call(this));return this.state.menuOpen&&(e.background.hover&&(e.background=Object.assign(Object.assign({},e.background),{resting:e.background.hover})),e.title.hover&&(e.title=Object.assign(Object.assign({},e.title),{resting:e.title.hover})),e.subtitle&&e.subtitle.hover&&(e.subtitle=Object.assign(Object.assign({},e.subtitle),{resting:e.subtitle.hover})),e.icon&&e.icon.hover&&(e.icon=Object.assign(Object.assign({},e.icon),{resting:e.icon.hover}))),e}},{key:"handleMenuOpen",value:function(){this.props.onMenuOpen&&this.props.onMenuOpen()}},{key:"handleMenuDismiss",value:function(){this.props.onMenuDismiss&&this.props.onMenuDismiss(),this.shouldFocusButtonOnDismiss()&&this.focus()}},{key:"onMenuDismiss",value:function(){this.handleMenuDismiss(),this.setState({menuOpen:!1})}},{key:"onButtonClick",value:function(){var e=this;this.setState((function(t){var n={menuOpen:!t.menuOpen};return n.menuOpen?e.handleMenuOpen():e.handleMenuDismiss(),n}))}},{key:"onItemClick",value:function(e){this.props.onClick&&this.props.onClick(e),e.preventDismiss||this.onMenuDismiss()}},{key:"onAccessibilityExpandCollapse",value:function(e){"expand"===e&&this.state.menuOpen||"collapse"===e&&!this.state.menuOpen||this.onButtonClick()}}])&&Kt(t.prototype,n),o&&Kt(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(Gt));pn.ids=0;var dn=n(2844);function gn(e){if(e)return{paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,paddingHorizontal:e.paddingHorizontal}}var hn=function(e){if(e.styles&&e.styles.widths&&e.shimmerCount!==e.styles.widths.length)return null;for(var t,n=[],o=0;o<e.shimmerCount;o+=1)n.push(C.createElement(dn.a,{styles:(t=e.styles&&e.styles.widths?e.styles.widths[o]:void 0,{root:{paddingBottom:5,width:t}})}));return C.createElement(W.a,{style:gn(e.styles),direction:G.c.TopToBottom,align:G.b.Stretch},n)};function fn(e){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function yn(e,t){return(yn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function bn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=xn(e);if(t){var i=xn(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return vn(this,n)}}function vn(e,t){if(t&&("object"===fn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Sn(e)}function Sn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xn(e){return(xn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cn=function(e){return"footerButton"+e.toString()},Tn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yn(e,t)}(s,e);var t,n,o,i=bn(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e)).defaultActionButtonRef=C.createRef(),t.overflowMenuRef=C.createRef(),t.isFirstTimeRendering=C.createRef(),t.actionIds=C.createRef(),t.state={actionIdShowAppearFocusMap:{}},t.addActionId=t.addActionId.bind(Sn(t)),t.isFirstTimeRendering.current=!0,t}return t=s,(n=[{key:"componentDidMount",value:function(){var e;this.props.setFooterActionIdList&&this.props.setFooterActionIdList(null!==(e=this.actionIds.current)&&void 0!==e?e:[]),this.isFirstTimeRendering.current=!1}},{key:"componentDidUpdate",value:function(e,t){var n=this,o=this.props.selectedButtonIndex,i=e.selectedButtonIndex;o!==i&&(void 0!==i&&-1!==i&&this.setState((function(e){if(null!==n.actionIds.current){var t=n.actionIds.current[i],o=Object.assign({},e.actionIdShowAppearFocusMap);return o[t]=!1,Object.assign(Object.assign({},n.state),{actionIdShowAppearFocusMap:o})}return e})),void 0!==o&&-1!==o&&this.setState((function(e){if(null!==n.actionIds.current){var t=n.actionIds.current[o],i=Object.assign({},e.actionIdShowAppearFocusMap);return i[t]=!0,Object.assign(Object.assign({},n.state),{actionIdShowAppearFocusMap:i})}return e})))}},{key:"render",value:function(){return C.createElement(W.a,{direction:G.c.LeftToRight,style:this.getFooterStyle(),align:G.b.Stretch},this.renderIcons(),C.createElement(W.a,{style:{flexibleSize:!0}}),this.props.definition.critiqueType===z.c.AccColorChecker?this.renderFooterButton(z.a.Accessibility):null,this.renderBrandingOrPrevNextButton())}},{key:"focus",value:function(){this.defaultActionButtonRef.current?this.defaultActionButtonRef.current.focus():this.overflowMenuRef.current&&this.overflowMenuRef.current.focus()}},{key:"openOverflowMenu",value:function(){var e;null===(e=this.overflowMenuRef.current)||void 0===e||e.openMenu()}},{key:"componentWillUnmount",value:function(){this.props.setFooterActionIdList&&this.props.setFooterActionIdList([]),this.isFirstTimeRendering.current=null}},{key:"renderIcons",value:function(){return this.props.definition.onlyShowFeedbackButton?this.renderFeedbackIcon():C.createElement(C.Fragment,null,this.renderDefaultActionButtons(),this.renderExplanation(),this.renderOverflowMenu())}},{key:"renderFeedbackIcon",value:function(){var e=this.props,t=e.definition,n=e.strings,o=e.onAction,i=e.automationId,r=e.onPositionChange;return yt(t,z.a.Feedback)?(this.addActionId(z.a.Feedback),function(e,t,n,o,i,r,s,a){var l=ft(e,o,z.a.Feedback);if(!l)return null;var c={type:mt(z.a.Feedback),filled:!0},u=w.O(t,s),p={onClick:function(){null==r||r(z.a.Feedback,void 0,void 0)},title:l,tooltip:l,disabled:bt(e,z.a.Feedback),style:n,theme:u,accessibilityLabel:ht(e,o,z.a.Feedback),automationLabel:"CritiqueActionButton_".concat(l,"_").concat(i),icon:c,onPositionChange:a};return C.createElement(U.a,Object.assign({},p,{key:z.a.Feedback.toString()}))}(t,this.getTheme(),w.t,n,i,o,this.state.actionIdShowAppearFocusMap[z.a.Feedback],r)):null}},{key:"addActionId",value:function(e){bt(this.props.definition,e)||this.isFirstTimeRendering.current&&(null===this.actionIds.current&&(this.actionIds.current=[]),this.actionIds.current.push(e))}},{key:"parseBooleanSetting",value:function(e){return!!this.props.settings&&"true"===this.props.settings[e]}},{key:"renderOverflowMenu",value:function(){var e=this.props,t=e.definition,n=e.strings,o=e.onAction,i=e.automationId,r=t.critiqueType,s=t.isContentPending;if(r===z.c.NeuralRewrite&&s||r===z.c.NeuralRewrite&&this.parseBooleanSetting("renderNRForAIFeedback")||r===z.c.DictationCorrection)return null;var a=this.state.actionIdShowAppearFocusMap[z.a.Overflow],l=lt(t,this.getTheme(),n,this.getFontTable(),this.calculateOverflowActions(),this.parseBooleanSetting("NoTooltipForFooterOverflow"),n.critique("footerSeeMoreActionsAccessibilityLabel"),void 0,i,o,a);return l&&this.addActionId(z.a.Overflow),l?C.createElement(pn,Object.assign({ref:this.overflowMenuRef},l,{icon:{type:"Overflow",filled:!0}})):null}},{key:"calculateOverflowActions",value:function(){var e=this.props.definition.actions;return void 0===e||0===e.length?[]:this.getAllFooterOverflowActions().filter((function(t){return void 0!==t&&-1!==e.indexOf(t)}))}},{key:"getTheme",value:function(){var e;return null!==(e=this.props.theme)&&void 0!==e?e:w.g}},{key:"getBrandingTheme",value:function(){var e,t;return null!==(t=null===(e=this.props.theme)||void 0===e?void 0:e.branding)&&void 0!==t?t:function(e){switch(e){case z.b.Text:return $e;case z.b.Icon:case z.b.MonochromeIcon:return et;case z.b.IconButton:return tt;case z.b.IconAndTextButton:return nt;default:return}}(this.props.definition.brandingMode)}},{key:"getFontTable",value:function(){var e;return null!==(e=this.props.fontTable)&&void 0!==e?e:w.h}},{key:"getFooterStyle",value:function(){var e;return null!==(e=this.props.footerContainerStyle)&&void 0!==e?e:w.u}},{key:"renderFooterButton",value:function(e,t,n){var o,i=this.props,r=i.definition,s=i.strings,a=i.onAction,l=i.automationId,c=i.onPositionChange;if(!yt(r,e))return null;var u=ft(r,s,e);if(!u)return null;this.addActionId(e);var p="CritiqueActionButton_".concat(u,"_").concat(l),d=bt(r,e),g=e===z.a.IgnoreOnce||e===z.a.IgnoreAll?ut(r,s,this.getTheme(),d,e,void 0,{horizontalSpacing:null===(o=this.getFooterStyle())||void 0===o?void 0:o.paddingHorizontal}):void 0;if(!this.shouldRenderFooterIconActionInOverflow(e))return ct(r,this.getTheme(),e,w.t,s,void 0,void 0,void 0,u,p,t?this.defaultActionButtonRef:void 0,g,l,a,!0,Cn(e),this.state.actionIdShowAppearFocusMap[e],n,c);var h={title:u,titleStyle:w.S(this.getFontTable(),u.length),onClick:function(){null==a||a(e)},style:w.t,theme:w.B(this.getTheme()),automationLabel:p,disabled:d};return C.createElement(U.a,Object.assign({key:e,ref:this.defaultActionButtonRef},h))}},{key:"renderDefaultActionButtons",value:function(){var e=this,t=this.props,n=t.definition,o=t.strings,i=t.onAction,r=t.automationId,s=n.critiqueType,a=n.actions,l=[];return void 0!==a&&a.length>0&&(l=this.getDefaultActions().filter((function(e){return void 0!==e&&-1!==a.indexOf(e)}))),s!==z.c.NeuralRewrite?C.createElement(C.Fragment,null,l.map((function(t){return e.renderFooterButton(t,0===l.indexOf(t))})),this.props.definition.critiqueType===z.c.AccColorChecker&&this.parseBooleanSetting("OpenColorPickerEnabled")?this.renderFooterButton(z.a.OpenColorPicker,void 0,"ACCF2E3E-7EC7-46DF-AB25-A1AFEDBC6B7B"):null):0===l.length?C.createElement(hn,{shimmerCount:1,styles:w.R(this.getSpacing())}):C.createElement(C.Fragment,null,l.map((function(t){return t===z.a.Dismiss?(e.addActionId(t),ct(n,e.getTheme(),z.a.Dismiss,w.U(e.getFontTable()),o,void 0,void 0,void 0,void 0,void 0,e.defaultActionButtonRef,void 0,r,i)):e.renderFooterButton(t)})))}},{key:"getDefaultActions",value:function(){var e=this.props.definition,t=e.critiqueType,n=e.isContentPending,o=function(e){switch(e){case z.c.Refinement:case z.c.RepeatedWord:case z.c.SimilarityChecker:case z.c.AccColorChecker:case z.c.TonalRewrite:case z.c.Grammar:case z.c.DictationCorrection:case r.Person:case r.File:case r.Location:case r.SatoriEntity:return z.a.IgnoreOnce;case z.c.Spelling:case z.c.Topic:case r.Topic:return z.a.IgnoreAll;case z.c.NeuralRewrite:case z.c.Classification:case z.c.WritersUnblock:default:return}}(t),i=this.parseBooleanSetting("EnableFeedback");switch(t){case z.c.Refinement:case z.c.Topic:var s=[o];return yt(e,z.a.Feedback)&&(this.shouldRenderFooterIconActionInOverflow(z.a.Feedback)&&t!==z.c.Topic||s.push(z.a.Feedback)),s;case z.c.Spelling:return[o,yt(e,z.a.Feedback)&&!this.shouldRenderFooterIconActionInOverflow(z.a.Feedback)?z.a.Feedback:void 0,this.shouldRenderFooterIconActionInOverflow(z.a.AddToDictionary)?void 0:z.a.AddToDictionary];case z.c.AccColorChecker:return this.parseBooleanSetting("AllowAccesibilityIssueEnabled")?[z.a.Allow]:[];case z.c.RepeatedWord:case z.c.SimilarityChecker:case z.c.DictationCorrection:return[o];case z.c.Grammar:return[o,i&&!this.shouldRenderFooterIconActionInOverflow(z.a.Feedback)?z.a.Feedback:void 0];case z.c.TonalRewrite:return[o,i?z.a.Feedback:void 0];case z.c.NeuralRewrite:return n?[]:0===pt(e).length?[z.a.Dismiss]:[z.a.Feedback];case r.Location:case r.Person:case r.SatoriEntity:case r.Topic:return[o];case r.File:return[o,z.a.Feedback];default:return[]}}},{key:"renderExplanation",value:function(){var e=this.props,t=e.definition,n=e.onAction,o=e.strings,i=e.automationId,r=e.style,s=t.explanation,a=this.getTheme(),l=this.getFontTable();if(!s||0===s.length){if(this.props.definition.critiqueType!==z.c.AccColorChecker)return null;t.explanationTitle=this.props.strings.critiqueExplanation("contrastIssueExplanationTitle"),t.explanation=this.props.strings.critiqueExplanation("contrastIssueExplanation")}var c={onClick:function(){null==n||n(z.a.ShowExplanation)},style:w.T(l),theme:w.B(a,void 0,!0),tooltip:ft(t,o,z.a.ShowExplanation),accessibilityLabel:ht(t,o,z.a.ShowExplanation),automationLabel:"CritiqueExplanationButton_".concat(i),icon:{type:"ShowExplanation",filled:!0}};this.addActionId(z.a.ShowExplanation);var u={definition:t,strings:o,style:r,theme:a,fontTable:l};return C.createElement(Bt,{calloutAccessibilityLabel:o.critique("explanationFlyoutAccessibilityLabel"),buttonProps:c},C.createElement(Xe,Object.assign({},u)))}},{key:"renderBrandingOrPrevNextButton",value:function(){var e=this.props,t=e.definition,n=e.showPreviewTooltipForBranding,o=t.brandingMode;if(vt(t))return this.renderPrevNextButtons();if(void 0===o)return null;var i=this.props,r=i.strings,s=i.automationId,a=i.onAction,l=i.onPositionChange,c=bt(t,z.a.OpenEditorPane);return o!==z.b.IconButton&&o!==z.b.IconAndTextButton||this.addActionId(z.a.OpenEditorPane),C.createElement(Tt,{strings:r,theme:this.getBrandingTheme(),fontTable:this.getFontTable(),definition:t,automationId:s,brandingMode:o,onAction:a,htmlId:Cn(z.a.OpenEditorPane),appearFocused:c?void 0:this.state.actionIdShowAppearFocusMap[z.a.OpenEditorPane],isDisabled:c,onPositionChange:l,showPreviewTooltipForBranding:n})}},{key:"renderPrevNextButtons",value:function(){if(!yt(this.props.definition,z.a.Previous)||!yt(this.props.definition,z.a.Next))return null;var e=w.U(this.getFontTable()),t=!this.parseBooleanSetting("NoTooltipForPrevNext");return this.addActionId(z.a.Previous),this.addActionId(z.a.Next),C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Stretch},ct(this.props.definition,this.getTheme(),z.a.Previous,e,this.props.strings,void 0,void 0,void 0,t?ft(this.props.definition,this.props.strings,z.a.Previous):void 0,void 0,void 0,void 0,this.props.automationId,this.props.onAction,void 0,Cn(z.a.Previous),this.state.actionIdShowAppearFocusMap[z.a.Previous]),ct(this.props.definition,this.getTheme(),z.a.Next,e,this.props.strings,void 0,void 0,void 0,t?ft(this.props.definition,this.props.strings,z.a.Next):void 0,void 0,void 0,void 0,this.props.automationId,this.props.onAction,void 0,Cn(z.a.Next),this.state.actionIdShowAppearFocusMap[z.a.Next]))}},{key:"getAllFooterOverflowActions",value:function(){var e=this.props.definition.critiqueType,t=this.parseBooleanSetting("EnableFeedback");switch(e){case z.c.Spelling:return[z.a.IgnoreOnce,this.shouldRenderFooterIconActionInOverflow(z.a.AddToDictionary)?z.a.AddToDictionary:void 0,z.a.ToggleContext,z.a.ToggleDescription,z.a.Options,z.a.ManageLanguages];case z.c.RepeatedWord:return[z.a.ToggleContext,z.a.Options];case z.c.Grammar:return[z.a.IgnoreAll,z.a.IgnoreRule,z.a.ShowExplanation,z.a.ToggleContext,t&&this.shouldRenderFooterIconActionInOverflow(z.a.Feedback)?z.a.Feedback:void 0,z.a.Options];case z.c.Refinement:return[z.a.IgnoreRule,z.a.ToggleContext,t&&this.shouldRenderFooterIconActionInOverflow(z.a.Feedback)?z.a.Feedback:void 0,z.a.Options];case z.c.TonalRewrite:return[z.a.IgnoreAll,z.a.IgnoreRule,z.a.ToggleContext,z.a.Options];case z.c.Topic:return[z.a.IgnoreOnce,z.a.IgnoreRule,z.a.ToggleContext,z.a.Options];case z.c.NeuralRewrite:return[z.a.ToggleContext,z.a.ToggleDescription];case z.c.SimilarityChecker:return[z.a.Feedback,z.a.LearnMore];case z.c.AccColorChecker:return[this.parseBooleanSetting("AllowAccesibilityIssueEnabled")?z.a.AllowAll:void 0,z.a.TurnOffAccChecker,z.a.Feedback];case r.Location:case r.SatoriEntity:case r.Person:return[z.a.IgnoreRule,z.a.Feedback,z.a.ReadAloud,z.a.Options];case r.File:return[z.a.IgnoreAll,z.a.ReadAloud,z.a.Options];case r.Topic:return[z.a.Feedback,z.a.Options];default:return[]}}},{key:"shouldRenderFooterIconActionInOverflow",value:function(e){var t=mt(e);return!(this.parseBooleanSetting("RenderFooterIcons")||this.props.definition.critiqueType===z.c.AccColorChecker)||!t||!me.a.shouldRender({type:t})}},{key:"getSpacing",value:function(){var e;return null!==(e=this.props.spacing)&&void 0!==e?e:w.i}}])&&mn(t.prototype,n),o&&mn(t,o),Object.defineProperty(t,"prototype",{writable:!1}),s}(C.Component);Tn.contextMaxLength=120;var wn,On=n(1691);!function(e){e[e.line=1]="line",e[e.circle=2]="circle",e[e.gap=3]="gap"}(wn||(wn={}));var kn=n(515);function An(e){return function(e){if(Array.isArray(e))return In(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return In(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return In(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function In(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var jn=function(e){var t,n;return null!==(n=null!==(t=null==e?void 0:e.paddingTop)&&void 0!==t?t:null==e?void 0:e.paddingVertical)&&void 0!==n?n:4},_n=function(e){var t,n;return null!==(n=null!==(t=null==e?void 0:e.paddingBottom)&&void 0!==t?t:null==e?void 0:e.paddingVertical)&&void 0!==n?n:4},Mn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:120;return[[{type:wn.circle,height:e},{type:wn.gap,width:t,height:16},{type:wn.line,width:n,height:16}],[{type:wn.circle,height:e},{type:wn.gap,width:t,height:16},{type:wn.line,width:n-20,height:16}],[{type:wn.circle,height:e},{type:wn.gap,width:t,height:16},{type:wn.line,width:n,height:16}]]},Dn=C.memo((function(e){var t=e.items,n=e.theme,o=e.style,i=e.isLongShimmer,r=e.circleSize,s=e.gapSize,a=e.lineSize,l=null!=t?t:i?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:120,o=Mn(e,t,n);return[[{type:wn.line,width:100,height:10}]].concat(An(o),[[{type:wn.line,width:100,height:10}]],An(o),An(o))}(r,s,a):Mn(r,s,a),c=C.useContext(kn.a),u=function(e){var t,n;return null!==(n=null!==(t=null==e?void 0:e.paddingStart)&&void 0!==t?t:null==e?void 0:e.paddingHorizontal)&&void 0!==n?n:8}(o),p=function(e){var t,n;return null!==(n=null!==(t=null==e?void 0:e.paddingEnd)&&void 0!==t?t:null==e?void 0:e.paddingHorizontal)&&void 0!==n?n:8}(o);if(!l.length)return null;for(var d=[],g=0;g<l.length;g++){var h=l[g];d.push(C.createElement(dn.a,{key:"shimmer-".concat(g),style:{paddingTop:jn(o),paddingRight:c?u:p,paddingBottom:_n(o),paddingLeft:c?p:u},shimmerColors:{background:null==n?void 0:n.background,shimmer:null==n?void 0:n.shimmer,shimmerWave:null==n?void 0:n.shimmerWave},shimmerElements:h}))}return C.createElement(C.Fragment,null,d)}));function En(e,t,n){var o;return(null!==(o=e.inlineSuggestions("combineSentences"))&&void 0!==o?o:"{0}. {1}").replace("{0}",t).replace("{1}",n)}var Rn=function(e){var t=e.style,n=e.isError,o=e.strings,i=e.onAction,r=e.theme,a=e.htmlId,l=e.appearFocused,c=e.buttonRef,u=C.useCallback((function(){i&&i(n?s.Retry:s.ClearSearch)}),[o.inlineSuggestions("clearSearchLabel"),o.inlineSuggestions("tryAgainLabel")]),p=n?o.inlineSuggestions("somethingWentWrongLabel"):o.common("suggestionsGroupNoSuggestionsText"),d=n?o.inlineSuggestions("tryAgainLabel"):o.inlineSuggestions("clearSearchLabel"),g={style:w.Y(t),theme:L(r,l),onClick:u,accessibilityLabel:En(o,p,d)};return C.createElement(W.a,{align:G.b.Stretch,direction:G.c.TopToBottom},C.createElement(W.a,{style:Object.assign(Object.assign({},t),{paddingBottom:6})},C.createElement(he.a,{text:p,style:B(r,w.h)})),C.createElement(U.a,Object.assign({ref:c,htmlId:a,automationLabel:d},g),C.createElement(he.a,{text:d,style:N(r,w.h)})))};function Bn(e,t){if(t){e=e.toLocaleLowerCase();var n=(t=t.toLocaleLowerCase()).indexOf(e);if(!(n<0))return[{start:n,length:e.length,fontWeight:O.a.SemiBold,wrapMode:O.b.NoWrap}]}}function Nn(e,t,n){if(e){var o=n?null==t?void 0:t.filter((function(e){return e.propertyHit===n})):t,i=[];return o&&o.forEach((function(e){i.push({start:e.offset,length:e.word.length,fontWeight:O.a.SemiBold,wrapMode:O.b.NoWrap})})),i}}var Ln=function(e){var t,n,o,i,r,s,a,l,c,u,p=e.htmlId,d=e.theme,h=e.style,f=e.containerStyles,m=e.strings,y=e.suggestionId,b=e.suggestionType,v=e.queryString,S=e.title,x=e.titleFontSize,T=e.subtitle,O=e.subtitleFontSize,k=e.truncateSubtitle,A=e.tooltip,I=e.icon,j=e.personaCoinProps,_=e.isHighlighted,D=e.hasSelectionBeenModifiedViaKeyboard,E=e.accessibilityRole,R=e.accessibilityPositionInSet,B=e.accessibilitySetSize,N=e.onPositionChange,L=e.onClick,P=e.enablePrefixHighlighting,F=e.hitHighlightIndexes,H=b===g.EntityType.Topic,W=(null==f?void 0:f.maxWidth)&&f.maxWidth-70,G=Je.b.rightCenter;switch(null===(t=null==d?void 0:d.tooltip)||void 0===t?void 0:t.directionHint){case z.d.centered:G=void 0;break;case z.d.rightCenter:G=Je.b.rightCenter;break;case z.d.bottomCenter:G=Je.b.bottomCenter;break;default:G=H?Je.b.rightCenter:void 0}var q=S&&T?En(m,S,T):S;return C.createElement(U.a,{htmlId:p,onClick:L,accessibilityLabel:q,accessibilityRole:E,accessibilityPositionInSet:R,accessibilitySetSize:B,onPositionChange:N,automationLabel:"Inline".concat(b,"Suggestion-").concat(y),tooltipProps:{showBeak:null!==(o=null===(n=null==d?void 0:d.tooltip)||void 0===n?void 0:n.showBeak)&&void 0!==o?o:H,gapSpace:null===(i=null==d?void 0:d.tooltip)||void 0===i?void 0:i.gapSpace,borderRadius:null===(r=null==d?void 0:d.tooltip)||void 0===r?void 0:r.borderRadius,calloutMaxWidth:null===(s=null==d?void 0:d.tooltip)||void 0===s?void 0:s.calloutMaxWidth,paddingStart:null===(a=null==d?void 0:d.tooltip)||void 0===a?void 0:a.paddingStart,paddingEnd:null===(l=null==d?void 0:d.tooltip)||void 0===l?void 0:l.paddingEnd,paddingTop:null===(c=null==d?void 0:d.tooltip)||void 0===c?void 0:c.paddingTop,paddingBottom:null===(u=null==d?void 0:d.tooltip)||void 0===u?void 0:u.paddingBottom,coverTarget:void 0===G,directionHint:G},title:S,titleStyle:w.xb(w.h,S?S.length:0,!0,x),titleRootStyle:w.Z(W),personaCoinProps:j,style:h,subtitle:T,subtitleStyle:w.ub(w.h,!0,k,O),theme:M(d,_),appearFocused:_,isSelectedByKeyboard:_&&D,tooltip:A,icon:I,titleFormatting_DONOTUSE:v?P?Nn(S,F,"title"):Bn(v,S):void 0,subtitleFormatting:v?P?Nn(T,F,"subTitle"):Bn(v,T):void 0})},Pn=Object.freeze({doc:{iconType:"Word"},docx:{iconType:"Word"},dot:{iconType:"Word"},dotx:{iconType:"Word"},docm:{iconType:"Word"},docb:{iconType:"Word"},ppt:{iconType:"PowerPoint"},pptx:{iconType:"PowerPoint"},xls:{iconType:"Excel"},xlm:{iconType:"Excel"},xlsx:{iconType:"Excel"},xlsm:{iconType:"Excel"},xlsb:{iconType:"Excel"},xltx:{iconType:"Excel"},pdf:{iconType:"Pdf"},vsd:{iconType:"Visio"},vsdx:{iconType:"Visio"},loop:{iconType:"Loop"},fluid:{iconType:"Loop"}});var Fn=Object.freeze({Apps:"Apps",FFXCAccounts:"Person",FFXCBulletedList:"BulletedList",FFXCCalendarAgenda:"Agenda",FFXCChecklist:"Checklist",FFXCodeSnippet:"Code",FFXCCommentAdd:"CommentAdd",FFXCCompleted:"FFXCCompleted",FFXConversation:"Conversation",FFXCEmoji:"EmojiSmile",FFXCEventDate:"Date",FFXFeedbackRequest:"FeedbackRequest",FFXCHorizontalDivider:"HorizontalDivider",FFXCInsertTextBox:"Paragraph",FFXCNumberedList:"NumberedList",FFXCPhoto2:"InsertImage",FFXQuestionAnswer:"QuestionAnswer",FFXCStatusTracker:"StatusTracker",FFXSignUp:"SignUpSheet",FFXCTable:"Table",FFXTeamUpdate:"TeamUpdate",FFXCVote:"Vote",Files:"Files",Location:"Location",Loop:"Loop",People:"People"});function Hn(e){return e&&e in Fn?Fn[e]:e}var zn=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n};var Un=function(e,t,n){var o,i,r;if(function(e){return e.type===g.EntityType.File}(e)){var s=e.hitFileName||"".concat(e.fileName,".").concat(e.fileExtension),a=(null==t?void 0:t.fileItemStyles)||{},l=a.iconStyles,c=a.titleFontSize,u=a.subtitleFontSize,p=zn(a,["iconStyles","titleFontSize","subtitleFontSize"]);return{suggestionId:e.itemId,suggestionType:e.type,title:s,titleFontSize:c,icon:{type:(i=e.fileExtension,r=i.toLocaleLowerCase(),Pn.hasOwnProperty(r)?Pn[r].iconType:"Cloud"),style:l||{}},style:p,subtitle:e.subject,subtitleFontSize:u,tooltip:s,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(function(e){return e.type===g.EntityType.People}(e)){var d=(null==t?void 0:t.personItemStyles)||{},h=d.personaCoinSize,f=d.titleFontSize,m=d.subtitleFontSize,y=zn(d,["personaCoinSize","titleFontSize","subtitleFontSize"]);return Object.assign(Object.assign({suggestionId:e.displayName,suggestionType:e.type,title:e.displayName,titleFontSize:f,personaCoinProps:{text:"",coinSize:h,imageUrl:e.imageUrl,imageInitials:e.initials,borderColor:null==n?void 0:n.userAvatarBorderColor}},e.iconName&&{icon:{type:e.iconName}}),{style:y,subtitle:e.primaryEmailAddress,subtitleFontSize:m,truncateSubtitle:!0,tooltip:e.primaryEmailAddress,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes})}if(function(e){return e.type===g.EntityType.Scope}(e)){var b=(null==t?void 0:t.scopeItemStyles)||{},v=b.iconStyles,S=b.titleFontSize,x=b.subtitleFontSize,C=b.personaCoinSize,T=zn(b,["iconStyles","titleFontSize","subtitleFontSize","personaCoinSize"]),w=Hn(e.iconName);return{suggestionId:e.id,suggestionType:e.type,title:e.title,titleFontSize:S,icon:void 0!==w?{type:w,style:v||{}}:void 0,personaCoinProps:e.imageUrl||e.iconName?{text:"",coinSize:C,imageUrl:e.imageUrl}:void 0,style:T,subtitle:e.subtitle,subtitleFontSize:x,tooltip:null!==(o=e.tooltip)&&void 0!==o?o:e.title,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}var O=e.id,k=e.title,A=e.subtitle,I=e.imageUrl,j=e.tooltip,_=e.type,M=e.isHighlighted,D=(null==t?void 0:t.genericItemStyles)||{},E=D.iconStyles,R=D.personaCoinSize,B=D.titleFontSize,N=D.subtitleFontSize,L=zn(D,["iconStyles","personaCoinSize","titleFontSize","subtitleFontSize"]),P=Hn(e.iconName);return{suggestionId:O,suggestionType:_,title:k,titleFontSize:B,icon:void 0!==P?{type:P,style:E}:void 0,personaCoinProps:I||P?{text:"",coinSize:R,imageUrl:I}:void 0,style:L,subtitle:A,subtitleFontSize:N,truncateSubtitle:!!j,tooltip:null!=j?j:k,isHighlighted:M,hitHighlightIndexes:e.hitHighlightIndexes}},Wn=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n},Gn=C.memo((function(e){var t=e.suggestion,n=e.theme,o=e.styles,i=e.onItemSelected,r=Wn(e,["suggestion","theme","styles","onItemSelected"]),s=C.useCallback((function(){i(t)}),[t]),a=Un(t,o,n);return C.createElement(Ln,Object.assign({},r,a,{theme:n,onClick:s}))}));function qn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var o,i,r=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(o=n.next()).done)&&(r.push(o.value),!t||r.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var Zn=C.memo((function(e){var t,n,o,i=e.group,r=i.title,s=i.subtitle,a=i.isScoped,l=void 0!==a&&a,c=i.isHighlighted,u=i.addBottomBorder,p=e.htmlId,d=e.theme,g=e.style,h=e.styles,f=e.isScopableHeader,m=e.accessibilityPositionInSet,y=e.accessibilitySetSize,b=e.onClick,v=e.onPositionChange,S=qn(C.useState(!1),2),x=S[0],T=S[1],O=null!=d?d:A,k=null!=g?g:I;if(f&&r){var j=null!==(t=null==h?void 0:h.titleLineHeight)&&void 0!==t?t:10,_=null!==(n=null==h?void 0:h.headerIconSize)&&void 0!==n?n:10,D=(c||x)&&null!==(o=null==O?void 0:O.text.hover)&&void 0!==o?o:null==O?void 0:O.text.resting,B={lineHeight:j+"px",display:"flex",width:l?"auto":"100%",flexDirection:l?"row-reverse":"row"},N={color:D,marginLeft:"4px",fontWeight:"600",flexGrow:l?0:1,fontSize:w.h.xsmall,display:"flex",alignItems:"center"},L=l?"Previous":"Next";return C.createElement(U.a,{htmlId:p,icon:{type:L},automationLabel:r,title:r,titleStyle:w.xb(w.h,(null==r?void 0:r.length)||0,!0),theme:M(O,c),onClick:b,style:Object.assign({flexibleSize:!0},h),onPositionChange:v,onHoverIn:function(){return T(!0)},onHoverOut:function(){return T(!1)},accessibilityRole:"option",accessibilityPositionInSet:m,accessibilitySetSize:y,useFullWidth:!0},C.createElement("span",{"data-is-focusable":!0,style:B},C.createElement("span",{style:N},r),C.createElement(me.a,{type:L,primaryColor:D,fontSize:_,style:{margin:(j-_)/2}})))}return C.createElement(fe.a,{header:r,headerStyle:Object.assign(Object.assign(Object.assign({},E(O,k,w.h)),h),{userSelectable:!1}),subheader:s,subheaderStyle:Object.assign(Object.assign({},R(O,k,w.h)),h),componentStackStyle:P(O,u),stackDirection:G.c.TopToBottom,stackAlignment:G.b.Stretch,accessibleLive:G.a.Off})})),Qn=C.memo((function(e){var t=e.theme,n=e.style,o=e.group,i=e.accessibilitySetSize,r=e.strings,s=e.headerHtmlId,a=e.isHeaderVisible,l=e.headerStyles,c=e.containerStyles,u=e.hasScopableHeader,p=e.headerAccessibilityPositionInSet,d=e.enablePrefixHighlighting,g=e.showSeparator,h=e.separatorProps,f=e.hasSelectionBeenModifiedViaKeyboard,m=e.itemsStyles,y=e.itemQueryString,b=e.onHeaderClick,v=e.onHeaderPositionChange,S=e.onItemSelected,x=e.onItemPositionChange,T=null!=t?t:A,w=null!=n?n:I,O=o.suggestions;return C.createElement(C.Fragment,null,g&&C.createElement(qt.a,Object.assign({},h)),a&&C.createElement(Zn,{theme:T,style:w,styles:l,htmlId:s,group:o,isScopableHeader:u,accessibilityPositionInSet:p,accessibilitySetSize:i,onClick:b,onPositionChange:v}),O.map((function(e,t){var n=p+(u?++t:t);return C.createElement(Gn,{styles:m,containerStyles:c,strings:r,suggestion:e,key:"suggestion-item-".concat(t),htmlId:se(n),theme:T,queryString:""!==y?y:void 0,accessibilityRole:"option",accessibilityPositionInSet:n+1,accessibilitySetSize:i,truncateSubtitle:!0,onItemSelected:S,onPositionChange:function(e,t){return x(e,t,n)},enablePrefixHighlighting:d,hasSelectionBeenModifiedViaKeyboard:f})})))})),Yn=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n},Kn=C.memo((function(e){var t,n,o,i=e.theme,r=e.style,s=e.styles,a=e.strings,l=e.results,c=e.isError,u=e.isEmpty,p=e.isShimmerVisible,d=e.isScrollVisible,g=e.enableScopedHeader,h=e.enablePrefixHighlighting,f=e.itemsCount,m=e.itemPositions,y=e.itemQueryString,b=e.noSuggestionId,v=void 0===b?"noSuggestions":b,S=e.noSuggestionKeyboardFocus,x=e.noSuggestionsButtonRef,T=e.isGroupHeaderVisible,w=e.hasSelectionBeenModifiedViaKeyboard,O=e.onGroupSelected,k=e.onItemSelected,j=e.onNoSuggestionAction,_=null!=i?i:A,M=null!=r?r:I,D=0;if(p){var E=(null==s?void 0:s.shimmerStyles)||{},R=E.circleSize,B=E.gapSize,N=E.lineSize,L=Yn(E,["circleSize","gapSize","lineSize"]);return C.createElement(W.a,{style:P(_),align:G.b.Start},C.createElement(Dn,{style:L,circleSize:R,gapSize:B,lineSize:N,isLongShimmer:d,theme:{background:null==_?void 0:_.background.resting,shimmer:null===(t=null==_?void 0:_.shimmer)||void 0===t?void 0:t.shimmerColor,shimmerWave:null===(n=null==_?void 0:_.shimmer)||void 0===n?void 0:n.shimmerWaveColor}}))}if(c||u)return C.createElement(W.a,{style:P(_),align:G.b.Stretch},C.createElement(Rn,{style:Object.assign(Object.assign({},null==s?void 0:s.noSuggestionsStyles),{backgroundColor:null===(o=null==i?void 0:i.background)||void 0===o?void 0:o.resting}),isError:c,strings:a,onAction:j,theme:_,htmlId:v,appearFocused:S,buttonRef:x}));var F={style:{marginHorizontal:-4,marginTop:4,marginBottom:4}};return C.createElement(C.Fragment,null,l.map((function(e,t){var n=e.suggestions,o=D,i=C.createElement(Qn,{theme:_,style:M,strings:a,key:"suggestion-group-".concat(t),group:e,accessibilitySetSize:f,headerHtmlId:se(D),headerStyles:null==s?void 0:s.headerStyles,containerStyles:null==s?void 0:s.containerStyles,headerAccessibilityPositionInSet:D,hasScopableHeader:g&&!1!==e.isScopingEnabled,enablePrefixHighlighting:h,onHeaderClick:function(){return null==O?void 0:O(e)},onHeaderPositionChange:function(e,t){return m[o]={top:e,bottom:t}},itemsStyles:null==s?void 0:s.itemsStyles,itemQueryString:y,onItemSelected:k,onItemPositionChange:function(e,t,n){0===n&&(e=0),m[n]={top:e,bottom:t}},showSeparator:e.showSeparator,isHeaderVisible:T,separatorProps:e.showSeparator&&F||void 0,hasSelectionBeenModifiedViaKeyboard:w});return g&&!1!==e.isScopingEnabled&&D++,D+=n.length,i})))})),Xn=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return Object.assign({hideFocusBox:!0,minWidth:240,maxWidth:240,maxHeight:null!==(e=null==n?void 0:n.menuHeight)&&void 0!==e?e:252,borderRadius:8,paddingHorizontal:4,paddingTop:4,paddingBottom:4},t)},Jn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({paddingVertical:4,paddingHorizontal:8},e)},$n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({paddingHorizontal:w.b,paddingVertical:9,borderRadius:8},e)},eo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},e)},to=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{genericItemStyles:io(e.genericItemStyles,e.sharedItemStyles,t),personItemStyles:ro(e.personItemStyles,e.sharedItemStyles,t),fileItemStyles:so(e.fileItemStyles,e.sharedItemStyles,t),scopeItemStyles:ao(e.scopeItemStyles,e.sharedItemStyles,t)}},no=function(e){var t,n;return Object.assign(Object.assign({},j),{borderRadius:null!==(t=null==e?void 0:e.itemBorderRadius)&&void 0!==t?t:j.borderRadius,height:null!==(n=null==e?void 0:e.itemHeight)&&void 0!==n?n:j.height})},oo=function(e){return Object.assign(Object.assign({},_),(null==e?void 0:e.itemIconSize)?{width:e.itemIconSize,height:e.itemIconSize,minWidth:e.itemIconSize}:{})},io=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},no(o)),{personaCoinSize:null!==(e=null==o?void 0:o.itemIconSize)&&void 0!==e?e:24}),n),t),{iconStyles:Object.assign(Object.assign({},oo(o)),null==t?void 0:t.iconStyles)})},ro=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;return Object.assign(Object.assign(Object.assign(Object.assign({},no(o)),{personaCoinSize:null!==(e=null==o?void 0:o.itemIconSize)&&void 0!==e?e:24}),n),t)},so=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return Object.assign(Object.assign(Object.assign(Object.assign({},no(n)),t),e),{iconStyles:Object.assign(Object.assign({},oo(n)),null==e?void 0:e.iconStyles)})},ao=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},no(o)),{personaCoinSize:null!==(e=null==o?void 0:o.itemIconSize)&&void 0!==e?e:24}),n),t),{iconStyles:Object.assign(Object.assign({},oo(o)),null==t?void 0:t.iconStyles)})},lo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(Object.assign(Object.assign({},w.u),{height:40,paddingTop:6,paddingBottom:4,paddingHorizontal:6,marginTop:-4,marginHorizontal:-4,marginBottom:4,transform:"translateY(4px)"}),e)},co=n(633),uo=n(2861);function po(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var o,i,r=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(o=n.next()).done)&&(r.push(o.value),!t||r.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return go(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return go(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function go(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var ho=function(e,t,n,o){var i,r;return{root:{borderRadius:null==t?void 0:t.borderRadius,borderColor:o?null===(i=null==n?void 0:n.borderColor)||void 0===i?void 0:i.hover:null===(r=null==n?void 0:n.borderColor)||void 0===r?void 0:r.resting,borderBottom:null==t?void 0:t.borderBottom,width:null==t?void 0:t.width,marginTop:null==t?void 0:t.marginTop,marginBottom:null==t?void 0:t.marginBottom,marginLeft:e?null==t?void 0:t.marginEnd:null==t?void 0:t.marginStart,marginRight:e?null==t?void 0:t.marginStart:null==t?void 0:t.marginEnd},icon:{color:null==n?void 0:n.iconColor}}},fo=function(e){var t=e.htmlId,n=e.theme,o=e.styles,i=e.accessibilityLabel,r=e.accessibilitySetSize,s=e.accessibilityPositionInSet,a=e.placeholder,l=e.disabled,c=e.disableAnimation,u=e.autofocus,p=e.handledKeys,d=e.autoComplete,g=e.spellCheck,h=e.onChange,f=e.onClear,m=e.onKeyDown,y=po(C.useState(!1),2),b=y[0],v=y[1],S={};co.a({onKeyDown:m,handledKeys:p},S);var x=C.useContext(kn.a);return C.createElement(uo.a,{id:t,"aria-label":i,"aria-posinset":s,"aria-setsize":r,spellCheck:g,autoComplete:void 0===d?void 0:d?"on":"off",styles:ho(x,o,n,b),onMouseEnter:function(){return v(!0)},onMouseLeave:function(){return v(!1)},autoFocus:u,placeholder:a,disabled:l,disableAnimation:c,onClear:f,onChange:function(e,t){return null==h?void 0:h(t)},onKeyDown:S.onKeyDown})},mo=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n},yo=C.memo((function(e){var t,n,o,i,r,s,a=e.theme,l=mo(e,["theme"]);return C.createElement(C.Fragment,null,C.createElement(W.a,{style:{marginVertical:8,marginHorizontal:12}},C.createElement(fo,Object.assign({},l,{autoComplete:!1,spellCheck:!1,accessibilityLabel:"InlineSuggestionsSearchBox",styles:{borderRadius:4,width:"100%",borderBottom:"".concat(null===(t=null==a?void 0:a.searchBox)||void 0===t?void 0:t.borderBottomColor," solid 1px")},theme:{iconColor:null===(n=null==a?void 0:a.searchBox)||void 0===n?void 0:n.iconColor,borderColor:{hover:null===(i=null===(o=null==a?void 0:a.searchBox)||void 0===o?void 0:o.borderColor)||void 0===i?void 0:i.hover,resting:null===(s=null===(r=null==a?void 0:a.searchBox)||void 0===r?void 0:r.borderColor)||void 0===s?void 0:s.resting}}}))),C.createElement(qt.a,null))}));function bo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var o,i,r=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(o=n.next()).done)&&(r.push(o.value),!t||r.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return r}(e,t)||vo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vo(e,t){if(e){if("string"==typeof e)return So(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?So(e,t):void 0}}function So(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var xo,Co=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n},To=function(e){var t,n,o,i=e.definition,s=e.theme,a=e.style,l=e.styles,c=e.strings,u=e.queryString,p=e.results,d=e.isError,g=e.isLoading,h=e.menuType,f=e.enableScopedHeader,m=e.enablePrefixHighlighting,y=e.enableStickyFooter,b=e.keyboardHandlerTarget,v=e.showMoreEntitiesConfig,S=e.onGroupSelected,x=e.onAction,T=e.onItemSelected,O=e.onItemFocused,k=e.onFooterAction,j=e.onAfterUpdate,_=null!=s?s:A,M=null!=a?a:I,E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{containerStyles:Xn(e.containerStyles,t),shimmerStyles:Jn(e.shimmerStyles),noSuggestionsStyles:$n(e.noSuggestionsStyles),headerStyles:eo(e.headerStyles),itemsStyles:to(e.itemsStyles,t),footerStyles:lo(e.footerStyles)}}(l,M),R=[],B=h&&"flag"in h?h.flag:z.c.Spelling,N={RenderFooterIcons:"true"},L=C.useRef(null),P=C.useRef(null),H=C.createRef(),q=C.createRef(),V=bo(C.useState({value:0}),2),Z=V[0],Q=V[1],Y=bo(C.useState({value:-1}),2),K=Y[0],X=Y[1],J=bo(C.useState([]),2),$=J[0],ne=J[1],oe=C.useCallback((function(e){ne(e)}),[ne]),ie=bo(C.useState(!1),2),ce=ie[0],ue=ie[1],pe=bo(C.useState(!1),2),de=pe[0],ge=pe[1],he=bo(C.useState(!1),2),fe=he[0],me=he[1],ye=bo(C.useState(),2),be=ye[0],ve=ye[1],Se=bo(C.useState(!1),2),xe=Se[0],Ce=Se[1],Te=bo(C.useState(!1),2),we=Te[0],Oe=Te[1],ke=bo(C.useState(!1),2),Ae=ke[0],Ie=ke[1],je=p.every((function(e){return!e.suggestions||0===e.suggestions.length})),_e=f&&!xe,Me=p.filter((function(e){return!1!==e.isScopingEnabled})).length,De=p.map((function(e){return e.suggestions.length})).reduce((function(e,t){return t+e}),0),Ee=!!(o=h)&&(o.hasOwnProperty("userInitiated")?void 0!==o.brandingMode:!!o.hasOwnProperty("flag")),Re=_e?De+Me:De,Be=De?De*(null!==(t=M.itemHeight)&&void 0!==t?t:40)+18*Me:80,Ne=!!h&&"brandingMode"in h&&void 0!==h.brandingMode?h.brandingMode:void 0,Le=h&&"flag"in h?h.critiquePosition:void 0,Pe=h&&"flag"in h?h.critiqueSetSize:void 0;C.useEffect((function(){var e,t=0,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=vo(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(p);try{for(n.s();!(e=n.n()).done;){var o=e.value;t++,Z.value>=t&&Z.value<t+o.suggestions.length&&(P.current=o.suggestions[Z.value-t]),t+=o.suggestions.length}}catch(e){n.e(e)}finally{n.f()}}),[Z]),C.useEffect((function(){if(!g)if((d||je)&&O)O({focusedItemHtmlId:"noSuggestions"}),me(!0);else{var e=_e?1:0;O&&O({focusedItemHtmlId:se(e)}),He(Z.value,e),Q({value:e})}}),[g,xe]),C.useEffect((function(){L.current&&(clearTimeout(L.current),L.current=null),g?p&&p.length?L.current=setTimeout((function(){return ge(!0)}),2e3):ge(!0):ge(!1)}),[g]),C.useEffect((function(){j&&i&&j(i)}));var Fe=function(e,t){var n=0;p.forEach((function(o){if(_e&&!1!==o.isScopingEnabled&&(e===n&&(o.isHighlighted=t,ve(R[e]),null==O||O({focusedItemHtmlId:se(e)})),n++),e>=n&&e<n+o.suggestions.length){var i=o.suggestions[e-n];i.isHighlighted=t,t&&(ve(R[e]),O&&O({focusedItemHtmlId:se(e),item:i}))}n+=o.suggestions.length}))},He=function(e,t){return t<0?-1:(e>=0&&Fe(e,!1),Fe(t%=Re,!0),t)},ze=function(e){var t;switch(e){case On.b.ArrowDown:-1===K.value?(Fe(Z.value,!1),X({value:0}),null==O||O({focusedItemHtmlId:Cn($[0])})):K.value<$.length-1?(X({value:K.value+1}),null==O||O({focusedItemHtmlId:Cn($[K.value+1])})):(Q({value:He(-1,0)}),X({value:-1}));break;case On.b.ArrowUp:if(0===K.value)Q({value:He(-1,Re-1)}),X({value:-1});else if(K.value>0)X({value:K.value-1}),null==O||O({focusedItemHtmlId:Cn($[K.value-1])});else{Fe(0,!1),X({value:$.length-1}),null==O||O({focusedItemHtmlId:Cn($[$.length-1])});var n=R[Re-1],o=n.top,i=n.bottom,r=R[Re],s=r.top,a=r.bottom;ve({top:o+s,bottom:i+a})}break;case On.b.Enter:case On.b.Tab:$[K.value]===z.a.Overflow?null===(t=q.current)||void 0===t||t.openOverflowMenu():null==k||k($[K.value])}},Ue=function(){var e;Ce(!0),Oe(!1),null===(e=null==v?void 0:v.onClickShowMoreEntities)||void 0===e||e.call(v,!0)},We=function(e){switch(e){case On.b.ArrowDown:we?(Oe(!1),X({value:0})):(Fe(Z.value,!1),Oe(!0));break;case On.b.ArrowUp:we?(Oe(!1),Q({value:He(-1,Re-1)})):(X({value:-1}),Oe(!0));break;case On.b.Enter:case On.b.Tab:Ue()}},Ge=function(e){if(e!==On.b.ArrowDown&&e!==On.b.ArrowUp&&e!==On.b.Enter&&e!==On.b.Tab&&e!==On.b.Home&&e!==On.b.End)return!1;if(d||je)return function(e){var t,n,o;switch(e){case On.b.ArrowDown:-1===K.value?(X({value:0}),null==O||O({focusedItemHtmlId:Cn($[0])}),me(!1)):K.value<$.length-1?(X({value:K.value+1}),null==O||O({focusedItemHtmlId:Cn($[K.value+1])})):(null==O||O({focusedItemHtmlId:"noSuggestions"}),me(!0),X({value:-1}));break;case On.b.ArrowUp:0===K.value?(null==O||O({focusedItemHtmlId:"noSuggestions"}),me(!0),X({value:-1})):K.value>0?(null==O||O({focusedItemHtmlId:Cn($[K.value-1])}),X({value:K.value-1})):(me(!1),X({value:$.length-1}),null==O||O({focusedItemHtmlId:Cn($[$.length-1])}));break;case On.b.Enter:case On.b.Tab:-1===K.value?null===(o=null===(t=H.current)||void 0===t?void 0:(n=t.props).onClick)||void 0===o||o.call(n):null==k||k($[K.value])}}(e),!0;switch(e){case On.b.ArrowDown:if(Ie(!0),-1!==K.value||Z.value===Re-1||we)!(null==v?void 0:v.isShowMoreEntitiesEnabled)||xe||-1!==K.value&&!we?$.length>0?ze(e):Q({value:He(Z.value,0)}):We(e);else{var t=He(Z.value,Z.value+1);Q({value:t})}break;case On.b.ArrowUp:Ie(!0),-1!==K.value||0===Z.value||we?!(null==v?void 0:v.isShowMoreEntitiesEnabled)||xe||0!==K.value&&!we?$.length>0?ze(e):Q({value:He(Z.value,Re-1)}):We(e):Q({value:He(Z.value,0===Z.value?(Re||1)-1:Z.value-1)});break;case On.b.Home:Ie(!0),Q({value:He(Z.value,0)});break;case On.b.End:Ie(!0),Q({value:He(Z.value,Re-1)});break;case On.b.Enter:case On.b.Tab:if(we){We(e);break}if(-1!==K.value){ze(e);break}if(g&&P.current)T(P.current);else{var n=0;p.forEach((function(e){_e&&!1!==e.isScopingEnabled&&(Z.value===n&&(null==S||S(e)),n++),Z.value>=n&&Z.value<n+e.suggestions.length&&T(e.suggestions[Z.value-n]),n+=e.suggestions.length}))}break;default:return!1}return!0},qe=function(e){b||Ge(e.key)};C.useEffect((function(){return null==b||b.setKeyPressHandler(Ge),function(){null==b||b.setKeyPressHandler(void 0)}}));var Ve,Ze=E.containerStyles||{},Qe=Ze.paddingHorizontal,Ye=Ze.paddingTop,Ke=Ze.paddingBottom,Xe=Ze.paddingVertical,Je=Ze.paddingScrollTop,$e=Co(Ze,["paddingHorizontal","paddingTop","paddingBottom","paddingVertical","paddingScrollTop"]),et=function(){return Ee?C.createElement(Tn,{ref:q,theme:le(_),definition:{critiqueType:B,brandingMode:Ne,onlyShowFeedbackButton:y,actions:ae(h),critiquePosition:Le,critiqueSetSize:Pe},strings:c,settings:N,onAction:k,footerContainerStyle:E.footerStyles,setFooterActionIdList:oe,selectedButtonIndex:K.value,onPositionChange:function(e,t){return R[Re]={top:e,bottom:t}},showPreviewTooltipForBranding:!0}):C.createElement(C.Fragment,null)},tt=(null==v?void 0:v.isShowMoreEntitiesEnabled)&&!xe&&!(d||je);return C.createElement(W.a,{style:Object.assign(Object.assign({},w.lb(_)),$e),align:G.b.Stretch,focusable:!0,onKeyDown:qe,handledKeys:[On.b.ArrowDown,On.b.ArrowUp,On.b.Enter,On.b.Tab,On.b.Home,On.b.End],accessibilityRole:de||d||je?void 0:"listbox",accessible:!0,accessibilityLabel:c.inlineSuggestions("suggestionsGroupSearchResultAccessibilityLabel")},C.createElement(re,{scrollDirection:"vertical",style:{paddingHorizontal:Qe,paddingTop:Ye,paddingBottom:Ke,paddingVertical:Xe,paddingScrollTop:Je,borderRadius:$e.borderRadius,height_DO_NOT_USE:Be},theme:{thumbColor:null===(n=null==_?void 0:_.scroll)||void 0===n?void 0:n.thumbColor},onScrollStatusChange:function(e){return ue(e)},scrollTo:be,hidden:de},C.createElement(ee,null,xe&&C.createElement(yo,{theme:_,style:M,htmlId:null==v?void 0:v.searchBoxHtmlId,autofocus:!0,handledKeys:[On.b.ArrowDown,On.b.ArrowUp,On.b.Enter,On.b.Tab,On.b.Home,On.b.End],onKeyDown:qe,placeholder:(null==v?void 0:v.searchBoxPlaceHolder)||"",onChange:function(e){var t;return null===(t=null==v?void 0:v.onSearchChange)||void 0===t?void 0:t.call(v,e)},onClear:function(){var e;Ce(!1),null===(e=null==v?void 0:v.onSearchClear)||void 0===e||e.call(v,!1)}}),C.createElement(Kn,{theme:_,style:M,styles:E,strings:c,results:p,isEmpty:je,isError:d,isShimmerVisible:de,isScrollVisible:ce,enableScopedHeader:_e,itemsCount:Re,itemPositions:R,itemQueryString:u,noSuggestionsButtonRef:H,noSuggestionKeyboardFocus:fe,onGroupSelected:S,onItemSelected:T,onNoSuggestionAction:x,enablePrefixHighlighting:m,isGroupHeaderVisible:!xe,hasSelectionBeenModifiedViaKeyboard:Ae}),tt&&C.createElement(U.a,{automationLabel:"InlineSuggestionMoreEntitiesButton",title:v.showMoreEntitiesButtonLabel,useFullWidth:!0,accessibilityRole:"option",theme:D(_,we),onClick:Ue})),h&&"flag"in h&&h.flag===r.SatoriEntity&&C.createElement(W.a,{style:{paddingHorizontal:w.b}},C.createElement(te.a,{url:(Ve=u,"https://www.bing.com/q="+Ve),text:c.inlineSuggestions("seeMoreHyperLinkLabel"),theme:F(_),style:{fontSize:12,fontWeight:600},inline:!1})),!y&&et()),y&&et())};function wo(e){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ko(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ao(e,t){return(Ao=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Io(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=_o(e);if(t){var i=_o(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return jo(this,n)}}function jo(e,t){if(t&&("object"===wo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _o(e){return(_o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e){e[e.Undo=0]="Undo",e[e.Ignore=1]="Ignore",e[e.Feedback=2]="Feedback"}(xo||(xo={}));var Mo,Do=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ao(e,t)}(r,e);var t,n,o,i=Io(r);function r(){return Oo(this,r),i.apply(this,arguments)}return t=r,(n=[{key:"render",value:function(){return this.renderUndoButton()}},{key:"renderUndoButton",value:function(){var e=this,t={icon:{type:"Undo"},onClick:function(){e.props.onAction&&e.props.onAction(xo.Undo)},style:w.wb(w.h),theme:w.B(w.g),accessibilityLabel:this.props.strings.undoAccessibilityLabel,automationLabel:"undefined",tooltip:this.props.originalText};return C.createElement(U.a,Object.assign({},t))}}])&&ko(t.prototype,n),o&&ko(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(C.Component);!function(e){e[e.Feedback=0]="Feedback",e[e.UndoInsertSummarization=1]="UndoInsertSummarization",e[e.RefreshSummary=2]="RefreshSummary"}(Mo||(Mo={}));var Eo={background:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9",disabled:"#F3F2F1"},title:{resting:"#201F1E",disabled:"#A19F9D"},tooltip:{textColor:"#201F1E",backgroundColor:"#FFFFFF"},tag:{resting:"#201F1E"},icon:{resting:"#757470",disabled:"#CCCCCC"}},Ro={backgroundColor:"transparent",borderColor:"transparent",width:"89px",paddingStart:8,paddingVertical:10,position:"relative"},Bo={color:"#474747",fontWeight:O.a.Normal,fontSize:"12px",fontFamily:"Segoe UI",lineHeight:"16px"};function No(e,t){return function(e,t){switch(t){case Mo.Feedback:return e.summarization("giveFeedback");case Mo.UndoInsertSummarization:return e.summarization("undoInsertSummary");case Mo.RefreshSummary:return e.summarization("refreshSummary");default:return}}(e,t)}function Lo(e){switch(e){case Mo.Feedback:return"Summarization_GiveFeedback";case Mo.UndoInsertSummarization:return"Summarization_Undo";case Mo.RefreshSummary:return"Summarization_Regenerate";default:return"Summarization_"+e}}var Po,Fo,Ho,zo,Uo,Wo,Go=function(e){var t=function(e){switch(e){case Mo.Feedback:return"GiveFeedback";case Mo.UndoInsertSummarization:return"Undo";case Mo.RefreshSummary:return"Repeat"}}(e.action),n=void 0!==t?{type:t}:void 0,o={onClick:function(){e.onAction&&e.onAction(e.action)},tooltip:No(e.strings,e.action),theme:e.theme,accessibilityLabel:No(e.strings,e.action),automationLabel:Lo(e.action),icon:n};return C.createElement(U.a,Object.assign({},o,{key:e.action.toString()}))},qo=function(){return C.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},C.createElement("g",{"clip-path":"url(#clip0_2770_459598)"},C.createElement("path",{d:"M6.19594 0.921875L1.49974 3.63385C0.571684 4.16979 0 5.16009 0 6.23178V11.7682C0 12.8398 0.571643 13.8301 1.49965 14.366L3.76712 15.6756L3.99007 15L8.23734 12.4567L6.49965 11.4531C5.57164 10.9172 5 9.9269 5 8.85525V7.27344L5.46563 6.67953L6.99999 5.49176V2L6.32422 1.01172L5.58517 1.53879C5.75624 1.30668 5.96137 1.09837 6.19594 0.921875Z",fill:"url(#paint0_linear_2770_459598)"}),C.createElement("path",{d:"M6.19594 0.921875L1.49974 3.63385C0.571684 4.16979 0 5.16009 0 6.23178V11.7682C0 12.8398 0.571643 13.8301 1.49965 14.366L3.76712 15.6756L3.99007 15L8.23734 12.4567L6.49965 11.4531C5.57164 10.9172 5 9.9269 5 8.85525V7.27344L5.46563 6.67953L6.99999 5.49176V2L6.32422 1.01172L5.58517 1.53879C5.75624 1.30668 5.96137 1.09837 6.19594 0.921875Z",fill:"url(#paint1_linear_2770_459598)"}),C.createElement("path",{d:"M10.9988 6.61523V8.85594C10.9988 9.92759 10.4271 10.9179 9.49914 11.4538L4.49914 14.3415C3.57076 14.8776 2.42682 14.8776 1.49844 14.3415L1.19531 14.1664C1.29151 14.2387 1.39266 14.3057 1.49844 14.3668L6.49844 17.2545C7.42682 17.7906 8.57076 17.7906 9.49914 17.2545L14.4991 14.3668C15.4271 13.8309 15.9988 12.8406 15.9988 11.769V9.68789L10.9988 6.61523Z",fill:"url(#paint2_radial_2770_459598)"}),C.createElement("path",{d:"M10.9988 6.61523V8.85594C10.9988 9.92759 10.4271 10.9179 9.49914 11.4538L4.49914 14.3415C3.57076 14.8776 2.42682 14.8776 1.49844 14.3415L1.19531 14.1664C1.29151 14.2387 1.39266 14.3057 1.49844 14.3668L6.49844 17.2545C7.42682 17.7906 8.57076 17.7906 9.49914 17.2545L14.4991 14.3668C15.4271 13.8309 15.9988 12.8406 15.9988 11.769V9.68789L10.9988 6.61523Z",fill:"url(#paint3_linear_2770_459598)"}),C.createElement("path",{d:"M6.19524 0.921668L6.49974 0.745824C7.42807 0.209725 8.57193 0.209726 9.50026 0.745825L14.5003 3.63324C15.4283 4.16918 16 5.15948 16 6.23117V11.7675C16 11.7881 15.9998 11.8087 15.9994 11.8293C15.9779 10.7814 15.4105 9.8187 14.5003 9.29307L9.50026 6.40565C8.57193 5.86955 7.42807 5.86954 6.49974 6.40564L5 7.27172V3.31815C5 2.36919 5.44824 1.48405 6.19524 0.921668Z",fill:"url(#paint4_radial_2770_459598)"}),C.createElement("path",{d:"M6.19524 0.921668L6.49974 0.745824C7.42807 0.209725 8.57193 0.209726 9.50026 0.745825L14.5003 3.63324C15.4283 4.16918 16 5.15948 16 6.23117V11.7675C16 11.7881 15.9998 11.8087 15.9994 11.8293C15.9779 10.7814 15.4105 9.8187 14.5003 9.29307L9.50026 6.40565C8.57193 5.86955 7.42807 5.86954 6.49974 6.40564L5 7.27172V3.31815C5 2.36919 5.44824 1.48405 6.19524 0.921668Z",fill:"url(#paint5_linear_2770_459598)"})),C.createElement("defs",null,C.createElement("linearGradient",{id:"paint0_linear_2770_459598",x1:"7.09324",y1:"4.8282",x2:"2.74492",y2:"17.4869",gradientUnits:"userSpaceOnUse"},C.createElement("stop",{"stop-color":"#AE7FE2"}),C.createElement("stop",{offset:"1","stop-color":"#0078D4"})),C.createElement("linearGradient",{id:"paint1_linear_2770_459598",x1:"5.44306",y1:"14.2211",x2:"4.6907",y2:"12.8939",gradientUnits:"userSpaceOnUse"},C.createElement("stop",{offset:"0.9999","stop-color":"#114A8B"}),C.createElement("stop",{offset:"1","stop-color":"#0078D4","stop-opacity":"0"})),C.createElement("radialGradient",{id:"paint2_radial_2770_459598",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(3.14608 13.7577) rotate(-13.0688) scale(12.7772 9.84272)"},C.createElement("stop",{offset:"0.140029","stop-color":"#D59DFF"}),C.createElement("stop",{offset:"1","stop-color":"#5E438F"})),C.createElement("linearGradient",{id:"paint3_linear_2770_459598",x1:"13.826",y1:"8.8471",x2:"13.1058",y2:"10.0024",gradientUnits:"userSpaceOnUse"},C.createElement("stop",{offset:"0.9999","stop-color":"#493474"}),C.createElement("stop",{offset:"1","stop-color":"#8C66BA","stop-opacity":"0"})),C.createElement("radialGradient",{id:"paint4_radial_2770_459598",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(14.5411 9.31795) rotate(-143.083) scale(11.412)"},C.createElement("stop",{"stop-color":"#50E6FF"}),C.createElement("stop",{offset:"1","stop-color":"#436DCD"})),C.createElement("linearGradient",{id:"paint5_linear_2770_459598",x1:"5.0174",y1:"4.56496",x2:"6.18205",y2:"4.56496",gradientUnits:"userSpaceOnUse"},C.createElement("stop",{offset:"0.9999","stop-color":"#114A8B"}),C.createElement("stop",{offset:"1","stop-color":"#0078D4","stop-opacity":"0"})),C.createElement("clipPath",{id:"clip0_2770_459598"},C.createElement("rect",{width:"16",height:"18",fill:"white"}))))},Vo=n(2845),Zo=function(e){var t,n;return C.createElement(W.a,{direction:G.c.LeftToRight,style:function(){var t,n;return null!==(t=e.style)&&void 0!==t?t:{paddingHorizontal:4,paddingVertical:4,backgroundColor:(null!==(n=e.theme)&&void 0!==n?n:Eo).background.resting}}(),align:G.b.Stretch},e.actions.map((function(t){return C.createElement(Go,{action:t,onAction:e.onAction,theme:e.theme,strings:e.strings,key:t.toString()})})),e.isSummarizationCopilotBranded&&C.createElement(Vo.a,{content:e.strings.summarization("raiTooltip"),directionalHint:v.a.bottomCenter,tooltipProps:{calloutProps:{calloutMaxWidth:230,ariaLabel:e.strings.summarization("raiTooltip"),style:Bo}}},C.createElement(W.a,{direction:G.c.LeftToRight,style:Ro,align:G.b.Stretch},C.createElement(qo,null),C.createElement(he.a,{text:e.strings.summarization("copilot"),style:(n=null!==(t=e.theme)&&void 0!==t?t:Eo,{fontWeight:O.a.SemiBold,fontSize:14,fontFamily:"Segoe UI",cssColor:n.title.resting,wrapMode:O.b.NoWrap,lineHeight:20,paddingHorizontal:6}),accessibilityRole:"text"}))))},Qo=n(2803),Yo=n(32);!function(e){e[e.None=0]="None",e[e.Offer=1]="Offer",e[e.See=2]="See",e[e.Try=3]="Try",e[e.Keep=4]="Keep"}(Po||(Po={})),function(e){e[e.SessionStart=0]="SessionStart",e[e.SessionEnd=1]="SessionEnd",e[e.Apply=2]="Apply",e[e.Preview=3]="Preview",e[e.BlurPreview=4]="BlurPreview",e[e.DrillIn=5]="DrillIn",e[e.Search=6]="Search",e[e.Created=7]="Created",e[e.Accepted=8]="Accepted",e[e.Resolved=9]="Resolved",e[e.Presented=10]="Presented",e[e.Modified=11]="Modified",e[e.Deleted=12]="Deleted",e[e.Rejected=13]="Rejected",e[e.Replied=14]="Replied",e[e.Back=15]="Back",e[e.Next=16]="Next",e[e.Previous=17]="Previous",e[e.IgnoreOnce=18]="IgnoreOnce",e[e.IgnoreAll=19]="IgnoreAll",e[e.Options=20]="Options",e[e.Toggle=21]="Toggle",e[e.Report=22]="Report",e[e.LearnMore=23]="LearnMore",e[e.SnoozeSuggestionGroupForSession=25]="SnoozeSuggestionGroupForSession",e[e.SnoozeSuggestionTypeForSession=26]="SnoozeSuggestionTypeForSession",e[e.Delete=27]="Delete",e[e.InvokeOnAddOnFooter=28]="InvokeOnAddOnFooter",e[e.GiveFeedback=29]="GiveFeedback",e[e.OpenEditorPane=30]="OpenEditorPane",e[e.AcceptAll=31]="AcceptAll",e[e.RejectAll=32]="RejectAll",e[e.Undo=33]="Undo",e[e.ShowExplanation=34]="ShowExplanation",e[e.SelectSource=35]="SelectSource",e[e.OpenDesignerPane=36]="OpenDesignerPane",e[e.AddToDictionary=37]="AddToDictionary",e[e.ViewOriginal=38]="ViewOriginal",e[e.SnoozeAll=39]="SnoozeAll",e[e.Retry=40]="Retry",e[e.ClearSearch=41]="ClearSearch",e[e.ShowMore=42]="ShowMore",e[e.ShowHideContext=43]="ShowHideContext",e[e.RevealSuggestions=44]="RevealSuggestions",e[e.UndoInsertSummarization=45]="UndoInsertSummarization",e[e.RefreshSummary=46]="RefreshSummary"}(Fo||(Fo={})),function(e){e[e.Normal=5]="Normal",e[e.Bold=8]="Bold"}(Ho||(Ho={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SpellingSquiggle=3]="SpellingSquiggle",e[e.GrammarSquiggle=4]="GrammarSquiggle",e[e.CritiqueSquiggle=5]="CritiqueSquiggle"}(zo||(zo={})),function(e){e[e.None=0]="None",e[e.Spelling=1]="Spelling",e[e.Grammar=2]="Grammar",e[e.Refinement=3]="Refinement",e[e.Rewrite=4]="Rewrite",e[e.SimilarityChecker=5]="SimilarityChecker",e[e.Modification=6]="Modification",e[e.PremiumEmphasis=7]="PremiumEmphasis",e[e.TrackChangeContent=8]="TrackChangeContent",e[e.TrackChangePlaceholder=9]="TrackChangePlaceholder"}(Uo||(Uo={})),function(e){e[e.None=0]="None",e[e.HideFromReviewCard=1]="HideFromReviewCard",e[e.HideFromReviewCardAndRibbon=2]="HideFromReviewCardAndRibbon"}(Wo||(Wo={}));zo.None;var Ko,Xo,Jo,$o,ei=n(959),ti=function(){function e(){}return e.prototype.loadStrings=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(l.__generator)(this,(function(o){return[2,n(1697)("./".concat(e,"/canvas-contextual.json")).then((function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){return Object(l.__generator)(this,(function(t){return[2,e]}))}))})).catch((function(t){return u.a.sendTraceTag(595727971,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Canvas contextual failed to load resources for locale '".concat(e,"'. Error: ").concat(JSON.stringify({message:t.message,stack:t.stack}),")}")),ei.CanvasContextual}))]}))}))},e}(),ni=n(46),oi={selectors:(Ko={},Ko[ni.l]={outline:"1px solid Highlight",color:"Highlight"},Ko)},ii='"Segoe UI", "Segoe UI Web", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Helvetica Neue, sans-serif',ri=n(422),si=n(2397),ai={themeDarker:"#185abd",themeDark:"#185abd",themeDarkAlt:"#185abd",themePrimary:"#185abd",themeSecondary:"#185abd",themeTertiary:"#185abd",themeLight:"#d2e0f4",themeLighter:"#d2e0f4",themeLighterAlt:"#eff6fc",black:"#242424",neutralDark:"#242424",neutralPrimary:"#242424",neutralPrimaryAlt:"#242424",neutralSecondary:"#424242",neutralSecondaryAlt:"#616161",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#bdbdbd",neutralQuaternary:"#e0e0e0",neutralQuaternaryAlt:"#e0e0e0",neutralLight:"#e0e0e0",neutralLighter:"#e0e0e0",neutralLighterAlt:"#f5f5f5",white:"#ffffff",blue:"#3355ff",purple:"#5a4ebc",greenLight:"#d4edd4",greenDark:"#0b6a0b",orange:"#da3b01",blueDark:"#ebf3fc"},li="red",ci="white",ui="#5A45B6",pi=(Xo=ai,Jo={themeDarker:"#82abf1",themeDark:"#82abf1",themeDarkAlt:"#82abf1",themePrimary:"#82abf1",themeSecondary:"#296FE6",themeTertiary:"#296FE6",themeLight:"#0c2145",themeLighter:"#071225",themeLighterAlt:"#071225",black:"#ffffff",neutralDark:"#ffffff",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#ffffff",neutralSecondary:"#d6d6d6",neutralSecondaryAlt:"#adadad",neutralTertiary:"#858585",neutralTertiaryAlt:"#858585",neutralQuaternary:"#666666",neutralQuaternaryAlt:"#5c5c5c",neutralLight:"#141414",neutralLighter:"#1f1f1f",neutralLighterAlt:"#3d3d3d",white:"#292929",blue:"#92a4f4",purple:"#a79cf1",greenLight:"#094609",greenDark:"#4fd34f",orange:"#ff6a49",blueDark:"#0c2145"},($o={})[si.a.Light]=Object(ri.a)({palette:Xo}),$o[si.a.Dark]=Object(ri.a)({palette:Jo}),$o);function di(){return pi[si.b.getInstance().getThemeMode()]}var gi=function(e){this.isRightToLeft=e,this.themeColors=di().palette,this.overflowButtonStyles={root:{display:"block",minHeight:"18px",padding:"11px",width:"100%",maxWidth:"100%",backgroundColor:"transparent",borderWidth:"0px",borderRadius:"0px"},iconHovered:{fontSize:14,color:this.themeColors.neutralSecondary,margin:"0px"},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootFocused:Object(l.__assign)({},oi),flexContainer:{alignItems:"center"},textContainer:{textAlign:this.isRightToLeft?"right":"left"}},this.overflowMenuStyles={root:{direction:this.isRightToLeft?"rtl":"ltr",borderRadius:"2px",boxShadow:"0px 1px 3px 0px rgba(0,0,0,0.2)",backgroundColor:this.themeColors.white,width:"auto",borderWidth:"0px",outline:"transparent solid 1px",alignContent:"center"},beakCurtain:{borderRadius:"2px"},calloutMain:{backgroundColor:this.themeColors.white,borderRadius:"2px"}},this.iconStyles={root:{fontSize:14,color:this.themeColors.neutralSecondary,margin:"0px"}},this.overflowIconName="More"},hi=function(e){function t(){var t,n=null!==e&&e.apply(this,arguments)||this;return n.overflowButtonStyles={root:{marginTop:"6px",marginBottom:"6px",paddingTop:"6px",paddingBottom:"6px",backgroundColor:n.themeColors.white,borderWidth:"0px",borderRadius:"2px"},icon:{paddingTop:"5px"},iconHovered:{color:n.themeColors.neutralSecondary},rootFocused:Object(l.__assign)({},oi),rootHovered:(t={backgroundColor:n.themeColors.neutralLighterAlt},t[ni.l]={outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"},t),rootPressed:{backgroundColor:n.themeColors.neutralLighter},flexContainer:{outline:"transparent solid 1px"},label:{color:n.themeColors.neutralSecondary}},n}return Object(l.__extends)(t,e),t}(gi),fi=function(){function e(e){this.isRightToLeft=e,this.themeColors=di().palette,this.suggestionStyles={display:"flex",flexDirection:"column"},this.previewHeaderStyles={display:"block",fontSize:10,margin:"4px 7px 4px 7px",paddingLeft:"7px",paddingRight:"7px",borderRadius:"12px",height:"14px",textAlign:this.isRightToLeft?"right":"left",color:this.themeColors.black,fontFamily:ii,fontWeight:600,backgroundColor:this.themeColors.neutralLight},this.suggestionButtonStyles={root:{display:"block",border:"transparent solid 1px",padding:"8px",width:"100%",maxWidth:"100%",backgroundColor:this.themeColors.white},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt,borderColor:this.themeColors.white},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootFocused:Object(l.__assign)({},oi),flexContainer:{alignItems:"center"},textContainer:{margin:"4px 12px 0px 12px",textAlign:this.isRightToLeft?"right":"left"},label:{fontSize:14,height:20,marginBottom:0,color:this.themeColors.neutralDark,fontFamily:ii,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},description:{fontSize:12,height:16,color:this.themeColors.neutralSecondary,fontFamily:ii,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},this.suggestionButtonIconStyles={root:{margin:"4px 0px 0px 0px",fontSize:32,height:32,width:32}},this.footerButtonStyles={root:{backgroundColor:this.themeColors.white,border:"transparent solid 1px",padding:"5px 9px 8px",height:44,borderRadius:0},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt,borderColor:this.themeColors.white},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootFocused:Object(l.__assign)({},oi),textContainer:{margin:"5px 6px",textAlign:this.isRightToLeft?"right":"left"},label:{margin:0,fontSize:14,height:19,color:this.themeColors.neutralSecondaryAlt,fontFamily:ii,lineHeight:"inherit",fontWeight:"normal"},labelDisabled:{color:this.themeColors.neutralTertiaryAlt}},this.footerIconStyles={root:{margin:"0px 8px 0px 0px",fontSize:18,color:this.themeColors.themeDarkAlt}},this.suggestionOverflowMenuStyleProvider=new gi(this.isRightToLeft),this.bottomAlignedOverflowMenuStyleProvider=new hi(this.isRightToLeft),this.suggestionOverflowButtonStyles={root:{padding:"8px",backgroundColor:this.themeColors.white,borderWidth:"0px",minHeight:"18px"},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt},rootDisabled:{backgroundColor:this.themeColors.white},flexContainer:{outline:"transparent solid 1px"},textContainer:{margin:"4px 4px 0px 4px",textAlign:this.isRightToLeft?"right":"left"},label:{fontSize:14,height:"20px",marginBottom:"0px",fontFamily:ii,fontWeight:600,color:this.themeColors.neutralPrimaryAlt},labelDisabled:{color:this.themeColors.neutralQuaternaryAlt}},this.overflowActionButtonRootStyles={margin:"0px",padding:"8px 12px",backgroundColor:this.themeColors.white,borderWidth:"0px",minHeight:"36px",height:"36px"},this.overflowActionButtonStyles={root:Object(l.__assign)(Object(l.__assign)({},this.overflowActionButtonRootStyles),{width:"186px"}),rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootDisabled:{backgroundColor:this.themeColors.white},rootFocused:Object(l.__assign)({},oi),flexContainer:{outline:"transparent solid 1px",alignItems:"center",height:"20px"},label:{fontSize:14,color:this.themeColors.neutralSecondaryAlt,fontFamily:ii,fontWeight:"normal",margin:"0px"},labelDisabled:{color:this.themeColors.neutralTertiaryAlt},textContainer:{textAlign:this.isRightToLeft?"right":"left"}},this.footerOverflowContainerStyles={minWidth:"140px",display:"flex",flexDirection:"column",marginTop:"4px",marginBottom:"4px"},this.onboardingHeadingStyles={color:this.themeColors.neutralSecondary,fontWeight:"bold",margin:"10px 14px 0px 14px"},this.onboardingContentStyles={color:this.themeColors.neutralSecondary,margin:"4px 14px 0px 14px"},this.onboardingLearnMoreStyles={margin:"14px 14px 8px 14px"},this.onboardingLearnMoreLinkStyles={color:this.themeColors.neutralSecondary}}return Object.defineProperty(e.prototype,"suggestionGroupStyles",{get:function(){return{width:"288px",display:"flex",flexDirection:"column",borderRadius:4}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headerStyles",{get:function(){return{display:"flex",justifyContent:"space-between",margin:"14px 16px 8px 16px",fontSize:12,minHeight:16,textAlign:this.isRightToLeft?"right":"left",color:this.themeColors.neutralSecondary,fontFamily:ii}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"footerStyles",{get:function(){return{display:"flex",height:44,margin:"2px 4px"}},enumerable:!1,configurable:!0}),e}(),mi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suggestionButtonStyles={root:{display:"block",border:"none",padding:"10px 16px 9px 16px",width:"100%",maxWidth:"100%",minHeight:"38px",maxHeight:"38px",backgroundColor:t.themeColors.white},rootHovered:{backgroundColor:t.themeColors.neutralLighter,borderColor:t.themeColors.white},flexContainer:{maxHeight:"38px"},textContainer:{textAlign:t.isRightToLeft?"right":"left",margin:"0px 8px 0px 8px"},label:{fontSize:14,height:"19px",color:t.themeColors.neutralDark,margin:"0px",fontFamily:ii,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},t.suggestionButtonIconStyles={root:{margin:"0px",fontSize:16,height:"16px",width:"16px"}},t}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"suggestionGroupStyles",{get:function(){return{minWidth:"186px",display:"flex",flexDirection:"column",borderRadius:"4px",outline:"transparent solid 1px"}},enumerable:!1,configurable:!0}),t.prototype.compoundButtonIconName=function(e){switch(e.type){case"InsertPlaceholderItem":return"ReminderTime";case"MarkCompleteItem":case"MarkCompleteKeepTextItem":case"MarkCompleteRemoveTextItem":return"CheckMark";case"OpenNavPaneItem":return"BulletedList2";default:return}},t}(fi),yi=function(e){function t(){var t,n=null!==e&&e.apply(this,arguments)||this;return n.overflowButtonStyles={root:{marginTop:"6px",marginBottom:"6px",paddingTop:"6px",paddingBottom:"6px",paddingLeft:"8px",paddingRight:"8px",backgroundColor:n.themeColors.white,borderWidth:"0px",borderRadius:"2px"},iconHovered:{color:n.themeColors.neutralSecondary},rootFocused:Object(l.__assign)({},oi),rootHovered:(t={backgroundColor:n.themeColors.neutralLighterAlt},t[ni.l]={outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"},t),rootPressed:{backgroundColor:n.themeColors.neutralLighter},flexContainer:{flexDirection:"row-reverse",outline:"transparent solid 1px"},label:{color:n.themeColors.neutralSecondary}},n.iconStyles={root:{fontSize:10,color:n.themeColors.neutralSecondary,margin:n.isRightToLeft?"0px 4px 0px 0px":"0px 0px 0px 4px",paddingTop:"5px"}},n}return Object(l.__extends)(t,e),t}(gi),bi=function(e){function t(){var t,n,o=null!==e&&e.apply(this,arguments)||this;return o.themeColors=di().palette,o.contextStyles={style:{color:o.themeColors.neutralSecondaryAlt,display:"block",margin:Si.critiqueMargin,fontFamily:ii}},o.disabledFooterIconStyles={root:{fontSize:10,color:o.themeColors.neutralQuaternaryAlt,background:"transparent",padding:"5px 0px 0px 0px",margin:"0px"}},o.footerRightIconName="ChevronRight",o.footerLeftIconName="ChevronLeft",o.footerButtonStyles={root:{marginTop:"6px",marginBottom:"6px",paddingLeft:"8px",paddingRight:"8px",paddingBottom:"6px",paddingTop:"6px",backgroundColor:o.themeColors.white,borderWidth:"0px",minHeight:"18px",selectors:(t={},t[ni.l]={color:"ButtonText",backgroundColor:"Button"},t)},rootHovered:(n={backgroundColor:o.themeColors.neutralLighterAlt},n[ni.l]={outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"},n),rootPressed:{backgroundColor:o.themeColors.neutralLighter},rootDisabled:{backgroundColor:o.themeColors.white},rootFocused:Object(l.__assign)({},oi),flexContainer:{alignItems:"center",outline:"transparent solid 1px"},label:{fontSize:14,color:o.themeColors.neutralSecondaryAlt,fontFamily:ii,fontWeight:"normal",margin:"0px"},labelDisabled:{color:o.themeColors.neutralTertiaryAlt}},o.footerIconStyles={root:{fontSize:10,color:o.themeColors.neutralSecondary,background:"transparent",padding:"5px 0px 0px 0px",margin:"0px"}},o.tooltipHostStyles={root:{display:"inline-block"}},o}return Object(l.__extends)(t,e),t.critiqueMargin=16,t}(fi);function vi(){var e=di().palette,t=e.themeDarker,n=e.themeDark,o=e.themeDarkAlt,i=e.themePrimary,r=e.themeSecondary,s=e.neutralDark,a=e.neutralPrimary,l=e.neutralSecondaryAlt,c=e.neutralTertiary,u=e.neutralTertiaryAlt,p=e.neutralLight,d=e.neutralLighter,g=e.neutralLighterAlt,h=e.black,f=e.white,m=e.blue,y=e.purple,b=e.greenLight,v=e.blueDark;return{background:{resting:f,hover:g,pressed:d,disabled:g},text:{resting:s,disabled:c},tag:{resting:s},altText:{resting:l},icon:{resting:l,disabled:u},grammarText:{resting:m},refinementText:{resting:y},rewriteText:y,suggestionMenuHoverBackground:p,primaryButtonBackground:{resting:r,hover:r,pressed:r,disabled:g},primaryButtonText:{resting:ci,disabled:c},header:a,subheader:l,dialogText:a,iconText:s,contextText:s,errorText:li,border:s,separator:d,focusRing:l,link:o,linkPressed:t,branding:{type:"IconAndTextButton",background:{resting:f,hover:g,pressed:d,disabled:f},icon:{resting:i,disabled:c},title:{resting:i,disabled:c},tooltip:{textColor:s},focusRing:l},addOnFooterBackground:g,addOnHeaderBackground:v,addOnFooterMessage:h,premiumEmphasis:i,addOnAction:i,editorIcon:i,correctionHighlight:b,helpLink:{text:{resting:o,hover:n,focused:o,pressed:t},focusRing:a},badgeBackground:r,badgeText:ci}}var Si=function(e){function t(){var n,o,i=null!==e&&e.apply(this,arguments)||this;return i.defaultTitleStyles={fontSize:14,fontFamily:ii,fontWeight:400},i.citationFeedbackContainerStyles={backgroundColor:i.themeColors.neutralLighterAlt,color:i.themeColors.neutralDark,marginLeft:"8px",marginRight:"8px",marginTop:"8px",marginBottom:"12px"},i.defaultHeaderStyles={display:"block",marginTop:"14px",marginBottom:"8px",marginRight:t.critiqueMargin,marginLeft:t.critiqueMargin,fontSize:12,color:i.themeColors.neutralSecondary,fontFamily:ii},i.largeHeaderStyles={fontSize:22},i.subheaderStyles={marginTop:"9px",color:i.themeColors.neutralPrimary},i.twoLineContextStyles={style:{display:"block",margin:t.critiqueMargin,fontFamily:ii,overflow:"hidden",maxHeight:"38px",fontSize:12,color:i.themeColors.neutralSecondaryAlt}},i.webkitTwoLineContextStyles={style:{display:"-webkit-box",margin:t.critiqueMargin,fontFamily:ii,overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:2,WebkitBoxOrient:"vertical",fontSize:12,color:i.themeColors.neutralSecondaryAlt}},i.suggestionGroupFeedbackStyles={display:"flex",minWidth:"248px",maxWidth:"600px",flexDirection:"column",outline:"transparent solid 1px"},i.suggestionStyles={display:"flex",flexDirection:"column"},i.suggestionTitleStyles={style:Object(l.__assign)(Object(l.__assign)({},i.defaultTitleStyles),{color:i.themeColors.neutralDark,wordBreak:"break-word"})},i.noSuggestionStyles={style:{display:"flex",fontWeight:600,margin:"8px 16px 8px 16px"}},i.disabledSuggestionTitleStyles={style:Object(l.__assign)(Object(l.__assign)({},i.defaultTitleStyles),{color:i.themeColors.neutralTertiary,wordBreak:"break-word"})},i.suggestionDescriptionStyles={style:{fontSize:12,height:"16px",color:i.themeColors.neutralSecondaryAlt,fontFamily:ii}},i.suggestionButtonStyles={root:{display:"block",minHeight:"18px",paddingTop:"9px",paddingBottom:"10px",paddingRight:t.critiqueMargin,paddingLeft:t.critiqueMargin,backgroundColor:"transparent",borderWidth:"0px",borderRadius:"0px",width:"100%",maxWidth:"100%"},rootHovered:{backgroundColor:i.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:i.themeColors.neutralLighter},rootFocused:Object(l.__assign)({},oi),rootDisabled:{backgroundColor:"transparent"},flexContainer:{justifyContent:"flex-start",display:"flex",flexDirection:"column",textAlign:i.isRightToLeft?"right":"left",outline:"transparent solid 1px",alignItems:"initial"}},i.suggestionContainerStyles={display:"flex",flexDirection:"row"},i.hoveredSuggestionContainerStyles=Object(l.__assign)(Object(l.__assign)({},i.suggestionContainerStyles),{backgroundColor:i.themeColors.neutralLighterAlt}),i.disabledSuggestionContainerStyles=Object(l.__assign)(Object(l.__assign)({},i.suggestionContainerStyles),{backgroundColor:i.themeColors.neutralLighterAlt}),i.suggestionChoiceGroupStyles={display:"flex",flexDirection:"row",paddingTop:"6px",paddingBottom:"10px",paddingRight:t.critiqueMargin,paddingLeft:t.critiqueMargin},i.suggestionChoiceItemStyles={display:"flex",paddingBottom:"12px"},i.suggestionShimmerTitleStyles={root:{paddingBottom:"3px"}},i.suggestionShimmerDescriptionStyles={root:{paddingBottom:"3px"}},i.suggestionShimmerFlexStyles={padding:"6px"},i.footerDialogStyles=Object(l.__assign)(Object(l.__assign)({},i.footerStyles),{flexDirection:"column",height:"auto"}),i.footerDialogButtonGroupStyles={display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"44px"},i.footerDefaultActionStyles={display:"flex"},i.similarityHeaderStyles={color:i.themeColors.neutralPrimary,fontSize:10,fontWeight:600,fontFamily:ii},i.similarityHeaderFeedbackStyles=Object(l.__assign)(Object(l.__assign)({},i.similarityHeaderStyles),{fontSize:20,color:i.themeColors.neutralPrimary}),i.similaritySourceTitleStyles={display:"block",marginTop:"6px",marginBottom:"1px",marginRight:t.critiqueMargin,marginLeft:t.critiqueMargin,fontSize:12,fontWeight:600,color:i.themeColors.neutralSecondary,fontFamily:ii},i.similaritySourceUrlStyles={display:"flex",justifyContent:"space-between",height:"16px",marginTop:"1px",marginBottom:"6px",marginRight:t.critiqueMargin,marginLeft:t.critiqueMargin,textAlign:i.isRightToLeft?"right":"left",fontFamily:ii,fontSize:10,color:i.themeColors.neutralSecondaryAlt,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},i.chooseSourceHeaderStyles={color:i.themeColors.neutralSecondaryAlt,fontSize:12,fontFamily:ii},i.chooseSourceSourceSnippetStyles={style:{display:"block",marginLeft:i.isRightToLeft?t.critiqueMargin:"0px",marginTop:t.critiqueMargin,marginBottom:t.critiqueMargin,marginRight:i.isRightToLeft?"0px":t.critiqueMargin,fontFamily:ii,overflow:"hidden",maxHeight:"38px",fontSize:12,color:i.themeColors.neutralSecondaryAlt}},i.webkitChooseSourceSourceSnippetStyles={style:{display:"-webkit-box",marginLeft:i.isRightToLeft?t.critiqueMargin:"0px",marginTop:t.critiqueMargin,marginBottom:t.critiqueMargin,marginRight:i.isRightToLeft?"0px":t.critiqueMargin,fontFamily:ii,overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:2,WebkitBoxOrient:"vertical",fontSize:12,color:i.themeColors.neutralSecondaryAlt}},i.chooseSourceSourceTitleStyles={display:"block",marginBottom:"1px",marginRight:i.isRightToLeft?"0px":t.critiqueMargin,marginLeft:i.isRightToLeft?t.critiqueMargin:"0px",fontSize:14,fontWeight:600,color:i.themeColors.neutralSecondaryAlt,fontFamily:ii},i.chooseSourceSourceUrlStyles={display:"flex",justifyContent:"space-between",height:"16px",marginTop:"1px",marginBottom:"6px",marginRight:i.isRightToLeft?"0px":t.critiqueMargin,marginLeft:i.isRightToLeft?t.critiqueMargin:"0px",textAlign:i.isRightToLeft?"right":"left",fontFamily:ii,fontSize:12,color:i.themeColors.neutralSecondaryAlt,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},i.similaritySourcesStyles={root:{display:"flex",paddingLeft:"12px",paddingRight:"12px",fontSize:"12px",backgroundColor:"transparent",color:i.themeColors.themePrimary,border:"solid 1px transparent",width:"100%",selectors:(n={},n[ni.l]={outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"},n)},rootHovered:{backgroundColor:i.themeColors.neutralLighterAlt,color:i.themeColors.themePrimary,border:"solid 1px transparent"},rootFocused:Object(l.__assign)(Object(l.__assign)({},oi),{border:"solid 1px ".concat(i.themeColors.themeDarkAlt),borderRadius:"0px"})},i.similaritySourceBackButtonStyles={root:{display:"flex",paddingLeft:"3px",paddingRight:"3px",marginBottom:"5px",minWidth:"30px",fontSize:"12px",backgroundColor:"transparent",color:i.themeColors.themePrimary,border:"solid 1px transparent",selectors:(o={},o[ni.l]={outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"},o)},rootHovered:{backgroundColor:i.themeColors.neutralLighterAlt,color:i.themeColors.themePrimary,border:"solid 1px transparent"},rootPressed:{backgroundColor:i.themeColors.neutralLighter,color:i.themeColors.themePrimary,border:"solid 1px transparent"},rootFocused:Object(l.__assign)(Object(l.__assign)({},oi),{border:"solid 1px ".concat(i.themeColors.themeDarkAlt),borderRadius:"0px"})},i.similaritySourceChoiceStyle={display:"flex",textAlign:i.isRightToLeft?"right":"left"},i.footerNextPrevStyles={display:"flex"},i.footerDialogButtonStyle={root:{marginLeft:"6px",marginRight:"6px"}},i.footerDialogDefaultButtonStyle={root:{marginLeft:"6px",marginRight:"6px",backgroundColor:i.themeColors.themeSecondary,color:ci},rootHovered:{backgroundColor:i.themeColors.themeSecondary,color:ci},rootPressed:{backgroundColor:i.themeColors.themeSecondary,color:ci}},i.footerRightIconName="ChevronRight",i.footerLeftIconName="ChevronLeft",i.linkStyle={root:{fontSize:"12px",width:"100%",marginLeft:"8px",marginRight:"8px",marginBottom:"16px",color:i.themeColors.themeDarkAlt,":hover":{color:i.themeColors.themeDark},":focus":{color:i.themeColors.themeDarkAlt},":press":{color:i.themeColors.themeDarker}}},i.privacyStatementStyle={style:{fontSize:"12px",marginLeft:"8px",marginRight:"8px",marginBottom:"2px"}},i.rewriteReportedSuggestionButtonStyles=Object(l.__assign)(Object(l.__assign)({},i.suggestionButtonStyles),{icon:{fontSize:"18px",height:"auto",margin:"4px"},label:{margin:"4px"},flexContainer:{alignItems:"center"}}),i.rewriteCommentsBoxStyles={description:{},errorMessage:{},field:{backgroundColor:i.themeColors.white,color:i.themeColors.neutralPrimary,border:"1px solid ".concat(i.themeColors.neutralSecondaryAlt),"::placeholder":{color:i.themeColors.neutralSecondaryAlt},":disabled":{backgroundColor:i.themeColors.neutralLighterAlt,borderColor:i.themeColors.neutralLighterAlt,"::placeholder":{color:i.themeColors.neutralTertiaryAlt}}},fieldGroup:{border:"0px",outline:"0px"},icon:{},prefix:{},root:{marginTop:"7px",marginBottom:"16px",marginLeft:"8px",marginRight:"8px"},subComponentStyles:{label:{}},suffix:{},wrapper:{},revealButton:{},revealIcon:{},revealSpan:{}},i.includeCitedContentOptionStyles=Object(l.__assign)(Object(l.__assign)({},i.rewriteCommentsBoxStyles),{root:{marginTop:"24px",marginBottom:"8px",marginLeft:"8px",marginRight:"8px"}}),i.citationSourceLineStyles={display:"flex",justifyContent:"space-between",height:"16px",marginTop:"1px",marginBottom:"6px",marginRight:t.critiqueMargin,marginLeft:t.critiqueMargin,textAlign:i.isRightToLeft?"right":"left",fontFamily:ii},i.poweredByBingStyles={marginTop:"1px",marginLeft:i.isRightToLeft?"0px":"8px",marginRight:i.isRightToLeft?"8px":"0px",fontSize:10,color:i.themeColors.neutralSecondaryAlt,whiteSpace:"nowrap"},i.citationLinkStyles={display:"block",fontSize:12,fontWeight:600,color:i.themeColors.neutralSecondary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},i.citationLinkFeedbackStyles=Object(l.__assign)(Object(l.__assign)({},i.citationLinkStyles),{fontWeight:0,color:i.themeColors.neutralDark}),i.citationDropdownIconName="ChevronDown",i.citationCheckmarkIconName="CheckMark",i.citationCheckmarkIconStyles={root:{fontSize:16,color:i.themeColors.neutralSecondary,background:"transparent",padding:"0px",margin:i.isRightToLeft?"0px 0px 0px 8px":"0px 8px 0px 0px"}},i.citationOverflowActionButtonStyles=Object(l.__assign)(Object(l.__assign)({},i.overflowActionButtonStyles),{root:Object(l.__assign)(Object(l.__assign)({},i.overflowActionButtonRootStyles),{width:"140px"})}),i.citationNoIconOverflowActionButtonStyles=Object(l.__assign)(Object(l.__assign)({},i.overflowActionButtonStyles),{root:Object(l.__assign)(Object(l.__assign)({},i.overflowActionButtonRootStyles),{padding:i.isRightToLeft?"8px 36px 8px 12px":"8px 12px 8px 36px",width:"140px"})}),i.citationFooterOverflowMenuStyleProvider=new yi(i.isRightToLeft),i.deleteIconName="Delete",i.deleteIconStyles={root:{paddingRight:"8px",fontSize:16,color:i.themeColors.neutralDark}},i.copyCitationIconName="Copy",i.copyCitationIconStyles={root:{paddingRight:"8px",fontSize:16,color:i.themeColors.neutralDark}},i.inTextCitationIconName="Add",i.inTextCitationIconStyles={root:{paddingRight:"8px",fontSize:16,color:i.themeColors.neutralDark}},i.feedbackIconStyles={root:{fontSize:16,color:i.themeColors.neutralSecondaryAlt,margin:"0px"}},i.feedbackIconProps={iconName:"Feedback",styles:i.feedbackIconStyles},i}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"headerStyles",{get:function(){return this.defaultHeaderStyles},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suggestionGroupStyles",{get:function(){return{backgroundColor:this.themeColors.white,display:"flex",minWidth:"248px",maxWidth:"380px",flexDirection:"column",outline:"transparent solid 1px"}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerStyles",{get:function(){return{margin:"2px 8px 2px 8px",display:"flex",justifyContent:"space-between",height:"44px"}},enumerable:!1,configurable:!0}),t}(bi),xi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suggestionTitleStyles={style:Object(l.__assign)(Object(l.__assign)({},t.defaultTitleStyles),{marginBottom:"0px",color:t.themeColors.neutralDark})},t}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"suggestionGroupStyles",{get:function(){return{backgroundColor:this.themeColors.white,display:"flex",minWidth:"370px",maxWidth:"380px",flexDirection:"column",outline:"transparent solid 1px"}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerStyles",{get:function(){return Object(l.__assign)(Object(l.__assign)({},this.defaultHeaderStyles),{display:"flex",justifyContent:"space-between"})},enumerable:!1,configurable:!0}),t}(Si),Ci=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"headerStyles",{get:function(){return Object(l.__assign)(Object(l.__assign)({},this.defaultHeaderStyles),{display:"flex",justifyContent:"space-between"})},enumerable:!1,configurable:!0}),t}(Si);var Ti,wi,Oi,ki,Ai=function(e){this.styleProviderOptions=e,this.themeColors=di().palette,this.contextualMenuStyles={root:{direction:this.styleProviderOptions.isRightToLeft?"rtl":"ltr",borderRadius:4,boxShadow:"0px 8px 24px 0px rgba(0, 0, 0, 0.1), 0px 8px 16px 0px rgba(0, 0, 0, 0.12)",backgroundColor:this.themeColors.white,width:"auto",borderWidth:0,outline:"transparent solid 1px",marginLeft:this.styleProviderOptions.alignInnerTextWithAnchor?this.styleProviderOptions.isRightToLeft?Si.critiqueMargin:-Si.critiqueMargin:void 0,marginTop:4,marginBottom:4},beakCurtain:{borderRadius:4},calloutMain:{borderRadius:4}},this.focusTrapStyles={backgroundColor:this.themeColors.white},this.styleProviderOptions.allowContentOverflow?this.contextualMenuStyles.calloutMain=Object(l.__assign)(Object(l.__assign)({},this.contextualMenuStyles.calloutMain),{overflow:"inherit"}):this.focusTrapStyles=Object(l.__assign)(Object(l.__assign)({},this.focusTrapStyles),{overflow:"hidden"}),this.styleProviderOptions.customScrollbarUsed&&(this.contextualMenuStyles.calloutMain=Object(l.__assign)(Object(l.__assign)({},this.contextualMenuStyles.calloutMain),{overflow:"hidden"}))},Ii=n(810),ji={":after":{outline:"none !important",border:"1px solid ".concat(di().palette.neutralPrimaryAlt," !important"),borderRadius:"4px",boxShadow:"none !important"},":hover":{border:"none !important"}},_i={selectors:(Ti={},Ti[ni.l]={background:"Highlight",boxShadow:"none !important"},Ti)},Mi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.overflowButtonStyles={root:Object(l.__assign)({minHeight:"32px",minWidth:"32px",height:"32px",width:"32px",border:"none",margin:"0px",padding:"0px",backgroundColor:"transparent"},ji),rootHovered:{borderRadius:"2px",backgroundColor:t.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:t.themeColors.neutralLighter},flexContainer:{width:"32px",outline:"transparent solid 1px"},rootFocused:Object(l.__assign)({},oi)},t}return Object(l.__extends)(t,e),t}(gi),Di=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contextStyles={style:{display:"block",margin:"2px 16px 8px 16px",fontSize:12,minHeight:16,color:t.themeColors.neutralSecondaryAlt,fontFamily:ii}},t.bottomAlignedOverflowMenuStyleProvider=new Mi(!1),t.footerActionsStyleWrapper={display:"flex"},t.footerActionsLeftStyle={marginTop:"6px",marginLeft:t.isRightToLeft?"0px":"6px",marginRight:t.isRightToLeft?"6px":"0px",display:"flex"},t.footerActionsRightStyle={display:"flex",marginLeft:t.isRightToLeft?"6px":"auto",marginRight:t.isRightToLeft?"auto":"6px",marginTop:"6px",alignItems:"stretch"},t.footerButtonStyles={root:Object(l.__assign)({minHeight:"32px",height:"32px",width:"32px",border:"none",padding:"0px",backgroundColor:"transparent"},ji),rootHovered:{backgroundColor:t.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:t.themeColors.neutralLighter},flexContainer:{width:"32px",outline:"transparent solid 1px",minHeight:"32px"},rootDisabled:{backgroundColor:t.themeColors.white},rootFocused:Object(l.__assign)({},oi),label:{fontSize:14,color:t.themeColors.neutralSecondaryAlt,fontFamily:ii,fontWeight:"normal",margin:"0px"},labelDisabled:{color:t.themeColors.neutralTertiaryAlt}},t.footerIconStyles={root:{fontSize:16,color:t.themeColors.neutralSecondary,background:"transparent",padding:"8px 0px 0px 0px",margin:"0px"}},t.disabledFooterIconStyles={root:{fontSize:16,color:t.themeColors.neutralQuaternaryAlt,background:"transparent",padding:"8px 0px 0px 0px",margin:"0px"}},t.actionButtonStyles={root:Object(l.__assign)({minHeight:"32px",height:"32px",width:"32px",border:"none",margin:"0px",padding:"0px",backgroundColor:"transparent"},ji),rootHovered:{borderRadius:"2px",backgroundColor:t.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:t.themeColors.neutralLighter},flexContainer:{width:"16px",height:"16px",outline:"transparent solid 1px"},rootFocused:Object(l.__assign)({},oi),rootDisabled:{backgroundColor:"transparent"},menuIcon:{height:"16px",width:"16px"}},t.nextButtonStyles={root:{minHeight:"24px",height:"24px",minWidth:"45px",border:"none",margin:"4px 2px 0px 10px",padding:"0px",background:t.themeColors.themePrimary,borderRadius:"4px"},rootHovered:{backgroundColor:t.themeColors.themeDarkAlt},rootPressed:{backgroundColor:t.themeColors.themeDarker},label:{fontSize:"12px",fontWeight:"normal",lineHeight:"16px"},rootFocused:Object(l.__assign)({},_i)},t.viewOriginalButtonFocusSelectorStyle={":after":{outline:"none !important",border:"none !important",boxShadow:"0 0 0 1px ".concat(t.themeColors.themePrimary," inset !important"),inset:"0px !important"},":hover":{border:"none !important"}},t.viewOriginalButtonStyles=Object(Ii.c)((function(e){return void 0===e&&(e=!1),e?{root:Object(l.__assign)({minHeight:"32px",height:"32px",width:"32px",margin:"0px",padding:"0px",border:"none",backgroundColor:t.themeColors.themeLight},t.viewOriginalButtonFocusSelectorStyle),rootHovered:{backgroundColor:t.themeColors.themeLighter},rootPressed:{backgroundColor:t.themeColors.themeLighter},flexContainer:{width:"16px",height:"16px",outline:"transparent solid 1px"},rootFocused:Object(l.__assign)({},oi),menuIcon:{height:"16px",width:"16px"}}:t.actionButtonStyles})),t.defaultIconStyles={root:{background:"transparent",fontSize:"14px",height:"14px",width:"14px",margin:"0px",padding:"1px"}},t.acceptIconStyles=Object(Ii.c)((function(e){return void 0===e&&(e=!1),{root:Object(l.__assign)(Object(l.__assign)({},t.defaultIconStyles.root),{color:e?t.themeColors.neutralTertiaryAlt:t.themeColors.greenDark})}})),t.rejectIconStyles=Object(Ii.c)((function(e){return void 0===e&&(e=!1),{root:Object(l.__assign)(Object(l.__assign)({},t.defaultIconStyles.root),{color:e?t.themeColors.neutralTertiaryAlt:t.themeColors.orange})}})),t.viewOriginalIconStyles=Object(Ii.c)((function(e){return void 0===e&&(e=!1),{root:{background:"transparent",fontSize:"16px",height:"16px",width:"16px",margin:"0px",color:e?t.themeColors.themePrimary:void 0}}})),t.giveFeedbackIconStyles={root:{background:"transparent",fontSize:"16px",height:"16px",width:"16px",margin:"0px",color:t.themeColors.neutralSecondaryAlt}},t.overflowActionIconStyles={root:{background:"transparent",fontSize:"16px",height:"16px",width:"16px"}},t.overflowActionButtonStyles={root:{margin:"0px 4px",padding:"8px 8px 8px 2px",backgroundColor:"transparent",borderWidth:"0px",minHeight:"36px",height:"36px",minWidth:"130px",width:"max-content"},rootHovered:{backgroundColor:t.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:t.themeColors.neutralLighter},rootDisabled:{backgroundColor:t.themeColors.white},rootFocused:Object(l.__assign)({},oi),flexContainer:{outline:"transparent solid 1px",alignItems:"center",height:"20px"},label:{fontSize:14,color:t.themeColors.neutralSecondaryAlt,fontFamily:ii,fontWeight:"normal",margin:"0px"},labelDisabled:{color:t.themeColors.neutralTertiaryAlt},textContainer:{textAlign:t.isRightToLeft?"right":"left"}},t.openPaneIconStyle={root:{fontSize:"18px",background:"transparent",padding:"0px 6px",margin:"0px"}},t.openPaneButtonStyle={root:Object(l.__assign)({minHeight:"32px",height:"32px",minWidth:"32px",border:"none",margin:"0px",padding:"0px",backgroundColor:"transparent"},ji),rootHovered:{borderRadius:"2px",backgroundColor:t.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:t.themeColors.neutralLighter},flexContainer:{minWidth:"32px",alignItems:"center",outline:"transparent solid 1px"},rootFocused:Object(l.__assign)({},oi),label:{fontWeight:600,fontFamily:ii,fontSize:"14px",lineHeight:"20px",color:t.themeColors.themePrimary,whiteSpace:"normal",overflowWrap:"anywhere",padding:"6px 0px",paddingRight:"6px",margin:"0px"}},t.externalWrapperStyles={display:"flex",flexDirection:"column",height:"auto",width:"max-content"},t.promptStyles={display:"flex",flexDirection:"column",padding:"8px 16px 12px 16px",textAlign:"left",color:t.themeColors.neutralPrimary,fontFamily:ii,fontSize:12,minHeight:16,backgroundColor:t.themeColors.themeLighterAlt,width:"".concat(t.cardWidth-32,"px")},t.promptIconStyleWrapper={width:"20px",marginRight:"6px"},t.promptIconStyle={root:{background:"transparent",width:"20px",height:"20px"}},t.promptBodyIconStyle={root:{background:"transparent",width:"14px",height:"14px"}},t.promptStyleWrapper={display:"flex"},t.promptTextStyleWrapper={display:"flex",flexDirection:"column"},t.promptTextHeadingStyle={fontWeight:600,paddingBottom:"4px"},t.promptTextBodyStyle={fontWeight:400},t}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"cardWidth",{get:function(){return 250},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suggestionGroupStyles",{get:function(){return{width:"".concat(this.cardWidth,"px"),display:"flex",flexDirection:"column",borderRadius:4}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerStyles",{get:function(){return{display:"flex",flexDirection:"column",padding:"2px 0px 0px",position:"static",width:"".concat(this.cardWidth-32,"px"),minHeight:"17px",flex:"none",order:0,flexGrow:0,margin:"10px 16px 6px 16px",fontFamily:ii,fontSize:"12px",lineHeight:"16px",color:this.themeColors.neutralPrimaryAlt}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerStyles",{get:function(){return{display:"flex",flexDirection:"column",width:"".concat(this.cardWidth,"px"),height:"44px"}},enumerable:!1,configurable:!0}),t}(bi),Ei={":after":{outline:"none !important",border:"1px solid ".concat(di().palette.neutralPrimaryAlt," !important"),borderRadius:"4px",boxShadow:"none !important"},":hover":{border:"none !important"}},Ri={":after":{border:"4px solid ".concat(di().palette.neutralLighter," !important"),borderRadius:"4px",outline:"none !important",boxShadow:"none",marginTop:"1px"},":hover":{outline:"none !important"}},Bi={selectors:(wi={},wi[ni.l]={color:"windowText !important",":hover":{color:"Highlight !important",border:"none !important",outline:"none !important"},":focus-within":{color:"Highlight !important"},":active":{color:"Highlight !important"}},wi)},Ni={selectors:(Oi={},Oi[ni.l]={border:"4px solid windowText !important",borderRadius:"2px",background:"transparent",color:"windowText !important",":hover":{background:"transparent",outline:"none !important"},":after":{outline:"none !important",border:"1px solid Highlight !important",borderRadius:"4px",boxShadow:"none !important",margin:"0px"},":focus-within":{background:"transparent !important",color:"Highlight !important"},":active":{background:"transparent"}},Oi)},Li={selectors:(ki={},ki[ni.l]={color:"windowText !important",":hover":{background:"transparent",border:"none !important",outline:"none !important",color:"Highlight !important"},":after":{outline:"none !important",background:"transparent !important",border:"1px solid Highlight !important",borderRadius:"4px",boxShadow:"none !important"},":focus-within":{background:"transparent !important",color:"Highlight !important"}},ki)},Pi={":active":{backgroundColor:ai.neutralLighter},":hover":{backgroundColor:ai.neutralLighterAlt}},Fi={position:"absolute",height:"100%",width:"calc(100% - 12px)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},Hi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.triageButtonStyles={root:{display:"block",margin:"4px 16px 4px 16px",height:"32px",maxHeight:"32px",padding:"0px",border:"none",backgroundColor:ai.white},rootHovered:{backgroundColor:ai.neutralLighterAlt},rootExpanded:{backgroundColor:ai.neutralLighterAlt},rootPressed:{backgroundColor:ai.neutralLighter},rootDisabled:{backgroundColor:ai.neutralLighterAlt},flexContainer:{justifyContent:t.isRightToLeft?"right":"left",border:"1px solid ".concat(t.themeColors.neutralQuaternary),boxSizing:"border-box",borderRadius:"4px"},textContainer:{flexGrow:0,textAlign:t.isRightToLeft?"right":"left",width:"186px",height:"32px"},menuIcon:{fontSize:14,height:"14px",width:"14px",padding:"1px",margin:"8px",color:ai.neutralSecondaryAlt},rootFocused:Object(l.__assign)({},oi)},t.triageCalloutStyles={root:{width:"206px",marginLeft:t.isRightToLeft?"0px":"6px",marginRight:t.isRightToLeft?"6px":"0px",marginTop:"32px",background:t.themeColors.white,borderRadius:"4px !important",boxShadow:"0px 14px 28.8px rgba(0, 0, 0, 0.24), 0px 0px 8px rgba(0, 0, 0, 0.2)",selectors:{"div::-webkit-scrollbar":{width:"7px",height:"107px",minWidth:"7px !important"},"div::-webkit-scrollbar-thumb":{borderRadius:"100px",border:"1px solid ".concat(t.themeColors.white," !important"),background:t.themeColors.neutralQuaternaryAlt}}},calloutMain:{borderRadius:"4px !important",maxHeight:"236px !important"}},t.triageContextualMenuStyles={root:{borderRadius:"4px",minWidth:"161px"}},t.triageContextualMenuSelectedItemStyles={item:{position:"static",height:"40px",backgroundColor:ai.white,selectors:Pi},label:Object(l.__assign)({},Bi),root:Object(l.__assign)(Object(l.__assign)({display:"flex",textAlign:t.isRightToLeft?"right":"left",border:"4px solid ".concat(ai.neutralLighter," !important"),height:"40px"},Ri),Ni)},t.triageContextualMenuItemStyles={item:{height:"40px",backgroundColor:ai.white,selectors:Pi},label:Object(l.__assign)({},Bi),root:Object(l.__assign)(Object(l.__assign)({display:"flex",textAlign:t.isRightToLeft?"right":"left",borderRadius:"4px",backgroundColor:"transparent"},Ei),Li),divider:{margin:"1px 0"}},t.menuItemSpanStyles=Object(l.__assign)(Object(l.__assign)({},Fi),{marginLeft:t.isRightToLeft?"0px":"6px",marginRight:t.isRightToLeft?"6px":"0px"}),t.menuSelectedItemSpanStyles=Object(l.__assign)(Object(l.__assign)({},Fi),{marginLeft:t.isRightToLeft?"0px":"4px",marginRight:t.isRightToLeft?"4px":"0px"}),t}return Object(l.__extends)(t,e),t}(Di),zi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.columnCount=1,t.showMoreLinkClassName=Object(ni.db)({font:"Segoe UI",fontSize:"12",color:t.themeColors.themePrimary,lineHeight:16}),t.imageSuggestionGalleryClassName=Object(ni.db)({padding:"6px 14px 0px 14px"}),t.galleryButtonRootStyles=Object(Ii.c)((function(e){return{height:54,width:180,marginBottom:6,marginLeft:e?0:6,marginRight:0,padding:0,border:"2px solid transparent !important"}})),t.galleryButtonStyles=Object(Ii.c)((function(e){return{root:t.galleryButtonRootStyles(0===e),rootFocused:{border:"2px solid ".concat(t.themeColors.black," !important")},rootHovered:{border:"2px solid ".concat(t.themeColors.themePrimary," !important")},rootPressed:{border:"4px solid ".concat(t.themeColors.themePrimary," !important")},rootChecked:{border:"4px solid ".concat(t.themeColors.themePrimary," !important")}}})),t.externalWrapperStyles={display:"flex",flexDirection:"row",width:"auto"},t.promptStyles={display:"flex",flexDirection:"column",padding:"16px 12px",textAlign:"left",width:"130px",color:t.themeColors.neutralPrimary,fontFamily:ii,fontSize:12,minHeight:16,backgroundColor:t.themeColors.themeLighterAlt},t.promptIconStyleWrapper={width:"20px",marginBottom:"6px"},t.promptStyleWrapper={display:"flex",flexDirection:"column"},t}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"cardWidth",{get:function(){return 0===this.columnCount?250:212+186*(this.columnCount-1)},enumerable:!1,configurable:!0}),t}(Di),Ui=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.defaultHeaderStyles={display:"block",marginTop:"8px",marginRight:"16px",marginLeft:"16px",height:"32px",fontSize:14,color:t.themeColors.neutralDark,fontFamily:ii,fontWeight:600},t.suggestionButtonStyles={root:{display:"block",border:"none",padding:"0px 0px 0px 0px",width:"183px",maxWidth:"183px",minHeight:"32px",maxHeight:"32px",backgroundColor:t.themeColors.white,marginLeft:"16px",marginRight:"8px"},rootHovered:{backgroundColor:t.themeColors.white,borderColor:t.themeColors.white},rootPressed:{backgroundColor:t.themeColors.white,borderColor:t.themeColors.white},flexContainer:{height:"32px",justifyContent:t.isRightToLeft?"right":"left",boxSizing:"border-box"},textContainer:{flexGrow:0,padding:"6px 0px 6px 0px",textAlign:t.isRightToLeft?"right":"left",width:"183px",height:"32px"},label:{fontSize:14,color:t.themeColors.neutralDark,fontFamily:ii,margin:"0px",fontWeight:400,whiteSpace:"nowrap"}},t}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"headerStyles",{get:function(){return this.defaultHeaderStyles},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suggestionGroupStyles",{get:function(){return{minWidth:"199px",height:"241px",display:"flex",flexDirection:"column",outline:"#E0E0E0 solid 1px",outlineOffset:"-4px",borderRadius:"4px",backgroundColor:this.themeColors.white}},enumerable:!1,configurable:!0}),t.prototype.compoundButtonIconName=function(e){},t}(fi);var Wi,Gi,qi=n(1205),Vi=function(e){function t(n){var o=e.call(this,n)||this;return o.state={menuOpen:!1,disabled:!1},o.buttonId="OverflowMenu"+t.ids,t.ids+=1,o.onButtonClick=o.onButtonClick.bind(o),o.closeMenu=o.closeMenu.bind(o),o.buttonRef=C.createRef(),o}return Object(l.__extends)(t,e),t.prototype.enableButton=function(){this.setState((function(){return{disabled:!1}}))},t.prototype.disabledButton=function(){this.setState((function(){return{disabled:!0}}))},t.prototype.focusButton=function(){this.buttonRef.current&&this.buttonRef.current.focus()},t.prototype.openMenu=function(){this.setState((function(){return{menuOpen:!0}})),this.props.onShow&&this.props.onShow()},t.prototype.closeMenu=function(e){this.setState((function(){return{menuOpen:!1}})),e&&this.focusButton(),this.props.onDismiss&&this.props.onDismiss()},t.prototype.render=function(){return this.state.menuOpen?C.createElement("div",null,this.renderOverflowMenuButton(),this.renderOverflowMenuCallout()):C.createElement("div",null,this.renderOverflowMenuButton())},t.prototype.onButtonClick=function(){this.state.menuOpen?this.closeMenu(!0):this.openMenu()},t.prototype.renderOverflowMenuButton=function(){var e={text:this.props.text?this.props.text:void 0,id:this.buttonId,ariaLabel:this.props.ariaLabel?this.props.ariaLabel:this.props.resources.OverflowButtonAccessibilityLabel,role:this.props.role?this.props.role:"button",styles:this.props.styleProvider.overflowButtonStyles,onClick:this.onButtonClick,iconProps:{iconName:this.props.iconName?this.props.iconName:this.props.styleProvider.overflowIconName,styles:this.props.styleProvider.iconStyles},componentRef:this.buttonRef,disabled:this.state.disabled};return C.createElement(qi.a,Object(l.__assign)({},e,{"data-automation-id":"OverflowMenu_Automation_".concat(t.ids)}))},t.prototype.renderOverflowMenuCallout=function(){var e={role:"menu",styles:this.props.styleProvider.overflowMenuStyles,target:"#"+this.buttonId,isBeakVisible:!1,directionalHint:this.props.styleProvider.isRightToLeft?v.a.bottomRightEdge:v.a.bottomLeftEdge,onDismiss:this.closeMenu,setInitialFocus:!0},t={isCircularNavigation:!0,handleTabKey:V.b.all};return C.createElement(b.a,Object(l.__assign)({},e),C.createElement(q.a,Object(l.__assign)({},t),this.props.children))},t.ids=0,t}(C.PureComponent),Zi=function(e){function t(t){var n=e.call(this,t)||this;return n.suggestionsFocusZoneRef=C.createRef(),n.onAction=n.onAction.bind(n),n.restoreFocus=n.restoreFocus.bind(n),n.footerOpenOverflowMenuRef=C.createRef(),n}return Object(l.__extends)(t,e),t.prototype.render=function(){var e=this.renderHeader();return C.createElement("div",Object(l.__assign)({style:this.props.styleProvider.suggestionGroupStyles},this.rootAttributes(!!e)),e,this.renderSuggestions(),this.renderFooter())},t.prototype.maximumSuggestions=function(){return 3},t.prototype.headerId=function(){return t.createHeaderId(this.props.group.type)},t.createHeaderId=function(e){return"header-".concat(e)},t.prototype.rootAttributes=function(e){var t={};return this.props.parameters.definition&&this.props.parameters.definition.suggestionGroups&&this.props.parameters.definition.suggestionGroups.length>1&&(t.role="listitem"),e?t["aria-labelledby"]=this.headerId():t["aria-label"]=this.headerText(),t},t.prototype.renderHeader=function(){return C.createElement("div",{id:this.headerId(),role:"note","aria-label":this.headerText(),style:this.props.styleProvider.headerStyles},this.headerText())},t.prototype.getSuggestionsToRender=function(){return this.props.group.suggestions},t.prototype.getSuggestionsRole=function(){return this.maximumSuggestions()>1?"list":"group"},t.prototype.getSuggestionItemRole=function(){return this.maximumSuggestions()>1?"listitem":null},t.prototype.renderSuggestions=function(){var e=this,t=this.getSuggestionsToRender();if(t){var n=this.maximumSuggestions(),o=t.filter((function(e){return!!e})).map((function(t,n){return e.renderSuggestionItem(t,n)})).filter((function(e,t){return!!e&&t<n}));if(o.length>0){var i=this.getSuggestionsRole();return C.createElement(q.a,{componentRef:this.suggestionsFocusZoneRef},C.createElement("div",{style:this.props.styleProvider.suggestionStyles,role:i,"aria-label":this.suggestionListDescription()},o))}}return null},t.prototype.renderSuggestionItem=function(e,t){var n=this.renderSuggestion(e,t);if(!n)return null;var o=this.getSuggestionItemRole();return C.createElement("div",{key:e.id,role:o||void 0},n)},t.prototype.renderSuggestion=function(e,t){return null},t.prototype.renderFooter=function(){return null},t.prototype.renderProactivePrompt=function(){return null},t.prototype.renderOverflowActions=function(){return[]},t.prototype.renderOverflowMenu=function(){var e=this.renderOverflowActions();if(0===e.length)return null;var t={styleProvider:this.props.styleProvider.bottomAlignedOverflowMenuStyleProvider,resources:this.props.resources,ref:this.footerOpenOverflowMenuRef};return C.createElement(Vi,Object(l.__assign)({},t,{key:"overflow-menu"}),C.createElement("div",{style:this.props.styleProvider.footerOverflowContainerStyles},e))},t.prototype.renderPreviewPillbox=function(){return C.createElement("div",{style:this.props.styleProvider.previewHeaderStyles},this.props.resources.PreviewHeaderLabel)},t.prototype.restoreFocus=function(){this.props.hostElementRef&&this.props.hostElementRef.current&&this.props.hostElementRef.current.focus()},t.prototype.shouldDismissOnAction=function(e){return![Fo.GiveFeedback,Fo.Report,Fo.ShowExplanation,Fo.Toggle,Fo.AddToDictionary].includes(e)},t.prototype.executeDefaultAction=function(){var e=this.getSuggestionsToRender();if(e){var t=e[0];t&&this.onAction(null,Fo.Apply,Po.Try,this.props.group,t,void 0)}},t.prototype.executeActionFromString=function(e){var t,n=e.toLowerCase(),o={actionSourceId:i.VoiceDictationPhrase};switch(n){case"ignore":case"ignore once":return void this.onAction(null,Fo.IgnoreOnce,Po.Try,this.props.group,void 0,void 0,void 0,o);case"ignore all":return void this.onAction(null,Fo.IgnoreAll,Po.Try,this.props.group,void 0,void 0,void 0,o);default:var r=this.getSuggestionsToRender(),s=null==r?void 0:r.find((function(e){var t;return(null===(t=null==e?void 0:e.title)||void 0===t?void 0:t.toLowerCase())===n}));return s||"SharedRepeatedWordCritique"!==(null===(t=this.props.group)||void 0===t?void 0:t.type)||1!==(null==r?void 0:r.length)||"delete"!==n||(s=r[0]),void(s?this.onAction(null,Fo.Apply,Po.Try,this.props.group,s,void 0,void 0,o):this.props.dismiss?this.props.dismiss(o):u.a.sendTraceTag(526513923,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unknown command and unable to dismiss"))}},t.prototype.invokeBadgeId=function(e){},t.prototype.onAction=function(e,t,n,o,r,s,a,l){if(this.props.parameters.onAction){var c=this.props.parameters.definition,u=r?r.telemetryData:null,p=o.telemetryData,d={actionType:t,engagement:n,objectName:o?o.type:"Unknown",objectId:o?o.id:"Unknown",objectFulfillment:s||(r?r.type:"Unknown"),contentReference:{range:o?o.contentDescriptor:void 0,contentId:c?c.contentId:void 0,contentHash:c?c.contentHash:void 0},data:u||p,suggestionGroup:o,suggestion:r,descriptorData:a},g=null!=l?l:{actionSourceId:i.Unknown};this.props.dependencies.actionLogger.logAction(d,g),this.props.parameters.onAction(d)&&(e&&(e.preventDefault(),e.stopPropagation()),this.shouldDismissOnAction(t)&&this.props.dismiss(g))}},t}(C.Component),Qi=n(736),Yi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.headerText=function(){return""},t.prototype.maximumSuggestions=function(){return 5},t.prototype.suggestionListDescription=function(){return""},t.prototype.renderHeader=function(){return null},t.prototype.renderSuggestion=function(e,t){var n=this,o={allowDisabledFocus:!0,text:e.title,styles:this.props.styleProvider.suggestionButtonStyles,iconProps:{iconName:this.props.styleProvider.compoundButtonIconName(e),styles:this.props.styleProvider.suggestionButtonIconStyles},onClick:function(t){return n.onAction(t,Fo.Apply,Po.Try,n.props.group,e)}};return C.createElement(Qi.a,Object(l.__assign)({key:e.id},o))},t.id="ActionSet",t}(Zi),Ki=n(1204),Xi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.renderBold=function(e,t){switch(t){case Ho.Normal:e.fontWeight="normal";break;case Ho.Bold:e.fontWeight="bold"}},t.prototype.renderHidden=function(e){e.position="absolute",e.height="1px",e.width="1px",e.overflow="hidden",e.clip="rect(1px 1px 1px 1px)"},t.prototype.renderUnderline=function(e,t){var n=!1;switch(t){case zo.Single:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmxpbmU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibGluZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICAgICAgICA8ZyBpZD0iVGlsZS1Db3B5IiBzdHJva2U9IiMwMDAwMDAiPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwLjUgTDUsMC41IiBpZD0iTGluZS0yLUNvcHktMTAiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",n=!0;break;case zo.Double:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmRvdWJsZV9saW5lPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImRvdWJsZV9saW5lIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2UtbGluZWNhcD0icm91bmQiPgogICAgICAgIDxnIGlkPSJUaWxlLUNvcHkiIHN0cm9rZT0iIzAwMDAwMCI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAuNSBMNSwwLjUiIGlkPSJMaW5lLTItQ29weS0xMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwyLjUgTDUsMi41IiBpZD0iTGluZS0yLUNvcHktMTEiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",n=!0;break;case zo.SpellingSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjRweCIgdmlld0JveD0iMCAwIDUgNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTYuMiAoODE2NzIpIC0gaHR0cHM6Ly9za2V0Y2guY29tIC0tPgogICAgPHRpdGxlPnNwZWxsaW5nX3NxdWlnZ2xlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkZsYWdzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTAxMC4wMDAwMDAsIC0yOTYuMDAwMDAwKSIgaWQ9InNwZWxsaW5nX3NxdWlnZ2xlIj4KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAxMC4wMDAwMDAsIDI5Ni4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDMgQzEuMjUsMyAxLjI1LDEgMi41LDEgQzMuNzUsMSAzLjc1LDMgNSwzIiBpZD0iUGF0aCIgc3Ryb2tlPSIjRUIwMDAwIiBzdHJva2Utd2lkdGg9IjEiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+')",n=!0;break;case zo.GrammarSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmdyYW1tYXJfZG91YmxlX2xpbmU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZ3JhbW1hcl9kb3VibGVfbGluZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICAgICAgICA8ZyBpZD0iR3JhbW1hci1UaWxlLUNvcHkiIHN0cm9rZT0iIzMzNTVGRiI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAuNSBMNSwwLjUiIGlkPSJMaW5lLTItQ29weS0xMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwyLjUgTDUsMi41IiBpZD0iTGluZS0yLUNvcHktMTEiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",n=!0;break;case zo.CritiqueSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTBweCIgaGVpZ2h0PSIycHgiIHZpZXdCb3g9IjAgMCAxMCAyIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA1Ny4xICg4MzA4OCkgLSBodHRwczovL3NrZXRjaC5jb20gLS0+CiAgICA8dGl0bGU+aW5zaWdodF90ZXh0dXJlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Imluc2lnaHRfdGV4dHVyZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ikdyb3VwLTItQ29weSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMCIgaGVpZ2h0PSIyIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xLDEgTDUsMSIgaWQ9IkxpbmUtNCIgc3Ryb2tlPSIjNzE2MEU4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+')",n=!0}n&&(e.backgroundRepeat="repeat-x",e.backgroundPosition="bottom left",e.borderBottom="solid 1px transparent")},t.prototype.getRunText=function(e,t){var n=this.props.text.length,o=Math.max(0,Math.min(n,e)),i=Math.max(0,Math.min(n,t));return o<i?this.props.text.substr(o,i-o):(u.a.sendTraceTag(595683267,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Canvas contextual trying to fetch invalid substring (start '".concat(e,"', end '").concat(t,"', length '").concat(n,"')")),"")},t.prototype.renderTextRun=function(e,t,n){var o={};return n&&(this.renderBold(o,n.fontWeight),this.renderUnderline(o,n.underlineType),n.hidden&&this.renderHidden(o),n.italic&&(o.fontStyle="italic"),n.cssColor&&(o.color=n.cssColor)),C.createElement("span",{key:e,style:o},this.getRunText(e,t))},t.prototype.render=function(){var e=[];if(this.props.formatting&&this.props.formatting.length>0)for(var t=0,n=0,o=this.props.text.length;t<o;)if(n<this.props.formatting.length){var i=this.props.formatting[n];if(i){var r=i.start,s=r+i.length,a=Math.max(t,Math.min(o,r)),l=Math.max(t,Math.min(o,s));if(a>=l){n+=1;continue}t<a&&(e.push(this.renderTextRun(t,a)),t=a),t<l&&(e.push(this.renderTextRun(t,l,i)),t=l)}n+=1}else t<o&&(e.push(this.renderTextRun(t,o)),t=o);return C.createElement("span",{"aria-label":this.props.ariaLabel,role:this.props.ariaRole,"aria-level":this.props.ariaLevel,style:this.props.style?this.props.style.style:{}},0!==e.length?e:this.props.text)},t}(C.PureComponent),Ji=n(836),$i=n(2850),er=n(577),tr=n(394),nr=n(862),or=function(e){function t(t){var n=e.call(this,t)||this;return n.dismissFooterOverflow=n.dismissFooterOverflow.bind(n),n.onShowHideContext=n.onShowHideContext.bind(n),n}return Object(l.__extends)(t,e),t.prototype.suggestionListDescription=function(){return this.props.resources.CritiqueSuggestionListDefaultAccessibilityLabel},t.prototype.shouldHideActionButton=function(e,t){return!this.hasActionType(e,t)},t.prototype.getActionButtonIconProps=function(e){},t.prototype.shouldDisableActionButton=function(e,t){return!1},t.prototype.getActionButtonToRender=function(e,t){return C.createElement(Qi.a,Object(l.__assign)({},t))},t.prototype.renderActionButton=function(e,t,n,o,i,r){var s=this;if(this.shouldHideActionButton(e,n))return null;var a=void 0;if(!i&&!(a=this.getActionString(e)))return null;var c={iconProps:this.getActionButtonIconProps(e),text:a,styles:t,disabled:this.shouldDisableActionButton(e,n),role:o||"button",onClick:function(t){return s.onAction(t,e,Po.Try,s.props.group,n,void 0,r)}};return this.getActionButtonToRender(e,Object(l.__assign)(Object(l.__assign)({},c),{key:e.toString(),"data-automation-id":"CritiqueActionButton_".concat(a,"_").concat(this.props.group.id)}))},t.prototype.showingSnippet=function(){return!(!this.props.group.snippet||!this.state.showingContext)},t.prototype.renderShowHideContextButton=function(){var e=this;if(!this.allowShowHideContextButton())return null;var t=this.state.showingContext?this.props.resources.HideContextButtonText:this.props.resources.ShowContextButtonText,n={iconProps:this.getActionButtonIconProps(Fo.ShowHideContext),text:t,styles:this.props.styleProvider.overflowActionButtonStyles,onClick:function(t){return e.onShowHideContext(t)}};return C.createElement(Qi.a,Object(l.__assign)({role:"menuitem",key:"ShowHideContext"},n,{"data-automation-id":"CritiqueActionButton_".concat(t,"_").concat(this.props.group.id)}))},t.prototype.renderSnippet=function(e,t,n){return this.showingSnippet()?C.createElement(Xi,{text:null!=t?t:this.props.group.snippet,ariaLabel:null!=t?t:this.props.group.snippet,ariaRole:"heading",ariaLevel:2,formatting:null!=n?n:this.props.group.snippetFormatting,style:null!=e?e:this.props.styleProvider.contextStyles}):null},t.prototype.renderNextPrev=function(){return this.props.parameters.definition.setSize>0?[this.renderNavigationButton(!1),this.renderNavigationButton(!0)]:[]},t.prototype.renderHeader=function(){return C.createElement("div",null,e.prototype.renderHeader.call(this),this.renderSnippet())},t.prototype.renderNavigationButton=function(e){var t=this,n=this.props.isRightToLeft?!e:e,o=n?Fo.Next:Fo.Previous,i=e?this.props.parameters.definition.positionInSet>=this.props.parameters.definition.setSize-1:this.props.parameters.definition.positionInSet<=0,r={disabled:i,styles:this.props.styleProvider.footerButtonStyles,iconProps:{iconName:n?this.props.styleProvider.footerRightIconName:this.props.styleProvider.footerLeftIconName,styles:i?this.props.styleProvider.disabledFooterIconStyles:this.props.styleProvider.footerIconStyles},ariaLabel:this.getAriaLabel(o),onClick:function(e){return t.onAction(e,o,Po.Try,t.props.group,void 0,void 0)}},s="CritiqueNavButton_".concat(n?"Right":"Left","_").concat(this.props.group.id);return C.createElement(Qi.a,Object(l.__assign)({key:o.toString()},r,{"data-automation-id":s}))},t.prototype.getAriaLabel=function(e){switch(e){case Fo.Next:return this.props.resources.NextButtonText;case Fo.Previous:return this.props.resources.PreviousButtonText}},t.prototype.getActionString=function(e){switch(e){case Fo.IgnoreOnce:return this.props.resources.IgnoreButtonText;case Fo.IgnoreAll:return this.props.resources.IgnoreAllButtonText;case Fo.Options:return this.props.resources.OptionsButtonText;case Fo.Deleted:return this.props.resources.DeleteButtonText;case Fo.LearnMore:return this.getActionStringForLearnMore();case Fo.Accepted:return this.props.resources.AcceptButton;case Fo.Rejected:return this.props.resources.RejectButton;case Fo.AcceptAll:return this.props.resources.AcceptAllButton;case Fo.RejectAll:return this.props.resources.RejectAllButton;case Fo.Next:return this.props.resources.NextButton;case Fo.Previous:return this.props.resources.PreviousButton;case Fo.Undo:return this.props.resources.UndoButton;case Fo.GiveFeedback:return this.props.resources.GiveFeedbackButtonText}},t.prototype.hasActionType=function(e,t){return t?!!t.supportedActions&&-1!==t.supportedActions.findIndex((function(t){return t===e})):!!this.props.group.supportedActions&&-1!==this.props.group.supportedActions.findIndex((function(t){return t===e}))},t.prototype.getActionStringForLearnMore=function(){return this.props.resources.LearnMoreButtonText},t.prototype.onAction=function(t,n,o,i,r,s,a){this.dismissFooterOverflow(),e.prototype.onAction.call(this,t,n,o,i,r,s,a)},t.prototype.onShowHideContext=function(e){this.setState((function(e){return{showingContext:!e.showingContext}})),this.onAction(e,Fo.Toggle,Po.Try,this.props.group,void 0,"Context")},t.prototype.allowShowHideContextButton=function(){return!(!this.props.group.snippet||!this.props.group.snippetFormatting)},t.prototype.dismissFooterOverflow=function(){this.footerOpenOverflowMenuRef.current&&this.footerOpenOverflowMenuRef.current.closeMenu(!0)},t}(Zi),ir=n(2902);!function(e){e[e.Default=0]="Default",e[e.ReportRewriteSuggestions=1]="ReportRewriteSuggestions",e[e.DisplayingFeedbackOptions=2]="DisplayingFeedbackOptions",e[e.Confirmation=3]="Confirmation"}(Wi||(Wi={})),function(e){e[e.Default=0]="Default",e[e.DisplayingFeedbackOptions=1]="DisplayingFeedbackOptions",e[e.Confirmation=2]="Confirmation",e[e.DisplayingSimilarSources=3]="DisplayingSimilarSources"}(Gi||(Gi={}));var rr=function(e){function t(t){var n,o,i=this;return(i=e.call(this,t)||this).privacyStatementLabel=Object(c.h)("IsO365CommercialHost")?i.props.resources.SuggestionFeedbackCommercialPrivacyNotice:i.props.resources.SuggestionFeedbackConsumerPrivacyNotice,i.handleSuggestionFocus=i.handleSuggestionFocus.bind(i),i.handleSuggestionBlur=i.handleSuggestionBlur.bind(i),i.onRewriteSelectFeedbackSuggestion=i.onRewriteSelectFeedbackSuggestion.bind(i),i.onRewriteSelectFeedbackOption=i.onRewriteSelectFeedbackOption.bind(i),i.onShowHideDescription=i.onShowHideDescription.bind(i),i.onShowHideSimilarText=i.onShowHideSimilarText.bind(i),i.onRewriteReportSuggestionCancel=i.onRewriteReportSuggestionCancel.bind(i),i.onRewriteReportSuggestionNext=i.onRewriteReportSuggestionNext.bind(i),i.onRewriteReportSuggestionSend=i.onRewriteReportSuggestionSend.bind(i),i.onRewriteReportSuggestionDone=i.onRewriteReportSuggestionDone.bind(i),i.onSimilaritySelectFeedbackOption=i.onSimilaritySelectFeedbackOption.bind(i),i.onSimilarityFeedbackCancel=i.onSimilarityFeedbackCancel.bind(i),i.onSimilarityFeedbackSubmit=i.onSimilarityFeedbackSubmit.bind(i),i.onSimilarityFeedbackOkay=i.onSimilarityFeedbackOkay.bind(i),i.onSimilarityShareCitedContentCheckbox=i.onSimilarityShareCitedContentCheckbox.bind(i),i.onSimilaritySourceDone=i.onSimilaritySourceDone.bind(i),i.onSimilaritySourceCancel=i.onSimilaritySourceCancel.bind(i),i.rewriteReportSuggestionsChoiceGroupRef=C.createRef(),i.rewriteFeedbackOptionChoiceGroupRef=C.createRef(),i.rewriteCommentsTextBoxRef=C.createRef(),i.rewriteReportDoneButtonRef=C.createRef(),i.similarityCommentsTextBoxRef=C.createRef(),i.similarityFeedbackOptionChoiceGroupRef=C.createRef(),i.similarityFeedbackReportOkayButtonRef=C.createRef(),i.similaritySourceOptionRef=Array.from({length:null!==(o=null===(n=i.props.group.sources)||void 0===n?void 0:n.length)&&void 0!==o?o:0},(function(){return C.createRef()})),i.state={showingContext:i.props.parameters.showSnippet,showingDescription:i.props.parameters.showDescription,hoveredSuggestionId:null,focusedSuggestionId:null,openSuggestionOverflowId:null,rewriteState:Wi.Default,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1,selectedCitationStyle:i.props.parameters.citationStyle?i.props.parameters.citationStyle:"MLA",similarityChoiceGroupSelected:!1,similarityState:Gi.Default,similarityShareCitedContentCheckbox:!1,showingSimilarText:!1,similaritySelectedSource:"0"},i}return Object(l.__extends)(t,e),t.prototype.componentDidUpdate=function(e,n){if(this.props.group.type===t.neuralRewrite&&n.rewriteState!==this.state.rewriteState)switch(this.state.rewriteState){case Wi.ReportRewriteSuggestions:this.rewriteReportSuggestionsChoiceGroupRef.current&&this.rewriteReportSuggestionsChoiceGroupRef.current.focus();break;case Wi.DisplayingFeedbackOptions:this.rewriteFeedbackOptionChoiceGroupRef.current&&this.rewriteFeedbackOptionChoiceGroupRef.current.focus();break;case Wi.Confirmation:this.rewriteReportDoneButtonRef.current&&this.rewriteReportDoneButtonRef.current.focus();break;default:this.suggestionsFocusZoneRef.current&&this.suggestionsFocusZoneRef.current.focus()}else if(this.props.group.type===t.similarity&&n.similarityState!==this.state.similarityState)switch(this.state.similarityState){case Gi.DisplayingFeedbackOptions:this.similarityFeedbackOptionChoiceGroupRef.current&&this.similarityFeedbackOptionChoiceGroupRef.current.focus();break;case Gi.Confirmation:this.similarityFeedbackReportOkayButtonRef.current&&this.similarityFeedbackReportOkayButtonRef.current.focus();break;default:this.suggestionsFocusZoneRef.current&&this.suggestionsFocusZoneRef.current.focus()}},t.prototype.hasNoSuggestions=function(){return!this.props.group.suggestions||0===this.props.group.suggestions.length},t.prototype.render=function(){return this.props.group.type===t.neuralRewrite&&this.hasNoSuggestions()?this.renderEmptyNeuralRewrite():this.isSimilarityFeedbackCard()?this.renderFeedbackCard():e.prototype.render.call(this)},t.prototype.isSimilarityFeedbackCard=function(){return this.props.group.type===t.similarity&&this.state.similarityState===Gi.DisplayingFeedbackOptions},t.prototype.renderFeedbackCard=function(){var e=this.renderHeader();return C.createElement("div",Object(l.__assign)({style:this.props.styleProvider.suggestionGroupFeedbackStyles},this.rootAttributes(!!e),{role:"alert"}),e,this.renderSuggestions(),this.renderFooter(),this.renderProactivePrompt())},t.prototype.headerText=function(){switch(this.props.group.type){case t.neuralRewrite:if(this.props.group.isContentPending)return this.props.resources.SuggestionsGroupLoadingSuggestionsText;switch(this.state.rewriteState){case Wi.Default:return this.props.resources.NeuralRewriteHeaderLabel;case Wi.ReportRewriteSuggestions:return this.props.resources.NeuralRewriteFeedbackDialogChooseSuggestionTitle;case Wi.DisplayingFeedbackOptions:return this.props.resources.NeuralRewriteFeedbackDialogChooseOptionTitle;case Wi.Confirmation:return this.props.resources.NeuralRewriteFeedbackConfirmationDialogTitle;default:return"<unknown>"}case t.similarity:switch(this.state.similarityState){case Gi.Default:return this.props.resources.PlagiarismHeaderLabel;case Gi.DisplayingFeedbackOptions:return this.props.resources.ProvideFeedbackHeaderText;case Gi.Confirmation:return this.props.resources.NeuralRewriteFeedbackConfirmationDialogTitle;case Gi.DisplayingSimilarSources:return this.props.resources.SelectSourceHeaderText;default:return"<unknown>"}case t.sensitiveContent:return this.props.resources.SensitiveContentHeaderLabel;default:return this.props.group.title?this.props.group.title:"<unknown>"}},t.prototype.showingSnippet=function(){switch(this.props.group.type){case t.similarity:return this.state.similarityState===Gi.DisplayingSimilarSources||!(!this.props.group.snippet||!this.state.showingSimilarText);default:return(this.props.group.type!==t.neuralRewrite||this.state.rewriteState===Wi.Default)&&e.prototype.showingSnippet.call(this)}},t.prototype.renderSnippet=function(n,o,i){var r=this.props.group.type===t.similarity&&this.state.similarityState===Gi.DisplayingSimilarSources,s=this.props.group.type===t.similarity?window.CSS&&window.CSS.supports&&window.CSS.supports("display","-webkit-box")?this.props.styleProvider.webkitTwoLineContextStyles:this.props.styleProvider.twoLineContextStyles:this.props.styleProvider.contextStyles;return r&&(s=window.CSS&&window.CSS.supports&&window.CSS.supports("display","-webkit-box")?this.props.styleProvider.webkitChooseSourceSourceSnippetStyles:this.props.styleProvider.chooseSourceSourceSnippetStyles),e.prototype.renderSnippet.call(this,s,o,i)},t.prototype.renderSnippetForFeedback=function(){var e;return C.createElement("div",{style:this.props.styleProvider.citationFeedbackContainerStyles},null===(e=this.props.group.snippet)||void 0===e?void 0:e.substr(0,t.characterLimitForUserTextToSend))},t.prototype.renderNeuralRewriteHeader=function(){var e=this.state.rewriteState===Wi.Confirmation,t=this.state.rewriteState===Wi.DisplayingFeedbackOptions,n=this.state.rewriteState===Wi.Confirmation,o=this.state.rewriteState===Wi.Default;return C.createElement("div",{style:this.props.styleProvider.headerStyles},C.createElement("div",null,C.createElement("div",{id:this.headerId(),role:"heading",style:e?this.props.styleProvider.largeHeaderStyles:void 0},this.headerText()),t||n?C.createElement("div",{style:this.props.styleProvider.subheaderStyles},t?this.props.resources.NeuralRewriteFeedbackDialogDescription:this.props.resources.NeuralRewriteFeedbackConfirmationDialogSubTitle):null),o?this.renderPreviewPillbox():null)},t.prototype.getSimilarityHeaderLabel=function(){return this.props.resources.SimilarityFormatHeaderLabel.replace("{0}",this.props.resources.PlagiarismHeaderLabel).replace("{1}",this.props.resources.PoweredByBingHeaderLabel)},t.prototype.getSimilarityHeaderStyle=function(){return this.state.similarityState===Gi.Confirmation?this.props.styleProvider.largeHeaderStyles:this.state.similarityState===Gi.DisplayingSimilarSources?this.props.styleProvider.chooseSourceHeaderStyles:this.state.similarityState===Gi.DisplayingFeedbackOptions?this.props.styleProvider.similarityHeaderFeedbackStyles:this.props.styleProvider.similarityHeaderStyles},t.prototype.renderSimilarityHeader=function(){var e=this.state.similarityState===Gi.DisplayingFeedbackOptions,t=this.state.similarityState===Gi.Confirmation,n=this.state.similarityState===Gi.Default;return C.createElement("div",{style:this.props.styleProvider.headerStyles},C.createElement("div",{"aria-live":"polite"},C.createElement("div",{id:this.headerId(),role:"heading","aria-level":1,style:this.getSimilarityHeaderStyle()},this.headerText()),e||t?C.createElement("div",{style:this.props.styleProvider.subheaderStyles},e?this.props.resources.SimilarityFeedbackDialogChooseOptionTitle:this.props.resources.NeuralRewriteFeedbackConfirmationDialogSubTitle):null),n?this.renderPreviewPillbox():null)},t.prototype.renderSimilaritySourceTitle=function(e){var t=this.state.similarityState===Gi.DisplayingSimilarSources;return C.createElement("span",{style:t?this.props.styleProvider.chooseSourceSourceTitleStyles:this.props.styleProvider.similaritySourceTitleStyles},e)},t.prototype.getDomainFromUrl=function(e){if(e)try{return new URL(e).hostname}catch(e){}return e},t.prototype.renderCitationToBeShared=function(){return C.createElement("div",{style:this.props.styleProvider.citationFeedbackContainerStyles},C.createElement("div",{style:this.props.styleProvider.citationLinkFeedbackStyles},this.getDomainFromUrl(this.props.group.url)))},t.prototype.renderSimilaritySourceUrl=function(e,t){var n=this.state.similarityState===Gi.DisplayingSimilarSources;return C.createElement("div",{style:n?this.props.styleProvider.chooseSourceSourceUrlStyles:this.props.styleProvider.similaritySourceUrlStyles},this.getDomainFromUrl(e),t?C.createElement("div",{style:this.props.styleProvider.poweredByBingStyles,"aria-hidden":"true"},this.props.resources.PoweredByBingHeaderLabel):null)},t.prototype.renderHeader=function(){switch(this.props.group.type){case t.similarity:switch(this.state.similarityState){case Gi.DisplayingFeedbackOptions:case Gi.Confirmation:case Gi.DisplayingSimilarSources:return this.renderSimilarityHeader();case Gi.Default:return C.createElement("div",{"aria-label":this.getSimilarityHeaderLabel(),role:"group"},this.renderSimilarityHeader(),this.renderSnippet(void 0,this.props.group.snippet,this.props.group.snippetFormatting),this.renderSimilaritySourceTitle(this.props.group.description),this.renderSimilaritySourceUrl(this.props.group.url,!0))}case t.neuralRewrite:return C.createElement("div",null,this.renderNeuralRewriteHeader(),this.renderSnippet(void 0,this.props.group.snippet,this.props.group.snippetFormatting));default:return e.prototype.renderHeader.call(this)}},t.prototype.suggestionListDescription=function(){switch(this.props.group.type){case t.neuralRewrite:case t.similarity:return this.headerText();default:return e.prototype.suggestionListDescription.call(this)}},t.prototype.handleSuggestionFocus=function(e){this.setState((function(){return{focusedSuggestionId:e}}))},t.prototype.handleSuggestionBlur=function(){this.setState((function(){return{focusedSuggestionId:null}}))},t.prototype.handleSuggestionHoverOn=function(e){this.setState((function(){return{hoveredSuggestionId:e}}))},t.prototype.handleSuggestionHoverOff=function(e){this.state.hoveredSuggestionId===e&&this.setState((function(){return{hoveredSuggestionId:null}}))},t.prototype.isSuggestionAlreadyReported=function(e){return this.props.group.type===t.neuralRewrite&&t.neuralRewriteReportedSuggestions.indexOf(e)>=0},t.prototype.isSuggestionDisabled=function(e){return this.props.group.type===t.neuralRewrite&&t.neuralRewriteDisabledSuggestions.indexOf(e)>=0},t.prototype.showingDescription=function(){return(this.props.group.type!==t.neuralRewrite||this.state.rewriteState===Wi.Default)&&this.state.showingDescription},t.prototype.getSuggestionStyle=function(e){return e?this.props.styleProvider.disabledSuggestionTitleStyles:this.props.styleProvider.suggestionTitleStyles},t.prototype.getSuggestionContainerStyle=function(e,t){return e?this.props.styleProvider.disabledSuggestionContainerStyles:t?this.props.styleProvider.hoveredSuggestionContainerStyles:this.props.styleProvider.suggestionContainerStyles},t.prototype.suggestionHasActionType=function(e,t){return!!e.supportedActions&&-1!==e.supportedActions.findIndex((function(e){return e===t}))},t.prototype.suggestionGroupHasActionType=function(e,t){return!!e.supportedActions&&-1!==e.supportedActions.findIndex((function(e){return e===t}))},t.prototype.getSuggestionsRole=function(){return"menu"},t.prototype.getSuggestionItemRole=function(){return null},t.prototype.getSuggestionTitle=function(e){if(this.props.group.type===t.similarity)switch(e.id){case t.similarityBlockQuoteSuggestion:return this.props.resources.BlockQuotationButtonText;case t.similarityFullCitationSuggestions:return this.props.resources.FullCitationButtonText;case t.similarityInlineCitationSuggestions:return this.props.resources.InlineCitationButtonText}return this.props.group.type===t.sensitiveContent?this.props.resources.RemoveButtonText:e.title?e.title:void 0},t.prototype.renderSuggestionIcon=function(e){switch(this.props.group.type){case t.sensitiveContent:return C.createElement(Ji.a,{iconName:this.props.styleProvider.deleteIconName,styles:this.props.styleProvider.deleteIconStyles});case t.similarity:switch(e.id){case t.similarityFullCitationSuggestions:return C.createElement(Ji.a,{iconName:this.props.styleProvider.copyCitationIconName,styles:this.props.styleProvider.copyCitationIconStyles});case t.similarityInlineCitationSuggestions:return C.createElement(Ji.a,{iconName:this.props.styleProvider.inTextCitationIconName,styles:this.props.styleProvider.inTextCitationIconStyles});case t.similarityBlockQuoteSuggestion:default:return null}default:return null}},t.prototype.renderSuggestionContents=function(e,t,n){return C.createElement("div",null,this.renderSuggestionIcon(e),C.createElement(Xi,{text:t,formatting:n?void 0:e.titleFormatting,style:this.getSuggestionStyle(n)}),e.description&&this.showingDescription()?C.createElement("div",null,C.createElement(Xi,{text:e.description,style:this.props.styleProvider.suggestionDescriptionStyles})):null)},t.prototype.getObjectFulfillment=function(e){if(this.props.group.type===t.similarity&&null!==e.id)return e.id},t.prototype.getDescriptorData=function(e){if(this.props.group.type===t.similarity)return e?parseInt(e,10):parseInt(this.state.similaritySelectedSource,10)},t.prototype.renderSuggestion=function(e,n){var o=this,i=this.getSuggestionTitle(e);if(!i)return null;if(this.props.group.isContentPending)return C.createElement("div",{style:this.props.styleProvider.suggestionShimmerFlexStyles,"aria-hidden":!0},C.createElement(dn.a,{styles:this.props.styleProvider.suggestionShimmerTitleStyles}));var r=!this.suggestionHasActionType(e,Fo.Apply)||this.isSuggestionDisabled(i),s=this.maximumSuggestions();this.props.group.suggestions&&this.props.group.suggestions.length<s&&(s=this.props.group.suggestions.length);var a={allowDisabledFocus:!0,disabled:r,role:"menuitem","aria-posinset":n+1,"aria-setsize":s,onClick:function(t){return o.onAction(t,Fo.Apply,Po.Try,o.props.group,e,o.getObjectFulfillment(e),o.getDescriptorData())}};if(this.props.group.type===t.neuralRewrite&&r){var c=Object(l.__assign)(Object(l.__assign)({},a),{styles:this.props.styleProvider.rewriteReportedSuggestionButtonStyles,text:this.props.resources.NeuralRewriteReportedSuggestionTitle,iconProps:{iconName:"Info"}});return C.createElement("div",{style:this.getSuggestionContainerStyle(!1,!1)},C.createElement(Qi.a,Object(l.__assign)({},c)))}var u=Object(l.__assign)(Object(l.__assign)({},a),{styles:this.props.styleProvider.suggestionButtonStyles,onFocus:function(){return o.handleSuggestionFocus(e.id)}}),p=this.state.hoveredSuggestionId===e.id,d=this.state.openSuggestionOverflowId===e.id,g={onMouseEnter:function(){return o.handleSuggestionHoverOn(e.id)},onMouseLeave:function(){return o.handleSuggestionHoverOff(e.id)},onFocus:function(){return o.handleSuggestionFocus(e.id)},onBlur:this.handleSuggestionBlur,style:this.getSuggestionContainerStyle(r,p||d)};return C.createElement("div",Object(l.__assign)({},g),C.createElement(Qi.a,Object(l.__assign)({},u,{"data-automation-id":"CritiqueSuggestionButton_".concat(e.id)}),this.renderSuggestionContents(e,i,r)))},t.prototype.renderEmptyNeuralRewrite=function(){return C.createElement("div",{style:this.props.styleProvider.suggestionGroupStyles},C.createElement("div",Object(l.__assign)({style:this.props.styleProvider.suggestionStyles,role:"group"},this.rootAttributes(!1)),C.createElement("div",{id:"header-emptyNeuralRewrite",role:"heading","aria-level":1,style:this.props.styleProvider.headerStyles},this.props.resources.CritiqueNoSuggestionsHeader),C.createElement("div",{style:this.props.styleProvider.suggestionContainerStyles},C.createElement(Xi,{ariaLabel:this.props.resources.NeuralRewriteNoSuggestionsText,ariaRole:"document",text:this.props.group.errorMessage?this.props.group.errorMessage:this.props.resources.NeuralRewriteNoSuggestionsText,style:this.props.styleProvider.noSuggestionStyles})),this.renderCloseButtonFooter()))},t.prototype.onRewriteSelectFeedbackSuggestion=function(e,t){t&&this.setState({rewriteReportedSuggestionId:t.key,rewriteChoiceGroupSelected:!0})},t.prototype.renderNeuralRewriteReportSuggestions=function(){var e=this,t=this.getSuggestionsToRender();if(!t)return null;var n=this.maximumSuggestions(),o=t.filter((function(t){return!!t&&!!t.id&&!!e.getSuggestionTitle(t)})).map((function(t){var n=t,o=n.id,i=e.getSuggestionTitle(n);if(e.isSuggestionDisabled(i))return{key:o,disabled:!0,text:e.props.resources.NeuralRewriteReportedSuggestionTitle,onRenderField:function(t,n){return C.createElement("div",{style:e.props.styleProvider.suggestionChoiceItemStyles},n(t))}};var r=e.isSuggestionAlreadyReported(i);return{key:o,disabled:r,text:"",ariaLabel:i,onRenderField:function(t,o){return C.createElement("div",{style:e.props.styleProvider.suggestionChoiceItemStyles},o(t),e.renderSuggestionContents(n,i,r))}}})).filter((function(e,t){return t<n}));return 0===o.length?null:C.createElement($i.a,{"aria-label":this.props.resources.NeuralRewriteFeedbackDialogChooseSuggestionTitle,onChange:this.onRewriteSelectFeedbackSuggestion,style:this.props.styleProvider.suggestionChoiceGroupStyles,options:o,componentRef:this.rewriteReportSuggestionsChoiceGroupRef})},t.prototype.onRewriteSelectFeedbackOption=function(e,t){t&&this.setState({rewriteChoiceGroupSelected:!0})},t.prototype.renderNeuralRewriteFeedbackOptions=function(){return C.createElement($i.a,{"aria-label":this.props.resources.NeuralRewriteFeedbackDialogChooseOptionTitle,componentRef:this.rewriteFeedbackOptionChoiceGroupRef,onChange:this.onRewriteSelectFeedbackOption,style:this.props.styleProvider.suggestionChoiceGroupStyles,options:[{key:t.neuralRewriteFeedbackOptionHelpful,text:this.props.resources.SuggestionFeedbackHelpfulLabel},{key:t.neuralRewriteFeedbackOptionWrong,text:this.props.resources.SuggestionFeedbackWrongLabel},{key:t.neuralRewriteFeedbackOptionOffensive,text:this.props.resources.SuggestionFeedbackOffensiveLabel},{key:t.neuralRewriteFeedbackOptionOther,text:this.props.resources.SuggestionFeedbackOtherLabel}]})},t.rewriteFeedbackOptionShouldDisableSuggestion=function(e){return e!==t.neuralRewriteFeedbackOptionHelpful},t.prototype.getSensitiveContentSuggestion=function(){return[{type:"CritiqueItem",id:"Remove",supportedActions:[Fo.Apply]}]},t.prototype.getSuggestionsToRender=function(){switch(this.props.group.type){case t.sensitiveContent:return this.getSensitiveContentSuggestion();default:return e.prototype.getSuggestionsToRender.call(this)}},t.prototype.renderSuggestions=function(){if(this.props.group.type===t.neuralRewrite)switch(this.state.rewriteState){case Wi.ReportRewriteSuggestions:return this.renderNeuralRewriteReportSuggestions();case Wi.DisplayingFeedbackOptions:return this.renderNeuralRewriteFeedbackOptions();case Wi.Confirmation:return null}else if(this.props.group.type===t.similarity)switch(this.state.similarityState){case Gi.DisplayingFeedbackOptions:return this.renderSimilarityFeedbackOptions();case Gi.DisplayingSimilarSources:return this.renderSimilaritySourceOptions();case Gi.Confirmation:return null}return e.prototype.renderSuggestions.call(this)},t.prototype.getActionStringForLearnMore=function(){return this.props.group.type===t.neuralRewrite?this.props.resources.AboutSuggestionsButtonText:e.prototype.getActionStringForLearnMore.call(this)},t.prototype.shouldDismissOnAction=function(n){return(this.props.group.type!==t.similarity||n!==Fo.GiveFeedback)&&((this.props.group.type!==t.similarity||n!==Fo.SelectSource)&&e.prototype.shouldDismissOnAction.call(this,n))},t.prototype.shouldHideActionButton=function(n,o){return(this.props.group.type!==t.similarity||n!==Fo.IgnoreOnce)&&e.prototype.shouldHideActionButton.call(this,n,o)},t.prototype.shouldDisableActionButton=function(e,n){return this.props.group.type===t.similarity&&e===Fo.IgnoreOnce&&!this.hasActionType(e,n)},t.prototype.renderNeuralRewriteFeedbackButton=function(){var e=this;if(this.props.group.isContentPending)return null;var t={text:this.props.resources.GiveFeedbackButtonText,styles:this.props.styleProvider.footerButtonStyles,onClick:function(){return e.setState({rewriteState:Wi.ReportRewriteSuggestions,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1})}};return C.createElement(Qi.a,Object(l.__assign)({key:"GiveFeedback"},t,{"data-automation-id":"CritiqueActionButton_GiveFeedback_".concat(this.props.group.id)}))},t.prototype.renderCloseButton=function(){var e=this,t={styles:this.props.styleProvider.footerButtonStyles,iconProps:{iconName:"Cancel",styles:this.props.styleProvider.footerIconStyles,ariaLabel:this.props.resources.CloseButtonLabel},onClick:function(){return e.props.dismiss({actionSourceId:i.Unknown})}};return C.createElement(Qi.a,Object(l.__assign)({key:"CloseButton"},t,{"data-automation-id":"CritiqueCloseButton_".concat(this.props.group.id)}))},t.prototype.onShowHideDescription=function(e){this.setState((function(e){return{showingDescription:!e.showingDescription}})),this.onAction(e,Fo.Toggle,Po.Try,this.props.group,void 0,"Description")},t.prototype.allowDescriptionToggleButton=function(){if(this.props.group.suggestions)for(var e=0,t=this.props.group.suggestions;e<t.length;e++){var n=t[e];if(n&&n.description)return!0}return!1},t.prototype.renderShowHideDescriptionButton=function(){if(!this.allowDescriptionToggleButton())return null;var e=null,n={text:e=this.props.group.type===t.neuralRewrite?this.state.showingDescription?this.props.resources.HideExplanationButtonText:this.props.resources.ShowExplanationButtonText:this.state.showingDescription?this.props.resources.HideSynonymsButtonText:this.props.resources.ShowSynonymsButtonText,styles:this.props.styleProvider.overflowActionButtonStyles,onClick:this.onShowHideDescription};return C.createElement(Qi.a,Object(l.__assign)({role:"menuitem",key:"ShowHideDescription"},n,{"data-automation-id":"CritiqueActionButton_".concat(e,"_").concat(this.props.group.id)}))},t.prototype.renderDefaultAction=function(){switch(this.props.group.type){case t.similarity:case t.sensitiveContent:return this.renderActionButton(Fo.IgnoreOnce,this.props.styleProvider.footerButtonStyles);case t.neuralRewrite:return this.renderNeuralRewriteFeedbackButton();default:return null}},t.prototype.getCitationSourceButtonTitle=function(e){switch(e){case"APA":return this.props.resources.CitationApaTitle;case"MLA":return this.props.resources.CitationMlaTitle;case"Chicago":return this.props.resources.CitationChicagoTitle;default:return}},t.prototype.renderCitationSourceButton=function(e,t,n){var o=this,i=this.getCitationSourceButtonTitle(e);if(!i)return null;var r={text:i,role:"option","aria-selected":this.state.selectedCitationStyle===e,"aria-posinset":t+1,"aria-setsize":n.length,styles:this.state.selectedCitationStyle!==e?this.props.styleProvider.citationNoIconOverflowActionButtonStyles:this.props.styleProvider.citationOverflowActionButtonStyles,iconProps:this.state.selectedCitationStyle!==e?void 0:{iconName:this.props.styleProvider.citationCheckmarkIconName,styles:this.props.styleProvider.citationCheckmarkIconStyles},onClick:function(t){o.setState({selectedCitationStyle:e}),o.onAction(t,Fo.Toggle,Po.Try,o.props.group,void 0,e)}};return C.createElement(Qi.a,Object(l.__assign)({key:e},r,{"data-automation-id":"CritiqueActionButton_".concat(i,"_").concat(this.props.group.id)}))},t.prototype.onSimilaritySelectFeedbackOption=function(e,t){t&&this.setState({similarityChoiceGroupSelected:!0})},t.prototype.onSimilarityFeedbackCancel=function(e){this.setState({similarityState:Gi.Default,similarityChoiceGroupSelected:!1})},t.prototype.onSimilarityFeedbackOkay=function(e){this.setState({similarityState:Gi.Default,similarityChoiceGroupSelected:!1})},t.prototype.onSimilaritySourceDone=function(e){var t,n,o;this.props.group.sources&&(this.props.group.description=null===(t=this.props.group.sources[e])||void 0===t?void 0:t.description,this.props.group.url=null===(n=this.props.group.sources[e])||void 0===n?void 0:n.url,this.props.group.snippet=null===(o=this.props.group.sources[e])||void 0===o?void 0:o.snippet,this.setState({similaritySelectedSource:e.toString(),similarityState:Gi.Default}))},t.prototype.onSimilaritySourceCancel=function(e){this.setState({similarityState:Gi.Default})},t.prototype.onSimilarityShareCitedContentCheckbox=function(e){var t=this.state.similarityShareCitedContentCheckbox;this.onAction(null,Fo.Toggle,Po.None,this.props.group,void 0,"Context"),this.setState({similarityShareCitedContentCheckbox:!t})},t.prototype.renderSimilarityFeedbackOptions=function(){return C.createElement($i.a,{"aria-label":this.headerText(),componentRef:this.similarityFeedbackOptionChoiceGroupRef,onChange:this.onSimilaritySelectFeedbackOption,style:this.props.styleProvider.suggestionChoiceGroupStyles,options:[{key:t.similarityFeedbackHelpfulLabel,text:this.props.resources.SimilarityFeedbackHelpfulLabel},{key:t.similarityFeedbackWrongSourceLabel,text:this.props.resources.SimilarityFeedbackWrongSourceLabel},{key:t.similarityFeedbackOriginalContentLabel,text:this.props.resources.SimilarityFeedbackOriginalContentLabel},{key:t.similarityFeedbackOffensiveLabel,text:this.props.resources.SimilarityFeedbackOffensiveContentLabel},{key:t.similarityFeedbackOtherLabel,text:this.props.resources.SimilarityFeedbackOtherLabel}]})},t.prototype.renderSimilaritySourceOverflowActions=function(e,n){if(this.props.group.type!==t.similarity)return null;var o={styleProvider:this.props.styleProvider.bottomAlignedOverflowMenuStyleProvider,resources:this.props.resources,ref:this.similaritySourceOptionRef[e],ariaLabel:this.props.resources.DefaultSplitButtonOverflowAccessibilityLabel.replace("{0}",n)};return C.createElement(Vi,Object(l.__assign)({},o),this.renderSimilarityFeedbackButton(),C.createElement("div",null,this.renderNavigateToSourceButton(e.toString())))},t.prototype.renderSimilaritySourceOption=function(e,t){var n=this;if(!this.props.group.sources)return null;var o=this.props.group.sources.length,i=t+1,r={role:"menuitem","aria-posinset":i,"aria-setsize":o,styles:this.props.styleProvider.suggestionButtonStyles,onClick:function(){return n.onSimilaritySourceDone(t)},onFocus:function(){return n.handleSuggestionFocus(e.id)}},s=this.state.hoveredSuggestionId===e.id,a=this.state.openSuggestionOverflowId===e.id,c={onMouseEnter:function(){var o,i;n.handleSuggestionHoverOn(e.id),null===(i=null===(o=n.similaritySourceOptionRef[t])||void 0===o?void 0:o.current)||void 0===i||i.enableButton()},onMouseLeave:function(){var o,i;n.handleSuggestionHoverOff(e.id),n.state.focusedSuggestionId!==e.id&&(null===(i=null===(o=n.similaritySourceOptionRef[t])||void 0===o?void 0:o.current)||void 0===i||i.disabledButton())},onFocus:function(){var i,r,s,a;n.handleSuggestionFocus(e.id);for(var l=0;l<o;l++)l===t?null===(r=null===(i=n.similaritySourceOptionRef[l])||void 0===i?void 0:i.current)||void 0===r||r.enableButton():null===(a=null===(s=n.similaritySourceOptionRef[l])||void 0===s?void 0:s.current)||void 0===a||a.disabledButton()},onBlur:this.handleSuggestionBlur,style:this.getSuggestionContainerStyle(!1,s||a)},u=this.props.resources.SimilaritySourceOptionLabel.replace("{0}",i.toString()),p=this.renderSimilaritySourceOverflowActions(t,u);return C.createElement("div",Object(l.__assign)({},c),C.createElement(Qi.a,Object(l.__assign)({},r,{"data-automation-id":"SimilaritySourceButton_".concat(e.id)}),C.createElement("div",{style:this.props.styleProvider.similaritySourceChoiceStyle},C.createElement("div",{"aria-label":u,role:"group"},this.renderSimilaritySourceTitle(e.description),this.renderSimilaritySourceUrl(e.url,!1),this.renderSnippet(void 0,e.snippet,e.snippetFormatting)))),p)},t.prototype.renderSimilaritySourceOptions=function(){var e=this;if(!this.props.group.sources)return null;var t=this.props.group.sources.filter((function(e){return!!e})).map((function(t,n){return e.renderSimilaritySourceOption(t,n)})).filter((function(e){return!!e}));return C.createElement(q.a,{componentRef:this.suggestionsFocusZoneRef},C.createElement("div",{style:this.props.styleProvider.suggestionStyles,role:"menu","aria-label":this.props.resources.SimilaritySourceOptionsLabel},t))},t.prototype.renderSimilarityFeedbackButton=function(){var e=this;if(this.props.group.type!==t.similarity||this.props.group.isContentPending)return null;if(!this.suggestionGroupHasActionType(this.props.group,Fo.Report))return null;var n={text:this.props.resources.GiveFeedbackButtonText,styles:this.props.styleProvider.overflowActionButtonStyles,onClick:function(t){e.onAction(t,Fo.GiveFeedback,Po.None,e.props.group),e.setState({similarityState:Gi.DisplayingFeedbackOptions})}};return C.createElement(Qi.a,Object(l.__assign)({key:"GiveFeedback"},n,{"data-automation-id":"CritiqueActionButton_GiveFeedback_".concat(this.props.group.id)}))},t.prototype.renderSimilarityFeedbackIconButton=function(){var e=this;if(this.props.group.type!==t.similarity||this.props.group.isContentPending)return null;if(!this.suggestionGroupHasActionType(this.props.group,Fo.Report))return null;var n={ariaLabel:this.props.resources.GiveFeedbackButtonText,iconProps:this.props.styleProvider.feedbackIconProps,styles:this.props.styleProvider.footerButtonStyles,onClick:function(t){e.onAction(t,Fo.GiveFeedback,Po.None,e.props.group),e.setState({similarityState:Gi.DisplayingFeedbackOptions})}};return C.createElement(Qi.a,Object(l.__assign)({key:"GiveFeedback"},n,{"data-automation-id":"CritiqueActionButton_GiveFeedback_".concat(this.props.group.id)}))},t.prototype.renderNavigateToSourceButton=function(e){var t=this,n={text:this.props.resources.NavigateToSourceButton,styles:this.props.styleProvider.overflowActionButtonStyles,role:"menuitem",onClick:function(){var n,o;t.props.group.sources?window.open(null!==(o=null===(n=t.props.group.sources[parseInt(e,10)])||void 0===n?void 0:n.url)&&void 0!==o?o:void 0):window.open(t.props.group.url?t.props.group.url:void 0)}};return C.createElement(Qi.a,Object(l.__assign)({},n))},t.prototype.renderOverflowActions=function(){var e=[];switch(this.props.group.type){case t.similarity:e=[this.renderShowHideSimilarTextButton(),this.renderNavigateToSourceButton(this.state.similaritySelectedSource),this.renderActionButton(Fo.LearnMore,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")];break;case t.sensitiveContent:e=[this.renderShowHideContextButton()];break;case t.neuralRewrite:e=[this.renderShowHideContextButton(),this.renderShowHideDescriptionButton(),this.renderActionButton(Fo.LearnMore,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")]}return e.filter((function(e){return!!e}))},t.prototype.renderShowHideSimilarTextButton=function(){var e=this;if(!this.allowShowHideSimilarTextButton())return null;var t=this.state.showingSimilarText?this.props.resources.HideSimilarTextButton:this.props.resources.ShowSimilarTextButton,n={text:t,styles:this.props.styleProvider.overflowActionButtonStyles,onClick:function(t){return e.onShowHideSimilarText(t)}};return C.createElement(Qi.a,Object(l.__assign)({role:"menuitem",key:"ShowHideSimilarText"},n,{"data-automation-id":"CritiqueActionButton_".concat(t,"_").concat(this.props.group.id)}))},t.prototype.allowShowHideSimilarTextButton=function(){return!!this.props.group.snippet},t.prototype.onShowHideSimilarText=function(e){this.setState((function(e){return{showingSimilarText:!e.showingSimilarText}})),this.onAction(e,Fo.Toggle,Po.None,this.props.group,void 0,"Context")},t.prototype.renderCitationStyleOptions=function(){var e=this;if(this.props.group.type!==t.similarity)return null;var n=this.state.selectedCitationStyle?this.state.selectedCitationStyle:this.props.resources.CitationMlaTitle,o={text:n,iconName:this.props.styleProvider.citationDropdownIconName,styleProvider:this.props.styleProvider.citationFooterOverflowMenuStyleProvider,resources:this.props.resources,ref:this.footerOpenOverflowMenuRef,ariaLabel:this.props.resources.SimilarityCitationStyleLabel.replace("{0}",n),role:"menu"},i=[this.props.resources.CitationMlaTitle,this.props.resources.CitationApaTitle,this.props.resources.CitationChicagoTitle].filter((function(e){return!!e})).map((function(t,n,o){return e.renderCitationSourceButton(t,n,o)}));return C.createElement(Vi,Object(l.__assign)({},o),C.createElement("div",{style:this.props.styleProvider.footerOverflowContainerStyles},i))},t.prototype.onRewriteReportSuggestionCancel=function(e){this.setState({rewriteState:Wi.Default,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1})},t.prototype.onRewriteReportSuggestionNext=function(e){this.setState({rewriteState:Wi.DisplayingFeedbackOptions,rewriteChoiceGroupSelected:!1})},t.prototype.onRewriteReportSuggestionSend=function(e){if(this.state.rewriteReportedSuggestionId&&this.props.group.suggestions)if(this.rewriteFeedbackOptionChoiceGroupRef.current&&this.rewriteFeedbackOptionChoiceGroupRef.current.checkedOption){for(var n=null,o=this.state.rewriteReportedSuggestionId,i=0,r=this.props.group.suggestions;i<r.length;i++){var s=r[i];if(s&&s.id===o){n=s;break}}if(n&&this.getSuggestionTitle(n)){var a=this.getSuggestionTitle(n),l=this.rewriteFeedbackOptionChoiceGroupRef.current.checkedOption.key,c={option:l,comments:this.rewriteCommentsTextBoxRef.current&&this.rewriteCommentsTextBoxRef.current.value?this.rewriteCommentsTextBoxRef.current.value:void 0};this.onAction(null,Fo.Report,Po.Try,this.props.group,n,void 0,JSON.stringify(c)),this.isSuggestionAlreadyReported(a)||t.neuralRewriteReportedSuggestions.push(a),t.rewriteFeedbackOptionShouldDisableSuggestion(l)&&!this.isSuggestionDisabled(a)&&t.neuralRewriteDisabledSuggestions.push(a),this.setState({rewriteState:Wi.Confirmation,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1})}else u.a.sendTraceTag(594871320,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unable to send feedback because we couldn't find the reported suggestion, or could grab the text on it")}else u.a.sendTraceTag(594871319,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unable to send feedback because apparently no option radio was selected");else u.a.sendTraceTag(594911240,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unable to send feedback because we don't know what was reported, or we don't have any suggestions")},t.prototype.onRewriteReportSuggestionDone=function(e){this.setState({rewriteState:Wi.Default,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1})},t.prototype.renderCloseButtonFooter=function(){var e=this.renderCloseButton();return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerStyles},C.createElement("div",{style:this.props.styleProvider.footerDefaultActionStyles},e))},t.prototype.renderShowSources=function(){var e=this;if(this.props.group.type!==t.similarity||!this.props.group.sources||this.props.group.sources.length<=1)return null;var n={text:this.props.resources.SimilaritySourcesLabel,styles:this.props.styleProvider.similaritySourcesStyles,onClick:function(t){e.onAction(t,Fo.SelectSource,Po.None,e.props.group),e.setState({similarityState:Gi.DisplayingSimilarSources})}};return C.createElement(er.a,Object(l.__assign)({},n))},t.prototype.renderDefaultFooter=function(){var e=this.renderDefaultAction(),t=this.renderCitationStyleOptions(),n=this.renderSimilarityFeedbackIconButton(),o=this.renderOverflowMenu(),i=this.renderNextPrev(),r=this.renderShowSources();return null!=e||null!=o||i.length>0?[C.createElement("div",{key:"footer"},r,C.createElement("div",{key:"footer",style:this.props.styleProvider.footerStyles},C.createElement("div",{style:this.props.styleProvider.footerDefaultActionStyles},e,t,n,o),C.createElement("div",{style:this.props.styleProvider.footerNextPrevStyles},i)))]:null},t.prototype.renderRewriteFooter=function(){switch(this.state.rewriteState){case Wi.Default:return this.props.group.isContentPending?null:this.renderDefaultFooter();case Wi.ReportRewriteSuggestions:case Wi.DisplayingFeedbackOptions:case Wi.Confirmation:var e=this.state.rewriteState===Wi.DisplayingFeedbackOptions,t=this.state.rewriteState!==Wi.Confirmation,n=this.state.rewriteState===Wi.ReportRewriteSuggestions,o=this.state.rewriteState===Wi.DisplayingFeedbackOptions,i=this.state.rewriteState===Wi.Confirmation;return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerDialogStyles},e?C.createElement(ir.a,{id:"commentsBox",type:"AppInputProps",ref:this.rewriteCommentsTextBoxRef,label:this.props.resources.NeuralRewriteFeedbackDialogTextBoxPlaceholder,hideLabel:!0,placeholder:this.props.resources.NeuralRewriteFeedbackDialogTextBoxPlaceholder,styles:this.props.styleProvider.rewriteCommentsBoxStyles,multiline:!0,resizable:!1}):null,e?this.renderPrivacyStatement():null,C.createElement("div",{style:this.props.styleProvider.footerDialogButtonGroupStyles},t?C.createElement(tr.a,{text:this.props.resources.CancelButton,onClick:this.onRewriteReportSuggestionCancel}):null,n?C.createElement(er.a,{text:this.props.resources.NextButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onRewriteReportSuggestionNext,disabled:!this.state.rewriteChoiceGroupSelected}):null,o?C.createElement(er.a,{text:this.props.resources.SendButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onRewriteReportSuggestionSend,disabled:!this.state.rewriteChoiceGroupSelected}):null,i?C.createElement(er.a,{text:this.props.resources.DoneButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onRewriteReportSuggestionDone,componentRef:this.rewriteReportDoneButtonRef}):null));default:return null}},t.prototype.renderPrivacyStatement=function(){return C.createElement(C.Fragment,null,C.createElement(Xi,{ariaLabel:this.privacyStatementLabel,style:this.props.styleProvider.privacyStatementStyle,text:this.privacyStatementLabel}),C.createElement(nr.a,{target:"_blank",href:this.props.resources.NeuralRewriteFeedbackDialogPrivacyStatementURL,styles:this.props.styleProvider.linkStyle,underline:!0},this.props.resources.NeuralRewriteFeedbackDialogPrivacyStatementLabel))},t.prototype.getUserTextToSend=function(){var e;return null===(e=this.props.group.snippet)||void 0===e?void 0:e.substr(0,t.characterLimitForUserTextToSend)},t.prototype.onSimilarityFeedbackSubmit=function(e){if(this.props.group.suggestions)if(this.similarityFeedbackOptionChoiceGroupRef.current&&this.similarityFeedbackOptionChoiceGroupRef.current.checkedOption){var t=this.similarityFeedbackOptionChoiceGroupRef.current.checkedOption.key,n=this.similarityCommentsTextBoxRef.current&&this.similarityCommentsTextBoxRef.current.value?this.similarityCommentsTextBoxRef.current.value:void 0,o=this.state.similarityShareCitedContentCheckbox?this.getUserTextToSend():void 0,i=this.state.similarityShareCitedContentCheckbox?this.getDomainFromUrl(this.props.group.url):void 0;this.onAction(null,Fo.Report,Po.Try,this.props.group,void 0,void 0,JSON.stringify({option:t,comments:n,snippet:o,url:i})),this.setState({similarityState:Gi.Confirmation})}else u.a.sendTraceTag(590136730,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unable to send feedback because apparently no option radio was selected");else u.a.sendTraceTag(590136729,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unable to send feedback because we don't know what was reported, or we don't have any suggestions")},t.prototype.renderSimilarSourcesFooter=function(){return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerDialogStyles},C.createElement("div",null,C.createElement(tr.a,{text:this.props.resources.BackButton,styles:this.props.styleProvider.similaritySourceBackButtonStyles,onClick:this.onSimilaritySourceCancel})))},t.prototype.renderSimilarityFooter=function(){switch(this.state.similarityState){case Gi.Default:return this.renderDefaultFooter();case Gi.DisplayingSimilarSources:return this.renderSimilarSourcesFooter();case Gi.DisplayingFeedbackOptions:case Gi.Confirmation:var e=this.state.similarityState===Gi.DisplayingFeedbackOptions,t=this.state.similarityState===Gi.DisplayingFeedbackOptions,n=this.state.similarityState===Gi.DisplayingFeedbackOptions,o=this.state.similarityState!==Gi.Confirmation,i=this.state.similarityState===Gi.DisplayingFeedbackOptions,r=this.state.similarityState===Gi.Confirmation;return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerDialogStyles},e?C.createElement(ir.a,{ref:this.similarityCommentsTextBoxRef,id:"commentsBox",type:"AppInputProps",label:this.props.resources.NeuralRewriteFeedbackDialogTextBoxPlaceholder,hideLabel:!0,placeholder:this.props.resources.NeuralRewriteFeedbackDialogTextBoxPlaceholder,styles:this.props.styleProvider.rewriteCommentsBoxStyles,multiline:!0,resizable:!1,disabled:!this.state.similarityChoiceGroupSelected}):null,t?C.createElement(C.Fragment,null,C.createElement(Ki.a,{label:this.props.resources.SimilarityFeedbackIncludeDocumentTextAndSourceUrl,checked:this.state.similarityShareCitedContentCheckbox,styles:this.props.styleProvider.includeCitedContentOptionStyles,onChange:this.onSimilarityShareCitedContentCheckbox}),C.createElement("div",{style:this.props.styleProvider.citationFeedbackContainerStyles},this.renderSnippetForFeedback(),this.renderCitationToBeShared())):null,n?this.renderPrivacyStatement():null,C.createElement("div",{style:this.props.styleProvider.footerDialogButtonGroupStyles},o?C.createElement(tr.a,{text:this.props.resources.CancelButton,onClick:this.onSimilarityFeedbackCancel}):null,i?C.createElement(er.a,{text:this.props.resources.SubmitButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onSimilarityFeedbackSubmit,disabled:!this.state.similarityChoiceGroupSelected}):null,r?C.createElement(er.a,{text:this.props.resources.DoneButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onSimilarityFeedbackOkay,componentRef:this.similarityFeedbackReportOkayButtonRef}):null));default:return null}},t.prototype.renderFooter=function(){switch(this.props.group.type){case t.neuralRewrite:return this.renderRewriteFooter();case t.similarity:return this.renderSimilarityFooter();default:return this.renderDefaultFooter()}},t.prototype.onAction=function(t,n,o,i,r,s,a){e.prototype.onAction.call(this,t,n,o,i,r,s,a)},t.neuralRewrite="NeuralRewriteCritique",t.similarity="PlagiarismCritique",t.sensitiveContent="SensitiveContent",t.neuralRewriteFeedbackOptionHelpful="Helpful",t.neuralRewriteFeedbackOptionWrong="Wrong",t.neuralRewriteFeedbackOptionOffensive="Offensive",t.neuralRewriteFeedbackOptionOther="Other",t.characterLimitForUserTextToSend=150,t.neuralRewriteReportedSuggestions=[],t.neuralRewriteDisabledSuggestions=[],t.similarityFeedbackHelpfulLabel="Helpful",t.similarityFeedbackWrongSourceLabel="WrongSource",t.similarityFeedbackOffensiveLabel="Offensive",t.similarityFeedbackOriginalContentLabel="OriginalContent",t.similarityFeedbackOtherLabel="Other",t.similarityBlockQuoteSuggestion="BlockQuotation",t.similarityFullCitationSuggestions="FullCitation",t.similarityInlineCitationSuggestions="InlineCitation",t}(or),sr=n(1695),ar=n(2872),lr=n(463),cr=n(2662);function ur(e,t,n){return{fontSize:t.xxsmall,fontFamily:k.a,cssColor:n?e.addOnAction:e.addOnFooterMessage,underlineType:n?O.c.Single:O.c.None,wrapMode:n?O.b.NoWrap:O.b.Normal}}function pr(e,t,n){return Object.assign(Object.assign({},ur(e,t,n)),{fontSize:t.xsmall,fontWeight:n?O.a.SemiBold:O.a.Normal})}function dr(e){return{background:{resting:"transparent"},title:{resting:e.addOnAction||e.background.resting}}}function gr(e){return e.premiumEmphasis}function hr(e,t){return e.hover?t?Object.assign(Object.assign({},e),{resting:e.hover}):Object.assign(Object.assign({},e),{hover:void 0}):e}function fr(e,t){return Object.assign(Object.assign({},e),{resting:t,hover:void 0})}function mr(e){var t;return null!==(t=null==e?void 0:e.borderThickness)&&void 0!==t?t:1}function yr(e){var t;return null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:0}function br(e){return(br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vr(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Sr(){return(Sr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=xr(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function xr(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kr(e)););return e}function Cr(e,t){return(Cr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Tr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=kr(e);if(t){var i=kr(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return wr(this,n)}}function wr(e,t){if(t&&("object"===br(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Or(e)}function Or(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kr(e){return(kr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ar=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cr(e,t)}(r,e);var t,n,o,i=Tr(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=i.call(this,e)).state={buttonHover:!1,buttonFocus:!1,overflowHover:!1,overflowFocus:!1,menuOpened:!1,overflowTimeout:void 0,highlightTimeout:void 0},t.buttonRef=C.createRef(),t.onButtonHoverIn=t.handleEvent.bind(Or(t),"buttonHover",!0),t.onButtonHoverOut=t.handleEvent.bind(Or(t),"buttonHover",!1),t.onButtonFocus=t.handleEvent.bind(Or(t),"buttonFocus",!0),t.onButtonBlur=t.handleEvent.bind(Or(t),"buttonFocus",!1),t.onOverflowHoverIn=t.handleEvent.bind(Or(t),"overflowHover",!0),t.onOverflowHoverOut=t.handleEvent.bind(Or(t),"overflowHover",!1),t.onOverflowFocus=t.handleEvent.bind(Or(t),"overflowFocus",!0),t.onOverflowBlur=t.handleEvent.bind(Or(t),"overflowFocus",!1),t.onMenuOpened=t.handleEvent.bind(Or(t),"menuOpened",!0),t.onMenuDismissed=t.handleEvent.bind(Or(t),"menuOpened",!1),t}return t=r,o=[{key:"shouldShowHighlight",value:function(e,t){return e.buttonHover||e.overflowHover||e.menuOpened||!t&&void 0!==e.highlightTimeout}},{key:"shouldSetHighlightTimerForEvent",value:function(e){return"buttonHover"===e||"overflowHover"===e}},{key:"shouldShowOverflow",value:function(e,t){return e.buttonHover||e.buttonFocus||e.overflowHover||e.overflowFocus||e.menuOpened||!t&&void 0!==e.overflowTimeout}},{key:"setTimerHighlightedInstance",value:function(e){this.timerHighlightedInstance!==e&&(void 0!==e&&void 0!==this.timerHighlightedInstance&&void 0!==this.timerHighlightedInstance.state.highlightTimeout&&this.timerHighlightedInstance.cancelUnhighlightTimer(!1),this.timerHighlightedInstance=e)}}],(n=[{key:"render",value:function(){var e,t,n,o,i,s,a,l,c,u={marginHorizontal:null===(e=this.props.style)||void 0===e?void 0:e.marginHorizontal,marginVertical:null===(t=this.props.style)||void 0===t?void 0:t.marginVertical,flexibleSize:null===(n=this.props.style)||void 0===n?void 0:n.flexibleSize,height:null===(o=this.props.style)||void 0===o?void 0:o.height,minHeight:null===(i=this.props.style)||void 0===i?void 0:i.minHeight,maxHeight:null===(s=this.props.style)||void 0===s?void 0:s.maxHeight};if(this.drawBorderOnRoot()){var p=null!==(a=this.props.buttonProps.theme)&&void 0!==a?a:Nt.a.defaultTheme;u.borderColor=null!==(l=p.border)&&void 0!==l?l:r.shouldShowHighlight(this.state)?p.background.hover:p.background.resting,u.borderStyle="solid",u.borderWidth=mr(this.props.style),u.borderRadius=yr(this.props.style)}return C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Stretch,style:u},C.createElement(U.a,Object.assign({ref:this.buttonRef},this.computeButtonProps())),(c=this.props).menuProps&&c.menuProps.items&&c.menuProps.items.length>0?C.createElement(pn,Object.assign({},this.computeOverflowMenuProps())):null)}},{key:"focus",value:function(){this.buttonRef.current&&this.buttonRef.current.focus()}},{key:"componentWillUnmount",value:function(){r.timerHighlightedInstance===this&&r.setTimerHighlightedInstance(void 0),this.cancelOverflowTimer(!1),this.cancelUnhighlightTimer(!1),Sr(kr(r.prototype),"componentWillUnmount",this)&&Sr(kr(r.prototype),"componentWillUnmount",this).call(this)}},{key:"cancelOverflowTimer",value:function(e){void 0!==this.state.overflowTimeout&&(clearTimeout(this.state.overflowTimeout),e||this.setState({overflowTimeout:void 0}))}},{key:"cancelUnhighlightTimer",value:function(e){void 0!==this.state.highlightTimeout&&(clearTimeout(this.state.highlightTimeout),e||this.setState({highlightTimeout:void 0}))}},{key:"computeButtonProps",value:function(){var e=mr(this.props.style),t=yr(this.props.style),n=Object.assign(Object.assign({},this.props.style),{paddingEnd:e,borderRadius:{topStart:t,bottomStart:t}});this.drawBorderOnRoot()?n.borderThickness=0:n.borderThickness={start:e,top:e,bottom:e},this.props.menuProps||delete n.paddingEnd,delete n.marginHorizontal,delete n.marginVertical,delete n.height,delete n.minHeight,delete n.maxHeight;var o,i,s=this.props.buttonProps,a=(null==s?void 0:s.icon)?{type:s.icon.type}:void 0;return Object.assign(Object.assign({},s),{icon:a,style:n,theme:(o=s.theme?s.theme:U.a.defaultTheme,i=r.shouldShowHighlight(this.state),Object.assign(Object.assign({},o),{background:hr(o.background,i),title:hr(o.title,i),subtitle:o.subtitle&&hr(o.subtitle,i)})),onHoverIn:this.onButtonHoverIn,onHoverOut:this.onButtonHoverOut,onFocus:this.onButtonFocus,onBlur:this.onButtonBlur,accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize})}},{key:"computeOverflowMenuProps",value:function(){var e=mr(this.props.style),t=yr(this.props.style),n={paddingStart:e,borderRadius:{topEnd:t,bottomEnd:t}};this.drawBorderOnRoot()?n.borderThickness=0:n.borderThickness={top:e,end:e,bottom:e};var o,i,s,a,l,c=this.props.menuProps;return Object.assign(Object.assign({},c),{icon:{type:"Overflow",filled:!0},hidden:!r.shouldShowOverflow(this.state),style:n,theme:(i=c.theme?c.theme:U.a.defaultTheme,s=this.props.theme,a=r.shouldShowHighlight(this.state),l=this.state.overflowHover||this.state.menuOpened,Object.assign(Object.assign({},i),{background:s&&s.splitMenuHoverBackground&&a&&l?fr(i.background,s.splitMenuHoverBackground):hr(i.background,a),title:s&&s.splitMenuHoverForeground&&a&&l?fr(i.title,s.splitMenuHoverForeground):hr(i.title,a),icon:s&&s.splitMenuHoverForeground&&a&&l?fr(i.icon,s.splitMenuHoverForeground):i.icon&&hr(i.icon,a)})),accessibilityLabel:(o=this.props,o.menuProps&&o.menuProps.accessibilityLabel?o.menuProps.accessibilityLabel:o.buttonProps.title&&o.strings&&o.strings.defaultSplitButtonOverflowAccessibilityLabel?o.strings.defaultSplitButtonOverflowAccessibilityLabel.replace("{0}",o.buttonProps.title):void 0),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,onHoverIn:this.onOverflowHoverIn,onHoverOut:this.onOverflowHoverOut,onFocus:this.onOverflowFocus,onBlur:this.onOverflowBlur,onMenuOpen:this.onMenuOpened,onMenuDismiss:this.onMenuDismissed})}},{key:"setOverflowTimer",value:function(){var e=this;if(!(r.hideOverflowLagInMs<=0))return this.cancelOverflowTimer(!0),setTimeout((function(){e.setState({overflowTimeout:void 0})}),r.hideOverflowLagInMs)}},{key:"setUnhighlightTimer",value:function(){var e=this;if(!(r.unhoverLagInMs<=0))return this.cancelUnhighlightTimer(!0),setTimeout((function(){r.timerHighlightedInstance===e&&r.setTimerHighlightedInstance(void 0),e.setState({highlightTimeout:void 0})}),r.unhoverLagInMs)}},{key:"handleEvent",value:function(e,t){var n=this;r.shouldSetHighlightTimerForEvent(e)&&t&&r.setTimerHighlightedInstance(this),this.setState((function(o){if(o[e]!==t){var i=Object.assign({},o);return i[e]=t,t&&("overflowHover"===e&&(i.buttonHover=!1),"buttonHover"===e&&(i.overflowHover=!1)),i.highlightTimeout=r.shouldShowHighlight(o)&&!r.shouldShowHighlight(i)?n.setUnhighlightTimer():void 0,i.overflowTimeout=r.shouldShowOverflow(o)&&!r.shouldShowOverflow(i)?n.setOverflowTimer():void 0,i}}))}},{key:"drawBorderOnRoot",value:function(){return!this.props.menuProps||!r.shouldShowOverflow(this.state)}}])&&vr(t.prototype,n),o&&vr(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(C.PureComponent);Ar.hideOverflowLagInMs=5,Ar.unhoverLagInMs=5,Ar.timerHighlightedInstance=void 0;function Ir(e){return(Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jr(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _r(e,t){return(_r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Mr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Er(e);if(t){var i=Er(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return Dr(this,n)}}function Dr(e,t){if(t&&("object"===Ir(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Er(e){return(Er=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_r(e,t)}(a,e);var t,n,r,s=Mr(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).firstSuggestionRef=C.createRef(),t.firstSuggestionButtonRef=C.createRef(),t.footerRef=C.createRef(),t.state={definition:e.definition},t}return t=a,(n=[{key:"setDefinition",value:function(e){this.setState({definition:e})}},{key:"componentDidMount",value:function(){var e,t;null===(t=(e=this.props).onAfterUpdate)||void 0===t||t.call(e,this.state.definition)}},{key:"componentDidUpdate",value:function(e,t){this.props.onAfterUpdate&&t.definition!==this.state.definition&&this.props.onAfterUpdate(this.state.definition),e.definition!==this.props.definition&&this.setState({definition:this.props.definition})}},{key:"render",value:function(){return C.createElement(W.a,{style:w.lb(this.getTheme(),this.props.style),align:G.b.Stretch},this.renderHeader(),this.renderBody(),this.renderFooterTitle(),C.createElement(Tn,{automationId:this.props.automationId,definition:this.state.definition,theme:this.props.theme,fontTable:this.props.fontTable,spacing:this.props.spacing,style:this.props.style,strings:this.props.strings,settings:this.props.settings,onAction:this.props.onAction,ref:this.footerRef}),this.renderAddOnFooter())}},{key:"focus",value:function(){var e;this.firstSuggestionRef.current?this.firstSuggestionRef.current.focus():this.firstSuggestionButtonRef.current?this.firstSuggestionButtonRef.current.focus():null===(e=this.footerRef.current)||void 0===e||e.focus()}},{key:"executeBadgedAction",value:function(e){if(this.props.onAction){var t=dt(this.getDefinition(),this.props.strings),n={actionSourceId:i.VoiceDictationBadge,maxBadgeId:t.reduce((function(e,t){return Math.max(e,t.badgeId)}),0)},o=t.filter((function(t){return t.badgeId===e}));o.length>0?(n.executedBadgeId=o[0].badgeId,this.props.onAction(o[0].action,o[0].suggestionIndex,void 0,n)):this.props.onAction(z.a.Dismiss,void 0,void 0,n)}}},{key:"getBooleanSetting",value:function(e){return!!this.props.settings&&"true"===this.props.settings[e]}},{key:"getDefinition",value:function(){return this.state.definition}},{key:"renderContext",value:function(e){if(!e.showContext||!e.contextText||!e.contextText.length)return null;var t=de(this.props.strings.textFormatting,e.critiqueType,e.contextText,e.contextDecorations),n=yt(e,z.a.ReadContext),o=n?Object.assign(Object.assign({},w.f),{flexibleSize:!0}):w.f,i=C.createElement(W.a,{style:o,accessibleLive:G.a.Polite},C.createElement(he.a,{text:Object(lr.c)(e.contextText,a.contextMaxLength),style:w.C(this.getTheme(),this.getFontTable()),formatting:Object(ce.b)(e.contextText.length,this.getTheme(),e.contextDecorations),accessibilityLabel:t}));if(!n)return i;var r=this.getBooleanSetting("NoTooltipForReadContext")?void 0:ft(e,this.props.strings,z.a.ReadContext);return C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Center},i,ct(this.getDefinition(),this.getTheme(),z.a.ReadContext,w.hb(this.getFontTable()),this.props.strings,{action:"readcontext",context:t||e.contextText},void 0,void 0,r,void 0,void 0,void 0,this.props.automationId,this.props.onAction))}},{key:"getCardHeaderText",value:function(){var e=this.getDefinition(),t=void 0;switch(e.critiqueType){case z.c.Classification:t=this.props.strings.critique("sensitiveContentCardHeader");break;case z.c.Spelling:case z.c.RepeatedWord:t=this.props.strings.critique("spellingCardHeader");break;case z.c.Grammar:t=this.props.strings.critique("grammarCardHeader");break;case z.c.NeuralRewrite:t=this.getBooleanSetting("renderNRForAIFeedback")?void 0:this.props.strings.critique("neuralRewriteCardHeader");break;case z.c.SimilarityChecker:t=this.props.strings.critique("similarityCheckerCardHeader");break;case z.c.TonalRewrite:t=this.props.strings.critique("tonalRewriteCardHeader");break;case z.c.AccColorChecker:t=this.props.strings.critique("accColorCheckerCardHeader");break;default:t=this.props.definition.header}return e.showDictationCommandUx&&!t&&(t=this.props.strings.critique("dictationCorrectionsGroupTitle")),t}},{key:"getCardSubheaderText",value:function(){var e,t,n=this.getDefinition(),o=void 0;if(n.isBehindPaywall)return null===(t=(e=this.props.strings).premiumPreview)||void 0===t?void 0:t.call(e,"premiumPreviewSubheader");switch(n.critiqueType){case z.c.Spelling:o=void 0;break;case z.c.RepeatedWord:o=this.props.strings.critique("repeatedWordCardSubheader");break;case z.c.NeuralRewrite:o=this.getBooleanSetting("renderNRForAIFeedback")?this.props.strings.critique("aIFeedbackCardSubHeader"):this.props.strings.critique("neuralRewriteCardSubheader");break;case z.c.SimilarityChecker:o=this.props.strings.critique("similarityCheckerCardSubheader");break;case z.c.AccColorChecker:o=this.props.strings.critique("accColorCheckerCardSubheader");break;default:o=n.subheader}return n.showDictationCommandUx&&!o&&(o=this.props.strings.critique("dictationCorrectionCommandCardTitle")),o}},{key:"renderPreviewMarker",value:function(){return C.createElement(he.a,{text:this.props.strings.critique("previewHeaderLabel"),style:w.gb(this.getTheme(),this.getFontTable())})}},{key:"renderCardHeader",value:function(e){var t=e.critiqueType===z.c.NeuralRewrite||e.critiqueType===z.c.SimilarityChecker||e.critiqueType===z.c.TonalRewrite?this.renderPreviewMarker():void 0,n=this.getCardHeaderText(),o=n?C.createElement(he.a,{text:n,style:w.V(this.getTheme(),this.getFontTable()),accessibilityRole:"heading"}):null,i=o?this.getDefinition().showPremiumIcon?C.createElement(W.a,{direction:G.c.LeftToRight},C.createElement(me.a,{type:"PremiumDiamond",primaryColor:this.getTheme().header}),C.createElement(W.a,{style:{minWidth:6}}),o):o:null;return t?C.createElement(W.a,{align:G.b.Stretch,direction:G.c.LeftToRight},i,C.createElement(W.a,{style:{flexibleSize:!0,minWidth:16}}),t):i}},{key:"renderCardFooterTitle",value:function(e){return e.showDictationCommandUx&&this.props.strings.critique("dictationSpelloutCommandCardTitle"),null}},{key:"renderCardSubheader",value:function(){var e=this.getCardSubheaderText();return e?C.createElement(he.a,{text:e,style:w.sb(this.getTheme(),this.getFontTable()),accessibilityRole:"heading"}):null}},{key:"renderHeader",value:function(){var e=this.getDefinition();return C.createElement(W.a,{style:w.yb,align:G.b.Stretch},this.renderCardHeader(e),this.renderCardSubheader(),this.renderContext(e))}},{key:"getAllSuggestionOverflowActions",value:function(){switch(this.getDefinition().critiqueType){case z.c.Spelling:return[z.a.Accept,z.a.ReadAloud,z.a.SpellOut,z.a.ChangeAll,z.a.AddToAutoCorrect,z.a.AutoCorrectOptions];case z.c.Grammar:case z.c.Refinement:case z.c.NeuralRewrite:return[z.a.Accept,z.a.ReadAloud,z.a.SpellOut];case z.c.SimilarityChecker:return[z.a.LearnMore,z.a.ReadAloud,z.a.SpellOut];case z.c.AccColorChecker:return[z.a.LearnMore];default:return[]}}},{key:"shouldShowSuggestionDescription",value:function(e){return St(this.getDefinition(),z.a.Accept,e)&&this.getDefinition().showDescription&&e.subtitle&&e.subtitle.length>0}},{key:"getSuggestionButtonProps",value:function(e,t,n,o){var i=this,r=this.getDefinition(),s=this.getSuggestionButtonKind(r.critiqueType,e),a=r.critiqueType===z.c.Topic?"#".concat(e.title):e.title,l=a.length,c=bt(r,n,e),u=ut(r,this.props.strings,this.getTheme(),c,n,t),p=void 0!==o?{type:o}:void 0,d={title:a,titleStyle:void 0!==s&&n!==z.a.MoreSources?w.xb(this.getFontTable(),l):Object(ce.b)(l,this.getTheme(),e.titleDecorations),tag:e.tag,tagStyle:w.G(this.getFontTable()),icon:p,disabled:c,onClick:function(){var e,o;null===(o=(e=i.props).onAction)||void 0===o||o.call(e,n,t)},theme:w.B(this.getTheme(),s),strings:rt(this.props.strings.common),accessibilityRole:"menuitem",accessibilityLabel:this.getSuggestionAccessibilityLabel(e),automationLabel:"CritiqueSuggestionButton_"+e.id,badgeProps:u};return this.shouldShowSuggestionDescription(e)&&(d.subtitle=e.subtitle,d.subtitleStyle=w.ub(this.getFontTable())),d}},{key:"getSuggestionButtonKind",value:function(e,t){if(!(t.titleDecorations&&t.titleDecorations.length>0)){var n=this.getDefinition();if(n.isBehindPaywall)return n.actions&&-1!==n.actions.indexOf(z.a.RevealSuggestions)?"refinement":"suggestion";switch(e){case z.c.Grammar:return"grammar";case z.c.Refinement:case z.c.Topic:return"refinement";default:return"suggestion"}}}},{key:"getSuggestionAccessibilityLabel",value:function(e){var t=this.getDefinition(),n=e.tagAccessibilityLabel||e.tag||"";return t.critiqueType!==z.c.Spelling&&t.critiqueType!==z.c.NeuralRewrite||!t.showDescription||!e.subtitle||0===e.subtitle.trim().length?n?this.props.strings.critique("suggestionWithTagAccessibilityLabel").replace("{0}",n).replace("{1}",e.title):void 0:n&&t.critiqueType===z.c.Spelling?this.props.strings.critique("spellingSuggestionTagAndDescriptionAccessibilityLabel").replace("{0}",n).replace("{1}",e.title).replace("{2}",e.subtitle):(t.critiqueType===z.c.Spelling?this.props.strings.critique("spellingSuggestionDescriptionAccessibilityLabel"):this.props.strings.critique("neuralRewriteSuggestionAccessibilityLabel")).replace("{0}",e.title).replace("{1}",e.subtitle)}},{key:"renderSplitButtonSuggestion",value:function(e,t,n,o,i,r){var s=this.getTheme();return C.createElement(Ar,{key:e,ref:t,buttonProps:n,menuProps:o,style:w.Gb,theme:{splitMenuHoverBackground:s.suggestionMenuHoverBackground,splitMenuHoverForeground:s.suggestionMenuHoverForeground},strings:at(this.props.strings.common),accessibilityPositionInSet:void 0!==i?i:1,accessibilitySetSize:void 0!==r?r:1})}},{key:"renderSingleSuggestion",value:function(e,t,n,o,i,r,s,a){return[this.renderSplitButtonSuggestion(e,n,this.getSuggestionButtonProps({title:t,actions:i?[]:[o]},e,o,r),void 0,s,a)]}},{key:"renderActionListAsSuggestions",value:function(e){var t=this,n=this.getDefinition();return e.filter((function(e){return ft(n,t.props.strings,e)})).map((function(e,o,i){return t.renderSingleSuggestion(o,ft(n,t.props.strings,e),0===o?t.firstSuggestionRef:void 0,e,void 0,mt(e),o+1,i.length)[0]}))}},{key:"renderSpecialSuggestions",value:function(e,t){var n,o,i,r=this;if(e.critiqueType===z.c.RepeatedWord)return this.renderSingleSuggestion(0,this.props.strings.critique("deleteRepeatedWord"),this.firstSuggestionRef,t[0],!1,"Delete");if(e.critiqueType===z.c.SimilarityChecker)return this.renderActionListAsSuggestions(t);if(e.isBehindPaywall){var s=!e.actions||-1===(null===(n=e.actions)||void 0===n?void 0:n.indexOf(z.a.RevealSuggestions));return this.renderSingleSuggestion(0,(null===(i=(o=this.props.strings).premiumPreview)||void 0===i?void 0:i.call(o,"premiumPreviewSuggestionTitle"))||"",this.firstSuggestionRef,z.a.RevealSuggestions,s,"Wand")}return[C.createElement(hn,{key:0,shimmerCount:w.Kb,styles:w.vb(this.getSpacing()),render:function(){var e=r.renderSingleSuggestion(0,r.props.strings.common("suggestionsGroupLoadingSuggestionsText"),void 0,z.a.Accept,!0);return e.length>0?e[0]:null}})]}},{key:"renderSuggestions",value:function(){var e=this,t=this.getDefinition(),n=gt(t,this.props.strings);if(n)return this.renderSpecialSuggestions(t,n);var o=pt(t),i=o.map((function(n,i){var r=e.renderSplitButtonSuggestion(i,0===i?e.firstSuggestionRef:void 0,e.getSuggestionButtonProps(n,i,z.a.Accept,e.getSuggestionIcon(t.critiqueType,n,o.length)),lt(t,e.getTheme(),e.props.strings,e.getFontTable(),e.getAllSuggestionOverflowActions(),e.getBooleanSetting("NoTooltipForFooterOverflow"),void 0,i,e.props.automationId,e.props.onAction),i+1,o.length);return i>0&&n.tag!==o[i-1].tag?C.createElement(C.Fragment,null,C.createElement(qt.a,{key:i,color:e.props.theme&&e.props.theme.separator,style:w.Jb}),r):r}));return 0===i.length?this.renderSingleSuggestion(0,t.critiqueType===z.c.NeuralRewrite?this.props.strings.critique("neuralRewriteNoSuggestionsText"):this.props.strings.common("suggestionsGroupNoSuggestionsText"),void 0,z.a.Accept,!0):i}},{key:"getSuggestionIcon",value:function(e,t,n){return e===z.c.Classification&&1===n?"Delete":e===z.c.Grammar&&this.props.critiqueSource===o.Inference?"Cloud":e!==z.c.NeuralRewrite||St(this.getDefinition(),z.a.Accept,t)?void 0:"Info"}},{key:"renderSourceUrlAsHyperlink",value:function(e,t){return C.createElement(te.a,{url:e,theme:w.rb(this.getTheme()),style:w.pb(this.getFontTable()),text:t})}},{key:"renderSourceUrlAsText",value:function(e){return C.createElement(he.a,{text:e,style:w.qb(this.getTheme(),this.getFontTable())})}},{key:"renderSource",value:function(){var e=this.getDefinition(),t=this.props.sourceIndex||0;if(e.sources){var n=e.sources[t].sourceUrl,o=e.sources[t].sourceTitle;if(n&&o){var i=Object(lr.a)(n);return C.createElement(W.a,{style:w.Fb,align:G.b.Stretch},C.createElement(he.a,{text:o,style:w.ob(this.getFontTable(),this.getTheme())}),C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Baseline},C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Baseline,style:{flexibleSize:!0}},e.sourceUrlClickable?this.renderSourceUrlAsHyperlink(n,i):this.renderSourceUrlAsText(i)),C.createElement(he.a,{text:this.props.strings.critique("poweredByBing"),style:w.fb(this.getFontTable())})))}}}},{key:"generateButtonProps",value:function(e,t,n){var o=this;return{onClick:function(){o.props.onAction&&o.props.onAction(z.a.ApplyColor,n)},hoverRing:!0,style:w.z(),theme:w.A(e),automationLabel:"ColorPickerButton_".concat(this.props.automationId),tooltip:t}}},{key:"renderColors",value:function(){var e=this,t=(this.getDefinition().suggestions||[]).map((function(t,n){return C.createElement(U.a,Object.assign({key:t.id,ref:0===n?e.firstSuggestionButtonRef:void 0},e.generateButtonProps(t.title,t.subtitle,n)))}));return C.createElement(W.a,{align:G.b.Start,justifyContent:G.d.Start,style:w.c},C.createElement(he.a,{text:this.props.strings.critique("accColorCheckerSecondCardSubheader"),style:w.mb(this.getTheme(),this.getFontTable()),accessibilityRole:"heading"}),C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Start,justifyContent:G.d.Start,style:w.d},t))}},{key:"renderHelpLink",value:function(){var e=this.getDefinition();if(e.helpLink)return C.createElement(W.a,{direction:G.c.LeftToRight,style:w.Ab,align:G.b.Stretch},C.createElement(te.a,{text:e.helpLink.text,url:e.helpLink.url,theme:w.X(this.getTheme()),style:w.W(this.getFontTable())}))}},{key:"renderBodySuggestions",value:function(){var e=this.getDefinition().critiqueType!==z.c.SimilarityChecker?this.props.strings.critique("suggestionsGroupAccessibilityLabel"):void 0,t=this.renderSuggestions();return C.createElement(W.a,{align:G.b.Stretch,accessible:!0,accessibilityRole:"menu",accessibilityLabel:e},t)}},{key:"renderBody",value:function(){var e=this.getDefinition();return C.createElement(W.a,{align:G.b.Stretch},e.critiqueType===z.c.SimilarityChecker?this.renderSource():void 0,C.createElement(ee,null,e.critiqueType===z.c.AccColorChecker?this.renderColors():this.renderBodySuggestions()),this.renderHelpLink())}},{key:"renderFooterTitle",value:function(){var e=this.getDefinition(),t=this.renderCardFooterTitle(e);return t?C.createElement(W.a,{style:w.yb,align:G.b.Stretch},t):null}},{key:"renderAddOnFooter",value:function(){var e=this;if(!this.props.addOnFooterData)return null;var t,n,o=this.props.addOnFooterData,i={onClick:function(){var t,n;null===(n=(t=e.props).onAction)||void 0===n||n.call(t,z.a.AddOnFooterAction)},style:w.a,theme:dr(this.getTheme()),automationLabel:"AddonFooterButton_".concat(o.actionText,"_").concat(this.props.automationId)};return C.createElement(W.a,{style:(n=this.getTheme(),{paddingHorizontal:w.b,paddingVertical:9,backgroundColor:n.addOnFooterBackground}),direction:G.c.LeftToRight,align:G.b.Center,accessible:!0,accessibilityLabel:o.message},o.icon&&C.createElement(C.Fragment,null,C.createElement(me.a,{type:o.icon,primaryColor:gr(this.getTheme()),fontSize:(t=this.getFontTable(),t.xsmall)}),C.createElement(W.a,{style:{width:8}})),this.getAddOnFooterFormattedText(),C.createElement(W.a,{style:{width:4}}),C.createElement(U.a,Object.assign({},i),C.createElement(he.a,{text:o.actionText,style:ur(this.getTheme(),this.getFontTable(),!0)})))}},{key:"getAddOnFooterFormattedText",value:function(){if(this.props.addOnFooterData){var e=this.props.addOnFooterData;return C.createElement(he.a,{text:e.message,style:ur(this.getTheme(),this.getFontTable(),!1),formatting:e.footerDecorations?Object(ce.b)(e.message.length,this.getTheme(),e.footerDecorations):void 0})}}},{key:"getTheme",value:function(){return this.props.theme?this.props.theme:w.g}},{key:"getFontTable",value:function(){return this.props.fontTable?this.props.fontTable:w.h}},{key:"getSpacing",value:function(){return this.props.spacing?this.props.spacing:w.i}}])&&jr(t.prototype,n),r&&jr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(C.Component);Rr.contextMaxLength=120;var Br,Nr=n(1189);function Lr(e){return(Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pr(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Fr(e,t){return(Fr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Hr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Wr(e);if(t){var i=Wr(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return zr(this,n)}}function zr(e,t){if(t&&("object"===Lr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ur(e)}function Ur(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wr(e){return(Wr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e){e[e.Default=0]="Default",e[e.ReportRewriteSuggestions=1]="ReportRewriteSuggestions",e[e.Feedback=2]="Feedback"}(Br||(Br={}));var Gr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fr(e,t)}(r,e);var t,n,o,i=Hr(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=i.call(this,e)).reportSuggestionsRadioGroupRef=C.createRef(),t.innerCritiqueRef=C.createRef(),t.onRewriteSelectFeedbackSuggestion=t.onRewriteSelectFeedbackSuggestion.bind(Ur(t)),t.onRewriteReportSuggestionCancel=t.onRewriteReportSuggestionCancel.bind(Ur(t)),t.onRewriteReportSuggestionNext=t.onRewriteReportSuggestionNext.bind(Ur(t)),t.onCritiqueCardClick=t.onCritiqueCardClick.bind(Ur(t)),t.onFeedbackCardBack=t.onFeedbackCardBack.bind(Ur(t)),t.onFeedbackCardDismiss=t.onFeedbackCardDismiss.bind(Ur(t)),t.onFeedbackCardReport=t.onFeedbackCardReport.bind(Ur(t)),t.state={definition:e.definition,rewriteState:Br.Default,rewriteReportedSuggestionId:void 0,rewriteOption:void 0,rewriteChoiceGroupSelected:!1},t}return t=r,o=[{key:"isRewriteFeedbackNegative",value:function(e){return e!==Nr.a.FeedbackOptionHelpful}}],(n=[{key:"setDefinition",value:function(e){this.setState({definition:e})}},{key:"executeBadgedAction",value:function(e){this.innerCritiqueRef.current&&this.innerCritiqueRef.current.executeBadgedAction(e)}},{key:"componentDidUpdate",value:function(e,t){if(e.definition!==this.props.definition&&this.setState({definition:this.props.definition}),t.rewriteState!==this.state.rewriteState)switch(this.state.rewriteState){case Br.ReportRewriteSuggestions:this.reportSuggestionsRadioGroupRef.current&&this.reportSuggestionsRadioGroupRef.current.focus();break;default:this.innerCritiqueRef.current&&this.innerCritiqueRef.current.focus()}}},{key:"focus",value:function(){this.innerCritiqueRef.current&&this.innerCritiqueRef.current.focus()}},{key:"render",value:function(){var e=this,t=this.getDefinition();if(!t||!t.suggestions)return null;switch(this.state.rewriteState){case Br.Default:var n=t.suggestions.map((function(n){if(e.isSuggestionReportedNegative(n.title))return Object.assign(Object.assign({},n),{actions:n.actions.filter((function(e){return e!==z.a.Accept})),title:e.props.strings.neuralRewrite("neuralRewriteReportedSuggestionTitle"),subtitle:void 0,titleDecorations:void 0});if(void 0===n.titleDecorations&&t.contextText){var o=function(e,t){var n=t.length,o=function(e,t){for(var n=e.length,o=t.length,i=0,r=0,s=0;s<Math.min(n,o)&&e.charAt(s)===t.charAt(s);s++)i++,lr.b(e.charCodeAt(s))&&(r=i);return r}(e,t),i=Math.min(function(e,t){for(var n=e.length,o=t.length,i=0,r=0,s=0;s<Math.min(n,o)&&e.charAt(n-s-1)===t.charAt(o-s-1);s++)i++,lr.b(e.charCodeAt(n-s-1))&&(r=i);return r}(e,t),Math.min(n,e.length)-o),r=o+i,s=n-r,a=Math.min(130,s),l=Math.min(150-a,r),c=Math.min(l,o),u=Math.min(l,i),p=function(e,t,n){var o,i,r=e/2;return t<r&&n<r?(o=t,i=n):t<r?(o=t,i=Math.min(n,e-o)):n<r?(i=n,o=Math.min(t,e-i)):(o=r,i=r),{actualLeftContextLength:o,actualRightContextLength:i}}(l,c,u),d=p.actualLeftContextLength,g=p.actualRightContextLength,h=t.substring(o-d,o),f=t.substring(o,n-i),m=t.substring(n-i,n-i+g),y=h,b=f,v=m;if(o>d){var S=qr(h,0,h.length,!0);y="..."+h.substring(S,h.length)}if(f.length>a){var x=qr(f,0,a/2,!1),C=qr(f,a/2,f.length,!0);b=f.substring(0,x)+"..."+f.substring(C,f.length)}if(i>g){var T=qr(m,0,m.length,!1);v=m.substring(0,T)+"..."}return{truncatedPrefix:y,truncatedSubstring:b,truncatedSuffix:v,target:f,commonPrefixLength:o,commonSuffixLength:i}}(t.contextText,n.title),i=o.commonPrefixLength,r=o.commonSuffixLength;return Object.assign(Object.assign({},n),{titleDecorations:[{start:i,length:n.title.length-i-r,decorationType:z.e.Rewrite}]})}return n})),o=Object.assign(Object.assign({},this.props),{definition:Object.assign(Object.assign({},t),{suggestions:n}),onAction:this.onCritiqueCardClick});return C.createElement(Rr,Object.assign({},o,{ref:this.innerCritiqueRef}));case Br.Feedback:return this.renderFeedback();case Br.ReportRewriteSuggestions:return C.createElement(W.a,{direction:G.c.TopToBottom,style:w.lb(this.getTheme(),this.props.style),align:G.b.Stretch},this.renderHeader(),this.renderReportSuggestions(),this.renderFooter())}}},{key:"getDefinition",value:function(){return this.state.definition}},{key:"getTheme",value:function(){return this.props.theme||w.g}},{key:"getFontTable",value:function(){return this.props.fontTable||w.h}},{key:"getSpacing",value:function(){return this.props.spacing||w.i}},{key:"onCritiqueCardClick",value:function(e,t){e===z.a.Feedback&&this.setState({rewriteState:Br.ReportRewriteSuggestions,rewriteReportedSuggestionId:void 0,rewriteOption:void 0,rewriteChoiceGroupSelected:!1}),this.props.onAction&&this.props.onAction(e,t)}},{key:"onFeedbackCardDismiss",value:function(){this.setState({rewriteState:Br.Default})}},{key:"onFeedbackCardBack",value:function(){this.setState({rewriteState:Br.ReportRewriteSuggestions,rewriteChoiceGroupSelected:!0})}},{key:"renderFeedback",value:function(){var e=this.getDefinition(),t=this.getIndexOfReportedSuggestion(),n=Object.assign(Object.assign({},this.props),{style:void 0,reportedSuggestionIndex:t,showCheckbox:!0,definition:e,onBack:this.onFeedbackCardBack,onDismiss:this.onFeedbackCardDismiss,onReport:this.onFeedbackCardReport});return C.createElement(Nr.a,Object.assign({},n))}},{key:"isSuggestionReportedNegative",value:function(e){return r.suggestionsReportedNegative.indexOf(e)>=0}},{key:"isSuggestionAlreadyReported",value:function(e){return r.reportedSuggestions.indexOf(e)>=0}},{key:"renderReportSuggestions",value:function(){var e=this,t=this.getDefinition();if(!t||!t.suggestions)return null;var n=t.suggestions.filter((function(e){return!(!e||!e.id&&t.critiqueType!==z.c.Grammar||!e.title)})).map((function(n){var o,i=n,r=i.title,s=e.isSuggestionReportedNegative(r),a=e.isSuggestionAlreadyReported(r);return t.critiqueType===z.c.Grammar&&(i.id=null===(o=t.suggestions)||void 0===o?void 0:o.indexOf(i).toString()),{key:i.id,disabled:a,text:s?e.props.strings.neuralRewrite("neuralRewriteReportedSuggestionTitle"):r}})).filter((function(e,t){return t<w.Bb}));return 0===n.length?null:C.createElement(cr.a,{onChange:this.onRewriteSelectFeedbackSuggestion,styles:w.Hb,radioChoiceTextStyles:w.kb(this.getTheme()),options:n,ref:this.reportSuggestionsRadioGroupRef,defaultSelectedKey:this.state.rewriteReportedSuggestionId,accessibilityLabel:this.props.strings.feedback("neuralRewriteFeedbackDialogChooseSuggestionTitle")})}},{key:"onRewriteSelectFeedbackSuggestion",value:function(e){e&&this.setState({rewriteReportedSuggestionId:e.key,rewriteChoiceGroupSelected:!0})}},{key:"renderHeader",value:function(){var e=this.getTheme(),t=this.getFontTable(),n=this.props.definition.critiqueType===z.c.Grammar?this.props.strings.feedback("grammarFeedbackDialogChooseSuggestionTitle"):this.props.strings.feedback("neuralRewriteFeedbackDialogChooseSuggestionTitle");return C.createElement(W.a,{direction:G.c.TopToBottom,style:w.zb,align:G.b.Stretch,accessibleLive:G.a.Polite},C.createElement(he.a,{text:n,style:w.sb(e,t),accessibilityRole:"heading"}),C.createElement(he.a,{text:this.props.strings.feedback("neuralRewriteFeedbackDialogChooseSuggestionDescription"),style:w.H(e,t),accessibilityRole:"text"}))}},{key:"renderFooterButton",value:function(e,t,n,o,i){return C.createElement(U.a,{title:e,titleStyle:w.S(this.getFontTable(),e.length),onClick:t,theme:w.jb(this.getTheme(),o),disabled:n,style:w.w,ref:i,automationLabel:"CritiqueActionButton_".concat(e,"_").concat(this.props.automationId)})}},{key:"renderFooter",value:function(){return C.createElement(W.a,{direction:G.c.TopToBottom,justifyContent:G.d.SpaceBetween,style:w.o,align:G.b.Stretch},C.createElement(W.a,{direction:G.c.LeftToRight,justifyContent:G.d.End,style:w.v,align:G.b.Stretch},this.renderFooterButton(this.props.strings.common("cancelButton"),this.onRewriteReportSuggestionCancel),C.createElement(W.a,{style:{minWidth:this.getSpacing().small}}),this.renderFooterButton(this.props.strings.common("nextButton"),this.onRewriteReportSuggestionNext,!this.state.rewriteChoiceGroupSelected,!0)))}},{key:"onRewriteReportSuggestionCancel",value:function(){this.setState({rewriteState:Br.Default,rewriteReportedSuggestionId:void 0,rewriteChoiceGroupSelected:!1})}},{key:"onRewriteReportSuggestionNext",value:function(){this.setState({rewriteState:Br.Feedback,rewriteChoiceGroupSelected:!1})}},{key:"getIndexOfReportedSuggestion",value:function(){var e=this.state.rewriteReportedSuggestionId,t=this.getDefinition();if(t.suggestions)for(var n=0;n<t.suggestions.length;n++){var o=t.suggestions[n];if(o&&o.id===e)return o&&o.title?n:-1}}},{key:"onFeedbackCardReport",value:function(e,t){var n=this.getDefinition();if(this.state.rewriteReportedSuggestionId&&n.suggestions){var o=this.getIndexOfReportedSuggestion();if(void 0!==o){var i=n.suggestions[o].title;this.props.onAction&&this.props.onAction(z.a.Report,o,{action:"feedback",type:n.critiqueType,option:e.option,comments:e.comments,payload:e.payload}),this.isSuggestionAlreadyReported(i)||n.critiqueType===z.c.Grammar||r.reportedSuggestions.push(i),void 0!==e.option&&r.isRewriteFeedbackNegative(e.option)&&!this.isSuggestionReportedNegative(i)&&n.critiqueType!==z.c.Grammar&&r.suggestionsReportedNegative.push(i),this.setState({rewriteReportedSuggestionId:void 0,rewriteChoiceGroupSelected:!1})}}}}])&&Pr(t.prototype,n),o&&Pr(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(C.Component);function qr(e,t,n,o){if(o){for(;!lr.b(e.charCodeAt(t))&&t<n;)++t;return t}for(var i=n;!lr.b(e.charCodeAt(n))&&n>t;)--n;return n+1<=i&&++n,n}function Vr(e){var t,n=Zr(e.strings,null!==(t=e.credits)&&void 0!==t?t:0),o=n.text,i=n.textDecorations;return C.createElement(he.a,{text:o,accessibilityLabel:o,style:pr(e.theme,e.fontTable,!1),formatting:Object(ce.b)(o.length,e.theme,i)})}function Zr(e,t){var n,o=e(1===t?"premiumPreviewAddOnHeaderTextSingular":"premiumPreviewAddOnHeaderText"),i=[];return t?(i=[{decorationType:z.e.PremiumPreviewCredits,start:o.indexOf("{0}"),length:t.toString().length}],n=o.replace("{0}",t.toString())):n=e("premiumPreviewAddOnHeaderNoCredits"),{text:n,textDecorations:i}}function Qr(e){return(Qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yr(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Kr(e,t){return(Kr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Xr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=$r(e);if(t){var i=$r(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return Jr(this,n)}}function Jr(e,t){if(t&&("object"===Qr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $r(e){return($r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Gr.reportedSuggestions=[],Gr.suggestionsReportedNegative=[];var es=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kr(e,t)}(r,e);var t,n,o,i=Xr(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=i.call(this,e)).onClick=function(e,n,o,i){var r,s,a=t.props,l=a.children,c=a.definition;if(null===(s=(r=l.props).onAction)||void 0===s||s.call(r,e,n,o,i),e===z.a.RevealSuggestions){var u=t.props.definition.credits;c.credits=u?u-1:0,t.setState({isRevealed:!0})}},t.state={isRevealed:!1},t}return t=r,(n=[{key:"render",value:function(){var e=this.props.style;return C.createElement(W.a,{align:G.b.Stretch,style:w.lb(this.getTheme(),e)},this.renderAddOnHeader(),this.renderCritiqueChild())}},{key:"renderCritiqueChild",value:function(){return this.state.isRevealed?this.props.children:C.createElement(Rr,{definition:this.premiumCritiqueDefinition(),onAction:this.onClick,strings:this.props.strings,theme:this.props.theme})}},{key:"renderAddOnHeader",value:function(){var e,t=this.props.strings.premiumPreview,n=this.props.definition.credits,o=t("premiumPreviewUpgradeEditor"),i=Zr(t,n).text,r=this.props,s=r.onAction,a=r.automationId,l={onClick:function(){null==s||s(z.a.GoPremium)},style:w.a,theme:dr(this.getTheme()),automationLabel:"AddonHeaderButton_".concat(o,"_").concat(a)};return C.createElement(W.a,{style:(e=this.getTheme(),{paddingHorizontal:w.b,paddingVertical:10,backgroundColor:e.addOnHeaderBackground,borderRadius:6}),direction:G.c.LeftToRight,align:G.b.Center,accessible:!0,accessibilityLabel:i},C.createElement(me.a,{type:"PremiumDiamond",primaryColor:gr(this.getTheme()),fontSize:this.getFontTable().medium}),C.createElement(W.a,{style:{width:8}}),C.createElement(Vr,{fontTable:this.getFontTable(),strings:t,theme:this.getTheme(),credits:n||0}),C.createElement(W.a,{style:{width:4}}),C.createElement(U.a,Object.assign({},l),C.createElement(he.a,{text:o,style:pr(this.getTheme(),this.getFontTable(),!0)})))}},{key:"premiumCritiqueDefinition",value:function(){var e=this,t=[z.a.Previous,z.a.Next,z.a.OpenEditorPane].filter((function(t){var n;return-1!==(null===(n=e.props.definition.actions)||void 0===n?void 0:n.indexOf(t))}));this.props.definition.credits&&t.push(z.a.RevealSuggestions);var n=this.props.definition,o=n.critiquePosition,i=n.critiqueSetSize,r=n.brandingMode;return{critiqueType:n.critiqueType,header:n.header,definitionType:"CritiqueDefinition",suggestions:[],actions:t,critiquePosition:o,critiqueSetSize:i,brandingMode:r,isBehindPaywall:!0}}},{key:"getTheme",value:function(){var e=this.props.theme;return e||w.g}},{key:"getFontTable",value:function(){var e=this.props.fontTable;return e||w.h}}])&&Yr(t.prototype,n),o&&Yr(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}(C.Component),ts={backButton:"BackButton",cancelButton:"CancelButton",closeButton:"CloseButton",defaultOverflowButtonAccessibilityLabel:"defaultOverflowButtonAccessibilityLabel",defaultSplitButtonOverflowAccessibilityLabel:"DefaultSplitButtonOverflowAccessibilityLabel",doneButton:"DoneButton",nextButton:"NextButton",oneOfManyChoiceButtonAccessibilityLabelAugment:"OneOfManyChoiceButtonAccessibilityLabelAugment",submitButton:"SubmitButton",suggestionsGroupLoadingSuggestionsText:"SuggestionsGroupLoadingSuggestionsText",suggestionsGroupNoSuggestionsText:"SuggestionsGroupNoSuggestionsText",voiceOverSplitButton2AccessibilityHint:"VoiceOverSplitButton2AccessibilityHint"},ns={accAssistant:"AccAssistant",accColorCheckerCardHeader:"AccColorCheckerCardHeader",accColorCheckerCardSubheader:"AccColorCheckerCardSubheader",accColorCheckerSecondCardSubheader:"AccColorCheckerSecondCardSubheader",accessibilityLabelForEditorButton:"AccessibilityLabelForEditorButton",addInTextCitation:"InlineCitationButtonText",addToAutoCorrect:"addToAutoCorrect",addToDictionary:"addToDictionary",allowAccIssue:"AllowAccIssue",allowAllAccIssues:"AllowAllAccIssues",autoCorrectOptions:"autoCorrectOptions",changeAll:"changeAll",copyFullCitation:"FullCitationButtonText",deleteRepeatedWord:"DeleteRepeatedWord",dictationCorrectionCommandCardTitle:"DictationCorrectionCommandCardTitle",dictationCorrectionsGroupTitle:"DictationCorrectionsGroupTitle",dictationSpelloutCommandCardTitle:"DictationSpelloutCommandCardTitle",editorButtonText:"EditorButtonText",editorButtonCiqPreviewTooltipContent:"EditorButtonCiqPreviewTooltipContent",editorButtonTooltipContent:"EditorButtonTooltipContent",explanationFlyoutAccessibilityLabel:"ExplanationFlyoutAccessibilityLabel",footerExplanationButtonAccessibilityLabel:"FooterExplanationButtonAccessibilityLabel",footerSeeMoreActionsAccessibilityLabel:"OverflowButtonAccessibilityLabel",giveFeedbackButtonText:"GiveFeedbackButtonText",grammarCardHeader:"GrammarCardHeader",hideContext:"HideContextButtonText",hideExplanationButtonText:"HideExplanationButtonText",hideSynonyms:"HideSynonymsButtonText",ignoreAll:"IgnoreAllButtonText",ignoreOnce:"IgnoreButtonText",ignoreRule:"ignoreRule",learnMore:"LearnMoreButtonText",microsoftEditorBranding:"MicrosoftEditorBranding",microsoftEditorBrandingAccessibilityLabel:"MicrosoftEditorBrandingAccessibilityLabel",moreColors:"MoreColors",moreSources:"MoreSources",neuralRewriteCardHeader:"NeuralRewriteCardHeader",neuralRewriteCardSubheader:"NeuralRewriteCardSubheader",neuralRewriteNoSuggestionsText:"NeuralRewriteNoSuggestionsText",neuralRewriteSuggestionAccessibilityLabel:"NeuralRewriteSuggestionAccessibilityLabel",nextIssue:"NextButtonText",nextIssueWithCount:"NextIssueWithCount",options:"OptionsButtonText",poweredByBing:"PoweredByBing",previewHeaderLabel:"PreviewHeaderLabel",previousIssue:"PreviousButtonText",previousIssueWithCount:"PreviousIssueWithCount",readAloud:"",readAloudOriginalSentenceAccessibilityLabel:"",repeatedWordCardSubheader:"RepeatedWordCardSubheader",sensitiveContentCardHeader:"SensitiveContentCardHeader",showContext:"ShowContextButtonText",showExplanationButtonText:"ShowExplanationButtonText",showMenuButtonText:"ShowMenuButtonText",showSynonyms:"ShowSynonymsButtonText",similarityCheckerCardHeader:"SimilarityCheckerCardHeader",similarityCheckerCardSubheader:"SimilarityCheckerCardSubheader",spellOut:"spellOut",spellingCardHeader:"SpellingCardHeader",spellingSuggestionDescriptionAccessibilityLabel:"spellingSuggestionDescriptionAccessibilityLabel",spellingSuggestionTagAndDescriptionAccessibilityLabel:"SpellingSuggestionTagAndDescriptionAccessibilityLabel",suggestionWithTagAccessibilityLabel:"SuggestionWithTagAccessibilityLabel",suggestionsGroupAccessibilityLabel:"suggestionsGroupAccessibilityLabel",tonalRewriteCardHeader:"TonalRewriteCardHeader",turnOffAccChecker:"TurnOffAccChecker"},os={contrastIssueExplanation:"ContrastIssueExplanation",contrastIssueExplanationTitle:"ContrastIssueExplanationTitle",exampleText:"ExampleText",explanationTableAccessibilityLabel:"ExplanationTableAccessibilityLabel",explanationTableAfter:"ExplanationTableAfter",explanationTableBefore:"ExplanationTableBefore",explanationTableSeparator:"ExplanationTableSeparator",goodContrast:"GoodContrast",poorContrast:"PoorContrast"},is={accColorsFeedbackDialogChooseOptionTitle:"AccColorsFeedbackDialogChooseOptionTitle",accColorsFeedbackHelpfulLabel:"AccColorsFeedbackHelpfulLabel",accColorsFeedbackNotHelpfulLabel:"AccColorsFeedbackNotHelpfulLabel",accColorsFeedbackOtherLabel:"AccColorsFeedbackOtherLabel",grammarFeedbackConfirmationDialogTitle:"NeuralRewriteFeedbackConfirmationDialogTitle",grammarFeedbackDialogCheckboxLabel:"GrammarFeedbackDialogCheckboxLabel",grammarFeedbackDialogChooseOptionTitle:"GrammarFeedbackDialogChooseOptionTitle",grammarFeedbackDialogChooseSuggestionTitle:"GrammarFeedbackDialogChooseSuggestionTitle",grammarFeedbackDialogDescription:"GrammarFeedbackDialogDescription",grammarSuggestionLabel:"GrammarSuggestionLabel",neuralRewriteFeedbackConfirmationDialogSubTitle:"NeuralRewriteFeedbackConfirmationDialogSubTitle",neuralRewriteFeedbackConfirmationDialogTitle:"NeuralRewriteFeedbackConfirmationDialogTitle",neuralRewriteFeedbackDialogCheckboxLabel:"NeuralRewriteFeedbackDialogCheckboxLabel",neuralRewriteFeedbackDialogChooseOptionTitle:"NeuralRewriteFeedbackDialogChooseOptionTitle",neuralRewriteFeedbackDialogChooseSuggestionDescription:"NeuralRewriteFeedbackDialogChooseSuggestionDescription",neuralRewriteFeedbackDialogChooseSuggestionTitle:"NeuralRewriteFeedbackDialogChooseSuggestionTitle",neuralRewriteFeedbackDialogDescription:"NeuralRewriteFeedbackDialogDescription",neuralRewriteFeedbackDialogPrivacyStatementLabel:"NeuralRewriteFeedbackDialogPrivacyStatementLabel",neuralRewriteFeedbackDialogPrivacyStatementURL:"NeuralRewriteFeedbackDialogPrivacyStatementURL",neuralRewriteFeedbackDialogTextBoxPlaceholder:"NeuralRewriteFeedbackDialogTextBoxPlaceholder",originalSentenceLabel:"OriginalSentenceLabel",provideAccColorsFeedbackHeaderText:"ProvideAccColorsFeedbackHeaderText",provideFeedbackHeaderText:"ProvideFeedbackHeaderText",rewriteSuggestionLabel:"RewriteSuggestionLabel",similarityFeedbackConfirmationDialogSubTitle:"SimilarityFeedbackConfirmationDialogSubTitle",similarityFeedbackConfirmationDialogTitle:"SimilarityFeedbackConfirmationDialogTitle",similarityFeedbackDialogChooseOptionTitle:"SimilarityFeedbackDialogChooseOptionTitle",similarityFeedbackHelpfulLabel:"SimilarityFeedbackHelpfulLabel",similarityFeedbackIncludeDocumentTextAndSourceUrl:"SimilarityFeedbackIncludeDocumentTextAndSourceUrl",similarityFeedbackOffensiveContentLabel:"SimilarityFeedbackOffensiveContentLabel",similarityFeedbackOriginalContentLabel:"SimilarityFeedbackOriginalContentLabel",similarityFeedbackOtherLabel:"SimilarityFeedbackOtherLabel",similarityFeedbackWrongSourceLabel:"SimilarityFeedbackWrongSourceLabel",similarityfeedbackOptionsAccessibilityLabel:"SimilarityfeedbackOptionsAccessibilityLabel",suggestionFeedbackConsumerPrivacyNotice:"SuggestionFeedbackConsumerPrivacyNotice",suggestionFeedbackHelpfulLabel:"SuggestionFeedbackHelpfulLabel",suggestionFeedbackOffensiveLabel:"SuggestionFeedbackOffensiveLabel",suggestionFeedbackOtherLabel:"SuggestionFeedbackOtherLabel",suggestionFeedbackWrongLabel:"SuggestionFeedbackWrongLabel"},rs={neuralRewriteReportedSuggestionTitle:"NeuralRewriteReportedSuggestionTitle"},ss={premiumPreviewAddOnHeaderNoCredits:"premiumPreviewAddOnHeaderNoCredits",premiumPreviewAddOnHeaderText:"premiumPreviewAddOnHeaderText",premiumPreviewAddOnHeaderTextSingular:"premiumPreviewAddOnHeaderTextSingular",premiumPreviewSubheader:"premiumPreviewSubheader",premiumPreviewSuggestionTitle:"premiumPreviewSuggestionTitle",premiumPreviewUpgradeEditor:"premiumPreviewUpgradeEditor"},as={contextAccessibilityLabelForCorrection:"ContextAccessibilityLabelForCorrection",contextAccessibilityLabelForGrammar:"ContextAccessibilityLabelForGrammar",contextAccessibilityLabelForRefinement:"ContextAccessibilityLabelForRefinement",contextAccessibilityLabelForRepeatedWord:"ContextAccessibilityLabelForRepeatedWord",contextAccessibilityLabelForSpelling:"ContextAccessibilityLabelForSpelling"},ls={clearSearchLabel:"ClearSearchLabel",somethingWentWrongLabel:"SomethingWentWrongLabel",tryAgainLabel:"TryAgainLabel",seeMoreHyperLinkLabel:"SeeMoreHyperLinkLabel"},cs={undoInsertSummary:"UndoInsertSummary",refreshSummary:"RefreshSummary",giveFeedback:"GiveFeedbackButtonText",copilot:"copilot",raiTooltip:"raiTooltip"};function us(e){return{common:function(t){return e[ts[t]]},critique:function(t){return e[ns[t]]},critiqueExplanation:function(t){return e[os[t]]},feedback:function(t){return"suggestionFeedbackFactuallyIncorrectLabel"===t||"writersUnblockDialogCheckboxLabel"===t||"writersUnblockFeedbackConfirmationDialogSubTitle"===t||"writersUnblockFeedbackConfirmationDialogTitle"===t||"writersUnblockFeedbackDialogChooseOptionTitle"===t||"writersUnblockFeedbackDialogDescription"===t?"":e[is[t]]},neuralRewrite:function(t){return e[rs[t]]},premiumPreview:function(t){return e[ss[t]]},textFormatting:function(t){return e[as[t]]},inlineSuggestions:function(t){return"suggestionsGroupSearchResultAccessibilityLabel"===t?"":e[ls[t]]},summarization:function(t){return e[cs[t]]}}}function ps(e,t){if(t&&e&&e.length)return e.map((function(e){return e?{start:e.start,length:e.length,decorationType:bs(e)}:void 0})).filter((function(e){return!!e}))}function ds(e){return e?e.filter((function(e){return!!e})).map((function(e){return{id:(t=e).id||void 0,title:t.title||"",titleDecorations:ps(t.titleFormatting,t.title),subtitle:t.description||void 0,actions:hs(t.supportedActions)};var t})):[]}function gs(e,t,n,o){if("Type-AIFeedbackRewrite"===o){var i=[z.a.Accept];return fs(e,Fo.Report)&&i.push(z.a.Feedback),i}var r=[z.a.Accept,z.a.Feedback,z.a.IgnoreOnce,z.a.Next,z.a.Previous,z.a.ToggleContext,z.a.ToggleDescription];return t===z.c.Spelling&&fs(e,Fo.AddToDictionary)&&r.push(z.a.AddToDictionary),t===z.c.Grammar||t===z.c.Refinement?fs(e,Fo.Options)&&r.push(z.a.Options):r.push(z.a.IgnoreAll),(fs(e,Fo.OpenEditorPane)||n)&&r.push(z.a.OpenEditorPane),t===z.c.Refinement&&"b1634cf9-5f68-42f4-82ca-e668f893d28f"!==o&&(r=r.filter((function(e){return e!==z.a.Feedback}))),t===z.c.DictationCorrection&&(r=hs(e)),r}function hs(e){return e?e.map((function(e){return function(e){switch(e){case Fo.Apply:case Fo.Accepted:return z.a.Accept;case Fo.IgnoreOnce:return z.a.IgnoreOnce;case Fo.IgnoreAll:return z.a.IgnoreAll;case Fo.Options:return z.a.Options;case Fo.Next:return z.a.Next;case Fo.Back:return z.a.Previous;case Fo.OpenEditorPane:return z.a.OpenEditorPane;case Fo.InvokeOnAddOnFooter:return z.a.AddOnFooterAction;case Fo.ShowExplanation:return z.a.ShowExplanation;case Fo.AddToDictionary:return z.a.AddToDictionary}return null}(e)})).filter((function(e){return null!=e})):[]}function fs(e,t){return!!e&&t&&-1!==e.findIndex((function(e){return e===t}))}function ms(e){switch(e){case z.a.Accept:return Fo.Apply;case z.a.IgnoreOnce:return Fo.IgnoreOnce;case z.a.IgnoreAll:return Fo.IgnoreAll;case z.a.Options:return Fo.Options;case z.a.Next:return Fo.Next;case z.a.Previous:return Fo.Previous;case z.a.ToggleContext:case z.a.ToggleDescription:return Fo.Toggle;case z.a.Report:return Fo.Report;case z.a.OpenEditorPane:return Fo.OpenEditorPane;case z.a.AddOnFooterAction:return Fo.InvokeOnAddOnFooter;case z.a.ShowExplanation:return Fo.ShowExplanation;case z.a.AddToDictionary:return Fo.AddToDictionary;case z.a.Feedback:return Fo.GiveFeedback;case z.a.RevealSuggestions:return Fo.RevealSuggestions}return null}function ys(e){if(e&&e.actionText&&e.labelText)return{message:e.labelText,actionText:e.actionText}}function bs(e){switch(e.underlineType){case zo.SpellingSquiggle:return z.e.Spelling;case zo.GrammarSquiggle:return z.e.Grammar;case zo.CritiqueSquiggle:return z.e.Refinement}return e.cssColor===ui?z.e.Rewrite:z.e.None}function vs(e){if((null==e?void 0:e.url)&&(null==e?void 0:e.text))return{url:e.url,text:e.text}}var Ss,xs=function(){return C.createElement("img",{style:{marginRight:"7px"},src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTEiIHZpZXdCb3g9IjAgMCAxNCAxMSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTAuMTQ2NDQ3IDQuODUzNTVDLTAuMDQ4ODE1NSA0LjY1ODI5IC0wLjA0ODgxNTUgNC4zNDE3MSAwLjE0NjQ0NyA0LjE0NjQ1TDQuMTQ2NDUgMC4xNDY0NDZDNC4zNDE3MSAtMC4wNDg4MTU1IDQuNjU4MjkgLTAuMDQ4ODE1NSA0Ljg1MzU1IDAuMTQ2NDQ2TDguODUzNTUgNC4xNDY0NUM5LjA0ODgyIDQuMzQxNzEgOS4wNDg4MiA0LjY1ODI5IDguODUzNTUgNC44NTM1NUM4LjY1ODI5IDUuMDQ4ODIgOC4zNDE3MSA1LjA0ODgyIDguMTQ2NDUgNC44NTM1NUw1IDEuNzA3MTFWOEM1IDkuMTA0NTcgNS44OTU0MyAxMCA3IDEwTDEzLjUgMTBDMTMuNzc2MSAxMCAxNCAxMC4yMjM5IDE0IDEwLjVDMTQgMTAuNzc2MSAxMy43NzYxIDExIDEzLjUgMTFMNyAxMUM1LjM0MzE1IDExIDQgOS42NTY4NSA0IDhMNCAxLjcwNzExTDAuODUzNTUzIDQuODUzNTVDMC42NTgyOTEgNS4wNDg4MiAwLjM0MTcwOSA1LjA0ODgyIDAuMTQ2NDQ3IDQuODUzNTVaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K"})},Cs=function(){return C.createElement("svg",{viewBox:"0 0 16 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},C.createElement("g",{"clip-path":"url(#clip0_2770_459598)"},C.createElement("path",{d:"M6.19594 0.921875L1.49974 3.63385C0.571684 4.16979 0 5.16009 0 6.23178V11.7682C0 12.8398 0.571643 13.8301 1.49965 14.366L3.76712 15.6756L3.99007 15L8.23734 12.4567L6.49965 11.4531C5.57164 10.9172 5 9.9269 5 8.85525V7.27344L5.46563 6.67953L6.99999 5.49176V2L6.32422 1.01172L5.58517 1.53879C5.75624 1.30668 5.96137 1.09837 6.19594 0.921875Z",fill:"url(#paint0_linear_2770_459598)"}),C.createElement("path",{d:"M6.19594 0.921875L1.49974 3.63385C0.571684 4.16979 0 5.16009 0 6.23178V11.7682C0 12.8398 0.571643 13.8301 1.49965 14.366L3.76712 15.6756L3.99007 15L8.23734 12.4567L6.49965 11.4531C5.57164 10.9172 5 9.9269 5 8.85525V7.27344L5.46563 6.67953L6.99999 5.49176V2L6.32422 1.01172L5.58517 1.53879C5.75624 1.30668 5.96137 1.09837 6.19594 0.921875Z",fill:"url(#paint1_linear_2770_459598)"}),C.createElement("path",{d:"M10.9988 6.61523V8.85594C10.9988 9.92759 10.4271 10.9179 9.49914 11.4538L4.49914 14.3415C3.57076 14.8776 2.42682 14.8776 1.49844 14.3415L1.19531 14.1664C1.29151 14.2387 1.39266 14.3057 1.49844 14.3668L6.49844 17.2545C7.42682 17.7906 8.57076 17.7906 9.49914 17.2545L14.4991 14.3668C15.4271 13.8309 15.9988 12.8406 15.9988 11.769V9.68789L10.9988 6.61523Z",fill:"url(#paint2_radial_2770_459598)"}),C.createElement("path",{d:"M10.9988 6.61523V8.85594C10.9988 9.92759 10.4271 10.9179 9.49914 11.4538L4.49914 14.3415C3.57076 14.8776 2.42682 14.8776 1.49844 14.3415L1.19531 14.1664C1.29151 14.2387 1.39266 14.3057 1.49844 14.3668L6.49844 17.2545C7.42682 17.7906 8.57076 17.7906 9.49914 17.2545L14.4991 14.3668C15.4271 13.8309 15.9988 12.8406 15.9988 11.769V9.68789L10.9988 6.61523Z",fill:"url(#paint3_linear_2770_459598)"}),C.createElement("path",{d:"M6.19524 0.921668L6.49974 0.745824C7.42807 0.209725 8.57193 0.209726 9.50026 0.745825L14.5003 3.63324C15.4283 4.16918 16 5.15948 16 6.23117V11.7675C16 11.7881 15.9998 11.8087 15.9994 11.8293C15.9779 10.7814 15.4105 9.8187 14.5003 9.29307L9.50026 6.40565C8.57193 5.86955 7.42807 5.86954 6.49974 6.40564L5 7.27172V3.31815C5 2.36919 5.44824 1.48405 6.19524 0.921668Z",fill:"url(#paint4_radial_2770_459598)"}),C.createElement("path",{d:"M6.19524 0.921668L6.49974 0.745824C7.42807 0.209725 8.57193 0.209726 9.50026 0.745825L14.5003 3.63324C15.4283 4.16918 16 5.15948 16 6.23117V11.7675C16 11.7881 15.9998 11.8087 15.9994 11.8293C15.9779 10.7814 15.4105 9.8187 14.5003 9.29307L9.50026 6.40565C8.57193 5.86955 7.42807 5.86954 6.49974 6.40564L5 7.27172V3.31815C5 2.36919 5.44824 1.48405 6.19524 0.921668Z",fill:"url(#paint5_linear_2770_459598)"})),C.createElement("defs",null,C.createElement("linearGradient",{id:"paint0_linear_2770_459598",x1:"7.09324",y1:"4.8282",x2:"2.74492",y2:"17.4869",gradientUnits:"userSpaceOnUse"},C.createElement("stop",{"stop-color":"#AE7FE2"}),C.createElement("stop",{offset:"1","stop-color":"#0078D4"})),C.createElement("linearGradient",{id:"paint1_linear_2770_459598",x1:"5.44306",y1:"14.2211",x2:"4.6907",y2:"12.8939",gradientUnits:"userSpaceOnUse"},C.createElement("stop",{offset:"0.9999","stop-color":"#114A8B"}),C.createElement("stop",{offset:"1","stop-color":"#0078D4","stop-opacity":"0"})),C.createElement("radialGradient",{id:"paint2_radial_2770_459598",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(3.14608 13.7577) rotate(-13.0688) scale(12.7772 9.84272)"},C.createElement("stop",{offset:"0.140029","stop-color":"#D59DFF"}),C.createElement("stop",{offset:"1","stop-color":"#5E438F"})),C.createElement("linearGradient",{id:"paint3_linear_2770_459598",x1:"13.826",y1:"8.8471",x2:"13.1058",y2:"10.0024",gradientUnits:"userSpaceOnUse"},C.createElement("stop",{offset:"0.9999","stop-color":"#493474"}),C.createElement("stop",{offset:"1","stop-color":"#8C66BA","stop-opacity":"0"})),C.createElement("radialGradient",{id:"paint4_radial_2770_459598",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(14.5411 9.31795) rotate(-143.083) scale(11.412)"},C.createElement("stop",{"stop-color":"#50E6FF"}),C.createElement("stop",{offset:"1","stop-color":"#436DCD"})),C.createElement("linearGradient",{id:"paint5_linear_2770_459598",x1:"5.0174",y1:"4.56496",x2:"6.18205",y2:"4.56496",gradientUnits:"userSpaceOnUse"},C.createElement("stop",{offset:"0.9999","stop-color":"#114A8B"}),C.createElement("stop",{offset:"1","stop-color":"#0078D4","stop-opacity":"0"})),C.createElement("clipPath",{id:"clip0_2770_459598"},C.createElement("rect",{width:"16",height:"18",fill:"white"}))))},Ts={fontFamily:"Segoe UI",fontStyle:"normal",fontWeight:"600",fontSize:"12px",lineHeight:"16px",verticalAlign:"middle",padding:"0px 12px 0px 6px"},ws={display:"flex",height:"16px",padding:"4px"},Os={root:{height:"24px",width:"24px",fontSize:"12px",lineHeight:"16px",borderRadius:"4px",marginLeft:"3px",padding:"0px",border:"0px solid transparent",minWidth:"24px",background:"transparent"},menuIcon:{display:"none"}},ks=function(e){var t;return{root:{height:"24px",width:"82px",fontSize:"12px",lineHeight:"16px",borderRadius:"4px",marginRight:"3px",background:null===(t=e.primaryButtonBackground)||void 0===t?void 0:t.resting,color:"#FFF"},rootHovered:{color:"#FFF"}}},As={width:"auto",display:"flex",justifyContent:"space-between",padding:"12px"},Is=n(2421),js=function(e){var t,n,o,i,r,s,a=e.definition,c=function(){return e.theme?e.theme:w.g},u=function(){return e.fontTable?e.fontTable:w.h},p=C.createElement(W.a,{style:w.yb,align:G.b.Stretch},C.createElement(he.a,{text:"Here's an idea based on the suggestion",style:Object(w.sb)(c(),u()),accessibilityRole:"heading"})),d=function(t,n,o){return{title:t.title,titleStyle:Object(ce.b)(t.title.length,c(),t.titleDecorations),tag:t.tag,tagStyle:Object(w.G)(u()),icon:void 0,disabled:!1,onClick:function(){var t;null===(t=e.onAction)||void 0===t||t.call(e,o,n)},theme:Object(w.B)(c(),void 0),strings:rt(e.strings.common),accessibilityRole:"menuitem",accessibilityLabel:t.title,automationLabel:"AIFeedbackSuggestion_"+t.id}},g=C.createElement(W.a,{align:G.b.Stretch},C.createElement(ee,null,C.createElement(W.a,{align:G.b.Stretch,accessible:!0,accessibilityRole:"menu"},(t=1,n=a.suggestions[0].title,o=void 0,i=a.suggestions[0].actions[0],r=a.suggestions[0].titleDecorations,[C.createElement(Ar,{key:t,ref:o,buttonProps:d({title:n,actions:[i],titleDecorations:r},0,i),menuProps:void 0,style:w.Gb,theme:{splitMenuHoverBackground:c().suggestionMenuHoverBackground,splitMenuHoverForeground:c().suggestionMenuHoverForeground},strings:at(e.strings.common),accessibilityPositionInSet:1,accessibilitySetSize:1})])))),h={title:"Replace",onClick:function(){var t;null===(t=e.onAction)||void 0===t||t.call(e,z.a.Accept,0)}},f={style:(s=u(),{paddingBottom:0,paddingVertical:0,marginStart:5,borderRadius:2,iconFontSize:s.xlarge}),theme:Object(w.B)(c(),void 0,!0),tooltip:"Fact Check",accessibilityLabel:"Fact Check",automationLabel:"FactCheckButton_".concat(e.automationId),icon:{type:"ShowExplanation",filled:!0}},m={title:"More",menuProps:{onDismiss:function(e){e&&"shiftKey"in e&&e.preventDefault()},items:[{key:"GiveFeedback",text:"Give Feedback",iconProps:{iconName:"Feedback"},onRenderIcon:function(){return C.createElement(Is.a,{color:c().header,style:{padding:"8px 4px"}})},onClick:function(){var t;null===(t=e.onAction)||void 0===t||t.call(e,z.a.Feedback)}}],directionalHintFixed:!0},menuIconProps:{iconName:void 0}},y=C.createElement("div",{style:As},C.createElement(W.a,{direction:G.c.LeftToRight,align:G.b.Stretch},C.createElement(er.a,Object(l.__assign)({styles:ks(c())},h),C.createElement(xs,null),"Replace"),a.explanation&&C.createElement(Bt,{calloutAccessibilityLabel:e.strings.critique("explanationFlyoutAccessibilityLabel"),buttonProps:f},C.createElement(W.a,{direction:G.c.TopToBottom,style:Object(w.I)(e.style,c()),align:G.b.Stretch},C.createElement(he.a,{text:"Fact Check",style:Object(w.K)(c(),u()),accessibilityRole:"heading"}),C.createElement(he.a,{text:a.explanation,style:Object(w.N)(c(),u()),accessibilityRole:"text"}))),C.createElement(tr.a,Object(l.__assign)({styles:Os},m),C.createElement(me.a,{type:"Overflow"}))),C.createElement(Vo.a,{calloutProps:{isBeakVisible:!1,gapSpace:12},directionalHint:v.a.bottomCenter,content:"Content generated by AI might contain inaccuracies or sensitive material. Be sure to verify information.",id:"raitooltip"},C.createElement("div",{style:ws},C.createElement(Cs,null),C.createElement("span",{style:Ts},"Copilot"))));return C.createElement(W.a,{style:Object(w.lb)(c(),Object(l.__assign)(Object(l.__assign)({},e.style),{maxWidth:728})),align:G.b.Stretch},[p,g,y])};!function(e){e[e.Default=0]="Default",e[e.Feedback=1]="Feedback"}(Ss||(Ss={}));var _s=function(e){function t(t){var n=e.call(this,t)||this;return n.onRewriteSelectFeedbackSuggestion=n.onRewriteSelectFeedbackSuggestion.bind(n),n.onRewriteReportSuggestionCancel=n.onRewriteReportSuggestionCancel.bind(n),n.onRewriteReportSuggestionNext=n.onRewriteReportSuggestionNext.bind(n),n.onCritiqueCardClick=n.onCritiqueCardClick.bind(n),n.onFeedbackCardBack=n.onFeedbackCardBack.bind(n),n.onFeedbackCardDismiss=n.onFeedbackCardDismiss.bind(n),n.onFeedbackCardReport=n.onFeedbackCardReport.bind(n),n.state={definition:t.definition,rewriteState:Ss.Default,rewriteReportedSuggestionId:void 0,rewriteOption:void 0,rewriteChoiceGroupSelected:!1},n}return Object(l.__extends)(t,e),t.isRewriteFeedbackNegative=function(e){return e!==Nr.a.FeedbackOptionHelpful},t.prototype.setDefinition=function(e){this.setState({definition:e})},t.prototype.componentDidUpdate=function(e){e.definition!==this.props.definition&&this.setState({definition:this.props.definition})},t.prototype.focus=function(){},t.prototype.render=function(){var e=this,t=this.getDefinition();if(!t||!t.suggestions)return null;switch(this.state.rewriteState){case Ss.Default:var n=t.suggestions.map((function(n){if(e.isSuggestionReportedNegative(n.title))return Object(l.__assign)(Object(l.__assign)({},n),{actions:n.actions.filter((function(e){return e!==z.a.Accept})),title:e.props.strings.neuralRewrite("neuralRewriteReportedSuggestionTitle"),subtitle:void 0,titleDecorations:void 0});if(void 0===n.titleDecorations&&t.contextText){var o=function(e,t){var n=t.length,o=function(e,t){for(var n=e.length,o=t.length,i=0,r=0,s=0;s<Math.min(n,o)&&e.charAt(s)===t.charAt(s);s++)i++,lr.b(e.charCodeAt(s))&&(r=i);return r}(e,t),i=Math.min(function(e,t){for(var n=e.length,o=t.length,i=0,r=0,s=0;s<Math.min(n,o)&&e.charAt(n-s-1)===t.charAt(o-s-1);s++)i++,lr.b(e.charCodeAt(n-s-1))&&(r=i);return r}(e,t),Math.min(n,e.length)-o),r=o+i,s=n-r,a=Math.min(130,s),l=Math.min(150-a,r),c=Math.min(l,o),u=Math.min(l,i),p=function(e,t,n){var o,i,r=e/2;t<r&&n<r?(o=t,i=n):t<r?(o=t,i=Math.min(n,e-o)):n<r?(i=n,o=Math.min(t,e-i)):(o=r,i=r);return{actualLeftContextLength:o,actualRightContextLength:i}}(l,c,u),d=p.actualLeftContextLength,g=p.actualRightContextLength,h=t.substring(o-d,o),f=t.substring(o,n-i),m=t.substring(n-i,n-i+g),y=h,b=f,v=m;if(o>d){var S=Ms(h,0,h.length,!0);y="..."+h.substring(S,h.length)}if(f.length>a){var x=Ms(f,0,a/2,!1),C=Ms(f,a/2,f.length,!0);b=f.substring(0,x)+"..."+f.substring(C,f.length)}if(i>g){var T=Ms(m,0,m.length,!1);v=m.substring(0,T)+"..."}return{truncatedPrefix:y,truncatedSubstring:b,truncatedSuffix:v,target:f,commonPrefixLength:o,commonSuffixLength:i}}(t.contextText,n.title),i=o.commonPrefixLength,r=o.commonSuffixLength;return Object(l.__assign)(Object(l.__assign)({},n),{titleDecorations:[{start:i,length:n.title.length-i-r,decorationType:z.e.Rewrite}]})}return n})),o=Object(l.__assign)(Object(l.__assign)({},this.props),{definition:Object(l.__assign)(Object(l.__assign)({},t),{suggestions:n}),onAction:this.onCritiqueCardClick});return C.createElement(js,Object(l.__assign)({},o));case Ss.Feedback:return this.renderFeedback()}},t.prototype.getDefinition=function(){return this.state.definition},t.prototype.onCritiqueCardClick=function(e,t){e===z.a.Feedback&&this.setState({rewriteState:Ss.Feedback,rewriteReportedSuggestionId:this.props.definition.suggestions[0].id,rewriteOption:this.props.definition.suggestions[0].id,rewriteChoiceGroupSelected:!0}),this.props.onAction&&this.props.onAction(e,t)},t.prototype.onFeedbackCardDismiss=function(){this.setState({rewriteState:Ss.Default})},t.prototype.onFeedbackCardBack=function(){this.setState({rewriteState:Ss.Default,rewriteChoiceGroupSelected:!0})},t.prototype.renderFeedback=function(){var e=this.getDefinition(),t=this.getIndexOfReportedSuggestion(),n=Object(l.__assign)(Object(l.__assign)({},this.props),{style:void 0,reportedSuggestionIndex:t,showCheckbox:!0,definition:e,onBack:this.onFeedbackCardBack,onDismiss:this.onFeedbackCardDismiss,onReport:this.onFeedbackCardReport});return C.createElement(W.a,{style:Object(w.lb)(this.props.theme||w.g,this.props.style)},C.createElement(Nr.a,Object(l.__assign)({},n,{theme:this.props.theme})))},t.prototype.isSuggestionReportedNegative=function(e){return t.suggestionsReportedNegative.indexOf(e)>=0},t.prototype.isSuggestionAlreadyReported=function(e){return t.reportedSuggestions.indexOf(e)>=0},t.prototype.onRewriteSelectFeedbackSuggestion=function(e){e&&this.setState({rewriteReportedSuggestionId:e.key,rewriteChoiceGroupSelected:!0})},t.prototype.onRewriteReportSuggestionCancel=function(){this.setState({rewriteState:Ss.Default,rewriteReportedSuggestionId:void 0,rewriteChoiceGroupSelected:!1})},t.prototype.onRewriteReportSuggestionNext=function(){this.setState({rewriteState:Ss.Feedback,rewriteChoiceGroupSelected:!1})},t.prototype.getIndexOfReportedSuggestion=function(){var e=this.state.rewriteReportedSuggestionId,t=this.getDefinition();if(t.suggestions)for(var n=0;n<t.suggestions.length;n++){var o=t.suggestions[n];if(o&&o.id===e)return o&&o.title?n:-1}},t.prototype.onFeedbackCardReport=function(e,n){var o=this.getDefinition();if(this.state.rewriteReportedSuggestionId&&o.suggestions){var i=this.getIndexOfReportedSuggestion();if(void 0!==i){var r=o.suggestions[i].title;this.props.onAction&&this.props.onAction(z.a.Report,i,{action:"feedback",type:o.critiqueType,option:e.option,comments:e.comments,payload:e.payload}),this.isSuggestionAlreadyReported(r)||o.critiqueType===z.c.Grammar||t.reportedSuggestions.push(r),void 0!==e.option&&t.isRewriteFeedbackNegative(e.option)&&!this.isSuggestionReportedNegative(r)&&o.critiqueType!==z.c.Grammar&&t.suggestionsReportedNegative.push(r),this.setState({rewriteReportedSuggestionId:void 0,rewriteChoiceGroupSelected:!1})}}},t.reportedSuggestions=[],t.suggestionsReportedNegative=[],t}(C.Component);function Ms(e,t,n,o){if(o){for(;!lr.b(e.charCodeAt(t))&&t<n;)++t;return t}for(var i=n;!lr.b(e.charCodeAt(n))&&n>t;)--n;return n+1<=i&&++n,n}var Ds=function(e){function t(t){var n,o,i=this;return(i=e.call(this,t)||this).enableFeedbackForGrammar=Object(c.b)("Microsoft.Office.WordOnline.GrammarFeedbackIsEnabled",!1),i.innerCritique=C.createRef(),i.onInnerCritiqueClick=i.onInnerCritiqueClick.bind(i),Object(sr.b)(new ar.a),null===(o=(n=t.dependencies).loadUpsellDependencies)||void 0===o||o.call(n),i.state={showingContext:i.props.parameters.showSnippet,showingDescription:i.props.parameters.showDescription},i}return Object(l.__extends)(t,e),t.prototype.critiqueComponent=function(){var e=this.convertCritiqueType();return"Type-AIFeedbackRewrite"===this.props.group.critiqueSubType?_s:e===z.c.NeuralRewrite||this.enableFeedbackForGrammar&&e===z.c.Grammar||"b1634cf9-5f68-42f4-82ca-e668f893d28f"===this.props.group.critiqueSubType||"Type-AIFeedbackRewrite"===this.props.group.critiqueSubType?Gr:Rr},t.prototype.isSoftPaywallEnabled=function(){var e;return Object(c.b)("Microsoft.Office.WordOnline.FA000000029.EditorSoftPaywallEnabled",!1)&&!!(null===(e=this.getSoftPaywallProvider())||void 0===e?void 0:e.softPaywallData.isEnabled)},t.prototype.getSoftPaywallProvider=function(){var e,t;return null===(t=(e=this.props.dependencies).getSoftPaywallData)||void 0===t?void 0:t.call(e)},t.prototype.getPremiumPreviewCredits=function(){var e=this.getSoftPaywallProvider();if(void 0!==e){var t=e.softPaywallData;if(void 0!==t){var n=Number(t.credits);return n>0?n:0}u.a.sendTraceTag(520218528,p.a.msoulscat_Wac_Telemetry,d.a.Error,"SoftPaywall data initialization failed")}else u.a.sendTraceTag(520218529,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Resolving SoftPaywall failed in CritiqueAdapter")},t.prototype.spendCredit=function(){var e=this.getSoftPaywallProvider();void 0!==e?(e.spendCredit(),u.a.sendTraceTag(520218526,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Soft paywall spend credit action"+JSON.stringify({critiqueType:this.props.group.critiqueSubType,credits:this.getPremiumPreviewCredits()}))):u.a.sendTraceTag(520218527,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Resolving SoftPaywall failed while spending credit")},t.prototype.renderSharedCritique=function(){var e,t,n=this.convertCritiqueType();if(null==n)return null;var o=this.critiqueComponent(),i=this.getCritiqueProps(n),r=C.createElement("div",{id:this.headerId(),"aria-label":this.getCardHeaderText()},C.createElement(o,Object(l.__assign)({ref:this.innerCritique},i)));if(!this.isSoftPaywallEnabled())return r;var s=null===(t=(e=this.props.dependencies).getPremiumPreviewCritiquesList)||void 0===t?void 0:t.call(e),a=(null==s?void 0:s.isCritiqueTypeUnderPaywall(this.props.group.critiqueSubType||"",this.props.group.title||"",this.props.uiCulture.split("-")[0]))||n===z.c.Refinement;return i.definition.credits=this.getPremiumPreviewCredits(),a&&void 0!==i.definition.credits&&this.props.group.suggestions&&0!==this.props.group.suggestions.length?(u.a.sendTraceTag(512501390,p.a.msoulscat_Wac_Telemetry,d.a.Info,"SoftPaywall Critique rendered "+JSON.stringify({critiqueType:this.props.group.critiqueSubType,credits:this.getPremiumPreviewCredits()})),C.createElement(es,Object(l.__assign)({},i,{strings:us(this.props.resources)}),C.createElement(o,Object(l.__assign)({ref:this.innerCritique},i)))):(void 0===i.definition.credits&&u.a.sendTraceTag(520218525,p.a.msoulscat_Wac_Telemetry,d.a.Error,"SoftPaywall credits initialization failed"),r)},t.prototype.render=function(){return this.renderSharedCritique()},t.prototype.getCardHeaderText=function(){switch(this.props.group.type){case"SharedSpellingCritique":return this.props.resources.spellingCardTitle;case"SharedRepeatedWordCritique":return this.props.resources.RepeatedWordCardTitle;default:return this.headerText()}},t.prototype.getCritiqueProps=function(e){var t,n;return{automationId:this.props.group.id||void 0,critiqueSource:"Inference"===(null===(t=this.props.group.icon)||void 0===t?void 0:t.resourceId)?o.Inference:void 0,settings:{RenderFooterIcons:this.props.parameters.renderFooterIcons||"Type-AIFeedbackRewrite"===this.props.group.critiqueSubType?"true":"false",RenderNeuralRewriteFeedbackCustomerContentData:"true",EnableFeedback:this.enableFeedbackForGrammar||e===z.c.NeuralRewrite||"Type-AIFeedbackRewrite"===this.props.group.critiqueSubType?"true":"false"},definition:{definitionType:"CritiqueDefinition",critiqueType:e,header:this.props.group.cardHeader||"",contextText:this.props.group.snippet||void 0,explanation:this.props.group.explanation||void 0,explanationTitle:this.props.group.description||void 0,subheader:this.headerText(),contextDecorations:ps(this.props.group.snippetFormatting,this.props.group.snippet),suggestions:ds(this.getSuggestionsToRender()),showContext:this.state.showingContext,showDescription:this.state.showingDescription,actions:gs(this.props.group.supportedActions,e,this.props.parameters.showEditorButton,this.props.group.critiqueSubType),brandingMode:this.getBrandingMode(),isContentPending:this.props.group.isContentPending,critiqueSetSize:this.props.parameters.definition?this.props.parameters.definition.setSize:void 0,critiquePosition:this.props.parameters.definition?this.props.parameters.definition.positionInSet:void 0,helpLink:vs(null===(n=this.props.parameters.definition)||void 0===n?void 0:n.helpLink),showDictationCommandUx:this.props.parameters.showDictationCommandUx},addOnFooterData:ys(this.props.parameters.addOnFooterData),onAction:this.onInnerCritiqueClick,style:this.getInnerCritiqueStyle(e),theme:vi(),strings:us(this.props.resources)}},t.prototype.getBrandingMode=function(){if(this.props.parameters.showEditorButton||this.props.parameters.showEditorBranding)return z.b.IconAndTextButton},t.prototype.getInnerCritiqueStyle=function(e){return{minWidth:e===z.c.NeuralRewrite?370:248,maxWidth:380}},t.prototype.convertCritiqueType=function(){switch(this.props.group.type){case"SharedSpellingCritique":return z.c.Spelling;case"SharedRepeatedWordCritique":return z.c.RepeatedWord;case"SharedGrammarCritique":return z.c.Grammar;case"SharedSuggestionCritique":return z.c.Refinement;case"SharedRewriteCritique":return z.c.NeuralRewrite;case"SharedDictationCorrectionCritique":return z.c.DictationCorrection}return null},t.prototype.onInnerCritiqueClick=function(e,t,n,o){var r,s,a=void 0;switch(e){case z.a.ToggleContext:this.onShowHideContext(),a="Context";break;case z.a.ToggleDescription:this.onShowHideDescription(),a="Description";break;case z.a.AddOnFooterAction:a=this.props.parameters.addOnFooterData.actionText;break;case z.a.Dismiss:this.props.dismiss&&this.props.dismiss(null!=o?o:{actionSourceId:i.Unknown});break;case z.a.GoPremium:u.a.sendTraceTag(512501389,p.a.msoulscat_Wac_Telemetry,d.a.Info,"SoftPaywall GoPremium clicked "+JSON.stringify({critiqueType:this.props.group.critiqueSubType,credits:this.getPremiumPreviewCredits()})),null===(s=(r=this.props.dependencies).dimeCallback)||void 0===s||s.call(r);break;case z.a.RevealSuggestions:this.spendCredit()}var l=ms(e);if(null!=l){var c=function(e,t){if(t&&e===Fo.Report&&"feedback"===t.action){var n=t;return JSON.stringify(n)}}(l,n),g=this.props.group.suggestions&&void 0!==t&&t<this.props.group.suggestions.length?this.props.group.suggestions[t]:void 0;this.onAction(null,l,Po.Try,this.props.group,g||void 0,a,c,o)}else u.a.sendTraceTag(590116176,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Unknown actionId")},t.prototype.headerText=function(){return"Type-AIFeedbackRewrite"===this.props.group.critiqueSubType?this.props.resources.AIFeedbackCardSubHeader:this.props.group.title?this.props.group.title:""},t.prototype.onShowHideContext=function(){this.setState((function(e){return{showingContext:!e.showingContext}}))},t.prototype.onShowHideDescription=function(){this.setState((function(e){return{showingDescription:!e.showingDescription}}))},t.prototype.suggestionListDescription=function(){return""},t.prototype.invokeBadgeId=function(e){this.innerCritique.current&&this.innerCritique.current.executeBadgedAction(e)},t}(Zi),Es=function(e){function t(n){var o=e.call(this,n)||this;return o.viewOriginalButtonRef=C.createRef(),o.state={showingContext:o.props.parameters.showSnippet,selectedSuggestion:t.getSelectedSuggestion(o.props),shouldScrollToSelectedMenuItem:!0,isContextualSuggestion:!0===o.props.parameters.showDesignerButton,isFormattingSuggestion:!0===o.props.parameters.isFormattingSuggestion,isViewingOriginal:!1},o}return Object(l.__extends)(t,e),t.getDerivedStateFromProps=function(e,n){var o=t.getSelectedSuggestion(e);return o!==n.selectedSuggestion?{selectedSuggestion:o}:null},t.getSelectedSuggestion=function(e){var t,n,o;return e.group.previewData?null===(t=this.getPreviewData(e))||void 0===t?void 0:t.getSelectedOption():(null===(o=null===(n=e.group)||void 0===n?void 0:n.suggestions)||void 0===o?void 0:o.length)?e.group.suggestions[0]:void 0},t.getPreviewData=function(e){var t;return null===(t=e.group)||void 0===t?void 0:t.previewData},t.prototype.getActionString=function(t){return t===Fo.ViewOriginal?this.state.isViewingOriginal?this.props.resources.ViewSuggestionTooltip:this.props.resources.ViewOriginalTooltip:t===Fo.Next?1===this.props.parameters.definition.setSize?this.props.resources.DoneButton:this.props.resources.NextButton:t===Fo.OpenDesignerPane?this.props.resources.DesignerButtonText:t===Fo.SnoozeAll?this.props.resources.HideSuggestionsButton:e.prototype.getActionString.call(this,t)},t.prototype.headerText=function(){var e;return null!==(e=this.props.group.title)&&void 0!==e?e:this.props.resources.DesignerMenuText},t.prototype.renderSuggestions=function(){return null},t.prototype.renderFooter=function(){return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerStyles},C.createElement("div",{style:this.props.styleProvider.footerActionsStyleWrapper},C.createElement("div",{style:this.props.styleProvider.footerActionsLeftStyle},this.renderLeftActions()),C.createElement("div",{style:this.props.styleProvider.footerActionsRightStyle},this.renderRightActions())))},t.prototype.render=function(){return C.createElement("div",{style:this.props.styleProvider.externalWrapperStyles},e.prototype.render.call(this),this.renderProactivePrompt())},t.prototype.getProactivePromptSideIconProps=function(){return{iconName:"MeetingInsights_20",styles:this.props.styleProvider.promptIconStyle}},t.prototype.getProactivePromptBodyIconProps=function(){return{iconName:"More",styles:this.props.styleProvider.promptBodyIconStyle}},t.prototype.getProactivePromptBodyText=function(){if(this.props.parameters.proactivePromptHintType)switch(this.props.parameters.proactivePromptHintType){case Wo.None:return u.a.shipAssertTag(523637135,p.a.msoulscat_Wac_WordDesigner,!1,"getProactivePromptBodyText with no hint"),"";case Wo.HideFromReviewCard:return this.props.resources.HideSuggestionsProactiveHintBody;case Wo.HideFromReviewCardAndRibbon:return this.props.resources.HideSuggestionsWithRibbonProactiveHintBody}return this.props.resources.HideSuggestionsProactiveHintBody},t.prototype.getProactivePromptCaptionText=function(){if(this.props.parameters.proactivePromptHintType)switch(this.props.parameters.proactivePromptHintType){case Wo.None:return u.a.shipAssertTag(523637136,p.a.msoulscat_Wac_WordDesigner,!1,"getProactivePromptCaptionText with no hint"),"";case Wo.HideFromReviewCard:return this.props.resources.HideSuggestionsProactiveHintCaption;case Wo.HideFromReviewCardAndRibbon:return this.props.resources.HideSuggestionsWithRibbonProactiveHintCaption}return this.props.resources.HideSuggestionsProactiveHintCaption},t.prototype.renderProactivePrompt=function(){if(this.props.parameters.proactivePromptHintType&&this.props.parameters.proactivePromptHintType!==Wo.None){var e=this.getProactivePromptBodyText(),t=e.substring(0,e.indexOf("{0}")),n=e.substring(e.indexOf("{0}")+"{0}".length,e.length);return C.createElement("div",{key:"prompt",style:this.props.styleProvider.promptStyles},C.createElement("div",{style:this.props.styleProvider.promptStyleWrapper},C.createElement("div",{style:this.props.styleProvider.promptIconStyleWrapper},C.createElement(Ji.a,Object(l.__assign)({},this.getProactivePromptSideIconProps()))),C.createElement("div",{style:this.props.styleProvider.promptTextStyleWrapper},C.createElement("div",{style:this.props.styleProvider.promptTextHeadingStyle},this.getProactivePromptCaptionText()),C.createElement("div",{style:this.props.styleProvider.promptTextBodyStyle},t,C.createElement(Ji.a,Object(l.__assign)({},this.getProactivePromptBodyIconProps())),n))))}},t.prototype.getActionButtonIconProps=function(e){switch(e){case Fo.Accepted:return{iconName:"Accept",styles:this.props.styleProvider.acceptIconStyles(this.shouldDisableActionButton(e))};case Fo.Rejected:return{iconName:"Clear",styles:this.props.styleProvider.rejectIconStyles(this.shouldDisableActionButton(e))};case Fo.ViewOriginal:return{iconName:this.state.isViewingOriginal?"ViewOriginalFormattingBlue_16":"ViewOriginalFormattingGray_16",styles:this.props.styleProvider.viewOriginalIconStyles(this.state.isViewingOriginal)};case Fo.Undo:return{iconName:"Undo",styles:this.props.styleProvider.defaultIconStyles};case Fo.OpenDesignerPane:return{iconName:"Designer_20",styles:this.props.styleProvider.openPaneIconStyle};case Fo.SnoozeAll:return{iconName:"Hide_16",styles:this.props.styleProvider.overflowActionIconStyles};case Fo.AcceptAll:case Fo.RejectAll:case Fo.ShowHideContext:return{iconName:"Empty_16",styles:this.props.styleProvider.overflowActionIconStyles};case Fo.GiveFeedback:return{iconName:"Feedback",styles:this.props.styleProvider.giveFeedbackIconStyles}}},t.prototype.renderLeftActions=function(){var e=this,t={isViewingOriginal:this.state.isViewingOriginal,setIsViewingOriginal:function(t){return e.setState({isViewingOriginal:t},(function(){var t;return null===(t=e.viewOriginalButtonRef.current)||void 0===t?void 0:t.focus()}))}};return[this.renderActionButton(Fo.Accepted,this.props.styleProvider.actionButtonStyles,void 0,void 0,!0),this.renderActionButton(Fo.Rejected,this.props.styleProvider.actionButtonStyles,void 0,void 0,!0),this.renderActionButton(Fo.ViewOriginal,this.props.styleProvider.viewOriginalButtonStyles(this.state.isViewingOriginal),void 0,void 0,!0,t),this.renderActionButton(Fo.Next,this.props.styleProvider.nextButtonStyles),this.renderActionButton(Fo.Undo,this.props.styleProvider.actionButtonStyles,void 0,void 0,!0),this.renderOverflowMenu()]},t.prototype.renderRightActions=function(){return this.state.isContextualSuggestion?[this.renderActionButton(Fo.GiveFeedback,this.props.styleProvider.actionButtonStyles,void 0,void 0,!0),this.renderActionButton(Fo.OpenDesignerPane,this.props.styleProvider.openPaneButtonStyle,void 0,void 0,!0)]:this.renderNextPrev()},t.prototype.getActionButtonAriaDescription=function(e){switch(e){case Fo.Accepted:return this.props.resources.AcceptTooltip;case Fo.Rejected:return this.props.resources.RejectTooltip;case Fo.OpenDesignerPane:return this.props.resources.DesignerButtonTooltipContent}},t.prototype.renderOverflowActions=function(){var e=[this.renderShowHideContextButton()];return this.state.isContextualSuggestion&&!this.state.isFormattingSuggestion||e.push(this.renderActionButton(Fo.AcceptAll,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")),e.push(this.renderActionButton(Fo.RejectAll,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")),e.push(this.renderActionButton(Fo.SnoozeAll,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")),e},t.prototype.shouldDisableActionButton=function(e,t){return this.state.isViewingOriginal?e!==Fo.ViewOriginal&&e!==Fo.GiveFeedback&&e!==Fo.OpenDesignerPane:e===Fo.Rejected&&!this.hasActionType(e,t)},t.prototype.shouldDismissOnAction=function(t){return!(!this.props.parameters.shouldSkipTwoStepReview||t!==Fo.Accepted&&t!==Fo.Rejected)||e.prototype.shouldDismissOnAction.call(this,t)&&t!==Fo.Apply&&t!==Fo.Accepted&&t!==Fo.Rejected&&t!==Fo.Undo&&t!==Fo.ViewOriginal&&t!==Fo.ShowMore},t.prototype.getTooltipString=function(e){if(!this.shouldDisableActionButton(e))switch(e){case Fo.Accepted:return this.props.resources.AcceptButton;case Fo.Rejected:return this.props.resources.RejectButton;case Fo.OpenDesignerPane:return this.props.resources.DesignerButtonTooltipContent;case Fo.Undo:return this.props.resources.UndoButton;case Fo.ViewOriginal:return this.state.isViewingOriginal?this.props.resources.ViewSuggestionTooltip:this.props.resources.ViewOriginalTooltip;case Fo.GiveFeedback:return this.props.resources.GiveFeedbackButtonText;case Fo.SnoozeAll:return this.props.resources.HideSuggestionsButtonTooltip;default:return}},t.prototype.renderOverflowMenu=function(){return C.createElement(Vo.a,{directionalHint:v.a.bottomCenter,content:this.props.resources.OverflowButtonAccessibilityLabel},e.prototype.renderOverflowMenu.call(this))},t.prototype.getActionButtonToRender=function(e,t){var n=this.getActionString(e),o=this.getActionButtonAriaDescription(e),i=this.getTooltipString(e),r=C.createElement(Qi.a,Object(l.__assign)({},t,{ariaLabel:n,ariaDescription:o,componentRef:e===Fo.ViewOriginal?this.viewOriginalButtonRef:void 0}));return e===Fo.Next&&(r=C.createElement(er.a,Object(l.__assign)({},t,{ariaLabel:n,ariaDescription:o}))),void 0===i?r:C.createElement(Vo.a,{directionalHint:v.a.bottomCenter,content:i},r)},t.prototype.renderNavigationButton=function(t){var n=t?this.props.resources.NextButton:this.props.resources.PreviousButton;return C.createElement(Vo.a,{directionalHint:v.a.bottomCenter,content:n},e.prototype.renderNavigationButton.call(this,t))},t.critique="DesignerCritiqueV2",t.imageCritique="DesignerImageCritique",t.pqCritique="DesignerPQCritique",t}(or),Rs=n(915),Bs=n(2417),Ns=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollToSelectedItem=function(e){e&&t.state.shouldScrollToSelectedMenuItem&&(e.scrollIntoView({block:"center"}),t.setState({shouldScrollToSelectedMenuItem:!1}))},t}return Object(l.__extends)(t,e),t.prototype.renderSuggestions=function(){var e,t,n;if(!(null===(e=this.props.group.suggestions)||void 0===e?void 0:e.length))return null;var o=null===(t=this.state.selectedSuggestion)||void 0===t?void 0:t.title,i=Object(l.__assign)({maxWidth:"175px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",lineHeight:"32px",padding:"0px 7px"},this.getTriageItemStyle(null===(n=this.state.selectedSuggestion)||void 0===n?void 0:n.titleFormatting)),r=Object(l.__assign)(Object(l.__assign)({},this.props.styleProvider.triageButtonStyles),{label:i});return C.createElement(Vo.a,{directionalHint:v.a.bottomCenter,content:this.state.isViewingOriginal?void 0:this.props.resources.ChangeRoleTooltip},C.createElement(tr.a,{text:o,styles:r,disabled:this.state.isViewingOriginal,menuProps:this.getTriageMenuProps(),menuAs:this.getTriageMenu,"aria-description":this.props.resources.ChangeRoleTooltip,autoFocus:!0}))},t.prototype.getTriageMenuProps=function(){var e,t=this,n=this.getTriageItems(),o={key:"separator-designer",itemType:Rs.a.Divider,itemProps:{styles:this.props.styleProvider.triageContextualMenuItemStyles}},i=null===(e=Es.getPreviewData(this.props))||void 0===e?void 0:e.getSeparatorIndexes();if(i)for(var r=0,s=0,a=i;s<a.length;s++){var l=a[s];n.splice(l+r,0,o),r+=1}else n.splice(2,0,o);return{coverTarget:!0,items:n,contextualMenuItemAs:function(e){return C.createElement("span",{style:e.item.checked?t.props.styleProvider.menuSelectedItemSpanStyles:t.props.styleProvider.menuItemSpanStyles,ref:e.item.checked?t.scrollToSelectedItem:void 0},e.item.text)},styles:this.props.styleProvider.triageContextualMenuStyles,directionalHint:this.props.isRightToLeft?v.a.topRightEdge:v.a.topLeftEdge,calloutProps:{styles:this.props.styleProvider.triageCalloutStyles},onMenuOpened:function(){t.setState({shouldScrollToSelectedMenuItem:!0})}}},t.prototype.getTriageMenu=function(e){return C.createElement(Bs.a,Object(l.__assign)({},e))},t.prototype.getTriageItems=function(){var e=this;return this.props.group.suggestions.filter((function(e){return!!e})).map((function(t){return{key:t.id,text:t.title,data:t,role:"menuitemradio",checked:t===e.state.selectedSuggestion,itemProps:{styles:t===e.state.selectedSuggestion?e.props.styleProvider.triageContextualMenuSelectedItemStyles:e.props.styleProvider.triageContextualMenuItemStyles},style:e.getTriageItemStyle(t.titleFormatting),onClick:function(){e.onAction(null,Fo.Apply,Po.Try,e.props.group,t)}}}))},t.prototype.getTriageItemStyle=function(e){if(e)for(var t=0,n=e;t<n.length;t++){var o=n[t];if(o)return{fontFamily:o.font,fontWeight:o.fontWeight===Ho.Bold?"bold":"normal",fontStyle:o.italic?"italic":void 0,fontSize:o.fontSize?"".concat(o.fontSize,"pt"):void 0,color:o.cssColor,textDecoration:o.underlineType>zo.None?"underline":void 0,textDecorationStyle:o.underlineType>zo.None?o.underlineType===zo.Single?"solid":"double":void 0,backgroundColor:"transparent",backgroundImage:"url('".concat(o.backgroundImg,"')"),backgroundSize:"cover"}}},t}(Es),Ls=n(2828),Ps=n(2661),Fs=function(e){var t=Object(ni.db)({height:"100%",width:"100%",objectFit:"cover",objectPosition:"center"}),n=Object(C.useRef)(Date.now()),o=Object(C.useRef)(!1);return C.createElement(Ls.a,Object(l.__assign)({},e,{title:e.imgAltText,focusOnHover:!1}),C.createElement("img",{src:e.thumbnailSrc,alt:e.imgAltText,"aria-hidden":!0,className:t,onError:function(){return u.a.shipAssertTag(526722326,p.a.msoulscat_Wac_WordDesigner,!1,"Image thumbnail failed to load")},onLoad:function(){var e=Date.now()-n.current;!o.current&&e>1e3&&u.a.sendTraceTag(526722327,p.a.msoulscat_Wac_WordDesigner,d.a.Info,"Image thumbnail loaded after ".concat(e,"ms")),o.current=!0}}))},Hs=function(e){var t,n=null===(t=e.suggestion)||void 0===t?void 0:t.contentData,o=Object(ni.db)({height:"105%",width:"105%"}),i=Object(ni.db)({display:"-webkit-box",position:"absolute",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:"2",WebkitBoxOrient:"vertical",width:"calc(100% - 30px)",fontSize:"8px",fontFamily:null==n?void 0:n.font,fontWeight:(null==n?void 0:n.bold)===Ho.Bold?"bold":"normal",fontStyle:(null==n?void 0:n.italic)?"italic":void 0,color:null==n?void 0:n.color});return C.createElement(Ls.a,Object(l.__assign)({},e,{title:null==n?void 0:n.title,focusOnHover:!1}),C.createElement("img",{src:null==n?void 0:n.backgroundImg,alt:null==n?void 0:n.title,"aria-hidden":!0,className:o}),C.createElement("span",{className:i},null==n?void 0:n.title))},zs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onGalleryButtonExecute=function(e){var n=e.galleryButton;n&&t.onAction(null,Fo.Apply,Po.Try,t.props.group,n.suggestion)},t}return Object(l.__extends)(t,e),t.prototype.getSuggestionGalleryButtons=function(){var e,t,n,o,i=this.props.group.suggestions;if(!i)return[];var r=i.length;if(!r)return[];for(var s=[],a=Math.ceil(r/this.props.styleProvider.columnCount),l=0;l<a;l++)for(var c=0;c<(null!==(e=this.props.styleProvider.columnCount)&&void 0!==e?e:1);c++){var u=c*a+l;if(u>r)break;var p=i[u];if(!p)break;s.push({type:"AppGalleryButtonProps",id:null!==(t=p.id)&&void 0!==t?t:"AppGalleryButton".concat(u),style:this.props.styleProvider.galleryButtonStyles(c),thumbnailSrc:null===(n=p.image)||void 0===n?void 0:n.src,imgAltText:null===(o=p.image)||void 0===o?void 0:o.imageAltText,suggestion:p})}return s},t.prototype.render=function(){var t,n=null===(t=this.props.group.suggestions)||void 0===t?void 0:t.length,o=n&&n>3?2:1;return this.props.styleProvider.columnCount=o,e.prototype.render.call(this)},t.prototype.renderSuggestions=function(){var e,t,n,o=this;if(!(null===(e=this.props.group.suggestions)||void 0===e?void 0:e.length))return null;var i=this.getSuggestionGalleryButtons();return C.createElement("div",{className:this.props.styleProvider.imageSuggestionGalleryClassName},C.createElement(q.a,{isCircularNavigation:!1},C.createElement(Ps.a,{id:"DesignerGallerySuggestions",role:"menu",columns:null!==(t=this.props.styleProvider.columnCount)&&void 0!==t?t:1,selectedId:null===(n=this.state.selectedSuggestion)||void 0===n?void 0:n.id,onGalleryButtonExecute:this.onGalleryButtonExecute,getGalleryButtonComponent:this.props.group.type===Es.pqCritique?Hs:Fs,gallerySections:[{galleryButtons:i}],defaultWidth:this.props.styleProvider.cardWidth})),this.shouldHideActionButton(Fo.ShowMore)?null:C.createElement(nr.a,{className:this.props.styleProvider.showMoreLinkClassName,onClick:function(){return o.onAction(null,Fo.ShowMore,Po.Try,o.props.group,void 0)}},this.props.resources.ShowMoreImagesLink))},t}(Es),Us=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.headerText=function(){return"Try saying:"},t.prototype.maximumSuggestions=function(){return 6},t.prototype.suggestionListDescription=function(){return""},t.prototype.renderHeader=function(){return C.createElement("div",null,e.prototype.renderHeader.call(this))},t.prototype.renderSuggestion=function(e,t){var n=this,o={allowDisabledFocus:!1,text:e.title,styles:this.props.styleProvider.suggestionButtonStyles,iconProps:{iconName:this.props.styleProvider.compoundButtonIconName(e),styles:this.props.styleProvider.suggestionButtonIconStyles},onClick:function(t){return n.onAction(t,Fo.Apply,Po.Try,n.props.group,e)}};return C.createElement(Qi.a,Object(l.__assign)({key:e.id},o))},t.id="Intent-DiscoveryCommand",t}(Zi),Ws=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return Object(l.__extends)(t,e),t.prototype.componentDidUpdate=function(){this.state.hasError&&this.props.onError&&this.props.onError(this.state.error,this.state.info)},t.prototype.render=function(){return this.state.hasError?this.props.fallbackRender?this.props.fallbackRender():null:this.props.children},t.prototype.componentDidCatch=function(e,t){this.setState({hasError:!0,error:e,info:t})},t}(C.Component),Gs=function(e){function t(t){var n=e.call(this,t)||this;return n.isInsertLoopsComponentEnabled=Object(c.b)("Microsoft.Office.WordOnline.InsertFluidComponent",!1),n.dismiss=n.dismiss.bind(n),n.calloutOnDismissHandler=n.calloutOnDismissHandler.bind(n),n.updateOnScrollOrResize=n.updateOnScrollOrResize.bind(n),n.dismissOnLostFocus=n.dismissOnLostFocus.bind(n),n.onAcceptPreviewStart=n.createTrackChangeToggleAction("AcceptMouseOver"),n.onAcceptPreviewEnd=n.createTrackChangeToggleAction("AcceptMouseOut"),n.onRejectPreviewStart=n.createTrackChangeToggleAction("RejectMouseOver"),n.onRejectPreviewEnd=n.createTrackChangeToggleAction("RejectMouseOut"),n.onUndo=n.createAutoReplaceAction(Fo.Undo),n.onAccepted=n.onTrackChangeAction.bind(n,Fo.Accepted,Po.Keep),n.onRejected=n.onTrackChangeAction.bind(n,Fo.Rejected,Po.Keep),n.onContextIQItemFocused=n.onContextIQItemFocused.bind(n),n.sortEntityTitle=n.sortEntityTitle.bind(n),n.state={parameters:t.parameters,focusInside:!t.parameters.keepCurrentFocus,profileImageUrlCache:{}},n.async=new h.a(n),n.hasListeners=!1,n.pendingUpdate=!1,n.disposables=[],n.targetWindow=null,n.calloutWrapperElement=C.createRef(),n.calloutBodyElement=C.createRef(),n.focusTrapZone=C.createRef(),n.defaultActionableIntent=null,n.commonActionData={actionSourceId:i.Unknown},n.prevPreviewDataCIQ=null,n}return Object(l.__extends)(t,e),t.prototype.updateOnScrollOrResize=function(e){var t=e.target;this.calloutWrapperElement.current&&Object(f.a)(this.calloutWrapperElement.current,t)||this.pendingUpdate||(this.pendingUpdate=!0,this.forceUpdate())},t.prototype.dismissOnLostFocus=function(e){var t,n;if(!this.state.focusInside&&!(null===(n=(t=this.state.parameters).shouldIgnoreFocusEvent)||void 0===n?void 0:n.call(t,e.target))){var o=e.target;this.calloutWrapperElement.current&&!Object(f.a)(this.calloutWrapperElement.current,o)&&this.dismiss({actionSourceId:i.Unknown})}},t.prototype.ensureListeners=function(){var e=this;this.async.setTimeout((function(){null==e.targetWindow&&e.updateWindowIfNeeded(),null!=e.targetWindow&&(e.hasListeners&&e.removeListeners(),e.props.parameters.preventDismissOnScroll&&e.disposables.push(Object(m.a)(e.targetWindow,"scroll",e.updateOnScrollOrResize,!0)),e.props.parameters.preventDismissOnResize&&e.disposables.push(Object(m.a)(e.targetWindow,"resize",e.updateOnScrollOrResize,!0)),e.disposables.push(Object(m.a)(e.targetWindow.document.documentElement,"click",e.dismissOnLostFocus,!0)),e.disposables.push(Object(m.a)(e.targetWindow.document.documentElement,"focus",e.dismissOnLostFocus,!0)),e.hasListeners=!0)}),0)},t.prototype.removeListeners=function(){this.disposables.forEach((function(e){return e()})),this.disposables=[],this.hasListeners=!1},t.prototype.getTargetElement=function(){return this.props.parameters.targetElement||this.props.parameters.containerElement},t.prototype.updateWindowIfNeeded=function(){var e=Object(y.a)(this.getTargetElement());if(e!==this.targetWindow){var t=this.hasListeners;t&&this.removeListeners(),this.targetWindow=e||null,t&&this.ensureListeners()}},t.prototype.componentDidMount=function(){this.props.parameters.onShow&&this.props.parameters.onShow(),this.ensureListeners()},t.prototype.componentWillUnmount=function(){this.async.dispose(),this.pendingUpdate=!1,this.targetWindow=null,this.hasListeners&&this.removeListeners(),this.props.parameters.onDismiss&&this.props.parameters.onDismiss(this.commonActionData)},t.prototype.componentDidUpdate=function(){this.ensureListeners()},t.prototype.render=function(){var e,t;return this.pendingUpdate=!1,C.createElement("div",{ref:this.calloutWrapperElement},C.createElement(b.a,{role:"dialog","aria-labelledby":this.headerId(),setInitialFocus:!1,onDismiss:this.calloutOnDismissHandler,target:this.getTargetElement(),styles:this.props.styleProvider.contextualMenuStyles,isBeakVisible:!1,preventDismissOnEvent:null!==(e=this.props.parameters.preventDismissOnEvent)&&void 0!==e?e:void 0,preventDismissOnLostFocus:!this.state.focusInside,preventDismissOnScroll:this.props.parameters.preventDismissOnScroll,preventDismissOnResize:this.props.parameters.preventDismissOnResize,bounds:null!==(t=this.props.parameters.bounds)&&void 0!==t?t:void 0,directionalHint:!0===this.props.parameters.isMultiParagraphSuggestion?v.a.topLeftEdge:void 0},C.createElement(S.a,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:this.state.focusInside,disableFirstFocus:this.props.parameters.keepCurrentFocus,componentRef:this.focusTrapZone,style:this.props.styleProvider.focusTrapStyles},C.createElement("div",{ref:this.calloutBodyElement},this.createContentGroups(this.state.parameters.definition)))))},t.prototype.focus=function(){this.focusTrapZone.current&&(this.setState({focusInside:!0}),this.focusTrapZone.current.focus())},t.prototype.calloutOnDismissHandler=function(){this.dismiss({actionSourceId:i.Unknown})},t.prototype.dismiss=function(e){e&&(this.commonActionData=e),Yo.unmountComponentAtNode(this.props.parameters.containerElement)},t.prototype.setDefinition=function(e){e?this.setState((function(t){var n=Object(l.__assign)({},t.parameters);return n.definition=e,{parameters:n}})):u.a.sendTraceTag(595658962,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Tried to set null definition for an open menu")},t.prototype.updatePosition=function(){this.forceUpdate()},t.prototype.executeDefaultAction=function(){this.defaultActionableIntent&&this.defaultActionableIntent.executeDefaultAction()},t.prototype.executeActionFromString=function(e){this.defaultActionableIntent&&e&&this.defaultActionableIntent.executeActionFromString(e)},t.prototype.invokeBadgeId=function(e){null!=e?this.defaultActionableIntent&&this.defaultActionableIntent.invokeBadgeId(e):u.a.sendTraceTag(526653642,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Tried to invoke null badge ID for an open menu")},t.prototype.getElementBounds=function(){if(!this.calloutBodyElement.current)return null;try{var e=this.calloutBodyElement.current.getBoundingClientRect();return{left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top}}catch(e){return null}},t.prototype.onAutoReplaceAction=function(e,t,n){this.props.parameters.onAction&&this.props.parameters.onAction({actionType:e,engagement:t,objectName:"Intent-AutoReplace",objectFulfillment:n})},t.prototype.createAutoReplaceAction=function(e,t){return this.onAutoReplaceAction.bind(this,e,Po.Try,t)},t.prototype.createAutoReplaceContent=function(e){var t=e.contentData,n={onAction:this.onUndo,originalText:t.originalText,strings:{undoAccessibilityLabel:"Undo"}};return C.createElement(Do,Object(l.__assign)({},n))},t.prototype.createTrackChangeContent=function(e){var t,n,o,i=e.contentData,r=(null===(t=i.changeDescriptor)||void 0===t?void 0:t.localizedDate)||"",s={definition:{definitionType:"TrackChangeDefinition",authorName:i.authorName||"",authorColor:i.authorColor||"",changeDescriptor:{formatting:null===(n=i.changeDescriptor)||void 0===n?void 0:n.formatting,text:(null===(o=i.changeDescriptor)||void 0===o?void 0:o.text)||"",localizedDate:r},theme:i.theme,acceptDisabled:!!i.acceptDisabled,rejectDisabled:!!i.rejectDisabled},strings:{acceptHoveredHeading:this.props.resources.TrackChangeCardAcceptSuggestionLabel,regularHeading:this.props.resources.TrackChangeCardAcceptOrRejectSuggestionLabel,rejectHoveredHeading:this.props.resources.TrackChangeCardRejectSuggestionLabel},style:{minWidth:240,maxWidth:240},onAcceptHoverIn:this.onAcceptPreviewStart,onRejectHoverIn:this.onRejectPreviewStart,onAcceptHoverOut:this.onAcceptPreviewEnd,onRejectHoverOut:this.onRejectPreviewEnd,onAcceptClick:this.onAccepted,onRejectClick:this.onRejected},a=r?"on ".concat(r):"";return C.createElement("div",{id:this.headerId(),"aria-label":"".concat(s.definition.authorName," ").concat(s.definition.changeDescriptor.text," ").concat(a)},C.createElement(Qo.a,Object(l.__assign)({},s)))},t.prototype.getInlineFileSuggestionSourceType=function(e){switch(e){case"ClassicAttachment":return a.ClassicAttachment;case"OneDriveForBusiness":return a.OneDriveForBusiness;case"SharepointOnline":return a.SharepointOnline;default:return a.Undefined}},t.prototype.convertAddressResultToSuggestion=function(e,t){var n;return{annotationId:t,id:null!==(n=e.entityId)&&void 0!==n?n:"",title:e.addressLine,subtitle:e.locality+" "+e.postalCode,url:e.url,type:g.EntityType.Address}},t.prototype.convertSatoriResultToSuggestion=function(e){var t;return{id:null!==(t=e.entityId)&&void 0!==t?t:"",title:e.text,type:g.EntityType.Satori}},t.prototype.convertTopicResultToSuggestion=function(e){return{id:e.Id,title:e.DisplayName,subtitle:e.Description,url:e.Url,type:g.EntityType.Topic,tooltip:e.Description}},t.prototype.convertFileResultToSuggestion=function(e){return{type:e.entityType,sourceType:this.getInlineFileSuggestionSourceType(e.FileSourceType),fileName:e.FileName,hitFileName:e.FileName,fileExtension:e.FileExtension||"",url:e.AccessUrl||"",lastAccessDateTime:e.DateAccessed,lastModifiedDateTime:e.DateModified,createdDateTime:e.DateCreated,itemId:e.Id,fileSize:e.FileSize||0}},t.prototype.getPersonImageUrl=function(e){if(e&&this.state.profileImageUrlCache[e])return this.state.profileImageUrlCache[e]},t.prototype.convertPersonResultToSuggestion=function(e){var t,n=e.EmailAddresses&&(null===(t=e.EmailAddresses)||void 0===t?void 0:t.length)>0?e.EmailAddresses[0]:void 0;return{type:e.entityType,displayName:e.DisplayName||n||"",primaryEmailAddress:n||"",imageUrl:this.getPersonImageUrl(n),initials:Object(x.a)(e.text,this.props.isRightToLeft)}},t.prototype.convertLoopSuggestion=function(e){var t;return{type:e.entityType,id:e.text,title:e.text,iconName:null===(t=e.icon)||void 0===t?void 0:t.iconName}},t.prototype.isSupportedLoopEntity=function(e){switch(e.text){case"Checklist":case"Task list":return!0;default:return!1}},t.prototype.getFlagType=function(e){switch(e){case g.EntityType.People:return r.Person;case g.EntityType.Address:return r.Location;case g.EntityType.Satori:return r.SatoriEntity;case g.EntityType.Topic:return r.Topic;default:return r.Location}},t.prototype.getEntityTitle=function(e){switch(e){case g.EntityType.File:return this.props.resources.FileEntityLabel;case g.EntityType.People:return this.props.resources.PeopleEntityLabel;case g.EntityType.Loop:return this.props.resources.LoopEntityLabel;case g.EntityType.Address:return this.props.resources.AddressEntityLabel;case g.EntityType.Satori:return this.props.resources.SatoriEntityLabel;case g.EntityType.Topic:return this.props.resources.TopicsEntityLabel;default:return""}},t.prototype.sortEntityTitle=function(e,t){for(var n={},o=[this.getEntityTitle(""),this.getEntityTitle(g.EntityType.People),this.getEntityTitle(g.EntityType.File),this.getEntityTitle(g.EntityType.Loop),this.getEntityTitle(g.EntityType.Address),this.getEntityTitle(g.EntityType.Topic),this.getEntityTitle(g.EntityType.Satori)],i=0;i<o.length;i++)n[o[i]]=i;return n[e]-n[t]||e.localeCompare(t)},t.prototype.fromInlineActionId=function(e){switch(e){case s.Retry:return Fo.Retry;case s.ClearSearch:return Fo.ClearSearch;default:return null}},t.prototype.convertContextIQResult=function(e,t){switch(e.entityType){case g.EntityType.File:return this.convertFileResultToSuggestion(e);case g.EntityType.People:var n=this.convertPersonResultToSuggestion(e);return this.fetchProfileImageUrl(n),n;case g.EntityType.Address:return this.convertAddressResultToSuggestion(e,t);case g.EntityType.Satori:return this.convertSatoriResultToSuggestion(e);case g.EntityType.Topic:return this.convertTopicResultToSuggestion(e);case g.EntityType.Loop:return this.isInsertLoopsComponentEnabled&&this.isSupportedLoopEntity(e)?this.convertLoopSuggestion(e):void 0}},t.prototype.fetchProfileImageUrl=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return Object(l.__generator)(this,(function(i){switch(i.label){case 0:return!e.primaryEmailAddress||this.state.profileImageUrlCache[e.primaryEmailAddress]?[2]:this.state.parameters.getPersonImageUrl?[4,this.state.parameters.getPersonImageUrl(e.primaryEmailAddress,e.displayName)]:[3,2];case 1:(t=i.sent())&&(n=Object(l.__assign)(Object(l.__assign)({},this.state.profileImageUrlCache),((o={})[e.primaryEmailAddress]=t,o)),this.setState({profileImageUrlCache:n})),i.label=2;case 2:return[2]}}))}))},t.prototype.onContextIQItemFocused=function(e){this.state.parameters.editingElement&&this.state.parameters.editingElement.setAttribute("aria-activedescendant",e.focusedItemHtmlId)},t.prototype.createContextIQContent=function(e){var t,n,o,i=this,s=r.Location,a={},c={},g=e.contentData;if(null===(t=g.results)||void 0===t||t.forEach((function(e){var t=i.convertContextIQResult(e,g.annotationId);if(t){var n=!!g.bestMatchResults&&-1!==g.bestMatchResults.findIndex((function(t){return t.entityId===e.entityId}))?"":i.getEntityTitle(t.type);s=i.getFlagType(t.type),a[n]?(a[n].push(t),c[n]++):(a[n]=[t],c[n]=1)}})),!e.isContentPending&&this.prevPreviewDataCIQ!==e.previewData){this.prevPreviewDataCIQ=e.previewData;var h=""===e.previewData;this.props.dependencies.actionLogger.logNumCIQResults(c,h,null!==(n=e.isFirstInvoke)&&void 0!==n&&n,e.previewData?e.previewData.length:0)}var f={brandingMode:z.b.IconAndTextButton,actions:this.props.parameters.showEditorButton?[z.a.OpenEditorPane]:[]};"Intent-ContextIQFlags"===e.type?o=Object(l.__assign)(Object(l.__assign)({},f),{flag:s}):"Intent-ContextIQUserInit"===e.type&&(o=Object(l.__assign)(Object(l.__assign)({},f),{userInitiated:!0}));var m,y={results:Object.keys(a).sort(this.sortEntityTitle).map((function(e){return{title:e,suggestions:a[e]}})),queryString:e.previewData?e.previewData:"@",onItemSelected:function(t){i.contextIQAction({actionType:Fo.Apply,engagement:Po.Keep,objectName:e.type,objectFulfillment:void 0,descriptorData:t,data:{entityType:t.type,queryLength:e.previewData?e.previewData.length:0}})},onAction:function(t){var n=i.fromInlineActionId(t);null!=n?i.contextIQAction({actionType:n,engagement:Po.Try,objectName:e.type}):u.a.sendTraceTag(537536654,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unknown InlineActionId")},isLoading:e.isContentPending,isError:!!e.errorMessage,strings:us(this.props.resources),theme:(m=di().palette,{background:{resting:m.white,hover:m.neutralLighterAlt,pressed:m.neutralLighter,disabled:m.neutralLighterAlt},text:{resting:m.neutralDark,disabled:m.neutralTertiary},altText:{resting:m.neutralSecondaryAlt},action:m.themePrimary,highlighting:m.neutralLighterAlt,branding:{type:"IconAndTextButton",background:{resting:m.white,hover:m.neutralLighterAlt,pressed:m.neutralLighter,disabled:m.white},icon:{resting:m.themePrimary,disabled:m.neutralTertiary},title:{resting:m.themePrimary,disabled:m.neutralTertiary},tooltip:{textColor:m.neutralDark},focusRing:m.neutralSecondaryAlt},scroll:{thumbColor:m.neutralTertiary},tooltip:{backgroundColor:m.white,textColor:m.neutralDark,showBeak:!0,directionHint:z.d.rightCenter}}),keyboardHandlerTarget:this.state.parameters.keyboardHandlerTarget?this.state.parameters.keyboardHandlerTarget:void 0,onItemFocused:this.onContextIQItemFocused,menuType:o,onFooterAction:function(t){var n=ms(t);n&&i.contextIQAction({actionType:n,engagement:Po.None,objectName:e.type})}};return C.createElement(To,Object(l.__assign)({},y))},t.prototype.createSummarizationCommandBarContent=function(){var e=this,t=function(e){switch(e){case Mo.UndoInsertSummarization:return Fo.UndoInsertSummarization;case Mo.RefreshSummary:return Fo.RefreshSummary;case Mo.Feedback:default:return Fo.GiveFeedback}},n=function(e){switch(e){case Mo.UndoInsertSummarization:case Mo.RefreshSummary:return Po.Try;default:return Po.None}},o={isSummarizationCopilotBranded:Object(c.h)("Microsoft.Office.WordOnline.IsSummarizationCopilotBranded",!1),actions:[Mo.UndoInsertSummarization,Mo.Feedback],onAction:function(o){e.props.parameters.onAction&&e.props.parameters.onAction({actionType:t(o),engagement:n(o),objectName:"Intent-SummarizationCommandBar"})},strings:us(this.props.resources),theme:Object(w.B)(vi())};return C.createElement(Zo,Object(l.__assign)({},o))},t.prototype.createContentGroups=function(e){var t=this;if(e&&e.suggestionGroups){var n=e.suggestionGroups.map((function(e,n){return t.createGroup(e,n)})).filter((function(e){return!!e}));return 1===n.length?n[0]:C.createElement("div",{role:"list","aria-label":this.props.resources.GroupListLabel},n)}return u.a.sendTraceTag(595854147,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Failure to create content groups because data model is missing or empty"),null},t.prototype.createGroup=function(e,t){if(!e)return u.a.sendTraceTag(595854149,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"group is null or undefined"),null;if(this.props.dependencies.hostServices&&!this.props.dependencies.hostServices.isGroupEnabled(e))return u.a.sendTraceTag(595637723,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Group type '".concat(e.type,"' is not enabled and thus skipped")),null;switch(e.type){case Yi.id:return this.createIntentComponent(t,e,Yi,mi);case rr.sensitiveContent:return this.createIntentComponent(t,e,rr,Si);case Es.critique:return this.createIntentComponent(t,e,Ns,Hi);case Es.imageCritique:case Es.pqCritique:return this.createIntentComponent(t,e,zs,zi);case"SharedSpellingCritique":case"SharedRepeatedWordCritique":case"SharedGrammarCritique":case"SharedSuggestionCritique":case"SharedRewriteCritique":case"SharedDictationCorrectionCritique":return this.createIntentComponent(t,e,Ds,Si);case rr.neuralRewrite:return this.createIntentComponent(t,e,rr,xi);case rr.similarity:return this.createIntentComponent(t,e,rr,Ci);case Us.id:return this.createIntentComponent(t,e,Us,Ui);case"Intent-TrackChange":return this.createTrackChangeContent(e);case"Intent-AutoReplace":return this.createAutoReplaceContent(e);case"Intent-ContextIQFlags":case"Intent-ContextIQUserInit":return this.createContextIQContent(e);case"Intent-SummarizationCommandBar":return this.createSummarizationCommandBarContent();default:return u.a.sendTraceTag(595854148,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"Unknown group: ".concat(e.type)),null}},t.prototype.createIntentComponent=function(e,t,n,o){var i=this.createIntentProps(t,o,e);return this.createIntentView(e,i,n)},t.prototype.createIntentProps=function(e,t,n){return{parameters:this.state.parameters,dismiss:this.dismiss,group:e,resources:this.props.resources,isRightToLeft:this.props.isRightToLeft,uiCulture:this.props.uiCulture,styleProvider:new t(this.props.isRightToLeft),hostElementRef:this.focusTrapZone,dependencies:this.props.dependencies,position:n}},t.prototype.createIntentView=function(e,t,n){var o=this,i=n;return C.createElement(i,Object(l.__assign)({key:e,ref:function(t){return o.assignDefaultActionableIntent(e,t)}},t))},t.prototype.assignDefaultActionableIntent=function(e,t){0===e&&(this.defaultActionableIntent=t)},t.prototype.onTrackChangeAction=function(e,t,n){this.props.parameters.onAction&&this.props.parameters.onAction({actionType:e,engagement:t,objectName:"Intent-TrackChange",objectFulfillment:n})},t.prototype.createTrackChangeToggleAction=function(e){return this.onTrackChangeAction.bind(this,Fo.Toggle,Po.See,e)},t.prototype.headerId=function(){var e,t,n;return 1===(null===(t=null===(e=this.props.parameters.definition)||void 0===e?void 0:e.suggestionGroups)||void 0===t?void 0:t.length)&&(null===(n=this.props.parameters.definition.suggestionGroups[0])||void 0===n?void 0:n.type)?Zi.createHeaderId(this.props.parameters.definition.suggestionGroups[0].type):""},t.prototype.contextIQAction=function(e){var t,n;null===(n=(t=this.props.parameters).onAction)||void 0===n||n.call(t,e),this.props.dependencies.actionLogger.logAction(e,{actionSourceId:i.Unknown})},t}(C.PureComponent);function qs(e){var t,n,o,i,r;if(1===(null===(n=null===(t=e.definition)||void 0===t?void 0:t.suggestionGroups)||void 0===n?void 0:n.length)&&(null===(o=e.definition.suggestionGroups[0])||void 0===o?void 0:o.type)){if("Type-AIFeedbackRewrite"===(null===(r=null===(i=e.definition)||void 0===i?void 0:i.suggestionGroups[0])||void 0===r?void 0:r.critiqueSubType))return!0;var s=e.definition.suggestionGroups[0].type;return"SharedGrammarCritique"===s||"SharedSpellingCritique"===s||"SharedSuggestionCritique"===s||"SharedRepeatedWordCritique"===s}return!1}var Vs,Zs,Qs=n(3),Ys=function(){function e(e){this.logSystemInitiatedFeedback=e}var t;return e.prototype.logAction=function(t,n){var o,i;if(t){var r=Object(l.__assign)({},t);r.actionName=Fo[t.actionType],r.engagementName=Po[t.engagement];var s=[{name:"actionType",int64:r.actionType},{name:"engagement",int64:r.engagement},{name:"actionName",string:r.actionName},{name:"engagementName",string:r.engagementName},{name:"objectName",string:r.objectName},{name:"objectId",string:r.objectId},{name:"objectFulfillment",string:r.objectFulfillment},{name:"actionSourceId",int64:n.actionSourceId}];void 0!==n.executedBadgeId&&s.push({name:"executedBadgeId",int64:n.executedBadgeId}),void 0!==n.maxBadgeId&&s.push({name:"maxBadgeId",int64:n.maxBadgeId});var a=r.objectName&&null!==(i=null===(o=e.userActionCommandMap[r.objectName])||void 0===o?void 0:o[r.engagement])&&void 0!==i?i:e.canvasContextualActionName;if(r.data){var c=r.data;Object.keys(c).forEach((function(e){var t=c[e],n=typeof t;"string"===n?s.push({name:e,string:t}):"boolean"===n?s.push({name:e,bool:t}):"number"===n&&Number.isInteger(t)?s.push({name:e,int64:t}):"number"===n?s.push({name:e,double:t}):u.a.sendTraceTag(528498709,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"ActionLogger: Data type '".concat(n,"' is not supported and therefore skipped."))}))}var g=a===e.contextIQCardSeen;g&&5===e.seenCountWithoutKept?(e.seenCountWithoutKept=0,this.logSystemInitiatedFeedback?this.logSystemInitiatedFeedback("CIQ_SeenNotKept"):u.a.sendTraceTag(509104668,p.a.msoulscat_Wac_Telemetry,d.a.Warning,"ActionLogger: No SystemInitiatedFeedback logger function found and thus the CIQ_SeenNotKept survey trigger is not fired.")):g&&e.seenCountWithoutKept++,a===e.contextIQCardKept&&(e.seenCountWithoutKept=0),Object(Qs.sendUserActionEvent)({actionName:a,dataFields:s})}},e.prototype.logNumCIQResults=function(t,n,o,i){var r=e.contextIQCardNumberOfResults,s=[{name:"isInZeroState",bool:n},{name:"isFirstInvoke",bool:o},{name:"queryLength",int64:i}];Object.keys(t).forEach((function(e){s.push({name:e,int64:t[e]})})),Object(Qs.sendUserActionEvent)({actionName:r,dataFields:s})},t=e,e.canvasContextualActionName="CanvasContextualSuggestion",e.contextIQCardSeen="ContextIQCardSeen",e.contextIQCardTried="ContextIQCardTried",e.contextIQCardKept="ContextIQCardKept",e.contextIQCardNumberOfResults="ContextIQCardNumberOfResults",e.userActionCommandMap=((Vs={})["Intent-ContextIQUserInit"]=((Zs={})[Po.See]=t.contextIQCardSeen,Zs[Po.Try]=t.contextIQCardTried,Zs[Po.Keep]=t.contextIQCardKept,Zs),Vs),e.seenCountWithoutKept=0,e}(),Ks=function(){function e(e){this.params=e,this.actionLogger=new Ys(this.params.logSystemInitiatedFeedback)}return e.prototype.createContextualUi=function(e){return e&&e.containerElement&&this.params?function(e,t,n,o){return new Promise((function(r,s){var a=(new ti).loadStrings(t),l=function(t,n){var o=t?{message:t.message,stack:t.stack}:{};u.a.sendTraceTag(595637724,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Crash while rendering. Error: ".concat(JSON.stringify(o)," Info: ").concat(JSON.stringify(n))),s(t),(new h.a).setImmediate((function(){e.onDismiss&&e.onDismiss({actionSourceId:i.Unknown}),Yo.unmountComponentAtNode(e.containerElement)}))};a.then((function(i){var s,a,c;Yo.render(C.createElement(Ws,{onError:l},C.createElement(Gs,{ref:function(e){r(e)},parameters:e,styleProvider:new Ai({isRightToLeft:n,alignInnerTextWithAnchor:qs(e),allowContentOverflow:"Intent-TrackChange"===(null===(s=e.definition)||void 0===s?void 0:s.id),customScrollbarUsed:"Intent-ContextIQFlags"===(null===(a=e.definition)||void 0===a?void 0:a.id)||"Intent-ContextIQUserInit"===(null===(c=e.definition)||void 0===c?void 0:c.id)}),resources:i,isRightToLeft:n,uiCulture:t,dependencies:o})),e.containerElement)})).catch((function(e){return s(e)}))}))}(e,this.getUiCulture(),this.params.isRightToLeft,this.createDependencies(e.hostServices)):Promise.reject(new Error("Arguments are not provided or incorrect."))},e.prototype.logAction=function(e,t){e&&this.actionLogger.logAction(e,null!=t?t:{actionSourceId:i.Unknown})},e.prototype.createDependencies=function(e){var t=this.params,n=t.dimeCallback,o=t.loadUpsellDependencies,i=t.getSoftPaywallData,r=t.getPremiumPreviewCritiquesList;return{actionLogger:this.actionLogger,hostServices:e,dimeCallback:n,loadUpsellDependencies:o,getSoftPaywallData:i,getPremiumPreviewCritiquesList:r}},e.prototype.getUiCulture=function(){return this.params.uiCulture||"en-US"},e}(),Xs=n(2772),Js={accdb:{extensions:["accdb","mdb"]},archive:{extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{extensions:["aif","aiff","aac","alac","amr","ape","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","oga","ra","rm","wav","wma","wv"]},calendar:{extensions:["ical","icalendar","ics","ifb","vcs"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","cbl","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","h","h++","haml","handlebars","hbs","hcp","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsproj","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","ps1xml","psd1","psm1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","shtml","sml","svn-base","swift","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},contact:{extensions:["vcf"]},csv:{extensions:["csv"]},desktopfolder:{},docset:{},documentfolder:{},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{extensions:["eml","msg","ost","pst"]},exe:{extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},folder:{},font:{extensions:["ttf","otf","woff"]},fluid:{extensions:["b","fluid"]},genericfile:{},html:{extensions:["htm","html","mht"]},link:{extensions:["lnk","link","url","website","webloc"]},linkedfolder:{},listitem:{},officescript:{extensions:["osts"]},splist:{extensions:["listitem"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layer","layout","max","mcworld","mtl","obj","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},multiple:{},one:{extensions:["note","one"]},onetoc:{extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pbiapp:{},pdf:{extensions:["pdf"]},photo:{extensions:["arw","bmp","cr2","crw","dic","dicm","dcm","dcm30","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psb","psd","raw","tga","tif","tiff","wdp"]},photo360:{},picturesfolder:{},potx:{extensions:["pot","potm","potx"]},powerbi:{extensions:["pbids","pbix"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx","classifier"]},sponews:{},spreadsheet:{extensions:["odc","ods","gsheet","numbers","tsv"]},stream:{},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{},sway:{},sysfile:{extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","ldt","lrprev","pkpass","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xlb","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vaultclosed:{},vaultopen:{},vector:{extensions:["ai","ait","cvs","dgn","gdraw","pd","emf","eps","fig","ind","indd","indl","indt","indb","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vdx","vsd","vsdm","vsdx","vsw","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx","vsx"]},whiteboard:{extensions:["whiteboard"]},xlsx:{extensions:["xlc","xls","xlsb","xlsm","xlsx","xlw"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{extensions:["zip"]}},$s=[16,20,24,32,40,48,64,96];function ea(e,t){void 0===e&&(e="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20210115.001/assets/item-types/"),$s.forEach((function(n){!function(e,t,n){var o=Object.keys(Js),i={};o.forEach((function(n){var o=e+t+"/"+n;i[n+t+"_png"]=C.createElement("img",{src:o+".png",alt:""}),i[n+t+"_svg"]=C.createElement("img",{src:o+".svg",alt:""}),i[n+t+"_1.5x_png"]=C.createElement("img",{src:e+t+"_1.5x/"+n+".png",height:"100%",width:"100%",alt:""}),i[n+t+"_1.5x_svg"]=C.createElement("img",{src:e+t+"_1.5x/"+n+".svg",height:"100%",width:"100%",alt:""}),i[n+t+"_2x_png"]=C.createElement("img",{src:e+t+"_2x/"+n+".png",height:"100%",width:"100%",alt:""}),i[n+t+"_3x_png"]=C.createElement("img",{src:e+t+"_3x/"+n+".png",height:"100%",width:"100%",alt:""}),i[n+t+"_4x_png"]=C.createElement("img",{src:e+t+"_4x/"+n+".png",height:"100%",width:"100%",alt:""})})),Object(ni.hb)({fontFace:{},style:{width:t,height:t,overflow:"hidden"},icons:i,mergeImageProps:!0},n)}(e,n,t)}))}var ta=function(){function e(){}return e.createController=function(e){return Object(Xs.a)(void 0,{disableWarnings:!0}),ea(void 0,{disableWarnings:!0}),new Ks(e)},e}(),na=n(44),oa=function(){function e(e){this._documentScoreHandler=e,this.skittleArgs={isThinking:!1},this.kpiConfigOfferLevel=void 0,this.scaleCritiquePercentage=function(e,t,n){return 0===t?0:Math.round(e*n/t)}}return Object.defineProperty(e.prototype,"documentScore",{get:function(){return this._documentScoreHandler.documentScore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_relativeSpellingScore",{get:function(){return this._documentScoreHandler.documentScoreWithoutSpelling-this.documentScore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_relativeGrammarScore",{get:function(){return this._documentScoreHandler.documentScoreWithoutGrammar-this.documentScore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_relativeRefinementsScore",{get:function(){return this._documentScoreHandler.documentScoreWithoutRefinements-this.documentScore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isIncipient",{get:function(){return this.wordCount<100},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"progressBarData",{get:function(){return this.scaleCritiquesPercentage(this.documentScore,this.relativeCritiqueScores)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordCount",{get:function(){return this._documentScoreHandler.wordCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"critiquesCount",{get:function(){return this._documentScoreHandler.critiquesCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relativeCritiqueScores",{get:function(){return{grammarPercent:this._relativeGrammarScore,refinementsPercent:this._relativeRefinementsScore,spellingPercent:this._relativeSpellingScore}},enumerable:!1,configurable:!0}),e.prototype.scaleCritiquesPercentage=function(e,t){var n=t.spellingPercent,o=t.grammarPercent,i=t.refinementsPercent,r=n+o,s=n+o+i,a=this.scaleCritiquePercentage(r,s,100-e),l=100-e-a;return{spellingPercent:this.scaleCritiquePercentage(n,r,a),grammarPercent:this.scaleCritiquePercentage(o,r,a),refinementsPercent:this.scaleCritiquePercentage(i,s-r,l)}},e}();Object(na.k)(oa,{wordCount:na.h,isIncipient:na.h,critiquesCount:na.h,documentScore:na.h,progressBarData:na.h,skittleArgs:na.p});var ia,ra=function(){function e(){var e=this;this.currentFocused=document.createElement("div"),this.currentHovered=document.createElement("div"),this.isFocusForced=!1,this.forceFocus=function(t){e.isFocusForced=t},this.handleElementHoveredOrFocused=function(t){t.stopPropagation(),"mouseover"!==t.type&&"mouseenter"!==t.type||(e.currentHovered=t.currentTarget),"mouseout"!==t.type&&"mouseleave"!==t.type||(e.currentHovered=null),"focus"!==t.type&&"click"!==t.type||(e.currentFocused=t.currentTarget),"blur"===t.type&&(e.currentFocused=null)},this.reset=function(){e.currentFocused=e.currentHovered=null}}return Object.defineProperty(e.prototype,"currentHoveredOrFocused",{get:function(){var e;return null!==(e=this.currentFocused)&&void 0!==e?e:this.currentHovered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHoveredOrFocused",{get:function(){return!!this.currentHoveredOrFocused||this.isFocusForced},enumerable:!1,configurable:!0}),e}();Object(na.k)(ra,{currentFocused:na.p,currentHovered:na.p,currentHoveredOrFocused:na.h,isHoveredOrFocused:na.h,forceFocus:na.g,isFocusForced:na.p,handleElementHoveredOrFocused:na.g,reset:na.g}),function(e){e[e.Collapsed=0]="Collapsed",e[e.Disabled=1]="Disabled",e[e.Short=2]="Short",e[e.FullSize=3]="FullSize"}(ia||(ia={}));var sa=function(){function e(e){this._store=e,this.verticalScrollValue=0,this.fullSizeLimit=30,this.shortSizeLimit=600,this.viewportHeight=window.innerHeight}return Object.defineProperty(e.prototype,"cardSize",{get:function(){return this.viewportHeight<180?ia.Disabled:this.verticalScrollValue<this.fullSizeLimit?ia.FullSize:this.verticalScrollValue<this.shortSizeLimit&&this._store.isIncipient?ia.Collapsed:this.verticalScrollValue<this.shortSizeLimit?ia.Short:ia.Collapsed},enumerable:!1,configurable:!0}),e}();Object(na.k)(sa,{cardSize:na.h,verticalScrollValue:na.p,fullSizeLimit:na.p,shortSizeLimit:na.p,viewportHeight:na.p});var aa=n(2668),la=n(963),ca=function(){this.css=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ni.db.apply(void 0,e)},this.keyframes=ni.ab},ua=n(960),pa=n(1699),da="(-ms-high-contrast: active), (forced-colors: active)",ga="(-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)",ha="(-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)",fa="@media screen and "+da,ma="@media screen and "+ga,ya="@media screen and "+ha,ba=(new(function(){function e(){}return Object.defineProperty(e.prototype,"isHighContrastActive",{get:function(){return window.matchMedia(da).matches},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHighContrastBlack",{get:function(){return window.matchMedia(ga).matches},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHighContrastWhite",{get:function(){return window.matchMedia(ha).matches},enumerable:!1,configurable:!0}),e}()),n(1698)),va=n(964),Sa=n(741),xa=function(e){ba.a.isKey(e,va.a.escape)&&(e.currentTarget.focus(),e.stopPropagation())};var Ca=function(e){var t=e.shouldRenderAsPremium,n=e.styleProvider,o=!e.hasHeader&&!e.ariaLabel,i="IdeasCardHeader_".concat(e.id),r=function(){var e,t=Object(Sa.b)();return{boxShadow:t.cardShadow,backgroundColor:t.buttonBackground,emptyCells:"hide","&:not(:empty)":(e={},e[ya]={border:"1px solid #000"},e[ma]={border:"1px solid #fff"},e)}}(),s=n.css(function(){var e,t=Object(Sa.b)();return{borderRadius:"4px",boxShadow:t.cardShadow,backgroundColor:t.buttonBackground,msHighContrastAdjust:"auto",position:"relative",emptyCells:"hide","&:not(:empty)":(e={},e[ya]={border:"1px solid #000"},e[ma]={border:"1px solid #fff"},e)}}(),t?r:[]);return o?C.createElement("div",{className:s,"data-card":1,"data-automation-id":i,"data-ignore-user-engagement":e.ignoreUserEngagement},e.children):C.createElement(q.a,{className:s,"data-card":1,"data-automation-id":i,"data-ignore-user-engagement":e.ignoreUserEngagement,isCircularNavigation:!0,onKeyDown:xa,direction:3},e.children)},Ta=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._styles={header:{marginBottom:"12px",padding:"0"},title:{display:"flex",alignItems:"center",fontSize:"14px",fontWeight:"600"}},t}return Object(l.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.id,n=e.title;return C.createElement("div",{className:this.props.styleProvider.css(this._styles.header),id:t},n&&this.renderTitle())},t.prototype.renderTitle=function(){var e=this.props,t=e.icon,n=e.styleProvider;return C.createElement("h1",{"aria-level":1,className:n.css(this._styles.title)},t,this.props.title)},t}(C.Component),wa=function(){return{diamondIcon:{width:"27px",color:Object(Sa.b)().infoIcon,fontSize:"20px",margin:"15px 15px 0px 15px"},diamondIconHeader:{color:"inherit",margin:"0px 0px 0px 0px"}}},Oa=function(e){var t=e.styleProvider.css(wa().diamondIcon,e.isHeader?wa().diamondIconHeader:[]);return C.createElement(Ji.a,{"aria-hidden":!0,iconName:"Diamond",className:t})};function ka(){var e=Object(Sa.b)();return{diamondHeader:{color:e.disabledText,":hover i":{color:e.accentButtonText}},header:{color:e.buttonText}}}var Aa=function(e){return e.shouldRenderAsPremium?C.createElement("div",{"data-automation-id":e.id,className:e.styleProvider.css(ka().diamondHeader)},C.createElement(Ta,Object(l.__assign)({},e,{icon:C.createElement(Oa,{isHeader:!0,styleProvider:e.styleProvider})}))):C.createElement("div",{"data-automation-id":e.id,className:e.styleProvider.css(ka().header)},C.createElement(Ta,Object(l.__assign)({},e)))},Ia={padding:"0"},ja=function(e){var t,n,o=e.id,i=e.styleProvider,r=e.ariaHidden,s=null!==(t=e.ariaLabel)&&void 0!==t?t:void 0,a=null!==(n=e.contentRole)&&void 0!==n?n:ua.a.Group;return C.createElement("div",{"aria-hidden":r,"aria-label":s,id:o,"data-automation-id":o,onFocus:e.onFocus,onBlur:e.onBlur,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,role:a,tabIndex:-1},C.createElement("div",{className:i.css(Ia)},e.children))},_a=Object(na.p)({isTABNavigationUsed:!1});function Ma(){return _a.isTABNavigationUsed}var Da,Ea,Ra,Ba,Na=Object(na.g)((function(){var e=document.querySelector("body");_a.isTABNavigationUsed=!!e&&e.classList.contains("ms-Fabric--isFocusVisible")})),La=function(e){var t,n={description:e.description,title:e.title,hasHeader:e.hasHeader},o=Object(l.__assign)({margin:"24px 0 10px 0",":first-of-type":{marginTop:"6px"}},e.style),i=e.styleProvider,r=e.theme,s=e.visibilityChanged,a=e.visibilityChangedCallbackMode,c=C.useCallback((function(t){var n,o=t.target;o&&function(e){if(Na(),Ma()){if(!(e.getBoundingClientRect().top>=180)){var t=window.scrollY,n=Math.max(t-180,0);window.requestAnimationFrame((function(){window.scrollTo(0,n)}))}}}(o),null===(n=e.onFocus)||void 0===n||n.call(e)}),[e.onFocus]),u=null!==(t=e.contentRole)&&void 0!==t?t:ua.a.Group,p=C.createElement("div",{className:"ideas-card ".concat(i.css(o))},e.hasHeader&&C.createElement(Aa,Object(l.__assign)({shouldRenderAsPremium:e.shouldRenderAsPremium,id:e.headerId,styleProvider:e.styleProvider,theme:r},n)),C.createElement(Ca,{id:e.headerId,hasHeader:e.hasHeader,ariaLabel:e.ariaLabel,ignoreUserEngagement:e.ignoreUserEngagement,shouldRenderAsPremium:e.shouldRenderAsPremium,styleProvider:e.styleProvider,theme:r},C.createElement(ja,Object(l.__assign)({id:"shell"+e.headerId,styleProvider:e.styleProvider,shouldRenderAsPremium:e.shouldRenderAsPremium,ariaLabel:e.ariaLabel,ariaHidden:!e.hasHeader&&!e.ariaLabel||void 0,contentRole:u,onFocus:c,onBlur:e.onBlur,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},n),e.children)));return s?C.createElement(pa.a,{visibilityChanged:s,visibilityChangedCallbackMode:a},p):p},Pa=n(2663);!function(e){e.communicationShade30="#004578",e.communicationShade20="#005a9e",e.communicationShade10="#106ebe",e.communicationPrimary="#0078d4",e.communicationTint10="#2b88d8",e.communicationTint20="#c7e0f4",e.communicationTint30="#deecf9",e.communicationTint40="#eff6fc"}(Da||(Da={})),function(e){e.black="#000000",e.gray400="#c4c4c4",e.gray300="#dbdbdb",e.gray220="#11100f",e.gray210="#161514",e.gray200="#1b1a19",e.gray190="#201f1e",e.gray180="#252423",e.gray170="#292827",e.gray160="#323130",e.gray150="#3b3a39",e.gray140="#484644",e.gray130="#605e5c",e.gray120="#797775",e.gray110="#8a8886",e.gray100="#979593",e.gray90="#a19f9d",e.gray80="#b3b0ad",e.gray70="#bebbb8",e.gray60="#c8c6c4",e.gray50="#d2d0ce",e.gray40="#e1dfdd",e.gray30="#edebe9",e.gray20="#f3f2f1",e.gray10="#faf9f8",e.white="#ffffff"}(Ea||(Ea={})),function(e){e.pinkRed10="#750b1c",e.red30="#a4262c",e.red10="#d13438",e.redOrange10="#da3b01",e.orange30="#8e562e",e.orange20="#ca5010",e.orange10="#ffaa44",e.yellow10="#fce100",e.orangeYellow20="#986f0b",e.orangeYellow10="#c19c00",e.yellowGreen10="#8cbd18",e.green20="#0b6a0b",e.green10="#498205",e.greenCyan10="#00ad56",e.cyan30="#005b70",e.cyan20="#038387",e.cyan10="#00b7c3",e.cyanBlue20="#004e8c",e.cyanBlue10="#0078d4",e.blue10="#4f6bed",e.blueMagenta30="#5c2e91",e.blueMagenta20="#8764b8",e.blueMagenta10="#8378de",e.magenta20="#881798",e.magenta10="#c239b3",e.magentaPink20="#9b0062",e.magentaPink10="#e3008c",e.gray40="#393939",e.gray30="#7a7574",e.gray20="#69797e",e.gray10="#a0aeb2"}(Ra||(Ra={})),function(e){e.activeReviewMode="#0e336a",e.aliceBlueBackground="#f3f7fc",e.barBackground="#d2e0f4",e.barGradientColor="#13458f",e.countColor="#1651aa",e.textColor="#6d6b69",e.grayBackground="#f3f3f3",e.gray1="#d2d2d2",e.gray2="#262626",e.gray3="#757470",e.gray4="#ebebeb",e.gray5="#3c3b3b",e.blueMagenta1="#5a4ebc",e.waterBlue="#D2E0F4",e.wordBlue="#2E6AC5",e.wordBlueDarkAlt="#295fb1",e.wordBlueDark="#225095",e.wordPrimary="#185ABD",e.lightPink="#FDE5E5",e.lightGreen="#D4EDD4",e.darkGreen="#0b5a08"}(Ba||(Ba={}));function Fa(){var e,t=Object(Sa.b)();return{mainWrapper:(e={borderRadius:"4px",boxShadow:"0px 1px 2.5px 0px rgba(0, 0, 0, 0.12), 0px 2px 4px 0px rgba(0, 0, 0, 0.08)",boxSizing:"border-box",height:"".concat(96,"px"),marginTop:"1px",overflow:"hidden",position:"relative",top:"0",transition:"height 400ms cubic-bezier(0.1, 0.9, 0.2, 1), top 400ms cubic-bezier(0.1, 0.45, 0.2, 1)",userSelect:"none",width:"100%",":focus":Ma()?{outline:"1px solid ".concat(t.focusBorder," !important")}:{},":focus > :first-child > :first-child":{backgroundColor:t.buttonBackgroundHovered}},e[ni.l]={outline:"1px solid transparent"},e),skittleMainWrapper:{height:"auto"},mainWrapperCollapsed:{boxShadow:"none",height:"48px",left:"12px",top:"-52px",position:"fixed",width:"calc(100% - 24px)"},mainWrapperShort:{height:"48px"},mainWrapperProgress:{boxShadow:"0px 0.3px 0.9px 0px rgba(0, 0, 0, 0.108), 0px 1.6px 3.6px 0px rgba(0, 0, 0, 0.132)"},progressCardWrapper:{alignItems:"flex-start",display:"flex",height:"100%",position:"relative"},pyroCardStyles:{margin:"0px",":first-of-type":{marginTop:"0px"}},disabledOffset:{marginTop:"-".concat(96,"px")}}}var Ha=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.render=function(){var e,t=this.props.isVisible,n=this.props.styleProvider,o=Object(sr.a)().getStringsFor("ProofingStrings"),i={mainContainer:{alignItems:"center",backgroundColor:(e=Object(Sa.b)()).buttonBackground,display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",opacity:"0",position:"absolute",top:"0",transition:"opacity 200ms linear, z-index 0ms 200ms",width:"100%",zIndex:"-1",":hover,&:focus":{backgroundColor:e.buttonBackgroundHovered},":active":{backgroundColor:e.buttonBackgroundPressed},fontFamily:Pa.b},mainContainerVisible:{opacity:"1",transition:"opacity 200ms linear, z-index 0ms 0ms",zIndex:"103"},startWritingLabel:{color:Ba.wordBlue,fontSize:"20px",fontWeight:"600",height:"24px",lineHeight:"18px",letterSpacing:"0px",maxWidth:"94%",overflow:"hidden",textAlign:"center",textOverflow:"ellipsis",whiteSpace:"nowrap"},editorScoreLabel:{color:e.buttonText,fontSize:"14px",lineHeight:"17px",position:"absolute",height:"19px",left:"17px",top:"13px"},incipientDocumentLabel:{color:"#262626",fontSize:"12px",maxWidth:"300px",textAlign:"center",width:"88%"},hundredWordsLabel:{color:e.bodySubtext,fontSize:"14px",lineHeight:"16px",position:"absolute",height:"19px",left:"17px",top:"34px"}},r=n.css(i.mainContainer,t?i.mainContainerVisible:[]);return T.a.createElement("div",{className:r},T.a.createElement("div",{"aria-hidden":!0,"data-is-focusable":!1,className:n.css(i.editorScoreLabel)},o("ProgressCardTitle")),T.a.createElement("div",{"aria-hidden":!0,"data-is-focusable":!1,className:n.css(i.hundredWordsLabel)},o("IncipientDocumentLabel")))},t}(C.Component),za=n(2801),Ua=n(962),Wa=n(637),Ga=n(2664),qa=function(){function e(){}return e.isElement=function(e){return"getAttribute"in e},e.isNode=function(e){return"parentElement"in e},e.createRect=function(e,t,n){var o={bottom:0,height:t,left:0,right:0,top:0,width:e,x:null!=n?n:0,y:0,toJSON:function(){return""}};return t<0?(o.top=o.y+t,o.bottom=o.y):(o.top=o.y,o.bottom=o.y+t),e<0?(o.right=o.x,o.left=o.x+e):(o.right=o.x+e,o.left=o.x),o},e}(),Va=function(e,t){void 0===t&&(t=6);var n,o=function(e){var t=document.getElementById("ideasApp"),n=null==t?void 0:t.getBoundingClientRect();return n?qa.createRect(n.width-2*e,window.innerHeight,e):void 0}(t);return e&&o?n=o.width<e?o.width:e:e?n=e:o&&(n=o.width),{bounds:o,calloutMaxHeight:void 0,calloutMaxWidth:n,minPagePadding:void 0}};function Za(){var e,t,n,o,i,r=Object(Sa.b)();return{flexContainer:{backgroundColor:r.buttonBackground,alignItems:"center",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",height:"100%",width:"100%",":hover":{backgroundColor:r.buttonBackgroundHovered},":active":{backgroundColor:r.buttonBackgroundPressed}},focusStyle:{":hover > :last-child > *":{backgroundColor:r.bodyStandoutBackground}},suggestionsContainer:{alignItems:"flex-start",cursor:"default",display:"flex",flexDirection:"row",height:"47px",justifyContent:"center",margin:"13px 16px 0px 17px",width:"100%"},suggestionsContainerShort:{alignItems:"flex-start",cursor:"default",display:"flex",flexDirection:"row",height:"22px",justifyContent:"flex-end",marginLeft:"6px",order:2,width:"35px"},editorScoreWrapper:{alignItems:"flex-start",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"44px",width:"36%"},editorScoreWrapperShort:{alignItems:"flex-start",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"20px",width:"35px"},focusableScoreWrapper:{alignItems:"flex-start",cursor:"pointer",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"38px",padding:"0px 1px"},focusableScoreWrapperShort:{alignItems:"flex-start",cursor:"pointer",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"22px",padding:"0px 1px"},progressNumberContainer:{color:r.accentButtonText,fontFamily:Pa.a,fontSize:"40px",fontWeight:"600",height:"44px",letterSpacing:"-1.15px",lineHeight:"43px",overflow:"hidden",pointerEvents:"none",textAlign:"right","@media screen and (-ms-high-contrast: none)":{paddingTop:"2.5px"}},progressNumberContainerShort:{color:r.accentButtonText,fontFamily:Pa.a,fontSize:"17px",fontWeight:"600",height:"20px",letterSpacing:"0px",lineHeight:"25px",textAlign:"right",paddingRight:"1px",order:2,overflow:"hidden",pointerEvents:"none","@media screen and (-ms-high-contrast: none)":{paddingTop:"1px"}},percentageContainer:{color:r.accentButtonText,fontFamily:Pa.a,fontSize:"16px",fontWeight:"bold",lineHeight:"23.5px",letterSpacing:"0px",marginLeft:"1px",pointerEvents:"none",textAlign:"right"},percentageContainerShort:{color:r.accentButtonText,fontFamily:Pa.a,fontSize:"11px",fontWeight:"bold",height:"16px",letterSpacing:"0px",lineHeight:"22px",marginLeft:"1px",order:3,pointerEvents:"none",textAlign:"right"},progressNumber:{height:"100%"},progressLabel:{color:r.buttonText,fontSize:"14px",lineHeight:"17px",height:"17px",width:"64%"},progressLabelShort:{height:"0px",width:"0px",visibility:"hidden"},progressBarWrapper:{alignItems:"center",alignSelf:"center",flexDirection:"row",display:"flex",justifyContent:"center",height:"12px",margin:"12px 16px 12px 16px",width:"100%"},progressBarWrapperShort:{alignItems:"center",alignSelf:"center",flexDirection:"row",display:"flex",justifyContent:"center",order:1,height:"44px",margin:"2px",width:"calc(100% - 72px)"},progressBarUnit:(e={background:"".concat(r.accentButtonText," !important"),borderRadius:"4px",transition:"flex-grow 300ms",height:"8px",margin:"0.5px",forcedColorAdjust:"none",":hover":{cursor:"pointer"}},e[ya]={background:"none",backgroundColor:Ea.black},e[ma]={background:"none",backgroundColor:Ea.white},e),progressBarSecondaryUnit:(t={background:"none",backgroundColor:r.variantBorder},t[fa]={opacity:.5},t),attentionUnitStyle:{":hover,&:focus":(n={},n[fa]={opacity:1},n)},calloutPopUp:{backgroundColor:r.bodyBackground,borderRadius:"3px",boxShadow:"0 8px 24px 0 rgba(0,0,0,0.1), 0 8px 16px 0 rgba(0,0,0,0.12)",padding:"6px 10px 8px 10px",pointerEvents:"none","> .ms-Callout-beakCurtain":{borderRadius:"2px"}},calloutPopUpTextStyle:{color:r.buttonText,fontFamily:Pa.b,fontSize:"12px"},calloutPopUpNumberStyle:{fontFamily:Pa.a,fontSize:"12px",fontWeight:"bold"},SkittleFocusStyle:{cursor:"pointer"},skittleCloseButton:{display:"inline-block",width:"24px",height:"24px"},skittleCritiqueCountWrapper:{alignItems:"center",alignSelf:"center",flexDirection:"row",display:"flex",justifyContent:"flex-start",height:"16px",margin:"0px 12px 7px 12px",width:"100%",fontFamily:Pa.b,fontSize:"10px",letterSpacing:"0px",color:r.buttonText},skittleCritiqueCount:{color:r.accentButtonText,fontFamily:Pa.c,fontWeight:"bold",margin:"0px 2px 0px 2px"},skittleShimmer:{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",transform:"translateX(-100%)",animationDuration:"2s",animationTimingFunction:"ease-in-out",animationDirection:"normal",animationIterationCount:"infinite",animationName:"shimmerAnimation",background:"linear-gradient(to right, rgb(243, 242, 241) 0%, rgb(237, 235, 233) 50%, rgb(243, 242, 241) 100%) 0px 0px / 90% 100% no-repeat rgb(243, 242, 241)"},skittleProgressBarWrapper:(o={backgroundColor:r.variantBorder,borderRadius:"4px",height:"6px",alignItems:"flex-start",display:"flex",flexDirection:"row",justifyContent:"flex-start",margin:"8px 12px 5px 12px",width:"100%",overflow:"hidden"},o[ni.l]={outline:"1px solid transparent",outlineOffset:"-1px"},o),skittleProgressBar:(i={background:r.accentButtonText,borderRadius:"4px",height:"6px",transition:"width 0.3s",minWidth:"6px"},i[ni.l]={outline:"3px solid transparent",outlineOffset:"-3px"},i),skittleSuggestionsContainer:{alignItems:"flex-start",display:"flex",flexDirection:"row",margin:"8px 12px 6px 12px",width:"100%",justifyContent:"space-between",cursor:"pointer"},skittleEditorScoreWrapper:{alignItems:"flex-start",display:"flex",flexDirection:"row",justifyContent:"flex-start",width:"36%"},skittleScoreWrapper:{alignItems:"flex-start",cursor:"pointer",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"25px"},skittleNumberContainer:{height:"25px",fontSize:"26px",letterSpacing:"-1px",lineHeight:"30px"},skittlePercentageContainer:{size:"14px"},editorIconStyles:{display:"flex",margin:"0px 0px 5px 57px"}}}function Qa(){var e={backgroundColor:"".concat(Object(Sa.b)().bodyBackground," !important")};return{beak:e,beakCurtain:e,calloutMain:e}}var Ya=n(2667),Ka=n(40),Xa=function(e){function t(t){var n=e.call(this,t)||this;return n.element=Object(C.createRef)(),n}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"styles",{get:function(){return Za()},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.styleProvider,n=e.barLength,o=e.ariaLabel,i=e.isSecondary,r=e.color,s=e.isVisible,a={backgroundColor:"".concat(r," !important")},l=this.element.current===this.props.orchestrator.currentHoveredOrFocused,c=n?{flexGrow:n,minWidth:"8px"}:{margin:"0"},u=s&&n>0,p=!u||void 0,d=this.styles;return T.a.createElement(T.a.Fragment,null,T.a.createElement("div",{"aria-hidden":p,"aria-label":Object(Ya.a)(o,Math.round(n)),"aria-readonly":!0,className:t.css(d.progressBarUnit,c,i?d.progressBarSecondaryUnit:[],d.attentionUnitStyle,l?a:[]),"data-is-focusable":u,onClick:this.props.orchestrator.handleElementHoveredOrFocused,onBlur:this.props.orchestrator.handleElementHoveredOrFocused,onFocus:this.props.orchestrator.handleElementHoveredOrFocused,onMouseOver:this.props.orchestrator.handleElementHoveredOrFocused,onMouseOut:this.props.orchestrator.handleElementHoveredOrFocused,ref:this.element,role:ua.a.TextBox},this.renderBarUnitPopUp()))},t.prototype.renderBarUnitPopUp=function(){var e=this.props,t=e.styleProvider,n=e.calloutContent,o=e.color,i=e.barLength,r=this.styles,s=t.css(r.calloutPopUp),a=t.css(r.calloutPopUpTextStyle),c=t.css(r.calloutPopUpNumberStyle,{color:o}),u=this.element.current===this.props.orchestrator.currentHoveredOrFocused,p=0===i||!u||this.props.cardSize===ia.Collapsed;return T.a.createElement(b.a,Object(l.__assign)({className:s,styles:Qa(),role:ua.a.Dialog,hidden:p,target:this.element.current,setInitialFocus:!0,directionalHint:v.a.bottomCenter,beakWidth:20},Va(236)),T.a.createElement("span",{className:a},n),T.a.createElement("span",{className:c}," ",Math.round(i),"%"))},t}(C.Component),Ja=Object(Ka.a)(Xa),$a=function(e,t,n,o,i){var r,s=t===(null===(r=o.currentHoveredOrFocused)||void 0===r?void 0:r.id),a=Za(),c=n.css(a.calloutPopUp),u=n.css(a.calloutPopUpTextStyle),p=!s||i===ia.Collapsed;return T.a.createElement(b.a,Object(l.__assign)({styles:Qa(),className:c,role:ua.a.Dialog,target:document.getElementById(t),setInitialFocus:!0,hidden:p,directionalHint:v.a.bottomCenter,beakWidth:20},Va(268)),T.a.createElement("div",{className:u},e))},el="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE3LjUgNUMxNy43MDgzIDUgMTcuOTAzNiA1LjAzOTA2IDE4LjA4NTkgNS4xMTcxOUMxOC4yNjgyIDUuMTk1MzEgMTguNDI3NyA1LjMwMjczIDE4LjU2NDUgNS40Mzk0NUMxOC43MDEyIDUuNTc2MTcgMTguODA4NiA1LjczNTY4IDE4Ljg4NjcgNS45MTc5N0MxOC45NjQ4IDYuMTAwMjYgMTkuMDAzOSA2LjI5NTU3IDE5LjAwMzkgNi41MDM5MUMxOS4wMDM5IDYuNzEyMjQgMTguOTY0OCA2LjkwNzU1IDE4Ljg4NjcgNy4wODk4NEMxOC44MDg2IDcuMjY1NjIgMTguNzAxMiA3LjQyMTg4IDE4LjU2NDUgNy41NTg1OUMxOC40Mjc3IDcuNjk1MzEgMTguMjY4MiA3LjgwMjczIDE4LjA4NTkgNy44ODA4NkMxNy45MDM2IDcuOTU4OTggMTcuNzA4MyA3Ljk5ODA1IDE3LjUgNy45OTgwNUgxMS42NjAyTDEwLjIxNDggMTBIMTQuNTAyQzE0LjcxMDMgMTAgMTQuOTA1NiAxMC4wMzkxIDE1LjA4NzkgMTAuMTE3MkMxNS4yNzAyIDEwLjE5NTMgMTUuNDI5NyAxMC4zMDI3IDE1LjU2NjQgMTAuNDM5NUMxNS42OTY2IDEwLjU3NjIgMTUuODAwOCAxMC43MzU3IDE1Ljg3ODkgMTAuOTE4QzE1Ljk1NyAxMS4xMDAzIDE1Ljk5NjEgMTEuMjk1NiAxNS45OTYxIDExLjUwMzlDMTUuOTk2MSAxMS43MTIyIDE1Ljk1NyAxMS45MDc2IDE1Ljg3ODkgMTIuMDg5OEMxNS44MDA4IDEyLjI2NTYgMTUuNjk2NiAxMi40MjE5IDE1LjU2NjQgMTIuNTU4NkMxNS40Mjk3IDEyLjY5NTMgMTUuMjcwMiAxMi44MDI3IDE1LjA4NzkgMTIuODgwOUMxNC45MDU2IDEyLjk1OSAxNC43MTAzIDEyLjk5OCAxNC41MDIgMTIuOTk4SDguMDI3MzRMNi41ODIwMyAxNUgxMS41MDM5QzExLjcwNTcgMTUgMTEuODk3OCAxNS4wMzkxIDEyLjA4MDEgMTUuMTE3MkMxMi4yNjI0IDE1LjE5NTMgMTIuNDIxOSAxNS4zMDI3IDEyLjU1ODYgMTUuNDM5NUMxMi42OTUzIDE1LjU3NjIgMTIuODAyNyAxNS43MzU3IDEyLjg4MDkgMTUuOTE4QzEyLjk1OSAxNi4xMDAzIDEyLjk5OCAxNi4yOTU2IDEyLjk5OCAxNi41MDM5QzEyLjk5OCAxNi43MTIyIDEyLjk1OSAxNi45MDc2IDEyLjg4MDkgMTcuMDg5OEMxMi44MDI3IDE3LjI2NTYgMTIuNjk1MyAxNy40MjE5IDEyLjU1ODYgMTcuNTU4NkMxMi40MjE5IDE3LjY5NTMgMTIuMjYyNCAxNy44MDI3IDEyLjA4MDEgMTcuODgwOUMxMS44OTc4IDE3Ljk1OSAxMS43MDU3IDE3Ljk5OCAxMS41MDM5IDE3Ljk5OEgzLjU3NDIyTDIuNTY4MzYgMTguNzIwN0MyLjUxNjI4IDE4Ljc1MzMgMi40NjA5NCAxOC43Njk1IDIuNDAyMzQgMTguNzY5NUMyLjM0Mzc1IDE4Ljc2OTUgMi4yOTE2NyAxOC43NTY1IDIuMjQ2MDkgMTguNzMwNUwxLjEyMzA1IDE5LjU2MDVDMS4xMDM1MiAxOS41NzM2IDEuMDcwOTYgMTkuNTgwMSAxLjAyNTM5IDE5LjU4MDFDMC44NTYxMiAxOS41ODAxIDAuNzEyODkxIDE5LjUzMTIgMC41OTU3MDMgMTkuNDMzNkMwLjQ3ODUxNiAxOS4zMzU5IDAuNDE5OTIyIDE5LjIyODUgMC40MTk5MjIgMTkuMTExM1YxOS4wODJMMC44MzAwNzggMTcuNzI0NkMwLjc0NTQ0MyAxNy42NTk1IDAuNzAzMTI1IDE3LjU3ODEgMC43MDMxMjUgMTcuNDgwNUMwLjcwMzEyNSAxNy40NjA5IDAuNzA5NjM1IDE3LjQzMTYgMC43MjI2NTYgMTcuMzkyNkwxLjY2OTkyIDE0LjIyODVMMTEuNjUwNCAwLjUzNzEwOUMxMS43MTU1IDAuNDkxNTM2IDExLjc2NDMgMC40NjIyNCAxMS43OTY5IDAuNDQ5MjE5QzExLjgyMjkgMC40MzYxOTggMTEuODY4NSAwLjQyOTY4OCAxMS45MzM2IDAuNDI5Njg4QzExLjk4NTcgMC40Mjk2ODggMTIuMDgzMyAwLjQ2MjI0IDEyLjIyNjYgMC41MjczNDRDMTIuMzY5OCAwLjU5MjQ0OCAxMi41NDIzIDAuNjgwMzM5IDEyLjc0NDEgMC43OTEwMTZDMTIuOTM5NSAwLjkwMTY5MyAxMy4xNTQzIDEuMDMxOSAxMy4zODg3IDEuMTgxNjRDMTMuNjE2NSAxLjMzMTM4IDEzLjg0NDQgMS40OTA4OSAxNC4wNzIzIDEuNjYwMTZDMTQuMjkzNiAxLjgyOTQzIDE0LjUwMiAyLjAwNTIxIDE0LjY5NzMgMi4xODc1QzE0Ljg5MjYgMi4zNjMyOCAxNS4wNTIxIDIuNTM5MDYgMTUuMTc1OCAyLjcxNDg0QzE1LjIwODMgMi43NjA0MiAxNS4yMzQ0IDIuODAyNzMgMTUuMjUzOSAyLjg0MThDMTUuMjczNCAyLjg4MDg2IDE1LjI4MzIgMi45MTY2NyAxNS4yODMyIDIuOTQ5MjJDMTUuMjgzMiAyLjk4ODI4IDE1LjI2NjkgMy4wMzA2IDE1LjIzNDQgMy4wNzYxN0wxMy44Mzc5IDVIMTcuNVpNMi41NzgxMiAxNC42ODc1TDEuODI2MTcgMTcuMTk3M0wyLjQwMjM0IDE3LjYwNzRMNC41NzAzMSAxNi4wNjQ1TDEzLjQyNzcgMy44NjcxOUwxMS40NzQ2IDIuNDgwNDdWMi40OTAyM0wyLjU3ODEyIDE0LjY4NzVaIiBmaWxsPSIjMTg1QUJEIi8+Cjwvc3ZnPgo=",tl="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE3LjUgNUMxNy43MDgzIDUgMTcuOTAzNiA1LjAzOTA2IDE4LjA4NTkgNS4xMTcxOUMxOC4yNjgyIDUuMTk1MzEgMTguNDI3NyA1LjMwMjczIDE4LjU2NDUgNS40Mzk0NUMxOC43MDEyIDUuNTc2MTcgMTguODA4NiA1LjczNTY4IDE4Ljg4NjcgNS45MTc5N0MxOC45NjQ4IDYuMTAwMjYgMTkuMDAzOSA2LjI5NTU3IDE5LjAwMzkgNi41MDM5MUMxOS4wMDM5IDYuNzEyMjQgMTguOTY0OCA2LjkwNzU1IDE4Ljg4NjcgNy4wODk4NEMxOC44MDg2IDcuMjY1NjIgMTguNzAxMiA3LjQyMTg4IDE4LjU2NDUgNy41NTg1OUMxOC40Mjc3IDcuNjk1MzEgMTguMjY4MiA3LjgwMjczIDE4LjA4NTkgNy44ODA4NkMxNy45MDM2IDcuOTU4OTggMTcuNzA4MyA3Ljk5ODA1IDE3LjUgNy45OTgwNUgxMS42NjAyTDEwLjIxNDggMTBIMTQuNTAyQzE0LjcxMDMgMTAgMTQuOTA1NiAxMC4wMzkxIDE1LjA4NzkgMTAuMTE3MkMxNS4yNzAyIDEwLjE5NTMgMTUuNDI5NyAxMC4zMDI3IDE1LjU2NjQgMTAuNDM5NUMxNS42OTY2IDEwLjU3NjIgMTUuODAwOCAxMC43MzU3IDE1Ljg3ODkgMTAuOTE4QzE1Ljk1NyAxMS4xMDAzIDE1Ljk5NjEgMTEuMjk1NiAxNS45OTYxIDExLjUwMzlDMTUuOTk2MSAxMS43MTIyIDE1Ljk1NyAxMS45MDc2IDE1Ljg3ODkgMTIuMDg5OEMxNS44MDA4IDEyLjI2NTYgMTUuNjk2NiAxMi40MjE5IDE1LjU2NjQgMTIuNTU4NkMxNS40Mjk3IDEyLjY5NTMgMTUuMjcwMiAxMi44MDI3IDE1LjA4NzkgMTIuODgwOUMxNC45MDU2IDEyLjk1OSAxNC43MTAzIDEyLjk5OCAxNC41MDIgMTIuOTk4SDguMDI3MzRMNi41ODIwMyAxNUgxMS41MDM5QzExLjcwNTcgMTUgMTEuODk3OCAxNS4wMzkxIDEyLjA4MDEgMTUuMTE3MkMxMi4yNjI0IDE1LjE5NTMgMTIuNDIxOSAxNS4zMDI3IDEyLjU1ODYgMTUuNDM5NUMxMi42OTUzIDE1LjU3NjIgMTIuODAyNyAxNS43MzU3IDEyLjg4MDkgMTUuOTE4QzEyLjk1OSAxNi4xMDAzIDEyLjk5OCAxNi4yOTU2IDEyLjk5OCAxNi41MDM5QzEyLjk5OCAxNi43MTIyIDEyLjk1OSAxNi45MDc2IDEyLjg4MDkgMTcuMDg5OEMxMi44MDI3IDE3LjI2NTYgMTIuNjk1MyAxNy40MjE5IDEyLjU1ODYgMTcuNTU4NkMxMi40MjE5IDE3LjY5NTMgMTIuMjYyNCAxNy44MDI3IDEyLjA4MDEgMTcuODgwOUMxMS44OTc4IDE3Ljk1OSAxMS43MDU3IDE3Ljk5OCAxMS41MDM5IDE3Ljk5OEgzLjU3NDIyTDIuNTY4MzYgMTguNzIwN0MyLjUxNjI4IDE4Ljc1MzMgMi40NjA5NCAxOC43Njk1IDIuNDAyMzQgMTguNzY5NUMyLjM0Mzc1IDE4Ljc2OTUgMi4yOTE2NyAxOC43NTY1IDIuMjQ2MDkgMTguNzMwNUwxLjEyMzA1IDE5LjU2MDVDMS4xMDM1MiAxOS41NzM2IDEuMDcwOTYgMTkuNTgwMSAxLjAyNTM5IDE5LjU4MDFDMC44NTYxMiAxOS41ODAxIDAuNzEyODkxIDE5LjUzMTIgMC41OTU3MDMgMTkuNDMzNkMwLjQ3ODUxNiAxOS4zMzU5IDAuNDE5OTIyIDE5LjIyODUgMC40MTk5MjIgMTkuMTExM1YxOS4wODJMMC44MzAwNzggMTcuNzI0NkMwLjc0NTQ0MyAxNy42NTk1IDAuNzAzMTI1IDE3LjU3ODEgMC43MDMxMjUgMTcuNDgwNUMwLjcwMzEyNSAxNy40NjA5IDAuNzA5NjM1IDE3LjQzMTYgMC43MjI2NTYgMTcuMzkyNkwxLjY2OTkyIDE0LjIyODVMMTEuNjUwNCAwLjUzNzEwOUMxMS43MTU1IDAuNDkxNTM2IDExLjc2NDMgMC40NjIyNCAxMS43OTY5IDAuNDQ5MjE5QzExLjgyMjkgMC40MzYxOTggMTEuODY4NSAwLjQyOTY4OCAxMS45MzM2IDAuNDI5Njg4QzExLjk4NTcgMC40Mjk2ODggMTIuMDgzMyAwLjQ2MjI0IDEyLjIyNjYgMC41MjczNDRDMTIuMzY5OCAwLjU5MjQ0OCAxMi41NDIzIDAuNjgwMzM5IDEyLjc0NDEgMC43OTEwMTZDMTIuOTM5NSAwLjkwMTY5MyAxMy4xNTQzIDEuMDMxOSAxMy4zODg3IDEuMTgxNjRDMTMuNjE2NSAxLjMzMTM4IDEzLjg0NDQgMS40OTA4OSAxNC4wNzIzIDEuNjYwMTZDMTQuMjkzNiAxLjgyOTQzIDE0LjUwMiAyLjAwNTIxIDE0LjY5NzMgMi4xODc1QzE0Ljg5MjYgMi4zNjMyOCAxNS4wNTIxIDIuNTM5MDYgMTUuMTc1OCAyLjcxNDg0QzE1LjIwODMgMi43NjA0MiAxNS4yMzQ0IDIuODAyNzMgMTUuMjUzOSAyLjg0MThDMTUuMjczNCAyLjg4MDg2IDE1LjI4MzIgMi45MTY2NyAxNS4yODMyIDIuOTQ5MjJDMTUuMjgzMiAyLjk4ODI4IDE1LjI2NjkgMy4wMzA2IDE1LjIzNDQgMy4wNzYxN0wxMy44Mzc5IDVIMTcuNVpNMi41NzgxMiAxNC42ODc1TDEuODI2MTcgMTcuMTk3M0wyLjQwMjM0IDE3LjYwNzRMNC41NzAzMSAxNi4wNjQ1TDEzLjQyNzcgMy44NjcxOUwxMS40NzQ2IDIuNDgwNDdWMi40OTAyM0wyLjU3ODEyIDE0LjY4NzVaIiBmaWxsPSIjODJBQkYxIi8+Cjwvc3ZnPgo=";var nl=n(2665),ol=n(734),il=function(e){var t=e.buttonStyle,n=e.dismissMenuProps,o=e.buttonIconStyle,i=n.styleProvider,r=n.orchestrator,s=n.cardSize,a=Object(sr.a)().getStringsFor("ProofingStrings")("SkittleCloseButton");return T.a.createElement(T.a.Fragment,null,$a(a,"SkittleCloseButton",i,r,s),T.a.createElement(ol.a,{iconProps:{iconName:nl.a.Cancel,style:o},id:"SkittleCloseButton",ariaLabel:a,className:t}))},rl=function(e){var t=e.buttonStyle,n=e.dismissMenuProps,o=e.buttonIconStyle,i=e.dismissMenuState,r=e.onDismiss,s=n.styleProvider,a=n.orchestrator,l=n.cardSize,c=n.onClosePermanent,u=Object(sr.a)().getStringsFor("ProofingStrings"),p=u("SkittleClosePermanentButton"),d=Object(Sa.b)(),g={menuItem:{color:d.buttonText,fontSize:"16px",width:"16px"},buttonIcon:o,callout:{backgroundColor:d.bodyBackground}},h=[{key:"1",ariaLabel:p,text:p,onClick:c,iconProps:{style:g.menuItem,iconName:nl.a.Blocked}}];return T.a.createElement(T.a.Fragment,null,$a(u("SkittleOptions"),"SkittleOptionsButton",s,a,l),T.a.createElement(ol.a,{iconProps:{iconName:nl.a.More,style:g.buttonIcon},id:"SkittleOptionsButton",ariaLabel:u("SkittleOptions"),className:t}),T.a.createElement(Bs.a,{items:h,target:"#SkittleOptionsButton",directionalHint:v.a.bottomRightEdge,hidden:i.isMenuHidden,onDismiss:r,calloutProps:{styles:{calloutMain:g.callout}},isBeakVisible:!1,theme:Object(Sa.c)()}))},sl=function(e){var t=Object(C.useState)(!0),n={isMenuHidden:t[0],setIsMenuHidden:t[1]},o=e.orchestrator,i=o.isHoveredOrFocused,r=o.forceFocus,s=o.reset;Object(C.useEffect)((function(){var e;return null===(e=document.getElementById("SkittleOptionsButton"))||void 0===e?void 0:e.addEventListener("click",(function(){r(!0),n.setIsMenuHidden(!1),s(),Object(za.a)().logEvent(525169620,"OptionsClicked",Ua.a.EditorScore,Wa.a.Info)}))}),[]);var a=Object(C.useCallback)((function(){r(!1),s(),n.setIsMenuHidden(!0)}),[]),c=!i&&n.isMenuHidden?{display:"none"}:[],u=Object(ni.db)(Za().skittleCloseButton,c),p={color:Object(Sa.b)().bodySubtext,fontSize:"16px",width:"28px"},d={buttonStyle:u,dismissMenuProps:e,buttonIconStyle:p,dismissMenuState:n,onDismiss:a},g={buttonStyle:u,dismissMenuProps:e,buttonIconStyle:p};return T.a.createElement("div",null,T.a.createElement(rl,Object(l.__assign)({},d)),T.a.createElement(il,Object(l.__assign)({},g)))},al=function(e){function t(t){var n=e.call(this,t)||this;return n._maxCritiqueCountNumber=99,n._animationTimeout=500,n._editorScoreRef=Object(C.createRef)(),n._str=Object(sr.a)().getStringsFor("ProofingStrings"),n.slideUpKeyframes=n.props.styleProvider.keyframes({from:{marginTop:"0px"},to:{marginTop:"-44px"}}),n.slideUpShortKeyframes=n.props.styleProvider.keyframes({from:{marginTop:"0px"},to:{marginTop:"-20px"}}),n.skittleSlideUpKeyframes=n.props.styleProvider.keyframes({from:{marginTop:"0px"},to:{marginTop:"-25px"}}),n._slideUpStyles={slideUp:{animationDuration:"300ms",animationName:n.slideUpKeyframes,animationTimingFunction:"ease-out",marginTop:"-44px"},slideUpShort:{animationDuration:"300ms",animationName:n.slideUpShortKeyframes,animationTimingFunction:"ease-out",marginTop:"-20px"},slideUpSkittle:{animationDuration:"300ms",animationName:n.skittleSlideUpKeyframes,animationTimingFunction:"ease-out",marginTop:"-25px"}},n.renderSkittleBar=function(){var e=n.props,t=e.documentScore,o=e.styleProvider,i=e.isThinking,r={width:"".concat(t,"%")},s=Object(Sa.b)(),a=Za(),l=i?{backgroundSize:"200% 100%",background:"linear-gradient(97.75deg, ".concat(s.accentButtonBackground," 5.99%, ").concat(s.accentButtonText," 48.17%, ").concat(s.accentButtonBackground," 94.01%)"),animationDuration:"2s",animationTimingFunction:"ease",animationIterationCount:"infinite",animationName:o.keyframes({"0%":{backgroundPosition:"200% 100%"},"100%":{backgroundPosition:"0% 100%"}})}:[];return T.a.createElement("div",{className:o.css(a.skittleProgressBarWrapper)},T.a.createElement("div",{className:o.css(a.skittleProgressBar,l,r)}))},n.renderSkittleFooter=function(){var e=n.props,t=e.styleProvider,o=e.critiquesCount,i=o>1?n._str("SkittleCritiquesFooterPlural"):n._str("SkittleCritiquesFooterSingular"),r=o>n._maxCritiqueCountNumber?n._maxCritiqueCountNumber+"+":o,s=Za();return T.a.createElement("div",{className:t.css(s.skittleCritiqueCountWrapper)},o?T.a.createElement(T.a.Fragment,null,Object(Ga.a)(i,"",{item:r,className:t.css(s.skittleCritiqueCount)})):T.a.createElement(T.a.Fragment,null,n._str("SkittleCritiquesAllGood")))},n.renderSkittleSuppressionMenu=function(){var e=n.props,t=e.orchestrator,o=e.styleProvider,i=e.cardSize;return T.a.createElement(T.a.Fragment,null,T.a.createElement(sl,{orchestrator:t,onClosePermanent:n.onClosePermanent,onClose:n.onCloseInSession,styleProvider:o,cardSize:i}))},n.renderProgressBarUnits=function(){var e=n.props,t=e.documentScore,o=e.isVisible,i=e.cardSize,r=e.styleProvider,s=e.orchestrator,a=e.progressBarData,c=a.spellingPercent,u=a.grammarPercent,p=a.refinementsPercent,d={isVisible:o,cardSize:i,styleProvider:r,orchestrator:s},g=Object(Sa.c)();return T.a.createElement(T.a.Fragment,null,T.a.createElement(Ja,Object(l.__assign)({},d,{barLength:t,ariaLabel:n._str("CompletedProgressAriaLabel"),calloutContent:n._str("CompletedProgressCalloutContent"),color:g.semanticColors.accentButtonText,isSecondary:!1})),T.a.createElement(Ja,Object(l.__assign)({},d,{barLength:c,ariaLabel:n._str("SpellingProgressAriaLabel"),calloutContent:n._str("SpellingProgressCalloutContent"),color:"#ef0000",isSecondary:!0})),T.a.createElement(Ja,Object(l.__assign)({},d,{barLength:u,ariaLabel:n._str("GrammarProgressAriaLabel"),calloutContent:n._str("GrammarProgressCalloutContent"),color:"#3368ff",isSecondary:!0})),T.a.createElement(Ja,Object(l.__assign)({},d,{barLength:p,ariaLabel:n._str("RefinementsProgressAriaLabel"),calloutContent:n._str("RefinementsProgressCalloutContent"),color:"#7160eb",isSecondary:!0})))},n.onClickButtonHandler=function(e){var t,o;n.props.orchestrator.handleElementHoveredOrFocused(e),null===(o=(t=n.props).onClick)||void 0===o||o.call(t)},n.onCloseIconButtonHandler=function(e){n.props.orchestrator.handleElementHoveredOrFocused(e),n.onCloseInSession()},n.onOptionsIconButtonHandler=function(e){n.props.orchestrator.handleElementHoveredOrFocused(e)},n.onCloseInSession=function(){return n.onClosed(!1)},n.onClosePermanent=function(){return n.onClosed(!0)},n.onClosed=function(e){var t,o,i,r;Object(aa.a)().logCategoryRejectedAcrossLevels(la.a.Skittle),Object(za.a)().logEvent(537518217,"SkittleDismissed",Ua.a.EditorScore,Wa.a.Info,{permanent:e}),e?null===(o=(t=n.props).onClosePermanently)||void 0===o||o.call(t):null===(r=(i=n.props).onClose)||void 0===r||r.call(i)},n.state={isAnimating:!1,oldDocumentScore:t.documentScore},n}return Object(l.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.orchestrator.reset();var e=document.getElementById("SkittleCloseButton");this.setupEventListeners(!0,e,this.onCloseIconButtonHandler);var t=document.getElementById("SkittleOptionsButton");this.setupEventListeners(!0,t,this.onOptionsIconButtonHandler);var n=this._editorScoreRef.current;this.setupEventListeners(!0,n,this.onClickButtonHandler)},t.prototype.componentWillUnmount=function(){var e=document.getElementById("SkittleCloseButton");this.setupEventListeners(!1,e,this.onCloseIconButtonHandler);var t=document.getElementById("SkittleOptionsButton");this.setupEventListeners(!0,t,this.onOptionsIconButtonHandler);var n=this._editorScoreRef.current;this.setupEventListeners(!1,n,this.onClickButtonHandler)},t.prototype.setupEventListeners=function(e,t,n){if(t){var o=this.props.orchestrator,i=(e?t.addEventListener:t.removeEventListener).bind(t);i("click",n),i("blur",o.handleElementHoveredOrFocused),i("focus",o.handleElementHoveredOrFocused),i("mouseover",o.handleElementHoveredOrFocused),i("mouseleave",o.handleElementHoveredOrFocused)}},t.prototype.componentDidUpdate=function(e){var t=this,n=this.props,o=n.documentScore,i=n.cardSize;o===this.state.oldDocumentScore||this.state.isAnimating||i!==e.cardSize||(window.requestAnimationFrame((function(){t.setState({isAnimating:!0})})),window.setTimeout((function(){window.requestAnimationFrame((function(){t.setState({isAnimating:!1,oldDocumentScore:o})}))}),this._animationTimeout))},t.prototype.getSkittleAdditionalButtons=function(e){return e?this.renderSkittleSuppressionMenu():T.a.createElement(T.a.Fragment,null)},t.prototype.render=function(){var e=this.props,t=e.cardSize,n=e.styleProvider,o=e.isSkittle,i=Za(),r=t!==ia.FullSize,s=r?i.progressBarWrapperShort:i.progressBarWrapper,a=r?i.suggestionsContainerShort:i.suggestionsContainer,l=r?i.progressLabelShort:i.progressLabel,c=r?i.editorScoreWrapperShort:i.editorScoreWrapper,u=o?i.skittleSuggestionsContainer:a,p=o?i.skittleEditorScoreWrapper:c,d=o?i.SkittleFocusStyle:i.focusStyle;return T.a.createElement(T.a.Fragment,null,T.a.createElement("div",{id:"ProgressBar",className:n.css(i.flexContainer,d),role:ua.a.Button},T.a.createElement("div",{className:n.css(u)},!o&&T.a.createElement("div",{"aria-hidden":!0,className:n.css(l)},this._str("ProgressCardTitle")),T.a.createElement("div",{className:n.css(p)},this.renderEditorScore()),o&&this.renderEditorIcon(),this.getSkittleAdditionalButtons(!!o)),!o&&T.a.createElement("div",{className:n.css(s)},this.renderProgressBarUnits()),o&&this.renderSkittleBar(),o&&this.renderSkittleFooter()))},t.prototype.renderEditorScore=function(){var e=this.props,t=e.isVisible,n=e.cardSize,o=e.styleProvider,i=e.documentScore,r=e.orchestrator,s=e.isSkittle,a=this.state.isAnimating,l=!t||void 0,c=n!==ia.FullSize,u=Za(),p=c?u.progressNumberContainerShort:u.progressNumberContainer,d=c?u.percentageContainerShort:u.percentageContainer,g=c?this._slideUpStyles.slideUpShort:this._slideUpStyles.slideUp,h=a?g:[],f=c?u.focusableScoreWrapperShort:u.focusableScoreWrapper,m=s?u.skittleScoreWrapper:[],y=s?u.skittleNumberContainer:[],b=s?u.skittlePercentageContainer:[],v=s&&a?this._slideUpStyles.slideUpSkittle:[];return T.a.createElement(T.a.Fragment,null,T.a.createElement("div",{id:"ProgressCardScore","aria-hidden":l,"aria-label":Object(Ya.a)(this._str("ReviewProgressAriaLabel"),i)+this._str("EditorScoreTooltip"),"data-is-focusable":t,className:o.css(f,m),ref:this._editorScoreRef,role:ua.a.Note},T.a.createElement("div",{"aria-hidden":!0,className:o.css(p,y)},T.a.createElement("div",{className:o.css(u.progressNumber,h,v)},this.state.oldDocumentScore),T.a.createElement("div",{className:o.css(u.progressNumber)},i)),T.a.createElement("div",{"aria-hidden":!0,className:o.css(d,b)},"%")),$a(this._str("EditorScoreTooltip"),"ProgressCardScore",o,r,n))},t.prototype.renderEditorIcon=function(){var e=this.props,t=e.orchestrator,n=e.styleProvider,o=t.isHoveredOrFocused?{display:"none"}:[];return T.a.createElement("div",{className:n.css(Za().editorIconStyles,o),"aria-hidden":!0},T.a.createElement("img",{src:Object(Sa.d)()?tl:el}))},t}(C.Component),ll=Object(Ka.a)(al),cl=function(e){function t(t){var n=e.call(this,t)||this;return n._progressCardRef=Object(C.createRef)(),n._str=Object(sr.a)().getStringsFor("ProofingStrings"),n.focusedByMouse=!1,n.styleProvider=new ca,n.onClickHandler=function(e){var t=n.props,o=t.orchestrator,i=t.onClick;t.isSkittle&&(o.handleElementHoveredOrFocused(e),null==i||i())},n.onRightClickHandler=function(e){n.props.isSkittle&&(e.stopPropagation(),e.preventDefault())},n.renderProgressCard=function(){var e=Fa(),t=n.props,o=t.orchestrator,i=t.isSkittle,r=t.onClose,s=t.onClick,a=t.onClosePermanently,l=n.props.store,c=l.documentScore,u=l.isIncipient,p=l.critiquesCount,d=l.progressBarData,g=l.skittleArgs.isThinking,h=n.props.sizeStore.cardSize;return T.a.createElement("div",{"aria-hidden":!!u||void 0,className:n.styleProvider.css(e.progressCardWrapper),id:"progress-container"},T.a.createElement(ll,{documentScore:c,cardSize:h,progressBarData:d,critiquesCount:p,orchestrator:o,styleProvider:n.styleProvider,isSkittle:i,isThinking:g,isVisible:!u,onClose:r,onClick:s,onClosePermanently:a}))},n.handleMouseEvent=function(e){var t=n.props,o=t.orchestrator,i=t.isSkittle,r=t.onMouseEnter,s=Object(aa.a)(),a=i?la.a.Skittle:la.a.EditorScore;switch(n.focusedByMouse=!1,e.type){case"mouseenter":r&&r(),s.logCategoryTriedAcrossLevels(a);break;case"mouseover":s.logCategoryTriedAcrossLevels(a);break;case"mousedown":n.focusedByMouse=!0,s.logCategoryKeptAcrossLevels(a)}i&&o.handleElementHoveredOrFocused(e)},n.scrollToTop=function(e){var t=n.props,o=t.orchestrator,i=t.isSkittle;n.focusedByMouse||i||window.scrollTo(0,0),i&&o.handleElementHoveredOrFocused(e)},n.visibilityChanged=function(e){var t=n.props.isSkittle;if(e.visible){var o=Object(aa.a)(),i=t?la.a.Skittle:la.a.EditorScore;o.logCategorySeenAcrossLevels(i),e.stopMonitoring=!0}},n.handleWindowResize=function(){n.props.sizeStore.viewportHeight=window.innerHeight},n}return Object(l.__extends)(t,e),t.prototype.componentDidUpdate=function(){this.props.sizeStore.cardSize===ia.Collapsed&&this.props.orchestrator.reset()},t.prototype.componentDidMount=function(){var e=this.props.isSkittle;this.setupEventListeners(!0),window.addEventListener("resize",this.handleWindowResize);var t=Object(aa.a)(),n=e?la.a.Skittle:la.a.EditorScore;t.logCategoryOfferedAcrossLevels(n)},t.prototype.componentWillUnmount=function(){this.setupEventListeners(!1),window.removeEventListener("resize",this.handleWindowResize)},t.prototype.setupEventListeners=function(e){var t=this._progressCardRef.current;if(t){var n=(e?t.addEventListener:t.removeEventListener).bind(t);n("mousedown",this.handleMouseEvent),n("mouseover",this.handleMouseEvent),n("mouseenter",this.handleMouseEvent),n("mouseleave",this.handleMouseEvent),n("mouseup",this.handleMouseEvent),n("focus",this.scrollToTop),n("blur",this.props.orchestrator.handleElementHoveredOrFocused),n("click",this.onClickHandler),n("contextmenu",this.onRightClickHandler)}},t.prototype.render=function(){var e=Fa(),t=this.props,n=t.orchestrator,o=t.isSkittle,i=this.props.store.isIncipient,r=this.props.sizeStore.cardSize,s=r===ia.Disabled,a=r===ia.Collapsed,l=r===ia.Short,c=ua.a.TextBox,u=o?ua.a.Button:ua.a.Group,p=i?c:u,d=this.styleProvider.css(e.mainWrapper,o?e.skittleMainWrapper:[],a||s?e.mainWrapperCollapsed:[],l?e.mainWrapperShort:[],i?[]:e.mainWrapperProgress);return T.a.createElement("div",{className:this.styleProvider.css(s?e.disabledOffset:[])},T.a.createElement(La,{ariaLabel:this._str("ProgressCardAriaLabel"),headerId:"progressCard-header",hasHeader:!1,styleProvider:this.styleProvider,shouldRenderAsPremium:!1,style:e.pyroCardStyles,visibilityChanged:this.visibilityChanged,visibilityChangedCallbackMode:"onchanged"},T.a.createElement("div",{id:"ProgressCardWrapper",className:d,role:p,"data-is-focusable":!0,"aria-label":this.getAriaLabel(),ref:this._progressCardRef},this.renderProgressCard(),!o&&this.renderIncipientDocumentLabel(),o&&$a(this._str("SkittleCardCallot"),"ProgressCardWrapper",this.styleProvider,n,r))))},t.prototype.getAriaLabel=function(){var e=this.props.store,t=e.documentScore,n=e.isIncipient,o=this.props.isSkittle?this._str("SkittleCardCallot"):"";return n?this._str("IncipientDocumentAriaLabel"):Object(Ya.a)(this._str("ReviewProgressAriaLabel"),t)+o},t.prototype.renderIncipientDocumentLabel=function(){var e=this.styleProvider,t=this.props.store.isIncipient;return T.a.createElement(Ha,{isVisible:t,styleProvider:e})},t}(C.Component),ul=Object(Ka.a)(cl),pl={position:"fixed",zIndex:"2",right:"19px",marginTop:"19px",width:"148px",transition:"visibility 0s, opacity 0.3s linear 0.3s",transformOrigin:"top right"},dl="visible",gl="hidden",hl="1",fl="0",ml=35,yl=function(){function e(e){var t,n=this;this._ulsLogger=e,this._skittleContainer=null,this._zoomContainerElement=null,this._contentContainerElement=null,this._scrollParentContainerElement=null,this.shouldSkittleRender=!1,this.canSkittleRender=void 0,this.isSkittleRendered=!1,this._orchestrator=new ra,this._documentScoreHandler=Object(na.p)({documentScore:0,critiquesCount:0}),this._store=(t=this._documentScoreHandler,new oa(t)),this._sizeStore=new sa(this._store),this.reposition=function(){n._skittleContainer&&n._zoomContainerElement&&(n._skittleContainer.style.transform=n._zoomContainerElement.style.transform,n.calculateCanSkittleRender())},this.calculateCanSkittleRender=function(){if(n._contentContainerElement&&n._skittleContainer&&n._scrollParentContainerElement){var e=n._contentContainerElement.getBoundingClientRect().width,t=n._scrollParentContainerElement.getBoundingClientRect().width,o=n._skittleContainer.getBoundingClientRect().width,i=(t-e)/2-ml>o;i!==n.canSkittleRender&&(n.canSkittleRender=i,n.shouldSkittleRender&&(n.canSkittleRender?n.tryShow():n.unconditionallyHide()))}}}return e.prototype.render=function(t){var n,o,i=this;if(t)if(this._skittleContainer)this._ulsLogger.sendTraceTag(529073374,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle already rendered!");else{this._zoomContainerElement=document.getElementsByClassName("PageContentOrigin").item(0),this._contentContainerElement=null!==(n=document.getElementsByClassName("Page").item(0))&&void 0!==n?n:document.getElementsByClassName("OutlineContainerDisplayWrapper").item(0),this._scrollParentContainerElement=document.getElementById("WACViewPanelContainer"),this._skittleContainer=document.createElement("div"),this._skittleContainer.id=e.skittleContainerId,this._skittleContainer.className=Object(ni.db)(pl),this._documentScoreHandler.documentScore=t.documentScore,this._documentScoreHandler.critiquesCount=t.critiqueNumber,this._store.skittleArgs.isThinking=t.isThinking;var r={store:this._store,orchestrator:this._orchestrator,sizeStore:this._sizeStore,isSkittle:!0,onClick:function(){t.onClick(),i._orchestrator.reset()},onClose:t.onClose,onClosePermanently:t.onClosePermanently,onMouseEnter:t.onMouseEnter};null===(o=this._scrollParentContainerElement)||void 0===o||o.appendChild(this._skittleContainer),Yo.render(C.createElement(ul,Object(l.__assign)({},r)),this._skittleContainer),this.show(),this._ulsLogger.sendTraceTag(529073375,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle rendered!")}else this._ulsLogger.sendTraceTag(529073373,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Bad Skittle arguments!")},e.prototype.update=function(e){this._documentScoreHandler.documentScore=e.documentScore,this._documentScoreHandler.critiquesCount=e.critiqueNumber,this._store.skittleArgs.isThinking=e.isThinking,this._ulsLogger.sendTraceTag(529073376,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle updated!")},e.prototype.dispose=function(){this._skittleContainer&&this._scrollParentContainerElement?(this._scrollParentContainerElement.removeChild(this._skittleContainer),Yo.unmountComponentAtNode(this._skittleContainer),this.removeEventListeners(),this._scrollParentContainerElement=this._zoomContainerElement=this._contentContainerElement=this._skittleContainer=null,this._ulsLogger.sendTraceTag(529073378,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle disposed!")):this._ulsLogger.sendTraceTag(529073377,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle already disposed!")},e.prototype.show=function(){this.shouldSkittleRender=!0,this.addEventListeners(),this.calculateCanSkittleRender(),this.tryShow()},e.prototype.tryShow=function(){this._skittleContainer&&this.canSkittleRender&&!this.isSkittleRendered&&(this._skittleContainer.style.visibility=dl,this._skittleContainer.style.opacity=hl,this._skittleContainer.style.overflow=dl,this.isSkittleRendered=!0,this._ulsLogger.sendTraceTag(529073379,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle shown!"))},e.prototype.hide=function(){this.shouldSkittleRender=!1,this.removeEventListeners(),this.unconditionallyHide()},e.prototype.unconditionallyHide=function(){this._skittleContainer&&(this._skittleContainer.style.visibility=gl,this._skittleContainer.style.opacity=fl,this._skittleContainer.style.overflow=gl,this.isSkittleRendered=!1,this._ulsLogger.sendTraceTag(529073408,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Skittle hidden!"))},e.prototype.addEventListeners=function(){window.addEventListener("resize",this.calculateCanSkittleRender)},e.prototype.removeEventListeners=function(){window.removeEventListener("resize",this.calculateCanSkittleRender)},e.skittleContainerId="skittleContainer",e}();function bl(e){return{skittleContainerStyles:{position:"fixed",right:"19px",marginTop:e?"2%":"",paddingTop:e?"84px":"15px",width:"148px",transition:"visibility 0s, opacity 0.3s linear 0.3s",transformOrigin:"top right"},transitionNone:"none",visible:"visible",hidden:"hidden",opacityVisible:"1",opacityHidden:"0",hiddenWidth:"0px",skittleWidthNumber:148,skittleWidth:"148px",skittlePaddingFromCanvas:35}}var vl,Sl=n(966),xl=n(1174),Cl=function(){this.css=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return xl.s.apply(void 0,e)},this.keyframes=xl.q};!function(e){e.Add="Add",e.Blocked="Blocked12",e.ChevronUp="ChevronUp",e.ChevronDown="ChevronDown",e.ChevronRight="ChevronRight",e.Delete="Delete",e.Edit="Edit",e.Feedback="Feedback",e.Lightbulb="Lightbulb",e.More="More",e.Back="Back",e.Cancel="Cancel",e.Diamond="Diamond",e.Undo="Undo",e.Save="Save",e.ReadingMode="ReadingMode",e.Dictionary="Dictionary",e.Clock="Clock",e.Info="Info",e.CircleFill="CircleFill",e.StatusCircleCheckmark="StatusCircleCheckmark",e.Sync="Sync"}(vl||(vl={}));var Tl,wl=new Map,Ol=void 0,kl=function(){return{viewportHeight:window.innerHeight||document.documentElement.clientHeight||0,viewportWidth:window.innerWidth||document.documentElement.clientWidth||0,viewportVisible:"visible"===document.visibilityState}},Al=function(e,t,n){var o={stopMonitoring:!1,visible:n};e(o),o.stopMonitoring&&_l(t)},Il=function(){var e=kl(),t=e.viewportHeight,n=e.viewportWidth;e.viewportVisible&&n&&t||wl.forEach((function(e,t){return Al(e,t,!1)})),wl.forEach((function(e,o){var i=o.getBoundingClientRect(),r=i.left,s=i.top,a=i.right,l=i.bottom,c=i.width,u=i.height;0===c&&0===u?Al(e,o,!1):Al(e,o,r>=0&&s>=0&&a<=n&&l<=t)}))},jl=function(e,t){wl.has(e)||(wl.set(e,t),Al(t,e,function(e){var t=kl(),n=t.viewportHeight,o=t.viewportWidth;if(!t.viewportVisible||!o||!n)return!1;var i=e.getBoundingClientRect(),r=i.left,s=i.top,a=i.right,l=i.bottom,c=i.width,u=i.height;return(0!==c||0!==u)&&(r>=0&&s>=0&&a<=o&&l<=n)}(e)),void 0===Ol&&(Ol=window.setInterval(Il,999)))},_l=function(e){wl.delete(e),Ol&&0===wl.size&&(window.clearInterval(Ol),Ol=void 0)},Ml=function(e){var t=C.useState(null),n=t[0],o=t[1];return C.useEffect((function(){var t=e.visibilityChanged,o=e.visibilityChangedCallbackMode;return n&&t&&jl(n,function(e,t){void 0===t&&(t="polling");var n=void 0;return function(o){"polling"!==t&&o.visible===n||(n=o.visible,e(o))}}(t,o)),function(){n&&_l(n)}}),[n]),e.children?C.createElement("div",{ref:o},e.children):C.createElement(C.Fragment,null)},Dl=n(2679),El=(new(function(){function e(){}return Object.defineProperty(e.prototype,"isHighContrastActive",{get:function(){return window.matchMedia("(-ms-high-contrast: active), (forced-colors: active)").matches},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHighContrastBlack",{get:function(){return window.matchMedia("(-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)").matches},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHighContrastWhite",{get:function(){return window.matchMedia("(-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)").matches},enumerable:!1,configurable:!0}),e}()),n(970));!function(e){e.arrowDown="ArrowDown",e.arrowLeft="ArrowLeft",e.arrowRight="ArrowRight",e.arrowUp="ArrowUp",e.backspace="Backspace",e.control="Control",e.enter="Enter",e.escape="Escape",e.space=" ",e.tab="Tab",e.home="Home",e.end="End",e.j="j",e.r="r",e.t="t",e.J="J",e.R="R",e.T="T"}(Tl||(Tl={}));var Rl,Bl=function(){function e(){}return e.createEvaluator=function(t,n,o,i,r){return function(s){return e.isKey(s,t,n,o,i,r)}},e.isKey=function(t,n,o,i,r,s){if(void 0!==o&&t.altKey!==o||void 0!==i&&t.ctrlKey!==i||void 0!==r&&t.metaKey!==r||void 0!==s&&t.shiftKey!==s)return!1;if(Array.isArray(n))return n.some((function(n){return e.isKey(t,n,o,i,r,s)}));if(t.key===n)return!0;if(n in El.a){var a=El.a[n];return t.which===a||t.keyCode===a}return!1},e.isEnterKey=function(t){var n=Tl.enter;return e.isKey(t,n)},e.isEnterOrSpaceKey=function(t){var n=Tl.enter,o=Tl.space;return e.isKey(t,[n,o])},e.isEscapeKey=function(t){var n=Tl.escape;return e.isKey(t,n)},e.focusIfEscapeKey=function(t){e.isKey(t,Tl.escape)&&(t.currentTarget.focus(),t.stopPropagation())},e.isSpaceKey=function(t){var n=Tl.space;return e.isKey(t,n)},e}(),Nl=n(2805),Ll=Object(Nl.a)({semanticColors:{cardShadow:"0px 1px 2.5px 0px rgba(0, 0, 0, 0.12),0px 2px 4px 0px rgba(0, 0, 0, 0.08)",cardShadowHovered:"0 8px 24px 0 rgba(0,0,0,0.1), 0 8px 16px 0 rgba(0,0,0,0.12)",buttonBackground:"#ffffff",buttonBackgroundHovered:"#f5f5f5",buttonBackgroundPressed:"#e0e0e0",buttonBorder:"#e1dfdd",bodyStandoutBackground:"#c4c4c4",buttonText:"#242424",buttonTextDisabled:"#616161",primaryButtonText:"#ffffff",disabledText:"#bdbdbd",disabledBodyText:"#605e5c",errorText:"#a80000",accentButtonText:"#185abd",accentButtonBackground:"#d2e0f4",bodyDivider:"#c7e0f4",focusBorder:"#242424",variantBorder:"#bdbdbd",infoIcon:"#185abd",successBackground:"#d2e0f4",successIcon:"#185ABD",menuDivider:"#e0e0e0",warningBackground:"#d4edd4",warningIcon:"#094609",errorBackground:"#fde5e5",errorIcon:"#3f1011",buttonTextChecked:"#185ABD",buttonBackgroundChecked:"#d2e0f4",buttonTextCheckedHovered:"#185ABD",buttonBackgroundCheckedHovered:"#d2e0f4",actionLink:"#185ABD",actionLinkHovered:"#185ABD",linkHovered:"#185ABD",bodySubtext:"#616161",bodyBackground:"#f5f5f5",cardStandoutBackground:"#ebf3fc"},palette:{themeDarker:"#185abd",themeDark:"#185abd",themeDarkAlt:"#185abd",themePrimary:"#185abd",themeSecondary:"#185abd",themeTertiary:"#185abd",themeLight:"#d2e0f4",themeLighter:"#d2e0f4",black:"#242424",neutralDark:"#242424",neutralPrimary:"#242424",neutralPrimaryAlt:"#242424",neutralSecondary:"#616161",neutralSecondaryAlt:"#616161",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#bdbdbd",neutralQuaternary:"#e0e0e0",neutralQuaternaryAlt:"#e0e0e0",neutralLight:"#e0e0e0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#f5f5f5",white:"#ffffff"}}),Pl=Object(Nl.a)({semanticColors:{cardShadow:"none",cardShadowHovered:"none",buttonBackground:"#292929",buttonBackgroundHovered:"#3d3d3d",buttonBackgroundPressed:"#1f1f1f",buttonBorder:"#3d3d3d",bodyStandoutBackground:"default",buttonText:"#ffffff",buttonTextDisabled:"#858585",primaryButtonText:"#ffffff",disabledText:"#858585",disabledBodyText:"#d6d6d6",errorText:"#f1707b",accentButtonText:"#82ABF1",accentButtonBackground:"#0c2145",bodyDivider:"#598fec",focusBorder:"#ffffff",variantBorder:"#5c5c5c",infoIcon:"#82ABF1",successBackground:"#071225",successIcon:"#82ABF1",menuDivider:"#666666",warningBackground:"#094609",warningIcon:"#d4edd4",errorBackground:"#3f1011",errorIcon:"#fde5e5",buttonTextChecked:"#82ABF1",buttonBackgroundChecked:"#0c2145",buttonTextCheckedHovered:"#82ABF1",buttonBackgroundCheckedHovered:"#0c2145",actionLink:"#82ABF1",actionLinkHovered:"#82ABF1",linkHovered:"#82ABF1",bodySubtext:"#adadad",bodyBackground:"#141414",cardStandoutBackground:"#3d3d3d"},palette:{themeDarker:"#82abf1",themeDark:"#82abf1",themeDarkAlt:"#82abf1",themePrimary:"#82abf1",themeSecondary:"#82abf1",themeTertiary:"#82abf1",themeLight:"#0c2145",themeLighter:"#071225",black:"#ffffff",neutralDark:"#ffffff",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#ffffff",neutralSecondary:"#adadad",neutralSecondaryAlt:"#adadad",neutralTertiary:"#858585",neutralTertiaryAlt:"#858585",neutralQuaternary:"#666666",neutralQuaternaryAlt:"#5c5c5c",neutralLight:"#1f1f1f",neutralLighter:"#3d3d3d",neutralLighterAlt:"#292929",white:"#141414"},isInverted:!0});!function(e){e.Light="Light",e.Dark="Dark"}(Rl||(Rl={}));var Fl=Object(na.p)({theme:Ll});function Hl(){return Fl.theme.semanticColors}Object(na.g)((function(e){Fl.theme=e===Rl.Dark?Pl:Ll})),Object(na.g)((function(e){Fl.theme=e}));var zl=function(e){Bl.isKey(e,Tl.escape)&&(e.currentTarget.focus(),e.stopPropagation())};var Ul=function(e){var t=e.shouldRenderAsPremium,n=e.styleProvider,o=!e.hasHeader&&!e.ariaLabel,i="IdeasCardHeader_".concat(e.id),r=function(){var e,t=Hl();return{boxShadow:t.cardShadow,backgroundColor:t.buttonBackground,emptyCells:"hide","&:not(:empty)":(e={},e["@media screen and (-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)"]={border:"1px solid #000"},e["@media screen and (-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)"]={border:"1px solid #fff"},e)}}(),s=n.css(function(){var e,t=Hl();return{borderRadius:"4px",boxShadow:t.cardShadow,backgroundColor:t.buttonBackground,msHighContrastAdjust:"auto",position:"relative",emptyCells:"hide","&:not(:empty)":(e={},e["@media screen and (-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)"]={border:"1px solid #000"},e["@media screen and (-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)"]={border:"1px solid #fff"},e)}}(),t?r:[]);return o?C.createElement("div",{className:s,"data-card":1,"data-automation-id":i,"data-ignore-user-engagement":e.ignoreUserEngagement},e.children):C.createElement(Dl.a,{className:s,"data-card":1,"data-automation-id":i,"data-ignore-user-engagement":e.ignoreUserEngagement,isCircularNavigation:!0,onKeyDown:zl,direction:3},e.children)},Wl=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._styles={header:{marginBottom:"12px",padding:"0"},title:{display:"flex",alignItems:"center",fontSize:"14px",fontWeight:"600"}},t}return Object(l.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.id,n=e.title;return C.createElement("div",{className:this.props.styleProvider.css(this._styles.header),id:t},n&&this.renderTitle())},t.prototype.renderTitle=function(){var e=this.props,t=e.icon,n=e.styleProvider;return C.createElement("h1",{"aria-level":1,className:n.css(this._styles.title)},t,this.props.title)},t}(C.Component),Gl=n(2835),ql=function(){return{diamondIcon:{width:"27px",color:Hl().infoIcon,fontSize:"20px",margin:"15px 15px 0px 15px"},diamondIconHeader:{color:"inherit",margin:"0px 0px 0px 0px"}}},Vl=function(e){var t=e.styleProvider.css(ql().diamondIcon,e.isHeader?ql().diamondIconHeader:[]);return C.createElement(Gl.a,{"aria-hidden":!0,iconName:"Diamond",className:t})};function Zl(){var e=Hl();return{diamondHeader:{color:e.disabledText,":hover i":{color:e.accentButtonText}},header:{color:e.buttonText}}}var Ql=function(e){return e.shouldRenderAsPremium?C.createElement("div",{"data-automation-id":e.id,className:e.styleProvider.css(Zl().diamondHeader)},C.createElement(Wl,Object(l.__assign)({},e,{icon:C.createElement(Vl,{isHeader:!0,styleProvider:e.styleProvider})}))):C.createElement("div",{"data-automation-id":e.id,className:e.styleProvider.css(Zl().header)},C.createElement(Wl,Object(l.__assign)({},e)))},Yl="button",Kl="group",Xl={padding:"0"},Jl=function(e){var t,n,o=e.id,i=e.styleProvider,r=e.ariaHidden,s=null!==(t=e.ariaLabel)&&void 0!==t?t:void 0,a=null!==(n=e.contentRole)&&void 0!==n?n:Kl;return C.createElement("div",{"aria-hidden":r,"aria-label":s,id:o,"data-automation-id":o,onFocus:e.onFocus,onBlur:e.onBlur,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,role:a,tabIndex:-1},C.createElement("div",{className:i.css(Xl)},e.children))},$l=Object(na.p)({isTABNavigationUsed:!1});function ec(){return $l.isTABNavigationUsed}var tc=Object(na.g)((function(){var e=document.querySelector("body");$l.isTABNavigationUsed=!!e&&e.classList.contains("ms-Fabric--isFocusVisible")})),nc=function(e){var t,n={description:e.description,title:e.title,hasHeader:e.hasHeader},o=Object(l.__assign)({margin:"24px 0 10px 0",":first-of-type":{marginTop:"6px"}},e.style),i=e.styleProvider,r=e.theme,s=e.visibilityChanged,a=e.visibilityChangedCallbackMode,c=C.useCallback((function(t){var n,o=t.target;o&&function(e){if(tc(),ec()){if(!(e.getBoundingClientRect().top>=180)){var t=window.scrollY,n=Math.max(t-180,0);window.requestAnimationFrame((function(){window.scrollTo(0,n)}))}}}(o),null===(n=e.onFocus)||void 0===n||n.call(e)}),[e.onFocus]),u=null!==(t=e.contentRole)&&void 0!==t?t:Kl,p=C.createElement("div",{className:"ideas-card ".concat(i.css(o))},e.hasHeader&&C.createElement(Ql,Object(l.__assign)({shouldRenderAsPremium:e.shouldRenderAsPremium,id:e.headerId,styleProvider:e.styleProvider,theme:r},n)),C.createElement(Ul,{id:e.headerId,hasHeader:e.hasHeader,ariaLabel:e.ariaLabel,ignoreUserEngagement:e.ignoreUserEngagement,shouldRenderAsPremium:e.shouldRenderAsPremium,styleProvider:e.styleProvider,theme:r},C.createElement(Jl,Object(l.__assign)({id:"shell"+e.headerId,styleProvider:e.styleProvider,shouldRenderAsPremium:e.shouldRenderAsPremium,ariaLabel:e.ariaLabel,ariaHidden:!e.hasHeader&&!e.ariaLabel||void 0,contentRole:u,onFocus:c,onBlur:e.onBlur,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},n),e.children)));return s?C.createElement(Ml,{visibilityChanged:s,visibilityChangedCallbackMode:a},p):p},oc=n(2671),ic=n(969),rc=n(2674),sc=n(2404),ac=n(1701),lc=n(2836),cc=n(1706),uc=n(1707);n(640);var pc=n(2677),dc=n(2673),gc=n(1708);!function(e){function t(n,o){var i=e.call(this,n,o)||this;return function(e,t,n){for(var o=0,i=n.length;o<i;o++)hc(e,t,n[o])}(i,t.prototype,["componentDidMount","shouldComponentUpdate","getSnapshotBeforeUpdate","render","componentDidUpdate","componentWillUnmount"]),i}Object(l.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){this._updateComponentRef(e,this.props)},t.prototype.componentDidMount=function(){this._setComponentRef(this.props.componentRef,this)},t.prototype.componentWillUnmount=function(){if(this._setComponentRef(this.props.componentRef,null),this.__disposables){for(var e=0,t=this._disposables.length;e<t;e++){var n=this.__disposables[e];n.dispose&&n.dispose()}this.__disposables=null}},Object.defineProperty(t.prototype,"className",{get:function(){if(!this.__className){var e=/function (.{1,})\(/.exec(this.constructor.toString());this.__className=e&&e.length>1?e[1]:""}return this.__className},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_disposables",{get:function(){return this.__disposables||(this.__disposables=[]),this.__disposables},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_async",{get:function(){return this.__async||(this.__async=new cc.a(this),this._disposables.push(this.__async)),this.__async},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_events",{get:function(){return this.__events||(this.__events=new uc.a(this),this._disposables.push(this.__events)),this.__events},enumerable:!1,configurable:!0}),t.prototype._resolveRef=function(e){var t=this;return this.__resolves||(this.__resolves={}),this.__resolves[e]||(this.__resolves[e]=function(n){return t[e]=n}),this.__resolves[e]},t.prototype._updateComponentRef=function(e,t){void 0===t&&(t={}),e&&t&&e.componentRef!==t.componentRef&&(this._setComponentRef(e.componentRef,null),this._setComponentRef(t.componentRef,this))},t.prototype._warnDeprecations=function(e){this.className,this.props},t.prototype._warnMutuallyExclusive=function(e){this.className,this.props},t.prototype._warnConditionallyRequiredProps=function(e,t,n){this.className,this.props},t.prototype._setComponentRef=function(e,t){!this._skipComponentRefResolution&&e&&("function"==typeof e&&e(t),"object"==typeof e&&(e.current=t))}}(C.Component);function hc(e,t,n){var o=e[n],i=t[n];(o||i)&&(e[n]=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return i&&(e=i.apply(this,t)),o!==i&&(e=o.apply(this,t)),e})}function fc(){return null}var mc=n(2064),yc=n(2678),bc=n(1705),vc=n(1195),Sc=n(642),xc=function(e){var t=e.className,n=e.imageProps,o=Object(dc.d)(e,dc.e,["aria-label","aria-labelledby","title","aria-describedby"]),i=n.alt||e["aria-label"],r=i||e["aria-labelledby"]||e.title||n["aria-label"]||n["aria-labelledby"]||n.title,s={"aria-labelledby":e["aria-labelledby"],"aria-describedby":e["aria-describedby"],title:e.title},a=r?{}:{"aria-hidden":!0};return C.createElement("div",Object(l.__assign)({},a,o,{className:Object(rc.a)(Sc.a,Sc.b.root,Sc.b.image,t)}),C.createElement(vc.a,Object(l.__assign)({},s,n,{alt:r?i:""})))},Cc=n(309),Tc=n(426),wc=n.n(Tc)()({loader:function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,2770)).then((function(e){return e.ContextualMenu}))},loading:function(){return null}}),Oc={msButton:"ms-Button",msButtonHasMenu:"ms-Button--hasMenu",msButtonIcon:"ms-Button-icon",msButtonMenuIcon:"ms-Button-menuIcon",msButtonLabel:"ms-Button-label",msButtonDescription:"ms-Button-description",msButtonScreenReaderText:"ms-Button-screenReaderText",msButtonFlexContainer:"ms-Button-flexContainer",msButtonTextContainer:"ms-Button-textContainer"},kc=Object(ic.b)((function(e,t,n,o,i,r,s,a,l,c,u){var p,d,g=Object(xl.k)(Oc,e||{}),h=c&&!u;return Object(xl.r)({root:[g.msButton,t.root,o,l&&["is-checked",t.rootChecked],h&&["is-expanded",t.rootExpanded,{selectors:(p={},p[":hover ."+g.msButtonIcon]=t.iconExpandedHovered,p[":hover ."+g.msButtonMenuIcon]=t.menuIconExpandedHovered||t.rootExpandedHovered,p[":hover"]=t.rootExpandedHovered,p)}],a&&[Oc.msButtonHasMenu,t.rootHasMenu],s&&["is-disabled",t.rootDisabled],!s&&!h&&!l&&{selectors:(d={":hover":t.rootHovered},d[":hover ."+g.msButtonLabel]=t.labelHovered,d[":hover ."+g.msButtonIcon]=t.iconHovered,d[":hover ."+g.msButtonDescription]=t.descriptionHovered,d[":hover ."+g.msButtonMenuIcon]=t.menuIconHovered,d[":focus"]=t.rootFocused,d[":active"]=t.rootPressed,d[":active ."+g.msButtonIcon]=t.iconPressed,d[":active ."+g.msButtonDescription]=t.descriptionPressed,d[":active ."+g.msButtonMenuIcon]=t.menuIconPressed,d)},s&&l&&[t.rootCheckedDisabled],!s&&l&&{selectors:{":hover":t.rootCheckedHovered,":active":t.rootCheckedPressed}},n],flexContainer:[g.msButtonFlexContainer,t.flexContainer],textContainer:[g.msButtonTextContainer,t.textContainer],icon:[g.msButtonIcon,i,t.icon,h&&t.iconExpanded,l&&t.iconChecked,s&&t.iconDisabled],label:[g.msButtonLabel,t.label,l&&t.labelChecked,s&&t.labelDisabled],menuIcon:[g.msButtonMenuIcon,r,t.menuIcon,l&&t.menuIconChecked,s&&!u&&t.menuIconDisabled,!s&&!h&&!l&&{selectors:{":hover":t.menuIconHovered,":active":t.menuIconPressed}},h&&["is-expanded",t.menuIconExpanded]],description:[g.msButtonDescription,t.description,l&&t.descriptionChecked,s&&t.descriptionDisabled],screenReaderText:[g.msButtonScreenReaderText,t.screenReaderText]})})),Ac=Object(ic.b)((function(e,t,n,o,i){return{root:Object(xl.s)(e.splitButtonMenuButton,n&&[e.splitButtonMenuButtonExpanded],t&&[e.splitButtonMenuButtonDisabled],o&&!t&&[e.splitButtonMenuButtonChecked],i&&!t&&[{selectors:{":focus":e.splitButtonMenuFocused}}]),splitButtonContainer:Object(xl.s)(e.splitButtonContainer,!t&&o&&[e.splitButtonContainerChecked,{selectors:{":hover":e.splitButtonContainerCheckedHovered}}],!t&&!o&&[{selectors:{":hover":e.splitButtonContainerHovered,":focus":e.splitButtonContainerFocused}}],t&&e.splitButtonContainerDisabled),icon:Object(xl.s)(e.splitButtonMenuIcon,t&&e.splitButtonMenuIconDisabled,!t&&i&&e.splitButtonMenuIcon),flexContainer:Object(xl.s)(e.splitButtonFlexContainer),divider:Object(xl.s)(e.splitButtonDivider,(i||t)&&e.splitButtonDividerDisabled)}})),Ic=n(2806);var jc=Object(ic.a)((function(e){var t=e;return Object(ic.a)((function(n){if(e===n)throw new Error("Attempted to compose a component with itself.");var o=n,i=Object(ic.a)((function(e){return function(t){return C.createElement(o,Object(l.__assign)({},t,{defaultRender:e}))}}));return function(e){var n=e.defaultRender;return C.createElement(t,Object(l.__assign)({},e,{defaultRender:n?i(n):o}))}}))}));var _c=function(e){function t(t){var n=e.call(this,t)||this;return n._buttonElement=C.createRef(),n._splitButtonContainer=C.createRef(),n._mergedRef=Object(oc.a)(),n._renderedVisibleMenu=!1,n._getMemoizedMenuButtonKeytipProps=Object(ic.b)((function(e){return Object(l.__assign)(Object(l.__assign)({},e),{hasMenu:!0})})),n._onRenderIcon=function(e,t){var o=n.props.iconProps;if(o&&(void 0!==o.iconName||o.imageProps)){var i=o.className,r=o.imageProps,s=Object(l.__rest)(o,["className","imageProps"]);if(o.styles)return C.createElement(Gl.a,Object(l.__assign)({className:Object(rc.a)(n._classNames.icon,i),imageProps:r},s));if(o.iconName)return C.createElement(bc.a,Object(l.__assign)({className:Object(rc.a)(n._classNames.icon,i)},s));if(r)return C.createElement(xc,Object(l.__assign)({className:Object(rc.a)(n._classNames.icon,i),imageProps:r},s))}return null},n._onRenderTextContents=function(){var e=n.props,t=e.text,o=e.children,i=e.secondaryText,r=void 0===i?n.props.description:i,s=e.onRenderText,a=void 0===s?n._onRenderText:s,l=e.onRenderDescription,c=void 0===l?n._onRenderDescription:l;return t||"string"==typeof o||r?C.createElement("span",{className:n._classNames.textContainer},a(n.props,n._onRenderText),c(n.props,n._onRenderDescription)):[a(n.props,n._onRenderText),c(n.props,n._onRenderDescription)]},n._onRenderText=function(){var e=n.props.text,t=n.props.children;return void 0===e&&"string"==typeof t&&(e=t),n._hasText()?C.createElement("span",{key:n._labelId,className:n._classNames.label,id:n._labelId},e):null},n._onRenderChildren=function(){var e=n.props.children;return"string"==typeof e?null:e},n._onRenderDescription=function(e){var t=e.secondaryText,o=void 0===t?n.props.description:t;return o?C.createElement("span",{key:n._descriptionId,className:n._classNames.description,id:n._descriptionId},o):null},n._onRenderAriaDescription=function(){var e=n.props.ariaDescription;return e?C.createElement("span",{className:n._classNames.screenReaderText,id:n._ariaDescriptionId},e):null},n._onRenderMenuIcon=function(e){var t=n.props.menuIconProps;return C.createElement(bc.a,Object(l.__assign)({iconName:"ChevronDown"},t,{className:n._classNames.menuIcon}))},n._onRenderMenu=function(e){var t,o,i=n.props.menuAs?(t=n.props.menuAs,o=wc,jc(t)(o)):wc;return C.createElement(i,Object(l.__assign)({},e))},n._onDismissMenu=function(e){var t=n.props.menuProps;t&&t.onDismiss&&t.onDismiss(e),e&&e.defaultPrevented||n._dismissMenu()},n._dismissMenu=function(){n._menuShouldFocusOnMount=void 0,n._menuShouldFocusOnContainer=void 0,n.setState({menuHidden:!0})},n._openMenu=function(e,t){void 0===t&&(t=!0),n.props.menuProps&&(n._menuShouldFocusOnContainer=e,n._menuShouldFocusOnMount=t,n._renderedVisibleMenu=!0,n.setState({menuHidden:!1}))},n._onToggleMenu=function(e){var t=!0;n.props.menuProps&&!1===n.props.menuProps.shouldFocusOnMount&&(t=!1),n.state.menuHidden?n._openMenu(e,t):n._dismissMenu()},n._onSplitContainerFocusCapture=function(e){var t=n._splitButtonContainer.current;!t||e.target&&Object(sc.a)(e.target,t)||t.focus()},n._onSplitButtonPrimaryClick=function(e){n.state.menuHidden||n._dismissMenu(),!n._processingTouch&&n.props.onClick?n.props.onClick(e):n._processingTouch&&n._onMenuClick(e)},n._onKeyDown=function(e){!n.props.disabled||e.which!==El.a.enter&&e.which!==El.a.space?n.props.disabled||(n.props.menuProps?n._onMenuKeyDown(e):void 0!==n.props.onKeyDown&&n.props.onKeyDown(e)):(e.preventDefault(),e.stopPropagation())},n._onKeyUp=function(e){n.props.disabled||void 0===n.props.onKeyUp||n.props.onKeyUp(e)},n._onKeyPress=function(e){n.props.disabled||void 0===n.props.onKeyPress||n.props.onKeyPress(e)},n._onMouseUp=function(e){n.props.disabled||void 0===n.props.onMouseUp||n.props.onMouseUp(e)},n._onMouseDown=function(e){n.props.disabled||void 0===n.props.onMouseDown||n.props.onMouseDown(e)},n._onClick=function(e){n.props.disabled||(n.props.menuProps?n._onMenuClick(e):void 0!==n.props.onClick&&n.props.onClick(e))},n._onSplitButtonContainerKeyDown=function(e){e.which===El.a.enter||e.which===El.a.space?n._buttonElement.current&&(n._buttonElement.current.click(),e.preventDefault(),e.stopPropagation()):n._onMenuKeyDown(e)},n._onMenuKeyDown=function(e){if(!n.props.disabled){n.props.onKeyDown&&n.props.onKeyDown(e);var t=e.which===El.a.up,o=e.which===El.a.down;if(!e.defaultPrevented&&n._isValidMenuOpenKey(e)){var i=n.props.onMenuClick;i&&i(e,n.props),n._onToggleMenu(!1),e.preventDefault(),e.stopPropagation()}if(e.which!==El.a.enter&&e.which!==El.a.space||Object(ac.b)(!0,e.target),!e.altKey&&!e.metaKey&&(t||o))if(!n.state.menuHidden&&n.props.menuProps)(void 0!==n._menuShouldFocusOnMount?n._menuShouldFocusOnMount:n.props.menuProps.shouldFocusOnMount)||(e.preventDefault(),e.stopPropagation(),n._menuShouldFocusOnMount=!0,n.forceUpdate())}},n._onTouchStart=function(){n._isSplitButton&&n._splitButtonContainer.current&&!("onpointerdown"in n._splitButtonContainer.current)&&n._handleTouchAndPointerEvent()},n._onMenuClick=function(e){var t=n.props,o=t.onMenuClick,i=t.menuProps;o&&o(e,n.props);var r="boolean"==typeof(null==i?void 0:i.shouldFocusOnContainer)?i.shouldFocusOnContainer:"mouse"===e.nativeEvent.pointerType;e.defaultPrevented||(n._onToggleMenu(r),e.preventDefault(),e.stopPropagation())},Object(lc.a)(n),n._async=new cc.a(n),n._events=new uc.a(n),n.props.split,n._labelId=Object(pc.a)(),n._descriptionId=Object(pc.a)(),n._ariaDescriptionId=Object(pc.a)(),n.state={menuHidden:!0},n}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"_isSplitButton",{get:function(){return!!this.props.menuProps&&!!this.props.onClick&&!0===this.props.split},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e,t=this.props,n=t.ariaDescription,o=t.ariaLabel,i=t.ariaHidden,r=t.className,s=t.disabled,a=t.allowDisabledFocus,l=t.primaryDisabled,c=t.secondaryText,u=void 0===c?this.props.description:c,p=t.href,d=t.iconProps,g=t.menuIconProps,h=t.styles,f=t.checked,m=t.variantClassName,y=t.theme,b=t.toggle,v=t.getClassNames,S=t.role,x=this.state.menuHidden,C=s||l;this._classNames=v?v(y,r,m,d&&d.className,g&&g.className,C,f,!x,!!this.props.menuProps,this.props.split,!!a):kc(y,h,r,m,d&&d.className,g&&g.className,C,!!this.props.menuProps,f,!x,this.props.split);var T=this._ariaDescriptionId,w=this._labelId,O=this._descriptionId,k=!C&&!!p,A=k?"a":"button",I=Object(dc.d)(Object(gc.a)(k?{}:{type:"button"},this.props.rootProps,this.props),k?dc.a:dc.b,["disabled"]),j=o||I["aria-label"],_=void 0;n?_=T:u&&this.props.onRenderDescription!==fc?_=O:I["aria-describedby"]&&(_=I["aria-describedby"]);var M=void 0;I["aria-labelledby"]?M=I["aria-labelledby"]:_&&!j&&(M=this._hasText()?w:void 0);var D=!(!1===this.props["data-is-focusable"]||s&&!a||this._isSplitButton),E="menuitemcheckbox"===S||"checkbox"===S,R=E||!0===b?!!f:void 0,B=Object(gc.a)(I,((e={className:this._classNames.root,ref:this._mergedRef(this.props.elementRef,this._buttonElement),disabled:C&&!a,onKeyDown:this._onKeyDown,onKeyPress:this._onKeyPress,onKeyUp:this._onKeyUp,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onClick:this._onClick,"aria-label":j,"aria-labelledby":M,"aria-describedby":_,"aria-disabled":C,"data-is-focusable":D})[E?"aria-checked":"aria-pressed"]=R,e));if(i&&(B["aria-hidden"]=!0),this._isSplitButton)return this._onRenderSplitButtonContent(A,B);if(this.props.menuProps){var N=this.props.menuProps.id,L=void 0===N?this._labelId+"-menu":N;Object(gc.a)(B,{"aria-expanded":!x,"aria-controls":x?null:L,"aria-haspopup":!0})}return this._onRenderContent(A,B)},t.prototype.componentDidMount=function(){this._isSplitButton&&this._splitButtonContainer.current&&("onpointerdown"in this._splitButtonContainer.current&&this._events.on(this._splitButtonContainer.current,"pointerdown",this._onPointerDown,!0),"onpointerup"in this._splitButtonContainer.current&&this.props.onPointerUp&&this._events.on(this._splitButtonContainer.current,"pointerup",this.props.onPointerUp,!0))},t.prototype.componentDidUpdate=function(e,t){this.props.onAfterMenuDismiss&&!t.menuHidden&&this.state.menuHidden&&this.props.onAfterMenuDismiss()},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.focus=function(){this._isSplitButton&&this._splitButtonContainer.current?(Object(ac.b)(!0),this._splitButtonContainer.current.focus()):this._buttonElement.current&&(Object(ac.b)(!0),this._buttonElement.current.focus())},t.prototype.dismissMenu=function(){this._dismissMenu()},t.prototype.openMenu=function(e,t){this._openMenu(e,t)},t.prototype._onRenderContent=function(e,t){var n=this,o=this.props,i=e,r=o.menuIconProps,s=o.menuProps,a=o.onRenderIcon,c=void 0===a?this._onRenderIcon:a,u=o.onRenderAriaDescription,p=void 0===u?this._onRenderAriaDescription:u,d=o.onRenderChildren,g=void 0===d?this._onRenderChildren:d,h=o.onRenderMenu,f=void 0===h?this._onRenderMenu:h,m=o.onRenderMenuIcon,y=void 0===m?this._onRenderMenuIcon:m,b=o.disabled,v=o.keytipProps;v&&s&&(v=this._getMemoizedMenuButtonKeytipProps(v));var S=function(e){return C.createElement(i,Object(l.__assign)({},t,e),C.createElement("span",{className:n._classNames.flexContainer,"data-automationid":"splitbuttonprimary"},c(o,n._onRenderIcon),n._onRenderTextContents(),p(o,n._onRenderAriaDescription),g(o,n._onRenderChildren),!n._isSplitButton&&(s||r||n.props.onRenderMenuIcon)&&y(n.props,n._onRenderMenuIcon),s&&!s.doNotLayer&&n._shouldRenderMenu()&&f(n._getMenuProps(s),n._onRenderMenu)))},x=v?C.createElement(Ic.a,{keytipProps:this._isSplitButton?void 0:v,ariaDescribedBy:t["aria-describedby"],disabled:b},(function(e){return S(e)})):S();return s&&s.doNotLayer?C.createElement(C.Fragment,null,x,this._shouldRenderMenu()&&f(this._getMenuProps(s),this._onRenderMenu)):C.createElement(C.Fragment,null,x,C.createElement(mc.a,null))},t.prototype._shouldRenderMenu=function(){var e=this.state.menuHidden,t=this.props,n=t.persistMenu,o=t.renderPersistedMenuHiddenOnMount;return!e||!(!n||!this._renderedVisibleMenu&&!o)},t.prototype._hasText=function(){return null!==this.props.text&&(void 0!==this.props.text||"string"==typeof this.props.children)},t.prototype._getMenuProps=function(e){var t=this.props.persistMenu,n=this.state.menuHidden;return e.ariaLabel||e.labelElementId||!this._hasText()||(e=Object(l.__assign)(Object(l.__assign)({},e),{labelElementId:this._labelId})),Object(l.__assign)(Object(l.__assign)({id:this._labelId+"-menu",directionalHint:Cc.a.bottomLeftEdge},e),{shouldFocusOnContainer:this._menuShouldFocusOnContainer,shouldFocusOnMount:this._menuShouldFocusOnMount,hidden:t?n:void 0,className:Object(rc.a)("ms-BaseButton-menuhost",e.className),target:this._isSplitButton?this._splitButtonContainer.current:this._buttonElement.current,onDismiss:this._onDismissMenu})},t.prototype._onRenderSplitButtonContent=function(e,t){var n=this,o=this.props,i=o.styles,r=void 0===i?{}:i,s=o.disabled,a=o.allowDisabledFocus,c=o.checked,u=o.getSplitButtonClassNames,p=o.primaryDisabled,d=o.menuProps,g=o.toggle,h=o.role,f=o.primaryActionButtonProps,m=this.props.keytipProps,y=this.state.menuHidden,b=u?u(!!s,!y,!!c,!!a):r&&Ac(r,!!s,!y,!!c,!!p);Object(gc.a)(t,{onClick:void 0,onPointerDown:void 0,onPointerUp:void 0,tabIndex:-1,"data-is-focusable":!1}),m&&d&&(m=this._getMemoizedMenuButtonKeytipProps(m));var v=Object(dc.d)(t,[],["disabled"]);f&&Object(gc.a)(t,f);var S=function(o){return C.createElement("div",Object(l.__assign)({},v,{"data-ktp-target":o?o["data-ktp-target"]:void 0,role:h||"button","aria-disabled":s,"aria-haspopup":!0,"aria-expanded":!y,"aria-pressed":g?!!c:void 0,"aria-describedby":Object(yc.a)(t["aria-describedby"],o?o["aria-describedby"]:void 0),className:b&&b.splitButtonContainer,onKeyDown:n._onSplitButtonContainerKeyDown,onTouchStart:n._onTouchStart,ref:n._splitButtonContainer,"data-is-focusable":!0,onClick:s||p?void 0:n._onSplitButtonPrimaryClick,tabIndex:!s&&!p||a?0:void 0,"aria-roledescription":t["aria-roledescription"],onFocusCapture:n._onSplitContainerFocusCapture}),C.createElement("span",{style:{display:"flex",width:"100%"}},n._onRenderContent(e,t),n._onRenderSplitButtonMenuButton(b,o),n._onRenderSplitButtonDivider(b)))};return m?C.createElement(Ic.a,{keytipProps:m,disabled:s},(function(e){return S(e)})):S()},t.prototype._onRenderSplitButtonDivider=function(e){if(e&&e.divider){return C.createElement("span",{className:e.divider,"aria-hidden":!0,onClick:function(e){e.stopPropagation()}})}return null},t.prototype._onRenderSplitButtonMenuButton=function(e,n){var o=this.props,i=o.allowDisabledFocus,r=o.checked,s=o.disabled,a=o.splitButtonMenuProps,c=o.splitButtonAriaLabel,u=o.primaryDisabled,p=this.state.menuHidden,d=this.props.menuIconProps;void 0===d&&(d={iconName:"ChevronDown"});var g=Object(l.__assign)(Object(l.__assign)({},a),{styles:e,checked:r,disabled:s,allowDisabledFocus:i,onClick:this._onMenuClick,menuProps:void 0,iconProps:Object(l.__assign)(Object(l.__assign)({},d),{className:this._classNames.menuIcon}),ariaLabel:c,"aria-haspopup":!0,"aria-expanded":!p,"data-is-focusable":!1});return C.createElement(t,Object(l.__assign)({},g,{"data-ktp-execute-target":n?n["data-ktp-execute-target"]:n,onMouseDown:this._onMouseDown,tabIndex:u&&!i?0:-1}))},t.prototype._onPointerDown=function(e){var t=this.props.onPointerDown;t&&t(e),"touch"===e.pointerType&&(this._handleTouchAndPointerEvent(),e.preventDefault(),e.stopImmediatePropagation())},t.prototype._handleTouchAndPointerEvent=function(){var e=this;void 0!==this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout((function(){e._processingTouch=!1,e._lastTouchTimeoutId=void 0,e.focus()}),500)},t.prototype._isValidMenuOpenKey=function(e){return this.props.menuTriggerKeyCode?e.which===this.props.menuTriggerKeyCode:!!this.props.menuProps&&(e.which===El.a.down&&(e.altKey||e.metaKey))},t.defaultProps={baseClassName:"ms-Button",styles:{},split:!1},t}(C.Component),Mc=n(639),Dc=n(1711),Ec=n(641),Rc=n(808);var Bc={outline:0},Nc=function(e){return{fontSize:e,margin:"0 4px",height:"16px",lineHeight:"16px",textAlign:"center",flexShrink:0}},Lc=Object(ic.b)((function(e){var t,n,o=e.semanticColors,i=e.effects,r=e.fonts,s=o.buttonBorder,a=o.disabledBackground,l=o.disabledText,c={left:-2,top:-2,bottom:-2,right:-2,outlineColor:"ButtonText"};return{root:[Object(xl.j)(e,{inset:1,highContrastStyle:c,borderColor:"transparent"}),e.fonts.medium,{border:"1px solid "+s,borderRadius:i.roundedCorner2,boxSizing:"border-box",cursor:"pointer",display:"inline-block",padding:"0 16px",textDecoration:"none",textAlign:"center",userSelect:"none",selectors:{":active > span":{position:"relative",left:0,top:0}}}],rootDisabled:[Object(xl.j)(e,{inset:1,highContrastStyle:c,borderColor:"transparent"}),{backgroundColor:a,borderColor:a,color:l,cursor:"default",selectors:{":hover":Bc,":focus":Bc}}],iconDisabled:{color:l,selectors:(t={},t[xl.c]={color:"GrayText"},t)},menuIconDisabled:{color:l,selectors:(n={},n[xl.c]={color:"GrayText"},n)},flexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},description:{display:"block"},textContainer:{flexGrow:1,display:"block"},icon:Nc(r.mediumPlus.fontSize),menuIcon:Nc(r.small.fontSize),label:{margin:"0 4px",lineHeight:"100%",display:"block"},screenReaderText:xl.p}})),Pc=Object(ic.b)((function(e,t){var n,o,i,r,s,a,c,u,p,d,g,h,f,m=e.effects,y=e.palette,b=e.semanticColors,v={left:-2,top:-2,bottom:-2,right:-2,border:"none"},S={position:"absolute",width:1,right:31,top:8,bottom:8},x={splitButtonContainer:[Object(xl.j)(e,{highContrastStyle:v,inset:2}),{display:"inline-flex",selectors:{".ms-Button--default":{borderTopRightRadius:"0",borderBottomRightRadius:"0",borderRight:"none",flexGrow:"1"},".ms-Button--primary":{borderTopRightRadius:"0",borderBottomRightRadius:"0",border:"none",flexGrow:"1",selectors:(n={},n[xl.c]=Object(l.__assign)({color:"WindowText",backgroundColor:"Window",border:"1px solid WindowText",borderRightWidth:"0"},Object(xl.l)()),n[":hover"]={border:"none"},n[":active"]={border:"none"},n)},".ms-Button--primary + .ms-Button":{border:"none",selectors:(o={},o[xl.c]={border:"1px solid WindowText",borderLeftWidth:"0"},o)}}}],splitButtonContainerHovered:{selectors:{".ms-Button--primary":{selectors:(i={},i[xl.c]={color:"Window",backgroundColor:"Highlight"},i)},".ms-Button.is-disabled":{color:b.buttonTextDisabled,selectors:(r={},r[xl.c]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},r)}}},splitButtonContainerChecked:{selectors:{".ms-Button--primary":{selectors:(s={},s[xl.c]=Object(l.__assign)({color:"Window",backgroundColor:"WindowText"},Object(xl.l)()),s)}}},splitButtonContainerCheckedHovered:{selectors:{".ms-Button--primary":{selectors:(a={},a[xl.c]=Object(l.__assign)({color:"Window",backgroundColor:"WindowText"},Object(xl.l)()),a)}}},splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:(c={padding:6,height:"auto",boxSizing:"border-box",borderRadius:0,borderTopRightRadius:m.roundedCorner2,borderBottomRightRadius:m.roundedCorner2,border:"1px solid "+y.neutralSecondaryAlt,borderLeft:"none",outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},c[xl.c]={".ms-Button-menuIcon":{color:"WindowText"}},c),splitButtonDivider:Object(l.__assign)(Object(l.__assign)({},S),{selectors:(u={},u[xl.c]={backgroundColor:"WindowText"},u)}),splitButtonDividerDisabled:Object(l.__assign)(Object(l.__assign)({},S),{selectors:(p={},p[xl.c]={backgroundColor:"GrayText"},p)}),splitButtonMenuButtonDisabled:{pointerEvents:"none",border:"none",selectors:(d={":hover":{cursor:"default"},".ms-Button--primary":{selectors:(g={},g[xl.c]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},g)},".ms-Button-menuIcon":{selectors:(h={},h[xl.c]={color:"GrayText"},h)}},d[xl.c]={color:"GrayText",border:"1px solid GrayText",backgroundColor:"Window"},d)},splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:{outline:"none",border:"none",selectors:(f={},f[xl.c]=Object(l.__assign)({color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},Object(xl.l)()),f)},splitButtonMenuFocused:Object(l.__assign)({},Object(xl.j)(e,{highContrastStyle:v,inset:2}))};return Object(xl.g)(x,t)})),Fc=Object(ic.b)((function(e,t){var n,o=Lc(e),i=Pc(e),r=e.palette,s={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",color:e.semanticColors.link},rootHovered:{color:r.themeDarkAlt,backgroundColor:r.neutralLighter,selectors:(n={},n[xl.c]={borderColor:"Highlight",color:"Highlight"},n)},rootHasMenu:{width:"auto"},rootPressed:{color:r.themeDark,backgroundColor:r.neutralLight},rootExpanded:{color:r.themeDark,backgroundColor:r.neutralLight},rootChecked:{color:r.themeDark,backgroundColor:r.neutralLight},rootCheckedHovered:{color:r.themeDark,backgroundColor:r.neutralQuaternaryAlt},rootDisabled:{color:r.neutralTertiaryAlt}};return Object(xl.g)(o,s,i,t)})),Hc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n,o,i;return Object(l.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return C.createElement(_c,Object(l.__assign)({},this.props,{variantClassName:"ms-Button--icon",styles:Fc(n,t),onRenderText:fc,onRenderDescription:fc}))},t=Object(l.__decorate)([(n="IconButton",o=["theme","styles"],i=!0,function(e){var t,r=((t=function(t){function r(e){var n=t.call(this,e)||this;return n._styleCache={},n._onSettingChanged=n._onSettingChanged.bind(n),n}return Object(l.__extends)(r,t),r.prototype.componentDidMount=function(){Mc.a.observe(this._onSettingChanged)},r.prototype.componentWillUnmount=function(){Mc.a.unobserve(this._onSettingChanged)},r.prototype.render=function(){var t=this;return C.createElement(Ec.a.Consumer,null,(function(r){var s=Mc.a.getSettings(o,n,r.customizations),a=t.props;if(s.styles&&"function"==typeof s.styles&&(s.styles=s.styles(Object(l.__assign)(Object(l.__assign)({},s),a))),i&&s.styles){if(t._styleCache.default!==s.styles||t._styleCache.component!==a.styles){var c=Object(Rc.a)(s.styles,a.styles);t._styleCache.default=s.styles,t._styleCache.component=a.styles,t._styleCache.merged=c}return C.createElement(e,Object(l.__assign)({},s,a,{styles:t._styleCache.merged}))}return C.createElement(e,Object(l.__assign)({},s,a))}))},r.prototype._onSettingChanged=function(){this.forceUpdate()},r}(C.Component)).displayName="Customized"+n,t);return Object(Dc.a)(e,r)})],t)}(C.Component),zc=n(2380),Uc=n(1704),Wc=l.__assign;function Gc(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var i=e;return i.isSlot?0===(n=C.Children.toArray(n)).length?i(t):i(Object(l.__assign)(Object(l.__assign)({},t),{children:n})):C.createElement.apply(C,Object(l.__spreadArray)([e,t],n))}function qc(e,t){void 0===t&&(t={});var n=t.defaultProp,o=void 0===n?"children":n;return function(t,n,i,r,s){if(C.isValidElement(n))return n;var a=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];for(var i={},r=[],s=0,a=n;s<a.length;s++){var l=a[s];r.push(l&&l.className),Wc(i,l)}return i.className=Object(zc.a)([e,r],{rtl:Object(Uc.a)(t)}),i}(r,s,t,function(e,t){var n,o;"string"==typeof t||"number"==typeof t||"boolean"==typeof t?((n={})[e]=t,o=n):o=t;return o}(o,n));if(i){if(i.component){var c=i.component;return C.createElement(c,Object(l.__assign)({},a))}if(i.render)return i.render(a,e)}return C.createElement(e,Object(l.__assign)({},a))}}var Vc=Object(ic.b)((function(e){return qc(e)}));function Zc(e,t){var n={},o=e,i=function(e){if(t.hasOwnProperty(e)){var i=function(n){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];if(i.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return Qc(t[e],n,o[e],o.slots&&o.slots[e],o._defaultStyles&&o._defaultStyles[e],o.theme)};i.isSlot=!0,n[e]=i}};for(var r in t)i(r);return n}function Qc(e,t,n,o,i,r){return void 0!==e.create?e.create(t,n,o,i):Vc(e)(t,n,o,i,r)}function Yc(e,t){void 0===t&&(t={});var n=t.factoryOptions,o=(void 0===n?{}:n).defaultProp,i=function(n){var o,i,r,s=(o=t.displayName,i=C.useContext(Ec.a),r=t.fields,Mc.a.getSettings(r||["theme","styles","tokens"],o,i.customizations)),a=t.state;a&&(n=Object(l.__assign)(Object(l.__assign)({},n),a(n)));var c=n.theme||s.theme,u=function e(t,n){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];for(var r={},s=0,a=o;s<a.length;s++){var c=a[s];c&&(c="function"==typeof c?c(t,n):c,Array.isArray(c)&&(c=e.apply(void 0,Object(l.__spreadArray)([t,n],c))),Wc(r,c))}return r}(n,c,t.tokens,s.tokens,n.tokens),p=function(e,t,n){for(var o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];return xl.g.apply(void 0,o.map((function(o){return"function"==typeof o?o(e,t,n):o})))}(n,c,u,t.styles,s.styles,n.styles),d=Object(l.__assign)(Object(l.__assign)({},n),{styles:p,tokens:u,_defaultStyles:p,theme:c});return e(d)};return i.displayName=t.displayName||e.name,o&&(i.create=qc(i,{defaultProp:o})),Wc(i,t.statics),i}var Kc={root:"ms-StackItem"},Xc={start:"flex-start",end:"flex-end"},Jc=function(e,t){return t.spacing.hasOwnProperty(e)?t.spacing[e]:e},$c=function(e){var t=parseFloat(e),n=isNaN(t)?0:t,o=isNaN(t)?"":t.toString();return{value:n,unit:e.substring(o.toString().length)||"px"}},eu=function(e,t){if(void 0===e||"number"==typeof e||""===e)return e;var n=e.split(" ");return n.length<2?Jc(e,t):n.reduce((function(e,n){return Jc(e,t)+" "+Jc(n,t)}))},tu={start:"flex-start",end:"flex-end"},nu={root:"ms-Stack",inner:"ms-Stack-inner",child:"ms-Stack-child"},ou=Yc((function(e){var t=e.children,n=Object(dc.d)(e,dc.e);return null==t?null:Gc(Zc(e,{root:"div"}).root,Object(l.__assign)({},n),t)}),{displayName:"StackItem",styles:function(e,t,n){var o=e.grow,i=e.shrink,r=e.disableShrink,s=e.align,a=e.verticalFill,l=e.order,c=e.className,u=e.basis,p=void 0===u?"auto":u,d=Object(xl.k)(Kc,t);return{root:[t.fonts.medium,d.root,{flexBasis:p,margin:n.margin,padding:n.padding,height:a?"100%":"auto",width:"auto"},o&&{flexGrow:!0===o?1:o},(r||!o&&!i)&&{flexShrink:0},i&&!r&&{flexShrink:1},s&&{alignSelf:Xc[s]||s},l&&{order:l},c]}}});var iu=Yc((function(e){var t=e.as,n=void 0===t?"div":t,o=e.disableShrink,i=void 0!==o&&o,r=e.enableScopedSelectors,s=void 0!==r&&r,a=e.wrap,c=Object(l.__rest)(e,["as","disableShrink","enableScopedSelectors","wrap"]),u=function e(t,n){var o=n.disableShrink,i=n.enableScopedSelectors,r=C.Children.toArray(t);return r=C.Children.map(r,(function(t){if(!t||!C.isValidElement(t))return t;if(t.type===C.Fragment)return t.props.children?e(t.props.children,{disableShrink:o,enableScopedSelectors:i}):null;var n,r=t,s={};return(n=t)&&"object"==typeof n&&n.type&&n.type.displayName===ou.displayName&&(s={shrink:!o}),C.cloneElement(r,Object(l.__assign)(Object(l.__assign)(Object(l.__assign)({},s),r.props),{className:i?Object(rc.a)(nu.child,r.props.className):r.props.className}))}))}(e.children,{disableShrink:i,enableScopedSelectors:s}),p=Object(dc.d)(c,dc.e),d=Zc(e,{root:n,inner:"div"});return Gc(d.root,Object(l.__assign)({},p),a?Gc(d.inner,null,u):u)}),{displayName:"Stack",styles:function(e,t,n){var o,i,r,s,a,c,u,p,d,g,h,f,m,y=e.className,b=e.disableShrink,v=e.enableScopedSelectors,S=e.grow,x=e.horizontal,C=e.horizontalAlign,T=e.reversed,w=e.verticalAlign,O=e.verticalFill,k=e.wrap,A=Object(xl.k)(nu,t),I=n&&n.childrenGap?n.childrenGap:e.gap,j=n&&n.maxHeight?n.maxHeight:e.maxHeight,_=n&&n.maxWidth?n.maxWidth:e.maxWidth,M=n&&n.padding?n.padding:e.padding,D=function(e,t){if(void 0===e||""===e)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if("number"==typeof e)return{rowGap:{value:e,unit:"px"},columnGap:{value:e,unit:"px"}};var n=e.split(" ");if(n.length>2)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if(2===n.length)return{rowGap:$c(Jc(n[0],t)),columnGap:$c(Jc(n[1],t))};var o=$c(Jc(e,t));return{rowGap:o,columnGap:o}}(I,t),E=D.rowGap,R=D.columnGap,B=""+-.5*R.value+R.unit,N=""+-.5*E.value+E.unit,L={textOverflow:"ellipsis"},P="> "+(v?"."+nu.child:"*"),F=((o={})[P+":not(."+Kc.root+")"]={flexShrink:0},o);return k?{root:[A.root,{flexWrap:"wrap",maxWidth:_,maxHeight:j,width:"auto",overflow:"visible",height:"100%"},C&&(i={},i[x?"justifyContent":"alignItems"]=tu[C]||C,i),w&&(r={},r[x?"alignItems":"justifyContent"]=tu[w]||w,r),y,{display:"flex"},x&&{height:O?"100%":"auto"}],inner:[A.inner,(s={display:"flex",flexWrap:"wrap",marginLeft:B,marginRight:B,marginTop:N,marginBottom:N,overflow:"visible",boxSizing:"border-box",padding:eu(M,t),width:0===R.value?"100%":"calc(100% + "+R.value+R.unit+")",maxWidth:"100vw"},s[P]=Object(l.__assign)({margin:""+.5*E.value+E.unit+" "+.5*R.value+R.unit},L),s),b&&F,C&&(a={},a[x?"justifyContent":"alignItems"]=tu[C]||C,a),w&&(c={},c[x?"alignItems":"justifyContent"]=tu[w]||w,c),x&&(u={flexDirection:T?"row-reverse":"row",height:0===E.value?"100%":"calc(100% + "+E.value+E.unit+")"},u[P]={maxWidth:0===R.value?"100%":"calc(100% - "+R.value+R.unit+")"},u),!x&&(p={flexDirection:T?"column-reverse":"column",height:"calc(100% + "+E.value+E.unit+")"},p[P]={maxHeight:0===E.value?"100%":"calc(100% - "+E.value+E.unit+")"},p)]}:{root:[A.root,(d={display:"flex",flexDirection:x?T?"row-reverse":"row":T?"column-reverse":"column",flexWrap:"nowrap",width:"auto",height:O?"100%":"auto",maxWidth:_,maxHeight:j,padding:eu(M,t),boxSizing:"border-box"},d[P]=L,d),b&&F,S&&{flexGrow:!0===S?1:S},C&&(g={},g[x?"justifyContent":"alignItems"]=tu[C]||C,g),w&&(h={},h[x?"alignItems":"justifyContent"]=tu[w]||w,h),x&&R.value>0&&(f={},f[T?P+":not(:last-child)":P+":not(:first-child)"]={marginLeft:""+R.value+R.unit},f),!x&&E.value>0&&(m={},m[T?P+":not(:last-child)":P+":not(:first-child)"]={marginTop:""+E.value+E.unit},m),y]}},statics:{Item:ou}}),ru=Yc((function(e){if(null==e.children)return null;e.block,e.className;var t=e.as,n=void 0===t?"span":t,o=(e.variant,e.nowrap,Object(l.__rest)(e,["block","className","as","variant","nowrap"]));return Gc(Zc(e,{root:n}).root,Object(l.__assign)({},Object(dc.d)(o,dc.e)))}),{displayName:"Text",styles:function(e,t){var n=e.as,o=e.className,i=e.block,r=e.nowrap,s=e.variant,a=t.fonts,l=t.semanticColors,c=a[s||"medium"];return{root:[c,{color:c.color||l.bodyText,display:i?"td"===n?"table-cell":"block":"inline",mozOsxFontSmoothing:c.MozOsxFontSmoothing,webkitFontSmoothing:c.WebkitFontSmoothing},r&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},o]}}});if(!C.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!na.s)throw new Error("mobx-react-lite requires mobx at least version 4 to be available");var su=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return s};function au(){var e=su(Object(C.useState)(0),2)[1];return Object(C.useCallback)((function(){e((function(e){return e+1}))}),[])}var lu={};function cu(){return"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:lu}var uu,pu=(uu="observerBatching","function"==typeof Symbol?Symbol.for(uu):"__$mobx-react "+uu+"__");function du(e){e()}var gu=!1;function hu(){return gu}function fu(e){return Object(na.l)(e)}var mu,yu=1e4,bu=new Set;function vu(){void 0===mu&&(mu=setTimeout(Su,1e4))}function Su(){mu=void 0;var e=Date.now();bu.forEach((function(t){var n=t.current;n&&e>=n.cleanAt&&(n.reaction.dispose(),t.current=null,bu.delete(t))})),bu.size>0&&vu()}var xu=!1,Cu=[];var Tu={};function wu(e){return"observer"+e}function Ou(e,t,n){if(void 0===t&&(t="observed"),void 0===n&&(n=Tu),hu())return e();var o,i=function(e){return function(){xu?Cu.push(e):e()}}((n.useForceUpdate||au)()),r=T.a.useRef(null);if(!r.current){var s=new na.c(wu(t),(function(){a.mounted?i():(s.dispose(),r.current=null)})),a=function(e){return{cleanAt:Date.now()+yu,reaction:e}}(s);r.current=a,o=r,bu.add(o),vu()}var l=r.current.reaction;return T.a.useDebugValue(l,fu),T.a.useEffect((function(){var e;return e=r,bu.delete(e),r.current?r.current.mounted=!0:(r.current={reaction:new na.c(wu(t),(function(){i()})),cleanAt:1/0},i()),function(){r.current.reaction.dispose(),r.current=null}}),[]),function(e){xu=!0,Cu=[];try{var t=e();xu=!1;var n=Cu.length>0?Cu:void 0;return T.a.useLayoutEffect((function(){n&&n.forEach((function(e){return e()}))}),[n]),t}finally{xu=!1}}((function(){var t,n;if(l.track((function(){try{t=e()}catch(e){n=e}})),n)throw n;return t}))}var ku=function(){return(ku=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Au(e,t){if(hu())return e;var n,o,i,r=ku({forwardRef:!1},t),s=e.displayName||e.name,a=function(t,n){return Ou((function(){return e(t,n)}),s)};return a.displayName=s,n=r.forwardRef?Object(C.memo)(Object(C.forwardRef)(a)):Object(C.memo)(a),o=e,i=n,Object.keys(o).forEach((function(e){Iu[e]||Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(o,e))})),n.displayName=s,n}var Iu={$$typeof:!0,render:!0,compare:!0,type:!0};function ju(e){var t=e.children,n=e.render,o=t||n;return"function"!=typeof o?null:Ou(o)}function _u(e,t,n,o,i){var r="children"===t?"render":"children",s="function"==typeof e[t],a="function"==typeof e[r];return s&&a?new Error("MobX Observer: Do not use children and render in the same time in`"+n):s||a?null:new Error("Invalid prop `"+i+"` of type `"+typeof e[t]+"` supplied to `"+n+"`, expected `function`.")}ju.propTypes={children:_u,render:_u},ju.displayName="Observer";var Mu;(Mu=Yo.unstable_batchedUpdates)||(Mu=du),Object(na.i)({reactionScheduler:Mu}),cu()[pu]=!0;var Du=0;var Eu={};function Ru(e){return Eu[e]||(Eu[e]=function(e){if("function"==typeof Symbol)return Symbol(e);var t="__$mobx-react "+e+" ("+Du+")";return Du++,t}(e)),Eu[e]}function Bu(e,t){if(Nu(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(var i=0;i<n.length;i++)if(!Object.hasOwnProperty.call(t,n[i])||!Nu(e[n[i]],t[n[i]]))return!1;return!0}function Nu(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function Lu(e,t,n){Object.hasOwnProperty.call(e,t)?e[t]=n:Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:n})}var Pu=Ru("patchMixins"),Fu=Ru("patchedDefinition");function Hu(e,t){for(var n=this,o=arguments.length,i=new Array(o>2?o-2:0),r=2;r<o;r++)i[r-2]=arguments[r];t.locks++;try{var s;return null!=e&&(s=e.apply(this,i)),s}finally{t.locks--,0===t.locks&&t.methods.forEach((function(e){e.apply(n,i)}))}}function zu(e,t){return function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];Hu.call.apply(Hu,[this,e,t].concat(o))}}function Uu(e,t,n){var o=function(e,t){var n=e[Pu]=e[Pu]||{},o=n[t]=n[t]||{};return o.locks=o.locks||0,o.methods=o.methods||[],o}(e,t);o.methods.indexOf(n)<0&&o.methods.push(n);var i=Object.getOwnPropertyDescriptor(e,t);if(!i||!i[Fu]){var r=e[t],s=function e(t,n,o,i,r){var s,a=zu(r,i);return(s={})[Fu]=!0,s.get=function(){return a},s.set=function(r){if(this===t)a=zu(r,i);else{var s=e(this,n,o,i,r);Object.defineProperty(this,n,s)}},s.configurable=!0,s.enumerable=o,s}(e,t,i?i.enumerable:void 0,o,r);Object.defineProperty(e,t,s)}}var Wu=na.a||"$mobx",Gu=Ru("isUnmounted"),qu=Ru("skipRender"),Vu=Ru("isForcingUpdate");function Zu(e){var t=e.prototype;if(t.componentWillReact)throw new Error("The componentWillReact life-cycle event is no longer supported");if(e.__proto__!==C.PureComponent)if(t.shouldComponentUpdate){if(t.shouldComponentUpdate!==Yu)throw new Error("It is not allowed to use shouldComponentUpdate in observer based components.")}else t.shouldComponentUpdate=Yu;Ku(t,"props"),Ku(t,"state");var n=t.render;return t.render=function(){return Qu.call(this,n)},Uu(t,"componentWillUnmount",(function(){if(!0!==hu()){if(this.render[Wu])this.render[Wu].dispose();else;this[Gu]=!0}})),e}function Qu(e){var t=this;if(!0===hu())return e.call(this);Lu(this,qu,!1),Lu(this,Vu,!1);var n,o=(n=this).displayName||n.name||n.constructor&&(n.constructor.displayName||n.constructor.name)||"<component>",i=e.bind(this),r=!1,s=new na.c(o+".render()",(function(){if(!r&&(r=!0,!0!==t[Gu])){var e=!0;try{Lu(t,Vu,!0),t[qu]||C.Component.prototype.forceUpdate.call(t),e=!1}finally{Lu(t,Vu,!1),e&&s.dispose()}}}));function a(){r=!1;var e=void 0,t=void 0;if(s.track((function(){try{t=Object(na.d)(!1,i)}catch(t){e=t}})),e)throw e;return t}return s.reactComponent=this,a[Wu]=s,this.render=a,a.call(this)}function Yu(e,t){return hu()&&console.warn("[mobx-react] It seems that a re-rendering of a React component is triggered while in static (server-side) mode. Please make sure components are rendered only once server-side."),this.state!==t||!Bu(this.props,e)}function Ku(e,t){var n=Ru("reactProp_"+t+"_valueHolder"),o=Ru("reactProp_"+t+"_atomHolder");function i(){return this[o]||Lu(this,o,Object(na.j)("reactive "+t)),this[o]}Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){var e=!1;return na._allowStateReadsStart&&na._allowStateReadsEnd&&(e=Object(na._allowStateReadsStart)(!0)),i.call(this).reportObserved(),na._allowStateReadsStart&&na._allowStateReadsEnd&&Object(na._allowStateReadsEnd)(e),this[n]},set:function(e){this[Vu]||Bu(this[n],e)?Lu(this,n,e):(Lu(this,n,e),Lu(this,qu,!0),i.call(this).reportChanged(),Lu(this,qu,!1))}})}var Xu="function"==typeof Symbol&&Symbol.for,Ju=Xu?Symbol.for("react.forward_ref"):"function"==typeof C.forwardRef&&Object(C.forwardRef)((function(e){return null})).$$typeof,$u=Xu?Symbol.for("react.memo"):"function"==typeof C.memo&&Object(C.memo)((function(e){return null})).$$typeof;function ep(e){if(!0===e.isMobxInjector&&console.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'"),$u&&e.$$typeof===$u)throw new Error("Mobx observer: You are trying to use 'observer' on function component wrapped to either another observer or 'React.memo'. The observer already applies 'React.memo' for you.");if(Ju&&e.$$typeof===Ju){var t=e.render;if("function"!=typeof t)throw new Error("render property of ForwardRef was not a function");return Object(C.forwardRef)((function(){var e=arguments;return Object(C.createElement)(ju,null,(function(){return t.apply(void 0,e)}))}))}return"function"!=typeof e||e.prototype&&e.prototype.render||e.isReactClass||Object.prototype.isPrototypeOf.call(C.Component,e)?Zu(e):Au(e)}if(!C.Component)throw new Error("mobx-react requires React to be available");if(!na.p)throw new Error("mobx-react requires mobx to be available");function tp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var o,i,r=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(o=n.next()).done)&&(r.push(o.value),!t||r.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return np(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return np(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function np(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}"function"==typeof Yo.unstable_batchedUpdates&&Object(na.i)({reactionScheduler:Yo.unstable_batchedUpdates});var op=ep((function(e){var t,n=Object(C.createRef)(),o=Object(sr.a)().getStringsFor("AiFeedbackSkittleStrings"),i=new Cl,r={skittleTitle:{root:{fontSize:"12px",font:"segoeui",fontWeight:"600",lineHeight:"16px",color:(t=Hl()).buttonText}},skittleSubtitle:{root:{fontSize:"10px",font:"segoeui",fontWeight:"400",lineHeight:"14px",color:t.buttonText,padding:"2px 8px 10px 12px",display:"flex",justifyContent:"left"}},topContainer:{padding:"8px 11px 0px 12px"},pyroCard:{borderRadius:"4px",height:"auto",width:"100%",cursor:"pointer",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",boxSizing:"border-box"},colors:{height:"auto",width:"100%",borderRadius:"4px",backgroundColor:t.buttonBackground,":hover":{backgroundColor:t.buttonBackgroundHovered},":active":{backgroundColor:t.buttonBackgroundPressed},":focus":ec()?{outline:"1px solid ".concat(t.focusBorder," !important")}:{}},iconStyles:{width:"24px",height:"24px",padding:"6px 3px 0px 0px"},closeButtonStyle:{root:{color:t.buttonText,display:"inline-block",width:"24px",height:"24px",padding:"4px"},rootHovered:{backgroundColor:t.buttonBackgroundPressed},rootPressed:{backgroundColor:t.buttonBackgroundPressed,borderStyle:"solid",borderWidth:"1px",borderColor:t.focusBorder}},closeIconStyle:{color:t.bodySubtext}},s=Object(aa.a)(),a=la.a.AiFeedbackSkittle;T.a.useEffect((function(){return s.logCategoryOfferedAcrossLevels(a)}),[a,s]);var l="AIFeedbackApp",c=Object(za.a)();T.a.useEffect((function(){return c.logKpi(l,l,Sl.a.Offered,!0,{isFromSkittle:!0})}),[c]);var u=tp(T.a.useState(!1),2),p=u[0],d=u[1],g=tp(T.a.useState(!1),2),h=g[0],f=g[1],m=T.a.useCallback((function(){return h?function(){s.logCategoryRejectedAcrossLevels(a),e.onClose()}:function(){s.logCategoryKeptAcrossLevels(a),c.logKpi(l,l,Sl.a.Tried,!0,{isFromSkittle:!0}),e.onClick()}}),[a,h,c,s,e]),y=function(){d(!0),s.logCategoryTriedAcrossLevels(a)};return T.a.createElement(nc,{headerId:"feedbackSkittle-header",hasHeader:!1,styleProvider:i,shouldRenderAsPremium:!1,visibilityChanged:function(e){e.visible&&(s.logCategorySeenAcrossLevels(a),e.stopMonitoring=!0)},visibilityChangedCallbackMode:"onchanged",style:r.pyroCard},T.a.createElement("div",{id:"AiFeedbackSkittle",ref:n,role:Yl,"aria-label":o("ariaLabelSkittle"),"data-is-focusable":!0,onClick:m(),onMouseEnter:y,onFocus:y,onMouseLeave:function(){return d(!1)},onKeyDown:function(e){"Enter"===e.key&&m()},className:i.css(r.colors)},T.a.createElement(iu,{horizontal:!0,tokens:{childrenGap:10},style:r.topContainer},T.a.createElement(ru,{"aria-hidden":!0,styles:r.skittleTitle},o("title")),T.a.createElement("div",{style:{width:"32px",height:"32px"}},p?T.a.createElement((function(){return T.a.createElement(Hc,{iconProps:{iconName:vl.Cancel,style:r.closeIconStyle},id:"AiFeedbackSkittleCloseButton",ariaLabel:o("closeAriaLabel"),styles:r.closeButtonStyle,onMouseEnter:function(){return f(!0)},onMouseLeave:function(){return f(!1)}})}),null):T.a.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzM0NzBfMTk5MjA5KSI+CjxwYXRoIGQ9Ik0zMi43ODM3IDcuNjg3NUwxMy45OTkgMTguNTM1NEMxMC4yODY3IDIwLjY3OTIgOCAyNC42NDA0IDggMjguOTI3MVY1MS4wNzI2QzggNTUuMzU5MiAxMC4yODY2IDU5LjMyMDMgMTMuOTk4NiA2MS40NjQxTDIzLjA2ODUgNjYuNzAyMkwyMy45NjAzIDY0TDQwLjk0OTMgNTMuODI2OEwzMy45OTg2IDQ5LjgxMjVDMzAuMjg2NiA0Ny42Njg3IDI4IDQzLjcwNzYgMjggMzkuNDIxVjMzLjA5MzhMMjkuODYyNSAzMC43MTgxTDM2IDI1Ljk2N1YxMkwzMy4yOTY5IDguMDQ2ODhMMzAuMzQwNyAxMC4xNTUyQzMxLjAyNDkgOS4yMjY3IDMxLjg0NTUgOC4zOTM0NiAzMi43ODM3IDcuNjg3NVoiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcl8zNDcwXzE5OTIwOSkiLz4KPHBhdGggZD0iTTMyLjc4MzcgNy42ODc1TDEzLjk5OSAxOC41MzU0QzEwLjI4NjcgMjAuNjc5MiA4IDI0LjY0MDQgOCAyOC45MjcxVjUxLjA3MjZDOCA1NS4zNTkyIDEwLjI4NjYgNTkuMzIwMyAxMy45OTg2IDYxLjQ2NDFMMjMuMDY4NSA2Ni43MDIyTDIzLjk2MDMgNjRMNDAuOTQ5MyA1My44MjY4TDMzLjk5ODYgNDkuODEyNUMzMC4yODY2IDQ3LjY2ODcgMjggNDMuNzA3NiAyOCAzOS40MjFWMzMuMDkzOEwyOS44NjI1IDMwLjcxODFMMzYgMjUuOTY3VjEyTDMzLjI5NjkgOC4wNDY4OEwzMC4zNDA3IDEwLjE1NTJDMzEuMDI0OSA5LjIyNjcgMzEuODQ1NSA4LjM5MzQ2IDMyLjc4MzcgNy42ODc1WiIgZmlsbD0idXJsKCNwYWludDFfbGluZWFyXzM0NzBfMTk5MjA5KSIvPgo8cGF0aCBkPSJNNTEuOTk1MiAzMC40NjA5VjM5LjQyMzdDNTEuOTk1MiA0My43MTAzIDQ5LjcwODYgNDcuNjcxNCA0NS45OTY2IDQ5LjgxNTJMMjUuOTk2NiA2MS4zNjU4QzIyLjI4MyA2My41MTA1IDE3LjcwNzMgNjMuNTEwNSAxMy45OTM4IDYxLjM2NThMMTIuNzgxMiA2MC42NjU2QzEzLjE2NiA2MC45NTUgMTMuNTcwNiA2MS4yMjI5IDEzLjk5MzggNjEuNDY3M0wzMy45OTM4IDczLjAxNzlDMzcuNzA3MyA3NS4xNjI2IDQyLjI4MyA3NS4xNjI2IDQ1Ljk5NjYgNzMuMDE3OUw2NS45OTY2IDYxLjQ2NzNDNjkuNzA4NiA1OS4zMjM1IDcxLjk5NTIgNTUuMzYyNCA3MS45OTUyIDUxLjA3NThWNDIuNzUxNkw1MS45OTUyIDMwLjQ2MDlaIiBmaWxsPSJ1cmwoI3BhaW50Ml9yYWRpYWxfMzQ3MF8xOTkyMDkpIi8+CjxwYXRoIGQ9Ik01MS45OTUyIDMwLjQ2MDlWMzkuNDIzN0M1MS45OTUyIDQzLjcxMDMgNDkuNzA4NiA0Ny42NzE0IDQ1Ljk5NjYgNDkuODE1MkwyNS45OTY2IDYxLjM2NThDMjIuMjgzIDYzLjUxMDUgMTcuNzA3MyA2My41MTA1IDEzLjk5MzggNjEuMzY1OEwxMi43ODEyIDYwLjY2NTZDMTMuMTY2IDYwLjk1NSAxMy41NzA2IDYxLjIyMjkgMTMuOTkzOCA2MS40NjczTDMzLjk5MzggNzMuMDE3OUMzNy43MDczIDc1LjE2MjYgNDIuMjgzIDc1LjE2MjYgNDUuOTk2NiA3My4wMTc5TDY1Ljk5NjYgNjEuNDY3M0M2OS43MDg2IDU5LjMyMzUgNzEuOTk1MiA1NS4zNjI0IDcxLjk5NTIgNTEuMDc1OFY0Mi43NTE2TDUxLjk5NTIgMzAuNDYwOVoiIGZpbGw9InVybCgjcGFpbnQzX2xpbmVhcl8zNDcwXzE5OTIwOSkiLz4KPHBhdGggZD0iTTMyLjc4MSA3LjY4NjY3TDMzLjk5OSA2Ljk4MzNDMzcuNzEyMyA0LjgzODkgNDIuMjg3NyA0LjgzODkgNDYuMDAxIDYuOTgzM0w2Ni4wMDEgMTguNTMzQzY5LjcxMzMgMjAuNjc2NyA3MiAyNC42Mzc5IDcyIDI4LjkyNDdWNTEuMDcwMkM3MiA1MS4xNTI2IDcxLjk5OTIgNTEuMjM0OSA3MS45OTc1IDUxLjMxNzFDNzEuOTExNSA0Ny4xMjU1IDY5LjY0MTkgNDMuMjc0OCA2Ni4wMDEgNDEuMTcyM0w0Ni4wMDEgMjkuNjIyNkM0Mi4yODc3IDI3LjQ3ODIgMzcuNzEyMyAyNy40NzgyIDMzLjk5OSAyOS42MjI2TDI4IDMzLjA4NjlWMTcuMjcyNkMyOCAxMy40NzY4IDI5Ljc5MyA5LjkzNjE5IDMyLjc4MSA3LjY4NjY3WiIgZmlsbD0idXJsKCNwYWludDRfcmFkaWFsXzM0NzBfMTk5MjA5KSIvPgo8cGF0aCBkPSJNMzIuNzgxIDcuNjg2NjdMMzMuOTk5IDYuOTgzM0MzNy43MTIzIDQuODM4OSA0Mi4yODc3IDQuODM4OSA0Ni4wMDEgNi45ODMzTDY2LjAwMSAxOC41MzNDNjkuNzEzMyAyMC42NzY3IDcyIDI0LjYzNzkgNzIgMjguOTI0N1Y1MS4wNzAyQzcyIDUxLjE1MjYgNzEuOTk5MiA1MS4yMzQ5IDcxLjk5NzUgNTEuMzE3MUM3MS45MTE1IDQ3LjEyNTUgNjkuNjQxOSA0My4yNzQ4IDY2LjAwMSA0MS4xNzIzTDQ2LjAwMSAyOS42MjI2QzQyLjI4NzcgMjcuNDc4MiAzNy43MTIzIDI3LjQ3ODIgMzMuOTk5IDI5LjYyMjZMMjggMzMuMDg2OVYxNy4yNzI2QzI4IDEzLjQ3NjggMjkuNzkzIDkuOTM2MTkgMzIuNzgxIDcuNjg2NjdaIiBmaWxsPSJ1cmwoI3BhaW50NV9saW5lYXJfMzQ3MF8xOTkyMDkpIi8+CjxwYXRoIGQ9Ik04LjAwMjUzIDUxLjMxNzFDOC4wMDI1MyA1MS4zMTcxIDguMDAyNTMgNTEuMzE3IDguMDAyNTMgNTEuMzE3MVoiIGZpbGw9InVybCgjcGFpbnQ2X3JhZGlhbF8zNDcwXzE5OTIwOSkiLz4KPHBhdGggZD0iTTguMDAyNTMgNTEuMzE3MUM4LjAwMjUzIDUxLjMxNzEgOC4wMDI1MyA1MS4zMTcgOC4wMDI1MyA1MS4zMTcxWiIgZmlsbD0idXJsKCNwYWludDdfbGluZWFyXzM0NzBfMTk5MjA5KSIvPgo8L2c+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXJfMzQ3MF8xOTkyMDkiIHgxPSIzNi4zNzI5IiB5MT0iMjMuMzEyOCIgeDI9IjE4Ljk3OTciIHkyPSI3My45NDc2IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiNBRTdGRTIiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMDA3OEQ0Ii8+CjwvbGluZWFyR3JhZGllbnQ+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQxX2xpbmVhcl8zNDcwXzE5OTIwOSIgeDE9IjI5Ljc3MjMiIHkxPSI2MC44ODQzIiB4Mj0iMjYuNzYyOCIgeTI9IjU1LjU3NTUiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agb2Zmc2V0PSIwLjk5OTkiIHN0b3AtY29sb3I9IiMxMTRBOEIiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMDA3OEQ0IiBzdG9wLW9wYWNpdHk9IjAiLz4KPC9saW5lYXJHcmFkaWVudD4KPHJhZGlhbEdyYWRpZW50IGlkPSJwYWludDJfcmFkaWFsXzM0NzBfMTk5MjA5IiBjeD0iMCIgY3k9IjAiIHI9IjEiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBncmFkaWVudFRyYW5zZm9ybT0idHJhbnNsYXRlKDIwLjU4NDMgNTkuMDMwOSkgcm90YXRlKC0xMy4wNjg4KSBzY2FsZSg1MS4xMDg5IDM5LjM3MDkpIj4KPHN0b3Agb2Zmc2V0PSIwLjE0MDAyOSIgc3RvcC1jb2xvcj0iI0Q1OURGRiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM1RTQzOEYiLz4KPC9yYWRpYWxHcmFkaWVudD4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDNfbGluZWFyXzM0NzBfMTk5MjA5IiB4MT0iNjMuMzAzOSIgeTE9IjM5LjM4ODQiIHgyPSI2MC40MjM0IiB5Mj0iNDQuMDA5NSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBvZmZzZXQ9IjAuOTk5OSIgc3RvcC1jb2xvcj0iIzQ5MzQ3NCIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM4QzY2QkEiIHN0b3Atb3BhY2l0eT0iMCIvPgo8L2xpbmVhckdyYWRpZW50Pgo8cmFkaWFsR3JhZGllbnQgaWQ9InBhaW50NF9yYWRpYWxfMzQ3MF8xOTkyMDkiIGN4PSIwIiBjeT0iMCIgcj0iMSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGdyYWRpZW50VHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjYuMTY0MyA0MS4yNzE4KSByb3RhdGUoLTE0My4wODMpIHNjYWxlKDQ1LjY0NzkgNDUuNjQ3OSkiPgo8c3RvcCBzdG9wLWNvbG9yPSIjNTBFNkZGIi8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzQzNkRDRCIvPgo8L3JhZGlhbEdyYWRpZW50Pgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50NV9saW5lYXJfMzQ3MF8xOTkyMDkiIHgxPSIyOC4wNjk2IiB5MT0iMjIuMjU5OCIgeDI9IjMyLjcyODIiIHkyPSIyMi4yNTk4IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIG9mZnNldD0iMC45OTk5IiBzdG9wLWNvbG9yPSIjMTE0QThCIi8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzAwNzhENCIgc3RvcC1vcGFjaXR5PSIwIi8+CjwvbGluZWFyR3JhZGllbnQ+CjxyYWRpYWxHcmFkaWVudCBpZD0icGFpbnQ2X3JhZGlhbF8zNDcwXzE5OTIwOSIgY3g9IjAiIGN5PSIwIiByPSIxIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgZ3JhZGllbnRUcmFuc2Zvcm09InRyYW5zbGF0ZSg2Ni4xNjQzIDQxLjI3MTgpIHJvdGF0ZSgtMTQzLjA4Mykgc2NhbGUoNDUuNjQ3OSA0NS42NDc5KSI+CjxzdG9wIHN0b3AtY29sb3I9IiM1MEU2RkYiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNDM2RENEIi8+CjwvcmFkaWFsR3JhZGllbnQ+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQ3X2xpbmVhcl8zNDcwXzE5OTIwOSIgeDE9IjI4LjA2OTYiIHkxPSIyMi4yNTk4IiB4Mj0iMzIuNzI4MiIgeTI9IjIyLjI1OTgiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agb2Zmc2V0PSIwLjk5OTkiIHN0b3AtY29sb3I9IiMxMTRBOEIiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMDA3OEQ0IiBzdG9wLW9wYWNpdHk9IjAiLz4KPC9saW5lYXJHcmFkaWVudD4KPGNsaXBQYXRoIGlkPSJjbGlwMF8zNDcwXzE5OTIwOSI+CjxyZWN0IHdpZHRoPSI4MCIgaGVpZ2h0PSI4MCIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K",alt:"Copilot Logo",style:r.iconStyles}))),T.a.createElement(ru,{"aria-hidden":!0,styles:r.skittleSubtitle},o("subtitle"))))})),ip=function(){function e(e){var t=this;this._ulsLogger=e,this._skittleContainer=null,this._scrollParentContainerElement=null,this._zoomContainerElement=null,this._contentContainerElement=null,this.canSkittleRender=void 0,this.shouldAiFeedbackSkittleRender=!1,this.isSkittleRendered=!1,this.reposition=function(){if(t._skittleContainer&&t._zoomContainerElement){var e=null!=document.getElementById(yl.skittleContainerId);t._skittleContainer.className=Object(ni.db)(bl(e).skittleContainerStyles),t._skittleContainer.style.transform=t._zoomContainerElement.style.transform,t.calculateCanSkittleRender()}},this.calculateCanSkittleRender=function(){if(t._contentContainerElement&&t._skittleContainer&&t._scrollParentContainerElement){var e=t._contentContainerElement.getBoundingClientRect().width,n=t._scrollParentContainerElement.getBoundingClientRect().width,o=t._skittleContainer.getBoundingClientRect().width,i=(n-e)/2-bl().skittlePaddingFromCanvas>o;i!==t.canSkittleRender&&(t.canSkittleRender=i,t.shouldAiFeedbackSkittleRender&&(t.canSkittleRender?t.tryShow():t.unconditionallyHide()))}}}return e.prototype.render=function(t){var n,o;if(t)if(this._skittleContainer)this._ulsLogger.sendTraceTag(509354946,p.a.msoulscat_Wac_Telemetry,d.a.Info,"AI Feedback Skittle already rendered!");else{this._zoomContainerElement=document.getElementsByClassName("PageContentOrigin").item(0),this._contentContainerElement=null!==(n=document.getElementsByClassName("Page").item(0))&&void 0!==n?n:document.getElementsByClassName("OutlineContainerDisplayWrapper").item(0),this._scrollParentContainerElement=document.getElementById("WACViewPanelContainer");var i=null!=document.getElementById(yl.skittleContainerId);this._skittleContainer=document.createElement("div"),this._skittleContainer.id=e.skittleContainerId,this._skittleContainer.className=Object(ni.db)(bl(i).skittleContainerStyles);var r={onClose:t.onClose,onClick:t.onClick};null===(o=this._scrollParentContainerElement)||void 0===o||o.appendChild(this._skittleContainer),Yo.render(C.createElement(op,Object(l.__assign)({},r)),this._skittleContainer),this.show(),this._ulsLogger.sendTraceTag(509354945,p.a.msoulscat_Wac_Telemetry,d.a.Info,"AI Feedback Skittle rendered!")}else this._ulsLogger.sendTraceTag(509354829,p.a.msoulscat_Wac_Telemetry,d.a.Error,"Bad AI Feedback Skittle arguments!")},e.prototype.dispose=function(){this._skittleContainer&&this._scrollParentContainerElement?(this._scrollParentContainerElement.removeChild(this._skittleContainer),Yo.unmountComponentAtNode(this._skittleContainer),this.removeEventListeners(),this._scrollParentContainerElement=this._zoomContainerElement=this._contentContainerElement=this._skittleContainer=null,this._ulsLogger.sendTraceTag(509354915,p.a.msoulscat_Wac_Telemetry,d.a.Info,"AI Feedback Skittle disposed!")):this._ulsLogger.sendTraceTag(509354944,p.a.msoulscat_Wac_Telemetry,d.a.Info,"AI Feedback Skittle already disposed!")},e.prototype.show=function(){this.shouldAiFeedbackSkittleRender=!0,this.addEventListeners(),this.calculateCanSkittleRender(),this.tryShow()},e.prototype.tryShow=function(){this._skittleContainer&&!this.isSkittleRendered&&(this._skittleContainer.style.visibility=bl().visible,this._skittleContainer.style.opacity=bl().opacityVisible,this._skittleContainer.style.overflow=bl().visible,this.isSkittleRendered=!0,this._ulsLogger.sendTraceTag(509354914,p.a.msoulscat_Wac_Telemetry,d.a.Info,"AI Feedback Skittle shown!"))},e.prototype.hide=function(){this.shouldAiFeedbackSkittleRender=!1,this.removeEventListeners(),this.unconditionallyHide()},e.prototype.unconditionallyHide=function(){this._skittleContainer&&(this._skittleContainer.style.visibility=bl().hidden,this._skittleContainer.style.opacity=bl().opacityHidden,this._skittleContainer.style.overflow=bl().hidden,this.isSkittleRendered=!1,this._ulsLogger.sendTraceTag(509354913,p.a.msoulscat_Wac_Telemetry,d.a.Info,"AI Feedback Skittle hidden!"))},e.prototype.update=function(){},e.prototype.addEventListeners=function(){window.addEventListener("resize",this.calculateCanSkittleRender)},e.prototype.removeEventListeners=function(){window.removeEventListener("resize",this.calculateCanSkittleRender)},e.skittleContainerId="AIFeedbackSkittleContainer",e}(),rp=n(2808),sp=n(2873),ap=n(2669),lp=n(2874),cp=function(){function e(e){this._params=e,this.setEditorTheme=function(){var e=si.b.getInstance().getThemeMode()===si.a.Dark?Sa.a.Dark:Sa.a.Light;Object(Sa.e)(e)},this._ulsLogger=this._params.ulsLogger}return e.prototype.init=function(){var e,t=new rp.a({logGroupName:"IdeasInWord",tenant:{tenantName:"NaturalLanguage",ariaTenantToken:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",nexusTenantToken:1733},defaultEventName:"",logToConsole:!0,logToKusto:!0},{sendTelemetryEvent:function(e){var t={otelEvent:e};Object(Qs.sendOtelEvent)(t)}},!0),n=new sp.a(t),o=new ap.a(t,n),i=new lp.a(n,o);this.setEditorTheme(),Object(ni.ib)(this.setEditorTheme),Object(aa.b)(i),Object(za.b)(t),Object(sr.b)(new ar.a),Object(sr.a)().loadLocale(null!==(e=this._params.uiCulture)&&void 0!==e?e:"en-US"),this._ulsLogger.sendTraceTag(557061700,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Editor initialized!")},e}(),up=new(function(){function e(){}return e.prototype.getWordContextualControllerInstance=function(e){if(e)return e.ulsLogger&&u.a.setLogger(e.ulsLogger),u.a.sendTraceTag(595858313,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Canvas contextual factory requested."),ta.createController(e)},e.prototype.getSkittleControllerV2Instance=function(e){return e.ulsLogger&&u.a.setLogger(e.ulsLogger),u.a.sendTraceTag(529073372,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Canvas contextual factory requested for Skittle Controller."),new yl(e.ulsLogger)},e.prototype.getEditorInitializerInstance=function(e){return e.ulsLogger&&u.a.setLogger(e.ulsLogger),u.a.sendTraceTag(557061699,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Canvas contextual factory requested for Editor Initializer."),new cp(e)},e.prototype.getAIFeedbackSkittleControllerInstance=function(e){return e.ulsLogger&&u.a.setLogger(e.ulsLogger),u.a.sendTraceTag(509366921,p.a.msoulscat_Wac_Telemetry,d.a.Info,"Canvas contextual factory requested for AI Feedback Skittle Controller."),new ip(e.ulsLogger)},e}());n.d(t,"FactoryGlobal",(function(){return up}))},632:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(1660),t),i(n(1661),t),i(n(1662),t),i(n(1663),t),i(n(1664),t),i(n(1665),t),i(n(1666),t),i(n(1667),t),i(n(1668),t),i(n(1669),t),i(n(1670),t),i(n(1671),t),i(n(1672),t),i(n(1673),t),i(n(1674),t),i(n(1675),t),i(n(1676),t),i(n(1677),t),i(n(1678),t),i(n(1679),t),i(n(1680),t),i(n(1681),t),i(n(1682),t),i(n(1683),t),i(n(1684),t),i(n(1685),t),i(n(957),t),i(n(1686),t),i(n(1687),t),i(n(1688),t)},957:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserInitiatedAnnotationClient=t.EccAnnotationClient=t.EccAnnotation=t.EccAnnotationBase=t.UserInitiatedAnnotation=t.PredictionAnnotation=t.PredictionAnnotationClient=t.PredictionAnnotationBase=t.FlagAnnotation=t.NudgeAnnotationClient=t.NudgeAnnotation=void 0;var o=n(83),i=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.NudgeAnnotation=i;var r=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_NudgeAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.NudgeAnnotationClient=r;var s=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagAnnotation"},e.getBaseTypes=function(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.FlagAnnotation=s;var a=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.PredictionAnnotationBase=a;var l=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.PredictionAnnotationClient=l;var c=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.PredictionAnnotation=c;var u=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedAnnotation=u;var p=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccAnnotationBase=p;var d=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccAnnotation=d;var g=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.EccAnnotationClient=g;var h=function(){function e(t){o.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();t.UserInitiatedAnnotationClient=h}}]);
//# sourceMappingURL=canvasContextual.min.js.map