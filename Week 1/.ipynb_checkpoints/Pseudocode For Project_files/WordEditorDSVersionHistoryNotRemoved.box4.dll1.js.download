'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1033:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.globalThis=void 0;D=c(1206);L.globalThis=D},1047:function(D,L,c){function l(M,I=self){I.addEventListener("message",function W(U){if(U&&U.data){var {id:V,type:Y,path:da}=Object.assign({path:[]},U.data),ba=(U.data.hrh||[]).map(m);try{const sa=da.slice(0,-1).reduce((ra,ma)=>ra[ma],M),ta=da.reduce((ra,ma)=>ra[ma],M);switch(Y){case "GET":var ja=
ta;break;case "SET":sa[da.slice(-1)[0]]=m(U.data.value);ja=!0;break;case "APPLY":ja=ta.apply(sa,ba);break;case "CONSTRUCT":const ra=new ta(...ba);ja=Object.assign(ra,{[v]:!0});break;case "ENDPOINT":const {port1:ma,port2:Ba}=new MessageChannel;l(M,Ba);ja=x(ma,[ma]);break;case "RELEASE":ja=void 0;break;default:return}}catch(sa){ja={value:sa,[J]:0}}Promise.resolve(ja).catch(sa=>({value:sa,[J]:0})).then(sa=>{const [ta,ra]=y(sa);I.postMessage(Object.assign(Object.assign({},ta),{id:V}),ra);"RELEASE"===
Y&&(I.removeEventListener("message",W),"MessagePort"===I.constructor.name&&I.close())})}});I.start&&I.start()}function e(M){if(M)throw Error("Proxy has been released and is not useable");}function a(M,I=[],T=function(){}){let U=!1;const W=new Proxy(T,{get(V,Y){e(U);if(Y===F)return()=>u(M,{type:"RELEASE",path:I.map(da=>da.toString())}).then(()=>{"MessagePort"===M.constructor.name&&M.close();U=!0});if("then"===Y){if(0===I.length)return{then:()=>W};V=u(M,{type:"GET",path:I.map(da=>da.toString())}).then(m);
return V.then.bind(V)}return a(M,[...I,Y])},set(V,Y,da){e(U);const [ba,ja]=y(da);return u(M,{type:"SET",path:[...I,Y].map(sa=>sa.toString()),value:ba},ja).then(m)},apply(V,Y,da){e(U);V=I[I.length-1];if(V===E)return u(M,{type:"ENDPOINT"}).then(m);if("bind"===V)return a(M,I.slice(0,-1));const [ba,ja]=k(da);return u(M,{type:"APPLY",path:I.map(sa=>sa.toString()),hrh:ba},ja).then(m)},construct(V,Y){e(U);const [da,ba]=k(Y);return u(M,{type:"CONSTRUCT",path:I.map(ja=>ja.toString()),hrh:da},ba).then(m)}});
return W}function k(M){M=M.map(y);return[M.map(I=>I[0]),Array.prototype.concat.apply([],M.map(I=>I[1]))]}function x(M,I){P.set(M,I);return M}function y(M){for(const [I,T]of H)if(T.hxh(M)){const [U,W]=T.serialize(M);return[{type:"HANDLER",name:I,value:U},W]}return[{type:"RAW",value:M},P.get(M)||[]]}function m(M){switch(M.type){case "HANDLER":return H.get(M.name).deserialize(M.value);case "RAW":return M.value}}function u(M,I,T){return new Promise(U=>{const W=z();M.addEventListener("message",function da(Y){Y.data&&
Y.data.id&&Y.data.id===W&&(M.removeEventListener("message",da),U(Y.data))});M.start&&M.start();M.postMessage(Object.assign({id:W},I),T)})}function z(){return Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}D=c(0);const v=Symbol("Comlink.proxy"),E=Symbol("Comlink.endpoint"),F=Symbol("Comlink.releaseProxy"),J=Symbol("Comlink.thrown"),K=M=>"object"===typeof M&&null!==M||"function"===typeof M,H=new Map([["proxy",{hxh:M=>K(M)&&M[v],serialize(M){const {port1:I,
port2:T}=new MessageChannel;l(M,I);return[T,[T]]},deserialize(M){M.start();return a(M,[],void 0)}}],["throw",{hxh:M=>K(M)&&J in M,serialize({value:M}){return[M instanceof Error?{rga:!0,value:{message:M.message,name:M.name,stack:M.stack}}:{rga:!1,value:M},[]]},deserialize(M){if(M.rga)throw Object.assign(Error(M.value.message),M.value);throw M.value;}}]]),P=new WeakMap;c.d(L,"a",function(){return N});class N{static mNj(M){N.P9a=M;N.eik=a(M,[],void 0)}static get Endpoint(){return N.P9a}static get nNj(){return N.eik}}
Object(D.a)(N,"WorkerUtils",null,[])},1063:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"WaterlineOverrideSettings",null,[])},1064:function(D,L,c){function l(z){return{scriptUrl:z,insideInitName:"window.UlsWorkerService.ulsWorkerInsideInit"}}c.r(L);c.d(L,"UlsWorkerService",function(){return m});c.d(L,"ulsWorkerInsideInit",function(){return u});c.d(L,"ulsWorkerInsideScript",function(){return l});D=c(0);var e=c(862),a=c(1002),k=c(21),x=c(2),y=c(872);class m{constructor(z,
v,E,F,J){this.qgk=new a.a(z,v,E,F,J)}nX(z){this.qgk.nX(z)}}Object(D.a)(m,"UlsWorkerService",null,[]);const u=({config:z,connection:v})=>{"Thread"===v.createMode&&e.setConfig(z);z=k.a.instance.Ma("Common.IRefreshableAppSettings");const E=new m(y.a.DGd,!0,x.AFrameworkApplication.Ke,null!==z&&void 0!==z?z:x.AFrameworkApplication.K,z);return e.Endpoint.B9e(v,()=>E)}},1065:function(D,L,c){D=c(0);var l=c(453),e=c(550),a=c(583),k=c(247);class x extends k.a{constructor(){super();this.LowWaterline=this.HighWaterline=
this.FileId=null}Cl(){return 97}static maa(E,F,J){const K=new x;K.FileId=E;K.HighWaterline=F;K.LowWaterline=J;return K}}Object(D.a)(x,"GetActivitiesRequest",k.a,[]);class y extends k.a{constructor(E,F,J){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=E;this.Waterline=F;this.Settings=J}Cl(){return 107}static maa(E,F,J){return new y(E,F,J)}}Object(D.a)(y,"GetRelevantActivitiesRequest",k.a,[]);class m extends k.a{constructor(E,F){super();this.WaterlineOverrideSettings=this.FileId=
null;this.FileId=E;this.WaterlineOverrideSettings=F}Cl(){return 96}static maa(E,F){return new m(E,F)}}Object(D.a)(m,"GetWywaActivitiesRequest",k.a,[]);class u{}Object(D.a)(u,"RelevantActivitiesSettings",null,[]);class z extends k.a{constructor(){super();this.FileId=null}Cl(){return 109}static maa(E){const F=new z;F.FileId=E;return F}}Object(D.a)(z,"UpdateWaterlineRequest",k.a,[]);c.d(L,"a",function(){return v});class v{constructor(E,F,J,K,H){this.H5j=E;this.Yrd=F;this.ENe=J;this.Dnc=K;this.EKg=H}requestWYWAActivities(E){E=
m.maa(this.Yrd(),E);return l.a.then(this.yaa(E,"wywa"),F=>F)}requestActivities(E,F){E=x.maa(this.Yrd(),E,F);return l.a.then(this.yaa(E,"activities"),J=>J)}fZn(){const E=z.maa(this.Yrd());return l.a.then(this.yaa(E,"waterline"),F=>F)}requestRelevantActivities(E,F){F=Object.assign(new u,{FirstDocumentOpen:F,MockDataEnabled:!1});E=y.maa(this.Yrd(),E,F);return l.a.then(this.yaa(E,"relevant"),J=>J)}updateActivityState(E){return l.a.H8c(this.EKg,F=>F.pLo(E.itemIds,E.activityStatesToSet,E.activityStatesToReset,
E.resetUnseenCount))}requestActivityFeed(){return l.a.H8c(this.EKg,E=>E.getActivityFeed(null))}yaa(E,F){const J={"Content-Type":"application/json; charset=utf-8"};return l.a.then(l.a.H8c(this.H5j,K=>K.Rw(this.ENe,J,e.a.QDh(E,this.Dnc),F)),K=>{if(!(K&&K.args&&K.args.data&&K.args.data.we))return null;({group:K}=a.a.H0(K.args.data.we));return K&&K.Responses&&K.Responses.length?K.Responses[0]:null})}}Object(D.a)(v,"SharedActivityRepository",null,[])},1206:function(D,L,c){D.exports=c(1207)()?globalThis:
c(1208)},1207:function(D){D.exports=function(){return"object"===typeof globalThis&&globalThis?globalThis.Array===Array:!1}},1208:function(D){function L(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw Error("Unable to resolve global `this`");}D.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(c){return L()}try{return __global__?__global__:L()}finally{delete Object.prototype.p5o}}()},
1209:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.aGi=void 0;var l=c(942);L.aGi=function(e){return function(a){var k=e[a];switch(typeof k){case "boolean":return(0,l.getBooleanFeatureGate)(a,k);case "number":return(0,l.l9h)(a,k);case "string":return(0,l.getStringFeatureGate)(a,k);default:throw Error("Wrong defaultValue type");}}}},1210:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.fGi=void 0;var l=c(943);L.fGi=function(){return function(e){return(0,l.isChangeGateEnabled)(e)}}},
1211:function(D,L,c){function l(k){var x=(0,a.Y7f)(void 0);(0,a.Y7f)(function(){var y=void 0!==x?x():{};return e.__assign(e.__assign({},y),k)});return x}Object.defineProperty(L,"__esModule",{value:!0});L.xrn=L.urn=void 0;var e=c(66),a=c(943);L.urn=l;L.xrn=function(k,x){return l(x)}},1212:function(D,L,c){function l(k){function x(){return{}}for(var y,m,u={},z=0,v=Object.keys(k);z<v.length;z++){var E=v[z];u[E]=null===(y=k[E])||void 0===y?void 0:y.toString()}var F=null!==(m=(0,a.p8f)(void 0))&&void 0!==
m?m:x;(0,a.p8f)(function(){return e.__assign(e.__assign({},F()),u)});return F}Object.defineProperty(L,"__esModule",{value:!0});L.yrn=L.vrn=void 0;var e=c(66),a=c(942);L.vrn=l;L.yrn=function(k,x){return l(x)}},1400:function(D,L,c){c.d(L,"a",function(){return e});var l;(function(a){a[a.Unknown=0]="Unknown";a[a.m2o=1]="Inference"})(l||(l={}));var e;(function(a){a[a.Unknown=0]="Unknown";a[a.E4o=1]="VoiceDictationBadge";a[a.F4o=2]="VoiceDictationPhrase"})(e||(e={}))},1501:function(D,L,c){c.r(L);c.d(L,
"Box4PasteSteward",function(){return ba});D=c(0);var l=c(21),e=c(2),a=c(16),k=c(138),x=c(59),y=c(6),m=c(8),u=c(36),z=c(76),v=c(11),E=c(134),F=c(135),J=c(10),K=c(3),H=c(98),P=c(5),N=c(191),M=c(150),I=c(40),T=c(95),U=c(42),W=c(61),V=c(31),Y=c(480),da=c(1743);class ba extends da.a{constructor(ja,sa,ta,ra,ma,Ba,Pa,Da=null,Ha=null){super(ja,Pa,Da,Ha);this._formatting=null;this.XJa=!1;this.Usb=null;this.nUb=-1;this.Aub=0;this.IAc=new z.a;this.w5m=4294967295;u.a(4223754,307,U.OutlineElementReader.Lh(ja));
this.$sb=sa;this.$sb.s0b(this);this.GL=ta;this.GL.s0b(this);this.Xp=ra;this.Qn=ma;this.rLe=E.ListItemReader.Kh(this.Fc);ba.Arm();ba.mrm();ba.Xrm()}get Qva(){return null!=this.qzg?this.qzg:this.qzg=l.a.instance.Ma("Box4.IInternalLinkManager")}get bGd(){return this._formatting}get t2b(){return this.rLe&&!this.GL.QCa}get KAb(){return 0<this.Aub}reset(){super.reset();this._formatting=this.Xmf(!1)}VZe(ja){var sa;u.a(4223762,307,U.OutlineElementReader.Lh(this.Fc)||T.OutlineReader.Kw(this.Fc));this.Kcc(!1);
var ta=new P.GraphIterator;ta.$c(this.Fc);ja=da.a.vg.UL(this.Fc,this.ENc(ja));this.zzd(ta,!1);u.a(4223763,307,ja===this.Fc.currentNode);u.a(4223764,307,J.ParagraphReader.Yb(ja));-1!==this._formatting.Xv&&ba.paragraphEditor.LD(ja,this._formatting.Xv);if(ba.paragraphEditor.Xp&&!this.e1.Hkj&&this._formatting.textIndent&&({unit:ma,returnValue:ra}=ba.V7d(this._formatting.textIndent),ta=!1,ra||!N.a.SZ)){if(0>ra){ta=!0;var ra=-1*ra}var ma=ba.l8e(ra,ma);ta?ba.paragraphEditor.Xp.lnb(ja,ma):ba.paragraphEditor.Xp.sca(ja,
ma)}(ba.Kd.Cg||H.a.instance.J(1)&&v.App.Ov.iPb)&&ja.setValue(y.a.EPa,!0);this._formatting.lineSpacing&&ba.paragraphEditor.KC(ja,this._formatting.lineSpacing);e.AFrameworkApplication.ye("702j5362;7g13g664");this._formatting.bR&&(null===(sa=e.AFrameworkApplication.K)||void 0===sa?0:sa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(m.ULS.sendTraceTag(509092556,307,50,"Setting before and after Spacing from margin top and bottom which we got from pasted HTML"),
ba.paragraphEditor.enb(ja,this._formatting.bR.afterSpacing),ba.paragraphEditor.fnb(ja,this._formatting.bR.beforeSpacing));if(this._formatting.Cjc){sa=[];ta=[];ma=[];ra=this._formatting.Cjc.split(" ");let Da=1,Ha=0;for(let oa=0;oa<ra.length;oa++){var Ba=ba.N_k(ra[oa]),Pa=ba.M_k(ra[oa]);if(-1!==Ba)Da=Ba;else if(-1!==Pa)Ha=Pa;else{({unit:Ba,returnValue:Pa}=ba.V7d(ra[oa]));Ba=ba.l8e(Pa,Ba);if(0<=Ba&&Ba<=this.w5m)sa.push(Ba),ta.push(Da),ma.push(Ha);else{u.b(555103310,307,15,"Invalid custom tab value. tabStops: "+
this._formatting.Cjc+" index: "+oa);break}Da=1;Ha=0}}0<sa.length&&ba.paragraphEditor.Wkk(ja,sa,ta,ma)}this._formatting.paragraph=ja;this.XJa=!0}zzd(ja,sa){u.a(8128518,307,!sa);this.xU&&(0<this.xU&&this.Xp.dIc(ja,this.xU),0>this.xU&&this.Xp.tRa(ja,this.xU,0));ja&&this.Qn.Zee(ja,this.KAb);this.xU=0}vke(ja){this.IAc.add(ja)}i5e(){this.xU=0}Qba(ja,sa=null){u.a(4223772,307,J.ParagraphReader.rh(this.Fc));const ta=this.Fc.currentNode;this._formatting.mhg(ta);if(!this.e1.vhg(this.Fc,sa,!1)){var ra=ta.qa.last,
ma=V.a.Bw(ta);this.XJa&&(ra.formatting=this._formatting.kQ.Sf(ra),ta.Pm(),this.XJa=!1);ja=this.e1.nuf(ja,sa);this.e1.fHa(this.Fc.currentNode,this._formatting.Xba,sa);this.characterPropertiesEditor.replaceTextRange(ma,ja,void 0,void 0,K.a.paste)}}UFa(ja){this.e1.hYd&&this.e1.XWd(ja)?(this.mG(),this.nG(ja)):(u.a(4223773,307,J.ParagraphReader.rh(this.Fc)),ja=V.a.Bw(this.Fc.currentNode),this.characterPropertiesEditor.jga(ja,sa=>new Y.a(sa)))}nlb(){this.e1.uuf(this.Fc)}Swa(ja){if(ba.Djl(ja)){const sa=
this.Fc.currentNode;J.ParagraphReader.Yb(sa)&&(sa.Hec=ja.Vgf)}else this.$sb.Swa(ja)}PFa(ja){this._formatting=ja;this.XJa=!0}RQa(ja){u.a(4223774,307,J.ParagraphReader.rh(this.Fc));u.a(4223775,307,!this.Usb);u.a(4223776,307,0>this.nUb);this.Usb=ja;this.nUb=J.ParagraphReader.textLength(this.Fc.currentNode)}QQa(){u.a(4223777,307,J.ParagraphReader.rh(this.Fc));u.a(4223778,307,!!this.Usb);u.a(4223779,307,0<=this.nUb);let ja=V.a.createTextRange(this.Fc.currentNode,this.nUb,J.ParagraphReader.textLength(this.Fc.currentNode)),
sa="",ta="";this.Qva&&({D1f:sa,wCb:ta}=this.Qva.ohg(F.HyperlinkReader.DOa(this.Usb))).returnValue&&(this.Usb=sa,ta&&(this.characterPropertiesEditor.replaceTextRange(ja,ta),ja=V.a.createTextRange(this.Fc.currentNode,this.nUb,J.ParagraphReader.textLength(this.Fc.currentNode))));ba.hyperlinkEditor.jH(ja,this.Usb,!1);this.XJa=!0;this.Usb=null;this.nUb=-1}nG(ja){this.VZe(ja);this._formatting.Kke(this.Fc.currentNode);this.e1.fHa(this.Fc.currentNode,this._formatting.Xba,ja)}mG(){u.a(4223808,307,J.ParagraphReader.rh(this.Fc));
ba.hyperlinkEditor.Xnl(this.Fc.currentNode);I.OutlineElementNavigator.Zd(this.Fc)}klb(){}jlb(){}XQa(){}Y3a(){}XFa(){u.a(4223809,307,U.OutlineElementReader.Lh(this.Fc)||T.OutlineReader.Kw(this.Fc));let ja=!1;this.KAb||(ja=this.t2b||!0);ja||(this.xU+=1);this.Aub++}VFa(){this.Aub--;let ja=!1;this.KAb||(ja=this.t2b||!0,this.Qn.G4i(this.IAc));ja||--this.xU}WQa(ja){u.a(4223810,307,U.OutlineElementReader.Lh(this.Fc)||T.OutlineReader.Kw(this.Fc));u.a(4223811,307,!!ja.listStyleType);this.Qn.Yee(this.MRm(ja))}WFa(){u.a(4223813,
307,U.OutlineElementReader.Lh(this.Fc))}$3a(ja){this.$sb.$3a(ja)}Pba(ja){this.GL.Pba(ja)}Mba(){this.GL.Mba()}Oba(ja){this.GL.Oba(ja)}Nba(){this.GL.Nba()}Lba(ja){this.GL.Lba(ja)}Kba(){this.GL.Kba()}static get paragraphEditor(){return null!=ba.ZBg?ba.ZBg:ba.ZBg=l.a.instance.resolve("Box4.IParagraphEditor")}static get hyperlinkEditor(){return null!=ba.qxg?ba.qxg:ba.qxg=l.a.instance.resolve("Box4.IHyperlinkEditor")}static get Kd(){return null!=ba.lFg?ba.lFg:ba.lFg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get DDj(){return null!=
ba.cGg?ba.cGg:ba.cGg=l.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get xjc(){return ba.IRe}static set xjc(ja){ba.IRe=ja}static get Gl(){return M.a.getInstance()}static Arm(){ba.l4a[1]=W.StyleReader.wordStyleIdHeading1;ba.l4a[2]=W.StyleReader.wordStyleIdHeading2;ba.l4a[3]=W.StyleReader.wordStyleIdHeading3;ba.l4a[4]=W.StyleReader.E7a;ba.l4a[5]=W.StyleReader.F7a;ba.l4a[6]=W.StyleReader.G7a;ba.l4a[7]=null}static mrm(){ba.vwa.unspecified=0;ba.vwa.defaultUnordered=1;ba.vwa.defaultOrdered=1;
ba.vwa.none=0;ba.vwa.disc=1;ba.vwa.circle=2;ba.vwa.square=3;ba.vwa.decimal=1;ba.vwa.lowerAlpha=2;ba.vwa.lowerRoman=3;ba.vwa.upperAlpha=4;ba.vwa.upperRoman=5}static Xrm(){ba.IRe=ba.DDj.Cr()}static N_k(ja){let sa=-1;if(!ja)return sa;ja=ja.toLowerCase();switch(ja){case "left":sa=1;break;case "center":sa=3;break;case "right":sa=4;break;case "decimal":sa=6;break;case "bar":sa=7}return sa}static M_k(ja){let sa=-1;if(!ja)return sa;ja=ja.toLowerCase();switch(ja){case "blank":sa=0;break;case "dotted":sa=1;
break;case "dashed":sa=2;break;case "lined":sa=3}return sa}static aAb(ja){const sa=a.a.substring(ja,0,2),ta=a.a.substring(ja,2,4);return a.a.substring(ja,4,6)+ta+sa}static V7d(ja){let sa=0;const ta=ja.length;var ra=a.a.substring(ja,0,ta-2);ra=parseFloat(ra);ja=a.a.substr(ja,ta-2,2);switch(ja){case "in":sa=3;break;case "px":sa=7;break;case "cm":sa=1;break;case "pt":sa=5;break;default:m.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",
ja),ra=0}return{returnValue:ra,unit:sa}}static l8e(ja,sa){let ta=0;switch(sa){case 3:ta=k.a.wv(ja);break;case 7:ta=x.a.ny(ja,0);break;case 1:ta=k.a.j4e(ja);break;case 5:ta=k.a.wv(k.a.BWf(ja));break;default:m.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",ja,sa)}return ta}static Djl(ja){return!!ja&&!!ja.Vgf&&""!==ja.Vgf}}ba.l4a=Array(8);ba.vwa={};ba.IRe=null;Object(D.a)(ba,"Box4PasteSteward",da.a,[])},1526:function(D,L,c){D=
c(0);var l=c(2),e=c(1993),a=c(8);const k=(y,m)=>{const u={};let z=null;switch(y){case 0:z="HtmlProcessor";var v=m.a;null!=v&&(u.SessionID=v);var E=m.b.toString();null!=E&&(u.Elements=E);var F=m.c.toString();null!=F&&(u.PrunedElements=F);var J=m.d.toString();null!=J&&(u.TransparentElements=J);var K=m.e.toString();null!=K&&(u.VoidElements=K);var H=m.f.toString();null!=H&&(u.UnknownElements=H);break;case 1:z="WordConverter";var P=m.a;null!=P&&(u.SessionID=P);var N=m.b.toString();null!=N&&(u.BulletsConverted=
N);var M=m.c.toString();null!=M&&(u.NumberedConverted=M);break;case 2:z="FormattingSteward";var I=m.a;null!=I&&(u.SourceApp=I);var T=m.b;null!=T&&(u.Browser=T);var U=m.c;null!=U&&(u.OperationId=U);var W=m.d.toString();null!=W&&(u.Lang=W);var V=m.e.toString();null!=V&&(u.TextDir=V);var Y=m.f.toString();null!=Y&&(u.Bold=Y);var da=m.g.toString();null!=da&&(u.Math=da);var ba=m.h.toString();null!=ba&&(u.Italics=ba);var ja=m.i.toString();null!=ja&&(u.Underline=ja);var sa=m.j.toString();null!=sa&&(u.Strikethrough=
sa);var ta=m.k.toString();null!=ta&&(u.Subscript=ta);var ra=m.l.toString();null!=ra&&(u.Superscript=ra);var ma=m.m.toString();null!=ma&&(u.Fontsize=ma);var Ba=m.n.toString();null!=Ba&&(u.Fontface=Ba);var Pa=m.o.toString();null!=Pa&&(u.GrowFontsize=Pa);var Da=m.p.toString();null!=Da&&(u.ShrinkFontsize=Da);var Ha=m.q.toString();null!=Ha&&(u.FontColor=Ha);var oa=m.r.toString();null!=oa&&(u.FontHighlight=oa);var wa=m.s.toString();null!=wa&&(u.ParagraphStyle=wa);var ia=m.t.toString();null!=ia&&(u.TextAlign=
ia);var ca=m.u.toString();null!=ca&&(u.TextIndent=ca);var pa=m.v.toString();null!=pa&&(u.MarginLeft=pa);var Ma=m.w.toString();null!=Ma&&(u.ParagraphSpaceBefore=Ma);var ya=m.x.toString();null!=ya&&(u.ParagraphSpaceAfter=ya);var Oa=m.y.toString();null!=Oa&&(u.LineSpace=Oa);var fa=m.z.toString();null!=fa&&(u.CellShadingColor=fa);var Ca=m.ba.toString();null!=Ca&&(u.StyleDefinition=Ca);var Ta=m.bb.toString();null!=Ta&&(u.TabStops=Ta);break;case 3:z="SemanticEvents";var eb=m.a;null!=eb&&(u.SessionID=eb);
var jb=m.b.toString();null!=jb&&(u.Text=jb);var ob=m.c.toString();null!=ob&&(u.LineBreak=ob);var Ya=m.d.toString();null!=Ya&&(u.Image=Ya);var Xa=m.e.toString();null!=Xa&&(u.File=Xa);var Sa=m.f.toString();null!=Sa&&(u.FormattingChange=Sa);var ab=m.g.toString();null!=ab&&(u.Anchor=ab);var Hb=m.h.toString();null!=Hb&&(u.Paragraph=Hb);var pb=m.i.toString();null!=pb&&(u.Math=pb);var Mb=m.j.toString();null!=Mb&&(u.List=Mb);var Qb=m.k.toString();null!=Qb&&(u.ListItem=Qb);var Aa=m.l.toString();null!=Aa&&
(u.RenderAugmentation=Aa);var bb=m.m.toString();null!=bb&&(u.Span=bb);break;case 4:z="SemanticTableEvents";var nb=m.a;null!=nb&&(u.SessionID=nb);var Va=m.b.toString();null!=Va&&(u.Tables=Va);var Ab=m.c.toString();null!=Ab&&(u.TableRow=Ab);var Zb=m.d.toString();null!=Zb&&(u.TableCell=Zb);var Kb=m.e.toString();null!=Kb&&(u.TablePart=Kb);break;case 5:z="HtmlEvents";var dc=m.a;null!=dc&&(u.OperationId=dc);var jc=m.b;null!=jc&&(u.SourceApp=jc);var zb=m.c;null!=zb&&(u.Browser=zb);var cc=null==m.d?null:
m.d.toString();null!=cc&&(u.Text=cc);var Ub=null==m.e?null:m.e.toString();null!=Ub&&(u.A=Ub);var Wb=null==m.f?null:m.f.toString();null!=Wb&&(u.Abbr=Wb);var Qa=null==m.g?null:m.g.toString();null!=Qa&&(u.Acronym=Qa);var sb=null==m.h?null:m.h.toString();null!=sb&&(u.Address=sb);var Jb=null==m.i?null:m.i.toString();null!=Jb&&(u.Applet=Jb);var pc=null==m.j?null:m.j.toString();null!=pc&&(u.Area=pc);var rc=null==m.k?null:m.k.toString();null!=rc&&(u.B=rc);var db=null==m.l?null:m.l.toString();null!=db&&(u.Base=
db);var lb=null==m.m?null:m.m.toString();null!=lb&&(u.Basefont=lb);var qa=null==m.n?null:m.n.toString();null!=qa&&(u.Bdo=qa);var Ga=null==m.o?null:m.o.toString();null!=Ga&&(u.Big=Ga);var Fb=null==m.p?null:m.p.toString();null!=Fb&&(u.Blockquote=Fb);var $b=null==m.q?null:m.q.toString();null!=$b&&(u.Body=$b);var rb=null==m.r?null:m.r.toString();null!=rb&&(u.Br=rb);var xb=null==m.s?null:m.s.toString();null!=xb&&(u.Button=xb);var gb=null==m.t?null:m.t.toString();null!=gb&&(u.Caption=gb);var Gb=null==m.u?
null:m.u.toString();null!=Gb&&(u.Center=Gb);var ac=null==m.v?null:m.v.toString();null!=ac&&(u.Cite=ac);var hc=null==m.w?null:m.w.toString();null!=hc&&(u.Code=hc);var Ec=null==m.x?null:m.x.toString();null!=Ec&&(u.Col=Ec);var Uc=null==m.y?null:m.y.toString();null!=Uc&&(u.Colgroup=Uc);var dd=null==m.z?null:m.z.toString();null!=dd&&(u.Dd=dd);var fd=null==m.ba?null:m.ba.toString();null!=fd&&(u.Del=fd);var xc=null==m.bb?null:m.bb.toString();null!=xc&&(u.Dfn=xc);var $c=null==m.bc?null:m.bc.toString();null!=
$c&&(u.Dir=$c);var Bc=null==m.bd?null:m.bd.toString();null!=Bc&&(u.Div=Bc);var Vd=null==m.be?null:m.be.toString();null!=Vd&&(u.Dl=Vd);var Je=null==m.bf?null:m.bf.toString();null!=Je&&(u.Dt=Je);var Gf=null==m.bg?null:m.bg.toString();null!=Gf&&(u.Em=Gf);var Nc=null==m.bh?null:m.bh.toString();null!=Nc&&(u.Fieldset=Nc);var md=null==m.bi?null:m.bi.toString();null!=md&&(u.Font=md);var Oe=null==m.bj?null:m.bj.toString();null!=Oe&&(u.Form=Oe);var fg=null==m.bk?null:m.bk.toString();null!=fg&&(u.Frame=fg);
var If=null==m.bl?null:m.bl.toString();null!=If&&(u.Frameset=If);var tf=null==m.bm?null:m.bm.toString();null!=tf&&(u.H=tf);var vf=null==m.bn?null:m.bn.toString();null!=vf&&(u.Head=vf);var $f=null==m.bo?null:m.bo.toString();null!=$f&&(u.Hr=$f);var vg=null==m.bp?null:m.bp.toString();null!=vg&&(u.Html=vg);var Kf=null==m.bq?null:m.bq.toString();null!=Kf&&(u.I=Kf);var Ph=null==m.br?null:m.br.toString();null!=Ph&&(u.Iframe=Ph);var ff=null==m.bs?null:m.bs.toString();null!=ff&&(u.Img=ff);var yc=null==m.bt?
null:m.bt.toString();null!=yc&&(u.Input=yc);var Rd=null==m.bu?null:m.bu.toString();null!=Rd&&(u.Ins=Rd);var de=null==m.bv?null:m.bv.toString();null!=de&&(u.Isindex=de);var Sb=null==m.bw?null:m.bw.toString();null!=Sb&&(u.Kbd=Sb);var nc=null==m.bx?null:m.bx.toString();null!=nc&&(u.Label=nc);var Tc=null==m.by?null:m.by.toString();null!=Tc&&(u.Legend=Tc);var td=null==m.bz?null:m.bz.toString();null!=td&&(u.Li=td);var je=null==m.ca?null:m.ca.toString();null!=je&&(u.Link=je);var se=null==m.cb?null:m.cb.toString();
null!=se&&(u.Map=se);var Ze=null==m.cc?null:m.cc.toString();null!=Ze&&(u.Math=Ze);var Xe=null==m.cd?null:m.cd.toString();null!=Xe&&(u.Menu=Xe);var ye=null==m.ce?null:m.ce.toString();null!=ye&&(u.Meta=ye);var Ei=null==m.cf?null:m.cf.toString();null!=Ei&&(u.Noframes=Ei);var Db=null==m.cg?null:m.cg.toString();null!=Db&&(u.Noscript=Db);var Vb=null==m.ch?null:m.ch.toString();null!=Vb&&(u.Object=Vb);var Sc=null==m.ci?null:m.ci.toString();null!=Sc&&(u.Ol=Sc);var bd=null==m.cj?null:m.cj.toString();null!=
bd&&(u.Optgroup=bd);var Ud=null==m.ck?null:m.ck.toString();null!=Ud&&(u.Option=Ud);var sf=null==m.cl?null:m.cl.toString();null!=sf&&(u.P=sf);var eg=null==m.cm?null:m.cm.toString();null!=eg&&(u.Param=eg);var Ug=null==m.cn?null:m.cn.toString();null!=Ug&&(u.Pre=Ug);var Lh=null==m.co?null:m.co.toString();null!=Lh&&(u.Q=Lh);var ah=null==m.cp?null:m.cp.toString();null!=ah&&(u.S=ah);var dh=null==m.cq?null:m.cq.toString();null!=dh&&(u.Samp=dh);var Hf=null==m.cr?null:m.cr.toString();null!=Hf&&(u.Script=Hf);
var Mf=null==m.cs?null:m.cs.toString();null!=Mf&&(u.Select=Mf);var Md=null==m.ct?null:m.ct.toString();null!=Md&&(u.Small=Md);var Sd=null==m.cu?null:m.cu.toString();null!=Sd&&(u.Span=Sd);var Pd=null==m.cv?null:m.cv.toString();null!=Pd&&(u.Strike=Pd);var Fk=null==m.cw?null:m.cw.toString();null!=Fk&&(u.Strong=Fk);var Vg=null==m.cx?null:m.cx.toString();null!=Vg&&(u.Style=Vg);var Lf=null==m.cy?null:m.cy.toString();null!=Lf&&(u.Sub=Lf);var kg=null==m.cz?null:m.cz.toString();null!=kg&&(u.Sup=kg);var Og=
null==m.da?null:m.da.toString();null!=Og&&(u.Tables=Og);var kh=null==m.db?null:m.db.toString();null!=kh&&(u.Tbody=kh);var ai=null==m.dc?null:m.dc.toString();null!=ai&&(u.Td=ai);var Bn=null==m.dd?null:m.dd.toString();null!=Bn&&(u.Textarea=Bn);var yh=null==m.de?null:m.de.toString();null!=yh&&(u.Tfoot=yh);var bi=null==m.df?null:m.df.toString();null!=bi&&(u.Th=bi);var qi=null==m.dg?null:m.dg.toString();null!=qi&&(u.Thead=qi);var ql=null==m.dh?null:m.dh.toString();null!=ql&&(u.Title=ql);var ci=null==m.di?
null:m.di.toString();null!=ci&&(u.Tr=ci);var Zk=null==m.dj?null:m.dj.toString();null!=Zk&&(u.Tt=Zk);var Wg=null==m.dk?null:m.dk.toString();null!=Wg&&(u.U=Wg);var Qh=null==m.dl?null:m.dl.toString();null!=Qh&&(u.Ul=Qh);var Fm=null==m.dm?null:m.dm.toString();null!=Fm&&(u.Var=Fm);var Pg=null==m.dn?null:m.dn.toString();null!=Pg&&(u.Unknown=Pg);break;case 6:z="List";var Xh=m.a;null!=Xh&&(u.SessionID=Xh);var fi=m.b.toString();null!=fi&&(u.MaxListLevel=fi)}u.Table=z;return Sys.Serialization.JavaScriptSerializer.serialize(u)};
c.d(L,"a",function(){return x});class x{static get Ina(){null==x.vtb&&(x.vtb=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return x.vtb}static get Dui(){null==x.NDe&&(x.NDe=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));return x.NDe}static D_(y){a.ULS.sendTraceTag(524038472,307,50,y)}static g6h(y){const m={};m.a=y;m.b=0;m.c=0;m.d=0;m.e=0;m.f=0;return m}static kYm(y){x.Ina||x.D_(k(0,y))}static B1h(y){const m=
{};m._sessionID=y;return m}static otf(y){const m={};m.a=y;m.b=0;m.c=0;return m}static V1m(y){x.Ina||x.D_(k(1,y))}static f6h(y,m){const u={};u.c=e.a[y];u.a=m;return u}static jYm(y,m){x.Dui&&y&&(y.b=m,x.D_(k(5,y)))}static aci(y){const m={};m.a=y;m.b=0;m.c=0;m.d=0;m.e=0;m.f=0;m.g=0;m.h=0;m.i=0;m.j=0;m.k=0;m.l=0;m.m=0;return m}static u0m(y){x.Ina||x.D_(k(3,y))}static bci(y){const m={};m.a=y;m.b=0;m.c=0;m.d=0;m.e=0;return m}static v0m(y){x.Ina||x.D_(k(4,y))}static $nf(y,m){const u={};u.b=e.a[y];u.c=m;
u.d=0;u.e=0;u.f=0;u.g=0;u.h=0;u.i=0;u.j=0;u.k=0;u.l=0;u.m=0;u.n=0;u.o=0;u.p=0;u.q=0;u.r=0;u.s=0;u.t=0;u.w=0;u.x=0;u.y=0;u.z=0;u.u=0;u.v=0;u.ba=0;u.bb=0;return u}static OXm(y,m){x.Dui&&y&&(y.a=m,x.D_(k(2,y)))}static lVl(y){const m={};m.a=y;m.b=-1;return m}static QYm(y){!x.Ina&&y&&0<=y.b&&x.D_(k(6,y))}}x.vtb=null;x.NDe=null;Object(D.a)(x,"UsageEditor",null,[])},1544:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(2),e=c(5);class a{static get Gob(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static xgb(k,
x=!1){const y=e.GraphIterator.$a(k);y.yd();return(x?y.Tb(4):y.ega(4))?4:e.GraphIterator.$a(k).Ab(36)?16:e.GraphIterator.$a(k).Ab(14)?2:e.GraphIterator.$a(k).Ab(38)?32:1}}Object(D.a)(a,"ConstructTypeHelper",null,[])},1559:function(D,L,c){c.d(L,"a",function(){return Pa});D=c(0);var l=c(21),e=c(59),a=c(138),k=c(2);L=c(72);var x=c(6),y=c(17),m=c(8),u=c(117),z=c(82),v=c(720),E=c(197),F=c(37),J=c(5),K=c(215),H=c(95),P=c(30),N=c(88),M=c(22),I=c(401),T=c(1501),U=c(235),W=c(276),V=c(718),Y=c(14),da=c(47),
ba=c(40),ja=c(131),sa=c(42),ta=c(292),ra=c(164),ma=c(576),Ba=c(48);class Pa{static get Qlm(){return Pa.h_j}static get Zlm(){return Pa.l_j}static get Xlm(){return Pa.k_j}static get Vg(){return null!=Pa.Wtg?Pa.Wtg:Pa.Wtg=U.ContextSetEditor.instance}static get tk(){return null!=Pa.aEg?Pa.aEg:Pa.aEg=l.a.instance.resolve("Box4.ITableEditor")}static get LC(){return null!=Pa.TDg?Pa.TDg:Pa.TDg=l.a.instance.Ma("Box4.Styles.ITableCellspacingReader")}static LBn(Da,Ha){const oa=Da.currentNode;M.forEachCell(Da,
Ha.rowSpan,Ha.colSpan,(wa,ia,ca)=>{const pa=wa.currentNode;pa!==oa&&(pa.gg=!0,Pa.iNh(wa),!ca&&1<=Ha.colSpan&&(pa.colSpan=Ha.colSpan),Pa.afj(wa,Ha.wia,ia,ca,Ha.rowSpan,Ha.colSpan))})}static sCn(Da,Ha){M.forEachCell(Da,Ha.rowSpan,Ha.colSpan,oa=>{Pa.wyk(oa);Pa.iNh(oa)})}static wyk(Da){Da=Da.currentNode;Da.gg=!0;Da.F3=!0;Da.Qnb=!0}static iNh(Da){Da&&(Da.Tb(1),Object(u.a)(v.a,Da.currentNode)&&Da.Dg())}static mzk(Da,Ha,oa){0<Ha&&(Da=Object(z.a)(E.TableCellNode,Da.currentNode))&&(Da.width=oa?Ha:e.a.Tl(Ha,
0))}static Axk(Da,Ha,oa){if(Da=Object(z.a)(I.TableNode,Da.currentNode))0<Ha&&(Da.ee=e.a.ny(Ha,0)),0<oa&&(Da.Cv=e.a.ny(oa,0))}static kzk(Da,Ha){void 0!==Ha&&null!==Ha&&Da.currentNode.properties.setValue(x.a.aqa,Pa.Zlm[Ha+""])}static vyk(Da,Ha){void 0!==Ha&&null!==Ha&&""!==Ha&&(Ha=parseInt(T.Box4PasteSteward.aAb(Ha),16),Da.currentNode.properties.setValue(y.a.eH,Ha))}static htk(Da){if(Da){if(m.ULS.sendTraceTag(520890260,3022,50,"Adjusting column width after paste."),Object(Ba.a)("AdjustingColumnWidthAfterPaste",
!0),16==Da.type){var Ha=new J.GraphIterator;Ha.set(Da);if(Ha.Ab(14)){var oa=N.a(Ha),wa=P.TableCellReader.dO(Da);if(Ha.fd(14)){Da=Ha.currentNode;var ia=F.TableReader.Lfa(Ha);if(ia){var ca=Array.clone(ia);Ha=F.TableReader.cPd(Ha);var pa=0,Ma=0;for(var ya=0;ya<ia.length;ya++)ya>=oa&&ya<oa+wa?Ha[ya]>ia[ya]&&(pa+=Ha[ya]-ia[ya],ca[ya]=Ha[ya]):Ma+=ia[ya]>Ha[ya]?ia[ya]-Ha[ya]:0;(null==Ma||0>=Ma||isNaN(Ma))&&m.ULS.sendTraceTag(521187336,3022,50,"spaceAvailableToShrink is invalid");(null==pa||0>=pa||isNaN(pa))&&
m.ULS.sendTraceTag(521187335,3022,50,"spaceToShrink is invalid");if(Ma<pa)for(oa=0;oa<ia.length;oa++)ca[oa]=Ha[oa];else for(ya=0;ya<ia.length;ya++)if((ya<oa||ya>=oa+wa)&&ia[ya]>Ha[ya]){const Oa=(ia[ya]-Ha[ya])/Ma;ca[ya]-=Oa*pa;(null==ca[ya]||0>=ca[ya]||isNaN(ca[ya]))&&m.ULS.sendTraceTag(521187334,3022,50,"Getting negative column width for scale {0}",Oa)}oa=ra.a.Ica+(Pa.LC?Pa.LC.ova(Da):0);for(ia=0;ia<ca.length;ia++)if(null==ca[ia]||0>=ca[ia]||isNaN(ca[ia]))m.ULS.sendTraceTag(521187333,3022,50,"Column width can not be negative."),
ca[ia]=e.a.Tl(oa,0);Da.JF=ca}else m.ULS.sendTraceTag(510253120,3022,50,"Column width should not be null")}}}}else m.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null")}static M$l(Da){var Ha=new J.GraphIterator;Ha.$c(Da);if((Da=K.OutlineNavigator.Y4f(Ha))&&H.OutlineReader.Kw(Ha)){Ha=Da.Lf(x.a.xo);const oa=Da.Lf(x.a.marginLeft);Da=Da.Lf(x.a.marginRight);return Ha-oa-Da}return 0}static IIm(Da){return!(void 0===Da||null===Da||1===Da)}static zhc(Da,Ha,oa,wa,ia){if(void 0===Ha||null===Ha||
""!==Ha){switch(Ha){case "thin":Ha=a.a.J8d(.25);break;case "initial":case "medium":Ha=a.a.J8d(.5);break;case "thick":Ha=a.a.J8d(1);break;default:Ha=Pa.A6l(Ha,oa,wa)}ia.currentNode.properties.setValue(Da,Ha)}}static yhc(Da,Ha,oa){void 0!==Ha&&null!==Ha&&Ha&&oa.currentNode.properties.setValue(Da,Pa.Xlm[Ha+""])}static c$n(Da,Ha,oa){void 0!==Ha&&null!==Ha&&""!==Ha&&(Ha=parseInt(T.Box4PasteSteward.aAb(Ha),16),oa.currentNode.properties.setValue(Da,Ha))}static A6l(Da,Ha,oa){let wa=0;const ia=({unit:Da}=
T.Box4PasteSteward.V7d(Da)).returnValue;switch(Da){case 5:wa=a.a.J8d(ia);break;case 1:wa=a.a.kNk(ia);break;case 3:wa=a.a.Gli(ia);break;case 7:wa=e.a.nwn(ia,oa)}if(6===Ha||7===Ha||10===Ha)wa/=3;return Math.round(wa)}static B6l(Da,Ha){let oa=0;const wa=({unit:Da}=T.Box4PasteSteward.V7d(Da)).returnValue;switch(Da){case 5:oa=a.a.jxa(wa);break;case 1:oa=a.a.i4e(wa);break;case 3:oa=a.a.Iva(wa);break;case 7:oa=e.a.Tl(wa,Ha)}return oa}static dee(Da,Ha,oa,wa,ia,ca,pa){if(ia&&(!pa||16===ia.Xe||pa||14!==ia.Xe)&&
12!==oa){if(pa)switch(wa){case 5:wa=x.a.$pa;var Ma=x.a.Xa;var ya=x.a.Wa;var Oa=0;break;case 4:wa=x.a.Zpa;Ma=x.a.tb;ya=x.a.rb;Oa=1;break;case 0:wa=x.a.Xpa;Ma=x.a.Va;ya=x.a.Ua;Oa=0;break;case 3:wa=x.a.Ypa;Ma=x.a.qb;ya=x.a.pb;Oa=1;break;default:return}else switch(wa){case 5:wa=x.a.GOb;Ma=x.a.xob;ya=x.a.Ijc;Oa=0;break;case 4:wa=x.a.FOb;Ma=x.a.wob;ya=x.a.Hjc;Oa=1;break;case 0:wa=x.a.DOb;Ma=x.a.uob;ya=x.a.Fjc;Oa=0;break;case 3:wa=x.a.EOb;Ma=x.a.vob;ya=x.a.Gjc;Oa=1;break;default:return}void 0!==ia.currentNode&&
null!==ia.currentNode&&(Pa.IIm(oa)?(Pa.c$n(wa,Da,ia),Pa.yhc(Ma,oa,ia),Pa.zhc(ya,Ha,oa,Oa,ia)):ca||pa||ia.currentNode.properties.setValue(Ma,"nil"))}}static afj(Da,Ha,oa,wa,ia,ca){wa||(Pa.hqh(Ha,Da,!1,!1),Pa.v_e(Ha,Da,!0,!1));wa===ca-1&&Pa.v_e(Ha,Da,!0,!1);oa||Pa.Jqh(Ha,Da,!0,!1);oa===ia-1&&Pa.Oph(Ha,Da,!0,!1)}static Nph(Da,Ha,oa,wa){Da&&(Pa.Jqh(Da,Ha,oa,wa),Pa.v_e(Da,Ha,oa,wa),Pa.Oph(Da,Ha,oa,wa),Pa.hqh(Da,Ha,oa,wa))}static Jqh(Da,Ha,oa,wa){Pa.dee(Da.borderTopColor,Da.borderTopWidth,Da.borderTopStyle,
5,Ha,oa,wa)}static v_e(Da,Ha,oa,wa){Pa.dee(Da.borderRightColor,Da.borderRightWidth,Da.borderRightStyle,4,Ha,oa,wa)}static Oph(Da,Ha,oa,wa){Pa.dee(Da.borderBottomColor,Da.borderBottomWidth,Da.borderBottomStyle,0,Ha,oa,wa)}static hqh(Da,Ha,oa,wa){Pa.dee(Da.borderLeftColor,Da.borderLeftWidth,Da.borderLeftStyle,3,Ha,oa,wa)}static eee(Da,Ha,oa){if(oa&&16===oa.Xe&&""!==Da){switch(Ha){case 3:Ha=x.a.DHa;var wa=0;break;case 2:Ha=x.a.qR;wa=1;break;case 0:Ha=x.a.BHa;wa=0;break;case 1:Ha=x.a.TO;wa=1;break;default:return}(Da=
Pa.B6l(Da,wa))&&oa.currentNode.properties.setValue(Ha,Da)}}static Ywk(Da,Ha){Ha&&(Pa.dzk(Ha,Da),Pa.oyk(Ha,Da),Pa.exk(Ha,Da),Pa.Lxk(Ha,Da))}static dzk(Da,Ha){Pa.eee(Da.eNk,3,Ha)}static oyk(Da,Ha){Pa.eee(Da.dNk,2,Ha)}static exk(Da,Ha){Pa.eee(Da.bNk,0,Ha)}static Lxk(Da,Ha){Pa.eee(Da.cNk,1,Ha)}static jxk(Da,Ha,oa,wa){var ia=0;const ca=Array(Da.length);var pa=0;wa&&(pa=(pa=a.a.R9c(Pa.M$l(Ha)))?pa:1);for(wa=0;wa<Da.length;wa++)ca[wa]=0<pa?pa/100*Da[wa]:e.a.Tl(Da[wa],0),ia+=ca[wa];Da=oa.getValue(y.a.lz);
wa=new J.GraphIterator;wa.$c(Ha);Ha=0;if(P.TableCellReader.t_(wa)){if(Da=M.returnToContainingCell(wa))Ha=Da.width;pa=N.a(wa);wa=M.returnToContainingTable(wa);if(-1!==pa&&pa<=wa.JF.length){let Ma=0;for(let ya=pa;ya<pa+Da.colSpan&&ya<wa.JF.length;ya++)Ma+=wa.JF[ya];Ha=Math.min(Ha,Ma);Ha===Ma&&(Ha-=e.a.Tl(Pa.C$m,0))}}else if(Da)for(pa=0;pa<Da.length;pa++)Ha+=Da[pa];if(0<Ha&&ia>Ha&&ia)for(ia=Ha/ia,Ha=0;Ha<ca.length;Ha++)ca[Ha]*=ia;oa.setValue(y.a.lz,ca)}static pyk(Da,Ha){Da.currentNode.setValue(x.a.v0,
e.a.Tl(Ha,1))}static Qfo(Da){var Ha,oa;m.ULS.sendTraceTag(520890259,3022,50,"Setting selection info and bound");Object(Ba.a)("SettingTableSelectionBounds",!0);var wa=Da.hb,ia=Da.pg;Da=Pa.Vg.lQ(ia,16);if(ia=Pa.Vg.MS(ia,14))if(ia=ia.node,!ia||14!==ia.type)m.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!Da)m.ULS.sendTraceTag(537507991,306,15,"Cell context must be present");else{if(!((null===(oa=null===(Ha=null===wa||void 0===wa?void 0:wa.lb)||void 0===Ha?void 0:Ha.Pe)||void 0===
oa?0:oa.Qa)&&wa.lb.Pe.Qa.contextId===Y.a.t0&&W.TableBorderSelectionCache.GOa()&&0<W.TableBorderSelectionCache.GOa().length)){W.TableBorderSelectionCache.cRc(ia);Ha=W.TableBorderSelectionCache.b9;Ha.leftMostColumnSelected=Number.MAX_SAFE_INTEGER;Ha.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;Ha.topMostRowSelected=Number.MAX_SAFE_INTEGER;Ha.bottomMostRowSelected=Number.MIN_SAFE_INTEGER;for(oa=0;oa<Da.length;oa++){if(Da.getContext(oa).contextId!==Y.a.tableCell)return;wa=Da.getContext(oa).node;if(!P.TableCellReader.Er(wa)){var ca=
new J.GraphIterator;ca.set(wa);if(ca.Ab(14)&&M.getContainingTable(ca)===ia){ca.fd(14);ca=P.TableCellReader.CDa(ca,wa);if(!ca)return;Array.add(W.TableBorderSelectionCache.GOa(),new V.a(wa,ca.rowIndex,ca.so,wa.rowSpan,wa.colSpan));Ha.leftMostColumnSelected=Math.min(Ha.leftMostColumnSelected,ca.so);Ha.rightMostColumnSelected=Math.max(Ha.rightMostColumnSelected,ca.so);Ha.topMostRowSelected=Math.min(Ha.topMostRowSelected,ca.rowIndex);Ha.bottomMostRowSelected=Math.max(Ha.bottomMostRowSelected,ca.rowIndex)}}}W.TableBorderSelectionCache.b9=
Ha}}else m.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static Daj(Da){var Ha;if(Da&&14===Da.type){m.ULS.sendTraceTag(520890258,3022,50,"Scaling Column Width");Object(Ba.a)("ScalingColumnWidthForCCP",!0);var oa=new J.GraphIterator;oa.set(Da);if(oa.yd()&&F.TableReader.Jw(oa)){var wa=Da.JF,ia=F.TableReader.cPd(oa),ca=M.returnToContainingCell(oa),pa=M.getContainingTable(oa);if(ca&&pa){var Ma=N.a(oa),ya=P.TableCellReader.dO(ca);if(oa.fd(14)){var Oa=F.TableReader.Lfa(oa);oa=0;for(let fa=
Ma;fa<Ma+ya;fa++)oa+=Oa[fa];Ma=ra.a.hM(ca,pa,x.a.TO,x.a.za,0);ca=ra.a.hM(ca,pa,x.a.qR,x.a.Aa,0);oa-=e.a.Tl(Ma+ca,0);(null==oa||0>=oa||isNaN(oa))&&m.ULS.sendTraceTag(521187332,3022,50,"Containing cell width is invalid for cell margins {0} & {1}",Ma,ca);ca=0;for(pa=0;pa<wa.length;pa++)ca+=wa[pa];pa=oa/ca;(null==pa||0>=pa||isNaN(pa))&&m.ULS.sendTraceTag(521187331,3022,50,"scale is invalid");Ma=0;for(ya=0;ya<wa.length;ya++)Oa=wa[ya],wa[ya]*=pa,wa[ya]<ia[ya]&&(wa[ya]=ia[ya],1>pa&&(null===(Ha=k.AFrameworkApplication.K)||
void 0===Ha?0:Ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1))&&(pa=(oa-ia[ya])/(ca-Oa))),Ma+=wa[ya];Ma>oa&&(wa=Array.clone(ia));Ha=ra.a.Ica+(Pa.LC?Pa.LC.ova(Da):0);for(ia=0;ia<wa.length;ia++)if(null==wa[ia]||0>=wa[ia]||isNaN(wa[ia]))m.ULS.sendTraceTag(521187330,3022,50,"Column width is invalid for inner table"),wa[ia]=e.a.Tl(Ha,0);Ha=new da.GraphTransaction(4);Ha.Eb(Da);Da.JF=wa;Ha.dispose()}}}else m.ULS.sendTraceTag(512291460,3022,50,"Table is not a nested table.")}else m.ULS.sendTraceTag(524932511,
3022,15,"Table node should not be null")}static RXn(Da){if(!Da||!F.TableReader.eEf(Da)||1!=Da.pq())return m.ULS.sendTraceTag(525361986,3022,50,"Outline iterator should contain a single table"),null;m.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");Object(Ba.a)("ReplaceTableContentForExternalPaste",!0);let Ha=new J.GraphIterator;Ha.set(Da.currentNode);Ha.Ab(14);ba.OutlineElementNavigator.Fe(Ha);const oa=new J.GraphIterator;oa.set(Da.currentNode);oa.Ab(14);if(!oa.fd(14)||!Ha||
14!=Ha.currentNode.type)return null;if(Da=M.getContainingTableCell(Ha))if(Da=P.TableCellReader.CDa(oa,Da)){if(W.TableBorderSelectionCache.QOc())var wa=this.Q4l();else{wa=F.TableReader.ag(Ha.currentNode)-(F.TableReader.ag(oa.currentNode)-Da.rowIndex);var ia=F.TableReader.Xg(Ha.currentNode)-(F.TableReader.Xg(oa.currentNode)-Da.so);this.Mnk(oa,wa,ia);wa=new ta.a(Da.so,F.TableReader.Xg(oa.currentNode)-1,Da.rowIndex,F.TableReader.ag(oa.currentNode)-1)}if(!wa)return null;ia=wa.bottomMostRowSelected-wa.topMostRowSelected+
1;var ca=wa.rightMostColumnSelected-wa.leftMostColumnSelected+1;ia=Math.min(ia,F.TableReader.ag(Ha.currentNode));ca=Math.min(ca,F.TableReader.Xg(Ha.currentNode));for(let pa=0;pa<ia;pa++){M.moveToCell(oa,pa+wa.topMostRowSelected,wa.leftMostColumnSelected);M.moveToCell(Ha,pa,0);for(let Ma=0;Ma<ca;Ma++)pa==Da.rowIndex-wa.topMostRowSelected&&Ma==Da.so-wa.leftMostColumnSelected||this.VIi(Ha,oa),M.moveToNextColumn(oa),M.moveToNextColumn(Ha);oa.rt(14);Ha.rt(14)}M.moveToCell(oa,Da.rowIndex,Da.so);Da.rowIndex-
wa.topMostRowSelected<F.TableReader.ag(Ha.currentNode)&&Da.so-wa.leftMostColumnSelected<F.TableReader.Xg(Ha.currentNode)?M.moveToCell(Ha,Da.rowIndex-wa.topMostRowSelected,Da.so-wa.leftMostColumnSelected):Ha=null;this.VIi(Ha,oa);oa.rt(14);M.moveToCell(oa,wa.topMostRowSelected,wa.leftMostColumnSelected);oa.Sd();return oa.currentNode}}static Kun(Da){if(Da&&F.TableReader.eEf(Da)&&1==Da.pq()){m.ULS.sendTraceTag(520890257,3022,50,"Pasting table below table");Object(Ba.a)("PasteTableBelowTable",!0);var Ha=
new J.GraphIterator;Ha.set(Da.currentNode);Da=ja.a.$a(Da.currentNode);Ha.Yo()&&Da.Yo()&&(ba.OutlineElementNavigator.N_(Da,!1,!0),sa.OutlineElementReader.Lh(Da)&&1==Da.pq()&&(ba.OutlineElementNavigator.Fe(Ha),ba.OutlineElementNavigator.Fe(Da),Ha&&Da&&Ha.currentNode!=Da.currentNode&&F.TableReader.isTable(Ha)&&F.TableReader.isTable(Da)&&this.p7m(Ha,Da)&&(m.ULS.sendTraceTag(525361989,3022,50,"Pasting table below table"),Ha.Dg(),Ha.Dg())))}else m.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static VIi(Da,
Ha){if(Ha&&P.TableCellReader.isTableCell(Ha)){var oa=Ha.pq();if(Da&&P.TableCellReader.isTableCell(Da)&&Da.dA())for(;Da.dA();)Da.Sd(),Ha.Qf(Da.currentNode,Da.role),Da.Dg();else oa--;for(;0<oa--;)Ha.Sd(),Ha.Dg()}}static p7m(Da,Ha){if(!F.TableReader.isTable(Da)||!F.TableReader.isTable(Ha))return!1;var oa=F.TableReader.Xg(Da.currentNode),wa=F.TableReader.Xg(Ha.currentNode);if(oa!=wa)return m.ULS.sendTraceTag(525361990,3022,50,"Number of columns in source and target table should be same"),!1;oa=F.TableReader.ag(Da.currentNode);
wa=F.TableReader.ag(Ha.currentNode);const ia=new da.GraphTransaction(4);ia.Eb(Ha.currentNode);Ha.currentNode.setValue(y.a.oya,oa+wa);for(ia.dispose();Da.dA();){Da.Sd();Ha.Qf(Da.currentNode,1);oa=new J.GraphIterator;oa.set(Da.currentNode);Da.Dg();oa.Sd();do oa.currentNode&&16==oa.currentNode.type&&(oa.currentNode.sE=Ha.currentNode);while(oa.gt())}return!0}static Mnk(Da,Ha,oa){m.ULS.sendTraceTag(512291459,307,50,"Adding rows and columns for content replace in CCP.");Object(Ba.a)("AddRowAndColumnForExternalCCP",
!0);Pa.Vza=ma.a.O6b;0<Ha&&(M.moveToLastRow(Da),m.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+Ha),this.tk.insertRows(Da,!1,Ha,this.Vza),m.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),Da.fd(14));0<oa&&(m.ULS.sendTraceTag(523896320,307,50,"Begin insert columns: "+oa),this.tk.insertColumns(Da,F.TableReader.Xg(Da.currentNode),!1,oa,this.Vza),m.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static Q4l(){return W.TableBorderSelectionCache?W.TableBorderSelectionCache.b9:
null}}Pa.C$m=8;Pa.Ran="Normal Table";Pa.RLh="Table Grid";Pa.Vza=null;Pa.h_j=L.a.N4("MsoNormalTable","Normal Table","MsoTableGrid",Pa.RLh,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2",
"MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5",
"MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2",
"MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5",
"MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6",
"MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1",
"List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3",
"MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4",
"MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3",
"MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5",
"List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6",
"List Table 7 Colorful Accent 6");Pa.l_j=L.a.N4("0","center","1","top","2","center","3","bottom");Pa.k_j=L.a.N4("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(D.a)(Pa,"Box4TableStewardHelper",null,[])},1563:function(D,L,c){c.d(L,"a",function(){return U});D=c(0);var l=c(76),e=c(133),a=c(21),k=c(171),x=c(2),y=c(200),m=c(6),u=c(96),z=c(64),v=c(11),E=c(47),F=c(603),J=c(235),K=c(249),H=c(10),P=
c(265),N=c(20),M=c(14),I=c(304),T=c(3);class U{static get Vg(){return J.ContextSetEditor.instance}static get Zf(){return K.a.instance}static get Jc(){return e.a.instance}static Gw(){return U.Rm||(U.Rm=a.a.instance.Sa("Box4.IExternalSelectionManager"))}static get sA(){return null!=U.aCg?U.aCg:U.aCg=a.a.instance.resolve("Box4.IParagraphIndentationReader")}static h9l(){this.rN||(this.rN=new l.a,this.rN.add(T.a.wA),this.rN.add(T.a.font),this.rN.add(T.a.pY),this.rN.add(T.a.wta),this.rN.add(T.a.bold),this.rN.add(T.a.setItalic),
this.rN.add(T.a.superscript),this.rN.add(T.a.subscript),this.rN.add(T.a.WYa),this.rN.add(T.a.uta),this.rN.add(T.a.fCa),this.rN.add(T.a.l4e),this.rN.add(T.a.gCa),this.rN.add(T.a.VYa),this.rN.add(T.a.e_),this.rN.add(T.a.o0),this.rN.add(T.a.clearFormatting),this.rN.add(T.a.Mdb),this.rN.add(T.a.jFc));return this.rN}static R9b(W){return U.h9l().contains(W)?!0:!1}static Mv(W,V,Y,da,ba){var ja=!0;if(!V.view.re)return 2;var sa=V.view,ta=sa.nb;ta&&ta.hb.lb||(U.Jc.Zb(u.a.kf,{["Reason"]:z.a.noSelection}),ja=
!1);U.Vg.zCa(N.ImageReader.XSc,sa.nb.pg)&&(U.Jc.Zb(u.a.kf,{["Reason"]:z.a.u7e}),ja=!1);if(U.Vg.zCa(N.ImageReader.N1a,sa.nb.pg))return U.Jc.Zb(u.a.kf,{["Reason"]:z.a.iGc}),8;var ra=!U.R9b(W);U.Zf.W9b(sa.nb.pg,ra)&&(U.Jc.Zb(u.a.kf,{["Reason"]:z.a.tE}),ja=!1);U.Vg.zCa(N.ImageReader.SWd,sa.nb.pg)&&(U.Jc.Zb(u.a.kf,{["Reason"]:z.a.p7e}),ja=!1);U.Vg.zCa(I.c,sa.nb.pg)&&(U.Jc.Zb(u.a.kf,{["Reason"]:z.a.q7e}),ja=!1);U.Vg.zCa(P.a.OAf,sa.nb.pg)&&(U.Jc.Zb(u.a.kf,{["Reason"]:z.a.o7e}),ja=!1);U.Vg.Oya(H.ParagraphReader.ZT,
sa.nb.pg)&&(U.Jc.Zb(u.a.kf,{["Reason"]:z.a.IN}),ja=!1);U.Gw()&&U.Gw().instance&&U.Gw().instance.aU(sa.nb.pg)&&(U.Jc.Zb(u.a.kf,{["Reason"]:z.a.externalSelection}),ja=!1);var ma=null;ta&&ta.hb.lb&&(ma=ta.hb.lb);if(1===Y||!ja||!ma)return ja?32:8;ja=W===T.a.zbc||W===T.a.t1b||W===T.a.Fgc||W===T.a.G5b;sa=W===T.a.SKb||W===T.a.ZAb||W===T.a.Zfc;ra=W===T.a.xSa||W===T.a.ySa||W===T.a.KC;const Ba=new E.GraphTransaction(15);Ba.Eb(ma.Qa.node);ma=new l.a;let Pa=!1;if(ja||sa||ra)k.a.mark(7121),V=U.Vg.EZh(V.Yj);else{k.a.mark(7119);
V=F.OutlineElementGeneralizer.xma(ta.hb,!0);if(!V)return U.Jc.Zb(u.a.oma,{["Reason"]:z.a.ZJd}),Ba.dispose(),8;ta=W===T.a.v1a||W===T.a.Zhb;V.Hw&&ta&&(Pa=U.xim(ma,V))}(W===T.a.leftJustify||W===T.a.zbc||W===T.a.centerJustify||W===T.a.t1b||W===T.a.rightJustify||W===T.a.Fgc||W===T.a.fullJustify||W===T.a.G5b)&&V.Hw&&1<V.length&&U.yim(V)&&(ba||(ba={}),Object.getType(ba)===Object&&(ba.InContextSet=!0));x.AFrameworkApplication.xa.Nf(V,W,Y,!0,da,ba);Pa&&U.Yan(ma,V,ba);Ba.dispose();v.App.ya.updateCommandUI();
ja||sa||ra?k.a.mark(7122):k.a.mark(7120);return 32}static xim(W,V){if(!V.Hw)return!1;let Y=!1,da=!1;for(let ja=0;ja<V.length;ja++)if(V.getContext(ja).Xk){var ba=V.getContext(ja).node;ba&&(ba=U.sA.Mgb(ba),2===ba.specialIndentType?(Y=!0,W.add(ja)):1!==ba.specialIndentType&&ba.specialIndentType||(da=!0))}return da&&Y}static Yan(W,V,Y){if(V.Hw)for(let ba=0;ba<W.count;ba++){var da=V.getContext(W.J(ba));if(!da.Xk)continue;da=da.node;const ja=U.sA.Mgb(da);2!==ja.specialIndentType||y.a.Vva(Y.value,ja.iB)||
da.setValue(m.a.ee,ja.iB-ja.Cca)}}static Q$f(W,V){let Y=!0;V.contextId!==M.a.paragraph?Y=!1:U.Zf.y2a(V)?(U.Jc.Zb(u.a.Ym,{["Reason"]:z.a.tE}),Y=!1):U.Gw()&&U.Gw().instance&&U.Gw().instance.aU(V)?(U.Jc.Zb(u.a.Ym,{["Reason"]:z.a.externalSelection}),Y=!1):V.Xk&&(V=V.node,H.ParagraphReader.Yb(V)&&V.UP&&(U.Jc.Zb(u.a.Ym,{["Reason"]:z.a.IN}),Y=!1));return{returnValue:1!==W&&Y,Qx:Y?32:8}}static yim(W){if(!W.Hw)return!1;let V=1;for(let da=0;da<W.length;da++){var Y=W.getContext(da);if(Y&&Y.Xk&&Y.contextId===
M.a.paragraph&&(Y=Y.node))if(Y=H.ParagraphReader.Uv(Y),!da)V=Y;else if(Y!==V)return!0}return!1}}U.Rm=null;U.rN=null;Object(D.a)(U,"FormattingActionHelper",null,[])},1565:function(D,L,c){c.d(L,"a",function(){return e});c.d(L,"b",function(){return a});var l=c(2);const e=k=>{switch(k){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;
case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var k;return null===(k=l.AFrameworkApplication.K)||void 0===k?void 0:k.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1576:function(D,L,c){c.r(L);D=c(0);var l=c(2),e=c(107),a=c(21),k=c(59),x=c(381),y=c(47),m=c(5);class u{rbf(qa,Ga,Fb){return 1===Fb?32:u.ycl(Ga.node)}static ycl(qa){const Ga=new m.GraphIterator;Ga.set(qa);Ga.Yo();qa=new y.GraphTransaction(7);qa.Fu(Ga);Ga.Dg();
qa.dispose();return 32}}Object(D.a)(u,"DeleteOutlineLevelContentStrategy",null,[]);var z=c(108),v=c(169),E=c(63),F=c(235),J=c(19),K=c(24),H=c(10),P=c(111),N=c(40),M=c(215),I=c(95),T=c(31);class U{constructor(qa){this.Dm=null;this.Nka=qa}get Eyb(){return null!=this.Jsg?this.Jsg:this.Jsg=a.a.instance.Ma("Box4.IAutoCorrectRules")}get zW(){return null!=this.Lsg?this.Lsg:this.Lsg=a.a.instance.Ma("Box4.IAutoCorrectScheduler")}get xM(){return null!=this.FBg?this.FBg:this.FBg=a.a.instance.Ma("Box4.Pages.IPageContentEditor")}get QK(){return null!=
this.cBg?this.cBg:this.cBg=a.a.instance.Ma("Box4.IOutlineEditor")}get Ug(){return this.Dm||(this.Dm=this.Nka())}kBi(qa,Ga,Fb){if(this.QK&&U.oq){var $b=F.ContextSetEditor.Uof(Ga);qa=$b.node;J.SelectionEditor.Dk($b)&&($b=T.a.Tc(qa,H.ParagraphReader.textLength(qa)));var rb=P.FormattingReader.language(P.FormattingReader.Ar($b));$b=m.GraphIterator.$a(Fb.Zc);U.eh.U3c($b);var xb=qa=null;if($b)for(let gb=$b.Tb(1);gb&&!xb;gb=$b.Ti(1))I.OutlineReader.gwa(gb)&&(xb=gb);if($b&&!xb){if(!this.xM||!this.QK)return;
qa=new y.GraphTransaction(7);qa.Fu($b);xb=this.xM.AFd($b);this.QK.I6($b,!0);rb&&(N.OutlineElementNavigator.Fe($b),$b=T.a.Tc($b.currentNode,0),U.oq.Ree(P.FormattingReader.Ar($b),rb))}rb=K.SelectionFactory.Yn(xb,!0);Fb.nb.setSelection(rb);J.SelectionEditor.jf(Ga)&&(Fb=m.GraphIterator.$a(Ga.node),Fb.Yo(),M.OutlineNavigator.Y4f(Fb),this.Eyb&&this.zW&&I.OutlineReader.jA(Fb,Ga,!0)&&(Ga=this.Eyb.Nhf(Ga,-1,!1,E.a.iw))&&this.zW.Qaj(Ga));this.Ug&&this.Ug.QE();qa&&qa.dispose()}}static get oq(){return null!=
U.Hwg?U.Hwg:U.Hwg=a.a.instance.Ma("Box4.IFormattingEditor")}static get instance(){return null!=U.ozg?U.ozg:U.ozg=U.Sl()}static Sl(){return new U(()=>a.a.instance.Ma("Box4.IUndoManager"))}static get eh(){return v.PageNavigator.instance}}Object(D.a)(U,"TitleViewEditor",null,[]);var W=c(52),V=c(444),Y=c(653),da=c(22),ba=c(14),ja=c(304),sa=c(3);class ta{constructor(){this.NUj=new u;this.rbf=(qa,Ga,Fb,$b,rb)=>this.NUj.rbf(qa,Ga,Fb,$b,rb)}Ub(qa){const Ga=this.LMh.Bbf.bind(this.LMh),Fb=this.rbf,$b=this.BMh.Dcl.bind(this.BMh);
this.Z0f(qa,Ga,Fb,$b);qa.pa(sa.a.backspace,ba.a.Vc,$b);qa.pa(sa.a.backspace,ba.a.Fd,$b);qa.pa(sa.a.backspace,ba.a.endOfParagraph,e.ActionManager.eQ);qa.pa(sa.a.backspace,ba.a.outline,Fb);qa.pa(sa.a.backspace,ba.a.view,Ga);qa.Uc(sa.a.backspace,1124);qa.pa(sa.a.iua,ba.a.Vc,e.ActionManager.eQ);qa.pa(sa.a.iua,ba.a.Fd,$b);qa.pa(sa.a.iua,ba.a.endOfParagraph,e.ActionManager.eQ);qa.pa(sa.a.iua,ba.a.outline,Fb);qa.pa(sa.a.iua,ba.a.view,Ga);qa.gb(sa.a.XFd,ba.a.view,Ga,1124);qa.pa(sa.a.kH,ba.a.Vc,$b);qa.pa(sa.a.kH,
ba.a.Fd,$b);qa.pa(sa.a.kH,ba.a.endOfParagraph,e.ActionManager.eQ);qa.pa(sa.a.kH,ba.a.outline,Fb);qa.pa(sa.a.kH,ba.a.view,Ga);qa.Uc(sa.a.kH,1124);qa.gb(sa.a.N$e,ba.a.view,Ga,1124);qa.gb(sa.a.Ula,ba.a.view,ta.Ula,1028)}Z0f(){}static get eh(){return v.PageNavigator.instance}static get vg(){return null!=ta.fBg?ta.fBg:ta.fBg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get xM(){return null!=ta.CBg?ta.CBg:ta.CBg=a.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get QK(){return null!=
ta.bBg?ta.bBg:ta.bBg=a.a.instance.resolve("Box4.IOutlineEditor")}static get Xb(){return null!=ta.Ovg?ta.Ovg:ta.Ovg=a.a.instance.Ma("Box4.IFeatureHelper")}static Ula(qa,Ga,Fb,$b,rb){$b=Ga.view;if(!$b.nb||!$b.nb.hb.lb||J.SelectionEditor.hm($b.nb.hb.lb))return 8;if(1===Fb)return 32;Fb=$b.nb.hb;const xb=Fb.lb;var gb=xb.Qa,Gb=null,ac=!1;if(Fb.YI){if(gb.contextId===ba.a.outline&&1===Fb.length){for(qa=m.GraphIterator.$a(gb.node);qa.Sd();)qa.Dg();ta.QK.I6(qa,!0);N.OutlineElementNavigator.Fe(qa);qa=K.SelectionFactory.te(qa.currentNode,
0);$b.nb.setSelection(qa);return 32}var hc=gb.node;Gb=null;if(ja.c(gb)){var Ec=hc.Ee($b.jc);Ec&&(Ec=Ec.Odp)&&0<=Ec.width&&0<=Ec.height&&(Gb=new V.a(k.a.Tl(Ec.x,0),k.a.Tl(Ec.y,1)));Gb||(Gb=Y.a(hc))}else Gb=Y.a(gb.node);gb=m.GraphIterator.$a(gb.node);gb.Yo();ta.eh.U3c(gb);hc=ta.xM.AFd(gb);Y.b(hc,Gb.x,Gb.y);ta.QK.I6(gb,!0);Gb=K.SelectionFactory.Yn(hc,!0)}else if(1===Fb.length){ac=Fb.last;gb=W.a.mAb(ac);if(ta.Xb&&ta.Xb.isFeatureEnabled(23)&&F.ContextSetEditor.instance.Lbg(gb).returnValue)return 2;ac=
ac.Rc;ac=!Fb.Lw&&(J.SelectionEditor.Dk(ac)||H.ParagraphReader.im(ac)||J.SelectionEditor.d8(ac))}ac&&(ac=J.SelectionEditor.Bj(xb,!1,!1,void 0,!1),$b.nb.setSelection(ac),l.AFrameworkApplication.xa.Nf(Ga,sa.a.newLine,2,!1,null,rb),Gb=$b.nb.hb.lb,$b.nb.setSelection(xb));rb||(rb=new x.DictionaryPropertySet);rb.setValue(z.a.LIc,!0);l.AFrameworkApplication.xa.Nf(Ga,sa.a.kH,2,!0,null,rb);if(Gb&&Gb.Qa.isValid)return $b.nb.setSelection(Gb),32;Fb.YI&&U.instance.kBi(qa,Ga.Yj,$b);J.SelectionEditor.hm($b.nb.hb.lb)||
l.AFrameworkApplication.xa.Nf(Ga,sa.a.newLine,2,!1,null,rb);return 32}static xcl(qa,Ga){if(1===Ga)return 32;Ga=new y.GraphTransaction(7);Ga.Eb(qa);ta.vg.GGa(qa);Ga.dispose();return 32}}Object(D.a)(ta,"ADeleteActor",null,[]);var ra=c(11),ma=c(249),Ba=c(275),Pa=c(1497),Da=c(60),Ha=c(16),oa=c(117),wa=c(82),ia=c(123),ca=c(703),pa=c(55);class Ma{get Zf(){return ma.a.instance}Dcl(qa,Ga,Fb,$b,rb){$b=null===rb||void 0===rb?void 0:rb.R$c;if(1===Fb)return 32;var xb=qa===sa.a.backspace;if(this.Zf.kh){if(this.Zf.rti(Ga)&&
Ma.Mta&&(Fb=Ga.clone(),Fb.Sb+=1,--Fb.Fb,this.Zf.Cac(Fb)))return Ma.Mta.v3i([Fb]),32;if(this.Zf.UBf(Ga,xb))return 2}if(Ma.Gw()&&Ma.Gw().instance&&Ma.Gw().instance.aU(Ga))return 4;var gb=Ga.node;let Gb=Ga.cpBegin;Fb=Ga.cpEnd;let ac=Ga.Fb,hc=Ga.Sb;const Ec=H.ParagraphReader.text(gb),Uc=Ec.length;let dd=!1;if(Gb===Fb){if(xb&&!Gb||!xb&&Gb===Uc)return 2;xb?({cp:Gb,returnValue:dd}=this.Zf.TIi(gb,Gb),dd||({cp:Gb,qla:ac,returnValue:dd}=this.Zf.SIi(Ga,Gb,ac)),dd||(Gb--,Ha.a.Yy(Ec,Gb)&&Gb--),qa=sa.a.K0e):({cp:Fb,
returnValue:dd}=this.Zf.q9m(gb,Fb),dd||({cp:Fb,qla:hc,returnValue:dd}=this.Zf.p9m(Ga,Fb,hc)),dd||(Fb++,Ha.a.Yy(Ec,Fb)&&Fb++),qa=sa.a.lMh)}Ga=Gb===Fb?T.a.Tc(gb,Gb):T.a.createTextRange(gb,Gb,Fb);dd&&this.Zf.kh&&(xb?Ga.Fb=ac:Ga.Sb=hc);if(!this.Zf.Cac(Ga))return 2;this.LZb(gb);xb=new y.GraphTransaction(15);xb.kk=qa;xb.Eb(gb);gb=Object(oa.a)(ca.a,rb)&&rb.N_a;if(!Ma.Kd.Cg||gb||pa.a.fr&&Ma.dCa.FYd(W.a.instance.hb.lb))this.CMh(Ga,$b);else{gb=Ma.Kd.DYa();try{const fd=Ma.yh.t7c(Ga);let xc;if(({type:xc}=fd.jRd()).returnValue){const $c=
Object(wa.a)(114,rb);$c&&$c.ia(ia.a.aAf,!1)||!pa.a.fr&&4===xc?Ma.Kd.q4a=xc:Ma.Kd.Bs(xc)}rb=0;for(let $c=fd.length-1;0<=$c;--$c){let Bc;const Vd=({hZd:Bc}=fd.getContext($c)).returnValue;Bc?(Ma.hyperlinkEditor.Ikb(Vd,null),rb+=Ma.lj.Bnb(Vd,2),Ma.lj.$Ed=Fb+rb):this.CMh(Vd,$b)}}finally{gb&&gb.dispose()}}xb.dispose();return 32}LZb(){}static get Kd(){return null!=Ma.UEg?Ma.UEg:Ma.UEg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get lj(){return null!=Ma.FEg?Ma.FEg:
Ma.FEg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get yh(){return null!=Ma.pFg?Ma.pFg:Ma.pFg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get hyperlinkEditor(){return null!=Ma.rxg?Ma.rxg:Ma.rxg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static Gw(){return Ma.Rm||(Ma.Rm=a.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Mta(){Ma.wsb||(Ma.wsb=a.a.instance.Sa("Box4.ContentControl.IContentControlOperator"));return Ma.wsb.instance}static get dCa(){return null!=
Ma.Xsg?Ma.Xsg:Ma.Xsg=a.a.instance.resolve("Box4.IContentControlViewElementManager")}}Ma.Rm=null;Ma.wsb=null;Object(D.a)(Ma,"ADeleteParagraphContentStrategy",null,[]);var ya=c(190),Oa=c(807),fa=c(335),Ca=c(240),Ta=c(91),eb=c(76),jb=c(80);class ob extends Ma{constructor(){super()}get characterPropertiesEditor(){return null!=this.dtg?this.dtg:this.dtg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Iq(){return null!=this.Usg?this.Usg:this.Usg=a.a.instance.Sa("Box4.ContentControlConfigSettings")}get Ecc(){return null!=
this.OAg?this.OAg:this.OAg=a.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get N2(){return null!=this.Btg?this.Btg:this.Btg=a.a.instance.resolve("Box4.IContentControlChpHelper")}get C_a(){return null!=this.awg?this.awg:this.awg=a.a.instance.resolve("Box4.IFieldEditor")}CMh(qa,Ga){this.Qbl(qa,Ga)}wtk(qa,Ga,Fb,$b){this.Iq.instance&&this.Iq.instance.kh&&(qa.cpBegin===Ga.cpBegin?qa.Fb=Ga.Fb:Fb&&(qa.Fb=Fb.Jb&&Fb.Jb.length?0:-1),qa.Sb=$b)}LZb(qa){const {DeleteActor:Ga}=c(1576);Ga.LZb(qa)}Qbl(qa,
Ga){var Fb=qa.node;const $b=Ca.b([new ya.a(qa.cpBegin,qa.cpEnd)],this.p$l(qa));var rb=new jb.a,xb=[];ob.QTk(Fb,$b,rb,xb);for(const gb of rb.keys)1<rb.J(gb)&&Oa.a.nMi(Da.a.Gf(gb));this.BSn(Fb,xb);this.Ecc.lFc(Fb);Fb=qa.Sb;rb=!!this.Iq.instance&&this.Iq.instance.kh;for(xb=$b.length-1;0<=xb;xb--)Fb=this.deleteRange(qa,$b[xb],Fb,rb,Ga)}p$l(qa){const Ga=[],Fb=qa.node;var $b=Ta.f(Fb,gb=>gb.pla);for(var rb of $b)$b=rb.Kb.cp,Ga.push(new ya.a($b,$b+1));rb=[];fa.a.Lfb?this.C_a&&(rb=this.C_a.Fnf(Fb,qa)):rb=
H.ParagraphReader.tOa(Fb);for(var xb of rb)this.tGm(xb,qa)&&Ga.push(xb);xb=!!this.Iq.instance&&this.Iq.instance.Dna;this.Iq.instance&&this.Iq.instance.kh||!xb||!Fb.Js||(ob.GEh&&ob.GEh.ARn(qa),this.N2&&Ga.push(...this.N2.smf(Fb).toArray()));return Ca.a(Ga)}tGm(qa,Ga){return fa.a.Lfb?this.C_a?!this.C_a.Jri(qa,Ga):!1:!qa.QN||!ob.IAf(qa,Ga)}BSn(qa,Ga){const Fb=new eb.a;for(const $b of Ga)for(Ga=0;Ga<$b.length;){Ga=this.E6h($b,Ga,0);if(-1===Ga)break;let rb=this.E6h($b,Ga+1,3);if(-1===rb)break;if($b.J(Ga).QN)for(;rb>=
Ga;){const xb=$b.J(rb);Fb.add(xb.ze);$b.remove(xb);rb--}Ga=rb+1}qa.npa(Fb)}E6h(qa,Ga,Fb){for(;Ga<qa.length;Ga++){const $b=qa.J(Ga);if(1===$b.BH&&$b.uj===Fb)return Ga}return-1}deleteRange(qa,Ga,Fb,$b,rb){const xb=Ga.begin,gb=Ga.end;Ga=null;$b&&(Ga=qa.node.qa.ei(xb));xb<gb&&($b=T.a.createTextRange(qa.node,xb,gb),this.wtk($b,qa,Ga,Fb),this.characterPropertiesEditor.replaceTextRange($b,"",void 0,void 0,sa.a.IDc,!1,rb));return Fb=Ga&&Ga.Jb&&Ga.Jb.length?Ga.Jb.length:-1}static get GEh(){return null!=ob.Ktg?
ob.Ktg:ob.Ktg=a.a.instance.Ma("WordEditor.ContentControl.IContentControlOperator")}static IAf(qa,Ga){return qa.begin>=Ga.cpBegin&&qa.end<=Ga.cpEnd}static QTk(qa,Ga,Fb,$b){let rb=0;qa=qa.qa;for(const xb of Ga)for(;rb<qa.length;){Ga=qa.J(rb);if(Ga.cp>=xb.begin&&Ga.cp<xb.end&&(Ga.pe&&Ga.pe.zYk&&$b.push(Ga.pe),Ga.Ah))for(let gb=0;gb<Ga.Ah.length;gb++){const Gb=Ga.Ah.J(gb).an.toString();Fb.ob(Gb)?Fb.Z(Gb,Fb.J(Gb)+1):Fb.Z(Gb,1)}++rb}}}Object(D.a)(ob,"DeleteParagraphContentStrategy",Ma,[]);class Ya{static get AJ(){return Ba.a.instance}static Xcl(qa,
Ga,Fb){if(1===Fb)return 32;qa=Ga.node;return Ya.AJ.lBd(qa)?ta.xcl(qa,Fb):32}}Object(D.a)(Ya,"DeleteUnsupportedObjectStrategy",null,[]);var Xa=c(171),Sa=c(339),ab=c(133),Hb=c(323),pb=c(8),Mb=c(1024),Qb=c(42),Aa=c(131),bb=c(661),nb=c(445),Va=c(554),Ab=c(603),Zb=c(846),Kb=c(185),dc=c(151),jc=c(213),zb=c(535),cc=c(37),Ub=c(139);class Wb{constructor(qa,Ga,Fb,$b,rb){this.GVo=qa;this.Z8=Fb;this.qd=$b;this.actionId=Ga;this.R$c=rb}}Object(D.a)(Wb,"DeleteActionData",null,[]);var Qa=c(1004),sb=c(150),Jb=c(866);
class pc{constructor(qa,Ga,Fb,$b,rb,xb,gb,Gb,ac,hc){this.DMh=qa;this.Zf=Ga;this.AJ=Fb;this.hyperlinkEditor=$b;this.j_=rb;this.hl=xb;this.zUi=gb;this.characterPropertiesEditor=Gb;this.Kd=ac;this.dCa=hc}zEo(qa){return!J.SelectionEditor.gl(qa)&&!J.SelectionEditor.fba(qa)}g5l(qa,Ga,Fb){var $b;let rb,xb,gb;if(!Ga&&qa&&qa.Sx&&($b=qa.Qa)&&J.SelectionEditor.jf($b)&&this.hl.Yb($b.node)&&(rb=$b.node.qa.ei($b.cpBegin))&&rb.Km&&(xb=this.lIl(rb))&&xb.hyperlink.iG&&(gb=this.V4l(qa,xb.cp)))return gb;if(!qa)return null;
if(pa.a.Oj&&($b=this.jIo(qa,Ga)))return $b;if(!Fb)return qa;Ga=J.SelectionEditor.uDa(qa,!Ga,{uA:!1,Yr:!0,lC:!0,OD:!0});return K.SelectionFactory.Vz(qa,Ga.Qa,!1)}lIl(qa){const Ga=qa.paragraph.qa;let Fb=null;qa=qa.cp;for(let $b=0;$b<Ga.length;$b++){const rb=Ga.J($b);if(rb.cp>=qa)break;rb.Km&&(Fb=null);rb.hyperlink&&(Fb=rb)}return Fb}Y4l(qa,Ga){var Fb=qa.Qa.node;if(Ga){if(Ga=J.SelectionEditor.ISa(qa.Qa.node,qa.Qa.cpBegin,!0),qa=K.SelectionFactory.Vz(qa,T.a.Tc(qa.Qa.node,Ga),!1),Fb=Fb.qa.ei(Ga),Fb.t3||
Fb.GX)qa.Qa.Fb=0}else if(Ga=J.SelectionEditor.ISa(qa.Qa.node,qa.Qa.cpBegin,!1),qa=K.SelectionFactory.Vz(qa,T.a.Tc(qa.Qa.node,Ga),!1),Fb=Fb.qa.ei(Ga),Fb.t3||Fb.GX)qa.Qa.Fb=Fb.gw+Fb.IM;qa.s$b=!0;return qa}jIo(qa,Ga){var Fb=qa.Qa;let $b=null;if(!qa.Sx||!Fb||!J.SelectionEditor.jf(Fb))return null;if(this.hl.Yb(Fb.node)&&($b=Ga?Fb.node.qa.ei(Fb.cpBegin):Fb.node.qa.fDb(Fb.cpBegin-1))&&$b.KQ)return this.Y4l(qa,Ga);Fb=m.GraphIterator.$a(qa.Qa.node);if(!Fb.Ab(8))return null;N.OutlineElementNavigator.Zd(Fb);
let rb=!1;const xb=[];if(Ga?$b&&$b.Rh:0===qa.Qa.cpBegin){do(qa=Ga?N.OutlineElementNavigator.Ir(Fb,!0,!0,!1):N.OutlineElementNavigator.N_(Fb,!0,!0,!1))&&(null===qa||void 0===qa?0:qa.cPa)?(xb.push(T.a.create(N.OutlineElementNavigator.Fe(Fb))),N.OutlineElementNavigator.Zd(Fb)):rb=!0;while(!rb);if(0<xb.length)return Ga=new Kb.Selection(Ga?xb:xb.reverse(),Ga),Ga.s$b=!0,Ga}return null}V4l(qa,Ga){var Fb=J.SelectionEditor.vDa(qa,{uA:!1,Yr:!1,lC:!0,OD:!0});if(!Fb||!Fb.Sx||Fb.Qa.node!==qa.Qa.node)return null;
Fb=Fb.Qa;if(Fb.cpBegin!==Fb.cpEnd)return null;const $b=this.hl.text(Fb.node);for(let rb=Fb.cpBegin-1;rb>=Ga;rb--)if(!Ha.a.yv($b.charCodeAt(rb)))return K.SelectionFactory.Vz(qa,T.a.Tc(Fb.node,rb+1),!1);return K.SelectionFactory.Vz(qa,T.a.Tc(Fb.node,Ga),!1)}Bbf(qa,Ga,Fb,$b,rb){var xb,gb;if(1===Fb)return 32;(Fb=null===(gb=null===(xb=Ga.view)||void 0===xb?void 0:xb.nb)||void 0===gb?void 0:gb.pg)&&F.ContextSetEditor.instance.gLh(Fb).filter(H.ParagraphReader.ZT).forEach(Gb=>{var ac;return null===(ac=H.ParagraphReader.vOa(Gb.node))||
void 0===ac?void 0:ac.Efe("delete_selection")});gb=!1;qa===sa.a.N$e?(qa=sa.a.kH,gb=!0):qa===sa.a.XFd?(qa=sa.a.backspace,gb=!0):qa===sa.a.iua&&(Ga=new Va.a(ra.App.ya.jb.xc));if(!Ga.view.re)return 2;dc.GrippersManager.instance.AB(!1);xb=qa===sa.a.kH;Fb=jc.a.Y4h(Ga);if(gb&&this.Zf.kh&&Fb&&J.SelectionEditor.hm(Fb)&&this.Zf.UBf(Fb.Qa,!xb,!0))return 2;gb=this.g5l(Fb,xb,gb);return this.Zcl(qa,Ga,$b,rb,gb,xb)}Zcl(qa,Ga,Fb,$b,rb,xb){var gb;const Gb=Ga.view,ac=Gb.nb;var hc=$b,Ec=$b;qa===sa.a.iua&&(Ec=hc=null,
rb=new Kb.Selection($b,!0));if(!rb)return 32;const Uc=this.Vjo(hc,xb);if(this.Zf.kh&&pc.Mta&&1===ac.hb.length&&J.SelectionEditor.hm(rb)&&rb.Sx&&pc.Mta.L5n(rb.Qa,xb))return 32;let dd;xb?Xa.a.mark(dd=5009):Xa.a.mark(dd=5011);hc=new y.GraphTransaction(15);hc.kk=qa;hc.Eb(Gb.Zc);let fd=null,xc=({u4n:fd}=this.mKl(qa,$b,ac,rb,fd)).returnValue;var $c=null;({ihe:$c}=F.ContextSetEditor.instance.Lbg(xc)).returnValue&&(xc=$c);if(!xc)return hc.dispose(),32;$c=!1;l.AFrameworkApplication.ye("b1jb9393;09icj321");
if(null===(gb=l.AFrameworkApplication.K)||void 0===gb?0:gb.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))gb=xc.node,$c=null===gb||void 0===gb?void 0:gb.Js;const Bc=new Wb(Ga,qa,Fb,Ec,$c);this.Zf.kh&&pc.Mta&&(Ec=F.ContextSetEditor.instance.DN(xc),pc.Mta.v3i(Ec));this.muj(xc);const Vd=this.hMd(xc,rb,xb);let Je=null;xb?Je=new Zb.a(rb):Vd&&(Je=new Zb.a(Vd));let Gf=!1;Ec=pc.Gk;if(J.SelectionEditor.jf(xc)){const Nc=Qa.a.T6b(Gb.Zc,Uc);Ec.he(()=>{this.Lbl(Ga,Fb,$b,xc,xb,
Je,rb,Nc,ac,Uc,Bc,Vd)},"DVS:DAIPC")}else!this.Kd.Cg||pa.a.fr&&this.dCa.FYd(rb)?Ec.he(()=>{Gf=this.OVi(qa,Gb.Zc,xc,ac,Uc,Bc,Je,fd)},"DVS:PUD"):(Ec.he(()=>{this.yEo(qa,Gb.Zc,xc,xb,rb,ac,Uc,Bc,Je)},"DVS:TCDC"),Gf=!0);this.fxl(ac);this.s8i(xc);hc.dispose();Xa.a.mark(dd+1);return qa===sa.a.iua?Gf?32:8:32}OVi(qa,Ga,Fb,$b,rb,xb,gb,Gb){Ga=Qa.a.T6b(Ga,rb);this.zEo(Fb)&&Ga.K6a(Fb);qa=pc.Jc.vp(qa);qa.properties.Z("CountOfParagraphsDeleted",this.hl.z8e(Fb).toString());Fb=this.ghl(Fb,$b,rb,Ga,xb,gb,Gb);qa.end();
return Fb}yEo(qa,Ga,Fb,$b,rb,xb,gb,Gb,ac){var hc=0,Ec=null;const Uc=F.ContextSetEditor.instance.DN(Fb),dd=Uc[Uc.length-1];if(dd.contextId===ba.a.paragraph||dd.contextId===ba.a.endOfParagraph){var fd=m.GraphIterator.$a(dd.node);fd.yd();N.OutlineElementNavigator.Zd(fd);N.OutlineElementNavigator.Ir(fd,!0,!1)&&(Ec=N.OutlineElementNavigator.Fe(fd))&&(hc=this.hl.textLength(Ec))}else hc=this.hl.textLength(dd.node)-dd.cpEnd;fd=Object(wa.a)(114,Gb.qd);if(fd=!!fd&&fd.ia(ia.a.aAf,!1))this.MVi(qa,Ga,Fb,xb,gb,
Gb,ac,!1,fd);else{fd=this.Kd.DYa();try{this.MVi(qa,Ga,Fb,xb,gb,Gb,ac,!0)}finally{fd&&fd.dispose()}}if(pa.a.Oj&&rb.s$b)hc=this.hMd(Fb,rb,$b),this.hl.Yb(hc.Qa.node)&&W.a.instance.setSelection(hc);else{if($b){if(Fb.Hw){qa=Uc.length-1;do rb=Uc[qa],qa--;while(!rb.node.isConnected&&0<=qa)}else rb=Fb;if(!this.hl.Yb(rb.node))return;switch(dd.contextId){case ba.a.paragraph:case ba.a.endOfParagraph:hc=Ec&&Ec.isConnected?0:hc;break;case ba.a.Vc:case ba.a.Fd:break;default:hc=0}hc=K.SelectionFactory.te(rb.node,
this.hl.textLength(rb.node)-hc);rb.zj===hc.Qa.cpBegin&&(hc.Qa.Fb=rb.Fb)}else{hc=rb.Qa.node;if(!this.hl.Yb(hc))return;Ec=rb.Qa.contextId===ba.a.paragraph?0:rb.Qa.contextId===ba.a.endOfParagraph?this.hl.textLength(hc):rb.Qa.cpBegin;hc=K.SelectionFactory.te(hc,Ec)}W.a.instance.setSelection(hc)}}MVi(qa,Ga,Fb,$b,rb,xb,gb,Gb,ac=!1){Fb=this.yBl($b,Fb);Fb=pc.yh.t7c(Fb);({type:Ec}=Fb.jRd()).returnValue&&(Gb&&4!==Ec?this.Kd.Bs(Ec):pa.a.fr||(this.Kd.q4a=Ec));for(Gb=Fb.length-1;0<=Gb;--Gb){var hc=void 0;var Ec=
({hZd:hc}=Fb.getContext(Gb)).returnValue;hc?(hc=ac&&Ec.contextId===ba.a.endOfParagraph&&Gb===Fb.length-1,this.hyperlinkEditor.Ikb(Ec,2),hc||pc.lj.Bnb(Ec,2)):this.OVi(qa,Ga,Ec,$b,rb,xb,gb,null)}}yBl(qa,Ga){if(Object(oa.a)(nb.a,Ga)){qa=Ab.OutlineElementGeneralizer.xma(qa.hb,!0);for(let Fb=0;Fb<qa.length;Fb++)if(qa.getContext(Fb).contextId===ba.a.table)return qa}return Ga}mKl(qa,Ga,Fb,$b,rb){qa===sa.a.iua?(qa=Sa.a.HCa(Ga),rb=zb.SelectionReferenceFactory.instance.rAb()):(rb=null,qa=1===Fb.hb.length?W.a.mAb($b):
Fb.pg);return{returnValue:qa,u4n:rb}}uLk(qa){return!qa.Xk||qa.contextId!==ba.a.paragraph||!this.hl.Yb(qa.node)||this.Kd.Cg||this.Zf.gYd(qa)?!1:!0}muj(qa){if(qa.Hw)for(let Ga=0;Ga<qa.length;Ga++)this.muj(qa.getContext(Ga));else this.uLk(qa)&&(qa.node.mBd=!0)}s8i(qa){if(qa.Hw)for(let Ga=0;Ga<qa.length;Ga++)this.s8i(qa.getContext(Ga));else qa.Xk&&(qa=qa.node)&&this.hl.Yb(qa)&&(qa.mBd=!1)}hMd(qa,Ga,Fb){if(qa.Xk&&J.SelectionEditor.jf(qa)&&!Fb){const $b=qa.node;let rb=qa.cpBegin,xb=-1;if(({cp:rb}=this.Zf.TIi($b,
rb)).returnValue)return K.SelectionFactory.te($b,rb);if(({cp:rb,qla:xb}=this.Zf.SIi(qa,rb,xb)).returnValue)return Ga=K.SelectionFactory.te($b,rb),Ga.Qa.Fb=xb,Ga.Qa.Sb=xb,Ga}Ga=pa.a.Oj?J.SelectionEditor.uDa(Ga,!Fb,{uA:!Ga.s$b||Ga.Sx,Yr:!1,lC:!1,OD:!0,vta:J.SelectionEditor.hm(Ga)}):J.SelectionEditor.uDa(Ga,!Fb,{uA:!0,Yr:!1,lC:!1,OD:!0});this.Zf.kh&&J.SelectionEditor.gl(qa)&&(Ga.Qa.Sb=Ga.Qa.Fb=Fb?qa.Sb:qa.Fb);return Ga}Lbl(qa,Ga,Fb,$b,rb,xb,gb,Gb,ac,hc,Ec,Uc){const dd=pc.Gk;!J.SelectionEditor.jA($b.node,
$b,rb)||this.Zf.kh&&this.Zf.rti($b)?dd.he(()=>{this.pcl($b,rb,xb,gb,Gb,ac,hc,Ec)},"DVS:IPM"):dd.he(()=>{const {response:fd,rY:xc}=this.ocl(qa,Ga,Fb,$b,rb,gb,Gb,ac,Ec,Uc);pc.OKi(Gb,32===fd);xc&&pc.rpa(ac,xb)},"DVS:ISE")}vfm(qa,Ga){sb.a.NX&&(Ga.qd||(Ga.qd=new x.DictionaryPropertySet),Ga.qd.setValue(ia.a.joa,"delete"),Ga.qd.setValue(ia.a.Lga,"backspace"));var Fb=qa.aT;const $b=pc.Ad.BT(Fb),rb=bb.a.zPm;if(null===rb||void 0===rb?0:rb.BIm(Fb,$b)){sb.a.NX&&Ga.qd.setValue(ia.a.Lga,"backspace-autocorrect");
Fb=rb.Yuj+" ";const xb=T.a.Tc(qa,0);this.characterPropertiesEditor.replaceTextRange(xb,Fb);qa=K.SelectionFactory.te(qa,Fb.length);W.a.instance.setSelection(qa);pb.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",rb.Yuj)}return l.AFrameworkApplication.xa.Nf(Ga.GVo,$b.Zy?sa.a.bL:sa.a.PC,2,!1,Ga.Z8,Ga.qd)}Uem(qa,Ga,Fb,$b,rb){let xb=!1;0<this.zUi.k3(qa).wt&&(rb=l.AFrameworkApplication.xa.Nf(Ga,sa.a.Zfc,2,!1,Fb,$b),xb=!0);return{OT:xb,response:rb}}afm(qa,Ga,Fb,$b,rb){let xb=!1;
0<this.zUi.aG(qa).wt&&(rb=l.AFrameworkApplication.xa.Nf(Ga,sa.a.G2c,2,!1,Fb,$b),xb=!0);return{OT:xb,response:rb}}egm(qa,Ga,Fb,$b,rb){let xb=!1;pc.Xp.lzb(qa)&&(rb=l.AFrameworkApplication.xa.Nf(Ga,sa.a.pG,2,!1,Fb,$b),xb=!0);return{OT:xb,response:rb}}Edm(qa,Ga,Fb,$b,rb,xb,gb,Gb,ac,hc){const Ec=new Aa.a;Ec.$c(Ga);let Uc=!1;if(N.OutlineElementNavigator.FFa(Ec,!1,!qa,!1)){hc=!0;ac=32;Uc=!0;(new m.GraphIterator).$c(Ec);N.OutlineElementNavigator.Fe(Ec);const fd=Ec.currentNode;H.ParagraphReader.Kta(fd)&&H.ParagraphReader.vOa(fd).Efe("delete_ip");
var dd=new m.GraphIterator;dd.set(gb);(dd=this.hl.isEmpty(dd))&&rb&&J.SelectionEditor.d8(rb.Qa)?(Fb.K6a(xb),N.OutlineElementNavigator.Fe(Ga),pc.vg.GGa(Ga.currentNode)):fd.XI?(Fb.K6a(xb),N.OutlineElementNavigator.Zd(Ec),Ec.Dg()):qa&&dd?this.Zf.Gvi(gb)&&!({rY:hc}=this.DYi(qa,gb,fd,rb,hc)).returnValue&&(Fb.K6a(xb),pc.Qn.Oha(Ga),this.DMh.azn(gb),Ga.Dg()):cc.TableReader.isTable(Ec)?(Fb.K6a(xb),qa&&(da.moveToFirstRow(Ec),da.moveToFirstColumn(Ec),M.OutlineNavigator.B8(Ec),N.OutlineElementNavigator.Fe(Ec),
Gb.setSelection((new Zb.a(K.SelectionFactory.te(Ec.currentNode,0))).restore())),ac=2,hc=!1):this.hl.Yb(fd)&&(1==this.hl.textLength(fd)&&(Gb=Ta.e(fd),1==Gb.length&&8==Gb[0].zh&&(Gb=T.a.createTextRange(fd,0,1),this.characterPropertiesEditor.replaceTextRange(Gb,"",void 0,void 0,sa.a.IDc))),({rY:hc}=this.DYi(qa,gb,fd,rb,hc)).returnValue||($b.actionId==sa.a.backspace&&Fb.Hkc(gb),this.DMh.Mbl(qa,Fb,xb,Ga,gb,Ec)))}return{OT:Uc,response:ac,rY:hc}}DYi(qa,Ga,Fb,$b,rb){if(this.Kd.Cg){if(pc.Nta){const xb=Object(oa.a)(Ub.AParagraphNode,
Fb)?pc.Nta.FTc(Fb):!1,gb=Object(oa.a)(Ub.AParagraphNode,Ga)?pc.Nta.FTc(Ga):!1;if(xb!==gb)return{returnValue:!1,rY:rb};if(!pa.a.fr&&gb)return this.Zf.kh&&pc.Izk(Ga,Fb,qa)&&this.Kd.Bs(4),{returnValue:!1,rY:rb}}qa=qa?Ga:Fb;if(!Object(oa.a)(Ub.AParagraphNode,qa))return{returnValue:!1,rY:rb};Ga=qa.qa.last;Fb=l.AFrameworkApplication.userName;if(!Ga.aj||Ga.aj.authorName!==Fb)return pc.lj.sNb(qa,2),$b&&(W.a.instance.setSelection($b),rb=!1),{returnValue:!0,rY:rb}}return{returnValue:!1,rY:rb}}ofm(qa,Ga,Fb,
$b,rb,xb,gb,Gb){Qb.OutlineElementReader.sCm(Ga,qa)||({response:gb,rY:Gb}=pc.Yhl(Fb,$b,qa,xb,rb,gb,Gb));return{OT:!1,response:gb,rY:Gb}}ocl(qa,Ga,Fb,$b,rb,xb,gb,Gb,ac,hc){let Ec=!1,Uc=2;const dd=$b.node;let fd=void 0,xc=!1;const $c=pc.Gk;if(!rb){if(dd.aT)return $c.he(()=>{Uc=this.vfm(dd,ac)},"DVS:HLOE"),{response:Uc,rY:Ec};$c.he(()=>{({response:Uc,OT:xc}=this.Uem(dd,qa,Ga,Fb,Uc))},"DVS:HIOD");if(xc)return{response:Uc,rY:Ec};$c.he(()=>{({response:Uc,OT:xc}=this.afm(dd,qa,Ga,Fb,Uc))},"DVS:HWPF");if(xc)return{response:Uc,
rY:Ec};fd=this.j7h(dd);$c.he(()=>{({response:Uc,OT:xc}=this.egm(fd,qa,Ga,Fb,Uc))},"DVS:HPOB");if(xc)return{response:Uc,rY:Ec}}null!==fd&&void 0!==fd?fd:fd=this.j7h(dd);$c.he(()=>{({response:Uc,OT:xc,rY:Ec}=this.Edm(rb,fd,gb,ac,hc,$b,dd,Gb,Uc,Ec))},"DVS:HAOE");if(xc)return{response:Uc,rY:Ec};$c.he(()=>{({response:Uc,OT:xc,rY:Ec}=this.ofm(rb,fd,Ga,Fb,gb,xb,Uc,Ec))},"DVS:HFLOE");return{response:Uc,rY:Ec}}eko(qa){return J.SelectionEditor.gl(qa)||this.AJ.Oyi(qa)||J.SelectionEditor.fba(qa)}Vjo(qa,Ga){return qa&&
qa.hasProperty(z.a.LIc)?!qa.ia(z.a.LIc,!1):!Ga}static get Ad(){return null!=pc.xAg?pc.xAg:pc.xAg=a.a.instance.resolve("Box4.List.IListReader")}static get Qn(){return null!=pc.oAg?pc.oAg:pc.oAg=a.a.instance.resolve("Box4.List.IListEditor")}static get vg(){return null!=pc.nBg?pc.nBg:pc.nBg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get Xp(){return Mb.a.JDb}static get lj(){return null!=pc.JEg?pc.JEg:pc.JEg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get yh(){return null!=
pc.sFg?pc.sFg:pc.sFg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Jc(){return ab.a.instance}static get Mta(){pc.wsb||(pc.wsb=a.a.instance.Sa("Box4.ContentControl.IContentControlOperator"));return pc.wsb.instance}static get Nta(){return null!=pc.Ntg?pc.Ntg:pc.Ntg=a.a.instance.Ma("Box4.IContentControlReader")}static get Gk(){return Hb.a.instance}fxl(qa){if(1===qa.hb.length&&(qa=qa.hb.J(0),J.SelectionEditor.hm(qa))){var Ga=qa.Qa;qa=Ga.node;Ga=Ga.cpBegin;var Fb=
this.hl.text(qa);Ga<Fb.length&&0<Ga&&" "===Fb.charAt(Ga-1)&&" "===Fb.charAt(Ga)&&this.characterPropertiesEditor.replaceTextRange(T.a.createTextRange(qa,Ga-1,Ga),"\u00a0")}}fCk(qa,Ga){if(!Ga.hyperlink.Qib){const Fb=new y.GraphTransaction(15);try{Fb.Eb(qa.node),this.j_.iR(qa,Ga)}finally{Fb&&Fb.dispose()}Ga.hyperlink.iG&&this.Kd.Bs(2)}}static Yhl(qa,Ga,Fb,$b,rb,xb,gb){if(Fb=J.SelectionEditor.uDa($b,!Fb,{uA:!1,Yr:!1,lC:!1,OD:!0})){$b=K.SelectionFactory.Vz($b,Fb.Qa);xb=32;for(Fb=0;Fb<$b.length;++Fb){rb.K6a($b.J(Fb));
const Gb=l.AFrameworkApplication.xa.Nf($b.J(Fb),sa.a.kH,2,!0,qa,Ga);2!==Gb&&(xb=Gb)}32===xb&&(gb=!0)}return{response:xb,rY:gb}}ghl(qa,Ga,Fb,$b,rb,xb,gb){let Gb=!1;this.fko(qa)?(Gb=pc.Ucf(qa,!0,Ga,Fb,$b,rb))&&pc.pIa(xb,Ga,gb):this.eko(qa)?(Gb=pc.Ucf(qa,!1,Ga,Fb,$b,rb))&&pc.pIa(xb,Ga,gb):($b.normalize(),pc.pIa(xb,Ga,gb));return Gb}static pIa(qa,Ga,Fb){Fb&&Fb.rpa()||pc.rpa(Ga,qa)}static Ucf(qa,Ga,Fb,$b,rb,xb){var gb;$b||I.OutlineReader.GPa(qa)||(Fb=pc.L9c(Fb))&&rb.xgo(Fb);l.AFrameworkApplication.ye("b1jb9393;09icj321");
if(null===(gb=l.AFrameworkApplication.K)||void 0===gb?0:gb.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))xb.qd?xb.qd.R$c=xb.R$c:xb.qd={R$c:xb.R$c};gb=qa instanceof nb.a?qa.getContext(0).node:qa.node;gb=pc.nZl(gb);qa=32===l.AFrameworkApplication.xa.Nf(qa,xb.actionId,2,Ga,xb.Z8,xb.qd);pc.OKi(rb,qa,gb);return qa}static get oq(){return null!=pc.Kwg?pc.Kwg:pc.Kwg=a.a.instance.resolve("Box4.IFormattingEditor")}static get TSa(){return null!=pc.yDg?pc.yDg:pc.yDg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static nZl(qa){const Ga=
new Jb.a;if(qa){let Fb=null;qa=K.SelectionFactory.Yn(qa,!0);if(!qa)pb.ULS.sendTraceTag(509645905,315,10,"Unexpected null selection.");else for(let $b=0;$b<qa.length;$b++)if(P.FormattingReader.r7e(qa.J($b))){Fb=qa.J($b);break}Fb&&((qa=P.FormattingReader.Ar(Fb))&&qa.cache&&qa.cache.lB&&(qa=qa.Sf(null),pc.oq.j4(qa)),qa&&(Ga.formatting=qa.Dj,Ga.languageId=P.FormattingReader.language(qa)),Ga.xqa=pc.TSa.Uo(Fb.node))}return Ga}static OKi(qa,Ga,Fb){Ga?qa.normalize(Fb):qa.cancel()}static rpa(qa,Ga){Ga&&pc.Gk.he(()=>
{const Fb=Ga.restore();Fb&&qa.setSelection(Fb)},"DVS:RS")}pcl(qa,Ga,Fb,$b,rb,xb,gb,Gb){let ac;!Ga&&({hyperlink:ac}=this.j_.C$b(qa)).returnValue?(Fb=new Zb.a($b),this.fCk(qa,ac),rb.normalize(),pc.rpa(xb,Fb)):pc.Ucf(qa,!1,xb,gb,rb,Gb)&&(Ga&&this.Kd.Cg?(Ga=pc.lj.$Ed)?(xb.setSelection(K.SelectionFactory.te(qa.node,Ga)),pc.lj.$Ed=null):pc.rpa(xb,Fb):pc.rpa(xb,Fb))}static Izk(qa,Ga,Fb){Fb?(Fb=qa,qa=Ga):Fb=Ga;Ga=pc.Nta.aac(Fb,!1);qa=pc.Nta.aac(qa,!0);return!(Ga&&qa)}fko(qa){return qa.Hw||I.OutlineReader.GPa(qa)||
this.hl.im(qa)}static L9c(qa){return(qa=Ab.OutlineElementGeneralizer.xma(qa.hb,!0))&&1===qa.length&&(qa=qa.getContext(0).node,cc.TableReader.QX(qa))?qa:null}j7h(qa){const Ga=new m.GraphIterator;Ga.set(qa);Ga.yd();N.OutlineElementNavigator.Zd(Ga);return Ga}}pc.wsb=null;Object(D.a)(pc,"ADeleteViewStrategy",null,[]);class rc{Mbl(qa,Ga,Fb,$b,rb,xb){const gb=xb.currentNode;N.OutlineElementNavigator.Zd(xb);qa?(Ga.Hkc(xb.currentNode),rc.Zf.zui(Fb,rb,gb,!1)||rc.vg.merge($b,xb,!1,!1)):rc.Zf.zui(Fb,gb,rb,!0)||
rc.vg.merge(xb,$b,!1,!1)}azn(qa){qa&&H.ParagraphReader.Yb(qa)&&(Pa.a.A2c(qa),rc.Dkl.PYe(qa))}static get vg(){return null!=rc.iBg?rc.iBg:rc.iBg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get Dkl(){return null!=rc.zug?rc.zug:rc.zug=a.a.instance.resolve("Box4.IDynamicRangeEditor")}static get Zf(){return ma.a.instance}}Object(D.a)(rc,"DeleteParagraphNodeStrategy",null,[448]);class db extends pc{constructor(qa,Ga,Fb,$b,rb,xb,gb,Gb,ac){super(new rc,qa,Ga,Fb,$b,rb,xb,gb,Gb,ac)}}Object(D.a)(db,
"DeleteViewStrategy",pc,[]);c.d(L,"DeleteActor",function(){return lb});class lb extends ta{constructor(qa,Ga,Fb,$b,rb,xb,gb,Gb,ac,hc,Ec,Uc){super();this.deleteParagraph=(dd,fd)=>{dd=fd.node;Pa.a.A2c(dd);this.pxe.PYe(dd);this.hn&&this.hn.instance&&this.hn.instance.DPi(dd);dd.Js&&(this.Qm.zRn(dd,!this.kh),this.kh&&this.USg.instance&&this.USg.instance.zyj(dd));return 0};this.TGd=(dd,fd,xc)=>{2==xc&&(dd=l.AFrameworkApplication.breadcrumbFolderUrl,dd&&0!=dd.length||(dd=l.AFrameworkApplication.breadcrumbBrandUrl),
ra.App.Ufb(dd));return 32};this.Kbl=(dd,fd,xc)=>{({DeleteActor:dd}=c(1576));if(1===xc)return 32;xc=ra.App.ya.xq.eg("ModelUpdate","DeleteAnchoredObject");fd=fd.node;const $c=new m.GraphIterator;$c.set(fd);$c.Ab(12);const Bc=$c.jo(12);if(ma.a.instance.DTc(Bc))return 2;dd.LZb(Bc);dd=new y.GraphTransaction(7);dd.Eb(fd);$c.Dg();dd.dispose();xc.stop();return 32};this.OUj=new ob;this.PUj=new db(ma.a.instance,Ba.a.instance,xb,gb,Gb,ac,hc,Ec,Uc);this.Qm=qa;this.qsc=Ga;this.USg=Fb;this.pxe=$b;this.hn=rb}get kh(){return this.qsc.instance?
this.qsc.instance.kh:!1}get LMh(){return this.PUj}get BMh(){return this.OUj}Z0f(qa,Ga,Fb,$b){const rb=Ya.Xcl,xb=this.Kbl;qa.pa(sa.a.backspace,ba.a.anchoredObject,xb);qa.pa(sa.a.backspace,ba.a.unsupportedObject,rb);qa.pa(sa.a.kH,ba.a.anchoredObject,xb);qa.pa(sa.a.kH,ba.a.unsupportedObject,rb);qa.pa(sa.a.backspace,ba.a.paragraph,this.deleteParagraph);qa.pa(sa.a.kH,ba.a.paragraph,this.deleteParagraph);qa.pa(sa.a.iua,ba.a.paragraph,this.deleteParagraph);qa.pa(sa.a.TGd,ba.a.view,this.TGd);qa.Uc(sa.a.iua,
64);super.Z0f(qa,Ga,Fb,$b)}static LZb(qa){var Ga;(null===(Ga=ra.App.xd)||void 0===Ga?0:Ga.Yp)&&ra.App.xd.Vq.aH(qa)}}Object(D.a)(lb,"DeleteActor",ta,[])},1577:function(D,L,c){c.r(L);D=c(0);var l=c(8),e=c(1432),a=c(1590),k=c(918),x=c(1528);class y{constructor(oa){this.p5j=oa}initialize(){return Promise.resolve(0)}z0d(){return Promise.resolve(0)}T4(){l.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new x.a,{IsSuccess:!0,Token:this.p5j}))}Vke(){return Promise.resolve(Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Hie(){return!1}qOc(){return"MockAuthTokenStrategy"}}Object(D.a)(y,"MockAuthTokenStrategy",null,[217]);var m=c(1639);class u{static get(oa,wa,ia){if(!ia)return oa;let ca=0;return Promise.race([oa,new Promise(pa=>{ca=window.setTimeout(()=>{pa(wa)},ia)})]).then(pa=>{window.clearTimeout(ca);return Promise.resolve(pa)}).catch(()=>{window.clearTimeout(ca);
return Promise.resolve(wa)})}}Object(D.a)(u,"PromiseWithTimeout",null,[]);var z=c(2),v=c(601);class E{constructor(oa,wa,ia,ca,pa){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=oa;this.scope=wa;this.silentLogin=ia;this.options=ca;this.correlationId=pa}}Object(D.a)(E,"TokenRequestParameters",null,[227]);var F=c(15),J=c(21);class K{constructor(){this.Shh=null;let oa=z.AFrameworkApplication.K.kb(z.AFrameworkApplication.Hia),wa=z.AFrameworkApplication.K.kb(z.AFrameworkApplication.hle);
this.yYb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",oa&&""!==oa?oa:"Unspecified",wa&&""!==wa?wa:"Unspecified")}initialize(){return new Promise(oa=>{J.a.instance.Sa("Common.App.WopiIdentity.IWopiIdentity").execute(wa=>{this.Shh=wa;oa(0)})})}fe(oa){const wa=["HTTPS:","API:"];let ia=!1;const ca=oa.toLocaleUpperCase();for(const pa of wa)if(ca.startsWith(pa)){ia=!0;break}return ia||this.nDm(oa)?oa+"/.default":oa}nDm(oa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(oa)}z0d(){return Promise.resolve(0)}T4(oa,
wa,ia,ca,pa,Ma,ya){if(F.a.QPa){pa=v.OAuthManagerSettings.eWo;if(!pa)return wa=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(wa);if(!Array.contains(pa,oa))return wa=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+oa}),Promise.resolve(wa)}oa=this.fe(ia);ia=new E(ia,oa,!ca,null,z.AFrameworkApplication.userSessionId);return this.Shh.getAccessToken(ia,wa,ya).then(Oa=>Object.assign(new x.a,
{IsSuccess:!0,Token:Oa.accessToken}),Oa=>Object.assign(new x.a,{IsSuccess:!1,ErrorCode:Oa}))}Vke(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Hie(){return!1}qOc(){return this.yYb}}Object(D.a)(K,"ParentFrameTokenStrategy",null,[217]);var H=c(46),P=c(756),N=c(76);class M{constructor(){this.reject=this.resolve=null;this.startTime=0;this.jZi=
this.Dsh=null}}Object(D.a)(M,"PromiseWrapper",null,[]);class I{constructor(oa=0){this.Gx=0;this.Kxc=!1;this.Mx=new N.a;this._timeout=oa}enqueue(oa){return new Promise((wa,ia)=>{this.Mx.add(Object.assign(new M,{jZi:oa,resolve:wa,reject:ia}));this.process()})}process(){if(this.Kxc||this.Gx===this.Mx.count)return!1;const oa=this.Mx.J(this.Gx++);try{this.Kxc=!0,oa.jZi().then(wa=>{this.Kxc=!1;this.N6e(oa,wa,null,!0)}).catch(wa=>{this.Kxc=!1;this.N6e(oa,null,wa,!1)})}catch(wa){this.Kxc=!1,this.N6e(oa,null,
wa,!1)}return!0}N6e(oa,wa,ia,ca){if(ca){const pa=()=>{oa.resolve(wa);this.process()};0<this._timeout?window.setTimeout(()=>{pa()},this._timeout):pa()}else{const pa=()=>{oa.reject(ia);this.process()};0<this._timeout?window.setTimeout(()=>{pa()},this._timeout):pa()}}}Object(D.a)(I,"PromiseQueue",null,[]);class T{constructor(){this.correlationId=this.resolve=null}}Object(D.a)(T,"ResolveWithCorrelation",null,[]);var U=c(82),W=c(152),V=c(949),Y=c(87);class da extends W.a{constructor(oa,wa,ia,ca,pa,Ma){super(!1,
!1,!0);this.IOg=this.zza=null;this.usa=oa;this.P9j=ia;this.Cq=ca;this.jgk=pa;this.ntb=Ma;this.TG=document.createElement("iframe");this.TG.id="SharedAuthInteractiveFrame";this.TG.setAttribute("name","SharedAuthInteractiveFrame");this.TG.setAttribute("title","SharedAuthInteractiveFrame");this.TG.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.TG.style.border="0";this.TG.style.height="48px";this.TG.style.width="190px";$addHandler(this.TG,"error",Object(H.a)(this,
this.pnn,"onSharedAuthFrameError"));oa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.usa,wa,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",z.AFrameworkApplication.userType);this.TG.src=oa;this.YUj=new Promise(ya=>{this.IOg=ya});this.JOg=!1}FSa(){this.zza={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.P9j,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:z.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(H.a)(this,
this.F3k,"createFrame"),["resolveDialogStyles"]:this.IOg}};this.zd=5;this.Yh(CommonUIStrings.l_SignIn,Object(H.a)(this,this.Yio,"sharedAuthConsentDialogHandler"),this.zza)}EAj(oa=!1,wa=5){this.zza&&this.zza.bodyControls&&(!0!==Object(U.a)(Object,this.zza.bodyControls).frameLoaded&&(Object(U.a)(Object,this.zza.bodyControls).frameLoaded=!0),oa!==Object(U.a)(Object,this.zza.bodyControls).frameLoadSuccess&&(Object(U.a)(Object,this.zza.bodyControls).frameLoadSuccess=oa),wa!==this.zza.dialogButtonsOption&&
(this.zza.dialogButtonsOption=null,this.zd=wa),this.update(this.zza))}jqo(oa,wa){const ia=new V.a(Y.a.bjo);ia.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:z.AFrameworkApplication.isRtl,["messageCorrelationId"]:oa,["dialogStyles"]:wa};this.Cq.pSa(ia,this.TG.contentWindow,this.usa)}IYh(){this.EAj(!1,6)}get Dij(){return this.TG}get jfl(){return this.YUj.then(oa=>{this.JOg=!0;return oa})}get kfl(){return this.JOg}pnn(){this.IYh()}F3k(){return this.TG}Yio(oa){0===
oa&&(this.jgk.reject(Object.assign(new x.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.ntb(null))}}Object(D.a)(da,"SharedAuthConsentDialog",W.a,[228]);var ba=c(958),ja=c(75),sa=c(114),ta=c(35),ra=c(118),ma=c(126);class Ba{constructor(){this.TG=null;this.ijd=0;this.RVb=this.fZb=this.vre=this.ntb=this.H$=this.Ufh=null;this.Cq=new ba.a(null,null);this.yYb="SharedAuthTokenStrategy Unloaded";this.usa=v.OAuthManagerSettings.$io;this.Zbh=v.OAuthManagerSettings.Zio;
this.kQg=v.OAuthManagerSettings.enableConsoleLogging;this.hWj=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.rdk=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.bhk=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.gbb={};this.y0j=new I(1500)}qOc(){return this.yYb}initialize(){var {OAuthManager:oa}=c(1577);
if("loadFrame"in this.gbb)return this.gbb.loadFrame.Dsh;if(!this.usa)return ja.Health.instance.recordKpiFailure(oa.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),l.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);oa=this.iie("loadFrame");this.ijd=ta.a.Ue();var wa=this.usa+this.Zbh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+z.AFrameworkApplication.userSessionId+"&WacUserType="+z.AFrameworkApplication.userType;
this.bhk&&(wa+="&webworker=1");this.TG=document.createElement("iframe");this.vxf(this.TG);this.TG.style.cssText="height:0;width:0;display:none;";this.TG.id="SharedAuthFrame";this.TG.setAttribute("name","SharedAuthFrame");this.TG.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.TG.setAttribute("title","SharedAuthFrame");this.TG.src=wa;document.body.appendChild(this.TG);wa=ta.a.Ue()-this.ijd;l.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",
wa,this.TG.src);return oa}z0d(oa){this.vre=oa;const wa=new V.a(Y.a.Gij);wa.Values=this.jsh(oa);oa=this.iie("initFrame");this.Cq.pSa(wa,this.TG.contentWindow,this.usa);l.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return oa}T4(oa,wa,ia,ca,pa,Ma){const ya=new V.a(Y.a.cjo),Oa=this.gbi();ya.Values=this.Vvj(oa,wa,ia,ca,pa,Ma,Oa);oa=this.iie(Oa);ca&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",
!1)?this.y0j.enqueue(()=>new Promise(fa=>{this.nHo(Ma,ya,fa,Oa)})):(this.Cq.pSa(ya,this.TG.contentWindow,this.usa),l.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",wa));return oa}nHo(oa,wa,ia,ca){const pa=this.gbb[ca];pa&&(this.fZb=wa,this.ntb=Object.assign(new T,{resolve:ia,correlationId:ca}),this.H$=new da(this.usa,this.Zbh,oa,this.Cq,pa,ia),this.H$.FSa())}gbi(){return ra.a.create().toString()}Vvj(oa,wa,ia,ca,pa,Ma,ya){const Oa={};Oa.appName=
oa;Oa.appId=wa;Oa.target=ia;Oa.withPopup=ca;Oa.claims=pa;Oa.promptMessage=Ma;Oa.messageCorrelationId=ya;return Oa}vxf(oa){$addHandler(oa,"load",Object(H.a)(this,this.Fin,"onIFrameLoaded"));$addHandler(oa,"error",Object(H.a)(this,this.blb,"onIFrameError"));this.Cq.S$(this.usa);this.Cq.pv(Y.a.Jij);this.Cq.uB(Y.a.Jij,Object(H.a)(this,this.Qmn,"onScriptLoaded"));this.Cq.pv(Y.a.Iij);this.Cq.uB(Y.a.Iij,Object(H.a)(this,this.Pmn,"onScriptInitialized"));this.Cq.pv(Y.a.Eij);this.Cq.uB(Y.a.Eij,Object(H.a)(this,
this.din,"onGetTokenResponse"));this.Cq.pv(Y.a.Kij);this.Cq.uB(Y.a.Kij,Object(H.a)(this,this.Gjn,"onLoginResponse"));this.Cq.pv(Y.a.Hij);this.Cq.uB(Y.a.Hij,Object(H.a)(this,this.djn,"onInteractiveFlowReady"));this.Cq.pv(Y.a.Fij);this.Cq.uB(Y.a.Fij,Object(H.a)(this,this.pin,"onHideDialog"));this.Cq.pv(Y.a.Cij);this.Cq.uB(Y.a.Cij,Object(H.a)(this,this.tQf,"onCloseDialog"))}iie(oa){const wa=new M;wa.startTime=ta.a.Ue();const ia=new Promise((ca,pa)=>{wa.resolve=ca;wa.reject=pa});wa.Dsh=ia;this.gbb[oa]=
wa;return ia}Fin(){const oa=ta.a.Ue()-this.ijd;l.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",oa)}blb(oa){const {OAuthManager:wa}=c(1577),ia=ta.a.Ue()-this.ijd,ca=Object.assign(new ma.a,{durationMs:ia});ja.Health.instance.recordKpiFailure(wa.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,ca);l.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ia,this.kQg?JSON.stringify(oa):"")}Qmn(oa){const {OAuthManager:wa}=c(1577),
ia=this.gbb.loadFrame;var ca=ta.a.Ue()-ia.startTime,pa=oa.Values.AuthLibrary.toString();oa=oa.Values.Success.toString();l.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",oa,pa,ca);pa&&(this.yYb="SharedAuthTokenStrategy "+pa);pa=Boolean.parse(oa);pa||(oa=sa.a.KF(),void 0!==oa&&null!==oa&&(oa.set("AuthLibrary",this.qOc()),ca=Object.assign(new ma.a,{durationMs:ca,extendedProperties:oa}),ja.Health.instance.recordKpiFailure(wa.kpiName,
"SharedAuthStrategyInitFailed",!1,!0,ca)));ia.resolve(pa?0:1)}Pmn(oa){if(oa.Values.interactive&&this.fZb&&this.fZb.Values.messageCorrelationId){const ia=this.fZb.Values.messageCorrelationId.toString();if(oa.Values.interactive&&this.H$){this.H$.jfl.then(ca=>{this.Cq.pSa(this.fZb,this.H$.Dij.contentWindow,this.usa);this.H$.jqo(ia,ca);this.H$.EAj(!0);this.fZb=null});return}}oa=this.gbb.initFrame;const wa=ta.a.Ue()-oa.startTime;l.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",
wa);oa.resolve(0)}din(oa){if(oa.Values.messageCorrelationId&&oa.Values.messageCorrelationId.toString()){var wa=oa.Values.messageCorrelationId.toString(),ia=this.gbb[wa];if(ia){var ca=ta.a.Ue()-ia.startTime;l.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",ca);oa.Values.isSuccess&&oa.Values.isSuccess?ia.resolve(oa.Values.response):ia.reject(oa.Values.response);this.swj(wa)}else l.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(573112904,
3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}djn(){if(this.H$.kfl)this.H$.IYh();else if(this.vre&&this.H$){const oa=new V.a(Y.a.Gij);oa.Values=this.jsh(this.vre,!0);this.Cq.pSa(oa,this.H$.Dij.contentWindow,this.usa)}}pin(){this.H$&&this.H$.CTd()}tQf(oa){oa.Values.cancelled&&oa.Values.cancelled&&oa.Values.messageCorrelationId&&this.swj(oa.Values.messageCorrelationId.toString());this.H$&&this.H$.hide()}jsh(oa,wa=!1){const ia={};ia.appIds=this.hFl();
ia.upn=oa.loginHint;ia.authority=oa.authority;ia.authorityType=Object(e.a)(k.a,oa.authorityType);ia.tenantId=oa.tenantId;ia.correlationId=z.AFrameworkApplication.userSessionId;ia.enableConsoleLogging=this.kQg;ia.enablePopupFlash=this.hWj;ia.skipUpnCheck=this.rdk;ia.interactive=wa;return ia}hFl(){const oa=[],wa=v.OAuthManagerSettings.KZe;for(let ca in wa){var ia=wa[ca];Array.contains(oa,ia)||Array.add(oa,ia)}return oa}Vke(oa,wa,ia,ca,pa,Ma){const ya=new V.a(Y.a.ajo),Oa=this.gbi();ya.Values=this.Vvj(oa,
wa,ia,ca,pa,Ma,Oa);this.Ufh=ya;oa=this.iie(Oa);l.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",wa);this.Tno();return oa}Hie(){return!0}Tno(){this.RVb||(this.RVb=new P.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.RVb.id=16,this.RVb.TXd=!1,this.RVb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{l.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");
this.Cq.pSa(this.Ufh,this.TG.contentWindow,this.usa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),z.AFrameworkApplication.ta.Ob.Wka(this.RVb,!0)||l.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}Gjn(oa){if(oa.Values.messageCorrelationId&&oa.Values.messageCorrelationId.toString()){var wa=this.gbb[oa.Values.messageCorrelationId.toString()];if(wa){var ia=ta.a.Ue()-wa.startTime;l.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",
ia);oa.Values.isSuccess&&oa.Values.isSuccess?wa.resolve(oa.Values.response):wa.reject(oa.Values.response)}else l.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}swj(oa){this.ntb&&this.ntb.correlationId===oa&&(this.ntb.resolve(null),this.ntb=null)}}Object(D.a)(Ba,"SharedAuthTokenStrategy",null,[217]);
class Pa{constructor(oa){this.o6=oa;this.yYb="UnsupportedAuthTokenStrategy Reason="+a.a[this.o6]}initialize(){return Promise.resolve(0)}z0d(){return Promise.resolve(0)}T4(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:a.a[this.o6],ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.o6]+"]"}))}Vke(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Hie(){return!1}qOc(){return this.yYb}}
Object(D.a)(Pa,"UnsupportedAuthTokenStrategy",null,[217]);var Da=c(1491);c.d(L,"OAuthManager",function(){return Ha});class Ha{constructor(oa=null){this.cja=0;this.cda=null;this.Yvb=0;const wa=ta.a.Ue();this.e0j=this.lel(oa).then(ia=>ia?this.Som():(l.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.wK(),Math.floor(ta.a.Ue()-wa)),ia=sa.a.KF(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.wK()),ia=Object.assign(new ma.a,
{durationMs:Math.floor(ta.a.Ue()-wa),extendedProperties:ia}),ja.Health.instance.recordKpiFailure(Ha.kpiName,"StrategyPickFailed",!1,!0,ia)),Promise.resolve(1))).then(ia=>0!==ia?Promise.resolve(ia):this.rSm())}mel(){var oa=v.OAuthManagerSettings.y8m;oa&&0<oa.length?(this.cja=1,this.cda=new y(oa)):z.AFrameworkApplication.K.$("IsO365ConsumerHost")||z.AFrameworkApplication.K.$("IsO365CommercialHost")?z.AFrameworkApplication.K.$("IsAnonymousUser")?(this.cja=2,this.cda=new Pa(this.cja)):(oa=m.a.getAuthContext().loginHint)&&
oa.length?v.OAuthManagerSettings.fQc?(this.cja=1,this.cda=new K):(this.cja=1,this.cda=new Ba):(this.cja=3,this.cda=new Pa(this.cja)):(this.cja=4,this.cda=new Pa(this.cja))}wK(){return this.cda?this.cda.qOc()||"Unknown":"None"}lel(oa=null){l.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const wa=ta.a.Ue();return z.AFrameworkApplication.K.pQl().then(ia=>{ia?(this.mel(),oa&&(this.cda=oa),l.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",
v.OAuthManagerSettings.clientVersion,v.OAuthManagerSettings.appVersion,v.OAuthManagerSettings.Ril,this.wK(),Math.floor(ta.a.Ue()-wa))):l.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ta.a.Ue()-wa));return Promise.resolve(ia)},()=>{l.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(ta.a.Ue()-wa));return Promise.resolve(!1)})}Som(){l.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.wK());const oa=ta.a.Ue();return u.get(this.cda.initialize(),2,v.OAuthManagerSettings.WYf).then(wa=>{if(0===wa)l.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.wK(),Math.floor(ta.a.Ue()-oa));else if(1===wa){l.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.wK(),Math.floor(ta.a.Ue()-
oa));var ia=sa.a.KF();void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.wK()),ia=Object.assign(new ma.a,{durationMs:Math.floor(ta.a.Ue()-oa),extendedProperties:ia}),ja.Health.instance.recordKpiFailure(Ha.kpiName,"StrategyInitFailed",!1,!0,ia))}else 2===wa&&(l.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.wK(),Math.floor(ta.a.Ue()-oa)),ia=sa.a.KF(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.wK()),ia=Object.assign(new ma.a,
{durationMs:Math.floor(ta.a.Ue()-oa),extendedProperties:ia}),ja.Health.instance.recordKpiFailure(Ha.kpiName,"StrategyInitTimedOut",!1,!0,ia)));return Promise.resolve(wa)},()=>{l.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.wK(),Math.floor(ta.a.Ue()-oa));return Promise.resolve(1)})}rSm(){l.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.wK());const oa=ta.a.Ue();return u.get(this.cda.z0d(m.a.getAuthContext()),2,
v.OAuthManagerSettings.WYf).then(wa=>{if(0===wa)l.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.wK(),Math.floor(ta.a.Ue()-oa));else if(1===wa){l.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.wK(),Math.floor(ta.a.Ue()-oa));var ia=sa.a.KF();void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.wK()),ia=Object.assign(new ma.a,{durationMs:Math.floor(ta.a.Ue()-oa),extendedProperties:ia}),ja.Health.instance.recordKpiFailure(Ha.kpiName,
"StrategyLoadFailed",!1,!0,ia))}else 2===wa&&(l.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.wK(),Math.floor(ta.a.Ue()-oa)),ia=sa.a.KF(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.wK()),ia=Object.assign(new ma.a,{durationMs:Math.floor(ta.a.Ue()-oa),extendedProperties:ia}),ja.Health.instance.recordKpiFailure(Ha.kpiName,"StrategyLoadTimedOut",!1,!0,ia)));return Promise.resolve(wa)},()=>{l.ULS.sendTraceTag(562128584,
3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.wK(),Math.floor(ta.a.Ue()-oa));return Promise.resolve(1)})}T4(oa,wa,ia=null){return this.Wkc(oa,wa,!1,null,"",ia)}Wvj(oa,wa,ia,ca,pa=null){return this.Wkc(oa,wa,!0,ia,ca,pa)}Wkc(oa,wa,ia,ca,pa,Ma,ya=0){ya+=1;l.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",oa,this.zMb(oa,wa),this.wK(),ya);var Oa=sa.a.KF();void 0!==Oa&&null!==Oa&&
(Oa.set("AuthLibrary",this.wK()),Oa.set("AppName",oa),Oa.set("Target",this.zMb(oa,wa)),ja.Health.instance.recordKpiUsage(Ha.kpiName,0,"WacOAuthFC",Oa));if(!v.OAuthManagerSettings.isEnabled){var fa;return this.QHf((fa=new x.a,fa.IsSuccess=!1,fa.Token=null,fa.ErrorCode="NotEnabled",fa.ErrorMessage="OAuthManager is disabled.",fa),oa)}const Ca=v.OAuthManagerSettings.KZe[oa];if(void 0===Ca||null===Ca){l.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
oa);var Ta;return this.QHf((Ta=new x.a,Ta.IsSuccess=!1,Ta.Token=null,Ta.ErrorCode="DisallowedApp",Ta.ErrorMessage="Disallowed appName: "+oa,Ta),oa)}const eb=ta.a.Ue();let jb=eb;const ob=this;Oa=this.e0j.then(ab=>{jb=ta.a.Ue();return ob.Mwm(oa,Ca,wa,ia,ca,pa,Ma,ab)});fa=ia?0:v.OAuthManagerSettings.WYf;let Ya;Ta=(Ya=new x.a,Ya.IsSuccess=!1,Ya.Token=null,Ya.ErrorCode="authTokenStrategy_timeout",Ya.ErrorMessage="Auth Strategy timed out after ["+fa+"] ms when fetching token",Ya);let Xa=this,Sa=this;return u.get(Oa,
Ta,fa).then(ab=>ya<=Ha.R5m&&(ab.ErrorCode===Ha.Rsj||ab.ErrorCode===Ha.uwo)?(l.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",ya,Math.floor(ta.a.Ue()-eb)),Xa.Wkc(oa,wa,ia,ca,pa,Ma,ya)):ab.ErrorCode===Ha.zzi&&!ia&&(l.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",ya,Ha.ERh),Ha.tml&&Xa.cda.Hie()&&Xa.cda.Vke(oa,Ca,wa,ia,ca,pa).then(Hb=>Promise.resolve(Xa.k1d(Hb,oa,wa,Ca,eb,jb))).catch(()=>
{let Hb;const pb=(Hb=new x.a,Hb.IsSuccess=!1,Hb.Token=null,Hb.ErrorCode="authTokenStrategy_failure",Hb.ErrorMessage="LoginPopup failed, GetToken could not be called",Hb);return Promise.resolve(Xa.k1d(pb,oa,wa,Ca,eb,jb))}),Ha.ERh)?Xa.Wkc(oa,wa,!0,ca,pa,Ma,ya):Promise.resolve(Xa.k1d(ab,oa,wa,Ca,eb,jb))).catch(()=>{let ab;const Hb=(ab=new x.a,ab.IsSuccess=!1,ab.Token=null,ab.ErrorCode="authTokenStrategy_failure",ab.ErrorMessage="Auth Strategy failed with an unknown error",ab);return Promise.resolve(Sa.k1d(Hb,
oa,wa,Ca,eb,jb))})}Mwm(oa,wa,ia,ca,pa,Ma,ya,Oa){return 1===Oa||2===Oa?this.QHf(Object.assign(new x.a,{IsSuccess:!1,Token:null,ErrorCode:1===Oa?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),oa):this.cda.T4(oa,wa,ia,ca,pa,Ma,ya).then(fa=>Promise.resolve(this.PKi(fa,!0,oa))).catch(fa=>Promise.resolve(this.PKi(fa,!1,oa)))}k1d(oa,wa,ia,ca,pa,Ma){const ya={},Oa=ta.a.Ue()-Ma;ya.IsSuccess=oa.IsSuccess;ya.ErrorCode=oa.IsSuccess?"Success":oa.ErrorCode||"";ya.ErrorMessage=
oa.IsSuccess?"Success":this.zMb(wa,oa.ErrorMessage||"");ya.Target=this.zMb(wa,ia||"");ya.TimeInMS=Math.floor(Oa);ya.LoadTimeInMS=Math.floor(Ma-pa);ya.AuthLibrary=this.wK();ya.AppName=wa;ya.AuthorityType=Object(e.a)(k.a,m.a.sMd());ya.UserType=this.dam(m.a.getAuthContext());ya.IsAuthSupportedInSession=a.a[this.cja];ya.RequestCount=++this.Yvb;ya.AppId=ca;l.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(ya));oa.IsSuccess||(ia=sa.a.KF(),void 0!==ia&&null!==ia&&(ia.set("AppName",wa),ia.set("AuthLibrary",
this.wK()),ia.set("ErrorCode",oa.ErrorCode),ia.set("ErrorMessage",this.zMb(wa,oa.ErrorMessage)),wa=Object.assign(new ma.a,{durationMs:Oa,extendedProperties:ia}),ja.Health.instance.recordKpiFailure(Ha.kpiName,"TryGetTokenFailure",!1,!0,wa)));return oa}QHf(oa,wa){l.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",wa,this.zMb(wa,oa.ErrorMessage));const ia=sa.a.KF();void 0!==ia&&null!==ia&&(ia.set("AppName",wa),ia.set("AuthLibrary",this.wK()),
ia.set("ErrorCode",oa.ErrorCode),ia.set("ErrorMessage",this.zMb(wa,oa.ErrorMessage)),wa=Object.assign(new ma.a,{extendedProperties:ia}),ja.Health.instance.recordKpiFailure(Ha.kpiName,"FailureBeforeGetToken",!1,!0,wa));return Promise.resolve(oa)}gti(oa){return oa===Da.a.Pje}zMb(oa,wa){return this.gti(oa)&&wa?"REDACTED":wa}dam(oa){return z.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":!oa.loginHint||1>oa.loginHint.length?"empty":-1<oa.loginHint.indexOf("guest#")?"guest":-1<oa.loginHint.indexOf("ext#")?
"external":0>oa.upn.indexOf("@")?"no-at":"supported"}Vxm(){return 1===this.cja}PKi(oa,wa,ia){let ca=null,pa=null,Ma=null,ya=null;oa?oa.ErrorCode||oa.ErrorMessage?(pa=oa.ErrorCode?oa.ErrorCode:Ha.CTh,Ma=oa.ErrorMessage?oa.ErrorMessage:"No message"):oa.Token?wa?ca=oa.Token:(pa=Ha.rRn,Ma="A rejected promise returned a token."):(pa=Ha.CTh,Ma=JSON.stringify(oa)):(pa=Ha.san,Ma="No result came from Auth Token Strategy");oa&&oa.Telemetry&&!this.gti(ia)&&(ya=oa.Telemetry,l.ULS.sendTraceTag(579166408,3E3,50,
JSON.stringify(ya)));if(pa===Ha.U8m||pa===Ha.yDo)pa=Ha.Rsj,Ma="Auth Library Timed Out";pa===Ha.fBk&&-1<Ma.indexOf(Ha.pik)&&(pa=Ha.zzi);if(pa||Ma)ca=null;return Object.assign(new x.a,{IsSuccess:!!ca,Token:ca,ErrorCode:pa,ErrorMessage:Ma,Telemetry:ya})}static get ERh(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get tml(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}Ha.yDo="token_renewal_error";Ha.CTh="Exception";Ha.san="NoResult";Ha.rRn="RejectToken";Ha.U8m="monitor_window_timeout";Ha.Rsj="Timeout";Ha.uwo="authTokenStrategy_timeout";Ha.fBk="login_required";Ha.pik="AADSTS50058";Ha.zzi="Cookies Disabled";Ha.kpiName="OAuthManager";Ha.R5m=2;Object(D.a)(Ha,"OAuthManager",null,[161])},1580:function(D,L,c){D=c(0);class l{constructor(y,m,u,z){this.MTj=y;this.zak=m;this.xak=u;this.Aak=z}get vEd(){return this.MTj}get uce(){return this.zak}get sce(){return this.xak}get resultType(){return this.Aak}}
Object(D.a)(l,"SearchContext",null,[1269]);class e{JFd(y,m,u,z){var v=u-m;let E;if(100<=v)v=m,E=u;else{v=Math.max(0,m+Math.ceil(v/2)-50);E=Math.min(y.length,v+100);v=Math.max(0,E-100);let J;if(v&&" "!==y.charAt(v-1)){J=Math.min(m,v+10);for(var F=v;F<J;++F)if(" "===y.charAt(F)){v=F+1;break}}if(E!==y.length&&" "!==y.charAt(E))for(J=Math.max(u,E-10),F=E-1;F>=J;--F)if(" "===y.charAt(F)){E=F;break}}y=y.substring(v,E);return new l(y,m-v,u-v,z)}KFd(y){return this.JFd(y.I9h(),y.begin,y.end,"")}}Object(D.a)(e,
"SearchContextFactory",null,[1243]);var a=c(139),k=c(1565);c.d(L,"a",function(){return x});class x extends e{constructor(){super()}KFd(y){let m=y.begin,u=y.end;const z=({begin:m,end:u}=x.f_l(y,m,u)).returnValue;y=k.a(y.type);return this.JFd(z,m,u,y)}static get instance(){return null!=x.qyg?x.qyg:x.qyg=new x}static f_l(y,m,u){y=y.I9h();return x.f4i(y,m,u)}static f4i(y,m,u){const z=a.AParagraphNode.CU(y);if(z.length<y.length){y=y.substring(0,m);const v=a.AParagraphNode.CU(y);y=y.length-v.length;m-=
y;u-=y}return{returnValue:z,begin:m,end:u}}}Object(D.a)(x,"EditorSearchContextFactory",e,[])},1582:function(D,L,c){D=c(0);var l=c(2),e=c(21),a=c(312),k=c(723),x=c(24),y=c(11),m=c(142),u=c(52),z=c(564),v=c(215),E=c(263),F=c(95),J=c(31),K=c(10),H=c(3),P=c(6),N=c(602),M=c(1043);class I{create(){return new M.a}}Object(D.a)(I,"FootnoteEndnoteContainerNodeFactory",null,[378]);var T=c(557);c.d(L,"a",function(){return U});class U{constructor(W,V,Y,da,ba,ja,sa,ta,ra){this.Yvd=null;U.ga=W;this.nF=Y;this.SKe=
da;this.nTj=ja;this.Xc=sa;this.ib=ba;this.C5j=ta;this.xUj=ra;U.Fh=V}e3d(W,V){this.Pnl(W);W.Tb(7);this.nF.eti(W,V)||W.wf(7)}Pnl(W){if(this.SKe.zvi(W)){var V=!1,Y=!1;if(W.Tb(7)){do{const da=W.currentNode;if(37===da.type)switch(da.getValue(P.a.C7)){case 0:Y=!0;break;case 1:V=!0}}while(W.Ti(7))}Y||this.$jh(W,0);V||this.$jh(W,1)}}$jh(W,V){const Y=this.nTj.create(1074135124);Y.setValue(P.a.C7,V);W.Qf(Y,7)}$5n(W){W&&this.Obj(W.tma)}Obj(W){W&&(W=x.SelectionFactory.te(W.Kb.paragraph,W.Kb.cp+1),this.ib.setSelection(W))}q$m(W){let V=
this.C5j(W);void 0!==V&&null!==V?this.nF.Ena(V)&&(V=this.nF.j$h(V)):V=W;return this.xUj(V)}Nqo(){this.Yvd?U.Fh.notificationBar.removeEntry(this.Yvd):this.Yvd=U.Fh.notificationBar.Jla(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);U.Fh.notificationBar.Kz(this.Yvd)}wxk(W,V){W=this.Xc.KDa(W,37,37);let Y=!1;if(W.Sd()){do{const da=W.currentNode;this.nF.WDf(da)?this.Zph(da,V):Y=!0}while(W.Wj())}Y&&this.Nqo()}Zph(W,V){N.e(W,Y=>{U.eAl(Y,V);return!0},12)}cim(W,V){W=
this.nF.VNd(W,V);return W?(W=this.Xc.Wf(W))?W.dA():!1:!1}P4h(W,V){W=this.nF.VNd(W,V);W=this.Xc.Wf(W);if(W.Sd()){do if(V=W.currentNode,1===V.getValue(P.a.uma))return V;while(W.Wj())}return null}static YMc(){return new U(l.AFrameworkApplication.xa,y.App.ya,T.a.instance,m.PageReader.instance,u.a.instance,new I,new z.a,v.OutlineNavigator.m$m,E.WordSectionNavigator.Uaf)}static get instance(){return null!=U.Ayg?U.Ayg:U.Ayg=U.YMc()}static get paragraphEditor(){return null!=U.XBg?U.XBg:U.XBg=e.a.instance.resolve("Box4.IParagraphEditor")}static eAl(W,
V){V.xhb?U.paragraphEditor.Xp.sca(W,F.OutlineReader.eX(W)):U.paragraphEditor.Xp.sca(W,0);W=J.a.createTextRange(W,0,K.ParagraphReader.textLength(W));U.ga.Nf(W,H.a.font,2,!0,new a.a,new k.a(V.fontName));U.ga.Nf(W,H.a.wA,2,!0,new a.a,new k.a(V.fontSize))}}U.ga=null;U.Fh=null;Object(D.a)(U,"FootnoteEndnoteEditor",null,[493])},1590:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";
e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported"})(l||(l={}));Object(D.b)("SupportStatus",l)},1600:function(D,L,c){c.d(L,"a",function(){return K});D=c(0);var l=c(381),e=c(60),a=c(21),k=c(108),x=c(8),y=c(117),m=c(82),u=c(14),z=c(111),v=c(554),E=c(139),F=c(135),J=c(10);class K{constructor(H,P,N,M,I,T=null,U="",W=!0,V=!1){this.E_a=this.Uhe=this.Mmb=this.rZi=this.Vbe=null;this.$Sc=!1;this.Xwf=null;this.aPf=0;this.context=H;this.je=H.view;this.ex=
P;this.qd=I;this.ZQ=N;this.Z8=M;this.Yha=this.failed=!1;this.h7d=null;this.b2a=this.V$b=!1;this.Dro=K.Q7e(H);this.browserName=U;this.YBj=W;this.LUc=V;this.HTa=!1;this.v2b=0;if(H=Object(y.a)(114,I)?I:null){this.rZi=new l.DictionaryPropertySet;this.rZi.Aw(H);N=H.ia(k.a.N_c,e.a.nil);this.vFc=N!=e.a.nil?N.toString():e.a.create().toString();if(H.ia(k.a.sVi,!1)){this.V$b=!0;this.b2a=H.ia(k.a.b2a,!1);this.h7d=T;for(T=this.je.nb.pg;T.Hw;)T=T.getContext(0);if(I=Object(m.a)(E.AParagraphNode,T.node)){N=0;M=
J.ParagraphReader.textLength(I);switch(T.contextId){case u.a.Fd:N=T.cpBegin;M=T.cpEnd;break;case u.a.endOfParagraph:N=M}this.Vbe=z.FormattingReader.QNd(T.node,N,T.Fb);x.ULS.shipAssertTag(6305503,307,!!this.Vbe);I=F.HyperlinkReader.jNc(I);for(const Y of I)Y.cpEnd<=N||Y.cpBegin>=M||K.hyperlinkEditor.iR(T.node,Y.hyperlink)}}this.Yha=H.ia(k.a.Yha,!1);this.HTa=H.ia(k.a.HTa,!1);this.Mmb=H.ia(k.a.Mmb,null)}else this.vFc=e.a.create().toString();P&64&&(this.Yha=!0)}static get hyperlinkEditor(){return null!=
K.ixg?K.ixg:K.ixg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static Q7e(H){if(H){if(H.Hw){for(let P=0;P<H.length;P++)if(K.Q7e(H.getContext(P)))return!0;return!1}if(Object(y.a)(v.a,H))return K.Q7e(H.Yj);if(J.ParagraphReader.Yb(H.node)&&H.node.JN)return!0}return!1}}Object(D.a)(K,"ClipboardActionArguments",null,[])},1601:function(D,L,c){c.d(L,"a",function(){return P});D=c(0);var l=c(21),e=c(60),a=c(47),k=c(652),x=c(142),y=c(564),m=c(169),u=c(11),z=c(120),v=c(6),E=c(879),F=c(775),J=c(557),K=c(1531),
H=c(1582);class P{constructor(N,M,I,T,U,W){this.nF=N;this.WJa=I;this.SKe=T;this.Hve=U;this.Xc=W}Ptm(N,M,I){const T=this.i7h(M,N.node),U=N.node.Mc;if(!U)return null;const W=new a.GraphTransaction(15);W.Eb(N.node);W.kk=I;I=this.Qtm(T,M);P.Rtm(I,U,N,M);W.dispose();return I}i7h(N,M){const I=this.Xc.Ck();I.set(M);I.Ab(7);I.fd(7);this.WJa.e3d(I,N);return I}Qtm(N,M){const I=F.a.createNode();I.properties.setValue(v.a.C7,M);N.Qf(I,8);this.Hve.H2k(I,M);return I}static get characterPropertiesEditor(){return null!=
P.ctg?P.ctg:P.ctg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get CR(){return P.pW||(P.pW=new k.WACStyleSet)}static set CR(N){P.pW=N}static YMc(){const {FootnoteEndnoteDefaultContentInserter:N}=c(1674);return new P(J.a.instance,K.a.instance,H.a.instance,x.PageReader.instance,N.instance,new y.a)}static get instance(){return null!=P.gzg?P.gzg:P.gzg=P.YMc()}static get eh(){return P.UB||(P.UB=m.PageNavigator.instance)}static set eh(N){P.UB=N}static Rtm(N,M,I,T){u.App.xd.Yp&&u.App.xd.Vq.aH(I.node);
const U=new z.a;U.setValue(v.a.v5b,N.id);U.setValue(v.a.C7,T);const W=M.Du(U,e.a.create());P.characterPropertiesEditor.jga(I,V=>E.a.getInstance(V,W,N.id),P.z1h(I.node,T))}static z1h(N,M){let I=null;(N=P.eh.Ms(N))&&(N=P.CR.tQ(N))&&(I=N.cEa(M?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return I}}P.pW=null;P.UB=null;Object(D.a)(P,"FootnoteEndnoteInserter",null,[559])},1607:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{static uXn(e,
a){l.sKe=e;l.yNe=a}static rXn(e,a){l.wNe=e;l.IXa=a}static ebi(){return l.wNe===l.IXa?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,l.IXa,l.sKe,l.yNe):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,l.wNe,l.IXa,l.sKe,l.yNe)}}l.wNe=0;l.IXa=0;l.sKe=null;l.yNe=null;Object(D.a)(l,"ReplaceAllContext",null,[])},1631:function(D,L,c){c.r(L);D=c(0);var l=c(2001),e=c(60),a=c(2),k=c(337),x=c(21),y=c(1925),m=c(11),u=c(8),z=c(234),v=c(2003),E=c(12),F=c(18),J=c(1580);class K{constructor(Ub=
"",Wb="",Qa=!1,sb=!1){this.XFm=Qa;this.uJm=sb;this.actionId=Ub;this.sHa=Wb}}Object(D.a)(K,"SearchEntryPointContext",null,[]);class H{constructor(Ub){this.Zda=null;this.ys=!1;this.UM=Ub}initialize(){this.CZ();this.gz();this.V6(0)}gz(){this.Zda.gz()}dispose(){this.UM=null}iOc(){return!1}get NF(){return this.Zda?this.Zda.NF:0}V6(Ub){this.Zda.V6(Ub)}get isVisible(){return this.ys}BXe(Ub){this.Zda&&this.Zda.L5o(Ub)}e5i(Ub){this.Zda&&this.Zda.Ndp(Ub)}TAj(Ub){this.Zda&&this.Zda.fhp(Ub)}mAh(){this.Zda&&this.Zda.V6o()}zde(Ub){this.Zda&&
this.Zda.zde(Ub)}}Object(D.a)(H,"FindReplacePane",null,[375,9]);var P=c(57),N=c(1397),M=c(1057),I=c(155),T=c(158),U=c(1044),W=c(79),V=c(83),Y=c(75),da=c(48),ba=c(27),ja=c(441),sa=c(1494),ta=c(358),ra=c(1023),ma=c(708),Ba=c(80),Pa=c(1085);class Da{constructor(Ub){this.Mlk=(Wb,Qa)=>{this.Zvd.ob(Wb)?this.Zvd.Z(Wb,Qa):this.Zvd.add(Wb,Qa);(Wb=this.TEl(Wb))&&this.qpi(Qa,Wb,this.cFh(ta.a.getTypeName()))};this.Zvd=new Ba.a;this.iV=new Ba.a;this.annotationType=sa.RoleDetectionAnnotation.getTypeName();Ub.uNn(this.Mlk)}xD(Ub,
Wb){let Qa;const sb=Ub.parentPath.substr(Ub.parentPath.lastIndexOf("\\")+1),Jb=Ub.content;if(!Jb||this.aJm(Jb))""!==sb&&({value:Qa}=this.Zvd.Ec(sb,Qa)).returnValue&&this.qpi(Qa,Ub,this.cFh(Wb)),Wb===ta.a.getTypeName()?(Wb=null,({value:Wb}=this.iV.Ec(sb,Wb)).returnValue?this.iV.Z(sb,Ub):this.iV.add(sb,Ub)):Wb===ra.a.getTypeName()&&this.iV.remove(sb)}qpi(Ub,Wb,Qa){const sb=this.pUl(Wb);Wb=this.UEl(Wb);0<Wb&&Ub(Qa,sb,Wb)}UEl(Ub){try{return Number.parseInvariant(Ub.id.substr(2))}catch(Wb){u.ULS.sendTraceTag(554747009,
367,10,Wb.toString())}return-1}TEl(Ub){let Wb;return({value:Wb}=this.iV.Ec(Ub,Wb)).returnValue?Wb:null}m0c(Ub){if(Ub)for(const Wb of Ub)this.xD(Wb,"AugLoop_Core_AddOperation")}pUl(Ub){if(Ub=Ub.content)switch(Ub.roleType){case sa.RoleType.Heading1:return 1;case sa.RoleType.Heading2:return 2;case sa.RoleType.Heading3:return 3;case sa.RoleType.Heading4:return 4;case sa.RoleType.Heading5:return 5;case sa.RoleType.Heading6:return 6;case sa.RoleType.Heading7:return 7;case sa.RoleType.Heading8:return 8;
case sa.RoleType.Heading9:return 9}return-1}aJm(Ub){Ub=Ub.roleType;return Ub===sa.RoleType.Heading1||Ub===sa.RoleType.Heading2||Ub===sa.RoleType.Heading3||Ub===sa.RoleType.Heading4||Ub===sa.RoleType.Heading5||Ub===sa.RoleType.Heading6||Ub===sa.RoleType.Heading7||Ub===sa.RoleType.Heading8||Ub===sa.RoleType.Heading9}cFh(Ub){if(Ub===ta.a.getTypeName()||Ub===ma.a.getTypeName())return Pa.a.kXe;if(Ub===ra.a.getTypeName())return Pa.a.WGd;throw Error.create("Invalid operation type");}}Object(D.a)(Da,"RoleDetectionAnnotationHandler",
null,[126]);var Ha=c(144),oa=c(70),wa=c(1144),ia=c(52),ca=c(76),pa=c(46),Ma=c(205),ya=c(169),Oa=c(666);class fa extends Ma.a{constructor(Ub,Wb){super(Ub,Wb,m.App.Oca);this.QZd=null;this.Bhb=this.y0b=0;this.headingsReady=!1;this.yRa=this.edb=0;this.HEi=!1;this.Q3g=this.GUg=this.QQg=null}get yZd(){return!0}get eUh(){return this.QQg}get w3d(){return this.Q3g}dDj(){this.headingsReady&&(this.GUg.style.display="none",this.Bhb||this.y0b?(this.eUh.style.display="none",this.container.style.display="block"):
(this.container.style.display="none",this.eUh.style.display="block"))}get Y7(){return super.Y7|240}static $9e(Ub,Wb,Qa){var sb=m.App.ya.jb.Wc;if(sb&&(sb=ya.PageNavigator.instance.HT(sb))){const Jb=new fa(new Oa.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"));Jb.Bhb=0;Jb.y0b=0;Jb.QZd=null;Jb.Nyb(Ub);Jb.QQg=Wb;Jb.GUg=Qa;Jb.nE(sb);Jb.headingsReady=!0;Jb.dDj();Jb.Q3g=null;return Jb}return null}}Object(D.a)(fa,"WordNavigationPaneHeadingsView",Ma.a,[409,256,134,9]);class Ca{constructor(Ub){this.iV=
new Ba.a;this.c5g=Ub}xD(Ub,Wb){Wb===ta.a.getTypeName()?(Wb=null,({value:Wb}=this.iV.Ec(Ub.id,Wb)).returnValue?this.iV.Z(Ub.id,Ub):this.iV.add(Ub.id,Ub)):Wb===ra.a.getTypeName()&&this.iV.remove(Ub.id);this.c5g&&this.c5g()}m0c(Ub){if(Ub)for(const Wb of Ub)this.xD(Wb,ta.a.getTypeName())}R5b(){var Ub;const Wb=[];if(0<(null===(Ub=this.iV)||void 0===Ub?void 0:Ub.count))for(const Qa of this.iV.values)Wb.push(Qa);return Wb}}Object(D.a)(Ca,"ContractEntityAnnotationHandler",null,[126]);var Ta=c(3);class eb{constructor(Ub){this.ga=
Ub}yfn(){this.cancelSearch()}Chn(Ub){this.ga.Rb(F.a.wRd,2,Ub)}Mkn(){this.cancelSearch()}cancelSearch(){this.ga.processAction(Ta.a.nzb,2)}Smn(){this.ga.processAction(Ta.a.findOnPage,2)}onSearchQueryChanged(Ub){this.ga.Rb(Ta.a.KKd,2,Ub)}Bon(){this.ga.processAction(F.a.replace,2)}Con(){this.ga.processAction(F.a.replaceAll,2)}xon(){this.ga.processAction(E.a.Shf,2)}yon(){this.ga.processAction(E.a.fif,2)}Aon(){this.ga.processAction(Ta.a.r9d,2)}zon(){this.ga.processAction(Ta.a.L3d,2)}Afc(Ub){this.ga.Rb(F.a.Afc,
2,Ub)}}Object(D.a)(eb,"FindReplaceActions",null,[408]);var jb=c(293);class ob{}ob.UO=jb.a.Ofb;ob.qec=0;ob.gua="FindReplaceTaskPaneData";ob.rR=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(D.a)(ob,"FindReplaceConstants",null,[]);var Ya=c(771);class Xa{Pvj(Ub){var Wb,Qa,sb;return ja.a.Qgb(null===(sb=null===(Qa=null===(Wb=m.App.ya)||void 0===Wb?void 0:Wb.jb)||void 0===Qa?void 0:Qa.Wc)||void 0===sb?void 0:sb.ud,Ub)}clearSelection(){if(this.iGe){const Ub=this.Pvj(this.iGe);Ub&&Ub.Oea()}this.iGe=
this.Zah=null}R5n(Ub){this.clearSelection();if(Ub){const Wb=this.Pvj(Ub.parentPath);if(Wb){const Qa=Ub.content;Qa&&(this.Zah=Ub.id,Wb.cia([new Ya.a(Qa.range.start,Qa.range.start+Qa.range.length)]),Wb.wJf(0,1));this.iGe=Ub.parentPath}}}}Object(D.a)(Xa,"RangeAnnotationContentSelector",null,[]);var Sa=c(1607);class ab{constructor(Ub){this.O3j=Ub}get Jj(){return this.O3j.value}PXl(Ub){Ub=this.Jj.z0a(Ub);return this.yCm(Ub)?null:Ub}yCm(Ub){return Ub.id===this.Jj.wDa.id}static get instance(){return null!=
ab.Uxg?ab.Uxg:ab.Uxg=ab.vE()}static vE(){const Ub=new z.a(()=>y.FindManager.instance.Jj);return new ab(Ub)}}Object(D.a)(ab,"SearchResultOrder",null,[]);var Hb=c(10),pb=c(213);class Mb{constructor(Ub){this.EGe=Ub}get j0(){return this.EGe.value}getSelectedText(){var Ub=this.j0.d3;if(Ub){const Wb=Ub.cpBegin,Qa=Ub.cpEnd-Wb;if(0<Qa&&(Ub=Ub.node,Hb.ParagraphReader.Yb(Ub)))return Ub.characterData.substr(Wb,Qa)}return null}static getInstance(){return Mb.Sl()}static Sl(){const Ub=new z.a(()=>pb.a.instance);
return new Mb(Ub)}}Object(D.a)(Mb,"SelectionHelper",null,[]);var Qb=c(28),Aa=c(126),bb=c(397),nb=c(858),Va=c(254),Ab=c(399),Zb=c(1839),Kb=c(400);class dc extends Ma.a{constructor(Ub,Wb,Qa){super(Ub,Wb,m.App.Oca);this.J4a=Qa;this.rii=!1}get yZd(){return!0}get Y7(){return super.Y7|248}static $9e(Ub){var Wb=m.App.ya.jb.Wc;const Qa=Kb.a.instance.Qc(3);return Wb&&(Wb=ya.PageNavigator.instance.HT(Wb))?(Ub=new dc(new Oa.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),Ub),Qa.b6c(Ub.jc),Ub.nE(Wb),Qa.dispose(),
Ub.rii=!0,Ub):null}}Object(D.a)(dc,"WordNavigationPaneReactHeadingsView",Ma.a,[256,134,9]);class jc extends H{constructor(Ub,Wb,Qa,sb,Jb,pc,rc,db,lb,qa,Ga,Fb,$b){var rb,xb,gb;super(Ub);this.lsb=ob.UO;this.Xek="FindReplaceTaskPaneProps";this.Vb=P.FocusManager.instance();this.AUa=this.ELa=this.$Y=this.GRe=null;this.uRb=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.Wcd=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.Ond=(null===(rb=a.AFrameworkApplication.K)||void 0===
rb?void 0:rb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactHeadings",!1))||(null===(xb=a.AFrameworkApplication.K)||void 0===xb?void 0:xb.$("NavPaneReactHeadings"));this.A5j=null===(gb=a.AFrameworkApplication.K)||void 0===gb?void 0:gb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.Bzj=()=>{this.isVisible&&this.dGd===v.a.intelligentPlaceholder&&this.wm()};this.QA=new N.a;this.BTg=Wb;this.qJa=v.a.headings;this.KBc=l.a.initial;this.ura=new ca.a;this.mP=
"";this.Trc={matchCase:!1,matchWholeWord:!1};this.xNe="";this.lPe=null;this.k2=Qa;this.Lch=!1;this.Gbb=sb;this.ib=Jb;this.Q5j=pc;this.lBa=rc;this.dI=db;this.Kod=!0;this.d6=this.c6=!1;this.Ze=lb;this.OG=qa;this.Gb=Ga;this.g5=Fb;this.AMg=$b;this.pre&&this.lBa.cRn(()=>{this.wm()})}get pSe(){return 1}get pre(){return this.uRb&&this.Wcd&&!!this.Ze}get qre(){return this.uRb&&this.A5j&&!!this.Ze}get headingsReady(){return this.Ond?this.OG.headingsReady:this.Pid?this.Pid.headingsReady:!1}set headingsReady(Ub){this.Ond?
this.OG.headingsReady=Ub:this.Pid&&(this.Pid.headingsReady=Ub)}get dGd(){return this.qJa}Clj(){this.qJa=v.a.headings;this.wm()}loo(){this.qJa=v.a.contracts;this.wm()}tlj(){this.qJa=v.a.find;da.a("NavigationPaneFind");this.wm()}kmj(){this.qJa=v.a.replace;this.wm()}Olj(){this.qJa=v.a.intelligentPlaceholder;this.wm()}P6c(Ub){this.Lch=Ub;this.wm()}iOc(){return this.dGd===v.a.replace}get NF(){return this.KBc}V6(Ub){this.KBc=Ub;this.wm()}BXe(Ub){this.Tnk(Ub);this.wm()}Tnk(Ub){const Wb=this.Q5j(Ub[Ub.length-
1]);if(Wb){let Qa=-1;for(let sb=0;sb<this.ura.count;sb++)if(Wb.id===this.ura.J(sb).id){Qa=sb;break}-1===Qa?u.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.ura.fA(Qa,this.BFh(Ub))}else this.ura.addRange(this.BFh(Ub))}e5i(Ub){for(const Wb of Ub)for(Ub=this.ura.count-1;0<=Ub;Ub--)if(this.ura.J(Ub).id===Wb.id){this.ura.removeAt(Ub);break}this.wm()}TAj(Ub){for(const Wb of Ub)for(Ub=this.ura.count-1;0<=Ub;Ub--)if(this.ura.J(Ub).id===Wb.id){this.ura.Z(Ub,this.AFh(Wb));
break}this.wm()}mAh(){this.ura.clear();this.lPe=null;this.wm()}zde(Ub){this.lPe=Ub?Ub.id:null;this.wm()}BFh(Ub){if(!Ub)return new ca.a;const Wb=new ca.a;for(const Qa of Ub)Wb.add(this.AFh(Qa));return Wb}AFh(Ub){const Wb=this.Gbb.KFd(Ub);return{id:Ub.id,searchBeginIndex:Wb.uce,searchEndIndex:Wb.sce,searchResult:Wb.vEd}}Sle(){}vRo(){var Ub={};this.UM.Afc(Ub);Ub=Ub[M.a.Value];this.GRe=ba.c(Ub)?"":Ub;this.wm()}sOa(){return this.mP}VDb(){return this.xNe}r8f(Ub){this.mP=Ub;this.wm()}clearSearch(){}initialize(){this.ttd=
window.performance.now();const Ub=this.Vb.fe(this.lsb);Ub.parent=I.AFrame.qp;Ub.zH=!0;this.CZ();this.V6(l.a.initial)}NO(){this.isVisible?(u.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),T.UISurfaces.uu().then(Ub=>{Ub.setSelectedTaskPane(this.lsb,this.pSe);this.g9();this.Kod&&this.Jgj(!0);return null}).catch(Ub=>{jc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Ub)})):(this.W6c(),this.Kod&&this.Jgj(!1))}Jgj(Ub){const Wb=
this.BTg();Wb?this.mP=Wb:Ub&&this.mP||(this.mP="");this.UM.onSearchQueryChanged(this.mP)}jna(){T.UISurfaces.uu().then(Ub=>{Ub.hideTaskPane(this.lsb,this.pSe);return null}).catch(Ub=>{jc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Ub)})}CZ(){this.k2.lNa();this.$Y=this.k2.X2b(this.Vb);this.ylk()}W6c(){T.UISurfaces.uu().then(Ub=>{this.ttd=window.performance.now();Ub.showTaskPane(this.lsb,this.Pz());Ub=[Object.assign(new Qb.a,{name:"Tab",string:this.qJa})];const Wb=window.performance.now()-
this.ttd;da.a("NavigationPaneOpen",!0,Wb,Ub);return null}).catch(Ub=>{jc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Ub)})}wm(){T.UISurfaces.uu().then(Ub=>{Ub.updateTaskPane(this.lsb,this.Pz());return null}).catch(Ub=>{jc.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],Ub)})}Pz(){const Ub={activeTab:v.a.initial};this.QA.snb(Ub);return Object.assign(new U.a,{title:ob.rR,hideHeader:!1,width:320,location:this.pSe,contentProps:Ub,onOpen:()=>{this.ys=
!0;this.BQn();this.HNn();this.Kod&&this.g9();m.App.ya.updateCommandUI();m.App.ya.mYa(this.Bzj)},onClose:()=>{try{const Wb=window.performance.now();this.tca();this.ys=!1;this.YJo();this.BKo();this.UM.Mkn();this.GRe="";this.KBc=l.a.initial;m.App.ya.dgc(this.Bzj);m.App.ya.updateCommandUI();const Qa=window.performance.now()-Wb;da.a("NavigationPaneClose",!0,Qa)}catch(Wb){jc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Wb)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,
isModernPane:!0})}BQn(){this.pre&&!this.ELa&&ja.a.Bl().then(()=>{this.ELa=new Da(this.lBa);this.Ze.mb(this.ELa,this.ELa.annotationType);this.Ze.getAnnotationsByType(this.ELa.annotationType).then(Ub=>{this.ELa.m0c(Ub)})})}BKo(){this.pre&&this.ELa&&(this.Ze.sc(this.ELa,this.ELa.annotationType),this.ELa=null)}DFo(){if(this.qre){var Ub=new Zb.ContractEntitySignal;Ub=Object.assign(new nb.a,{parentPath:["Signal",Va.a.getTypeNameFor(Ub)],items:[Object.assign(new Ab.a,{body:Ub})]});this.g5.getAugLoopRuntimeManager().submitOperation(Object.assign(new bb.a,
{operation:Ub}))}}HNn(){this.qre&&!this.AUa&&ja.a.Bl().then(()=>{this.AUa=new Ca(this.wm);this.Ze.mb(this.AUa,Zb.ContractEntityAnnotation.getTypeName());this.DFo();this.Ze.getAnnotationsByType(Zb.ContractEntityAnnotation.getTypeName()).then(Ub=>{this.AUa.m0c(Ub)})})}YJo(){this.qre&&this.AUa&&(this.Ze.sc(this.AUa,Zb.ContractEntityAnnotation.getTypeName()),this.AUa=null)}ylk(){this.QA.UK(this.SOl());this.QA.UK(this.UOl());this.QA.UK(this.qRl());this.QA.UK(this.qKl());this.QA.UK(this.kTl());this.QA.UK(this.sDl());
this.QA.UK(this.onLinkExecute());this.QA.UK(this.onPivotTabExecute());this.QA.UK(this.G5l());this.QA.UK(this.t8l());this.QA.UK(this.QSl());this.QA.UK(this.k9l());this.QA.UK(this.U2l())}k9l(){return Ub=>{Ub.autoDetectedHeadingsToggleDisabled=this.lBa?!this.lBa.BBk():!0}}t8l(){return Ub=>{Ub.type=this.Xek}}onLinkExecute(){return Ub=>{Ub.onLinkExecute=()=>{this.UM.Smn()}}}onPivotTabExecute(){return Ub=>{Ub.onPivotTabExecute=Wb=>{switch(Wb){case v.a.headings:this.Clj();break;case v.a.replace:this.kmj();
break;case v.a.contracts:this.loo();break;case v.a.intelligentPlaceholder:this.Olj();break;default:this.tlj()}ba.b(this.mP)&&(this.mP=this.BTg(),this.mP||(this.mP=""),ba.b(this.mP)||(this.UM.onSearchQueryChanged(this.mP),this.wm()))}}}G5l(){return Ub=>{Ub.showOutOfSyncNotification=this.Lch}}UOl(){return Ub=>{Ub.findSearchBoxContent={onSearchQueryChanged:Wb=>{this.mP=Wb;this.wm();this.UM.onSearchQueryChanged(Wb)},findOptions:this.Trc,matchCase:this.c6,matchWholeWord:this.d6,findSearchText:this.mP,
onClearButtonExecute:()=>{void 0!==this.mP&&null!==this.mP&&""!==this.mP&&(this.mP="",this.ib.setSelection(null),this.UM.yfn())},onMatchCaseExecute:()=>{this.Trc.matchCase=!this.Trc.matchCase;this.c6=!this.c6;this.wm();this.UM.xon()},onMatchWholeWordExecute:()=>{this.Trc.matchWholeWord=!this.Trc.matchWholeWord;this.d6=!this.d6;this.wm();this.UM.yon()},onMenuClose:()=>{if(this.$Y)this.$Y.onMenuClose()},onMenuOpen:()=>{if(this.$Y)this.$Y.onMenuOpen()}}}}sDl(){return Ub=>{Ub.activeTab=this.dGd}}QSl(){return Ub=>
{Ub.autoDetectedHeadingsToggleState=this.lBa?this.lBa.A0e:!1;this.OG.dKc=Ub.autoDetectedHeadingsToggleState;!Ub.autoDetectedHeadingsToggleState&&this.lBa&&this.lBa.wkc(!1)}}SOl(){return Ub=>{const Wb={onReplaceAllExecute:()=>{this.UM.Con()},onReplaceExecute:()=>{this.UM.Bon()},onReplaceQueryChanged:Qa=>{this.xNe=Qa;this.wm()},replaceSearchText:this.xNe};Ub.findReplaceContent={searchResults:this.ura.toArray(),replaceSearchBoxContent:Wb,onNextSearchResultExecute:()=>{this.UM.zon()},onPrevSearchResultExecute:()=>
{this.UM.Aon()},onSearchResultSelected:Qa=>{const {FindReplaceUIManager:sb}=c(1631);this.UM.Chn(Qa);sb.lEi(1)},selectedResultId:this.lPe,summaryLabel:this.GRe,explanationText:this.iOl(this.KBc),haveTooManySearchResults:this.KBc===l.a.tooManyResults}}}iOl(Ub){switch(Ub){case l.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case l.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case l.a.replaceAllComplete:return Sa.a.ebi();case l.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;
default:return""}}U2l(){return Ub=>{Ub.replaceFollowUpsWithCommentsIsEnabled=!0}}kTl(){return Ub=>{var Wb=this.dI.fEl();const Qa=[];for(const sb of Wb)Wb=this.dI.lMd(sb.Mc,sb.id),Qa.push({id:sb.id.toString(),intelligentPlaceholderAnchorText:Wb});Ub.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:Qa,onIntelligentPlaceholderInputExecute:sb=>{this.mP=sb;this.qJa=v.a.find;this.wm();this.UM.onSearchQueryChanged(sb)},onSearchResultSelected:sb=>{this.wm();sb=e.a.Gf(sb);this.dI.a6n(sb)}}}}qRl(){return Ub=>
{let Wb=()=>{};this.lBa&&(Wb=Object(pa.a)(this.lBa,this.lBa.wkc,"toggleAutoDetectedHeadings"));Ub.headingsContent={onHeaderInputExecute:Qa=>{this.mP=Qa;this.qJa=v.a.find;this.wm();da.a("NavigationPaneFind");this.UM.onSearchQueryChanged(Qa)},renderHeadingContent:(Qa,sb,Jb)=>{this.Gb.Wb(new W.a(0,1,100,()=>{var pc=window.performance.now()-this.ttd;if(this.Ond){var rc=this.OG.L8;this.headingsReady=!0;this.wm();Jb.style.display="none";rc.first&&(Qa.style.display="block");this.Gb.Wb(new W.a(1,1,0,()=>
{dc.$9e(this)}))}else this.Pid=fa.$9e(Qa,sb,Jb),this.wm();rc=window.performance.now()-this.ttd;da.a("NavigationPaneHeadingsLoaded",!0,rc,[Object.assign(new Qb.a,{name:"NavPaneReactHeadings",bool:this.Ond})]);pc=[Object.assign(new Qb.a,{name:"HeadingFetchStart",double:pc}),Object.assign(new Qb.a,{name:"HeadingFetchFinished",double:rc})];da.a("NavigationPaneHeadingsLoadDetails",!0,void 0,pc)}))},autoDetectedHeadingsToggle:Wb,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,
headingsList:this.OG.L8,onHeadingChevronClick:Qa=>{this.OG.Fql(Qa);this.wm()},onClickHeading:Qa=>{if(this.Gb.zv){u.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",Qa);const sb=window.performance.now();this.Gb.Wb(new W.a(0,1,0,()=>{this.OG.onClickHeading(Qa);this.wm();const Jb=window.performance.now()-sb;da.a("NavigationPaneAsyncOnClickHeadingItem",!0,Jb)}))}else this.OG.onClickHeading(Qa),this.wm()},onClickBookmark:Qa=>
{if(this.Gb.zv){u.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",Qa);const sb=window.performance.now();this.Gb.Wb(new W.a(0,1,0,()=>{this.OG.onClickBookmark(Qa);this.wm();const Jb=window.performance.now()-sb;da.a("NavigationPaneAsyncOnClickHeadingItem",!0,Jb)}))}else this.OG.onClickBookmark(Qa),this.wm()},onShareHeadingClick:Qa=>{this.OG.onShareHeadingClick(Qa)},bookmarkIconUrl:Ha.a.Bg("BookmarkDefault.png")}}}pKl(){var Ub,
Wb=null===(Ub=this.AUa)||void 0===Ub?void 0:Ub.R5b();if(Wb){Ub=Array(Wb.length);let Qa=0;for(const sb of Wb)(Wb=sb.content)&&(Ub[Qa++]={id:sb.id,type:Wb.type,value:Wb.value});return Ub}return null}qKl(){return Ub=>{Ub.contractsContent={onHeaderInputExecute:Wb=>{this.mP=Wb;this.qJa=v.a.find;this.wm();da.a("NavigationPaneFind");this.UM.onSearchQueryChanged(Wb)},contractEntities:this.pKl(),selectedEntityId:this.AMg.Zah,onEntitySelected:Wb=>{var Qa;const sb=null===(Qa=this.AUa)||void 0===Qa?void 0:Qa.R5b();
if(sb)for(const Jb of sb)if(Jb.id===Wb){this.AMg.R5n(Jb);break}this.wm()}}}}Zfj(Ub){this.Kod=Ub}HPo(Ub){this.Gb.Wb(new W.a(0,1,0,()=>{this.OG.njg(Ub)&&this.wm()}))}xem(Ub){this.Gb.Wb(new W.a(0,1,0,()=>{const Wb=this.OG.VKb;this.OG.vcl(Ub)?this.wm():0===this.OG.VKb&&0<Wb&&this.wm()}))}yig(Ub,Wb){this.Gb.Wb(new W.a(0,1,0,()=>{const Qa=this.OG.VKb;this.OG.yig(Ub,Wb)?this.wm():0<this.OG.VKb&&0===Qa&&this.wm()}))}Obl(Ub){this.Gb.Wb(new W.a(0,1,0,()=>{const Wb=this.OG.VKb;this.OG.Pbl(Ub)?this.wm():0===
this.OG.VKb&&0<Wb&&this.wm()}))}Vgo(Ub){this.OG.gDo(Ub);this.wm()}Yig(Ub){this.OG.Yig(Ub)&&this.wm()}pbf(Ub){this.OG.pbf(Ub)&&this.wm()}XDn(){return 0<this.OG.VKb}g9(){this.Vb.mg(this.lsb);u.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}tca(){if(this.G2a()){var Ub;(Ub=oa.InteractiveViewManager.instance.vd)?(Ub=Ub.GI,u.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(Ub=this.Vb.fT,u.ULS.sendTraceTag(40469192,312,50,
"Taskpane now hidden with focus on default scope."));this.Vb.mg(Ub)}}G2a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===this.lsb}static getInstance(){return jc.Sl()}static Sl(){return new jc(new eb(a.AFrameworkApplication.xa),Object(pa.a)(Mb.getInstance(),Mb.getInstance().getSelectedText,"getSelectedText"),wa.a.instance,J.a.instance,ia.a.instance,Object(pa.a)(ab.instance,ab.instance.PXl,"getNextSearchResult"),x.a.instance.Ma("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),
x.a.instance.Ma("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),x.a.instance.Ma("Box4.AugmentationLoop.IAnnotationStorage"),x.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),V.a.instance,x.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new Xa)}static recordQosError(Ub,Wb,Qa){const sb=Object.assign(new Aa.a,{extendedProperties:new Map});Qa&&sb.extendedProperties.set("exception",Qa);Y.Health.instance.recordQosError(Ub,Wb,!1,!0,!1,!1,sb)}}Object(D.a)(jc,
"ReactFindReplacePane",H,[374,375,9]);var zb=c(1565);c.d(L,"FindReplaceUIManager",function(){return cc});class cc{constructor(Ub,Wb,Qa=null,sb=null,Jb=null,pc=null){this.mfd=this.M1=0;this.d6=this.c6=this.Zwb=!1;this.am=this.p4g=this.Xia=null;this.aFa=this.xEe=!1;this.hj=Ub;this.Mp=Qa;this.Gbb=sb;this.$0g=Jb;this.ge=pc;cc.W0b=new K}get mDf(){return this.xEe}set mDf(Ub){Ub!==this.xEe&&(this.xEe=Ub,this.$yh())}Gfe(Ub){this.M1=Ub;this.update();this.M1||this.NF!==l.a.searchComplete&&this.NF!==l.a.tooManyResults?
0<this.M1&&this.NF===l.a.noMatchesFound?this.V6(l.a.searchComplete):this.M1>cc.ytj&&this.NF!==l.a.tooManyResults&&(u.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.V6(l.a.tooManyResults)):this.V6(l.a.noMatchesFound)}$de(Ub){this.mfd=Ub;this.aFa&&this.update();this.$0g&&!this.$0g.value.i3c&&this.N7f()}reset(){}dif(){this.ge&&(this.am=this.ge.eg("UserAction","Find"));if(this.aFa||!this.NF)this.aFa=!1,u.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.V6(l.a.searching)}e5b(){var Ub;
this.aFa=!0;let Wb=this.M1?l.a.searchComplete:l.a.noMatchesFound;if(this.NF!==l.a.tooManyResults&&y.FindManager.instance){const Qa=y.FindManager.instance.Jj;0<Qa.Cia&&(Qa.Cia>cc.ytj?Wb=l.a.tooManyResults:this.HQo(Qa))}this.V6(Wb);this.update();this.am&&(this.am.stop(),this.am=null);cc.tbj=e.a.create().toString();cc.lEi(0,this.m3b,this.sOa().length,this.M1);Object(zb.b)()&&(null===(Ub=this.hj)||void 0===Ub?0:Ub.isVisible)&&(Ub={},a.AFrameworkApplication.xa.Rb(E.a.S$d,2,Ub),Ub[k.a.On]&&a.AFrameworkApplication.xa.Rb(E.a.AVd,
2,{CommandValueId:{query:this.sOa(),matchCase:this.c6,matchWholeWordOnly:this.d6,totalResultLimit:-1}}))}HQo(Ub){const Wb=Ub.wDa;let Qa=Wb;const sb=[];do sb[sb.length]=Qa,Qa=Ub.z0a(Qa);while(Wb!==Qa);this.hj.BXe(sb);this.Xia&&this.hj.zde(this.Xia)}update(){this.hj&&this.hj.vRo()}get NF(){return this.hj.NF}get m3b(){return this.hj.dGd}vnb(Ub){this.mDf=Ub}$yh(){if(this.mDf)switch(this.NF){case l.a.searchComplete:case l.a.noMatchesFound:case l.a.tooManyResults:this.hj.P6c(!0)}else this.hj.P6c(!1)}V6(Ub){if(this.hj.isVisible){switch(Ub){case l.a.noMatchesFound:case l.a.searchComplete:this.NF===
l.a.tooManyResults&&(Ub=l.a.tooManyResults)}this.hj&&(this.hj.V6(Ub),this.$yh());this.update();this.N7f()}}WNa(Ub,Wb){const Qa=this.aFa&&this.NF!==l.a.tooManyResults;switch(Ub){case 0:Qa&&this.hj.BXe(Wb);break;case 1:Qa&&this.hj.e5i(Wb);break;case 4:Qa&&this.hj.TAj(Wb);break;case 2:this.hj.mAh();break;case 3:this.Xia=Wb[0],Qa&&0<this.M1&&this.hj.zde(this.Xia)}}get matchCase(){return this.c6}set matchCase(Ub){this.c6!==Ub&&(this.c6=Ub,this.bzj())}get matchWholeWord(){return this.d6}set matchWholeWord(Ub){this.d6!==
Ub&&(this.d6=Ub,this.bzj())}bzj(){this.hj.Sle()}sOa(){return this.hj.sOa()}VDb(){return this.hj.VDb()}r8f(Ub){this.hj.r8f(Ub)}clearSearch(){this.hj.clearSearch()}get lmj(){return 0<this.M1&&this.NF!==l.a.replaceAllInProgress&&this.NF!==l.a.replaceAllComplete}N9n(Ub){let Wb="";Ub?Wb=0<this.M1?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.sOa(),this.VDb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.sOa(),this.VDb()):
Ub||0<this.M1&&(Wb=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.N7f(Wb)}dispose(){this.hj.dispose()}iOc(){return this.hj.iOc()}Fdo(Ub,Wb=!0){Ub!==this.m3b&&(Ub===v.a.headings?(u.ULS.sendTraceTag(9056651,367,50,""),this.hj.Clj()):Ub===v.a.find?this.hj.tlj():Ub===v.a.replace?this.hj.kmj():Ub===v.a.intelligentPlaceholder&&(Wb||this.hj.Zfj(Wb),this.hj.Olj()))}AB(Ub,Wb=!0){this.hj.Zfj(Wb);Ub?(this.Zwb||this.Exf(),this.hj.NO(),this.M1||this.NF===l.a.noMatchesFound?a.AFrameworkApplication.K&&
a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.hj.V6(l.a.searchComplete):this.V6(l.a.initial)):this.hj.jna()}Exf(){this.Zwb||(this.hj.initialize(),this.Zwb=!0)}N7f(Ub=""){var Wb=this.h3l();Wb&&(Ub=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Ub,Wb));this.Gbb&&Wb&&this.Xia&&this.NF!==l.a.tooManyResults&&this.NF!==l.a.replaceAllInProgress&&(Wb=this.Gbb.KFd(this.Xia),Ub=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
Ub,Wb.vEd));(Wb=this.hOl())&&(Ub=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Ub,Wb));this.Mp&&Ub&&this.p4g!==Ub&&(this.p4g=Ub,this.Mp.sendNotification(Ub,!0))}h3l(){let Ub="";switch(this.NF){case l.a.startSearch:Ub=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case l.a.searchComplete:Ub=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.mfd,this.M1);break;case l.a.tooManyResults:this.aFa&&(Ub=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,
this.mfd,this.M1));break;case l.a.noMatchesFound:Ub=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case l.a.replaceAllInProgress:Ub=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case l.a.replaceAllComplete:Ub=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return Ub}hOl(){let Ub="";switch(this.NF){case l.a.initial:Ub=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,
this.MOl());break;case l.a.noMatchesFound:Ub=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case l.a.replaceAllComplete:Ub=Sa.a.ebi();break;case l.a.tooManyResults:Ub=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return Ub}MOl(){let Ub="";this.c6&&this.d6?Ub=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.c6?Ub=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchCase):this.d6&&(Ub=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return Ub}static getInstance(Ub){return cc.Sl(Ub)}static Sl(Ub){const Wb=jc.getInstance();return new cc(Wb,Ub,x.a.instance.resolve("Common.Utils.IAriaNotifier"),J.a.instance,new z.a(()=>y.FindManager.instance.VLb),m.App.ya.xq)}static lEi(Ub,Wb=-1,Qa=-1,sb=-1){u.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:Ub,["SearchComplete.ResultsCount"]:sb,
["SearchOpsCorrelation"]:cc.tbj,["ActionId"]:cc.W0b.actionId,["SourceControlId"]:cc.W0b.sHa,["IsNavPanOpenedAlready"]:cc.W0b.XFm,["IsSearchFromNavPane"]:cc.W0b.uJm,["CurrentTab"]:Wb,["QueryLength"]:Qa})}static fJk(Ub,Wb,Qa){Wb=void 0!==Wb&&null!==Wb?void 0===Wb.SourceControlId||null===Wb.SourceControlId?"Unknown":Wb.SourceControlId:Ub===F.a.Tnb?"FindKeyboardShorcut":Ub===F.a.Unb?"ReplaceKeyboardShorcut":"Unknown";switch(Ub){case F.a.Eic:Ub="ShowHeadingsPane";break;case F.a.Tnb:Ub="ShowFindPane";break;
case F.a.Unb:Ub="ShowReplacePane";break;case F.a.Iic:Ub="ShowIntelligentPlaceholderPane";break;case F.a.F6a:Ub="ToggleNavigationPane";break;default:Ub="Unknown"}cc.W0b=new K(Ub,Wb,Qa,!0)}}cc.ytj=100;cc.tbj=null;cc.W0b=null;Object(D.a)(cc,"FindReplaceUIManager",null,[329,159,9])},1632:function(D,L,c){c.r(L);D=c(0);var l=c(155),e=c(86),a=c(63),k=c(2),x=c(21),y=c(57),m=c(1088),u=c(143),z=c(11),v=c(8),E=c(18),F=c(293),J=c(505),K=c(1531),H=c(1801),P=c(23),N=c(299),M=c(7),I=c(482),T=c(19),U=c(280),W=c(52),
V=c(557),Y=c(1675);class da{constructor(Xa,Sa,ab,Hb,pb,Mb,Qb,Aa){this.b4g=this.v8g=this.FSg=this.bI=this.c8a=this.NQb=this.hze=this.cve=this.Kwe=this.fN=this.h6=this.l6=null;this.Gle=()=>{const bb=this.nsa.v6b(this.bI),nb=this.nsa.ZPl(this.bI);this.cve.innerText=bb.toString();this.hze.innerText=nb.toString();H.a.UMb(this.l6,1===bb?!1:!0);H.a.UMb(this.h6,bb===nb?!1:!0)};this.dbo=()=>{const bb=this.Vb.getRegion(F.a.L_a);let nb;if(this.IV)if(this.fN&&!this.fN.disabled)nb=this.fN;else if(this.l6.disabled){if(this.h6.disabled)return;
nb=this.h6}else nb=this.l6;else if(this.h6.disabled)if(this.l6.disabled)if(this.fN&&!this.fN.disabled)nb=this.fN;else return;else nb=this.l6;else nb=this.h6;nb.focus();bb.Xj.wy(nb)};this.epa=(bb,nb)=>{(bb=nb.sl.lb)&&this.fN&&H.a.UMb(this.fN,T.SelectionEditor.hm(bb)?!0:!1)};this.w5e=()=>{if(!this.h6.disabled){const bb=this.nsa.Iib(this.bI)?E.a.q3d:E.a.p3d;this.ga.processAction(bb,2)}return!0};this.x5e=()=>{if(!this.l6.disabled){const bb=this.nsa.Iib(this.bI)?E.a.s3d:E.a.r3d;this.ga.processAction(bb,
2)}return!0};this.v5e=()=>{this.fN&&!this.fN.disabled&&this.ga.processAction(E.a.PAi,2);return!0};this.Vb=Xa;this.ga=Hb;this.hg=pb;this.$d=Mb;this.ib=Qb;this.nsa=ab;this.f7=document.createElement("div");this.f7.classList.add("FootnoteEndnoteActionBarControl");this.IV=Aa;this.f7.style.zIndex=String(U.a.oId);this.f7.style.position="relative";this.Kqc=document.createElement("div");this.Kqc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.IV=Aa;this.f7.appendChild(this.Kqc);this.f1k();
this.f7.appendChild(this.NQb);this.f7.appendChild(this.c8a);this.TY=e.KeyInputManager.mc(a.a.Q0,0);this.Uqm();this.Tqm()}ufa(Xa){v.ULS.shipAssertTag(4520065,308,this.nsa.Ena(Xa));if(this.bI!==Xa){this.bI=Xa;this.Gle();Xa=this.nsa.Iib(this.bI);this.D3k(Xa);this.bI.Kmh(this.Gle);let Sa="",ab="";const Hb=this.IV?this.nsa.v6b(this.bI):-1;-1!==Hb&&(Sa=(Hb-1).toString(),ab=(Hb+1).toString());Xa?(this.h6.title=this.IV&&!this.h6.disabled?String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,
ab):WordEditorIntl.WordEditorStrings.L_NextFootnote,this.l6.title=this.IV&&!this.l6.disabled?String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,Sa):WordEditorIntl.WordEditorStrings.L_PrevFootnote):(this.h6.title=this.IV&&!this.h6.disabled?String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,ab):WordEditorIntl.WordEditorStrings.L_NextEndnote,this.l6.title=this.IV&&!this.l6.disabled?String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,Sa):WordEditorIntl.WordEditorStrings.L_PrevEndnote);
this.DGa()}}dBb(){this.bI&&(this.fN&&this.fN.parentNode===this.NQb&&this.NQb.removeChild(this.fN),this.Kia(),this.bI.hVn(this.Gle),this.bI=null)}dispose(){this.Vb.fe(F.a.L_a).Xq(this.TY)}D3k(Xa){3===this.ga.mode&&(Xa=Xa?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.fN=this.E8e("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",Xa,null),P.a.Uq(this.fN,P.a.Bea,Xa),this.NQb.appendChild(this.fN))}f1k(){this.NQb=
document.createElement("div");this.NQb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.c8a=document.createElement("div");this.c8a.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.l6=this.E8e("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.c8a.appendChild(this.l6);this.cve=I.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");
this.c8a.appendChild(this.cve);this.Kwe=I.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.Kwe.innerText=" / ";this.c8a.appendChild(this.Kwe);this.hze=I.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.c8a.appendChild(this.hze);this.h6=this.E8e("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.c8a.appendChild(this.h6)}E8e(Xa,Sa,ab,Hb){Xa=H.a.zZa(Xa,Sa,ab,Hb,void 0===Hb||null===Hb);Xa.setAttribute(P.a.oh,
P.a.z2);return Xa}Uqm(){const Xa=this.Vb.fe(F.a.L_a);Xa.parent=u.AppFrame.qp;Xa.bindAction(this.TY,E.a.p7);Xa.pea(this.dbo)}Tqm(){var Xa=new N.DOMFocusListing(()=>this.f7);Xa.Dxa=!1;Xa.In(2);Xa.In(1);Xa=this.Vb.O0b(this.f7,this.Vb.fe(F.a.L_a),Xa);Xa.LRa();Xa.lU=!0}DGa(){this.fN&&(this.hg.mb(M.a.click,this.fN,this.v5e),this.FSg=this.$d.qmb(this.fN,this.v5e,a.a.ks));this.hg.mb(M.a.click,this.l6,this.x5e);this.v8g=this.$d.qmb(this.l6,this.x5e,a.a.ks);this.hg.mb(M.a.click,this.h6,this.w5e);this.b4g=this.$d.qmb(this.h6,
this.w5e,a.a.ks);this.ib.gx(this.epa)}Kia(){this.fN&&(this.hg.sc(M.a.click,this.fN,this.v5e),this.$d.fpb(this.fN,this.FSg));this.hg.sc(M.a.click,this.l6,this.x5e);this.$d.fpb(this.l6,this.v8g);this.hg.sc(M.a.click,this.h6,this.w5e);this.$d.fpb(this.h6,this.b4g);this.ib.lY(this.epa)}static UPl(){return da.VPl()}static VPl(){return new da(y.FocusManager.instance(),Y.a.instance,V.a.instance,k.AFrameworkApplication.xa,z.App.ya.MC,z.App.ya.NC,W.a.instance,!!z.App.instance&&z.App.instance.twa)}}Object(D.a)(da,
"FootnoteEndnoteActionBarControl",null,[562]);var ba=c(208),ja=c(12),sa=c(1582),ta=c(1762);class ra{constructor(Xa,Sa,ab,Hb,pb,Mb,Qb,Aa,bb,nb,Va,Ab){this.dE=null;this.hS=!1;this.Gv=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.FWb=Xa;this.k4b=Sa;this.cnc=ab;this.v7j=Hb;this.HJe=pb;this.Zl=Mb;this.k$a=Qb;this.hg=Aa;this.c7g=bb;this.mVj=Va;this.pr=this.FWb.ownerDocument.createElement("div");this.pr.id="FootnoteEndnoteControlOverlay";this.pr.className="EditingSurfaceOverlay";this.UH=this.rKl();
this.k0(!1);this.FWb.appendChild(this.pr);this.FWb.appendChild(this.UH);this.k4b.bind();this.$h=null;this.ga=Ab;this.WJa=nb}$Zn(){const Xa=this.c7g();Xa&&Xa.Yi&&(Xa.Umb=0,Xa.Jyd())}ayj(Xa){if(this.GDc){const Sa=this.GDc.tma;Sa&&(Sa.WAf=Xa)}}get Iw(){return this.hS}get GDc(){return this.dE}get dialog(){return this.$h}get uo(){return null!=this.Swg?this.Swg:this.Swg=x.a.instance.Sa("Common.IZoomManager")}h9e(){this.$h=ta.a.cQl()}C3c(){this.$h=null}show(Xa=!0){this.hS||(this.ayj(!0),this.mVj(),this.k0(!0),
this.gz(),Xa&&this.setFocus())}setFocus(){this.hS&&(this.k4b.setInitialSelection(),this.v7j())}update(){this.hS&&(this.dE.isConnected?this.cnc.Gle():this.dismiss())}dismiss(Xa=!1,Sa=!1){this.hS&&(this.ayj(!1),this.A9(),this.$Zn(),this.k0(!1),this.HJe(Sa),this.$h&&(this.ga.processAction(ja.a.lIc,2),this.$h=null),!Xa&&this.dE&&this.dE.isConnected&&this.WJa.$5n(this.dE),this.dBb())}LYn(Xa){const Sa=null!==this.uo.instance?this.uo.instance.ij:1;this.UH.style.width=Xa.gEh*Sa+"px";this.Gv.style.width=Xa.sGc*
Sa+"px";this.UH.style.marginLeft=Xa.f2b*Sa+"px";this.Zl?this.Gv.style.marginRight=Xa.M7e*Sa+"px":this.Gv.style.marginLeft=Xa.p2b*Sa+"px";if(Xa=this.c7g())Xa=Xa.VK,this.UH.style.bottom=Xa.offsetHeight-Xa.clientHeight+"px"}ufa(Xa){v.ULS.shipAssertTag(4520073,308,this.k$a.Ena(Xa));this.dE!==Xa&&(this.dE=Xa,this.k4b.ufa(Xa),this.cnc.ufa(this.dE))}dispose(){this.dismiss();this.k4b.dispose();this.cnc.dispose()}gz(){this.hg&&this.hg.mb(M.a.click,this.pr,this.onClick)}A9(){this.hg&&this.hg.sc(M.a.click,this.pr,
this.onClick)}rKl(){let Xa;Xa=document.createElement("div");Xa.classList.add("FootnoteEndnoteControl");this.Gv=document.createElement("div");this.Gv.classList.add("FootnoteEndnoteContent");this.Gv.appendChild(this.k4b.f7);this.Gv.appendChild(this.cnc.f7);Xa.appendChild(this.Gv);return Xa}k0(Xa){Xa=(this.hS=Xa)?"":"none";this.pr.style.display=Xa;this.UH.style.display=Xa}dBb(){this.dE&&(this.k4b.dBb(),this.cnc.dBb(),this.dE=null)}static uPd(){const Xa=z.App.ya.jb.xc;return Xa&&Xa.Yi?Xa:null}static YPl(Xa,
Sa,ab,Hb,pb){return new ra(Xa,Sa,ab,Hb,pb,k.AFrameworkApplication.isRtl,V.a.instance,ba.a.instance,ra.uPd,sa.a.instance,ra.$gl,k.AFrameworkApplication.xa)}static $gl(){k.AFrameworkApplication.xa.Rb(ja.a.Fhb,2,!0)}}Object(D.a)(ra,"FootnoteEndnoteControl",null,[561]);var ma=c(816),Ba=c(5),Pa=c(215),Da=c(40),Ha=c(10),oa=c(24),wa=c(91),ia=c(1674),ca=c(377),pa=c(970),Ma=c(588),ya=c(1446),Oa=c(70),fa=c(117);class Ca extends ca.a{constructor(Xa,Sa,ab,Hb,pb,Mb,Qb,Aa,bb,nb,Va,Ab,Zb,Kb,dc,jc,zb){super(F.a.Efa,
ab,Hb,pb,Qb,Aa,bb,nb,Va,Ab,Zb,Kb,dc,jc,zb);this.DMg=Xa;this.YWa=Mb;this.YWa.s8c=this;Sa(this);this.features.Vdg=!0}get fti(){return!0}jtf(){const Xa=this.DMg.mkf(this);return pa.ViewReference.GE(this,Xa)}Pcf(Xa){Object(fa.a)(Ca,Xa)||this.DMg.Mcf()}mOc(){return Ma.a.sIi}onResize(){super.onResize();this.YWa.OSh()}nE(Xa,Sa=null){super.nE(Xa,Sa);this.YWa.ASh(this.Zc.Wi)}detach(){this.YWa.NSh();super.detach()}JLd(){this.onResize()}static xZa(){const {FootnoteEndnoteControlManager:Xa}=c(1632);return new Ca(Xa.instance,
ya.a.b7e,z.App.ya.jb,Oa.InteractiveViewManager.instance,()=>x.a.instance.resolve("Box4.IUndoManager"),x.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),k.AFrameworkApplication.xa,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),x.a.instance.resolve("Box4.IInteractiveEventNotifier"),x.a.instance.Sa("Box4.ITextMetricsAdapter"),x.a.instance.resolve("Box4.IRotatingCoordinateConverter"),x.a.instance.Sa("Common.IZoomManager"),x.a.instance.Ma("Box4.IContentControlViewElementManager"),x.a.instance.Ma("Box4.CpConversionManagerImpl"),
x.a.instance.Ma("Box4.ContentControlConfigSettings"),x.a.instance.Ma("Box4.IContentControlReader"),x.a.instance.Ma("Box4.IContentControlBoundaryNavigator"))}}Object(D.a)(Ca,"FootnoteEndnoteEditView",ca.a,[]);class Ta{constructor(Xa,Sa,ab,Hb=!1){this.rsb=null;this.oDe=this.yJg=!1;this.tzl=()=>{const pb=String.format("{0} {1}",this.oDe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);
this.lu.sendNotification(pb,!0)};this.Vb=Xa;this.nsa=Sa;this.tda=ab();this.gkd=Hb;this.f7=document.createElement("div");this.f7.classList.add("FootnoteEndnoteEditControl");this.Kqc=document.createElement("div");this.Kqc.classList.add("FootnoteEndnoteEditControlDividerElement");this.Cxb=(new ma.a(this.f7,"WACViewPanel_FootnoteEndnoteEditControl")).OH;this.f7.appendChild(this.Kqc);this.f7.appendChild(this.Cxb)}get lu(){return null!=this.Asg?this.Asg:this.Asg=x.a.instance.resolve("Common.Utils.IAriaNotifier")}ufa(Xa){v.ULS.shipAssertTag(4520077,
308,this.nsa.Ena(Xa));this.rsb!==Xa&&(this.rsb=Xa,this.q0e(this.rsb),this.oDe=this.nsa.Iib(this.rsb),this.gkd?(this.tda.XMb(P.a.Jzd),this.Vb.fe(F.a.Efa).E6(this.tzl)):this.tda.Fej(this.oDe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,P.a.Jzd))}dBb(){const Xa=V.a.instance.Iib(this.rsb)?"Footnote":"Endnote";v.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:Xa,["CalloutHeight"]:this.f7.scrollHeight});
this.Peb();this.rsb=null}bind(){this.yJg||(this.tda.Nyb(this.Cxb),this.yJg=!0)}setInitialSelection(){const Xa=this.P4l();Xa?this.tda.setSelection(Xa):this.tda.O5c()}dispose(){this.Peb()}q0e(Xa){this.Peb();this.tda.nE(Xa,Xa.Wi)}Peb(){this.tda.detach()}P4l(){let Xa=0;var Sa=null,ab=Ba.GraphIterator.$a(this.rsb);Pa.OutlineNavigator.B8(ab);if((ab=Da.OutlineElementNavigator.Fe(ab))&&Ha.ParagraphReader.Yb(ab)){if(Sa=Ta.UTl(ab)){Xa=Sa.Kb.cp+1;Sa=ia.FootnoteEndnoteDefaultContentInserter.PLh;const Hb=Sa.length;
Xa+Hb<=Ha.ParagraphReader.textLength(ab)&&ab.characterData.substr(Xa,Hb)===Sa&&(Xa+=Hb)}Sa=oa.SelectionFactory.te(ab,Xa)}return Sa}static $Pl(){return Ta.aQl()}static aQl(){return new Ta(y.FocusManager.instance(),V.a.instance,()=>Ca.xZa(),k.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static UTl(Xa){Xa=wa.i(Xa,10);return 0<Xa.length?Xa[Xa.length-1]:null}}Object(D.a)(Ta,"FootnoteEndnoteEditControl",null,[560]);var eb=c(1177);class jb{constructor(Xa,Sa){this.HAa=Xa;
this.Zl=Sa}v7b(Xa,Sa){Xa=this.HAa.v7b(Xa);var ab=Sa.clientWidth;const Hb=Sa.scrollLeft,pb=Xa.gEh;let Mb=Xa.f2b,Qb=Xa.f2b,Aa=jb.EKf,bb=jb.FKf,nb=pb,Va=Xa.sGc;this.Zl?bb=Xa.M7e-Qb:Aa=Xa.p2b-Mb;ab<pb&&(Mb=Math.max(Mb-Hb,0),nb=ab-Mb,this.Zl?(ab=Sa.scrollWidth-Hb-ab,Qb=Sa.scrollWidth-Xa.f2b-pb,bb=Math.max(Xa.M7e-ab-Qb,jb.FKf),Va=nb-bb-jb.EKf):(Aa=Math.max(Xa.p2b-Hb-Mb,jb.EKf),Va=nb-Aa-jb.FKf));return new eb.a(Mb,nb,Aa,bb,Va)}}jb.EKf=25;jb.FKf=50;Object(D.a)(jb,"FootnoteEndnoteViewPositionProvider",null,
[]);class ob{constructor(Xa,Sa=0,ab=0){this.clientWidth=Xa;this.scrollLeft=Sa;this.scrollWidth=ab?ab:Xa}}Object(D.a)(ob,"PageViewScrollContainerSizeInfo",null,[]);c.d(L,"FootnoteEndnoteControlManager",function(){return Ya});class Ya{constructor(Xa,Sa,ab,Hb,pb,Mb,Qb,Aa){this.$D=null;this.g9=()=>{this.Zo.nI(F.a.Efa);this.Zo.nI(F.a.L_a);this.Zo.nx(l.AFrame.$n);this.Vb.iCc(F.a.Efa);this.Vb.mg(F.a.Efa)};this.lbo=bb=>{this.Zo.nx(F.a.Efa);this.Zo.nx(F.a.L_a);this.Zo.nI(l.AFrame.$n);this.Vb.LHc(F.a.Efa);
(bb||this.Vb.currentScope&&(this.Vb.currentScope.name===F.a.Efa||this.Vb.currentScope.name===F.a.L_a))&&this.Vb.mg(l.AFrame.$n)};this.Vb=Xa;this.Zo=Sa;this.wYj=ab;this.xYj=Hb;this.vYj=pb;this.HAa=Mb;this.xra=Qb;this.cZ=Aa;this.TY=e.KeyInputManager.mc(a.a.Q0,0);this.xxf();this.GS()}get control(){return this.$D}get dialog(){return this.control.dialog}get ori(){return this.control.Iw}h9e(){this.control.h9e()}C3c(){this.control.C3c()}bind(Xa){this.XXk(Xa)}Qag(Xa){if(this.control.GDc!==Xa.qZa)this.control.dismiss();
else if(this.ori)return;this.P3b();this.control.ufa(Xa.qZa);this.control.show(Xa.Yfe)}P3b(){if(this.cZ){const Xa=new m.a(!0);this.cZ.yGa(Xa)}}oY(){this.control.setFocus()}f$c(){this.control.update()}Mcf(Xa,Sa=!1){this.P3b();this.control.dismiss(Xa,Sa)}JYn(Xa){const Sa=Ya.uPd().VK;Xa=this.HAa.v7b(Xa,new ob(Sa.clientWidth,Sa.scrollLeft,Sa.scrollWidth));this.control.LYn(Xa)}dispose(){this.control.dispose();this.Vb.fe(F.a.Efa).Xq(this.TY)}mkf(Xa){v.ULS.shipAssertTag(4520074,308,!!this.control);v.ULS.shipAssertTag(4520075,
308,!!this.control.GDc);return this.nkf(this.control.GDc.id,Xa)}XXk(Xa){const Sa=this.xYj(),ab=this.vYj();this.$D=this.wYj(Xa,Sa,ab,this.g9,this.lbo)}xxf(){const Xa=this.Vb.fe(F.a.Efa);Xa.parent=3===k.AFrameworkApplication.xa.mode?u.AppFrame.xE:u.AppFrame.Nfc;this.Vb.RWe(F.a.Efa);Xa.bindAction(this.TY,E.a.p7)}GS(){this.Zo.GS(F.a.Efa);this.Zo.GS(F.a.L_a)}nkf(Xa,Sa){return()=>{const ab=Ya.uPd().Zc.Mc.Db(Xa);this.xra.I4b();if(!ab.isConnected)return v.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),
null;this.Qag(new J.a(ab,!0));return Sa}}static Sl(){const Xa=new jb(x.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),k.AFrameworkApplication.isRtl);return new Ya(y.FocusManager.instance(),z.App.ya.Tw,ra.YPl,Ta.$Pl,da.UPl,Xa,K.a.instance,x.a.instance.resolve("Box4.IPasteFloatieEventSource"),x.a.instance.resolve("Common.IAppSettingsManager"))}static uPd(){const Xa=z.App.ya.jb.xc;return Xa&&Xa.Yi?Xa:null}static get instance(){return null!=Ya.Yyg?Ya.Yyg:Ya.Yyg=Ya.Sl()}}Object(D.a)(Ya,
"FootnoteEndnoteControlManager",null,[531])},1652:function(D,L,c){c.d(L,"a",function(){return z});D=c(0);var l=c(8),e=c(46),a=c(155),k=c(2),x=c(7),y=c(148),m=c(112),u=c(21);class z{constructor(v,E){this.Bt=null;this.frd=!1;this.vab=0;this.G_g="";this.Dse={};this.mIe=v;this.Vb=E;this.y5g=Object(e.a)(this,this.$Rf,"onModalMouseWheel");this.zZg=!!k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Ob.Una;this.tw=!!k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Ob.uO}onMenuOpen(){0<this.vab?
this.vab++:(this.vab++,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(e.a)(this,this.zZi,"pushTransientFocusScope"),0)}):this.zZi(),this.showModal())}zZi(){this.Vb&&this.Vb.TK(a.AFrame.jpa,!0)}eHl(){const v=m.f(),E=appChrome.selectors.getShyState();return String.format("{0}{1}",v,this.zZg&&E.isActive&&1===E.state?"_ShyRibbon":"")}x9l(v){var E=0;if(this.tw){if(this.Dse[v])return this.Dse[v];
(E=document.getElementById("BusinessBar"))||l.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");E=E?E.offsetTop:0;this.Dse[v]=E}return E}showModal(){if(!this.Bt)if(this.Bt=this.createElement("div"),this.Bt.setAttribute("id","ReactModalDiv"),this.Bt.style.position="absolute",this.Bt.style.bottom="0px",this.Bt.style.left="0px",this.Bt.style.right="0px",this.Bt.style.backgroundColor="white",this.Bt.style.opacity="0.0",this.tw){var v=
document.getElementById("regionComposerRoot");v&&v.appendChild(this.Bt)}else this.mIe.appendChild(this.Bt);v=this.eHl();if(v!==this.G_g){const E=this.x9l(v),F=appChrome.selectors.getShyState();this.zZg&&F.isActive&&1===F.state&&m.a("getRibbonHeight")?this.Bt.style.top=String.format("{0}px",E+appChrome.api.getRibbonHeight(m.f())):this.Bt.style.top=String.format("{0}px",E);this.G_g=v}this.Bt.style.display="block";this.Bt.style.visibility="visible";this.Bt.style.zIndex="1000";this.frd||(window.addEventListener("wheel",
this.y5g,!0),this.OXd()?y.a.instance.mb(x.a.AM,this.Bt,Object(e.a)(this,this.J5d,"onModalPointerUp")):y.a.instance.mb(x.a.pointerDown,this.Bt,Object(e.a)(this,this.I5d,"onModalPointerDown")),this.frd=!0)}onMenuClose(){this.vab--;0<this.vab||(0>this.vab?this.vab=0:this.Fji())}sQf(){this.vab=0;this.AIc();this.Fji()}createElement(v){v=document.createElement(v);v.setAttribute("unselectable","on");return v}Eji(){this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name===a.AFrame.jpa&&!k.AFrameworkApplication.oc.zv&&
this.Vb.cR(a.AFrame.jpa,!1);this.Bt&&(this.Bt.style.zIndex="-1",this.Bt.style.visibility="hidden",this.Bt.style.display="none");this.frd&&(window.removeEventListener("wheel",this.y5g,!0),this.OXd()?y.a.instance.sc(x.a.AM,this.Bt,Object(e.a)(this,this.J5d,"onModalPointerUp")):y.a.instance.sc(x.a.pointerDown,this.Bt,Object(e.a)(this,this.I5d,"onModalPointerDown")),this.frd=!1)}Fji(){this.OXd()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Eji()},0)}):this.Eji()}I5d(){this.O3b();this.tOh();
this.sQf();this.E5a();return!0}J5d(){this.O3b();this.tOh();this.sQf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.E5a()},0)});return!0}E5a(){4===k.AFrameworkApplication.ta.Ob.jm&&k.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?k.AFrameworkApplication.ta.E5a():this.Vb.mg(a.AFrame.$n)}$Rf(v){v.stopPropagation()}O3b(){const v=u.a.instance.Ma("Common.IReactContextualUILauncher");v&&v.O3b()}AIc(){const v=u.a.instance.Ma("Common.IReactContextualUILauncher");
v&&v.AIc()}tOh(){k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Ob.KPa&&(this.OXd()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}OXd(){return k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}}Object(D.a)(z,"ReactModalDiv",null,[])},1657:function(D,L,c){c.d(L,"a",function(){return e});c.d(L,"b",function(){return a});c.d(L,"c",function(){return k});var l=
c(2);const e=(x,y)=>{const m=RegExp("mailto:(.*)").exec(x.url);y.email=m&&2===m.length?m[1]:x.url;y.resolveState=x.hx.charAt(35)===c(1751).ACommentFormatTranslator.FAk?1:0},a=(x,y)=>{y.contentId=x.hx},k=(x,y,m)=>{y.contentId=x.hx;y.isCurrentUser=m.email===l.AFrameworkApplication.K.kb("UserPrincipalName")}},1658:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(1032),e=c(6);class a{constructor(k,x){this.$M=this.Owc=null;this.eb=k;this.S8a=x}get key(){return"COMMENT"}get zw(){return WordEditorIntl.WordEditorStrings.L_Comment}get T2(){return this.$M}reset(k){this.$M=
k.node}YHa(k){let x=null;if(this.Owc&&this.wri(k,this.T2,this.Owc))return x=Object.assign(new l.a,{rG:this.key,contentObject:this.Owc}),{returnValue:!0,xF:x};this.Owc=null;const y=this.S8a.C9e(this.T2);if(this.S8a.Bzf(y)){let m=y.Sd();for(;m;){if(this.wri(k,this.T2,m))return this.Owc=m,x=Object.assign(new l.a,{rG:this.key,contentObject:m,description:this.zgb()}),{returnValue:!0,xF:x};m=y.Wj()}}return{returnValue:!1,xF:x}}wri(k,x,y){if(this.Dkj(y))return!1;const m=this.S8a.z7b(y,!0),u=this.S8a.z7b(y,
!1);return m&&u&&this.eb.ETc(x,m,u)&&(x=this.S8a.ava(m,y.id,!0))&&(m!==this.T2||x.Kb.cp<=k)&&(y=this.S8a.ava(u,y.id,!1))&&(u!==this.T2||y.Kb.cp>k||y.Kb.cp>=k)?!0:!1}Dkj(k){return k.ia(e.a.jG,!1)}zgb(){return null}}Object(D.a)(a,"CommentDetailsProvider",null,[376,59])},1664:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);L=c(174);var l=c(110);class e extends L.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new l.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(D.a)(e,"DocumentTypeClassifierAnnotation",L.a,[])},1668:function(D,L,c){c.d(L,"a",function(){return z});D=c(0);var l=c(2),e=c(1146),a=c(75),k=c(8),x=c(46),y=c(96),m=c(64),u=c(364);class z{constructor(v,E,F,J,K,H){this.lLe=null;this.o8g=0;this.c2=!1;this.nd=J;this.Re=E;this.r5=K;this.mBe=F;this.Koc=l.AFrameworkApplication.Dag();this.pte=v.appSettings.ChromeClipboardAccessOperationTimeout;this.YH=0;this.kSj=H;this.FWj=v.$("EnableExternalPasteSupportOnMobileIsEnabled");this.Mh=e.a.getInstance(u.a.TYa);
this.c2=v.$("ShouldLogCcpExtendedHealthKpis")}get lRa(){return this.r5.lRa}process(v,E){if(!this.YH)return this.Hun(E);if(1===this.YH)return this.prepareForPaste(v,E);if(2===this.YH)return this.YH=3,this.lLe(v,E);3===this.YH&&this.r5.Ngj(v,E);return!1}Hun(v){let E=!0;this.FWj&&(E=!(v.ex&1));this.Re.A3&&E||v.ex&512?(this.lLe=v.ex&2?Object(x.a)(this.r5,this.r5.paste,"paste"):Object(x.a)(this.r5,this.r5.fVi,"pasteInternal"),this.YH=2):(this.Koc?(this.YH=1,this.o8g=Date.now()):this.YH=2,this.lLe=Object(x.a)(this.r5,
this.r5.paste,"paste"));u.a.o_m(v);return!0}prepareForPaste(v,E){v=!0;if(this.mBe.value.sXi())this.YH=2;else{const F=Date.now()-this.o8g;F>this.pte&&(k.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",F),this.nd.Zb(y.a.oma,{["Reason"]:m.a.MSi}),E.ZQ&&(E.ZQ.fail("Prepare for paste timed out",!1),this.c2?this.Mh.logKpiFailure({kpiName:u.a.LMa,errorName:"PreparePasteTimedOut",optionalVeto:{name:u.a.Plb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):a.Health.instance.recordQosError("PreparePasteTimedOut",
[u.a.Plb],!1,!0,!0,!1,null)),E.failed=!0,v=!1,this.kSj.p_n())}return v}}Object(D.a)(z,"ClipboardOperationPasteProcessor",null,[614])},1669:function(D,L,c){c.d(L,"a",function(){return W});D=c(0);L=c(241);var l=c(1146),e=c(75),a=c(2),k=c(48),x=c(108),y=c(8),m=c(117),u=c(82),z=c(1432),v=c(46),E=c(98),F=c(3),J=c(96),K=c(64),H=c(1090),P=c(19),N=c(52),M=c(1600),I=c(1670),T=c(364),U=c(126);class W extends L.a{constructor(V,Y,da,ba,ja,sa,ta,ra,ma,Ba,Pa,Da,Ha,oa,wa,ia,ca,pa,Ma,ya,Oa,fa,Ca,Ta,eb,jb,ob,Ya=!0){super();
this.hja=this.ZB=null;this.lL=this.Dz=0;this.ecb=this.mPe=this.n$=this.mh=null;this.W5=!1;this.vS=!0;this.mUg=!1;this.init(V);this.ul("ClipboardOperation");this.bib(ma,Y,ja,sa,ta);this.nd=Ba;this.Ie=Pa;this.Re=Da;this.Ic=Ha;this.vLg=oa;this.xLg=wa;this.wLg=ia;this.Cte=ca;this.XRb=pa;this.Dte=Ma;this.Koc=ra;this.woc=ya;this.QLa=Oa;this.$gk=Ya;this.fD=fa;this.Wd=Ca;this.Dm=Ta;this.cZ=eb;this._context=ba;this.dea=jb;this.eYb=ob;this.Mh=l.a.getInstance(T.a.TYa);ta&&Object(m.a)(114,ta)&&(this.n$=Object(u.a)(619,
ta.ia(x.a.Ata,null)));this.n$||(this.n$=this.dea.E7c());this.cqb=void 0===da||null===da?"NotAvailable":Object(z.a)(I.a,da);this.n$.Cwk(this.cqb.split(", "));V=this._context;if(this.eYb){if(!W.exh(V,this.Cte,this.nd,this.n$,Ya)){this.ar=8;this.finish();return}this.mh=V.view;this.W5=3===this.mh.uHb;this.Dz=0;this.lL=da;this.ecb=ca.lRa}else{if(!V.view.re){this.nd.Zb(J.a.kf,{["Reason"]:K.a.YIb});this.n$.fail("Not in interactive view",!0);this.ar=8;this.finish();return}this.mh=V.view;if(!this.mh.nb){this.nd.Zb(J.a.kf,
{["Reason"]:K.a.noSelection});this.n$.fail("No selection manager",!0);this.ar=8;this.finish();return}this.W5=3===this.mh.uHb;this.Dz=0;this.lL=da;this.ecb=ca.lRa;if(Ya&&!(this.ecb&&this.ecb.lb&&this.ecb.length)){this.nd.Zb(J.a.kf,{["Reason"]:K.a.noSelection});this.n$.fail("No selection when one required",!0);this.ar=8;this.finish();return}}ca=P.SelectionEditor.hm(this.ecb.lb);ca=!(this.lL&16&&ca);ca=Ma.$ym(da,this.pg)&&ca;1!==this.behavior&&ca||(ca||this.n$.fail("Clipboard operation disabled for selection",
!0),this.ar=ca?32:8,this.Ipa());!this.mUg&&this.Re.si&&(k.b("IPadCCP"),this.mUg=!0)}get pg(){this.mPe||(this.mPe=N.a.P0b(this.ecb));return this.mPe}gca(){super.gca();this.ecb=null}run(){this.Dz||this.setup();1===this.Dz&&this.process();2===this.Dz&&this.teardownSync();3===this.Dz&&this.teardownAsync();4===this.Dz&&this.finish()}setup(){if(this.lL&256&&this.Koc){this.dC||this.XRb.BPk(this,this.lL,this.cqb);this.dC.run();if(this.dC.inProgress)return;this.vS=this.dC.Koa;this.wCd();if(!this.vS){this.n$.fail("No access to system clipboard",
!0);this.ar=8;this.Dz=4;this.U0d();return}}else y.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.lL,this.cqb,this.Re.GF,this.actionId);this.lL&32&&!this.Ie.BWd(this.mh.nb.pg)?(y.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.nd.Zb(J.a.kf,{["Reason"]:K.a.uaf}),this.n$.fail("Cut not allowed",!0),this.woc.show(),this.ar=8,this.Dz=4):(this.lL&16||this.lL&32)&&E.a.instance.J(1)&&this.fD.GYd(this.mh.nb.hb.lb)?(this.n$.fail("Selected content deleted in coauthoring",
!0),this.Wd.VNb(),this.ar=8,this.Dz=4):(this.lL&4096&&(this.cZ.Jfc(Object.assign(new H.a,{FSc:!0,iY:this.cqb})),this.Dm.undo()),this.Dte.hzn(this.lL),this.mh.Zc?(this.ZB=this.Ic.Qc(15),this.ZB.kk=this.actionId,this.ZB.Eb(this.mh.Zc),this.Dz=1):(this.n$.fail("Interactive view has null target node",!0),this.ar=8,this.Dz=4))}process(){if(!this.dC){y.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.lL,this.cqb,this.Re.GF);y.ULS.shipAssertTag(6305507,307,!this.hja);
this.hja=new M.a(this._context,this.lL,this.n$,this.Z8,this.kL,void 0,this.Re.GF,this.$gk,this.W5);let V;V=this.lL&65536?Object(v.a)(this.vLg,this.vLg.process,"process"):this.lL&64?Object(v.a)(this.xLg,this.xLg.process,"process"):this.lL&1?Object(v.a)(this.Cte,this.Cte.process,"process"):Object(v.a)(this.wLg,this.wLg.process,"process");this.lL&16&&this.mh.nb.tya.FYh();this.QLa.create(this,V,this.hja).ul("ClipboardAction")}y.ULS.shipAssertTag(6305536,307,!!this.dC);this.dC.run();this.dC.inProgress||
(this.wCd(),this.Dz=this.Hg?2:3)}teardownSync(){this.hja.V$b&&(this.ZB.kk=F.a.typing);this.hja.$Sc&&this.ZB.zFa(this.hja.Xwf,this.hja.aPf);this.ZB.dispose();this.ar=this.hja.failed?8:32;this.Dz=4}teardownAsync(){if(this.dC){if(this.dC.run(),this.dC.inProgress)return}else if(this.hja.V$b&&(this.ZB.kk=F.a.typing),this.ZB.ZGa(this),this.hja.$Sc&&this.ZB.zFa(this.hja.Xwf,this.hja.aPf),this.ZB.dispose(),this.kWe)return;this.ar=this.hja.failed?8:32;this.Dz=4}finish(){this.cZ.Jfc(Object.assign(new H.a,{FSc:!1}));
this.Ipa();32===this.response?y.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.lL,this.cqb,this.Re.GF):y.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.lL,this.cqb,this.Re.GF);this.dea.sfa(this.n$);(W.HJn||W.Z$f)&&this.JWm()}U0d(){const V=!!(this.lL&1),Y=this._context.view;Y&&T.a.U0d(V,Y.nb,this.Re.GF)}JWm(){if(!(this.lL&4||
this.lL&64)){var V=new Map;V.set("isCopy",String.format("{0}",!!(this.lL&16)));V.set("isIPad",String.format("{0}",this.Re.si));W.Z$f?(V.set("SkipAria","false"),V.set("ErrorLevel","info"),this.Mh.logKpiUsage({kpiName:T.a.LBd,kpiType:0,optionalProperties:{extendedProperties:V},blockFutureEmissionDurationInMs:0})):e.Health.instance.recordKpiUsage(T.a.LBd,0,T.a.MBd,V);this.vS||(W.Z$f?(V.set("SkipAria","false"),V.set("ErrorLevel","info"),this.Mh.logKpiFailure({kpiName:T.a.LBd,errorName:T.a.lyh,optionalProperties:{isIntentional:!0,
isInternal:!0,additionalValues:{extendedProperties:V}},blockFutureEmissionDurationInMs:0})):(V=Object.assign(new U.a,{extendedProperties:V}),e.Health.instance.recordKpiFailure(T.a.LBd,T.a.lyh,!0,!0,V)))}}static get HJn(){null==W.cNe&&(W.cNe=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return W.cNe}static get Z$f(){null==W.c2&&(W.c2=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis"));return W.c2}static l0f(V,Y,
da,ba){V&&V.Zb(J.a.kf,{["Reason"]:da});Y&&Y.fail(ba,!0)}static exh(V,Y,da=null,ba=null,ja=!0){return V.view.re?V.view.nb?!ja||Y.lRa&&Y.lRa.lb&&Y.lRa.length?!0:(W.l0f(da,ba,K.a.noSelection,"Paste target is invalid"),!1):(W.l0f(da,ba,K.a.noSelection,"No selection manager"),!1):(W.l0f(da,ba,K.a.YIb,"Not in interactive view"),!1)}}W.cNe=null;W.c2=null;Object(D.a)(W,"ClipboardOperation",L.a,[])},1670:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.paste=1]="paste";e[e.textOnly=
2]="textOnly";e[e.overtype=4]="overtype";e[e.copy=16]="copy";e[e.deleteSelection=32]="deleteSelection";e[e.move=64]="move";e[e.useSystemClipboard=256]="useSystemClipboard";e[e.forceInternalClipboard=512]="forceInternalClipboard";e[e.reformatPastedContent=4096]="reformatPastedContent";e[e.pasteAsPlainText=8192]="pasteAsPlainText";e[e.showPlaceholderGlossary=65536]="showPlaceholderGlossary";e[e.reformatPastedContentWithDesignerPaste=131072]="reformatPastedContentWithDesignerPaste";e[e.noSpacesAdjustment=
262144]="noSpacesAdjustment"})(l||(l={}));Object(D.b)("ClipboardActionFlags",l)},1673:function(D,L,c){var l=this&&this.RD||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.xy:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,
x)||l(k,a,x)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1830),L);e(c(1831),L);D.exports.IntentIds||Object.defineProperty(D.exports,"IntentIds",{enumerable:!0,get:function(){return D.exports.IntentIds}});D.exports.ObjectSchemaType||Object.defineProperty(D.exports,"ObjectSchemaType",{enumerable:!0,get:function(){return D.exports.ObjectSchemaType}});D.exports.ObjectSemantic||Object.defineProperty(D.exports,"ObjectSemantic",{enumerable:!0,get:function(){return D.exports.ObjectSemantic}});D.exports.SearchSuggestionAnnotation||
Object.defineProperty(D.exports,"SearchSuggestionAnnotation",{enumerable:!0,get:function(){return D.exports.SearchSuggestionAnnotation}});D.exports.SearchSuggestionSignal||Object.defineProperty(D.exports,"SearchSuggestionSignal",{enumerable:!0,get:function(){return D.exports.SearchSuggestionSignal}});D.exports.SequenceType||Object.defineProperty(D.exports,"SequenceType",{enumerable:!0,get:function(){return D.exports.SequenceType}})},1674:function(D,L,c){c.r(L);c.d(L,"FootnoteEndnoteDefaultContentInserter",
function(){return J});D=c(0);var l=c(21),e=c(60),a=c(2),k=c(40),x=c(564),y=c(31),m=c(6),u=c(17),z=c(46),v=c(1188),E=c(884),F=c(1601);class J{constructor(K,H,P,N,M=null){this.Xc=K;this.cSj=H;this.Zl=P;J.Hh=N;this.bNg=M||J.y4k}get QK(){return null!=this.ZAg?this.ZAg:this.ZAg=l.a.instance.resolve("Box4.IOutlineEditor")}H2k(K,H){var P=this.Xc.Ck();P.set(K);this.QK.hib(P,null,!0);J.Hh.kNb(P.currentNode,this.Zl);K=k.OutlineElementNavigator.Fe(P);J.Fca.tfe(H?Box4Intl.Box4Strings.L_StyleWordFootnoteText:
Box4Intl.Box4Strings.L_StyleWordEndnoteText,K);P=this.bNg(P.currentNode);J.characterPropertiesEditor.replaceTextRange(P,J.PLh);this.Stm(K,H)}Stm(K,H){var P=this.cSj(131073);P.setValue(m.a.Rs,1===H?36:35);P.setValue(m.a.pla,!0);P.setValue(u.a.w9,!0);const N=K.Mc.Du(P,e.a.create());P=this.bNg(K);J.characterPropertiesEditor.jga(P,M=>E.a.getInstance(M,N,!0),F.a.z1h(K,H))}static Sl(){return new J(new x.a,Object(z.a)(v.a.instance,v.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,
l.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Fca(){return null!=J.sDg?J.sDg:J.sDg=l.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get characterPropertiesEditor(){return null!=J.jtg?J.jtg:J.jtg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=J.lzg?J.lzg:J.lzg=J.Sl()}static y4k(K){return y.a.Tc(K,0)}}J.PLh=" ";J.Hh=null;Object(D.a)(J,"FootnoteEndnoteDefaultContentInserter",null,[587])},1675:function(D,L,c){c.d(L,"a",function(){return x});
D=c(0);var l=c(564),e=c(557),a=c(1531),k=c(1601);class x{constructor(y,m){this.xra=m}CRd(y,m,u){return(y=this.xra.N8h(y.node,u?y.cpBegin:y.cpEnd,m))?y.l3():null}tgi(y,m){return(y=this.xra.o1l(y.node,y.cpBegin,m))?y.l3():null}static YMc(){return new x(e.a.instance,a.a.instance,new l.a,k.a.instance)}static get instance(){return null!=x.Iyg?x.Iyg:x.Iyg=x.YMc()}}Object(D.a)(x,"FootnoteEndnoteNavigator",null,[558])},1687:function(D,L,c){c.d(L,"a",function(){return x});D=c(0);var l=c(1745),e=c(2),a=c(39),
k=c(21);class x{constructor(y,m,u,z,v,E){this.$ra=y;this.asa=m;this.pBe=u;this.DY=z;this.Wfd=v;this.oRb=E}get Dlj(){return!this.asa&&!this.pBe}get JLi(){return 2===this.oRb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get iTh(){return CommonUIStrings.l_OICErrorMessageNoOffice}get Cki(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Chb(){return CommonUIStrings.l_OICErrorHelpLink}get rji(){return"OICFailure"}get icon(){return 3}get fxd(){return 2===
this.oRb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}yIn(y){this.VLi(y)}$Qm(y){this.VLi(y)}VLi(y){let m=10;1===y?(k.a.instance.resolve("Common.IOfficeTrialExperience").jGf(this.oRb),m=3):2===y&&((!this.pBe||this.pBe(this.DY))&&this.asa&&l.a.instance.M5k(this.asa,this.$ra,this.DY),m=5);(0===y||1===y)&&this.$ra&&this.$ra(this.DY);e.AFrameworkApplication.q3c(a.a.ASi,this.Wfd,m);this.dispose()}dispose(){this.DY=
this.asa=this.$ra=null}}Object(D.a)(x,"AOICErrorDialogWithTrial",null,[9])},1743:function(D,L,c){D=c(0);var l=c(2),e=c(15),a=c(21),k=c(600),x=c(1526),y=c(36);class m{constructor(fa,Ca=null){this.R5j=fa;this.nW=Ca||x.a.$nf(e.a.Vyb,"")}get jy(){return this.R5j}get Hc(){return this.nW}N8f(fa){this.Hc.d++;return this.jy.N8f(fa)}Zhc(fa){this.Hc.e++;return this.jy.Zhc(fa)}XK(fa){this.Hc.f++;return this.jy.XK(fa)}nnb(fa){this.Hc.h++;return this.jy.nnb(fa)}x4(fa){this.Hc.i++;return this.jy.x4(fa)}gia(fa){this.Hc.j++;
return this.jy.gia(fa)}hHa(fa){this.Hc.k++;return this.jy.hHa(fa)}Kpa(fa){this.Hc.l++;return this.jy.Kpa(fa)}Bee(fa){this.Hc.m++;return this.jy.Bee(fa)}G5a(fa,Ca=!1){this.Hc.n++;return this.jy.G5a(fa,Ca)}Stf(){this.Hc.o++;return this.jy.Stf()}Mbg(){this.Hc.p++;return this.jy.Mbg()}Ev(fa){this.Hc.q++;return this.jy.Ev(fa)}Yxa(fa){this.Hc.r++;return this.jy.Yxa(fa)}Nhc(fa){this.Hc.g++;return this.jy.Nhc(fa)}W5c(fa){return this.jy.W5c(fa)}rnb(fa){this.Hc.s++;return this.jy.rnb(fa)}kfe(fa){this.Hc.s++;
return this.jy.kfe(fa)}l$e(fa){this.Hc.ba++;return this.jy.l$e(fa)}gee(fa){this.Hc.s++;return this.jy.gee(fa)}pnb(fa){this.Hc.s++;return this.jy.pnb(fa)}pNb(fa){this.Hc.t++;return this.jy.pNb(fa)}zfe(fa){this.Hc.u++;return this.jy.zfe(fa)}dia(fa){this.Hc.v++;return this.jy.dia(fa)}D9f(fa){this.Hc.bb++;return this.jy.D9f(fa)}fHa(fa){return this.jy.fHa(fa)}f9(fa){this.Hc.z++;return this.jy.f9(fa)}m4f(){return this.jy.m4f()}vca(fa,Ca){this.Hc.w++;this.Hc.x++;return this.jy.vca(fa,Ca)}KC(fa){this.Hc.y++;
return this.jy.KC(fa)}clearFormatting(){return this.jy.clearFormatting()}clone(){return new m(this.jy.clone(),this.Hc)}}Object(D.a)(m,"FormattingStewardUsageCollector",null,[565]);class u extends m{constructor(fa,Ca=null){super(fa,Ca)}get D8(){return this.jy}get Xv(){return this.D8.Xv}set Xv(fa){this.D8.Xv=fa}get textIndent(){return this.D8.textIndent}get marginLeft(){return this.D8.marginLeft}get Cjc(){return this.D8.Cjc}get bR(){return this.D8.bR}get lineSpacing(){return this.D8.lineSpacing}get F4(){return this.D8.F4}get leftIndent(){return this.D8.leftIndent}get Xba(){return this.D8.Xba}get paragraph(){return this.D8.paragraph}set paragraph(fa){this.D8.paragraph=
fa}get kQ(){return this.D8.kQ}get Mjc(){return this.D8.Mjc}Kke(fa){return this.D8.Kke(fa)}mhg(fa){return this.D8.mhg(fa)}clone(){const fa=this.jy.clone();return new u(fa,this.Hc)}}Object(D.a)(u,"FormattingStewardUsageCollector",m,[667,565]);var z=c(10),v=c(191),E=c(313),F=c(866),J=c(40),K=c(215),H=c(95),P=c(42),N=c(60),M=c(381),I=c(147),T=c(16),U=c(75),W=c(59),V=c(17),Y=c(6),da=c(43),ba=c(126),ja=c(529),sa=c(318),ta=c(154),ra=c(61),ma=c(85),Ba=c(195),Pa=c(1594),Da=c(176),Ha=c(31),oa=c(1390),wa=c(883);
class ia{constructor(fa,Ca,Ta,eb,jb,ob,Ya,Xa,Sa,ab,Hb=null){var pb;this.YD=this._paragraph=null;this.Bpd=0;this.OKg=this.Cpd=null;this.k$=0;this.jvb=this.Mjc=this.leftIndent=this.F4=this.lvc=this.bR=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=fa;this.ue=Ca;this.FL=Ta;this.ax=eb;this.RJ=jb;this.YTb=ob;this.Gja=Ya;this.HSb=Xa;this.gVa=Sa;this.psb=ab;Hb?(y.a(4223818,307,!!Hb.YD),this.YD=Hb.YD.wla(this.paragraph),this.Bpd=Hb.Bec,this.Cpd=Hb.hVf,Hb.bR&&(this.bR=new oa.a,this.bR.afterSpacing.value=
Hb.bR.afterSpacing.value,this.bR.beforeSpacing.value=Hb.bR.beforeSpacing.value,null===(pb=l.AFrameworkApplication.K)||void 0===pb?0:pb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(this.bR.afterSpacing.unit=Hb.bR.afterSpacing.unit,this.bR.beforeSpacing.unit=Hb.bR.beforeSpacing.unit),Hb.lineSpacing&&(this.lvc=Hb.lineSpacing.clone()),this.k$=Hb.k$,this.Mjc=Hb.Mjc.clone(),this._textIndent=Hb.textIndent,this._marginLeft=Hb.marginLeft,this._tabStops=Hb.Cjc,
this.F4=Hb.F4,this.leftIndent=Hb.leftIndent,Hb.Xba&&(this.jvb=Hb.Xba)):(this.YD=new Ba.a(this.paragraph,0),this.YD.formatting=new Da.a(this.YD,N.a.nil),Ca=Ha.a.Bw(fa),Ca=this.RJ.Ar(Ca),this.hao(Ca),this.xno(fa)?(this.YTb.Bbo(this.YD.formatting,Ca),fa.hasProperty(V.a.Sh)?this.k$=fa.getValue(V.a.Sh):this.k$=0):this.k$=-1,this.Bpd=0,this.bR=this.Cpd=null,this.psb&&(this.bR=this.YTb.VDa(fa),this.lvc=this.YTb.zDb(fa),this.F4=this.YTb.y7b(fa),this.leftIndent=this.YTb.zT(fa)),this.Mjc=new M.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(fa){y.a(4223816,
307,!!fa&&z.ParagraphReader.Yb(fa));this._paragraph=fa}get kQ(){return this.YD.formatting}get Bec(){return this.Bpd}get hVf(){return this.Cpd}get Qv(){return this.OKg}get Xv(){return this.k$}set Xv(fa){y.a(4223817,307,1===fa||2===fa||3===fa||6===fa);this.k$=fa}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get Cjc(){return this._tabStops}get lineSpacing(){return this.lvc}get Xba(){return this.jvb}get uc(){return this.ax}hao(fa){const Ca=this.RJ.language(fa);Ca&&
this.ue.O8f(this.YD.formatting,Ca,0,fa.cache.tGb,!1)}xno(fa){fa=this.uc.jg(this.uc.Uo(fa));return fa===ra.StyleReader.Pad||fa===ra.StyleReader.wordStyleIdNormal||fa===ra.StyleReader.lQb||fa===ra.StyleReader.styleIdNormal}N8f(fa){(fa=k.a.lg(fa))&&this.ue.Ree(this.YD.formatting,fa.LCID);return!0}Zhc(){return!1}XK(fa){this.ue.XK(this.YD.formatting,fa);return!0}nnb(fa){this.ue.setItalic(this.YD.formatting,fa);return!0}x4(fa){this.ue.x4(this.YD.formatting,fa);return!0}gia(fa){this.ue.gia(this.YD.formatting,
fa);return!0}hHa(fa){this.ue.hHa(this.YD.formatting,fa);return!0}Kpa(fa){this.ue.Kpa(this.YD.formatting,fa);return!0}Bee(fa){if(0>=fa)return!1;this.ue.wA(this.YD.formatting,fa);return!0}G5a(fa,Ca){if(!fa||""===fa)return!1;if(({bYh:Ta}=I.FontUtils.Awj(fa)).returnValue)return this.ue.bia(this.YD.formatting,Ta.fontName),!0;var Ta=!1;const eb=I.FontUtils.LQa(fa);Ca&&this.qjb(eb,this.Gja)&&(this.Gja.Kla(fa),Ta=!0);if(this.qjb(eb,this.HSb)||this.qjb(eb,this.gVa))Ta=!0;Ta&&this.ue.bia(this.YD.formatting,
eb);return Ta}qjb(fa,Ca){return!!Ca&&Ca.isEnabled&&Ca.qjb(fa)}Stf(){this.ue.Rgi(this.YD.formatting);return!0}Mbg(){this.ue.Emj(this.YD.formatting);return!0}Ev(fa){var {Box4PasteSteward:Ca}=c(1501);if(null===fa||""===fa)return!1;fa=Ca.aAb(fa);Ca=null;this.Xba&&this.Xba.hasOwnProperty(Y.a.listLevel.id.toString())&&(Ca=this.Xba[Y.a.listLevel.id.toString()]);this.ue.Ev(this.YD.formatting,fa,Ca);return!0}Yxa(fa){const {Box4PasteSteward:Ca}=c(1501);if(!fa||""===fa||!ia.jcm().contains(fa))return!1;this.ue.Yxa(this.YD.formatting,
Ca.aAb(fa));return!0}Nhc(fa){this.ue.Nhc(this.YD.formatting,fa);return!0}W5c(fa){let Ca=0;switch(T.a.fh(fa)){case "small-caps":Ca=1;break;case "uppercase":Ca=2}this.ue.Wl(this.YD.formatting,da.a.capitalization,Ca);return!0}f9(fa){const {Box4PasteSteward:Ca}=c(1501);if(!fa||""===fa)return!1;this.Mjc.setValue(V.a.eH,parseInt(Ca.aAb(fa),16));return!0}pnb(fa){return 0>=fa?!1:this.kfe(this.uc.Vci(fa))}rnb(fa){this.clearFormatting();this.Bpd=fa;return!0}l$e(fa){var {Box4PasteSteward:Ca}=c(1501),Ta=new Map;
Ta.set("Source","CreateStyleCCP_FormattingSteward");U.Health.instance.recordKpiUsage(ta.a.AEj,0,ta.a.dB,Ta);Ta=ma.a.N6l(fa);fa=[];fa.push(Ta);(fa=ma.a.IWe(fa,this.paragraph))?(Ca.xjc=this.uc.Cr(),y.b(593078085,3017,50,"Custom style created via paste.")):(Ca=new Map,Ca.set("Source","CreateStyleCCP_FormattingSteward"),Ca.set("IsStyleNull",(!Ta).toString()),Ca=Object.assign(new ba.a,{extendedProperties:Ca}),U.Health.instance.recordKpiFailure(ta.a.AEj,"UnableToCreateStyle",!1,!0,Ca));return fa}kfe(fa){const {Box4PasteSteward:Ca}=
c(1501);return fa&&0<fa.length&&Ca.xjc&&Ca.xjc.Ni(fa)?(this.Cpd=fa,!0):!1}gee(fa){const {Box4PasteSteward:Ca}=c(1501);return fa&&0<fa.length&&Ca.xjc&&Ca.xjc.Ni(fa)?(this.OKg=fa,!0):!1}mhg(fa){if(this.Qv){fa=this.uc.qC(fa);if(!fa)return y.a(41968715,307,!1),!1;(fa=fa.Ni(this.Qv))&&this.ue.Fnb(this.YD.formatting,fa);return!0}return!1}vca(fa,Ca){this.bR=new oa.a;this.bR.beforeSpacing=this.neo(fa);this.bR.afterSpacing=this.meo(Ca);return!0}neo(fa){return new wa.a(4,fa)}meo(fa){return new wa.a(4,fa)}KC(fa){if(!fa)return!1;
const Ca=parseFloat(T.a.substring(fa,0,T.a.fh(fa).indexOf("px")));if(!isNaN(Ca))return this.lvc=new wa.a(3,W.a.ny(Ca,1)),!0;fa=parseFloat(T.a.substring(fa,0,T.a.fh(fa).indexOf("%")));return isNaN(fa)?!1:(this.lvc=new wa.a(2,fa/100),!0)}pNb(fa){let Ca=0;if(!fa||""===fa)return!1;switch(fa){case "left":Ca=1;break;case "center":Ca=2;break;case "right":Ca=3;break;case "justify":Ca=6}if(!Ca)return!1;this.Xv=Ca;return!0}zfe(fa){this._textIndent=fa;return!0}dia(fa){this._marginLeft=fa;return!0}D9f(fa){this._tabStops=
fa;return!0}fHa(fa){this.jvb=JSON.parse(fa);return this.Xba?!0:!1}clearFormatting(){this.YD.formatting=new Da.a(this.YD,N.a.nil);return!0}m4f(){this.k$=0;return!0}Kke(fa){var {Box4PasteSteward:Ca}=c(1501);if(0<this.Bec&&Ca.l4a[this.Bec]){y.a(4223819,307,1<=this.Bec);y.a(4223820,307,7>=this.Bec);Ca=this.uc.qC(fa);if(!Ca)return y.a(4223821,307,!1),!1;Ca=Ca.Ni(c(1501).Box4PasteSteward.l4a[this.Bec]);this.FL.rJ(Ca,fa,!1);return!0}if(this.hVf){Ca=this.uc.qC(fa);if(!Ca)return y.a(41968716,307,!1),!1;Ca=
Ca.Ni(this.hVf);this.FL.rJ(Ca,fa,!1);return!0}return!1}clone(){return new ia(this.paragraph,this.ue,this.FL,this.ax,this.RJ,this.YTb,this.Gja,this.HSb,this.gVa,this.psb,this)}static jcm(){ia.qZ||(ia.qZ=new ja.a(sa.a.Xh()),ia.qZ.add(Pa.a.yellow),ia.qZ.add(Pa.a.jRm),ia.qZ.add(Pa.a.szk),ia.qZ.add(Pa.a.fBl),ia.qZ.add(Pa.a.blue),ia.qZ.add(Pa.a.red),ia.qZ.add(Pa.a.v$m),ia.qZ.add(Pa.a.teal),ia.qZ.add(Pa.a.green),ia.qZ.add(Pa.a.purple),ia.qZ.add(Pa.a.R4m),ia.qZ.add(Pa.a.odn),ia.qZ.add(Pa.a.gray),ia.qZ.add(Pa.a.Xro),
ia.qZ.add(Pa.a.black));return ia.qZ}}ia.qZ=null;Object(D.a)(ia,"FormattingSteward",null,[667,565]);class ca{vhg(){return!1}nuf(fa){return fa}uuf(){}fHa(){}Yee(){}XWd(){return!1}get hYd(){return!1}KC(){}vca(){}rfe(){}get Hkj(){return!1}}Object(D.a)(ca,"NoOpPasteStewardBridge",null,[117]);var pa=c(76);class Ma{constructor(fa,Ca){this.pbn=fa;this.qbn=Ca||"Normal"}}Object(D.a)(Ma,"NoteTagInfoBox4",null,[]);const ya=fa=>{const Ca=new pa.a;for(const Ta of fa)fa=new Ma(Ta.pbn,Ta.qbn),Ca.add(fa);return Ca};
c.d(L,"a",function(){return Oa});class Oa{constructor(fa,Ca,Ta=null,eb=null){this.Pyl=l.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.H7g=0;this.Fc=fa;this.Y5=Ca;this.e1=eb||new ca;this.Hc=Ta||x.a.$nf(e.a.Vyb,"")}get characterPropertiesEditor(){return null!=this.btg?this.btg:this.btg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get fontService(){return null!=this.iwg?this.iwg:this.iwg=a.a.instance.Ma("Box4.IFontService")}get SCa(){return null!=this.eug?this.eug:
this.eug=a.a.instance.Ma("Box4.CustomFontService")}get Tll(){return null!=this.Fug?this.Fug:this.Fug=a.a.instance.Ma("Box4.IEmbeddedFontService")}reset(){}get SHc(){return this.Xmf(!1)}Xmf(fa){y.a(4223770,307,P.OutlineElementReader.Lh(this.Fc));const Ca=J.OutlineElementNavigator.Fe(this.Fc);J.OutlineElementNavigator.Zd(this.Fc);y.a(4223771,307,!!Ca&&z.ParagraphReader.Yb(Ca));fa=new ia(Ca,Oa.oq,Oa.EG,Oa.uc,Oa.D7,Oa.tAl,this.fontService,this.SCa,this.Tll,this.Pyl,void 0,fa);return new u(fa,this.Hc)}Qba(){}UFa(){}nlb(){}Swa(){}PFa(){}RQa(){}QQa(){}nG(){}mG(){}klb(){}jlb(){}XQa(){}Y3a(){}XFa(){}VFa(){}WQa(){}WFa(){}$3a(){}Kcc(fa){P.OutlineElementReader.Lh(this.Fc)?
(Oa.vg.tna(this.Fc,!0),J.OutlineElementNavigator.Ir(this.Fc,!1,!1)):H.OutlineReader.Kw(this.Fc)?K.OutlineNavigator.B8(this.Fc)?fa?(this.Fc.Dg(),Oa.QK.I6(this.Fc,!1)):Oa.vg.NLb(this.Fc):Oa.QK.I6(this.Fc,!1):y.a(8128524,307,!1,"Unexpected node type {0} encountered",this.Fc.Xe)}ENc(fa){let Ca=null;if(fa&&fa.H8&&fa.cultureName)try{Ca=Object.assign(new F.a,{languageId:k.a.lg(fa.cultureName).LCID})}catch(Ta){y.a(8128526,307,!1,"Setting up culture {0} encountered {1}",fa.cultureName,Ta)}Ca||null==this.Y5||
(Ca=Object.assign(new F.a,{languageId:this.Y5}));return Ca}get xU(){return this.H7g}set xU(fa){this.H7g=fa}zzd(){}vke(){}i5e(){}get t2b(){return!1}get KAb(){return!1}MRm(fa){let Ca=1;if(fa.sui){var Ta=0;switch(fa.listStyleType){case 1:Ca=0;break;case 7:Ca=1;break;case 8:Ca=2;break;case 9:Ca=3;break;case 10:Ca=4;break;case 11:Ca=5}}else switch(Ta=1,fa.listStyleType){case 1:Ca=0;break;case 3:Ca=1;break;case 4:Ca=2;break;case 5:Ca=3}let eb;Ta=(eb=v.a.SZ)?E.a.dT(Ta,Ca,ya(fa.Moa),fa.listId,fa.listLevel,
fa.levelText,fa.font):E.a.dT(Ta,Ca,ya(fa.Moa));3!==fa.Gr&&(Ta.U4=fa.Gr);fa.sui&&!fa.jqi&&(Ta.vB=eb&&0<fa.listId&&0<=fa.listLevel&&!fa.Eec?fa.fjc:fa.R9k);!Ta.Zy||3!==Ta.listStyle&&5!==Ta.listStyle||(Ta.Xv="right");(fa=fa.$Gf)&&Ta.propertySet.Aw(fa);Ta.D5b=!0;this.e1.Yee(this.Fc);return Ta}Pba(){}Mba(){}Oba(){}Nba(){}Lba(){}Kba(){}static get vg(){return null!=Oa.pBg?Oa.pBg:Oa.pBg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get QK(){return null!=Oa.eBg?Oa.eBg:Oa.eBg=a.a.instance.resolve("Box4.IOutlineEditor")}static get oq(){return null!=
Oa.Jwg?Oa.Jwg:Oa.Jwg=a.a.instance.resolve("Box4.IFormattingEditor")}static get EG(){return null!=Oa.aGg?Oa.aGg:Oa.aGg=a.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get uc(){return null!=Oa.EGg?Oa.EGg:Oa.EGg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get D7(){return null!=Oa.Nwg?Oa.Nwg:Oa.Nwg=a.a.instance.resolve("Box4.IFormattingReader")}static get tAl(){return null!=Oa.Owg?Oa.Owg:Oa.Owg=a.a.instance.resolve("Box4.Actors.IFormattingStewardBridge")}}Oa.If=null;Object(D.a)(Oa,
"Box4PasteStewardBase",null,[648,466,467])},1745:function(D,L,c){D=c(0);var l=c(46),e=c(8),a=c(2),k=c(39),x=c(359),y=c(21);class m{constructor(N,M,I,T){this.zHe=null;this.Wfd=T;this.$ra=N;this.asa=M;this.DY=I;this.pch=this.rIb.nlo;N=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.E4j=N[0];this.D4j=N[1]}get rIb(){return this.zHe||(this.zHe=y.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Chb(){return CommonUIStrings.l_OICErrorHelpLink}get x6c(){return this.pch}get WFi(){return this.E4j}get VFi(){return this.D4j}get UFi(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.pch?
3:2}get TJc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get fEd(){return!!this.asa}get UJc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}T_f(N){this.DYc(N)}OGf(N){this.DYc(N)}DYc(N){let M=10;this.asa&&1===N&&(this.asa(this.DY),M=1);this.$ra&&this.$ra(this.DY);this.jR(M)}fJb(){x.Redirect.showHelp("OICFailure");this.jR(2)}pPf(){this.rIb.RAi();this.jR(4)}jR(N){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.Wfd,N);a.AFrameworkApplication.q3c(k.a.ySi,this.Wfd,N)}dispose(){this.DY=this.$ra=this.asa=null}}Object(D.a)(m,"AOICErrorDialog",null,[9]);var u=c(29),z=c(141);class v extends m{constructor(N,M,I,T){super(N,M,I,T);this.sab=this.pF=null;N=document.createElement("span");N.id="errorMessageText";N.innerText=this.errorMessage;N.appendChild(document.createElement("br"));N.appendChild(document.createElement("br"));this.pF=document.createElement("a");this.pF.href="#";this.pF.innerText=this.Chb;N.appendChild(this.pF);
u.a.addHandler(this.pF,"click",Object(l.a)(this,this.fJb,"oicErrorHelpLinkHandler"));M=new z.StandardDialog;M.sg=this.id;this.x6c?(I=document.createElement("span"),T=document.createElement("span"),I.innerText=this.WFi,T.innerText=this.VFi,this.sab=document.createElement("a"),this.sab.href="#",this.sab.innerText=this.UFi,N.appendChild(document.createElement("br")),N.appendChild(I),N.appendChild(this.sab),N.appendChild(T),u.a.addHandler(this.sab,"click",Object(l.a)(this,this.pPf,"oicErrorMacOfferLinkHandler"))):
this.fEd&&(N.appendChild(document.createElement("br")),N.appendChild(document.createElement("br")),I=document.createElement("span"),I.innerText=this.TJc,N.appendChild(I));this.fEd?(M.zd=1,M.Ge(1,this.UJc)):M.zd=0;M.Au(this.dialogTitle,null,this.icon,Object(l.a)(this,this.OGf,"legacyOICErrorDialogHandler"),N);M.s4("errorMessageText")}dispose(){this.pF&&(u.a.removeHandler(this.pF,"click",Object(l.a)(this,this.fJb,"oicErrorHelpLinkHandler")),this.pF=null);this.sab&&(u.a.removeHandler(this.sab,"click",
Object(l.a)(this,this.pPf,"oicErrorMacOfferLinkHandler")),this.sab=null);super.dispose()}}Object(D.a)(v,"OICErrorDialog",m,[]);class E{constructor(N,M,I){this.$ra=M;this.asa=N;this.DY=I}get id(){return"OICErrorDialogWithDownload"}get jTh(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Chb(){return CommonUIStrings.l_OICErrorHelpLink}get TJc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get UJc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}T_f(N){this.DYc(N)}OGf(N){this.DYc(N)}DYc(N){let M=
10;1===N&&(this.asa(this.DY),M=1);this.$ra&&this.$ra(this.DY);this.jR(M)}fJb(){x.Redirect.showHelp("OICFailure");this.jR(2)}jR(N){a.AFrameworkApplication.q3c(k.a.zSi,3,N)}dispose(){this.DY=this.asa=this.$ra=null}}Object(D.a)(E,"AOICErrorDialogWithDownload",null,[9]);class F extends E{constructor(N,M,I){super(N,M,I);this.pF=null;N=document.createElement("span");N.id="errorMessageText";N.innerText=this.jTh;N.appendChild(document.createElement("br"));N.appendChild(document.createElement("br"));this.pF=
document.createElement("a");this.pF.href="#";this.pF.innerText=this.Chb;N.appendChild(this.pF);u.a.addHandler(this.pF,"click",Object(l.a)(this,this.fJb,"oicErrorHelpLinkHandler"));N.appendChild(document.createElement("br"));N.appendChild(document.createElement("br"));M=document.createElement("span");M.innerText=this.TJc;N.appendChild(M);M=new z.StandardDialog;M.sg=this.id;M.zd=1;M.Ge(1,this.UJc);M.Au(this.dialogTitle,null,this.icon,Object(l.a)(this,this.OGf,"legacyOICErrorDialogHandler"),N);M.s4("errorMessageText")}dispose(){this.pF&&
(u.a.removeHandler(this.pF,"click",Object(l.a)(this,this.fJb,"oicErrorHelpLinkHandler")),this.pF=null);super.dispose()}}Object(D.a)(F,"OICErrorDialogWithDownload",E,[]);var J=c(152);class K extends m{constructor(N,M,I,T){super(N,M,I,T);M={["errorMessage"]:this.errorMessage};M.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Chb,["onExecute"]:U=>{this.fJb(U)}};this.x6c?(M.macOfficePreLinkText=this.WFi,M.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.UFi,
["onExecute"]:U=>{this.pPf(U)}},M.macOfficePostText=this.VFi):this.fEd&&(M.errorFileDownloadOffer=this.TJc);N=new J.a(!1,!1,!0);this.fEd?(N.zd=1,N.Ge(1,this.UJc)):N.zd=0;N.sg=this.id;M={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:M};N.Yh(this.dialogTitle,Object(l.a)(this,this.T_f,"reactOICErrorDialogHandler"),M)}}Object(D.a)(K,"ReactOICErrorDialog",m,[]);class H extends E{constructor(N,M,I){super(N,M,I);M={["errorMessage"]:this.jTh,["errorFileDownloadOffer"]:this.TJc};M.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.Chb,["onExecute"]:T=>{this.fJb(T)}};N=new J.a(!1,!1,!0);N.zd=1;N.Ge(1,this.UJc);N.sg=this.id;M={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:M};N.Yh(this.dialogTitle,Object(l.a)(this,this.T_f,"reactOICErrorDialogHandler"),M)}}Object(D.a)(H,"ReactOICErrorDialogWithDownload",E,[]);c.d(L,"a",function(){return P});class P{constructor(){this.zKa=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Ob.VE}L5k(N,M,I){this.zKa?new K(N,M,null,I):new v(N,M,null,
I)}M5k(N,M,I){this.zKa?new H(N,M,I):new F(N,M,I)}N5k(N,M,I,T,U){const {ReactOICErrorDialogWithTrial:W}=c(1845),{OICErrorDialogWithTrial:V}=c(1846);this.zKa?new W(N,M,I,null,T,U):new V(N,M,I,null,T,U)}static get instance(){return P._instance||(P._instance=new P)}}P._instance=null;Object(D.a)(P,"OICErrorDialogFactory",null,[1018])},1746:function(D,L,c){c.r(L);D=c(0);var l=c(337),e=c(1823),a=c(952),k=c(381),x=c(2),y=c(60),m=c(1146),u=c(21),z=c(107),v=c(86),E=c(63),F=c(1434),J=c(133),K=c(35),H=c(15),
P=c(282),N=c(108),M=c(8),I=c(234),T=c(117),U=c(82),W=c(322),V=c(14),Y=c(31),da=c(3),ba=c(11),ja=c(143),sa=c(554),ta=c(52),ra=c(1669),ma=c(1668),Ba=c(364),Pa=c(241);class Da extends Pa.a{constructor(fa,Ca,Ta,eb,jb,ob){super();this.init(fa);this.ul("DummyClipboardOperation");this.bib(x.AFrameworkApplication.xa,Ca,eb,jb,ob);this._context=Ta;this.ar=8;this.Ipa()}run(){this.M$a=!0;this.m5c(this._context);this.z4a();this.ar=32}}Object(D.a)(Da,"DummyClipboardOperation",Pa.a,[]);Pa=c(1561);class Ha extends Pa.a{constructor(fa,
Ca,Ta,eb,jb){super(fa,Ca,jb);this.ek=Ta;this.TPe=eb}Zkc(fa){let Ca;if(this.zS&&!fa)return M.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,uua:null};Ca=null;if(this.TPe&&!this.zS){const Ta=this.properties.ia(N.a.lVi,"");Ta&&(Ca=this.ek.Mlb(Ta))}Ca||(Ca=this.ek.Mlb(fa));return{returnValue:!0,uua:Ca}}}Object(D.a)(Ha,"HtmlStringImportStrategy",Pa.a,[]);var oa=c(1824);class wa extends oa.a{constructor(fa,Ca,Ta,eb,jb){super(fa,Ca,Ta,eb,jb)}C$h(){return this.properties.ia(N.a.hKb,
"")}Zkc(fa){x.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.Dch){if(this.ek)return fa=this.ek.vVf(fa,!0),{returnValue:!0,uua:fa};M.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.Zkc(fa)}cWc(fa){fa=super.cWc(fa);return fa.length&&" "!==fa?fa:"\u00a0"}}Object(D.a)(wa,"MultiLinePlainTextImportStrategy",oa.a,[]);class ia extends Pa.a{constructor(fa,Ca,Ta){super(fa,Ca,Ta)}Zkc(fa){({ClipboardActor:Ca}=
c(1746));if(this.zS&&!fa)return M.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,uua:null};var Ca=Ca.Iun;Ca.innerText=fa;return{returnValue:!0,uua:Ca}}}Object(D.a)(ia,"PlainTextImportStrategy",Pa.a,[]);var ca=c(96),pa=c(64);class Ma{constructor(fa){this.Ona=this.QCf=!1;this.bea=fa}sXi(){this.QCf||(this.QCf=!0,this.Ona=!1,this.bea.prepareForPaste(()=>{this.Ona=!0}));return this.Ona}Jvj(){this.QCf=!1;const fa=this.bea.paste();return fa?fa.hasChildNodes()?{returnValue:!0,qEd:fa}:
(M.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),Ma.Jc.Zb(ca.a.J0,{["Reason"]:pa.a.Kgf}),{returnValue:!1,qEd:fa}):(M.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),Ma.Jc.Zb(ca.a.UBb,{["Reason"]:pa.a.leg}),{returnValue:!1,qEd:fa})}static get Jc(){return J.a.instance}}Object(D.a)(Ma,"SystemClipboardImportStrategy",null,[620]);var ya=c(265);c.d(L,"ClipboardActor",function(){return Oa});class Oa{get mAi(){return this.FKa}set mAi(fa){this.FKa=fa}constructor(fa,Ca,Ta,eb,jb,ob,
Ya,Xa,Sa,ab,Hb,pb,Mb,Qb,Aa,bb,nb,Va){this.zdd=null;this.FKa=0;this.zid=this.yBc=!1;this.Dqb=l.a.On;this.U6c=()=>{const Ab=Array(1);Ab.push("PasteRecoveryFloatie");var Zb=this.R8j.uOa();Zb=Object.assign(new e.a,{x:Zb.x,y:Zb.y});this.nL.showFloatie(Zb,Ab,1);return 32};this.OEb=()=>{this.nL.r_&&this.nL.Dw();return 32};this.f_i=(Ab,Zb,Kb,dc,jc)=>{if(1===Kb)return 32;jc[a.a.On]=!1;return 32};this.lkl=(Ab,Zb,Kb,dc,jc,zb)=>{M.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var cc=zb.DataTransfer;
zb=cc.getData("text/html");cc=cc.getData("text/plain");let Ub=!1;const Wb=new k.DictionaryPropertySet;0<zb.length?(M.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Wb.setValue(N.a.EO,zb),Ub=!0):0<cc.length&&(M.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Wb.setValue(N.a.hKb,cc),Ub=!0);if(Ub){const Qa=this.wz.J(Zb);return this.PCd.create(Ab,Zb,Qa,new I.a(()=>this.iIc(Qa,Wb)),Kb,dc,jc,Wb)}return null};this.f_f=(Ab,Zb,Kb,dc,jc)=>{if(Zb=
"object"===typeof jc?jc:null)this.fYb?this.g$n(Ab,this.FKa,Zb):Ab===da.a.A$d?(Ab=this.FKa!==da.a.reformatPastedContent&&this.FKa!==da.a.GRa&&this.FKa!==da.a.xxa,Zb[this.Dqb]=this.FKa===da.a.reformatPastedContent||Ab):Ab===da.a.B$d?Zb[this.Dqb]=this.FKa===da.a.GRa:Ab===da.a.b_f&&(Zb[this.Dqb]=this.FKa===da.a.xxa);return 32};this.JW=(Ab,Zb,Kb,dc,jc,zb)=>{if((x.AFrameworkApplication.protectFile||x.AFrameworkApplication.qG)&&!x.AFrameworkApplication.BBb||ya.a.vga(Kb)&&ya.a.l$b())return new Da(Ab,Zb,Kb,
dc,jc,zb);let cc=this.wz.J(Zb);1!==dc&&cc&1&&(this.FKa=Zb);if(1!==dc){var Ub=Object(T.a)(114,zb)?zb:null;zb?(cc&1&&(this.zdd=Ub),Ub=Ub?Ub.ia(N.a.iY,0):0,Zb===da.a.paste&&Ub===da.a.QYa?cc=this.wz.J(da.a.BZ):Zb===da.a.N8&&Ub===da.a.hzb&&(cc=this.wz.J(da.a.g8d))):!zb&&cc&4096&&(zb=this.zdd,Ub=Object(T.a)(114,zb)?zb:null)&&(Ub=Ub.ia(N.a.N_c,y.a.nil),M.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",Ub))}return this.PCd.create(Ab,Zb,cc,new I.a(()=>this.iIc(cc,zb)),
Kb,dc,jc,zb)};this.gBn=(Ab,Zb,Kb,dc,jc)=>this.q3e(Ab,Zb,Kb,jc);this.fBn=(Ab,Zb,Kb,dc,jc)=>this.q3e(Ab,Zb,Kb,jc);this.eBn=(Ab,Zb,Kb,dc,jc)=>this.q3e(Ab,Zb,Kb,jc);this.$2d=(Ab,Zb,Kb,dc,jc,zb)=>{zb=Y.a.Tc(ta.a.instance.hb.lb.Qa.node,zb);return this.JW(Ab,Zb,Kb,dc,jc,zb)};this.oSj=fa;this.bea=Ca;this.nd=Ta;this.ek=eb;this.ga=ob;this.Ydd=ab;this.XRb=Hb;this.Be=pb;this.fg=Mb;this.Vb=Sa;this.eYb=Qb;this.fYb=Aa;this.R8j=bb;this.nL=nb;this.kEe=Va;this.Mh=m.a.getInstance(Ba.a.TYa);Xa&&(this.yBc=Xa.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),
this.zid=this.fYb&&Xa.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.wz=new W.a;this.wz.Z(da.a.paste,257);this.wz.Z(da.a.N8,8449);this.wz.Z(da.a.BZ,1);this.wz.Z(da.a.A1a,1);this.wz.Z(da.a.uyb,1);this.wz.Z(da.a.IBa,1);this.wz.Z(da.a.oVd,513);this.wz.Z(da.a.reformatPastedContent,4097);this.wz.Z(da.a.GRa,12289);this.wz.Z(da.a.xxa,131073);this.wz.Z(da.a.CVf,7);this.wz.Z(da.a.f8d,1);this.wz.Z(da.a.g8d,8193);this.wz.Z(da.a.copy,272);this.wz.Z(da.a.bEc,16);this.wz.Z(da.a.cut,304);this.wz.Z(da.a.q2e,
48);this.wz.Z(da.a.Z2d,64);this.wz.Z(da.a.$2d,64);this.wz.Z(da.a.showPlaceholderGlossary,65536);this.wz.Z(da.a.Sdf,1);this.zid&&this.wz.Z(da.a.Slb,this.wz.J(da.a.g8d))}get ZSa(){return null!=this.NDg?this.NDg:this.NDg=u.a.instance.Ma("Box4.Clipboard.ISystemClipboardAccessManager")}get telemetry(){return null!=this.hEg?this.hEg:this.hEg=u.a.instance.Ma("Common.Utils.Telemetry.ITelemetry")}get PCd(){return this.oSj.value}get Fyo(){return this.bea}Ub(){this.ga.gb(da.a.NEn,V.a.application,this.f_i,97);
this.ga.gb(da.a.OEn,V.a.application,this.f_i,97);this.ga.gb(da.a.A$d,V.a.application,this.f_f,97);this.ga.gb(da.a.B$d,V.a.application,this.f_f,97);this.ga.gb(da.a.b_f,V.a.application,this.f_f,97);this.ga.FS(da.a.q2e,V.a.view,this.JW,1028);this.ga.Hcb(da.a.bEc,V.a.view,this.JW);this.ga.FS(da.a.Sdf,V.a.view,this.lkl,1028);this.ga.FS(da.a.BZ,V.a.view,this.JW,1028);this.ga.FS(da.a.A1a,V.a.view,this.JW,1028);this.ga.FS(da.a.uyb,V.a.view,this.JW,1028);this.ga.FS(da.a.IBa,V.a.view,this.JW,1028);this.eYb&&
this.ga.gb(da.a.QYa,V.a.view,this.eBn,1028);this.fYb&&this.ga.gb(da.a.hzb,V.a.view,this.fBn,1028);this.ga.FS(da.a.paste,V.a.view,this.JW,1028);this.ga.FS(da.a.N8,V.a.view,this.JW,1028);this.ga.FS(da.a.g8d,V.a.view,this.JW,1028);this.ga.FS(da.a.f8d,V.a.view,this.JW,1028);this.ga.FS(da.a.CVf,V.a.view,this.JW,1028);this.ga.FS(da.a.reformatPastedContent,V.a.view,this.JW,1028);this.ga.FS(da.a.GRa,V.a.view,this.JW,1028);this.ga.pa(da.a.aMb,V.a.view,z.ActionManager.Kf);this.ga.pa(da.a.rVi,V.a.view,z.ActionManager.Kf);
this.ga.pa(da.a.oVi,V.a.view,z.ActionManager.Kf);this.ga.pa(da.a.pVi,V.a.view,z.ActionManager.Kf);this.ga.pa(da.a.qVi,V.a.view,z.ActionManager.Kf);this.ga.pa(da.a.nVi,V.a.view,z.ActionManager.Kf);this.ga.Hcb(da.a.Z2d,V.a.view,this.JW);this.ga.Hcb(da.a.$2d,V.a.view,this.$2d);this.ga.Hcb(da.a.oVd,V.a.view,this.JW);this.ga.Hcb(da.a.showPlaceholderGlossary,V.a.view,this.JW);this.zid&&(this.ga.gb(da.a.yEc,V.a.view,this.gBn,1028),this.ga.FS(da.a.Slb,V.a.view,this.JW,1028));this.ga.pa(da.a.iKh,V.a.view,
z.ActionManager.Kf);this.ga.pa(da.a.MKh,V.a.view,z.ActionManager.Kf);this.kEe&&(this.ga.gb(da.a.U6c,V.a.view,this.U6c,96),this.ga.gb(da.a.OEb,V.a.view,this.OEb,96))}h4(){if(this.Vb){const fa=this.Vb.fe(ja.AppFrame.xE);this.zid&&fa.bindAction(v.KeyInputManager.mc(E.a.Ypb,v.KeyInputManager.Ph|4),da.a.yEc)}else M.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}g$n(fa,Ca,Ta){switch(Ca){case da.a.GRa:case da.a.N8:case da.a.Slb:Ca=da.a.B$d;break;case da.a.xxa:Ca=
da.a.b_f;break;default:Ca=da.a.A$d}Ta[this.Dqb]=fa===Ca}h0l(){const fa=Object(T.a)(114,this.zdd)?this.zdd:null;return fa?fa.ia(N.a.N_c,y.a.nil):y.a.nil}q3e(fa,Ca,Ta,eb){if(1===Ta){if(!Object(T.a)(sa.a,Ca)||!this.Ydd||ya.a.vga(Ca)&&ya.a.l$b())return 8;Ta=new I.a(()=>this.iIc(this.wz.J(da.a.BZ),eb));const jb=this.Ydd.create(Ta,Object(U.a)(114,eb));Ta=new ma.a(x.AFrameworkApplication.K,F.a.instance,Ta,J.a.instance,jb,this.XRb);return ra.a.exh(Ca,Ta)?32:8}if(2===Ta){if(this.pko(ba.App.aYa))return this.QYa(fa);
ba.App.Sfc(()=>{this.QYa(fa)});return 32}return 2}QYa(fa){if(!this.Be)return M.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var Ca=this.Be.Dgb();if(!Ca)return M.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;Ca=Ca.Ln;if(!Ca)return M.ULS.sendTraceTag(592454659,307,10,"No document"),8;M.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",fa);this.Mh.logKpiUsage({kpiName:Ba.a.LMa});this.fg.kml(fa);fa=K.a.NBb(Ca,"paste");Ca=this.fg.Ufl();M.ULS.sendTraceTag(573388233,
307,50,"PasteEventHandled: {0}",Ca);if(fa)return M.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.Mh.logKpiSuccess({kpiName:Ba.a.LMa}),32;this.Nem();M.ULS.sendTraceTag(592454662,307,10,"execCommand failed");this.Mh.logKpiFailure({kpiName:Ba.a.LMa,errorName:"ExecCommandFailed"});return 8}Nem(){this.ZSa&&(this.ZSa.WNb(),Ba.a.U0d(!0,ta.a.instance,H.a.GF));if(this.telemetry){const fa=this.telemetry.E7c();fa.V_b("CallExecCommandPasteOperation");fa.fail("call to execCommand('paste') failed",
!0);this.telemetry.sfa(fa)}}pko(fa){let Ca=!1;this.Vb?this.Vb.currentScope?Ca=!this.Vb.oAf(this.Vb.currentScope.name):M.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):M.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(Ca){M.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Vb.currentScope.name);if(1>fa)return M.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Vb.Sif();return!1}return!0}iIc(fa,Ca){return fa&256?new Ma(this.Fyo):fa&2?fa&4096?new Ha(Ca,
this.nd,this.ek,ba.App.instance.TSc,ba.App.instance.DSa):new ia(Ca,this.nd,ba.App.instance.DSa):Ca.hasProperty(N.a.hKb)?new wa(Ca,this.nd,this.ek,this.yBc,ba.App.instance.DSa):new Ha(Ca,this.nd,this.ek,ba.App.instance.TSc,ba.App.instance.DSa)}static get Iun(){return P.a.rQd("Box4PasteScratchPad")}dxh(fa,Ca,Ta,eb){return!x.AFrameworkApplication.protectFile&&!x.AFrameworkApplication.qG||x.AFrameworkApplication.BBb?(fa=this.JW(null,fa?da.a.cut:da.a.copy,Ca,1,Ta,eb))?fa.response:8:8}}Object(D.a)(Oa,"ClipboardActor",
null,[])},1751:function(D,L,c){c.r(L);D=c(0);var l=c(16),e=c(1995),a=c(1802);class k extends a.a{constructor(){super();this.isCurrentUser=!1}}Object(D.a)(k,"IsMeAtMentionOptionalAttributes",a.a,[]);class x{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(D.a)(x,"DeltaAttributes",null,[]);var y=c(1595),m=c(10),u=c(84),z=c(17),v=c(8),E=c(1657);c.d(L,"ACommentFormatTranslator",
function(){return F});class F{constructor(J){this.ih=J}Dwk(J,K){const H=m.ParagraphReader.text(K);let P=null,N=null,M=null,I=0;var T=0,U=!1;let W="";for(K.qa||H&&H.length&&"\n"!==H||v.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");I<K.qa.length;){const Y=K.qa.J(I),da=Y.cp;var V=Y.formatting?Y.formatting.sn:null;W+=l.a.substring(H,U?T+1:T,da);Y.Km&&P&&(T=new e.a,T.fullName=W.startsWith("@")?W.substr(1):W,E.a(P,T),U=new k,E.c(P,U,T),J.Qxf(W,T,U,!0),W=
"",P=null);Y.Km&&N&&(T=M||new x,T.link=N.url,J.Ani(W,T),W="",N=null);P&&N||""===W||(this.ih.Jyb&&M?(J.Rni(W,M),M=null):J.lga(W),W="");Y.hyperlink&&(Y.hyperlink.hx?P=Y.hyperlink:Y.hyperlink.url&&(N=Y.hyperlink));this.ih.Jyb&&V&&(M=new x,M.weight=V.ia(z.a.bold,!1)?y.a.DKf:0,M.italic=V.ia(z.a.italic,!1),M.underline=V.ia(z.a.underline,!1),M.strikethrough=V.ia(z.a.strikethrough,!1),V.hasProperty(z.a.highlight)&&(T=V.getValue(z.a.highlight),M.highlight=u.a.wI(T)),V.hasProperty(z.a.fontColor)&&(V=V.getValue(z.a.fontColor),
M.color=u.a.wI(V)));T=da;U=!!Y.blob;I++}}}F.EAk="_@_";F.FAk="Z";Object(D.a)(F,"ACommentFormatTranslator",null,[424])},1762:function(D,L,c){D=c(0);var l=c(152),e=c(16),a=c(23),k=c(21),x=c(2),y=c(181),m=c(167);class u{static get Wg(){return l.a.Xz(u.Hm,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}u.Hm="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(D.a)(u,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var z=c(18),v=c(3);c.d(L,"a",function(){return E});class E extends l.a{constructor(F,J,K){super();this.fUg=!1;this.BV=null;this.qzl=H=>{switch(H){case 1:this.ga.processAction(z.a.mYh,2);break;case 2:this.ga.processAction(z.a.nYh,2);break;case 0:this.ga.processAction(z.a.oYh,2)}};this.hu=J;this.YR=!1;this.STb=E.Yyl;this.Fh=F;this.ga=K;this.sg="FootnoteEndnoteFormattingOptionsDialog";this.zd=2;this.Wg=u.Wg;this.Ge(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.Ge(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Yh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.qzl,null);this.xhb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.BV}set fontName(F){this.BV=F;if(F=document.getElementById("FontSizeComboBox"))F.focus(),this.Fh.updateCommandUI()}get fontSize(){return this.STb}get xhb(){return this.fUg}set xhb(F){this.fUg=F;this.Jwn()}E8(){this.OAd("FontStyleComboBox",
"FontPlaceholder",z.a.zLd.toString(),z.a.QZi.toString(),z.a.e0c.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.OAd("FontSizeComboBox","FontPlaceholder",z.a.ALd.toString(),v.a.a1c.toString(),z.a.f0c.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const F=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
e.a.i_(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),J=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',e.a.i_(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.gEc("NoStyle","IndentPlaceholderStyles",
z.a.qYh.toString(),z.a.RZi.toString(),F,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.gEc("FirstLineIndent","IndentPlaceholderStyles",z.a.pYh.toString(),z.a.IZf.toString(),J,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}OAd(F,J,K,H,P,N,M){K=y.c(F,K,!0,!0,H,P,e.a.Af(N),!0,M);this.mFd(F,J,K,"Medium")}gEc(F,J,K,H,P,N,M){K=y.f(F,K,H,e.a.Af(P),e.a.Af(N),M);this.mFd(F,J,K,"Large",N)}mFd(F,J,K,H,P=null){J=document.getElementById(J);
this.hu.fYa(F,K);K=this.hu.ZCb(F,H);P&&a.a.lzd(K,String.format("{0}Label",F),P);J.appendChild(K);this.hu.$oa(F)}Jwn(){this.hu.$oa("NoStyle");this.hu.$oa("FirstLineIndent")}dispose(){this.YR||(this.hu.kY("FontStyleComboBox"),this.hu.kY("FontSizeComboBox"),this.hu.kY("NoStyle"),this.hu.kY("FirstLineIndent"),this.YR=!0);this.Fh.updateCommandUI();super.dispose()}static get jTa(){return k.a.instance.resolve("Common.IStandaloneRootController").zca}static dQl(){return new E(m.App.Hn,E.jTa,x.AFrameworkApplication.xa)}static cQl(){return E.dQl()}}
E.Yyl=-1;Object(D.a)(E,"FootnoteEndnoteFormattingOptionsDialog",l.a,[])},1791:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a){this.Bi=this.vmd=0;this.DTg=a;this.Pek=e}zkb(){return this.vmd-this.Bi>=this.Pek}reset(){this.Bi=this.vmd=this.DTg()}update(){this.vmd=this.DTg()}}Object(D.a)(l,"TimeBasedTaskYieldStrategy",null,[609])},1802:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.contentId=""}}Object(D.a)(l,"AtMentionOptionalAttributes",
null,[])},1830:function(D,L){Object.defineProperty(L,"__esModule",{value:!0});L.ObjectSchemaType=L.ObjectSemantic=L.SequenceType=L.IntentIds=void 0;(function(c){c.Logging="Logging";c.ZeroTermMenu="ZeroTermMenu";c.Floatie="Floatie"})(L.IntentIds||(L.IntentIds={}));(function(c){c.CommandId="CommandId";c.ControlId="ControlId"})(L.SequenceType||(L.SequenceType={}));(function(c){c.CommandIdHistory="CommandIdHistory";c.ControlIdHistory="ControlIdHistory";c.FilteredCommandIdHistory="FilteredCommandIdHistory";
c.CanvasContext="CanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.GenericSuggestions="GenericSuggestions"})(L.ObjectSemantic||(L.ObjectSemantic={}));(function(c){c.CommandExecutionSequence="CommandExecutionSequence";c.WordCanvasContext="WordCanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.RankedSuggestion="RankedSuggestion"})(L.ObjectSchemaType||(L.ObjectSchemaType={}))},1831:function(D,L,c){Object.defineProperty(L,"__esModule",
{value:!0});L.SearchSuggestionAnnotation=L.SearchSuggestionSignal=void 0;const l=c(222);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[e.getTypeName()])}}L.SearchSuggestionSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=
k}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}L.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1839:function(D,L,c){var l=this&&this.RD||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.xy:m.writable||m.configurable))m={enumerable:!0,
get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1840),L);e(c(1841),L);e(c(1842),L);e(c(1843),L);D.exports.ContractEntityAnnotation||Object.defineProperty(D.exports,"ContractEntityAnnotation",{enumerable:!0,get:function(){return D.exports.ContractEntityAnnotation}});
D.exports.ContractEntitySignal||Object.defineProperty(D.exports,"ContractEntitySignal",{enumerable:!0,get:function(){return D.exports.ContractEntitySignal}})},1840:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1841:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1842:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.ContractEntityAnnotation=void 0;const l=c(222);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}L.ContractEntityAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1843:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.ContractEntitySignal=void 0;const l=c(222);class e{constructor(a){l.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])}}L.ContractEntitySignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1845:function(D,L,c){c.r(L);c.d(L,"ReactOICErrorDialogWithTrial",function(){return k});D=c(0);var l=c(46);L=c(1687);var e=c(359),a=c(152);class k extends L.a{constructor(x,y,m,u,z,v){super(x,y,m,u,z,v);y={["errorMessage"]:this.iTh,["offerString"]:this.JLi};x=new a.a(!1,!1,!0);this.Dlj?(x.zd=1,y.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Chb,["onExecute"]:()=>{e.Redirect.showHelp(this.rji)}}):
(x.zd=4,x.Ge(2,this.Cki));x.Ge(1,this.fxd);x.sg=this.id;y={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:y};x.Yh(this.dialogTitle,Object(l.a)(this,this.yIn,"reactOICErrorDialogWithTrialHandler"),y)}}Object(D.a)(k,"ReactOICErrorDialogWithTrial",L.a,[])},1846:function(D,L,c){c.r(L);c.d(L,"OICErrorDialogWithTrial",function(){return a});D=c(0);var l=c(46);L=c(1687);var e=c(141);class a extends L.a{constructor(k,x,y,m,u,z){super(k,x,y,m,u,z);k=document.createElement("span");k.innerText=this.iTh;
k.appendChild(document.createElement("br"));k.appendChild(document.createElement("br"));x=document.createElement("span");x.innerText=this.JLi;k.appendChild(x);x=new e.StandardDialog;this.Dlj?(x.zd=1,x.YWe(this.Chb,this.rji)):(x.zd=4,x.Ge(2,this.Cki));x.Ge(1,this.fxd);x.sg=this.id;x.Au(this.dialogTitle,null,this.icon,Object(l.a)(this,this.$Qm,"legacyOICErrorDialogWithTrialHandler"),k)}}Object(D.a)(a,"OICErrorDialogWithTrial",L.a,[])},1848:function(D,L,c){var l=this&&this.RD||(Object.create?function(a,
k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1849),L);e(c(1850),L);D.exports.SearchProviderAnnotation||Object.defineProperty(D.exports,"SearchProviderAnnotation",{enumerable:!0,get:function(){return D.exports.SearchProviderAnnotation}});
D.exports.SearchProviderSignal||Object.defineProperty(D.exports,"SearchProviderSignal",{enumerable:!0,get:function(){return D.exports.SearchProviderSignal}})},1849:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1850:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.SearchProviderAnnotation=L.SearchProviderSignal=void 0;const l=c(222);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}L.SearchProviderSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}L.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1851:function(D,
L,c){var l=this&&this.RD||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.xy:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1852),L);e(c(1853),L);D.exports.Result||
Object.defineProperty(D.exports,"Result",{enumerable:!0,get:function(){return D.exports.Result}});D.exports.TextExtractiveSummaryAnnotation||Object.defineProperty(D.exports,"TextExtractiveSummaryAnnotation",{enumerable:!0,get:function(){return D.exports.TextExtractiveSummaryAnnotation}})},1852:function(D,L){Object.defineProperty(L,"__esModule",{value:!0});L.Result=void 0;D=L.Result||(L.Result={});D.BlockedByPostfilter="BlockedByPostfilter";D.BlockedByPostfilterProcessError="BlockedByPostfilterProcessError";
D.BlockedByPrefilter="BlockedByPrefilter";D.BlockedByQualityCheck="BlockedByQualityCheck";D.InvalidRequestForm="InvalidRequestForm";D.Success="Success";D.UnknownError="UnknownError"},1853:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.TextExtractiveSummaryAnnotation=L.ExtractiveSummarizationArray=L.ExtractiveSummarization=void 0;const l=c(222);class e{constructor(x){l.SchemaObject.assign(e,this,x)}static getTypeName(){return"AugLoop_TextExtractiveSummarization_ExtractiveSummarization"}static getBaseTypes(){return[]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,
[e.getTypeName()])}}L.ExtractiveSummarization=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(x){l.SchemaObject.assign(a,this,x)}static getTypeName(){return"AugLoop_TextExtractiveSummarization_ExtractiveSummarizationArray"}static getBaseTypes(){return[]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}L.ExtractiveSummarizationArray=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(x){l.SchemaObject.assign(k,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=
x}static getTypeName(){return"AugLoop_TextExtractiveSummarization_TextExtractiveSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[k.getTypeName()])}}L.TextExtractiveSummaryAnnotation=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1921:function(D,L,c){function l(ka){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");ka?
P.WPn():P.main();fi.main(ka);yh.main(ka);z.a.instance.Gc(new Pm,0,ka);z.a.instance.Gc(new Pp,0,ka);ym(ka);Af(ka)}var e=c(0),a=c(8),k=c(1577),x=c(1590),y=c(2),m=c(75),u=c(601),z=c(180),v=c(34),E=c(35),F=c(15),J=c(72),K=c(21),H=c(126);class P{get name(){return"Common.App.OAuth.OAuthPackage"}yc(ka){ka.register(161,"Common.App.OAuth.IOAuthManager").singleInstance().Qd(()=>new k.OAuthManager)}init(){const ka=K.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.hIo(ka)}hIo(ka){const Za=y.AFrameworkApplication.K.kb("FileSource");
if(y.AFrameworkApplication.K.$("IsO365ConsumerHost")||y.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===Za){var Cb=u.OAuthManagerSettings.w8e;if(Cb&&Cb.IsEnabled){var Rb=Cb.Application,sc=u.OAuthManagerSettings.authority;if(void 0!==Rb&&null!==Rb&&Rb.length&&void 0!==sc&&null!==sc&&sc.length){var Wc=x.a[ka.cja],xd=F.a.GF,oe=ka.wK();try{var Nd=new Map;void 0!==Nd&&null!==Nd?(Nd.set("SupportStatus",Wc),Nd.set("Browser",xd),Nd.set("AuthStrategy",oe)):Nd=null}catch(hf){Nd=null}m.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT",
"WacOAuthFC",Nd);var $e=E.a.Ue();ka.T4("Core",Rb).then(hf=>{const bg=Math.floor(E.a.Ue()-$e);Wc=x.a[ka.cja];xd=F.a.GF;oe=ka.wK();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',bg,hf.IsSuccess,Wc,hf.ErrorCode,Za,xd,oe);Nd&&(Nd.set("SupportStatus",Wc),Nd.set("Browser",xd),Nd.set("AuthStrategy",oe));var Dg=Object.assign(new H.a,{durationMs:bg,
extendedProperties:Nd});if(hf.IsSuccess){if(m.Health.instance.recordKpiSuccess("WacCorePFT",Dg),hf="Bearer "+hf.Token,y.AFrameworkApplication.Ke.qlg=hf,Dg=Cb.Endpoint){var Zh=E.a.Ue();y.AFrameworkApplication.Ke.h_b(Dg,1,null,{["Authorization"]:hf},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(zh=>{var zi=Math.floor(E.a.Ue()-Zh),Ti=null;zh.wo?zh="Canceled":zh.Ai?zh="Faulted":(Ti=zh.result,zh=Ti.succeeded?"Completed":"Failed");zi={["TaskResult"]:zh,["BrowserTokenDurationMS"]:bg,
["BrowserValidationDurationMS"]:zi};Ti&&(zi.HttpStatus=Ti.args.data.Ve,Ti.succeeded&&(Ti=v.a(Ti.args.data.we),zi.ServerValidationDurationMS=Ti.ElapsedMilliseconds,zi.ServerValidationResult=Ti.ValidatedToken,zi.KMSI=Ti.KMSI,zi.Scopes=Ti.Scopes,zi.TokenExpirationS=Math.floor(parseInt(Ti.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,3E3,"Completed"===zh?50:15,J.a.toJSON(zi))})}}else m.Health.instance.recordKpiFailure("WacCorePFT",hf.ErrorCode,!1,!1,Dg)}).catch(hf=>{var bg=Math.floor(E.a.Ue()-
$e);bg=Object.assign(new H.a,{durationMs:bg,extendedProperties:Nd});m.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+hf.toString(),!1,!1,bg)})}}}}dispose(){}static main(){z.a.instance.Gc(new P)}static WPn(){z.a.instance.Gc(new P,0,!0)}}Object(e.a)(P,"OAuthPackage",null,[1,2]);var N=c(323),M=c(394),I=c(16);class T{constructor(){this.qsd=new M.a}VHo(ka,Za){if(!ka)return a.ULS.sendTraceTag(40478031,306,10,"SDX AssetId is null."),!1;ka=I.a.fh(ka);if(this.qsd.ob(ka))return a.ULS.sendTraceTag(40478032,
306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",ka),!1;this.qsd.Z(ka,Za);return!0}$Zl(ka){if(!ka)return a.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;ka=I.a.fh(ka);return this.qsd.ob(ka)?this.qsd.J(ka):(a.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",ka),null)}}Object(e.a)(T,"SdxPaneSuppressionManager",null,[]);var U=c(234),W=c(269),V=c(11);class Y{constructor(ka){this.WIe=0;this.c6j=ka}zkb(){return this.WIe>=
this.c6j}reset(){this.WIe=0}update(){this.WIe++}}Object(e.a)(Y,"NodeCountBasedTaskYieldStrategy",null,[609]);var da=c(1791);class ba{constructor(){this.e5c=new Set}HLb(ka){this.e5c.add(ka)}pKo(ka){this.e5c.delete(ka)}gnn(){return()=>{this.e5c.forEach(ka=>{ka.onSessionClose()})}}hnn(){return()=>{this.e5c.forEach(ka=>{ka.onSessionConnect()})}}inn(){return()=>{this.e5c.forEach(ka=>{ka.onSessionDisconnect()})}}}Object(e.a)(ba,"AlSessionLifeEventNotifier",null,[435]);var ja=c(1386),sa=c(66),ta=c(67),ra=
c(79),ma=c(60),Ba=c(6),Pa=c(1494),Da=c(174),Ha=c(358),oa=c(1023),wa=c(708),ia=c(254),ca=c(451),pa=c(684),Ma=c(455),ya=c(450);class Oa{constructor(){this.token=null}}Object(e.a)(Oa,"ReleaseAnnotationParameters",null,[]);class fa{constructor(){this.value=this.id=this.parentPath=null}}Object(e.a)(fa,"SetAnnotationMetadataParameters",null,[]);class Ca{constructor(){this.id=this.parentPath=null;this.value=0}}Object(e.a)(Ca,"SetAnnotationStateParameters",null,[]);var Ta=c(529),eb=c(318),jb=c(76),ob=c(80),
Ya=c(602),Xa=c(1205),Sa=c(324),ab=c(754),Hb=c(10),pb=c(441);class Mb extends Sys.EventArgs{constructor(ka,Za){super();this.annotation=ka;this.Scb=Za}}Object(e.a)(Mb,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var Qb=c(999);class Aa{constructor(ka){this.HZe=this.annotations=null;if(!ka)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=null;else if(ka.items&&0<ka.items.length){const Za=Aa.FPd(ka.parentPath);this.annotations=Array(ka.items.length);let Cb=0;
for(const Rb of ka.items){const sc=Object.assign(new Qb.a,{id:Rb.id,parentPath:Za,content:Rb.body,annotationType:ia.a.getTypeNameFor(Rb.body),parentRevId:ka.parentRevId});this.annotations[Cb++]=sc}this.HZe=ia.a.getTypeNameFor(ka)}}static FPd(ka){return ka?ka.join("\\"):""}}Object(e.a)(Aa,"AnnotationOperation",null,[]);class bb extends Sys.EventArgs{constructor(ka,Za){super();this.annotationType=ka;this.activated=Za}}Object(e.a)(bb,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class nb extends Sys.EventArgs{constructor(ka,
Za){super();this.annotation=ka;this.opType=Za}}Object(e.a)(nb,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class Va{constructor(){this.newState=this.oldState=0;this.handlers=new jb.a}}Object(e.a)(Va,"AnnotationResultStateUpdateData",null,[]);var Ab=c(485),Zb=c(993);class Kb{constructor(){this.EZe=this.uvk=this.FZe=null}}Object(e.a)(Kb,"AnnotationCallbacks",null,[]);class dc{constructor(ka,Za,Cb,Rb,sc,Wc){this.GZb=null;this.Cxc=new M.a(0);this.WBc=new M.a;this.Lcd=new M.a;this.Vpd=new Ab.a;this.uSf=
null;this.pi=ka;this.vKa=Za;this.cI=Cb;this.VD=Rb;this.gI=sc;this.jd=Wc}GWo(ka,Za,Cb,Rb){this.VD.C9b(ka)&&this.pi.he(()=>{if(!this.GZb){this.GZb=new M.a;var sc=Hb.ParagraphReader.Wv(pb.a.getRootNode(),!0,!0);for(const Wc of sc)Wc&&(sc=Wc.ia(Ba.a.Lc,0))&&(this.GZb.add(sc,Wc.id),this.Cxc.Z(Wc.id.toString(),sc))}this.vKa.tSf(ka,(Wc,xd)=>{if(Wc){var oe=this.VD.d8h(ka);Wc.contentDescriptor.Av===oe&&((oe=this.AQl(Wc))?Wc.Rcb?(oe=this.J8e(Wc,oe))&&(xd?Cb(xd,Wc.contentDescriptor):Za(oe,Wc.contentDescriptor)):
Rb(Wc.contentDescriptor):this.obl(Wc,Object.assign(new Kb,{FZe:Za,uvk:Cb,EZe:Rb})))}})},"PAS:FEPAOT")}AQl(ka){if(3===ka.contentDescriptor.Av){let Za;return({value:Za}=this.GZb.Ec(ka.contentDescriptor.paragraphId)).returnValue?Za:null}if(4===ka.contentDescriptor.Av)return ma.a.nil;a.ULS.sendTraceTag(592525442,dc.Di,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}jDm(ka,Za){if(3===ka.contentDescriptor.Av)return Za=this.gI.value.Db(Za).getValue(Ba.a.sj),ka.contentDescriptor.sj===
Za;if(4===ka.contentDescriptor.Av&&Za===ma.a.nil)return!0;a.ULS.sendTraceTag(592525443,dc.Di,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}obl(ka,Za){if(3===ka.contentDescriptor.Av){const Cb=ka.contentDescriptor.paragraphId;this.WBc.ob(Cb)||this.WBc.add(Cb,new jb.a);this.WBc.J(Cb).add(Rb=>{12===Rb.type&&this.GZb.add(Cb,Rb.id);ka.Rcb?(Rb=this.J8e(ka,Rb.id))&&Za.FZe(Rb,ka.contentDescriptor):Za.EZe(ka.contentDescriptor)})}else if(4===ka.contentDescriptor.Av)if(ka.Rcb){const Cb=
this.J8e(ka,ma.a.nil);Cb&&Za.FZe(Cb,ka.contentDescriptor)}else Za.EZe(ka.contentDescriptor);else a.ULS.sendTraceTag(592525444,dc.Di,15,"DelayCallbackForAnnotation: Unsupported content type")}J8e(ka,Za){if(this.jDm(ka,Za)){if(Za=this.VD.Han(ka.Rcb,ka.contentDescriptor,Za.toString()))return this.Lcd.Z(Za.id,ka.T4a),Za}else this.jd.isFeatureEnabled(87)&&this.cI.yCc(ka);return null}vAj(ka,Za){const Cb=this.VD.ZMd(ka);Cb&&(Za===oa.a.getTypeName()?this.BGo(ka,Cb):this.oGo(ka,Cb))}BGo(ka,Za){this.VD.C9b(ka.annotationType)&&
(this.cI.NRa(this.gI.value,Za,ka.annotationType),this.Lcd.remove(ka.id))}oGo(ka,Za){if(this.VD.C9b(ka.annotationType)){Za=Object.assign(new Zb.a,{Rcb:this.VD.yvk(ka),contentDescriptor:Za,annotationType:ka.annotationType});Za=this.cI.addAnnotation(this.gI.value,Za);this.Lcd.Z(ka.id,Za);const Cb=this.VD.Cfi(ka.annotationType);Cb&&this.Vpd.contains(Cb)&&(this.pi.he(()=>{var Rb=Hb.ParagraphReader.Wv(pb.a.getRootNode(),!0,!0);if(Rb&&0<Rb.count){const sc=new jb.a;for(const Wc of Rb)(Rb=dc.BPd(Wc))&&sc.add(Rb);
0<sc.count&&this.cI.Zkh(this.gI.value,Cb,sc.toArray())}},"PAS:TAOCPA"),this.Vpd.remove(Cb))}}ilb(ka){if(this.GZb)if(ka){var Za=ka.ia(Ba.a.Lc,0);if(Za&&(this.Cxc.Z(ka.id.toString(),Za),({value:Za}=this.WBc.Ec(Za)).returnValue))for(const Cb of Za)Cb(ka)}else a.ULS.sendTraceTag(592525445,dc.Di,10,"OnParagraphNodeConnected: Invalid node")}FPi(ka,Za){if(ka){var Cb=ka.id.toString();ka=ka.ia(Ba.a.Lc,0);var Rb=0;({value:Rb}=this.Cxc.Ec(Cb)).returnValue&&(3===Za?(this.WBc.remove(Rb),this.Cxc.remove(Cb)):2===
Za?this.Cxc.Z(Cb,ka):a.ULS.sendTraceTag(592525447,dc.Di,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,dc.Di,10,"UpdatePersistedAnnotations: Invalid node")}O2l(ka){let Za;return({value:Za}=this.Lcd.Ec(ka)).returnValue?Za:ma.a.nil}nSo(ka,Za,Cb){ka?Za?this.vKa.G$h(ka,Rb=>{if(Rb){const xd=dc.BPd(Za,Cb);if(xd){var sc=Array(Rb.length),Wc=!1;for(let oe=0;oe<Rb.length;oe++)if(Wc||xd!==Rb[oe])sc[oe]=Rb[oe];else{const Nd=dc.BPd(Za);if(!Nd)return;
Wc=!0;sc[oe]=Nd;Rb[oe]=Nd}Wc&&this.cI.Zkh(this.gI.value,ka,sc)}}}):a.ULS.sendTraceTag(588863697,dc.Di,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,dc.Di,10,"UpdateWorkflowParagraphVersion: null workflowType")}weo(ka){ka?this.Vpd.add(ka):a.ULS.sendTraceTag(588863698,dc.Di,10,"SetPendingWorkflow: null workflowType")}zRk(ka){ka?this.Vpd.remove(ka):a.ULS.sendTraceTag(588105731,dc.Di,10,"ClearPendingWorkflow: null workflowType")}static BPd(ka,Za=0){if(!ka)return null;
Za||(Za=ka.ia(Ba.a.sj,0));ka=Hb.ParagraphReader.rQ(ka);if(Za&&ka)return String.format("{0}{1}{2}",ka,dc.ntn,Za);a.ULS.sendTraceTag(588091606,dc.Di,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",Za?"valid":"0",ka?"valid":"0");return null}}dc.Di=389;dc.ntn="-";Object(e.a)(dc,"PersistedAnnotationStorage",null,[606]);class jc{constructor(){this.config=this.token=null}}Object(e.a)(jc,"UpdateAnnotationConfigParameters",null,[]);var zb=c(132),cc=c(1186),Ub=c(361),Wb=c(1396),Qa=c(860),
sb=c(213),Jb=c(1094);class pc{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe,Nd,$e,hf,bg=null,Dg){this.ybb=Dg;this.ra=new ta.a;this.$ya=new ob.a;this.h5=new ob.a;this.RC=new ob.a;this.Wqe=new ob.a;this.mqc=new Ta.a(eb.a.Xh());this.uKe=new jb.a;this.iRb=new ob.a;this.Sqe=new ob.a;this.Mcd=new ob.a;this.jRb=new ob.a;this.Bnc=new ob.a;this.Ncd=new ob.a;this.bfd=new ob.a;this.Znd=[];this.$nd=[];this.Kvc=null;this.d6j=new Ta.a(eb.a.Xh());this.Uqe=new Map;this.jqc=new Map;this.Loc=null;this.$ia=new ob.a;this.DHc=
null;this.x7g=this.HWg=0;this.hXa=null;this.H9k=()=>{if(this.Znd.length||this.$nd.length)try{0<this.Znd.length&&this.s4m(),0<this.$nd.length&&this.KJo()}finally{this.MRk()}else this.Gb.Se(this.Kvc),this.Kvc=null};this.IRk=()=>{const Zh=new jb.a;for(const zh of this.RC.values)if(Zh.add(zh),Zh.count===pc.m6j)break;for(const zh of Zh)this.XAb(zh),this.MMb(zh,oa.a.getTypeName());this.RC.count||(this.Gb.Se(this.Loc),this.Loc=null)};this.aZc=(Zh,zh)=>{for(const zi of zh.Gj)Zh=zi.intent,!Zh.type&&this.Ujo(Zh.intent,
zi.cpBegin,zi.cpEnd,zi.LHb)&&this.XAb(Zh.intent)};this.W0j=ka.$("AugLoopAnnotationsAttachingIsEnabled");this.Abk=ka.oC("SendReleaseMessageAnnotationList")||[];this.jd=$e;this.MIa=bg;this.vKa=Wc;this.cI=xd;this.zm=Cb;this.VD=oe;this.v$=Nd;this.gI=Rb;this.pi=Za;this.Gb=sc;K.a.instance.resolve("Box4.ICharacterPropertiesEditor").hYe(this.aZc);this.Is=hf;this.ePj=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",!1);this.L0j=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1);this.x2j=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.KYg=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.ybb&&this.Vfm();this.Hy=sb.a.instance}get o3i(){return this.jRb}set o3i(ka){this.jRb=ka}mb(ka,Za){a.ULS.sendTraceTag(41521862,pc.Di,50,"New registration for annotation type: {0}.",Za);this.addHandler(ka,Za);this.fWe(Za).catch(Cb=>{a.ULS.sendTraceTag(594396739,pc.Di,10,"Failed to activate annotation type {0}: {1}",
Za,Cb.toString())})}addHandler(ka,Za){if(ka&&Za&&""!==Za){var Cb=null;({value:Cb}=this.jRb.Ec(Za,Cb)).returnValue?Cb.add(ka):(Cb=new jb.a,Cb.add(ka),this.jRb.add(Za,Cb))}else a.ULS.sendTraceTag(41521861,pc.Di,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!ka,!Za,""===Za)}sc(ka,Za){a.ULS.sendTraceTag(41521863,pc.Di,50,"Unregister handler for annotation type: {0}.",Za);let Cb=null;({value:Cb}=this.jRb.Ec(Za,Cb)).returnValue&&(Cb.remove(ka),
Cb.count||(a.ULS.sendTraceTag(41521864,pc.Di,50,"Unregister all handlers for annotation type: {0}.",Za),this.jRb.remove(Za),this.fen(Za)))}$gj(ka){this.DHc||(this.DHc=this.Is.Qc(2),this.DHc.Eb(ka))}MRk(){var ka;null===(ka=this.DHc)||void 0===ka?void 0:ka.dispose();this.DHc=null}OGh(){this.Kvc||(this.Kvc=new ra.a(4,2,100,this.H9k,141),this.Gb.Wb(this.Kvc))}s4m(){let ka;ka=Array.dequeue(this.Znd);const Za=pb.a.EDb(this.gI.value,ka);if(Za)if(Za.Wi){this.$gj(Za);var Cb=null;if(({value:Cb}=this.Bnc.Ec(ka,
Cb)).returnValue){this.Bnc.remove(ka);for(const Rb of Cb)this.t4m(Za,Rb)}else a.ULS.sendTraceTag(50663568,pc.Di,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.d6j.add(ka);else a.ULS.sendTraceTag(50436127,pc.Di,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}t4m(ka,Za){var Cb=Za.content.range;Cb=new Xa.a(0,Cb.start,Cb.start+Cb.length,ma.a.create(),Za,Rb=>{this.Wqe.Z(Za.id,Rb.toString())});this.zm.xQa(ka,Cb);this.ra.Q7&&this.ra.raiseEvent(pc.kdc,new nb(Za,
Ha.a.getTypeName()))}uGi(ka){const Za=pb.a.M0a(ka.parentPath);let Cb=null;({value:Cb}=this.Bnc.Ec(Za,Cb)).returnValue||(Cb=new jb.a,this.Bnc.add(Za,Cb),this.Znd.push(Za));Cb.add(ka);this.OGh()}v4m(ka,Za){this.pi.he(()=>{let Cb;if(({value:Cb}=this.h5.Ec(ka,Cb)).returnValue){var Rb=this.mkj(ka);for(const sc of Cb){let Wc;({value:Wc}=this.RC.Ec(sc,Wc)).returnValue&&Za(Wc)&&pc.JFb(Wc)&&(this.uGi(Wc),Rb&&this.ra.raiseEvent(pc.kdc,new nb(Wc,oa.a.getTypeName())))}}},"AS:MIFAT")}LJo(ka,Za){this.pi.he(()=>
{let Cb;if(({value:Cb}=this.h5.Ec(ka,Cb)).returnValue)for(const Rb of Cb){let sc;({value:sc}=this.RC.Ec(Rb,sc)).returnValue&&Za(sc)&&pc.JFb(sc)&&this.aig(sc)}},"AS:UIFAT")}nen(ka){var Za=pb.a.eM(ka);let Cb=null;if(({value:Cb}=this.$ya.Ec(Za,Cb)).returnValue){Za=0;for(var Rb=new jb.a;Cb.count>Za;){var sc=Cb.J(Za),Wc=null;({value:Wc}=this.RC.Ec(sc,Wc)).returnValue&&pc.JFb(Wc)?this.VD.q6c(ka,Wc)?this.XAb(Wc,!this.jd.isFeatureEnabled(87)):(sc=Wc.content.range,Wc=new Xa.a(0,sc.start,sc.start+sc.length,
ma.a.create(),Wc),Rb.add(Wc),Za++):Za++}0<Rb.count&&this.zm.$1d(ka,Rb)}}KJo(){let ka="";ka=Array.dequeue(this.$nd);const Za=pb.a.EDb(this.gI.value,ka);if(Za&&12===Za.type){this.$gj(Za);var Cb=null;({value:Cb}=this.Ncd.Ec(ka,Cb)).returnValue?(this.zm.X9c(Rb=>Cb.contains(Rb.intent),Za,0),this.Ncd.remove(ka)):a.ULS.sendTraceTag(50663570,pc.Di,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else a.ULS.sendTraceTag(50436128,pc.Di,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}aig(ka){let Za;
({value:Za}=this.Wqe.Ec(ka.id,Za)).returnValue||(Za=pb.a.M0a(ka.parentPath));this.Wqe.remove(ka.id);var Cb=null;({value:Cb}=this.Ncd.Ec(Za,Cb)).returnValue||(Cb=new jb.a,this.Ncd.add(Za,Cb),this.$nd.push(Za));Cb.add(ka);this.OGh();Cb=null;({value:Cb}=this.Bnc.Ec(Za,Cb)).returnValue&&Cb.remove(ka)}ymk(ka){const Za=ka.id;var Cb=ka.annotationType;const Rb=ka.parentPath;if(this.VD.Yib(ka)){var sc=pb.a.Qgb(this.gI.value,Rb);if(sc&&(sc=sc.ia(Ba.a.sj,0).toString(),ka.parentRevId&&sc!==ka.parentRevId))return!1}sc=
null;({value:sc}=this.h5.Ec(Cb,sc)).returnValue||(sc=new jb.a,this.h5.add(Cb,sc));sc.add(Za);Cb=null;({value:Cb}=this.$ya.Ec(Rb,Cb)).returnValue||(Cb=new jb.a,this.$ya.add(Rb,Cb));Cb.add(Za);this.RC.add(Za,ka);this.FWo(ka);return!0}FWo(ka){const Za=this.VD.O_h(ka);if(0===Za.length)this.zOh(ka);else{let Cb=!1;this.vKa.Zkn(Za,ka.annotationType,(Rb,sc)=>{this.RC.ob(ka.id)?(sc=this.VD.pjb(ka,pb.a.XEl(ka)),!Rb&&sc?this.jjg(ka,10,!1):Rb&&this.jjg(ka,Rb),Cb||(this.zOh(ka),Cb=!0)):sc.ESa=!0})}}zOh(ka){const Za=
pc.JFb(ka);Za&&this.uGi(ka);!Za&&this.ra.Q7&&this.ra.raiseEvent(pc.kdc,new nb(ka,Ha.a.getTypeName()))}Txj(ka,Za,Cb,Rb){let sc=!0;this.pi.he(()=>{if(Rb.startsWith(pb.a.jBb)){var Wc=ka.id,xd=null;if(Za===oa.a.getTypeName())this.XAb(ka);else if(({value:xd}=this.RC.Ec(Wc,xd)).returnValue)a.ULS.sendTraceTag(41418891,pc.Di,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",Wc,ka.annotationType),this.RC.Z(Wc,ka);else if(!this.ymk(ka)){sc=!1;return}Cb&&Za===Ha.a.getTypeName()&&
Rb!==pb.a.jBb&&this.uKe.add(ka.annotationType)}this.MMb(ka,Za)},"AS:UAS");return sc}N$n(ka){if(ka)for(const Za of ka)this.MMb(Za,wa.a.getTypeName()),ka=Za.content,this.bfd.ob(ka.categoryName)?this.bfd.Z(ka.categoryName,Za):this.bfd.add(ka.categoryName,Za);else a.ULS.sendTraceTag(592802119,pc.Di,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}kqk(ka){this.ra.addHandler(pc.kdc,ka)}umh(ka){this.ra.addHandler(pc.vMi,ka)}B9b(ka){return this.iRb.ob(ka)}jqk(ka){this.ra.addHandler(pc.t4d,
ka)}WUn(ka){this.ra.removeHandler(pc.t4d,ka)}mkj(ka){return!pb.a.mf(ka)&&ab.a(ka)&&this.ra.Q7}XAb(ka,Za=!0){if(this.RC.ob(ka.id)){var Cb=this.RC.J(ka.id);this.RC.remove(ka.id);var Rb=null;({value:Rb}=this.$ya.Ec(ka.parentPath,Rb)).returnValue?(Rb.remove(ka.id),pc.JFb(Cb)&&this.aig(Cb)):a.ULS.sendTraceTag(50734169,pc.Di,15,"DeleteAnnotationFromStorage: No annotations in given parent path");Rb=null;({value:Rb}=this.h5.Ec(ka.annotationType,Rb)).returnValue?Rb.remove(ka.id):a.ULS.sendTraceTag(50734170,
pc.Di,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.mkj(ka.annotationType)?this.ra.raiseEvent(pc.kdc,new nb(Cb,oa.a.getTypeName())):this.MMb(ka,oa.a.getTypeName());Za&&this.v$.vAj(Cb,oa.a.getTypeName())}}$kf(ka,Za,Cb=!1){const Rb=new jb.a;var sc;if(!({value:sc}=this.h5.Ec(ka,sc)).returnValue)return Rb;for(const Wc of sc)this.RC.ob(Wc)?(ka=this.RC.J(Wc),(sc=this.VD.ZMd(ka))&&(Za.equals(sc)||Cb&&Za.overlaps(sc))&&Rb.add(ka)):a.ULS.sendTraceTag(577843217,
pc.Di,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",Wc);return Rb}PGd(ka){let Za=null;if(({value:Za}=this.h5.Ec(ka,Za)).returnValue){ka=Za.toArray();for(const Cb of ka){let Rb;({value:Rb}=this.RC.Ec(Cb,Rb)).returnValue&&this.XAb(Rb)}}}fAm(ka){return ia.a.getTypeNameFor(ka)===Ub.a.getTypeName()}xri(ka){var Za,Cb;return(null===(Cb=null===(Za=this.ybb)||void 0===Za?void 0:Za.$7h)||void 0===Cb?void 0:Cb.call(Za))===cc.a.Bmc&&ka&&0===ka.priority?this.ybb.A8c(ka.context.substr(ka.startInContext,
ka.range.length)):!1}UYi(ka,Za){this.pi.he(()=>{a.ULS.o9(pc.Di,100)&&a.ULS.sendTraceTag(41418894,pc.Di,100,"Operation of type {0} with path {1} received",ia.a.getTypeNameFor(ka),ka.parentPath.join("\\"));try{const Cb=new Aa(ka);for(const Rb of Cb.annotations)if(Rb.annotationType===Qa.FlagResultAnnotation.getTypeName()){const sc=Rb.content.results.map(Wc=>{var xd;const oe=null===(xd=Wc.M_)||void 0===xd?void 0:xd.seq;xd=void 0===oe?Rb.id:Rb.id+"_"+oe;return{id:xd,body:Object.assign(Object.assign({},
Wc),{id:xd}),source:"",revId:"",contextId:"",sourceTimestamp:Date.now()}});this.UYi({items:sc,parentPath:ka.parentPath,parentRevId:ka.parentRevId,H_:ka.H_},Za)}else Cb.HZe===Ha.a.getTypeName()&&this.Fmo(Rb)?(y.AFrameworkApplication.ye("g8469255;j5hhe441"),this.KYg&&(this.hXa||(this.hXa=Jb.a.hlf()),this.HWg++,this.hXa.Djh("AnnotationSkippedDueToInvalidContextCount",this.HWg.toString()))):this.Wtf(Rb,Za,Cb.HZe,!0)}catch(Cb){a.ULS.sendTraceTag(41418898,pc.Di,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",
Cb.message,Cb.stack)}},"AS:PO")}Fmo(ka){var Za;y.AFrameworkApplication.ye("01dfc961;05c12706");if(this.x2j&&ab.a(ka.annotationType)){var Cb;let sc=Cb=null;if(this.Hy){Cb=this.Hy.d3;var Rb=null===Cb||void 0===Cb?void 0:Cb.node;Cb=pb.a.M0a(ka.parentPath);if(pb.a.EDb(this.gI.value,Cb)!==Rb)return!1;ka=ka.content;Cb=ka.context.substring(ka.startInContext,ka.startInContext+ka.range.length);sc=null===(Za=null===Rb||void 0===Rb?void 0:Rb.characterData)||void 0===Za?void 0:Za.substring(ka.range.start,ka.range.start+
ka.range.length);this.KYg&&ka&&0===ka.priority&&(Za=0<ka.range.start?Rb.characterData.charAt(ka.range.start-1):null,Rb=ka.range.start+ka.range.length<Rb.characterData.length?Rb.characterData.charAt(ka.range.start+ka.range.length):null,"en-us"==ka.language.toLocaleLowerCase()&&sc&&Cb&&sc===Cb&&(Za&&Za.match("[A-Za-z0-9]")||Rb&&Rb.match("[A-Za-z0-9]"))&&(this.hXa||(this.hXa=Jb.a.hlf()),this.x7g++,this.hXa.Djh("partialWordAnnotationsCount",this.x7g.toString())))}return sc&&Cb&&sc!==Cb?!0:!1}return!1}Wtf(ka,
Za,Cb,Rb){if(this.fAm(ka.content)&&this.xri(ka.content))this.iIa(ka,70);else{var sc=ka.parentPath;Cb!==oa.a.getTypeName()&&Rb||this.$3i(ka);Rb&&Cb===Ha.a.getTypeName()&&ab.a(ka.annotationType)&&ka.content.isHotCritique&&this.L0j?this.jqc.set(ka.id,{annotation:ka,time:Date.now()}):(Rb=ka.annotationType,pb.a.mf(Rb)||Rb!==ca.a.getTypeName()?!pb.a.mf(Rb)&&ab.a(Rb)&&ka.content&&0==ka.content.priority&&zb.a.D3?(ka=pb.a.M0a(sc))&&ka==zb.a.rDl()&&a.ULS.sendTraceTag(539870169,pc.Di,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):
Cb!==oa.a.getTypeName()&&this.mqc.contains(sc)?a.ULS.sendTraceTag(41418897,pc.Di,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",sc,ka.id):this.Rxj(ka,sc,Cb,Za):a.ULS.sendTraceTag(595342670,pc.Di,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",sc))}}aSn(ka){if(ka&&ka.annotationType&&this.VD.C9b(ka.annotationType)){var Za;if(({value:Za}=this.h5.Ec(ka.annotationType,Za)).returnValue&&(ka=this.VD.ZMd(ka)))for(const Cb of Za){let Rb;
({value:Rb}=this.RC.Ec(Cb,Rb)).returnValue&&(Za=this.VD.ZMd(Rb))&&(ka.equals(Za)||ka.overlaps(Za))&&this.XAb(Rb)}}}MMb(ka,Za){this.pi.he(()=>{let Cb=null;if(({value:Cb}=this.o3i.Ec(ka.annotationType,Cb)).returnValue)for(const Rb of Cb)Rb.xD(ka,Za)},"AS:SATH")}HRk(){a.ULS.sendTraceTag(50860999,pc.Di,50,"ClearStorage: Initiated Clearing Storage");this.Loc||(this.Loc=new ra.a(4,2,100,this.IRk,142),this.Gb.Wb(this.Loc))}activateAnnotation(ka,Za){let Cb;if(({value:Cb}=this.Mcd.Ec(ka,Cb)).returnValue){if(Cb.contains(Za))return Promise.resolve(null);
Cb.add(Za)}else{let Rb;this.Mcd.add(ka,(Rb=new jb.a,Rb.add(Za),Rb))}return this.fWe(ka)}fWe(ka){a.ULS.sendTraceTag(41521865,pc.Di,50,"ActivateAnnotation: Activating annotation type {0}.",ka);if(this.iRb.ob(ka))return Promise.resolve(null);var Za=null;if(({value:Za}=this.Sqe.Ec(ka,Za)).returnValue)return Za;this.ojk(ka);Za=null;this.MIa&&(Za=this.MIa());if(Za){const Cb=new ya.a;Cb.annotationType=ka;this.ePj&&(this.$ia.ob(ka)||this.$ia.Z(ka,new Va),Cb.stateUpdateHandler=(Rb,sc)=>{this.$ia.J(ka).oldState=
Rb;this.$ia.J(ka).newState=sc;for(const Wc of this.$ia.J(ka).handlers)Wc(ka,Rb,sc)});Za=Za.activateAnnotation(Cb);this.Sqe.add(ka,Za);return Za.then(Rb=>{this.Sqe.remove(ka);this.iRb.add(ka,Rb.token);this.Sxj(Rb.token,ka);this.ra.raiseEvent(pc.t4d,new bb(ka,!0));this.Tfm(ka);return Rb})}return Promise.reject(Error.create("Error during annotation activation"))}Tfm(ka){const Za=this.VD.Cfi(ka);Za&&this.vKa.G$h(Za,Cb=>{if(this.v$.uSf){var Rb=Hb.ParagraphReader.Wv(pb.a.getRootNode(),!0,!0);if(Rb&&0<Rb.count){let sc=
0;for(const Wc of Rb){Rb=dc.BPd(Wc);if(!Rb)continue;let xd=!1;for(;sc<Cb.length;){if(Rb===Cb[sc]){xd=!0;break}sc++}if(!xd){this.v$.uSf(Za);break}sc++}}}})}ojk(ka){this.v$.GWo(ka,(Za,Cb)=>{0<this.$kf(ka,Cb,!0).count||this.Txj(Za,Ha.a.getTypeName(),!0,Za.parentPath)},(Za,Cb)=>{if(3!==Cb.Av)a.ULS.sendTraceTag(591541786,pc.Di,15,"Annotation moved to unsupported location type: {0}",Cb.Av);else if(Za.Av!==Cb.Av)a.ULS.sendTraceTag(591541787,pc.Di,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",
Za.Av,Cb.Av);else{Za=this.$kf(ka,Za);for(const sc of Za){const Wc=sc.content;Za=pb.a.Qgb(this.gI.value,sc.parentPath);if(!Za){a.ULS.sendTraceTag(591541788,pc.Di,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.zm.X9c(xd=>xd.intent===Wc,Za,0))break;var Rb=Cb.eta;Rb=new Xa.a(0,Rb,Rb+Cb.dta,null,Wc);this.zm.xQa(Za,Rb)}}},Za=>{for(const Cb of this.$kf(ka,Za))this.XAb(Cb,!1)})}releaseAnnotation(ka,Za){let Cb;if(({value:Cb}=this.Mcd.Ec(ka,Cb)).returnValue){Cb.contains(Za)&&
Cb.remove(Za);if(0<Cb.count)return Promise.resolve(!1);this.Mcd.remove(ka)}a.ULS.sendTraceTag(593790408,pc.Di,50,"ReleaseAnnotation: Releasing annotation type {0}.",ka);return this.Tcj(ka)}fen(ka){var Za=null;if(({value:Za}=this.h5.Ec(ka,Za)).returnValue){a.ULS.sendTraceTag(41418899,pc.Di,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",ka);for(const Cb of Za)if(Za=null,({value:Za}=this.RC.Ec(Cb,Za)).returnValue){const Rb=Za.parentPath;let sc=null;({value:sc}=this.$ya.Ec(Rb,
sc)).returnValue&&(sc.remove(Cb),sc.count||this.$ya.remove(Rb));this.RC.remove(Cb);pc.JFb(Za)&&this.aig(Za)}this.h5.remove(ka)}Array.contains(this.Abk,ka)&&this.Tcj(ka)}Tcj(ka){let Za=null,Cb=null;this.MIa&&(Cb=this.MIa());if(Cb){if(({value:Za}=this.iRb.Ec(ka,Za)).returnValue){const Rb=new Oa;Rb.token=Za;this.iRb.remove(ka);this.ra.raiseEvent(pc.t4d,new bb(ka,!1));return Cb.releaseAnnotation(Rb)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}yBi(){this.pi.he(()=>
{if(this.W0j){var ka=pb.a.getRootNode();if(ka){var Za=new ob.a;Ya.e(ka,Cb=>{var Rb=pb.a.eM(Cb),sc=null;if(({value:sc}=this.$ya.Ec(Rb,sc)).returnValue)for(const Wc of sc)Rb=null,({value:Rb}=this.RC.Ec(Wc,Rb)).returnValue&&(Rb.parent=Cb,Rb.hTc=!0,Rb.fKb=2,Za.ob(Rb.annotationType)||Za.Z(Rb.annotationType,new jb.a),Za.J(Rb.annotationType).add(Wc),sc=null,({value:sc}=this.h5.Ec(Rb.annotationType,sc)).returnValue&&sc.remove(Rb.id));return!0},12);for(const Cb of this.h5.keys)if(ka=null,({value:ka}=this.h5.Ec(Cb,
ka)).returnValue)for(const Rb of ka)if(ka=null,({value:ka}=this.RC.Ec(Rb,ka)).returnValue){let sc=null;ka.parentPath===pb.a.jBb?(ka.fKb=1,ka.parent=null):({value:sc}=this.RC.Ec(ka.parentPath,sc)).returnValue?(ka.fKb=3,ka.parent=sc):(ka.fKb=0,ka.parent=null,a.ULS.sendTraceTag(41554060,pc.Di,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",ka.id));ka.hTc=!0;Za.ob(ka.annotationType)||Za.Z(ka.annotationType,new jb.a);Za.J(ka.annotationType).add(Rb)}else a.ULS.sendTraceTag(41997840,
pc.Di,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",Rb);else a.ULS.sendTraceTag(41997841,pc.Di,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",Cb);this.h5=Za;this.uKe.clear()}else a.ULS.sendTraceTag(41554058,pc.Di,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,pc.Di,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}xvk(ka){this.UYi(ka,!0)}don(ka,
Za){this.pi.he(()=>{const Cb=Za?Za+String.format("\\{0}",ka.id):pb.a.eM(ka);a.ULS.sendTraceTag(41418900,pc.Di,50,"OnTileDeleted: Tile delete event received for tile {0}.",Cb);this.mqc.contains(Cb)||this.mqc.add(Cb);var Rb=null;if(({value:Rb}=this.$ya.Ec(Cb,Rb)).returnValue){a.ULS.sendTraceTag(41418901,pc.Di,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",Rb.count,Cb);for(const sc of Rb)Rb=null,({value:Rb}=this.RC.Ec(sc,Rb)).returnValue&&(this.MMb(Rb,oa.a.getTypeName()),this.ra.Q7&&
this.ra.raiseEvent(pc.kdc,new nb(Rb,oa.a.getTypeName())),this.RC.remove(sc));this.$ya.remove(Cb)}},"AS:OTD")}con(ka){ka=pb.a.eM(ka);this.mqc.remove(ka)&&a.ULS.sendTraceTag(41418902,pc.Di,50,"OnTileAdded: Deleted tile {0} was re-added.",ka)}sQo(ka){if(ka){a.ULS.sendTraceTag(50436131,pc.Di,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",ka.count);var Za=new ob.a;for(var Cb of ka)ka=null,({value:ka}=Za.Ec(Cb.parentPath,ka)).returnValue||(ka=new ob.a,Za.add(Cb.parentPath,ka)),ka.Z(Cb.id,
Cb);for(const Rb of Za){Za=pb.a.Qgb(this.gI.value,Rb.key);if(!Za){a.ULS.sendTraceTag(50436160,pc.Di,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}Cb=new Sa.a([0]);for(let sc=0,Wc=Za.qa.length;sc<Wc;sc++)ka=Za.qa.J(sc),ka.Gj&&Cb.FTa(ka.Gj,void 0,(xd,oe)=>{if(oe){var Nd=null,$e=oe.intent;$e&&({value:Nd}=Rb.value.Ec($e.id,Nd)).returnValue&&($e=new pa.a,$e.start=oe.Kb.cp,$e.length=xd.Kb.cp-$e.start,Nd.content.range=$e,Nd.Fwa=!1)}})}}else a.ULS.sendTraceTag(50436130,pc.Di,
10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(ka){a.ULS.sendTraceTag(593049729,pc.Di,50,"GetAnnotationsByType: Method called for type {0}.",ka);return this.fWe(ka).then(()=>{const Za=new jb.a;this.pi.he(()=>{if(pb.a.mf(ka)||ka!==ca.a.getTypeName()){this.uKe.contains(ka)&&this.yBi();var Cb=null;if(({value:Cb}=this.h5.Ec(ka,Cb)).returnValue){a.ULS.sendTraceTag(41418903,pc.Di,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",ka);var Rb=new jb.a;for(const sc of Cb)Cb=
null,({value:Cb}=this.RC.Ec(sc,Cb)).returnValue&&(Cb.Fwa&&Rb.add(Cb),Za.add(Cb));Rb&&0<Rb.count&&pc.JFb(Rb.J(0))&&this.sQo(Rb)}}else for(Rb of this.bfd.values)Za.add(Rb);Za.count||a.ULS.sendTraceTag(41418904,pc.Di,50,"GetAnnotationsByType: No annotations found for type {0}!",ka)},"AS:GABT");return Za},Za=>{a.ULS.sendTraceTag(41418905,pc.Di,10,"Exception occurred while fetching annotations of type {0}: {1}",ka,Za);return null})}Sua(ka){let Za=null;return({value:Za}=this.RC.Ec(ka,Za)).returnValue?Za:
null}c0h(ka){let Za=null;if(this.$ya.ob(ka))for(const Cb of this.$ya.J(ka))if(ka=this.Sua(Cb))Za||(Za=new jb.a),Za.add(ka);return Za}QHb(ka){return(ka=this.Sua(ka))?(ka.hTc||this.yBi(),ka):null}iIa(ka,Za){this.mgo(ka,Za);this.jjg(ka,Za);this.MMb(ka,wa.a.getTypeName())}BLo(ka,Za){this.pPo(ka,Za);this.ydo(ka,pb.a.WEl(ka));this.MMb(ka,wa.a.getTypeName())}CLo(ka,Za){ka=this.VD.O_h(ka);for(const Cb of ka)this.cI.Xig(this.gI.value,Cb,Za)}mgo(ka,Za){let Cb=null;this.MIa&&(Cb=this.MIa());Cb&&(ka=this.YEl(ka,
Za))&&Cb.setAnnotationState(ka)}jjg(ka,Za,Cb=!0){if(ka&&pc.pqi(ka)){var Rb=this.Sua(ka.id);!ka.content||Rb&&ka.content===Rb.content||pb.a.setAnnotationState(ka,Za);Rb&&Rb.content&&pb.a.setAnnotationState(Rb,Za);Cb&&this.ra.Q7&&(70===Za||60===Za)&&this.ra.raiseEvent(pc.vMi,new Mb(ka,Za))}}YEl(ka,Za){let Cb=null;ka&&(Cb=Object.assign(new Ca,{id:ka.id,value:Za}),pb.a.mf(ka.parentPath)||(Cb.parentPath=ka.parentPath.split("\\")));return Cb}ydo(ka,Za){const Cb=this.MIa?this.MIa():null;Cb&&(ka=this.VEl(ka,
Za))&&Cb.setAnnotationMetadata(ka)}pPo(ka,Za){if(ka&&pc.pqi(ka)){var Cb=this.Sua(ka.id);!ka.content||Cb&&ka.content==Cb.content||pb.a.Cdj(ka,Za);Cb&&Cb.content&&pb.a.Cdj(Cb,Za)}}VEl(ka,Za){if(!ka)return null;const Cb=new fa;Cb.id=ka.id;Cb.value=Za;pb.a.mf(ka.parentPath)||(Cb.parentPath=ka.parentPath.split("\\"));return Cb}Ujo(ka,Za,Cb,Rb){const sc=ka.content;if(this.VD.Yib(ka)&&sc){const Wc=sc.range.start+sc.range.length;if(0<Rb&&Wc<=Cb||0>Rb&&Wc<=Cb+Rb)return!1;if(0<Rb&&sc.range.start>=Za||0>Rb&&
sc.range.start>=Cb)return sc.range.start+=Rb,!1}return!this.jd.isFeatureEnabled(60)&&sc&&sc.M_?(ka=this.VD.pjb(ka,60),!(60===sc.M_.state&&ka)):!0}Ijh(ka,Za){this.$ia.ob(Za)||this.$ia.Z(Za,new Va);this.$ia.J(Za).handlers.add(ka);ka(Za,this.$ia.J(Za).oldState,this.$ia.J(Za).newState)}I3i(ka,Za){this.$ia.ob(Za)&&this.$ia.J(Za).handlers.contains(ka)&&this.$ia.J(Za).handlers.remove(ka)}static pqi(ka){ka=ia.a.getBaseTypesFor(ka.content);return Array.contains(ka,Da.a.getTypeName())}static JFb(ka){if(void 0===
ka.content||null===ka.content||""===pb.a.M0a(ka.parentPath))return!1;const Za=ia.a.getBaseTypesFor(ka.content);return Array.contains(Za,Ma.a.getTypeName())&&ka.annotationType!==Pa.RoleDetectionAnnotation.getTypeName()}ALo(ka){ka?(this.Uqe.AugLoop_Text_Critique=ka,ka=this.B9b("AugLoop_Text_Critique")?this.iRb.J("AugLoop_Text_Critique"):null,this.Sxj(ka,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,pc.Di,50,"Annotation configuration could not be updated for annotation type: {0}.","AugLoop_Text_Critique")}Sxj(ka,
Za){if(ka&&this.Uqe[Za]){const Cb=new jc;Cb.token=ka;Cb.config=this.Uqe[Za];this.MIa&&(this.MIa().updateAnnotationConfig(Cb),a.ULS.sendTraceTag(540615553,pc.Di,50,"Annotation configuration has been updated for annotation type: {0}.",Za))}}$3i(ka){let Za=null;({value:Za}=this.RC.Ec(ka.id,Za)).returnValue&&(ka.annotationType=Za.annotationType);this.jqc.has(ka.id)&&this.jqc.delete(ka.id)}Rxj(ka,Za,Cb,Rb){this.aSn(ka);this.Txj(ka,Cb,Rb,Za)&&this.v$.vAj(ka,Cb)}NRa(ka){const Za=ka.parentPath,Cb=oa.a.getTypeName();
this.$3i(ka);this.iIa(ka,70);this.mqc.contains(Za)||this.Rxj(ka,Za,Cb,!0)}rVl(ka){const Za=new jb.a;ka=this.h5.Ec(ka).value;if(null===ka)return Za;for(const Cb of ka)ka=this.RC.Ec(Cb).value,null!==ka&&Za.push(ka);return Za}Vfm(){Object(sa.__awaiter)(this,void 0,void 0,function*(){yield Object(Wb.b)();this.U3i()})}U3i(){const ka=this.rVl(Ub.a.getTypeName());for(const Za of ka)this.xri(Za.content)&&this.NRa(Za)}}pc.Di=389;pc.kdc="OnAnnotationOperation";pc.vMi="OnAnnotationLocalStateChange";pc.t4d="OnAnnotationActivationChange";
pc.m6j=20;Object(e.a)(pc,"AnnotationStorage",null,[607]);class rc{constructor(){this.vde=null;this.z6c=!1}}Object(e.a)(rc,"AugmentationLoopStateManager",null,[605]);var db=c(187),lb=c(583),qa=c(82),Ga=c(94),Fb=c(604),$b=c(247);class rb extends $b.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=
!1}Cl(){return 102}static construct(ka,Za,Cb,Rb,sc,Wc){const xd=new rb;xd.ExpectedEndRevisionId=ka;xd.OriginString=Za;xd.Authorization=Cb;xd.AugLoopSeedUrl=Rb;xd.FileId=sc;xd.SeedBatchesInParallelIsEnabled=Wc;xd.AddDocumentKindTypeToPathIsEnabled=!0;xd.CheckOnDemandNodeVersionEnabled=!0;xd.AddSubDocumentKindTypeToPathIsEnabled=!0;return xd}}Object(e.a)(rb,"FullFileAugLoopSeedingRequest",$b.a,[]);class xb{constructor(){this.authToken=this.url=this.TSi=null}}Object(e.a)(xb,"ReseedingTaskInfo",null,
[]);class gb{constructor(ka,Za,Cb,Rb,sc,Wc){this.Q9=null;this.RSg=!1;this.QSb=null;this.NNe=0;this.E0c=(xd,oe)=>{xd=oe.daa;this.QSb&&Ga.AT(xd,Nd=>Nd===this.QSb)&&(oe.httpStatusCode!==db.a.oz||oe.CH||2!==oe.rWf?oe.httpStatusCode!==db.a.oz||oe.CH||1!==oe.rWf?this.r9i(()=>{a.ULS.sendTraceTag(50861003,gb.Di,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",oe.httpStatusCode,
oe.CH,oe.rWf,oe.ou)}):(this.pN.z6c=!1,this.Q9.QLb(this.E0c),this.Ze.HRk(),a.ULS.sendTraceTag(50861002,gb.Di,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),xd=Object(qa.a)(xb,this.QSb),this.u_i(oe.C1n,xd.TSi,xd.url,xd.authToken)):this.r9i(()=>{a.ULS.sendTraceTag(50861001,gb.Di,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.Btl=xd=>{if(void 0===xd||null===xd||void 0===xd.data||null===xd.data||void 0===xd.data.we||null===xd.data.we)a.ULS.sendTraceTag(41445393,
gb.Di,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(xd.data.Ve!==db.a.oz)a.ULS.sendTraceTag(41445394,gb.Di,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",xd.data.Ve);else try{let oe;({group:oe}=lb.a.H0(xd.data.we)).returnValue?oe.Responses&&oe.Responses.length?(xd=null,oe&&oe.Responses&&oe.Responses.length&&(xd=oe.Responses[0])?(this.S1.ATa(xd),xd.StatusCode?a.ULS.sendTraceTag(41445398,gb.Di,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",
xd.StatusCode):a.ULS.sendTraceTag(41445399,gb.Di,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",xd.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,gb.Di,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):a.ULS.sendTraceTag(41445396,gb.Di,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):
a.ULS.sendTraceTag(41445395,gb.Di,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(oe){a.ULS.sendTraceTag(41445400,gb.Di,10,"FileSeedingSuccessCallback: {0}",oe.message)}};this.Atl=xd=>{void 0===xd||null===xd||void 0===xd.data||null===xd.data||void 0===xd.data.we||null===xd.data.we?a.ULS.sendTraceTag(41445401,gb.Di,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):a.ULS.sendTraceTag(41445402,gb.Di,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",
xd.data.Ve)};this.$Pj=ka.$("AugLoopServerSideSeedingIsEnabled");this.YPj=ka.$("AugLoopReseedingIsEnabled");this.ZPj=ka.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.H2g=ka.pc("MaxReseedingRetries",1);this.Of=Za;this.bjd=Cb;this.pN=Rb;this.S1=sc;this.Ze=Wc;V.App.ya&&V.App.ya.jb&&V.App.ya.jb.Wc&&V.App.ya.jb.Wc.contentReplicator&&(this.Q9=V.App.ya.jb.Wc.contentReplicator)}psm(ka,Za,Cb){if(this.$Pj){var Rb=this.pN.vde;Rb&&Rb.trim().length?this.RSg?this.YPj&&(a.ULS.sendTraceTag(50861E3,gb.Di,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),
this.NNe=0,this.Q9?(this.pN.z6c=!0,this.Q9.r_b(this.E0c),this.QSb=Object.assign(new xb,{TSi:ka,url:Za,authToken:Cb}),this.Q9.DE(null,null,this.QSb)):a.ULS.sendTraceTag(592814793,gb.Di,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,gb.Di,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.u_i(Rb,ka,Za,Cb),this.RSg=!0):a.ULS.sendTraceTag(41445391,gb.Di,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,
gb.Di,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}r9i(ka){this.NNe<this.H2g?(a.ULS.sendTraceTag(594384E3,gb.Di,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",++this.NNe,this.H2g),this.Q9.DE(null,null,this.QSb)):(this.pN.z6c=!1,this.Q9.QLb(this.E0c),ka())}u_i(ka,Za,Cb,Rb){const sc=rb.construct(ka,Za,Rb,Cb,y.AFrameworkApplication.rootQuerySignature,this.ZPj);
a.ULS.sendTraceTag(595178454,gb.Di,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.bjd.oFb.execute(()=>{this.Unk(sc)})}Unk(ka){a.ULS.sendTraceTag(595178453,gb.Di,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");this.Of.oj(V.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,Fb.b(ka),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.Btl,this.Atl,ka);a.ULS.sendTraceTag(42016906,
gb.Di,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}gb.Di=389;Object(e.a)(gb,"FullFileAugLoopSeedingService",null,[]);class Gb{constructor(){}}Object(e.a)(Gb,"RuntimeManagerInitializationTracker",null,[]);var ac=c(945);class hc{getAugLoopRuntimeManager(){return ac.a.getAugLoopRuntimeManager()}}Object(e.a)(hc,"AlFactoryWrapper",null,[604]);class Ec{Bl(){return pb.a.Bl()}}Object(e.a)(Ec,"UtilsWrapper",null,[459]);var Uc=c(600),dd=c(59),fd=c(17),xc=c(43),$c=c(108),Bc=c(1992),
Vd=c(5),Je=c(111),Gf=c(225),Nc=c(31),md=c(379),Oe=c(433),fg=c(102),If=c(55);class tf{constructor(ka,Za,Cb,Rb,sc){this.Na=ka;this.If=Cb;this.Po=Rb;this.ve=sc;this.Bna=this.Na.$("WordDesignerCaptionDetectionEnabled")}Abo(ka,Za){ka.listType=this.jVl(Za);ka.outlineLevel=Hb.ParagraphReader.Sma(Za);ka.indentation=tf.Dof(this.Po.zT(Za));ka.alignment=tf.Nkf(Hb.ParagraphReader.Uv(Za));ka.isInsideTable=this.isInsideTable(Za);ka.isInsideTOC=Za.jr;ka.rightIndentation=tf.Dof(this.Po.H0a(Za));var Cb=this.Po.y7b(Za);
ka.specialIndentType=tf.a6l(Cb);ka.specialIndentBy=tf.Dof(Cb);ka.listType!==Bc.e.NoList&&this.gdo(Za,ka);this.ggo(Za,ka);Cb=[];this.Bna&&(Cb=this.XAn(Za));ka.formattedRanges=this.kQl(Za,Cb);this.Bna&&null!=Cb&&(ka.objectReferences=0<Cb.length?Cb:void 0)}kQl(ka,Za){var Cb=ka.qa?ka.qa.length:0,Rb=Je.FormattingReader.Ar(Nc.a.create(ka));let sc=fg.a.OF,Wc=0,xd=fg.a.XL/2;Rb&&(xd=Je.FormattingReader.Mn(Rb,fd.a.fontSize,fg.a.XL)/2,sc=Je.FormattingReader.Mn(Rb,fd.a.font,fg.a.OF),Wc=Je.FormattingReader.language(Rb));
Rb="Normal";var oe=this.ve.Uo(ka);oe&&(Rb=oe.getValue(xc.a.ja)||"Normal",oe.hasProperty(fd.a.font)&&(sc=oe.getValue(fd.a.font)));if(Cb){--Cb;oe=[];let zh=null,zi=void 0,Ti=null;this.Bna&&ka.hasProperty(fd.a.En)&&(Ti=ka.getValue(fd.a.En));const Il=ka.properties.ia(Ba.a.kfa,null);for(let mi=0;mi<Cb;mi++){var Nd=ka.qa.J(mi),$e=ka.Mc,hf=null;this.Bna&&(hf=tf.ysf(ka,Ti,mi));Nd.uf&&(zh=tf.XMo($e,Nd.uf,zh));Nd.hyperlink&&Nd.hyperlink.url?zi=Nd.hyperlink.url:Nd.Km&&(zi=void 0);var bg=ka.qa.J(mi+1).cp-1;$e=
Nd.cp;bg=bg-Nd.cp+1;let pm=!1,po=!1,$m=!1,pn=xd,pp=0,Vo=0,Xn=Rb,Lj=void 0,Mn=Wc,qp=sc,Hk;if(Nd.formatting){var Dg=Nd.formatting;pm=Je.FormattingReader.Mn(Dg,fd.a.bold,!1);po=Je.FormattingReader.Mn(Dg,fd.a.italic,!1);$m=Je.FormattingReader.Mn(Dg,fd.a.underline,!1);pn=Je.FormattingReader.Mn(Dg,fd.a.fontSize,2*xd)/2;pp=Je.FormattingReader.Mn(Dg,xc.a.capitalization,0);Vo=Je.FormattingReader.Mn(Dg,fd.a.fontColor,0);Mn=Je.FormattingReader.language(Dg)||Wc;qp=Je.FormattingReader.Mn(Dg,fd.a.font,sc);Xn=Rb;
var Zh=Dg.sn;Zh&&(Zh=Zh.ia(xc.a.Qv,null))&&!Zh.equals(ma.a.nil)&&Dg.paragraph.Mc&&(Dg=Dg.paragraph.Mc.Db(Zh))&&(Xn=(new Gf.a(Dg)).getValue(xc.a.ja))}this.Bna&&(Hk=this.$pf(hf),null!=Hk&&this.Klh(Za,hf,Hk,oe.length,Bc.b.Inline));zh&&(Lj=0<zh.count);Nd={isDeleted:this.GAm(Il,Nd,mi,zi),fontFamily:qp,fontWeight:pm?Bc.d.Bold:Bc.d.Normal,fontSize:pn,italic:po,underline:$m?Bc.h.SingleLine:Bc.h.None,capitalization:tf.xFh(pp),color:Vo,styleName:Xn,isFollowUp:Lj,languageId:tf.nFh(Mn),start:$e,length:bg,link:zi,
isReference:tf.isReference(Nd)?!0:void 0,objectType:null!==Hk&&void 0!==Hk?Hk:void 0};hf=0<oe.length?oe[oe.length-1]:void 0;tf.LLk(hf,Nd)?hf.length+=Nd.length:oe.push(Nd)}return oe}return[{fontFamily:sc,fontWeight:Bc.d.Normal,fontSize:xd,italic:!1,underline:Bc.h.None,capitalization:tf.xFh(0),color:0,styleName:Rb,isFollowUp:void 0,languageId:tf.nFh(Wc),start:0,length:ka.characterData.length}]}GAm(ka,Za,Cb,Rb){if(this.jB()){if(Za.blob||Za.formatting&&Za.formatting.cache&&Za.formatting.cache.tGb||Rb)return!0;
if(ka&&Cb<ka.length)return ka[Cb]}return If.a.Oj&&Za.KQ?!0:Za.gi?!0:!1}jB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static LLk(ka,Za){return!!ka&&!!Za&&ka.start+ka.length===Za.start&&ka.isDeleted===Za.isDeleted&&ka.fontFamily===Za.fontFamily&&ka.fontWeight===Za.fontWeight&&ka.fontSize===Za.fontSize&&ka.italic===Za.italic&&ka.underline===Za.underline&&ka.capitalization===Za.capitalization&&ka.color===
Za.color&&ka.highlightColor===Za.highlightColor&&ka.styleName===Za.styleName&&void 0===ka.link&&void 0===Za.link&&ka.languageId===Za.languageId&&!ka.isReference&&!Za.isReference&&!ka.isFollowUp&&!Za.isFollowUp&&void 0===ka.objectType&&void 0===Za.objectType}jVl(ka){const Za=new Vd.GraphIterator;Za.set(ka);Za.Ab(11);Za.fd(11);return(ka=this.If.Fw(Za))?tf.Q_k(ka.listType):Bc.e.NoList}gdo(ka,Za){var Cb=this.If.pC(ka);Cb&&(Cb.hasProperty(Ba.a.listID)&&(Za.listId=Cb.getValue(Ba.a.listID).toString()),Cb=
this.N7h(ka,fd.a.font),ka=this.N7h(ka,fd.a.fontSize),Cb&&(Za.bulletAndNumberFontFamily=Cb),ka&&(Za.bulletAndNumberFontSize=ka))}isInsideTable(ka){const Za=new Vd.GraphIterator;Za.set(ka);return Za.Ab(14)}ggo(ka,Za){Za.spacingBeforeParagraph=this.Bci(ka,Ba.a.Zba,Ba.a.Poa,Ba.a.rj);Za.spacingAfterParagraph=this.Bci(ka,Ba.a.Yba,Ba.a.Ooa,Ba.a.sa);Za.lineSpacing=this.zDb(ka)}Bci(ka,Za,Cb,Rb){if(Hb.ParagraphReader.Mn(ka,Za,!1))return 0;Za=Hb.ParagraphReader.Mn(ka,Cb,-1);if(0<=Za)return Za*md.a.$Jb/100;ka=
Hb.ParagraphReader.Mn(ka,Rb,-1);return 0<=ka?ka/20:0}N7h(ka,Za){ka=this.rNl(ka);if(null!=ka&&null!=ka.cache)return ka.cache.getValue(Za)}rNl(ka){var Za;ka=null===(Za=ka.qa)||void 0===Za?void 0:Za.last;return null!=ka&&ka.Rh?ka.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),null)}zDb(ka){const Za=Hb.ParagraphReader.Mn(ka,Ba.a.va,md.a.va);ka=Hb.ParagraphReader.Mn(ka,Ba.a.ua,md.a.lineSpacing);switch(Za){case 0:return ka/240;case 1:return ka/
20;default:return 0}}static XMo(ka,Za,Cb){for(let Rb=0;Rb<Za.length;Rb++){const sc=Za.J(Rb),Wc=sc.Tj,xd=ka.Db(Wc);xd&&xd.ia(Ba.a.jG,!1)&&(Cb||(Cb=new Ta.a(new Oe.a)),sc.Oc?Cb.add(Wc):Cb.remove(Wc))}return Cb}static nFh(ka){return(ka=Uc.a.lg(ka))&&ka.name?ka.name.toLowerCase():void 0}static Dof(ka){return ka?2===ka.unit?Math.floor(dd.a.uzb(ka.value)/20):Math.floor(ka.value/20):0}static a6l(ka){if(!ka)return Bc.g.Initial;switch(ka.specialIndentType){case 1:return Bc.g.FirstLine;case 2:return Bc.g.Hanging;
default:return Bc.g.Initial}}static xFh(ka){switch(ka){case 2:return Bc.c.AllCaps;case 1:return Bc.c.SmallCaps;default:return Bc.c.NoCaps}}static Nkf(ka){switch(ka){case 1:return Bc.a.Left;case 3:return Bc.a.Right;case 2:return Bc.a.Center;case 6:return Bc.a.Justified;case 0:return Bc.a.None;default:return Bc.a.Other}}static Q_k(ka){switch(ka){case 15:return Bc.e.Any;case 1:return Bc.e.Bullet;case 42:return Bc.e.Invalid;case 13:return Bc.e.Lim;case 14:return Bc.e.Nil;case 16:return Bc.e.NoList;case 0:return Bc.e.Numbered;
default:return Bc.e.Invalid}}static isReference(ka){return ka.blob&&(7===ka.blob.zh||10===ka.blob.zh)||ka.Ah&&0<ka.Ah.length||ka.uf&&0<ka.uf.length||ka.Jb&&0<ka.Jb.length?!0:!1}static ysf(ka,Za,Cb){return null==Za?null:Za[Cb]&&!Za[Cb].equals(ma.a.nil)&&ka.Mc?ka.Mc.Db(Za[Cb]):null}$pf(ka){if(null==ka)return null;if(ka.hasProperty(Ba.a.Rs)){var Za=ka.getValue(Ba.a.Rs);if(tf.lWi.has(Za))return tf.lWi.get(Za)}if(ka.hasProperty(Ba.a.v5b)&&null!=ka.getValue(Ba.a.v5b))return Bc.f.FootnoteEndnote;if(ka.hasProperty(Ba.a.pageBreak)&&
ka.getValue(Ba.a.pageBreak))return Bc.f.PageBreak;if(ka.hasProperty(Ba.a.$Gb)&&ka.getValue(Ba.a.$Gb))return Bc.f.Tab;Za=!1;ka.hasProperty($c.a.v3)?Za=ka.getValue($c.a.v3):ka.hasProperty(Ba.a.wga)&&(Za=ka.getValue(Ba.a.wga));return Za&&ka.hasProperty(Ba.a.imageType)&&1==ka.getValue(Ba.a.imageType)?Bc.f.Image:null}static tDm(ka){return ka.hasProperty(Ba.a.l8b)&&0<=ka.getValue(Ba.a.l8b)?!0:!1}Mxi(ka){return tf.Axo.has(ka)}zIh(ka,Za,Cb,Rb){return null==ka||null==Za?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),
null):Rb===Bc.b.Inline&&null==Cb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):Rb===Bc.b.Floating&&null!=Cb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>Cb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):tf.tDm(ka)?null:this.Mxi(Za)?{referencedPath:["session",
"doc","main",ka.id.toString()],formattedRangeIndex:Cb,anchorMode:null!==Rb&&void 0!==Rb?Rb:Bc.b.Unspecified,anchoredObjectType:Rb==Bc.b.Floating?Za:void 0}:null}Klh(ka,Za,Cb,Rb,sc){Za=this.zIh(Za,Cb,Rb,sc);null!=Za&&null!=ka&&ka.push(Za)}XAn(ka){const Za=[];if(null==ka)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),Za;let Cb=null;ka.hasProperty(Ba.a.G6)&&(Cb=ka.getValue(Ba.a.G6));if(null!=Cb)for(let Rb=0;Rb<Cb.length;++Rb){const sc=tf.ysf(ka,
Cb,Rb),Wc=this.$pf(sc);null!=Wc&&this.Klh(Za,sc,Wc,null,Bc.b.Floating)}return Za}rEh(ka){if(null==ka||!ka.hasProperty(fd.a.En))return!1;const Za=ka.getValue(fd.a.En);for(let Rb=0;Rb<Za.length;Rb++){var Cb=tf.ysf(ka,Za,Rb);Cb=this.$pf(Cb);if(this.Mxi(Cb))return!0}return!1}}tf.lWi=new Map([[5,Bc.f.Image],[11,Bc.f.TextBox],[7,Bc.f.Chart],[6,Bc.f.SmartArt],[10,Bc.f.Drawing],[2,Bc.f.EquationObject],[4,Bc.f.Ink],[19,Bc.f.PageBreak],[23,Bc.f.FootnoteEndnote],[24,Bc.f.FootnoteEndnote],[35,Bc.f.FootnoteEndnoteReferenceMark],
[36,Bc.f.FootnoteEndnoteReferenceMark],[0,Bc.f.Other]]);tf.Axo=new Set([Bc.f.Image,Bc.f.TextBox,Bc.f.Chart,Bc.f.SmartArt,Bc.f.Drawing,Bc.f.Ink]);Object(e.a)(tf,"FormattingExtractor",null,[458]);var vf=c(1066);class $f extends Sys.EventArgs{constructor(ka){super();this.g8b=ka}}Object(e.a)($f,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class vg extends Sys.EventArgs{constructor(ka){super();this.e8=ka}}Object(e.a)(vg,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class Kf{constructor(ka,Za,Cb){this.lYc=
ka;this.graphNode=Za;this.fullPath=Cb}}Object(e.a)(Kf,"NodeEvent",null,[486]);class Ph{constructor(){this.RCe=this.DAe=!1;this.Otb=null;this.ra=new ta.a;this.m$=new M.a(0);this.f$a=new vf.a(eb.a.Xh());this.Cub=new vf.a(eb.a.Xh());this.Ynd=[]}imh(ka){this.ra.addHandler("IsCollectingNodeEventsChangedKey",ka)}oRk(){this.m$=new M.a(0);this.g8b=!1}get g8b(){return this.DAe}set g8b(ka){this.DAe!==ka&&(this.DAe=ka,this.ra.raiseEvent("HasNodeEventsChangedKey",new $f(ka),this))}get e8(){return this.RCe}set e8(ka){this.RCe!==
ka&&(this.RCe=ka,this.ra.raiseEvent("IsCollectingNodeEventsChangedKey",new vg(ka),this))}CMb(ka,Za){this.f$a.ob(ka)||this.f$a.Z(ka,Za)}b4n(ka,Za){this.Cub.Z(ka,Za)}PEl(ka){let Za=null;this.Cub.ob(ka)&&(Za=this.Cub.J(ka),this.Cub.remove(ka));return Za}Iae(ka,Za){if(ka)if(this.e8){var Cb=3!==Za&&4!==Za&&5!==Za||!this.f$a.ob(String.format("{0}",ka.id))?pb.a.eM(ka):this.f$a.J(String.format("{0}",ka.id));if(({value:Rb}=this.m$.Ec(Cb)).returnValue)if(Rb||3!==Za)if(5===Rb&&3===Za){if(ka=Cb.split("\\").pop(),
this.Cub.ob(ka)){var Rb=this.Cub.J(ka);Rb===Cb?(this.DIf(Cb,Za),this.m$.add(Cb,Za)):(this.Cub.Z(ka,Cb),this.f$a.Z(ka,Rb),this.EEi(Cb),this.m$.remove(Cb),this.DIf(Cb,Za),this.m$.add(Rb,5))}}else Rb&&(4!==Rb||0!==Za&&3!==Za&&5!==Za)&&(this.DIf(Cb,Za),this.m$.add(Cb,Za));else this.EEi(Cb),this.m$.remove(Cb);else this.X1m(Cb,Za),this.Ynd.push(ka),this.m$.add(Cb,Za);this.g8b=0<this.m$.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,
389,15,"node is null.")}X1m(ka,Za){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",ka,Za)}DIf(ka,Za){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",ka,Za)}EEi(ka){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",ka)}lYk(){let ka=null;var Za=!1;let Cb=null;for(;this.Ynd.length&&!Za;){Cb=Array.dequeue(this.Ynd);if(!Cb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),
null;this.f$a.ob(String.format("{0}",Cb.id))?(ka=this.f$a.J(String.format("{0}",Cb.id)),this.f$a.remove(String.format("{0}",Cb.id)),this.Ynd.push(Cb)):ka=pb.a.eM(Cb);Za=this.m$.ob(ka)}if(!Za)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.oRk(),null;Za=this.m$.J(ka);this.m$.remove(ka);this.g8b=0<this.m$.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",ka,Za);return new Kf(Za,Cb,ka)}wLn(ka){this.Otb=ka}mYk(){if(!this.Otb)return null;
for(var ka=0;ka<this.Otb.length;ka++){var Za=this.Otb.J(ka);Za=pb.a.eM(Za.node);if(this.m$.ob(Za))return null}ka=this.Otb;this.Otb=null;return ka}FRk(){this.Otb=null}uuo(){this.e8=!0}UBm(ka){return this.m$.ob(ka.id.toString())}}Object(e.a)(Ph,"NodeEventsCollection",null,[455]);var ff=c(1468),yc=c(1395),Rd=c(310),de=c(125);class Sb extends yc.a{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe,Nd,$e,hf){super();this.sjd=new ff.a;this.R9a=!1;this.Zqc=null;this.iha=(bg,Dg)=>{(bg=Dg.node)&&this.W5a(bg)&&(a.ULS.sendTraceTag(40253400,
389,100,"New paragraph Connect event."),pb.a.Elo(bg,this.dka.e8,this.uRb,this.pbk)&&(this.dka.Iae(bg,0),this.Wyj(bg)));this.dka.e8&&this.v$.ilb(bg)};this.EMi=(bg,Dg)=>{bg=Dg.node;this.dka.CMb(String.format("{0}",bg.id),pb.a.eM(bg))};this.HJb=(bg,Dg)=>{(bg=Dg.node)&&this.W5a(bg)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.dka.e8&&this.dka.Iae(bg,3));this.dka.e8&&this.v$.FPi(bg,3)};this.W3=(bg,Dg)=>{bg=Dg.node;Dg=Dg.property;bg&&this.vPj.has(Dg)&&this.W5a(bg)&&(a.ULS.sendTraceTag(40253402,
389,100,"New paragraph Modified event."),this.dka.e8&&(this.dka.Iae(bg,2),Dg===Ba.a.sj&&this.Wyj(bg)));this.dka.e8&&Dg===Ba.a.Lc&&this.v$.FPi(bg,2)};this.FMi=(bg,Dg)=>{(bg=Dg.node)&&Hb.ParagraphReader.Yb(bg)&&!this.Cqc.has(bg)&&!this.Rxe.has(bg)&&(this.Cqc.add(bg),this.eY())};this.HPi=(bg,Dg)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(bg=Dg.node)&&this.Ze.nen(bg)};this.xOf=()=>{this.B6c()?this.zU():this.R9a&&!this.dka.e8&&this.wTa()};this.VB=Za;this.dka=Cb;this.pbk=de.b(Rb.vde);
this.uRb=ka.$("AugLoopOperationsAreEnabled");this.Ze=sc;this.v$=Wc;this.VD=xd;this.Gb=oe;this.zm=Nd;this.cI=$e;this.Cqc=new Set;this.Rxe=new Set;hf.Cpa(this,7);this.vPj=new Set([fd.a.yo,fd.a.bold,fd.a.italic,fd.a.underline,fd.a.font,fd.a.fontSize,fd.a.fontColor,xc.a.capitalization,fd.a.Sh,fd.a.En,Ba.a.Zba,Ba.a.Poa,Ba.a.rj,Ba.a.Yba,Ba.a.Ooa,Ba.a.sa,Ba.a.va,Ba.a.ua,Ba.a.listID,Ba.a.yM,Ba.a.ee,Ba.a.tha,Ba.a.Cv,Ba.a.sj])}get index(){return 7}get xZc(){return this.Zqc}set xZc(ka){this.Zqc=ka;this.v$.uSf=
ka?()=>{this.Zqc()}:null}init(){this.B6c()&&this.zU();this.dka.imh(this.xOf)}zU(){this.VB?(this.R9a=!0,this.VB.ku(this.iha),this.VB.vW(this.EMi),this.VB.Lv(this.HJb),this.VB.Ro(this.W3),this.VB.Rmh(this.HPi),this.VB.wqk(this.FMi)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}wTa(){this.VB?(this.R9a=!1,this.VB.DU(this.iha),this.VB.hca(this.EMi),this.VB.ica(this.HJb),this.VB.EU(this.W3),this.VB.U5i(this.HPi),this.VB.bVn(this.FMi)):a.ULS.sendTraceTag(39403913,
389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}aUd(ka){ka&&this.sjd.add(ka.id,ka.ia(Ba.a.sj,0))}Wyj(ka){this.sjd.ob(ka.id)?(this.v$.nSo(ja.a.qhe,ka,this.sjd.J(ka.id)),this.sjd.remove(ka.id)):(this.v$.zRk(ja.a.qhe),this.xZc&&this.xZc())}W5a(ka){const Za=V.App.ya.jb.xc;return!!Za&&Za.Qt&&!!Za.Zc&&!!Za.Zc.Mc&&!!ka&&!!ka.Mc&&ka.Mc.id===Za.Zc.Mc.id}run(){if(0!==this.Cqc.size){var ka=[];for(const Za of this.Cqc)ka.push(Za),this.Rxe.add(Za),100<=ka.length&&(this.dSh(ka),ka=
[]);0<ka.length&&this.dSh(ka);this.Cqc.clear()}}dSh(ka){const Za=new ra.a(4,1,500,()=>{for(const Cb of ka)this.Rxe.delete(Cb),this.updateAnnotationRangeData(Cb)},158);this.Gb.Wb(Za)}updateAnnotationRangeData(ka){var Za=this.zm.yOa(ka,0,Rb=>this.hno(Rb.intent));if(0<Za.count)for(const Rb of Za){Za=this.v$.O2l(Rb.intent.id);var Cb=ka.dma;const sc=Hb.ParagraphReader.rQ(ka);Rb.end<Rb.begin||(Cb=Rd.a.jHc(sc,Cb,Rb.begin,Rb.end-Rb.begin,Rb.begin,Rb.end-Rb.begin,ka),this.cI.K1f(ka.Mc,Za,Cb))}}hno(ka){return!!ka&&
this.VD.Yib(ka)&&!!ka.content}B6c(){return!this.R9a&&this.dka.e8}}Object(e.a)(Sb,"ParagraphNodeEventHandler",yc.a,[451]);var nc=c(1001),Tc=c(398),td=c(490),je=c(110);class se extends td.a{constructor(){super();this.H_=Object.assign(new je.a,{T_:se.getTypeName(),B_:se.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(e.a)(se,"DeltaUpdateOperation",td.a,[]);var Ze=c(399);class Xe{constructor(){this.referencedPath=
null}}Object(e.a)(Xe,"ItemReference",null,[]);class ye extends Ze.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(e.a)(ye,"ItemWithPath",Ze.a,[]);var Ei=c(979);class Db extends Ei.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new je.a,{T_:Db.getTypeName(),B_:Db.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(e.a)(Db,
"MoveOperation",Ei.a,[]);var Vb=c(476);class Sc extends Vb.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new je.a,{T_:Sc.getTypeName(),B_:Sc.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(Sc,"SelectionSignal",Vb.a,[]);class bd extends Sc{constructor(){super();this.content=null;this.H_=Object.assign(new je.a,{T_:bd.getTypeName(),B_:bd.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal",
"AugLoop_Signals_Signal"]}}Object(e.a)(bd,"SelectionContentSignal",Sc,[]);class Ud{constructor(){this.range=this.tileReference=null}}Object(e.a)(Ud,"TextTileRange",null,[]);var sf=c(1651),eg=c(397),Ug=c(145),Lh=c(40),ah=c(19);class dh{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe){this._augLoopRuntimeManager=this.vhd=null;this.bQe=!1;this.uka=this.kGe=this.Hsd=null;this.Dwl=()=>{if(V.App.lostSession||Tc.SessionStatusManager.instance&&Tc.SessionStatusManager.instance.eo)y.AFrameworkApplication.ye("a596e684;c81e6109"),
y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",!1)&&(ac.a.getAugLoopRuntimeManager().closeSession(),a.ULS.sendTraceTag(512623445,389,10,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Gb.Se(this.vhd));this.pi.he(()=>{var Nd;const $e=sb.a.instance.d3;this.jB()&&this.mZn();for(this.NAc.reset();this.kWa.g8b&&!this.NAc.zkb();){let Dg;Dg=this.kWa.lYk();if(!Dg||!Dg.graphNode){a.ULS.sendTraceTag(41719901,389,15,
"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.NAc.update();continue}if(!this.llo(Dg)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",Dg.graphNode.id);this.NAc.update();continue}const Zh=Dg.graphNode.id.toString();var hf=-1,bg=!0;$e&&ah.SelectionEditor.jf($e)&&Zh==$e.node.id.toString()&&(hf=$e.cpBegin,bg=!1);let zh=null;if(this.lwb.contains(Zh))switch(Dg.lYc){case 3:this.lwb.remove(Zh);zh=3;break;default:zh=
Dg.lYc}else switch(Dg.lYc){case 0:case 1:this.lwb.add(Zh);zh=0;break;case 2:this.lwb.add(Zh);zh=0;break;case 3:this.lwb.remove(Zh);zh=3;break;default:zh=Dg.lYc}if(null!=zh){hf=this.F9h(Dg.graphNode,Dg.fullPath,zh,hf,bg);if(4==zh||5==zh){if(hf.prevParentPath.join()!==hf.parentPath.join()){bg=Object.assign(new oa.a,{parentPath:hf.prevParentPath,items:hf.items});const zi=Object.assign(new Ha.a,{parentPath:hf.parentPath,items:hf.items,prevId:hf.prevId,nextId:hf.nextId});Zh!==hf.prevId&&Zh!==hf.nextId||
a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",zh,Zh,hf.prevId,hf.nextId,Dg.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new eg.a,{operation:bg}));this._augLoopRuntimeManager.submitOperation(Object.assign(new eg.a,{operation:zi}));Dg.graphNode.type===Ug.a.table&&this.Ccj(Dg.graphNode,hf.parentPath).forEach(Ti=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new eg.a,
{operation:Ti}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new eg.a,{operation:hf}));if(this.jdd&&this.uka&&this.uka[0]==Zh)switch(zh){case 3:this.uka=null;break;case 0:case 1:case 2:case 4:case 5:this.uka[1]=null===(Nd=this.Eub.GDb(Dg.graphNode))||void 0===Nd?void 0:Nd.vMc(Dg.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",ia.a.getTypeNameFor(hf),Zh);switch(zh){case 0:case 4:case 5:this.Ze.con(Dg.graphNode);
break;case 3:this.Ze.don(Dg.graphNode,hf.parentPath.join("\\"))}}this.NAc.update()}(Nd=this.kWa.mYk())&&this.u7i(Nd)},"TV:FPEFO")};this.epa=(Nd,$e)=>{var hf;if($e.sl&&$e.sl.length){if(this.jdd)if(Nd=pb.a.bYl($e.sl),!Nd)this.uka=null;else if(!this.uka||this.uka[0]!=Nd.id.toString()){const bg=this.kWa.UBm(Nd)?null:null===(hf=this.Eub.GDb(Nd))||void 0===hf?void 0:hf.vMc(Nd);this.uka=[Nd.id.toString(),bg]}this.bQe&&this.kWa.wLn($e.sl.lb)}};this.Na=ka;this.kWa=Za;this.Gb=Cb;this.NAc=Rb;this.XPj=this.Na.$("AugLoopOperationsAreEnabled");
this.lwb=new Ta.a(eb.a.Xh());this.Ze=sc;this.pi=Wc;this.Eub=xd;this.ib=oe;this.jdd=this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.ib.gx(this.epa);pb.a.Bl().then(()=>{this._augLoopRuntimeManager=ac.a.getAugLoopRuntimeManager();y.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.Na.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new sf.a,
{handler:Nd=>{this.Ze.xvk(Nd)}}));this.XPj&&this.kWa.uuo();this.lvo()}).catch(()=>{})}mZn(){const ka=this.Ze.jqc.entries();for(let Za=0;Za<this.Ze.jqc.size;Za++){const Cb=ka.next();2E3<=Date.now()-Cb.value[1].time&&this.Ze.Wtf(Cb.value[1].annotation,!0,Ha.a.getTypeName(),!1)}}llo(ka){return 3===ka.lYc||pb.a.Mkj(ka.graphNode)}lvo(){!this.vhd&&this.kWa.e8&&(this.vhd=new ra.a(4,2,this.Na.pc("NodeEventsFiringInterval",500),this.Dwl,131),this.Gb.Wb(this.vhd))}Ccj(ka,Za){var Cb,Rb=[];const sc=Vd.GraphIterator.$a(ka),
Wc=sc.pq();for(var xd=0;xd<Wc;xd++){let oe=sc.fG(xd);oe.type===Ug.a.outlineElement&&(oe=Lh.OutlineElementNavigator.Fe(sc));const Nd=oe.id.toString(),$e=null===(Cb=this.Eub.GDb(oe))||void 0===Cb?void 0:Cb.$zb(oe);Rb.push(Object.assign(new Ze.a,{body:$e,id:Nd,revId:pb.a.Esf(oe)}));sc.fd(ka.type)}Za.push(ka.id.toString());Cb=[];Cb.push(Object.assign(new Ha.a,{parentPath:Za.slice(),items:Rb,prevId:null}));for(Rb=0;Rb<Wc;Rb++)xd=sc.fG(Rb),xd.type===Ug.a.outlineElement&&(xd=Lh.OutlineElementNavigator.Fe(sc)),
0<sc.pq()&&(Cb=Cb.concat(this.Ccj(xd,Za))),sc.fd(ka.type);Za.pop();return Cb}COa(ka){return ka.split("\\").slice(0,-1)}F9h(ka,Za,Cb,Rb=-1,sc=!0){var Wc;let xd=null,oe=null;const Nd=ka.id.toString();var $e=null;3!==Cb&&($e=pb.a.bIk(ka));if($e)for(let hf=0;hf<$e.length;hf++)if($e[hf]===Nd){oe=hf+1<$e.length?$e[hf+1]:null;xd=hf?$e[hf-1]:null;break}Nd!==xd&&Nd!==oe||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",
Cb,Nd,xd,oe,ka.type);$e=null===(Wc=this.Eub.GDb(ka))||void 0===Wc?void 0:Wc.$zb(ka,Rb,sc);Rb=[Object.assign(new Ze.a,{body:$e,id:Nd,revId:pb.a.Esf(ka)})];switch(Cb){case 0:case 1:return Object.assign(new Ha.a,{parentPath:this.COa(Za),items:Rb,prevId:xd,nextId:oe});case 4:return Object.assign(new Db,{parentPath:this.COa(pb.a.eM(ka)),prevParentPath:this.COa(Za),items:Rb,prevId:xd,nextId:oe});case 5:return Cb=this.kWa.PEl(Nd),Object.assign(new Db,{parentPath:this.COa(null!==Cb&&void 0!==Cb?Cb:pb.a.eM(ka)),
prevParentPath:this.COa(Za),items:Rb,prevId:xd,nextId:oe});case 2:return Object.assign(new wa.a,{parentPath:this.COa(Za),items:Rb});case 3:return Object.assign(new oa.a,{parentPath:this.COa(Za),items:Rb});default:return a.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",Cb,Nd),Object.assign(new Ei.a,{parentPath:this.COa(Za),items:Rb,prevId:xd,nextId:oe})}}M9l(ka){return this.uka&&this.uka[0]===ka?this.uka[1]:null}t8n(ka){var Za;if(!this.jdd)return a.ULS.sendTraceTag(545552581,
389,10,"sendTile: autoreplace is not enabled"),!1;if(!pb.a.Mkj(ka))return!1;const Cb=ka.id.toString();var Rb=this.lwb.contains(Cb)?2:0;Rb=this.F9h(ka,pb.a.eM(ka),Rb);this._augLoopRuntimeManager.submitOperation(Object.assign(new eg.a,{operation:Rb}));this.lwb.add(Cb);this.uka=[Cb,null===(Za=this.Eub.GDb(ka))||void 0===Za?void 0:Za.vMc(ka)];return!0}j7n(ka,Za){var Cb;if(this.jdd){var Rb=ka.id.toString(),sc=this.COa(pb.a.eM(ka));Za=[Object.assign(new ye,{id:Rb,revId:pb.a.Esf(ka),parentPath:sc,delta:Za})];
sc=Object.assign(new se,{parentPath:sc,items:Za});this._augLoopRuntimeManager.submitOperation(Object.assign(new eg.a,{operation:sc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",Rb);this.uka=[Rb,null===(Cb=this.Eub.GDb(ka))||void 0===Cb?void 0:Cb.vMc(ka)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}Tzk(ka,Za){if(ka.tileReference.referencedPath.length!==Za.tileReference.referencedPath.length||ka.range.start!==Za.range.start||ka.range.length!==
Za.range.length)return!1;for(let Cb=0;Cb<ka.tileReference.referencedPath.length;Cb++)if(ka.tileReference.referencedPath[Cb]!==Za.tileReference.referencedPath[Cb])return!1;return!0}Ozk(ka,Za){if(ka.selectedRanges.length!==Za.selectedRanges.length||ka.content!==Za.content)return!1;for(let Cb=0;Cb<ka.selectedRanges.length;Cb++)if(!this.Tzk(ka.selectedRanges[Cb],Za.selectedRanges[Cb]))return!1;return!0}u7i(ka){var Za;if(ka){var Cb=new jb.a,Rb="";for(let xd=0;xd<ka.length;xd++){var sc=ka.J(xd),Wc=(null===
(Za=this.Eub.GDb(sc.node))||void 0===Za?void 0:Za.$zb(sc.node)).content;Rb+=Wc;Wc=sc.cpBegin<Wc.length?sc.cpBegin:-1;Wc=Object.assign(new pa.a,{start:Wc,length:sc.cpEnd-sc.cpBegin});const oe=sc.node.id.toString();sc=this.COa(pb.a.eM(sc.node));sc.push(oe);Cb.add(Object.assign(new Ud,{range:Wc,tileReference:Object.assign(new Xe,{referencedPath:sc})}))}ka=Object.assign(new bd,{selectedRanges:Cb.toArray(),content:Rb});this.kGe&&this.Ozk(ka,this.kGe)||(Za=this.Hsd?this.Hsd:ma.a.create().toString(),Cb=
[Object.assign(new Ze.a,{body:ka,id:Za})],this.Hsd?Za=Object.assign(new wa.a,{parentPath:["session","doc"],items:Cb}):(this.Hsd=Za,Za=Object.assign(new Ha.a,{parentPath:["session","doc"],items:Cb})),this._augLoopRuntimeManager.submitOperation(Object.assign(new eg.a,{operation:Za})),this.kGe=ka)}}$fo(ka){(this.bQe=ka)?this.u7i(this.ib.hb.lb):this.kWa.FRk()}jB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}
Object(e.a)(dh,"TileView",null,[453]);var Hf=c(44),Mf=c(100);class Md{constructor(ka){Mf.a.assign(Md,this,ka)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(ka){return Mf.a.matchesTypesFor(ka,[Md.getTypeName()])}}Md.H_={T_:Md.getTypeName(),B_:Md.getBaseTypes()};class Sd{constructor(ka){Mf.a.assign(Sd,this,ka)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(ka){return Mf.a.matchesTypesFor(ka,[Sd.getTypeName()])}}
Sd.H_={T_:Sd.getTypeName(),B_:Sd.getBaseTypes()};class Pd{constructor(ka){Mf.a.assign(Pd,this,ka)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(ka){return Mf.a.matchesTypesFor(ka,[Pd.getTypeName()])}}Pd.H_={T_:Pd.getTypeName(),B_:Pd.getBaseTypes()};class Fk{constructor(ka){Mf.a.assign(Fk,this,ka)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(ka){return Mf.a.matchesTypesFor(ka,
[Fk.getTypeName()])}}Fk.H_={T_:Fk.getTypeName(),B_:Fk.getBaseTypes()};class Vg{constructor(ka){Mf.a.assign(Vg,this,ka)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable","AugLoop_Table_Table"]}static typeGuard(ka){return Mf.a.matchesTypesFor(ka,[Vg.getTypeName()])}}Vg.H_={T_:Vg.getTypeName(),B_:Vg.getBaseTypes()};var Lf;(function(ka){ka[ka.Top=0]="Top";ka[ka.Center=1]="Center";ka[ka.Bottom=2]="Bottom"})(Lf||(Lf={}));var kg;(function(ka){ka[ka.none=
0]="none";ka[ka.firstRow=32]="firstRow";ka[ka.lastRow=64]="lastRow";ka[ka.firstCol=128]="firstCol";ka[ka.lastCol=256]="lastCol";ka[ka.noHBand=512]="noHBand";ka[ka.noVBand=1024]="noVBand";ka[ka.nwCell=160]="nwCell";ka[ka.neCell=288]="neCell";ka[ka.swCell=192]="swCell";ka[ka.seCell=320]="seCell";ka[ka.defaultLook=1184]="defaultLook"})(kg||(kg={}));Object(e.b)("TableLookFlags",kg);class Og{$zb(ka){if(ka)switch(ka.type){case 14:return this.b8k(ka);case 15:return new Md;case 16:return this.a8k(ka)}else a.ULS.sendTraceTag(524149331,
389,10,"ConvertNodeToTile: Node can't be null.")}b8k(ka){var Za=ka.JF||[];let Cb=0;for(let Rb=0;Rb<Za.length;Rb++)Cb+=Za[Rb];Za=Za.map((Rb,sc)=>({columnId:sc.toString(),widthPercent:0!=Cb?100*Rb/Cb:0}));return new Fk({columnDefs:Za,tableLook:ka.properties.ia(Ba.a.tableLook,kg.defaultLook),complexTable:ka.properties.ia(Ba.a.complexTable,!1),floatingTable:ka.properties.ia(Ba.a.Ysi,!1)})}a8k(ka){return new Sd({rowspan:ka.properties.ia(Ba.a.rowSpan,1),colspan:ka.properties.ia(Ba.a.colSpan,1),borderInfo:{topBorder:{color:ka.properties.ia(Ba.a.GOb,
0),size:ka.properties.ia(Ba.a.Ijc,4),style:ka.properties.ia(Ba.a.xob,"single")},leftBorder:{color:ka.properties.ia(Ba.a.EOb,0),size:ka.properties.ia(Ba.a.Gjc,4),style:ka.properties.ia(Ba.a.vob,"single")},rightBorder:{color:ka.properties.ia(Ba.a.FOb,0),size:ka.properties.ia(Ba.a.Hjc,4),style:ka.properties.ia(Ba.a.wob,"single")},bottomBorder:{color:ka.properties.ia(Ba.a.DOb,0),size:ka.properties.ia(Ba.a.Fjc,4),style:ka.properties.ia(Ba.a.uob,"single")}},verticalAlignment:ka.properties.ia(Ba.a.aqa,Lf.Top),
ghostCell:ka.properties.ia(Ba.a.ghostCell,!1),renderCell:ka.properties.ia(Ba.a.renderCell,!1),skippedCell:ka.properties.ia(Ba.a.skippedCell,!1),fillColor:ka.properties.ia(fd.a.eH,0),verticalMerge:ka.properties.ia(Hf.a.vMerge,null)})}vMc(ka){return null===ka||void 0===ka?void 0:ka.properties}}Object(e.a)(Og,"TableElementNodeToTileConverter",null,[452]);class kh{constructor(ka,Za,Cb){this.Ho=Za;this.nya=Cb;this.vJd=!1;this.Zqc=null;this.CRi=(Rb,sc)=>{this.vxa(sc.node,0)};this.yRi=(Rb,sc)=>{Rb=sc.node;
this.nya.CMb(Rb.id.toString(),pb.a.eM(Rb))};this.DRi=(Rb,sc)=>{this.vxa(sc.node,3)};this.C6d=(Rb,sc)=>{this.vxa(sc.node,2)};this.FRi=(Rb,sc)=>{this.vxa(sc.node,0)};this.GRi=(Rb,sc)=>{this.vxa(sc.node,3)};this.ERi=(Rb,sc)=>{Rb=sc.node;this.nya.CMb(Rb.id.toString(),pb.a.eM(Rb))};this.D6d=(Rb,sc)=>{this.vxa(sc.node,2)};this.ARi=(Rb,sc)=>{this.vxa(sc.node,0)};this.zRi=(Rb,sc)=>{Rb=sc.node;this.nya.CMb(Rb.id.toString(),pb.a.eM(Rb))};this.BRi=(Rb,sc)=>{this.vxa(sc.node,3)};this.A6d=(Rb,sc)=>{var Wc;Rb=
sc.node;if(sc.property===Ba.a.ghostCell){if(sc=Rb.gg?Rb:null===(Wc=Rb.Dwa)||void 0===Wc?void 0:Wc.controlCell){Wc=Vd.GraphIterator.$a(sc);var xd=Wc.pq();for(var oe=0;oe<xd;oe++){Wc.fG(oe);var Nd=Lh.OutlineElementNavigator.Fe(Wc);this.nya.CMb(Nd.id.toString(),String.format("{0}\\{1}",pb.a.eM(sc),Nd.id));this.vxa(Nd,4);Wc.fd(16)}}}else if(sc.property===fd.a.gf){sc=Vd.GraphIterator.$a(Rb);Wc=sc.pq();let $e=null;xd=[];for(oe=0;oe<Wc;oe++){sc.fG(oe);Nd=Lh.OutlineElementNavigator.Fe(sc);this.nya.b4n(Nd.id.toString(),
String.format("{0}\\{1}",pb.a.eM(Rb),Nd.id));if(14!==Nd.type){if($e=pb.a.eM(Nd))this.nya.CMb(Nd.id.toString(),$e),this.vxa(Nd,5)}else xd.push(Nd);sc.fd(16)}$e&&xd.forEach(hf=>{this.nya.CMb(hf.id.toString(),String.format("{0}\\{1}",$e.split("\\").slice(0,-1).join("\\"),hf.id));this.vxa(hf,5)})}this.vxa(Rb,2)};this.xOf=()=>{this.B6c()?this.zU():this.vJd&&!this.nya.e8&&this.wTa()};this.uRb=ka.$("AugLoopOperationsAreEnabled")}get xZc(){return this.Zqc}init(){this.B6c()&&this.zU();this.nya.imh(this.xOf)}zU(){const {qrj:ka,
eje:Za,erj:Cb}=this.s4h();if(ka&&Za&&Cb){this.vJd=!0;var Rb=this.yRi,sc=this.DRi,Wc=this.C6d;ka.ku(this.CRi);ka.vW(Rb);ka.Lv(sc);ka.Ro(Wc);Rb=this.ERi;sc=this.GRi;Wc=this.D6d;Za.ku(this.FRi);Za.vW(Rb);Za.Lv(sc);Za.Ro(Wc);Rb=this.zRi;sc=this.BRi;Wc=this.A6d;Cb.ku(this.ARi);Cb.vW(Rb);Cb.Lv(sc);Cb.Ro(Wc)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}wTa(){const {qrj:ka,eje:Za,erj:Cb}=this.s4h();if(ka&&Za&&Cb){this.vJd=!1;var Rb=this.yRi,sc=
this.DRi,Wc=this.C6d;ka.DU(this.CRi);ka.hca(Rb);ka.ica(sc);ka.EU(Wc);Rb=this.ERi;sc=this.GRi;Wc=this.D6d;Za.DU(this.FRi);Za.hca(Rb);Za.ica(sc);Za.EU(Wc);Rb=this.zRi;sc=this.BRi;Wc=this.A6d;Cb.DU(this.ARi);Cb.hca(Rb);Cb.ica(sc);Cb.EU(Wc)}else a.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}vxa(ka,Za){ka&&this.W5a(ka)&&this.nya.e8&&this.uRb&&this.nya.Iae(ka,Za)}s4h(){return{qrj:this.Ho.af(14),eje:this.Ho.af(15),erj:this.Ho.af(16)}}W5a(ka){const Za=
V.App.ya.jb.xc;return!!Za&&Za.Qt&&!!Za.Zc&&!!Za.Zc.Mc&&!!ka&&!!ka.Mc&&ka.Mc.id===Za.Zc.Mc.id}B6c(){return!this.vJd&&!!this.nya.e8}}Object(e.a)(kh,"TableNodeEventHandler",null,[451]);class ai{constructor(ka,Za){this.BUi=ka;this.hzo=Za}GDb(ka){return ka?14===ka.type||15===ka.type||16===ka.type?this.hzo:12===ka.type?this.BUi:null:null}}Object(e.a)(ai,"NodeToTileConverterHolder",null,[450]);var Bn=c(400);class yh{get name(){return"Box4.AugmentationLoop"}yc(ka){this.W=ka;const Za=this.W.resolve("Common.IAppSettingsManager"),
Cb=Za.$("AugLoopTaskUseTimeBasedYieldStrategy"),Rb=new Ph,sc=Cb?new da.a(Za.pc("AugLoopTaskAllowedRunTimeBeforeYielding",10),E.a.Ue):new Y(Za.pc("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ha("Common.ICpuMeter",()=>N.a.instance).singleInstance();this.W.ha("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new rc).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").singleInstance();this.W.ha("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new Sb(Za,V.App.jk.Kl.af(12),Rb,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),
this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),y.AFrameworkApplication.oc,this.W.resolve("Box4.Intent.IIntentRangeEditor"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").singleInstance();pb.a.bge()&&this.W.ha("Box4.AugmentationLoop.TableNodeEventHandler",
()=>new kh(Za,V.App.jk.Kl,Rb)).singleInstance();this.W.ha("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new T).singleInstance();this.W.ha("Box4.AugmentationLoop.IFormattingExtractor",()=>new tf(this.W.resolve("Common.IAppSettingsManager"),this.W.Ma("Box4.IFeatureHelper"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IAnnotationPolicies",()=>
new ja.a(new U.a(()=>V.App.ya.jb.Wc.ud),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new dc(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new U.a(()=>V.App.ya.jb.Wc.ud),ka.resolve("Box4.IFeatureHelper"))).singleInstance();const Wc=this.W.resolve("IRoamingDictionary");this.W.ha("Box4.AugmentationLoop.IAnnotationStorage",
()=>new pc(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),new U.a(()=>V.App.ya.jb.Wc.ud),y.AFrameworkApplication.oc,this.W.Ma("Box4.IIntelligenceReader"),this.W.Ma("Box4.IIntelligenceEditor"),this.W.Ma("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Ma("Box4.AugmentationLoop.IPersistedAnnotationStorage"),ka.resolve("Box4.IFeatureHelper"),Bn.a.instance,()=>{try{return ac.a.getAugLoopRuntimeManager()}catch(xd){return a.ULS.sendTraceTag(50935320,
389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",xd),null}},Wc)).singleInstance();this.W.ha("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new ai(new nc.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new Og)).singleInstance();this.W.ha("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",()=>new dh(Za,Rb,y.AFrameworkApplication.oc,sc,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.W.resolve("Box4.ISelectionManager"))).singleInstance();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ha("Box4.AugmentationLoop.IUtilsWrapper",()=>new Ec).singleInstance();this.W.ha("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new hc).singleInstance()}init(){if(y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",
!1)&&y.AFrameworkApplication.yZ.BootFailed)a.ULS.sendTraceTag(512624089,389,10,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(y.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const ka=new gb(this.W.resolve("Common.IAppSettingsManager"),y.AFrameworkApplication.Ke,V.App.Bia,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),W.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),
Za=new ba;this.W.register(435,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").singleInstance().QTo(()=>Za);y.AFrameworkApplication.ye("b8afb343;bjdjj400");y.AFrameworkApplication.ye("72af9564;82jf1647");const Cb=pb.a.qSm(this.W.resolve("Common.IDynamicScriptLoaderProvider").HA,this.W.resolve("Common.App.OAuth.IOAuthManager"),ka,this.W.resolve("Common.ISharedDependencyLoader"),Za);this.W.ha("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new Gb(Cb)).singleInstance();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();
pb.a.bge()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(ka){z.a.instance.Gc(new yh,0,ka);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(e.a)(yh,"Box4AugmentationLoopPackage",null,[1,2]);var bi=c(627),qi=c(47),ql=c(14),ci=c(448),Zk=c(1139);class Wg{constructor(ka,
Za,Cb,Rb=null,sc=null,Wc=null){this.LN=new Zk.a(Za,Rb,sc,Wc);this.Kb=ka;this.Oc=Cb}get type(){return this.LN.type}get id(){return this.LN.id}get intent(){return this.LN.intent}Sf(ka){return new Wg(ka,this.type,this.Oc,this.id,this.intent,this.LN.Qwa)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.LN,this.Oc)}}Object(e.a)(Wg,"IntentObject",null,[201]);var Qh=c(509),Fm=c(162),Pg=c(236);class Xh{constructor(){this.Rrc=new Fm.a}Sxd(ka,Za,Cb,Rb,sc=null,Wc=null,xd=null){ka=ka.Y2(Za,
ka.qa.wGo(Za));ka.Gj||(ka.Gj=new Qh.a(ka));ka.Gj.add(new Wg(ka,Cb,Rb,sc,Wc,xd));ka.isFromErrorRangeSplit=!0}y4i(ka){return ka.Kb&&ka.Kb.Gj&&ka.Kb.Gj.S2c(Za=>Za===ka,[ka.type])?!0:!1}z4i(ka,Za){if(ka.type===Za.type&&ka.Oc&&!Za.Oc&&ka.Kb&&ka.Kb.Gj&&ka.Kb.Gj.contains(ka)&&Za.Kb&&Za.Kb.Gj&&Za.Kb.Gj.contains(Za)){var Cb=[ka.type];ka.Kb.Gj.S2c(Rb=>Rb===ka,Cb);Za.Kb.Gj.S2c(Rb=>Rb===Za,Cb)}}JUo(ka,Za,Cb){if(!Za)return!1;Cb=new Sa.a([Cb]);for(let Rb=0;Rb<ka.length;Rb++){const sc=ka.J(Rb);if(!sc.Gj)continue;
let Wc=!0;Cb.FTa(sc.Gj,void 0,xd=>{xd.id&&Za.equals(xd.id)&&(Wc=!1)});if(!Wc)return!1}return!0}dzn(ka,Za,Cb,Rb){let sc=null,Wc=null;Za=new Sa.a([Za]);const xd=ka.qa;for(let oe=0;oe<xd.length;oe++){const Nd=xd.J(oe);if(!Nd.Gj)continue;let $e=!0;Za.FTa(Nd.Gj,void 0,(hf,bg)=>{if(bg){var Dg=bg.Kb.cp<Cb,Zh=hf.Kb.cp>Rb;Dg&&hf.Kb.cp<=Cb||bg.Kb.cp>=Rb&&Zh||(Dg&&Zh?$e=!1:Dg?sc=hf:Zh?Wc=bg:this.z4i(bg,hf))}});if(!$e)return!1}if(sc){if(!this.y4i(sc))return!1;this.Sxd(ka,Cb,sc.type,sc.Oc,sc.id,sc.intent,sc.LN.Qwa)}if(Wc){if(!this.y4i(Wc))return!1;
this.Sxd(ka,Rb,Wc.type,Wc.Oc,Wc.id,Wc.intent,Wc.LN.Qwa)}return!0}$$f(ka){let Za;return y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:Za}=this.Rrc.Ec(ka.type,Za)).returnValue?Za.$$f(ka):!0}u4m(ka,Za){if(this.$$f(Za)){var Cb=Za.id,Rb=Za.type,sc=Za.begin,Wc=Za.end;if(({cpEnd:Wc}=Xh.RCj(ka,sc,Wc)).returnValue){if(ci.a(Rb)){if(!this.JUo(ka.qa,Cb,Rb))return}else if(!this.dzn(ka,Rb,sc,Wc))return;this.Sxd(ka,sc,Rb,!0,Cb,Za.intent,Za.LN.Qwa);this.Sxd(ka,
Wc,Rb,!1,Cb,Za.intent,Za.LN.Qwa)}}}T_c(ka,Za){V.App.ya.rff(ka,()=>{const Cb=new qi.GraphTransaction(2);try{Cb.Eb(ka);const Rb=ka.uY();try{const sc=ka.OZ();try{Za()}finally{sc&&sc.dispose()}}finally{Rb&&Rb.dispose()}}finally{Cb&&Cb.dispose()}})}xQa(ka,Za){this.T_c(ka,()=>{this.u4m(ka,Za)})}w4m(ka,Za){if(Za.count){var Cb=new Ab.a,Rb=new Pg.a;for(var sc of Za){var Wc=sc.value;ci.a(sc.key)||Wc.Sc((oe,Nd)=>oe.begin!==Nd.begin?oe.begin-Nd.begin:oe.end-Nd.end);if(Xh.NUo(Wc))for(var xd of Wc)Wc=xd.end,({cpEnd:Wc}=
Xh.RCj(ka,xd.begin,Wc)).returnValue&&(Wc=Wc!==xd.end?new Xa.a(xd.type,xd.begin,Wc,xd.id,xd.intent,xd.LN.Qwa):xd,Cb.add(Wc.begin),Cb.add(Wc.end),Xh.dmk(Rb,Wc))}ka.SId(Cb);ka=ka.qa;for(Cb=0;Cb<ka.length;Cb++){sc=ka.J(Cb);if(xd=sc.Gj)for(const Nd of Za.keys)xd.r5i(Nd);let oe;({value:oe}=Rb.Ec(sc.cp,oe)).returnValue||(oe=null);if(oe){xd||(xd=sc.Gj=new Qh.a(sc));for(const Nd of oe)xd.add(Nd.Sf(sc))}sc.isFromErrorRangeSplit=!0}}}$1d(ka,Za){const Cb=new Fm.a;for(const Rb of Za){let sc;({value:sc}=Cb.Ec(Rb.type,
sc)).returnValue||(sc=new jb.a,Cb.Z(Rb.type,sc));sc.add(Rb)}this.T_c(ka,()=>{this.w4m(ka,Cb)})}MJo(ka,Za,Cb){ka=ka.qa;const Rb=new Sa.a([8]);Za===Cb&&(Cb+=1);for(let sc=0;sc<ka.length;sc++){const Wc=ka.J(sc);Wc.Gj&&Rb.FTa(Wc.Gj,void 0,(xd,oe)=>{oe&&Math.max(oe.Kb.cp,Za)<Math.min(xd.Kb.cp,Cb)&&this.z4i(oe,xd)})}}cig(ka,Za,Cb){this.T_c(ka,()=>{this.MJo(ka,Za,Cb)})}OJo(ka,Za){ka=ka.qa;for(let Cb=0;Cb<ka.length;Cb++){const Rb=ka.J(Cb);Rb.Gj&&Rb.Gj.r5i(Za)}}Y6a(ka,Za){this.T_c(ka,()=>{this.OJo(ka,Za)})}NJo(ka,
Za,Cb){let Rb=!1;Za=Za.qa;Cb=[Cb];for(let sc=0;sc<Za.length;sc++){const Wc=Za.J(sc);Wc.Gj&&(Rb=Wc.Gj.S2c(ka,Cb)||Rb)}return Rb}X9c(ka,Za,Cb){let Rb=!1;this.T_c(Za,()=>{Rb=this.NJo(ka,Za,Cb)});return Rb}wOd(ka,Za,Cb,Rb){return!ka||0>Cb||Rb>ka.characterData.length||Cb>Rb?new jb.a:this.yOa(ka,Za,sc=>Math.max(sc.begin,Cb)<=Math.min(sc.end,Rb))}yOa(ka,Za,Cb){return Xh.nTl(ka,Za,Cb)}static nTl(ka,Za,Cb){const Rb=new jb.a;ka=ka.qa;Za=new Sa.a([Za]);if(!ka)return Rb;for(let sc=0;sc<ka.length;sc++){const Wc=
ka.J(sc);Wc.Gj&&Za.FTa(Wc.Gj,void 0,(xd,oe)=>{oe&&(xd=new Xa.a(oe.type,oe.Kb.cp,xd.Kb.cp,oe.id,oe.intent,oe.LN.Qwa),Cb(xd)&&Rb.add(xd))})}return Rb}rNc(ka,Za){const Cb=new jb.a;if(!Xh.qMm(ka.contextId))return Cb;let Rb;const sc=ka.node;ka.contextId!==ql.a.paragraph?(Rb=ka.cpBegin,ka=ka.cpEnd):(Rb=0,ka=sc.characterData.length);Cb.addRange(this.wOd(sc,Za,Rb,ka));return Cb}nPn(ka){this.Rrc.ob(0)||this.Rrc.Z(0,ka)}static RCj(ka,Za,Cb){ka=Hb.ParagraphReader.textLength(ka);if(Za>=ka)return{returnValue:!1,
cpEnd:Cb};Cb>ka&&(Cb=ka);return{returnValue:!0,cpEnd:Cb}}static NUo(ka){if(!ka.count)return!0;const Za=new bi.a,Cb=ka.J(0).type,Rb=ci.a(Cb);let sc=-1;for(const Wc of ka){if(Wc.type!==Cb||(ci.c(Wc.type)?Wc.begin>Wc.end:Wc.begin>=Wc.end))return!1;if(Rb){ka=Wc.id;if(!ka||ka.equals(ma.a.nil)||Za.contains(ka))return!1;Za.add(ka)}else if(-1===sc)sc=Wc.end;else if(sc>Wc.begin)return!1}return!0}static dmk(ka,Za){let Cb;({value:Cb}=ka.Ec(Za.begin,Cb)).returnValue||(Cb=new jb.a,ka.Z(Za.begin,Cb));Cb.add(new Wg(null,
Za.type,!0,Za.id,Za.intent,Za.LN.Qwa));({value:Cb}=ka.Ec(Za.end,Cb)).returnValue||(Cb=new jb.a,ka.Z(Za.end,Cb));Cb.add(new Wg(null,Za.type,!1,Za.id,Za.intent,Za.LN.Qwa))}static qMm(ka){return ka===ql.a.Fd||ka===ql.a.Vc||ka===ql.a.paragraph}}Object(e.a)(Xh,"IntentRangeEditor",null,[454]);class fi{constructor(){this.W=null}get name(){return"Box4.Intent"}yc(ka){this.W=ka;this.W.ha("Box4.Intent.IntentRangeEditor",()=>new Xh).as("Box4.Intent.IIntentRangeEditor").singleInstance()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(ka){z.a.instance.Gc(new fi,
0,ka);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}Object(e.a)(fi,"PackageManager",null,[1,2]);var kl=c(1015),$k=c(117),dj=c(1399);class Mm{constructor(ka){this.K2m=ka;this.G2m=[]}get handler(){return this.K2m}get mma(){return this.G2m}}Object(e.a)(Mm,"RegisteredListener",null,[]);class Qi{constructor(ka,Za){this.type=0;this.payload=null;this.type=ka;this.payload=Za}}Object(e.a)(Qi,"OfficeSharedCommentsEvent",null,[876]);class Rg{constructor(){this.eventType=0;this.newViewContainer=
null;this.viewContainerVisibilityState=1}}Object(e.a)(Rg,"ViewContainerEvent",null,[876]);var Cj=c(587);class fl{constructor(ka){this.aJf=!1;this.qoa=new jb.a;this.N1d=ka}KOn(ka){ka=new Mm(ka);this.qoa.add(ka)}qxj(ka){for(let Za=0;Za<this.qoa.count;++Za)if(this.qoa.J(Za).handler===ka){this.qoa.removeAt(Za);break}}lSa(ka=!1){const Za=()=>{if(y.AFrameworkApplication.Rk)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let sc=0;sc<this.qoa.count;++sc){const Wc=
this.qoa.J(sc);for(;0<Wc.mma.length;){var Cb=Array.dequeue(Wc.mma);if(Object($k.a)(Rg,Cb)){var Rb=Wc.handler;Rb(Cb)}else Object($k.a)(Qi,Cb)&&(Rb=Wc.handler,Rb(Cb.type,Cb.payload))}}};ka?Za():this.aJf||(this.aJf=!0,Cj.a.s2(this.N1d,()=>{Za();this.aJf=!1},dj.a.nyl))}}Object(e.a)(fl,"GenericEventHost",null,[]);class qj{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=
this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(e.a)(qj,"BasicEventPayload",null,[905]);class kn{constructor(ka){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ka}}Object(e.a)(kn,"CommentContextDetails",null,[]);class Gk{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=
0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(e.a)(Gk,"ContextChangeWithSelectedThreadIndex",null,[905]);class xk{constructor(){this.tasks=this.comments=null}}Object(e.a)(xk,"LoadCommentsNoVirtualization",null,[905]);class Rh extends fl{constructor(ka){super(ka);this.X$g=0}lfo(){this.X$g=1656}uPn(ka,Za,Cb,Rb,sc,Wc){ka=new Mm(ka);Wc&&Array.enqueue(ka.mma,this.Z1k(Wc,this.X$g));Wc=Za?Za.length:0;Array.enqueue(ka.mma,this.ZGh(Wc,Cb,Rb,0));Wc&&Array.enqueue(ka.mma,this.$Hh(Za,
sc));this.qoa.add(ka);this.lSa()}yPb(ka){this.qxj(ka)}e7n(ka,Za,Cb,Rb=0){this.yFb(this.ZGh(ka,Za,Cb,Rb));this.lSa()}f7n(ka,Za,Cb){this.yFb(this.y2k(ka,Za,Cb));this.lSa()}C7n(ka,Za){this.yFb(this.$Hh(ka,Za));this.lSa()}selectComment(ka){this.yFb(this.YIh(ka,6));this.lSa()}highlightComment(ka){this.yFb(this.YIh(ka,7));this.lSa()}ojg(ka,Za){this.yFb(this.D5k(ka,Za));this.lSa()}ZWf(ka,Za){this.yFb(this.F7k(ka,Za));this.lSa()}Z1k(ka,Za=0){const Cb=new qj;Cb.modelCapabilityFlags=ka;Cb.richTextCapabilityFlags=
Za;return new Qi(12,Cb)}ZGh(ka,Za,Cb,Rb){const sc=new qj;sc.numberOfComments=ka;sc.numberOfThreads=Za;sc.contextDetails=Object.assign(new kn(Cb),{nextPopulatedContextDetails:Rb});sc.contextDrafts=null;sc.rehydrationDrafts=null;return new Qi(0,sc)}y2k(ka,Za,Cb){const Rb=new qj;Rb.comments=ka;Rb.numberOfThreads=Za;Rb.tasks=Cb;return new Qi(2,Rb)}$Hh(ka,Za){const Cb=new xk;Cb.comments=ka;Cb.tasks=Za;return new Qi(1,Cb)}YIh(ka,Za){const Cb=new qj;Cb.commentId="";ka&&(Cb.commentId=ka);return new Qi(Za,
Cb)}D5k(ka,Za){const Cb=new qj;Cb.changes=[];Cb.contextDetails=Object.assign(new kn(Za),{nextPopulatedContextDetails:ka});return new Qi(10,Cb)}F7k(ka,Za){const Cb=new qj;Cb.commentId=ka;Cb.smartReplies=Za;return new Qi(15,Cb)}yFb(ka){for(let Za=0;Za<this.qoa.count;++Za)Array.enqueue(this.qoa.J(Za).mma,ka)}}Object(e.a)(Rh,"OfficeSharedCommentsEventHost",fl,[892]);var ln=c(208),Sf=c(153),Jd=c(238);class rn{constructor(){this.KPe=this.lHg=!1;this.mI=this.fn=this.mWg=this.y1g=this.xwd=this.IWb=this.Geh=
this.TLg=this.HA=this.Ozc=null}initialize(ka,Za,Cb,Rb=null,sc=null,Wc=null,xd=null,oe=null,Nd=null,$e=null){this.HA=ka;this.TLg=Za;this.Geh=Cb;this.IWb=Rb;this.xwd=sc;this.y1g=Wc;this.mWg=xd;this.fn=oe;this.lHg=!0;this.mI=Nd;this.Ozc=$e}cVd(ka=null,Za=null){if(!this.lHg)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((Cb,Rb)=>{Rb(Cj.a.lD(-2130915313))});if(this.KPe)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),
new Promise(()=>{});this.Ozc||(y.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.Ozc=appResourceLoader.loadChunk("sharedComments"):this.Ozc=this.HA.loadScript("sharedComments"));return this.Ozc.then(()=>{ka&&ka();this.KPe||(this.mI&&this.mI.execute(Cb=>{Cb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),Za&&Za(),sharedComments.instantiate(this.TLg,this.Geh,this.IWb,this.xwd,this.y1g,this.mWg,this.fn));this.KPe=!0})}}Object(e.a)(rn,
"CommentActivationManager",null,[937]);class mn extends fl{constructor(ka){super(ka)}gRn(ka){this.KOn(ka)}JKo(ka){this.qxj(ka)}Mhj(ka){ka=this.u2k(ka);for(let Za=0;Za<this.qoa.count;++Za)Array.enqueue(this.qoa.J(Za).mma,ka);this.lSa(!0)}u2k(ka){const Za=new Rg;Za.eventType=3;Za.viewContainerVisibilityState=ka;return Za}Lyl(){const ka=this.J8k();for(let Za=0;Za<this.qoa.count;++Za)Array.enqueue(this.qoa.J(Za).mma,ka);this.lSa(!0)}J8k(){const ka=new Rg;ka.eventType=2;return ka}}Object(e.a)(mn,"ViewContainerEventHost",
fl,[860]);var Al=c(46);class dg{constructor(){this.actionBehavior=this.actionType=0}}Object(e.a)(dg,"CommentUIActionPayload",null,[]);var Gm=c(322);class gl{constructor(ka,Za){this.ga=ka;this.bqb=Za;this.fnc=new Gm.a;for(let Cb of this.bqb)this.fnc.Z(Cb.value.canvasActionId,Cb.key),ka=Cb.value,ka.delayActionsUntilRegistration||this.pa(ka)}pa(ka){ka.withFlags?this.ga.gb(ka.canvasActionId,ka.canvasContextId,Object(Al.a)(this,this.ajh,"actionHandler"),97):this.ga.pa(ka.canvasActionId,ka.canvasContextId,
Object(Al.a)(this,this.ajh,"actionHandler"))}IRa(ka,Za){this.bqb.ob(ka)&&(this.bqb.J(ka).delayActionsUntilRegistration&&this.pa(this.bqb.J(ka)),this.bqb.J(ka).registeredCallback=Za)}ajh(ka,Za,Cb,Rb,sc){if(this.fnc.ob(ka)){var Wc=this.fnc.J(ka);if(!this.bqb.ob(Wc))return 8;const xd=this.bqb.J(Wc);if(xd.preCallback){const oe=xd.preCallback(ka,Za,Cb,Rb,sc);if(2!==oe)return oe}if(!xd.registeredCallback)return 1===Cb?8:2;Wc=Object.assign(new dg,{actionType:Wc});1===Cb&&(Wc.actionBehavior=1);Wc=xd.registeredCallback(Wc);
return xd.postCallback?xd.postCallback(Wc,ka,Za,Cb,Rb,sc):Wc?32:8}return 2}}Object(e.a)(gl,"OfficeSharedCommentsActionHost",null,[894]);var Cn=c(1798),bh=c(57),Ij=c(113),Bd=c(1452),Fe=c(12),nn=c(30),no=c(564),Zd=c(1144),nd=c(143),Hm=c(336),cf=c(52),Of=c(22),xm=c(1035),ze=c(1027),Bf=c(1558),ch=c(155),bj=c(7),Ag=c(41),Uf=c(707),Hl=c(504),th=c(18),Ym=c(1998);class Nm{constructor(ka){this.FV=ka;this.Nec=new M.a;this.l1a=new M.a;this.frm();this.Rkm=[new Ym.a(Ag.a.wCh,Ag.a.hVk),new Ym.a(Ag.a.wDd,Ag.a.gVk),
new Ym.a(Ag.a.nCh,Ag.a.XUk),new Ym.a(Ag.a.oDd,Ag.a.WUk),new Ym.a(Ag.a.xCh,Ag.a.jVk),new Ym.a(Ag.a.xDd,Ag.a.iVk)]}MRa(ka){this.FV.MRa(ka);this.oSn(ka)}tCf(ka,Za){return!!ka&&!!ka.objectId&&Za.contains(ma.a.Gf(ka.objectId))}SPa(ka){ka=Object(qa.a)(549,ka);return!!ka&&!!ka.objectId}oSn(ka){for(const Za of this.Rkm)ka.classList.remove(Za.className,Za.cPc);ka.classList.remove(Ag.a.zWf,Ag.a.zDd,Ag.a.oCh,Ag.a.yDd,Nm.pog)}frm(){const ka=new M.a,Za=new M.a;ka.add(0,null);ka.add(1,Ag.a.wDd);ka.add(2,Ag.a.wCh);
ka.add(3,Ag.a.zDd);Za.add(0,null);Za.add(1,Ag.a.oDd);Za.add(2,Ag.a.nCh);Za.add(3,Ag.a.oCh);this.l1a.Z(1,ka);this.l1a.Z(2,Za);this.l1a.Z(3,Za);this.Nec.add(0,null);this.Nec.add(1,Ag.a.xDd);this.Nec.add(2,Ag.a.xCh);this.Nec.add(3,Ag.a.yDd)}}Nm.pog="CommentImportant";Object(e.a)(Nm,"CommentHighlightUtils",null,[]);class Dn{constructor(){this.tId=0;this.Jzb=null}}Object(e.a)(Dn,"CommentGuidsInElementInfo",null,[]);class Sn{constructor(){this.tii=!1;this.Bla=this.RJb=null;this.oRa=this.SEb=0}}Object(e.a)(Sn,
"HighlightInfoForElement",null,[]);class Kl{constructor(){this.Vli=this.Xli=this.Wli=-1;this.Oji=[];this.S1b=[];this.SQc=this.TQc=-1;this.Sqi=!1}}Object(e.a)(Kl,"HighlightInfoForElementsInPara",null,[]);class Tm{constructor(){this.Zhg=this.aSf=null}}Object(e.a)(Tm,"OnAnchorMouseOutData",null,[]);var rg=c(1488);class ri{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe){this.Wte=ka;this.L9=Za;this.nk=Cb;this.v1=Rb;this.ga=sc;this.Gb=Wc;this.wj=xd;this.pWa=this.ej=null;this.Mfn=Nd=>{if(!this.ej||this.v1.oXd)return!0;
if(Nd=Nd.Io){if(this.ej.vA&&Nd[0].toString()===this.ej.vA.objectId)return!0;this.pWa&&Nd[0].equals(this.pWa.Zhg[0])?this.Gb.Se(this.pWa.aSf):(this.pWa&&(this.Gb.Se(this.pWa.aSf),this.ga.Rb(Fe.a.ADd,2,this.pWa.Zhg)),this.ej.jp.Tqi(Nd[0])&&!this.wj.yn||this.ga.Rb(Fe.a.s6e,2,Nd));this.pWa=null}return!0};this.Lfn=Nd=>{if(this.v1.oXd)return!0;const $e=Nd.Io;$e&&(Nd=new ra.a(2,1,0,()=>{this.ga.Rb(Fe.a.ADd,2,$e);this.pWa=null}),this.Gb.Wb(Nd),this.pWa=Object.assign(new Tm,{aSf:Nd,Zhg:$e}));return!0};this.cNi=
Nd=>{const $e=new ra.a(2,1,0,()=>{if(this.ej&&!this.ej.jp.Xx){var hf=Nd.Io;if(!hf)hf=V.App.ya.yp.currentScope,this.ej.vA&&(!hf||hf.name!==ch.AFrame.bM&&hf.name!==ch.AFrame.xr)&&this.ej.clearSelection();else if(!this.ej.vA||hf.toString()!==this.ej.vA.objectId)if(hf=this.ej.jp.WZ(hf.toString()))hf=Object.assign(new Bd.a,{commentId:hf.id,mR:!1,e9:1}),this.ga.Rb(th.a.selectComment,2,hf)}});this.Gb.Wb($e);return!1};oe.execute(Nd=>{this.ej=Nd})}Nuh(ka,Za,Cb,Rb){const sc=new Kl,Wc=[],xd=this.L9.SPa(Za)?
Za.objectId:null;for(let $e=0,hf=ka.length;$e<hf;$e++){var oe=ka[$e],Nd=rg.g(oe);const bg=rg.d(oe);oe=new bi.a;const Dg=new Sn;if(Nd){const Zh=new Hl.a(rg.c);Nd=this.HVh(Nd,xd,Zh);0<Nd.length&&(this.kOo(Nd,Cb,oe,Dg,xd,Rb),Wc.push(Object.assign(new Dn,{tId:$e,Jzb:Zh})))}bg&&(Nd=this.HVh(bg,xd),0<Nd.length&&(this.mOo(Nd,Cb,oe,Dg,sc,xd,Rb,$e),this.EMo(Wc,Nd,$e,Dg)));0<Cb.count&&this.nOo(Za,Cb,Dg,Rb);this.CMo(Wc,Dg);sc.Oji.push(Dg)}return sc}cqh(ka,Za,Cb){let Rb=!1;for(let sc=0,Wc=ka.length;sc<Wc;sc++){const xd=
ka[sc],oe=Za.Oji[sc],Nd=Uf.a(xd);if(1!==Nd&&2!==Nd&&3!==Nd)continue;const $e=3===Nd||2===Nd&&-1!==xd.className.indexOf(Ag.a.aPa);this.L9.MRa(xd);this.cnk(xd,oe,$e,Rb);this.Olk(xd,sc,Nd,oe,Za,Cb);this.Plk(xd,sc,Za,oe);Rb=$e}}HVh(ka,Za,Cb=null){const Rb=[];for(let sc=0;sc<ka.length;sc++)this.Wte.kjj(ka[sc],ka[sc].toString()===Za)&&(Rb.push(ka[sc]),Cb&&Cb.add(ka[sc]));return Rb}kOo(ka,Za,Cb,Rb,sc,Wc){var xd;let oe=!1,Nd=!1;for(const hf of ka){Za.add(hf);Cb.add(hf);var $e=hf.toString();$e===sc?($e=Wc?
1:2,Rb.oRa=$e,Rb.SEb=$e):this.tCf(this.ej.vA,Za)&&($e===(null===(xd=this.ej.vA)||void 0===xd?void 0:xd.objectId)&&(Nd=!0),oe=!0)}0<ka.length&&!Rb.oRa&&(Rb.oRa=Nd?1:3,Rb.SEb=oe?1:3)}mOo(ka,Za,Cb,Rb,sc,Wc,xd,oe){var Nd,$e;const hf=new Hl.a(rg.c);xd=xd?1:2;let bg=!1;for(const Dg of ka){const Zh=Dg.toString();Za.contains(Dg)||(Zh===Wc?sc.Vli=oe:(sc.Wli=oe,Rb.oRa=3,(null===(Nd=this.ej.vA)||void 0===Nd?void 0:Nd.objectId)===Zh&&(sc.Xli=oe,Rb.oRa=1)),hf.add(Dg));Zh===(null===($e=this.ej.vA)||void 0===$e?
void 0:$e.objectId)&&(bg=!0);Za.remove(Dg);Cb.contains(Dg)&&this.lOo(Rb,Dg,Zh,Wc,xd);Zh===Wc&&(Rb.oRa=xd)}0<ka.length&&!Rb.oRa&&(Rb.oRa=bg?1:3);0<hf.count&&sc.S1b.push(Object.assign(new Dn,{tId:oe,Jzb:hf}))}EMo(ka,Za,Cb,Rb){0!==ka.length&&(Za.forEach(sc=>{for(let Wc=ka.length-1;0<=Wc;Wc--){const xd=ka[Wc];if(xd.Jzb.contains(sc)){xd.tId===Cb&&(Rb.Bla?Rb.Bla.push(sc):Rb.Bla=[sc]);xd.Jzb.remove(sc);break}}}),ka=ka.filter(sc=>0<sc.Jzb.count))}nOo(ka,Za,Cb,Rb){var sc,Wc;this.tCf(ka,Za)?Cb.SEb=Rb?1:2:Cb.SEb||
(Cb.SEb=null!=(null===(sc=this.ej.vA)||void 0===sc?void 0:sc.objectId)&&Za.contains(ma.a.Gf(null===(Wc=this.ej.vA)||void 0===Wc?void 0:Wc.objectId))?1:3);Cb.RJb||(Cb.RJb=[]);for(const xd of Za)Cb.RJb.push(xd)}CMo(ka,Za){if(0<ka.length){Za.Bla||(Za.Bla=[]);for(const Cb of ka[ka.length-1].Jzb)Za.Bla.push(Cb)}}lOo(ka,Za,Cb,Rb,sc){ka.tii=!0;ka.RJb||(ka.RJb=[]);ka.RJb.push(Za);Cb===Rb&&(ka.SEb=sc)}tCf(ka,Za){return!!ka&&!!ka.objectId&&Za.contains(ma.a.Gf(ka.objectId))}cnk(ka,Za,Cb,Rb){!Za.oRa||Cb||Rb||
((Cb=this.L9.Nec.J(Za.oRa))&&ka.classList.add(Cb),Za.tii&&ka.classList.add(Ag.a.zWf))}Olk(ka,Za,Cb,Rb,sc,Wc){Rb=this.L9.l1a.J(Cb).J(Rb.SEb);Za<sc.Vli?Rb=Wc?this.L9.l1a.J(Cb).J(1):this.L9.l1a.J(Cb).J(2):Za<sc.Wli&&!Rb&&(Rb=Za<sc.Xli?this.L9.l1a.J(Cb).J(1):this.L9.l1a.J(Cb).J(3));Rb&&(Za=sc.Sqi,ka.classList.add(Rb),Za&&ka.classList.add(Nm.pog))}Plk(ka,Za,Cb,Rb){Rb.Bla||(Rb.Bla=this.hJl(Za,Cb)||Rb.RJb);Za=null;Rb.Bla&&0<Rb.Bla.length&&(this.nk.mb(bj.a.L_,ka,this.Mfn,Rb.Bla),this.nk.mb(bj.a.Ewa,ka,this.Lfn,
Rb.Bla),Za=Rb.Bla[0]);this.nk.mb(bj.a.click,ka,this.cNi,Za);this.nk.mb(bj.a.yJ,ka,this.cNi,Za)}hJl(ka,Za){for(;0<Za.S1b.length&&Za.S1b[0].tId===ka;)Za.S1b.splice(0,1);if(0<Za.S1b.length){ka=[];for(const Cb of Za.S1b[0].Jzb)ka.push(Cb);return ka}return null}}Object(e.a)(ri,"AllMarkupModeHighlightChangeHandler",null,[546]);var Cf=c(1462);class ne extends Cf.a{constructor(ka){super(100,25);this.dnc=new M.a(0);this.JOj=6E4;this.jyl=()=>{const Za=this.dnc.keys;if(Za.length){var Cb="";for(let Rb=0;Rb<Za.length;Rb++)Cb+=
Za.J(Rb)+":"+this.dnc.J(Za.J(Rb))+";";this.lpa(Cb);this.dnc=new M.a(0)}};this.lqb=new jb.a;this.lqb.add(1);this.lqb.add(6);this.lqb.add(2);this.lqb.add(4);this.lqb.add(10);this.lqb.add(11);this.ih=ka;ka.m0f&&window.setInterval(this.jyl,this.JOj)}BGa(ka){this.ih.zIo&&this.ih.m0f&&(this.lqb.contains(ka)?this.uJn(ka):this.lpa(ka+""))}uJn(ka){this.dnc.Z(ka,this.dnc.Wy(ka,0)+1)}}Object(e.a)(ne,"CommentActionInTypingRecorder",Cf.a,[555]);var Fd=c(1595),zj=c(200);class Xd{static DTn(ka){ka&&ka.atmention&&
delete ka.atmention.isCurrentUser;return ka}}Object(e.a)(Xd,"DeltaFormatHelpers",null,[]);class Th{constructor(){this.optional=this.attributes=null}}Object(e.a)(Th,"Operation",null,[]);class Pf extends Th{constructor(){super();this.insert=null}}Object(e.a)(Pf,"DeltaOperation",Th,[]);class rj{constructor(){this.ops=null}}Object(e.a)(rj,"Delta",null,[]);var En=c(118),lg=c(195),al=c(176),Dh=c(61),Fi=c(84),Ri=c(135),Ll=c(522),Pe=c(1188),ib=c(1751);class Ib extends ib.ACommentFormatTranslator{constructor(ka,
Za){super(ka);this.ve=Za}fgg(ka){const Za=new Fd.a;for(let Cb=0;Cb<ka.length;Cb++){const Rb=ka[Cb];Rb.WFb=!0;this.Dwk(Za,Rb);Za.lga("\n")}return[Za.IMc()]}UCo(ka,Za){ka=Fd.a.aDb(ka[0]);ka=this.Czn(ka);const Cb=new jb.a;let Rb=0,sc=null,Wc=null;for(;Rb<ka.ops.length;){const xd=ka.ops[Rb];sc||(sc=Pe.a.instance.createInstance(393230),sc.WFb=!0,sc.Yg(Ba.a.Lc,zj.a.aF()),Za(sc),sc.qa.clear(),sc.Fpa(""));"\n"===xd.insert?(Wc=this.mHf(sc,Wc),this.Hho(sc),Cb.add(sc),sc=null):Wc=this.rTm(sc,xd,Wc);Rb++}return Cb.toArray()}Hho(ka){const Za=
ka.uwh();for(let Cb=0;Cb<Za;Cb++)ka.Ae.$p.Z(Cb,Ib.X$m),ka.Ae.Ps.Z(Cb,Ib.bOf)}mHf(ka,Za){var Cb=ka.RId();Cb.cp===ka.characterData.length?Cb.Rh=!0:(Cb=Object.assign(new lg.a(ka,ka.characterData.length),{Rh:!0}),ka.qa.add(Cb));Cb=ka.qa.last;if(Za){Za=!!Za.hx;const Rb=this.PDh(ka,Cb,!Za,Za,null);Cb.formatting=Rb;Za&&(ka=this.NDh(ka,Cb),Cb.UT=ka.Dj);Cb.Km=!0;Za=null}Cb.cp||Cb.formatting||(Cb.formatting=new al.a(Cb,ma.a.nil));return Za}rTm(ka,Za,Cb){const Rb=ka.RId(),sc=!!Za.attributes&&!!Za.attributes.link,
Wc=!!Za.attributes&&!!Za.attributes.atmention,xd=this.PDh(ka,Rb,sc,Wc,Za);Rb.formatting=xd;Cb&&(Cb.hx&&(Cb=this.NDh(ka,Rb),Rb.UT=Cb.Dj),Rb.Km=!0,Cb=null);if(sc||Wc)this.TSm(Rb,ka,Za),Cb=Rb.hyperlink;ka.Fpa(ka.characterData+Za.insert);return Cb}NDh(ka,Za){Za=new al.a(Za,ma.a.create());let Cb=this.EFd();Cb.setValue(Ba.a.XGb,!0);Cb=ka.Mc.gR(Cb);Za.Dj=Cb.id;return Za}PDh(ka,Za,Cb,Rb,sc){Za=new al.a(Za,ma.a.create());let Wc=Pe.a.instance.createInstance(1179649);if(Cb||Rb)Wc.setValue(fd.a.lB,!0),Wc.setValue(fd.a.z3,
!0),Cb&&this.t$n(ka,Wc);this.ih.Jyb&&sc&&sc.attributes&&this.mfo(sc.attributes,Wc);Wc=ka.Mc.gR(Wc);Za.Dj=Wc.id;return Za}t$n(ka,Za){(ka=this.ve.qC(ka))&&(ka=ka.Ni(Dh.StyleReader.kQb))&&Za.setValue(xc.a.Qv,ka.id)}mfo(ka,Za){this.fNb(ka.weight>=Fd.a.DKf,Za,fd.a.bold,!0);this.fNb(ka.italic,Za,fd.a.italic,!0);this.fNb(ka.underline,Za,fd.a.underline,!0);this.fNb(ka.underline,Za,fd.a.underlineType,fg.a.uPb);this.fNb(ka.strikethrough,Za,fd.a.strikethrough,!0);if(Fi.a.ZUc(ka.highlight)){var Cb=Fi.a.jEa(ka.highlight);
this.fNb(!!ka.highlight,Za,fd.a.highlight,Fi.a.o4(Cb))}Fi.a.ZUc(ka.color)&&(Cb=Fi.a.jEa(ka.color),this.fNb(!!ka.color,Za,fd.a.fontColor,Fi.a.o4(Cb)))}fNb(ka,Za,Cb,Rb){ka&&Za.setValue(Cb,Rb)}TSm(ka,Za,Cb){if(Cb.attributes&&Cb.attributes.atmention){var Rb=Ri.HyperlinkReader.DOa(Cb.attributes.atmention.email);Cb=Cb.optional&&Cb.optional.atmention&&Cb.optional.atmention.contentId?Cb.optional.atmention.contentId:Ib.dCl(1===Cb.attributes.atmention.resolveState);Rb=new Ll.a(ka,Rb,!0,void 0,void 0,void 0,
Cb);this.n1k(Rb,Za.Mc);ka.hyperlink=Rb}else Za=Ri.HyperlinkReader.DOa(Cb.attributes.link),Rb=this.X3k(ka.paragraph.qa.first),ka.hyperlink=new Ll.a(ka,Za,!1,Rb.Dj)}X3k(ka){let Za=this.RIh();Za=ka.paragraph.Mc.gR(Za);ka=new al.a(ka,ma.a.nil);ka.Dj=Za.id;return ka}n1k(ka,Za){var Cb=String.format(' HYPERLINK "{0}"',ka.url),Rb=ka.hx;const sc=this.EFd();sc.setValue(Ba.a.Rs,15);sc.setValue(Ba.a.hx,Rb);sc.setValue(Ba.a.PPa,!0);sc.setValue(Ba.a.fieldInstruction,Cb);ka.Zsa(Za.gR(sc).id);Rb=this.EFd();Rb.setValue(Ba.a.Rs,
47);Rb.setValue(Ba.a.fieldInstruction,Cb);ka.Zsa(Za.gR(Rb).id);Cb=this.EFd();Cb.setValue(Ba.a.Rs,16);ka.Zsa(Za.gR(Cb).id)}RIh(){const ka=Pe.a.instance.createInstance(1179649);ka.setValue(fd.a.lB,!0);ka.setValue(fd.a.z3,!0);ka.setValue(fd.a.isHidden,!0);return ka}EFd(){const ka=this.RIh();ka.setValue(fd.a.w9,!0);return ka}Czn(ka){const Za=new jb.a;for(let Cb=0;Cb<ka.ops.length;Cb++){const Rb=ka.ops[Cb];Rb.optional=Xd.DTn(Rb.optional);if(-1!==Rb.insert.indexOf("\n")&&"\n"!==Rb.insert){const sc=Rb.insert.split("\n");
for(let Wc=0;Wc<sc.length;Wc++)if(Cb!==ka.ops.length-1||Wc!==sc.length-1||sc[Wc])Za.add(Object.assign(new Pf,{insert:sc[Wc],attributes:Rb.attributes,optional:Rb.optional})),Wc!==sc.length-1&&Za.add(Object.assign(new Pf,{insert:"\n"}))}else Za.add(Rb)}return Object.assign(new rj,{ops:Za.toArray()})}static dCl(ka){return ib.ACommentFormatTranslator.EAk+En.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(ka?"Z":"")}}Ib.X$m=0;Ib.bOf=0;Object(e.a)(Ib,"CommentDeltaFormatTranslator",ib.ACommentFormatTranslator,
[]);var fc=c(1658),Cc=c(1539);class Jc{get userPrincipalName(){return this.K.kb("UserPrincipalName")}constructor(ka,Za,Cb){this.ik=ka;this.K=Za;this.QS=Cb}pD(ka){return this.ik.pD(ka)}nzm(ka){ka=this.ik.pD(ka);return ka?!ka.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}xSc(ka){return this.ik.xSc(ka)}isCurrentUserMentioned(ka){var Za,Cb;ka=this.ik.XIl(ka);for(const Rb of ka){if(!Rb.text||0===Rb.text.length)continue;ka=Fd.a.aDb(Rb.text[0]);let sc=0;for(;ka.ops&&
sc<ka.ops.length;){const Wc=null===(Cb=null===(Za=ka.ops[sc])||void 0===Za?void 0:Za.attributes)||void 0===Cb?void 0:Cb.atmention;if(Wc&&Wc.email===this.userPrincipalName)return!0;sc++}}return!1}dZc(){this.QS.ipa("OnContentFilterUpdate")}}Object(e.a)(Jc,"CommentFilterActor",null,[553]);var pd=c(86),ge=c(1994),pe=c(892),ke=c(609);class Qf{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe,Nd){this.Wh=ka;this.Gb=Za;this.pi=Cb;this.bUa=Rb;this.wj=sc;this.t5=Wc;this.Eh=xd;this.US=oe;this.PO=Nd;this.osb=null;this.TSe=
0;this.Fld=!1;this.oqd=0;this.IPb=this.f7c=this.YKg=this.uuc=this.Dxb=!1;this.updateViewportInfo=()=>{this.US.Bag()&&this.Eh.updateViewportInfo(this.Fld,this.JTf)};this.Pkb=()=>{this.Eh.Tka.Lna()&&(this.n2c(this.Eh.Tka.xc),this.Eh.Tka.bgc(this.Pkb))};this.JTf=()=>{this.h7a();this.US.ITf()};this.kdg=()=>{!this.Dxb&&this.US.R$f()&&(this.oqd=this.VUe.scrollTop,this.Dxb=!0,this.bUa.BGa(2))};this.K0f=($e,hf)=>{this.Dxb&&($e=this.VUe.scrollTop,$e-this.oqd?(this.uuc||hf.Xme||this.updatePosition(),this.uuc||
1!==hf.Xme||this.h7a(),this.UYe($e),this.US.ESf()):this.uuc=this.Dxb=!1)};this.VUe=this.Eh.Yca;this.vha=ke.a.m7d;this.Us=this.Eh.Us;this.Eh.DDh()}get RWd(){return this.US.GDf()}get vha(){return this.Eh.vha}set vha(ka){this.Eh.vha=ka}get Wqh(){return"1"===this.Us.YE.style.opacity}wij(ka){this.f7c||(this.f7c=!0,this.Eh.RWi(),this.osb=ka(this.Us.BEa,this.Eh.h5i,()=>{this.updatePosition()}),this.Eh.tDi(this.osb),this.US.initialize(this.osb,this),this.Eh.initialize(this.osb,this.US.Rkb),this.Eh.D2i(),
this.Eh.qij(),this.Eh.rij(),this.Eh.vij(this.US.f1e,this.US.m6d,this.US.l6d),this.t1f())}h6c(){}Xfe(){return this.Eh.ojj()}setInitialActiveContainerId(ka,Za,Cb=null){this.Eh.setInitialActiveContainerId(ka,0,Cb)}updatePosition(){if(!this.IPb&&this.RWd&&this.Wh.c8b()){var ka=E.a.Ue()-this.TSe<ke.a.AAj;ka||this.Fld||this.h7a(ka)}}j0e(){this.h7a()}mSa(ka,Za,Cb){this.Eh.mSa(ka,Za,Cb)}deleteContainer(ka,Za,Cb=!1){this.Eh.deleteContainer(ka,Za,()=>{this.Wh.Nuf()||this.Eh.wvf();this.US.NQf()},Cb)}addContainer(ka,
Za,Cb){this.Eh.addContainer(ka,Za,Cb,this.Eh.qf,this.US.GNc,this.US.yPf)}wVi(ka){this.IPb=!0;ka();this.IPb=!1}g3c(ka,Za,Cb){this.Eh.g3c(ka,Za,Cb)}E1b(){this.Eh.E1b()}WAj(){const ka="1"===this.Us.YE.style.opacity;switch(!0){case ka&&!this.Wh.Nuf():this.Eh.wvf();break;case !ka&&this.Wh.Nuf():this.Eh.Nic()}}sgg(ka=!0){this.US.wag&&this.Eh.ttj(ka)}static M3h(ka,Za=null){const Cb=new ob.a;for(const Rb of ka)Rb.Ff||Rb.er!==ge.a.beingCreated&&(!Za||Za(Rb))&&Qf.Ekk(Cb,Rb.objectId,Rb);return Cb}static Ekk(ka,
Za,Cb){let Rb;({value:Rb}=ka.Ec(Za,Rb)).returnValue||(Rb=[],ka.Z(Za,Rb));Rb.push(Cb)}n2c(ka){ka&&(ka.Xka(()=>{this.updateViewportInfo()}),this.oqd=this.VUe.scrollTop,ka.fnh(this.kdg),ka.gnh(this.K0f))}t1f(){this.Eh.qf?this.n2c(this.Eh.qf):this.Eh.Tka?this.Eh.Tka.p_b(this.Pkb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}UYe(ka){this.Us.YE.style.top=ka-this.oqd+"px";this.uuc=!1}h7a(ka=!1){ka=new ra.a(0,1,0,()=>{this.pdf()},129,void 0,!ka);this.Gb.Wb(ka);
this.Fld=!0;this.uuc=this.Dxb;this.bUa.BGa(10)}Bqf(ka){return this.Eh.FZa({contentAnchorPositions:ka.contentAnchorPositions})}pdf(){this.Fld=!1;if(this.Us.BEa&&this.osb&&this.Wh.c8b()){this.Eh.gJd();var ka=0;this.pi.he(()=>{ka=this.Eh.pNd()},"FCM:UP:GET");var Za=null,Cb=null;this.pi.he(()=>{const Rb=this.US.q2h(ka,this.Eh.qf);Za=Rb.VVk;Cb=this.Bqf(Rb)},"FCM:UP:GP");this.pi.he(()=>{this.Dxb?(this.Eh.nRh(Cb),this.Dxb=!1):this.osb.emitEvent(3,Cb);this.t5.nae()},"FCM:UP:RC");this.osb.setFirstCommentRenderDone();
"0"===this.Us.YE.style.opacity&&0<Za.count&&!this.wj.yn&&this.pi.he(()=>{this.Eh.Nic()},"FCM:UP:SFC");!this.YKg&&0<Za.count&&(Cj.a.s2(this.Gb,this.Eh.WDi,dj.a.VDi),this.YKg=!0);this.TSe=E.a.Ue();this.bUa.BGa(6)}else this.TSe=E.a.Ue()}}Object(e.a)(Qf,"FloatingCommentManager",null,[26,537]);var Hg=c(106),gc=c(1463),nh;(function(ka){ka[ka.ffp=0]="singleHint";ka[ka.Hbp=1]="multiHint";ka[ka.Vdp=2]="resolvedHint";ka[ka.Ibp=3]="multiResolvedHint";ka[ka.entryPoint=4]="entryPoint";ka[ka.unknown=void 0]="unknown"})(nh||
(nh={}));Object(e.b)("CommentIconType",nh);var Yd=c(112),Nk=c(1108);const Jj={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[nh.unknown]:""},gj={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],[2]:["OfficeIconColors_mCommentResolvedHintIconCenter",
"OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[nh.unknown]:[]},eh=(ka,Za)=>{switch(ka){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(Za){case 3:return Nk.a.DCh;
case 2:return Nk.a.ECh;case 1:return Nk.a.FCh}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(Za){case 3:return Nk.a.ACh;case 2:return Nk.a.BCh;case 1:return Nk.a.CCh}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(Za){case 3:return Nk.a.GCh;case 2:return Nk.a.HCh;
case 1:return Nk.a.ICh}}},Eh=(ka,Za)=>{Yd.a("renderIcon")&&appChrome.api.renderIcon(ka,Za)};class sg{}sg.Qji=16;sg.blm=1;sg.Zwf=20;sg.nFj=2;Object(e.a)(sg,"CommentIconConstants",null,[]);class Ea{constructor(){this.pDd=0;this.sDc=!1}}Object(e.a)(Ea,"CommentHintCensus",null,[]);class yb{constructor(ka,Za,Cb,Rb,sc){this.WLg=ka;this.JZb=Cb;this.iVj=Rb;this.Uea=sc;this.iMa=-1;this.Vte=new Set(Za)}get y(){if(-1!==this.iMa)return this.iMa;const ka=Sys.UI.DomElement.getBounds(this.WLg),Za=this.WLg.getClientRects();
return this.iMa=0<Za.length&&Za[0]?this.iVj?ka.y/this.JZb+sg.nFj:Math.floor(Za[0].height)/(2*this.JZb)+ka.y/this.JZb-sg.Qji/2:0}get vDd(){return Array.from(this.Vte)}Hok(ka){this.Vte=new Set([...this.Vte,...ka])}}Object(e.a)(yb,"HintInfo",null,[568]);class kc extends gc.a{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe,Nd,$e,hf,bg,Dg,Zh){super();this.ih=ka;this.hg=Za;this.nk=Cb;this.ZD=Rb;this.ga=sc;this.Wh=$e;this.Uqa=hf;this.bUa=bg;this.wj=Dg;this.JSj=Zh;this.led=new Map;this.Tsb=this.nwb=null;this.Akc={PHa:-1,
pOf:-1}}Lnb(ka){let Za=!1;V.App.FEj&&ka.fc.Yi?N.a.instance.he(()=>{Za=rg.m(ka,!0)},"CHA:SCIVE"):N.a.instance.he(()=>{Za=rg.l(ka.htmlElement,!0)},"CHA:SCI");return Za}reb(ka){const Za=this.zoom,Cb=ka.b4,Rb=ka.Lva;let sc=0;for(let oe=0;oe<ka.cba.length;oe++)if(0<ka.cba[oe].width){sc=oe;break}const Wc=ka.xdb(1,sg.Zwf,Za,sc);this.bUa.BGa(1);let xd=[];Rb.forEach((oe,Nd)=>{const $e=ka.cba[Nd].y/Za;oe=this.l4k(this.CRl(oe,Nd),hf=>this.Z3k(Cb,hf,hf.y-$e,Wc),()=>kc.Y5k(Cb));xd=xd.concat(oe)});return xd}l4k(ka,
Za,Cb){Cb=Cb();const Rb=[];for(const sc of ka){ka=Za(sc);for(const xd of sc.vDd)this.led.set(xd.toString(),ka);const Wc=this.n9h(sc.vDd);this.pzj(Wc,ka);null==Cb.Uea&&(Cb.Uea=sc.Uea);Cb.appendChild(ka);Rb.push(ka)}this.u8b(this.Tsb);this.Ihb(this.nwb);return[Cb]}Cjl(ka,Za){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+kc.eTi);return 0<(null===ka||void 0===ka?void 0:ka.length)&&ka[0]&&(ka=Array.from(ka[0].querySelectorAll(kc.kVk)))?this.p5n(ka,Za):!1}p5n(ka,Za){let Cb=0,Rb=ka.length-1,sc;
for(;Rb>=Cb;){sc=Math.floor((Rb-Cb)/2+Cb);const Wc=ka[sc];if(Wc.offsetTop>=Za-2&&Wc.offsetTop<=Za+2)return!0;Wc.offsetTop>Za+2?Rb=sc-1:Cb=sc+1}return!1}n9h(ka){var Za,Cb;let Rb=0,sc=0;for(const Wc of ka)if(this.Wh.GCf(Wc)){if(this.ih.contentFilterApiEnabled&&this.wj.yn&&(ka=this.Wh.WZ(Wc.toString()),null===(Cb=(Za=this.JSj).isContentInFilteredContent)||void 0===Cb||!Cb.call(Za,ka.id)))continue;this.Wh.Tqi(Wc)?sc+=1:Rb+=1}Za=new Ea;Za.pDd=Rb+sc;Za.sDc=0===Rb;return Za}mlc(ka){if(ka=this.led.get(ka.objectId)){var Za=
rg.g(ka);Za=this.n9h(Za);this.pzj(Za,ka)}}pzj(ka,Za){let Cb,Rb;if(this.ih.contentFilterApiEnabled&&0===ka.pDd)Za.style.display="none";else if(1===ka.pDd?(Cb=ka.sDc?2:0,Rb=ka.sDc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=ka.pDd&&(Cb=ka.sDc?3:1,Rb=ka.sDc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),Za.style.display=
"block",ka=Za.firstElementChild)this.Wbo(ka,Cb),ka.title=Rb+". "+ka.title,Eh(Jj[Cb],ka)}Wbo(ka,Za){ka.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;Hg.a.jl(ka,kc.JCh,Za)}CRl(ka,Za){ka=this.$3k(ka,Za);ka.sort((Cb,Rb)=>Cb.y-Rb.y);return this.c7m(ka)}$3k(ka,Za){const Cb=[],Rb=this.ih.Kq,sc=this.zoom;ka=rg.f(ka,!0);for(let Wc=0,xd=ka.length;Wc<xd;Wc++){const oe=ka[Wc],Nd=rg.g(oe);Nd&&Cb.push(new yb(oe,Nd,sc,Rb,Za))}return Cb}c7m(ka){let Za=null;const Cb=[];for(let Rb=0;Rb<
ka.length;Rb++)Za&&Math.abs(ka[Rb].y-Za.y)<sg.Qji+sg.blm?Za.Hok(ka[Rb].vDd):(Za=ka[Rb],Cb.push(Za));return Cb}Z3k(ka,Za,Cb,Rb){const sc=ka.Og.ownerDocument,Wc=sc.createElement("div");Wc.className=kc.yCh;Wc.style.top=Cb+"px";Wc.style.left=Rb+"px";Wc.style.right="auto";Wc.style.zIndex="40";Hg.a.jl(Wc,Ag.a.RFc,Za.vDd);Za=sc.createElement("span");this.ejg(Za,Wc);Eh(Jj[0],Za);this.bF(Za,ka);return Wc}ejg(ka,Za){ka.title=CommonUIStrings.l_CommentHintTooltip;ka.setAttribute("role","button");Za.appendChild(ka)}bF(ka,
Za){this.hg.JD(bj.a.click,ka,this.qin.bind(this),Za);this.hg.mb(bj.a.$A,ka,this.uin.bind(this));this.nk.mb(bj.a.L_,ka,this.win.bind(this));this.nk.mb(bj.a.LK,ka,this.vin.bind(this));this.ZD.mb(ka,this.tin.bind(this))}static Y5k(ka){ka=ka.Og.ownerDocument.createElement("div");ka.className=kc.eTi;return ka}tin(){return!0}uin(){return!0}qin(ka){const Za=rg.g(ka.xw.parentNode);ka.eventName===bj.a.yJ&&(this.Uqa.e5e(),this.zAh());this.ga.Rb(Fe.a.zCh,2,Za);return!0}win(ka){this.MDa(this.Tsb)!==ka.xw&&(ka=
rg.g(ka.xw.parentNode),this.ga.Rb(Fe.a.s6e,2,ka));return!0}vin(){this.ga.processAction(Fe.a.ADd,2);return!0}u8b(ka){this.zAh();this.Tsb=ka;this.yxk()}yxk(){this.zxk(this.MDa(this.Tsb),this.MDa(this.nwb))}Ihb(ka){this.bRk();this.nwb=ka;if(ka=this.MDa(this.nwb)){const Za=this.gOd(ka);this.Gee(ka,Za,1)}}MDa(ka){if(!ka)return null;let Za=null;if(ka=this.Wh.WZ(ka))if(ka=ka.Ff?this.Wh.pD(ka.Ff):ka)Za=ka.objectId;return Za&&this.led.has(Za)?this.led.get(Za).firstChild:null}zAh(){this.dRk(this.MDa(this.Tsb),
this.MDa(this.nwb))}dRk(ka,Za){if(ka){const Cb=this.gOd(ka);this.Gee(ka,Cb,ka===Za?1:3);this.Tsb=null}}zxk(ka,Za){ka&&(ka.title=0<this.Akc.pOf&&1<this.Akc.PHa?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.Akc.pOf,this.Akc.PHa):CommonUIStrings.l_CommentHintTooltip,Za!==ka&&(Za=this.gOd(ka),this.Gee(ka,Za,2)))}bRk(){const ka=this.MDa(this.Tsb),Za=this.MDa(this.nwb);if(Za){const Cb=this.gOd(Za);this.Gee(Za,Cb,ka===Za?2:3);this.nwb=null}}Gee(ka,Za,Cb){this.ADm()?
this.Nbo(ka,Cb):this.Mdo(ka,Za,Cb)}Nbo(ka,Za){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===ka||void 0===ka?void 0:ka.length)&&(ka[0].style.fill=2===Za||1===Za?"Highlight":"ButtonText")}Mdo(ka,Za,Cb){Za=gj[Za];for(let sc=0;sc<Za.length;sc++){var Rb=Za[sc];const Wc=eh(Rb,Cb);if(!this.kAm(Wc)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${Wc}.`);break}Rb=null===ka||void 0===ka?void 0:ka.querySelectorAll("."+Rb);0<(null===
Rb||void 0===Rb?void 0:Rb.length)&&(Rb[0].style.fill=`var(${Wc})`)}}ADm(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(ka){return!1}}gOd(ka){return Hg.a.Db(ka,kc.JCh)}kAm(ka){var Za;const Cb=document.getElementById(nd.AppFrame.RIc);return!(null===(Za=null===Cb||void 0===Cb?void 0:Cb.style)||void 0===Za||!Za.getPropertyValue(ka))}}kc.yCh="clip16x16 HintContainer";kc.kVk=".clip16x16.HintContainer";kc.eTi="OutlineElementHintMargin";kc.JCh="CommentIconType";Object(e.a)(kc,
"CommentHintActor",gc.a,[550]);var Rc=c(1E3);class Xc extends Rc.a{get wag(){return this.f_()}get sdf(){return this.n_o.qci()}constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe,Nd,$e){super();this.wi=ka;this.rv=Za;this.ik=Cb;this.taskManager=Rb;this.pxd=sc;this.QS=Wc;this.Eh=xd;this.getSelectedText=oe;this.n_o=Nd;this.tg=$e;this.NYc=()=>{};this.e5d=()=>{};this.qIg=!1;this.qNk={[0]:()=>this.oMh(),[1]:()=>this.Ric.j0e(),[2]:()=>this.oMh()};this.ITf=()=>{this.pxd.BGa(11)};this.f1e=hf=>{if(this.rv.Jyb)for(const bg of rg.t)hf.bindAction(pd.KeyInputManager.hG(bg),
th.a.S2e)};this.m6d=()=>{this.e5d()};this.l6d=(hf,bg)=>{if(hf.name!==ch.AFrame.xr&&bg){var Dg=this.ik.Ts?this.ik.Ts.id:"";this.wi.oJb||(this.wi.oJb=Cj.a.s2(this.taskManager,()=>{this.NYc(Dg)}))}};this.hRi=()=>{};this.Rkb=()=>{this.glj()};this.yPf=(hf,bg)=>{0===bg&&(this.QS.nae(),this.pxd.BGa(0))};this.NQf=()=>{this.pxd.BGa(5)};this.GNc=hf=>{let bg=0;const Dg=this.ik.mQ();for(let Zh=0;Zh<Dg.length;Zh++){if(Dg[Zh].Ff||Dg[Zh].done)continue;if((Dg[Zh].er===ge.a.beingCreated?Dg[Zh].Ty.draftId:Dg[Zh].id)===
hf.contentId)break;const zh=this.ox.getContentAnchorPosition(Dg[Zh].id);!zh||4<Math.abs(hf.anchorTop-zh.anchorTop)||bg++}return bg};this.pMi=()=>{this.QS.nae()};this.ESf=()=>{this.pxd.BGa(2)};this.glj=()=>{if(!this.qIg&&this.Eh.Yca){const hf=this.Eh.Yca.getElementsByClassName(kc.yCh);for(let bg=0;bg<hf.length;bg++)hf[bg].style.opacity="1";this.qIg=!0}}}initialize(ka,Za){this.ox=ka;this.Ric=Za;this.m2c()}mbo(ka,Za){this.e5d=ka;this.NYc=Za}B2h(ka,Za){return{uYa:this.KJl(ka,Za),containerContentByType:{}}}q2h(ka,
Za){const Cb=Qf.M3h(this.ik.mQ(),this.ik.Cna),Rb=[],sc=rg.e(!0);var Wc=this.ik.mQ();Za=this.DBn(Za,Wc,Cb);!Za.IXf&&Za.contentAnchorPosition&&(Rb.push(Za.contentAnchorPosition),Za.contentAnchorPosition=null);for(Wc=0;Wc<sc.length;Wc++){const xd=sc[Wc],oe=rg.g(xd);if(oe)for(let Nd=0;Nd<oe.length;Nd++){const $e=this.getContentAnchorPosition(ka,Cb,xd,oe[Nd]);$e&&(Rb.push($e),Za.IXf&&Za.contentAnchorPosition&&$e.contentId===Za.IXf.id&&(Rb.push(Za.contentAnchorPosition),Za.contentAnchorPosition=null))}}Za.contentAnchorPosition&&
Rb.splice(0,0,Za.contentAnchorPosition);return{VVk:Cb,contentAnchorPositions:Rb}}GDf(){var ka;return!(null===(ka=this.ox)||void 0===ka||!ka.getAreContainersEnabled())}f_(){return this.ik.c8b()}R$f(){return this.f_()}G6c(){return this.f_()}Bag(){return this.ox&&this.Eh.Yca&&this.f_()}WQi(ka){0!==ka&&this.NYc(this.ik.Ts?this.ik.Ts.id:"")}getContentAnchorPosition(ka,Za,Cb,Rb){let sc=null;return({value:sc}=Za.Ec(Rb.toString(),sc)).returnValue?(Za=sc[0])&&!Za.Ff?Object.assign(Object.assign({},new pe.a),
{anchorTop:(ke.a.NMc(Cb)-ka)/this.Eh.saa,anchorLeft:0,containerContentType:0,contentId:Za.id}):null:null}DBn(ka,Za,Cb){var Rb,sc;const Wc={};"CREATE"===(null===(sc=null===(Rb=this.ik.Xx)||void 0===Rb?void 0:Rb.Ty)||void 0===sc?void 0:sc.sessionType)&&(Rb=this.Eh.Yca.querySelectorAll(rg.b),ka=this.Eh.Y_h((0<Rb.length?Rb[0]:null)||this.getSelectedText(),this.ik.Xx.Ty.draftId,0,ka),Wc.IXf=this.R_l(Za,Cb),Wc.contentAnchorPosition=ka);return Wc}R_l(ka,Za){var Cb=Array.indexOf(ka,this.ik.Xx);for(--Cb;-1<
Cb;Cb--)if(Za.ob(ka[Cb].objectId))return ka[Cb]}KJl(ka,Za){return this.q2h(ka,Za).contentAnchorPositions}m2c(){this.QS.Iha("OnAfterTrackChangeMarkupViewChange",(ka,Za)=>{if(Za)this.qNk[Za.Cj]()})}oMh(){const ka=rg.i();if(0!==ka.length){var Za=Qf.M3h(this.ik.mQ()),Cb=this.ik.rK;for(let Rb=0;Rb<ka.length;Rb++){const sc=rg.g(ka[Rb]);for(let Wc=0;Wc<sc.length;Wc++){let xd;({value:xd}=Za.Ec(sc[Wc].toString(),xd)).returnValue&&(xd.forEach(oe=>{var Nd;oe&&!oe.Ff&&(this.Ric.deleteContainer(oe.id,0,!1),(null===
(Nd=Cb.vA)||void 0===Nd?void 0:Nd.id)===oe.id&&Cb.clearSelection())}),this.tg.mg(ch.AFrame.$n))}}}}}Object(e.a)(Xc,"CommentFloatingContainerActor",Rc.a,[554]);var yd=c(1465),gf=c(1999),vc=c(175);class Le extends yd.a{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe,Nd){super();this.V3j=ka;this.S8a=Za;this.Wte=Cb;this.pi=sc;this.L9=oe;this.t5=Nd;this.ej=null;this.Cj=1;Rb.execute($e=>{this.ej=$e});this.L1=[];this.cpc=new vc.ScriptSharpLegacyMap;this.ANn(Wc,xd);this.m2c()}get Hi(){return this.V3j.value}get commentEditor(){return this.S8a}get Xaa(){return!!this.ej}get Jhb(){return 0}get m1a(){return this.L1}get VUg(){return this.cpc.ob(this.Cj)?
this.cpc.J(this.Cj):this.cpc.J(0)}SPa(ka){return this.L9.SPa(ka)}D0a(ka,Za){if(ka=Object(qa.a)(549,ka))for(const Cb of this.SBn(ka))Za.add(Cb)}ZFa(ka,Za){this.Xaa&&this.pi.he(()=>{this.Qkn(ka,Za)},"CHA:OPHC")}Qkn(ka,Za){if(this.ej.jp.c8b()){var Cb=this.Uu.JCa,Rb=new Ta.a(new Oe.a),sc=Za.uGa("*"),Wc=this.lJl(Cb),xd=!!Cb&&!Cb.action||!!Wc&&Wc===this.ej.vA,oe;this.pi.he(()=>{this.Wte.RYl(ka.id,Rb,null===Wc||void 0===Wc?void 0:Wc.objectId)},"OPHC:GOI");this.pi.he(()=>{oe=this.VUg.Nuh(sc,Wc,Rb,xd);oe.Sqi=
this.Qqi(Cb)&&0===Cb.action},"OPHC:BHI");this.pi.he(()=>{this.VUg.cqh(sc,oe,xd)},"OPHC:AH")}}lJl(ka){let Za=null;!this.Qqi(ka)||0!==ka.action&&2!==ka.action||(Za=this.Uu.JCa.eA);return Za||this.ej.vA}SBn(ka){if(!ka)return[];ka=this.Hi.Db(ma.a.Gf(ka.objectId));return this.commentEditor.yPd(ka,null)}F3i(){return!1}gF(ka,Za,Cb){this.Xaa&&(ka=Object.assign(new gf.a,{action:ka,type:0,eA:Za,lJ:Cb}),this.Uu.gF(ka))}e5e(){this.Xaa&&(this.gF(3,this.ej.A8b,this.ej.A8b),this.ej.A8b=null)}ANn(ka,Za){this.cpc.add(1,
ka);this.cpc.add(0,Za)}m2c(){this.t5.Iha("OnBeforeTrackChangeMarkupViewChange",(ka,Za)=>{Za&&Za.$Nf!==this.Cj&&(this.Cj=Za.$Nf)})}Qqi(ka){return ka&&0===ka.type}}Object(e.a)(Le,"CommentHighlightActor",yd.a,[552,434]);var id=c(1020),Gi=c(390),Oh=c(439),Yg=c(1497);class xi{constructor(ka,Za){this.HVk=ka;this.rPf=Za}}Object(e.a)(xi,"CommentEndParaIdBeforeChangeInfo",null,[]);var Dj=c(1596);class Ml{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe){this.AGf=ka;this.wi=Za;this.ik=Cb;this.QS=Rb;this.Ho=sc;this.Gk=Wc;
this.dVk=xd;this.rv=oe;this.Qqb=null;this.EBn=(Nd,$e)=>{(Nd=$e.commentNode)&&!rg.s(Nd)&&($e=this.ik.bmf(Nd),ma.a.Sp($e.F7c,$e.xJc)||this.Qyj($e,Nd)||this.mzh($e.pCa,$e.$Ma,Nd)||this.pjg(Nd))};this.Ben=(Nd,$e)=>{$e.property===Ba.a.Gua&&(Nd=rg.h($e.node,ma.a.nil),this.Qqb=new xi($e.node.id,Nd))};this.Ofn=(Nd,$e)=>{Nd=$e.node;if($e.property===Ba.a.Gua&&Nd){var hf=rg.k(Nd,ma.a.nil);$e=rg.h(Nd,ma.a.nil);var bg=this.Qqb?this.ud.Db(this.Qqb.rPf):null;!rg.s(Nd)&&hf&&!hf.equals($e)&&this.Qqb&&Nd.id.equals(this.Qqb.HVk)&&
!hf.equals(this.Qqb.rPf)&&bg&&bg.isConnected&&this.jXe(this.Qqb.rPf,Nd.id);$e&&this.wi.Ax.ob($e)&&(hf=this.wi.Ax.J($e),hf.e1a&&(a.ULS.shipAssertTag(572835481,327,!!hf.uM,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),hf.uM&&hf.uM.contains(Nd.id)&&(hf.uM.remove(Nd.id),hf.uM.count||(hf.e1a=!1),this.wi.tU.ob(Nd.id)?this.wi.tU.J(Nd.id).remove($e):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.oZc=(Nd,$e)=>{Nd=
$e.node.id;this.wi.Ax.ob(Nd)&&this.HTn(Nd)};this.jen=(Nd,$e)=>{$e&&$e.node&&this.sUa.ob($e.node)&&(Nd=this.sUa.J($e.node).l7d,this.sUa.ob(Nd)||(Nd=this.sUa.J($e.node),this.mzh(Nd.$$e?Nd.currentNode:Nd.l7d,Nd.$$e?Nd.l7d:Nd.currentNode,Nd.commentNode)||this.pjg(Nd.commentNode)),this.sUa.remove($e.node))};this.Rfn=(Nd,$e)=>{const hf=Nd.Tj;if(!$e&&this.jbb.ob(hf)){var bg;(bg=this.jbb).Z(hf,bg.J(hf)&(Nd.Oc?-2:-3));this.jbb.J(hf)||(this.pjg(this.ud.Db(hf)),this.jbb.remove(hf))}};this.sUa=new Oh.a(new id.a);
this.jbb=new vf.a(rg.c);this.QS.Iha("OnCommentNodeAdded",this.EBn);this.rv.contentFilterApiEnabled?(this.QS.Iha("OnCommentPaneOpen",this.Zvm.bind(this)),this.QS.Iha("OnCommentPaneClose",this.Yvm.bind(this)),this.QS.Iha("OnContentFilterUpdate",this.dZc.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Nd=>{this.QS.Iha(Nd,this.Xvm.bind(this))});ka=this.Ho.af(12);ka.Lv(this.oZc);ka.ku(this.jen);this.Ho.af(40).t_b(this.Ben);this.Ho.af(40).Ro(this.Ofn);Gi.a.JRa(this.Rfn)}get my(){return this.AGf.value}get ud(){return this.my.ud}RYl(ka,
Za,Cb){if(this.dtn(ka))for(const Rb of this.wi.Ax.J(ka).uM)!this.kjj(Rb,Cb===Rb.toString())||Za.add(Rb)}kjj(ka,Za){const Cb=this.ud.Db(ka),Rb=rg.s(Cb);if(!Cb||Rb)return!1;ka=this.ik.WZ(ka.toString());return!ka||this.rv.contentFilterApiEnabled&&this.wi.yn&&!this.dVk.isContentInFilteredContent(ka.id)||!this.wi.yn&&!this.ik.Cna(ka)&&!Za?!1:!0}dtn(ka){return this.Lsn(ka)}pjg(ka){if(ka){var Za=Yg.a.yPd(ka,null),Cb=new Ab.a;for(let Rb=1;Rb<Za.length-1;Rb++)this.jXe(Za[Rb].id,ka.id),Cb.add(Za[Rb]);Uf.b(Cb)}}Lsn(ka){if(!this.wi.PX)return!1;
let Za=null;if(({value:Za}=this.wi.Ax.Ec(ka,Za)).returnValue)return Za.e1a;let Cb=!1;this.Gk.he(()=>{const Rb=rg.e();for(let sc=0;sc<Rb.length;sc++)Cb=this.NPo(Rb[sc],ka,Cb);Cb||(this.wi.Ax.add(ka,new Dj.a),this.wi.Ax.J(ka).e1a=!1)},"CHORA:PHOC");return Cb}NPo(ka,Za,Cb){ka=rg.g(ka);if(!ka)return Cb;for(let Rb=0;Rb<ka.length;Rb++){const sc=this.ud.Db(ka[Rb]);sc&&!rg.s(sc)&&(Cb=Cb||this.QNk(sc,Za))}return Cb}QNk(ka,Za){var Cb=this.ik.bmf(ka);if(this.Qyj(Cb,ka))return!1;var Rb=Cb.F7c;const sc=Cb.xJc;
Cb=Cb.pCa;if(Rb!==ma.a.nil&&(Rb.equals(sc)||Rb.equals(Za)))return!1;for(Rb=Hb.ParagraphReader.ug(Cb,!1);Rb&&!Rb.id.equals(sc);){if(Rb.id.equals(Za))return this.jXe(Za,ka.id),!0;Rb=Hb.ParagraphReader.ug(Rb,!1)}return!1}jXe(ka,Za){this.wi.tU.ob(Za)||this.wi.tU.add(Za,new Ta.a(new Oe.a));this.wi.tU.J(Za).add(ka);this.wi.Ax.ob(ka)?this.wi.Ax.J(ka).uM||(this.wi.Ax.J(ka).uM=new Ta.a(new Oe.a)):this.wi.Ax.add(ka,new Dj.a(!0));this.wi.Ax.J(ka).e1a=!0;this.wi.Ax.J(ka).uM.add(Za)}HTn(ka){if(this.wi.Ax.J(ka).uM)for(const Za of this.wi.Ax.J(ka).uM)this.wi.tU.ob(Za)?
this.wi.tU.J(Za).remove(ka):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.wi.Ax.remove(ka)}Xvm(){const ka=new Ab.a;for(const Za of this.ik.mQ())Za.Ff||Za.er===ge.a.beingCreated||this.ik.Cna(Za)||this.ik.rjg(Za,ka);Uf.b(ka)}Zvm(){this.Kyf("OnCommentPaneOpen")}dZc(){this.Kyf("OnContentFilterUpdate")}Yvm(){this.Kyf("OnCommentPaneClose")}Kyf(ka){const Za=new Ab.a;for(const Cb of this.ik.mQ())Cb.Ff||Cb.er===ge.a.beingCreated||this.ik.rK.cxh(ka,Cb)||
this.ik.rjg(Cb,Za);Uf.b(Za)}Qyj(ka,Za){let Cb=!1;if(!ka.The||!ka.JId){Cb=!0;if(!ka.pCa||!ka.$Ma)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!ka.pCa,!ka.$Ma),!0;ka.The||this.sUa.ob(ka.pCa)||this.sUa.add(ka.pCa,{commentNode:Za,currentNode:ka.pCa,l7d:ka.$Ma,$$e:!0});ka.JId||this.sUa.ob(ka.$Ma)||this.sUa.add(ka.$Ma,{commentNode:Za,currentNode:ka.$Ma,l7d:ka.pCa,$$e:!1})}return Cb}mzh(ka,Za,Cb){ka=Yg.a.ava(ka,Cb.id,!0);Za=Yg.a.ava(Za,Cb.id,!1);let Rb;ka||({value:Rb}=
this.jbb.Ec(Cb.id,Rb),this.jbb.Z(Cb.id,Rb&1));Za||({value:Rb}=this.jbb.Ec(Cb.id,Rb),this.jbb.Z(Cb.id,Rb&2));return!ka||!Za}}Object(e.a)(Ml,"CommentHighlightOnRestActor",null,[551]);var Kn=c(415),Kj=c(350),Rj=c(648);class Ul{constructor(ka,Za){this.Cxb=ka;this.Bja=Za}getViewContainer(){return this.Cxb}registerForViewContainerEvents(ka){this.Bja.gRn(ka)}unregisterForViewContainerEvents(ka){this.Bja.JKo(ka)}}Object(e.a)(Ul,"ViewContainerProvider",null,[859]);class uh{constructor(ka,Za,Cb,Rb){this.isRightToLeft=
!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ka;this.appLocale=Za;this.uiCulture=Cb;this.dataCulture=Rb}}Object(e.a)(uh,"LocalizationDetails",null,[]);var yk=c(1141),Bi=c(1509);class yf{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe,Nd,$e,hf,bg,Dg,Zh,zh,zi,Ti,Il,mi,pm,po,$m,pn,pp,Vo,Xn,Lj,Mn,qp,Hk,Yn){this.Jq=ka;this.ik=Za;this.V1b=Cb;this.HZ=Rb;this.rv=sc;this.wi=Wc;this.gLd=xd;this.v8b=oe;this.vq=Nd;this.rc=$e;this.dynamicScriptLoader=hf;this.N1n=bg;this.tg=Dg;this.A6e=Zh;this.w6e=
zh;this.hjh=zi;this.EVo=Ti;this.p0=Il;this.QS=mi;this.r3n=pm;this.orl=po;this.RLi=$m;this.FVo=pn;this.Kzb=pp;this.US=Vo;this.Eh=Xn;this.PO=Lj;this.K7e=Mn;this.f4a=qp;this.BDd=Hk;this.jZk=Yn;this.Xjd=this.BWa=null;this.hWg=!1;this.QJe=[];this.W$g=this.iWg=!1;this.initialize=(hk,vn)=>{this.eqm(vn)};this.F$k=hk=>Fi.a.i8e(hk);this.Sfn=()=>{this.Pmi()};this.BPl=(hk,vn,go)=>{hk=Object.assign(Object.assign({},new yk.a),{containerPanel:hk,paneOpenedCallback:vn,paneClosedCallback:go,ulsLogger:new Kn.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,
isRtl:y.AFrameworkApplication.isRtl,viewportInfo:this.Eh.Rmf(),destroyAllContainersCallback:()=>{this.wi.yn||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.rv.hLd,synchronousContainerPositioningEnabled:!1,trackChangeInSidetrackEnabled:this.rv.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.rv.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,
contentNavigationApiEnabled:this.rv.contentNavigationApiEnabled,contentFilterApiEnabled:this.rv.contentFilterApiEnabled,returnToDraftFixEnabled:!0}});this.rv.contentNavigationApiEnabled&&(hk.sidetrackContentNavigationApi=this.K7e,hk.featureGateApiSettings=this.US.sdf,hk.telemetryDetails=this.RLi,this.rv.contentFilterApiEnabled&&(hk.contentFilterAPI=this.jZk));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(hk)};this.Hhn=hk=>{2!==this.Jq.mode&&3!==this.Jq.mode&&this.ik.Ts&&hk===
this.ik.Ts.id&&this.Jq.clearSelection();V.App.ya.updateCommandUI(!0)};this.eNi=(hk,vn)=>{this.fx("onCSCStart",window.performance.now());this.Fcb&&!hk&&(this.Fpn(),this.fx("openInFishbowl",!0));this.V1b.Jcb&&this.rv.WAb&&this.rc.processAction(Fe.a.newComment,2);vn&&vn();this.fx("onCSCEnd",window.performance.now())};this.QS.Iha("OnCommentInit",this.initialize);this.QS.Iha("OnCommentRenderedOnce",this.Sfn);this.US.mbo(()=>{},this.Hhn)}get DJa(){return this.Jq}get Fcb(){return this.wi.Fcb}fx(ka,Za){this.f4a.fx(kl.a.comments,
ka,Za,!0)}eqm(ka){if(this.wi.PX)ka&&ka.JFa&&ka.JFa();else if(this.hWg)(null===ka||void 0===ka?0:ka.JFa)&&this.QJe.push(ka.JFa);else{var Za=this.rv.uPc;this.fx("hasCommentOnBoot",Za);Za?this.Kzb.logKpiUsage(Bi.a.U1b,0):Kj.a.$cc("canvas","floatingComments");this.hWg=!0;this.fx("initInProgress",!0);this.ik.initialize(this.Jq);this.V1b.initialize(this.Jq,null);this.V1b.sij(this.Jq);this.v8b.Zqm(this.HZ.Tfo);this.fx("InitAMSetup",window.performance.now());Rj.a.xp(this.orl).continueWith(Cb=>{(this.BWa=
Cb.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.A6e.initialize(this.BWa);this.DJa.o6e.initialize(this.DJa,this.ik,this.BWa,this.A6e);this.hjh.initialize(this.dynamicScriptLoader,this.DJa.o6e,this.RLi,this.BWa,new Ul(this.EVo,this.FVo),this.b8h(),"",this.A6e.qci(),this.p0,V.App.Nfe);this.fx("AMInitialized",window.performance.now());this.rv.contentNavigationApiEnabled?(V.App.iCb?V.App.iCb:this.Eh.gCi()).then(()=>{this.fx("FCMLoaded",
window.performance.now());this.h6c();this.cVd(ka)}):this.cVd(ka)})}}Byn(){var ka;null===(ka=sharedComments.setDarkModeColorHandler)||void 0===ka?void 0:ka.call(sharedComments,this.F$k)}cVd(ka){this.Xjd=this.hjh.cVd(void 0,this.Byn.bind(this));this.eRc(ka);this.wi.PX=!0;this.rv.Zbg&&this.w6e.initialize()}eRc(ka){if(!this.wi.jFb){this.fx("InitCSStart",window.performance.now());var Za=this.vq.eg("Task","InitiateCommentingSession");this.Kzb.logKpiUsage(Bi.a.KCh,0);try{const Cb=this.vq.eg("Task","InitiateCommentingSession-UpdateModel");
this.BDd.wqm();Cb.stop();this.fx("initAtBoot",window.performance.now());this.rv.Kq&&this.ik.c8b()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",E.a.Ue()));Ij.a.get_instance().WK(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.wi.jFb=!0;this.Xjd.then(()=>{this.fx("SCLoaded",window.performance.now());this.Eh.Qqm();this.fx("FCMInitiated",window.performance.now());if(this.rv.Kq){let sc=!1;if(this.Fcb){var Rb=
this.HZ.SMd(this.Fcb);Rb?(y.AFrameworkApplication.ye("3ge3g205;cha3g788"),Rb=this.HZ.TMd(Rb,0),Rb)?this.ik.Cna(Rb)||(sc=!0,this.Gpn(Rb)):(sc=!0,this.K3a()):sc=!0}Rb=ka?ka.WNi:null;this.rv.contentNavigationApiEnabled?this.eNi(sc,Rb):this.OSm(sc,Rb)}ka&&ka.JFa&&ka.JFa();for(const sc of this.QJe)sc();this.iWg&&this.Pmi();this.QJe=[]})}catch(Cb){a.ULS.JH(539567713,327,10,Cb,`Comments Initialization Failed: ${Cb}`),this.Kzb.logKpiFailure(Bi.a.KCh,"CommentsInitializationFailed",{isInternal:!0},{name:Bi.a.T1b,
isInternal:!0})}finally{Za.stop(),this.fx("InitCSEnd",window.performance.now())}this.rc.processAction(Fe.a.mCh,2)}}Gpn(ka){this.rc.processAction(Fe.a.vY,2);this.US.glj();Cj.a.s2(y.AFrameworkApplication.oc,()=>{this.HZ.selectComment(ka,Object.assign(Object.assign({},new Bd.a),{mR:!0,e9:1}));this.tg.mg(ch.AFrame.xr);a.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-y.AFrameworkApplication.DW)},dj.a.W5n);this.Kzb.hy(Fe.a.r6e);
y.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}K3a(){this.rc.processAction(Fe.a.K3a,2)}OSm(ka,Za){(V.App.iCb?V.App.iCb:this.Eh.gCi()).then(()=>{this.fx("FCMLoaded",window.performance.now());this.h6c();this.eNi(ka,Za)}).catch(Cb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+Cb.toString())})}h6c(){this.PO.trackChangeInSidetrackEnabled?(this.gLd.h6c(),this.fx("STSet",window.performance.now())):this.gLd.wij(this.BPl)}Pmi(){this.W$g||
(this.wi.PX&&this.Xjd?(this.Xjd.then(()=>{const ka=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.r3n.execute(Za=>{ka.registerSafelinksNavigator(Za.Ykc.bind(Za))});this.N1n.execute(Za=>{Za.DNn(ka)})}),this.W$g=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.iWg=!0))}b8h(){return new uh(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}Fpn(){this.HZ.Hbj(this.Fcb,
Object.assign(Object.assign({},new Bd.a),{pag:!1,sSc:!0}));this.Kzb.hy(Fe.a.r6e)}}Object(e.a)(yf,"CommentInitActor",null,[]);class Uh{constructor(ka,Za,Cb,Rb,sc){this.hg=ka;this.ZD=Za;this.ga=Cb;this.KSj=Rb;this.mj=sc;this.Fme=this.hVa=null}get zoom(){let ka=1;this.mj&&this.mj.instance&&(ka=this.mj.instance.ij);return 0<ka?ka:1}Ssl(ka,Za){if(!this.Fme||!ka.Lva||Za>=ka.Lva.length)return null;const Cb=this.zoom,Rb=ka.b4,sc=ka.xdb(1,sg.Zwf,Cb,Za);return this.h3k(ka.Lva[Za],Rb,(this.Fme.y-ka.cba[Za].y)/
Cb+sg.nFj,sc)}h3k(ka,Za,Cb,Rb){if(this.hVa)return(Za=this.hVa.parentElement)&&Za.removeChild(this.hVa),this.lej(ka,this.hVa,Cb,Rb),this.hVa;const sc=Za.Og.ownerDocument,Wc=sc.createElement("div");Wc.className=Uh.bVk;this.lej(ka,Wc,Cb,Rb);ka=sc.createElement("span");this.ejg(ka,Wc);Eh(Jj[4],ka);this.ROn(ka,Za);return this.hVa=Wc}ejg(ka,Za){ka.title=CommonUIStrings.l_CommentNewCommentButton;ka.setAttribute("role","button");Za.appendChild(ka)}ROn(ka,Za){this.hg.JD(bj.a.click,ka,this.ohn.bind(this),Za);
this.hg.mb(bj.a.$A,ka,this.qhn.bind(this));this.ZD.mb(ka,this.phn.bind(this))}yTd(){if(this.hVa){const ka=this.hVa.parentElement;ka&&ka.removeChild(this.hVa)}}lej(ka,Za,Cb,Rb){this.KSj.Cjl(ka,Cb)?Za.style.left=Rb+sg.Zwf+"px":Za.style.left=Rb+"px";Za.style.top=Cb+"px";Za.style.right="auto";Za.style.display="block";Za.style.position="absolute";Za.style.overflow="hidden";Za.style.cursor="default";Za.style.zIndex="40"}qhn(){return!0}ohn(ka){this.ga.iD=30;this.ga.processAction(Fe.a.newComment,2);ka=ka.xw;
Eh(Jj[4],ka);ka=ka.parentElement;(null===ka||void 0===ka?0:ka.parentElement)&&ka.parentElement.removeChild(ka);return!0}phn(){return!0}}Uh.bVk="clip16x16 EntryPointContainer";Object(e.a)(Uh,"CommentMarginEntryPointActor",null,[]);var ue=c(457),Be=c(92),nf=c(231),qe=c(26),Sj=c(123);class on{constructor(ka,Za,Cb,Rb,sc,Wc,xd){this.AGf=ka;this.CQm=Za;this.jp=Cb;this.wi=Rb;this.rv=sc;this.u6e=Wc;this.Kzb=xd;this.cZi=new Set;this.XHb=new Set;this.UZc=new nf.a;this.W1b=new Map;this.PCh=K.a.instance.We("Box4.CommentParagraphMapping");
this.Lzb=new Set;this.Qea=this.RMd()}get my(){return this.AGf.value}get ud(){return this.my.ud}get sCa(){return this.CQm.value}RMd(){const ka=new Vd.GraphIterator;ka.set(this.my);this.sCa.G3a(ka);return ka}wqm(){this.wi.jFb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",qe.Debug.S_a());this.rv.contentNavigationApiEnabled||(this.rv.uPc&&this.uqm(),this.jp.ePi())}Uen(){this.p9i();this.Lzb.forEach(ka=>{this.Nrg(ka)});
this.Lzb.clear();this.jp.ePi()}Nrg(ka){if(ue.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${ka}`);var Za=this.W1b.get(ka).gjc,Cb=this.W1b.get(ka).C4b;Za===ma.a.nil||Cb===ma.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${Za} or end ${Cb} has invalid value`):(this.PCh.value.kZa.set(ka,Za),this.PCh.value.jZa.set(ka,Cb),a.ULS.sendTraceTag(512235651,327,50,`Start ${Za} and End ${Cb} mapping info for Comment ${ka} added on Comment Model load`))}}btm(ka){const Za=
[];for(const Cb of ka)ka=Cb.Tj.toString(),this.vyj(ka,Cb.paragraph.id,Cb.Oc),Cb.Oc&&(this.cZi.has(ka)?a.ULS.sendTraceTag(523334301,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",Cb.Tj):(this.cZi.add(ka),(ka=this.Gkk(Cb))&&Za.push(ka)));return Za}vyj(ka,Za,Cb){ue.a.isEnabled&&(this.W1b.has(ka)||this.W1b.set(ka,{gjc:ma.a.nil,C4b:ma.a.nil}),Cb?this.W1b.get(ka).gjc=Za:this.W1b.get(ka).C4b=Za)}Gkk(ka){var Za=this.ud.Db(ka.Tj);this.Qea.Fi(Za);if(40!==this.Qea.Xe||!Za)return a.ULS.sendTraceTag(523334303,
327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!Za,!ka.Tj),this.Qea=39===this.Qea.Xe?this.Qea:this.RMd(),null;Za=this.jp.jFd(this.Qea);let Cb;if(({index:Cb}=this.jp.Rke(Za)).returnValue)if(this.jp.FWe(Za,Cb),this.XHb.add(Za.objectId),rg.p(Za)||this.Lzb.add(Za.objectId),Za.Ff)this.uif(Za);else return{contentId:Za.id,containerContentType:0,Q8:{rd:ka.Kb.cp,tM:ka.paragraph.wl}};else this.UZc.add(Za);return null}uif(ka){if(ka.Ff){var Za=
this.jp.pD(ka.Ff);if(Za&&Za.Ff){const Cb=this.jp.pD(Za.Ff);Cb&&(Cb.Ff?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(ka.Ff=Za.Ff,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${ka.objectId} parentObjectId: ${Za.objectId}`)))}}}uqm(){const ka=new M.a(0),Za=Be.a.So(this.jp.zIa),Cb=new Set;this.rv.brn&&!ue.a.isEnabled&&this.Pmk(Za,ka);const Rb=this.RMd(),sc=new Set,Wc=new Set,xd=new qi.GraphTransaction(2);try{if(xd.Fu(Rb),
Rb.Xr(1)){for(;Za.moveNext();){if(!Hb.ParagraphReader.rh(Za.iterator))continue;const Nd=Za.iterator.currentNode,$e=Hb.ParagraphReader.PCb(Nd);ue.a.isEnabled&&this.z4m(Nd,$e,ka);Cb.add(Nd.id.toString());this.wYi($e,Wc,Rb,sc)}this.p9i();const oe=this.mJl(Cb);0<oe.length&&this.d1n(oe,Cb,Rb,Wc);this.Lzb.forEach(Nd=>{this.Nrg(Nd)});this.Lzb.clear()}}finally{xd&&xd.dispose()}0==this.XHb.size&&this.rv.uPc&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");Cc.a.pZm(sc,
Wc,this.ud)}wYi(ka,Za,Cb,Rb){for(const sc of ka){ka=this.rv.Kq?!sc.Oc:sc.Oc;const Wc=sc.Tj.toString();this.vyj(Wc,sc.paragraph.id,sc.Oc);ka?Za.has(Wc)||Rb.add(Wc):Za.has(Wc)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",sc.Tj):(Za.add(Wc),this.Hkk(sc,Cb))}}d1n(ka,Za,Cb,Rb){const sc=this.c_l(ka);Cc.a.POk(sc);const Wc=new Set,xd=new Set;sc.forEach(Nd=>{Za.has(Nd.id.toString())||xd.has(Nd.id.toString())||(xd.add(Nd.id.toString()),Nd=Hb.ParagraphReader.PCb(Nd),
a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${Nd.length} CommentRangeObjects`),this.wYi(Nd,Rb,Cb,Wc))});const oe=[];ka.forEach(Nd=>{this.XHb.has(Nd)||oe.push(Nd)});0<oe.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${oe.length} Failed To Load on Retry: ${oe.join(",")}`),this.Kzb.logKpiFailure(Bi.a.U1b,"CommentsFailedToLoadOnRetry",{isInternal:!0},{name:Bi.a.T1b,isInternal:!0}))}c_l(ka){const Za=[];ka.forEach(Cb=>{if(Cb=this.u6e.o2h(Cb))Cb=rg.k(Cb),(Cb=this.ud.Db(Cb))&&Cb.Wi&&
Za.push(Cb)});return Za}Hkk(ka,Za){const Cb=this.ud.Db(ka.Tj);Za.Fi(Cb);40===Za.Xe&&Cb?(ka=this.jp.jFd(Za),({index:Za}=this.jp.Rke(ka)).returnValue?(this.jp.FWe(ka,Za),this.XHb.add(ka.objectId),rg.p(ka)||this.Lzb.add(ka.objectId),ka.Ff&&this.uif(ka)):this.UZc.add(ka)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",!Cb,!ka.Tj),39===Za.Xe||this.RMd())}mJl(ka){const Za=[],Cb=this.u6e.gJl();if(this.XHb.size===Cb.length)return Za;
Cb.forEach(Rb=>{!this.XHb.has(Rb)&&Cc.a.EMm(Rb,ka,this.u6e,this.ud)&&Za.push(Rb)});return Za}p9i(){for(let ka=0;ka<this.UZc.length;ka++){const Za=this.UZc.J(ka);let Cb;({index:Cb}=this.jp.Rke(Za)).returnValue?(this.jp.FWe(Za,Cb),rg.p(Za)||this.Lzb.add(Za.objectId),this.XHb.add(Za.objectId),Za.Ff&&this.uif(Za)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",Za.LOa,Za.l_a,Za.objectId,Za.Ff))}this.UZc.clear()}Pmk(ka,
Za){ka.Sn(Cb=>{if(11===Cb.Xe){var Rb=Cb.currentNode;const sc=Rb.ia(Sj.a.D6e,null),Wc=Rb.ia(Sj.a.B6e,null);Cb=!!sc&&0<sc.length;const xd=!!Wc&&0<Wc.length;Cb&&sc.forEach(Nd=>{const $e=this.ud.Db(Nd);$e&&!rg.s($e)&&Za.add(Nd,0)});xd&&Wc.forEach(Nd=>{Za.ob(Nd)&&Za.remove(Nd)});(Rb=Rb.ia(fd.a.mK,null))&&Rb.forEach(Nd=>{const $e=this.ud.Db(Nd);Hb.ParagraphReader.Yb($e)&&!this.wi.Ax.ob(Nd)&&this.wi.Ax.add(Nd,new Dj.a)});const oe=Za.keys;for(let Nd=0;Nd<oe.length;Nd++){Rb&&0<Za.J(oe.J(Nd))&&(this.wi.tU.ob(oe.J(Nd))||
this.wi.tU.add(oe.J(Nd),new Ta.a(new Oe.a)),Rb.forEach(hf=>{const bg=this.ud.Db(hf);Hb.ParagraphReader.Yb(bg)&&(this.wi.Ax.J(hf).uM||(this.wi.Ax.J(hf).uM=new Ta.a(new Oe.a)),this.wi.tU.J(oe.J(Nd)).add(hf),this.wi.Ax.J(hf).e1a=!0,this.wi.Ax.J(hf).uM.add(oe.J(Nd)))}));let $e;Za.Z($e=Za.keys.J(Nd),Za.J($e)+1)}return Cb||xd}return!0},null)}z4m(ka,Za,Cb){ka&&(this.ZLj(Za,Cb),this.wi.Ax.ob(ka.id)||this.wi.Ax.add(ka.id,new Dj.a),Cb.forEach((Rb,sc)=>{0<sc&&(this.wi.tU.ob(Rb)||this.wi.tU.add(Rb,new Ta.a(new Oe.a)),
this.wi.Ax.J(ka.id).uM||(this.wi.Ax.J(ka.id).uM=new Ta.a(new Oe.a)),this.wi.tU.J(Rb).add(ka.id),this.wi.Ax.J(ka.id).e1a=!0,this.wi.Ax.J(ka.id).uM.add(Rb));Cb.Z(Rb,sc+1);return!0}))}ZLj(ka,Za){ka.forEach(Cb=>{if(Cb.Oc){const Rb=this.ud.Db(Cb.Tj);Rb&&!rg.s(Rb)&&Za.Z(Cb.Tj,0)}else Za.ob(Cb.Tj)&&Za.remove(Cb.Tj)})}}Object(e.a)(on,"CommentModelBootLoader",null,[548]);var he=c(1030);class vh{constructor(ka){this.MCh=ka;this.Wrc=null;this.k3g=void 0;this.l3g=null;this.Iwc=new Map;this.nxe=new Map}XQn(){he.a.JRa(this.BMo.bind(this))}BMo(ka,
Za){const Cb=ka.id.toString();var Rb=ka.getValue(Ba.a.wE).toString();Za?(this.Iwc.delete(Cb),this.nxe.delete(Rb)):(this.Iwc.set(Cb,ka),this.nxe.set(Rb,ka));0===this.Iwc.size&&this.Wrc&&(ka=+new Date-+this.Wrc,this.Wrc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${ka}`));Za||this.k3g!==Rb||(Za=+new Date-+this.l3g,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${Za}`),
Rb=new H.a,Rb.durationMs=Za,this.MCh.logKpiFailure(Bi.a.rDd,"CommentFoundAfterDeeplinkAttempt",{isInternal:!0,additionalValues:Rb},{name:Bi.a.sCh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Rb}));this.Wrc||(this.Wrc=new Date)}set w8m(ka){this.k3g=ka;this.l3g=new Date;if(ka=this.eJl(ka))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${ka.id} present but failed to load`),ka=new H.a,this.MCh.logKpiFailure(Bi.a.rDd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:Bi.a.sCh,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ka})}gJl(){return[...this.Iwc.keys()]}eJl(ka){return this.nxe.get(ka)}o2h(ka){return this.Iwc.get(ka)}}Object(e.a)(vh,"CommentNodeTracker",null,[]);class zk{get contentType(){return 0}constructor(ka,Za,Cb,Rb,sc){this.c5f=ka;this.jp=Za;this.HZ=Cb;this.rK=Rb;this.wi=sc;this.c5f.e3i(this)}Lbj(ka,Za,Cb){0===Za?(Za=this.jp.xSc(ka),this.HZ.selectComment(Za?this.jp.Xx:this.jp.pD(ka),Object.assign(new Bd.a,{mR:Cb||Za,e9:1}))):this.rK.clearSelection()}Pjj(ka){return this.wi.yn||
this.jp.xSc(ka.contentId)?!0:this.jp.Cna(this.jp.pD(ka.contentId))}}Object(e.a)(zk,"CommentReviewSuggestionContentActor",null,[55]);class bp{get sqj(){return this.Odg}constructor(ka){this.BDd=ka;this.Odg=new Set([12])}initialize(){}nCi(ka){if(!Hb.ParagraphReader.Yb(ka.node))return[];ka=Hb.ParagraphReader.PCb(ka.node);return this.BDd.btm(ka)}LMi(){this.BDd.Uen()}}Object(e.a)(bp,"CommentReviewSuggestionContentProvider",null,[54]);var ll=c(62),Ej=c(107),Ok=c(265),sj=c(1560);class Te{constructor(){this.commentId=
null;this.iUc=!1}}Object(e.a)(Te,"CommentToSelectOnPaneLoadData",null,[]);class wf{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe,Nd,$e,hf,bg,Dg,Zh,zh){this.Jq=ka;this.jp=Za;this.rCa=Cb;this.HZ=Rb;this.QS=sc;this.wi=Wc;this.gLd=xd;this.rv=oe;this.V1b=Nd;this.X2a=$e;this.rc=hf;this.BGf=bg;this.tg=Dg;this.Gk=Zh;this.EVk=zh;this.rc.pa(Fe.a.UNb,ll.a.frame,this.Jq.UNb.bind(this.Jq));this.rc.pa(Fe.a.ZHd,ll.a.frame,this.ZHd.bind(this));this.rc.pa(Fe.a.p6e,ll.a.frame,this.Kfn.bind(this));this.rc.pa(Fe.a.QUk,ll.a.frame,
this.Jfn.bind(this));this.rc.pa(Fe.a.VJi,ll.a.frame,this.jkn.bind(this));this.rc.pa(Fe.a.vOh,ll.a.frame,this.Wgn.bind(this));this.rc.pa(Fe.a.zCh,ll.a.frame,this.rin.bind(this));this.rc.gb(Fe.a.s6e,ll.a.frame,this.kxk.bind(this),64);this.rc.gb(Fe.a.ADd,ll.a.frame,this.pSn.bind(this),64);this.rc.pa(th.a.selectComment,ll.a.frame,this.HZ.T5n.bind(this.HZ));this.rv.iRm&&this.rc.pa(th.a.p_d,ll.a.frame,this.p_d.bind(this));this.ekh(th.a.XHc,!1);this.ekh(th.a.jbf,!0);this.rc.gb(th.a.CDd,ll.a.frame,this.CDd.bind(this),
64);this.rc.pa(th.a.dDi,ll.a.frame,Ej.ActionManager.Kf);this.rv.Jyb&&this.rc.pa(th.a.S2e,ll.a.frame,this.IIk.bind(this));this.rc.pa(th.a.nMh,ll.a.frame,(zi,Ti)=>Ok.a.vga(Ti.Yj)&&Ok.a.l$b()?8:32)}get ik(){return this.jp}get mode(){return this.Jq.mode}get vA(){return this.Jq.vA}get Tz(){return this.rv.Kq}get Hi(){return this.X2a.value}get nb(){return this.BGf.value}get rK(){return this.Jq}ZHd(ka,Za,Cb,Rb,sc){return sc?sc?(ka=this.HZ.SMd(sc.NavigationId))&&this.HZ.TMd(ka,1)?32:8:(a.ULS.sendTraceTag(540160449,
327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}Kfn(ka,Za,Cb,Rb,sc){sc&&this.QS.ipa("OnCommentInit",Object.assign(Object.assign({},new sj.a),{JFa:()=>{var Wc=this.HZ.SMd(sc.NavigationId);if(Wc){var xd=this.HZ.TMd(Wc,1);xd?this.V1b.isVisible?(this.I4c(xd,1),this.tg.JC(ch.AFrame.xr)):this.ik.Cna(xd)?(Wc=rg.r(xd),this.HZ.selectComment(xd,Object.assign(Object.assign({},new Bd.a),{mR:!Wc,e9:1})),this.tg.JC(ch.AFrame.bM)):
(this.wi.yn||this.rc.processAction(Fe.a.vY,2),Cj.a.s2(y.AFrameworkApplication.oc,()=>{this.I4c(xd,1)},dj.a.I4c)):this.rc.processAction(Fe.a.K3a,2)}}}));return 32}Jfn(ka,Za,Cb,Rb,sc){sc?(ka=this.ik.sMc(sc))?this.rK.odc(ka.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.rK.odc(null);return 32}jkn(ka,Za,Cb,Rb,sc){if(sc){if(this.wi.jFb){for(ka=0;ka<sc.length;ka++)this.ik.gej(sc[ka]);this.Jq.FLb()}else this.ik.Mok(sc);this.CZm(sc)}return 32}Wgn(ka,
Za,Cb,Rb,sc){if(sc)if(this.wi.jFb){for(ka=0;ka<sc.length;ka++)this.ik.gej(sc[ka],!0);this.Jq.FLb()}else this.ik.nRk();return 32}rin(ka,Za,Cb,Rb,sc){this.Tz||this.wi.yn||this.rc.processAction(Fe.a.vY,2);if(sc){ka=null;if(!this.vA||2!==this.mode&&3!==this.mode){if(!sc)return 8;if(this.Tz)ka=this.Cul(sc);else for(Za=0;Za<sc.length&&(ka=this.ik.WZ(sc[Za].toString()),this.gLd.RWd&&(!ka||ka.done));Za++);}else ka=this.vA;this.I4c(ka,1);ka&&this.wi.PX&&this.tg.mg(this.Tz&&!this.wi.yn?ch.AFrame.bM:ch.AFrame.xr)}else a.ULS.sendTraceTag(5017933,
327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}kxk(ka,Za,Cb,Rb,sc){var Wc;if(!sc)return 32;if(sc&&0<sc.length){Za=ka=Cb=0;Rb=!1;for(let xd=0;xd<sc.length;xd++)sc[xd].toString()===(null===(Wc=this.vA)||void 0===Wc?void 0:Wc.objectId)?(Rb=!0,ka++):this.jp.GCf(sc[xd])&&(Rb&&0===Cb&&(Cb=xd,Za=ka),ka++);(Wc=this.jp.WZ(sc[Cb].toString()))?(this.rCa.Akc.pOf=Za+1,this.rCa.Akc.PHa=ka,this.rK.odc(Wc.id)):(sc=sc[Cb],this.Hi.Db(sc)?a.ULS.sendTraceTag(540148256,327,10,
`Comment Node with ObjectId ${sc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",sc.toString()))}return 32}pSn(){this.rK.odc(null);return 32}ekh(ka,Za){this.rc.pa(ka,ll.a.frame,(Cb,Rb,sc)=>this.Bgn(sc,Za))}p_d(ka,Za,Cb){2===Cb&&(ka=this.ik.Is.Qc(7),ka.Eb(this.ik.zIa),Za=new Fd.a,Za.lga(`${String.fromCodePoint(128077)} \n`),this.jp.nAb(cf.a.instance.hb.lb,void 0,Za),this.EVk.yTd(),ka.dispose());
return 32}Bgn(ka,Za=!1){if(2===ka)ka=this.ik.Is.Qc(15),ka.Eb(this.ik.zIa),this.Gk.he(()=>{this.XHc(Za)},"ECM:DAC"),ka.dispose();else if(1===ka&&!this.ik.c8b())return 2;return 32}XHc(ka=!1){this.Jq.mode=1;const Za=this.ik.mQ();for(const Cb of Za)Cb.er===ge.a.beingCreated||ka&&!Cb.done||Cb.Ff||this.Jq.deleteComment(Cb);this.tg.mg(ch.AFrame.$n);0<(ka?this.ik.mQ().filter(Cb=>Cb.done):this.ik.mQ()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",ka):
a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",ka)}CDd(ka,Za,Cb){if(2===Cb)if(ka=this.tg.currentScope.name,ka!==ch.AFrame.xr&&ka!==ch.AFrame.bM){!this.Tz||this.wi.yn?(this.wi.yn||this.rc.processAction(Fe.a.vY,2),this.tg.mg(ch.AFrame.xr)):this.tg.mg(ch.AFrame.bM);var Rb=this.nb.hb.lb;if(!Rb||!Rb.Qa)return 2;ka=Rb.Qa.cpBegin;Za=Rb.Qa.node;Rb=!!this.vA&&(ah.SelectionEditor.hm(Rb)||Rb.uH)&&rg.q(this.vA,Za,this.Hi,ka);ka=!!this.vA&&(2===this.mode||
3===this.mode);if(Rb||ka)return this.rK.Nbj(this.vA.id,!0),32;Rb=this.Tz&&!this.wi.yn?this.ik.p2h(!0,!0):null;this.rK.b6n(Rb)}else this.ik.Ts&&(this.Jq.v8b.Gbj(this.ik.Ts,!0),this.Jq.v8b.Ihb(null===(Rb=this.ik.Ts)||void 0===Rb?void 0:Rb.objectId)),this.tg.mg(ch.AFrame.$n);return 32}IIk(){return 4}CZm(ka){const Za=new Set;for(let Cb=0;Cb<ka.length;Cb++){const Rb=this.ik.sMc(ka[Cb]);Rb&&Za.add(Rb.Ff?Rb.Ff:Rb.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",Za.size.toString())}I4c(ka,
Za){ka?this.V1b&&!this.wi.PX?this.wi.Xdb=Object.assign(new Te,{commentId:ka.id,iUc:!1}):this.HZ.selectComment(ka,Object.assign(new Bd.a,{mR:!!Za,e9:Za})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}Cul(ka){let Za=null,Cb=!1;for(let Rb=0;Rb<ka.length;Rb++){const sc=ka[Rb].toString();if(this.ik.GCf(ka[Rb])){Za||(Za=sc);if(Cb&&this.ik.Ts.objectId!==sc)return this.ik.WZ(sc);Cb=Cb||!!this.ik.Ts&&this.ik.Ts.objectId===sc}}return Za?this.ik.WZ(Za):null}}Object(e.a)(wf,
"CommentsActionManager",null,[]);var Ge=c(203),pf=c(38),mm=c(158),Bo=c(1800),rl=c(544),cp=c(28),Co;(function(ka){ka[ka.d7o=0]="commentDeeplink";ka[ka.catchUpActivity=1]="catchUpActivity"})(Co||(Co={}));Object(e.b)("DeeplinkSource",Co);class Zm{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe,Nd,$e,hf,bg,Dg){this.ga=ka;this.Wh=Za;this.lv=Cb;this.Xte=Rb;this.nP=sc;this.Xbh=Wc;this.Vb=xd;this.wj=oe;this.ih=Nd;this.Ttb=$e;this.Zte=hf;this.JJ=bg;this.yQe=!1;this.Tfo=Zh=>{if(this.ih.Kq&&!this.wj.yn){const zh=new ra.a(0,
1,0,()=>{this.Tdj(Zh)},136,void 0,!0);y.AFrameworkApplication.oc.Wb(zh)}else this.Tdj(Zh)};Dg.execute(Zh=>{this.lI=Zh})}get jp(){return this.Wh}get nb(){return this.Ttb.value}oRh(ka){let Za=ka.er===ge.a.beingCreated?ka.Ty.draftId:ka.id,Cb=null;ka.Ff&&(Za=ka.Ff,Cb=()=>{this.Xbh.selectComment(ka.id)});this.nP.setInitialActiveContainerId(Za,0,Cb)}T5n(ka,Za,Cb,Rb,sc){if(!sc.commentId)return 2;ka=this.Wh.pD(sc.commentId);if(!ka)return 2;this.Ymb(ka,sc);return 32}Kbj(ka,Za){var Cb,Rb;if(ka){var sc=(null===
(Rb=null===(Cb=this.Wh.Xx)||void 0===Cb?void 0:Cb.Ty)||void 0===Rb?void 0:Rb.draftId)===ka?this.Wh.Xx:this.Wh.pD(ka);this.selectComment(sc,Za)}}selectComment(ka,Za){ka&&this.Ymb(ka,Za)}Hbj(ka,Za){var Cb=this.SMd(ka);Cb&&((Cb=this.TMd(Cb,0))?Za.pag?(this.wj.Xdb=Object.assign(new Te,{commentId:Cb.id,iUc:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.Ymb(Cb,Object.assign(new Bd.a,{commentId:Cb.id,e9:1,mR:!0,sSc:!0})),this.ih.Kq&&void 0!==ka&&null!==
ka&&this.oRh(Cb),Cj.a.s2(y.AFrameworkApplication.oc,()=>{this.Vb.mg(this.ih.Kq&&!this.wj.yn?ch.AFrame.bM:ch.AFrame.xr)},dj.a.obo),Ge.a.instance.Rf(pf.a.iLh,(new Date).getTime()),ka=this.ih.Kq?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",ka+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,ka,(new Date).getTime()-y.AFrameworkApplication.DW)):this.ga.processAction(Fe.a.K3a,2))}SMd(ka){let Za=null;var Cb=null;if(I.a.S$b(ka))Za=ka;else if(({Nu:Cb}=
v.d(ka)).returnValue&&(ka=Cb))return rl.a.comment in ka&&(Za=ka[rl.a.comment]),Za;Za||(Cb=Cb?Object.keys(Cb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",Cb?Cb.join(","):"Not Json."));return Za?Za.toString():null}TMd(ka,Za){const Cb=this.Wh.sMc(ka),Rb=0===Za;Rb&&this.JJ.logKpiUsage(Bi.a.rDd,0);if(!Cb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",ka,Za);const sc=new cp.a;sc.name="DeepLinkSource";sc.string=
Co[Za];this.JJ.logActivity("CommentDeeplinkNotFound",{dataFields:[sc]});Rb&&(Za=new H.a,Za.extendedProperties=new Map([["ErrorLevel","warning"]]),this.JJ.logKpiFailure(Bi.a.rDd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:Za}),this.Zte.w8m=ka)}return Cb}Tdj(ka){this.yQe=!0;this.nb.setSelection(ka);this.yQe=!1}Ymb(ka,Za){if(ka){this.wj.oJb&&(y.AFrameworkApplication.oc.Se(this.wj.oJb),this.wj.oJb=null);var Cb=this.Wh.Ts,Rb=this.jp.yqf(ka),sc=2===Za.e9,Wc={};sc&&(Wc.TriggeredByFindReplace=
!0);if(this.wj.yn)sc&&(Wc.PaneAlreadyOpen=!0),mm.UISurfaces.uu().then(xd=>{xd.setSelectedTaskPane(Bo.a.DDd);return null});else if(ka.er!==ge.a.beingCreated&&!this.jp.Cna(ka))this.wj.PX?this.ga.processAction(th.a.vY,2):this.wj.Xdb=Object.assign(new Te,{commentId:ka.id,iUc:Za.sSc}),sc&&(Wc.OpeningPaneToSelect=!0);else if(this.ih.Kq){const xd=Rb.er===ge.a.beingCreated;xd?this.nP.mSa(Rb.Ty.draftId,0,Za.mR):this.nP.mSa(Rb.id,0,Za.mR);!xd&&sc&&(Wc.SelectingDHC=!0)}Cj.a.s2(y.AFrameworkApplication.oc,()=>
{this.wj.PX&&(Za.mR&&this.Vb.mg(this.ih.Kq&&!this.wj.yn?ch.AFrame.bM:ch.AFrame.xr),Za.sSc&&this.jp.Cna(ka)||!Za.mR&&!Za.e9||this.Xbh.selectComment(ka.id))},dj.a.t8f);sc=this.jp.yqf(Cb);this.ih.Hta&&this.lI&&sc&&sc.id!==Rb.id&&this.lI.fireEvent(9,{comment:sc});this.Wh.selectComment(ka);this.ih.Hta&&this.lI&&ka.er===ge.a.normal&&!ka.Ff&&this.lI.fireEvent(8,{comment:ka});this.Xte.highlightComment(ka,!0);this.lv.gF(0,Rb,Cb);V.App.ya.updateCommandUI(!0);0<Object.keys(Wc).length&&this.JJ.hy(th.a.selectComment,
{customData:Wc})}}}Object(e.a)(Zm,"CommentSelectionActor",null,[547]);class Jq extends Vb.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new je.a,{T_:Jq.getTypeName(),B_:Jq.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(Jq,"CommentSmartReplySignal",Vb.a,[]);class dp extends Da.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=
0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new je.a,{T_:dp.getTypeName(),B_:dp.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(e.a)(dp,"SmartReply",Da.a,[]);var vb=c(858);class Fc{constructor(ka){this.Tqa=ka}P2b(ka,Za){return Object.assign(new vb.a,{parentPath:["Signal",Jq.getTypeName()],items:[Object.assign(new Ze.a,{body:Object.assign(new Jq,{commentId:ka,comment:Za})})]})}ZWf(ka){const Za=
new jb.a;if(ka&&ka.CommentId&&ka.ResultSets&&0<ka.ResultSets.length&&ka.ResultSets[0].Documents&&0<ka.ResultSets[0].Documents.length){for(const Cb of ka.ResultSets[0].Documents)Za.add(Cb.Caption);0<Za.count&&this.Tqa.ZWf(ka.CommentId,Za.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return dp.getTypeName()}}Object(e.a)(Fc,"BaseCommentSmartReplyProvider",null,[964]);class rd extends Fc{constructor(ka,Za,Cb,Rb){super(ka);this.Ze=Za;this.gD=
Cb;this.aQj=Rb}initialize(){this.gD.Bl().then(()=>{this.Ze.mb(this,Fc.prototype.getTypeName.call(this))})}invoke(ka,Za){this.gD.Bl().then(()=>{this.aQj.getAugLoopRuntimeManager().submitOperation(Object.assign(new eg.a,{operation:this.P2b(ka,Za)}))})}xD(ka,Za){ka&&ia.a.getTypeNameFor(ka.content)===this.getTypeName()&&Za===Ha.a.getTypeName()?this.ZWf(ka.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(e.a)(rd,"CommentSmartReplyProvider",Fc,[126]);var De=
c(29),kf=c(142),Ef=c(167),Se=c(556);class ad{constructor(ka,Za,Cb,Rb,sc,Wc){this.Na=ka;this.jd=Za;this.Ix=Cb;this.CGe=Rb;this.Zte=sc;this.PO=Wc;this.btb=!1;this.Zte.XQn();this.HSj=this.tYl();this.m0f&&(De.a.addHandler(window.self,bj.a.Wnh,()=>{this.btb=!0}),De.a.addHandler(window.self,bj.a.Xnh,()=>{this.btb=!1}))}get my(){return this.Ix?this.Ix.value:null}get sCa(){return this.CGe.value}get zIo(){return this.btb}get uPc(){return 0<this.HSj}get Kq(){return this.PO.Kq}get Cgl(){return!0}get IBk(){return Object(Se.c)()?
!1:this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoPopulateShareTUIComment",!1)}get OOb(){return this.jd.isFeatureEnabled(114)&&!Ef.App.xTc}get l7n(){return this.jd.isFeatureEnabled(34)&&this.Na.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get RUk(){return this.Na.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get m0f(){return this.Na.$("RecordCommentActionsInTypingIsEnabled")}get yKi(){return this.Na.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get WAb(){return this.Kq&&
!this.uPc&&!this.Na.kb("BootActivityNavigationId")&&F.a.Rt}get Jyb(){return this.jd.isFeatureEnabled(7)}get GAk(){return this.Na.$("AtMentionUserFloodGateCampaignIsEnabled")}get fVk(){return this.Na.$("CommentFriendlyTimestampsIsEnabled")}get vgl(){return this.Na.kb("DisabledChangeGatesInSharedComments")}get hLd(){return this.PO.hLd}get cOb(){return this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1)}get Zbg(){return this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",
!1)}get jY(){return this.Na.kb("PresenceUserId")}get removePersonalInformation(){return Ef.App.vne&&!!kf.PageReader.instance&&kf.PageReader.instance.Wfa(V.App.ya.jb.Wc).removePersonalInformation}get ofb(){return this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1)}get oSm(){return this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.SharedCommentsLivePersonaCardForWeb",!1)}get dAo(){return this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1)}get XVk(){return this.Na.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get LVk(){return this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",!1)}get iRm(){return this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.PO.contentNavigationApiEnabled}get brn(){return this.jd.isFeatureEnabled(85)}get Hta(){return this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",
!1)}get contentFilterApiEnabled(){return this.PO.contentFilterApiEnabled}get eVk(){return this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentFilterHintIconFix",!0)}tYl(){if(this.my&&this.sCa){const ka=new Vd.GraphIterator;ka.set(this.my);this.sCa.G3a(ka);let Za=0;39===ka.Xe&&(Za=ka.pq());return Za}return-1}}Object(e.a)(ad,"CommentsSettings",null,[]);var Xg=c(1593),Zg=c(1363);class Mg{constructor(ka){this.L9=ka}Nuh(ka,Za,Cb){const Rb=new Kl;Za=this.L9.SPa(Za)?Za.objectId:null;if(!Za)return Rb;
Za=ma.a.Gf(Za);if(Cb.contains(Za))return Rb.TQc=0,Rb.SQc=ka.length,Rb;for(let Wc=0,xd=ka.length;Wc<xd;Wc++){var sc=ka[Wc];Cb=rg.g(sc);sc=rg.d(sc);Cb&&Zg.a.kEh(Cb,Za)&&(Rb.TQc=Wc);if(sc&&Zg.a.kEh(sc,Za)){Rb.SQc=Wc;break}}return Rb}cqh(ka,Za,Cb){const Rb=-1===Za.TQc&&-1===Za.SQc,sc=-1<Za.TQc?Za.TQc:-1;Za=-1<Za.SQc?Za.SQc:ka.length;const Wc=!Rb&&sc===Za;var xd=!1;for(let oe=0;oe<ka.length;oe++){const Nd=ka[oe],$e=Uf.a(Nd);if(1!==$e&&2!==$e&&3!==$e)continue;this.L9.MRa(Nd);if(Rb||oe<sc||oe>Za)continue;
const hf=3===$e||2===$e&&-1!==Nd.className.indexOf(Ag.a.aPa),bg=Cb?1:2;this.hyk(oe,sc,Za,bg,hf,xd,Nd,Wc);if(oe!==Za||Wc)(xd=this.L9.l1a.J($e).J(bg))&&Nd.classList.add(xd),xd=hf}}hyk(ka,Za,Cb,Rb,sc,Wc,xd,oe){ka!==Za&&ka!==Cb||sc||Wc||((ka=this.L9.Nec.J(Rb))&&xd.classList.add(ka),oe&&xd.classList.add(Ag.a.zWf))}}Object(e.a)(Mg,"DefaultHighlightChangeHandler",null,[546]);var Si;(function(ka){ka[ka.success=0]="success";ka[ka.noSelection=1]="noSelection";ka[ka.invalidContent=2]="invalidContent"})(Si||
(Si={}));Object(e.b)("AnchorCreationResult",Si);var ii=c(70),Hh=c(24),Ui=c(296),mc=c(249),ml=c(1201);class hl{}Object(e.a)(hl,"EditorAnchorInfo",null,[566]);class Kd{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe){this.HQm=ka;this.BGf=Za;this.ik=Cb;this.w1a=Rb;this.rCa=sc;this.vo=Wc;this.QS=xd;this.rv=oe;this.Obh=null;this.w1a.Q4a(this.rCa);this.rv.contentFilterApiEnabled&&(this.QS.Iha("OnCommentPaneOpen",this.vOo.bind(this)),this.QS.Iha("OnCommentPaneClose",this.uOo.bind(this)),this.QS.Iha("OnContentFilterUpdate",
this.dZc.bind(this)))}get nb(){return this.BGf.value}get Hi(){return this.HQm.value}initialize(){}Zqm(ka){this.Obh=ka}dispose(){}Ihb(ka){this.rCa.Ihb(ka)}u8b(ka){this.rCa.u8b(ka)}highlightComment(ka){this.Gbj(ka,!1);this.rCa.Ihb(ka.objectId)}mlc(ka){this.rCa.mlc(ka)}MDa(ka){return this.rCa.MDa(ka)}dZc(){this.ipe("OnContentFilterUpdate")}vOo(){this.ipe("OnCommentPaneOpen")}uOo(){this.ipe("OnCommentPaneClose")}ipe(ka){const Za=[],Cb=new Set;for(const sc of this.ik.mQ())if(!sc.Ff&&sc.er!==ge.a.beingCreated&&
!this.ik.rK.cxh(ka,sc)){var Rb=this.oZl(sc);Cb.has(Rb.id.toString())||(Cb.add(Rb.id.toString()),(Rb=Rb.Ee(ii.InteractiveViewManager.instance.vd.jc))&&Za.push(Rb))}Za.forEach(sc=>{this.w1a.nlc(sc)})}oZl(ka){var Za,Cb;const Rb=null===(Za=this.Hi)||void 0===Za?void 0:Za.Db(ka.objectId);if(!Rb)return null;ka=rg.k(Rb);Za=null===(Cb=this.Hi)||void 0===Cb?void 0:Cb.Db(ka);return Cc.a.P9h(Za)}Gbj(ka,Za){if(!ka.er){var Cb=this.Hi.Db(ma.a.Gf(ka.objectId)),Rb=Yg.a.Iaa(Cb,this.Hi,!0);Cb=Yg.a.Iaa(Cb,this.Hi,!1);
if(Rb&&Cb){const sc=Rb.Kb.paragraph;Rb=Rb.Kb.cp;if(this.MJm(sc,Rb))V.App.ya.updateCommandUI(!0);else{Rb=Hh.SelectionFactory.te(sc,Rb);Cb=Nc.a.Tc(Cb.Kb.paragraph,Cb.Kb.cp);if(Kd.Zf.i8(Rb.Qa)||Kd.Zf.i8(Cb))ka.K$b=!0,ka.D3a();ka=Za?Hh.SelectionFactory.Vz(Rb,Cb):Rb;this.Obh(ka)}}}}aRk(){this.rCa.u8b(null);this.rCa.Ihb(null)}l1k(){const ka=new hl;return{returnValue:Si.success,anchor:ka}}MJm(ka,Za){if(ka&&Object($k.a)(ml.PageView,this.vo.vd)){var Cb=ka.Ee(this.vo.vd.jc);ka=document.getElementById(nd.AppFrame.MTa);
if(Cb&&ka){Za=Ui.a.Gq(Cb,Za);if(!Za)return!1;Za=Za.y;Cb=Sys.UI.DomElement.getBounds(ka).y;ka=ka.offsetHeight;if(Za>=Cb&&Za<=Cb+ka)return!0}}return!1}static get Zf(){return mc.a.instance}static getInstance(){return Kd.Sl()}static Sl(){return Kd._instance||(Kd._instance=new Kd(new U.a(()=>V.App.ya.jb.Wc.ud),new U.a(()=>cf.a.instance),K.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),K.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,K.a.instance.resolve("WordEditor.Comments.CommentHintActor"),
ii.InteractiveViewManager.instance,K.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),K.a.instance.resolve("WordEditor.Comments.CommentsSettings")))}}Kd._instance=null;Object(e.a)(Kd,"EditorCommentHintManager",null,[541,542,9]);var Vi=c(1996),ph=c(378),ji=c(1151);class Gd extends Cn.a{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe,Nd,$e,hf,bg,Dg,Zh,zh,zi,Ti,Il,mi,pm,po,$m,pn,pp,Vo,Xn){super(xd);this.Nh=Za;this.Ttb=oe;this.o6e=$e;this.Uqa=hf;this.epc=bg;this.nP=Dg;this.ih=Zh;this.Mp=zh;this.gSb=
zi;this.wj=Ti;this.t5=Il;this.ge=pm;this.JJ=po;this.US=pn;this.tDd=pp;this.MDo=Xn;this.iji=this.Kdh=this.yVa=null;this.Pkb=()=>{this.Aqa.Lna()&&(this.W2i(this.Aqa.xc),this.Aqa.bgc(this.Pkb))};this.GXc=Lj=>{2===Lj.mode?this.VC=1:1===Lj.mode&&(this.VC=0);this.Wh.Xx&&0===this.VC?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.Wh.Xx.Ty.sessionType):this.wj.PX&&(this.Tz||this.j1.isVisible)&&this.FLb()};this.Odn=()=>{this.wj.jFb?
this.mode=0:this.VC=0};this.bGa=(Lj,Mn)=>{var qp;Lj=Mn.sl.lb;if((this.Tz||this.Uba&&this.Uba.isVisible)&&!this.gSb.yQe&&Lj){Mn=ah.SelectionEditor.hm(Lj);var Hk=Lj.uH;null!==(qp=this.iji)&&void 0!==qp&&qp.xaa||(this.jp||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),qp=this.jp&&this.jp.zib(this.ga,!1),1!==this.mode||Mn&&!Hk||!qp?this.epc.yTd():this.d5k(Lj));2!==this.mode&&3!==this.mode&&this.ih.RUk&&this.RGo(Lj,Mn,Hk)}};this.LOk=()=>{if(this.ik&&this.ik.Xx&&!V.App.bzf){var Lj=
this.ik.Xx;Lj.Ty.sessionType!==Vi.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${Lj.er} present on app shutdown`),(Lj=Cc.a.kNl(Lj))&&this.JJ.logKpiFailure(Lj,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:Bi.a.T1b,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.Ydn=()=>{if(this.wj.PX){var Lj=()=>!0;this.Tz&&!this.wj.yn&&(Lj=Mn=>this.jp.Cna(Mn));Lj=this.jp.Jlf(Lj);this.FLb(Lj)}};this.ga=xd;this.VC=1===this.ga.mode?0:1;this.j1=sc;this.Wh=Rb;this.a$=
Wc;this.Vb=Nd;this.YPn();Cb.P4a(this.Uqa);this.nb.gx(this.bGa);ka.CWR(()=>ka.result.zA.tMa(this.Odn));y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.lYa(this.GXc);this.t5.Iha("OnAfterTrackChangeMarkupViewChange",this.Ydn);y.AFrameworkApplication.uJ&&y.AFrameworkApplication.uJ(this.LOk);Vo.execute(Lj=>{this.lI=Lj});$m.execute(Lj=>{Lj.RZk.execute(Mn=>{this.iji=Mn})})}YPn(){this.Aqa&&(this.Aqa.Lna()?this.W2i(this.Aqa.xc):this.Aqa.p_b(this.Pkb))}W2i(ka){ka.Xka(()=>{this.evo()})}get Aqa(){var ka;
return null===(ka=Ef.App.Hn)||void 0===ka?void 0:ka.jb}get nb(){return this.Ttb.value}get ik(){return this.Wh}get jp(){return this.Wh}get Tz(){return this.ih.Kq}get gKi(){return!0}get ycj(){return!0}get A8b(){return this.yVa}set A8b(ka){this.yVa=ka}get mode(){return super.mode}set mode(ka){ka!==this.VC&&(super.mode=ka,this.D3a())}get vA(){return this.model&&this.model.Ts?this.model.Ts.Ff?this.model.pD(this.model.Ts.Ff):this.model.Ts:null}get Hi(){return this.Nh.value}get hlj(){return!1}get removePersonalInformation(){return this.ih.removePersonalInformation}FLb(ka=
null,Za=null){const Cb=this.jp,Rb=!this.VC,sc=this.Uba.cVk,Wc=Cb.lPd();sc.ojg(Wc?5:1,Rb);ka=this.ih.cOb&&ka?ka:Cb.dmf(this.ih.cOb&&this.Tz&&!this.wj.yn);sc.f7n(ka,Wc,Cb.vUa);this.Uig();Za&&a.ULS.sendTraceTag(572281362,327,50,Za)}eZc(ka,Za,Cb=!1){this.wj.yn?this.nP.WAj():Za?this.nP.deleteContainer(ka.er===ge.a.beingCreated?ka.Ty.draftId:ka.id,0,Cb):this.fIn(ka)}fIn(ka){const {WBo:Za}=this.Wh.GSl(ka),Cb=this.a$.MDa(ka.objectId);Cb&&this.nP.addContainer(ka.id,Cb.parentElement,0,Za)}Rbj(ka){const Za=
this.vA;this.K4c();this.Uqa.gF(0,this.Wh.Ts,Za);this.Tz&&this.Wh.Ts&&!this.wj.yn&&this.nP.mSa(this.Wh.Ts.id,0,1===ka)}c6n(){const ka=this.vA;this.L4c();this.Uqa.gF(0,this.Wh.Ts,ka);this.Tz&&this.Wh.Ts&&!this.wj.yn&&this.nP.mSa(this.Wh.Ts.id,0,!1)}mlc(ka){this.a$.mlc(ka)}Vll(ka,Za){this.nP.addContainer(ka,null,0,Za)}Yun(ka){this.nP.wVi(ka)}Xll(ka,Za){this.nP.g3c(ka,Za,0)}INo(){this.nP.j0e()}Jbj(ka){if(ka&&(2!==this.mode||ka.er===ge.a.beingCreated)){var Za=this.Wh.Ts;Za!==ka&&(this.Wh.selectComment(ka),
this.j1.isVisible?this.wj.PX?(this.j1.selectComment(ka,1),this.Bja.selectComment(ka.id)):this.wj.Xdb=Object.assign(new Te,{commentId:ka.id,iUc:!1}):this.Tz&&!ka.done&&(this.Nbj(ka.id,!1),this.Bja.selectComment(ka.id)),!this.j1.isVisible&&this.Tz&&ka.done||(this.v8b.Ihb(ka.objectId),this.Uqa.gF(0,this.vA,Za)))}}eRc(){}cff(){this.wj.jFb=!1}ayb(ka){this.ih.yKi&&this.Wh.Ts&&this.clearSelection();super.ayb(ka);this.JJ.logKpiUsage(Bi.a.z6e,0);this.Uig();if(this.Tz){const Za=this.Wh.W8l(ka.draftId);this.Vll(ka.draftId,
Za)}}addReply(ka,Za){this.JJ.logKpiUsage(Bi.a.FDd,0);super.addReply(ka,Za)}Ita(ka){this.Tz&&null!=ka.Ty&&this.Wh.b4i(ka.Ty.draftId);super.Ita(ka);this.a$.Ihb(ka.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",rg.a(ka));this.JJ.logKpiUsage(Bi.a.qCh,0);this.QOk(ka);Cc.a.nVo(ka,this.Hi,this.JJ);this.JJ.hy(th.a.pCh,{succeeded:!0,customData:{actionType:ka.Ff?Vi.a.reply:Vi.a.create}})}Zdb(ka){super.Zdb(ka);this.JJ.hy(th.a.pCh,{succeeded:!0,customData:{actionType:Vi.a.edit}})}QOk(ka){if(ka.Ff){var Za=
this.Wh.yqf(ka);if(Za.$Cc&&Za.aDc){var Cb=this.Hi.Db(ma.a.Gf(Za.aDc));Za=Za.aDc===Za.$Cc?null:this.Hi.Db(ma.a.Gf(Za.$Cc));Cc.a.Hog(Cb,ka,!0);Cc.a.Hog(Za,ka,!1)}}}YHc(ka){super.YHc(ka);this.vA&&this.vA.id===ka.id&&(super.clearSelection(),this.Tz&&this.nP.E1b());if(this.Tz)if(rg.r(ka)){var Za=[];let Cb=null;for(const Rb of this.model.mQ())Rb!==ka&&(Rb.Ff===ka.Ff&&Za.push(Rb),Rb.id===ka.Ff&&(Cb=Rb));Cb&&Cb.id&&Cb.objectId&&!Cb.done&&this.jp.jG(Cb.objectId)&&!this.jp.jWi(Cb.objectId)&&!Za.length&&this.eZc(Cb,
!0)}else Za=ka.er===ge.a.beingCreated,ka.done||this.eZc(ka,!0),Za&&this.Wh.b4i(ka.Ty.draftId)}editComment(ka,Za){1===this.mode&&ka&&(this.Wh.eJc(ka,Za),Vi.a.edit===Za.sessionType&&this.JJ.logKpiUsage(Bi.a.vCh,0),this.ih.OOb&&3!==Vi.a.Iof(Za.sessionType)&&this.gSb.selectComment(ka,Object.assign(new Bd.a,{mR:!1,e9:0})))}wde(ka){this.Tz&&!this.wj.yn||super.wde(ka)}deleteComment(ka){ka.er!==ge.a.beingCreated&&this.jp.zMh(ma.a.Gf(ka.objectId));this.yVa&&this.yVa.id===ka.id&&(this.Wh.Ts&&this.yVa.id===
this.Wh.Ts.id?this.yVa=null:this.Uqa.e5e());!this.Wh.Ts||this.Wh.Ts.id!==ka.id&&this.Wh.Ts.Ff!==ka.id?this.Wh.Ts&&this.Uqa.gF(0,this.Wh.Ts,null):void 0===ka.Ff||null===ka.Ff?this.clearSelection():this.Wh.selectComment(this.Wh.pD(ka.Ff));ka.K$b&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",rg.a(ka));super.deleteComment(ka);a.ULS.sendTraceTag(50426377,327,50,`${rg.a(ka)} deleted by user action. DurableId: ${ka.l_a}`)}szb(ka,Za){super.szb(ka,Za);this.Tz&&
!this.wj.yn&&Za&&(this.Wh.Ts&&this.Wh.Ts.id===ka.id&&this.clearSelection(),this.A8b&&this.A8b.id===ka.id&&this.Uqa.e5e())}b6n(ka=null){(ka=this.jp.cJl(ka))?this.gSb.selectComment(ka,Object.assign(new Bd.a,{mR:!0,e9:1})):this.Rbj(1)}d5k(ka){var Za,Cb=this.Aqa.xc;if(Cb){var Rb=ka.Qa.node,sc=null===(Za=this.MDo.instance)||void 0===Za?void 0:Za.FOc(Rb);if(sc)for(const Wc of Cb.fOa(sc))if(Wc&&Wc instanceof ph.a&&(Za=Wc,Cb=ji.a.DIh(Za),this.epc.Fme=this.btl(Rb,ka),sc=this.TJk(Cb),null!==sc)){if(ka=this.epc.Ssl(Cb,
sc))Cb.Lva[sc].appendChild(ka),Za.mz(ka);break}}}btl(ka,Za){let Cb;for(const Rb of ka.DG)if(Rb&&Rb){Cb=Rb;break}ka=Za.Qa.zj;Za=!(null===Cb||void 0===Cb||!Cb.Pn)&&0<Cb.Pn.length;return 0>ka||!Za||null===Cb||void 0===Cb||!Cb.eop?null:Ui.a.AZ(ka,Cb,!1,!1)}TJk(ka){var Za;const Cb=null===(Za=this.epc.Fme)||void 0===Za?void 0:Za.y;for(const [Rb,sc]of ka.cba.entries())if(ka=Cb-sc.y,-2<=ka&&ka<sc.height+2)return Rb;return null}D3a(){V.App.thb=2===this.mode||3===this.mode;1!==this.mode&&this.epc.yTd()}RGo(ka,
Za,Cb){const Rb=this.Vb.currentScope;let sc=null;if(Za||Cb){Za=ka.Qa.cpBegin;ka=ka.Qa.node;if(this.vA&&rg.q(this.vA,ka,this.Hi,Za))return;sc=this.eXl(ka,Za)}sc?!this.Tz||this.wj.yn?Cj.a.s2(y.AFrameworkApplication.oc,()=>{this.Jbj(sc)},dj.a.V5n):this.Jbj(sc):!this.Wh.Ts||Rb&&Rb.name===ch.AFrame.bM||this.clearSelection()}eXl(ka,Za){let Cb=null;const Rb=this.model.mQ();for(let sc=Rb.length-1;0<=sc;sc--){const Wc=Rb[sc];if(Wc.objectId&&!(Wc.Ff||this.Tz&&!this.Uba.isVisible&&Wc.done)&&rg.q(Wc,ka,this.Hi,
Za)){Cb=Wc;break}}return Cb}selectComment(ka,Za=1){this.gSb.Kbj(ka,Object.assign(new Bd.a,{mR:1===Za,e9:Za}))}Nbj(ka,Za){const Cb=this.Wh.pD(ka);Cb?this.Tz&&!rg.r(Cb)&&Cb.er!==ge.a.beingCreated&&this.nP.mSa(ka,0,Za):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const ka=this.model.Ts;this.ih.Hta&&this.lI&&ka&&this.lI.fireEvent(9,{comment:ka});super.clearSelection();this.Uqa.gF(1,ka,ka);this.Tz&&ka&&this.nP.E1b()}pJm(){var ka;return 500>(null===(ka=this.Kdh)||
void 0===ka?void 0:ka.ri)}odc(ka,Za=1){if(!this.ih.yKi||!this.Wh.Xx){var Cb=this.Wh.pD(ka),Rb=null;Cb||(Rb=this.yVa);var sc=this.pJm(),Wc=!1;1===Za&&this.Bja&&(sc?Wc=!0:this.Bja.highlightComment(ka));ka?Cb?sc?Wc=!0:this.a$.u8b(Cb.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.a$.u8b(null);Cb?sc?Wc=!0:(this.yVa=Cb,this.Uqa.gF(2,Cb,Rb)):(this.yVa=null,this.Uqa.gF(3,null,Rb));Wc&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}evo(){this.ge&&
(this.Kdh=this.ge.eg("UserAction","StartScrollDetectionStopwatch"))}notify(ka,Za){this.Mp.sendNotification(ka,Za)}Uig(){this.tDd.onContentChanged()}cxh(ka,Za){var Cb,Rb;switch(ka){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.Aro(Za);case "OnContentFilterUpdate":return!(null===(Rb=(Cb=this.tDd).isContentInFilterUpdateDiff)||void 0===Rb?0:Rb.call(Cb,Za.id));default:return!0}}Aro(ka){return this.ih.eVk?!ka.done&&this.jp.Cna(ka)===this.tDd.isContentInFilteredContent(ka.id):this.jp.Cna(ka)===
this.tDd.isContentInFilteredContent(ka.id)}static getInstance(){return Gd.Sl()}static Sl(){Gd.Kg||(Gd.Kg=new Gd(V.App.cna(),new U.a(()=>V.App.ya.jb.Wc.ud),K.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,K.a.instance.resolve("Common.Comments.ICommentModel"),K.a.instance.resolve("Common.Comments.ICommentPane"),Kd.getInstance(),y.AFrameworkApplication.xa,new U.a(()=>cf.a.instance),bh.FocusManager.instance(),K.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),
K.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),K.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),K.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),K.a.instance.resolve("WordEditor.Comments.CommentsSettings"),K.a.instance.resolve("Common.Utils.IAriaNotifier"),K.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),K.a.instance.resolve("WordEditor.Comments.CommentsState"),K.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),
Ef.App.Hn.jb.xc,V.App.ya.xq,K.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),K.a.instance.Sa("WordEditor.HeaderFooter.HeaderFooterControlOwner"),K.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),K.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),K.a.instance.Sa("WordEditor.Extension.RichApiEventManager"),K.a.instance.Sa("WordEditor.Indicator.TopLevelOutlineElementCache")),Gd.Kg.wNb=!0);return Gd.Kg}}Gd.Kg=null;Object(e.a)(Gd,
"EditorCommentManager",Cn.a,[543,544,545,9]);var sn=c(1739);class fk{constructor(ka,Za,Cb,Rb){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ka;this.body=Za;this.confirmButton=Cb;this.cancelButton=Rb}}Object(e.a)(fk,"ViewContainerModalDialogStrings",null,[]);var me=c(337);c(1471);class Ad{constructor(ka,Za){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=
ka;this.canvasContextId=Za}}Object(e.a)(Ad,"CommentUIAction",null,[]);var Wi=c(1044);class cm{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe,Nd,$e,hf,bg,Dg,Zh,zh,zi,Ti){this.ga=ka;this.hg=Za;this.$d=Cb;this.Vb=Rb;this.Zo=sc;this.Fh=Wc;this.k2=xd;this.Tqa=oe;this.xwd=Nd;this.TUe=$e;this.Gb=hf;this.nP=bg;this.ih=Dg;this.wj=Zh;this.gSb=zh;this.t5=zi;this.yja=Ti;this.Xte=this.ej=null;this.Sbh=this.uHg=!1;this.pyc=null;this.cpo=(Il,mi,pm)=>2!==pm||this.wj.PX?1===pm?32:2:(this.t5.ipa("OnCommentInit",Object.assign(new sj.a,
{JFa:()=>{this.ga.processAction(Fe.a.vY,2)}})),32);this.jmi=(Il,mi,pm)=>1!==pm||this.wj.PX?2:8;this.zjk=(Il,mi,pm)=>{if(1===pm)return!this.zib()||this.Jcb?8:this.wj.PX?2:32;if(!this.wj.PX)return this.Jcb=!0,this.t5.ipa("OnCommentInit",Object.assign(new sj.a,{JFa:()=>{this.Kq||this.wj.yn||this.ga.processAction(Fe.a.vY,2)}})),32;this.Kq||this.wj.yn||this.ga.processAction(Fe.a.vY,2);(this.Kq||this.wj.yn)&&this.Vb.mg(this.wj.yn?ch.AFrame.xr:ch.AFrame.bM);return 2};this.Gbl=(Il,mi,pm)=>1===pm&&Tc.SessionStatusManager.instance.xj?
8:2;this.dgl=(Il,mi,pm,po)=>1!==po||(this.Kq||this.isVisible)&&this.ej.model.Ts?Il||this.ej.model.Ts?32:8:8;this.Fhb=(Il,mi,pm,po,$m)=>{if(1===pm||!this.wj.yn)return 32;if(!this.Kq&&2===pm&&(2===this.ej.mode||3===this.ej.mode))return $m=new fk(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.xwd.invokeModalConfirmationDialog(()=>{this.$fn(Il,mi,pm,po)},()=>{this.dfn()},$m),32;this.ATd();
if(this.Kq)return 32;$m&&this.mRh();return 32};this.oLb=(Il,mi,pm,po,$m)=>{if(1===pm)return 32;$m[me.a.On]=this.isVisible;return 32};this.fnc=this.h1k()}get isVisible(){return this.wj.yn}get Jcb(){return this.uHg}set Jcb(ka){this.uHg=ka}get djo(){return"SharedCommentsTaskPaneProps"}get u_c(){return null}get WJi(){return null}get zE(){return this.Zo}get Uba(){return null}get cVk(){return this.Tqa}get Kq(){try{return this.ih.Kq}catch(ka){return!1}}b8h(){return new uh(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,
y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}h1k(){const ka=new Fm.a,Za=new Ad(Fe.a.newComment,ll.a.frame);Za.preCallback=this.zjk;const Cb=new Ad(th.a.kOf,ll.a.frame),Rb=new Ad(th.a.LXf,ll.a.frame),sc=new Ad(th.a.deleteComment,ll.a.frame);sc.preCallback=this.Gbl;sc.postCallback=this.dgl;this.Kq&&(Cb.preCallback=this.jmi,Rb.preCallback=this.jmi);const Wc=new Ad(Fe.a.vY,ll.a.frame);Wc.preCallback=this.cpo;ka.Z(6,Wc);ka.Z(0,Za);ka.Z(1,Cb);ka.Z(2,Rb);ka.Z(3,sc);return ka}sij(ka){this.Sbh||
(this.Vek=this.cQd(),this.k2.lNa(),this.rio(),this.nio(ka),this.Sbh=!0)}nio(ka){this.ej=ka;this.Xte=ka.v8b;this.ej.sTh=this.Tqa}initialize(ka){this.sij(ka);this.Ub()}zxf(){this.pyc&&this.Vb.mg(ch.AFrame.xr);this.Jcb&&!this.Kq?(this.ga.processAction(Fe.a.newComment,2),this.Jcb=!1):this.wj.Xdb&&Cj.a.s2(y.AFrameworkApplication.oc,()=>{const ka=this.wj.Xdb.commentId,Za=this.wj.Xdb.iUc;this.ga.Rb(th.a.selectComment,2,Object.assign(new Bd.a,{commentId:ka,e9:1,mR:!0,sSc:Za}));Za&&(Cj.a.s2(y.AFrameworkApplication.oc,
()=>{this.Vb.mg(ch.AFrame.xr)},dj.a.t8f),Ge.a.instance.Rf(pf.a.iLh,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.DW);this.wj.Xdb=null},dj.a.U5n)}dispose(){}B4(){}selectComment(){this.isVisible||this.Kq||this.Plj();this.Fh.updateCommandUI(!0)}Ub(){this.ga.pa(Fe.a.Fhb,ll.a.frame,this.Fhb);this.ga.gb(Fe.a.oLb,ll.a.frame,this.oLb,96)}D3a(){-1!==this.ej.mode&&(this.ej.mode||this.mRh())}mRh(){const ka=
this.ej,Za=ka.jp,Cb=Za.lPd(),Rb=Za.dmf(this.ih.cOb&&this.ih.Kq&&!this.wj.yn);this.Tqa.e7n(Rb.length,Cb,!ka.mode,Cb?5:1);this.Tqa.C7n(Rb,Za.vUa)}rio(){const ka=this.Vb.fe(ch.AFrame.xr);ka.parent=ch.AFrame.qp;ka.zH=!0;ka.Q3c=!0;ka.GTa=!0;ka.iYa((Za,Cb)=>{ke.a.bxh(Cb.name)&&(this.wj.oJb=Cj.a.s2(this.Gb,()=>{Cb.name!==ch.AFrame.bM&&2!==this.ej.mode&&3!==this.ej.mode&&(this.ej.clearSelection(),this.Fh.updateCommandUI(!0));this.wj.oJb=null},dj.a.Pfn))});this.Zo.GS(ch.AFrame.xr);if(this.ih.Jyb)for(const Za of rg.t)ka.bindAction(pd.KeyInputManager.hG(Za),
th.a.S2e)}bbo(){this.pyc&&this.TUe.Lyl()}Zyh(){this.DXj&&this.bbo()}$fn(ka,Za,Cb,Rb){const sc=this.ej,Wc=sc.jp.Xx;Wc&&Wc.Ty?sc.o6e.endCommentSession(Wc.Ty.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.Fhb(ka,Za,Cb,Rb,!0);Cj.a.s2(this.Gb,()=>{this.Fh.updateCommandUI(!0)},dj.a.Y1n)}dfn(){this.pyc&&this.Vb.mg(ch.AFrame.xr);this.Fh.updateCommandUI(!0)}AGa(ka){ka.Xq(this.Vb.dW);ka.Xq(this.Vb.eW)}UNb(ka,Za,Cb){if(1===Cb)return 32;this.Plj();return 32}Plj(){this.isVisible||
(this.wj.PX?(this.ahl(),this.wj.yn=!0,this.t5.nae(),this.Vb.iCc(ch.AFrame.xr),this.Kq&&this.ih.cOb&&this.ej.FLb(this.ej.model.Jlf(()=>!0)),this.DXj=!0,mm.UISurfaces.uu().then(ka=>{ka.showTaskPane(Bo.a.DDd,this.Vek);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.ej.odc(null),this.Fh.updateCommandUI(!0),this.AGa(this.Vb.fe(ch.AFrame.xr)),this.t5.ipa("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.t5.ipa("OnCommentInit",
Object.assign(new sj.a,{JFa:()=>{this.wj.yn||this.ga.processAction(Fe.a.vY,2)}})))}ahl(){this.ga.Rb(th.a.p7,2,null);this.ga.Rb(th.a.iT,2,null)}zib(){return this.yja.zib(this.ga,!1)}ayb(){}show(){this.isVisible||this.ga.processAction(Fe.a.vY,2)}editComment(){return 2}ATd(){this.ej.paneClosing();this.wj.yn=!1;if(this.Kq&&this.ih.cOb){const Za=this.ej.model;this.ej.FLb(Za.Jlf(Cb=>Za.Cna(Cb)))}var ka=bh.FocusManager.instance();ka.currentScope&&ka.currentScope.name===ch.AFrame.xr&&ka.mg(this.Kq&&(2===
this.ej.mode||3===this.ej.mode||this.ej.ik.Ts)?ch.AFrame.bM:ka.fT);this.Zo.nx(ch.AFrame.xr);this.Vb.LHc(ch.AFrame.xr);mm.UISurfaces.uu().then(Za=>{Za.hideTaskPane(Bo.a.DDd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.Kq&&(ka=this.ej.model.Ts)&&this.JMo(ka);this.t5.ipa("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}JMo(ka){ka.done?this.ej.clearSelection():this.gSb.oRh(ka)}Vnn(ka=null){this.TUe.Mhj(3);this.zxf();
if(ka){this.Zyh();De.a.g1f(ka,[bj.a.contextMenu]);const Za=this.Vb.fe(ch.AFrame.xr);this.hg.XZb(ch.AFrame.xr,ka,Za.GTa)}}Dln(ka){this.Zo.nI(ch.AFrame.xr);1!==ka&&Cj.a.s2(y.AFrameworkApplication.oc,()=>{this.Vb.JC(ch.AFrame.xr)},dj.a.t8f)}onTaskPaneClose(){this.wj.PX&&this.TUe.Mhj(1)}cQd(){const ka={type:this.djo,w9o:this.Zyh};return Object.assign(new Wi.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:ka,hideHeader:!1,width:300,location:2,onOpen:Za=>{this.pyc=Za;this.Vnn(Za);this.nP.sgg(!0)},
onClose:()=>{this.pyc=null;this.ga.Rb(Fe.a.Fhb,2,!0);this.Fh.updateCommandUI(!0);this.onTaskPaneClose();this.nP.sgg(!1)},onShow:Za=>{this.Dln(Za)}})}vY(){return 32}}Object(e.a)(cm,"OfficeSharedCommentPane",null,[9,533,534]);var bq=c(1656),Fn=c(141);class Jh{constructor(ka,Za){this.containerType="full-pane";this.identifier=null;this.ga=ka;this.identifier=Za}openView(){this.ga.processAction(Fe.a.UNb,2)}closeView(){this.ga.Rb(Fe.a.Fhb,2,!0)}invokeModalConfirmationDialog(ka,Za,Cb){const Rb=new Fn.StandardDialog;
Cb&&Cb.title&&Cb.body&&Cb.confirmButton&&Cb.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),Cb=new fk("","","",""));Rb.zd=1;Rb.Ge(1,Cb.confirmButton);Rb.Ge(0,Cb.cancelButton);Rb.Au(Cb.title,Cb.body,1,sc=>{1===sc?ka():Za()})}}Object(e.a)(Jh,"ViewContainerAPI",null,[490,491]);class Lc{constructor(ka,Za,Cb){this.nEo=ka;this.wi=Za;this.SHa=Cb;this.kd=new ta.a;this.nEo.execute(Rb=>{this.SHa.Vae("OnBeforeTrackChangeMarkupViewChange",(sc,
Wc)=>{Wc&&Wc.$Nf!==Rb.Cj&&this.kd.raiseEvent("OnBeforeTrackChangeMarkupViewChange",Wc)});this.SHa.Vae("OnAfterTrackChangeMarkupViewChangeEventKey",(sc,Wc)=>{Wc&&Wc.Cj===Rb.Cj&&(Xg.a.Cj=Rb.Cj,this.kd.raiseEvent("OnAfterTrackChangeMarkupViewChange",Wc))})})}Iha(ka,Za){this.kd.addHandler(ka,Za)}ipa(ka,Za){this.kd.raiseEvent(ka,Za)}nae(){this.wi.N_f||(this.wi.N_f=!0,this.kd.raiseEvent("OnCommentRenderedOnce"))}}Object(e.a)(Lc,"WordCommentEventsActor",null,[]);var Bh=c(1797);class ag{constructor(){this.insertIndex=
0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(e.a)(ag,"InitCommentSessionResult",null,[]);class sl extends ag{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(e.a)(sl,"BeginDraftingHostResult",ag,[]);var tn=c(2035),Tn=c(1997),Un=c(1028);class Vh{constructor(ka,Za,Cb,Rb,sc,Wc,xd,oe,Nd,$e,hf,bg,Dg,Zh,zh){this.taskManager=ka;this.Tqa=Za;this.bOj=Cb;this.sFo=Rb;this.w6e=sc;this.rv=Wc;this.Zs=xd;this.tg=oe;this.p0=Nd;
this.rc=$e;this.Gk=hf;this.HZ=bg;this.wi=Dg;this.FVk=Zh;this.DVk=zh;this.IWb=this.f6=this.Bm=null;this.RSj="WordWebCommitNewCommentActivity";this.SSj="WordWebCommitTaskActivity";this.OSj="WordWebCommentReactionActivity";this.YLg=null}get yja(){return this.f6}mzn(ka){var Za;const Cb=this.yja.Xx,Rb=this.f6.mQ();if(Rb&&Cb){const sc=Un.a.Ffb(null!==(Za=Cb.authorId)&&void 0!==Za?Za:"");Za=new Bh.a(Cb.authorId,Cb.l0b,Cb.author,null!==sc&&void 0!==sc?sc:"",!0);ka.author=Za;ka.insertIndex=Array.indexOf(Rb,
Cb);ka.authorName=Cb.author;ka.authorIdentity="";return null}return Cj.a.lD(-2130915320)}initialize(ka,Za,Cb,Rb){this.Bm=ka;this.f6=Za;this.IWb=Cb;this.YLg=Rb}beginDraftingAsync(ka){if(!ka)return new Promise((Rb,sc)=>{sc(Cj.a.lD(-2130915327))});const Za=new sl,Cb=Vi.a.Iof(ka.sessionType);return void 0===Cb||null===Cb?new Promise((Rb,sc)=>{sc(Cj.a.lD(-2130915317))}):new Promise((Rb,sc)=>{Cj.a.s2(this.taskManager,()=>{if(1!==this.Bm.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",
this.Bm.mode),sc(Cj.a.lD(-2130915325));else{this.wyh();try{switch(Cb){case 0:if(!this.Bm.Uba.zib()){sc(Cj.a.lD(-2130915326));return}this.FVk.yTd();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${ka.draftId}`);this.Bm.ayb(ka);break;case 1:if(!ka.threadId||""===ka.threadId){sc(Cj.a.lD(-2130915324));return}if(this.rv.Zbg){const oe=this.f6.pD(ka.threadId);if(oe){const Nd=this.f6.k2h(oe,!1),$e=tn.a.QCb(oe,Nd,oe.authorId===this.rv.jY);$e&&this.w6e.invoke(ka.threadId,$e)}else a.ULS.sendTraceTag(579170962,
327,10,"Smart reply provider not invoked since comment is null",this.Bm.mode)}this.Bm.addReply(ka.threadId,ka);break;case 3:if(!ka.threadId||""===ka.threadId){sc(Cj.a.lD(-2130915324));return}var Wc=this.f6.pD(ka.threadId);if(!Wc){sc(Cj.a.lD(-2130915323));return}this.Bm.editComment(Wc,ka);break;case 2:if(!ka.commentId||""===ka.commentId){sc(Cj.a.lD(-2130915324));return}const xd=this.f6.pD(ka.commentId);if(!xd){sc(Cj.a.lD(-2130915323));return}this.Bm.editComment(xd,ka)}}catch(xd){sc(xd);this.h8i();
a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${xd} on Session ${Cb}`);return}(Wc=this.mzn(Za))?sc(Wc):Rb(Za);this.h8i()}},dj.a.beginDraftingAsync)})}commit(ka,Za,Cb){const Rb=this.yja.Xx;if(!Rb)throw Cj.a.lD(-2130915320);var sc=Rb.Ty;if(!sc)throw Cj.a.lD(-2130915320);const Wc=Vi.a.Iof(sc.sessionType);if(void 0===Wc||null===Wc)throw Cj.a.lD(-2130915317);if(ka!==sc.draftId)throw Cj.a.lD(-2130915327);let xd=!1,oe=!1;sc=!1;switch(Wc){case 3:if(!Cb)throw Cj.a.lD(-2130915327);break;case 0:this.Gk.he(()=>
{if(!this.Bm.Uba.zib())throw Cj.a.lD(-2130915326);Rb.text=[Za];this.Bm.Tz&&!this.wi.yn?this.Bm.Yun(()=>{this.Bm.Ita(Rb);this.Bm.Xll(ka,Rb.id)}):this.Bm.Ita(Rb);oe=Cb&&null!=Cb.Task;xd=this.Bm.Tz;Cj.a.s2(this.taskManager,()=>{this.Ymb(Rb.id)},dj.a.Ymb)},"WESCA:C:C");break;case 1:this.Gk.he(()=>{Rb.text=[Za];this.Bm.Ita(Rb);oe=Cb&&null!=Cb.Task;xd=this.Bm.Tz},"WESCA:C:R");break;case 2:this.Gk.he(()=>{Rb.text=[Za];this.Bm.Zdb(Rb);this.BYi(th.a.BWm)},"WESCA:C:E");break;default:throw Cj.a.lD(-2130915322);
}Cb&&(Cb.Resolve&&(this.iej(Rb,Cb.Resolve.isResolved),Cb.Resolve.isResolved&&!this.wi.yn&&this.Bm.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),Cb.Task&&this.Bm.eWk(Rb,Cb.Task),Cb.Reaction&&(sc=this.rv.LVk,Cb.Reaction.isActive?this.Bm.Fxd(Rb,Cb.Reaction.reactionType):this.Bm.kbe(Rb,Cb.Reaction.reactionType)));this.rv.XVk&&oe&&this.p0.execute(Nd=>Nd.logActivity(this.SSj,"CommentsTasksFpsIsEnabled"));xd&&this.p0.execute(Nd=>{Nd.logActivity(this.RSj,"CommentsFpsIsEnabled")});sc&&this.p0.execute(Nd=>
{Nd.logActivity(this.OSj,"CommentReactionsFpsIsEnabled")});return Rb.id}endCommentSession(ka){const Za=this.yja.Xx;if(Za){if(Za.Ty&&Za.Ty.draftId!==ka)throw Cj.a.lD(-2130915327);if(Za.er===ge.a.beingCreated)this.Bm.deleteComment(Za),!this.Bm.Tz||Za.Ff||this.wi.yn||this.tg.mg(ch.AFrame.$n);else{if(3!==this.Bm.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}Za.er=ge.a.normal;Za.kSa=Tn.a.succeeded;Za.Ty=null;this.Bm.M3e()}}this.Zs&&
this.Zs.updateCommandUI(!0);this.yja.lPd()||this.Tqa.ojg(1,!this.Bm.mode)}deleteComment(ka){(ka=this.f6.pD(ka))?(this.Bm.deleteComment(ka),this.Bm.Tz&&!this.wi.yn?ka.Ff||this.tg.mg(ch.AFrame.$n):this.tg.JC(ch.AFrame.xr),this.sFo.lag(ka)&&this.BYi(th.a.dDi)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(ka){this.Ymb(ka,0)}highlightComment(ka){this.Bm.odc(ka,0)}setThreadResolvedState(ka,Za){(ka=this.f6.pD(ka))&&this.iej(ka,Za)}iej(ka,Za){if(ka.Ff&&""!==
ka.Ff)throw Cj.a.lD(-2130915321);this.Bm.szb(ka,Za);Za&&!this.wi.yn&&this.tg.mg(ch.AFrame.$n)}presentLinkToComment(ka){var Za=this.f6.pD(ka);Za?(Za=this.yja.sNd(Za))?(ka={["nav"]:btoa(`{"${rl.a.comment}":${Za}}`),["mode"]:"copy"},this.DVk.hy(th.a.presentLinkToComment),this.rc.Rb(Fe.a.A7,2,ka,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",ka):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",
ka)}selectFirstThreadInNextCommentContext(){this.Bm.Rbj(0)}selectLastThreadInPreviousCommentContext(){this.Bm.c6n()}registerForCommentEvents(ka){const Za=this.yja.dmf(this.rv.cOb&&this.rv.Kq&&!this.wi.yn),Cb=this.yja.vUa,Rb=this.yja.lPd(),sc=!this.Bm.mode;this.Tqa.lfo();this.YLg.wWl().then(Wc=>{this.Tqa.uPn(ka,Za,Rb,sc,Cb,Wc);this.Tqa.ojg(Rb?5:1,sc);this.Zs&&this.Zs.updateCommandUI(!0)})}unregisterForCommentEvents(ka){this.Tqa.yPb(ka)}registerForAction(ka,Za){this.bOj.IRa(ka,Za)}unregisterForAction(){}checkAtMentionCapability(){return this.IWb?
this.IWb.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(ka=>{ka(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}wyh(){const ka=this.Bm.Tz&&!this.wi.yn?ch.AFrame.bM:ch.AFrame.xr;if(ka===ch.AFrame.xr){if(!this.wi.yn)return;mm.UISurfaces.uu().then(Za=>{Za.setSelectedTaskPane(Bo.a.DDd);return null})}this.tg.JC(ka)}Ymb(ka,Za=1){this.wyh();
this.HZ.Kbj(ka,Object.assign(new Bd.a,{e9:Za,mR:1===Za}))}h8i(){this.Bm.Uba.Jcb&&(this.Bm.Uba.Jcb=!1)}BYi(ka){this.rc.processAction(ka,2)}}Object(e.a)(Vh,"WordEditorSharedCommentAPI",null,[482,483]);class kk{constructor(ka,Za,Cb,Rb,sc,Wc,xd=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ka;this.parentId=Za;this.commentBody=Cb;this.author=Rb;this.date=sc;this.commentFlags=Wc;this.usersByReactionType=xd}}
Object(e.a)(kk,"OfficeSharedCommentModel",null,[]);c(1640);class lf{constructor(ka,Za){this.Na=ka;this.X2a=Za;this.zjh="AD";this.dpc=new M.a;this.EUe=new M.a;this.iBk=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.VLg=new bi.a}get userPrincipalName(){return this.Na.kb("UserPrincipalName")}get u4a(){return this.Na.kb("PresenceProvider")}get jY(){return this.Na.kb("PresenceUserId")}get Hi(){return this.X2a.value}LKi(ka){const Za=this.iBk.exec(ka);return Za?Za[1]:ka}pci(ka,Za=!1){let Cb=0;ka.done&&(Cb=ka.Ff&&
""!==ka.Ff?Cb|4:Cb|8);ka.BEh&&(Cb|=2);Za&&(Cb|=1);this.lag(ka)&&(Cb|=16);ka.gCf&&(Cb|=32);this.Vim(ka)||(Cb|=128);return Cb}Vim(ka){return ka?(ka=this.Hi.Db(ka.objectId))?ka.hasProperty(Ba.a.a7):!1:!1}lag(ka){if(!ka)return!1;if(void 0===ka.authorId||null===ka.authorId||""===ka.authorId)return this.pIf(ka.id,ka.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.jY||null===this.jY||""===this.jY)return this.pIf(ka.id,ka.objectId,"PresenceUserId null or empty"),!1;if(this.jY==ka.authorId&&
ka.l0b==this.u4a)return!1;const Za=this.UJd(ka.authorId),Cb=this.UJd(this.jY);if(this.u4a===this.zjh&&Za&&Cb&&Za[0]!=this.userPrincipalName&&Za[1]!=Cb[1])return!0;this.pIf(ka.id,ka.objectId,"Unknown");return!1}isCurrentUser(ka){if(!ka||void 0===ka.authorId||null===ka.authorId||""===ka.authorId||void 0===this.jY||null===this.jY||""===this.jY)return!1;if(this.jY==ka.authorId&&ka.l0b==this.u4a)return!0;ka=this.UJd(ka.authorId);const Za=this.UJd(this.jY);return this.u4a===this.zjh&&ka&&Za?ka[0]==this.userPrincipalName||
ka[1]==Za[1]:!1}UJd(ka){if(void 0===ka||null===ka)return null;ka=ka.split("::");return 3===ka.length?ka.slice(1,3):null}pIf(ka,Za,Cb){ka&&!this.VLg.contains(ka)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${Za}; reason: ${Cb}`),this.VLg.add(ka))}kZh(ka,Za){var Cb;if(!ka)return null;const Rb=ka.BYd;let sc=!1;1===Za&&(sc=!0);Za=ka.author?this.LKi(ka.author):"";const Wc=Un.a.Ffb(null!==(Cb=ka.authorId)&&void 0!==Cb?Cb:"");Cb=new Bh.a(ka.authorId?ka.authorId:"",ka.l0b,
Za,null!==Wc&&void 0!==Wc?Wc:"",this.isCurrentUser(ka));return new kk(ka.id?ka.id:"",ka.Ff?ka.Ff:"",ka.text&&ka.text.length?ka.text[0]:null,Cb,ka.date||Rb?ka.date:new Date,this.pci(ka,sc),this.rci(ka.usersByReactionType))}aBl(ka,Za,Cb){const Rb=[],sc=new M.a;if(!ka)return Rb;for(const Wc of ka)Wc.er!==ge.a.beingCreated&&Cb(Wc)&&(Wc.id&&this.dpc.ob(Wc.id)?(ka=this.dpc.J(Wc.id),ka=this.u5k(Wc,ka,Za),Rb.push(ka),sc.Z(Wc.id,ka)):Wc.id?(ka=this.kZh(Wc,Za),Rb.push(ka),sc.Z(Wc.id,ka)):a.ULS.sendTraceTag(50667679,
327,10,"CommentId should not be null"));this.dpc=sc;return Rb}dHl(ka,Za,Cb){const Rb=[];for(const sc of ka)sc.er!==ge.a.beingCreated&&Cb(sc)&&(sc.id&&this.dpc.ob(sc.id)?Rb.push(this.dpc.J(sc.id)):sc.id&&Rb.push(this.kZh(sc,Za)));return Rb}u5k(ka,Za,Cb){var Rb=ka.BYd,sc=1===Cb;Cb=ka.Ff?ka.Ff:"";const Wc=ka.text&&ka.text.length?ka.text[0]:null,xd=ka.author?this.LKi(ka.author):"",oe=ka.authorId?ka.authorId:"",Nd=ka.l0b?ka.l0b:"",$e=Un.a.Ffb(oe);Rb=ka.date||Rb?ka.date:new Date;sc=this.pci(ka,sc);const hf=
this.isCurrentUser(ka),bg=this.rci(ka.usersByReactionType);return Za.parentId===Cb&&Za.commentBody===Wc&&Za.author.DisplayName===xd&&Za.author.UserId===oe&&Za.author.Provider===Nd&&Za.author.IsCurrentUser===hf&&Za.date===Rb&&Za.commentFlags===sc&&this.Kzk(Za.usersByReactionType,bg)?Za:(Za=new Bh.a(oe,Nd,xd,null!==$e&&void 0!==$e?$e:"",hf),new kk(ka.id,Cb,Wc,Za,Rb,sc,bg))}Kzk(ka,Za){if(!ka&&!Za)return!0;if(!Za||!ka)return!1;var Cb=Object.keys(ka);if(Cb.length!==Object.keys(Za).length)return!1;for(const Rb of Cb){if(!(Rb in
Za))return!1;Cb=ka[Rb];const sc=Za[Rb];if(Cb.length!==sc.length)return!1;for(let Wc=0;Wc<Cb.length;Wc++)if(!this.yzk(Cb[Wc],sc[Wc]))return!1}return!0}yzk(ka,Za){return ka||Za?ka&&Za&&ka.UserId===Za.UserId&&ka.Provider===Za.Provider&&ka.Email===Za.Email&&ka.DisplayName===Za.DisplayName&&ka.IsCurrentUser===Za.IsCurrentUser?!0:!1:!0}rci(ka){if(!ka)return null;const Za={},Cb=this.Na.kb("PresenceUserId");for(const sc of Object.keys(ka)){const Wc=[];var Rb=ka[sc];for(const xd of Rb){Rb=xd.UserId===Cb;let oe;
this.EUe.ob(xd.UserId)?(oe=this.EUe.J(xd.UserId),oe.IsCurrentUser=Rb):(oe=new Bh.a(xd.UserId,xd.Provider,xd.DisplayName,xd.Email,Rb),this.EUe.add(xd.UserId,oe));Wc.push(oe)}Za[sc]=Wc}return Za}}Object(e.a)(lf,"WordEditorSharedCommentModelTranslator",null,[481]);class Tg{constructor(){this.fn=null;this.cdd=this.t8g=this.zIg=this.Feh=this.uhh=this.$3g=this.u$g=!1}qci(){this.fn||(a.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.Sgj());
return this.fn}wWl(){return new Promise((ka,Za)=>{this.cdd?ka(this.A8h()):this.Hdj().then(()=>{ka(this.A8h())}).catch(Cb=>{Za(Cb)})})}A8h(){this.cdd||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ka;ka=33;this.zIg&&(ka|=2);this.u$g&&(ka|=8);this.uhh&&(ka|=16);this.$3g&&(ka|=4);this.Feh&&(ka|=64);this.t8g&&(ka|=128);return ka}}Object(e.a)(Tg,"OfficeSharedCommentsAppCapabilities",null,
[893]);class dm extends Tg{constructor(ka){super();this.BWa=null;this.ih=ka;this.ugo();this.Sgj()}ugo(){this.Feh=this.ih.OOb;this.uhh=!1;this.t8g=this.$3g=this.u$g=!0}initialize(ka){this.BWa=ka;this.Hdj()}Sgj(){this.fn={};this.fn.LivePersonaPicker="true";this.fn.PersonaColor="true";this.fn.DiscreteHostedComments=this.ih.Cgl.toString();this.fn.NewCommentButton="true";this.fn.DisabledChangeGates="WebThemeIntegrationHighContrastFixes,"+this.ih.vgl;this.fn.CommentsFluentUI="true";this.fn.CommentTasks=
this.ih.OOb.toString();this.fn.CommentTasksFromReply=this.fn.CommentTasks;this.fn.CommentsFluentUIV2="true";this.fn.CommentFriendlyTimestamps=this.ih.fVk.toString();this.fn.AtMentionFloodgateSurvey=this.ih.GAk.toString();this.fn.HyperlinksInComments="true";this.fn.NewModelState="true";this.fn.LogDraftCommentIdPair="true";this.fn.RichTextFormattingInWeb=this.ih.Jyb.toString();this.fn.NoDiscardOnFocusLoss="true";this.fn.NewResolvedCardDesignInWeb="true";this.fn.RichContentEditIntegration="true";this.fn.HyperlinksWithDisplayText=
"true";this.fn.SmartReplies=this.ih.Zbg.toString();this.fn.NewBorderAndFocusLookInWeb="true";this.fn.LinkToComment="true";this.fn.TaskPaneWithNewInfrastructure="true";this.fn.CommentReactions="true";this.fn.WebThemeIntegration="true";this.fn.NewSelectionInteractions="true";this.fn.QuillInitializationTelemetry="true";this.fn.PersonaIconImageForWeb="true";this.fn.HighlightsAndFontColorInWebComments="true";this.fn.TruncationUIWithReadMoreText="true";this.fn.CtrlEnterTip="true";this.fn.AtMentionHintMessage=
"true";this.fn.LivePersonaCardForWeb=this.ih.oSm.toString();this.fn.TaskHistoryRecordIDs=this.ih.dAo.toString();this.fn.ContentNavigation=this.ih.contentNavigationApiEnabled.toString()}Hdj(){return new Promise((ka,Za)=>{this.BWa?this.BWa.atMentionsEnabledAsync().then(Cb=>{this.zIg=Cb;this.cdd=!0;ka(this.cdd)}):(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),Za(Cj.a.lD(-2130915320)))})}}
Object(e.a)(dm,"WordSharedCommentsAppCapabilities",Tg,[479]);class Hc{constructor(){this._initialized=!1;this.WVk={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:Bi.a.ihf,vetoPillar:7};this.kAo={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:bq.a.ihf,vetoPillar:7}}get f4a(){return null!=this.uBg?this.uBg:this.uBg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}sZ(ka){this.f4a.sZ(kl.a.comments,ka,!0)}get name(){return"WordEditor.Comments"}yc(ka){this.W=
ka;this.sZ("CPConfigStart");ka.ha("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new xm.a(m.Health.instance,new ze.a,this.WVk)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").singleInstance();ka.ha("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new xm.a(m.Health.instance,new ze.a,this.kAo)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").singleInstance();ka.ha("WordEditor.Comments.CommentNodeTracker",()=>new vh(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").singleInstance();
ka.ha("WordEditor.Comments.CommentsSettings",()=>new ad(y.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new U.a(()=>V.App.ya.jb.Wc),new U.a(()=>Bf.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").singleInstance();ka.ha("WordEditor.Comments.CommentsState",()=>new Xg.a).singleInstance();ka.ha("WordEditor.Comments.WordCommentEventsActor",()=>new Lc(ka.Sa("Box4.TrackChange.ITrackChangeManager"),
ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).singleInstance();ka.ha("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new lf(y.AFrameworkApplication.K,new U.a(()=>V.App.ya.jb.Wc.ud))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").singleInstance();ka.ha("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new Ib(ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").singleInstance();
ka.ha("Common.Comments.OfficeSharedCommentsEventHost",()=>new Rh(y.AFrameworkApplication.oc)).as("Common.Comments.IOfficeSharedCommentsEventHost").singleInstance();ka.ha("WordEditor.Comments.CommentActionInTypingRecorder",()=>new ne(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").singleInstance();ka.ha("WordEditor.Comments.EditorCommentModel",sn.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").singleInstance();
ka.ha("WordEditor.Comments.ICommentModelBootLoader",()=>new on(new U.a(()=>V.App.ya.jb.Wc),new U.a(()=>Bf.a.instance),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.CommentsSettings"),ka.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));ka.ha("WordEditor.Comments.ICommentFilterActor",()=>new Jc(ka.resolve("WordEditor.Comments.IEditorCommentModel"),
y.AFrameworkApplication.K,ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).singleInstance();ka.resolve("WordEditor.Comments.ICommentFilterActor");ka.ha("WordEditor.Comments.CommentHighlightOnRestActor",()=>new Ml(new U.a(()=>V.App.ya.jb.Wc),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.WordCommentEventsActor"),ka.resolve("Box4.INotebookManager").Kl,N.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),
ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").singleInstance();ka.ha("WordEditor.Comments.CommentHighlightUtils",()=>new Nm(ka.resolve("Box4.Highlight.IHighlightManager"))).singleInstance();ka.ha("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new Mg(ka.resolve("WordEditor.Comments.CommentHighlightUtils"))).singleInstance();ka.ha("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new ri(ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),
ka.resolve("WordEditor.Comments.CommentHighlightUtils"),y.AFrameworkApplication.ta.B0,y.AFrameworkApplication.ta.LHa,y.AFrameworkApplication.xa,y.AFrameworkApplication.oc,ka.resolve("WordEditor.Comments.CommentsState"),ka.Sa("WordEditor.Comments.IEditorCommentManager"))).singleInstance();ka.ha("WordEditor.Comments.CommentHighlightActor",()=>new Le(new U.a(()=>V.App.ya.jb.Wc.ud),ka.resolve("WordEditor.CommentsInteractive.ICommentEditor"),ka.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),
ka.Sa("WordEditor.Comments.IEditorCommentManager"),N.a.instance,ka.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),ka.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),ka.resolve("WordEditor.Comments.CommentHighlightUtils"),ka.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").singleInstance();ka.ha("WordEditor.Comments.CommentHintActor",()=>new kc(ka.resolve("WordEditor.Comments.CommentsSettings"),ln.a.instance,Sf.a.instance,
Jd.a.instance,y.AFrameworkApplication.xa,nn.TableCellReader.bFm,Of.moveToLastRenderedCellOfTheRow,new no.a,ka.Sa("Box4.ContentControlConfigSettings"),ka.resolve("WordEditor.Comments.IEditorCommentModel"),ka.resolve("WordEditor.Comments.ICommentHighlightActor"),ka.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),ka.resolve("WordEditor.Comments.CommentsState"),ka.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").singleInstance();
ka.ha("WordEditor.Comments.CommentMarginEntryPointActor",()=>new Uh(ln.a.instance,Jd.a.instance,y.AFrameworkApplication.xa,ka.resolve("WordEditor.Comments.ICommentHintActor"),ka.Sa("Common.IZoomManager"))).singleInstance();ka.ha("WordEditor.Comments.ViewContainerAPI",()=>new Jh(y.AFrameworkApplication.xa,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").singleInstance();ka.ha("Common.Comments.CommentActivationManager",()=>new rn).as("Common.Comments.ICommentActivationManager").singleInstance();
ka.ha("Common.Comments.ViewContainerEventHost",()=>new mn(y.AFrameworkApplication.oc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").singleInstance();ka.ha("WordEditor.Comments.CommentSmartReplyProvider",()=>new rd(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").singleInstance();
ka.ha("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new dm(ka.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").singleInstance();this.sZ("CPConfigEnd")}init(){this.sZ("CPInitStart");this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>{try{this.$m(),this.sZ("CPInitEnd")}catch(ka){throw a.ULS.JH(524300632,327,10,ka,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",ka),this.f4a.fx(kl.a.comments,
"CPInitException",ka,!0),ka;}})}$m(){const ka=this.W.resolve("WordEditor.Comments.CommentsSettings");this.sZ("onAfterGFNLoadedStart");this.W.ha("WordEditor.Comments.OfficeSharedCommentPane",()=>new cm(y.AFrameworkApplication.xa,y.AFrameworkApplication.ta.MC,y.AFrameworkApplication.ta.NC,y.AFrameworkApplication.ta.yp,y.AFrameworkApplication.ta.Tw,V.App.ya,Zd.a.instance,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.resolve("Common.Comments.IViewContainerEventHost"),
y.AFrameworkApplication.oc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").singleInstance();this.W.ha("Common.Comments.OfficeSharedCommentsActionHost",()=>new gl(y.AFrameworkApplication.xa,
this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").fnc)).as("Common.Comments.IOfficeSharedCommentsActionHost").singleInstance();this.W.ha("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new Vh(y.AFrameworkApplication.oc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),
ka,V.App.ya,y.AFrameworkApplication.ta.yp,this.W.Sa("Common.ISystemInitiatedFeedback"),y.AFrameworkApplication.xa,N.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").singleInstance();Cn.a.factory=Gd.getInstance;this.W.ha("WordEditor.Comments.EditorCommentManager",
Gd.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").singleInstance();this.W.ha("WordEditor.Comments.CommentFloatingContainerActor",()=>new Xc(this.W.resolve("WordEditor.Comments.CommentsState"),ka,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.oc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),
()=>document.querySelector(`#${nd.AppFrame.MTa} .${Hm.a.y3b}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),y.AFrameworkApplication.ta.yp)).as("WordEditor.Comments.ICommentFloatingContainerActor").singleInstance();const Za=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),Cb=Za.trackChangeInSidetrackEnabled;Cb&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").H2i(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));this.W.ha("WordEditor.Comments.FloatingCommentManager",
()=>new Qf(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.oc,N.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),Za)).singleInstance();this.W.ha("WordEditor.Comments.IFloatingCommentManager",()=>Cb?
this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").singleInstance();this.W.ha("WordEditor.Comments.CommentSelectionActor",()=>new Zm(y.AFrameworkApplication.xa,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),Kd.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
y.AFrameworkApplication.ta.yp,this.W.resolve("WordEditor.Comments.CommentsState"),ka,new U.a(()=>cf.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.Sa("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").singleInstance();this.W.ha("WordEditor.Comments.CommentInitActor",()=>new yf(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),
this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),ka,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),Kd.getInstance(),V.App.ya.xq,y.AFrameworkApplication.xa,this.W.resolve("Common.IDynamicScriptLoaderProvider").HA,this.W.Sa("WordEditor.Comments.ICommentRibbonCommandHandler"),y.AFrameworkApplication.ta.yp,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),
this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.Sa("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.Sa("Common.App.SafeLinks.ISafeLinksManager"),this.W.Sa("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),Za,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).singleInstance();this.W.ha("WordEditor.Comments.CommentsActionManager",
()=>new wf(this.W.resolve("WordEditor.Comments.EditorCommentManager"),this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),ka,this.W.resolve("Common.Comments.ICommentPane"),new U.a(()=>V.App.ya.jb.Wc.ud),y.AFrameworkApplication.xa,
new U.a(()=>cf.a.instance),bh.FocusManager.instance(),N.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"))).as("WordEditor.Comments.CommentsActionManager").singleInstance();this.W.resolve("WordEditor.Comments.CommentInitActor");ka.contentNavigationApiEnabled&&(this.W.ha("WordEditor.Comments.CommentContentProvider",()=>new bp(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"))).singleInstance(),this.W.ha("WordEditor.Comments.CommentContentActor",()=>new zk(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),
this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).singleInstance(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),this.W.resolve("WordEditor.Comments.CommentContentActor"));const Rb=ka.Kq,sc=this.W.resolve("WordEditor.Comments.EditorCommentManager");this.W.resolve("WordEditor.Comments.CommentsActionManager");
sc&&Rb&&(this.W.resolve("WordEditor.Comments.CommentsState").Fcb=Hc.P0h(),ka.WAb||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").ipa("OnCommentInit"));Cc.a.j_m();ka.uPc&&V.App.ya.jb.fSh();Cn.a.instance&&(ka.WAb||Ij.a.get_instance().Vk(4,()=>{this.Qfn(Rb)},11).continueWith(()=>{this.tqm()}),this._initialized=!0);this.zNn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}tqm(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").ipa("OnCommentInit")}Qfn(ka){ka||
this.qcm()}qcm(){const ka=Hc.P0h();ka&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.DW),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").ipa("OnCommentInit",Object.assign(new sj.a,{JFa:()=>{Cn.a.instance.Uba.isVisible||y.AFrameworkApplication.xa.processAction(Fe.a.vY,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").Hbj(ka,Object.assign(new Bd.a,{pag:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").hy(Fe.a.r6e))}zNn(ka,
Za,Cb){ka&&ka.execute(Rb=>{Rb.g4(new fc.a(Za,Cb))})}dispose(){this._initialized&&(Cn.a.instance&&Cn.a.instance.dispose(),this._initialized=!1)}static P0h(){return y.AFrameworkApplication.K.kb("BootActivityNavigationId")}}Object(e.a)(Hc,"PackageManager",null,[1,2]);const Af=ka=>{const Za=K.a.instance.Sa("Box4.IPackageBootPerfLogger"),Cb=window.performance.now();Za.execute(Rb=>{Rb.fx(kl.a.comments,"CPMain",Cb,!0)});z.a.instance.Gc(new Hc,0,ka)};var fh=c(1926);class Kq{isComment(ka){return Yg.a.isComment(ka)}jWd(ka){return Yg.a.jWd(ka)}Bzf(ka){return Yg.a.Bzf(ka)}CQf(ka,
Za){Yg.a.CQf(ka,Za)}GQf(ka,Za){Yg.a.GQf(ka,Za)}C9e(ka){return Yg.a.C9e(ka)}G3a(ka){return Bf.a.instance.G3a(ka)}deleteComment(ka,Za){Yg.a.deleteComment(ka,Za)}SGd(ka,Za){Yg.a.SGd(ka,Za)}xmb(ka){Yg.a.xmb(ka)}Iaa(ka,Za,Cb){return Yg.a.Iaa(ka,Za,Cb)}ava(ka,Za,Cb){return Yg.a.ava(ka,Za,Cb)}z7b(ka,Za){return Yg.a.z7b(ka,Za)}rMc(ka,Za,Cb,Rb=null){return Yg.a.rMc(ka,Za,Cb,Rb)}UZb(ka,Za,Cb,Rb){Yg.a.UZb(ka,Za,Cb,Rb)}Exd(ka,Za,Cb,Rb){return Yg.a.Exd(ka,Za,Cb,Rb)}get VFb(){return Yg.a.VFb}set VFb(ka){Yg.a.VFb=
ka}GJb(ka,Za){Yg.a.GJb(ka,Za)}A2c(ka){Yg.a.A2c(ka)}T1f(ka){Yg.a.T1f(ka)}yPd(ka,Za){return Yg.a.yPd(ka,Za)}DQf(ka,Za){Yg.a.DQf(ka,Za)}FQf(ka,Za){Yg.a.FQf(ka,Za)}J4d(ka,Za,Cb,Rb,sc,Wc){Yg.a.J4d(ka,Za,Cb,Rb,sc,Wc)}wff(ka,Za){Yg.a.wff(ka,Za)}x0c(ka,Za,Cb,Rb){return Yg.a.x0c(ka,Za,Cb,Rb)}C0c(ka,Za,Cb,Rb){return Yg.a.C0c(ka,Za,Cb,Rb)}}Object(e.a)(Kq,"CommentEditorProxy",null,[478]);class nm{constructor(){this.W=null}get HOb(){return null!=this.VDg?this.VDg:this.VDg=(()=>this.W.Sa("WordEditor.ITableEditor"))()}get f4a(){return null!=
this.vBg?this.vBg:this.vBg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}sZ(ka){this.f4a.sZ(kl.a.comments,ka,!0)}get name(){return"WordEditor.CommentsInteractive"}yc(ka){this.W=ka;this.sZ("CIPConfigStart");ka.ha("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new Kq).as("WordEditor.CommentsInteractive.ICommentEditor").singleInstance();this.sZ("CIPConfigEnd")}init(){this.sZ("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>{this.$m();this.sZ("CIPInitEnd")})}$m(){this.hlm()}dispose(){}hlm(){Gi.a.JRa(Yg.a.GQf);
fh.a.oYe(Yg.a.DQf);fh.a.uyd(Yg.a.FQf);fh.a.Dqk(Yg.a.Nfn);this.HOb.execute(Za=>{Za.pYe(Yg.a.GJb)});const ka=V.App.jk.Kl;ka.af(39).Ro(Yg.a.CQf);fh.a.Ipk(Yg.a.Qen);fh.a.zpk(Yg.a.Zdn);ue.a.isEnabled&&ka.af(12).Lv(Yg.a.WJj)}}Object(e.a)(nm,"PackageManager",null,[1,2]);const ym=ka=>{const Za=K.a.instance.Sa("Box4.IPackageBootPerfLogger"),Cb=window.performance.now();Za.execute(Rb=>{Rb.fx(kl.a.comments,"CIPMain",Cb,!0)});z.a.instance.Gc(new nm,0,ka)};var Do=c(2034),Ak=c(169),Yf=c(1655);class tc{constructor(ka,
Za,Cb,Rb,sc,Wc,xd){this.XLa=ka;this.M$=Za;this.t6=Cb;this.Xc=Rb;this.QYj=sc;this.aJe=Wc;this.eub=xd;Yf.a.Cqk((oe,Nd)=>{this.yok(Nd.graphNode,Nd.SUk)});Yf.a.frk((oe,Nd)=>{this.z0k(Nd.graphNode,Nd.QSk)})}AOd(){var ka=this.QYj();const Za=this.Xc.Ck();Za.set(ka);if(this.M$.mIo(Za))return Za;Za.set(ka);Ak.PageNavigator.instance.TQ(Za);ka=this.t6.d8k(Za.currentNode);Za.Fi(ka);return Za}SQd(ka){const Za=this.AOd();let Cb=null;this.M$.FLd(Za,Rb=>{this.t6.Ndi(Rb)===ka&&(Cb=Rb);return!Cb});return Cb}Jdi(ka){const Za=
this.AOd();let Cb=null;this.M$.FLd(Za,Rb=>{this.t6.I7b(Rb)===ka&&(Cb=Rb);return!Cb});return Cb}ODi(ka,Za,Cb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",ka,Za,Cb)}Odi(){const ka=this.AOd(),Za=[];this.M$.FLd(ka,Cb=>{Za.push(this.t6.Ndi(Cb));return!0});return Za}veb(ka,Za){if(!Za.length)return this.eub&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const Cb=this.AOd(),Rb=En.a.create().toString(),
sc=new nf.a;for(let Wc of Za)sc.add(Wc),this.ODi(Wc.type,Rb,Wc.completion);Za=this.XLa.u7f(sc);this.t6.veb(Cb.currentNode,Rb,ka,Za);this.aJe();return Rb}Se(ka){(ka=this.SQd(ka))?(this.t6.Se(ka),this.aJe()):this.eub&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}I7b(ka){ka=this.SQd(ka);return ka?this.t6.I7b(ka):(this.eub&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}Kdi(ka){return this.t6.I7b(ka)}Mdi(ka){ka=
this.SQd(ka);if(!ka)return this.eub&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;ka=this.t6.Arf(ka);return this.XLa.F3b(ka).toArray()}Mwk(ka,Za){if(!Za.length)return this.eub&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const Cb=this.SQd(ka);if(!Cb)return this.eub&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const Rb=this.t6.Arf(Cb),sc=this.XLa.F3b(Rb);
for(let Wc of Za)sc.add(Wc),this.ODi(Wc.type,ka,Wc.completion);ka=this.XLa.u7f(sc);ka!==Rb&&(this.t6.Yfo(Cb,ka),this.aJe());return!0}yok(ka,Za){if(Za=this.Jdi(Za)){const Cb=this.Xc.Ck();Cb.set(ka);this.t6.Wb(Za.clone(),this.t6.Kol(Za,Cb))}}w1i(ka,Za,Cb){if(Za.ob(ka))return Za.J(ka);const Rb=En.a.create().toString();Za.add(ka,Rb);Cb&&this.eub&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return Rb}z0k(ka,Za){const Cb=new Pg.a;var Rb=
this.Xc.Ck();Rb.set(ka);Rb.Tb(38)&&this.M$.FLd(Rb,sc=>{const Wc=this.t6.I7b(sc);void 0!==Wc&&null!==Wc&&Cb.add(Wc,sc);return!0});for(let sc of Za)if(ka=null,({value:ka}=Cb.Ec(sc.key,ka)).returnValue)if(sc.value===sc.key)ka=this.Jdi(sc.key),this.t6.Igo(ka,parseInt(sc.key));else{ka=this.t6.Arf(ka);if(!ka||""===ka){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}ka=this.XLa.F3b(ka);Rb=new ob.a;for(let Wc=0;Wc<ka.length;Wc++){if(ka.J(Wc).commentId){const xd=
Number.parseInvariant(ka.J(Wc).commentId);Za.ob(xd)?ka.J(Wc).commentId=Za.J(xd).toString():ka.J(Wc).commentId=null}ka.J(Wc).recordId=this.w1i(ka.J(Wc).recordId,Rb,!1);-1===ka.J(Wc).type&&(ka.J(Wc).undoId=this.w1i(ka.J(Wc).undoId,Rb,!0))}this.veb(sc.value,ka.toArray())}}static zr(){return new tc(K.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),K.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),K.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new no.a,()=>V.App.ya.jb.Wc,()=>
{K.a.instance.Sa("Common.Interface.IEditNotificationManager").execute(ka=>{ka.editHappened()})},!0)}}Object(e.a)(tc,"TaskActor",null,[489]);var Qk=c(1118);class cq{create(){return new Qk.a}}Object(e.a)(cq,"TaskContentNodeFactory",null,[378]);var Eo=c(1053);class zm{create(){return new Eo.a}}Object(e.a)(zm,"TaskNodeFactory",null,[378]);class Vn{constructor(ka,Za,Cb,Rb,sc,Wc){this.M$=ka;this.Ic=Za;this.Xc=Cb;this.Qek=Rb;this.Tek=sc;this.wRb=Wc}J6k(ka,Za,Cb){const Rb=this.Tek.create(1074135162);Rb.setValue(Ba.a.taskId,
ka);Rb.setValue(Ba.a.LOb,Za);Rb.setValue(Ba.a.qya,Cb);return Rb}K7b(ka){const Za=this.Ic.Qc(4);Za.Eb(ka);this.wRb();return Za}Ndi(ka){return this.M$.cHb(ka)?ka.getValue(Ba.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}I7b(ka){return this.M$.cHb(ka)?ka.hasProperty(Ba.a.LOb)?ka.getValue(Ba.a.LOb):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}Arf(ka){return this.M$.cHb(ka)?ka.getValue(Ba.a.qya):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),
null)}d8k(ka){if(7!==ka.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const Za=this.K7b(ka);try{const Cb=this.Qek.create(1074135161),Rb=this.Xc.Ck();Rb.set(ka);Rb.q2(Cb,38,Vn.$zo);return Cb}finally{Za&&Za.dispose()}}veb(ka,Za,Cb,Rb){if(!this.M$.hEf(ka))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const sc=this.K7b(ka);try{const Wc=this.J6k(Za,Cb,Rb),xd=this.Xc.Ck();xd.set(ka);xd.q2(Wc,1,new ma.a(En.a.Yta(Cb.toString()),1));return Wc}finally{sc&&
sc.dispose()}}Se(ka){if(this.M$.cHb(ka))if(ka.anchor&&ka.anchor.Wp){var Za=ka.anchor.Wp.lr.node;if(this.M$.hEf(Za)){var Cb=this.K7b(Za);try{const Rb=this.Xc.Ck();Rb.set(Za);Rb.Fi(ka.anchor.node);Rb.Dg()}finally{Cb&&Cb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}Yfo(ka,Za){if(this.M$.cHb(ka)){var Cb=
this.K7b(ka);try{ka.setValue(Ba.a.qya,Za)}finally{Cb&&Cb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}Igo(ka,Za){if(this.M$.cHb(ka)){var Cb=this.K7b(ka);try{const Rb=ka.hasProperty(Ba.a.LOb)?ka.getValue(Ba.a.LOb):null;void 0===Rb||null===Rb||Rb===Za?ka.Yg(Ba.a.LOb,Za):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{Cb&&Cb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}Kol(ka,Za){if(!Za.Xr(38)){const Cb=this.Xc.Ck();
Cb.set(ka);Cb.Ab(71);Cb.fd(71);ka=Ya.a(Cb.currentNode,ka.Ei().Mc,!0);Za.Qf(ka,38)}return Za.Tb(38)}Wb(ka,Za){if(this.M$.hEf(Za)){var Cb=this.K7b(Za);try{const Rb=this.Xc.Ck();Rb.set(Za);Rb.Qf(ka,1)}finally{Cb&&Cb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static zr(){return new Vn(K.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new Bn.a,new no.a,new cq,new zm,()=>{Ef.App.Hn.jb.Wc.NE.Q6(10)})}}Vn.$zo=new ma.a(En.a.Gf("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),
1);Object(e.a)(Vn,"TaskEditor",null,[485]);class qk{constructor(ka,Za){this.Ix=ka;this.zWb=Za}cHb(ka){return!!ka&&72===ka.type}pLm(ka){return!!ka&&71===ka.Xe}hEf(ka){return!!ka&&71===ka.type}mIo(ka){ka.set(this.Ix.value);this.zWb.TQ(ka);return!!ka.Tb(38)}FLd(ka,Za){if(ka&&Za)if(this.pLm(ka))for(var Cb=!0,Rb=ka.Tb(1);Cb&&Rb;)this.cHb(Rb)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",Rb.type),Cb=Za(Rb),Rb=ka.wf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",
ka.Xe);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static zr(){return new qk(new U.a(()=>V.App.ya.jb.Wc),Ak.PageNavigator.instance)}}Object(e.a)(qk,"TaskNavigator",null,[484]);class Pp{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>{this.$m()})}dispose(){}yc(ka){this.W=ka;ka.ha("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new Do.a).as("WordEditor.Tasks.ITaskHistorySerialization").singleInstance();
ka.ha("WordEditor.Tasks.TaskNavigator",()=>qk.zr()).as("WordEditor.Tasks.ITaskNavigator").singleInstance();ka.ha("WordEditor.Tasks.TaskEditor",()=>Vn.zr()).as("WordEditor.Tasks.ITaskEditor").singleInstance();ka.ha("WordEditor.Tasks.TaskActor",()=>tc.zr()).as("WordEditor.Tasks.ITaskActor").singleInstance()}$m(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(114)}}Object(e.a)(Pp,"TasksPackage",null,[1,2]);var tl=c(63),un=c(1652),fo=c(443),oo=c(73);class sd{constructor(){this.onResizeMiddleContainer=
this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(e.a)(sd,"TaskPaneGroupAppProps",null,[]);var Bk=c(140);class rq{static jWk(ka,Za){bh.FocusManager.DJ()&&(Sf.a.instance.yBa(ka,Za,!1),Bk.a.instance.yBa(ka,Za,!1),y.AFrameworkApplication.ta.Tw.GS(ka))}}Object(e.a)(rq,"ReactTaskPaneManagerUtils",null,[]);var Tj=c(119),Hp=c(299);class Fo{constructor(){this.type=
null}}Object(e.a)(Fo,"SampleTaskPaneProps",null,[]);var om=c(1653);class Om{constructor(){this.entry=null;this.show=!1}}Object(e.a)(Om,"AnimationBatchEntry",null,[]);var Ln=c(287),Qp=c(1134),Wn=c(103);class jj{constructor(){this.f7g=[];this.g7g=[];this.Kka={};this.iJa=this.hJa=null;this.Kud=!1;this.$Y=null;this.Srd=this.Cmd=0;this.znc=[];this.lEe=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Ob.ejb;this.tw=!1}initialize(){this.Kud=!1;(this.tw=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Ob.uO)&&
this.o$e()}q$e(ka,Za,Cb,Rb){Za=this.UQd(Za);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.o$e();const sc=document.createElement("div");sc.id=Za;sc.className=jj.lWo;sc.style.width="0";this.lEe||(this.olk(Cb,Za,sc),this.Kka[Za]=ka.q$e(Za,Cb,Rb,sc));return sc}o$e(){this.Kud||this.Gio()}olk(ka,Za,Cb){let Rb=null,sc=null;0===ka?(Rb=this.hJa,sc=this.f7g):1===ka&&(Rb=this.iJa,sc=this.g7g);if(Rb){ka=!1;for(let Wc=0;Wc<sc.length;Wc++)if(!ka)sc[Wc]===Za&&(ka=!0);else if(sc[Wc]in this.Kka){this.Mum(Rb,
Cb,this.Kka[sc[Wc]]);return}Rb.appendChild(Cb)}}Mum(ka,Za,Cb){ka.insertBefore(Za,Cb.element)}Nhl(ka){ka=this.UQd(ka);if(ka in this.Kka){const Za=this.Kka[ka];Za.element.parentNode.removeChild(Za.element);delete this.Kka[ka]}}umj(ka){ka=this.UQd(ka);ka in this.Kka&&(ka=this.Kka[ka])&&!ka.isVisible&&(this.Flj(ka,!0),this.Dnh(ka.position,!0,this.swh(ka,!0)),1===ka.position&&1<J.a.count(this.Kka)&&this.L1m())}Dkm(ka){ka=this.UQd(ka);ka in this.Kka&&(ka=this.Kka[ka])&&ka.isVisible&&(this.Flj(ka,!1),this.Dnh(ka.position,
!1,this.swh(ka,!1)))}X2b(ka){if(this.$Y)return this.$Y;const Za=document.createElement("div");document.body.appendChild(Za);Za&&(this.$Y=new un.a(Za,ka));return this.$Y}Flj(ka,Za){ka.element&&(ka.isVisible=Za,this.znc.push(Object.assign(new Om,{entry:ka,show:Za})));0===ka.position?this.Cmd+=Za?1:-1:this.Srd+=Za?1:-1;1===this.znc.length&&window.setTimeout(Object(Al.a)(this,this.Zuo,"startPaneAnimation"),0);this.tw&&ka.element&&ka.element.parentNode&&(0===ka.position&&!this.Cmd||1===ka.position&&!this.Srd?
(ka.element.parentNode.style.minHeight="0px",ka.element.parentNode.style.height="0px",ka.element.parentNode.style.overflow="hidden"):(ka.element.parentNode.style.minHeight="",ka.element.parentNode.style.height="",ka.element.parentNode.style.overflow=""))}Zuo(){this.BPi();var ka=Ga.where(Ga.asEnumerable(this.znc),sc=>0===sc.entry.position),Za=Ga.where(ka,sc=>!sc.show);if(Ga.any(Za)&&Ga.Ct(Za)!==Ga.Ct(ka)){for(var Cb of Za)Cb.entry.element.style.width="0";ka=Ga.where(ka,sc=>sc.show)}Za=Ga.where(Ga.asEnumerable(this.znc),
sc=>1===sc.entry.position);Cb=Ga.where(Za,sc=>!sc.show);if(Ga.any(Cb)&&Ga.Ct(Cb)!==Ga.Ct(Za)){for(var Rb of Cb)Rb.entry.element.style.width="0";Za=Ga.where(Za,sc=>sc.show)}for(let sc of Ga.concat(ka,Za))ka=sc.entry,Wn.WacAirSpace.JU(ka.element,Ln.a.ebg),Rb=new Qp.a(ka.element),sc.show?Rb.AZe(0,ka.width):Rb.AZe(ka.width,0),Wn.WacAirSpace.animate(Rb,null,null);this.znc.length=0}BPi(){}swh(ka,Za){let Cb=ka.width;ka=0===ka.position?this.Cmd:this.Srd;if(Za&&1===ka||!Za&&!ka)Cb+=1;return Cb}Gio(){this.Kud||
(this.hJa||(this.hJa=document.createElement("div"),this.hJa.id=jj.jWo,this.hJa.className=jj.EDj,Sys.UI.DomElement.addCssClass(this.hJa,"alignLeft"),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Ob.n8&&Sys.UI.DomElement.addCssClass(this.hJa,"FlexBoxLayout"),this.lEe&&Sys.UI.DomElement.addCssClass(this.hJa,jj.BDj),this.Flh(0,this.hJa)),this.iJa||(this.iJa=document.createElement("div"),this.iJa.id=jj.kWo,this.iJa.className=jj.EDj,Sys.UI.DomElement.addCssClass(this.iJa,"alignRight"),y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Ob.n8&&Sys.UI.DomElement.addCssClass(this.iJa,"FlexBoxLayout"),this.lEe&&Sys.UI.DomElement.addCssClass(this.iJa,jj.BDj),this.Flh(1,this.iJa)),this.JRi(this.hJa,this.iJa),this.Kud=!0)}JRi(){}BBa(ka,Za){Array.add(1===ka?this.g7g:this.f7g,Za)}UQd(ka){return ka+"-Entry"}L1m(){let ka=0;for(const Za of J.a.gO(this.Kka)){const Cb=Object(qa.a)(954,this.Kka[Za]);Cb&&Cb.isVisible&&1===Cb.position&&ka++}2===ka?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<ka&&
a.ULS.sendTraceTag(595179605,320,50,ka+" simultaneous panes open")}}jj.jWo="WACTaskPaneContainerLeft";jj.kWo="WACTaskPaneContainerRight";jj.EDj="WACTaskPaneContainer";jj.lWo="WACTaskPaneEntry";jj.BDj="WACReactTaskPaneContainer";Object(e.a)(jj,"BaseTaskPaneManager",null,[955]);var rk=c(407),Yh=c(314);class Uj extends jj{constructor(ka,Za){super();this.uwc=this.twc=this.XUe=this.WUe=0;this.BYh=()=>{ii.InteractiveViewManager.instance.forEach(Cb=>{Cb.JLd()})};this.ga=ka;this.XWg=Za}Flh(ka,Za){const Cb=
V.App.ya.QC;Cb.parentNode&&(ka?1===ka&&(this.tw?((ka=Object(Yh.a)("FarPane"))&&ka.appendChild(Za),Za.classList.add("regionComposer"),V.App.ya.oI.registerBoundingWindowRectsChanged("farPane",(Rb,sc)=>{"DP"===sc||3===sc?Za.classList.add("DL"):Za.classList.remove("DL")})):Cb.parentNode.insertBefore(Za,Cb.nextSibling)):this.tw?((ka=Object(Yh.a)("NearPane"))&&ka.appendChild(Za),Za.classList.add("regionComposer")):Cb.parentNode.insertBefore(Za,Cb))}Dnh(ka,Za,Cb){this.tw||(Za=Za?Cb:-Cb,ka?this.uwc+=Za:this.twc+=
Za)}BPi(){if(!this.tw){var ka=V.App.ya.QC;Wn.WacAirSpace.JU(ka,Ln.a.ebg);if(this.WUe!==this.twc){const Za=new rk.a(ka);Za.jvk(this.WUe,this.twc,this.XWg);Wn.WacAirSpace.animate(Za,null,this.BYh);this.WUe=this.twc}this.XUe!==this.uwc&&(ka=new rk.a(ka),ka.kvk(this.XUe,this.uwc,this.XWg),Wn.WacAirSpace.animate(ka,null,this.BYh),this.XUe=this.uwc)}}}Object(e.a)(Uj,"TaskPaneManager",jj,[]);var Ck=c(293);class Ng extends Uj{get Hsi(){null==this.zpe&&(this.zpe=y.AFrameworkApplication.K?y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",
!1):!1);return this.zpe}constructor(ka,Za){super(ka,Za);this.dW=pd.KeyInputManager.mc(tl.a.iw,0);this.eW=pd.KeyInputManager.mc(tl.a.iw,4);this.RNe=this.ewc=null;this.f1g="AccCheckerTaskPane";this.ra=new ta.a;this.isPaneOpen=!1;this.zpe=this.oye=null;this.BBa(0,"SampleTaskPane");this.BBa(0,Ck.a.Ofb);this.BBa(1,Ck.a.BAk);this.BBa(1,"CustomTaskPane");this.BBa(1,Ck.a.uyf);this.BBa(1,ch.AFrame.xr);this.BBa(1,ch.AFrame.wjh);this.BBa(1,ch.AFrame.rjh);this.BBa(1,Ck.a.PLd);this.BBa(1,Ck.a.gIc);this.BBa(1,
Ck.a.SJc);this.m2j=(this.eIg=!!y.AFrameworkApplication.ta&&!!y.AFrameworkApplication.ta.Ob)&&y.AFrameworkApplication.ta.Ob.cDf;this.s1j=Ef.App.lHb;this.z1j=this.eIg&&y.AFrameworkApplication.ta.Ob.XTc;this.initialize();ka.gb(th.a.wbg,ql.a.application,Ng.wbg,96)}get nce(){if(!V.App.ya||!V.App.ya.QC)return null;this.RNe||(this.RNe=new un.a(V.App.ya.QC,bh.FocusManager.instance()));return this.RNe}Ub(){}JRi(ka,Za){const Cb=fo.a.instance,Rb=bh.FocusManager.instance(),sc=oo.EventHandlerManager.instance,
Wc=this;mm.UISurfaces.uu().then(xd=>{Wc.ewc=Wc.X2b(Rb);let oe;xd.renderTaskPaneGroups(ka,Za,(oe=new sd,oe.middleContainer=V.App.ya.QC,oe.onTabStripFocus=()=>{Rb.JC(Ck.a.Djc)},oe.onOpen=(Nd,$e)=>{Wc.dDf(Nd)&&rq.jWk(Nd,$e);sc.PWe($e,"focus",Wc.Kbi(Nd,Rb),!0);var hf=Wc.oui(Nd),bg=xd.selectors.getTabbedTaskPaneCount(hf?1:2);hf=hf?Ck.a.Tie:Ck.a.Djc;1===bg&&(Cb.nea(hf),this.isPaneOpen=!0,this.V_i({isPaneOpen:this.isPaneOpen,NOb:$e}));$e=Wc.Snf(Nd);if(bg=Rb.fe($e))bg.hGc=hf,Wc.gno(Nd)&&(bg.Xq(Wc.dW),bg.Xq(Wc.eW)),
Cb.bti($e)&&Cb.nx($e);this.Hsi&&this.QJd&&this.QJd.Dw(!0)},oe.onClose=(Nd,$e)=>{Wc.dDf(Nd);const hf=Wc.oui(Nd),bg=hf?Ck.a.Tie:Ck.a.Djc;xd.selectors.getTabbedTaskPaneCount(hf?1:2)||(Cb.nx(bg),this.isPaneOpen=!1,this.V_i({isPaneOpen:this.isPaneOpen,NOb:$e}));sc.W1f($e,"focus",Wc.Kbi(Nd,Rb),!0);this.Hsi&&this.QJd&&this.QJd.Dw(!0)},oe.setFocusCallback=(Nd,$e)=>{Wc.dDf(Nd)&&$e&&(Nd=Rb.fe(Wc.Snf(Nd)),Nd.GRk(),Nd.pea($e))},oe.onOverflowMenuOpen=()=>{if(Wc.ewc)Wc.ewc.onMenuOpen()},oe.onOverflowMenuClose=
()=>{if(Wc.ewc)Wc.ewc.onMenuClose()},oe.onShow=(Nd,$e)=>{2===$e&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{Rb.mg(Nd)},0)})},oe.onHide=(Nd,$e,hf)=>{hf&&1!==$e&&Rb.mg(Rb.fT)},oe.onResizeStart=()=>{if(V.App.ya&&(V.App.ya.QC.className=nd.AppFrame.clg,Wc.nce))Wc.nce.onMenuOpen()},oe.onResizeEnd=()=>{if(V.App.ya&&(Tj.a.xwi()||(V.App.ya.QC.className+=" "+V.App.ya.Lxh),Wc.nce))Wc.nce.onMenuClose()},oe));this.lia(Ck.a.Djc,Rb,Za,Wc);this.lia(Ck.a.Tie,Rb,ka,Wc);return null})}lia(ka,Za,Cb,Rb){const sc=
Za.fe(ka);sc.parent=ch.AFrame.qp;sc.zH=!0;Sf.a.instance.yBa(ka,Cb,!1);Bk.a.instance.yBa(ka,Cb,!1);ka=new Hp.DOMFocusListing(()=>Cb);ka.In(3);ka.In(2);ka.In(4);ka.In(1);Za.nla(()=>Cb,sc,ka).lU=!0;sc.Xq(Rb.dW);sc.Xq(Rb.eW)}Snf(ka){return ka===this.f1g?Ck.a.Bih:ka}Kbi(ka,Za){return()=>{Za.JC(this.Snf(ka))}}gno(ka){return ka===this.f1g?!1:!0}lCm(ka){return ka===Ck.a.Ofb}dDf(ka){return this.lCm(ka)||ka===Ck.a.Bih||0<=ka.indexOf("AppForOfficePanel")||ka===Ck.a.PLd||ka===Ck.a.uyf&&this.m2j||ka===Ck.a.gIc&&
this.s1j||ka===Ck.a.SJc&&this.z1j||ka===om.a.qCb?!0:!1}oui(ka){return ka===Ck.a.Ofb||"SampleTaskPane"===ka}static s8l(){return new Ng(y.AFrameworkApplication.xa,y.AFrameworkApplication.isRtl)}static wbg(ka,Za,Cb,Rb,sc){if(1===Cb)return 32;mm.UISurfaces.uu().then(Wc=>{Wc.showTaskPane(sc,Object.assign(new Wi.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new Fo,{type:"SampleTaskPaneProps"})}));return null});return 32}oYa(ka){this.ra.addHandler("onPaneToggle",ka)}Y2c(ka){this.ra.removeHandler("onPaneToggle",
ka)}V_i(ka){this.ra.raiseEvent("onPaneToggle",ka)}get QJd(){this.oye||(this.oye=K.a.instance.Ma("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.oye}}Object(e.a)(Ng,"TaskPaneManager",Uj,[194]);class Pm{constructor(){this.BS=null}get name(){return"WordEditor.TaskPaneManager"}yc(){}init(){this.BS=Ng.s8l();this.BS.Ub();V.App.ya.Fob=this.BS}dispose(){}}Object(e.a)(Pm,"PackageManager",null,[1,2]);c.d(L,"a",function(){return l})},1926:function(D,L,c){D=c(0);var l=c(171),e=c(731),a=c(1146),
k=c(21),x=c(2),y=c(67),m=c(48),u=c(44),z=c(6),v=c(17),E=c(8),F=c(76),J=c(474),K=c(98),H=c(444),P=c(5),N=c(602),M=c(202),I=c(233),T=c(20),U=c(1102),W=c(40),V=c(95),Y=c(42),da=c(778),ba=c(30),ja=c(88),sa=c(22),ta=c(58);class ra{constructor(Va,Ab,Zb,Kb){this.cHd=this.aHd=null;this.q7c=Va;this.aje=Ab;this.Gnj=Zb;this.Hnj=Kb}}Object(D.a)(ra,"TableSimplificationInformation",null,[]);var ma=c(91),Ba=c(31),Pa=c(480),Da=c(275),Ha=c(927),oa=c(1559),wa=c(304),ia=c(3),ca=c(11),pa=c(142),Ma=c(19),ya=c(276),Oa=
c(37),fa=c(267),Ca=c(10),Ta=c(651),eb=c(576),jb=c(364);class ob extends Sys.EventArgs{constructor(Va){super();this.Go=Va}}Object(D.a)(ob,"AfterTrimCompleteOnCopyArgs",Sys.EventArgs,[]);var Ya=c(1752);class Xa extends Ya.a{constructor(Va,Ab,Zb,Kb){super(Va,Ab,{});this.oSa=[];for(Va=0;Va<Zb.length;Va++)this.oSa.push(...Zb.J(Va).toArray());this.ACa=0;this.Vx=Kb;this.Go={}}}Object(D.a)(Xa,"BasicInternalCopyArguments",Ya.a,[]);class Sa extends Sys.EventArgs{constructor(Va,Ab){super();this.Go=Ab;this.oSa=
[];for(Ab=0;Ab<Va.length;Ab++)this.oSa.push(...Va.J(Ab).toArray())}}Object(D.a)(Sa,"BeforeCopyArguments",Sys.EventArgs,[]);class ab extends Sys.EventArgs{constructor(Va){super();this.Go=Va}}Object(D.a)(ab,"BeforePasteArguments",Sys.EventArgs,[]);class Hb extends Sys.EventArgs{constructor(Va,Ab,Zb,Kb){super();this.paragraph=Va;this.cpBegin=Ab;this.cpEnd=Zb;this.Go=Kb}}Object(D.a)(Hb,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var pb=c(1795),Mb=c(1796);class Qb{constructor(Va,Ab,Zb,Kb,dc,jc,zb,cc,
Ub){this.Kjc=Va;this.source=Ab;this.target=Zb;this.mUf=Kb;this.rowIndex=dc;this.so=jc;this.YYa=zb;this.gVi=cc;this.je=Ub}}Object(D.a)(Qb,"CoreInternalTablePasteArguments",null,[]);class Aa extends Sys.EventArgs{constructor(Va,Ab,Zb,Kb,dc){super();this.operation=Va;this.LSi=Ab;this.original=Zb;this.clone=Kb;this.Go=dc}}Object(D.a)(Aa,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var bb=c(134);c.d(L,"a",function(){return nb});class nb{constructor(Va,Ab,Zb,Kb,dc,jc,zb,cc,Ub,Wb,Qa,sb,Jb,pc,rc){this.oW=
this.Ys=null;this.UIe=!1;this.vL=this.Vza=null;this.eRk=(db,lb)=>{l.a.mark(5566);lb=lb.target;if(lb.Sd())return lb.Dg(),!0;db.ai(this.$Jc);return!0};this.$Jc=(db,lb)=>{lb=new pb.a(lb,null);const qa=new e.a(db,this.HGc,lb);qa.ul("ExecuteCoreCopyToInternalClipboard");this.aBn(lb);qa.run();db.ai(this.eGo);return!0};this.HGc=(db,lb)=>{if(!lb.source.Sd())return lb.Ji&&(lb.Ji.nCd=null),E.ULS.shipAssertTag(6305560,307,!1),this.Mh.logKpiFailure({kpiName:jb.a.KBd,errorName:"InternalCopyFailedSourceHasNoChildren"}),
!1;db.ai(this.VFh);return!0};this.VFh=(db,lb)=>{const qa=lb.insertAfter,Ga=lb.source,Fb=lb.target,$b=Ga.currentNode;var rb=this.kSi;if(!$b.Aga)return db.ai(this.GGc),!0;lb.Ji.BNb&&(lb.BNb=!0);if(!this.OOk(lb))return lb.Ria.LEa.c++,db.ai(this.GGc),!0;if(!lb.BNb&&($b.Q4b()&&lb.Ria.LEa.c++,$b.Q4b()||rb&&!$b.ajb(this.av)))return db.ai(this.GGc),!0;if(!lb.BNb&&rb&&!$b.hz)return Ga.dA()&&(lb.tme=!0,lb=new e.a(db,this.HGc,new pb.a(lb,qa)),lb.ul("RecursiveCoreCopyToInternalClipboard"),lb.run()),db.ai(this.GGc),
!0;rb=Fb.currentNode.Ei().ud;rb=N.a($b,rb,!0);rb.Cib=!0;this.sqa.Jae(lb.Ria.qEb,rb);Fb.rH(rb,qa,18===Ga.parentNode.type?1:Ga.role);Fb.Fi(rb);lb.insertAfter=rb;Ca.ParagraphReader.Yb(rb)&&(this.nBn(db,this.HGc,$b,rb,lb),this.mBn(db,$b,rb));this.USh($b,rb);Ga.dA()&&(E.ULS.shipAssertTag(6305562,307,!lb.tme),lb=new e.a(db,this.HGc,new pb.a(lb,null)),lb.ul("RecursiveCoreCopyToInternalClipboard"),lb.run());db.ai((xb,gb)=>this.B0k(xb,gb));return!0};this.GGc=(db,lb)=>{lb.tme&&(lb.insertAfter=lb.nCd,lb.tme=
!1);if(!lb.source.gt()){lb.Ji&&(lb.Ji.nCd=lb.insertAfter);const qa=lb.source;11!==qa.Xe||qa.R6b(-1)||this.OBn(db,qa.currentNode,lb.target.currentNode,lb);return!1}db.ai(this.VFh);return!0};this.eGo=(db,lb)=>{if(lb.ACa>=lb.oSa.length)return nb.ra.raiseEvent("AfterTrimCompleteOnCopy",new ob(lb.Go)),db.ai(this.A0k),!0;db=lb.oSa[lb.ACa];var qa=db.node,Ga=db.cpBegin;let Fb=db.cpEnd;if(!Ma.SelectionEditor.Xu(db))if(!lb.ACa&&Ma.SelectionEditor.Dk(db))Fb=Ga=Ca.ParagraphReader.textLength(qa);else if(Ca.ParagraphReader.im(db))Ga=
0,Fb=Ca.ParagraphReader.textLength(qa);else if(Ma.SelectionEditor.fba(db)){E.ULS.shipAssertTag(6305568,307,!lb.ACa);var $b=P.GraphIterator.$a(qa);Ga=$b.Ab(12);E.ULS.shipAssertTag(6305569,307,Ga);qa=$b.origin;Fb=Ga=Ca.ParagraphReader.textLength(qa)}else{if(V.OutlineReader.aYd(db))for(db=M.a.So(db.node);db.moveNext();)$b=db.currentNode,Ca.ParagraphReader.Yb($b)&&lb.oSa.push(Ba.a.createTextRange($b,0,Ca.ParagraphReader.textLength($b)));lb.ACa++;return!0}$b=lb.cVf[qa.id.toString()];E.ULS.shipAssertTag(6305570,
307,!!$b);if(!$b)return E.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:lb.ACa,["SelectedContextsLength"]:lb.oSa.length,["SelectedNodeType"]:qa.type,["ContextId"]:db.contextId}),lb.ACa++,!0;qa=ma.e($b);let rb,xb=!1;for(rb=qa.length-1;0<=rb;rb--)if(!qa[rb].bCa)if(4===qa[rb].zh)qa[rb].Kb.blob=null,qa[rb].Kb.blob=new Pa.a(qa[rb].Kb),lb.Ria.LEa.e++;else{qa[rb].Kb.blob=null;if(-1!==qa[rb].ze){var gb=qa[rb].Kb.formatting,Gb=void 0,ac=void 0;gb&&-1===gb.ze?(ac=qa[rb].ze+
1,Gb=qa[rb].O3-1,gb.ze=qa[rb].ze):(Gb=qa[rb].O3,ac=qa[rb].ze);for(gb=0;gb<Gb;gb++)$b.Ae.removeAt(ac,16);0<Gb&&(xb=!0)}Gb="";wa.f(qa[rb])?(Gb=" ",lb.Ria.LEa.f++):wa.g(qa[rb])&&(ac=wa.b(qa[rb]))&&(Gb=wa.a(ac),lb.Ria.LEa.g++);ac=qa[rb].Kb.cp;ac>=Ga&&ac<Fb&&(nb.characterPropertiesEditor.replaceTextRange(Ba.a.createTextRange($b,ac,ac+1),Gb,void 0,void 0,void 0,void 0,!0),Fb=Fb-1+Gb.length,lb.Ria.LEa.i++)}xb&&$b.Pm();this.RTn($b);nb.ra.raiseEvent("BeforeTrimOnCopy",new Hb($b,Ga,Fb,lb.Go));qa=Ca.ParagraphReader.textLength($b);
Fb<qa&&nb.characterPropertiesEditor.replaceTextRange(Ba.a.createTextRange($b,Fb,qa),"",void 0,void 0,void 0,void 0,!0);0<Ga&&nb.characterPropertiesEditor.replaceTextRange(Ba.a.createTextRange($b,0,Ga),"",void 0,void 0,void 0,void 0,!0);this.Hdm($b,lb.Ria.LEa);Ca.ParagraphReader.textLength($b)||lb.ACa!==lb.oSa.length-1||!Ma.SelectionEditor.Xu(db)||$b.Js||(db=P.GraphIterator.$a($b),db.Ab(25)&&(W.OutlineElementNavigator.Zd(db),this.Hh.d_a(db),lb.ACa&&(this.Ys.lb.Hua=!0)));lb.ACa!=lb.oSa.length-1||this.Hua||
$b.Qg(u.a.e4,u.a.Vba,u.a.Roa,u.a.dxa,u.a.J8);this.sqa.b2c(lb.Ria.R7d,lb.Ria.yzb,lb.Ria.jdb,$b);lb.ACa++;return!0};this.A0k=(db,lb)=>{this.Aia.YPb(null);lb.Vx.dispose();l.a.mark(5567);this.Van();this.oW=lb.Ria;this.VCi("Copy");this.azm&&E.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1};this.Mun=(db,lb)=>{if(lb.Kjc){if(lb.Kjc.inProgress)return!0;ba.TableCellReader.isTableCell(lb.source)||lb.source.fd(16);if(this.x9m(lb))return!1}else Oa.TableReader.isTable(lb.target)||lb.target.fd(14),
Oa.TableReader.isTable(lb.source)||lb.source.fd(14),sa.moveToCell(lb.target,lb.rowIndex,lb.so),sa.moveToCell(lb.source,0,0);if(ba.TableCellReader.gg(lb.source)||ba.TableCellReader.gg(lb.target))return!0;this.zun(lb,db);return!0};this.IGc=(db,lb)=>{if(!lb.source.Sd())return db.ai(this.Rlb),!0;db.ai(this.XFh);return!0};this.XFh=(db,lb)=>{const qa=lb.source,Ga=lb.target,Fb=qa.currentNode;if(!Fb.Aga||!Fb.IMa||this.Nmo(qa,Ga))return db.ai(this.x8e),!0;if(K.a.instance.J(1)&&Y.OutlineElementReader.Lh(qa)){if(!W.OutlineElementNavigator.Fe(qa).IMa)return W.OutlineElementNavigator.Zd(qa),
db.ai(this.x8e),!0;W.OutlineElementNavigator.Zd(qa)}E.ULS.shipAssertTag(6305608,307,!Fb.Q4b());var $b=Ga.currentNode.Ei().ud;$b=N.a(Fb,$b,!0);$b.SQa();$b.ITc=!0;this.bYn(qa,Ga);Ga.rH($b,lb.insertAfter,qa.role);Ga.Fi($b);lb.insertAfter=$b;ca.App.xd.Yp&&ca.App.xd.Vq.aH($b);this.USh(Fb,$b);lb=new e.a(db,this.IGc,new Mb.a(qa,Ga,null,lb.mUf,lb.Go));lb.ul("RecursiveCorePasteOperation");lb.run();db.ai(this.E0k);return!0};this.E0k=(db,lb)=>{const qa=lb.target,Ga=qa.currentNode,Fb=lb.source,$b=Fb.currentNode;
let rb=-1;lb.Go[nb.ywf]&&(rb=lb.Go[nb.ywf]);Ca.ParagraphReader.Yb(Ga)&&(this.aCn(db,this.IGc,$b,Ga,lb),this.WBn(db,$b,Ga));Ga.O_();lb.Go[U.a.Noi]?22===Ga.type&&(ba.TableCellReader.t_(Fb)||Ga.setValue(z.a.listID,Number.MAX_VALUE)):this.zL.lXn(Ga);if(Ca.ParagraphReader.Yb(Ga)&&(lb=ma.i(Ga,5),0<lb.length)){for(const xb of lb)!xb.properties.hasProperty(z.a.mKb)&&xb.properties.hasProperty(z.a.s8d)&&(lb=xb.properties.getValue(z.a.s8d),xb.properties.setValue(z.a.mKb,lb)),T.ImageReader.N9b()?T.ImageReader.fHb(xb.properties)&&
this.Nj.f6f(xb.properties,rb):T.ImageReader.Zx(xb.properties)||this.Nj.f6f(xb.properties,rb);Ga.Ei().contentReplicator.forceOutbound(null,null,null)}this.TSh(qa);this.ERo($b,Ga);Oa.TableReader.QX(Ga)&&E.ULS.sendTraceTag(524919814,3022,50,"TablePasted");this.hU&&ba.TableCellReader.Yna(qa)&&oa.a.Daj(Ga);qa.wc();db.ai(this.x8e);return!0};this.x8e=(db,lb)=>{if(!lb.source.gt())return db.ai(this.Rlb),!0;db.ai(this.XFh);return!0};this.Rlb=()=>{l.a.mark(5565);return!1};this.dWb=jc;this.Po=zb;this.Nj=Va;this.eSe=
Ab;this.XJ=Zb;this.Hh=Kb;this.zL=dc;this.Na=cc;this.Ic=Wb;this.rwd=Ub.create(2097162);this.a1f(this.rwd);this.kxe=Ub.create(2097162);this.a1f(this.kxe);this.ZUe=Ub.create(2097162);this.a1f(this.ZUe);this.Wud=this.rwd;this.KY=Qa;this.h2=sb;this.Wd=Jb;this.Mh=a.a.getInstance(jb.a.TYa);this.Mzc=pc;this.Fbk=pc.substr(0,3);this.O5=rc}get paragraphEditor(){return null!=this.UBg?this.UBg:this.UBg=k.a.instance.resolve("Box4.IParagraphEditor")}get Xb(){return null!=this.Hvg?this.Hvg:this.Hvg=k.a.instance.Ma("Box4.IFeatureHelper")}get av(){return this.Ys?
this.Ys.av:0}get Rzb(){return this.Ys.lb.Rzb}get Hua(){return this.Ys.lb.Hua}get Aia(){return this.Wud}get osj(){return this.ZUe}get y7e(){return this.Ys.YI&&!this.UIe}Thj(){this.UIe=!0}get kSi(){return!this.Ys.YI}get sqa(){return Ta.a.instance}a1f(Va){var Ab=new Ha.a(-1);this.dWb.Kl.pMa(Ab);const Zb=new P.GraphIterator;Zb.set(Ab);x.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");Ab=3;this.Na&&this.Na.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&
(Ab=0);Ab=this.Ic.Qc(Ab);Ab.Fu(Zb);Zb.Qf(Va,80);Ab.dispose()}PEd(Va,Ab=null){Va=Va.nb;this.Ys=Va.hb.clone();this.UIe=!1;Va=P.GraphIterator.$a(Va.D0);const Zb=P.GraphIterator.$a(this.Aia),Kb=this.Ic.Qc(3,ia.a.internalCopy);Kb.Fu(Zb);Va.Tb(82);do Va.currentNode.YPb(null);while(Va.Ti(82));Va=new e.a(Ab,this.eRk,new Xa(Va,Zb,this.Ys,Kb));Va.ul("InternalCopy");Va.Hg=!Ab||Ab.Hg;Va.run()}B0k(Va,Ab){var Zb=Ab.source;const Kb=Ab.target;var dc=Kb.currentNode,jc=Zb.currentNode;Ca.ParagraphReader.rh(Kb)&&(Ab.cVf[jc.id.toString()]=
dc);if(Ca.ParagraphReader.Yb(dc)){if(0<Ca.ParagraphReader.kdi(jc))if(0<this.Po.aG(jc).wt)jc.setValue(z.a.iRa,0);else{const zb=this.Po.k3(jc).wt;this.paragraphEditor.Xp.sca(dc,zb)}if(!this.kSc&&this.O5.hVi){Zb.wc();if(!Oa.TableReader.Jw(Kb)&&Zb.dFa&&!this.Hua)for(const zb of this.O5.eVf)dc.removeProperty(zb);Zb.Fi(jc)}}if(Ca.ParagraphReader.Yb(dc)){for(jc=0;jc<dc.Ae.length;jc++)dc.Ae.$p.Z(jc,fa.CharacterPropertiesEditor.sM),dc.Ae.Ps.Z(jc,fa.CharacterPropertiesEditor.VQ);E.ULS.shipAssertTag(6305565,
307,!!ca.App.xd);(this.Wd.Cg||K.a.instance.J(1)&&ca.App.Ov.iPb)&&dc.setValue(z.a.EPa,!0);dc.Qg(z.a.$Bb,z.a.kUi,z.a.VUf);K.a.instance.J(1)&&Ca.ParagraphReader.Yb(dc)&&dc.Qg(z.a.jwa)}this.kSi&&(this.TSh(Kb),Oa.TableReader.isTable(Kb)&&(dc=this.Ys.NN(),dc.moveNext(),(dc=ba.TableCellReader.CDa(Zb,dc.current.node))||(dc=new da.a(0,0)),Zb=new ra(dc,Kb,Oa.TableReader.Lfa(Zb),Oa.TableReader.krf(Zb)),this.eSe.value.j_n(Zb)));Y.OutlineElementReader.Lh(Kb)&&!Kb.Xr(2)&&(this.Hh.UL(Kb),Kb.wc());Kb.wc();Ab.Ji&&
(Ab.Ji.nCd=Ab.insertAfter);Va.ai(this.GGc);return!0}OOk(Va){const Ab=Va.source;if(Y.OutlineElementReader.Lh(Ab)&&Ab.vhb(12)){const Zb=Ab.Sd();if(Ca.ParagraphReader.Yb(Zb)&&Zb.ia(z.a.NM,null))return Ab.wc(),Va.BNb=!1;Ab.wc()}else if(Ca.ParagraphReader.Yb(Ab.Kn)&&Ab.Kn.ia(z.a.NM,null))return!1;return!0}mBn(Va,Ab,Zb){Ab=ma.e(Ab);Zb=ma.e(Zb);for(let Kb=0;Kb<Ab.length;Kb++)Ab[Kb].gQf(Zb[Kb],Va,this.HGc)}RTn(Va){if(Va=Va.qa){var Ab=new F.a;for(let Zb=0;Zb<Va.length;Zb++){const Kb=Va.J(Zb);Kb.tj&&Ab.add(Kb)}for(const Zb of Ab)Zb.tj=
null}}get azm(){return!P.GraphIterator.$a(this.Aia).Sd()}aCj(){this.Wud=this.ZUe}$Bj(){this.Wud=this.rwd}cTo(){this.Wud=this.kxe}get gMm(){return this.Aia===this.rwd}get nBm(){return this.Aia===this.kxe}AAh(){const Va=P.GraphIterator.$a(this.Aia);for(;Va.Sd();)Va.Dg()}VCi(Va){const Ab=this.oW.LEa.b;Va+="-"+Ab;this.oW.LEa.b=Va;this.oW.qEb.b=Va;this.oW.R7d.b=Va;this.oW.yzb.b=Va;this.oW.jdb.b=Va;this.sqa.CYm(this.oW.LEa);this.sqa.YHf(this.oW.qEb);this.sqa.YDi(this.oW.R7d);this.sqa.MHf(this.oW.yzb);this.sqa.JHf(this.oW.jdb);
this.oW.LEa.b=Ab;this.oW.qEb.b=Ab;this.oW.R7d.b=Ab;this.oW.yzb.b=Ab;this.oW.jdb.b=Ab}dVi(Va,Ab,Zb,Kb,dc=null,jc=null){this.VCi("Paste");Ab=P.GraphIterator.$a(Ab);const zb=P.GraphIterator.$a(this.Aia);var cc=null;dc&&(cc=new H.a(V.OutlineReader.yLh,V.OutlineReader.cbl),cc=dc.equals(new H.a(-1,-1))?new H.a(0,0):dc.tie(cc));if(this.Hoi())if(zb.Sd(),T.ImageReader.Wu(zb.currentNode))dc=zb.currentNode,zb.wc(),zb.rH(this.Hh.pAb(),null,1),zb.Sd(),zb.rH(dc,null,2),zb.wc(),zb.Fi(dc),zb.Dg(),this.Thj();else if(I.isFloatingEmbeddedFileNode(zb.currentNode)){dc=
zb.currentNode;zb.wc();zb.rH(this.Hh.pAb(),null,1);zb.Sd();var Ub=this.Hh.UL(zb);Ub=Ba.a.Tc(Ub,0);nb.characterPropertiesEditor.replaceTextRange(Ub,"<<"+I.getEmbeddedFileName(dc)+">>",void 0,void 0,void 0,void 0,!0);zb.wc();zb.wc();zb.Fi(dc);zb.Dg();this.Thj()}this.KY&&this.KY.HCf(Zb)||!this.uyi(zb,Ab)?(l.a.mark(5564),zb.currentNode.YPb(null),Va={},Va[nb.ywf]=Kb,bb.ListItemReader.Kh(Zb)&&(Va[U.a.Noi]=!0),Zb=new Mb.a(zb,Ab,Zb,cc,Va),Kb=new e.a(jc,this.IGc,Zb),Kb.ul("ExecuteCorePasteFromInternalClipboard"),
Kb.Hg=!jc||jc.Hg,this.bBn(Zb),Kb.run()):(zb.currentNode.YPb(null),E.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.QXn(jc,zb,Ab,cc,Va),E.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}Sxi(Va){if(Va&&Va.isValid){const Ab=P.GraphIterator.$a(this.Aia);return this.uyi(Ab,Va)}return!1}uyi(Va,Ab){if(ba.TableCellReader.Yna(Ab)&&1===Va.pq()){Va.Tb(1);if(Y.OutlineElementReader.Lh(Va)){W.OutlineElementNavigator.Fe(Va);if(Oa.TableReader.isTable(Va)){Oa.TableReader.kB(Va.currentNode)&&
E.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(Ab.Ab(14)&&!Oa.TableReader.kB(sa.getContainingTable(Ab))){if(E.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!this.hU)return!0}else if(E.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),this.kSc&&!this.hU)return!0;if(this.hU)return!0}W.OutlineElementNavigator.Zd(Va)}Va.wc()}return!1}QXn(Va,Ab,Zb,Kb,dc){let jc,zb;let cc;Object(m.a)("ReplaceTableCellsFromClipboardTable",!0);Zb.Ab(14);
jc=ta.a.Wr(Zb);zb=ja.a(Zb);Zb.fd(14);var Ub=Oa.TableReader.ag(Zb.currentNode);cc=Oa.TableReader.Xg(Zb.currentNode);const Wb=Oa.TableReader.ag(Ab.currentNode),Qa=Oa.TableReader.Xg(Ab.currentNode);E.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",Ub,cc,Wb,Qa,jc,zb);if(this.hU&&ya.TableBorderSelectionCache.QOc())this.Hgo(),Ub=Math.min(this.nje+1,Ub),cc=Math.min(this.Teg+1,cc),this.Teg-this.Yzo==cc-1&&(this.zrj==
this.nje?zb=0:this.nje-this.zrj==Ub-1&&(Zb.Sd(),jc=ta.a.Wr(Zb),zb=ja.a(Zb)));else{this.Vza=eb.a.O6b;const sb=jc+Wb-Ub;0<sb&&(sa.moveToLastRow(Zb),E.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+sb),this.eSe.value.insertRows(Zb,!1,sb,this.Vza),E.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),Zb.fd(14));const Jb=zb+Qa-cc;if(0<Jb){E.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Jb);try{this.eSe.value.insertColumns(Zb,cc,!1,Jb,this.Vza)}catch(pc){throw E.ULS.sendTraceTag(19269661,
307,10,"Insert columns failed: {0}",pc.toString()),pc;}E.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}(0<sb||0<Jb)&&Object(m.a)("InsertRowsAndColumnsForInternalCCP",!0)}Ub=this.OHl(Ub,cc,Wb,Qa,jc,zb);E.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");Va=new e.a(Va,this.Mun,new Qb(null,Ab,Zb,Kb,jc,zb,Ub,null,dc));Va.ul("ExecuteCorePasteTableInTable");Va.Hg=!1;Va.run()}Van(){if(this.kSc){for(var Va=P.GraphIterator.$a(this.Aia),Ab=Va.currentNode;14!==Va.Xe;)if(Ab=Va.Sd(),
!Ab){E.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.QKi(Ab)}}Zan(Va){this.kSc&&this.QKi(Va)}OCo(Va){const Ab=P.GraphIterator.$a(Va);this.XJ.hib(Ab,null,!0);Va.gg=!1;Va.rowSpan=1;Va.colSpan=1}QKi(Va){if(Va&&14===Va.type){E.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var Ab={},Zb=Oa.TableReader.ag(Va),Kb=Oa.TableReader.Xg(Va),dc=P.GraphIterator.$a(Va);sa.forEachCellInTable(dc,(jc,zb,
cc)=>{const Ub={};jc=jc.currentNode;if(16===jc.type)if(jc.gg)nb.pDh(zb,cc)in Ab||(this.OCo(jc),Ub.IsGhostCell="->false");else{nb.KMn(Va,jc,zb,cc,Zb,(Qa,sb,Jb)=>{Ub.rowSpan=String.format("{0}:{1}->{2}",Qa,sb,Jb)});nb.JMn(Va,jc,cc,zb,Kb,(Qa,sb,Jb)=>{Ub.colSpan=String.format("{0}:{1}->{2}",Qa,sb,Jb)});const Wb=String.format("{0},{1}-{2},{3}",zb,cc,zb+jc.rowSpan,cc+jc.colSpan);for(let Qa=0;Qa<jc.rowSpan;Qa++)for(let sb=0;sb<jc.colSpan;sb++)if(Qa||sb)Ab[nb.pDh(zb+Qa,cc+sb)]=Wb}if(0<J.a(Ub).length){if(void 0===
Ub.IsGhostCell||null===Ub.IsGhostCell){if(void 0===Ub.rowSpan||null===Ub.rowSpan)Ub.rowSpan=jc.rowSpan;if(void 0===Ub.colSpan||null===Ub.colSpan)Ub.colSpan=jc.colSpan}E.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",zb,cc,Ub)}return!0});nb.ukl(Ab)}}Hdm(Va,Ab){if(Va&&Ca.ParagraphReader.Yb(Va)){var Zb=0,Kb=P.GraphIterator.$a(Va);for(Kb.Tb(6);!Kb.Dr;){var dc=Kb.currentNode;Kb.Ti(6);T.ImageReader.Wu(dc)?T.ImageReader.jDf(dc)?P.GraphIterator.$a(dc).vhb(59)?E.ULS.sendTraceTag(590455048,
307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.paragraphEditor.bFh(dc,Ba.a.Tc(Va,Zb),!0),Ab.d++,Zb++):(dc=P.GraphIterator.$a(dc),dc.Ab(12),dc.Dg(),Ab.h++):E.ULS.shipAssertTag(6305571,307,!1)}}}get kSc(){return!!this.Na&&this.Na.$("ComplexTableCellPasteWithFormattingIsEnabled")}OHl(Va,Ab,Zb,Kb,dc,jc){const zb=[];let cc,Ub,Wb,Qa;this.hU&&ya.TableBorderSelectionCache.QOc()?(cc=Math.min(Va,dc+Zb),Ub=Math.min(Ab,jc+Kb),Qa=dc):(Qa=0,cc=Math.max(dc+Zb,Va));
for(;Qa<cc;Qa++)for(this.hU&&ya.TableBorderSelectionCache.QOc()?Wb=jc:(Wb=0,Ub=jc+Kb,Qa<dc?Wb=Ab:Qa>=dc&&Qa<Math.min(dc+Zb,Va)?Wb=jc:Qa>=dc+Zb&&Qa<Va?Wb=Ab:Ub=Math.max(jc+Kb,Ab));Wb<Ub;Wb++)zb.push(Array(2)),zb[zb.length-1][0]=Qa,zb[zb.length-1][1]=Wb;return zb}bYn(Va,Ab){if(this.kSc)if(!Ab||!Va)E.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:Va,["table"]:Ab});else if(16===Ab.currentNode.type&&16===Va.parentNode.type){Ab=Ab.currentNode;Va=Va.parentNode;var Zb={};
Ab.gg!==Va.gg&&(Ab.gg=Va.gg,Zb.IsGhostCell=Ab.gg);Ab.F3!==Va.F3&&(Ab.F3=Va.F3,Zb.IsSkippedCell=Ab.F3);Ab.Qnb!==Va.Qnb&&(Ab.Qnb=Va.Qnb,Zb.ShouldRenderCell=Ab.Qnb);Ab.colSpan!==Va.colSpan&&(Zb.ColSpan=String.format("{0}<={1}.",Ab.colSpan,Va.colSpan),Ab.colSpan=Va.colSpan);Ab.rowSpan!==Va.rowSpan&&(Zb.RowSpan=String.format("{0}<={1}.",Ab.rowSpan,Va.rowSpan),Ab.rowSpan=Va.rowSpan);J.a(Zb)}}Nmo(Va,Ab){let Zb=!1;Y.OutlineElementReader.Lh(Va)&&(Zb=Y.OutlineElementReader.UP(Va)&&this.oLm(Ab));return Zb}oLm(Va){if(Va)return Va=
Va.Xe,36===Va||38===Va||16===Va;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}WBn(Va,Ab,Zb){Ab=ma.e(Ab);const Kb=ma.e(Zb);for(let dc=Ab.length-1;0<=dc;dc--){if(!Ab[dc].ric(Zb)){const jc=Ba.a.createTextRange(Zb,Ab[dc].Kb.cp,Ab[dc].Kb.cp+1);nb.characterPropertiesEditor.replaceTextRange(jc,"",void 0,void 0,void 0,void 0,!0)}Ab[dc].MYc(Kb[dc],Va,this.IGc,this.nBm)}}ERo(Va,Ab){if(K.a.instance.J(1)&&Oa.TableReader.QX(Va)){let Zb=0;const Kb=Oa.TableReader.ag(Va);
for(const dc of Oa.TableReader.qx(Va,0,Kb-1))dc.dv&&Zb++;Va=this.Ic.Qc(4);Va.Eb(Ab);Ab.properties.setValue(v.a.oya,Kb-Zb);Va.dispose()}}get hU(){null==this.vL&&(x.AFrameworkApplication.ye("he991617;3eed2178"),this.vL=x.AFrameworkApplication.K?x.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.vL}S3d(){return!P.GraphIterator.$a(this.Aia).Sd()}Hoi(){return this.y7e?1===P.GraphIterator.$a(this.Aia).pq():!1}W2h(Va){try{return this.BKl(Va)}catch(Ab){return E.ULS.sendTraceTag(23643968,
307,10,"GetCopySourceFromDOMTree failed with exception:{0}",Ab.message),0}}BKl(Va){let Ab=0;if(Va&&(Ab=this.AKl(Va),!Ab&&Va.childNodes))for(let Zb=0;Zb<Va.childNodes.length&&!(Ab=this.W2h(Va.childNodes[Zb]));Zb++);return Ab}AKl(Va){if(1===Va.nodeType&&Va.getAttribute){Va=(Va.getAttribute("class")||"").split(" ");for(const Ab of Va)if(Ab.startsWith(this.Fbk))return Ab.startsWith(this.Mzc)?this.av&&Ab===this.Mzc+this.av?3:2:1}return 0}nBn(Va,Ab,Zb,Kb,dc){dc.Go||(dc.Go={});nb.ra.raiseEvent("OnParagraphCopy",
new Aa(Va,Ab,Zb,Kb,dc.Go))}OBn(Va,Ab,Zb,Kb){Kb.Go||(Kb.Go={});nb.ra.raiseEvent("OnCopyComplete",new Aa(Va,null,Ab,Zb,Kb.Go))}bBn(Va){Va.Go||(Va.Go={});nb.ra.raiseEvent("BeforePaste",new ab(Va.Go))}aBn(Va){Va.Go||(Va.Go={});nb.ra.raiseEvent("BeforeCopy",new Sa(this.Ys,Va.Go))}aCn(Va,Ab,Zb,Kb,dc){nb.ra.raiseEvent("OnParagraphPaste",new Aa(Va,Ab,Zb,Kb,dc.Go))}TSh(Va){ba.TableCellReader.isTableCell(Va)&&(Va.Tb(1)||this.XJ.I6(Va,!0),Va.wc())}USh(Va,Ab){this.h2.nwa(Ab)&&(Ab.width=Va.width)}static oYe(Va){nb.ra.addHandler("OnParagraphCopy",
Va)}static uyd(Va){nb.ra.addHandler("OnParagraphPaste",Va)}static nVn(Va){nb.ra.removeHandler("OnParagraphPaste",Va)}static Dqk(Va){nb.ra.addHandler("OnCopyComplete",Va)}static Hpk(Va){nb.ra.addHandler("BeforePaste",Va)}static JUn(Va){nb.ra.removeHandler("BeforePaste",Va)}static Fpk(Va){nb.ra.addHandler("BeforeCopy",Va)}static Ipk(Va){nb.ra.addHandler("BeforeTrimOnCopy",Va)}static zpk(Va){nb.ra.addHandler("AfterTrimCompleteOnCopy",Va)}static get characterPropertiesEditor(){return null!=nb.ktg?nb.ktg:
nb.ktg=k.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get AJ(){return Da.a.instance}static get lf(){return pa.PageReader.instance}static ukl(Va){const Ab={};for(const Zb of J.a(Va)){const Kb=Va[Zb];Ab[Kb]=Kb in Ab?String.format("{0}|{1}",Ab[Kb],Zb):Zb}1<=J.a(Ab).length&&E.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",Ab)}static JMn(Va,Ab,Zb,Kb,dc,jc){Ab.colSpan>dc-Zb&&(jc&&jc("A",Ab.colSpan,dc-Zb),Ab.colSpan=dc-Zb);Va=nb.Yqo(Va,Ab,Kb,Zb);Ab.colSpan!==Va&&(jc&&
jc("B",Ab.colSpan,Va),Ab.colSpan=Va)}static KMn(Va,Ab,Zb,Kb,dc,jc){Ab.rowSpan>dc-Zb&&(jc&&jc("A",Ab.rowSpan,dc-Zb),Ab.rowSpan=dc-Zb);Va=nb.Zqo(Va,Ab,Zb,Kb);Ab.rowSpan!==Va&&(jc&&jc("B",Ab.rowSpan,Va),Ab.rowSpan=Va)}static Yqo(Va,Ab,Zb,Kb){return nb.Gmj(Va,Ab.colSpan,(dc,jc)=>{sa.moveToCell(dc,Zb,Kb+jc)})}static Zqo(Va,Ab,Zb,Kb){return nb.Gmj(Va,Ab.rowSpan,(dc,jc)=>{sa.moveToCell(dc,Zb+jc,Kb)})}static Gmj(Va,Ab,Zb){if(14!==Va.type)throw Error.argument("tableNode is not a Table.");if(!Zb)throw Error.argumentNull("MoveToCellAction");
for(let dc=1;dc<Ab;dc++){var Kb=P.GraphIterator.$a(Va);Zb(Kb,dc);Kb=Kb.currentNode;if(!Kb||16!==Kb.type||!Kb.gg)return dc}return Ab}static pDh(Va,Ab){return Va+","+Ab}zun(Va,Ab){for(;Va.target.Sd();)Va.target.Dg();Va.Kjc=new e.a(Ab,Va.gVi?Va.gVi:this.IGc,new Mb.a(Va.source,Va.target,null,Va.mUf));Va.Kjc.ul("ExecuteCorePasteCellContentInCell");Va.Kjc.Hg=!1;Va.Kjc.run()}x9m(Va){let Ab=!1;if(this.hU&&ya.TableBorderSelectionCache.QOc()){const Zb=ja.a(Va.target),Kb=ta.a.Wr(Va.target);let dc=this.nje;isNullOrUndefined(Va.YYa[Va.YYa.length-
1])||(dc=Math.min(dc,Va.YYa[Va.YYa.length-1][0]));let jc=this.Teg;isNullOrUndefined(Va.YYa[Va.YYa.length-1])||(jc=Math.min(jc,Va.YYa[Va.YYa.length-1][1]));ba.TableCellReader.CPa(Va.target)||ba.TableCellReader.CPa(Va.source)||Kb==dc&&Zb==jc?Ab=!0:(ba.TableCellReader.isTableCell(Va.target)||Va.target.fd(16),ba.TableCellReader.lba(Va.source)?(ba.TableCellReader.CPa(Va.target)||(sa.moveToNextRow(Va.target),sa.moveToColumnByIndex(Va.target,Va.so),E.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),
sa.moveToNextOrPreviousCell(Va.source,!1,!1)):ba.TableCellReader.lba(Va.target)||Zb==jc?(sa.moveToNextRow(Va.source),sa.moveToColumnByIndex(Va.source,0),E.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),sa.moveToNextRow(Va.target),sa.moveToColumnByIndex(Va.target,Va.so),E.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):(sa.moveToNextOrPreviousCell(Va.target,!1,!1),sa.moveToNextOrPreviousCell(Va.source,!1,!1)))}else ba.TableCellReader.CPa(Va.source)?
Ab=!0:(ba.TableCellReader.isTableCell(Va.target)||Va.target.fd(16),ba.TableCellReader.lba(Va.source)?(sa.moveToNextRow(Va.target),sa.moveToColumnByIndex(Va.target,Va.so),E.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):sa.moveToNextOrPreviousCell(Va.target,!1,!1),sa.moveToNextOrPreviousCell(Va.source,!1,!1));Ab&&(this.KY&&this.KY.YBn(Va.target,Va.YYa),Oa.TableReader.isTable(Va.target)||Va.target.fd(14),this.Zan(Va.target.currentNode),E.ULS.sendTraceTag(7869377,307,
50,"End of internal paste table in table"));return Ab}Hgo(){this.nje=ya.TableBorderSelectionCache.b9.bottomMostRowSelected;this.Teg=ya.TableBorderSelectionCache.b9.rightMostColumnSelected;this.Yzo=ya.TableBorderSelectionCache.b9.leftMostColumnSelected;this.zrj=ya.TableBorderSelectionCache.b9.topMostRowSelected}}nb.ra=new y.a;nb.ywf="PasteConstrainingWidth";Object(D.a)(nb,"InternalClipboard",null,[])},1936:function(D,L,c){D=c(0);var l=c(2),e=c(107),a=c(60),k=c(200),x=c(21),y=c(16),m=c(75),u=c(133),
z=c(17),v=c(43),E=c(6),F=c(8),J=c(82),K=c(48),H=c(28),P=c(322),N=c(98),M=c(14),I=c(5),T=c(111),U=c(20),W=c(40),V=c(263),Y=c(42),da=c(266),ba=c(22),ja=c(91),sa=c(176),ta=c(881),ra=c(3),ma=c(96),Ba=c(64),Pa=c(11),Da=c(102),Ha=c(47),oa=c(511),wa=c(603),ia=c(235),ca=c(19),pa=c(24),Ma=c(52),ya=c(37),Oa=c(249),fa=c(10),Ca=c(1544),Ta=c(1563),eb=c(241),jb=c(171),ob=c(57),Ya=c(535),Xa=c(55);class Sa extends eb.a{constructor(Aa,bb,nb,Va,Ab,Zb,Kb,dc){super();this.ebh=this.ZB=null;this.init(Aa);this.ul("FormattingViewOperation");
this.bib(l.AFrameworkApplication.xa,bb,Va,Ab,Zb);this._context=nb;this.a8a=0;this.xs=!0;this.pXj=Kb;this.Rm=dc}get Aaa(){return this.Rm.instance}run(){const Aa=this._context.view;var bb=null;Aa.re&&(bb=Aa.nb);if(bb){var nb=bb.hb.lb,Va=!Ta.a.R9b(this.actionId);!nb||Sa.Zf.zDf(nb,Va)?(Sa.Jc.Zb(ma.a.kf,{["Reason"]:Ba.a.tE}),this.xs=!1):this.Aaa&&this.Aaa.i$b(nb)?(Sa.Jc.Zb(ma.a.kf,{["Reason"]:Ba.a.externalSelection}),this.xs=!1):Sa.Vg.Oya(fa.ParagraphReader.ZT,bb.pg)&&(Sa.Jc.Zb(ma.a.kf,{["Reason"]:Ba.a.IN}),
this.xs=!1)}else Sa.Jc.Zb(ma.a.kf,{["Reason"]:Ba.a.Gba}),this.xs=!1;1!==this.behavior&&this.xs||(this.xs&&(nb=bb.hb.lb,1===bb.hb.length&&1===nb.length&&ca.SelectionEditor.gl(nb.Qa)&&ja.b(nb.Qa)&&(Sa.Jc.Zb(ma.a.kf,{["Reason"]:Ba.a.kGc}),this.xs=!1)),(nb=this.xs)&&this.actionId===ra.a.u4&&((nb=Array.from(bb.hb.lb).some(T.FormattingReader.r7e))||Sa.Jc.Zb(ma.a.kf,{["Reason"]:Ba.a.Fdf})),this.ar=nb?32:8,this.a8a=3);this.a8a||(jb.a.mark(5730),this.ebh=Ya.SelectionReferenceFactory.instance.rAb(),nb=bb.hb.lb.Qa,
this.ZB=new Ha.GraphTransaction(15),this.ZB.Eb(nb.node),this.ZB.kk=this.actionId,this.a8a=1);if(1===this.a8a){this.dC||this.m5c(this._context.Yj);if(1===this.z4a())return;this.a8a=2}if(2===this.a8a){if(this.actionId===ra.a.u4)if(bb=bb.pg,bb.Hw)for(nb=0;nb<bb.length;nb++)Va=bb.getContext(nb),this.zwj(Va);else this.zwj(bb);Xa.a.F7e&&this.sGo(this.actionId,this.qd);this.ebh.rpa(this.actionId===ra.a.pY||this.actionId===ra.a.wta);(bb=Object(J.a)(22,this.qd))&&!bb.CSa||ob.FocusManager.instance().mg(Aa.GI);
this.ZB.dispose();this.ZB=null;Pa.App.ya.updateCommandUI();jb.a.mark(5731);this.a8a=3;this.ar=32}3===this.a8a&&(this.pXj.process(this.actionId,this._context,this.behavior,this.response),this.Ipa())}sGo(Aa,bb){const nb={};nb.FormattingActionId=Aa;nb.FormattingActionData=bb;8===this.ga.Rb(ra.a.vzd,2,nb)&&F.ULS.sendTraceTag(509110153,368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",Aa,bb)}zwj(Aa){(ca.SelectionEditor.Xu(Aa)||ca.SelectionEditor.Dk(Aa))&&Pa.App.KM.Dca(Aa.node)}static get Zf(){return Oa.a.instance}static get Vg(){return ia.ContextSetEditor.instance}static get Jc(){return u.a.instance}}
Object(D.a)(Sa,"FormattingViewOperation",eb.a,[]);var ab=c(1025),Hb=c(950),pb=c(84);c.d(L,"a",function(){return Qb});const Mb=new Set([ra.a.e_,ra.a.o0,ra.a.clearFormatting,ra.a.fCa,ra.a.gCa,ra.a.VYa,ra.a.uta,ra.a.WYa]);class Qb{constructor(Aa,bb,nb=null,Va,Ab,Zb,Kb,dc,jc,zb,cc,Ub,Wb){this.kpiName="ChangeCaseCommandUsage";this.y7="wwaengidc";this.Djb=new Map;this.Z1g=new Set;this.yCb=()=>new ta.a(2);this.KZi=(Qa,sb,Jb,pc,rc)=>{pc=!0;sb.contextId!==M.a.view&&(pc=!1);if(1===Jb&&!pc)return 8;if(Qa===
ra.a.b1c)Qa=rc.formatting,rc=rc.bcg;else{if(!sb.view||!sb.view.re)return 2;sb=sb.view;if(!sb.nb||!sb.nb.hb.lb)return 8;Qa=rc;rc=sb.nb.hb}this.VWk(rc,Qa);return 32};this.a_e=(Qa,sb,Jb,pc,rc,db)=>new Sa(Qa,sb,Jb,pc,rc,db,this.VXj,Qb.Gw());this.rzd=(Qa,sb,Jb,pc,rc)=>{var db,lb,qa;let Ga=!0,Fb=sb;const $b=!Ta.a.R9b(Qa);sb.contextId!==M.a.Fd&&sb.contextId!==M.a.Vc?Ga=!1:(Qb.Zf.i8(Fb,!1,$b)&&(Qb.Jc.Zb(ma.a.Ym,{["Reason"]:Ba.a.tE}),Ga=!1),Qb.Gw()&&Qb.Gw().instance&&Qb.Gw().instance.aU(Fb)&&(Ga=!1),Ga&&ca.SelectionEditor.gl(sb)&&
ja.b(Fb)&&(Qb.Jc.Zb(ma.a.Ym,{["Reason"]:Ba.a.kGc}),Ga=!1),fa.ParagraphReader.ZT(sb)&&(Qb.Jc.Zb(ma.a.kf,{["Reason"]:Ba.a.IN}),Ga=!1));if(1===Jb||!Ga)return Ga?32:8;if(sb.contextId===M.a.Vc)return 2;(sb=null===(db=this.Ao)||void 0===db?void 0:db.LPd(Fb))&&(Fb=sb);this.eno(Qa)&&(db=ca.SelectionEditor.mPb(Fb),ca.SelectionEditor.jf(db)||(Fb=db));db="boolean"===typeof rc&&rc;sb=!1;(null===(lb=this.Bra)||void 0===lb?0:lb.annotateRange)&&(null===(qa=this.Bra)||void 0===qa?0:qa.EGb(Fb.node))&&(sb=this.w2(Fb,
Qa,rc,db));sb&&Qa!==ra.a.u4||Qb.IHa.w2(Fb,rb=>{this.Dhc(rb,Qa,rc,Fb.cpEnd)},db);Fb.node.jr&&(lb=[Object.assign(new H.a,{name:"Source",string:"CharacterFormatting"})],K.a("TOCFormatting",!0,void 0,lb));this.Oym(Qa)&&this.SBd(Fb,Qa);pc&&Ca.a.Gob&&(pc.Ur|=Ca.a.xgb(Fb.node));return 32};this.T8c=(Qa,sb,Jb)=>1!==Jb&&2===Jb?(this.Djb.set("Source","Shortcut"),Qa=sb.node.characterData.substr(sb.cpBegin,sb.cpEnd-sb.cpBegin),Qb.UDf(Qa,0,Qa.length)?this.SBd(sb,ra.a.fCa):Qb.BKm(Qa,Qa.length)?this.SBd(sb,ra.a.uta):
this.SBd(sb,ra.a.gCa)):32;this.Mdb=(Qa,sb,Jb)=>{let pc=!0;Qa=!Ta.a.R9b(Qa);sb.contextId!==M.a.Fd&&sb.contextId!==M.a.Vc?pc=!1:(Qb.Zf.i8(sb,!1,Qa)&&(Qb.Jc.Zb(ma.a.Ym,{["Reason"]:Ba.a.tE}),pc=!1),pc&&ca.SelectionEditor.gl(sb)&&ja.b(sb)&&(Qb.Jc.Zb(ma.a.Ym,{["Reason"]:Ba.a.kGc}),pc=!1),pc&&fa.ParagraphReader.ZT(sb)&&(Qb.Jc.Zb(ma.a.kf,{["Reason"]:Ba.a.IN}),pc=!1));if(1===Jb||!pc)return pc?32:8;sb=sb.node;this.As.G1b(sb,!1);sb.jr&&(sb=[Object.assign(new H.a,{name:"Source",string:"ClearFormatting"})],K.a("TOCFormatting",
!0,void 0,sb));return 32};this.jFc=(Qa,sb,Jb,pc,rc)=>{Qa={};Qa[ab.a.yIa]=6168;Qa[ab.a.xIa]=6169;const db=sb.view;var lb=null;db.Yi&&(lb=db);var qa=!0;let Ga=32;lb&&(lb=lb.nb.hb.lb)&&(Qb.Zf.zDf(lb)?(Qb.Jc.Zb(ma.a.kf,{["Reason"]:Ba.a.tE}),Ga=8,qa=!1):1===Jb&&(Ga=32,qa=!1));qa&&(qa=new Ha.GraphTransaction(1===Jb?3:15),qa.Eb(db.root),Ga=ab.a.Voa(ra.a.Mdb,sb,Jb,pc,rc,Qa,12),qa.dispose());return Ga};this.j_e=(Qa,sb,Jb,pc,rc)=>{var db,lb=!0,qa=32;const Ga=!Ta.a.R9b(Qa);sb.contextId!==M.a.Vc?lb=!1:Qb.Zf.i8(sb,
!1,Ga)&&(Qb.Jc.Zb(ma.a.Ym,{["Reason"]:Ba.a.tE}),lb=!1);if(1===Jb||!lb)return lb?32:8;Jb=sb.node;Qa===ra.a.clearFormatting&&(Qb.Qn.kFc(Jb),this.As.SAh(Jb),lb=this.ax.qC(Jb).Ni(this.ax.wordStyleIdNormal),this.FL.rJ(lb,Jb,!0));Jb=Qb.qj.yrf(sb);!Jb&&(lb=null===(db=this.Ao)||void 0===db?void 0:db.LPd(sb))&&(sb=lb,Jb=pa.SelectionFactory.Zn(sb));if(Jb)qa=Ma.a.mAb(Jb),qa=l.AFrameworkApplication.xa.Nf(qa,Qa,2,!1,pc,rc);else{pc=Object(J.a)(22,rc);db=T.FormattingReader.Ar(sb);if(!db)return 16;db=db.cache;switch(Qa){case ra.a.font:Qb.CXh();
if(pc&&pc.qd){const {fontName:Fb,Qca:$b,bold:rb,italic:xb}=Qb.Unf(pc.qd);Qb.qj.Aee(Fb);Qb.qj.J9f($b);Object(oa.a)()&&(Qa=1==rb,rc=1==xb,Qa||rc)&&(Qb.qj.XK(Qa),Qb.qj.setItalic(rc))}break;case ra.a.Ev:F.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");Qb.qj.Ev(rc);break;case ra.a.Hpa:Qb.qj.Ev(rc);this.recentColors.Kcb(rc)||F.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ra.a.Nea:Qb.qj.Nea();break;case ra.a.pY:F.ULS.sendTraceTag(594899722,
340,50,"Font background color is selected from Standard colors.");Qb.qj.Yxa(rc);break;case ra.a.h9:Qb.qj.Yxa(rc);this.recentColors.Kcb(rc)||F.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ra.a.wta:Qb.qj.ACd();break;case ra.a.wA:Qb.CXh();Qb.qj.wA(pc.qd);break;case ra.a.e_:Qa=Qb.qj.eG(z.a.fontSize,db.fontSize);Qb.qj.wA(this.ue.e_(Qa));break;case ra.a.o0:Qa=Qb.qj.eG(z.a.fontSize,db.fontSize);Qb.qj.wA(this.ue.o0(Qa));break;case ra.a.bold:Qa=
Qb.qj.eG(z.a.bold,db.isBold);Qb.qj.XK(!Qa);break;case ra.a.setItalic:Qa=Qb.qj.eG(z.a.italic,db.isItalic);Qb.qj.setItalic(!Qa);break;case ra.a.underline:Qa=Qb.qj.eG(z.a.underline,db.isUnderline);Qb.qj.x4(!Qa);break;case ra.a.jia:Qb.qj.jia(rc);break;case ra.a.superscript:Qa=Qb.qj.eG(z.a.superscript,db.isSuperscript);Qb.qj.Kpa(!Qa);break;case ra.a.subscript:Qa=Qb.qj.eG(z.a.subscript,db.isSubscript);Qb.qj.hHa(!Qa);break;case ra.a.strikethrough:Qa=Qb.qj.eG(z.a.strikethrough,db.isStrikethrough);Qb.qj.gia(!Qa);
break;case ra.a.Ou:Qa=Qb.qj.eG(v.a.Ou,db.isDoubleStrikethrough);Qb.qj.uee(!Qa);break;case ra.a.clearFormatting:Qb.qj.c5a();break;case ra.a.u4:rc.hasProperty(z.a.IK)&&Qb.qj.u4(rc.getValue(z.a.IK));rc.hasProperty(E.a.noProof)&&(Qa=rc.getValue(E.a.noProof),Qb.qj.Ldo(Qa));break;default:this.Z1g.has(Qa)||(this.Z1g.add(Qa),(rc=e.ActionManager.Q$(Qa))&&rc.length||(rc="UnknownAction"),F.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${rc} (${Qa})`))}}Pa.App.ya.updateCommandUI();
return qa};this.JS=(Qa,sb,Jb,pc,rc)=>{pc=Qb.Jc.vp(ra.a.Eao);var db=!0;sb.contextId!==M.a.endOfParagraph&&(db=!1);if(1===Jb||!db)return db?32:8;Jb=sb.node;db=I.GraphIterator.$a(sb.node);db.yd();db=db.ega(4);if((db=!!db&&Qb.Ad.k8(db))&&!Pa.App.Dbc)return 8;var lb=!fa.ParagraphReader.textLength(Jb);pc.properties.Z("Action",Qa.toString());pc.properties.Z("ListContext",db.toString());pc.properties.Z("IsEmptyParagraph",lb.toString());F.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",
Qa,db,lb);db=Jb.qa.last;this.$Tn(Jb,Qa);var qa=!!db.formatting;const Ga=Jb.getValue(E.a.endOfParagraphFormatting);lb=this.Jd.u_a(Jb);qa=!qa&&Ga&&Ga.equals(a.a.nil)?new sa.a(db,a.a.nil):lb.Sf(lb.Kb);this.Dhc(lb,Qa,rc,db.cp);N.a.instance.J(1)&&Qb.lj.YMb(Jb,db,sb.cpBegin,sb.cpEnd,qa,lb,Qb.Kd.Cg);pc.end();return 32};this.ela=(Qa,sb,Jb)=>{Qa=!0;const pc=I.GraphIterator.$a(sb.node);pc.yd();sb.contextId===M.a.endOfParagraph&&pc.ega(4)||(Qb.Jc.Zb(ma.a.Ym,{["Reason"]:Ba.a.dHf}),Qa=!1);return Qb.Ad.k8(pc.currentNode)?
1!==Jb&&Qa?32:Qa?32:8:8};this.hpa=(Qa,sb,Jb,pc,rc)=>{Qa=!0;sb.contextId!==M.a.paragraph&&(Qa=!1);if(1===Jb&&!Qa)return 8;Jb=sb.node;-1!==rc.Sh?rc.Sh!==fa.ParagraphReader.Uv(Jb)&&(rc.Sh=0):rc.Sh=fa.ParagraphReader.Uv(Jb);Qa=this.Po.Mgb(Jb);rc.it?(!rc.wim&&this.zim(rc.it,Qa)&&2===rc.it.specialIndentType&&(rc.it.specialIndentType=0),rc.it.lFb===Qa.lFb&&k.a.Vva(rc.it.iB,Qa.iB)||(rc.it.iB=Number.MAX_VALUE),rc.it.mFb===Qa.mFb&&k.a.Vva(rc.it.qna,Qa.qna)||(rc.it.qna=Number.MAX_VALUE)):rc.it=Qa;sb=Qb.Vg.Wrh(sb.Yj);
void 0!==sb&&null!==sb&&(sb=sb.node,void 0!==sb&&null!==sb&&(sb=V.WordSectionNavigator.instance.gJ(sb),void 0!==sb&&null!==sb&&(sb=Qb.Vf.Ot(sb)-(Qb.Vf.OI(sb)+Qb.Vf.zK(sb)+Pa.App.Sya),Qa.RQc=sb-Qa.iB,Qa.QQc=sb-Qa.qna,rc.it.QQc=Math.min(rc.it.QQc,Qa.QQc),rc.it.RQc=Math.min(rc.it.RQc,Qa.RQc))));sb=this.JV.VDa(Jb);rc.spacing?(rc.spacing.beforeSpacing=Qb.Lnh(sb.beforeSpacing,rc.spacing.beforeSpacing),rc.spacing.afterSpacing=Qb.Lnh(sb.afterSpacing,rc.spacing.afterSpacing),rc.spacing.lineSpacing.unit===
sb.lineSpacing.unit&&k.a.Vva(rc.spacing.lineSpacing.value,sb.lineSpacing.value)||(rc.spacing.lineSpacing.unit=0,rc.spacing.lineSpacing.value=0)):rc.spacing=sb;sb=new I.GraphIterator;sb.set(Jb);sb.Ab(11);if(Jb=sb.fd(11))rc.isRtl=Y.OutlineElementReader.Mm(Jb);Jb=Qb.Ad.Fw(sb);sb=16;void 0!==Jb&&null!==Jb&&(sb=Jb.listType);rc.listType=Qb.iLl(rc.listType,sb);rc.wx=16===rc.listType?null:Jb;return 32};this.KEn=(Qa,sb,Jb,pc,rc)=>{rc.isRtl=Y.OutlineElementReader.Mm(W.OutlineElementNavigator.El(sb.node));return 32};
this.Gqh=(Qa,sb,Jb)=>{if(Qa===ra.a.rNb)Qa=!0;else if(Qa===ra.a.qNb)Qa=!1;else return 2;Qa&&this.kEi(sb);if(1===Jb)return 32;this.Hh.jNb(W.OutlineElementNavigator.El(sb.node),Qa);return 32};this.AEn=(Qa,sb,Jb,pc,rc)=>{Qa=sb.node;rc.isRtl=Y.OutlineElementReader.isRtl(W.OutlineElementNavigator.El(Qa));rc.Sh=U.ImageReader.Uv(Qa);return 32};this.KFn=(Qa,sb,Jb,pc,rc)=>{Qa=sb.node;rc.isRtl=Y.OutlineElementReader.isRtl(W.OutlineElementNavigator.El(Qa));rc.Sh=ya.TableReader.Uv(Qa);-1!==rc.Sh&&rc.Sh||(rc.Sh=
rc.isRtl?3:1);return 32};this.t_e=(Qa,sb,Jb,pc,rc)=>{let db;if(!({Qx:db}=Ta.a.Q$f(Jb,sb)).returnValue)return db;const lb=sb.node;switch(Qa){case ra.a.qNb:this.Hh.Zhc(lb,!1);break;case ra.a.rNb:this.kEi(sb);this.Hh.Zhc(lb,!0);break;case ra.a.u4:db=l.AFrameworkApplication.xa.Nf(sb.Yj,Qa,Jb,!0,pc,rc),32===db&&fa.ParagraphReader.im(sb)&&Qb.L0c&&Qb.L0c.Dca(lb)}return 32};this.YQk=(Qa,sb,Jb,pc,rc)=>{const db={};db[ab.a.yIa]=6168;db[ab.a.xIa]=6169;var lb=sb.view;const qa=new Ha.GraphTransaction(1===Jb?3:
15);qa.Eb(lb.root);let Ga=ab.a.Voa(Qa,sb,Jb,pc,rc,db,0),Fb=null;lb.Yi&&(Fb=lb);lb=!0;let $b=null;Fb&&($b=Fb.nb.hb.lb)&&(Qa=!Ta.a.R9b(Qa),Qb.Zf.zDf($b,Qa)?(Qb.Jc.Zb(ma.a.kf,{["Reason"]:Ba.a.tE}),Ga=8,lb=!1):1===Jb&&(Ga=32,lb=!1),Qb.Vg.Oya(fa.ParagraphReader.ZT,Fb.nb.pg)&&(Qb.Jc.Zb(ma.a.kf,{["Reason"]:Ba.a.IN}),Ga=8,lb=!1));lb&&this.GKm($b)&&(Ga=ab.a.Voa(ra.a.Mdb,sb,Jb,pc,rc,db,12));qa.dispose();return Ga};this.XQk=(Qa,sb,Jb)=>{Qa=!0;sb.contextId!==M.a.paragraph&&sb.contextId!==M.a.Vc?Qa=!1:Qb.Zf.y2a(sb)&&
(Qb.Jc.Zb(ma.a.Ym,{["Reason"]:Ba.a.tE}),Qa=!1);if(1===Jb||!Qa)return Qa?32:8;sb=sb.node;Jb=new Ha.GraphTransaction(15);Jb.Eb(sb);Qb.Qn.kFc(sb);this.As.G1b(sb,!0);this.FL.n5e(sb);Jb.dispose();return 2};this.Xdm=(Qa,sb,Jb)=>{Qa=!0;sb.contextId!==M.a.view&&(Qa=!1);if(1===Jb&&!Qa)return 8;if(!sb.view||!sb.view.re)return 2;sb=sb.view;if(!sb.nb||!sb.nb.hb.lb)return 8;if(Qb.Vg.Oya(fa.ParagraphReader.ZT,sb.nb.pg))return Qb.Jc.Zb(ma.a.kf,{["Reason"]:Ba.a.IN}),8;sb=sb.nb.hb;for(const pc of sb)for(const rc of pc)if(rc&&
rc.contextId!==M.a.Fd&&rc.contextId!==M.a.Vc&&rc.contextId!==M.a.paragraph&&rc.contextId!==M.a.endOfParagraph)return 2;return 32};this.F4a=(Qa,sb,Jb,pc,rc)=>{Qa=!0;sb.contextId!==M.a.paragraph&&(Qa=!1);if(1===Jb&&!Qa)return 8;rc.it||(sb=sb.node,Jb=this.Po.Mgb(sb),rc.it=Jb,sb=W.OutlineElementNavigator.El(sb),rc.isRtl=sb?Y.OutlineElementReader.Mm(sb):!1);return 32};this.LFn=(Qa,sb,Jb,pc,rc)=>{sb=sb.node;Qa=W.OutlineElementNavigator.El(sb);rc.it||(sb=this.w_l(sb),sb=this.Po.Mgb(sb),rc.it=sb,rc.isRtl=
Y.OutlineElementReader.isRtl(Qa));return 32};this.VXj=Aa;this.Bra=bb;this.M5=nb;this.Ao=Va;this.ue=Ab;this.Jd=Zb;this.As=Kb;this.JV=dc;this.FL=zb;this.ax=jc;this.Hh=cc;this.Po=Wb}get recentColors(){return null!=this.uCg?this.uCg:this.uCg=x.a.instance.Ma("Box4.UI.RecentColorsSectionHandler")}get vLd(){return!!this.M5&&this.M5.enabled}Ub(){const Aa=l.AFrameworkApplication.xa,bb=this.KEn;(Qb.Xb?Qb.Xb.iA(40):l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?
(Aa.pa(ra.a.font,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.wA,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.e_,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.o0,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.Ev,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.Hpa,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.Nea,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.pY,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.h9,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.wta,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.bold,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.setItalic,M.a.endOfParagraph,
this.JS),Aa.pa(ra.a.underline,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.jia,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.superscript,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.subscript,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.strikethrough,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.Ou,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.u4,M.a.endOfParagraph,this.JS),Aa.pa(ra.a.clearFormatting,M.a.endOfParagraph,this.JS)):Pa.App.Dbc&&(Aa.pa(ra.a.font,M.a.endOfParagraph,this.ela),Aa.pa(ra.a.wA,M.a.endOfParagraph,this.ela),Aa.pa(ra.a.Ev,
M.a.endOfParagraph,this.ela),Aa.pa(ra.a.Hpa,M.a.endOfParagraph,this.ela),Aa.pa(ra.a.Nea,M.a.endOfParagraph,this.ela),Aa.pa(ra.a.bold,M.a.endOfParagraph,this.ela),Aa.pa(ra.a.setItalic,M.a.endOfParagraph,this.ela),Aa.pa(ra.a.superscript,M.a.endOfParagraph,this.ela),Aa.pa(ra.a.subscript,M.a.endOfParagraph,this.ela),Aa.pa(ra.a.strikethrough,M.a.endOfParagraph,this.ela),Aa.pa(ra.a.Ou,M.a.endOfParagraph,this.ela),Aa.pa(ra.a.e_,M.a.endOfParagraph,this.ela),Aa.pa(ra.a.o0,M.a.endOfParagraph,this.ela));const nb=
Pa.App.iTa.TGc(Va=>wa.OutlineElementGeneralizer.xma(Va.hb,!0));Aa.gb(ra.a.l4e,M.a.view,this.Xdm,100);Aa.gb(ra.a.T8c,M.a.Fd,this.T8c,1028);Aa.pa(ra.a.C4a,M.a.view,this.KZi);Aa.pa(ra.a.b1c,M.a.view,this.KZi);Aa.pa(ra.a.hpa,M.a.view,nb);Aa.pa(ra.a.hpa,M.a.paragraph,this.hpa);Aa.pa(ra.a.hpa,M.a.image,this.AEn);Aa.pa(ra.a.hpa,M.a.unsupportedObject,bb);Aa.pa(ra.a.hpa,M.a.table,this.KFn);Aa.pa(ra.a.F4a,M.a.view,nb);Aa.pa(ra.a.F4a,M.a.paragraph,this.F4a);Aa.pa(ra.a.F4a,M.a.table,this.LFn);Aa.Uc(ra.a.C4a,
99);Aa.Uc(ra.a.b1c,1127);Aa.Uc(ra.a.hpa,97);Aa.Uc(ra.a.F4a,97);this.KL(Aa,ra.a.font);this.KL(Aa,ra.a.wA);this.KL(Aa,ra.a.e_);this.KL(Aa,ra.a.o0);Aa.Hcb(ra.a.$Xh,M.a.view,this.a_e);Aa.Uc(ra.a.$Xh,1092);this.KL(Aa,ra.a.Ev);this.KL(Aa,ra.a.Hpa);this.KL(Aa,ra.a.Nea);this.KL(Aa,ra.a.pY);this.KL(Aa,ra.a.h9);this.KL(Aa,ra.a.VYa);this.KL(Aa,ra.a.fCa);this.KL(Aa,ra.a.gCa);this.KL(Aa,ra.a.uta);this.KL(Aa,ra.a.WYa);this.KL(Aa,ra.a.wta);this.KL(Aa,ra.a.bold);Aa.RMb(ra.a.bold,this.yCb);this.KL(Aa,ra.a.setItalic);
Aa.RMb(ra.a.setItalic,this.yCb);this.KL(Aa,ra.a.underline);Aa.RMb(ra.a.underline,this.yCb);this.KL(Aa,ra.a.jia);this.KL(Aa,ra.a.superscript);Aa.RMb(ra.a.superscript,this.yCb);this.KL(Aa,ra.a.subscript);Aa.RMb(ra.a.subscript,this.yCb);this.KL(Aa,ra.a.strikethrough);Aa.RMb(ra.a.strikethrough,this.yCb);this.KL(Aa,ra.a.Ou);Aa.RMb(ra.a.Ou,this.yCb);Aa.gb(ra.a.mPa,M.a.Fd,this.rzd,96);Aa.Hcb(ra.a.u4,M.a.view,this.a_e);Aa.pa(ra.a.u4,M.a.paragraph,this.t_e);Aa.pa(ra.a.u4,M.a.Fd,this.rzd);Aa.pa(ra.a.u4,M.a.Vc,
this.j_e);Aa.pa(ra.a.clearFormatting,M.a.view,this.YQk);Aa.pa(ra.a.clearFormatting,M.a.paragraph,this.XQk);Aa.pa(ra.a.clearFormatting,M.a.Fd,this.rzd);Aa.pa(ra.a.clearFormatting,M.a.Vc,this.j_e);Aa.Uc(ra.a.clearFormatting,1036);Aa.pa(ra.a.Mdb,M.a.Fd,this.Mdb);Aa.pa(ra.a.Mdb,M.a.Vc,this.Mdb);Aa.pa(ra.a.jFc,M.a.view,this.jFc);Aa.pa(ra.a.qNb,M.a.view,Ta.a.Mv);Aa.pa(ra.a.qNb,M.a.paragraph,this.t_e);Aa.pa(ra.a.qNb,M.a.unsupportedObject,this.Gqh);Aa.Uc(ra.a.qNb,1028);Aa.pa(ra.a.rNb,M.a.view,Ta.a.Mv);Aa.pa(ra.a.rNb,
M.a.paragraph,this.t_e);Aa.pa(ra.a.rNb,M.a.unsupportedObject,this.Gqh);Aa.Uc(ra.a.rNb,1028)}KL(Aa,bb){Aa.Hcb(bb,M.a.view,this.a_e);Aa.pa(bb,M.a.Fd,this.rzd);Aa.pa(bb,M.a.Vc,this.j_e);Aa.Uc(bb,1036)}VWk(Aa,bb){for(const dc of Aa)for(const jc of dc){Aa=null;if(jc.contextId===M.a.Fd){if(ja.b(jc))continue;Aa=[];var nb=jc.node.qa;if(nb){var Va=nb.length-1;const zb=jc.cpBegin,cc=jc.cpEnd;let Ub=!1;const Wb=jc.node.characterData;if(Wb&&""!==Wb){var Ab=Wb.substr(zb,cc-zb);Ab&&""!==Ab&&y.a.A7e(Ab,0,Ab.length)&&
(Ub=!0)}Ab=!1;for(let Qa=0;Qa<Va;Qa++){var Zb=nb.J(Qa).cp,Kb=nb.J(Qa+1).cp;if(nb.J(Qa).formatting&&Math.max(Zb,zb)<Math.min(Kb,cc)){if(Wb&&""!==Wb&&(Zb=Zb<zb?zb:Zb,Kb=Wb.substr(Zb,(Kb<cc?Kb:cc)-Zb),!Ub&&y.a.A7e(Kb,0,Kb.length)))continue;Ab=!0;Aa.push(nb.J(Qa).formatting)}else if(Ab)break}nb.J(Va).formatting&&jc.cpEnd>nb.J(Va).cp&&Aa.push(nb.J(Va).formatting)}}else if(jc.contextId===M.a.paragraph&&!fa.ParagraphReader.ZT(jc)){if(Aa=[],nb=jc.node.qa)for(Va=0;Va<nb.length;Va++)nb.J(Va).formatting&&Aa.push(nb.J(Va).formatting)}else if(jc.contextId===
M.a.endOfParagraph)Aa=[T.FormattingReader.Ar(jc)];else if(jc.contextId===M.a.Vc){this.jEn(jc,bb);return}if(Aa&&0<Aa.length)for(const zb of Aa)if(T.FormattingReader.Eig(bb,zb.cache,jc))return}}jEn(Aa,bb){if(Aa=T.FormattingReader.Ar(Aa)){Aa=Aa.cache;var nb=Qb.qj.eG(z.a.bold,Aa.isBold);bb.bold=nb?1:0;nb=Qb.qj.eG(z.a.italic,Aa.isItalic);bb.italic=nb?1:0;nb=Qb.qj.eG(z.a.underline,Aa.isUnderline);bb.underline=nb?1:0;bb.underlineType=Qb.qj.eG(z.a.underlineType,Aa.underlineType);nb=Qb.qj.eG(z.a.superscript,
Aa.isSuperscript);bb.superscript=nb?1:0;nb=Qb.qj.eG(z.a.subscript,Aa.isSubscript);bb.subscript=nb?1:0;nb=Qb.qj.eG(z.a.strikethrough,Aa.isStrikethrough);bb.strikethrough=nb?1:0;nb=Qb.qj.eG(v.a.Ou,Aa.isDoubleStrikethrough);bb.Ou=nb?1:0;nb=Qb.qj.eG(z.a.font,Aa.BE);bb.fontName=Da.a.l0a(nb);bb.Qca=Aa.He;bb.fontSize=Qb.qj.eG(z.a.fontSize,Aa.fontSize);bb.fontColor=Qb.qj.eG(z.a.fontColor,Aa.fontColor);bb.highlight=Qb.qj.eG(z.a.highlight,Aa.highlight)}}eno(Aa){return Aa===ra.a.underline||Aa===ra.a.jia||Aa===
ra.a.strikethrough||Aa===ra.a.Ou||Aa===ra.a.pY}static Unf(Aa){return"string"===typeof Aa?{fontName:Aa,Qca:-1,bold:2,italic:2}:Aa}w2(Aa,bb,nb,Va){var Ab;const Zb=Aa.cpBegin,Kb=Aa.cpEnd,dc=Aa.node;var jc=T.FormattingReader.Ar(Aa);let zb=Zb;const cc=null===(Ab=l.AFrameworkApplication.K)||void 0===Ab?void 0:Ab.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);Ab=Qb.Kd.Cg;if(cc&&(Ab||dc.Js))return!1;if(Mb.has(bb))for(const Ub of dc.qa)if(!(Ub.cp<=Zb)){if(Ub.cp>=Kb)break;Ub.formatting&&
Ub.formatting.cache.fontSize!=jc.cache.fontSize&&(jc=this.Znf(Aa.node,jc,bb,nb,cc?null:Va),this.Bra.annotateRange(Aa.node,cc?dc.qa.i_a(zb):zb,cc?dc.qa.i_a(Ub.cp):Ub.cp,jc),zb=Ub.cp,jc=Ub.formatting)}bb=this.Znf(Aa.node,jc,bb,nb,cc?null:Va);this.Bra.annotateRange(Aa.node,cc?dc.qa.i_a(zb):zb,cc?dc.qa.i_a(Kb):Kb,bb);return!0}Znf(Aa,bb,nb,Va,Ab){const Zb={},Kb=Object(J.a)(22,Va),dc=bb.cache;switch(nb){case ra.a.bold:2===Va.value&&(Va.value=dc.isBold?0:1);Zb[z.a.bold.id]=1===Va.value;break;case ra.a.setItalic:2===
Va.value&&(Va.value=dc.isItalic?0:1);Zb[z.a.italic.id]=1===Va.value;break;case ra.a.underline:2===Va.value&&(Va.value=dc.isUnderline?0:1);Zb[z.a.underline.id]=1===Va.value;break;case ra.a.jia:Zb[z.a.underlineType.id]=Va.number;break;case ra.a.superscript:2===Va.value&&(Va.value=dc.isSuperscript?0:1);Zb[z.a.superscript.id]=1===Va.value;1===Va.value&&(Zb[z.a.subscript.id]=!1);break;case ra.a.subscript:2===Va.value&&(Va.value=dc.isSubscript?0:1);Zb[z.a.subscript.id]=1===Va.value;1===Va.value&&(Zb[z.a.superscript.id]=
!1);break;case ra.a.strikethrough:6!==l.AFrameworkApplication.xa.iD?F.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===Va.value&&(Va.value=dc.isStrikethrough?0:1);Zb[z.a.strikethrough.id]=1===Va.value;break;case ra.a.Ou:2===Va.value&&(Va.value=dc.isDoubleStrikethrough?0:1);Zb[v.a.Ou.id]=1===Va.value;break;case ra.a.font:if(Kb&&Kb.qd){const {fontName:zb,Qca:cc,bold:Ub,italic:Wb}=Qb.Unf(Kb.qd);
Va=zb.substr(0,Qb.LGi);this.vLd&&(Zb[E.a.KS.id]=Va,Zb[E.a.iC.id]=Va,Zb[E.a.IZ.id]=Va,Zb[E.a.g_.id]=Va,Zb[E.a.Le.id]=cc,Zb[E.a.Ye.id]=cc,Zb[E.a.Je.id]=cc,Zb[E.a.Me.id]=cc);Zb[z.a.font.id]=Va;Zb[E.a.He.id]=cc;if(Object(oa.a)()){Va=1==Ub;var jc=1==Wb;if(Va||jc)Zb[z.a.bold.id]=Va,Zb[z.a.italic.id]=jc}}break;case ra.a.Ev:Va=Hb.a.instance.WMa(Aa,Va);Zb[z.a.fontColor.id]=Va;break;case ra.a.Hpa:jc=Hb.a.instance.WMa(Aa,Va);Zb[z.a.fontColor.id]=jc;this.recentColors.Kcb(Va)||F.ULS.sendTraceTag(529006977,340,
50,"Color selected from Recent Colors section. Menu: Font");break;case ra.a.Nea:Zb[z.a.fontColor.id]=pb.a.auto;break;case ra.a.pY:Zb[z.a.highlight.id]=parseInt(Va,16);break;case ra.a.h9:Zb[z.a.highlight.id]=parseInt(Va,16);this.recentColors.Kcb(Va)||F.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ra.a.wta:Zb[z.a.highlight.id]=pb.a.auto;break;case ra.a.wA:Zb[z.a.fontSize.id]=this.ue.d2b(Kb.qd);break;case ra.a.e_:Zb[z.a.fontSize.id]=this.ASl(dc.fontSize);
break;case ra.a.o0:Zb[z.a.fontSize.id]=this.WLl(dc.fontSize);break;case ra.a.mPa:if(Va=null===(jc=Qb.yz)||void 0===jc?void 0:jc.mPa)for(const zb of Va.Fl())Zb[zb.id]=Va.Lf(zb);break;case ra.a.clearFormatting:if(Va=bb.sn)for(const zb of Va.Fl())Zb[zb.id]=null;Zb[E.a.Bzb.id]=!0;break;case ra.a.fCa:case ra.a.gCa:case ra.a.VYa:case ra.a.uta:case ra.a.WYa:dc.NOa&&2===dc.capitalization&&(Zb[v.a.capitalization.id]=0)}null!=Ab&&(Zb[l.AFrameworkApplication.Vjf]=Ab);return Zb}ASl(Aa){Aa=this.ue.e_(Aa);return this.ue.d2b(Aa)}WLl(Aa){Aa=
this.ue.o0(Aa);return this.ue.d2b(Aa)}Dhc(Aa,bb,nb,Va){var Ab=Aa.cache;const Zb=Object(J.a)(22,nb);switch(bb){case ra.a.bold:2===nb.value&&(nb.value=Ab.isBold?0:1);this.ue.XK(Aa,1===nb.value);break;case ra.a.setItalic:2===nb.value&&(nb.value=Ab.isItalic?0:1);this.ue.setItalic(Aa,1===nb.value);break;case ra.a.underline:2===nb.value&&(nb.value=Ab.isUnderline?0:1);this.ue.x4(Aa,1===nb.value);break;case ra.a.jia:this.ue.jia(Aa,nb);break;case ra.a.superscript:2===nb.value&&(nb.value=Ab.isSuperscript?0:
1);this.ue.Kpa(Aa,1===nb.value);break;case ra.a.subscript:2===nb.value&&(nb.value=Ab.isSubscript?0:1);this.ue.hHa(Aa,1===nb.value);break;case ra.a.strikethrough:6!==l.AFrameworkApplication.xa.iD?F.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===nb.value&&(nb.value=Ab.isStrikethrough?0:1);this.ue.gia(Aa,1===nb.value);break;case ra.a.Ou:2===nb.value&&(nb.value=Ab.isDoubleStrikethrough?
0:1);this.ue.uee(Aa,1===nb.value);break;case ra.a.font:if(Zb&&Zb.qd){const {fontName:Kb,Qca:dc,bold:jc,italic:zb}=Qb.Unf(Zb.qd);this.ue.bia(Aa,Kb.substr(0,Qb.LGi));this.ue.J9f(Aa,dc);Object(oa.a)()&&(nb=1==jc,Va=1==zb,nb||Va)&&(this.ue.XK(Aa,nb),this.ue.setItalic(Aa,Va))}break;case ra.a.Ev:F.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");this.ue.Ev(Aa,nb,null);break;case ra.a.Hpa:this.ue.Ev(Aa,nb,null);this.recentColors.Kcb(nb)||F.ULS.sendTraceTag(594899727,
340,50,"Color selected from Recent Colors section. Menu: Font");break;case ra.a.Nea:this.ue.Nea(Aa);break;case ra.a.pY:F.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");this.ue.Yxa(Aa,nb);break;case ra.a.h9:this.ue.Yxa(Aa,nb);this.recentColors.Kcb(nb)||F.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ra.a.wta:this.ue.ACd(Aa);break;case ra.a.wA:this.ue.wA(Aa,Zb.qd);break;case ra.a.e_:this.ue.Rgi(Aa);
break;case ra.a.o0:this.ue.Emj(Aa);break;case ra.a.u4:Ab=nb.ia(E.a.noProof,!1);this.ue.O8f(Aa,nb.getValue(z.a.IK),Va,Ab);break;case ra.a.mPa:this.ue.Cee(Aa);break;case ra.a.clearFormatting:this.ue.ula(Aa);break;case ra.a.fCa:case ra.a.gCa:case ra.a.VYa:case ra.a.uta:case ra.a.WYa:Ab.NOa&&2===Ab.capitalization&&this.ue.KQk(Aa)}}$Tn(Aa,bb){ra.a.clearFormatting===bb&&W.OutlineElementNavigator.El(Aa).properties.removeProperty(z.a.U_)}zim(Aa,bb){return this.arh(Aa,bb)||this.arh(bb,Aa)}arh(Aa,bb){return(1===
Aa.specialIndentType||!Aa.specialIndentType)&&2===bb.specialIndentType}w_l(Aa){Aa=I.GraphIterator.$a(Aa);Aa.Ab(11);ba.moveToCell(Aa,0,0);Aa.Sd();Aa.Taa();return Aa.currentNode}GKm(Aa){return!Aa||ca.SelectionEditor.hm(Aa)||1===Aa.length&&ca.SelectionEditor.gl(Aa.Qa)&&!ca.SelectionEditor.Hib(Aa.Qa)?!1:!0}kEi(Aa){Qb.qah.ob(Aa.contextId)||(F.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",Aa.contextId),Qb.qah.Z(Aa.contextId,!0))}Oym(Aa){return Aa===ra.a.VYa||Aa===ra.a.fCa||Aa===ra.a.gCa||Aa===ra.a.uta||
Aa===ra.a.WYa}SBd(Aa,bb){const nb=Aa.node,Va=nb.characterData.substr(Aa.cpBegin,Aa.cpEnd-Aa.cpBegin);this.Djb.set("Command",bb.toString());m.Health.instance.recordKpiUsage(this.kpiName,1,this.y7,this.Djb);bb=Qb.dBo(Va,bb);nb.Fpa(nb.characterData.substr(0,Aa.cpBegin)+bb+nb.characterData.substr(Aa.cpEnd));return 32}static get qj(){return Qb.yz||(Qb.yz=x.a.instance.resolve("Box4.IInsertionPointFormatting"))}static Gw(){return Qb.Rm||(Qb.Rm=x.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Vg(){return ia.ContextSetEditor.instance}static get Zf(){return Oa.a.instance}static get Jc(){return u.a.instance}static get Xb(){return null!=
Qb.Evg?Qb.Evg:Qb.Evg=x.a.instance.Ma("Box4.IFeatureHelper")}static get L0c(){return Pa.App.KM}static get Kd(){return null!=Qb.iFg?Qb.iFg:Qb.iFg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get lj(){return null!=Qb.KEg?Qb.KEg:Qb.KEg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get IHa(){return null!=Qb.mEg?Qb.mEg:Qb.mEg=x.a.instance.resolve("Box4.TextFormattingHelper")}static get Ad(){return null!=Qb.FAg?Qb.FAg:Qb.FAg=x.a.instance.resolve("Box4.List.IListReader")}static get Qn(){return null!=
Qb.rAg?Qb.rAg:Qb.rAg=x.a.instance.resolve("Box4.List.IListEditor")}static get Vf(){return da.a.instance}static iLl(Aa,bb){return 42===Aa?bb:Aa!==bb||16===Aa?16:Aa}static Lnh(Aa,bb){Aa.nri||(bb.nri?bb=Aa:bb.unit===Aa.unit&&k.a.Vva(bb.value,Aa.value)||(bb.value=-1));return bb}static dBo(Aa,bb){switch(bb){case ra.a.fCa:return Aa.toLowerCase();case ra.a.gCa:return 6!==l.AFrameworkApplication.xa.iD?F.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):F.ULS.sendTraceTag(539305616,340,
50,"User changed the case from keyboard shortcut"),Aa.toUpperCase();case ra.a.VYa:case ra.a.uta:return Qb.ENk(Aa,bb===ra.a.uta);case ra.a.WYa:return Qb.rDo(Aa);default:return Aa}}static rDo(Aa){let bb="";for(let nb=0;nb<Aa.length;nb++)bb=Aa.charAt(nb)===Aa.charAt(nb).toUpperCase()?bb+Aa.charAt(nb).toLowerCase():bb+Aa.charAt(nb).toUpperCase();return bb}static ENk(Aa,bb){let nb,Va,Ab=!0,Zb=Aa.length,Kb=0,dc=Qb.UDf(Aa,Kb,Zb);for(;0<Zb;){Va=nb=!1;var jc=Zb;let cc;var zb=void 0;for(zb=0;0<jc&&Qb.VPk(Aa.charAt(Kb+
zb));zb++,jc--)Va=Qb.IYd(Aa.charAt(Kb+zb));for(cc=zb;0<jc&&!(nb=Qb.IYd(Aa.charAt(Kb+zb)))&&" "!==Aa.charAt(Kb+zb)&&"/"!==Aa.charAt(Kb+zb);zb++,jc--);jc=zb-cc;if(0>=jc)break;Kb+=cc;zb=Aa.substr(Kb,jc);zb=zb===zb.toUpperCase();if(dc||!zb)Aa=Ab||Va||bb?Aa.substr(0,Kb)+Aa.charAt(Kb).toUpperCase()+Aa.substr(Kb+1,jc-1).toLowerCase()+Aa.substr(Kb+jc):Aa.substr(0,Kb)+Aa.substr(Kb,jc).toLowerCase()+Aa.substr(Kb+jc);Zb-=jc+cc;Kb+=jc;if(Ab=nb)Kb++,Zb--,dc=Qb.UDf(Aa,Kb,Zb)}return Aa}static UDf(Aa,bb,nb){for(;0<
nb&&!Qb.IYd(Aa.charAt(bb));){if(Aa.charAt(bb)!==Aa.charAt(bb).toUpperCase())return!1;bb++;nb--}return!0}static BKm(Aa,bb){for(var nb=0;0<bb&&!Qb.IYd(Aa.charAt(nb));){if(Aa.charAt(nb)!==Aa.charAt(nb).toLowerCase())return!1;nb++;bb--}return!0}static IYd(Aa){return"."===Aa||"!"===Aa||"?"===Aa?!0:!1}static VPk(Aa){return-1==="0123456789".indexOf(Aa)&&Aa.toUpperCase()===Aa.toLowerCase()}static CXh(){const Aa=x.a.instance.Sa("Common.ISystemInitiatedFeedback");Aa&&Aa.execute(bb=>{bb.logActivity("FontsSurveyActivity",
"FontsFloodgateSurvey")})}}Qb.qah=new P.a;Qb.yz=null;Qb.Rm=null;Qb.LGi=31;Object(D.a)(Qb,"TextFormattingActor",null,[])},1993:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.IE=3]="IE";e[e.safari=4]="safari";e[e.others=5]="others";e[e.unknown=6]="unknown";e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=9]="teamsElectron"})(l||(l={}));Object(D.b)("BrowserCode",l)},1995:function(D,
L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(D.a)(l,"AtMentionAttributes",null,[])},2001:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.initial=0]="initial";e[e.startSearch=1]="startSearch";e[e.searching=2]="searching";e[e.searchComplete=3]="searchComplete";e[e.replaceAllInProgress=4]="replaceAllInProgress";e[e.replaceAllComplete=5]="replaceAllComplete";e[e.tooManyResults=6]="tooManyResults";
e[e.noMatchesFound=7]="noMatchesFound"})(l||(l={}));Object(D.b)("FindReplaceViewType",l)},2003:function(D,L,c){c.d(L,"a",function(){return l});var l;(function(e){e[e.initial=0]="initial";e[e.headings=1]="headings";e[e.find=2]="find";e[e.replace=3]="replace";e[e.intelligentPlaceholder=4]="intelligentPlaceholder";e[e.contracts=5]="contracts"})(l||(l={}))},2018:function(D,L,c){function l(b,h){h=Object.assign(new sa.a,{name:"LinkType",string:h});e(qa.a.ytm,b,[h])}function e(b,h,t,A=!0){h&&h.UILocation&&
Object(lb.d)(b,A,lb.e,0,h.UILocation,0,t)}function a(b,h){const t=Sa.a.instance;return new Dy(b,h,t.We("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value,t.We("WordEditor.Bookmark.FullBookmarkManager").value,t.resolve("Box4.IHyperlinkStrategy"),t.resolve("Box4.IHyperlinkEditor"),t.resolve("Box4.ICharacterPropertiesEditor"),t.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,t.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Fq.a.instance,t.Ma("Box4.IInternalLinkManager"))}
function k(b,h){var t;return b===Hr.none?"none":null===(t=Ey[b])||void 0===t?void 0:t[h]}function x(){const b=Sa.a.instance.Ma("WordEditor.Gc2Inline.IWordEditHostFactory");void 0===b&&u.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function y(){const b=Sa.a.instance.Ma("WordEditor.Gc2Inline.IGc2ClassFactory");void 0===b&&u.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");
return b}c.r(L);var m=c(0),u=c(8),z=c(46),v=c(2),E=c(34),F=c(16),J=c(159),K=c(87);class H{constructor(b){this.$fg=0;this.UEb=this.mfc=this.p6a=null;this.oR=v.AFrameworkApplication.ta.xq;this.vX=b;this.vX.pv(K.a.vej);this.vX.uB(K.a.vej,Object(z.a)(this,this.Iln,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.UEb)return u.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.UEb;this.p6a=this.oR.eg("ComponentAttach","getCustomAuthConfig");return this.UEb=new Promise((b,
h)=>{const t={};let A=!1,O=!1,aa=0;this.$fg=window.setInterval(()=>{4>aa?(aa++,this.vX.sendMessage(K.a.getCustomAuthConfig,t)):(window.clearInterval(this.$fg),A=!0,u.ULS.sendTraceTag(588087303,344,10,E.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.mfc=(ua,Ra)=>{window.clearInterval(this.$fg);A||O||(O=!0,ua?(u.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(ua)):(u.ULS.sendTraceTag(589050654,369,10,E.c({["error"]:Ra.toString()})),h(Ra)))};
this.vX.sendMessage(K.a.getCustomAuthConfig,t)})}Iln(b){try{const h=E.a(b.Values[J.a.WIk]);let t=v.AFrameworkApplication.K.kb("Application")||"";t=F.a.fh(t);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+t+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+t+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+t+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
t+"%3Facctsw%3D1";this.p6a&&(this.p6a.stop(),this.p6a=null);this.mfc(h,"")}catch(h){u.ULS.sendTraceTag(589050655,344,10,E.c({["error"]:h.message,["stack"]:h.stack})),this.mfc(null,h.message)}}}Object(m.a)(H,"AccountSwitchingManager",null,[156]);var P=c(180);class N{get name(){return"Common.App.AccountSwitching"}yc(b){b.register(H,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").singleInstance().Qd(()=>new H(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){P.a.instance.Gc(new N)}}
Object(m.a)(N,"AccountSwitchingPackage",null,[1,2]);var M;(function(b){b[b.generalException=0]="generalException";b[b.invalidArgument=1]="invalidArgument";b[b.notAllowed=2]="notAllowed";b[b.apiNotAvailable=3]="apiNotAvailable";b[b.unresolvedPendingRequest=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.adalTimeout=6]="adalTimeout";b[b.userNotSignedIn=7]="userNotSignedIn";b[b.userAborted=8]="userAborted";b[b.silentSignInFailed=9]="silentSignInFailed";b[b.invalidResourceUrl=10]="invalidResourceUrl";
b[b.invalidGrant=11]="invalidGrant";b[b.connectionLost=12]="connectionLost";b[b.clientError=13]="clientError";b[b.serverError=14]="serverError"})(M||(M={}));Object(m.b)("ErrorCodes",M);c(1789);class I{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(m.a)(I,"OutstandingRequest",null,[]);class T{}T.zan="AADSTS50058";T.invalidResourceUrl="AADSTS50001";T.ran="AADSTS65001";T.hbn="AADSTS70011";T.userAborted="13002";T.Rxn="Popup Window is null";
T.Qxn="Popup Window closed";T.adalTimeout="Token renewal operation failed due to timeout";T.zDo="tokenRevoked";Object(m.a)(T,"WopiHostErrorType",null,[]);var U=c(601),W=c(60),V=c(1788);class Y{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(m.a)(Y,"WopiIdentityInfo",null,[735]);class da{constructor(b,h,t){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=t}}Object(m.a)(da,"WopiIdentityToken",
null,[734]);var ba=c(15),ja=c(156),sa=c(28),ta=c(168);class ra{constructor(b){this._initialized=!1;this.lec={};this.hie={};this.oR=v.AFrameworkApplication.ta.xq;this.Rvf=b}Iff(b){this._initialized||(b.pv(K.a.Zec),b.uB(K.a.Zec,Object(z.a)(this,this.Hln,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(b,h,t=null){this.Rga(b,h);return new Promise((A,O)=>{if(this.ezf(h))if(h in this.lec)O("unresolvedPendingRequest");else{var aa=window.setTimeout(()=>{u.ULS.sendTraceTag(37856032,344,10,E.c({["error"]:"Request timeout.",
["callerId"]:h}));O("timeout")},12E4);this.Fkf(b,h,t,(ua,Ra)=>{window.clearTimeout(aa);ua?A(ua):(u.ULS.sendTraceTag(37856033,369,15,E.c({["error"]:M[Ra]})),O(Ra))})}else u.ULS.sendTraceTag(37856034,344,10,E.c({["error"]:"Caller is not allowed."})),O("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,t)=>{this.ezf(b)?this.B1l((A,O)=>{A?h(A):(u.ULS.sendTraceTag(37856064,369,10,E.c({["error"]:O.toString()})),t(O))}):(u.ULS.sendTraceTag(37856065,344,10,E.c({["error"]:"Caller is not allowed."})),
t("notAllowed"))})}getAuthContext(b){return new Promise((h,t)=>{const A=this.getAuthContextSync(b);A?h(A):t("notAllowed")})}getAuthContextSync(b){if(this.ezf(b)){const h=new V.a;h.upn=v.AFrameworkApplication.K.kb("UserPrincipalName");h.userId=v.AFrameworkApplication.K.kb("LoggableUserId");h.authority=v.AFrameworkApplication.K.kb("HostAuthAuthority");h.tenantId=v.AFrameworkApplication.K.kb("TenantId");h.isAnonymous=v.AFrameworkApplication.K.$("IsAnonymousUser");h.supportsAuthToken=this.Clm(b);b=v.AFrameworkApplication.K.kb("HostAuthType");
h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}u.ULS.sendTraceTag(40751647,344,10,E.c({["error"]:"Caller is not allowed."}));return null}Clm(b){const h=U.OAuthManagerSettings.fQc;return ba.a.QPa?h&&U.OAuthManagerSettings.Jrj?Array.contains(U.OAuthManagerSettings.Jrj,b.toLowerCase()):!1:h}Fkf(b,h,t,A){var O=[];Array.add(O,Object.assign(new sa.a,{name:"CallerId",string:h}));Array.add(O,Object.assign(new sa.a,{name:J.a.Icg,string:b.correlationId}));ja.a.sendTelemetryEvent(Object.assign(new ta.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:O}));O=W.a.create().toString();const aa="getAccessToken_"+O,ua=this.oR.eg("ComponentAttach",aa);this.hie[aa]=ua;const Ra={};Ra[J.a.Jcg]=O;Ra[J.a.euo]=b.resource;Ra[J.a.fuo]=b.scope;Ra[J.a.noj]=v.AFrameworkApplication.K.kb("HostAuthType");Ra[J.a.iuo]=v.AFrameworkApplication.K.kb("UserPrincipalName");Ra[J.a.guo]=b.silentLogin;Ra[J.a.buo]=b.options;Ra[J.a.Icg]=b.correlationId;Ra[J.a.cuo]=h;t&&(Ra[J.a.addinName]=t.AddinName,
Ra[J.a.auo]=t.AddinTrustId);this.Rvf.execute(ub=>{this.Iff(ub);ub.sendMessage(K.a.getAuthToken,Ra)});this.lec[O]=new I(b,A)}B1l(b){const h=v.AFrameworkApplication.K.kb("UserName"),t=v.AFrameworkApplication.K.kb("UserPrincipalName"),A=v.AFrameworkApplication.K.kb("LoggableUserIdSpace"),O=new Y;O.email=t;O.displayName=h;switch(A){case "OrgIdPuid":O.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":O.authority="MicrosoftAccount";break;default:O.authority=A}b(O,null)}Hln(b){let h=
null;try{let A=b.Values[J.a.Jcg];const O=b.Values[J.a.$to],aa=b.Values[J.a.noj],ua=b.Values[J.a.huo];let Ra=null,ub=null;const Nb=this.lec[A];if("undefined"!==typeof Nb&&Nb){var t=[];Array.add(t,Object.assign(new sa.a,{name:J.a.Icg,string:Nb.requestParameters.correlationId}));ja.a.sendTelemetryEvent(Object.assign(new ta.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:t}));h=Nb.requestCallback;delete this.lec[A];"undefined"!==typeof O&&O&&O.length?ub=new da(O,aa,
ua):Ra=M[this.R3m(b)];t="getAccessToken_"+A;t in this.hie&&(this.hie[t].stop(),delete this.hie[t]);h(ub,Ra)}else u.ULS.sendTraceTag(37856066,344,10,E.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:A}))}catch(A){b=b.Values[J.a.Jcg],b in this.lec&&delete this.lec[b],this.M0d(),u.ULS.sendTraceTag(37856067,344,10,E.c({["error"]:A.message,["stack"]:A.stack})),h&&h(null,"generalException")}}ezf(b){var h=v.AFrameworkApplication.gcm();b=b.toLowerCase();for(const t of h)if(b===
t.toLowerCase())return!0;h=U.OAuthManagerSettings.KZe;for(let t in h)if(b===h[t].toLowerCase())return!0;return!1}R3m(b){b=b.Values[J.a.duo];this.M0d();u.ULS.sendTraceTag(39068821,344,15,E.c({["error"]:b}));return b?-1<b.indexOf(T.zan)?9:-1<b.indexOf(T.Rxn)||-1<b.indexOf(T.Qxn)?12:-1<b.indexOf(T.invalidResourceUrl)?10:-1<b.indexOf(T.userAborted)?8:-1<b.indexOf(T.hbn)||-1<b.indexOf(T.ran)||b===T.zDo?11:-1<b.indexOf(T.adalTimeout)?6:0:13}Rga(b,h){b=this.EMn(b.resource);u.ULS.sendTraceTag(39921882,344,
50,E.c({["callerId"]:h,["resource"]:b}))}M0d(){u.ULS.sendTraceTag(39068822,344,50,E.c({["userAgent"]:window.navigator.userAgent}))}EMn(b){return(b?b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(m.a)(ra,"WopiIdentityManager",null,[718]);class ma{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}yc(b){this.W=b;b.register(ra,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").singleInstance().Qd(()=>new ra(b.Sa("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.Wo(Object(z.a)(this,this.zx,"onFullAppSettingsReady"))}zx(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){u.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}dispose(){}static main(){P.a.instance.Gc(new ma)}}Object(m.a)(ma,"WopiIdentityPackage",null,[1,2]);var Ba=c(439),Pa=c(318),Da=c(82),Ha;(function(b){b[b.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";b[b.cloudPolicySettings=1]=
"cloudPolicySettings";b[b.alternateAuthToken=2]="alternateAuthToken"})(Ha||(Ha={}));Object(m.b)("ApplicationFeatureHelperRequestType",Ha);class oa{constructor(){this.message=null;this.httpStatusCode=0}}Object(m.a)(oa,"HttpRequstToPromiseRejectData",null,[]);var wa=c(75),ia=c(45),ca=c(187),pa=c(759);class Ma{constructor(b,h){this.Na=b;this.Of=h}$Gc(b,h,t,A=null,O=null,aa=null,ua=null,Ra=null){const ub=Ha[t],Nb=ub+"RequestFailure";wa.Health.instance.recordKpiUsage(Nb,0,"jpittsdirects",null);return new Promise((Yb,
bc)=>{u.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",ub);const Dc=null!=ua?ua:this.Na.pc("ApplicationFeatureHelperRequestQueueTimeout",15E3),Pc=null!=Ra?Ra:this.Na.pc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Of.dyb(b,1,null,this.lof(t,A),aa,1,jd=>{u.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",ub);try{if(void 0===jd||null===jd||void 0===
jd.data||null===jd.data||void 0===jd.data.we||null===jd.data.we){wa.Health.instance.recordKpiFailure(Nb,"Invalid RequestSucceededEventArgs",!1,!0,null);let ee=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",ub);bc(this.$Da(ee,jd))}else if(jd.data.Ve!==ca.a.oz){wa.Health.instance.recordKpiFailure(Nb,"HttpStatusCode_"+jd.data.Ve.toString(),!1,!0,null);let ee=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
jd.data.Ve,ub);bc(this.$Da(ee,jd))}else{void 0!==O&&null!==O&&void 0!==jd.data.vj&&null!==jd.data.vj&&O(jd.data.vj);var Cd=h(jd.data.we);if(Cd)u.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",ub),Yb(Cd);else{wa.Health.instance.recordKpiFailure(Nb,"Parse Failure",!1,!0,null);let ee=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",ub);bc(this.$Da(ee,
jd))}}}catch(ee){wa.Health.instance.recordKpiFailure(Nb,"Unexpected Failure",!1,!0,null),Cd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",ee,ub),bc(this.$Da(Cd,jd))}},jd=>{if(jd.data){wa.Health.instance.recordKpiFailure(Nb,"HttpStatusCode_"+jd.data.Ve.toString(),!1,!0,null);var Cd=pa.a.s7b(jd.data.we||"No Data");Cd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",
jd.data.Ve,Cd,ub)}else wa.Health.instance.recordKpiFailure(Nb,"Invalid RequestFailedEventArgs",!1,!0,null),Cd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",ub);bc(this.$Da(Cd,jd))},void 0,void 0,Dc,Pc)})}$Da(b,h){const t=new oa;t.message=b;t.httpStatusCode=h&&h.data?h.data.Ve:-1;return t}lof(b,h){const t={};t["x-UserDataSignature"]=this.Na.kb("UserDataSignature");t["x-LicensingIsEnabled"]=this.Na.$("LicensingIsEnabled").toString();
t["x-CacheIsEnabled"]=this.Na.$("LicensingRedisIsEnabled").toString();t["x-OcpsIsEnabled"]=this.Na.$("OcpsIsEnabled").toString();t["x-LicensingAADIdIsEnabled"]=this.Na.$("LicensingAadIdIsEnabled").toString();0===b&&(t["x-LicenseCheckOnTenantEnabled"]="true",t["x-SupportUserConsentDependentFeatures"]="true",t["x-AFHUserConsentGroupValue"]="0",t["x-UseShellServiceForUserConsentGroup"]="true",t["x-SMBUserLicensingEnabled"]="true",t["x-AFHPIPLComplianceEnabled"]=ia.a.JT(window.location.href,"wd_afhpipl")||
"false");if(h)for(let A of h.keys)t[A]=h.J(A);return t}}Object(m.a)(Ma,"HttpRequestToPromiseUtility",null,[]);var ya;(function(b){b[b.loki=0]="loki";b[b.augloopACLP=1]="augloopACLP"})(ya||(ya={}));Object(m.b)("AlternateAuthSupportApp",ya);class Oa{constructor(){this.Token=null;this.ExpirationTime=0}}Object(m.a)(Oa,"WacAlternateAuthToken",null,[]);class fa{constructor(b,h){this.xDo=3E5;if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Na=b;this.Fcd=new Ba.a(Pa.a.Xh());this.dtc=new Ma(b,h);void 0!==U.OAuthManagerSettings.GIf&&null!==U.OAuthManagerSettings.GIf&&void 0!==U.OAuthManagerSettings.u1d&&null!==U.OAuthManagerSettings.u1d&&0<U.OAuthManagerSettings.u1d&&(b=new Oa,b.Token=U.OAuthManagerSettings.GIf,b.ExpirationTime=U.OAuthManagerSettings.u1d,this.Fcd.Z("loki",b))}HEl(){let b=null;this.Fcd.ob(ya[0])&&(b=this.Fcd.J(ya[0]));return void 0===b||null===b||this.isTokenExpired(b)?this.Vsl():Promise.resolve(b.Token)}isTokenExpired(b){return b.ExpirationTime-
Date.now()<this.xDo}Vsl(){const b=new Ba.a(Pa.a.Xh());b.Z("X-AlternateAuthApp",ya[0]);return this.dtc.$Gc(this.Egb("/afhs/AlternateAuthHelperHandler.ashx"),Object(z.a)(this,this.xtn,"parseAlternateAuthTokenResponse"),2,b).then(h=>{u.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",ya[0]);this.Fcd.Z(ya[0],h);return h.Token},h=>{h=Object(Da.a)(oa,h);u.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
h.message,h.httpStatusCode);return null})}xtn(b){let h=null;({Nu:h}=E.d(b));u.ULS.sendTraceTag(545821457,3004,h?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",b);return h}Egb(b){return String.format("{0}{1}?{2}",this.Na.kb("WebServiceBase"),b,v.AFrameworkApplication.fm)}}Object(m.a)(fa,"AlternateAuthHelper",null,[699]);var Ca=c(485);class Ta{constructor(b,h,t){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=
t}}Object(m.a)(Ta,"FeatureStateChangeArgs",null,[]);var eb=c(114),jb=c(192),ob=c(72),Ya=c(118),Xa;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(Xa||(Xa={}));Object(m.b)("FeatureState",Xa);var Sa=c(21),ab=c(12),Hb=c(126);class pb{constructor(b,h,t=null,A=null,O=null){this.Kfb=this.MAa=this.n$g=this.jab=this.Utd=null;this.dtc=new Ma(b,h);this.Na=b;this.Z3j=b.pc("LicensingMaxRetryAttempts",0);this.$kd=b.$("IsO365ConsumerHost");this.VDe=b.$("IsO365CommercialHost");this.qDe=b.$("PremiumUpsellIsEnabled");
this.OUb=!1;this.vGe=0;this.ALg=t;this.fhh=A;this.ga=O;this.iab=b.$("LicensingIsEnabled");this.Jub=b.$("OcpsIsEnabled")&&this.VDe;this.FUe=b.$("ShowPrivacyDialog")&&!!A;this.EUb=b.$("IsAnonymousUser");this.cKd=new Promise(aa=>{aa(!1)});this.$ob=new Promise(aa=>{aa(!0)});this.Jfb=new Ba.a(Pa.a.Xh());this.swd=!0;this.i1g=this.wUl();this.x2a()&&!this.EUb?(void 0!==v.AFrameworkApplication.ta&&null!==v.AFrameworkApplication.ta&&(this.Utd=v.AFrameworkApplication.ta.xq,void 0!==this.Utd&&null!==this.Utd&&
(this.jab=this.Utd.vQa("WebServiceCall","ApplicationFeatureHelperService"))),this.Kfb=this.xhg()):this.Kfb=new Promise(aa=>{aa({})});this.Kfb.catch(aa=>{aa=Object(Da.a)(oa,aa);u.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",aa?aa.httpStatusCode.toString():"Unknown")});this.swd&&this.isFeatureEnabled("FreemiumUpsell",!0).then(aa=>{this.OUb=aa;return null})}wUl(){const b=this.Na.yw("AllLicensedFeatures")?this.Na.oC("AllLicensedFeatures"):[],h=new Ca.a;
for(let t=0;t<b.length;t++)h.add(b[t]);return h}x2a(){return this.VDe||this.$kd}xhg(b=0,h=!1){u.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const t=eb.a.KF();t&&(t.set("retryAttempt",b.toString()),t.set("forceRefresh",h.toString()),t.set("isO365ConsumerHost",this.$kd.toString()),t.set("isO365CommercialHost",this.VDe.toString()),t.set("isFreemiumUpsellSettingEnabled",this.qDe.toString()));wa.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",t);wa.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",t);void 0!==this.jab&&null!==this.jab&&this.jab.start();let A=null;h&&(A=new Ba.a(Pa.a.Xh()),A.Z("x-LicensingForceRefresh","true"));this.n$g=new Date;return(this.iab?this.dtc.$Gc(this.Egb("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(z.a)(this,this.Btn,"parseApplicationFeatureHelperResponse"),0,A,Object(z.a)(this,this.ZAn,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(O=>
{const aa=Object.assign(new Hb.a,{durationMs:this.jpj()});aa.extendedProperties=t;aa.extendedProperties&&O&&(aa.extendedProperties.set("featureCount",ob.a.count(O).toString()),aa.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in O).toString()),aa.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in O).toString()),"FreemiumUpsell"in O&&aa.extendedProperties.set("isFreemiumUpsellEnabled",O.FreemiumUpsell.toString()),this.MAa&&aa.extendedProperties.set("fromCache",
(this.MAa<this.n$g).toString()));wa.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",aa);return O},O=>{const aa=Object.assign(new Hb.a,{durationMs:this.jpj()}),ua=Object(Da.a)(oa,O);if(!ua)return u.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),wa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,aa),new Promise((Ra,ub)=>{ub(O)});aa.extendedProperties=
t;aa.extendedProperties&&aa.extendedProperties.set("status",ua.httpStatusCode.toString());wa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,aa);return 408===ua.httpStatusCode&&++b<=this.Z3j?this.xhg(b):new Promise((Ra,ub)=>{ub(ua)})})}Btn(b){(b=E.b(b))?(u.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),u.ULS.sendTraceTag(50938594,3004,50,"{0}",b)):u.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return b.Features}Egb(b){var h=String.format("{0}{1}",this.Na.kb("WebServiceBase"),b);this.Na.yw("ApplicationFeatureHelperHttpCachingEnabled")&&this.Na.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=pb.WOd(this.Na))&&0<b.length&&(this.swd&&(b+="ucbf"),h=new jb.QueryStringBuilder(h),h.De("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.Jub&&!this.FUe&&!this.iab)return this.$ob;u.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
b);if("ConnectedServices"===b){var t=this.Jub?this.ALg.G7("ControllerConnectedServicesEnabled"):this.$ob;const aa=this.FUe?this.fhh.getSettings().then(ua=>2!==ua.vI,()=>h):this.$ob;return t.then(ua=>ua?aa:this.cKd)}if("FreemiumUpsell"===b&&(!this.qDe||!this.$kd||this.EUb))return this.cKd;t=null;t=this.Jub?this.ALg.isFeatureEnabled(b):this.$ob;let A=null;A=this.iab?this.dCm(b,h):this.$ob;let O=null;O=this.FUe?this.fhh.isFeatureEnabled(b):this.$ob;return t.then(aa=>aa?O.then(ua=>ua?A:this.cKd):this.cKd).then(aa=>
{this.nDi(b,aa,!0);return aa},()=>{this.nDi(b,h,!1);return h})}nDi(b,h,t){u.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,t)}getFeatureTier(b,h){if(!this.iab)return new Promise(t=>{t(2)});u.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.Kfb.then(t=>this.aRd(b,t,h),()=>h)}isFreemiumUpsellEnabled(){if(this.qDe&&this.$kd&&!this.EUb){if(this.OUb&&2!==this.vGe||!this.OUb&&1!==this.vGe)u.ULS.sendTraceTag(509728161,
3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.OUb.toString()),this.vGe=this.OUb?2:1;return this.OUb}return!1}launchUpsellExperience(b,h=null){u.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var t=eb.a.KF();t&&(t.set("experienceId",b),h&&t.set("campaignId",h));wa.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",t);
if(t=Sa.a.instance.Ma("Common.IInProductMessagingUIManager")){const A=Object(z.a)(this,this.Aem,"handleDimeTaskComplete");t.KAi(b,A,h)}else u.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),wa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.Rb(ab.a.VLd,2,{["experience"]:b})}Axa(b,h){if(!this.iab)return null;if(!b||!h)return u.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const t=Ya.a.create().toString();this.Jfb.ob(b)||this.Jfb.Z(b,new Ba.a(Pa.a.Xh()));this.Jfb.J(b).add(t,h);u.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",t,b));return t}Yfc(b,h){this.iab&&(b&&this.Jfb.ob(b)?h&&Ya.a.isValid(h)?this.Jfb.J(b).ob(h)?(u.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
h,b)),this.Jfb.J(b).remove(h)):u.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):u.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",h,b)):u.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
b)))}aRd(b,h,t){return this.swd?b in h?h[b].LicenseTier:t:b in h?this.mun(h[b],t):t}mun(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}Aem(){u.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.Kfb.then(b=>{this.f2i(b)}).catch(()=>{this.f2i({})})}f2i(b){u.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.xhg(0,!0);h.then(t=>
{this.Kfb=h;ob.a.count(t)>ob.a.count(b)?wa.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):wa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let A of this.Jfb.keys)if(A in t){const O=this.aRd(A,t,0);A in b?this.aRd(A,b,0)!==O&&this.NOf(A,!0,O):this.NOf(A,!0,O)}else A in b&&this.NOf(A,!1,this.aRd(A,b,0))}).catch(t=>{wa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);u.ULS.sendTraceTag(594051086,
3004,10,JSON.stringify(t))})}NOf(b,h,t){u.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,t);h=new Ta(b,h,t);t=this.Jfb.J(b);for(let A of t)try{A.value(h)}catch(O){u.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,A.key,O.message))}}cCm(b,h){if(this.iab){const t=
this.i1g.contains(b);let A=!0,O="",aa=!1;return this.Kfb.then(ua=>{b in ua?(ua=ua[b],O=Xa[ua.FeatureState],A=1!==ua.FeatureState):A=!t;this.BDi(b,t,O,aa,h,A);return A},()=>{aa=!0;t&&(A=h);this.BDi(b,t,O,aa,h,A);return A})}return this.$ob}BDi(b,h,t,A,O,aa){u.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,A,t,O,aa)}dCm(b,h){if(this.swd)return this.cCm(b,h);if(this.iab){if(this.i1g.contains(b))return this.Kfb.then(t=>
b in t,()=>h);u.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.$ob}ZAn(b){try{b&&"Date"in b&&(this.MAa=new Date(b.Date),u.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.MAa.toString()))}catch(h){u.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",h)}}jpj(){if(void 0!==this.jab&&
null!==this.jab){const b=this.jab.ri;this.jab.stop();return b}return null}static WOd(b){try{if(ba.a.Iie){const h=b.kb("UserDataSignature").split(".");if(1<h.length){const t=window.self.atob(h[1]),A=JSON.parse(t).LocalStorageKey;if(void 0!==A&&null!==A&&0<A.length)return A}}}catch(h){u.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(m.a)(pb,"ApplicationFeatureHelper",null,[700]);var Mb=c(76);class Qb{constructor(b,h){this.PolicySettings=
null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(m.a)(Qb,"CloudPolicySettingsCacheData",null,[]);var Aa=c(1368),bb=c(475),nb=c(264);class Va{static Kmj(){return v.AFrameworkApplication.K.$("SideCarIsEnabled")?Va.qde&&Va.wSc?new Promise(b=>{b(!0)}):new Promise((b,h)=>{Va.qde=nb.a.create(v.AFrameworkApplication.K.kb("SideCarUrl"));bb.a.ZW(Va.qde);Va.qde.tZ((t,A)=>{(Va.wSc=A.succeeded)?b(A.succeeded):h(A.succeeded)})}):
new Promise(b=>{b(!1)})}}Va.wSc=!1;Va.qde=null;Object(m.a)(Va,"SideCarLoader",null,[]);class Ab{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(m.a)(Ab,"CloudPolicySettingsData",null,[]);class Zb{constructor(b,h){this.bte=0;this.VCd=null;this.dtc=new Ma(b,h);this.Na=b;h=b.kb("HostAuthType");this.Jub=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===h||null===h)&&"aad"===h.toLowerCase();this.P4g=E.b(b.kb("OcpsDefaultSettings")||"{}");this.vvc=
this.WOd();h=this.Na.yw("ServicesControlsMicrosoftControllerServicesList")?this.Na.oC("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Ued=new Ca.a;for(let t=0;t<h.length;t++)this.Ued.add(h[t]);this.Jub&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.VCd=this.rHo():this.VCd=this.whg(this.Jub,this.Egb("/afhs/CloudPolicySettings.ashx"),Object(z.a)(this,this.Ftn,"parseCloudPolicySettingsResponse"));this.VCd.then(()=>null).catch(t=>{t=Object(Da.a)(oa,t);u.ULS.sendTraceTag(50622685,
3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",t?t.httpStatusCode.toString():"Unknown")})}G7(b,h=!0){if(!this.Jub){const aa=this;return new Promise(ua=>{ua(aa.KNc(b))})}let t=this,A=this;const O=this.VCd.then(aa=>{try{let ua=null;aa.PolicySettings&&"unknown"in aa.PolicySettings&&(ua=aa.PolicySettings.unknown);if(ua){if(b in ua&&void 0!==ua[b]&&null!==ua[b])return new Promise(ub=>{ub("0"!==ua[b])});const Ra=b.toLowerCase();if(Ra in ua&&void 0!==ua[Ra]&&null!==ua[Ra])return new Promise(ub=>
{ub("0"!==ua[Ra])});u.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default");return new Promise(ub=>{ub(t.KNc(b))})}return new Promise(Ra=>{Ra(t.KNc(b))})}catch(ua){return u.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",ua.message),t.handleError(ua.toString(),h,t.KNc(b))}},aa=>A.handleError(aa,h,A.KNc(b)));O.then(aa=>{u.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,aa);
return null});return O}isFeatureEnabled(b,h=!0){if(this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.fCm(b,h);let t=new Promise(O=>{O(!0)}),A="";this.Ued.contains(b)&&(A="ControllerConnectedServicesEnabled",t=this.G7(A,h));t.then(O=>{u.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,O,A);return null});return t}fCm(b,h=!0){let t=new Promise(O=>
{O(!0)}),A="";"mso_sendASmile"===b?A="Enabled":"Survey"===b||"FloodgateSurvey"===b?A="SurveyEnabled":this.Ued.contains(b)&&(A="ControllerConnectedServicesEnabled");""!==A&&(t=this.G7(A,h));t.then(O=>{u.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",b,O,A);return null});return t}handleError(b,h,t){return h?new Promise(A=>{A(t)}):new Promise((A,O)=>{O(b)})}whg(b,h,t){if(!b)return Promise.resolve(new Ab);let A=!1,O=
null;wa.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let aa=this.I8e("GetCloudPolicySettings");return(new Promise((ua,Ra)=>{if(void 0!==this.vvc&&null!==this.vvc&&0<this.vvc.length){const ub=this.WGo();if(void 0!==ub&&null!==ub){A=!0;ua(ub);return}}this.dtc.$Gc(h,t,1,null,Object(z.a)(this,this.kBn,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Na.pc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Na.pc("CloudPolicySettingsRequestSentTimeout",
3E4)).then(ub=>{u.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.bIo(ub);ua(ub);return ub},ub=>{Ra(ub);return null})})).then(ua=>{({jz:aa,returnValue:O}=this.die(aa));var Ra=eb.a.KF();Ra&&Ra.set("FromCache",A.toString());Ra=Object.assign(new Hb.a,{durationMs:O,extendedProperties:Ra});wa.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Ra);return ua})}rHo(){return Va.Kmj().then(()=>{u.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");
return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}Egb(b){return String.format("{0}{1}",this.Na.kb("WebServiceBase"),b)}Ftn(b){let h=null;({Nu:h}=E.d(b));b=!!h;u.ULS.sendTraceTag(50622687,3004,b?50:10,"ParseCloudPolicySettingsResponse: Success={0}",b);return h}kBn(b){try{if(void 0!==b&&null!==b&&"CheckIn-Interval"in b){const h=parseInt(b["CheckIn-Interval"]);void 0!==h&&null!==h&&0<h&&(this.bte=h)}}catch(h){u.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",
h)}}KNc(b){return b in this.P4g?"0"!==this.P4g[b]:!0}WGo(){try{const b=Aa.a.instance.getItem(this.vvc);if(void 0===b||null===b)return u.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;u.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return u.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),
null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return u.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(h.ExpirationTime)).getTime()<Date.now())return u.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const t=new Ab;t.PolicySettings=h.PolicySettings;t.ControllerConnectedServicesFeatureNames=new Mb.a;this.Na.yw("ServicesControlsMicrosoftControllerServicesList")&&
this.Na.oC("ServicesControlsMicrosoftControllerServicesList");for(let A of this.Ued)t.ControllerConnectedServicesFeatureNames.add(A);u.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return t}catch(b){return u.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}bIo(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)u.ULS.sendTraceTag(51662944,3004,15,
"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.bte)u.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new Qb(b,this.bte),t=JSON.stringify(h);u.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",t);Aa.a.instance.setItem(this.vvc,t);u.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){u.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}WOd(){const b=pb.WOd(this.Na);return b&&0<b.length?"OCPS"+b:null}I8e(b){const h=Sa.a.instance.Ma("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==h&&null!==h?h.eg("WebServiceCall",b):null}die(b){if(void 0!==b&&null!==b){const h=b.ri;b.stop();return{returnValue:h,jz:null}}return{returnValue:null,jz:b}}}Object(m.a)(Zb,"CloudPolicySettingsHelper",null,[697]);class Kb{constructor(){this.dQh=this.gCj=this.vI=
0;this.eQh=this.hCj=this.Yzb="";this.RQe=this.ITa=2}clone(){const b=new Kb;b.vI=this.vI;b.gCj=this.gCj;b.dQh=this.dQh;b.Yzb=this.Yzb;b.hCj=this.hCj;b.eQh=this.eQh;b.ITa=this.ITa;b.RQe=this.src;return b}get src(){return this.RQe}serialize(b=null){const h={};if(!b||b.contains(Kb.bJb))h[Kb.bJb]=this.vI;if(!b||b.contains(Kb.BYc))h[Kb.BYc]=this.Yzb;if(!b||b.contains(Kb.CYc))h[Kb.CYc]=this.ITa;return JSON.stringify(h)}static create(b,h=null){const t=new Kb;t.RQe=b;void 0!==h&&null!==h&&(Kb.bJb in h&&(t.vI=
h[Kb.bJb]),Kb.BYc in h&&(t.Yzb=h[Kb.BYc]),Kb.CYc in h&&(t.ITa=h[Kb.CYc]));return t}static deserialize(b,h){try{const t=JSON.parse(b);if(void 0!==t&&null!==t)return Kb.create(h,t);u.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",b);throw Error.argument("settingsData");}catch(t){throw u.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",t.toString()),t;}}}Kb.bJb="CCS";Kb.BYc="CCSTime";Kb.CYc="OfficePrivacyRoamedNoticeShown";
Object(m.a)(Kb,"UserPrivacySettings",null,[]);var dc=c(127);class jc{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Na=b;this.Of=h;this.IPe=this.Rd=null}Egb(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",this.Na.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");h.append(v.AFrameworkApplication.fm);return h.toString()}executeRequest(b,h,t,
A=null){return this.Of.h_b(b,h,A,null,t,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,t)=>{try{if(void 0===this.Rd||null===this.Rd||void 0===b||null===b)u.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),t("Can't determine setting changes to save");else{var A=this.Rd.vI!==b.vI;if(2===this.Rd.src&&A)this.m4n(b),h(!0);else{var O=this.Z8n(b);if(void 0===O||null===O||!O.length)u.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),
t("No changes to save");else if(1===this.Rd.src)h(this.uwj(O));else if(0===this.Rd.src){u.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",O);const aa=this.executeRequest(this.Egb("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",O);aa.continueWith(()=>{if(aa.wo||aa.Ai)u.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),h(!1);else{var ua=aa.result;void 0!==ua.args&&null!==ua.args&&void 0!==ua.args.data&&
null!==ua.args.data&&ua.args.data.Ve===ca.a.oz?(u.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(u.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(aa){u.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",aa.toString()),h(!1)}})}Z8n(b){if(void 0===this.Rd||null===this.Rd||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");
const h=new Mb.a;0===b.src?(this.Rd.vI!==b.vI&&(h.add(Kb.bJb),h.add(Kb.BYc)),this.Rd.ITa!==b.ITa&&h.add(Kb.CYc)):1===b.src&&this.Rd.vI!==b.vI&&h.add(Kb.bJb);return h.count?b.serialize(h):(u.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.IPe){const b=this;this.IPe=new Promise(h=>{try{b.Rd?h(b.Rd.clone()):b.mHo().then(t=>{b.Rd=t;h(b.Rd.clone());return null},()=>{b.kHo().then(t=>{b.Rd=t;h(b.Rd.clone());return null},()=>{b.lHo().then(t=>
{b.Rd=t;h(b.Rd.clone());return null},()=>{u.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Rd=new Kb;h(b.Rd.clone());return null});return null});return null})}catch(t){u.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",t.toString()),b.Rd=new Kb,h(b.Rd.clone())}})}return this.IPe}mHo(){return new Promise((b,h)=>{try{const A=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Na.$("PrivacyDialogShouldCheckRoaming")||
A){var t=this.executeRequest(this.Egb("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");t.continueWith(()=>{try{if(t.wo||t.Ai)u.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const O=t.result;if(O&&O.args&&O.args.data)if(O.args.data.Ve!==ca.a.oz)u.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",O.args.data.Ve);else{if(O.args.data.we){b(jc.parse(O.args.data.we,0));u.ULS.sendTraceTag(51258447,
3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",O.args.data.we);return}u.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else u.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(O){u.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",
O.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else u.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(A){u.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",A.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}kHo(){return new Promise((b,h)=>{try{const t=dc.a.get("WacUPToggleState");let A=null;void 0!==t&&null!==
t&&0<t.length&&(A=decodeURIComponent(t));if(void 0!==A&&null!==A&&0<A.length){const O=jc.parse(A,1);u.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",O.toString());b(O)}else{const O=Kb.create(1),aa=new Mb.a;aa.add(Kb.bJb);const ua=O.serialize(aa);this.uwj(ua)?(u.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",ua),b(O)):(u.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",
ua),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(t){u.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",t.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}lHo(){return new Promise(b=>{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");let t=Kb.create(2);h?(t.vI=2,v.AFrameworkApplication.bOh(),u.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",
t.toString())):(t.vI=1,u.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",t.toString()));b(t)}catch(t){u.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",t.toString()),h=Kb.create(2),h.vI=1,b(h)}})}m4n(b){u.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===b.vI?v.AFrameworkApplication.bOh():v.AFrameworkApplication.oml();u.ULS.sendTraceTag(51258454,
3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}uwj(b){try{u.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Na.kb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");u.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return dc.a.Qhj("WacUPToggleState",b,dc.a.AQa,h)}catch(h){return u.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",
h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const t=this.Na.yw("ServicesControlsMicrosoftControllerServicesList")?this.Na.oC("ServicesControlsMicrosoftControllerServicesList"):[],A=new Ca.a;for(let O=0;O<t.length;O++)A.add(t[O]);return A.contains(b)?2!==h.vI:!0},()=>{u.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);return!0})}static parse(b,h){try{return u.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
b,h),Kb.deserialize(b,h)}catch(t){throw u.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",t.toString()),t;}}}Object(m.a)(jc,"UserPrivacySettingsHelper",null,[698]);class zb{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}yc(b){this.W=b;this.W.register(697,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").singleInstance().Qd(()=>new Zb(v.AFrameworkApplication.K,v.AFrameworkApplication.Ke));this.W.register(698,
"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").singleInstance().Qd(()=>new jc(v.AFrameworkApplication.K,v.AFrameworkApplication.Ke));this.W.register(699,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").singleInstance().Qd(()=>new fa(v.AFrameworkApplication.K,v.AFrameworkApplication.Ke));this.W.register(700,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").singleInstance().Qd(()=>new pb(v.AFrameworkApplication.K,v.AFrameworkApplication.Ke,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),
this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),v.AFrameworkApplication.xa))}init(){v.AFrameworkApplication.K.Wo(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");v.AFrameworkApplication.K.$("LicensingIsEnabled")&&(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{u.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",h,
v.AFrameworkApplication.K.kb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{u.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,v.AFrameworkApplication.K.kb("IsAnonymousUser"));return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.OAo()})}dispose(){}OAo(){try{v.AFrameworkApplication.K.$("SideCarIsEnabled")&&Va.Kmj().then(b=>
{u.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){P.a.instance.Gc(new zb)}}Object(m.a)(zb,"ApplicationFeatureHelperPackage",null,[1,2]);var cc=c(190);class Ub{aPd(b,h){let t;const A=[];for(;t=h.exec(b);){const O=t.index;A.push(new cc.a(O,O+t[0].length))}return A}isEndPuncSpecialCase(b){const h=this.aPd(b,Ub.Rso);for(const t of h)if(t.end===b.length)return!0;return!1}fKc(b){for(const h of Ub.Kql){const t=
this.aPd(b,h);if(0<t.length&&!t[0].begin)return t[0].end-1}return 0}findBeginBoundary(b,h,t){var A=b.substring(t,h);b=this.aPd(A,Ub.XRh);for(h=b.length-1;0<=h;h--){const O=A.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(O))return A=A.substring(b[h].begin,A.length),t+b[h].end+this.fKc(A)}return t}findEndBoundary(b,h,t){var A=b.substring(h,t);b=this.aPd(A,Ub.XRh);for(t=0;t<b.length;t++){const O=A.substring(0,b[t].end);if(!this.isEndPuncSpecialCase(O))return A=A.substring(b[t].begin,A.length),
h+b[t].end+this.fKc(A)}return-1}}Ub.Ggf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";Ub.Hgf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";
Ub.Igf="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";Ub.Kql=[new RegExp(Ub.Ggf,"ig"),new RegExp(Ub.Hgf,"ig"),new RegExp(Ub.Igf,"ig")];Ub.jcg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Ub.mcg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";Ub.lcg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
Ub.kcg=Ub.mcg+"|"+Ub.lcg;Ub.ncg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Ub.ocg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";Ub.pcg="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
Ub.qcg="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";Ub.s7f="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
Ub.kcg+"|"+Ub.ncg+"|"+Ub.ocg+")";Ub.r7f="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
Ub.pcg+")";Ub.uOf=Ub.jcg+"|"+Ub.qcg;Ub.icg=Ub.uOf+"|"+Ub.s7f+"|"+Ub.r7f;Ub.XRh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");Ub.Rso=new RegExp(Ub.icg,"g");Object(m.a)(Ub,"ProofingSentenceSeparatorScriptSharp",null,[694]);class Wb{ubd(b,h){const t=[];let A;for(;null!=(A=h.exec(b));){const O=A.index;t.push({begin:O,end:O+A[0].length})}return t}isEndPuncSpecialCase(b){return this.ubd(b,Wb.lLj).some(h=>
h.end==b.length)}fKc(b){for(const h of Wb.PHj){const t=this.ubd(b,h);if(0<t.length&&0==t[0].begin)return t[0].end-1}return 0}findBeginBoundary(b,h,t){var A=b.substring(t,h);b=this.ubd(A,Wb.Hng);for(h=b.length-1;0<=h;h--){const O=A.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(O))return A=A.substring(b[h].begin,A.length),t+b[h].end+this.fKc(A)}return t}findEndBoundary(b,h,t){var A=b.substring(h,t);b=this.ubd(A,Wb.Hng);for(t=0;t<b.length;t++){const O=A.substring(0,b[t].end);if(!this.isEndPuncSpecialCase(O))return A=
A.substring(b[t].begin,A.length),h+b[t].end+this.fKc(A)}return-1}}Wb.BGj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";Wb.gLj="[\u2639\u263a\u263b]";Wb.Spg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";Wb.BHj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
Wb.ZJj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";Wb.rqg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
Wb.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
Wb.Rpg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";Wb.ZIj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";Wb.YIj="[\uff21-\uff3a\uff41-\uff5a]";Wb.WIj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
Wb.VIj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";Wb.XIj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";Wb.hoe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";Wb.Gng="[\u3002\uff61]";Wb.Pbd="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";Wb.UHj="[\u00bb\u2019\u201d\u203a\"']";Wb.Coe=Wb.BGj+"|"+Wb.gLj;Wb.$Ij="[\u2028\u2029\n\r]";Wb.UIj="("+Wb.Pbd+"|"+Wb.Spg+"|"+Wb.rqg+"|"+Wb.Rpg+
")";Wb.TIj="("+Wb.Pbd+"|"+Wb.Spg+"|"+Wb.rqg+"|"+Wb.Symbol+"|"+Wb.Rpg+"|"+Wb.BHj+"|"+Wb.ZJj+")";Wb.Ggf="("+Wb.hoe+"("+Wb.Coe+"|"+Wb.UHj+"|"+Wb.Pbd+")*"+Wb.$Ij+")";Wb.Hgf="("+Wb.hoe+"("+Wb.Coe+")*("+Wb.Pbd+")+)";Wb.Igf="("+Wb.Gng+"("+Wb.Coe+")*)";Wb.PHj=[new RegExp(Wb.Ggf,"ig"),new RegExp(Wb.Hgf,"ig"),new RegExp(Wb.Igf,"ig")];Wb.jcg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Wb.mcg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
Wb.lcg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";Wb.kcg=Wb.mcg+"|"+Wb.lcg;Wb.ncg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Wb.ocg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
Wb.pcg="(("+Wb.ZIj+"|"+Wb.WIj+"|"+Wb.XIj+")[.])+|(("+Wb.VIj+")[.\ufe52\uff0e])+";Wb.qcg="("+Wb.YIj+")[.\ufe52\uff0e]";Wb.s7f=Wb.UIj+"("+Wb.kcg+"|"+Wb.ncg+"|"+Wb.ocg+")";Wb.r7f=Wb.TIj+"("+Wb.pcg+")";Wb.uOf=Wb.jcg+"|"+Wb.qcg;Wb.icg=Wb.uOf+"|"+Wb.s7f+"|"+Wb.r7f;Wb.Hng=new RegExp(Wb.hoe+"|"+Wb.Gng,"ig");Wb.lLj=new RegExp(Wb.icg,"g");Object(m.a)(Wb,"ProofingSentenceSeparator",null,[694]);class Qa{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}yc(b){this.W=b;v.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new Wb).singleInstance():b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new Ub).singleInstance()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){P.a.instance.Gc(new Qa)}}Object(m.a)(Qa,"Box4GrammarCheckPackage",null,[1,2]);var sb=c(86),Jb=c(11),pc=c(70),rc=c(63),db=c(7),lb=c(48),qa=c(3);class Ga{constructor(b,h,t,A){this.ONe=this.Lld=this.pCe=this.$d=null;this.t_g=this.ltb=this.Qja=this.Nra=this.bJg=
!1;this.Hda=0;this.zag=!1;this.PJb=()=>{this.reset()};this.DMa=O=>{this.Hda=O.Ib.keyCode;var aa=O.Ib.rawEvent.key;aa&&aa!==Ga.hK||(this.zag=!0);return this.Qja&&this.Lld?O.Ib.keyCode===rc.a.Q0||O.Ib.keyCode===rc.a.ks||O.Ib.keyCode===rc.a.iw?(aa=!1,O.Ib.keyCode===rc.a.Q0?(u.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),aa=!0):O.Ib.keyCode===rc.a.ks?u.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):O.Ib.keyCode===rc.a.iw&&
u.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this.Lld(O),aa&&this.reset(),!0):O.Ib.keyCode===rc.a.Uca||O.Ib.keyCode===rc.a.a5||O.Ib.keyCode===rc.a.R0||O.Ib.keyCode===rc.a.S0||O.Ib.keyCode===rc.a.Z4||O.Ib.keyCode===rc.a.gL?(this.Lld(O),!0):!1:!1};this.gqa=O=>{if(this.zag||this.Qja){this.zag=!1;var aa=this.VNc(),ua=this.GMc(O.Ib.target),Ra=O.Ib.rawEvent.inputType;return(void 0!==Ra&&null!==Ra||this.Hda!==rc.a.JB&&this.Hda!==rc.a.P0)&&"deleteContentBackward"!==
Ra&&"deleteContentForward"!==Ra?this.Phi(aa,ua,O.Ib.target):!1}};this.GCk=O=>{if(1!==O.Ib.rawEvent.key.length)return!1;const aa=this.VNc(),ua=this.GMc(O.Ib.target);return this.Phi(aa,ua,O.Ib.target)};this.YPa=O=>{if(!this.Qja)return!1;const aa=this.VNc(),ua=this.GMc(O.Ib.target);(O.Ib.keyCode===rc.a.JB||O.Ib.keyCode===rc.a.P0||(O.Ib.keyCode===rc.a.aUa||O.Ib.keyCode===rc.a.Umc)&&O.Ib.ctrlKey)&&this.iuf(aa,ua,O.Ib.target);return!1};this.L0e=(O,aa)=>{this.Hda=aa.mzf?rc.a.JB:aa.isDelete?rc.a.P0:this.Hda;
this.Qja&&(aa.mzf?this.Odm(aa.Mzi):aa.isDelete&&this.sem(aa.Mzi))};this.Be=b;this.lk=h;this.Qnc=t;this.ed=A;this.reset()}Kyb(b,h){this.Nra||(this.Nra=!0,b.Sva?this.hdb(h):b.sea(()=>{this.Nra||this.hdb(h)}))}dispose(){this.ltb&&(Jb.App.ya.kkc.sc(db.a.input,this.ed.editingView.editingElement,this.gqa),this.ltb=!1);this.bJg&&(this.$d.sc(db.a.kAd,this.ed.editingView.editingElement,this.GCk),this.bJg=!1);this.t_g&&(this.$d.sc(db.a.CF,this.ed.editingView.editingElement,this.DMa),this.$d.sc(db.a.sh,this.ed.editingView.editingElement,
this.YPa));Jb.App.ya.jca(this.PJb);this.kpj()}Q2i(b){this.pCe=b}d3i(b){this.ONe=b}R2i(b){this.Lld=b}LCk(){this.Qja=!0;v.AFrameworkApplication.ye("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}kpj(){this.Qja=!1}UE(){return this.Qja}hdb(b){this.$d=b;if(!this.ed.vd)u.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session");else if(this.ed.vd.Yi){if(Jb.App.$Dc&&ba.a.Eie||ba.a.Rt)Jb.App.ya.kkc.mb(db.a.input,this.ed.editingView.editingElement,
this.gqa,null),this.ltb=!0;this.$d&&(this.$d.mb(db.a.CF,this.ed.editingView.editingElement,this.DMa),this.$d.mb(db.a.sh,this.ed.editingView.editingElement,this.YPa),this.t_g=!0);this.Qnc.vmh(this.L0e);Jb.App.ya.uZ(this.PJb)}}Phi(b,h,t){if(1>h)return!1;b=b.replace(new RegExp(Ga.newLine,"g"),"");const A=b.charAt(h-1);this.Qja&&A!==Ga.hK?this.iuf(b,h,t):this.Qja||A!==Ga.hK?this.Qja&&A===Ga.hK&&u.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this.pCe&&(this.reset(),
this.nAn(h,b)&&(this.LCk(),this.iuf(b,h,t),u.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===h?"true":"false")));return this.Qja}reset(){this.Nra=!1;this.kpj();this.ONe&&this.ONe()}GMc(b){return this.lk.X5b(2,b)}VNc(){return this.Be.Tv().innerText}nAn(b,h){return 0>b-2||this.JNk(h.charAt(b-2))?!0:!1}JNk(b){return F.a.sba(b)||"("===b}iuf(b,h,t){if(!b||""===b||0>h)this.reset();else{const {vbj:A,Vzd:O}=this.JOm(b,h);this.pCe(A,t,O)}}JOm(b,h){const t=this.tFl(b,h);if(0<=
t&&h<=b.length)return{vbj:b.substring(t,h),Vzd:t};this.reset();return{vbj:"",Vzd:t}}tFl(b,h){let t=-1,A=h;for(A;0<=A&&63>=h-A;A--)if(b.charAt(A)===Ga.hK){t=A;break}63<h-A&&-1==t&&lb.c(qa.a.xIo,!0,void 0,void 0,void 0,void 0);return t}Odm(b){b=this.GMc(b.Ib.target);b=this.VNc().charAt(b-1);this.Qja&&b===Ga.hK&&this.reset()}sem(b){b=this.GMc(b.Ib.target);b=this.VNc().charAt(b);this.Qja&&b===Ga.hK&&this.reset()}}Ga.hK="@";Ga.newLine="\n";Object(m.a)(Ga,"AtMentionsListener",null,[693]);class Fb{constructor(){this.W=
null}get name(){return"Box4.AtMentions"}yc(b){this.W=b;this.W.ha("Box4.AtMentions.IAtMentionsListener",()=>new Ga(this.W.resolve("Box4.IEditingDomManager"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),pc.InteractiveViewManager.instance)).singleInstance()}init(){v.AFrameworkApplication.K.Wo(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").Kyb(Jb.App.ya.jb,sb.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){P.a.instance.Gc(new Fb)}}
Object(m.a)(Fb,"Box4AtMentionsPackage",null,[1,2]);class $b{get name(){return"Box4.Workers"}yc(){}init(){}dispose(){}static main(){P.a.instance.Gc(new $b)}}Object(m.a)($b,"Box4WorkersPackage",null,[1,2]);var rb=c(322),xb=c(80);class gb{constructor(){this.IIa=new xb.a}r4(b,h){this.IIa.Z(b,h)}Mkf(b){({value:b}=this.IIa.Ec(b));return b}}Object(m.a)(gb,"AggregationMethodsForActivityName",null,[]);var Gb=c(246);class ac{constructor(){this.yqd=new rb.a;this.IIa=new rb.a}r4(b,h,t){this.IIa.ob(b)&&this.IIa.J(b)||
this.IIa.Z(b,new gb);this.IIa.J(b).r4(h,t)}Mkf(b,h){return this.IIa.ob(b)&&this.IIa.J(b)?this.IIa.J(b).Mkf(h):null}bOc(b){this.yqd.ob(b)&&this.yqd.J(b)||this.yqd.Z(b,new Gb.a);return this.yqd.J(b)}ZKh(b,h){this.bOc(b).add(h)}}Object(m.a)(ac,"ActivityAggregationInfo",null,[766]);var hc=c(117),Ec=c(987),Uc=c(1005);class dd extends Ec.a{constructor(b,h){super(b);this.bUe=(this.kOj=h)?h.vPl():Uc.a.wkf()}get wBa(){return this.kOj}get activityName(){return this.wBa.name}get startTime(){return this.wBa.startTime}get endTime(){return this.wBa.endTime}end(){}cancel(){}ojf(){}VNo(){this.C5b.Z("AM",
this.wBa.mode.toString());this.C5b.Z("C",this.wBa.count.toString());this.C5b.Z("DA",this.wBa.sQh.toFixed(2));this.C5b.Z("DV",this.wBa.xkl.toFixed(2))}Oqf(b){return this.wBa.Oqf(b)}srf(){return this.wBa.srf()}n_b(){for(let b of this.wBa.xBa)b.n_b()}}Object(m.a)(dd,"AggregatedActivity",Ec.a,[]);class fd{constructor(b,h){this.zqe=0;this.Xya=b;this.cUa=h}Ztk(b,h){this.zqe=h;for(h=0;h<b.count;h++){const t=b.J(h);this.$tk(t)}}$tk(b){const h=Object(Da.a)(dd,b);if(h)if(1===this.zqe)this.Ytk(h);else if(2===
this.zqe){this.auk(h);for(let t of this.cUa.bOc(this.Xya)){const A=h.wBa.xBa.J(0);A.properties.ob(t)&&b.properties.Z(t,A.properties.J(t))}}}Ytk(b){for(let h of this.cUa.bOc(this.Xya))this.H$i(b,h)}auk(b){for(let h of b.srf())this.H$i(b,h)}H$i(b,h){const t=this.cUa.Mkf(this.Xya,h);if(t){const A=b.Oqf(h);b.properties.Z(h,t(A))}}}Object(m.a)(fd,"PropertyAggregationHelper",null,[]);var xc=c(1080);class $c{constructor(b,h,t,A,O){this.eRb=b;this.cUa=h;this.dMg=O;this.hqe=A;this.v3j=t}get pjh(){return this.v3j.value}UFc(b){if(Object(hc.a)(xc.a,
b))b.UFc();else if(Object(hc.a)(dd,b)&&this.hqe.kxh(b.activityName.toString())){b=Object(Da.a)(dd,b);b.VNo();b=b.dGi();var h=[];Array.add(h,b);b=E.c(h);u.ULS.sendTraceTag(6907266,213,50,b)}}EBa(b,h){const t=(new Date).getTime();var A=this.dMg.list.J(b);const O=({cuk:A}=this.SDl(A)).returnValue;this.dMg.list.Z(b,new Mb.a);h&&(A=this.J0k(A,t,this.eRb.vgi));0<A.count&&(new fd(b,this.cUa)).Ztk(A,O)}J0k(b,h,t){const A=new Mb.a;for(let O=0;O<b.count;O++){const aa=b.J(O);aa.startTime>h-t?aa.n_b():A.add(aa)}return A}SDl(b){const h=
this.pjh.Msj(b);b=this.pjh.lCo(b);const t=this.duk(h,b);return{returnValue:t,cuk:1===t?h:b}}duk(b,h){return b.count*this.eRb.wIi<h.count?1:2}get enabled(){return this.eRb.enabled}n_b(){}}Object(m.a)($c,"ActivityAggregationManager",null,[716]);class Bc{constructor(b){this.enabled=!1;this.PGi=500;this.cIi=2;this.wIi=5;this.vgi=3E4;this.pKc(b.appSettings)}pKc(b){this.enabled=Boolean.parse(b[Bc.Zef]||"false");this.PGi=parseInt(b[Bc.x5m]||"500");this.cIi=parseInt(b[Bc.c8m]||"2");this.wIi=parseInt(b[Bc.A8m]||
"5");this.vgi=parseInt(b[Bc.Acm]||"30000")}}Bc.Zef="ActivityAggregationEnabled";Bc.x5m="ActivityAggregationMaxInterval";Bc.c8m="ActivityAggregationMinChain";Bc.A8m="ActivityAggregationModeFactor";Bc.Acm="ActivityAggregationGraceWindow";Object(m.a)(Bc,"ActivityAggregationParams",null,[]);class Vd{constructor(b,h){this.cUa=b;this.rHg=h}Msj(b,h=1){if(!b||!b.count)return b;const t=new Mb.a;var A=null;for(let O=0;O<b.count;O++){const aa=b.J(O);if(!aa)continue;const ua=aa.activityName;A?A.fNm(aa)?A.add(aa):
(A=A.process(),t.addRange(A),A=this.rHg(ua,h),A.add(aa)):(A=this.rHg(ua,h),A.add(aa))}A&&(b=A.process(),t.addRange(b));return t}lCo(b){if(!b||!b.count)return b;const h={};var t=null;for(let O=0;O<b.count;O++){const aa=b.J(O);if(aa){if(!t){t=new Mb.a;var A=this.cUa.bOc(aa.activityName);for(let ua of A)t.add(ua)}A=this.$1l(aa,t);null!==A&&(A in h&&h[A]||(h[A]=new Mb.a),h[A].add(aa))}}b=new Mb.a;for(const O of ob.a.gO(h))t=this.Msj(h[O],2),b.addRange(t);return b}$1l(b,h){let t="";for(let A of h)t+=A,
t=b.properties.ob(A)&&void 0!==b.properties.J(A)&&null!==b.properties.J(A)?t+b.properties.J(A):t+"null";return t}}Object(m.a)(Vd,"ActivityAggregationSchemes",null,[715]);class Je{constructor(b,h,t,A,O){this.Mr=this.Bi=0;this.eRb=t;this.mnc=A;this.cUa=O;this.name=b;this.Fy=h;this.xBa=new Mb.a}get mode(){return this.Fy}get count(){return this.xBa.count}get startTime(){return this.Bi}get endTime(){return this.Mr}get sQh(){if(!this.count)return 0;let b=0;for(let h of this.xBa)b+=h.endTime-h.startTime;
return b/this.count}get xkl(){if(!this.count)return 0;let b=0;const h=this.sQh;for(let t of this.xBa){const A=t.endTime-t.startTime;b+=(A-h)*(A-h)}return b/this.count}add(b){this.count?this.Mr=b.endTime>this.endTime?b.endTime:this.endTime:(this.Bi=b.startTime,this.Mr=b.endTime);this.xBa.add(b)}fNm(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.eRb.PGi}process(){if(this.count>=this.eRb.cIi){const b=new Mb.a,h=this.mnc(this);b.add(h);return b}return this.xBa}Oqf(b){const h=new Mb.a;for(let t of this.xBa)if(t.properties.ob(b)){const A=
t.properties.J(b);h.add(A)}else h.add(null);return h}srf(){const b=this.cUa.bOc(this.name),h=new Gb.a;for(let t of this.tEl())b.contains(t)||h.add(t);return h}tEl(){const b=new Gb.a;if(!this.xBa)return b;for(let h of this.xBa)for(let t of h.properties.keys)b.add(t);return b}vPl(){return this.xBa.J(0).uniqueID}}Object(m.a)(Je,"ActivityCollection",null,[714]);class Gf{constructor(){this.Sqb=new rb.a}get list(){return this.Sqb}add(b){const h=b.activityName;if(this.Sqb.ob(h)&&this.Sqb.J(h)){const t=this.DSl(this.Sqb.J(h),
b);this.Sqb.J(h).insert(t,b)}else this.Sqb.Z(h,new Mb.a),this.Sqb.J(h).add(b)}DSl(b,h){for(let t=b.count-1;0<=t;t--)if(h.startTime>b.J(t).startTime)return t+1;return 0}}Object(m.a)(Gf,"CompletedActivitiesHelper",null,[713]);class Nc{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){v.AFrameworkApplication.uJ(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}yc(b){this.W=b;const h=A=>new dd(()=>b.Ma("Common.App.Activities.IActivityAggregationManager"),
A),t=(A,O)=>new Je(A,O,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));b.register($c,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").singleInstance().Qd(()=>new $c(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.We("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),
b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(Bc,"Common.App.ActivityAggregator.ActivityAggregationParams").singleInstance().Qd(()=>new Bc(v.AFrameworkApplication.K));b.register(ac,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").singleInstance().Qd(()=>new ac);b.register(Vd,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").singleInstance().Qd(()=>
new Vd(b.resolve("Common.IActivityAggregationInfo"),t));b.register(Gf,"Common.App.ActivityAggregator.CompletedActivitiesHelper").singleInstance().Qd(()=>new Gf)}static main(){P.a.instance.Gc(new Nc)}}Object(m.a)(Nc,"ActivityAggregatorPackage",null,[1,2]);var md=c(473),Oe=c(1379);class fg{constructor(b){this.I8g=0;this.Zse=null;this.x$j=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get u$f(){return this.x$j.value}Ub(){this.isInitialized?this.Rfc():this.GPn(Object(z.a)(this,this.Rfc,
"registerActionsInternal"))}Rfc(){u.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(b=>{b.getChatsContainer(Object(z.a)(this,this.pfn,"onChatContainerReady"))}).catch(b=>{u.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),this.chat.getChatsCounter().then(b=>{b.onChatsCountChange(Object(z.a)(this,this.ONk,"chatCountChanged"))}).catch(b=>{u.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",
b)}),this.chat.getKeyboard().then(b=>{b.onKeyDown(Object(z.a)(this,this.sfn,"onChatKeyPress"))}).catch(b=>{u.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",b)}))}catch(b){u.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}}ONk(b){u.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",b);if(!b)this.u$f.ofn();else if(1===b&&!this.I8g){const h=document.getElementById(this.Zse?this.Zse:Oe.a.vzb);h?this.u$f.tfn(h,Object(z.a)(this,this.VEo,"transferFocusToChat")):
u.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.I8g=b}pfn(b){this.Zse=b}sfn(b){b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.UEo(b.shiftKey)}GPn(b){md.a.instance.mb(db.a.eyo,window.self,()=>{b();return!0})}VEo(){u.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{u.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){u.ULS.sendTraceTag(50595974,
333,10,"Failed to transfer focus to chat: {0}",b)}}UEo(b){u.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.u$f.qfn(b)}}Object(m.a)(fg,"ChatManager",null,[768]);var If=c(67);class tf{constructor(){this.ra=new If.a;this.Sfk=!1}Crk(b){this.ra.addHandler("OnTopRowControlsCreatedEvent",b)}nrk(b){this.ra.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get PDo(){return this.Sfk}Z_i(b){this.ra.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(m.a)(tf,
"HeaderEventSource",null,[]);var vf=c(155),$f=c(299);class vg{constructor(b,h,t,A,O){this.Dvd=null;this.Vb=b;this.Zo=h;this.nk=t;this.Vfk=A;this.ga=O}F2i(b,h,t,A=null){const O=this.Vb.fe(h);O.parent=t;O.zH=!0;A&&O.E6(A);this.nk.yBa(h,b,!1);this.Vfk.yBa(h,b,!1);h=new $f.DOMFocusListing(()=>b);h.In(2);h.In(1);h.In(8);h.In(5);h.In(3);h.In(6);this.Vb.nla(()=>b,O,h).lU=!0;h=sb.KeyInputManager.mc(rc.a.iw,0);t=sb.KeyInputManager.mc(rc.a.iw,4);O.Xq(h);O.Xq(t)}onFlexPaneOpen(b){this.F2i(b,Oe.a.pcc,Oe.a.TOa);
this.Vb.mg(Oe.a.pcc);this.Zo.nea(Oe.a.pcc)}onFlexPaneClose(){this.Zo.nx(Oe.a.pcc);this.Vb.mg(Oe.a.TOa)}tfn(b,h){this.Dvd||(this.Dvd=h,this.F2i(b,Oe.a.vzb,vf.AFrame.ML,Object(z.a)(this,this.rfn,"onChatFocus")));this.Vb.mg(Oe.a.vzb);this.Zo.nea(Oe.a.vzb)}rfn(){this.Dvd&&this.Dvd()}ofn(){this.Zo.nx(Oe.a.vzb);this.Vb.KLd(vf.AFrame.$n)}qfn(b){this.ga.processAction(b?ab.a.$gf:ab.a.joe,2)}}Object(m.a)(vg,"ReactSharedHeaderFocusManager",null,[767]);var Kf=c(107),Ph=c(1041),ff=c(35),yc=c(62);class Rd{constructor(b){this.ga=
b}Ub(){this.ga.pa(ab.a.VLd,yc.a.frame,Object(z.a)(this,this.JJi,"navigateToUpsellPage"));this.ga.pa(ab.a.VAl,yc.a.frame,Object(z.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.ga.pa(ab.a.vYn,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.n7i,yc.a.frame,Kf.ActionManager.Kf)}JJi(b,h,t,A,O){if(1===t)return 32;b=8;2===t&&(t=this.Zlf(O,"experience","gopremiumribbon"),O=ia.a.M7("2116536"),O=ia.a.Xn(O,"ocid",Ph.b(v.AFrameworkApplication.ta.Ob.jm,v.AFrameworkApplication.ta.Ob.bha,t)),
ff.a.km(O,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.ga.processAction(ab.a.n7i,2),u.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b}launchUpsellExperience(b,h,t,A,O){if(1===t)return 32;var aa=8;2===t&&(u.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(aa=Sa.a.instance.Ma("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(b=this.Zlf(O,"experience","gopremium"),O=this.Zlf(O,"dimeCampaignId",null),aa.launchUpsellExperience(b,O),aa=32):
(u.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),aa=this.JJi(b,h,t,A,O)));return aa}Zlf(b,h,t){b&&b[h]&&(t=Object(Da.a)(String,b[h]));return t}}Object(m.a)(Rd,"UpsellActor",null,[712]);class de{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Sa.a.instance.resolve("Common.App.Header.IUpsellActor").Ub();Sa.a.instance.resolve("Common.App.Header.IChatManager").Ub()}dispose(){}yc(b){this.W=b;this.W.register(tf,"Common.App.Header.HeaderEventSource").singleInstance();
this.W.register(Rd,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").singleInstance().Qd(()=>new Rd(v.AFrameworkApplication.xa));this.W.register(vg,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").singleInstance().Qd(()=>new vg(v.AFrameworkApplication.ta.yp,v.AFrameworkApplication.ta.Tw,v.AFrameworkApplication.ta.B0,v.AFrameworkApplication.ta.Hje,v.AFrameworkApplication.xa));this.W.register(fg,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").singleInstance().Qd(()=>
new fg(this.W.We("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){P.a.instance.Gc(new de)}}Object(m.a)(de,"CommonAppHeaderPackage",null,[1,2]);var Sb=c(756);class nc{static n0h(b,h){switch(b){case 3:return nc.wbm(h);case 2:return nc.CZl(h);case 1:return nc.eOl(h)}return""}static wbm(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static CZl(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static eOl(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(b,h,t){if(ba.a.si||ba.a.kM)window.setTimeout(()=>{nc.W1i(t,nc.oRd())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(nc.aph(t),b,0,!1)}static mSk(b,h,t,A){h&&
A&&A();nc.openInClient(b,h,t)}static oRd(){return ba.a.si?1:ba.a.kM?2:ba.a.M2a?3:ba.a.Yk?4:0}static fbm(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static gbm(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get TBf(){return"zh-CN"===window.navigator.language}static W1i(b,h){1===h?(u.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=nc.n0h(b,h),8<ba.a.n1a?ff.a.km(b,void 0,void 0,"RedirectToAppStore"):ff.a.pCb(b)):document.hidden||(nc.TBf?(b=v.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(u.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),ff.a.pCb(b)):u.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(u.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(nc.n0h(b,
h),null,null)))}static aph(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get pge(){return(ba.a.M2a||ba.a.Yk)&&ba.a.qq}static get Emo(){return ba.a.si||ba.a.kM}static H0h(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static yui(b){return(b=nc.wTl(b))&&""!==b?Boolean.parse(b):!1}static P9f(b){nc.xco(b)}static wTl(b){try{return localStorage.getItem(b)}catch(h){return u.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static xco(b){try{localStorage.setItem(b,"true")}catch(h){u.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}nc.Szh="ChromeExtensionBarDismiss";Object(m.a)(nc,"WildFireUtilities",null,[]);var Tc=c(394);class td{constructor(){this.Rqe=new Tc.a;this.Pqe=new Tc.a;this.Oqe=new Tc.a;this.FFk(this.Rqe);this.EFk(this.Pqe);this.DFk(this.Oqe);this.sBe=new Tc.a;
this.rBe=new Tc.a;this.qBe=new Tc.a;this.kIk(this.sBe);this.jIk(this.rBe);this.iIk(this.qBe);this.qte=new Tc.a;this.RFk(this.qte);this.Yxb(this.qte);this.Yxb(this.Oqe);this.Yxb(this.Pqe);this.Yxb(this.Rqe);this.Yxb(this.rBe);this.Yxb(this.sBe);this.Yxb(this.qBe)}DQd(b,h){switch(b){case 1:return this.lcm(h);case 2:return this.REl(h)}return nc.pge?this.qte:null}FFk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}EFk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}DFk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}kIk(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}RFk(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}jIk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}iIk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}Yxb(b){b.add("Corporation","Microsoft Corporation")}lcm(b){switch(b){case 3:return this.sBe;case 2:return this.rBe;case 1:return this.qBe}return null}REl(b){switch(b){case 3:return this.Rqe;case 2:return this.Pqe;case 1:return this.Oqe}return null}static get instance(){td._instance||
(td._instance=new td);return td._instance}}td._instance=null;Object(m.a)(td,"WildFireStringFactory",null,[]);class je{constructor(b,h,t,A,O=null,aa=null){this.iKe=null;this._id=b;this.KLe=h;this.eZj=O;this.Wtc=A;this.mzc=aa;this.p8a=null;this.DBc=t;this.vAc=td.instance.DQd(h,b)}W1k(){this.p8a=new Sb.a(this.title,this.message,null);this.p8a.addButton(this.BIk,Object(z.a)(this,this.Xen,"onButtonOneClick"),"");this.DBc&&this.p8a.xlh(this.HIk,Object(z.a)(this,this.bfn,"onButtonTwoClick"));this.p8a.xla=
Object(z.a)(this,this.Fgl,"dismissBar");this.p8a.image=3;this.p8a.id=16;this.p8a.closeable=!0}get title(){return this.vAc.J("Headline")}get message(){return this.vAc.J("CallToAction")}get BIk(){return this.DBc?this.vAc.J("InstallButton"):this.vAc.J("UseAppButton")}get HIk(){return this.DBc?this.vAc.J("OpenAppButton"):""}Xen(){this.DBc?this.bvm():this.aTo()}bfn(){this.DBc&&this.zpn()}get uvh(){return this.p8a}get b4a(){this.iKe||(this.iKe=this.eZj());return this.iKe}bvm(){u.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.Wtc&&this.mzc&&this.mzc();nc.W1i(this._id,this.KLe)}zpn(){this.b4a&&(u.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Wtc&&this.mzc&&this.mzc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(nc.aph(this._id),this.b4a,0,!1))}aTo(){nc.pge?this.xIk():(u.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),nc.P9f("BizBarClicked"),1!==this.KLe&&2!==this.KLe||nc.mSk(this.b4a,this.Wtc,this._id,this.mzc))}xIk(){this.Wtc?
u.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):u.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");ff.a.pCb(v.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}Ggl(){this.Wtc?u.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):u.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");nc.P9f(nc.Szh)}Fgl(){nc.pge?this.Ggl():(nc.P9f(nc.H0h(this._id)),u.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static u$e(){const b=v.AFrameworkApplication.ta.Ob;
new je(b.jm,nc.oRd(),8<ba.a.n1a,1===b.bha,()=>b.Pea,b.R5f());u.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(m.a)(je,"WildFireBusinessBar",null,[]);class se{get name(){return"Common.App.WildFire"}CWe(b){const h=v.AFrameworkApplication.ta.Ob;let t=!1;b&&(b.W1k(),b.uvh&&(t=h.Wka(b.uvh,!0)));return t}b2k(){var b=v.AFrameworkApplication.ta.Ob;b=new je(b.jm,nc.oRd(),!1,1===b.bha);this.CWe(b)&&u.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}u$e(b,h,t,A,O,aa){b=new je(b,
t,A,h,O,aa);this.CWe(b)&&u.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}T8k(){const b=v.AFrameworkApplication.ta.Ob;var h=v.AFrameworkApplication.K;const t=b.jm,A=1===b.bha;if(h.$(nc.fbm(t))){var O=nc.oRd(),aa=8<ba.a.n1a;if(2!==t||2!==O||!A){h=h.$(nc.gbm(t));var ua=b.R5f(),Ra=()=>b.Pea;h&&!nc.yui(nc.H0h(t))&&this.u$e(t,A,O,aa,Ra,ua)}}}init(){var b=v.AFrameworkApplication.K;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;nc.pge&&b&&!nc.yui(nc.Szh)?
this.b2k():(document.body&&nc.Emo&&this.T8k(),v.AFrameworkApplication.xa.pa(ab.a.nGf,yc.a.frame,Object(z.a)(this,this.nGf,"launchWildFireBusinessBar")))}nGf(b,h,t,A,O){if(1===t)return 32;if(!O)return 8;this.u$e(O.app,O.mode,O.platform,O.useTwoButton,null,null);return 32}dispose(){}yc(){}static main(){P.a.instance.Gc(new se)}}Object(m.a)(se,"PackageManager",null,[1,2]);class Ze{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(m.a)(Ze,"BrowserInfo",null,[]);class Xe{constructor(){this.Version=
this.Name=null}}Object(m.a)(Xe,"PluginInfo",null,[]);class ye{static Aba(){if(v.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=ye.sBl();try{const h=JSON.stringify(b);u.ULS.sendTraceTag(6903563,102,50,h)}catch(h){u.ULS.sendTraceTag(6903564,102,15,h.message)}}else u.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static I0l(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let t=0;t<b.length;t++){const A=b[t].name,O=b[t].version;
Array.add(h,Object.assign(new Xe,{Name:A,Version:O}))}return h}static sBl(){const b=new Ze,h=new Sys.StringBuilder;ye.qH(t=>{b.DocElemClientHeight=t},()=>document.documentElement.clientHeight,h);ye.qH(t=>{b.DocElemClientWidth=t},()=>document.documentElement.clientWidth,h);ye.qH(t=>{b.DocElemOffsetHeight=t},()=>document.documentElement.offsetHeight,h);ye.qH(t=>{b.DocElemOffsetWidth=t},()=>document.documentElement.offsetWidth,h);ye.qH(t=>{b.ScreenAvailHeight=t},()=>window.screen.availHeight,h);ye.qH(t=>
{b.ScreenAvailWidth=t},()=>window.screen.availWidth,h);ye.qH(t=>{b.ScreenWidth=t},()=>window.screen.width,h);ye.qH(t=>{b.ScreenHeight=t},()=>window.screen.height,h);ye.qH(t=>{b.ScreenLogicalXdpi=t},()=>window.screen.logicalXDPI,h);ye.qH(t=>{b.ScreenLogicalYdpi=t},()=>window.screen.logicalYDPI,h);ye.qH(t=>{b.ScreenDeviceXdpi=t},()=>window.screen.deviceXDPI,h);ye.qH(t=>{b.ScreenDeviceYdpi=t},()=>window.screen.deviceYDPI,h);ye.qH(t=>{b.WinInnerHeight=t},()=>window.self.innerHeight,h);ye.qH(t=>{b.WinInnerWidth=
t},()=>window.self.innerWidth,h);ye.qH(t=>{b.WinOuterHeight=t},()=>window.self.outerHeight,h);ye.qH(t=>{b.WinOuterWidth=t},()=>window.self.outerWidth,h);ye.qH(t=>{b.WinOrientation=t},()=>window.self.orientation,h);ye.qH(t=>{b.WinDevicePixelRatio=t},()=>window.self.devicePixelRatio,h);ye.qH(t=>{b.SupportsTouch=t},()=>ba.a.c8c,h);ye.qH(t=>{b.NavAppName=t},()=>window.navigator.appName,h);ye.qH(t=>{b.NavAppVersion=t},()=>window.navigator.appVersion,h);ye.qH(t=>{b.NavLanguage=t},()=>window.navigator.browserLanguage||
window.navigator.language,h);ye.qH(t=>{b.NavUserAgent=t},()=>window.navigator.userAgent,h);ye.qH(t=>{b.NavPlatform=t},()=>window.navigator.platform,h);ye.qH(t=>{b.NavPlugins=t},ye.I0l,h);ye.qH(t=>{b.CalculatedDevicePixelRatio=t},()=>ye.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static qH(b,h,t){try{const A=h();b(A)}catch(A){t.isEmpty()||t.append(" | "),t.append(A.message||
"null")}}}Object(m.a)(ye,"BrowserInfoLogger",null,[]);class Ei{get name(){return"Common.App.BrowserInfoLogger"}yc(){}init(){ye.Aba()}dispose(){}static main(){P.a.instance.Gc(new Ei)}}Object(m.a)(Ei,"BrowserInfoLoggerPackage",null,[1,2]);class Db{constructor(){this.ra=new If.a}Mcb(b){this.ra.addHandler("OnEditHappenedEvent",b)}V2c(b){this.ra.removeHandler("OnEditHappenedEvent",b)}IGn(){this.ra.raiseEvent("OnEditHappenedEvent")}}Object(m.a)(Db,"EditNotificationEventSource",null,[]);var Vb=c(79);class Sc{constructor(b,
h,t,A,O,aa,ua=0){this.sxe=!1;this.rxe=this.Gub=null;this.bhh=!1;this.Gb=h;this.god=b;this.w$a=t;this.pda=A;this.$gh=O;this.OVj=aa;this.ugd=0;this.Bid=!1;try{0<ua&&(this.ugd=ua,3E5>this.ugd&&(this.ugd=3E5),this.Gb&&!this.rxe&&(this.rxe=new Vb.a(3,2,this.ugd,Object(z.a)(this,this.oYn,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Gb.Wb(this.rxe)))}catch(Ra){u.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+Ra)}}get vkg(){return this.bhh}editHappened(){this.vkg?
this.Bid=!0:(this.bhh=!0,wa.Health.instance.addQosPillar("Save"),wa.Health.instance.addQosPillar("ContentCreation"),lb.c(ab.a.editDocument));this.sxe=!0;this.$gh&&this.$gh.sjh();this.pda&&this.pda.IGn();v.AFrameworkApplication.Sg&&v.AFrameworkApplication.Sg.f4m();this.OVj&&!this.Gub&&(this.X4c(null),this.Gub=new Vb.a(3,2,this.god,Object(z.a)(this,this.X4c,"sendPostMessageIfNecessary"),113),this.Gb.Wb(this.Gub))}X4c(){this.sxe&&(this.w$a.CWR(()=>this.w$a.result.sendMessage(K.a.editNotification,null)),
u.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.sxe=!1)}oYn(){try{this.Bid&&(lb.c(ab.a.editDocument),this.Bid=!1)}catch(b){this.Bid=!1,u.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+b)}}}Object(m.a)(Sc,"EditNotificationManager",null,[770]);class bd{constructor(b,h,t,A,O){this.tAe=this.Gub=null;this.gUb=this.dqe=!1;this.Gb=h;this.god=b;this.w$a=t;this.nk=A;this.CJe=O;this.M2i(null)}M2i(){const b=
document.getElementById(v.AFrameworkApplication.X_b);!this.gUb&&this.nk&&b&&(this.nk.mb(db.a.L_,b,Object(z.a)(this,this.VKf,"mouseActivityHandler"),null),this.gUb=!0);this.CJe(()=>{this.dispose()})}VKf(){this.gUb&&(this.nk.sc(db.a.L_,document.getElementById(v.AFrameworkApplication.X_b),Object(z.a)(this,this.VKf,"mouseActivityHandler")),this.gUb=!1);this.sjh();return!1}sjh(){this.dqe=!0;this.tAe||(this.tAe=new Vb.a(3,2,this.god,Object(z.a)(this,this.M2i,"registerHandlerTask"),112),this.Gb.Wb(this.tAe));
this.Gub||(this.X4c(null),this.Gub=new Vb.a(3,2,this.god,Object(z.a)(this,this.X4c,"sendPostMessageIfNecessary"),111),this.Gb.Wb(this.Gub))}X4c(){this.dqe&&(this.w$a.CWR(()=>this.w$a.result.sendMessage(K.a.DTo,null)),u.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.dqe=!1)}dispose(){this.gUb&&(this.nk.sc(db.a.L_,document.getElementById(v.AFrameworkApplication.X_b),Object(z.a)(this,this.VKf,"mouseActivityHandler")),this.gUb=!1)}}Object(m.a)(bd,
"UserActivityHostNotificationManager",null,[769,9]);var Ud=c(153),sf=c(83),eg=c(648);class Ug{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Wo(Object(z.a)(this,this.zx,"onFullAppSettingsReady"))}zx(){Ug.Rkl&&0<Ug.mef&&(this.W.register(Db,"Common.App.HostNotification.EditNotificationEventSource").singleInstance(),this.W.register(bd,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").singleInstance().Qd(()=>
new bd(6E4,sf.a.instance,eg.a.xp(this.W.Sa("Postmessage.IHostPostmessenger")),Ud.a.instance,v.AFrameworkApplication.uJ)),this.W.register(Sc,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").singleInstance().Qd(()=>new Sc(Ug.mef,sf.a.instance,eg.a.xp(this.W.Sa("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.Ma("Common.Interface.IUserActivityHostNotificationManager"),Ug.Skl,Ug.Lkl)),
this.W.resolve("Common.Interface.IEditNotificationManager"),u.ULS.shipAssertTag(38086291,209,0<Ug.mef,"EditNotification Interval is less than or equal to 0."))}yc(b){this.W=b}dispose(){}static get mef(){return v.AFrameworkApplication.K?parseInt(v.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get Lkl(){return v.AFrameworkApplication.K?parseInt(v.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get Rkl(){return!!v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get Skl(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){P.a.instance.Gc(new Ug)}}Object(m.a)(Ug,"CommonHostNotificationPackage",null,[1,2]);class Lh{constructor(b,h,t){this.Bwb=null;this.Gb=b;this.ga=h;this.gSg=t.create()}smb(){this.Bwb?u.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(u.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),
this.Bwb=new Vb.a(2,1,3E4,Object(z.a)(this,this.Dge,"showFloatPane"),67),this.Gb.Wb(this.Bwb))}Dge(){this.Bwb=null;u.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.gSg.display()}IRa(){this.ga.pa(ab.a.Dge,yc.a.frame,Object(z.a)(this,this.Qoo,"showFloatPaneHandler"))}Qoo(b,h,t,A,O){return b!==ab.a.Dge?2:1===t?32:2===t&&O?(u.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",O),O?this.smb():(this.Bwb?(u.ULS.sendTraceTag(23674914,
207,50,"Hide float pane via removing show task!"),this.Gb.Se(this.Bwb)):(u.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.gSg.remove(null)),this.Bwb=null),32):8}}Object(m.a)(Lh,"FloatPaneActor",null,[772]);var ah=c(89),dh=c(97),Hf=c(29),Mf=c(23);class Md{constructor(b,h,t,A,O){this.TGe=this.Ssc=this.ird=this.UWa=this.Oda=this.rUa=this.ise=this.s$=this.xxc=this.qvc=this.rvc=this.$ye=null;this.Gb=h;this.Na=b;this.hg=t;this.W=O;this.bza=A}aHh(){this.s$=document.createElement("div");
this.s$.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.s$.style.width=this.Oda.width+"px";(this.TGe=this.vYl(this.bza))?(this.UWa=document.createElement("a"),this.UWa.setAttribute(Mf.a.oh,Mf.a.Ny),this.hg.mb(db.a.click,this.UWa,Object(z.a)(this,this.kQi,"onRedirectClick")),this.UWa.href=this.TGe,this.UWa.target="_blank",this.UWa.appendChild(this.Oda),this.s$.appendChild(this.UWa)):this.s$.appendChild(this.Oda);this.rUa=document.createElement("a");this.rUa.setAttribute(Mf.a.oh,
Mf.a.z2);this.rUa.className="StandardButton WACFloatPaneCloseButton";this.rUa.title=CommonUIStrings.l_Close;this.rUa.tabIndex=-1;this.ise=dh.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.ise.setAttribute(Mf.a.oh,Mf.a.Ny);this.rUa.appendChild(this.ise);this.hg.mb(db.a.click,this.rUa,Object(z.a)(this,this.onClose,"onClose"));this.s$.appendChild(this.rUa);this.xxc.appendChild(this.s$)}oSl(b){const h=this.Na.$("O365PromotionHasStarted");
switch(b){case 2:return ah.a.laa(String.format("adppt{0}.png",h?"sale":""));case 1:return ah.a.laa(String.format("adxls{0}.png",h?"sale":""));case 3:return ah.a.laa(String.format("addoc{0}.png",h?"sale":""))}return null}vYl(b){const h=this.Na.kb("O365AdPaneRedirectedURL");switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.Ssc=null;this.s$&&!this.ird&&(b?u.ULS.sendTraceTag(23674904,207,50,
"The float pane is closed automatically."):u.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.s$.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.s$.style.height="0px",this.ird=new Vb.a(2,1,1E3,Object(z.a)(this,this.remove,"remove"),67),this.Gb.Wb(this.ird))}remove(){this.s$&&this.xxc&&(this.UWa&&this.hg.sc(db.a.click,this.UWa,Object(z.a)(this,this.kQi,"onRedirectClick")),this.hg.sc(db.a.click,this.rUa,Object(z.a)(this,this.onClose,"onClose")),
this.xxc.removeChild(this.s$),this.s$=null);this.ird=null}display(){if(this.$ye=this.W.Ma("Common.IFloatPaneContainer"))if(this.xxc=this.$ye.container){var b=this.oSl(this.bza);b?(u.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.Oda=document.createElement("img"),this.Oda.className="WACFloatPaneImage",this.rvc=Object(z.a)(this,this.Fjn,"onLoadImageFinish"),Hf.a.addHandler(this.Oda,db.a.load,this.rvc),this.qvc=Object(z.a)(this,this.Ejn,"onLoadImageError"),Hf.a.addHandler(this.Oda,
db.a.error,this.qvc),this.Oda.src=b):u.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else u.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else u.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}Fjn(){const b=this.Na.pc("O365AdPaneShowingDuration",60);this.aHh();this.s$.style.display="block";this.s$.style.height=this.Oda.height+"px";this.Ssc=new Vb.a(2,
1,1E3*b,Object(z.a)(this,this.hide,"hide"),67);this.Gb.Wb(this.Ssc);this.v4i()}Ejn(){u.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.v4i();this.Oda=null}v4i(){this.rvc&&this.Oda&&Hf.a.removeHandler(this.Oda,db.a.load,this.rvc);this.rvc=null;this.qvc&&this.Oda&&Hf.a.removeHandler(this.Oda,db.a.error,this.qvc);this.qvc=null}kQi(){u.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.Ssc&&
this.Gb.Se(this.Ssc);this.hide();return!0}dispose(){this.hide()}}Object(m.a)(Md,"FloatPane",null,[791]);class Sd{constructor(b,h,t,A,O){this.Gb=h;this.Na=b;this.hg=t;this.W=O;this.bza=A}create(){return new Md(this.Na,this.Gb,this.hg,this.bza,this.W)}}Object(m.a)(Sd,"FloatPaneFactory",null,[771]);var Pd=c(208);class Fk{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get Wsi(){return v.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&v.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.Wsi&&
(u.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").smb(),u.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").IRa())}yc(b){this.W=b;this.Wsi&&(this.W.register(Sd,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Qd(()=>new Sd(v.AFrameworkApplication.K,v.AFrameworkApplication.oc,Pd.a.instance,v.AFrameworkApplication.ta.Ob.jm,
this.W)).singleInstance(),this.W.register(Lh,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Qd(()=>new Lh(v.AFrameworkApplication.oc,v.AFrameworkApplication.xa,this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).singleInstance())}dispose(){}static main(){P.a.instance.Gc(new Fk)}}Object(m.a)(Fk,"FloatPanePackage",null,[1,2]);var Vg=c(1639);class Lf{}Object(m.a)(Lf,"LokiTokenResult",null,[]);class kg{constructor(b){this.pod=b}rpf(){const b=this.xVl();return b?
kg.x2a?new Promise((h,t)=>{this.pod.continueWith(()=>{this.pod.wo||this.pod.Ai?t(Error.create("Error downloading auth library")):this.pod.result.T4("Loki",b).then(A=>{A=v.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.AVl():A.IsSuccess&&A.Token?Object.assign(new Lf,{isSuccess:!0,token:A.Token,errorMessage:null}):Object.assign(new Lf,{isSuccess:!1,token:null,errorMessage:JSON.stringify(A)});h(A);return A})})}):Promise.resolve(Object.assign(new Lf,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):
Promise.resolve(Object.assign(new Lf,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Vg.a.v0h())}))}AVl(){const b=v.AFrameworkApplication.K.kb("LokiUserDataSignature")||"";return Object.assign(new Lf,{isSuccess:!0,token:b,errorMessage:null})}xVl(){let b=null;const h=Vg.a.sMd();2===h?b=v.AFrameworkApplication.K.kb("LokiAADAppId"):1===h&&(b=v.AFrameworkApplication.K.kb("LokiMSAAppId"));return b}static get x2a(){return v.AFrameworkApplication.K.$("IsO365CommercialHost")||
v.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(m.a)(kg,"LokiTokenManager",null,[774]);class Og{get name(){return"Common.App.LivePersonaUtils"}init(){Sa.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}yc(b){b.register(kg,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").singleInstance().Qd(()=>new kg(eg.a.xp(b.Sa("Common.App.OAuth.IOAuthManager"))))}static main(){P.a.instance.Gc(new Og)}}Object(m.a)(Og,"LivePersonaUtilsPackage",null,[1,2]);class kh{constructor(b){this.Kqe=
b}fsi(b){if(!this.Kqe)return!0;b=ia.a.rof(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.Kqe.length;h++)if(b.endsWith(this.Kqe[h]))return!0;return!1}}Object(m.a)(kh,"DomainAllowListManager",null,[]);class ai{constructor(b,h){this.paf=null;this.bTe=b;this.url=h}get bkg(){return ia.a.Exa(this.url)}get Kr(){return this.bTe}kgg(){const b={},h=this.Kr;b.a=this.bkg;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);
b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);b.s=this.round(h.domContentLoadedEventEnd);
b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.paf;return b}round(b){return Math.round(1E3*b)/1E3}}Object(m.a)(ai,"PerformanceTimingEntry",null,[]);const Bn=(b,h)=>{const t={};let A=null;switch(b){case 0:A="ResourceTiming";b=h.a;null!=b&&(t.Url=b);b=h.b;null!=b&&(t.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(t.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(t.RedirectEnd=b);b=null==h.e?null:h.e.toString();null!=b&&(t.FetchStart=
b);b=null==h.f?null:h.f.toString();null!=b&&(t.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(t.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(t.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(t.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(t.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(t.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(t.ResponseStart=b);b=null==h.m?null:h.m.toString();null!=b&&(t.ResponseEnd=b);b=h.n;
null!=b&&(t.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(t.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(t.EncodedBodySize=b);h=null==h.q?null:h.q.toString();null!=h&&(t.TransferSize=h);break;case 1:A="PerformanceTiming",b=h.a,null!=b&&(t.Url=b),b=null==h.b?null:h.b.toString(),null!=b&&(t.NavigationStart=b),b=null==h.c?null:h.c.toString(),null!=b&&(t.UnloadEventStart=b),b=null==h.d?null:h.d.toString(),null!=b&&(t.UnloadEventEnd=b),b=null==h.e?null:h.e.toString(),null!=b&&
(t.RedirectStart=b),b=null==h.f?null:h.f.toString(),null!=b&&(t.RedirectEnd=b),b=null==h.g?null:h.g.toString(),null!=b&&(t.FetchStart=b),b=null==h.h?null:h.h.toString(),null!=b&&(t.DomainLookupStart=b),b=null==h.i?null:h.i.toString(),null!=b&&(t.DomainLookupEnd=b),b=null==h.j?null:h.j.toString(),null!=b&&(t.ConnectStart=b),b=null==h.k?null:h.k.toString(),null!=b&&(t.ConnectEnd=b),b=null==h.l?null:h.l.toString(),null!=b&&(t.SecureConnectionStart=b),b=null==h.m?null:h.m.toString(),null!=b&&(t.RequestStart=
b),b=null==h.n?null:h.n.toString(),null!=b&&(t.ResponseStart=b),b=null==h.o?null:h.o.toString(),null!=b&&(t.ResponseEnd=b),b=null==h.p?null:h.p.toString(),null!=b&&(t.DomLoading=b),b=null==h.q?null:h.q.toString(),null!=b&&(t.DomInteractive=b),b=null==h.r?null:h.r.toString(),null!=b&&(t.DomContentLoadedEventStart=b),b=null==h.s?null:h.s.toString(),null!=b&&(t.DomContentLoadedEventEnd=b),b=null==h.t?null:h.t.toString(),null!=b&&(t.DomComplete=b),b=null==h.u?null:h.u.toString(),null!=b&&(t.LoadEventStart=
b),b=null==h.v?null:h.v.toString(),null!=b&&(t.LoadEventEnd=b),h=h.w,null!=h&&(t.CustomText=h)}t.Table=A;return Sys.Serialization.JavaScriptSerializer.serialize(t)};var yh=c(38),bi=c(203),qi=c(161);class ql{constructor(b,h=null,t=null){this.Mg=b;this.akg=this;this.lYj=h||(()=>window.location.href);this.Zwe=new kh(t)}run(){if(ql.sdb(window.performance))try{const O=this.lYj();if(ql.cgk.exec(O)&&this.Zwe.fsi(O)){var b=new ai(window.performance.timing,O);qi.a.instance.FJn(b.Kr.fetchStart);qi.a.instance.GJn(b.Kr.navigationStart);
qi.a.instance.cY(yh.a.DAl,"connectStart","requestStart");qi.a.instance.cY(yh.a.LAl,"requestStart","responseStart");qi.a.instance.cY(yh.a.OAl,"responseStart","responseEnd");this.akg.dIb(1,b.kgg());this.Mg.Rf(yh.a.bgb,b.Kr.fetchStart);this.Mg.Rf(yh.a.IAl,b.Kr.domainLookupStart);this.Mg.Rf(yh.a.HAl,b.Kr.domainLookupEnd);this.Mg.Rf(yh.a.FAl,b.Kr.connectStart);this.Mg.Rf(yh.a.QAl,b.Kr.secureConnectionStart);this.Mg.Rf(yh.a.EAl,b.Kr.connectEnd);this.Mg.Rf(yh.a.MAl,b.Kr.requestStart);this.Mg.Rf(yh.a.Ojf,
b.Kr.responseStart);this.Mg.Rf(yh.a.JAl,b.Kr.responseEnd-b.Kr.responseStart);this.Mg.Rf(yh.a.NAl,b.Kr.responseStart-b.Kr.requestStart);var h=0,t=0,A=0;({transferSize:h,aff:t,Maf:A}=this.IHo(O)).returnValue&&(this.Mg.Rf(yh.a.SAl,h),this.Mg.Rf(yh.a.GAl,A),this.Mg.Rf(yh.a.KAl,t));this.Mg.Rf(yh.a.xLc,b.Kr.navigationStart)}}catch(O){u.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",O)}}IHo(b){let h,t,A;A=t=h=-1;if(void 0===window.performance.getEntriesByName||null===
window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,aff:t,Maf:A};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,aff:t,Maf:A};b=b[0];var O=b.transferSize;void 0!==h&&null!==h&&(h=O);O=b.decodedBodySize;void 0!==O&&null!==O&&(A=O);b=b.encodedBodySize;void 0!==b&&null!==b&&(t=b);return{returnValue:!0,transferSize:h,aff:t,Maf:A}}dIb(b,h){u.ULS.sendTraceTag(4551815,306,50,Bn(b,h))}static get instance(){return ql._instance||
(ql._instance=new ql(bi.a.instance,null,v.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?v.AFrameworkApplication.K.oC("ResourceLoggerDomainAllowList"):null))}static sdb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}ql._instance=null;ql.cgk=RegExp("^https?://.*","i");Object(m.a)(ql,"PerformanceTimingLogger",null,[773]);class ci{constructor(b,h){this.paf=null;this.bTe=b;this.behavior=h;this.url=this.Kr.name}get bkg(){return 2===this.behavior?this.url:
ia.a.Exa(this.url)}get Kr(){return this.bTe}kgg(){const b={},h=this.Kr;b.a=this.bkg;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);
b.o=this.round(ci.l7b(h,"decodedBodySize"));b.p=this.round(ci.l7b(h,"encodedBodySize"));b.q=this.round(ci.l7b(h,"transferSize"));b.n=this.paf;return b}round(b){return Math.round(1E3*b)/1E3}static l7b(b,h){return b[h]}}Object(m.a)(ci,"ResourceTimingEntry",null,[792]);class Zk{constructor(b,h=null,t=100){this.hIg=b;this.Rtd=h;this.dRb={};this.BRj=t}qGo(b){var h=b.name.toLowerCase();const t=ia.a.tPd(h);this.a0n(t,h)&&(t in this.dRb?u.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
t):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.HLm(b),h.encodedsize=ci.l7b(b,"encodedBodySize"),h.decodedsize=ci.l7b(b,"decodedBodySize"),this.dRb[t]=h))}a0n(b,h){if(this.hIg)return Array.contains(this.hIg,b);if(this.Rtd)for(b=ia.a.YZ(h),h=0;h<this.Rtd.length;h++)if(this.Rtd[h]&&b.endsWith(this.Rtd[h]))return!0;return!1}HLm(b){try{const h=ci.l7b(b,"transferSize");if(void 0!==h&&null!==h)return!h;u.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");
return b.responseEnd-b.fetchStart<this.BRj}catch(h){u.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",h.message)}return!1}fMn(){if(ob.a.mf(this.dRb))u.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var b=v.AFrameworkApplication.Daa?v.AFrameworkApplication.Daa.split(";"):[],h=Object.assign(new Hb.a,{extendedProperties:eb.a.KF()});h.extendedProperties.set("Flights",E.c(b));
this.GDi(h,this.dRb,wa.Health.instance)}}Lkf(b){let h=0,t=0,A=0,O=0;const aa=this.dRb;for(let Ra in aa){var ua=aa[Ra];Ra.endsWith(".js")&&(ua=Object(Da.a)(Object,ua),ua.responseend<b&&(h+=1,t+=ua.decodedsize,O+=ua.encodedsize,A+=ua.iscached?0:ua.encodedsize))}b={};b.filesLoaded=h;b.decodedBytes=t;b.transferredBytes=A;b.encodedBytes=O;return b}GDi(b,h,t){if(h){var A=0,O=0,aa=0,ua=0,Ra=0,ub=0,Nb=0,Yb=0,bc=0,Dc=0,Pc=0;for(let Cd in h){var jd=h[Cd];try{const ee=Object(Da.a)(Object,jd);if(!ee)continue;
const Od=ee.iscached?Boolean.parse(ee.iscached.toString()):!1,fe=ee.fetchstart?this.parseFloat(ee.fetchstart.toString()):0,Ee=(ee.responseend?this.parseFloat(ee.responseend.toString()):0)-fe,re=ee.encodedsize?this.parseFloat(ee.encodedsize.toString()):0,Fg=ee.decodedsize?this.parseFloat(ee.decodedsize.toString()):0;A+=Ee;ua+=re;Nb+=Fg;Dc++;Od?(aa+=Ee,ub+=re,bc+=Fg,Pc++):(O+=Ee,Ra+=re,Yb+=Fg)}catch(ee){u.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",
ee.message)}}b.extendedProperties.set("StaticResources",E.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",A.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",O.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",aa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",ua.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Ra.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",
ub.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Nb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Yb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",bc.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",Dc.toString());b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Pc.toString());t.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",
null);t.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(m.a)(Zk,"AppStaticResourceManager",null,[]);class Wg extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(m.a)(Wg,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Qh{constructor(b,h,t=null,A=null,O=100){this.ZEe=!1;this.ro=null;this.Epc=0;this.ra=new If.a;this.mRb=null;this.YY=!1;this.ofh=0;this.Gb=b;this.UNg=0;this.akg=this;this.Zwe=new kh(t);
this.aK=h;A&&(this.mRb=new Zk(null,A,O))}get yuh(){try{return!(void 0===this.aK||null===this.aK)&&!(void 0===this.aK.getEntriesByType||null===this.aK.getEntriesByType)}catch(b){return u.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get ial(){return this.UNg}get isActive(){return this.YY}get agg(){return this.ofh}emh(b){this.ra.addHandler(Qh.Yff,b)}A5i(b){this.ra.removeHandler(Qh.Yff,b)}yc(b,h){const t=this.agg!==b;this.ofh=
b;this.isActive&&this.Gb&&t&&(this.Se(),this.Wb());this.UNg=h}activate(){!this.isActive&&this.yuh&&(this.Wb(),this.YY=!0)}deactivate(b){this.isActive&&(this.Se(),b&&this.flush(),this.YY=!1)}flush(){if(this.isActive&&this.yuh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.Epc&&u.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",b.length-this.Epc);const h=!(void 0===window.performance.clearResourceTimings||
null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.Epc=0);const t=[];for(let A=this.Epc;A<b.length;A++)this.Zwe.fsi(b[A].name)&&(this.mRb&&this.mRb.qGo(b[A]),t.push(new ci(b[A],this.ial)));h||(this.Epc=b.length);this.ra.raiseEvent(Qh.Yff,new Wg(t));for(b=0;b<t.length;b++)0!==t[b].behavior&&2!==t[b].behavior||this.akg.dIb(0,t[b].kgg());0<t.length&&u.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",
t.length)}catch(h){u.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}dIb(b,h){u.ULS.sendTraceTag(4310804,306,50,Bn(b,h))}AJn(){this.mRb.fMn()}Lkf(b){return this.mRb.Lkf(b)}Wb(){this.Gb&&0<this.agg&&(this.ro=new Vb.a(3,2,1E3*this.agg,()=>{this.flush()},5),this.Gb.Wb(this.ro),this.ZEe=!0)}Se(){this.ZEe&&(this.Gb.Se(this.ro),this.ro=null,this.ZEe=!1)}}Qh.Yff="EntriesAvailable";Object(m.a)(Qh,"ResourceTimingLogger",null,[691,773]);class Fm{constructor(){this.W=
null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");ql.instance.run()}dispose(){}yc(b){this.W=b;let h=null;if(v.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=v.AFrameworkApplication.K.oC("ResourceLoggerDomainAllowList")}catch(O){u.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const t=[];t.push(ia.a.YZ(ah.a.H4).toLowerCase());t.push(ia.a.YZ(ah.a.l6c).toLowerCase());
const A=v.AFrameworkApplication.K.pc("AppStaticResourceMonitorCacheThresholdInMs",100);b.register(691,"Common.NetworkTiming.IResourceTimingLogger").singleInstance().Qd(()=>new Qh(v.AFrameworkApplication.oc,window.performance,h,t,A))}static main(){P.a.instance.Gc(new Fm)}}Object(m.a)(Fm,"ResourceTimingPackage",null,[1,2]);var Pg=c(234);class Xh{constructor(){this.aqe={}}kjk(b){this.aqe[b.id.toString()]=b}Abn(b){const h=this.aqe;for(let t in h)h[t].notify(b,!1);this.aqe={}}tEn(b,h){h&&this.kjk(h);return this.xQi(b,
h)}Nef(b){this.Abn(b)}lRh(b,h){b.notify(h,!0)}}Object(m.a)(Xh,"AEventEmitter",null,[528]);var fi;(function(b){b[b.notStarted=0]="notStarted";b[b.waiting=1]="waiting";b[b.shouldRetry=2]="shouldRetry";b[b.complete=3]="complete"})(fi||(fi={}));Object(m.b)("EventResultState",fi);class kl{constructor(){this._state=0}get state(){return this._state}set state(b){u.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:fi[this._state],["NewState"]:fi[b]},"ResultType",this.nbi());
this._state=b}}Object(m.a)(kl,"AEventResult",null,[527]);class $k extends kl{constructor(){super();this.uRe=this.Sxc=null;this.state=0;this.ECe=this.AWg=!1}get $ba(){return this.Sxc}get q6a(){return this.uRe}get hvm(){return this.AWg}nbi(){return"GetMoreInfo Result"}}Object(m.a)($k,"GetMoreInfoResult",kl,[756,527]);var dj=c(1370),Mm=c(1540),Qi=c(1042);class Rg{constructor(b,h,t,A,O,aa,ua,Ra){this.ga=b;this.Of=h;this.Fh=t;this.bza=A;this.Gb=O;this.$C=aa;this.BZj=ua;this.mud=Ra}BNn(){this.Qcc.pa(ab.a.eec,
yc.a.frame,Object(z.a)(this,this.eec,"openUrlInNewTab"));this.Qcc.pa(ab.a.TTf,yc.a.frame,Object(z.a)(this,this.TTf,"openDocumentUrl"));v.AFrameworkApplication.mfa?this.NDi():this.Qcc.gb(ab.a.RHd,yc.a.frame,Object(z.a)(this,this.RHd,"documentLoaded"),96)}eec(b,h,t,A,O){O&&O.MenuItemId&&(u.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:O.SourceControlId,["AppType"]:Qi.a[this.HFa]}),ff.a.km(O.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}TTf(b,
h,t,A,O){if(O&&O.MenuItemId){const aa=v.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),ua=v.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");u.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",aa,ua);if(aa&&ua){u.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:O.SourceControlId,["AppType"]:Qi.a[this.HFa]});b=O.MenuItemId.toString();const Ra={};Ra[J.a.Pfc]="1";Ra[J.a.documentUrl]=b;Ra[J.a.reason]=Mm.a.open;
u.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");v.AFrameworkApplication.lO().execute(ub=>{ub.sendMessage(K.a.kBb,Ra)})}else this.eec(b,h,t,A,O)}return 32}RHd(){this.NDi();return 32}lQa(b,h,t=""){if(h&&h.tH){const A=dj.a[h.status];h=h.tH.getTime();const O=this.ir()-h;u.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:A,["ElapsedMs"]:O,["StartTime"]:h,["Notes"]:t})}else u.ULS.sendTraceTag(5849680,202,50,
"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}NDi(){var b=v.AFrameworkApplication.K.$("QPGVCI"),h=ia.a.JT(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var t=ia.a.JT(document.URL,"wdPreviousSession",b);b=ia.a.JT(document.URL,"wdPreviousCorrelation",b);var A=v.AFrameworkApplication.K.$("NAOPLP");if(v.AFrameworkApplication.mfa){var O=v.AFrameworkApplication.mfa.getTime();!h||h>O?u.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",
{["ClickTimestamp"]:h,["DocumentLoadedTime"]:O,["SessionId"]:t,["Correlation"]:b}):u.ULS.sendTraceTag(5849683,202,A?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:O-h,["ClickTimestamp"]:h,["SessionId"]:t,["Correlation"]:b})}else u.ULS.sendTraceTag(5849681,202,A?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:h,["SessionId"]:t,["Correlation"]:b})}}get Qcc(){return this.ga.value}get aYc(){return this.Of.value}get UJi(){return this.Fh.value}get HFa(){return this.bza.value}get B3d(){return this.Gb.value}get ir(){return this.$C}get IQa(){return this.BZj.value}get u6a(){return this.mud.value}static get instance(){return Rg._instance||
(Rg._instance=Rg.zr())}static zr(){return new Rg(new Pg.a(()=>v.AFrameworkApplication.xa),new Pg.a(()=>v.AFrameworkApplication.Ke),new Pg.a(()=>v.AFrameworkApplication.ta),new Pg.a(()=>v.AFrameworkApplication.ta.Ob.jm),new Pg.a(()=>v.AFrameworkApplication.oc),()=>(new Date).getTime(),new Pg.a(()=>v.AFrameworkApplication.ta.Ob.IQa),new Pg.a(()=>v.AFrameworkApplication.u6a))}}Rg._instance=null;Object(m.a)(Rg,"NewAndOpenCommonHelpers",null,[525]);class Cj{constructor(b,h,t){this.Nsd=this.ro=null;this.aOe=
0;this.Hbk=b;this.Gb=h;this.uOg=t}Jtk(){this.aOe=this.wgc+1}r4f(b){this.ro&&(this.Gb.Se(this.ro),this.ro=null);b&&(this.aOe=0)}Wuo(b){const h=this.wCo;0<=h?(this.Jtk(),this.r4f(!1),this.ro=new Vb.a(4,1,h,b,107),this.Gb.Wb(this.ro)):(this.r4f(!0),u.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.uOg}))}get wgc(){return this.aOe}get wCo(){return this.wgc>=this.ldj.length?-1:this.ldj[this.wgc]}get ldj(){if(!this.Nsd){const b=(this.Hbk.value||"0").split(",");this.Nsd=[];for(let h=
0;h<b.length;h++){const t=parseInt(b[h]);isNaN(t)?u.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.uOg,["Entry"]:b[h]}):Array.add(this.Nsd,t)}}return this.Nsd}}Object(m.a)(Cj,"RetryHelper",null,[]);class fl extends Xh{constructor(b,h){super();this.sAa=b;this.Uyc=new Cj(h,this.JXc.B3d,"GetMoreInfo");this.hq=new $k}m3m(){this.vJf("Document opened")}b5k(b){return()=>{this.vJf(b,!0)}}xQi(b,h=null){u.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",
{["Trigger"]:b});3===this.hq.state?(h&&this.lRh(h,this.hq),u.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):this.vJf(b);return this.hq}vJf(b,h=!1){this.Uyc.r4f(!h);1===this.hq.state?u.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.Uyc.wgc}):(u.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.Uyc.wgc}),this.hq.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",
this.JXc.IQa,v.AFrameworkApplication.fm),this.JXc.aYc.dyb(h,1,null,null,[fl.T7g,fl.Ldh],5,this.Q3k(),this.P3k(b)))}Q3k(){return b=>{var h=!1;let t=!1;var A=!1,O;v.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.we?({Nu:O}=E.d(b.data.we)).returnValue?O?(A=!0,this.hq.uRe=O.StorageServiceDisplayName,this.hq.Sxc=fl.gzi(O.PersonalFileStorageUrl)?O.PersonalFileStorageUrl:"",""===this.hq.$ba&&"SharePointOnlineConsumer"===v.AFrameworkApplication.K.kb("FileSource")&&(this.hq.Sxc=ia.a.Exa(v.AFrameworkApplication.breadcrumbFolderUrl)),
h=""===this.hq.$ba&&""!==this.hq.q6a):u.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):u.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):u.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));A||((O=b.data.vj)?(this.hq.uRe=
(O[fl.Ldh]||"").toString(),h=(O[fl.T7g]||"").toString(),this.hq.Sxc=fl.gzi(h)?h:"",""===this.hq.$ba&&"SharePointOnlineConsumer"===v.AFrameworkApplication.K.kb("FileSource")?(this.hq.Sxc=ia.a.Exa(v.AFrameworkApplication.breadcrumbFolderUrl),h=""===this.hq.$ba&&""!==this.hq.q6a):h=""===h&&""!==this.hq.q6a):(u.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),t=!0));A=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.Uyc.wgc,t,h,A);this.JXc.lQa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,A);this.Bdj(3,h,t)}}P3k(b){return h=>{this.JXc.lQa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");this.Bdj(2);this.Uyc.Wuo(this.b5k(b))}}Bdj(b,h=!1,t=!1){this.hq.state=b;this.hq.AWg=h;this.hq.ECe=t;this.Nef(this.hq)}get JXc(){return this.sAa.value}static get instance(){return fl._instance||(fl._instance=fl.zr())}static zr(){return new fl(new Pg.a(()=>Rg.instance),
new Pg.a(()=>v.AFrameworkApplication.LWl))}static gzi(b){if(!b)return u.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(F.a.fh(b).startsWith("https://"))return!0;u.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}fl.T7g="PersonalFileStorageUrl";fl.Ldh="StorageServiceDisplayName";fl._instance=null;Object(m.a)(fl,"GetMoreInfoActor",Xh,[]);class qj{constructor(b,h,t,A,O){this.R_j=6E4;this.Dli="inactive";this.ijh="active";
this.YY=!0;this.Gb=b;this.KYj=h;this.$C=t;this.jvd=A;this.ra=new If.a;O&&this.Luo();this.E_g=this.C7h()}Kjh(b){this.ra.addHandler(this.ijh,b)}Imk(b){this.ra.addHandler(this.Dli,b)}Luo(){const b=new Vb.a(5,2,this.R_j,Object(z.a)(this,this.Snm,"inactiveLoop"),108);this.Tnm.Wb(b)}Snm(){const b=this.C7h(),h=this.ir()-b;h>this.Tje&&this.YY&&(u.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.YY=!1,this.ra.raiseEvent(this.Dli));b-this.E_g>this.Tje&&(this.YY=!0,
this.ra.raiseEvent(this.ijh));this.E_g=b}get Tnm(){return this.Gb.value}get C7h(){return this.KYj}get ir(){return this.$C}get Tje(){return this.jvd.value}static get instance(){return qj._instance||(qj._instance=qj.zr())}static zr(){return new qj(new Pg.a(()=>sf.a.instance),()=>v.AFrameworkApplication.$Ff.getTime(),()=>(new Date).getTime(),new Pg.a(()=>v.AFrameworkApplication.Tje),!0)}}qj._instance=null;Object(m.a)(qj,"InactivityManager",null,[]);var kn=c(1659);class Gk extends kl{constructor(){super();
this.v5j=this.H3g=this.G3g=null;this.state=this.pfh=0;this.ECe=!1}get tLf(){return this.G3g}get kJi(){return this.H3g}get CCo(){return this.pfh}nbi(){return"MruActor Result"}}Object(m.a)(Gk,"MruResult",kl,[526,527]);class xk{constructor(b,h,t){this.task=null;this.pFb=b;this.maxRetries=h;this.taskManager=t;this.retryCount=this.KRc=0;this.oMe=this.qVc=null}DHm(b,h){return b===ca.a.x5b||20===h||18===h||3===h}WIm(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===
b||16===b||23===b||26===b||27===b||28===b}get q9d(){return this.oMe}reset(){this.KRc=this.retryCount=0;this.oMe=this.qVc=null;this.task&&(this.taskManager.Se(this.task),this.task=null)}rsm(b,h,t,A){this.oMe=String.format("{0}_{1}",t,A);if(this.retryCount>=this.maxRetries)return u.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.DHm(t,A))return u.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.WIm(A)&&1<=this.KRc)return this.qVc=t,!1;h=
Math.max(h,this.pFb*Math.pow(2,this.KRc));if(26===A)h=Math.max(h,3E4);else if(27===A||28===A)h=Math.max(h,6E4);9===A||412===t&&(null==this.qVc||412!==this.qVc)?h=500:this.KRc+=1;this.qVc=t;this.retryCount+=1;this.task&&this.taskManager.Se(this.task);u.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",h);this.task=new Vb.a(2,1,h,b,107);this.taskManager.Wb(this.task);return!0}}Object(m.a)(xk,"RetryManager",null,[]);var Rh=c(112);class ln{constructor(){this.mruItemId=this.app=this.documentExt=
this.documentName=this.folderName=this.documentUrl=null}}Object(m.a)(ln,"WriteOptions",null,[]);var Sf=c(600);class Jd extends Xh{constructor(b,h,t,A,O,aa,ua){super();this.sAa=b;this.m4j=h;this.obb=new xk(v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.vM.B3d);this.Bcb=new xk(v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",
15E3),v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.vM.B3d);this.A$j=t;this.jih=A;this.fik={};this.Yja=new Gk;this.hYj=O;this.Knd="";this.qL=aa;this.pQg=ua;this.ard="";this.E$j=v.AFrameworkApplication.K.pc("WordRecentLinksCount",25)}get Jne(){return this.fik}jRn(){this.vM.Qcc.pa(ab.a.l6i,yc.a.frame,Object(z.a)(this,this.XVn,"renameMruEntry"))}XVn(){return this.wmg("Rename")}D3m(){this.gGi("File Opened")}E3m(){this.gGi("IntervalUpdate")}gGi(b){u.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.wmg(b)}Qfa(b){(b=F.a.Qfa(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}j0h(){switch(this.vM.HFa){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}kam(b){var h=this.hYj();if(!h)return null;const t=new ln;t.documentUrl=this.pQg.value?encodeURI(h):h;t.mruItemId=this.Knd;t.app=this.j0h();if(h=this.qL())t.folderName=h.breadcrumbFolderName,
h=h.Oy,t.documentName=F.a.KI(h),t.documentExt=this.Qfa(h);b&&(t.documentName?t.documentName.length?255<=t.documentName.length?b.set("DocumentNameLength","Long"):2084<=t.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength","Null"));return JSON.stringify(t)}wmg(b,h=!1){if(4===this.vM.HFa&&!v.AFrameworkApplication.OHd)return 2;var t=eb.a.KF();t&&(t.set("Trigger",b),t.set("IsRetry",h?"true":"false"),t.set("MruIdSent",this.Knd?"true":"false"),
t.set("URLEncoded",this.pQg.value?"true":"false"));wa.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",t);b=this.kam(t);if(!b)return h=!v.AFrameworkApplication.iQb,t&&(t.set("WebEditingIsEnabled",v.AFrameworkApplication.iQb?"true":"false"),t.set("ProtectedFile",v.AFrameworkApplication.protectFile?"true":"false")),wa.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new Hb.a,{extendedProperties:t})),2;this.Bcb&&!h&&this.Bcb.reset();t=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",
this.vM.IQa,this.BHf);this.jih?this.Jne["X-FileId"]=v.AFrameworkApplication.fm:t+=String.format("&{0}",v.AFrameworkApplication.fm);v.AFrameworkApplication.sessionStartInfoSettings&&(this.Jne["X-Office-AudienceGroup"]=Object(Da.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");this.Jne["X-Timeout"]=15E3;return this.vM.aYc.oj(t,2,b,this.Jne,!0,5,Object(z.a)(this,this.J_o,"writeMruV2EntryOnServerSuccessCallback"),Object(z.a)(this,this.$8k,"createWriteMruV2EntryOnServerFailureCallback"),
null,void 0,void 0,void 0,void 0,"4")}J_o(b){this.shi(b.data)}shi(b){const h=eb.a.KF();this.Bcb&&(h&&this.Bcb.q9d&&(h.set("LastError",this.Bcb.q9d),h.set("NumRetries",this.Bcb.retryCount.toString())),this.Bcb.reset());const t=kn.c(b.we);t&&t.diagnostics_data&&(this.Knd=t.diagnostics_data.mru_id);b=+b.XS-+b.tH;h&&h.set("RequestDuration",b.toString());wa.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Hb.a,{extendedProperties:h}))}$8k(b){if(b.data.Ve===ca.a.tHc)this.shi(b.data);else{var h=
b.data.Ve===ca.a.kxa,t=eb.a.KF();this.Chi(this.Bcb,b,this.E8k(),t);t&&(t.set("StatusCode",b.data.Ve.toString()),h||this.OWe(b.data,t));wa.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",b.data.Ve),h,!1,Object.assign(new Hb.a,{extendedProperties:t}))}}E8k(){return()=>{this.wmg("Retry",!0)}}UWl(){this.WWc("Polling")}TWl(){this.WWc("Retry",!0)}p3m(){this.WWc("Open")}o3m(){this.WWc("Activity")}n3m(){this.WWc("ActivityRecentLinks",!1,!0)}WWc(b,h=!1,t=!1){u.ULS.sendTraceTag(5849674,
202,50,"Making GetMru request {0}",{["Trigger"]:b});const A=eb.a.KF();A&&(A.set("Trigger",b),A.set("IsRetry",h?"true":"false"),t&&A.set("RecentLinks","true"));wa.Health.instance.recordKpiUsage("GetMru",0,"smartfio",A);this.obb&&!h&&this.obb.reset();t?this.GHh(Object(z.a)(this,this.VWl,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(z.a)(this,this.QWl,"getMruForRecentLinksFromServerFailureCallback"),!0):this.GHh(Object(z.a)(this,this.WWl,"getMruV2FromServerSuccessCallback"),Object(z.a)(this,
this.SWl,"getMruFromServerFailureCallback"))}OWe(b,h){b&&b.vj&&(b=b.vj["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}VXm(b,h){b&&(h&&h.set("RequestDuration",(+b.XS-+b.tH).toString()),wa.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Hb.a,{extendedProperties:h})))}WWl(b){this.E8h(b)}E8h(b,h=!1){var t="";let A=null,O=null,aa=null;const ua=kn.c(b.data.we);ua&&(A=ua.places?ua.places.items:[],O=ua.documents?ua.documents.items:[],(aa=kn.a(ua,h))&&(t=E.c(aa)));v.AFrameworkApplication.ta&&
v.AFrameworkApplication.ta.Ob.KPa&&Rh.c()&&(h?this.ard=t:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(t,!0)));t=eb.a.KF();this.obb&&(t&&this.obb.q9d&&(t.set("LastError",this.obb.q9d),t.set("NumRetries",this.obb.retryCount.toString())),this.obb.reset());h&&t&&t.set("RecentLinks","true");aa||A||O?(h?this.vM.lQa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Success"):this.vM.lQa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.Zle(3,aa,A,O),this.VXm(b.data,
t)):(h?this.vM.lQa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.vM.lQa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),t&&this.OWe(b.data,t),wa.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Hb.a,{extendedProperties:t})),this.Zle(3,null,null,null,!0));this.Nef(this.Yja)}VWl(b){this.E8h(b,!0)}Chi(b,h,t,A){let O=0,aa=0;const ua=kn.c(h.data.we);ua&&(null!=ua.response_code&&(O=ua.response_code,
A&&A.set("MruResponseCode",O.toString()),9===O&&(this.Knd="")),ua.error_data&&null!=ua.error_data.retry_after_ms&&(aa=ua.error_data.retry_after_ms,A&&A.set("ExpectedRetryAfter",aa.toString())));b&&(h=b.rsm(t,aa,h.data.Ve,O),A&&(A.set("CurrentRetryCount",b.retryCount.toString()),A.set("RetryScheduled",h?"true":"false")))}SWl(b){this.D8h(b)}D8h(b,h=!1){const t=b.data.Ve===ca.a.kxa,A=eb.a.KF();A&&(A.set("StatusCode",b.data.Ve.toString()),h&&A.set("RecentLinks","true"),t||this.OWe(b.data,A));h?this.vM.lQa("MruActor.GetMruForRecentLinksFromServerFailureCallback",
b.data,"Failure"):this.vM.lQa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.Zle(2);this.Chi(this.obb,b,Object(z.a)(this,this.TWl,"getMruFromServerRetryTask"),A);wa.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.Ve),t,!1,Object.assign(new Hb.a,{extendedProperties:A}));this.Nef(this.Yja);v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.KPa&&Rh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.ard=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}QWl(b){this.D8h(b,!0)}Zle(b,h=null,t=null,A=null,O=!1){if(3!==this.Yja.state||3===b)this.Yja.G3g=h,this.Yja.H3g=t,this.Yja.v5j=A,this.Yja.state=b,this.Yja.ECe=O,this.Yja.pfh=this.vM.ir()}xQi(b,h){u.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Yja.state});h&&3===this.Yja.state&&this.lRh(h,this.Yja);return this.Yja}GHh(b,h,t=!1){this.Zle(1);let A;const O={};A=t?String.format(this.vM.IQa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",
this.E$j,"OfficeSuite",this.BHf,"ClassicMru"):String.format(this.vM.IQa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.j0h(),this.BHf);this.A$j.value||(A+="&entity=docs");v.AFrameworkApplication.sessionStartInfoSettings&&(O["X-Office-AudienceGroup"]=Object(Da.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");t&&(O["X-Office-Application"]="147");this.jih?O["X-FileId"]=v.AFrameworkApplication.fm:A+=String.format("&{0}",v.AFrameworkApplication.fm);
this.vM.aYc.oj(A,1,null,O,!0,5,b,h,null)}get vM(){return this.sAa.value}get BHf(){return this.m4j.value}static get instance(){return Jd._instance||(Jd._instance=Jd.zr())}static zr(){return new Jd(new Pg.a(()=>Rg.instance),new Pg.a(()=>Sf.a.lg(v.AFrameworkApplication.lcid).name),new Pg.a(()=>v.AFrameworkApplication.ta.Ob.VE),v.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),()=>v.AFrameworkApplication.ta.Ob.Pea,()=>v.AFrameworkApplication.Mt,new Pg.a(()=>v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}
Jd._instance=null;Object(m.a)(Jd,"MruActor",Xh,[]);class rn{constructor(){this.uBc=this.q9g=this.W=null;this.Gh=!1}get name(){return"Common.App.NewAndOpen.Core"}yc(b){this.W=b;b.register(525,"Common.INewAndOpenCommonHelpers").singleInstance().Qd(()=>Rg.instance);b.register(528,"Common.IEventEmitter<Common.IGetMoreInfoResult>").singleInstance().Qd(()=>fl.instance);b.register(528,"Common.IEventEmitter<Common.IMruResult>").singleInstance().Qd(()=>Jd.instance)}init(){v.AFrameworkApplication.K.Wo(()=>
{this.x1a()})}x1a(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;Rg.instance.BNn();v.AFrameworkApplication.IFa&&(b=!0);v.AFrameworkApplication.Y_f&&(Jd.instance.p3m(),0<v.AFrameworkApplication.lJi&&this.ykh(),this.Aio(),b=!0);v.AFrameworkApplication.u6a&&b&&fl.instance.m3m();v.AFrameworkApplication.EPo&&(b=Jd.instance,b.jRn(),b.D3m(),sf.a.instance.Wb(this.FPo))}Aio(){qj.instance.Kjh(Object(z.a)(Jd.instance,
Jd.instance.o3m,"makeGetMruRequestActivityTrigger"));qj.instance.Kjh(Object(z.a)(this,this.ykh,"addGetMruFromServerTask"));qj.instance.Imk(Object(z.a)(this,this.qcl,"deleteGetMruFromServerTask"))}qcl(){sf.a.instance.Se(this.mJi)}ykh(){sf.a.instance.Wb(this.mJi)}get mJi(){return this.q9g||(this.q9g=new Vb.a(5,2,v.AFrameworkApplication.lJi,Object(z.a)(Jd.instance,Jd.instance.UWl,"getMruFromServerTask"),109))}get FPo(){return this.uBc||(this.uBc=new Vb.a(2,2,6E4*v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",
1440),Object(z.a)(Jd.instance,Jd.instance.E3m,"makeUpdateMruTask"),197))}dispose(){this.Gh||(this.Gh=!0,this.uBc&&(sf.a.instance.Se(this.uBc),this.uBc=null))}}Object(m.a)(rn,"CorePackageManager",null,[1,2,9]);var mn=c(1536),Al=c(109);class dg{static Fml(b){return dg.kvh("New",b)}static Gml(b){return dg.kvh("Open",b)}static Quh(b,h){return dg.MYa("LoadingMenuSection",dg.rVm,b,dg.iEc("lblLoading",h))}static jEc(b,h,t=null,A=null){return dg.MYa("MessageMenuSection",dg.jJi,h,dg.iEc("lblMessage",b,t,A))}static XGk(b){return dg.Quh(b,
CommonUIStrings.l_VoicedLoadingText)}static YGk(b,h){return dg.jEc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,h.$ba,h.q6a)}static WGk(b,h){return dg.jEc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.q6a,"\n\n"),b.labelText)}static Uuh(b){return dg.jEc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static UGk(b,h,t){return dg.MYa("menuNewBlank",dg.Djm,t?b.labelText:null,dg.eEc(b.dji,b.eji,b.fji,null,b.o1a,b.vQc,h,"blank"))}static THk(){return dg.iEc("lblTemplatesLoading",
CommonUIStrings.l_VoicedLoadingText)}static ivh(){return dg.iEc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static UHk(b,h){return dg.MYa("menuNewTemplates",b,null,h)}static SGk(b,h){return dg.MYa("menuNewMoreTemplates",dg.kYh,null,dg.eEc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,b,h))}static JFk(b,h,t){let A="";t&&h&&(A=dg.MYa("BrowseMoreMenuSection",dg.kYh,null,dg.eEc("btnBrowseMore",h,h,null,null,null,b||
"1959943459",t)));return A}static iEc(b,h,t=null,A=null){let O=A;h&&0<h.length&&(O=dg.cKi.Ulb(h).trimEnd(),O=0<=O.indexOf("{0}")?String.format(O,A):String.format("{0} {1}",O,A));t=t&&A?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',F.a.Af(t),F.a.Af(A),F.a.Af(O)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',F.a.Af(b||""),dg.cKi.Ulb(F.a.Af(h||"")),t)}static eEc(b,h,
t,A,O,aa,ua,Ra){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',F.a.Af(b||""),F.a.Af(h||""),F.a.Af(t||""),A||"32by32",F.a.Af(O||""),F.a.Af(aa||""),ua,F.a.Af(Ra||""))}static kvh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,h)}static MYa(b,h,t,A){t=t?String.format('Title="{0}"',
F.a.Af(t)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',F.a.Af(b||""),F.a.Af(h||""),t,A)}}dg.jJi="MenuMru";dg.rVm="MenuLoading";dg.Djm="MenuHeader";dg.kYh="MenuFooter";dg.cKi=Al.a.fC("\n","&#10;");Object(m.a)(dg,"NewAndOpenXmlUtilities",null,[]);class Gm{constructor(){this.folderName=this.folderUrl=
this.hostName=this.hostUrl=null}}Object(m.a)(Gm,"HostInformation",null,[]);var gl=c(189);class Cn{constructor(b,h,t,A,O,aa){this.Qud=this.mw=this.Cdd=null;this.utd=this.oQe=!1;this.T2g=0;this.WPe=this.pEe=!1;this.sAa=b;this.Nrc=h;this.tVa=new Pg.a(()=>new mn.a(t.value,Object(z.a)(this,this.BDb,"getMoreInfoEventReceived")));this.t5j=A;this.Cab=O;this.Nck=aa;this.Uzc=this.mge;2===this.N3.HFa&&(this.WPe=!0);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)&&this.htl()}get H6(){switch(this.N3.HFa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}htl(){sf.a.instance.Wb(new Vb.a(5,1,0,()=>{this.getTemplateListJson()}))}Ub(){const b=this.N3.Qcc;b.pa(ab.a.newDocument,yc.a.frame,Object(z.a)(this,this.newDocument,"newDocument"));b.pa(ab.a.R8d,yc.a.frame,Object(z.a)(this,this.R8d,"populateNewMenu"))}newDocument(b,h,t,A,O){if(1===t)return 32;if(2===t&&O){if(v.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&
O.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),v.AFrameworkApplication.xa.processAction(ab.a.Qyn,2);if(O.MenuItemId&&O.SourceControlId)return"NewDocumentHome"===O.SourceControlId&&lb.a("NewDocumentFromHomeTab"),this.gHc(O.MenuItemId,O.SourceControlId)}return 8}gHc(b,h){var t=this.G3d.lIh;if(null===t)return 8;var A=v.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(v.AFrameworkApplication.eHb&&A){u.ULS.sendTraceTag(51455198,
202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const O={};O[J.a.template]=b;O[J.a.H6]=this.H6;O[J.a.lcid]=v.AFrameworkApplication.lcid.toString();O[J.a.reason]=Mm.a.M9e;O[J.a.uiCulture]=v.AFrameworkApplication.uiCulture;O[J.a.dataCulture]=v.AFrameworkApplication.dataCulture;v.AFrameworkApplication.lO().execute(aa=>{aa.sendMessage(K.a.gHc,O)})}else A=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",
t,F.a.Mj(this.IFa),F.a.Mj(b),F.a.Mj(this.H6),F.a.Mj(v.AFrameworkApplication.lcid.toString()),F.a.Mj(A.toString()),F.a.Mj(h),F.a.Mj(v.AFrameworkApplication.canary),v.AFrameworkApplication.fm),(t=v.AFrameworkApplication.K.kb("ScenarioId"))&&""!==t&&(h+="&wdscenarioid="+F.a.Mj(t)),h+="&"+v.AFrameworkApplication.vQd(),v.AFrameworkApplication.u2a&&(h+="&"+v.AFrameworkApplication.YOd()),(t=this.mw?this.mw.$ba:null)&&(h+="&DestinationUrl="+F.a.Mj(t)),ff.a.km(h,"_blank",void 0,"CreateNewDocument");2===this.N3.HFa&&
u.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Qi.a[this.N3.HFa],["Template"]:b});v.AFrameworkApplication.K&&v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.N3.HFa&&("blank"===b?lb.b("ConsumerTemplateNewBlank"):(b=[Object.assign(new sa.a,{name:"TemplateId",string:b})],lb.b("ConsumerTemplateNew",null,0,!0,0,b)));return 32}X0m(b){let h=Number.MAX_VALUE,t=Number.MIN_VALUE;const A=window.performance;
if(A&&"undefined"!==typeof A.getEntriesByName){for(let aa=0;aa<b.length;aa++){var O=A.getEntriesByName(b[aa]);O&&0<O.length&&(O=O[0],h=Math.min(parseInt(String(O.fetchStart)),h),t=Math.max(parseInt(String(O.responseEnd)),t))}t>h&&u.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:t-h,["MinFetchStart"]:h,["MaxResponseEnd"]:t})}}R8d(b,h,t,A,O){if(1===t)return this.WPe&&(v.AFrameworkApplication.moa("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),
this.WPe=!1),32;2!==t||this.pEe||(this.T2g=(new Date).getTime(),u.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.mge,["CachedNewMenuXmlExists"]:!!this.Cdd,["ShouldCallGetMoreInfo"]:this.N3.u6a}));v.AFrameworkApplication.ye("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");v.AFrameworkApplication.ye("WordConsumerTemplates-tf;WordConsumerTemplates-cf");return this.Dxn(O)}Dxn(b){b&&(this.Cdd?b.PopulationXML=this.Cdd:(this.N3.u6a&&
!this.mw&&this.U$m.Vj("Opened New menu",!0),b.PopulationXML=this.PCl(this.getTemplateListJson())));return 32}vwi(){return!this.N3.u6a||!!this.mw&&3===this.mw.state&&!!this.mw.q6a&&!!this.mw.$ba}vIm(){return v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.KPa?!0:this.vwi()}getTemplateListJson(){if(!this.mge||!this.vIm())return null;if(this.Uzc&&!this.utd){var b="9";v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)&&(b="21");const h=v.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in h&&(b=h.NumberOfTemplatesInBackstage);let t=this.H6;"TemplateCollectionId"in h&&(t=h.TemplateCollectionId);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",!1)&&(t="WordConsumerWAC",b="23");b=String.format(this.N3.IQa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",F.a.Mj(v.AFrameworkApplication.lcid.toString()),F.a.Mj(t),b);Boolean.parse(h.AppendOriginQueryParam||
"false")&&(b+="&org=backstage");Boolean.parse(h.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in h&&(b+="&templateTier="+h.TemplateTier);b+="&"+v.AFrameworkApplication.vQd();v.AFrameworkApplication.u2a&&(b+="&"+v.AFrameworkApplication.YOd());this.N3.aYc.oj(b,1,null,null,!1,2,A=>{this.N3.lQa("CreateNewActor.GetTemplateListJson",A.data);this.NAo(A.data.we)},A=>{this.N3.lQa("CreateNewActor.GetTemplateListJson",A.data);this.MAo()},null,void 0,void 0,void 0,void 0,"5");this.Uzc=!1}return this.Qud}NAo(b){v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)?this.Qud=this.gul(b):this.Qud=b;this.Uzc=!1;this.g2c();if(v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.KPa&&Rh.c()){b=v.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const h=v.AFrameworkApplication.eHb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.Qud,!0,b&&h))}}MAo(){this.utd=this.Uzc=!0;this.g2c();v.AFrameworkApplication.ta&&
v.AFrameworkApplication.ta.Ob.KPa&&Rh.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));wa.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}gul(b){b=JSON.parse(b);const h=new Mb.a;h.add("TM00002102");h.add("TM00002101");h.add("TM16392939");const t=gl.a.Flg(b,A=>h.contains(A.AssetId));b=b.slice(0,9);b.splice.apply(b,[2,0].concat(t));return JSON.stringify(b)}Csf(b){var h=0;for(var t=0;t<b.length;t++)if("ST"===
b[t].ImageType){h=t;break}const A=b.length?b[h]:null;b=A?A.Url||"":"";var O;let aa=t=h=!1;if(A&&(O=A.AspectRatio))O=parseFloat(O),1>O?h=!0:1.5<O?t=!0:1===O&&(aa=!0);else switch(u.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),this.N3.HFa){case 3:h=!0;break;case 2:t=!0;break;case 5:aa=!0}return{returnValue:b,vnm:h?"95by123":t?"123by69":aa?"100by100":"123by95"}}PCl(b){b=({Wfe:h}=this.VGk(b,this.G3d,this.G3d.lEc||"1056925771")).returnValue;if(h){this.Cdd=b;var h=(new Date).getTime()-
this.T2g;u.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:h})}return b}BDb(b,h){u.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.mw||3!==b.state?2===b.state&&(u.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.oQe=!0,this.g2c()):(this.mw=b,h||this.g2c(),v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.KPa&&Rh.c()&&Rh.d("setFileMenuHostInformation")&&(b=Object.assign(new Gm,
{hostUrl:this.mw.$ba,hostName:this.mw.q6a,folderUrl:v.AFrameworkApplication.breadcrumbFolderUrl,folderName:v.AFrameworkApplication.breadcrumbFolderName}),u.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b))))}VGk(b,h,t){let A;A=!1;const O=this.vwi();let aa="";this.N3.u6a&&(this.oQe?(aa=dg.Uuh(h),this.oQe=!1,u.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):
this.mw?O?aa=dg.YGk(h,this.mw):this.mw.hvm?(A=!0,this.Uzc=!1,aa=dg.WGk(h,this.mw),u.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(A=!0,aa=dg.Uuh(h),u.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.mw.$ba,["StorageServiceDisplayNameIsSet"]:!!this.mw.q6a})):(aa=dg.XGk(h.labelText),u.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));
O&&(aa+=dg.UGk(h,t,!aa)+({Wfe:A}=this.SHk(b,t)).returnValue);return{returnValue:dg.Fml(aa),Wfe:A}}SHk(b,h){let t;t=!1;if(!this.mge)return t=!0,u.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Wfe:t};let A="",O="",aa="MenuTemplate";if(this.utd)A=dg.ivh(),this.utd=!1,u.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const ua=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);A=this.RHk(ua,
h);u.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");v.AFrameworkApplication.dKi&&"OneDrive"===this.IFa&&(O=dg.SGk(this.V$m,v.AFrameworkApplication.dKi))}catch(ua){u.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),A=dg.ivh()}t=!0}else aa="MenuLoading",A=dg.THk(),u.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:dg.UHk(aa,A)+O,Wfe:t}}RHk(b,h){let t="";
const A=[];for(let aa=0;aa<b.length;aa++){var O=b[aa];let ua="";if(O){const Ra=O.Title,ub=O.AssetId;O=O.Thumbnails;ub&&Ra&&O&&({vnm:O,returnValue:ua}=this.Csf(O),t+=dg.eEc("jbtnNewTemplate"+aa,Ra,null,O,null,ua,h,ub))}A[aa]=ua}b=new Vb.a(4,1,5E3,()=>{this.X0m(A)},106);this.N3.B3d.Wb(b);return t}g2c(){this.pEe=!0;this.N3.UJi.oIa(this.G3d.kLc);this.pEe=!1}get N3(){return this.sAa.value}get G3d(){return this.Nrc.value}get U$m(){return this.tVa.value}get V$m(){return this.t5j.value}get IFa(){return this.Cab.value}get mge(){return this.Nck.value}}
Object(m.a)(Cn,"CreateNewActor",null,[]);class bh{constructor(){this._initialized=!1;this.xRe={}}uD(b){this.RSh();return this.get(b)}contains(b){this.RSh();return b.toString()in this.xRe}RSh(){this._initialized||(this.mok(),this._initialized=!0)}Lcb(b,h){this.xRe[b.toString()]=h}get(b){return this.xRe[b.toString()]}}Object(m.a)(bh,"AIntlHelper",null,[]);class Ij extends bh{constructor(){super()}mok(){this.Lcb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.Lcb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.Lcb(2,CommonUIStrings.l_Open);this.Lcb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.Lcb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.Lcb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Ij._instance||(Ij._instance=new Ij)}static fqn(b){return Ij.instance.uD(b)}}Ij._instance=null;Object(m.a)(Ij,"MruActorIntlHelper",bh,[]);var Bd;(function(b){b[b.success=0]="success";b[b.failure=1]="failure";b[b.spinner=2]="spinner";b[b.none=3]="none"})(Bd||(Bd={}));Object(m.b)("DisplayState",
Bd);class Fe{constructor(b,h,t,A,O,aa,ua,Ra){this.vse=null;this.gVe=!0;this.Bdd="";this.Nfk=0;this.zVb=null;this.UFe=3;this.Na=Ra;this.sAa=b;this.zsa=h;this.ZWj=t;this.fRj=A;this.eRj=O;this.tVa=new Pg.a(()=>new mn.a(aa.value,null));this.NYj=new Pg.a(()=>new mn.a(ua.value,Object(z.a)(this,this.O9m,"mruEventResultReceived")));this.Na.$("WacInTabOpenMRUIsEnabledForUiHost");this.Na.$("UiHostSupportsDocRebootFeatures")}O9m(b,h){this.zVb=b;h||this.j2i()}oQn(){this.vM.Qcc.gb(ab.a.XWf,yc.a.frame,Object(z.a)(this,
this.XWf,"populateMruMenu"),96)}XWf(b,h,t,A,O){return 1!==t&&O?this.Bxn(O):32}Bxn(b){this.onl();this.nnl();b.PopulationXML=dg.Gml(this.Bdd+this.vse);return 32}onl(){var b=3;let h=!1;if(this.Bdd&&this.Nfk===this.zVb.CCo)u.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.UFe;else{u.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var t=this.vM.ir();this.zVb=
this.N9m.Vj("File Open opened",!0);this.Bdd&&2!==this.UFe&&3!==this.zVb.state?h=!0:(b=this.n5l(this.zVb),v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.KPa&&Rh.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.Bdd=({M$m:b}=this.QCl(this.zVb)).returnValue);t=this.vM.ir()-t;u.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:t})}2!==b&&(t={["DisplayState"]:Bd[b]},1!==b&&(t.IsStale=h),
u.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",t));this.UFe=b}n5l(b){let h;try{h=E.c(b.tLf)}catch(t){h=null,u.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",t)}return h}nnl(){this.gVe?(u.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.vse=({wWo:this.gVe}=this.j3m()).returnValue):u.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");u.ULS.sendTraceTag(5849633,
202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.gVe,["NotDisplayingLink"]:!this.vse})}QCl(b){let h;1===b.state||0===b.state?(u.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=dg.Quh(this.N0a(2),this.N0a(5))):3===b.state&&b.tLf?(h=this.TGk(b.tLf),b=0):(u.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=dg.jEc(this.N0a(1),this.N0a(2)),b=1);return{returnValue:h,M$m:b}}TGk(b){let h;const t=this.uXc.lEc||
"2155708348";if(b.length){h=dg.iEc("lblRecentDocuments",this.N0a(3));let A=0;for(let O=0;O<b.length;O++){const aa=b[O];"FileName"in aa&&"DocumentUrl"in aa&&"Path"in aa&&(h+=dg.eEc("MruButton"+O,aa.FileName.toString(),aa.Path.toString(),null,this.uXc.o1a,this.uXc.vQc,t,aa.DocumentUrl.toString()),aa.IsPinned&&A++)}h=dg.MYa("RecentDocumentsMenuSection",dg.jJi,this.N0a(2),h);u.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:A})}else h=
dg.jEc(this.N0a(0),this.N0a(2)),u.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}j3m(){let b;b=!0;let h=this.cFk;var t=this.bFk;if(h&&t||!this.vM.u6a)b=!1;else{const A=this.dPd.Vj("File Open",!1);3===A.state&&(h=A.$ba,t=A.q6a,b=!1)}t=t?String.format(this.N0a(4),t):null;return{returnValue:dg.JFk(this.uXc.lEc,t,h),wWo:b}}j2i(){this.vM.UJi.oIa(this.uXc.kLc)}get vM(){return this.sAa.value}get N0a(){return this.zsa.value}get uXc(){return this.ZWj.value}get cFk(){return this.fRj.value}get bFk(){return this.eRj.value}get dPd(){return this.tVa.value}get N9m(){return this.NYj.value}}
Object(m.a)(Fe,"MruRenderer",null,[]);var nn=c(1541);class no{constructor(b,h,t,A,O,aa,ua){this.mw=null;this.Pah=!1;this.tra=this.f1=0;this.J5j=b;this.aWb=h;this.Rnd=t;this.Nrc=A;this.Cab=O;this.sAa=aa;this.tVa=new Pg.a(()=>new mn.a(ua.value,Object(z.a)(this,this.BDb,"getMoreInfoEventReceived")))}gHc(){!this.mw&&this.SNf.u6a?this.dPd.Vj("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}BDb(b){if(!this.mw&&3===b.state)this.mw=b;else if(2===b.state){this.Pah?u.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.dPd.Vj("NewDocumentFromStream",!0),this.Pah=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.f1=(new Date).getTime();var b=this.utl.lIh;if(null===b)this.aWb(null);else{var h=this.Rnd.menuItemId,t=this.Rnd.sHa,A=this.Rnd.vwo,O=this.Rnd.Ctl;this.tra="streamBase64"===A?O.length/1024:0;u.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.H6,this.tra);var aa=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
b,F.a.Mj(this.IFa),F.a.Mj(h),F.a.Mj(this.H6),F.a.Mj(v.AFrameworkApplication.lcid.toString()),F.a.Mj(aa.toString()),F.a.Mj(t),F.a.Mj(v.AFrameworkApplication.canary),v.AFrameworkApplication.fm,F.a.Mj(A));b+="&"+v.AFrameworkApplication.vQd();v.AFrameworkApplication.u2a&&(b+="&"+v.AFrameworkApplication.YOd());(h=this.mw?this.mw.$ba:null)&&(b+="&DestinationUrl="+F.a.Mj(h));this.SNf.aYc.oj(b,2,O,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(z.a)(this,this.P$m,"newDocumentFromStreamSuccessHandler"),
Object(z.a)(this,this.O$m,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}P$m(b){if(b&&b.data&&b.data.we)if(({Nu:h}=E.d(b.data.we)).returnValue)if(b=h,b.StatusCode!==ca.a.oz&&b.StatusCode!==ca.a.tHc)u.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.H6,this.tra,b.StatusCode),this.aWb(null);else if(b.NewDocumentUrl&&""!==b.NewDocumentUrl){var h=(new Date).getTime()-this.f1;u.ULS.sendTraceTag(35156359,
202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.H6,this.tra,h);this.J5j(b.NewDocumentUrl)}else u.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.H6,this.tra),this.aWb(null);else u.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.H6,this.tra,{["ResponseData"]:nn.a.z9c(b.data.we)}),this.aWb(null);else u.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.H6,this.tra),this.aWb(null)}O$m(b){b&&b.data&&u.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.H6,this.tra,b.data.status);this.aWb(null)}get H6(){switch(this.SNf.HFa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get utl(){return this.Nrc.value}get IFa(){return this.Cab.value}get SNf(){return this.sAa.value}get dPd(){return this.tVa.value}}
Object(m.a)(no,"NewDocumentFromStreamOperation",null,[]);class Zd{constructor(b,h,t,A){this.Nrc=b;this.Cab=h;this.sAa=t;this.MYj=A}create(b,h,t){return new no(b,h,t,this.Nrc,this.Cab,this.sAa,this.MYj)}}Object(m.a)(Zd,"NewDocumentFromStreamOperationFactory",null,[741]);var nd=c(122);class Hm{get name(){return"Common.App.NewAndOpen.UX"}yc(b){b.register(Zd,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").singleInstance().Qd(()=>
new Zd(new Pg.a(()=>v.AFrameworkApplication.ta.Ob.Gnf()),new Pg.a(()=>v.AFrameworkApplication.IFa),new Pg.a(()=>b.Ma("Common.INewAndOpenCommonHelpers")),new Pg.a(()=>b.Ma("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){v.AFrameworkApplication.K.Wo(()=>{this.x1a()})}x1a(){const b=eg.a.xp(Sa.a.instance.Sa("Common.INewAndOpenCommonHelpers")),h=eg.a.xp(Sa.a.instance.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));v.AFrameworkApplication.IFa&&nd.Task.WAA.call(null,b,h).continueWith(()=>
{const t=new Cn(new Pg.a(()=>b.result),new Pg.a(()=>v.AFrameworkApplication.ta.Ob.Gnf()),new Pg.a(()=>h.result),new Pg.a(()=>v.AFrameworkApplication.ta.Ob.Hnf().lEc||"1959943459"),new Pg.a(()=>v.AFrameworkApplication.IFa),new Pg.a(()=>v.AFrameworkApplication.bGm));t.Ub();t.g2c()});if(v.AFrameworkApplication.Y_f){const t=eg.a.xp(Sa.a.instance.Sa("Common.IEventEmitter<Common.IMruResult>"));nd.Task.WAA.call(null,b,h,t).continueWith(()=>{const A=new Fe(new Pg.a(()=>b.result),new Pg.a(()=>Ij.fqn),new Pg.a(()=>
v.AFrameworkApplication.ta.Ob.Hnf()),new Pg.a(()=>v.AFrameworkApplication.eqn),new Pg.a(()=>v.AFrameworkApplication.dqn),new Pg.a(()=>h.result),new Pg.a(()=>t.result),v.AFrameworkApplication.K);A.oQn();A.j2i()})}}dispose(){}}Object(m.a)(Hm,"UXPackageManager",null,[1,2,9]);var cf=c(141);class Of extends cf.StandardDialog{constructor(){super();this.zd=0;this.Ge(1,CommonUIStrings.l_DialogClose)}kT(b){this.Sw(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}cdf(b){this.Sw(b,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(m.a)(Of,"ErrorDialog",cf.StandardDialog,[775]);var xm=c(438);class ze{e0h(){u.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new xm.a;b.xg("api.onedrive.com");return b.task}}Object(m.a)(ze,"OneDriveConsumerEndpointHelper",null,[690]);var Bf=c(39);class ch{constructor(b,h,t,A){this.Pub=this.OFa=null;this.HPe=this.JPe=!1;this.mWb=null;this.Na=b;this.lRb=h;this.Vtb=t;this.LG=A}get Joh(){return this.lRb}get K(){return this.Na}U6b(){this.mWb||
(this.mWb=this.dec?nb.a.create(this.dec,null,null,null,!1):null);return this.mWb}setup(b){this.Pub=b;this.JPe||this.HPe?this.JPe&&this.Pub&&this.Pub(!0):(b=this.U6b())?(this.HPe=!0,b.f3a.continueWith(h=>{this.tkn(h)}),bb.a.ZW(b)):(u.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.Pub(!1))}KRf(b){u.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.")}tkn(b){this.HPe=
!1;if(b.Ai)this.KRf(b),this.Pub(!1);else try{this.JPe=!0,u.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.oxf(),u.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.Pub(!0)}catch(h){u.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.Pub(!1)}}H7c(b){this.OFa=b;this.Vtb?u.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(u.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(z.a)(this,this.PPf,"onApiReady")))}PPf(b){b?this.$Zd():this.Lp()}Lp(){this.LG().kT(Bf.a.ppn)}onSuccess(b){u.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.OFa&&this.OFa(!0,b)}dispose(){this.mWb&&this.mWb.dispose()}}Object(m.a)(ch,"AOneDriveFilePickerApiManager",null,[793,9]);class bj extends ch{constructor(b,h,t,A,O,aa){super(h,t,A,aa);this.Sm=null;this.vsa=b;this.Vck=O}get dec(){return this.K.kb("OneDriveApiUrl")}start(b,h){this.Sm=
b;this.H7c(h)}oxf(){WL.init(1===this.Joh||2===this.Joh?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}H7c(b){this.OFa=b;!this.Vtb&&this.vsa.WRc?(u.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(z.a)(this,this.PPf,"onApiReady"))):(u.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Vck())}$Zd(){try{u.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Sm).then(Object(z.a)(this,this.onSuccess,"onSuccess"),Object(z.a)(this,this.onFailure,"onFailure"))}catch(b){u.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.Lp()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){u.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}u.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,
b.error.message)}else u.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.OFa&&this.OFa(!1,b);this.Lp()}}Object(m.a)(bj,"OneDriveFilePickerApiManagerV5",ch,[]);class Ag extends ch{constructor(b,h,t,A,O){super(b,h,t,A);this.Xid=this.d6g=null;this.jWj=O;this.options={};this.options.clientId=this.K.kb("OneDriveApiV7ClientId");this.options.cancel=Object(z.a)(this,this.cke,"toggleHostDivVisibility")}get dec(){return this.K.kb("OneDriveApiV72Url")}start(b,h){this.Xid=h;const t=
this.jWj.e0h();t.continueWith(()=>{u.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.d6g=t.result;this.H7c((A,O)=>{this.cke();b(A,O)})},3);t.continueWith(()=>{u.ULS.sendTraceTag(24134242,352,15,t.exception.message);this.cke()},5)}oxf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.d6g;this.options.advanced.iframeParentDiv=this.Xid}$Zd(){try{u.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.cke(),OneDrive.open(this.options)}catch(b){u.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.Lp()}}onFailure(b){this.OFa&&this.OFa(!1,b);this.Lp()}cke(){this.Xid.style.visibility="hidden"===this.Xid.style.visibility?"":"hidden"}}Object(m.a)(Ag,"OneDriveFilePickerApiManagerV7",ch,[]);class Uf extends ch{constructor(b,
h,t,A){super(b,h,t,A);this.uPj=b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.kb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get dec(){return this.K.kb("OneDriveApiV72Url")}start(b,h,t,A){this.options.advanced.iframeParentDiv=t;this.options.advanced.endpointHint=A;this.options.cancel=h;this.uPj.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.H7c(b)}H7c(b){this.OFa=b;this.Vtb?u.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(u.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.PPf,"onApiReady")))}oxf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}$Zd(){try{u.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){u.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Lp()}}KRf(b){u.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.");bb.a.aUn(this.dec);this.mWb=null}Lp(){this.LG().cdf(Bf.a.H3n)}onFailure(b){this.OFa&&this.OFa(!1,b)}}Object(m.a)(Uf,"OneDriveFilePickerApiManagerV72",
ch,[]);class Hl{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(m.a)(Hl,"IExtraData",null,[]);class th extends Uf{constructor(b,h,t,A){super(b,h,t,A);this.options.advanced.filter=b.kb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=v.AFrameworkApplication.Voh;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.kb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new Hl(v.AFrameworkApplication.userSessionId))}get dec(){return this.K.kb("OneDriveApiV72Url")}$Zd(){try{u.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",v.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){u.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Lp()}}}Object(m.a)(th,"OneDriveFilePickerApiOpenManagerV72",Uf,[]);class Ym{constructor(b){this.Qp=null;this.Of=b;this.ZNe=3}e0h(){this.Qp=new xm.a;u.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.a7f();return this.Qp.task}a7f(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",v.AFrameworkApplication.BAb);this.Of.dyb(h,1,null,b,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(z.a)(this,this.MWl,"getMoreInfoSucceeded"),Object(z.a)(this,this.KWl,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}KWl(b){if(b.data.Ve===ca.a.kxa&&"X-NewKey"in b.data.vj){u.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const h={};h["X-Key"]=b.data.vj["X-NewKey"];this.a7f(h)}else 0<this.ZNe?(u.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.ZNe),this.ZNe--,this.a7f()):(u.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Qp.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}MWl(b){"PersonalFileStorageUrl"in b.data.vj&&""!==b.data.vj.PersonalFileStorageUrl?(u.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Qp.xg(b.data.vj.PersonalFileStorageUrl)):(u.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.Qp.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(m.a)(Ym,"OneDriveForBusinessEndpointHelper",null,[690]);var Nm=c(755);class Dn{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}yc(b){this.W=b;this.W.register(bj,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").singleInstance().Qd(()=>new bj(Nm.a.instance,v.AFrameworkApplication.K,
v.AFrameworkApplication.vfa,v.AFrameworkApplication.ioa,v.AFrameworkApplication.zbg,()=>new Of));v.AFrameworkApplication.RGb?this.W.register(690,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Qd(()=>new ze):this.W.register(690,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Qd(()=>new Ym(v.AFrameworkApplication.Ke));this.W.register(Ag,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").singleInstance().Qd(()=>new Ag(v.AFrameworkApplication.K,
v.AFrameworkApplication.vfa,v.AFrameworkApplication.ioa,()=>new Of,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(Uf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").singleInstance().Qd(()=>new Uf(v.AFrameworkApplication.K,v.AFrameworkApplication.vfa,v.AFrameworkApplication.ioa,()=>new Of));this.W.register(th,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").singleInstance().Qd(()=>new th(v.AFrameworkApplication.K,
v.AFrameworkApplication.vfa,v.AFrameworkApplication.ioa,()=>new Of))}static main(){P.a.instance.Gc(new Dn)}}Object(m.a)(Dn,"PackageManager",null,[1,2]);class Sn{constructor(b,h,t,A,O,aa){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=t;this.PolicyCookieTTL=A;this.WasServiceDown=O;this.AffinitizedUrl=aa}}Object(m.a)(Sn,"SafeLinksData",null,
[]);class Kl{constructor(b,h){this.oje=b;this.jz=h}}Object(m.a)(Kl,"SafeLinksGetUrlReputationRequestData",null,[]);class Tm{constructor(b,h,t,A){this.Na=b;this.Of=h;this.fZj=t;Tm.ge=A}Ykc(b,h,t){try{var A=null;Tm.ge&&(A=Tm.ge.eg("WebServiceCall","SafeLinksGetUrlReputation"));const O=new Kl(h,A);A={};A.AffinitizedUrl=b;A.TargetUrl=h;A.PolicyCookie=t;const aa=E.c(A);this.Of.oj(this.fZj,2,aa,null,!1,2,Object(z.a)(this,this.fin,"onGetUrlReputationSuccessCallback"),Object(z.a)(this,this.ein,"onGetUrlReputationFailureCallback"),
O,void 0,void 0,3E3,3E3,"36");return!0}catch(O){u.ULS.sendTraceTag(588788033,378,10,O.message)}return!1}fin(b){let h="OnGetUrlReputationSuccessCallback: ",t=10;const A=b.data.state;try{const O=E.b(b.data.we).reputationResults[0],aa=O.navigateUrl.length,ua=A.oje.length,Ra=O.navigateUrl===A.oje;O.navigateUrl&&0<O.navigateUrl.length&&(A.oje=O.navigateUrl);h+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",b.data.Ve,O.verdict,
ua.toString(),aa.toString(),Ra.toString());t=50}catch(O){h+=String.format("Exception {0}",O.message)}this.khi(A,h,t)}ein(b){let h="OnGetUrlReputationFailureCallback: ";const t=b.data.state;try{h+=String.format("HttpStatus {0}",b.data.Ve)}catch(A){h+=String.format("Exception {0}",A.message)}this.khi(t,h,10)}khi(b,h,t){b.jz&&(b.jz.stop(),b.jz=null);u.ULS.sendTraceTag(588788034,378,t,h);ff.a.km(b.oje,void 0,"noopener,noreferrer","SafeLinksNav")}}Tm.ge=null;Object(m.a)(Tm,"SafeLinksNavigationHelper",
null,[]);var rg;(function(b){b[b.enabledByPolicy=0]="enabledByPolicy";b[b.disabledByPolicy=1]="disabledByPolicy";b[b.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";b[b.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(rg||(rg={}));Object(m.b)("SafeLinksNavigationState",rg);class ri{constructor(b,h,t,A=!1,O=null,aa=null){this.Fsb=this.Esb=0;this.NSc=this.jid=!1;this.Zab=null;this.hVb=!0;this.Psd=null;u.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");
this.Na=b;this.Of=h;this.aza=t;ri.ge=aa;this.Nhk=A?this.Na.kb("SafeLinksHandlerWebServiceBase"):this.Na.kb("WebServiceBase");this.fhk=this.Na.kb("SafeLinksHashedUserId");this.y_o=this.Na.kb("SafeLinksWorkloadIdHeaderValue");this.Zmd=this.Na.pc("SafeLinksMaxGetPolicyBootRetries",2);this.$md=this.Na.pc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.Ekd=this.kJm();this.Dkd=this.jJm();u.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.Ekd,this.Dkd);
if(this.Ekd&&this.Dkd){h=(b=this.qgb())?b.IsSafeLinksEnabled.toLowerCase():"";t=this.MCf();u.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,t);var ua=!b||"unknown"===h||b.WasServiceDown||t,Ra=eb.a.KF();Ra&&(Ra.set("shouldGetSafeLinksDataFromServer",ua.toString()),Ra.set("isSafeLinksEnabledCacheValue",h.toString()));O?(this.hVb=!1,O.execute(ub=>{ub.isFeatureEnabled("MsoUrlreputation",!0).then(Nb=>{this.hVb=Nb;Ra.set("isUserLicensedForSafeLinks",
this.hVb.toString());wa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ra);this.hVb&&ua&&this.oQd(!0);return null})})):(wa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ra),ua&&this.oQd(!0))}}get appName(){return this.aza}get gne(){return this.Nhk}get userId(){return this.fhk}get K0l(){const b=this.gne?this.gne+"/":"",h=new jb.QueryStringBuilder("SafeLinksHandler.ashx");h.De("app",this.appName);this.Na.$("SafeLinksUseDebugHeader")&&h.De("action","debug");
this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.De("s2satpop","1");this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.De("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),v.AFrameworkApplication.fm)}get L$l(){const b=this.gne?this.gne+"/":"",h=new jb.QueryStringBuilder("SafeLinksHandler.ashx");h.De("app",this.appName);this.Na.$("SafeLinksUseDebugHeader")&&h.De("action","debug");this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",
!1)&&h.De("s2satpop","1");this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.De("s2saat","1");this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.De("s2se03","1");h.De("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),v.AFrameworkApplication.fm)}get s$m(){ri.KOe||(ri.KOe=new Tm(this.Na,this.Of,this.L$l,ri.ge));return ri.KOe}Ykc(b){if(!b)return u.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),
!1;var h=this.IDm(b);u.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",h,this.Ekd,this.Dkd,this.hVb);if(!(h&&this.Ekd&&this.Dkd&&this.hVb))return!1;h=0;const t=({state:h}=this.fno()).returnValue;u.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",rg[h]);const A=eb.a.KF();A&&A.set("SafeLinksNavigationState",rg[h]);wa.Health.instance.recordKpiUsage("SafeLinksNavigations",
0,"jpittsdirects",A);if(!t)return 2!==h&&3!==h||wa.Health.instance.recordKpiFailure("SafeLinksNavigations",rg[h],!1,!0,null),!1;u.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");if(this.Dno())return this.MCf()?!1:this.s$m.Ykc(this.RDl(),b,this.T$h());if(!this.MCf())return this.hwj(b),!0;this.Zab=b;u.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.NSc=!1;this.oQd();return!0}IDm(b){b=b.toLowerCase();const h=this.Na.oC("SafeLinksUnsupportedProtocols");
if(h)for(let t=0;t<h.length;t++)if(b.startsWith(h[t]))return!1;return!0}oQd(b=!1){var h=eb.a.KF();h&&h.set("isOnBootRequest",b.toString());wa.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);wa.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.I8e("SafeLinksGetPolicy");this.Of.oj(this.K0l,1,null,null,!0,2,Object(z.a)(this,this.f4l,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(z.a)(this,this.e4l,"getSafeLinksDataFromServer_OnFailureCallback"),
h,void 0,void 0,void 0,void 0,"23");this.NSc=b;this.jid=!0;b?this.Esb++:this.Fsb++}f4l(b){let h=ca.a.fbn,t="";try{this.jid=this.NSc=!1;var A=b.data.state;const Dc=({jz:A}=this.die(A)).returnValue,Pc=Object.assign(new Hb.a,{durationMs:Dc});wa.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Pc);u.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",b.data.Ve,b.data.we.length,Dc);if(b.data.Ve!==ca.a.oz)t=
"Unexpected httpStatus: "+b.data.Ve.toString();else{A=null;try{A=E.b(b.data.we)}catch(jd){t="Exception:"+jd.toString()+" deserializing response";return}if(A){var O=A.IsSafeLinksEnabled;if(void 0===O||null===O||0>=O.length)t="Invalid isSafeLinksEnabledString";else{u.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",O);var aa=ri.AVf(O);if(void 0===A.WebAffinitizedUrl||null===A.WebAffinitizedUrl||0>=A.WebAffinitizedUrl.length)t="Invalid WebAffinitizedUrl";else if(void 0===A.PolicyCookie||
null===A.PolicyCookie||0>=A.PolicyCookie.length)t="Invalid PolicyCookie";else if(void 0===A.PolicyCookieTTL||null===A.PolicyCookieTTL)t="Invalid PolicyCookieTTL";else{var ua=A.WebAffinitizedUrl,Ra=A.PolicyCookie,ub=A.AffinitizedUrl,Nb=new Date;Nb.setMinutes(Nb.getMinutes()+(5<A.PolicyCookieTTL?A.PolicyCookieTTL-5:0));var Yb=Nb.getTime(),bc=new Sn(O,ua,Ra,Yb,!1,ub);this.Sdj(bc);h=b.data.Ve;this.Zab&&(aa?(this.hwj(this.Zab),this.Fsb=this.Esb=0):(u.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),
wa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),ff.a.pCb(this.Zab)),this.Zab=null)}}}else t="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Dc){t="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Dc.toString()}finally{h!==ca.a.oz&&this.jhi(h,t)}}e4l(b){this.jid=!1;let h=500,t="";try{let A=b.data.state;const O=({jz:A}=this.die(A)).returnValue,aa=Object.assign(new Hb.a,{durationMs:O});h=b.data.Ve;wa.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest",
"HttpStatusCode_"+h.toString(),!1,!0,aa);t="Request Failed, Status="+dj.a[b.data.status]+" Duration: "+O}catch(A){t="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+A.toString()}finally{this.jhi(h,t)}}jhi(b,h=""){try{if(u.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.Esb<this.Zmd&&this.Fsb<this.$md)this.oQd(this.NSc);else{this.NSc=!1;u.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.Esb,this.Fsb,b,h);h=null;const t=eb.a.KF();t&&(t.set("HttpStatus",b.toString()),h=Object.assign(new Hb.a,{extendedProperties:t}));wa.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const A=new Sn("false","","",0,!0,"");this.Sdj(A);this.Zab&&(u.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),wa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),ff.a.pCb(this.Zab),this.Zab=null)}}catch(t){u.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",t.toString())}}hwj(b){const h=this.T$h(),t=this.Yam(),A={};A.Url=b;A.SafeLinksCookie=h;A.CorrelationId=Ya.a.create().toString();A.WorkloadId=this.y_o;A.UserAgentInfo=ba.a.GF+"|"+this.appName;u.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",A.CorrelationId);ff.a.hXf(ff.a.zqa(4),t,A)}kJm(){const b=this.Na.kb("IsSafeLinksEnabledForUser");
return b?ri.AVf(b):!1}jJm(){const b=this.Na.oC("SafeLinksDisabledBrowsers");if(ba.a.u3){if(this.Na.yw("SafeLinksForTeamsIsEnabled")&&this.Na.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,ba.a.GF))return!1;return"officecomhwa"===(this.Na.kb(v.AFrameworkApplication.Hia)||"").toLowerCase()?!1:!0}Dno(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",
!1)&&ba.a.pTc?!0:ba.a.u3}fno(){let b;b=0;const h=this.qgb(),t=h?h.IsSafeLinksEnabled:"";if(""!==t)return h.WasServiceDown?(u.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===t.toLowerCase()?(u.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:ri.AVf(t),state:b};if(this.jid)return b=3,u.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.Esb>=
this.Zmd||this.Fsb>=this.$md)return b=2,u.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.Esb,this.Zmd,this.Fsb,this.$md),{returnValue:!1,state:b};u.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.Zmd+this.$md-(this.Esb+this.Fsb));return{returnValue:!0,state:b}}T$h(){const b=
this.qgb();return b?b.PolicyCookie:""}Yam(){const b=this.qgb();return b?b.WebAffinitizedUrl:""}RDl(){const b=this.qgb();return b?b.AffinitizedUrl:""}gOl(){const b=new Date;try{const h=this.qgb();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){u.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}MCf(){const b=this.gOl();return!!b&&b.getTime()<Date.now()}qgb(){if(!this.Psd){const b=Aa.a.instance.getItem(this.userId);if(!b||""===b)return null;this.Psd=
JSON.parse(b)}return this.Psd}Sdj(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.Psd=b;b.WasServiceDown||this.M_o(b)}M_o(b){b=JSON.stringify(b);Aa.a.instance.setItem(this.userId,b)}I8e(b){return void 0!==ri.ge&&null!==ri.ge?ri.ge.eg("WebServiceCall",b):null}die(b){if(void 0!==b&&null!==b){const h=b.ri;b.stop();return{returnValue:h,
jz:null}}return{returnValue:null,jz:b}}static AVf(b){return"false"!==b.toLowerCase()?!0:!1}}ri.ge=null;ri.KOe=null;Object(m.a)(ri,"SafeLinksManager",null,[711]);const Cf=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},ne=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};class Fd{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}yc(b){this.W=
b}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Wo(Object(z.a)(this,this.zx,"onFullAppSettingsReady"))}dispose(){}zx(){v.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&(this.W.register(ri,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").singleInstance().Qd(()=>new ri(v.AFrameworkApplication.K,v.AFrameworkApplication.Ke,String.format("{0}-{1}",Cf(v.AFrameworkApplication.ta.Ob.jm),ne(v.AFrameworkApplication.ta.Ob.bha)),!1,this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
v.AFrameworkApplication.ta.xq)),this.W.Ma("Common.App.SafeLinks.ISafeLinksManager"))}static main(){P.a.instance.Gc(new Fd)}}Object(m.a)(Fd,"SafeLinksPackage",null,[1,2]);var zj=c(188);class Xd{constructor(b){this.ra=new If.a;this.Fh=b}Ncb(b){this.ra.addHandler(Xd.Wxa,b)}W2c(b){this.ra.removeHandler(Xd.Wxa,b)}nYa(b){this.ra.addHandler(Xd.nTa,b)}SLb(b){this.ra.removeHandler(Xd.nTa,b)}uYe(b){this.ra.addHandler(Xd.ykc,b)}Vag(){this.ra.raiseEvent(Xd.Wxa)}Yuf(){return zj.a.instance.MPa(v.AFrameworkApplication.Ly)}}
Xd.Wxa="SE";Xd.d5c="SEP";Xd.nTa="SER";Xd.ykc="TRP";Object(m.a)(Xd,"NullSessionExpirationManager",null,[687,688]);class Th{constructor(){this.Nzc=this.Lbb=!1;const b=v.AFrameworkApplication.Ly;0>=b||(this.Ly=b,u.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Ly,["NowGetTime"]:(new Date).getTime(),["BootTime"]:v.AFrameworkApplication.DW}),zj.a.instance.mnh(Object(z.a)(this,this.Sdc,"onSessionExpiredDetected")),zj.a.instance.lnh(Object(z.a)(this,
this.BZc,"onSessionExpiringDetected")))}Sdc(){zj.a.instance.f6i(Object(z.a)(this,this.Sdc,"onSessionExpiredDetected"));u.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.suf()}BZc(){zj.a.instance.LVn(Object(z.a)(this,this.BZc,"onSessionExpiringDetected"));this.Nzc||this.Lbb||(u.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Nzc=!0,this.Bbg())}suf(){this.Lbb||(v.AFrameworkApplication.jR(Bf.a.c5c),this.Lbb=!0,this.Yge())}}Object(m.a)(Th,"ASessionExpirationManager",
null,[]);var Pf=c(152),rj=c(270);class En{constructor(b,h,t,A){this.Lfg="";this.gcd=b;this.Dbh=t;this.zbh=A;this.SXg=h;b=(new Date(this.gcd)).format(v.AFrameworkApplication.ijj);this.Lfg=this.SXg?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}uhc(b){1===b?this.Dbh&&this.Dbh(this.SXg):0===b&&v.AFrameworkApplication.xa.Rb(ab.a.close,2,rj.g)}dispose(){this.zbh&&this.zbh()}}En.id="SessionExpirationDialog";Object(m.a)(En,"SessionExpirationDialogSharedProperties",
null,[]);class lg{}lg.Wg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(m.a)(lg,"SessionExpirationDialogHtml",null,[]);class al extends Pf.a{constructor(b,h,t,A){super(h);const O={};this.qXa=new En(b,h,t,A);this.sg=En.id;v.AFrameworkApplication.gxh?(this.zd=1,this.Ge(0,CommonUIStrings.l_DialogClose)):(this.zd=0,this.ht=!1);h||1===v.AFrameworkApplication.ta.mode?this.Ge(1,CommonUIStrings.l_SessionExpirationRefreshButton):
this.Ge(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Wg=lg.Wg;O.WACSessionExpirationText=this.qXa.Lfg;this.Yh(CommonUIStrings.l_DefaultDialogTitle,Object(z.a)(this,this.uhc,"sessionExpirationDialogHandler"),O);this.s4(this.kj("WACSessionExpirationText"))}uhc(b){this.qXa.uhc(b)}rvf(){this.hide()}dispose(){super.dispose();this.qXa&&this.qXa.dispose()}}Object(m.a)(al,"LegacySessionExpirationDialog",Pf.a,[843]);class Dh extends cf.StandardDialog{constructor(b,h,t,A){super(h);this.qXa=
new En(b,h,t,A);this.sg=En.id;v.AFrameworkApplication.gxh?(this.zd=1,this.Ge(0,CommonUIStrings.l_DialogClose)):(this.zd=0,this.ht=!1);h||1===v.AFrameworkApplication.ta.mode?this.Ge(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ge(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Au(CommonUIStrings.l_DefaultDialogTitle,this.qXa.Lfg,0,Object(z.a)(this,this.uhc,"sessionExpirationDialogHandler"))}uhc(b){this.qXa.uhc(b)}rvf(){this.hide()}dispose(){super.dispose();this.qXa&&this.qXa.dispose()}}
Object(m.a)(Dh,"SessionExpirationDialog",cf.StandardDialog,[843]);const Fi=(b,h,t,A)=>v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.VE&&v.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?new Dh(b,h,t,A):new al(b,h,t,A);var Ri=c(157);class Ll extends Th{constructor(b){super();this.std=this.hYb=!0;this.iZ=null;this.ra=new If.a;this.Fh=b}Ncb(b){this.ra.addHandler(Ll.Wxa,b)}W2c(b){this.ra.removeHandler(Ll.Wxa,b)}nYa(b){this.ra.addHandler(Ll.nTa,b)}SLb(b){this.ra.removeHandler(Ll.nTa,
b)}uYe(b){this.ra.addHandler(Ll.ykc,b)}Yuf(){return zj.a.instance.MPa(v.AFrameworkApplication.Ly)}Vag(b){this.hYb=b}Bbg(){if(!this.iZ&&!Ri.a.VL){if(this.std){const b=Object(z.a)(this,this.S3b,"disposeCallback");this.iZ=Fi(this.Ly,!1,Object(z.a)(this,this.vhc,"sessionExpirationHandler"),b)}this.ra.raiseEvent(Ll.d5c)}}Yge(){this.iZ&&(this.iZ.Ega&&this.iZ.rvf(),this.iZ=null);if(this.hYb){const b=Object(z.a)(this,this.S3b,"disposeCallback");this.iZ=Fi(this.Ly,!0,Object(z.a)(this,this.vhc,"sessionExpirationHandler"),
b)}this.ra.raiseEvent(Ll.Wxa)}S3b(){this.iZ=null}vhc(b){(b||this.Fh.lAd())&&this.Fh.refreshDocument(null)}}Ll.Wxa="SE";Ll.d5c="SEP";Ll.nTa="SER";Ll.ykc="TRP";Object(m.a)(Ll,"SessionExpirationManager",Th,[687,688]);class Pe{}Pe.tik="Aborting";Pe.xxd="ActivityDuration";Pe.error="Error";Pe.fgf="Errors";Pe.failed="Failed";Pe.fCb="FirstActivity";Pe.initialized="Initialized";Pe.kickedOut="KickedOut";Pe.hPm="LastActivity";Pe.q9i="RetryOverride";Pe.dce="RequestGroups";Pe.Fmb="Requests";Pe.pce="Responses";
Pe.Wde="SessionDuration";Pe.status="Status";Pe.success="Success";Pe.fxo="Successful";Pe.tokens="Tokens";Pe.IWf="PollingDuration";Object(m.a)(Pe,"SessionExpirationStrings",null,[]);class ib{constructor(b){this.MB={};this.Zia={};this.CWa={};this.ADi=15;this.IZg=!1;this.Jbk=new Date;this.Uld=new Date;this.Gb=b;this.YB=new Vb.a(2,2,6E4*this.ADi,Object(z.a)(this,this.jFj,"writeMeasures"),135,"SL",!1);this.Gb.Wb(this.YB);this.prm()}jFj(){u.ULS.sendTraceTag(41964821,217,50,u.ULS.iVc({["Aggregate"]:this.Zia,
["Current"]:this.MB}))}prm(){this.Zia[Pe.dce]=0;this.Zia[Pe.Fmb]=0;this.Zia[Pe.pce]=0;this.Zia[Pe.status]=Pe.initialized;this.Zia[Pe.fCb]=new Date;this.Zia[Pe.Wde]=0;this.Zia[Pe.xxd]=0;this.Zia[Pe.Wde]=0;this.MB[Pe.Wde]=0;this.Zia[Pe.xxd]=0;this.MB[Pe.xxd]=0}get Rwn(){this.CWa[Pe.IWf]=+new Date-+this.CWa[Pe.fCb];return this.CWa}Wwf(b,h){var t=b[h];t=t?t:0;t++;b[h]=t;this.P8f(b)}P8f(b){const h=new Date;b[Pe.xxd]=+h-+this.Uld;this.Uld=h;b[Pe.Wde]=+this.Uld-+this.Jbk;b[Pe.hPm]=this.Uld}j9(b,h){this.MB[b]=
h;this.P8f(this.MB)}f8f(b,h){this.MB[b]=h;this.P8f(this.MB)}V8b(b){this.Wwf(this.MB,b);this.Wwf(this.Zia,b);this.Wwf(this.CWa,b)}flush(){this.IZg||(this.Zia[Pe.status]=this.MB[Pe.status],this.jFj(this.YB),this.Gb.l4(this.YB,6E4*this.ADi))}LZn(){const b=this.MB[Pe.status];b&&(this.Zia[Pe.status]=b);this.MB={}}b_n(){this.CWa={};this.CWa[Pe.IWf]=0;this.CWa[Pe.fCb]=new Date}stop(){u.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.IZg=!0;this.Gb.Se(this.YB)}}
Object(m.a)(ib,"SessionLogger",null,[683]);class Ib{constructor(b,h){this.svd=b;this.Pza=h}get tokens(){return this.svd}get errors(){return this.Pza}}Object(m.a)(Ib,"TokenRefreshArgs",null,[709]);var fc=c(398);class Cc extends Sys.EventArgs{constructor(b,h,t,A,O,aa,ua){super();this.CWa=b;this.Iwn=h;this.dce=A;this.failed=O;this.Fmb=aa;this.pce=ua}}Object(m.a)(Cc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Jc=c(36);class pd{constructor(b,h=null,t=null){this.Nzc=this.Lbb=!1;this.std=this.hYb=
!0;this.ra=new If.a;this.Pzc=this.Muc=this.crd=!1;this.svb=null;this.c8g=10;this.ild=!1;this.jTe=b;this.$Ee=v.AFrameworkApplication.hNm;this.Gb=sf.a.instance;u.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:v.AFrameworkApplication.Ly,["NowGetTime"]:(new Date).getTime(),["BootTime"]:v.AFrameworkApplication.DW});this.xe=h||new ib(sf.a.instance);this.Bka=t;zj.a.instance.mnh(Object(z.a)(this,this.mik,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));
zj.a.instance.lnh(Object(z.a)(this,this.QVe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));fc.SessionStatusManager.instance.sYe(Object(z.a)(this,this.QVe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));fc.SessionStatusManager.instance.Rrk(Object(z.a)(this,this.Eyn,"preemptiveTokenRefresh"));this.e0g=new Date;v.AFrameworkApplication.gNm&&(zj.a.instance.S3e=Object(z.a)(this,this.FMn,"refreshAccessTokenWhenSessionExpired"));b=!1;v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",
!1),this.c8g=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),b=v.AFrameworkApplication.K.$("WopiTokenRefreshWhenNetworkResumed"));b?fc.SessionStatusManager.instance.sYe(Object(z.a)(this,this.nik,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):fc.SessionStatusManager.instance.sYe(Object(z.a)(this,this.QVe,
"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}Ncb(b){this.ra.addHandler(pd.Wxa,b)}W2c(b){this.ra.removeHandler(pd.Wxa,b)}nYa(b){this.ra.addHandler(pd.nTa,b)}SLb(b){this.ra.removeHandler(pd.nTa,b)}uYe(b){this.ra.addHandler(pd.ykc,b)}Yuf(){return zj.a.instance.MPa(v.AFrameworkApplication.Ly)}FMn(){this.qPc(!1);return!zj.a.instance.MPa(v.AFrameworkApplication.Ly)}mik(b,h){zj.a.instance.NYd?this.Sdc(b,h):this.$Ee?(this.Muc=!1,this.qPc(!1)):(this.Lbb||u.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),
this.Sdc(b,h))}nik(b,h){zj.a.instance.MYd?this.BZc(b,h):(Jc.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.Muc=!1,this.qPc(!0))}QVe(b,h){zj.a.instance.MYd?this.BZc(b,h):this.qPc(!0)}qPc(b){if(!this.crd&&!this.Muc)if(this.Bka&&this.Bka.eo)this.Pzc=!0,this.xe.j9(Pe.status,Pe.kickedOut),this.xe.flush(),this.xe.stop();else if(u.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.Pzc),this.Pzc)this.Yge();else{this.xe.flush();
this.xe.LZn();this.xe.V8b(Pe.dce);this.crd=!0;this.ild||(this.xe.b_n(),this.ild=!0,this.w1k());const h=this.jTe.ZMn(b);h.continueWith(()=>{if(this.jTe.ECn(h))this.xe.V8b(Pe.fxo),this.xe.j9(Pe.status,Pe.success),this.std=!1,this.$Ee&&(this.hYb=!1),this.Muc=!1,this.e0g=new Date,this.$vo(),this.ra.raiseEvent(pd.nTa,new Ib(h.result.tokens,null));else{const t=h.result.errors;this.xe.V8b(Pe.failed);this.xe.j9(Pe.status,Pe.failed);b||(this.Pzc=this.jTe.JTc(t));this.Pzc&&(this.xe.j9(Pe.tik,JSON.stringify(t)),
u.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.Muc=!0;this.ra.raiseEvent(pd.nTa,new Ib(null,t))}this.xe.flush();this.crd=!1})}}Sdc(){this.$Ee||zj.a.instance.f6i(Object(z.a)(this,this.Sdc,"onSessionExpiredDetected"));u.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.suf(zj.a.instance.NYd)}BZc(){this.Nzc||this.Lbb||(u.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Nzc=!0,this.Bbg(zj.a.instance.MYd))}suf(b){if(!this.Lbb){var h=
b?Bf.a.g9n:Bf.a.c5c;const t=Object.assign(new Hb.a,{extendedProperties:new Map});t.extendedProperties.set("ErrorCode",String.format("{0}",h));v.AFrameworkApplication.jR(h,void 0,["SessionExpired"],t);b||(b=new Date,h=new Date(v.AFrameworkApplication.DW),u.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&wa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,t),2592E5>+b-+h&&
wa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,t));this.Lbb=!0;this.Yge()}}$vo(){this.ild&&(this.Gb.Se(this.svb),this.ild=!1)}w1k(){this.svb=new Vb.a(2,2,1E3*this.c8g,Object(z.a)(this,this.wDo,"tokenRefreshPolling"),135);this.Gb.Wb(this.svb)}wDo(){const b=this.xe.Rwn;u.ULS.sendTraceTag(555255521,217,50,"{0}",E.c(b));this.ra.raiseEvent(pd.ykc,new Cc(b,b[Pe.IWf],b[Pe.fCb],b[Pe.dce],b[Pe.failed],b[Pe.Fmb],b[Pe.pce]))}Eyn(){3E5<+new Date-
+this.e0g?(u.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.qPc(!1)):u.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}pd.Wxa="SE";pd.d5c="SEP";pd.nTa="SER";pd.ykc="TRP";Object(m.a)(pd,"ASessionExpirationManagerWithRefresh",null,[]);class ge extends pd{constructor(b,h,t=null,A=null){super(h,t,A);this.iZ=null;this.Fh=b}Vag(b){this.hYb=b}Bbg(b){if(!this.iZ&&!Ri.a.VL){if(b){var h=Object(z.a)(this,this.S3b,
"disposeCallback");this.iZ=Fi(v.AFrameworkApplication.Tmb,!1,Object(z.a)(this,this.vhc,"sessionExpirationHandler"),h)}else if(this.std){if(this.crd)return;h=Object(z.a)(this,this.S3b,"disposeCallback");this.iZ=Fi(v.AFrameworkApplication.Ly,!1,Object(z.a)(this,this.vhc,"sessionExpirationHandler"),h)}u.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",pd.d5c,b);this.ra.raiseEvent(pd.d5c)}}Yge(){this.iZ&&(this.iZ.Ega&&this.iZ.rvf(),this.iZ=null);if(this.hYb){this.xe.stop();
if(this.Bka&&this.Bka.eo)return;const b=Object(z.a)(this,this.S3b,"disposeCallback");this.iZ=Fi(v.AFrameworkApplication.Ly,!0,Object(z.a)(this,this.vhc,"sessionExpirationHandler"),b)}u.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",pd.Wxa);this.ra.raiseEvent(pd.Wxa)}S3b(){this.iZ=null}vhc(b){(b||this.Fh.lAd())&&this.Fh.refreshDocument(null)}}Object(m.a)(ge,"SessionExpirationManagerWithRefresh",pd,[687,688]);class pe{constructor(b,h,t=null,A=null){this.Ogh=!1;this._instance=null;this._frame=
b;this.Bm=h;this.xe=t||new ib(sf.a.instance);this.Bka=A}create(){this.Ogh=v.AFrameworkApplication.N2a;if(!this.Ogh)return new Ll(this._frame);v.AFrameworkApplication.An("WOPITokenRefreshIsEnabled");u.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this._instance)switch(v.AFrameworkApplication.iXo){case 1:u.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new Xd(this._frame);break;case 2:u.ULS.sendTraceTag(39408091,
217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new ge(this._frame,this.Bm,this.xe,this.Bka);break;default:u.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new Ll(this._frame)}u.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(m.a)(pe,"SessionExpirationManagerFactory",null,[686]);class ke{}Object(m.a)(ke,"Error",
null,[]);class Qf{}Object(m.a)(Qf,"NamedResult",null,[]);class Hg extends Qf{}Object(m.a)(Hg,"ErrorInfo",Qf,[]);var gc=c(1067);class nh{constructor(b,h,t,A=null,O=!1,aa=null,ua=!1,Ra=!1){this.NAa=0;this.YLa=this.ro=null;this.svd=new Mb.a;this.Pza=new Mb.a;this.Qp=null;this.tuc=!1;this.ZAc=this.$Ac=null;this.Gb=b;this.h8g=h;this.h8g.execute(ub=>{ub.uB(K.a.Svf,Object(z.a)(this,this.xin,"onHostResponseReceived"))});this.X1=t;this.vfh=new gc.a("WebServiceCall","TokenRefresh");this.xe=A||new ib(b);this.Cbk=
O;this.ff=aa?aa:fc.SessionStatusManager.instance;this.mQg=ua;this.Lgd=Ra}xin(b){if(b.MessageId!==K.a.Svf)Jc.b(39408099,306,15,"Unexpected message.");else{var h=new Mb.a,t=new Mb.a;this.xe.V8b(Pe.pce);var A=b.Values[J.a.rdj];if(!A||0>=A.length)Jc.b(40122317,306,15,"Found no tokens in the dictionary"),A=b.Values;Jc.b(40122318,306,100,"The Tokens array contains {0} tokens",A.length);this.xe.j9("Correlation",b.CorrelationId);var O="";for(let Ra=0;Ra<A.length;Ra++){this.xe.f8f(Pe.tokens,A.length);var aa=
A[Ra],ua=aa;if(!ua||!ua.Name)continue;this.xe.V8b(ua.Name);const ub=aa;if(ub&&ub.Value)Jc.b(39408128,306,100,"Received token with name: {0}",ub.Name),h.add(ub),this.svd.add(ub),this.Lgd||this.xe.j9(Pe.status,Pe.success),this.mQg&&this.ff&&this.ff.s_n();else if(aa=this.q4l(aa),Jc.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ua.Name,JSON.stringify(aa),this.YLa),t.add(aa),this.Lgd||(this.Pza.add(aa),O=JSON.stringify(aa),this.xe.j9(Pe.error,JSON.stringify(aa)),
this.xe.j9(Pe.status,Pe.failed)),this.mQg)for(const Nb of aa.Errors)ua=this.YNl(Nb),this.ff&&this.ff.Tok(ua)}this.Lgd?(0<t.count?this.ZAc?this.ZAc(new Ib(h,t)):Jc.b(512267295,306,15,"Received errors but the promise has completed"):this.$Ac?this.$Ac(new Ib(h,t)):Jc.b(512267294,306,15,"Received valid tokens but the promise has completed"),Jc.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,t.count,b.CorrelationId,this.YLa)):(0<t.count&&
""!==O?(A=Object.assign(new Hb.a,{extendedProperties:new Map}),A.extendedProperties.set("Errors",O),A.extendedProperties.set("RetryCount",this.NAa.toString()),A.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),A.extendedProperties.set("IsTokenExpiring",this.tuc.toString()),wa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,A)):wa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),Jc.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
h.count,t.count,b.CorrelationId,this.YLa),0<t.count&&!this.JTc(t)?(b=this.X1.obi(t),b!==this.X1.xgc&&(this.xe.f8f(Pe.q9i,b),this.Gb.l4(this.ro,b))):(this.xe.flush(),this.ro&&(Jc.b(39408131,306,100,"Deleting task {0} from task manager",this.ro.name),this.Gb.Se(this.ro)),this.Qp&&!this.Qp.task.isCompleted?this.Qp.xg(new Ib(h,t)):Jc.b(512267293,306,15,"Received results but the task has completed")))}}q4l(b){if(!b)return null;const h=Object.assign(new Hg,{Name:b.Name,Errors:[]});for(const t of b.Errors)b=
new ke,b.Id=t.Id,b.Details=pa.a.s7b(t.Details,500),h.Errors.push(b);return h}requestTokensOnce(){this.Z7i()}Z7i(){v.AFrameworkApplication.ye("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.NAa>=this.X1.n2d?(Jc.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.YLa),this.j3k(this.Qp)):(wa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Acj())}Acj(){const b={};b[J.a.rdj]=this.X1.tokens;const h=Ya.a.create().toString();
Jc.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.X1.tokens),this.NAa+1,h,this.YLa);this.h8g.execute(t=>{t.sendMessage(K.a.PZe,b,h)});this.NAa++;this.xe.V8b(Pe.Fmb)}j3k(b){const h=new Mb.a;for(let t=0;t<this.X1.tokens.length;t++){const A=Object.assign(new Hg,{Name:this.X1.tokens[t],Errors:[Object.assign(new ke,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});h.add(A);
this.Pza.add(A)}this.Gb.Se(this.ro);this.xe.j9(Pe.fgf,JSON.stringify(this.Pza));this.xe.j9(Pe.status,Pe.failed);b&&!b.task.isCompleted&&b.xg(new Ib(new Mb.a,this.Pza))}ZMn(b){this.vfh.start();this.tuc=b;this.YLa=Ya.a.create().toString();Jc.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.YLa,this.tuc);this.NAa=0;this.Pza.clear();this.svd.clear();this.Qp=new xm.a;this.Lgd?this.$7i(this.X1.n2d).then(h=>{this.Qp&&!this.Qp.task.isCompleted&&this.Qp.xg(h);this.ZAc=this.$Ac=
null;this.xe.j9(Pe.fgf,JSON.stringify(this.Pza));this.xe.j9(Pe.status,Pe.success);this.xe.flush()}).catch(h=>{this.Qp&&!this.Qp.task.isCompleted&&this.Qp.xg(Object(Da.a)(709,h));this.ZAc=this.$Ac=null;this.xe.j9(Pe.fgf,JSON.stringify(this.Pza));this.xe.j9(Pe.status,Pe.failed);this.xe.flush()}):(this.ro=new Vb.a(this.X1.priority,2,this.X1.xgc,Object(z.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,K.a.PZe,!0),this.Cbk&&this.Z7i(),this.Gb.Wb(this.ro));return this.Qp.task}$7i(b){const h=this,
t=new Promise((Ra,ub)=>{h.$Ac=Ra;h.ZAc=ub;wa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.Acj()}),A=this,O=new Promise((Ra,ub)=>{window.setTimeout(()=>{ub(A.wHh("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},A.X1.xgc)});let aa=b;const ua=this;return new Promise((Ra,ub)=>{aa--;Promise.race([t,O]).then(Nb=>{wa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ra(Nb)}).catch(Nb=>{var Yb=ua.X1.xgc;if(Object(hc.a)(709,Nb)&&(Nb=
Object(Da.a)(709,Nb),0<Nb.errors.count)){ua.iXm(Nb.errors);ua.kkh(Nb.errors);if(ua.JTc(Nb.errors)){ub(Nb);return}const bc=ua.X1.obi(Nb.errors);bc!==ua.X1.xgc?(ua.xe.f8f(Pe.q9i,bc),Yb=bc):ua.FLm(Nb.errors)&&(Yb=0)}aa?window.setTimeout(()=>{ua.$7i(aa).then(Ra).catch(ub)},Yb):(Yb=ua.wHh("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ua.kkh(Yb.errors),ub(Yb),Jc.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
ua.YLa))})})}kkh(b){for(let h of b)this.Pza.add(h)}FLm(b){if(!b.count)return!1;b=b.J(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}wHh(b,h){const t=new Mb.a;for(let A=0;A<this.X1.tokens.length;A++){const O=this.k3k(this.X1.tokens[A],b,h);t.add(O)}return new Ib(new Mb.a,t)}k3k(b,h,t){return Object.assign(new Hg,{Name:b,Errors:[Object.assign(new ke,{Id:h,Details:t})]})}iXm(b){if(b.count){b=b.J(b.count-1);b=JSON.stringify(b);var h=Object.assign(new Hb.a,{extendedProperties:new Map});
h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.NAa.toString());h.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.tuc.toString());wa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,h);this.xe.j9(Pe.error,b);this.xe.j9(Pe.status,Pe.failed)}}ECn(b){this.vfh.stop();const h=this.Yhm(b.result.errors);u.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!h,this.YLa,this.tuc,this.NAa,this.Pza.count,0<b.result.errors.count?b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return h?!1:this.DCn(b.result.tokens)}JTc(b){return this.X1.JTc(b)}DCn(b){for(let h=0;h<b.count;h++){const t=b.J(h);if(t.Name===J.a.accessToken){const A=(new Date).getTime();t.Expiry>v.AFrameworkApplication.Ly?
(u.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:t.Expiry,["NowGetTime"]:A,["BootTime"]:v.AFrameworkApplication.DW},"PreviousAccessTokenTtl",v.AFrameworkApplication.Ly),v.AFrameworkApplication.accessToken=t.Value,v.AFrameworkApplication.Ly=Math.floor(t.Expiry),v.AFrameworkApplication.Jlg=A,v.AFrameworkApplication.kMa=Math.floor(t.Expiry)):u.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:t.Expiry,
["NowGetTime"]:A,["BootTime"]:v.AFrameworkApplication.DW},"PreviousAccessTokenTtl",v.AFrameworkApplication.Ly)}}return!0}Yhm(b){let h=!1;for(let t=0;t<b.count;t++){h=!0;const A=b.J(t);u.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",A.Name,JSON.stringify(A.Errors),this.YLa)}return h}YNl(b){let h=Bf.a.c5c;b=parseInt(b.Id);if(isNaN(b))h=Bf.a.mEj;else{switch(b){case 401:h=Bf.a.Klg;break;case 403:h=Bf.a.kEj;break;case 500:h=Bf.a.lEj;break;case 503:h=Bf.a.oEj}h===
Bf.a.c5c&&(h=500<b?Bf.a.nEj:Bf.a.jEj)}return h}}Object(m.a)(nh,"TokenRefreshManager",null,[685]);class Yd{constructor(){this.xgc=v.AFrameworkApplication.lXo;this.n2d=v.AFrameworkApplication.jXo;this.tokens=v.AFrameworkApplication.icm();this.priority=v.AFrameworkApplication.mXo;this.E$g=this.hfo();this.tVe=v.AFrameworkApplication.hcm()}JTc(b){b=JSON.stringify(b);if(this.tVe&&0<this.tVe.length)for(const h of this.tVe)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}obi(b){try{if(b)for(let h of b)if(h.Errors)for(const t of h.Errors)if(t.Id in
this.E$g)return Number.parseInvariant(this.E$g[t.Id].toString())}catch(h){u.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.xgc}hfo(){const b={};try{if(!v.AFrameworkApplication.vRd()||0>=v.AFrameworkApplication.vRd().length||""===v.AFrameworkApplication.vRd()[0])return b;for(const h of v.AFrameworkApplication.vRd())0<h.length&&(b[h]=v.AFrameworkApplication.kXo)}catch(h){u.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
h.toString())}return b}}Object(m.a)(Yd,"TokenRefreshPolicy",null,[684]);class Nk{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){v.AFrameworkApplication.K.Wo(()=>{this.x1a()})}x1a(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}yc(b){this.W=b;b.register(683,"Common.App.SessionExpiration.ISessionLogger").singleInstance().Qd(()=>new ib(sf.a.instance));
b.register(684,"Common.App.SessionExpiration.ITokenRefreshPolicy").singleInstance().Qd(()=>new Yd);b.register(685,"Common.App.SessionExpiration.ITokenRefreshManager").singleInstance().Qd(()=>new nh(sf.a.instance,v.AFrameworkApplication.lO(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),v.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Ma("Common.ISessionStatus"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1),v.AFrameworkApplication.K.$("WopiTokenRefreshSyncMessageWithTimeout")));b.register(686,"Common.ISessionExpirationManagerFactory").singleInstance().Qd(()=>new pe(v.AFrameworkApplication.ta,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Ma("Common.ISessionStatus")));b.register(687,"Common.ISessionExpirationManagerWithDialog").singleInstance().Qd(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(688,
"Common.ISessionExpirationManager").singleInstance().Qd(()=>b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){P.a.instance.Gc(new Nk)}}Object(m.a)(Nk,"SessionExpirationPackage",null,[1,2]);var Jj=c(758),gj=c(442),eh=c(362),Eh=c(216);class sg extends Eh.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(m.a)(sg,"PersonaButtonProps",Eh.a,[]);class Ea{S2b(b,h){if(b&&!(1>b.length)&&h){var t=Object.assign(new eh.a,{ExternalId:"msPresenceOuter",
ControlList:[]});this.y3k(b,t.ControlList);h.push(t)}}y3k(b,h){const t=Object.assign(new Jj.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new gj.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,t);h=Object.assign(new eh.a,{Title:"",ControlList:[]});Array.add(t.Menu.MenuSectionList,h);this.r6k(b,h.ControlList)}r6k(b,h){for(let t=0;t<b.length;t++){const A=Object.assign(new sg,{ExternalId:String.format("CoauthorPersona_{0}",
t),Command:"336231556",DisplayName:b[t].userName,LabelText:b[t].userName,ImageBackColor:b[t].color,PersonaId:b[t].email,IsAnonymous:b[t].isAnonymous});Array.add(h,A)}}}Object(m.a)(Ea,"PresenceContextMenuSectionBuilder",null,[776]);var yb=c(78);class kc{constructor(b,h,t,A){this.jza=this.Xs=this.ro=this.$h=this.SIa=null;this.xtd=b;this.Sck=A;this.xtd.WRc&&(this.ro=new Vb.a(3,2,5E3,Object(z.a)(this,this.gBk,"authenticationCheckTask"),2),v.AFrameworkApplication.oc.Wb(this.ro),this.Ub(h,t));this.xtd.Cpk(()=>
{this.lJb()});this.xtd.amh(()=>{this.mJb()})}get FN(){return this.Xs||(this.Xs=Sa.a.instance.Ma("CommonUI.IBusinessBar"))}get vvh(){return this.jza||(this.jza=Sa.a.instance.Ma("CommonUI.IBusinessBarEntryFactory"))}Ub(b,h){const t=v.AFrameworkApplication.xa;t.gb(ab.a.lsh,yc.a.frame,b,96);t.gb(ab.a.msh,yc.a.frame,h,96);t.pa(ab.a.Exh,yc.a.frame,Kf.ActionManager.eQ);t.pa(ab.a.Fxh,yc.a.frame,Kf.ActionManager.eQ);t.pa(ab.a.lGf,yc.a.frame,Kf.ActionManager.eQ)}lJb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
v.AFrameworkApplication.xa.processAction(ab.a.lsh,2)}mJb(){this.xAo();v.AFrameworkApplication.xa.processAction(ab.a.msh,2)}gBk(){this.xtd.authenticationCheck()}xAo(){this.$h&&(this.$h.hide(),this.$h.dispose(),this.$h=null);this.SIa&&this.FN&&(v.AFrameworkApplication.Rk||this.FN.removeEntry(this.SIa),this.SIa.dispose(),this.SIa=null)}showDialog(b){yb.a.zB(this.$h);this.$h=new cf.StandardDialog;this.Sck||(this.$h.ht=!1,this.$h.zd=0);this.$h.Ge(1,CommonUIStrings.l_SignIn);this.$h.PU(CommonUIStrings.l_DefaultDialogTitle,
b,Object(z.a)(this,this.vaa,"dialogHandler"))}vaa(b){1===b?(Nm.a.p8d(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),v.AFrameworkApplication.xa.processAction(ab.a.lGf,2)):(this.Sno(),v.AFrameworkApplication.xa.processAction(ab.a.Fxh,2))}Sno(){this.FN&&this.vvh&&(this.SIa=this.vvh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.SIa.closeable=!0,this.SIa.addButton(CommonUIStrings.l_SignIn,kc.wdb,""),this.SIa.xla=
Object(z.a)(this,this.sIk,"businessBarEntryCloseHandler"),this.FN.Kz(this.SIa,!1))}sIk(){this.mgl();v.AFrameworkApplication.xa.processAction(ab.a.Exh,2)}mgl(){this.ro&&(v.AFrameworkApplication.oc.Se(this.ro),this.ro=null)}dispose(){this.ro=this.$h=this.SIa=null}static wdb(){Nm.a.p8d();v.AFrameworkApplication.xa.processAction(ab.a.lGf,2)}}Object(m.a)(kc,"SignOutResponseUI",null,[9]);class Rc{get name(){return"Common.App.UI"}yc(b){b.register(Ea,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").singleInstance()}init(){}dispose(){yb.a.zB(Rc.vsa);
Rc.vsa=null}static main(){P.a.instance.Gc(new Rc)}static Gpm(b,h,t){Rc.Eno()&&(Rc.vsa=new kc(Nm.a.instance,b,h,t))}static Eno(){return v.AFrameworkApplication.x3d&&!v.AFrameworkApplication.qga}}Rc.vsa=null;Object(m.a)(Rc,"CommonAppUIPackage",null,[1,2]);class Xc{get name(){return"Common.App.DialogWithLinkToResource"}yc(){}init(){}dispose(){}static main(){P.a.instance.Gc(new Xc)}}Object(m.a)(Xc,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var yd=c(57);class gf{constructor(b){this.Ox=b;this.Gx=
Array.indexOf(this.Ox,this.Dfa)}dispose(){this.Ox=null}get R2(){return this.Ox[this.Gx]}wy(b){this.l5c(b,!1);return!0}z5b(b){this.l5c(b,!0)}l5c(b,h){b&&(this.R2!==b||h)&&(b.tabIndex=0,yd.FocusManager.zJ(b));Array.contains(this.Ox,b)&&(this.Gx=Array.indexOf(this.Ox,b))}get TXi(){let b=this.Gx;do if(b)if(0<b&&b<this.Ox.length)b--;else break;else b=this.Ox.length-1;while(!$f.DOMFocusListing.n_a(this.Ox[b])&&b!==this.Gx);return this.Ox[b]}get kKi(){let b=this.Gx;do if(b===this.Ox.length-1)b=0;else if(0<=
b&&b<this.Ox.length-1)b++;else break;while(!$f.DOMFocusListing.n_a(this.Ox[b])&&b!==this.Gx);return this.Ox[b]}get Dfa(){let b=0;for(;!$f.DOMFocusListing.n_a(this.Ox[b])&&b<this.Ox.length;)b++;return $f.DOMFocusListing.n_a(this.Ox[b])?this.Ox[b]:null}get lbc(){let b=this.Ox.length-1;for(;!$f.DOMFocusListing.n_a(this.Ox[b])&&0<b;)b--;return $f.DOMFocusListing.n_a(this.Ox[b])?this.Ox[b]:null}}Object(m.a)(gf,"DialogFocusListing",null,[152]);var vc=c(49);class Le extends cf.StandardDialog{constructor(b,
h,t,A=null){super();this.Pda=this.uw=this.V9a=null;this.Ox=[];this.Lpd=h;this.nk=b;this.TZj=t;this.Jsd=A;this.am=new gc.a("LoadResource","LoadPrintablePdf")}dDa(){this.zd=5;this.width=40;const b=document.createElement("span");b.id=this.kj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.Pda=document.createElement("iframe");this.Pda.name="pdfObjectFrame";this.Pda.title=
CommonUIStrings.l_DirectPrintDialogIFrame;this.Pda.onload=Object(z.a)(this,this.wAn,"printablePdfLoaded");if(this.Jsd&&0<this.Jsd.count){var t=ia.a.uqf(this.Lpd,this.Jsd);const A=ia.a.k2f(this.Lpd,this.Jsd);this.uw=document.createElement("form");this.uw.id="printPreviewPostForm";this.uw.method="POST";this.uw.target=this.Pda.name;this.uw.action=A;for(let O of t)t=document.createElement("input"),t.type="hidden",t.name=O.key,t.value=O.value,this.uw.appendChild(t)}else this.Pda.setAttribute("src",this.Lpd);
Sys.UI.DomElement.addCssClass(this.Pda,Ri.a.M4g);this.TZj?(Sys.UI.DomElement.addCssClass(this.Pda,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Mf.a.Uq(this.Pda,Mf.a.Lz,Mf.a.gp)):(Sys.UI.DomElement.addCssClass(this.Pda,"DirectPrintPdfObject"),this.Ox.push(this.Pda));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.Pda);this.uw&&b.appendChild(this.uw);b.appendChild(document.createElement("br"));b.appendChild(this.TXk(this.uw?
"#":this.Lpd));this.am.start();this.pkb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.s4(this.kj("DirectPrintHeaderContent"));this.uw&&this.uw.submit();this.z3k();u.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}TXk(b){const h=document.createElement("span");var t=document.createElement("span");t.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(t);v.AFrameworkApplication.K&&(2===v.AFrameworkApplication.ta.Ob.jm&&v.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||
1===v.AFrameworkApplication.ta.Ob.jm&&v.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===v.AFrameworkApplication.ta.Ob.jm?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===v.AFrameworkApplication.ta.Ob.jm&&(b.innerText=CommonUIStrings.l_InternalError_Directive,u.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.V9a=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(t=
document.createElement("a"),t.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,t.href=b,t.target="_blank",t.id="PrintPDFLink",t.className="AllowBrowserClick",this.V9a=t,h.appendChild(document.createElement("br")),h.appendChild(t),this.uw&&Hf.a.addHandler(t,"click",Object(z.a)(this,this.Jnn,"onSubmit")),this.nk.mb(db.a.click,this.V9a,Object(z.a)(this,this.iQh,"downloadPDFLinkClicked"),null));this.Ox.push(this.V9a);return h}Jnn(b){this.uw&&(this.uw.target="_blank",this.uw.submit());b.preventDefault()}z3k(){if(0<
this.Ox.length){const b=new gf(this.Ox),h=yd.FocusManager.instance().Hs();h&&(this.V9a.focus(),h.Xj=b,h.lU=!0)}}iQh(){u.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}zWc(){u.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}wAn(){u.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.am&&this.am.stop()}dispose(){this.V9a&&(this.nk.sc(db.a.click,this.V9a,Object(z.a)(this,this.iQh,"downloadPDFLinkClicked")),
this.V9a=null);vc.a.Pw(this.Pda);this.Pda=null;super.dispose()}}Object(m.a)(Le,"DirectPrintDialog",cf.StandardDialog,[745]);class id{constructor(b){this.nk=b}LMl(b,h,t=null){return new Le(this.nk,b,h,t)}}Object(m.a)(id,"DirectPrintDialogFactory",null,[725]);class Gi{constructor(b,h){this._url=b;this.S7j=h}YOh(){this.S7j?ff.a.downloadFile(this._url):ff.a.km(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(m.a)(Gi,"OpenUrlInTabDialogDownloadBehavior",null,
[759,9]);class Oh extends cf.StandardDialog{constructor(b,h=!0,t=!1,A=null,O=null,aa=!1){super();this.XTb=this.WTb=this.uw=this.R1=null;var ua=this.egg?this.egg:CommonUIStrings.l_DefaultDialogTitle;Oh.q8b=aa;this.dxe=A||new Gi(b,!0);const Ra=[],ub=[];Oh.fL&&(this.Hyd&&this.Hyd.forEach(bc=>{Array.add(Ra,bc)}),this.Bnh&&this.Bnh.forEach(bc=>{Array.add(ub,bc)}));h?t?this.vWd?(this.zd=12,this.Ge(1,this.buttonText),this.Ge(2,CommonUIStrings.l_DownloadACopyDialog_CopyALinkButton),this.Ge(3,CommonUIStrings.l_DialogClose)):
this.GWd?(this.zd=12,this.Ge(1,this.buttonText),this.Ge(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.Ge(3,CommonUIStrings.l_DialogClose)):(this.zd=4,this.Ge(1,this.buttonText),this.Ge(2,CommonUIStrings.l_DialogClose)):(this.zd=6,this.Ge(0,CommonUIStrings.l_DialogClose)):this.zd=5;aa=document.createElement("span");this.uHc&&(aa.className=this.uHc);A=document.createElement("a");A.innerText=this.Bbc;A.href=b;A.target="_blank";A.id=this.gWc;A.className=vf.AFrame.pZe;var Nb=!ba.a.u3&&
!!O&&0<O.count;if(Nb){const bc=ia.a.uqf(b,O);O=ia.a.k2f(b,O);A.href="#";A.target="_self";this.uw=document.createElement("form");this.uw.id="printPreviewPostForm1";this.uw.method="post";this.uw.target="_blank";this.uw.action=O;for(var Yb of bc)O=document.createElement("input"),O.type="hidden",O.name=Yb.key,O.value=Yb.value,this.uw.appendChild(O)}else this.uw=null;this.uw||Oh.q8b?Oh.q8b||Array.add(ub,{["type"]:"AppLinkProps",["id"]:this.gWc,["text"]:this.Bbc,["onExecute"]:()=>{this.y0i()}}):Array.add(ub,
{["type"]:"AppLinkProps",["id"]:this.gWc,["text"]:this.Bbc,["handler"]:{["href"]:Nb?"#":b,["target"]:Nb?"_self":"_blank"}});this.C3a&&Array.add(Ra,this.C3a);t?(b=document.createElement("span"),b.innerText=this.C3a.replace("{0}",""),aa.appendChild(b)):this.SHi?(b=document.createElement("span"),b.id=this.kj("message"),Yb=document.createElement("span"),O=document.createElement("span"),Nb=this.C3a.split("{0}"),Yb.innerText=Nb[0],O.innerText=Nb[1],b.appendChild(Yb),b.appendChild(A),b.appendChild(O),aa.appendChild(b)):
(b=document.createElement("span"),b.innerText=this.C3a,aa.appendChild(b),aa.appendChild(document.createElement("br")),aa.appendChild(document.createElement("br")),aa.appendChild(A),Oh.q8b||Array.add(Ra,"{0}"));this.uw&&aa.appendChild(this.uw);Oh.fL&&(this.Qjb&&(this.NVc?this.nkh(this.Qjb,this.NVc):(Array.add(Ra,"{0}"),Array.add(ub,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.Qjb,["onExecute"]:()=>{}}))),this.pCc(Ra,ub));this.pkb(ua,null,this.cwf,null,Object(z.a)(this,this.vaa,"dialogHandler"),
Oh.fL?null:aa);this.s4(this.kj("message"));!Oh.fL&&this.NVc&&this.Qjb&&(ua=document.createElement("div"),ua.className="WACDialogLearnMoreLinkContainer",this.R1=document.createElement("a"),this.R1.innerText=this.Qjb,this.R1.href=this.NVc,this.R1.target="_blank",this.R1.id=this.kj("LearnMoreLinkId"),this.R1.className=vf.AFrame.pZe,ua.appendChild(this.R1),h?this.Kc.insertBefore(ua,this.Kc.lastChild):this.Kc.appendChild(ua),this.s4(String.format("{0} {1}",this.kj("message"),this.kj("LearnMoreLinkId"))));
this.Sqc=A;t?this.l0(this.GG):this.l0(this.Sqc);this.OHf();v.AFrameworkApplication.ta.B0.mb(db.a.click,this.Sqc,Object(z.a)(this,this.hQh,"downloadLinkClicked"),null);this.R1&&v.AFrameworkApplication.ta.B0.mb(db.a.click,this.R1,Object(z.a)(this,this.iBi,"learnMoreLinkClicked"),null);this.xV=!1}get cwf(){return null}get egg(){return null}get C3a(){return null}get NVc(){return null}get Qjb(){return null}get SHi(){return!1}get buttonText(){return CommonUIStrings.l_Open}get uHc(){return null}get Hyd(){return null}get Bnh(){return null}get vWd(){return!1}get GWd(){return!1}t8e(){}iRh(){}hla(){this.uw&&
(this.WTb||(this.WTb=Object(z.a)(this,this.udn,"onActionButtonClicked"),this.Bq.mb(db.a.click,this.GG,this.WTb)),this.XTb||(this.XTb=Object(z.a)(this,this.vdn,"onActionButtonKeyUp"),this.$d.mb(db.a.sh,this.GG,this.XTb)));super.hla()}udn(b){this.JTh(b);return!0}vdn(b){return this.kVc(b,Object(z.a)(this,this.JTh,"executeDismissActionButtonFromArgs"))}JTh(b){this.uw&&this.uw.submit();this.MBb(b.zf)}zWc(){}hQh(){this.PHf();this.uw?this.uw.submit():this.dxe.YOh();return!0}iBi(){return!1}dispose(){this.dxe.dispose();
this.Sqc&&(v.AFrameworkApplication.ta.B0.sc(db.a.click,this.Sqc,Object(z.a)(this,this.hQh,"downloadLinkClicked")),this.Sqc=null);this.R1&&(v.AFrameworkApplication.ta.B0.sc(db.a.click,this.R1,Object(z.a)(this,this.iBi,"learnMoreLinkClicked")),this.R1=null);this.Bq&&this.WTb&&(this.Bq.sc(db.a.click,this.GG,this.WTb),this.WTb=null);this.$d&&this.XTb&&(this.$d.sc(db.a.sh,this.GG,this.XTb),this.XTb=null);super.dispose()}y0i(){this.uw&&(document.body.appendChild(this.uw),this.uw.submit(),document.body.removeChild(this.uw))}vaa(b){1===
b?(this.zWc(),this.uw?Oh.fL&&this.y0i():this.dxe.YOh()):2===b&&(this.vWd?this.t8e():this.GWd&&this.iRh());this.dispose()}static get fL(){return v.AFrameworkApplication.ta.Ob.VE&&v.AFrameworkApplication.ta.Ob.rwi}static get q8b(){return Oh.NUg}static set q8b(b){Oh.NUg=b}}Oh.NUg=!1;Object(m.a)(Oh,"ADialogWithLinkToResource",cf.StandardDialog,[]);class Yg extends Oh{constructor(b,h,t=null,A=!0,O=!1){super(b,!0,!(Yg.qpb&&A),new Gi(b,h),t,O);Yg.qpb=Yg.qpb&&A;if(Yg.qpb){h=document.createElement("iframe");
A=null;O=this.xNh;h.name="pdfObjectFrame";h.id="pdfObjectIFrame";if(t&&0<t.count){const aa=ia.a.uqf(b,t);b=ia.a.k2f(b,t);A=document.createElement("form");A.id="printPreviewPostForm";A.method="POST";A.target=h.name;A.action=b;for(let ua of aa)b=document.createElement("input"),b.type="hidden",b.name=ua.key,b.value=ua.value,A.appendChild(b)}else h.src=b;O.appendChild(h);A&&(O.appendChild(A),A.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");Mf.a.Uq(h,Mf.a.Lz,Mf.a.gp)}}get cwf(){return"Print_32x32x32"}get egg(){return Yg.qpb?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get C3a(){return Yg.qpb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get Hyd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Oh.q8b){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==v.AFrameworkApplication.ta.Ob.GKh&&(h=v.AFrameworkApplication.ta.Ob.GKh);Array.add(b,h)}return Yg.qpb?b:null}get Bbc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get gWc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get uHc(){return v.AFrameworkApplication.XZa?
"UIFontDialogTextLarge":null}OHf(){u.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}PHf(){v.AFrameworkApplication.Om.t1a(9540);u.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}zWc(){u.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get qpb(){return!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.VE&&v.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(ba.a.u3||ba.a.jt||ba.a.jj||ba.a.oba)&&!v.AFrameworkApplication.RUc&&
v.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set qpb(b){}}Object(m.a)(Yg,"PrintDialogWithLinkToPdf",Oh,[]);class xi{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.ZHm=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.GEm=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.pOb=(b.DirectPrintSupportedMimeTypes||"").split(xi.ycf);this.mob=(b.DirectPrintSupportedPlugins||"").split(xi.ycf);this.Hnm=(b.DirectPrintImmersivePreviewPlugins||
"").split(xi.ycf);this.nsi=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.Uym=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.$Pk=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.HKf=14;this.eIi=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.HKf=parseInt(h[0]),this.eIi=parseInt(h[1])):u.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else u.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}xi.ycf=",";Object(m.a)(xi,"DirectPrintBrsSettings",null,[]);class Dj{constructor(b,h){this.Pdg=b;this.mob=h}}Object(m.a)(Dj,"DirectPrintProbeResults",null,[]);class Ml{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb){this.qwd=null;this.dVj=b;this.owc=h;this.GIe=t;this.y1j=A;this.C2j=O;this.iyc=new Pg.a(Object(z.a)(this,this.G1l,"getProbeResults"));this.uqc=aa;this.g1g=ub;this.bW=ua;this.ruc=Ra;this.V2j=Nb}get dQ(){return this.dVj}start(){}TAn(){this.dQ.ZHm&&
this.G_m()}GFn(){const b=Array(this.dQ.pOb.length);if(void 0!==this.owc&&null!==this.owc)for(let h=0;h<this.dQ.pOb.length;h++)b[h]=this.dQ.pOb[h]in this.owc&&this.y1j(this.owc[this.dQ.pOb[h]]);return b}HFn(){const b=Array(this.dQ.mob.length),h=!(void 0===this.GIe||null===this.GIe);for(let t=0;t<this.dQ.mob.length;t++){const A=this.dQ.mob[t];b[t]=h&&A in this.GIe?!0:this.C2j(A)}return b}m7l(){const b=this.GFn(),h=Array(b.length);for(let t=0;t<b.length;t++)h[t]=b[t]?this.Irl(this.owc[this.dQ.pOb[t]]):
null;return h}Irl(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}G_m(){u.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.iyc.value.Pdg,this.iyc.value.mob)}G1l(){var b=this.m7l();const h=this.HFn(),t={},A={};for(let O=0;O<this.dQ.pOb.length;O++)t[this.dQ.pOb[O]]=b[O];for(b=0;b<this.dQ.mob.length;b++)A[this.dQ.mob[b]]=h[b];return new Dj(t,A)}wno(){return this.V2j||!this.dQ.isEnabled||v.AFrameworkApplication.RUc?!1:this.uxo()}Cno(){if(null!=
this.qwd)return this.qwd;const b=Ml.msi(this.dQ);return this.qwd=this.dQ.nsi&&b||this.Tym()}Tym(){return ba.a.qq&&this.dQ.Uym&&ba.a.ZPk>=this.dQ.$Pk?!0:!1}uxo(){if(!this.ruc(this.dQ))return!1;var b=ob.a.mRd(this.iyc.value.Pdg);for(const h of b)if(void 0!==h&&null!==h)return!0;b=ob.a.mRd(this.iyc.value.mob);for(const h of b)if(h)return!0;return!1}iim(){const b=ob.a.mRd(this.iyc.value.Pdg);for(const h of b)if(gl.a.contains(this.dQ.Hnm,h))return!0;return!1}Spo(b,h=null){v.AFrameworkApplication.ta&&v.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?
this.g1g(b,h):this.wno()?this.qhl(b,this.iim()&&!0,h):this.g1g(b,h)}qhl(b,h,t=null){const A=this.bW.eg("UserAction","OpenDirectPrintDialog");this.uqc.LMl(b,h,t).dDa();A.stop()}static HKm(b){try{return new ActiveXObject(b),!0}catch(h){u.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static LBm(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=new xi(v.AFrameworkApplication.K.appSettings);let t=
null;try{t=window.navigator.mimeTypes}catch(Nb){u.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let A=null;try{A=window.navigator.plugins}catch(Nb){u.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const O=Ml.LBm,aa=Ml.HKm;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const ua=v.AFrameworkApplication.ta.xq,Ra=Ml.JKm,ub=!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.VE&&!v.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");
return new Ml(h,t,A,O,aa,b,ua,Ra,(Nb,Yb)=>new Yg(Nb,!1,Yb,!0,ub),v.AFrameworkApplication.qga)}static JKm(b){return ba.a.qq||ba.a.jt&&b.GEm||b.nsi&&Ml.msi(b)?!0:!1}static msi(b){var h=ba.a.j4b;if(h){var t=h.split(".");if(2===t.length)return h=parseInt(t[0]),t=parseInt(t[1]),h>b.HKf||h===b.HKf&&t>=b.eIi}return!1}}Object(m.a)(Ml,"DirectPrintManager",null,[710]);class Kn{constructor(){this.Frb=this.W=null}get name(){return"Common.App.DirectPrint"}yc(b){this.W=b;b.register(id,"Common.App.DirectPrint.DirectPrintDialogFactory").singleInstance().Qd(()=>
new id(v.AFrameworkApplication.ta.B0));b.register(710,"Common.App.DirectPrint.IDirectPrintManager").singleInstance().Qd(()=>Ml.create(this.W))}init(){this.Frb=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.Frb.start()}dispose(){}}Object(m.a)(Kn,"PackageManager",null,[1,2]);class Kj{constructor(b,h=3E4){this.ugg=9E5;this.wgg=1E4;this.jFi=this.$bc=null;this.WIf=0;this.Feb=Date.now;this.cRd=b;this.oTa=h;this.nMd()}tei(b=!0){const h=this.Feb();if(h<this.WIf+this.ugg)return h>this.WIf+
this.wgg&&this.nMd(),this.jFi;b&&this.nMd();return null}getToken(b=!0){return(b=this.tei(b))?Promise.resolve(b):this.nMd()}nMd(){return this.$bc=this.$bc||new Promise(b=>{this.cRd().then(h=>{this.$bc=null;""!==h&&h&&(this.jFi=h,this.WIf=this.Feb(),b(h));b(null)}).catch(()=>{this.$bc=null;b(null)});window.setTimeout(()=>{this.$bc=null;b(null)},this.oTa)})}}Object(m.a)(Kj,"OAuthCacheManager",null,[]);class Rj{static Uua(b){return""!==b&&b?Rj.awk[b.toLowerCase()]:""}static o9l(b,h){const t=Date.now();
var A=Rj.hYk();const O=v.AFrameworkApplication.K.kb("UserPrincipalName"),aa=Rj.Uua(b);u.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+b);if(""===O||!O)return u.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===aa||!aa)return u.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+b),Promise.resolve("");const ua=Ya.a.create().toString();A=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none",
"https://login.microsoftonline.com",aa,encodeURIComponent(h),encodeURIComponent(O),encodeURIComponent(A),ua);const Ra=document.createElement("iframe");Ra.style.display="none";Ra.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");Ra.src=A;document.body.appendChild(Ra);return new Promise(ub=>{Rj.T8m(Ra.contentWindow).then(Nb=>{document.body.removeChild(Ra);const Yb=new xb.a,bc=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Dc;for(;Dc=bc.exec(Nb);)3!==Dc.length&&(u.ULS.sendTraceTag(593862983,
1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",Dc.length),ub("")),Yb.Z(Dc[1],Dc[2]);Yb.ob("access_token")?(u.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",h,b,Date.now()-t),ub(Yb.J("access_token"))):(u.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",h,b,(Date.now()-t).toString()),ub(""))}).catch(Nb=>{try{document.body.removeChild(Ra)}catch(Yb){}u.ULS.sendTraceTag(593862980,
1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",h,b,JSON.stringify(Nb),(Date.now()-t).toString());ub("")})})}static hYk(){const b=window.location.protocol,h=window.location.host;var t=v.AFrameworkApplication.K.kb("OAuthManagerHostPathOverride");if(void 0===t||null===t){t=window.location.pathname;const A=t.lastIndexOf("/");t=0<=A?t.substring(0,A+1):""}return b+"//"+h+t+"WacOAuth.html"}static T8m(b){return new Promise((h,t)=>{let A=0,O=0;O=window.setInterval(()=>
{if(200<A++)window.clearInterval(O),t("Exceeded 10000ms timeout after 200 polls");else{var aa=null,ua=null;try{if(!b||b.closed){window.clearInterval(O);t("Window or Frame is closed before completion");return}aa=b.location.href;ua=b.location.hash}catch(Ra){}aa&&"about:blank"!==aa&&ua&&""!==ua&&(window.clearInterval(O),h(ua))}},50)})}}Rj.awk={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(m.a)(Rj,"OAuthHelper",null,[]);class Ul{constructor(b,
h){this.token=b;this.source=h}}Object(m.a)(Ul,"TokenResult",null,[]);var uh=c(93),yk=c(250);class Bi{constructor(){this.z8=null;this.uQg={};this.tokenCache=new Ba.a(Pa.a.Xh())}getToken(b,h,t=!1){if(this.tokenCache.ob(h))return this.tokenCache.J(h).getToken();const A=new Kj(()=>t?this.uei(b,h):this.cRd(b,h));this.tokenCache.Z(h,A);return A.getToken()}l9l(b,h,t=!1){if(this.tokenCache.ob(h))return this.tokenCache.J(h).tei();const A=new Kj(()=>t?this.uei(b,h):this.cRd(b,h));this.tokenCache.Z(h,A);return null}cRd(b,
h){const t=Date.now();return Rj.o9l(b,h).then(A=>new Ul(A,"SSOStack")).then(A=>new Promise(O=>{A.token&&""!==A.token?(u.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",b,A.source,Date.now()-t),this.bnb("GetTokenInternal",!0,Date.now()-t,b,"","",h),O(A.token)):(u.ULS.sendTraceTag(593862978,1300,50,"{0}: SSO Token provider failed! Latency: {1}",b,Date.now()-t),this.bnb("GetTokenInternal",!1,Date.now()-t,b,"GetTokenSilent Failed","SSO Token provider failed!",h),O(""))}))}uei(b,
h){if(!this.z8)try{this.z8=Sa.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(t){u.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+t)}return this.z8?new Promise(t=>{const A=Date.now();this.z8.T4(b,h).then(O=>{const aa=O.Token;!O.IsSuccess||this.JLm(aa)?(this.bnb("GetTokenInternalImplicitJS",!1,Date.now()-A,b,O.ErrorCode,O.ErrorMessage,h),t(null)):(this.bnb("GetTokenInternalImplicitJS",!0,Date.now()-A,b,O.ErrorCode,O.ErrorMessage,h),t(aa))}).catch(O=>{O=O?E.c(O):"";
this.bnb("GetTokenInternalImplicitJS",!1,Date.now()-A,b,"Caught Exception",O,h);t(null)})}):new Promise(t=>{this.bnb("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");t(null)})}bnb(b,h,t,A,O="",aa="",ua=""){var Ra="Search"===A;const ub=[];b=uh.a.Nfa(Ra?"Event":"EventName",b,2);A=uh.a.Nfa("AppName",A,2);Array.add(ub,b);Array.add(ub,A);Ra&&(A=uh.a.Nfa("LatencyType","FetchToken",2),Array.add(ub,A));O&&""!==O&&(O=uh.a.Nfa("ErrorCode",O,2),Array.add(ub,O));aa&&""!==aa&&(aa=
uh.a.Nfa("ErrorMessage",aa,2),Array.add(ub,aa));ua&&""!==ua&&(aa=!(ua in this.uQg),this.uQg[ua]=aa,aa=uh.a.Nfa("WarmUpCall",aa.toString(),1),Array.add(ub,aa),ua=uh.a.Nfa("Service",this.r5l(ua),2),Array.add(ub,ua));Ra=Ra?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";h=Object.assign(new yk.a,{name:Ra,samplingPolicy:2,dataFields:ub,succeeded:h,durationMs:t});ja.a.sendActivityEvent(h)}r5l(b){return b===v.AFrameworkApplication.HIf?"Loki":b===v.AFrameworkApplication.Idg?
"Substrate":v.AFrameworkApplication.K&&b===v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}JLm(b){return!b||!b.length}}Object(m.a)(Bi,"SearchOAuthManager",null,[669]);class yf{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}yc(b){this.W=b;this.W.register(669,"Common.App.SearchCommon.ISearchOAuthManager").singleInstance().Qd(()=>new Bi)}init(){}dispose(){}static main(){P.a.instance.Gc(new yf)}}Object(m.a)(yf,"SearchOAuthPackage",null,
[1,2]);var Uh=c(231),ue=c(5),Be=c(20),nf=c(19),qe=c(10);class Sj{constructor(b,h,t){this.yJe=this.Tvb=this.vJe=this.Svb=this.jGe=null;this.Fem=A=>{try{this.Eem(A)}catch(O){A=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",O.message,O.stack),u.ULS.sendTraceTag(5285580,334,10,A)}};this.Mp=b;this.SVj=h;this.ib=t;this.init()}init(){this.SVj.mb(this.Fem);this.Svb=new Tc.a;this.vJe=new Tc.a;this.Tvb=new Tc.a;this.yJe=new Uh.a}g4(b){this.Svb.add(b.key,
b)}Ufc(b){this.Tvb.add(b.key,b)}Eem(b){let h;const t=this.ib.hb.lb;({daf:h}=Sj.oHo(t)).returnValue&&(b=Sj.nKl(b,this.jGe,h),this.lBn(b,h,t),this.jGe=h)}lBn(b,h,t){b=this.VDl(b,h,t);let A;({notification:A}=Sj.fHo(b)).returnValue&&this.Mp.sendNotification(A,!1)}VDl(b,h,t){const A=new Tc.a;A.Z(1,new Uh.a);A.Z(0,new Uh.a);b.forEach(O=>{3===O?(Sj.fag(h.node)||this.sZn(h,t),this.t_l(A,h)):O||this.LKl(A,h);return!0});return A}sZn(b,h){this.Svb.forEach((t,A)=>{A.reset(b,h);return!0})}LKl(b,h){let t=new Tc.a;
Sj.fag(h.node)||(t=this.JKl(h.cpBegin));this.KKl(b,this.vJe,t,Sj.kcj(this.jGe,h));this.vJe=t}JKl(b){const h=new Tc.a;this.Svb.forEach((t,A)=>{t=null;({xF:t}=A.YHa(b)).returnValue&&h.Z(A.key,t);return!0});return h}KKl(b,h,t,A){const O=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((aa,ua)=>{const Ra=this.Svb.J(aa).zw||ua.title;let ub;({value:ub}=t.Ec(aa)).returnValue?A&&ub.contentObject!==ua.contentObject&&(Ra&&b.J(1).add(Ra),aa=this.Svb.J(aa).zw,aa=String.format(O,ub.title,aa),ub.description&&
(aa+=", "+ub.description),b.J(0).add(aa)):Ra&&b.J(1).add(Ra);return!0});t.forEach((aa,ua)=>{h.ob(aa)||(aa=this.Svb.J(aa).zw,aa=String.format(O,ua.title,aa),ua.description&&(aa+=", "+ua.description),b.J(0).add(aa));return!0})}t_l(b,h){h=this.F6l(h.node);h=this.FTk(h);this.G6l(b,this.yJe,h);this.yJe=h}F6l(b){const h=new ue.GraphIterator;h.set(b);if(!h.Ab(1))return null;const t=new Uh.a;for(;1!==h.Xe;)this.Tvb.forEach((A,O)=>{let aa;({Fla:aa}=O.Vkc(h)).returnValue&&t.add(aa);return!0}),h.wc();t.reverse();
return t}FTk(b){b=b.toArray();let h=0;for(;h<b.length-1;){var t=b[h];if(t.rG===b[h+1].rG&&(this.Tvb.J(t.rG),({ITk:t}={returnValue:!1,ITk:null}).returnValue)){b.splice(h,2,t);continue}h++}return new Uh.a(b)}G6l(b,h,t){var A;for(A=0;A<Math.min(t.length,h.length)&&t.J(A).contentId.equals(h.J(A).contentId);A++){var O=this.Tvb.J(t.J(A).rG).VCb(t.J(A),h.J(A));O&&(t.J(A).description&&(O+=", "+t.J(A).description),b.J(0).add(O))}for(O=A;O<t.length;O++){let aa=this.Tvb.J(t.J(O).rG).VCb(t.J(O),null);aa&&(t.J(O).description&&
(aa+=", "+t.J(O).description),b.J(0).add(aa))}for(t=A;t<h.length;t++)(A=this.Tvb.J(h.J(t).rG).zw)&&b.J(1).add(A)}static nKl(b,h,t){const A=new Uh.a;(b=b||Sj.G6n(h,t))?(A.add(3),A.add(0)):Sj.kcj(h,t)&&A.add(0);return A}static G6n(b,h){return!b||!b.node.id.equals(h.node.id)}static kcj(b,h){return!b||!b.equals(h)}static oHo(b){let h=null;if(!b||!(nf.SelectionEditor.hm(b)||(b=nf.SelectionEditor.Bj(b,!0,!1),nf.SelectionEditor.hm(b)||b.Qa&&Sj.fag(b.Qa.node))))return{returnValue:!1,daf:h};h=b.Qa;return{returnValue:!!h,
daf:h}}static fHo(b){const h=new Uh.a;b.J(1).forEach(t=>{t=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,t);h.add(t);return!0});b.J(0).forEach(t=>{t=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,t);h.add(t);return!0});b=h.toArray().join(" ");return{returnValue:0<h.length,notification:b}}static fag(b){return Be.ImageReader.Wu(b)||qe.ParagraphReader.Kta(b)}}Object(m.a)(Sj,"AccessibilityContextManager",null,[666]);class on{constructor(b,h){this.oZg=
!1;this.szc=null;this.Gsd=this.gwd=!1;this.RPg=null;this.Nyd=(t,A)=>{(A.zR||A.Bpa)&&this.Jbn(A.zR,A.Bpa)};this.Gb=b;this.YM=h}get bjm(){return!!this.szc}mb(b){this.oZg||(this.YM.smh(this.Nyd),this.oZg=!0);this.RPg=b}Jbn(b,h){this.bjm&&this.Gb.Se(this.szc);this.gwd=this.gwd||b;this.Gsd=this.Gsd||h;this.szc=new Vb.a(5,1,on.Lpl,()=>{this.RPg(this.gwd,this.Gsd);this.reset()},126);this.Gb.Wb(this.szc)}reset(){this.szc=null;this.Gsd=this.gwd=!1}}on.Lpl=100;Object(m.a)(on,"EditingViewOnAfterValidateEventsConsolidator",
null,[665]);var he=c(52);class vh{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){Jb.App.rrh&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}yc(b){this.W=b;b.ha("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new on(v.AFrameworkApplication.oc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").singleInstance();b.ha("Box4.Accessibility.AccessibilityContextManager",
()=>new Sj(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),he.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").singleInstance()}static main(){P.a.instance.Gc(new vh)}}Object(m.a)(vh,"Box4AccessibilityPackage",null,[1,2]);var zk=c(133),bp=c(1048),ll=c(1629),Ej=c(896),Ok=c(171),sj=c(1517),Te=c(47),wf=c(24),Ge=c(135),pf=c(31);class mm extends sj.a{get Qva(){return null!=this.pzg?this.pzg:this.pzg=Sa.a.instance.Ma("Box4.IInternalLinkManager")}get UWi(){return null!=
this.oCg?this.oCg:this.oCg=Sa.a.instance.Ma("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get vC(){return!0}get commandId(){return qa.a.qBk}$la(b){Ok.a.mark(7012);const h=new Te.GraphTransaction(15);h.Eb(b);var t=this.kG,A=this.I_,O=qe.ParagraphReader.text(b),aa=O.substring(t,A);const ua=({eYc:Ra}=F.a.rdg(aa)).returnValue;aa!==ua&&(t+=Ra,A=t+ua.length);aa=pf.a.createTextRange(b,t,A);var Ra=O.substring(t,A);mm.zEm(O,t,A)&&(this.Jd.replaceTextRange(pf.a.createTextRange(b,t-1,A+1),Ra,!0,!1),
--t,--A,aa=pf.a.createTextRange(b,t,A),t=wf.SelectionFactory.te(b,A),he.a.instance.setSelection(t));t=Ge.HyperlinkReader.DOa(Ra);mm.hyperlinkEditor.jH(aa,t,!1);O=Ra="";A=!1;this.Qva&&({D1f:Ra,wCb:O}=this.Qva.ohg(t)).returnValue&&(t=Ra,A=!0,Ra=Ge.HyperlinkReader.rD(aa,!1),mm.hyperlinkEditor.iR(Ra[0].paragraph,Ra[0].hyperlink),""!==O&&(this.Jd.replaceTextRange(aa,O,!0,!1),aa=pf.a.createTextRange(b,this.kG,this.kG+O.length),b=wf.SelectionFactory.te(b,this.kG+this.kG+O.length),he.a.instance.setSelection(b)),
mm.hyperlinkEditor.jH(aa,t,!1));h.dispose();!A&&this.UWi&&this.UWi.gyn(aa,t);Ok.a.mark(7013)}set vC(b){super.vC=b}static get hyperlinkEditor(){return null!=mm.oxg?mm.oxg:mm.oxg=Sa.a.instance.resolve("Box4.IHyperlinkEditor")}static zEm(b,h,t){t=t!==b.length&&('"'===b.charAt(t)||"\u201d"===b.charAt(t));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&t}}Object(m.a)(mm,"HyperlinkAction",sj.a,[]);class Bo{constructor(b){this.Jd=b}c4k(b,h,t){return new mm(null,b,h,t,this.Jd)}}Object(m.a)(Bo,
"HyperlinkActionFactory",null,[660]);var rl=c(249);class cp{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}yc(b){this.W=b;b.ha("Box4.AutoCorrect.AutoCorrectRules",()=>new ll.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),rl.a.instance,v.AFrameworkApplication.xa,v.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectOptionsInfo",
()=>new bp.a(b.resolve("Box4.IRoamingServiceRequestManager"),v.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectScheduler",()=>new Ej.a(b.resolve("Box4.IAutoCorrectRules"),he.a.instance,zk.a.instance,v.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").singleInstance();
b.ha("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new Bo(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").singleInstance()}init(){this.W.resolve("Box4.IAutoCorrectRules").BSm();const b=v.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").zFl()}dispose(){}static main(){P.a.instance.Gc(new cp)}}Object(m.a)(cp,"Box4AutoCorrectPackage",null,[1,2]);class Co{get name(){return"Box4.Clipboard"}init(){}dispose(){}yc(){}static main(){P.a.instance.Gc(new Co)}}
Object(m.a)(Co,"Box4ClipboardPackage",null,[1,2]);class Zm{get name(){return"Box4.ImageEditors"}yc(){}init(){}dispose(){}static main(){P.a.instance.Gc(new Zm)}}Object(m.a)(Zm,"Box4ImageEditorsPackage",null,[1,2]);class Jq{$jj(){return{Zjj:!0,eEj:!1}}}Object(m.a)(Jq,"CursorMovementValidator",null,[663]);class dp{xYi(b,h,t,A,O,aa){return b?v.AFrameworkApplication.xa.Nf(b,h,t,!0,O,aa):8}}Object(m.a)(dp,"ListContextManager",null,[664]);class vb{get name(){return"Box4.ListEditors"}yc(b){b.ha("Box4.ListEditors.CursorMovementValidator",
()=>new Jq).as("Box4.List.ICursorMovementValidator").singleInstance();b.ha("Box4.ListEditors.ListContextManager",()=>new dp).as("Box4.ListEditors.IListContextManager")}init(){}dispose(){}static main(){P.a.instance.Gc(new vb)}}Object(m.a)(vb,"Box4ListEditorsPackage",null,[1,2]);var Fc=c(638),rd=c(878),De=c(612),kf=c(829),Ef=c(1148);class Se{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,h,t,A,O){const aa=new Se;aa.DocumentId=O;aa.UserId=t;aa.WACSessionId=A;aa.Revision=b;aa.ChangeStateList=
Ef.a.ddj(h);return aa}}Object(m.a)(Se,"LocalUnsavedChange",null,[]);class ad{constructor(){this.G0d=null}Xle(b){return new Promise((h,t)=>{this.eHh().then(A=>{const O=A.transaction(ad.tWc,"readwrite");O.objectStore(ad.tWc).put(b);O.oncomplete=()=>h();O.onerror=()=>t(O.error.message)}).catch(t)})}DCd(b,h,t){return new Promise((A,O)=>{this.eHh().then(aa=>{const ua=aa.transaction(ad.tWc,"readwrite");ua.objectStore(ad.tWc).delete([b,h,t]);ua.oncomplete=()=>A();ua.onerror=()=>O(ua.error.message)}).catch(O)})}static isSupported(){return"indexedDB"in
window}eHh(){return new Promise((b,h)=>{if(ad.isSupported())if(this.G0d)b(this.G0d);else{var t=window.indexedDB.open(ad.wVm,ad.xVm);t.onsuccess=()=>{this.G0d=t.result;b(t.result)};t.onerror=()=>{h(t.error.message)};t.onupgradeneeded=()=>{const A=t.result,O=A.createObjectStore(ad.tWc,{keyPath:["DocumentId","UserId","WACSessionId"]});O.createIndex("DocumentId, UserId",["DocumentId","UserId"],{unique:!1});O.createIndex("UserId",["UserId"],{unique:!1});this.G0d=A;b(A)}}else h("This browser does not support IndexedDB.")})}}
ad.wVm="LocalUnsavedChangeDatabase";ad.xVm=1;ad.tWc="LocalUnsavedChange";Object(m.a)(ad,"LocalUnsavedChangeStore",null,[]);class Xg{constructor(b,h,t,A,O,aa){this.HCi=b;this.Ece=h;this.u9h=t;this.dOd=A;this.DNk=O;this.Mxa=aa}initialize(){const b=rd.a.hrf(this.u9h());this.cGd=this.xHc=b;this.Mxa.rrk(this.CQi.bind(this));this.Mxa.srk(this.DQi.bind(this))}dispose(){this.Mxa.qVn(this.CQi.bind(this));this.Mxa.rVn(this.DQi.bind(this))}CQi(b,h){this.ZOo(h.iSa)}DQi(b,h){this.LLo(h.iSa)}LLo(b){b.equals(this.xHc)||
(this.xHc=b,b.equals(this.cGd)?this.DCd():this.Xle())}ZOo(b){b.equals(this.cGd)||(this.cGd=b,b.equals(this.xHc)?this.DCd():this.Xle())}W4k(){const b=new kf.a(this.cGd,this.xHc,this.u9h(),this.dOd().Fs,this.dOd().umb,this.dOd().contextId,this.xHc.id,this.Ece,De.FolderReader.dGb(this.dOd()),!1);return Se.construct(b,this.DNk.EMc(),Xg.userId,Xg.sessionId,Xg.documentId)}Xle(){const b=this.W4k();this.HCi.Xle(b).then(()=>{u.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",
b.Revision.Id)}).catch(h=>{u.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",h)})}DCd(){this.HCi.DCd(Xg.documentId,Xg.userId,Xg.sessionId).then(()=>{u.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{u.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",b)})}static isSupported(){return ad.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=
Xg.wug?Xg.wug:Xg.wug=v.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=Xg.KFg?Xg.KFg:Xg.KFg=v.AFrameworkApplication.K.kb("LoggableUserId")}static get sessionId(){return null!=Xg.TCg?Xg.TCg:Xg.TCg=v.AFrameworkApplication.K.kb("SessionId")}}Object(m.a)(Xg,"LocalUnsavedChangeManager",null,[638]);class Zg{get name(){return"Box4.LocalUnsavedChange"}init(){this.Vri()&&Xg.isSupported()&&(this.AHf=this.container.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeManager"),
this.AHf.initialize())}dispose(){this.AHf&&this.AHf.dispose()}yc(b){this.container=b;if(this.Vri()){b.ha("Box4.LocalUnsavedChange.LocalUnsavedChangeStore",()=>new ad).singleInstance();var h=(t,A,O)=>new Fc.a(t,A,O);b.ha("Box4.LocalUnsavedChange.LocalUnsavedChangeManager",()=>new Xg(b.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeStore"),h,()=>Jb.App.ya.jb.Wc.ud,()=>Jb.App.ya.jb.Wc,b.resolve("Box4.CatchUpActivity.IChangeStateManager"),b.resolve("Box4.Revision.RevisionSequenceNumberManager"))).singleInstance()}}static main(){P.a.instance.Gc(new Zg)}Vri(){return v.AFrameworkApplication.K.$("DisconnectedScenarioIsEnabled")}}
Object(m.a)(Zg,"LocalUnsavedChangePackage",null,[1,2]);class Mg{get name(){return"Box4.NotebookLevelEditors"}yc(){}init(){}dispose(){}static main(){P.a.instance.Gc(new Mg)}}Object(m.a)(Mg,"Box4NotebookLevelEditorsPackage",null,[1,2]);var Si=c(1529),ii=c(26),Hh=c(143),Ui=c(782),mc=c(14);const ml=(b,h,t,A,O)=>{if(h.contextId===mc.a.view)switch(b){case qa.a.search:return ii.Debug.Hrh(509109570),Jb.App.LM.Sfj(),32;case qa.a.findOnPage:return 1!==t&&(ii.Debug.Hrh(509109571),Jb.App.LM.$8f()),32;case qa.a.t8i:return Jb.App.ya.jb.xc&&
Jb.App.ya.jb.xc.Yi?(1!==t&&(Ui.a.HMb?Jb.App.LM.WZn():Jb.App.LM.$8f()),b=32):b=8,b;case qa.a.nzb:case qa.a.xxh:return 1===t?b=Ui.a.HMb?32:8:(Jb.App.LM.WZn(),b=32),b;case qa.a.r9d:return 1!==t&&Jb.App.LM.ARd(),32;case qa.a.VXi:return(b=ff.a.dOa(document.body.ownerDocument))&&b.id===Hh.AppFrame.qbj&&Jb.App.LM.ARd(),32;case qa.a.L3d:return 1!==t&&Jb.App.LM.zRd(),32;case qa.a.mKi:return(b=ff.a.dOa(document.body.ownerDocument))&&b.id===Hh.AppFrame.qbj&&Jb.App.LM.zRd(),32;case qa.a.Vej:return Jb.App.LM.Pep(),
32;case qa.a.N3c:return Jb.App.LM.N3c(),32;case qa.a.Tvf:return 1!==t&&"string"===typeof O&&Jb.App.LM.Tvf(O),32;case qa.a.$aj:return 1!==t&&Jb.App.LM.$8f(),32;case qa.a.abj:return 1!==t&&Jb.App.LM.Sfj(),32;case qa.a.njh:return Jb.App.LM.s$o(),32;case qa.a.sbj:return Jb.App.LM.Sfj(),"string"===typeof O&&(Jb.App.LM.iEn(O),Ui.a.HMb=!0),32;case qa.a.KKd:return Jb.App.LM.$8f(),"string"===typeof O&&(Jb.App.LM.iEn(O),Ui.a.HMb=!0),32}return 2};class hl{get name(){return"Box4.Search"}yc(b){b.ha("Box4.Search.FindManagerHelper",
()=>Si.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").singleInstance()}init(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableSearchActor",!1)||bb.a.i2c(ml)}dispose(){}}Object(m.a)(hl,"PackageManager",null,[1,2]);class Kd{get name(){return"Box4.TableEditors"}yc(){}init(){}dispose(){}static main(){P.a.instance.Gc(new Kd)}}Object(m.a)(Kd,"Box4TableEditorsPackage",null,[1,2]);class Vi{get name(){return"Box4.TextLevelEditors"}yc(){}init(){}dispose(){}static main(){P.a.instance.Gc(new Vi)}}
Object(m.a)(Vi,"Box4TextLevelEditorsPackage",null,[1,2]);var ph=c(106),ji=c(381),Gd=c(108),sn=c(634),fk=c(1542);class me{constructor(b,h,t){this.Iv=this.IJa=this.ULa=null;this.UD=this.vve=this.ZIa=0;this.Tja=this.Okd=this.pVa=this.oVa=!1;this.Bjd=this.OVg=this.RVg=0;this.dAa=b;this.ga=h;this.Um=t}sO(b){return!Jb.App.ya.jb.isEditingAllowed||fc.SessionStatusManager.instance.xj?!1:""!==this.fNc(b.zf)}PK(b){if(!this.sO(b))return!1;this.jco(b);this.UD=this.dAa.k6b();this.bfo(b);this.cfo();({t$b:this.Okd,
Oac:this.Tja}=this.wgj(this.vve));this.dfo();this.ULa=b.IH;this.Iv=new Sys.UI.Point(0,0);[this.RVg,this.OVg]=this.dAa.getDimensions();u.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}rU(b){this.IJa=b.IH;this.lJk();this.Bjd=fk.b(this.Iv.x,this.Iv.y,this.RVg,this.OVg,this.Okd,this.Tja,this.Bjd,v.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));this.dAa.yjg(this.Bjd,this.Okd,this.Tja);return!0}ED(){this.setSize();u.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}fY(){this.dAa.q4f();
u.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}jco(b){this.dAa=ph.a.Db(b.zf,sn.a)}cfo(){this.vve=(Math.floor((this.UD+22)/45)%8+this.ZIa)%8}wgj(b){let h,t;if(this.UD&&90!==this.UD&&180!==this.UD&&270!==this.UD&&360!==this.UD||this.DEm(b))return{t$b:!0,Oac:!0};h=t=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:t=!0}return{t$b:t,Oac:h}}dfo(){this.pVa=this.oVa=!1;switch(this.vve){case 0:this.pVa=this.oVa=!0;break;case 1:case 2:this.pVa=!0;break;case 7:case 6:this.oVa=!0}}DEm(b){return!(b%
2)}fNc(b){var h=b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const t=b[h].toString();if(t.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==t)return t}return""}bfo(b){switch(this.fNc(b.zf)){case "WACImageResizeHandleNW":this.ZIa=0;break;case "WACImageResizeHandleN":this.ZIa=1;break;case "WACImageResizeHandleNE":this.ZIa=2;break;case "WACImageResizeHandleE":this.ZIa=3;break;case "WACImageResizeHandleSE":this.ZIa=
4;break;case "WACImageResizeHandleS":this.ZIa=5;break;case "WACImageResizeHandleSW":this.ZIa=6;break;case "WACImageResizeHandleW":this.ZIa=7}}lJk(){var b=1;this.Um.instance&&(b=this.Um.instance.ij);const h=(this.IJa.x-this.ULa.x)/b;b=(this.IJa.y-this.ULa.y)/b;this.Iv.x=this.oVa?-h:h;this.Iv.y=this.pVa?-b:b}setSize(){const b=new ji.DictionaryPropertySet;b.setValue(Gd.a.JQc,100*this.Bjd);b.setValue(Gd.a.mli,!0);if(90===this.UD||270===this.UD){let h,t;({t$b:h,Oac:t}=this.wgj(this.ZIa));b.setValue(Gd.a.Awf,
h);b.setValue(Gd.a.Bwf,t)}else b.setValue(Gd.a.Awf,this.Okd),b.setValue(Gd.a.Bwf,this.Tja);this.ga.Rb(qa.a.M8b,2,b)}}Object(m.a)(me,"ImageResizeDragAdapter",null,[153]);var Ad=c(138),Wi=c(882);class cm{constructor(b,h,t,A){this.WBe=this.IJa=this.ULa=this.asd=null;this.Yod=this.Owd=0;this.Hb=null;this.ga=b;this.ib=h;this.Um=t;this.u1g=this.QAa=0;this.ed=A}sO(b){return Jb.App.ya.jb.isEditingAllowed&&!fc.SessionStatusManager.instance.xj&&b&&this.dJm(b.zf)?(this.asd=this.ib.pg)?!0:!1:!1}eLd(){}irf(){return null}PK(b){if(!this.sO(b))return!1;
this.dAa=ph.a.Db(b.zf,sn.a);if(!this.dAa)return!1;this.ysd=this.dAa.d9;if(!this.ysd)return!1;this.asd=this.ib.pg;this.Hb=Be.ImageReader.Wm(this.asd);if(!this.Hb)return!1;this.ULa=this.lOa(b);this.WBe=Sys.UI.DomElement.getBounds(this.ysd);this.Owd=0<Be.ImageReader.mOd(this.Hb)?Be.ImageReader.mOd(this.Hb):0;this.Yod=Be.ImageReader.Aof(this.Hb);return!0}rU(b){this.IJa=this.lOa(b);this.tJk();if(this.dAa)return this.dAa.hme(this.QAa,this.u1g),!0;u.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");
return!1}ED(){this.Owd=this.QAa=fk.c(this.QAa);this.w4()}fY(){this.dAa.hme(this.Yod,0)}dJm(b){return b.classList.contains(Wi.c)||b.classList.contains(Wi.b)||b.classList.contains(Wi.a)||!!b.parentElement&&b.parentElement.classList.contains(Wi.a)}lOa(b){return this.ed.vd.X_a(b)}tJk(){var b=1;this.Um&&this.Um.instance&&(b=this.Um.instance.ij);var h=new Sys.UI.Point(this.WBe.x+this.ysd.clientWidth/2*b,this.WBe.y+this.ysd.clientHeight/2*b);b=fk.a(this.ULa,h);h=fk.a(this.IJa,h);this.QAa=Math.round(Ad.a.mGn(h-
b));0<this.Owd&&(this.QAa+=this.Owd-this.Yod);this.u1g=this.QAa;this.QAa+=this.Yod}w4(){const b=new ji.DictionaryPropertySet;b.setValue(Gd.a.GQc,0);b.setValue(Gd.a.WI,this.QAa);this.ga.Rb(qa.a.imageRotate,2,b)}}Object(m.a)(cm,"ImageRotateDragAdapterSimplified",null,[631,153]);class bq{constructor(){this.W=null}get name(){return"Box4.Images"}yc(b){this.W=b;this.W.ha("Box4.Images.ImageResizeDragAdapter",()=>new me(null,v.AFrameworkApplication.xa,Sa.a.instance.Sa("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").singleInstance();
this.W.ha("Box4.Images.ImageRotateDragAdapterUpdated",()=>new cm(v.AFrameworkApplication.xa,he.a.instance,Sa.a.instance.Sa("Common.IZoomManager"),pc.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").singleInstance()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){P.a.instance.Gc(new bq)}}Object(m.a)(bq,"Box4ImagesPackage",null,[1,2]);var Fn=c(294),Jh=c(123),Lc=c(6),Bh=c(692),ag=c(494),
sl=c(583),tn=c(269),Tn=c(277),Un=c(1753),Vh=c(1805),kk=c(1200);class lf extends Vh.a{constructor(b,h,t){super(b,h,t);this.$pd=this.qcb=null}get oR(){return v.AFrameworkApplication.ta.xq}DNd(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}Mme(b){return lf.Nya(b,this.$ei())}$ei(){return lf.JUe}Nya(b,h=null){b=this.Mme(b);return 0!==b?(h&&h.Nxd(),2===b&&(h=this.DNd(b),this.Lp(this.p4h(b),h)),!1):
!0}VNa(b,h){u.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.ETf=h;Ok.a.mark(5576);this.$pd=this.oR.eg("LoadResource","PictureUploadTime");this.ZUd()?this.Xbe(b):this.GZc()}Lp(b,h){const t=new cf.StandardDialog;t.zd=0;t.Sw(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}GZc(){u.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.GZc();this.$pd&&(this.$pd.stop(),this.$pd=null)}b6a(){this.qcb=(new kk.a).create();this.qcb.message=CommonUIStrings.l_ImageUploadWait;
this.qcb.zd=5;this.qcb.ht=!1;this.qcb.YK(null,null,null)}K1b(){this.qcb&&(this.qcb.close(),this.qcb=null)}static qjm(b,h){b=F.a.fh(b);for(let t=0;t<h.length;++t)if(b.endsWith(h[t]))return!0;return!1}static Nya(b,h=null){h||(h=lf.JUe);return b?lf.qjm(b,h)?0:2:1}}lf.JUe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(m.a)(lf,"PictureUploader",Vh.a,[]);var Tg=c(1146),dm;(function(b){b[b.validPicture=0]="validPicture";b[b.noPictureSpecified=1]="noPictureSpecified";b[b.invalidExtension=2]="invalidExtension";
b[b.pictureTooLarge=3]="pictureTooLarge"})(dm||(dm={}));Object(m.b)("PictureValidationResult",dm);var Hc=c(59),Af=c(17),fh=c(43);class Kq{constructor(){this.rT=null}}Object(m.a)(Kq,"ImageData",null,[]);var nm=c(56),ym=c(1754),Do=c(1597),Ak=c(1634);class Yf extends Pf.a{constructor(b,h=!0){super(!1,!1,Yf.fL);this.dXb=null;this.CRg=!1;this.Ox=[];this.hs=null;this.scb=b;this.Qbk=h;this.Z9=this.reh=!1;this.SXa=null;this.Fye=!1;this.Wg=this.ffl;this.sg="InsertFileDialog";this.Ge(1,this.fxd);Yf.fL?(this.dXb=
{["id"]:this.sg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(z.a)(this,this.Mon,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(z.a)(this,this.Shn,"onFrameReady")},this.Yh(this.titleText,Object(z.a)(this,this.PUd,"insertDialogHandler"),this.dXb),this.xV=!0):(this.showDialog(this.titleText,Object(z.a)(this,this.PUd,"insertDialogHandler")),h&&this.mho(),(b=this.vMd(1))&&this.Ox.push(b),
(b=this.vMd(0))&&this.Ox.push(b),this.Szj(),this.xV=!1)}get KBj(){return this.scb}validate(){this.hs.rT||u.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.hs.rT.value?!0:(Yf.Sw(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}Shn(b){this.Qbk&&(this.hs=this.Ahj(b,this.scb))}Mon(){this.hs&&this.hs.rT&&(this.CRg||(this.hs.IPn(Object(z.a)(this,this.YQf,"onFileChosen")),this.CRg=!0),this.hs.uVh())}YQf(b){this.dXb.uploadStatusLabel=b;this.V4(this.titleText,Object(z.a)(this,
this.PUd,"insertDialogHandler"),this.dXb)}PUd(b){1===b&&this.isEnabled()?Yf.fL&&this.hs.rT&&!this.hs.rT.value?(this.dXb.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.V4(this.titleText,Object(z.a)(this,this.PUd,"insertDialogHandler"),this.dXb)):(this.CTd(),this.scb.VNa(this.hs,Object(z.a)(this,this.dispose,"dispose"))):0===b&&this.hide()}mho(){this.Fye=!1;this.hs=this.Ahj(document.getElementById("uploadFrameContainer"),this.scb);v.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&
(this.SXa=Object(z.a)(this,this.FTf,"onUploadFrameLoad"),Hf.a.addHandler(this.hs.iFrame,"load",this.SXa));this.hs.rT||u.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.FYi()}FTf(){this.FYi()}FYi(){if(this.hs&&!this.Fye){var b=this.hs.rT;b&&(Hf.a.addHandler(b,db.a.fi,Object(z.a)(this,this.onKeyDown,"onKeyDown")),b=[b],this.Ox=b.concat.apply(b,this.Ox),this.Szj(),this.Fye=!0)}}dispose(){if(this.hs&&!Yf.fL){const b=this.hs.rT;b&&Hf.a.removeHandler(b,db.a.fi,Object(z.a)(this,
this.onKeyDown,"onKeyDown"));this.SXa&&Hf.a.removeHandler(this.hs.iFrame,"load",this.SXa)}this.hs=null;super.dispose()}Szj(){if(0<this.Ox.length){const b=new gf(this.Ox),h=yd.FocusManager.instance().Hs();h&&(this.Ox[0].focus(),h.Xj=b,h.lU=!0)}}onKeyDown(b){4!==yd.FocusManager.instance().JYi(b)&&b.preventDefault()}static get fL(){return v.AFrameworkApplication.ta.Ob.VE&&v.AFrameworkApplication.ta.Ob.twi}static Sw(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}
Object(m.a)(Yf,"InsertFileDialog",Pf.a,[]);class tc{static get Wg(){return Pf.a.Xz(tc.Hm,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}tc.Hm="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(m.a)(tc,"InsertImageDialogHtml",null,[]);class Qk extends Yf{constructor(b,
h=!0){super(b,h)}get fxd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get ffl(){return tc.Wg}validate(){this.hs.rT||u.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(Da.a)(lf,this.KBj);const h=b.Mme(this.hs.rT.value);return 0!==h?(b=b.DNd(h),Yf.Sw(b),!1):!0}}Object(m.a)(Qk,"InsertImageDialog",Yf,[]);class cq extends Qk{constructor(b){super(b)}Ahj(b,h){const t=v.AFrameworkApplication.ta.Ob.VE&&v.AFrameworkApplication.ta.Ob.twi;
return new Ak.a(b,Object(z.a)(h,h.$dc,"onUploadFrameInitialized"),Object(z.a)(h,h.Fya,"uploadResponseReceived"),v.AFrameworkApplication.K,!t)}isEnabled(){return cq.mO.Mea(this.KBj.context)}static get mO(){return null!=cq.zxg?cq.zxg:cq.zxg=Sa.a.instance.resolve("Box4.Images.IImageEditor")}}Object(m.a)(cq,"Box4InsertImageDialog",Qk,[]);class Eo{c_k(b){return new Promise((h,t)=>{this.d_k(b).then(A=>{h(A)},A=>{t(A)})})}dFh(b){return new Promise((h,t)=>{const A=new FileReader;A.addEventListener("load",
()=>{h(A.result)},!1);A.addEventListener("error",()=>{t("FileReader exception ("+A.error.name+")")});A.readAsDataURL(b)})}d_k(b){return new Promise((h,t)=>{this.dFh(b).then(A=>{this.b8e(A,"image/jpeg").then(O=>{h(O)},O=>{t(O)})},A=>{t(A)})})}b8e(b,h){return new Promise((t,A)=>{const O=new Image;O.addEventListener("load",()=>{const aa=document.createElement("canvas"),ua=aa.getContext("2d");aa.width=O.width;aa.height=O.height;ua.drawImage(O,0,0);t(aa.toDataURL(h))});O.addEventListener("error",()=>{A("Image failed to load")});
O.src=b})}}Object(m.a)(Eo,"ImageFormatConverter",null,[]);var zm=c(436);const Vn=["ImageInsertFailed"];class qk extends lf{constructor(b,h,t,A,O,aa,ua=!0){super(b,h,t);this.aAa=this.Nl=this.FG=this.Te=null;this.jKd="wwpicturesfc";this.kpiName="ImageFileExtension";this.Huc="LocalDeviceUpload";this.Hga=new Map;this.AVh=0;this.rcb=null;this.Dye="";this.tra=0;this.Mp=null;this.wtc="";this.u2g=50;this.cTg=this.Crc=this.gAc=this.Ewc=!1;this.L4j=19922944;this.H4g=0;this.Hye=[];this.BRg=[];this.I4g=0;this.ySf=
Ra=>{u.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(Ra){var ub={},Nb=this.FG?this.FG.properties.Nc.toString():this.Te.Nc.toString();ub[ag.a.nodeId]=this.FG?this.FG.id.toString():this.Te.id.toString();ub[ag.a.classId]=Nb;this.Cf.hasProperty(Lc.a.imageType)&&(ub[Bh.a.imageType]=this.Cf.getValue(Lc.a.imageType));this.Cf.hasProperty(Lc.a.WT)&&(ub[Bh.a.WT]=this.Cf.getValue(Lc.a.WT));this.Cf.hasProperty(Jh.a.ofa)&&(ub[Bh.a.ofa]=this.Cf.getValue(Jh.a.ofa));this.Cf.hasProperty(Lc.a.ckb)&&
(ub[Bh.a.ckb]=this.Cf.getValue(Lc.a.ckb));Do.d(Ra,this.Te,this.Nl,ub)&&(this.V7c(Ra),qk.edc++)}else u.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.Bhn=Ra=>{if(!this.Zxf){var ub=this.I4h(this.hs);ub&&(this.Dye=ub.name,this.tra=ub.size);if(!this.Nya(Ra,this.hs)||!this.Lkg(ub,this.hs)){ub=Object.assign(new Hb.a,{extendedProperties:new Map});ub.extendedProperties.set("type",this.Nya(Ra,this.hs)?"Image too large":"FileType invalid");this.$0d(ub);this.W0d();return}}this.VNa(this.hs,
null)};this.Cf=A;this.Dm=O;this.ga=aa;this.Mh=Tg.a.getInstance(zm.a);this.v1g=t.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.L2g=t.pc("ImageUploadMaxByteSize",Number.MAX_VALUE);ua&&this.showDialog();Jb.App.ikc.addHandler(this)}get fui(){return this.K.$("JfifImageInsertIsEnabled")}get yO(){return this.Huc}get fileExtension(){return this.Dye}get fileSize(){return this.tra}get JBj(){return this.rcb}get lu(){return this.Mp||(this.Mp=Sa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get Zxf(){return this.yO===
this.Huc}showDialog(){Do.a(this.K)?(this.J3b=!1,this.hs=new Ak.a(document.body,Object(z.a)(this,this.$dc,"onUploadFrameInitialized"),Object(z.a)(this,this.Fya,"uploadResponseReceived"),this.K,!1,void 0,!0)):Do.b()||this.QIb&&ba.a.wH?(this.J3b=!1,this.hs=new Ak.a(document.body,Object(z.a)(this,this.$dc,"onUploadFrameInitialized"),Object(z.a)(this,this.Fya,"uploadResponseReceived"),this.K,!1)):(this.J3b=!0,this.hs=(new cq(this)).hs)}p4h(b){switch(b){case dm.noPictureSpecified:return nm.a.noPictureSpecified;
case dm.invalidExtension:return nm.a.qum;case dm.pictureTooLarge:return nm.a.zCi}return Bf.a.unknown}Xbe(b){this.Zxf||(this.Te.Ei()?(u.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),ym.a.instance.Zjg(this.Te.Ei()),this.Te.Ei().contentReplicator.forceOutbound(this.ySf,Object(z.a)(this,this.MKb,"processFailure"),b)):this.MKb(b,157))}NHm(){return Do.c(this.Te)}V7c(b){b.V7c();this.rcb=b.rcb}Fya(b){this.AVh=+new Date-+this.JBj;this.W0d();u.ULS.sendTraceTag(36783364,322,50,
"Box4PictureUploader.UploadResponseReceived");Do.e(this,b,this.Te)}wSo(){u.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.GZc();qk.edc--;this.ga.processAction(ab.a.j7a,2);this.Te?ym.a.instance.wlc(this.Te.Ei(),0):u.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.lu.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}MKb(b,h){var t;if(this.g1n(b))u.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",
this.retryCount,h.toLocaleString());else{b=Object.assign(new Hb.a,{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());(null===(t=v.AFrameworkApplication.K)||void 0===t?0:t.$("ShouldLogPicturesExtendedHealthKpis"))?this.Mh.logKpiFailure({kpiName:zm.c.tEa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:{name:zm.c.K8b,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,
isSessionEndingError:!1,additionalValues:b}}):wa.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",Vn,!1,!0,!1,!1,b);t=this.egf(h);u.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.Te.pH();var A=new Te.GraphTransaction(15,qa.a.DQ);A.Eb(this.Te);qk.mO.uSa(this.Cf,t);qk.mO.l2f(this.Te,this.FG);Be.ImageReader.nfj(this.Cf);A.dispose();this.Qlj(t);this.Dm.I1b(b,!1);this.GZc();qk.edc--;ym.a.instance.wlc(this.Te.Ei(),
h)}}Qlj(b){const h=new cf.StandardDialog;h.zd=0;h.Sw(nm.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}egf(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}tIj(){if(this.wtc&&0<this.wtc.length){const b=new ji.DictionaryPropertySet;b.setValue(Gd.a.EO,this.wtc);b.setValue(Gd.a.v3,!0);this.ga.Rb(qa.a.BZ,2,b)}this.Goo()}Goo(){let b="";this.cTg?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.Ewc&&
this.Crc&&this.gAc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.Ewc&&this.Crc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.Ewc&&this.gAc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.gAc&&this.Crc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.gAc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.Crc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.Ewc&&
(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.Qlj(b),this.fJj())}Kok(b){this.wtc+=String.format('<img src="{0}"></img>',b);this.I4g++}wYm(){this.gAc=!0;u.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new Hb.a,{extendedProperties:new Map});b.extendedProperties.set("type","Image too large");this.$0d(b)}uYm(){this.Crc=!0;u.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");const b=Object.assign(new Hb.a,{extendedProperties:new Map});
b.extendedProperties.set("type","Filetype invalid");this.$0d(b)}qDi(b){this.cTg=!0;u.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}vuo(b){const h=new Eo;if(this.Mme(b.name)===dm.validPicture)return h.dFh(b);if(lf.Nya(b.name,Ak.a.KUe)===dm.validPicture)return h.c_k(b)}l_k(b){return new Promise(h=>{const t=this.vuo(b);void 0===t&&(this.qDi("Failed starting conversion work"),h());t.then(A=>{A.length>this.L4j?this.wYm():this.Kok(A);h()},A=>{this.qDi(A);
h()})})}uMm(b){return this.Mme(b.name)===dm.validPicture||lf.Nya(b.name,Ak.a.KUe)===dm.validPicture}Dtm(){const b=[];if(this.hs.rT.files){this.H4g=this.hs.rT.files.length;this.hs.rT.files.length>this.u2g&&(this.Ewc=!0);this.b6a();for(let h=0;h<this.hs.rT.files.length&&this.u2g;h++){const t=this.hs.rT.files[h];this.Hye.push(t.name);this.BRg.push(t.size);t&&(this.uMm(t)?b.push(this.l_k(t)):this.uYm())}}Promise.all(b).then(()=>{this.K1b();this.tIj()});return!0}tum(){this.Nl=Ya.a.create();this.Cf||(this.Cf=
new ji.DictionaryPropertySet);this.v1g&&this.aAa&&this.Cf.setValue(Jh.a.FCi,this.aAa);var b=480;let h=320;const t=this.context.view.qh.editingElement.clientWidth;0<t&&t<b&&(h=Math.floor(1*t/b*h),b=t,this.Cf.setValue(Jh.a.ofa,t));this.Cf.setValue(Af.a.xba,Hc.a.Tl(b,0));this.Cf.setValue(Af.a.Jga,Hc.a.Tl(h,1));this.Cf.setValue(fh.a.l_,1);this.Cf.setValue(Gd.a.v3,!0);this.Cf.setValue(Lc.a.ckb,Box4Intl.Box4Strings.l_Picture);b=qk.mO.$Oh(this.context,this.Cf,this.Nl);if(!b)return!1;this.Te=b.node;this.Cf=
(this.FG=b.blob)?this.FG.properties:this.Te.properties;Jb.App.xd.Yp&&Jb.App.xd.Vq.aH(this.Te);return!0}ZUd(){return this.Zxf?this.Dtm():this.tum()}fJj(){var b;this.Hga.set("FileExtensions",this.vJl());this.Hga.set("FileSizeInBytes",this.BRg.toString());this.Hga.set("Source",this.yO);this.Hga.set("NumberOfImagesAttemptedToInsert",this.H4g.toString());this.Hga.set("NumberOfImagesPasted",this.I4g.toString());(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?
(this.Hga.set("ErrorLevel","warning"),b=Object.assign(new Hb.a,{extendedProperties:this.Hga}),this.Mh.logKpiFailure({kpiName:zm.c.tEa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})):wa.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.jKd,this.Hga)}vJl(){let b="";for(let h=0;h<this.Hye.length;++h)b=b+this.H4h(this.Hye[h])+",";return b}VNa(b,h){this.v1g&&(this.aAa=new Kq,this.aAa.rT=b.rT);super.VNa(b,h)}$dc(b){this.hs=b;if(!this.J3b){if(this.xme){if(Do.a(this.K)||
this.QIb&&ba.a.wH){b.GHd(this.Bhn);return}const h=b.GHd(null),t=this.I4h(b);t&&(this.Dye=t.name,this.tra=t.size);if(!this.Nya(h,b)||!this.Lkg(t,b)){b=Object.assign(new Hb.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.Nya(h,this.hs)?"Image too large":"FileType invalid");this.$0d(b);this.W0d();return}}this.VNa(b,null)}}tTd(){return!!qk.edc}W0d(){var b;this.Hga.set("FileExtension",this.H4h(this.fileExtension));this.Hga.set("Source",this.yO);this.Hga.set("FileSizeInBytes",this.fileSize.toString());
this.Hga.set("RequestTimeInMs",this.AVh.toString());(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?this.Mh.logKpiUsage({kpiName:zm.c.tEa,kpiType:0,optionalProperties:{extendedProperties:this.Hga}}):wa.Health.instance.recordKpiUsage(this.kpiName,0,this.jKd,this.Hga)}H4h(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}$ei(){return this.fui?Ak.a.ihh:lf.JUe}I4h(b){return(b=b.rT)?b.files[0]:null}Lkg(b,h){return b&&b.size>this.L2g?
(h&&h.Nxd(),b=this.DNd(dm.pictureTooLarge),this.Lp(this.p4h(dm.pictureTooLarge),b),!1):!0}DNd(b){switch(b){case dm.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;case dm.invalidExtension:return this.fui?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case dm.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.L2g/1E6));default:return""}}$0d(b){var h;(null===(h=v.AFrameworkApplication.K)||
void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:zm.c.K8b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.Mh.logKpiFailure({kpiName:zm.c.tEa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):wa.Health.instance.recordQosError("PictureFromLocalInvalid",Vn,!0,!0,!1,!1,b)}static get mO(){return null!=
qk.yxg?qk.yxg:qk.yxg=Sa.a.instance.resolve("Box4.Images.IImageEditor")}}qk.edc=0;Object(m.a)(qk,"Box4PictureUploader",lf,[706,622]);var Pp=c(836),tl=c(144);class un{constructor(){this.vs=this.kq=this.xvb=this.efh=this.$cd=this.iSj=null;this.SNe=0;this.jra=this.hJe=this.Mvb=null;this.tMg=0;this.ore=this.Rda=this.DFe=null;this.cXg=!1;this.uqe=this.qqe=this.vqe=null}get assetId(){return this.$cd}get thumbnailUrl(){return this.efh}get mAn(){return this.xvb}get displayName(){return this.jra}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.kq,this.vs)}get Wsk(){if(this.qqe&&this.uqe&&this.vqe){const b=document.createElement("a");b.setAttribute("href",this.vqe);b.setAttribute("target","_blank");b.innerText=this.uqe;return b}return null}get Anh(){return this.qqe}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.tMg)}get aIn(){const b=document.createElement("span");var h=0;if(this.Mvb&&0<this.Mvb.length){var t=this.Mvb.indexOf("."),A=0>t?this.Mvb:this.Mvb.substring(0,t);for(A=Number.parseInvariant(A);h<
A&&5>h;h++)b.appendChild(dh.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",tl.a.Bg("box42.png"),"","",!0,""));0<t&&(t=Number.parseInvariant(this.Mvb.substr(t+1)),3>t?b.appendChild(dh.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",tl.a.Bg("box42.png"),"","",!0,"")):8>t?b.appendChild(dh.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",tl.a.Bg("box42.png"),"","",!0,"")):b.appendChild(dh.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",tl.a.Bg("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(dh.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",tl.a.Bg("box42.png"),"","",!0,""));this.hJe&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.hJe),b.appendChild(h));return b}get F_n(){return 0<this.SNe?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.SNe):""}get cBk(){if(this.cXg){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.ore&&this.Rda)return un.L4k(this.ore,this.Rda);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.DFe){const h=this.DFe.split(",");b=Array(h.length);for(let t=0;t<h.length;t++)b[t]=h[t].trim()}else b=[];return b}static dBl(b){const h=new un;for(let t=0;t<b.childNodes.length;t++){const A=b.childNodes[t];if(1===A.nodeType)try{const O=A.firstChild.nodeValue;switch(A.nodeName){case "src":h.iSj=O;break;case "assetid":h.$cd=
O;break;case "thumb":"64x64"===A.attributes.getNamedItem("size").nodeValue?h.efh=un.gvj(O):"192x192"===A.attributes.getNamedItem("size").nodeValue&&(h.xvb=un.gvj(O));break;case "imagedim":if(O){const ua=O.indexOf("x");0<ua&&ua<O.length&&(h.kq=O.substr(0,ua),h.vs=O.substr(ua+1))}break;case "resolution":h.SNe=Number.parseInvariant(O);break;case "rating":h.Mvb=O;break;case "numofratings":h.hJe=O;break;case "displayname":h.jra=O;break;case "contentlength":h.tMg=Number.parseInvariant(O)/1024;break;case "subject":h.DFe=
O;break;case "provider":h.Rda=O;break;case "attributionlink":h.ore=O;break;case "iscsc":h.cXg=1===Number.parseInvariant(O);break;case "additional":const aa=A.firstChild;if(A.hasChildNodes()&&aa&&"id"===aa.nodeName&&1===Number.parseInvariant(aa.text))for(let ua=0;ua<A.childNodes.length;ua++){const Ra=A.childNodes[ua];switch(Ra.nodeName){case "caption":h.qqe=Ra.text;break;case "value":h.vqe=Ra.text;break;case "string":h.uqe=Ra.text}}}}catch(O){}}return h}static L4k(b,h){const t=document.createElement("a");
t.setAttribute("href",b);t.setAttribute("target","_blank");t.innerText=h;return t}static gvj(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(m.a)(un,"ClipArtSearchResult",null,[]);class fo{static get Wg(){return Pf.a.Xz(fo.Hm,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}fo.Hm="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(m.a)(fo,"InsertClipartDialogHtml",null,[]);class oo extends Pf.a{constructor(b){super();this.Zza=this.Xsb=0;this.x8g=null;this.hMe=!1;this.QWb=this.JWa=this.iN=null;this.RQi=h=>{const t=this.gW.value;t&&0<t.trim().length&&(this.search(this.gW.value),this.Dpa(1,!1));h.preventDefault();h.stopPropagation()};this.Vmn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.RQi(h),h.preventDefault(),h.stopPropagation())};this.SQi=h=>{100<=this.gW.value.length&&(h.preventDefault(),h.stopPropagation())};
this.sln=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.QXi(h);this.s8f(h)};this.onScroll=()=>{if(this.sr&&this.sr.children&&!(2>this.sr.children.length)){var h=this.sr.children[0].children[0],t=this.sr.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.sr.scrollTop,A=h.clientHeight+2,O=parseInt(String(this.sr.scrollTop/A));h=parseInt(String(t/A));var aa=parseInt(String(this.sr.clientWidth/A));h<t/A&&h<parseInt(String(this.iN.length/aa))&&h++;for(t=O;t<h;t++)for(A=
0;A<aa;A++){var ua=t*aa+A;O=this.iN[ua];(ua=document.getElementById("clip"+ua))&&!ua.childNodes.length&&(O=this.CJh(O),ua.appendChild(O))}}};this.bon=h=>{h.target.setAttribute("src",tl.a.Bg("phthumb.64x64x32.png"))};this.tln=h=>{h.target.setAttribute("src",tl.a.Bg("phpreview.96x96x32.png"))};this.qOi=h=>{ff.a.km(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.Ein=h=>{(h?h.keyCode:
window.event.keyCode)===Sys.UI.Key.enter&&this.qOi(h)};this.JOi=h=>{const t=h.target.innerText;this.gW&&(this.gW.value=t);this.search(t);h.stopPropagation();h.preventDefault();this.Dpa(1,!1)};this.pjn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.JOi(h)};this.UQi=h=>{this.iN&&(this.y5n(this.iN[this.Xsb]),h.stopPropagation(),h.preventDefault(),this.gW.value="",this.Dpa(1,!1))};this.Wmn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.UQi(h)};this.onKeyDown=h=>{if(h.keyCode>=
Sys.UI.Key.left&&h.keyCode<=Sys.UI.Key.down){let t=0;switch(h.keyCode){case Sys.UI.Key.up:t=-5;break;case Sys.UI.Key.down:t=5;break;case Sys.UI.Key.left:t=-1;break;case Sys.UI.Key.right:t=1}this.Zza=this.Zza+t<this.sr.children.length-1?0>this.Zza+t?0:this.Zza+t:this.sr.children.length-1;this.s8f(this.Zza);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.sr.children.length&&this.Ubj(h)):h.keyCode===Sys.UI.Key.tab&&
(this.Zza=h.shiftKey?Math.max(0,this.Zza-1):Math.min(this.Zza+1,this.sr.children.length-1))};this.onError=()=>{this.sr&&(this.sr.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.ZYi=h=>{if(this.sr)if(h.data.Qha){var t=h.data.Qha.lastChild.childNodes;this.iN||(this.iN=[]);for(h=0;h<t.length&&100>this.iN.length;h++){var A=t[h];1===A.nodeType&&"image"===A.nodeName&&(A=un.dBl(A),this.iN.push(A))}this.JOh();this.iN.length||(this.sr.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.we){h=
F.a.Qpj(h.data.we);try{t=parseInt(h)}catch(O){t=14}this.sr.innerText=26===t?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.JOh=()=>{if(this.iN){vc.a.FZ(this.sr);this.JWa&&(this.JWa.dispose(),this.JWa=null);this.sr.focus();this.sr.classList.remove("ClipartSearchInProgress");for(let t=0;t<this.iN.length;t++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+t;const A=document.createElement("span");A.id="clip"+t;A.classList.add("ClipartImageContainer");
h.appendChild(A);this.sr.appendChild(h);t<parseInt(String(this.sr.clientHeight/A.clientHeight))*parseInt(String(this.sr.clientWidth/A.clientWidth))&&(h=this.CJh(this.iN[t]),A.appendChild(h))}this.hMe&&(this.Ubj(this.Xsb),this.s8f(this.Xsb))}};this.Xsm=h=>{1===h&&this.iN&&oo.mO.Mea(this.sLg.context)&&(h=this.iN[this.Xsb])&&this.sLg.wHa(h)};this.sLg=b;this.Wg=fo.Wg;this.sg="InsertClipartDialog";this.Ge(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.Xsm);this.sr=document.getElementById("clipartsearchresults");this.tsd=this.onKeyDown;Hf.a.addHandler(this.sr,"keydown",this.tsd);this.ssd=this.onScroll;Hf.a.addHandler(this.sr,"scroll",this.ssd);this.gW=document.getElementById("textInput");this.Sud=this.Vmn;Hf.a.addHandler(this.gW,"keydown",this.Sud);this.Tud=this.SQi;Hf.a.addHandler(this.gW,"keypress",this.Tud);this.Uud=this.SQi;Hf.a.addHandler(this.gW,"paste",this.Uud);this.doc=document.getElementById("btnSearch");this.doc.setAttribute("src",
tl.a.Bg("search.16x16x32.png"));this.rsd=this.RQi;Hf.a.addHandler(this.doc,"click",this.rsd);this.$Sb=document.getElementById("clipartpreviewimage");this.Hwe=document.getElementById("clipartattributedisplayname");this.F9a=document.getElementById("clipartseesimilar");this.Gwe=document.getElementById("clipartdimensions");this.Hqc=document.getElementById("clipartadditionalvalue");this.Iwe=document.getElementById("clipartratingvalue");this.WUa=document.getElementById("clipartattributionvalue");this.XUa=
document.getElementById("clipartkeywords");this.Ewe=document.getElementById("clipartadditionalname");this.Jwe=document.getElementById("clipartratingname");this.Fwe=document.getElementById("clipartattributionname");this.jMe=this.sln;this.RSe=this.bon;this.gjd=this.qOi;this.hjd=this.Ein;this.BFe=this.JOi;this.CFe=this.pjn;this.vsd=this.UQi;this.wsd=this.Wmn;this.gW.focus();this.Dpa(1,!1)}dispose(){this.sr&&this.jAh();this.sr&&this.tsd&&(Hf.a.removeHandler(this.sr,"keydown",this.tsd),this.tsd=null);
this.sr&&this.ssd&&(Hf.a.removeHandler(this.sr,"scroll",this.ssd),this.ssd=null);this.sr=null;this.gW&&this.Sud&&(Hf.a.removeHandler(this.gW,"keydown",this.Sud),this.Sud=null);this.gW&&this.Tud&&(Hf.a.removeHandler(this.gW,"keypress",this.Tud),this.Tud=null);this.gW&&this.Uud&&(Hf.a.removeHandler(this.gW,"paste",this.Uud),this.Uud=null);this.gW=null;this.doc&&this.rsd&&(Hf.a.removeHandler(this.doc,"click",this.rsd),this.doc=this.rsd=null);this.Fwe=this.Jwe=this.Ewe=this.XUa=this.WUa=this.Iwe=this.Hqc=
this.Gwe=this.F9a=this.Hwe=this.$Sb=this.wsd=this.vsd=this.CFe=this.BFe=this.hjd=this.gjd=this.QWb=this.RSe=this.jMe=null;this.JWa&&(this.JWa.dispose(),this.JWa=null);super.dispose()}$K(){super.$K();document.getElementById(this.kj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.OMb(b,!1,this.ZYi)}OMb(b,h,t){this.Zza=this.Xsb=0;this.jAh();if(this.iN&&b===this.x8g&&this.hMe===h)window.setTimeout(this.JOh,500);else{this.iN&&(Array.clear(this.iN),this.iN=null);this.x8g=b;this.hMe=
h;var A=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');A.append("<query>");A.append(F.a.Af(b));A.append("</query>");A.append("<mediatype>Illustration</mediatype>");A.append("<mediatype>Photo</mediatype>");A.append("<filetype>jpg</filetype>");A.append("<filetype>jpeg</filetype>");A.append("<filetype>gif</filetype>");A.append("<filetype>bmp</filetype>");A.append("<filetype>tif</filetype>");A.append("<filetype>tiff</filetype>");A.append("<filetype>png</filetype>");A.append("</search>");
b=v.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let O=b.length;4>O;O++)b="0"+b;v.AFrameworkApplication.Ke.oj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Jb.App.webServiceBase,b,Bh.a.hro,h.toString()),2,A.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,t,this.onError,null)}}y5n(b){this.OMb(b.assetId,!0,this.ZYi);this.iN||(this.iN=[],this.iN.push(b))}CJh(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",
b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;h.setAttribute("title",b);h.setAttribute("alt",b);Hf.a.addHandler(h,"click",this.jMe);Hf.a.addHandler(h,"error",this.RSe);return h}Wcl(b){1===b.childNodes.length&&(b=b.childNodes[0],Hf.a.removeHandler(b,"click",this.jMe),Hf.a.removeHandler(b,"error",this.RSe))}QXi(b){const h=this.iN[b];var t=h.mAn;this.hAh();this.QWb=this.tln;var A=document.createElement("img");A.setAttribute("src",t);if(h.displayName)t=
String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{t=new Sys.StringBuilder;for(let O=0;O<h.keywords.length&&5>O;O++)O&&t.append(", "),t.append(h.keywords[O]);t=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,t.toString())}A.setAttribute("title",t);A.setAttribute("alt",t);Hf.a.addHandler(A,"error",this.QWb);this.$Sb.appendChild(A);A=document.getElementById("clip"+this.Xsb);A.classList.remove("ClipartSelectedImage");A=document.getElementById("clip"+
b);A.classList.add("ClipartSelectedImage");this.Xsb=b;h.displayName&&(this.Hwe.innerText=h.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');Hf.a.addHandler(b,"click",this.vsd);Hf.a.addHandler(b,"keydown",this.wsd);this.F9a.appendChild(b);this.Gwe.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.F_n,h.fileSize);(b=h.Wsk)&&h.Anh?(this.Hqc.parentNode.style.display="block",this.Ewe.innerText=h.Anh,this.Hqc.appendChild(b)):
this.Hqc.parentNode.style.display="none";this.Iwe.appendChild(h.aIn);vc.a.FZ(this.WUa);if(b=h.cBk)this.WUa.appendChild(b),"a"===b.nodeName.toLowerCase()&&(Hf.a.addHandler(b,"click",this.gjd),Hf.a.addHandler(b,"keydown",this.hjd));this.XUa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)A=h.keywords[b],t=document.createElement("a"),t.innerText=A,t.setAttribute("href",'""'),Hf.a.addHandler(t,"click",this.BFe),Hf.a.addHandler(t,"keydown",this.CFe),this.XUa.appendChild(t),
b<h.keywords.length-1&&(A=document.createElement("span"),A.innerText=", ",this.XUa.appendChild(A));this.Jwe.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.Fwe.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.Dpa(1,!0)}hAh(){this.$Sb&&1===this.$Sb.childNodes.length&&(this.QWb&&(Hf.a.removeHandler(this.$Sb.childNodes[0],"error",this.QWb),this.QWb=null),vc.a.FZ(this.$Sb));this.WUa&&0<this.WUa.childNodes.length&&"a"===this.WUa.childNodes[0].nodeName.toLowerCase()&&(this.gjd&&Hf.a.removeHandler(this.WUa.childNodes[0],
"click",this.gjd),this.hjd&&Hf.a.removeHandler(this.WUa.childNodes[0],"keydown",this.hjd));this.F9a&&0<this.F9a.children.length&&"a"===this.F9a.children[0].nodeName.toLowerCase()&&(this.vsd&&Hf.a.removeHandler(this.F9a.children[0],"click",this.vsd),this.wsd&&Hf.a.removeHandler(this.F9a.children[0],"keydown",this.wsd),vc.a.FZ(this.F9a));if(this.XUa){for(let b=0;b<this.XUa.childNodes.length;b++){const h=this.XUa.childNodes[b];"a"===h.nodeName.toLowerCase()&&(Hf.a.removeHandler(h,"click",this.BFe),Hf.a.removeHandler(h,
"keydown",this.CFe))}vc.a.FZ(this.XUa)}this.Hwe.innerText="";this.Gwe.innerText="";vc.a.FZ(this.Hqc);vc.a.FZ(this.Iwe);vc.a.FZ(this.WUa);this.XUa.innerText="";this.Ewe.innerText="";this.Jwe.innerText="";this.Fwe.innerText=""}Ubj(b){if(!(this.sr.children.length<=b||0>b)){var h=this.sr.children[b],t=this.sr.children[0];t=t.clientHeight-t.children[0].clientHeight+2;this.sr.scrollTop+this.sr.clientHeight<h.offsetTop+h.clientHeight?this.sr.scrollTop=h.offsetTop-3*h.clientHeight-t:this.sr.scrollTop>h.offsetTop&&
(this.sr.scrollTop=h.offsetTop-t/2);this.QXi(b)}}validate(){return!0}jAh(){if(yd.FocusManager.DJ()){var b=yd.FocusManager.instance().getRegion(this.uK);b&&b.Xj.wy(this.gW)}else this.gW.focus();for(b=0;b<this.sr.childNodes.length;b++){const h=this.sr.childNodes[b];1===h.childNodes.length&&this.Wcl(h.childNodes[0])}vc.a.FZ(this.sr);this.hAh();this.Dpa(1,!1);this.JWa=new Pp.a(Box4Intl.Box4Strings.l_ClipartSearching);this.JWa.sxi=!1;this.sr.appendChild(this.JWa.element);this.sr.classList.add("ClipartSearchInProgress")}s8f(b){this.Zza=
b;b=this.sr.children[this.Zza];yd.FocusManager.DJ()?yd.FocusManager.instance().getRegion(this.uK).Xj.wy(b):b.focus()}static get mO(){return oo.Nj=oo.Nj||Sa.a.instance.resolve("Box4.Images.IImageEditor")}}oo.Nj=null;Object(m.a)(oo,"InsertClipartDialog",Pf.a,[]);class sd extends qk{constructor(b,h,t,A,O,aa){super(b,h,t,A,O,aa,!1);this.cln=ua=>{if(this.NHm()){var Ra=this.Te.Ei(),ub=Ra.contentReplicator.kt.toString(),Nb=new Sys.Net.WebRequest;Nb.set_url("ClipArtUpload.ashx");Nb=new Sys.StringBuilder(Nb.getResolvedUrl());
this.sW(Nb,Bh.a.assetId,ua.assetId,!0);this.sW(Nb,ag.a.lcid,v.AFrameworkApplication.lcid.toString());this.sW(Nb,ag.a.nodeId,this.FG?this.FG.id.toString():this.Te.id.toString());this.sW(Nb,ag.a.cellId,Ra.Zm.toString());this.sW(Nb,ag.a.fileId,Ra.Fs);this.sW(Nb,ag.a.ota,ub);this.sW(Nb,ag.a.gT,this.Nl.toString());ua=this.Te.ia(Jh.a.eJ,Tn.a.nt);this.sW(Nb,ag.a.eJ,ua.toString());this.sW(Nb,ag.a.Dpb,"1");Ra.DI&&this.sW(Nb,ag.a.DI,Ra.DI);this.sW(Nb,ag.a.classId,this.FG?this.FG.properties.Nc.toString():this.Te.Nc.toString());
this.Cf.hasProperty(Lc.a.imageType)&&this.sW(Nb,Bh.a.imageType,this.Cf.getValue(Lc.a.imageType).toString());tn.a.instance.Sok(Nb);v.AFrameworkApplication.Ke.oj(Nb.toString(),2,"",{},!1,2,this.xSo,this.uploadFailed,null);qk.edc++}};this.xSo=ua=>{if(({group:Ra}=sl.a.H0(ua.data.we)).returnValue){var Ra=Ra.Responses[0];Ra.Dmb=ua.data.tH;Ra.ou=ua.data.vj?ua.data.vj[Fn.a.g7]:"";this.Fya(Ra)}else this.uploadFailed(null)};this.uploadFailed=()=>{const ua=new Un.a;ua.StatusCode=14;this.Fya(ua)};new oo(this)}wHa(b){this.ZUd()&&
this.Te.Ei().contentReplicator.forceOutbound(this.cln,null,b)}sW(b,h,t,A){b.append(A?"?":"&");b.append(F.a.Mj(h));b.append("=");b.append(F.a.Mj(t))}egf(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.egf(b)}}Fya(b){super.Fya(b);qk.edc--}}Object(m.a)(sd,"ClipartUploader",qk,[]);class Bk{constructor(b,h,t){this.Ysm=(A,O,aa,ua,Ra)=>{if(!this.Nj||!this.Nj.value)return u.ULS.sendTraceTag(524109267,
306,15,"ImageEditor not available"),8;A=this.Nj.value.Mea(O);return 2===aa&&A?(new sd(O,sf.a.instance,v.AFrameworkApplication.K,Ra,this.Dm,this.ga),32):1===aa?A&&Jb.App.ZAh?32:8:2};this.Nj=b;this.Dm=h;this.ga=t}Ub(){this.ga.gb(qa.a.rni,mc.a.view,this.Ysm,260)}}Object(m.a)(Bk,"ClipArtActor",null,[]);class rq{constructor(){this.W=null}get name(){return"Box4.ClipArt"}yc(b){this.W=b;b.ha("Box4.ClipArt.ClipArtActor",()=>new Bk(b.We("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.xa)).singleInstance()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Ub();
const b=Jb.App.ya;b&&b.updateCommandUI()}dispose(){}}Object(m.a)(rq,"ClipartPackage",null,[1,2]);class Tj{constructor(b){this.fXa=this.RWa=this.kXa=this.jXa=null;this.pUg=this.bPg=this.qUg=this.Y_g=this.xh=this.j$=!1;this.HNe=this.F0g=null;this.o0g=0;this.Na=this.z0g=null;this.pda=b;this.VM=3;this.HUb=!0}initialize(b,h,t){this.jXa=this.qrf(b,h);this.kXa=CommonUIStrings.l_SavingStatus;this.RWa=CommonUIStrings.l_ReadOnlyStatus;this.fXa=CommonUIStrings.l_ReviewModeStatus;this.pda&&this.pda.execute(A=>
{A.Mcb(Object(z.a)(this,this.C$c,"updateToSavingStatus"))});this.xh=!0;this.Na=t;this.bPg=this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}opb(b,h){this.j$=b;this.VM=h;this.CTa(this.HUb)}CTa(b){!this.HUb&&b&&(this.z0g=new Date);this.HUb=b;this.pUg=!1;b=null;3===this.VM&&(b=this.HUb?this.jXa:this.kXa);this.hhl(b)}qrf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,
h):CommonUIStrings.l_SavedStatus}C$c(){this.CTa(!1)}vWl(){switch(this.VM){case 1:return this.RWa;case 2:return this.fXa;default:return null}}uWl(){if(3!==this.VM)switch(this.VM){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.pUg?"FailedToSave":this.HUb?"Saved":"Saving"}eBm(b){return this.Y_g===this.j$&&this.o0g===this.VM&&this.F0g===b}Scf(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.j$,b,this.vWl(),this.z0g,this.HUb,this.bPg?h.getHeaderSaveStatusIconProps(this.uWl()):
null);this.qUg=!0;return null});this.HNe=null}hhl(b){this.xh&&Rh.c()&&!this.eBm(b)&&(!this.qUg&&this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.Scf(b):ff.a.ece()?(this.HNe&&u.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.HNe=window.requestIdleCallback(()=>{this.Scf(b)})):window.requestAnimationFrame(()=>{this.Scf(b)}),this.Y_g=this.j$,this.F0g=b,this.o0g=this.VM)}}Object(m.a)(Tj,"ReactSaveStatusUIHandler",
null,[689]);class Hp{constructor(b,h){this.vX=null;this.jXa=CommonUIStrings.l_SavedStatus;this.kXa=CommonUIStrings.l_SavingStatus;this.RWa=CommonUIStrings.l_ReadOnlyStatus;this.fXa=CommonUIStrings.l_ReviewModeStatus;this.v$a=h;this.pda=b;this.VM=3;this.Dbb=!0}bF(){this.pda&&this.pda.execute(b=>{b.Mcb(Object(z.a)(this,this.C$c,"updateToSavingStatus"))});this.v$a.execute(b=>{this.vX=b})}opb(b,h){this.VM=h;3===h?this.CTa(this.Dbb):2===h?this.Khg(this.fXa):this.Khg(this.RWa)}C$c(){this.CTa(!1)}CTa(b){this.Dbb=
b;this.Khg(this.Dbb?this.jXa:this.kXa)}Khg(b){this.vX&&this.vX.sendMessage(K.a.EIo,this.eYk(b))}eYk(b){const h={};h.StatusText=b;return h}}Object(m.a)(Hp,"SaveStatusPostMessageHandler",null,[689]);var Fo=c(227),om=c(119);class Om{constructor(b,h,t,A){this.fXa=this.RWa=this.kXa=this.jXa=null;this.nub=0;this.hZ=this.POe=this.rqb=this.are=this.cTe=null;this.kg=b;this.p$a=h;this.pda=t;this.Zl=A;this.cYg=!0;this.j$=!1;this.VM=3;this.Dbb=!0}initialize(b,h){if(!this.kg)return!1;this.jXa=this.qrf(b,h);this.kXa=
CommonUIStrings.l_SavingStatus;this.RWa=CommonUIStrings.l_ReadOnlyStatus;this.fXa=CommonUIStrings.l_ReviewModeStatus;this.bF();return!0}qrf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}bF(){this.p$a&&this.p$a.execute(b=>{b.Crk(Object(z.a)(this,this.jJh,"createStatusAndModeElements"));b.nrk(Object(z.a)(this,this.gpo,"showHideSaveStatusElement"));b.PDo&&this.jJh(null,
null)});this.pda&&this.pda.execute(b=>{b.Mcb(Object(z.a)(this,this.C$c,"updateToSavingStatus"))})}Jia(){this.hZ&&this.kg&&this.kg.Aya(this.hZ)}gpo(b,h){this.opb("true"===h,this.VM)}opb(b,h){this.j$=b;this.VM=h;this.are&&(this.are.style.display=this.j$||3===this.VM||!this.cTe?"none":"");this.rqb&&(this.rqb.style.display=this.j$||3===this.VM?"none":"",this.rqb.innerText=1===this.VM?this.RWa:this.fXa,this.rqb.title=1===this.VM?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);
this.POe&&(this.POe.style.display=this.j$||1===this.VM||!this.cTe&&!this.rqb?"none":"");this.hZ&&(this.hZ.style.display=this.j$||1===this.VM?"none":"",this.CTa(this.Dbb),this.hZ.title=CommonUIStrings.l_SaveStatusTooltip)}jJh(b,h){b=document.getElementById(Fo.CuiHelper.Ejm);h&&h.cXo||!b||""===this.jXa||""===this.kXa||""===this.RWa||""===this.fXa||(this.cTe=document.getElementById(Fo.CuiHelper.m2e),this.are=Fo.CuiHelper.gFd(b,"BreadcrumbAppModeDash","-"),this.rqb=Fo.CuiHelper.gFd(b,"BreadcrumbAppModeStatus",
1===this.VM?this.RWa:this.fXa),this.Zyj(this.rqb),this.POe=Fo.CuiHelper.gFd(b,"BreadcrumbSaveStatusDash","-"),this.hZ=Fo.CuiHelper.gFd(b,"BreadcrumbSaveStatus",this.jXa),this.Zyj(this.hZ),this.opb(this.j$,this.VM))}C$c(){this.CTa(!1)}CTa(b){this.Dbb=b;this.QQo(this.Dbb?this.jXa:this.kXa)}QQo(b){!this.hZ||3!==this.VM&&2!==this.VM||(this.cYg&&!this.Dbb?(this.nub=this.hZ.offsetWidth<this.nub?this.nub:this.hZ.offsetWidth,this.yLo(this.kXa),this.cYg=!1):this.hZ.innerText=b)}Zyj(b){b.style.direction=this.Zl?
"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.Zl?"right":"left";b.style.display=this.j$?"none":"";b.setAttribute("Unselectable","on")}yLo(b){this.hZ&&(this.hZ.style.width="",this.hZ.innerText=b,this.nub=this.hZ.offsetWidth<this.nub?this.nub:this.hZ.offsetWidth,b=om.a.mC(this.hZ),this.hZ.style.width=this.nub-vc.a.zM(b.paddingLeft)-vc.a.zM(b.paddingRight)+1+"px")}}Object(m.a)(Om,"SaveStatusUIHandler",null,[689]);var Ln=c(73);class Qp{constructor(){this.QOe=this.VMe=this.JLa=this.W=null}get name(){return"Common.App.SaveStatus"}yc(b){this.W=
b;v.AFrameworkApplication.K.$("PostMessageEmbedded")&&v.AFrameworkApplication.tX?this.W.register(Hp,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Qd(()=>new Hp(this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"),this.W.Sa("Postmessage.IHostPostmessenger"))):v.AFrameworkApplication.ta.Ob.YDf||(v.AFrameworkApplication.ta.Ob.ZI?this.W.register(Tj,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Qd(()=>
new Tj(this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(Om,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Qd(()=>new Om(Ln.EventHandlerManager.instance,this.W.Sa("Common.App.Header.HeaderEventSource"),this.W.Sa("Common.App.HostNotification.EditNotificationEventSource"),v.AFrameworkApplication.isRtl)))}init(){v.AFrameworkApplication.K.Wo(Object(z.a)(this,this.zx,"onFullAppSettingsReady"))}zx(){const b=
v.AFrameworkApplication.K,h=!!v.AFrameworkApplication.ta.Ob&&4===v.AFrameworkApplication.ta.Ob.jm;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))v.AFrameworkApplication.K.$("PostMessageEmbedded")&&v.AFrameworkApplication.tX?(this.QOe=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.QOe.bF():v.AFrameworkApplication.ta.Ob.YDf||
b.$("PreventSaveStatusInitializationWithHiddenHeader")&&v.AFrameworkApplication.hideHeader||(v.AFrameworkApplication.ta.Ob.ZI?(this.VMe=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.VMe.initialize(b.$("IsSkyDrive"),b.kb("HostNameToIncludeInSavedStatus"),v.AFrameworkApplication.K):(this.JLa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.JLa.initialize(b.$("IsSkyDrive"),b.kb("HostNameToIncludeInSavedStatus")))}dispose(){this.JLa&&this.JLa.Jia()}}Object(m.a)(Qp,
"PackageManager",null,[1,2]);var Wn=c(1637);class jj{get name(){return"Common.App.EventsCachePackage"}yc(){}init(){Wn.a.instance.init()}dispose(){}static main(){P.a.instance.Gc(new jj)}}Object(m.a)(jj,"EventsCachePackage",null,[1,2]);var rk=c(113),Yh=c(148),Uj=c(99),Ck=c(643),Ng=c(337),Pm=c(481),ka=c(308),Za=c(27),Cb=c(257),Rb=c(25);class sc{constructor(b){this.iXg=!1;this.mcd=this.lm=null;this.$pe=!1;this.$D=b}get control(){return this.$D}get Od(){return this.control.Od}get root(){return this.control.root}get EH(){return this.control.EH}get bYa(){return this.control.bYa}get qk(){return this.control.qk}get uE(){return this.control.uE}rI(){}initialize(){}Ew(b,
h,t){this.control.Zhl(b,h,t)}qm(){Za.c(this.control.Bh.Command)||this.Xt(this.control.Bh.Command,null,null)}Xt(b,h,t){let A=0;this.root&&(A=this.root.Zoa(b,h,t));this.control.enabled=0<(A&1);return A}l7a(){let b=this.control.visible;this.root.VSa&&(b=this.Od[Cb.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.Occ=!0));return b}ijg(){const b=Rb.a.uqa(this.Od[Cb.a.labelText],this.control.Bh.LabelText);this.Qee(b)}Qee(b){this.control.labelText!==b&&(this.uE.forEach(h=>{h.Qee(b)}),
this.control.labelText=b,this.root.I3a=!0)}LPb(){const b=Rb.a.uqa(this.Od[Cb.a.alt],this.control.Bh.Alt);this.$hc(b)}$hc(b){this.control.tooltip!==b&&(this.uE.forEach(h=>{h.$hc(b)}),this.control.tooltip=b)}Nia(){const b=Rb.a.uqa(this.Od[Ck.a.Image16by16Class],this.control.Bh.Image16by16Class),h=Rb.a.uqa(this.Od[Ck.a.Image32by32Class],this.control.Bh.Image32by32Class);var t=Rb.a.uqa(this.Od[Ck.a.Image48by48Class],this.control.Bh.Image48by48Class);t=Za.b(t)?h:t;this.mDc(this.uE.small,b);this.mDc(this.uE.medium,
b);this.mDc(this.uE.large,h);this.mDc(this.uE.aso,b);this.mDc(this.uE.jbc,t)}mDc(b,h){!b||Za.c(b.fQ)||Za.c(h)||b.fQ.className===h||(b.fQ.className=h)}kNo(b){if(!Za.b(b)&&this.root.Tdg){for(const h of this.control.R6e){const t=h.lT===b;t&&(this.control.lWe=h);this.control.visible&&(h.DA=t)}this.control.visible&&(this.root.I3a=!0)}}otk(){if(this.uE.jbc&&this.uE.jbc.WN&&this.uE.jbc.ifb){const b=this.uE.jbc.WN,h=Rb.a.uqa(this.Od[Ng.a.Description],this.control.Bh.Description);Za.b(h)&&(b.style.position=
"relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.qk;Object(hc.a)(Pm.a,b)?this.EH.jpb(b):this.root.Xzb=this.control;return!1}onBlur(){const b=this.qk;this.control.UGb()&&Rb.a.dw(b.Pc,"cui-ctl-menu-hovered-without-focus");this.root.Xzb=null;return!1}DO(b){if(this.control.UGb()){var h=this.EH.Upa;const t=h===this.root.BIb-1;h=t?null:this.root.yC[h+1];this.K5e(!1);t||this.control===h||Rb.a.dw(h.FHb,ka.MenuLauncher.sXc);this.control.enabled&&
this.control.su?t?this.control.oY():(Rb.a.Xf(this.qk.Pc,"cui-ctl-menu-hovered-without-focus"),h.pfa=this.control.su):t?this.EH.setFocus(b.ig):(h.pfa=this.EH.Pc,this.EH.qpa())}return!1}iJ(){this.control.UGb()&&Rb.a.dw(this.qk.Pc,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(b){let h=!1;if(!Za.c(b.Ib)&&!Za.c(b.Ib.rawEvent)){const t=b.Ib.keyCode;b=b.Ib.rawEvent.shiftKey;t===Sys.UI.Key.enter&&(h=!0);if(Object(hc.a)(Pm.a,this.qk)){const A=this.EH;if(!Za.c(A)){const O=A.Upa,aa=0===this.root.x0,
ua=!Za.c(this.control.stn);if(t!==Sys.UI.Key.tab&&t!==Sys.UI.Key.left&&t!==Sys.UI.Key.right&&t!==Sys.UI.Key.up&&t!==Sys.UI.Key.down&&t!==Sys.UI.Key.esc)return h;ff.a.k5e();t!==Sys.UI.Key.tab||b?t===Sys.UI.Key.tab&&b?(A.sK(1),h=!0):t===Sys.UI.Key.left&&aa||t===Sys.UI.Key.right&&!aa?(ua?A.sK(2):0<O&&this.root.hZa(O,!0,!1),h=!0):t===Sys.UI.Key.right&&aa||t===Sys.UI.Key.left&&!aa?(ua&&A.sK(4),h=!0):t===Sys.UI.Key.up?(A.sK(5),h=!0):t===Sys.UI.Key.down?(A.sK(6),h=!0):t===Sys.UI.Key.esc&&(this.root.hZa(O,
!0,!1),h=!0):(A.sK(0),h=!0)}}}return h}ly(b){let h=!1;if(!Za.c(b.Ib)&&!Za.c(b.Ib.rawEvent)){const t=b.Ib.keyCode;sb.KeyInputManager.uii(b)||t!==Sys.UI.Key.enter&&t!==Sys.UI.Key.space||(h=this.$tf(b),h||(this.Ew(b.zf,1,b.Ib),h=!0))}return h}zC(b){this.G6e();if(this.bYa){let h=!0;2===b.ig&&(h=b.Cba===Sys.UI.MouseButton.leftButton);h&&this.qk&&this.rxd(this.qk.Pc)}(b.Ib.type.toLowerCase()!==db.a.YO||this.bYa)&&b.Ib.preventDefault();return!1}get Czf(){return this.iXg}mml(){this.iXg=!0}G6e(){this.Czf&&
this.control.root.Ydb()}Uwa(b){Object(hc.a)(Pm.a,this.qk)&&!this.bYa&&2===b.ig&&b.Cba===Sys.UI.MouseButton.leftButton?(this.Ew(b.zf,b.ig,b.Ib),b=!0):b=this.control.hua(b);return b}onClick(b){let h=!1;Object(hc.a)(Pm.a,this.qk)&&!this.bYa&&3===b.ig&&(this.Ew(b.zf,b.ig,b.Ib),h=!0);return ba.a.si?!1:h}qlb(b){return this.q4d(b)}dGa(b){this.hua(b);return!1}q4d(b){return Za.c(this.lm)?!1:(this.F7f(ff.a.jYd(this.ljh,b.clientPoint)),!0)}Adc(b){let h=!1;this.hua(b)&&(h=!0);3!==b.ig&&(b=!0,!this.root&&sc.UOf&&
(u.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.I2(),h=!0);return h}Ddc(b){return this.hua(b)}Bdc(b){return this.q4d(b)}Cdc(b){return this.hua(b)}ydc(b){return 3===b.ig?(this.root.I2(),!0):!1}zdc(){return!1}get ljh(){!Za.c(this.lm)&&Za.c(this.mcd)&&(this.mcd=ff.a.getElementBounds(this.lm));return this.mcd}F7f(b){this.$pe!==b&&(this.$pe=b,this.mWe(this.$pe))}mWe(b){Za.c(this.lm)||Rb.a.P4(this.lm,Uj.Control.uxd,b)}rxd(b){this.control.enabled&&(this.lm=b,this.root.mCc=this.control,
this.F7f(!0),this.root.Gea(this.control,!1))}hua(b){if(!Za.c(this.lm)){this.F7f(!1);let h=!!this.root;if(sc.UOf){const t=Kf.ActionManager.Q$(parseInt(this.control.Bh.Command))||"";u.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",h,t)}h&&this.root.zaa(this.control,!1);Za.c(b)||ff.a.jYd(this.ljh,b.clientPoint)&&this.Ew(this.lm,b.ig,b.Ib);h=!!this.root;sc.UOf&&u.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.mCc=null);this.mcd=this.lm=null;return!0}return!1}sK(b){return Object(hc.a)(Pm.a,
this.qk)&&2!==b&&4!==b&&!ff.a.x9b(this.control.su)?this.oY():!1}oY(){try{if(this.control.visible){const b=this.control.su;if(!Za.c(b))return b.focus(),!0}}catch(b){}return!1}K5e(b){const h=this.EH;Za.c(h)||this.root.hZa(h.Upa+1,b)}Doa(){}$tf(){return!1}lX(b){let h=null;b&&b.rawEvent&&(h={},h[sc.triggerTime]=b.rawEvent.timeStamp);return h}static get UOf(){null==sc.cJe&&(sc.cJe=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return sc.cJe}}
sc.triggerTime="TriggerTime";sc.cJe=null;Object(m.a)(sc,"ControlBehavior",null,[678]);var Wc=c(140);class xd extends sc{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.Bh}rI(b){const h=b.Im;b=b.lT;Za.c(h)||(md.a.instance.mb(db.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus")),md.a.instance.mb(db.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur")),Yh.a.instance.mb(db.a.pointerOver,h,Object(z.a)(this,this.DO,"onPointerOver")),Yh.a.instance.mb(db.a.pointerOut,
h,Object(z.a)(this,this.iJ,"onPointerOut")),sb.KeyInputManager.instance.JD(db.a.fi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"),b),sb.KeyInputManager.instance.JD(db.a.St,h,Object(z.a)(this,this.lG,"onKeyPress"),b),sb.KeyInputManager.instance.JD(db.a.sh,h,Object(z.a)(this,this.ly,"onKeyUp"),b),Yh.a.instance.mb(db.a.pointerDown,h,Object(z.a)(this,this.zC,"onPointerDown")),Yh.a.instance.mb(db.a.AM,h,Object(z.a)(this,this.Uwa,"onPointerUp")),Pd.a.instance.mb(db.a.click,h,Object(z.a)(this,this.onClick,
"onClick")),Wc.a.instance.mb(db.a.XO,h,Object(z.a)(this,this.qlb,"onTouchMove")),Wc.a.instance.mb(db.a.yJ,h,Object(z.a)(this,this.dGa,"onTouchEnd")))}Ew(b,h,t){this.control.enabled&&(b=null,this.qk&&this.qk.mTc()&&this.EH&&(b=this.root.yC[this.EH.Upa])&&!this.Czf&&(b.nSa(this.button),b=null),this.executeCommand(this.control.Bh.Command,h,!0,t),b&&b.nSa(this.button))}executeCommand(b,h,t,A){if(!Za.c(b)){const O=this.Od;O.CommandValueId=this.button.NCb();O.MenuItemId=this.button.Bh.MenuItemId;O.SourceControlId=
this.control.id;this.root.executeCommand(b,O,this.qk,h,t,null,this.lX(A))}}qm(){Za.c(this.control.Bh.Command)||0<(this.Xt(this.properties.Command,this.properties.QueryCommand,this.Od)&2)&&this.l7a()&&this.zTa()}zTa(){this.ijg();this.LPb();this.Nia()}onFocus(b){super.onFocus(b);this.Tcg();return!1}onBlur(b){super.onBlur(b);this.fff();return!1}onKeyDown(b){let h=super.onKeyDown(b);Za.c(b.Ib)||this.L$f(b.Io,b.Ib.keyCode)&&(h=!1);return h}lG(b){let h=!1;Za.c(b.Ib)||Za.c(b.Ib.rawEvent)||(this.L$f(b.Io,
b.Ib.rawEvent.keyCode)?(this.Ew(b.zf,b.ig,b.Ib),h=!0):b.Ib.preventDefault());return h}L$f(b,h){if(ba.a.jt&&h===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}ly(b){let h=!1;Za.c(b.Ib)||this.L$f(b.Io,b.Ib.keyCode)||(h=super.ly(b));return h}Tcg(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}fff(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(m.a)(xd,
"ButtonBehavior",sc,[]);var oe=c(978);class Nd{}Nd.Color="Color";Nd.IndexColorSelected="ColorSelected";Object(m.a)(Nd,"ColorPickerCommandProperties",null,[]);class $e extends sc{constructor(b){super(b);this.Czc=this.kv=-1}get colorPicker(){return this.control}get VMa(){return this.colorPicker.eUk.VMa}get properties(){return this.colorPicker.Bh}Ew(b,h,t){if(this.control.enabled){const A=this.Od;A.Color=$e.gPd(b)[oe.ColorPicker.hDd];b=null;Rb.a.Fr(this.properties.Stateful)&&this.qk&&this.qk.mTc()&&
this.EH&&(b=this.root.yC[this.EH.Upa]);this.root.executeCommand(this.properties.Command,A,this.qk,h,!0,null,this.lX(t));b&&b.nSa(this.colorPicker)}}qm(){var b=this.Od;b.SourceControlId=this.properties.Id;if(0<(this.Xt(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,Nd.IndexColorSelected in this.Od&&(b=this.Od[Nd.IndexColorSelected]),b!==this.Czc)){const h=this.VMa;0<=b&&b<h.length&&this.nyj(h[b],!0);0<=this.Czc&&this.Czc<h.length&&this.nyj(h[this.Czc],!1);this.Czc=b}}nyj(b,h){h?
Rb.a.Xf(b,"cui-colorpicker-selected"):Rb.a.dw(b,"cui-colorpicker-selected")}rI(b){for(let h=0;h<b.RVe.length;++h){const t=b.RVe[h];md.a.instance.mb(db.a.focus,t,Object(z.a)(this,this.mQf,"onCellFocus"));md.a.instance.mb(db.a.blur,t,Object(z.a)(this,this.kfn,"onCellBlur"));sb.KeyInputManager.instance.mb(db.a.fi,t,Object(z.a)(this,this.onKeyDown,"onKeyDown"));sb.KeyInputManager.instance.mb(db.a.sh,t,Object(z.a)(this,this.ly,"onKeyUp"));Pd.a.instance.mb(db.a.click,t,Object(z.a)(this,this.lfn,"onCellClick"));
Yh.a.instance.mb(db.a.AM,t,Object(z.a)(this,this.oQf,"onCellPointerUp"));Yh.a.instance.mb(db.a.pointerOver,t,Object(z.a)(this,this.nQf,"onCellPointerOver"));Yh.a.instance.mb(db.a.pointerDown,t,Object(z.a)(this,this.mfn,"onCellPointerDown"))}}mQf(b){b=$e.gPd(b.zf);this.EH.jpb(this.qk);this.Kle(b,!0);return!0}kfn(b){this.Kle($e.gPd(b.zf),!1);return!0}Kle(b,h){h?(this.kv=parseInt(b.getAttribute("arrayPosition")),Rb.a.Xf(b,"cui-colorpicker-hoveredOver"),this.Tcg(b)):(this.kv=-1,this.fff(b),Rb.a.dw(b,
"cui-colorpicker-hoveredOver"))}lfn(b){3===b.ig&&this.Ew(b.zf,b.ig,b.Ib);return!0}oQf(b){3!==b.ig&&this.Ew(b.zf,b.ig,b.Ib);return!0}nQf(b){this.K5e(!1);b=parseInt($e.gPd(b.zf).getAttribute("arrayPosition"));this.r5c(b);return!0}mfn(){return!1}Tcg(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!Za.b(h)){const t=this.Od;t.Color=b[oe.ColorPicker.hDd];this.root.executeCommand(h,t,this.qk,0,!1)}}}fff(b){if(this.control.enabled){const h=this.properties.CommandRevert;if(!Za.b(h)){const t=
this.Od;t.Color=b[oe.ColorPicker.hDd];this.root.executeCommand(h,t,this.qk,0,!1)}}}sK(b){b=Uj.Control.Tif(this.kv,this.colorPicker.width,this.VMa.length,b);if(b!==this.kv&&this.r5c(b))return!0;this.Kle(this.VMa[this.kv],!1);return!1}oY(){return this.r5c(0)}r5c(b){return this.VMa&&this.VMa.length>b&&(b=this.VMa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}Doa(){-1!==this.kv&&this.Kle(this.VMa[this.kv],!1)}static gPd(b){return $e.cXl(b)}static cXl(b){var h=["td"];const t=h.length;if(!b)return null;
for(var A=0;A<t;A++)if(b.tagName.toLowerCase()===h[A].toLowerCase())return b;for(b=b.parentNode;b;){for(A=0;A<t;A++)if(b.tagName.toLowerCase()===h[A].toLowerCase())return b;b=b.parentNode}return null}}Object(m.a)($e,"ColorPickerBehavior",sc,[]);var hf=c(285),bg=c(287),Dg=c(1660),Zh=c(697),zh=c(402),zi=c(1125);class Ti{constructor(b,h){this.lfk=b;this.VWg=h}yee(b,h,t,A){if(Za.c(b)||Za.c(h))return null;const O=new zi.a;const aa=A.x;var ua=A.y;const Ra=A.width;var ub=A.height;let Nb;Ti.K3b(h,"flyoutWidth");
A=Ti.K3b(h,"flyoutRealHeight");const Yb=Ti.K3b(h,"viewportWidth");var bc=Ti.K3b(h,"viewportHeight"),Dc=Ti.K3b(h,"viewableLeft");const Pc=Ti.K3b(h,"viewableTop"),jd=this.lfk;let Cd=!1,ee=!1;const Od=1===t,fe=4===t,Ee=this.VWg;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Nb=this.mHi(b);O.sDj=bc;O.dlg=Yb;if(Od)jd?h=aa+Ra:(h=aa-Nb,O.Ojb=!0),ub=ua;else{var re="";Ra>Nb&&(Nb=Ra,re=(Nb-2*zh.Menu.u2d).toString());jd?h=aa:(h=aa+Ra-Nb,O.Ojb=!0);ub=ua+ub;""!==re&&
(b.style.minWidth=re+"px")}Ee&&(ub+=Pc,h+=Dc);b.style.top=ub+"px";b.style.left=h+"px";let Fg=!1;re=!1;Nb<=Yb?h+Nb>Dc+Yb?(Od&&jd&&aa-Nb>Dc||fe&&aa-Nb>Dc?(h=aa-Nb,Ee&&(h+=Dc),re=O.Ojb=!0):(h=Dc+Yb-Nb,Cd=!0),Fg=!0):h<Dc&&(Od&&!jd&&aa+Ra+Nb<Dc+Yb?(h=aa+Ra,Ee&&(h+=Dc),O.Ojb=!1,re=!0):(h=Dc,ee=!0,O.Ojb=!0),Fg=!0):jd?(h=Dc,Fg=!0,O.Ojb=!0):(h=Dc+Yb-Nb,Fg=!0,O.Ojb=!1);Fg&&(b.style.left=h+"px");O.q5b=ub;ub+A<=Pc+bc&&3!==t||(O.pGf=!0,{R$m:t,vyl:ua,ACm:bc,sJm:Dc}=this.qif(t,ub,A,ua,Pc,bc),ub!==t&&(b.style.top=
t+"px",O.q5b=t),-1<ua&&(b.style.maxHeight=ua+"px"),bc&&(b.style.bottom="0px",b.style.height="auto"),Dc&&this.l3m(b,jd,Od,re,ee,Cd,Yb,aa,Ra));O.mLc=h;O.Qif=Nb;O.Nif=A;return O}qif(b,h,t,A,O,aa){let ua,Ra,ub;ua=-1;ub=Ra=!1;const Nb=h,Yb=O+aa-h;h=A-t;const bc=this.VWg;let Dc=!1;0>h&&(h=O);bc||(A-=O);t<=A&&1!==b||(4===b||1===b?t<aa?(h=aa-t,Ra=!0):(h=O,Dc=ub=Ra=!0):(A<Yb&&3!==b?(h=Nb,Ra=!0):ua=A,ub=!0));bc&&(Ra=!1,Dc?ua=aa:h+=O);return{R$m:h,vyl:ua,ACm:Ra,sJm:ub}}l3m(b,h,t,A,O,aa,ua,Ra,ub){b.style.overflowY=
"scroll";b.style.width="auto";if(h){if(aa||A)b.style.left="",b.style.right=(aa?0:ua-Ra)+"px"}else O||A||(b.style.left="",b.style.right=(t?ua-Ra:ua-Ra-ub)+"px")}JMl(b){const h={};if(Za.c(b))return h;h.viewportWidth=vc.a.kEb();h.viewportHeight=vc.a.mX();Za.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);Za.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=document.body.clientHeight);h.viewableTop=
window.pageYOffset;h.viewableLeft=window.pageXOffset;Za.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);Za.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*zh.Menu.u2d:b.scrollHeight;const t=b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.mHi(b);b.style.overflowY=t;return h}mHi(b){return b.offsetWidth}static K3b(b,
h){return Za.c(b)?0:b[h]}}Object(m.a)(Ti,"MenuPositioner",null,[]);var Il=c(537),mi=c(626),pm=c(1127),po=c(1126),$m=c(1123),pn=c(1124),pp=c(1129),Vo=c(417),Xn=c(976);class Lj extends sc{constructor(b){super(b);this.YHe=0;this.S_g=null;this.uLe=-1;this.xgd=null;this.HWf=this.ZTg=!1;this.e5j=new Ti(0===this.root.x0,Rb.a.Fr(this.root.properties.DivSyndicated))}get BHi(){return this.e5j}get zu(){return this.control}get properties(){return this.control.Bh}get menu(){return this.zu.menu}set menu(b){this.zu.menu=
b}get KK(){return this.zu.KK}set KK(b){this.zu.KK=b}get zsh(){Za.c(this.xgd)&&(this.xgd=Lj.Y3k());return this.xgd}get qkj(){let b=!this.root.Mwf;Object(hc.a)(164,this.root)&&1===this.root.BIb&&(b=!0);return b}Ew(b,h){Object(hc.a)(164,this.root)&&this.root.xff();this.zu.x_(h)}x_(b){if(this.zu.enabled&&!this.KK){var h=zk.a.instance.vp(ab.a.x_);h.properties.add("Id",this.zu.Bh.Id);h.properties.add("InputMethod",hf.a[b]);h.end();Ok.a.mark(10326);ff.a.r2d(this.zu.Bh.Id,"MenuOpen");this.zu.su&&(this.zu.pfa=
ff.a.dOa(this.zu.su.ownerDocument));this.YHe=b;this.BWi(b);this.Pde();this.zu.b7a(this.zu.su,!0)}}Pde(){Za.c(this.properties.PopulateAsyncTriggerCommand)||this.ZTg||(this.Bbn(),this.ZTg=!0)}Bbn(){const b={};b[Dg.a.Callback]=Object(z.a)(this,this.h2i,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.qk,0,!1)}h2i(){this.zu.HRa()}HRa(){this.KK&&this.BWi(this.YHe,!0)}BWi(b,h=!1){var t=!0;if(Rb.a.Fr(this.properties.PopulateDynamically)){t=!1;const A=this.Y_c(b);
A!==this.S_g&&(t=this.WWf(A,h));t=t||!this.KK}t&&(h=v.AFrameworkApplication.ta.xq,t=null,h&&(t=h.eg("LoadResource","Menu Initialization")),this.AEa(b),t&&t.stop(),this.E5d())}AEa(b){if(!Za.c(this.menu)){if(this.zu.m4a){var h=this.zu.qk;if(h&&h.keytip){var t=h.keytip.key.toLocaleLowerCase();this.menu.qeo(String.format("{0} {1}",this.zu.m4a,h.keytip.Eef),this.zu.kRa&&""!==this.zu.kRa?String.format("{0}-{1}",this.zu.kRa,t):t)}}this.menu.jma();Rb.a.Xf(this.menu.Pc,this.zu.OYe);Rb.a.P4(this.menu.Pc,"cui-touch",
3===b||this.root.qke);if(this.menu.hasItems()){this.menu.rI();h=this.qk;h.qSh();h.tQc=!0;h.Qf(this.menu);h.tQc=!1;this.menu.wWi();t=Object(hc.a)(Xn.a,this.root);var A=null,O=!1;t&&(A=this.root,O=A.U5a,A.U5a=!1);var aa=this.menu.Pc;aa.style.visibility="hidden";aa.style.position="absolute";aa.style.top="0px";aa.style.left="0px";ba.a.jt&&!ba.a.Tib&&(aa.style.maxHeight="100px",aa.style.overflowY="scroll");document.body.appendChild(aa);this.stk();this.Xxn(aa);Sys.Browser.agent===Sys.Browser.InternetExplorer&&
this.Djk();Rb.a.Xf(this.zu.FHb,ka.MenuLauncher.sXc);var ua=this.root.BIb;this.Oko&&this.root.Gea(this.control,!0);aa.style.zIndex=String(v.AFrameworkApplication.ta.Vsa);this.root.nmk(this.zu);this.menu.Upa=ua;aa.style.visibility="visible";ua=this.H1h();if(Object(hc.a)(pn.a,this.menu)){aa.style.position="fixed";const Ra=this.root.yC[0];Ra&&Ra.menu&&Ra.menu.Pc?100!==ff.a.LNc(this.root.yC[0].menu.Pc)&&bg.a.lbg(aa,ua,Object(z.a)(this,this.ZYe,"afterShowMenu")):bg.a.lbg(aa,ua,Object(z.a)(this,this.ZYe,
"afterShowMenu"))}else bg.a.lbg(aa,ua,Object(z.a)(this,this.ZYe,"afterShowMenu"));this.KK=!0;this.menu.oGf=!0;!ba.a.si&&this.zu.q7n&&this.menu.setFocus(b);t&&(A.U5a=O);t=this.properties.CommandMenuOpen;Za.b(t)||this.root.executeCommand(t,null,h,b,!1)}}Ok.a.mark(10327)}E5d(){}Djk(){this.uLe=Rb.a.ozb(this.uLe);this.uLe=window.setTimeout(Object(z.a)(this,this.Ejk,"addAndPositionBackFrameInternal"),50)}Ejk(){this.menu&&this.menu.Pc&&(document.body.appendChild(this.zsh),this.Txn())}Txn(){const b=this.zsh;
var h=this.menu.Pc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let t=h.offsetWidth;h=h.offsetHeight;ba.a.Tib&&(t-=4,h-=4);b.style.width=t.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get Oko(){return this.root.BIb?!1:!0}ZYe(b){b.element&&(b.element.style.filter="",b.element.style.opacity="",this.menu&&this.menu.Pc===b.element&&Object(hc.a)($m.a,this.menu)&&
bg.a.evk(this.H1h()))}H1h(){const b=this.menu.children,h=[];if(Object(hc.a)($m.a,this.menu))for(let t=0;t<b.count;t++){const A=b.J(t);Array.add(h,A.separator);for(let O=0;O<A.children.count;O++){const aa=A.children.J(O);Array.add(h,aa.Pc)}}return h}stk(){var b=this.menu.children;for(let t=0;t<b.count;t++){const A=b.J(t).children;for(let O=0;O<A.count;O++){var h=A.J(O);if(Object(hc.a)(Pm.a,h)){const aa=h;if("Menu32"===aa.lT||"Menu48"===aa.lT)h=h.control,h.behavior&&(Object(hc.a)(mi.a,h)||Object(hc.a)(po.a,
h))&&h.behavior.otk()}}}0<b.count&&(b=b.J(0),Za.c(b.separator)||(b.separator.style.display="none"),Za.c(b.Wje)||Rb.a.Xf(b.Wje,"cui-menusection-titleAtTop"))}Xxn(b){if(!Za.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom="";b.style.right="";b.style.width="";b.style.minWidth="";var h=Zh.a.create();try{const t=this.BHi.JMl(b),A=this.vNc();let O=this.root.yee(b,t,this.zu.v2d,A);O||(O=this.BHi.yee(b,t,this.zu.v2d,A));this.root.CHi=O}finally{h&&h.dispose()}}}vNc(){const b=ff.a.getElementBounds(this.zu.FHb);
var h=this.EH;Za.c(h)||Za.c(h.Pc)||(h=ff.a.getElementBounds(h.Pc),b.x=h.x+zh.Menu.u2d,b.width=h.width-2*zh.Menu.u2d);Object(hc.a)(Vo.a,this.zu.d_d)&&(b.height=0);return b}Cta(){if(this.zu.KK){u.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{["Id"]:this.zu.Bh.Id});this.menu.Doa();this.K4i();this.KK=!1;this.menu.oGf=!1;this.root.zaa(this.control,!0);this.qkj?v.AFrameworkApplication.ta.P3c(this.zu.pfa,this.YHe):this.n0n();this.zu.pfa=null;var b=this.zu.FHb;Rb.a.dw(b,ka.MenuLauncher.sXc);this.zu.b7a(this.zu.su,
!1);Rb.a.dw(b,"cui-ctl-menu-hovered-without-focus");this.menu.qpa();Za.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.qk,0,!1);this.J4i()}}n0n(){const b=this.zu.pfa;if(b)try{b.focus()}catch(h){}}J4i(){vc.a.Pw(this.menu.Pc);vc.a.Pw(this.xgd);Rb.a.Aya(this.menu.Pc)}Y_c(b){if(this.HWf&&Rb.a.Fr(this.properties.PopulateOnlyOnce)||Za.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.zu.$lf();return 0<(this.root.Zoa(this.properties.PopulateQueryCommand,
this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}WWf(b,h=!1){if(this.HWf&&Rb.a.Fr(this.properties.PopulateOnlyOnce))return!0;let t=null;this.S_g=b;Za.c(b)||(t=this.g5k(b));Za.c(t)||(this.HWf=!0);if(h){this.root.lRk(this.zu);if(Za.c(t)||!t.hasItems())return this.Cta(),!1;this.K4i();this.J4i()}this.tdo(t);return!0}INi(){}g5k(b){b=Il.Builder.CFh(b);if(!Za.c(b)){const h=new pp.a;h.fBh=!0;h.parentId=this.control.id;let t;t=Object(hc.a)(pm.a,this.control);return this.root.EN.LYa(b,h,t)}return null}tdo(b){Za.c(b)||
(Za.c(this.menu)||this.menu.dispose(),this.menu=b,this.INi())}K4i(){const b=this.menu.parent;b?(b.tQc=!0,b.removeChild(this.menu.id),b.tQc=!1):u.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(b){let h=!1;Za.c(b.Ib)||Za.c(b.Ib.rawEvent)||Object(hc.a)(Pm.a,this.qk)||!b.Ib.rawEvent.altKey||b.Ib.keyCode!==Sys.UI.Key.down||(this.Ew(b.zf,1,b.Ib),h=!0);h||(h=super.onKeyDown(b));return h}zC(b){this.G6e();2===b.ig&&b.Cba!==Sys.UI.MouseButton.leftButton||
this.Ew(b.zf,b.ig,b.Ib);b.Ib.preventDefault();return!1}$tf(b){if(!this.EH||!this.EH.inKeytipMode||!this.zu.VOi)return!1;this.zu.VOi(this.qk,b);return!0}static Y3k(){const b=Rb.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(m.a)(Lj,"MenuLauncherBehavior",sc,[707,678]);var Mn=c(923);class qp extends Lj{constructor(b){super(b)}get Ss(){return this.aJc.properties}get aJc(){return this.control}get yNa(){return this.aJc.yNa}rI(){Yh.a.instance.mb(db.a.pointerDown,
this.yNa.Im,Object(z.a)(this,this.zC,"onPointerDown"));sb.KeyInputManager.instance.mb(db.a.fi,this.yNa.Im,Object(z.a)(this,this.onKeyDown,"onKeyDown"));sb.KeyInputManager.instance.mb(db.a.sh,this.yNa.Im,Object(z.a)(this,this.ly,"onKeyUp"))}qm(){const b=this.Od[Mn.a.SelectedItemId];if(0<(this.Xt(this.Ss.Command,this.Ss.QueryCommand,this.Od)&2)){const h=this.Od[Mn.a.SelectedItemId];Za.c(h)||b===h||this.aJc.J4c(h)||(this.Od[Mn.a.SelectedItemId]=null)}}}Object(m.a)(qp,"DropDownBehavior",Lj,[]);var Hk=
c(549),Yn=c(710);class hk extends qp{constructor(b){super(b);this.eVa=null;this.HIe=this.ktb=this.qAa=!1;this.Jxc=null;this.Hxc=-1}get J2(){return this.control}get OP(){return this.J2.OP}get dH(){return this.J2.dH}get YWd(){return this.Od[Hk.a.IsFreeForm]}set YWd(b){this.Od[Hk.a.IsFreeForm]=b}rI(b){Yh.a.instance.mb(db.a.pointerDown,b.Im,Object(z.a)(this,this.zC,"onPointerDown"));const h=b.gr;md.a.instance.mb(db.a.focus,h,Object(z.a)(this,this.dlb,"onInputFocus"));md.a.instance.mb(db.a.blur,h,Object(z.a)(this,
this.Twa,"onInputBlur"));sb.KeyInputManager.instance.mb(db.a.fi,h,Object(z.a)(this,this.Vin,"onInputKeyDown"));sb.KeyInputManager.instance.mb(db.a.St,h,Object(z.a)(this,this.Win,"onInputKeyPress"));Ud.a.instance.mb(db.a.Eba,h,Object(z.a)(this,this.xRf,"onInputMouseUp"));Yh.a.instance.mb(db.a.pointerDown,h,Object(z.a)(this,this.Yin,"onInputPointerDown"));Yh.a.instance.mb(db.a.pointerDown,b.WQh,Object(z.a)(this,this.XRf,"onMenuButtonPointerDown"))}qm(){0<(this.Xt(this.dH.Command,this.dH.QueryCommand,
this.Od)&2)&&(this.ktb||this.xBj(),this.ONo())}INi(){this.J2.menuItems=null;var b;var h=b=null;if(!Za.c(this.menu)){this.bee();for(let A of this.menu.children)for(let O of A.children)if(Object(hc.a)(Pm.a,O)){var t=O;t=t.control;Object(hc.a)(682,t)&&(b=t,b=b.Bh.MenuItemId);Object(hc.a)(675,t)&&(h=t,h=h.L0a());Za.c(b)||Za.c(h)||(this.J2.menuItems[h]=b,b=h=null)}}}Yin(b){Object(hc.a)(164,this.root)&&2===b.ig&&(this.eVa=ff.a.dOa(this.control.su.ownerDocument),this.control.su.focus());return!1}zC(b){this.G6e();
let h=!1;3===b.ig&&(h=super.zC(b),this.bee());h&&b.Ib.preventDefault();return!1}XRf(b){let h=!1;if(2!==b.ig||b.Cba===Sys.UI.MouseButton.leftButton)this.Ew(b.zf,b.ig,b.Ib),this.bee(),h=!0;h&&b.Ib.preventDefault();return!1}Vin(b){let h=!1;if(!Za.c(b.Ib)&&!Za.c(b.Ib.rawEvent)){const t=b.Ib.keyCode;b=b.Ib.rawEvent.shiftKey;Rb.a.Fr(this.dH.AutoComplete);if(t===Sys.UI.Key.enter)this.WS(),this.C4f(),Object(hc.a)(Yn.Ribbon,this.root)&&this.root.PZ(),h=!0;else if(t===Sys.UI.Key.tab){if(this.WS(),this.C4f(),
Object(hc.a)(Yn.Ribbon,this.root)&&(h=this.root.Cne(this.qk.Pc,!b)),Object(hc.a)(164,this.root))return!0}else t===Sys.UI.Key.backspace||t===Sys.UI.Key.del?this.control.enabled?(this.P3e(),this.Jxc=null):h=!0:t===Sys.UI.Key.esc?(this.G4f(),this.C4f(),Object(hc.a)(Yn.Ribbon,this.root)&&this.root.PZ(),h=!0):t===Sys.UI.Key.down&&(this.x_(1),this.bee(),h=!0)}return h}Win(b){if(!this.control.enabled)return!0;!Za.c(b.Ib)&&b.Ib.charCode&&this.nbl();return!1}xRf(){return this.qAa?!1:this.qAa=!0}Tpl(){this.Hxc=
-1;const b=this.OP.gr,h=b.value,t=this.gPl(h);if(t){b.value=t.key;if(b.setSelectionRange)b.setSelectionRange(h.length,b.value.length);else if(b.createTextRange){const A=b.createTextRange();A.moveStart("character",h.length);A.moveEnd("character",b.value.length);A.select()}this.Jxc=t.value}else this.Jxc=null}gPl(b){const h=this.J2.menuItems;for(let t in h){const A={key:t,value:h[t]};if(A.key.toLowerCase().startsWith(b.toLowerCase()))return A}return null}nbl(){Rb.a.Fr(this.dH.AutoComplete)&&-1===this.Hxc&&
(this.HIe&&(this.Y_c(0),this.HIe=!1),this.Hxc=window.setTimeout(Object(z.a)(this,this.Tpl,"executeAutoComplete"),this.J2.lBk))}P3e(){Rb.a.Fr(this.dH.AutoComplete)&&(this.Hxc=Rb.a.ozb(this.Hxc))}dlb(b){if(this.KK)return this.menu.setFocus(0),!0;Object(hc.a)(164,this.root)&&(yd.FocusManager.instance().JC("ribbon"),this.root.FPc=!1);this.onFocus(b);this.ktb=!0;Rb.a.Xf(this.OP.Im,"cui-cb-focus");Rb.a.Fr(this.dH.PopulateDynamically)&&(this.HIe=!0);ff.a.F4c(this.OP.gr);Za.c(this.menu)||this.menu.rm();return this.qAa=
!1}Twa(){this.ktb=!1;this.WS();Rb.a.dw(this.OP.Im,"cui-cb-focus");return!1}C4f(){Object(hc.a)(164,this.root)&&(void 0!==this.eVa&&null!==this.eVa&&v.AFrameworkApplication.ta.P3c(this.eVa,2),this.eVa=null)}WS(){if(this.control.enabled){this.P3e();var b=this.OP.gr;if(void 0===this.Od[Hk.a.Value]||null===this.Od[Hk.a.Value]||b.value!==this.Od[Hk.a.Value].toString())if(this.J2.J4c(this.Jxc))this.YWd=!1,this.Od[Hk.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.J2.O4c.NCb(),["MenuItemId"]:this.J2.O4c.Bh.MenuItemId},
this.root.executeCommand(this.dH.Command,b,this.qk,0,!1);else{if(!Rb.a.Fr(this.dH.AutoComplete)){var h=this.J2.menuItems[b.value];if(!Za.b(h)&&this.J2.J4c(h)){this.YWd=!1;this.Od[Hk.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.J2.O4c.NCb(),["MenuItemId"]:h};this.root.executeCommand(this.dH.Command,b,this.qk,0,!1);return}}h=!Za.b(b.value)&&""!==F.a.FGa(b.value);this.J2.koh&&h?(this.YWd=!0,this.Od[Hk.a.Value]=b.value,this.root.executeCommand(this.dH.Command,{["IsFreeForm"]:!0,["Value"]:b.value},
this.qk,0,!1)):this.G4f()}}else this.G4f()}G4f(){this.P3e();this.Jxc=null;this.xBj()}xBj(){const b=this.Od[Hk.a.Value]||"";b!==this.OP.gr.value&&(this.OP.gr.value=b);this.J2.J4c(this.J2.menuItems[b])}ONo(){const b=this.Od[Hk.a.FontStyle]||"normal";b!==this.OP.gr.style.fontStyle&&(this.OP.gr.style.fontStyle=b)}bee(){this.control.su&&this.menu&&this.control.su.setAttribute(Mf.a.trh,this.menu.id)}}Object(m.a)(hk,"ComboBoxBehavior",qp,[]);class vn extends Lj{constructor(b){super(b)}get uEd(){return this.control}vNc(){let b=
0;this.menu&&this.menu.Pc&&2===this.menu.horizontalAlignment&&(b=this.menu.Pc.clientWidth);return new Sys.UI.Bounds(this.uEd.x-b,this.uEd.y,this.uEd.rGf,this.uEd.qGf)}}Object(m.a)(vn,"ContextMenuLauncherBehavior",Lj,[]);class go extends Lj{constructor(b){super(b)}get mHd(){return this.control}vNc(){return new Sys.UI.Bounds(this.mHd.x,this.mHd.y,this.mHd.rGf,this.mHd.qGf)}}Object(m.a)(go,"DialogMenuLauncherBehavior",Lj,[]);var fp=c(625);class Go extends Lj{constructor(b){super(b);this.KIe=!1;this.Jck=
!Rb.a.sga(this.Ss.ShouldRefreshWhenDropped)}get xDa(){return this.control}get Ss(){return this.control.Bh}rI(b){b=b.Im;Za.c(b)||(md.a.instance.mb(db.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus")),md.a.instance.mb(db.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur")),Yh.a.instance.mb(db.a.pointerOver,b,Object(z.a)(this,this.DO,"onPointerOver")),sb.KeyInputManager.instance.mb(db.a.fi,b,Object(z.a)(this,this.onKeyDown,"onKeyDown")),sb.KeyInputManager.instance.mb(db.a.sh,b,Object(z.a)(this,this.ly,
"onKeyUp")),Yh.a.instance.mb(db.a.pointerDown,b,Object(z.a)(this,this.zC,"onPointerDown")))}qm(){Za.c(this.control.Bh.Command)||(this.xDa.KK&&!this.Jck?this.KIe=!0:(0<(this.Xt(this.Ss.Command,this.Ss.QueryCommand,this.Od)&2)&&this.l7a()&&this.zTa(),Rb.a.Fr(this.Ss.RefreshableMenu)&&this.KK&&this.menu.Lwn()))}zTa(){this.LNo();this.Nia();this.wOo();this.xDa.uwf=this.Od[fp.a.ImageIsVisible]}LNo(){const b=Rb.a.uqa(this.Od[fp.a.LabelText],this.Ss.LabelText),h=this.Od[fp.a.LabelTextUserGeneratedPlaceholderReplacements];
if(this.control.labelText!==b||this.Ss.LabelTextUserGeneratedPlaceholderReplacements!==h)this.uE.medium&&this.MNo(this.uE.medium.WN,b,h),this.root.I3a=!0,this.control.labelText=b,this.Ss.LabelTextUserGeneratedPlaceholderReplacements=h}MNo(b,h,t){const A=b.lastChild;Rb.a.qej(b,h+" ",t);h=Za.c(A);u.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",h?"":A.nodeType.toString());h||b.appendChild(A)}wOo(){const b=this.Od[fp.a.ImageBackColor];this.uE.forEach(h=>
{Go.ixk(h.fQ,b)})}x_(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(v.AFrameworkApplication.moa("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),v.AFrameworkApplication.xa.processAction(ab.a.qHd,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||v.AFrameworkApplication.xa.processAction(ab.a.qHd,2);Object(hc.a)(Pm.a,this.qk)&&(this.KK||this.K5e(!0),this.control.enabled&&
this.oY());super.x_(b)}Cta(){super.Cta();this.KIe&&(this.KIe=!1,this.qm())}DO(b){return this.control.UGb()?(this.xDa.KK?(this.root.zxh(),Rb.a.Xf(this.xDa.FHb,ka.MenuLauncher.sXc),this.xDa.pfa=this.control.su):(super.DO(b),this.Ew(b.zf,b.ig,b.Ib)),!1):super.DO(b)}onKeyDown(b){let h=!1;if(!Za.c(b.Ib)&&!Za.c(b.Ib.rawEvent)){if(Object(hc.a)(Pm.a,this.qk)){const t=b.Ib.rawEvent,A=b.Ib.keyCode,O=0===this.root.x0;t.shiftKey||t.ctrlKey||!(A===Sys.UI.Key.right&&O||A===Sys.UI.Key.left&&!O)||(h=this.$tf(b),
h||(this.Ew(b.zf,1,b.Ib),h=!0))}h||(h=super.onKeyDown(b))}return h}static ixk(b,h){Za.c(b)||Za.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(m.a)(Go,"FlyoutAnchorBehavior",Lj,[]);var Cl=c(952);class ws extends sc{constructor(b){super(b)}get H5b(){return this.control}get properties(){return this.H5b.properties}get Sea(){return this.H5b.Sea}rI(b){b=b.wBb;md.a.instance.mb(db.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));md.a.instance.mb(db.a.blur,b,Object(z.a)(this,this.onBlur,
"onBlur"));Yh.a.instance.mb(db.a.pointerOver,b,Object(z.a)(this,this.DO,"onPointerOver"));Yh.a.instance.mb(db.a.pointerOut,b,Object(z.a)(this,this.iJ,"onPointerOut"));sb.KeyInputManager.instance.mb(db.a.fi,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));sb.KeyInputManager.instance.mb(db.a.sh,b,Object(z.a)(this,this.ly,"onKeyUp"));Yh.a.instance.mb(db.a.pointerDown,b,Object(z.a)(this,this.zC,"onPointerDown"));Yh.a.instance.mb(db.a.AM,b,Object(z.a)(this,this.Uwa,"onPointerUp"));Wc.a.instance.mb(db.a.XO,
b,Object(z.a)(this,this.qlb,"onTouchMove"));Wc.a.instance.mb(db.a.yJ,b,Object(z.a)(this,this.dGa,"onTouchEnd"))}qm(){const b=this.Od[Cl.a.On],h=this.Od[Cl.a.IsRtl];this.cBj();if(0<(this.Xt(this.properties.Command,this.properties.QueryCommand,this.Od)&2)){var t=!Za.c(this.Od[Cl.a.InnerHTML])||!Za.c(this.properties.InnerHTML),A=!Za.c(this.properties.Image);t||A||(this.control.enabled=!1);A=this.Sea.wBb;if(!Za.c(A)){if(t){t=Rb.a.uqa(this.Od[Cl.a.InnerHTML],this.properties.InnerHTML);if(null===A.innerHTML||
null===t||F.a.fh(A.innerHTML)!==F.a.fh(t))A.innerHTML=t;""===t&&(this.control.enabled=!1)}t=A.title;const O=Rb.a.uqa(this.Od[Cl.a.Alt],this.properties.Alt);O===t||this.control.Y$f||(A.title=O)}A=this.Od[Cl.a.IsRtl];b===this.Od[Cl.a.On]&&h===A||this.control.MJb()}}cBj(){const b=this.Od;b[Cl.a.CommandValueId]=this.control.NCb();b.MenuItemId=this.control.Bh.MenuItemId;b.SourceControlId=this.properties.Id}Ew(b,h,t){if((b=this.qk)&&this.control.enabled){const A=this.root;if(v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&b.mTc()&&this.EH){const O=A.yC[this.EH.Upa];O?O.nSa(this.H5b):u.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.cBj();this.Od[Cl.a.On]||(this.Od[Cl.a.On]=!0,this.control.MJb());"Menu"===b.lT&&Rb.a.dw(this.Sea.Im,"cui-gallerybutton-focused");A.executeCommand(this.properties.Command,this.Od,b,h,!0,null,this.lX(t))}}onFocus(b){super.onFocus(b);Rb.a.Xf(this.Sea.Im,
"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);Rb.a.dw(this.Sea.Im,"cui-gallerybutton-focused");return!1}}Object(m.a)(ws,"GalleryButtonBehavior",sc,[]);var bl=c(1130),bs=c(1382),Lq=c(656);class ul extends sc{constructor(b){super(b);this.oWa=-1}get j9b(){return this.control}get properties(){return this.j9b.Bh}get LFc(){return this.j9b.LFc}get Pvf(){var b=null;if(this.qk&&(b=this.qk.parent,!Object(hc.a)(Lq.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get tFb(){return this.j9b.aVd.tFb}get WZc(){return this.j9b.aVd.WZc}Ew(b,
h,t){if(this.control.enabled){b=this.Fof(this.Y5b(b));const A=this.HMd(b);this.LFc[bs.a.Rows]=this.lQd(b)+1;this.LFc[bs.a.Columns]=A+1;this.root.executeCommand(this.properties.Command,this.LFc,this.qk,h,!0,null,this.lX(t))}}rI(b){var h=b.Im;const t=b.myh;b=b.cells;Yh.a.instance.mb(db.a.pointerOut,h,Object(z.a)(this,this.qgn,"onControlPointerOut"));Wc.a.instance.mb(db.a.XO,h,Object(z.a)(this,this.sgn,"onControlTouchMove"));Wc.a.instance.mb(db.a.yJ,h,Object(z.a)(this,this.rgn,"onControlTouchEnd"));
for(h=0;h<b.length;++h)this.IAk(t[h],b[h])}IAk(b,h){md.a.instance.mb(db.a.focus,b,Object(z.a)(this,this.mQf,"onCellFocus"));Yh.a.instance.mb(db.a.pointerOver,h,Object(z.a)(this,this.nQf,"onCellPointerOver"));Yh.a.instance.mb(db.a.AM,h,Object(z.a)(this,this.oQf,"onCellPointerUp"));sb.KeyInputManager.instance.mb(db.a.fi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));sb.KeyInputManager.instance.mb(db.a.sh,h,Object(z.a)(this,this.ly,"onKeyUp"));Wc.a.instance.mb(db.a.YO,h,Object(z.a)(this,this.nfn,"onCellTouchStart"))}Fof(b){return parseInt(b.id.substr(this.j9b.id.length+
1))}mhi(b){this.lhi(this.Fof(b))}lQd(b){return Math.floor(b/bl.a.sYc)}HMd(b){return b%bl.a.sYc}lhi(b){if(b!==this.oWa){var h=this.HMd(b),t=this.lQd(b),A=-1;let O=-1;-1!==this.oWa&&(A=this.lQd(this.oWa),O=this.HMd(this.oWa));for(;A!==t||O!==h;)A<t?this.Cgj(++A,O,!0):A>t?(this.Cgj(A,O,!1),A--):O<h?this.dej(++O,A,!0):O>h&&(this.dej(O,A,!1),O--);this.Pvf?this.Pvf.shj(this.q1h(t+1,h+1)):(t=(h=this.control.R6e)&&0<h.length?h[0]:null,A=this.qk,u.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!h,["FirstComp"]:!!t,["FirstCompPar"]:!!t&&!!t.parent,["DispComp"]:!!A,["DispCompPar"]:!!A&&!!A.parent}));this.oWa=b}}Cgj(b,h,t){for(let A=0;A<=h;A++)this.Wdj(b,A,t)}dej(b,h,t){for(let A=0;A<=h;A++)this.Wdj(A,b,t)}Wdj(b,h,t){h=b*bl.a.sYc+h;b=this.tFb[h];h=this.WZc[h];t?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}oQf(b){this.Ew(b.zf,b.ig,b.Ib);return!0}Y5b(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return Za.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}thj(b){const h=this.Fof(b);b.childNodes[0].childNodes[0].title=this.q1h(this.lQd(h)+1,this.HMd(h)+1)}q1h(b,h){let t=this.properties.Alt;Za.c(t)&&(t=this.properties.MenuSectionTitle);return t=String.format(t,h.toString(),b.toString())}kgc(){if(this.qk){for(var b=0;b<bl.a.bdc;b++)this.tFb[b].className="cui-it-inactiveCell",this.WZc[b].className="cui-it-inactiveCellOuter";this.oWa=-1;b=this.properties.MenuSectionInitialTitle;
Za.c(b)&&(b="");this.Pvf.shj(b)}}nQf(b){this.control.enabled&&(b=this.Y5b(b.zf),this.r5c(b),this.idf(b));return!1}idf(b){this.thj(b);this.mhi(b)}mQf(b){if(!this.control.enabled)return!1;b=this.Y5b(b.zf);this.thj(b);this.mhi(b);return!1}qgn(b){ff.a.LCf(this.j9b.aVd.Im,b.clientPoint)||this.kgc();return!1}nfn(b){if(!this.control.enabled)return!1;b=this.Y5b(b.zf);this.idf(b);return!0}sgn(b){if(!this.control.enabled)return!1;b=ff.a.wNd(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.Y5b(b))?this.idf(b):this.kgc();return!0}rgn(b){if(!this.control.enabled)return!1;var h=ff.a.wNd(b.clientPoint);if(!h||"table"===h.tagName.toLowerCase())return this.kgc(),!0;(h=this.Y5b(h))?this.Ew(h,3,b.Ib):this.kgc();return!0}sK(b){b=Uj.Control.Tif(this.oWa,bl.a.sYc,bl.a.bdc,b);if(b!==this.oWa)return this.tFb[b].firstChild.focus(),this.lhi(b),!0;this.kgc();this.oWa=-1;return!1}oY(){const b=this.tFb[0];if(Za.c(b))return!1;b.firstChild.focus();return!0}r5c(b){if(Za.c(b))return!1;b.firstChild.firstChild.focus();
return!0}Doa(){this.kgc()}}Object(m.a)(ul,"InsertTableBehavior",sc,[]);class Rf extends Lj{constructor(b){super(b)}qm(){this.control.enabled=!!this.menu}Ew(b,h,t){v.AFrameworkApplication.xa.Rb(ab.a.cQa,2,h,this.lX(t))}}Object(m.a)(Rf,"JewelMenuLauncherBehavior",Lj,[]);var Vj=c(1057);class Wo extends sc{constructor(b){super(b)}get properties(){return this.control.Bh}qm(){0<(this.Xt(this.properties.Command,this.properties.QueryCommand,this.Od)&2)&&this.l7a()&&this.zTa()}zTa(){this.KRo();this.Nia();
this.LPb()}KRo(){const b=this.control.labelText;let h=this.Od[Vj.a.Value];Za.c(h)&&(h=this.properties.LabelText,Za.c(h)&&(h=""));h!==b&&this.Qee(h)}rI(b){b=b.Im;Za.c(b)||(Yh.a.instance.mb(db.a.pointerDown,b,Object(z.a)(this,this.zC,"onPointerDown")),Yh.a.instance.mb(db.a.pointerOver,b,Object(z.a)(this,this.DO,"onPointerOver")),Yh.a.instance.mb(db.a.pointerOut,b,Object(z.a)(this,this.iJ,"onPointerOut")))}}Object(m.a)(Wo,"LabelBehavior",sc,[]);var tj=c(874),Mi=c(220),rp=c(319);class an extends Lj{constructor(b){super(b);
this.XBe=this.Hte=!1;this.sUb=this.VQb=null;if(this.VUb=v.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.VQb=this.Yt.Tha.LightImage16by16Class,this.sUb=this.Yt.Tha.DarkImage16by16Class}get Yt(){return this.control}T3d(b,h,t,A){h&&(this.Yt.pfa=t,v.AFrameworkApplication.ta.E5a());if(Object(hc.a)(Mi.a,b)&&A){t=new tj.a;t.CommandLocation=this.root.a9;t.InvocationMethod=0;const O={};(b=b.control)&&b.Bh&&(O.CommandId=b.Bh.Command,O.ControlId=b.Bh.Id,O.CloseAllMenus=h,b.EH&&b.EH.parent&&b.EH.parent.id&&
(O.ParentControlId=b.EH.parent.id.split("-")[0]),this.root.eF&&this.root.eF.NNa(A,O,t))}}Cta(){this.Yt.pfa||(this.Yt.pfa=this.Yt.Yx);!this.Yt.Z8m&&this.VUb&&(Rb.a.dw(this.Yt.Yx,"cui-sb-focus"),Rb.a.dw(this.Yt.G0,"cui-sb-focus"),Rb.a.dw(this.Yt.Txa,this.VQb),Rb.a.Xf(this.Yt.Txa,this.sUb));this.Hte=!0;super.Cta();this.Hte=!1;this.F_f()}get qkj(){return!this.Yt.sRa}E5d(){this.Yt.E5d()}pae(){this.XBe||this.Hte||(this.XBe=!0,this.Yt.raiseEvent(rp.a.K1a,null))}F_f(){this.KK||this.Yt.Mxf||(this.XBe=!1,this.Yt.raiseEvent(rp.a.KFb,
null))}uRf(b){Rb.a.dw(this.Yt.Yx,"cui-sb-focus");Rb.a.dw(this.Yt.G0,"cui-sb-focus");this.VUb&&!this.Yt.KK&&(Rb.a.dw(this.Yt.Txa,this.VQb),Rb.a.Xf(this.Yt.Txa,this.sUb));this.Yt.raiseEvent(rp.a.blur,b);this.F_f();this.Yt.pfa=this.Yt.Yx;return!1}vRf(b){Rb.a.Xf(this.Yt.Yx,"cui-sb-focus");Rb.a.Xf(this.Yt.G0,"cui-sb-focus");this.VUb&&(Rb.a.dw(this.Yt.Txa,this.sUb),Rb.a.Xf(this.Yt.Txa,this.VQb));this.Yt.raiseEvent(rp.a.focus,b);this.pae();return!1}$Sf(){this.VUb&&(Rb.a.Xf(this.Yt.G0,"cui-sb-hover"),Rb.a.Xf(this.Yt.Yx,
"cui-sb-hover"),Rb.a.dw(this.Yt.Txa,this.sUb),Rb.a.Xf(this.Yt.Txa,this.VQb));return!1}ZSf(){this.VUb&&(Rb.a.dw(this.Yt.G0,"cui-sb-hover"),Rb.a.dw(this.Yt.Yx,"cui-sb-hover"),this.Yt.KK||this.Yt.Mxf||(Rb.a.dw(this.Yt.Txa,this.VQb),Rb.a.Xf(this.Yt.Txa,this.sUb)));return!1}}Object(m.a)(an,"SearchBoxBehavior",Lj,[680,678]);class Im{}Im.Value="value";Im.MinValue="MinValue";Im.MaxValue="MaxValue";Im.Text="Text";Object(m.a)(Im,"SliderCommandProperties",null,[]);class Dl extends sc{constructor(b){super(b)}get Ybg(){return this.control}get D4(){return this.Ybg.D4}get properties(){return this.control.Bh}initialize(){}Ew(){}rI(b){b=
b.gr;md.a.instance.mb(db.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));md.a.instance.mb(db.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));md.a.instance.mb(db.a.change,b,Object(z.a)(this,this.Iba,"onChange"));md.a.instance.mb(db.a.input,b,Object(z.a)(this,this.Iba,"onChange"))}onFocus(b){this.D4.Im&&Sys.UI.DomElement.addCssClass(this.D4.Im,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.D4.Im&&Sys.UI.DomElement.removeCssClass(this.D4.Im,"cui-sldr-onfocus");return super.onBlur(b)}Iba(){this.gWk(this.D4.gr.value);
return!0}gWk(b){this.Od[Im.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Od,this.qk,0,!1)}qm(){const b=this.Od[Im.Value],h=this.Od[Im.MaxValue],t=this.Od[Im.Text];var A=this.Xt(this.properties.Command,this.properties.QueryCommand,this.Od);this.D4&&this.D4.gr&&(this.D4.gr.disabled=!this.control.enabled);if(0<(A&2)){A=this.Od[Im.Value];const O=this.Od[Im.MaxValue],aa=this.Od[Im.Text];(O!==h||A!==b||t!==aa)&&this.D4&&this.D4.gr&&(this.D4.gr.setAttribute(Mf.a.Ozd,String.format("{0}",
O)),this.D4.gr.setAttribute("max",String.format("{0}",O)),this.D4.gr.value=A,this.D4.WN.innerText=this.Od[Im.Text])}}}Object(m.a)(Dl,"SliderBehavior",sc,[]);var Ue=c(1376);class bn extends sc{constructor(b){super(b);this.ood=0;this.ocb=null;this.yld=!1;this.khh=null;this.PQe=!1;this.srd=this.Npd=-1;this.qAa=!1}get spinner(){return this.control}get uG(){return this.spinner.uG}get properties(){return this.control.Bh}initialize(){const b=this.spinner.Gkg;this.khh=this.CJo(b);this.ood=b[0].min;this.ocb=
b[0];this.yld=!1}Ew(){}rI(b){const h=b.gr,t=b.u4b;b=b.kJc;md.a.instance.mb(db.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));md.a.instance.mb(db.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur"));sb.KeyInputManager.instance.mb(db.a.fi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));sb.KeyInputManager.instance.mb(db.a.St,h,Object(z.a)(this,this.lG,"onKeyPress"));sb.KeyInputManager.instance.mb(db.a.sh,h,Object(z.a)(this,this.ly,"onKeyUp"));md.a.instance.mb(db.a.change,h,Object(z.a)(this,this.Iba,
"onChange"));Ud.a.instance.mb(db.a.Eba,h,Object(z.a)(this,this.xRf,"onInputMouseUp"));Yh.a.instance.mb(db.a.pointerDown,t,Object(z.a)(this,this.xMi,"onArrowPointerDown"));Yh.a.instance.mb(db.a.pointerDown,b,Object(z.a)(this,this.xMi,"onArrowPointerDown"));Yh.a.instance.mb(db.a.AM,t,Object(z.a)(this,this.yMi,"onArrowPointerUp"));Yh.a.instance.mb(db.a.AM,b,Object(z.a)(this,this.yMi,"onArrowPointerUp"));Wc.a.instance.mb(db.a.XO,t,Object(z.a)(this,this.AMi,"onArrowTouchMove"));Wc.a.instance.mb(db.a.XO,
b,Object(z.a)(this,this.AMi,"onArrowTouchMove"));Wc.a.instance.mb(db.a.yJ,t,Object(z.a)(this,this.zMi,"onArrowTouchEnd"));Wc.a.instance.mb(db.a.yJ,b,Object(z.a)(this,this.zMi,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);Rb.a.Xf(this.uG.Im,"cui-spn-focus");this.control.enabled&&ff.a.F4c(this.uG.gr);return this.qAa=!1}onBlur(b){super.onBlur(b);Rb.a.dw(this.uG.Im,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!Za.c(b.Ib)&&!Za.c(b.Ib.rawEvent)){const t=b.Ib.keyCode,A=b.Ib.rawEvent.shiftKey;if(t===
Sys.UI.Key.up||t===Sys.UI.Key.down)this.root.Vzf(this.control)||this.Roj(t===Sys.UI.Key.up,b.ig),h=!0;else if(t===Sys.UI.Key.enter)this.WS(),Object(hc.a)(Yn.Ribbon,this.root)&&this.root.PZ(),h=!0;else if(t===Sys.UI.Key.tab)this.WS(),Object(hc.a)(Yn.Ribbon,this.root)&&(h=this.root.Cne(this.qk.Pc,!A));else if(t===Sys.UI.Key.esc)this.mgc(),Object(hc.a)(Yn.Ribbon,this.root)&&this.root.PZ(),h=!0;else if(t===Sys.UI.Key.backspace||t===Sys.UI.Key.del)h=!this.control.enabled}return h}lG(){return!this.control.enabled}ly(){this.S$k();
return!1}Iba(){this.WS();return!1}xRf(){return this.qAa?!1:this.qAa=!0}xMi(b){var h=!1;let t=!0;2===b.ig&&(t=b.Cba===Sys.UI.MouseButton.leftButton);t&&(h=b.zf,this.Roj(h===this.uG.u4b||h===this.uG.gRh||h===this.uG.fRh,b.ig),h=!0);return h}yMi(b){return this.hua(b)}AMi(b){return this.q4d(b)}zMi(b){return this.hua(b)}Ynm(b){if(this.control.enabled){var h=!1;if(!this.yld){var t=this.zSl(b);t=b?t+this.ocb.step:t-this.ocb.step;t=Math.min(t,this.ocb.max);t=Math.max(t,this.ocb.min);t!==this.ood&&(this.F6e(t,
this.ocb),this.root.executeCommand(this.properties.Command,this.Od,this.qk,0,!1),h=!0)}h||(h=this.properties.SpinCommand,t=this.Od,t.Increment=b,Za.c(h)||this.root.executeCommand(h,t,this.qk,0,!1))}}zSl(b){const h=Math.pow(10,v.AFrameworkApplication.numberFormat.$3d),t=Math.round(this.ocb.step*h);let A=Math.round(this.ood*h)/t;A=b?Math.floor(A):Math.ceil(A);return A*t/h}Roj(b,h){if(this.control.enabled){this.WS();const t=b?this.uG.u4b:this.uG.kJc;switch(h){case 2:case 3:this.PQe=b;this.rxd(t);break;
case 1:this.PQe=b,this.jjk(t)}}}xpj(){this.Axh();this.tMk()}bMh(){-1===this.Npd&&(this.Npd=window.setTimeout(Object(z.a)(this,this.qXn,"repeatSpin"),500))}Axh(){this.Npd=Rb.a.ozb(this.Npd)}qXn(){this.Axh();-1===this.srd&&(this.Ghe(),this.srd=window.setInterval(Object(z.a)(this,this.Ghe,"spin"),50))}tMk(){this.srd=Rb.a.pMk(this.srd)}Ghe(){this.Ynm(this.PQe)}jjk(b){this.root.Gea(this.control,!1);Rb.a.Xf(b,Uj.Control.uxd);this.Ghe();this.bMh()}S$k(){this.root.zaa(this.control,!1);this.xpj();Rb.a.dw(this.uG.u4b,
Uj.Control.uxd);Rb.a.dw(this.uG.kJc,Uj.Control.uxd)}Khc(b){this.uG.gr.value!==b&&(this.uG.gr.value=b)}mgc(){this.Khc(this.Od[Ue.a.Text])}sej(b){this.Khc(b);this.Od[Ue.a.Text]=b;this.yld=!0}X$n(b,h,t){this.Khc(t);this.Od[Ue.a.Text]=t;this.Od[Ue.a.Number]=b;this.Od[Ue.a.UnitType]=h.type;this.ood=b;this.ocb=h;this.uG.gr.setAttribute(Mf.a.e0e,t);this.uG.gr.setAttribute(Mf.a.Arh,String.format("{0}",h.min));this.uG.gr.setAttribute(Mf.a.Ozd,String.format("{0}",h.max));this.yld=!1}WCh(b){var h;if(({ebn:h}=
this.nKm(b)).returnValue)this.sej(h);else{({number:b,X6a:h}=F.a.TUi(b,this.khh,v.AFrameworkApplication.numberFormat));let t=this.vle(h);0===h&&Za.c(t)&&(t=this.vle(this.Od[Ue.a.UnitType]));this.F6e(b,t)}}F6e(b,h){b=this.DOf(b,h);if(isNaN(b)||Za.c(h))this.mgc();else{const t=v.AFrameworkApplication.numberFormat;let A;A=F.a.ADa(b,h.type,t);A=A.replace(6===h.type?t.a4d:t.YVf,"");this.X$n(b,h,A)}}nKm(b){let h,t=!1;h="";b=b.trim();const A=this.spinner.ECj;if(!Za.c(A))for(let O=0;O<A.length;O++)if(A[O].toLowerCase()===
b.toLowerCase()){h=A[O];t=!0;break}return{returnValue:t,ebn:h}}DOf(b,h){return isNaN(b)||Za.c(h)?Number.NaN:h.DOf(b)}vle(b){let h=null;const t=this.spinner.Gkg;for(let A=0;A<t.length;A++)if(t[A].type===b){h=t[A];break}return h}CJo(b){const h=b.length,t=Array(h);for(let A=0;A<h;A++)t[A]=b[A].type;return t}WS(){if(this.control.enabled){const b=this.Od[Ue.a.Text],h=this.uG.gr.value;h!==b&&(this.WCh(h),this.Od[Ue.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Od,this.qk,0,!1))}else this.mgc()}qm(){var b=
this.Od[Ue.a.Text],h=this.Od[Ue.a.Number];const t=this.Od[Ue.a.UnitType],A=this.Od[Ue.a.MaxValue];if(0<(this.Xt(this.properties.Command,this.properties.QueryCommand,this.Od)&2)){const O=this.Od[Ue.a.Text],aa=this.Od[Ue.a.Number],ua=this.Od[Ue.a.UnitType],Ra=this.Od[Ue.a.MaxValue];Ra!==A&&(this.vle(ua).max=Ra,this.uG.gr.setAttribute(Mf.a.Ozd,String.format("{0}",Ra)));O!==b?""===O?this.sej(O):this.WCh(O):isNaN(aa)||aa===h&&ua===t||this.F6e(aa,this.vle(ua));b=this.uG.Im.title;h=Rb.a.uqa(this.Od[Ue.a.Alt],
this.properties.Alt);h!==b&&(this.uG.gr.title=h,this.uG.u4b.title=h,this.uG.kJc.title=h)}}mWe(b){super.mWe(b);b?(this.Ghe(),this.bMh()):this.xpj()}}Object(m.a)(bn,"SpinnerBehavior",sc,[679,678]);var Gn=c(326),Rk=c(889);class Xo extends Lj{constructor(b){super(b);this.VVb=!0;this.Fqb=!1}get G4(){return this.control}get Ss(){return this.G4.properties}rI(b){const h=b.Im,t=b.hfb;b=b.mJc;md.a.instance.mb(db.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));md.a.instance.mb(db.a.blur,h,Object(z.a)(this,
this.onBlur,"onBlur"));sb.KeyInputManager.instance.mb(db.a.fi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));sb.KeyInputManager.instance.mb(db.a.sh,h,Object(z.a)(this,this.ly,"onKeyUp"));ba.a.Rt&&16>this.sNl()&&(Yh.a.instance.mb(db.a.pointerDown,h,Object(z.a)(this,this.pRi,"onSplitbuttonPointerDownPointerUp")),Yh.a.instance.mb(db.a.AM,h,Object(z.a)(this,this.pRi,"onSplitbuttonPointerDownPointerUp")));Yh.a.instance.mb(db.a.pointerOver,t,Object(z.a)(this,this.Zen,"onButtonPointerOver"));Yh.a.instance.mb(db.a.pointerOut,
t,Object(z.a)(this,this.Yen,"onButtonPointerOut"));Yh.a.instance.mb(db.a.pointerDown,t,Object(z.a)(this,this.NMi,"onButtonPointerDown"));Yh.a.instance.mb(db.a.AM,t,Object(z.a)(this,this.OMi,"onButtonPointerUp"));Wc.a.instance.mb(db.a.XO,t,Object(z.a)(this,this.afn,"onButtonTouchMove"));Wc.a.instance.mb(db.a.yJ,t,Object(z.a)(this,this.$en,"onButtonTouchEnd"));Yh.a.instance.mb(db.a.pointerDown,b,Object(z.a)(this,this.XRf,"onMenuButtonPointerDown"));Yh.a.instance.mb(db.a.pointerOver,b,Object(z.a)(this,
this.Qjn,"onMenuButtonPointerOver"));Yh.a.instance.mb(db.a.pointerOut,b,Object(z.a)(this,this.Pjn,"onMenuButtonPointerOut"))}Ew(b,h,t){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.Fqb&&(this.G4.on=!this.G4.on,b=this.Od,b.CommandValueId=this.control.NCb(),this.root.executeCommand(this.Ss.Command,b,this.qk,h,!0,null,this.lX(t))):this.VVb&&super.Ew(b,h,t)}ly(b){const h=b.Ib.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Od,b.CommandValueId=this.control.NCb(),this.root.executeCommand(this.Ss.Command,
b,this.qk,1,!0),!0):super.ly(b)}qm(){const b=this.root.Zoa(this.Ss.Command,this.Ss.QueryCommand,this.Od),h=0<(b&1);let t=!0;t=Za.c(this.Ss.CommandMenuOpen)?h:0<(this.root.Zoa(this.Ss.CommandMenuOpen,null,null)&1);if(t!==this.VVb||h!==this.Fqb||(t||h)!==this.control.enabled)this.control.enabled=t||h,h!==this.Fqb&&this.khn(h),t!==this.VVb&&this.lhn(t),this.VVb=t,this.Fqb=h;if(0<(b&2)){this.Nia();const A=Rb.a.uqa(this.Od[Rk.a.LabelText],this.Ss.LabelText);this.Od[Rk.a.ApplyLabelTextToControlOnly]?this.G4.w5b(O=>
{O.Im.title=A;O.hfb.removeAttribute("title");O.mJc.removeAttribute("title")}):this.G4.w5b(O=>{O.hfb.title=A});this.Od[Rk.a.EnsureControlRoleIsButton]&&this.G4.w5b(O=>{Mf.a.Uq(O.Im,Mf.a.oh,Mf.a.z2)});Za.c(this.Od[Rk.a.Visible])||this.l7a()&&this.zTa()}this.G4.setState(this.G4.on&&h)}zTa(){this.ijg();this.LPb();this.Nia()}lhn(b){this.G4.w5b(h=>{Rb.a.knb(h.mJc,b)});this.D2c();this.VVb=b}khn(b){this.G4.w5b(h=>{Rb.a.knb(h.hfb,b)});this.D2c();this.Fqb=b}D2c(){const b=this.G4.Cgb();Za.c(b)||(Rb.a.dw(b.childNodes[0],
"cui-ctl-split-hovered-primary"),Rb.a.dw(b.childNodes[0],"cui-ctl-split-hovered-secondary"),Rb.a.dw(b.childNodes[1],"cui-ctl-split-hovered-primary"),Rb.a.dw(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}pRi(b){if(0!==Gn.a(b.Ib))return!1;let h=!1;b.eventName===db.a.pointerDown?h=this.NMi(b):b.eventName===db.a.AM&&(h=this.OMi(b));return h}NMi(b){let h=!1;const t=b.ig;switch(t){case 3:this.zno()?this.Ew(this.qk.Pc,t,b.Ib):this.rxd(this.G4.MOh);h=!0;break;case 2:b.Cba===Sys.UI.MouseButton.leftButton&&
(this.rxd(this.G4.MOh),h=!0)}h&&b.Ib.preventDefault();return!1}zno(){const b=this.qk.lT;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}OMi(b){return this.hua(b)}afn(b){return this.q4d(b)}$en(b){return this.hua(b)}onFocus(b){super.onFocus(b);this.Evf(!0,!0);return!1}onBlur(b){super.onFocus(b);this.D2c();return!1}Zen(){this.control.enabled&&this.Fqb&&this.Evf(!0,this.G4.on);return!1}Yen(){this.control.enabled&&this.Fqb&&this.D2c();return!1}XRf(b){let h=!1;if(2!==b.ig||b.Cba===Sys.UI.MouseButton.leftButton)this.Ew(b.zf,
b.ig,b.Ib),h=!0;h&&b.Ib.preventDefault();return!1}Qjn(){this.control.enabled&&this.VVb&&this.Evf(this.G4.on,!0);return!1}Pjn(){this.D2c();return!1}Evf(b,h){const t=this.control.Cgb();Za.c(t)||(Rb.a.Xf(t.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),Rb.a.Xf(t.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}sNl(){var b=ba.a.j4b;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(m.a)(Xo,"SplitButtonBehavior",Lj,[]);
var Ho=c(1381);class Mj extends sc{constructor(b){super(b);this.ktb=this.qAa=!1;this.wWj=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get Nca(){return this.textBox.Nca}get Zeg(){return this.textBox.Bh}rI(b){b=b.gr;md.a.instance.mb(db.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));md.a.instance.mb(db.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));sb.KeyInputManager.instance.mb(db.a.fi,b,Object(z.a)(this,this.onKeyDown,
"onKeyDown"));sb.KeyInputManager.instance.mb(db.a.St,b,Object(z.a)(this,this.lG,"onKeyPress"));sb.KeyInputManager.instance.mb(db.a.sh,b,Object(z.a)(this,this.ly,"onKeyUp"));md.a.instance.mb(db.a.change,b,Object(z.a)(this,this.Iba,"onChange"));Ud.a.instance.mb(db.a.Eba,b,Object(z.a)(this,this.YQa,"onMouseUp"))}onFocus(b){super.onFocus(b);this.ktb=!0;Rb.a.Xf(this.Nca.Im,"cui-tb-focus");this.control.enabled&&ff.a.F4c(this.Nca.gr);return this.qAa=!1}onBlur(b){this.ktb=!1;super.onBlur(b);Rb.a.dw(this.Nca.Im,
"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!Za.c(b.Ib)&&!Za.c(b.Ib.rawEvent)){const t=b.Ib.keyCode,A=b.Ib.rawEvent.shiftKey;t===Sys.UI.Key.tab?(this.WS(),Object(hc.a)(Yn.Ribbon,this.root)&&(h=this.root.Cne(this.qk.Pc,!A))):t===Sys.UI.Key.enter?this.wWj&&(this.WS(),Object(hc.a)(Yn.Ribbon,this.root)&&this.root.PZ(),h=!0):t===Sys.UI.Key.esc?(this.mgc(),Object(hc.a)(Yn.Ribbon,this.root)&&this.root.PZ(),h=!0):t===Sys.UI.Key.backspace||t===Sys.UI.Key.del?h=!this.control.enabled:b.Eta&&
(Hf.a.wxh(b.Ib),h=!1)}return h}lG(){return!this.control.enabled}ly(){return!1}Iba(){this.WS();return!1}YQa(){return this.Nca.isEditable?this.qAa?!1:this.qAa=!0:(ff.a.F4c(this.Nca.gr),!0)}Khc(b){this.Nca.gr.value!==b&&(this.Nca.gr.value=b)}mgc(){this.Khc(this.Od[Ho.a.Text])}WS(){if(this.control.enabled&&this.Nca.isEditable){const b=this.Nca.gr.value;b!==this.Od[Ho.a.Text]&&(this.Od[Ho.a.Text]=b,this.root.executeCommand(this.Zeg.Command,this.Od,this.qk,0,!1))}else this.mgc()}qm(){const b=this.Od[Ho.a.Text];
if(0<(this.Xt(this.Zeg.Command,this.Zeg.QueryCommand,this.Od)&2)&&!this.ktb){const h=this.Od[Ho.a.Text];h!==b&&this.Khc(h)}}}Object(m.a)(Mj,"TextBoxBehavior",sc,[677,678]);var qo=c(428);class Nr extends sc{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.Bh}Ew(b,h,t){this.control.enabled&&(Rb.a.sga(this.properties.TogglesWhenExecuted)||this.toggle(),this.Od.CommandValueId=this.toggleButton.NCb(),this.Od.MenuItemId=this.toggleButton.Bh.MenuItemId,
this.Od.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Od,this.qk,h,!Rb.a.sga(this.properties.CloseMenuWhenExecuted),A=>{Rb.a.Fr(this.properties.UpdateHtmlPostToggle)&&(32===A?this.wtj():this.utj())},this.lX(t)))}utj(){this.Od[Ng.a.On]=!this.Od[Ng.a.On]}wtj(){this.toggleButton.setState(this.Od[Ng.a.On]);(this.toggleButton.Hya&&this.toggleButton.Bme||Rb.a.Fr(this.properties.UpdateHtmlPostToggle))&&this.zTa()}toggle(){this.utj();Rb.a.Fr(this.properties.UpdateHtmlPostToggle)||
this.wtj()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!Za.c(b.Ib)&&this.EH){const t=b.Ib.keyCode;t!==Sys.UI.Key.enter&&t!==Sys.UI.Key.space||b.Ib.preventDefault()}return h}qm(){Za.c(this.properties.MenuItemId)||(this.Od.MenuItemId=this.properties.MenuItemId);0<(this.Xt(this.properties.Command,this.properties.QueryCommand,this.Od)&2)&&this.l7a()&&this.zTa()}zTa(){this.toggleButton.setState(this.Od[Ng.a.On]);this.kNo(Rb.a.uqa(this.Od[Ng.a.DisplayMode],""));this.ijg();this.Nia();this.UOo();Ng.a.Alt in
this.Od&&this.LPb()}UOo(){const b=this.uE.jbc;if(b&&b.ifb){var h=Rb.a.uqa(this.Od[Ng.a.Description],this.properties.Description);h!==b.ifb.innerText&&(b.ifb.innerText=h,b.WN&&!Object(hc.a)(qo.Jewel,this.root)&&(h=!Za.b(h),Rb.a.P4(b.WN,"UIFontBold",h),Rb.a.P4(b.WN,"cui-ctl-mediumlabel-nodescription",!h)))}}rI(b){b=b.Im;md.a.instance.mb(db.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));md.a.instance.mb(db.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Yh.a.instance.mb(db.a.pointerOver,b,Object(z.a)(this,
this.DO,"onPointerOver"));Yh.a.instance.mb(db.a.pointerOut,b,Object(z.a)(this,this.iJ,"onPointerOut"));sb.KeyInputManager.instance.mb(db.a.fi,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));sb.KeyInputManager.instance.mb(db.a.sh,b,Object(z.a)(this,this.ly,"onKeyUp"));Yh.a.instance.mb(db.a.pointerDown,b,Object(z.a)(this,this.zC,"onPointerDown"));Yh.a.instance.mb(db.a.AM,b,Object(z.a)(this,this.Uwa,"onPointerUp"));Pd.a.instance.mb(db.a.click,b,Object(z.a)(this,this.onClick,"onClick"));Wc.a.instance.mb(db.a.XO,
b,Object(z.a)(this,this.qlb,"onTouchMove"));Wc.a.instance.mb(db.a.yJ,b,Object(z.a)(this,this.dGa,"onTouchEnd"))}}Object(m.a)(Nr,"ToggleButtonBehavior",sc,[]);class No{constructor(b){this.QSj=b;this.vye={["Button"]:h=>new xd(h),["FileMenuButton"]:h=>new xd(h),["ColorPicker"]:h=>new $e(h),["ComboBox"]:h=>new hk(h),["ContextMenuControl"]:h=>new vn(h),["ContextMenuLauncher"]:h=>new vn(h),["DialogMenuLauncher"]:h=>new go(h),["DropDown"]:h=>new qp(h),["FlyoutAnchor"]:h=>new Go(h),["GalleryButton"]:h=>new ws(h),
["StatefulColorFlyoutAnchor"]:h=>new Go(h),["JewelMenuLauncher"]:h=>new Rf(h),["Label"]:h=>new Wo(h),["Placeholder"]:h=>new sc(h),["SearchBox"]:h=>new an(h),["Separator"]:h=>new sc(h),["SplitButton"]:h=>new Xo(h),["StatefulColorSplitButton"]:h=>new Xo(h),["StatefulImageSplitButton"]:h=>new Xo(h),["TextBox"]:h=>new Mj(h),["ToggleButton"]:h=>new Nr(h)}}DRh(){this.vye[Uj.Control.Zni]=b=>new ul(b)}Xef(){this.vye[Uj.Control.Rnj]=b=>new bn(b)}OFl(b){const h=this.vye[b.controlType];(b=h?h(b):null)&&this.QSj&&
b.mml();return b}static get instance(){return No._instance||(No._instance=new No(!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}No._instance=null;Object(m.a)(No,"ControlBehaviorFactory",null,[653]);var sq=c(977),Rp=c(170);class tq extends ka.MenuLauncher{constructor(b,h,t,A){super(b,h,t,A);this.X0g=null;this.iMa=this.XBc=0;this.eF=null;this.hvc=this.gvc=0;this.hh("Menu");this.enabled=!0}get x(){return this.XBc}get y(){return this.iMa}get qGf(){return this.gvc}get rGf(){return this.hvc}get controlType(){return"DialogMenuLauncher"}H5a(){}b7a(){}$lf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.Ss.DialogMoveCommand;b.DialogCloseCommand=this.Ss.DialogCloseCommand;return b}QPm(b,h){this.XBc=b.x;this.iMa=b.y;this.gvc=b.height;this.hvc=b.width;this.x_(h)}XP(b){this.X0g=Rb.a.createElement("span");return new Rp.a(b,this.X0g)}get Ss(){return this.Bh}Jta(b,h,t){return new tq(b,this.id,h,t)}}Object(m.a)(tq,"DialogMenuLauncher",ka.MenuLauncher,[]);var qh=c(821);class Nn extends sq.a{constructor(b,h){super(b,h);this.j8a=null}get pWe(){return this.j8a}get wNh(){return this.properties}get a9(){return 20}rm(){super.rm();
Za.c(this.Pc)&&this.kC();this.Pc=Rb.a.QRa(this.Pc);this.yW(this.Pc);this.dirty=!1}YN(b){if(!Object(hc.a)(qh.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}b9e(b,h,t,A){t=new zh.Menu(this,h,t,A,null);b||(b={});b.CommandMenuOpen=this.wNh.CommandMenuOpen;b.CommandMenuClose=this.wNh.CommandMenuClose;b=new tq(this,h,b,t);this.xAb[h]=b;h=new qh.a(this,"dock"+h);h.Qf(b.YP("Menu"));this.Qf(h);this.refresh()}Uag(b,h,t,A){const O=this.xAb[b];if(Za.c(O))throw Error.create('The dialog menu "'+
b+'" does not exist');O.QPm(new Sys.UI.Bounds(h,t,0,0),A);this.j8a=O.menu}L5e(b){b=this.xAb[b];Za.c(b)||(b.Cta(),this.j8a=null)}F5d(){this.j8a=null}dispose(){const b=this.xAb;for(let h in b)b[h].dispose();super.dispose()}}Object(m.a)(Nn,"DialogMenuRoot",sq.a,[]);class be{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(m.a)(be,"RootProperties",null,[]);class Nl extends be{constructor(){super()}}Object(m.a)(Nl,"StandaloneRootProperties",be,[]);class ir extends Nl{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(m.a)(ir,"DialogMenuRootProperties",Nl,[]);class Vl{constructor(){const b=new ir;b.ImageSideArrow=v.AFrameworkApplication.Ks;b.ImageSideArrowClass=dh.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=v.AFrameworkApplication.isRtl?"rtl":"ltr";this.Ed=new Nn("DialogMenuRootId",b);this.Ed.eF=this;this.Ed.refresh();v.AFrameworkApplication.xa.gb(ab.a.OWf,yc.a.frame,Object(z.a)(this,this.OWf,"populateDialogMenu"),96)}get C0(){return this.Ed}NNa(b,h,t,A,O=null){b=parseInt(b);A=v.AFrameworkApplication.xa;
t&&(A.iD=t.CommandLocation,A.p_=t.InvocationMethod);h=A.Rb(b,2,h,O);this.Ed.refresh();return 32===h}gFa(b){return b?32===v.AFrameworkApplication.xa.processAction(parseInt(b),1):!0}Xt(){this.C0.root.qm()}b9e(b,h,t){const A={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};A.DialogMoveCommand=h;A.DialogCloseCommand=t;this.C0.b9e(A,b,"","")}Uag(b,h,t,A){this.C0.Uag(b,h,t,A)}L5e(b){this.C0.L5e(b)}OWf(b,h,t,A,O){if(1===t)return 32;b=new Sys.StringBuilder;
b.append('<Menu Id="dialogMenu">');b.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');b.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',O.DialogMoveCommand,CommonUIStrings.l_DialogMove));b.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',O.DialogCloseCommand,CommonUIStrings.l_DialogClose));b.append("</Controls></MenuSection>");b.append("</Menu>");O.PopulationXML=b.toString();return 32}dispose(){this.Ed&&
(this.Ed.dispose(),this.Ed=null)}}Object(m.a)(Vl,"DialogMenuRootUser",null,[119,9,632]);class cs{constructor(b,h,t){this.mrb=this.Ntd=this.jwc=this.ol=null;this.bCe=this.ctd=!1;this.ksc=b;this.$d=h;this.Nr=t;this.UUb=v.AFrameworkApplication.isRtl}get Nwf(){return this.bCe}Zol(b){b?(this.ol=b,this.bCe=!0,this.ctd=!1,this.$d.capture(Object(z.a)(this,this.wOm,"keyEventHandler"),null),this.Nr.mb(db.a.pointerDown,this.ksc,Object(z.a)(this,this.Pec,"pointerDownHandler")),this.jwc||this.q5k(),this.ol.appendChild(this.jwc),
this.Cqm()):u.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}Dgf(){this.bCe=!1;this.Ntd=this.mrb=null;this.CTn();this.F1f();this.ol=null}F1f(){this.$d.releaseCapture();this.Nr.sc(db.a.pointerDown,this.ksc,Object(z.a)(this,this.Pec,"pointerDownHandler"))}Cqm(){if(this.ol.style.left.endsWith("px")&&this.ol.style.right.endsWith("px"))this.mrb=new Sys.UI.Point(om.a.hY(this.UUb?this.ol.style.right:this.ol.style.left),om.a.hY(this.ol.style.top));else{const b=this.UUb?this.ksc.offsetWidth-
(this.ol.offsetLeft+this.ol.offsetWidth+om.a.hY(this.ol.style.marginRight)):this.ol.offsetLeft-om.a.hY(this.ol.style.marginLeft),h=this.ol.offsetTop-om.a.hY(this.ol.style.marginTop);this.Zgj(b,h);this.mrb=new Sys.UI.Point(b,h)}this.Ntd=this.mrb}q5k(){this.jwc=dh.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}CTn(){this.jwc.parentNode===this.ol&&this.ol.removeChild(this.jwc)}wOm(b){if(!this.Nwf)return!1;b.Ib.preventDefault();if(b.eventName===db.a.fi){const h=b.Ib.ctrlKey?
1:10;let t;switch(b.Ib.keyCode){case rc.a.a5:this.Hcc(0,-1*h);break;case rc.a.Uca:this.Hcc(0,1*h);break;case rc.a.Jlc:t=this.UUb?1:-1;this.Hcc(t*h,0);break;case rc.a.upb:t=this.UUb?-1:1;this.Hcc(t*h,0);break;case rc.a.qIa:this.LIi(this.Ntd.x,this.Ntd.y);this.ctd=!0;break;case rc.a.ks:this.ctd=!0}}b.eventName===db.a.sh&&this.ctd&&this.Dgf();return!0}Pec(b){if(!this.Nwf)return!1;b.Ib.preventDefault();this.Dgf();return!0}Hcc(b,h){this.LIi(this.mrb.x+b,this.mrb.y+h)}LIi(b,h){b=this.ttk(b,h);this.Zgj(b.x,
b.y);this.mrb=b}Zgj(b,h){this.UUb?this.ol.style.right=b+"px":this.ol.style.left=b+"px";this.ol.style.top=h+"px"}ttk(b,h){const t=this.UUb?om.a.hY(this.ol.style.marginRight):om.a.hY(this.ol.style.marginLeft),A=om.a.hY(this.ol.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-t,b),this.ksc.offsetWidth-this.ol.offsetWidth-t),Math.min(Math.max(-A,h),this.ksc.offsetHeight-this.ol.offsetHeight-A))}}Object(m.a)(cs,"KeyMoveAdapter",null,[633]);var Rt=c(1119),bt=c(575);class wn{get name(){return"CUI.Behavior"}yc(b){v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(632,"Common.UI.IDialogMenuRootUser").singleInstance().Qd(()=>new Vl),b.register(633,"Common.IKeyMoveAdapter").singleInstance().Qd(()=>new cs(v.AFrameworkApplication.ta.Dma(),sb.KeyInputManager.instance,Yh.a.instance)));b.register(bt.a,"CommandUI.RootManager").as("Common.IRootManager").singleInstance().Qd(()=>bt.a.instance)}init(){Rt.a.X7e=No.instance;const b=bt.a.instance.j$i;for(let h=0;h<b.length;++h){const t=Object(Da.a)(634,
b[h]);t&&t.HNa()}rk.a.get_instance().WK(6)}dispose(){}static main(){P.a.instance.Gc(new wn,5)}}Object(m.a)(wn,"CuiBehaviorPackage",null,[1,2]);class ds{constructor(b){const h=new Nl;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=dh.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=dh.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=dh.getImageClass("RibbonUpArrow_8x8x32");
h.ImageDownArrow8by8Class=dh.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=dh.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=dh.getImageClass("CheckboxChecked_16x16x32");h.ImageUncheckMarkClass=dh.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=v.AFrameworkApplication.isRtl?"rtl":"ltr";this.Wbb=sq.a.L7k(h);this.Wbb.refresh()}get zca(){return this.Wbb}dispose(){this.Wbb.dispose()}}Object(m.a)(ds,"StandaloneRootController",null,[866,9]);var Oo=c(1144),
Sk=c(181);class Ip{constructor(b){this.Jyc=b}create(b,h){const t=new Sys.StringBuilder;this.nHc(t,b,h);this.y9e(t,b);return t.toString()}ueb(b,h){const t=[];this.i$e(t,b,h);this.z9e(t,b);return t}nHc(b,h,t){switch(h.errorType){case 0:b.append(this.Jyc.build());break;case 1:case 2:b.append(this.A2e(h,t))}}i$e(b,h,t){switch(h.errorType){case 0:b.push(this.Jyc.avh());break;case 1:case 2:b.push(this.$Fk(h,t))}}y9e(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');
b.append(Sk.a("btnIgrnoreSpellingError",(2===h.errorType?qa.a.hIa:qa.a.Eva).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}z9e(b,h){const t=Object.assign(new eh.a,{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";t.ControlList.push(Object.assign(new Eh.a,{ExternalId:h}));b.push(t)}A2e(b,h){b=this.wCl(b.suggestions,h);return 0<b.length?Sk.g("msUnknownWord",Sk.d(null,b),"Menu16"):Sk.g("msUnknownWord",Sk.d(null,[Sk.a("btnNoSuggestions",
qa.a.hIa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}wCl(b,h){const t=[];if(b){const A=Math.min(h.length,b.length);for(let O=0;O<A;++O)b[O]&&t.push(Sk.a("btnCorrectWord"+O,h[O].toString(),b[O]))}return t}$Fk(b,h){const t=Object.assign(new eh.a,{Id:"Suggestions",ControlList:[]});this.vCl(b.suggestions,h,t.ControlList);0>=t.ControlList.length&&(b=Object.assign(new Eh.a,{ExternalId:"NoSuggestions"}),t.ControlList.push(b));return t}vCl(b,h,t){if(b){const A=Math.min(h.length,b.length);
for(let O=0;O<A;++O){if(!b[O])continue;const aa=Object.assign(new Eh.a,{ExternalId:"btnCorrectWord"+O,Command:h[O].toString(),LabelText:b[O]});t.push(aa)}}}}Object(m.a)(Ip,"DefaultProofingContextMenuCreator",null,[]);var eq=c(714);class uq{constructor(b,h){this.VNg=b;this.UPg=h;this.Eka=[qa.a.Cob,qa.a.Dob,qa.a.Eob,qa.a.JOb,qa.a.KOb]}create(b,h){return h?Object(hc.a)(eq.a,h)?this.UPg.create(b,h,this.Eka):this.VNg.create(h,this.Eka):""}S2b(b,h){return h?Object(hc.a)(eq.a,h)?this.UPg.ueb(b,h,this.Eka):
this.VNg.ueb(h,this.Eka):null}}Object(m.a)(uq,"ProofingContextMenuSectionFactory",null,[637]);class Zn{build(){const b=[Sk.a("btnDeleteRepeatedWord",qa.a.WCa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return Sk.g("msRepeatedWord",Sk.d(null,b),"Menu16")}avh(){const b=Object.assign(new eh.a,{ControlList:[]}),h=Object.assign(new Eh.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(m.a)(Zn,"ProofingRepeatedWordSectionBuilder",null,[636]);class Yo{static get Wg(){return Pf.a.Xz(Yo.Hm,
Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}Yo.Hm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(m.a)(Yo,"AutoCorrectOptionsDialogHTML",null,[]);class Ni{static get Wg(){return Pf.a.Xz(Ni.Hm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Ni.Hm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(m.a)(Ni,"AutoCorrectOptionsDialogHTML2",null,[]);class ro extends Pf.a{constructor(b,h){super();this.R9n=(t,A)=>{1!==t?u.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):A.ReplaceTextAsYouType!==this.jV.URa||A.CapitalizeFirstLetterOfSentences!==this.jV.xBd||A.ReplaceOrdianalsWithSuperscript!==this.jV.Sbe||A.ReplaceHyphensWithDash!==this.jV.h3c||A.ReplaceFractionsWithFractionCharacter!==this.jV.Rbe||this.Tda&&A.ReplaceQuoteWithSmartQuote!==
this.jV.E3f?(t={},t.ReplaceTextAsYouType=A.ReplaceTextAsYouType,t.CapitalizeFirstLetterOfSentences=A.CapitalizeFirstLetterOfSentences,t.ReplaceOrdianalsWithSuperscript=A.ReplaceOrdianalsWithSuperscript,t.ReplaceHyphensWithDash=A.ReplaceHyphensWithDash,t.ReplaceFractionsWithFractionCharacter=A.ReplaceFractionsWithFractionCharacter,this.Tda&&(t.ReplaceQuoteWithSmartQuote=A.ReplaceQuoteWithSmartQuote),this.jV.M3n(t),u.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:A.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:A.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:A.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:A.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:A.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Tda,["ReplaceQuoteWithSmartQuote"]:this.Tda&&A.ReplaceQuoteWithSmartQuote}),Jb.App.ya.updateCommandUI(!0)):u.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.jV=b;this.Tda=h;this.sg="AutoCorrectOptionsDialog"}kbg(){u.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Wg=this.Tda?Ni.Wg:Yo.Wg;const b={};b.ReplaceTextAsYouType=this.jV.URa;b.CapitalizeFirstLetterOfSentences=this.jV.xBd;b.ReplaceOrdianalsWithSuperscript=this.jV.Sbe;b.ReplaceHyphensWithDash=this.jV.h3c;b.ReplaceFractionsWithFractionCharacter=this.jV.Rbe;this.Tda&&(b.ReplaceQuoteWithSmartQuote=
this.jV.E3f);this.Yh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.R9n,b)}}Object(m.a)(ro,"AutoCorrectOptionsDialog",Pf.a,[635]);class Mq{static get Wg(){return Pf.a.Xz(Mq.Hm,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Mq.Hm="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(Mq,"AltTextDialogWithDescriptionHtml",null,[]);class Sp{static get Wg(){return Pf.a.Xz(Sp.Hm,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Sp.Hm="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(Sp,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class Zo extends Pf.a{constructor(b=!1,h=!1){super(!1,!1,b);this.Hji=!1;h?(this.Hji=!0,this.Wg=Sp.Wg):this.Wg=Mq.Wg;this.sg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}H8e(b){this.Yh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(z.a)(this,this.Uuk,"altTextDialogHandler"),this.bnf(b));b=document.getElementById(Zo.uZe);b.focus();b.select()}bnf(b){const h={};this.Hji||(h[Zo.uZe]=this.Vkf(b));h[Zo.tZe]=this.rMl(b)||"";return h}mua(b){return b.zf.id===
Zo.tZe?!1:super.mua(b)}}Zo.uZe="titleText";Zo.tZe="descriptionText";Object(m.a)(Zo,"BaseAltTextDialogWithDescription",Pf.a,[]);var ni=c(37);class ho extends Zo{constructor(b,h,t,A,O){super();this.tk=h;this.qn=t;this.Is=A;this.Kd=O;this.Aob=this.bT=null;this.H8e(b)}rMl(b){this.bT=b.node;this.Aob=ni.TableReader.wdi(b);return ni.TableReader.dsf(this.Aob)}Vkf(b){this.bT=b.node;this.Aob=ni.TableReader.wdi(b);return ni.TableReader.esf(this.Aob)}Uuk(b,h){if(1===b){b=ni.TableReader.esf(this.Aob);const t=
ni.TableReader.dsf(this.Aob),A=h[Zo.uZe];h=h[Zo.tZe];this.hide();const O=this.Is.Qc(15);try{O.Eb(this.bT),this.tk.E9f(this.Aob,A),this.tk.dhj(this.Aob,h)}finally{O&&O.dispose()}A===b&&h===t||this.Kd.Bs(16)}this.qn.Yp&&this.qn.Vq.aH(this.bT)}}Object(m.a)(ho,"TableAltTextDialog",Zo,[]);class vq{constructor(b,h,t){this.Iz=b;this.Ic=h;this.Wd=t}create(b){return new ho(b,this.Iz,Jb.App.xd,this.Ic,this.Wd)}}Object(m.a)(vq,"TableAltTextDialogFactory",null,[]);const wq=()=>{Jb.App.moh=!0;return 32},Xq=(b,
h,t,A,O)=>{if(1===t)return 32;if(!({point:b,ux:h}=Hi(O)).returnValue)return 16;Jb.App.ya.yic(b,h);return 32},Tp=(b,h,t,A,O)=>{if(1===t)return 32;if(!({point:b,ux:h}=Hi(O)).returnValue)return 16;Jb.App.ya.mia(b,h);return 32},Hi=b=>{let h=null,t=0;if(!b)return{returnValue:!1,point:h,ux:t};b=b.split(",");if(3>b.length)return{returnValue:!1,point:h,ux:t};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));t=parseInt(b[2]);return{returnValue:!0,point:h,ux:t}};var Ol=c(1806);class Ns extends Sys.EventArgs{constructor(b,
h,t,A,O,aa=0,ua=0,Ra=null){super();this.controlId=b;this.commandId=A;this.time=O;this.commandSurface=aa;this.ux=ua;this.contentType=Ra}}Object(m.a)(Ns,"CommandClickEventArgs",Sys.EventArgs,[]);class fq{constructor(b,h){this.Dra=b.Mmf();this.Apc=b;this.d8a=h}NNa(b,h,t,A=null,O=null){t&&(this.d8a.iD=t.CommandLocation,this.d8a.p_=t.InvocationMethod,this.d8a.ZMa=t.CommandTabName);b=parseInt(b);let aa=this.Apc.t4h(b,h,t);aa.zNf&&(aa=this.Apc.t4h(aa.IL,h,t));if(void 0!==aa.m_a&&null!==aa.m_a)return aa.m_a;
if(aa.IEb)O=32;else{var ua=null;this.Dra&&this.Dra.iXf&&(ua=this.Dra.iXf(aa,O));aa.Bga||aa.VTc?aa.pDa?O=16:(O=this.d8a.Rb(aa.IL,aa.eac?2:1,aa.qd,O),2===O&&(O=32)):aa.pDa?O=this.d8a.dpa(null,aa.IL,aa.qd,Ra=>{A&&A(Ra.response)},O):(O=this.d8a.Rb(aa.IL,2,aa.qd,O),A&&A(O));this.Dra&&this.Dra.dXf&&this.Dra.dXf(aa,O,ua);if(h&&t&&-1!==t.InvocationMethod&&t.InvocationMethod){t=h.LegacyId;if(void 0===t||null===t)t="";ua=h.ParentMenuId;void 0!==ua&&null!==ua||!h.MenuId||(ua=h.MenuId);let Ra=h.SqmControlId;
void 0!==Ra&&null!==Ra||!h.SourceControlId||(Ra=h.SourceControlId);(void 0!==Ra&&null!==Ra||void 0!==ua&&null!==ua)&&Ol.a.AGn(new Ns(Ra,t,ua,Kf.ActionManager.Q$(b),Date.now()))}}aa.Bga&&32===O&&this.Dra&&this.Dra.LBa&&this.Dra.LBa(aa,h);aa.VTc&&32===O&&this.Dra&&this.Dra.xYa&&this.Dra.xYa(aa,h);return 32===O||1===O}gFa(b,h=null){if(v.AFrameworkApplication.Rk||sf.a.instance.zv)return!1;null!=h&&null!=h.UILocation&&(this.d8a.iD=h.UILocation);const t=parseInt(b);if(!b||t===Kf.ActionManager.Pef)return!0;
b=this.Apc.j4h(t,h);b.zNf&&(b=this.Apc.j4h(b.IL,h));if(void 0!==b.m_a&&null!==b.m_a)return b.m_a;t===ab.a.b_b&&h&&(b.qd=h);return 32===this.d8a.Rb(b.IL,1,b.qd)}clearCache(){this.Apc.clearCache()}}Object(m.a)(fq,"GeneralCuiUser",null,[118,119]);var mk=c(175),ck=c(85),Tf=c(61),Nq=c(1388);class gp{get EG(){return null!=this.VFg?this.VFg:this.VFg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}constructor(b,h,t,A){this.lPg="DocumentProofingFailed";this.HSe=b;this.Meh=h;this.hdd=t;this.fI=A}z4l(){const b=
this.fI.N1l(this.HSe);return{returnValue:this.fI.zOa(this.HSe),eDn:b}}TOo(b,h){const t=ck.a.Nt();if(t){var A=new mk.ScriptSharpLegacyMap;A.add(Af.a.IK,b);A.add(Lc.a.noProof,h);b=new Te.GraphTransaction(15);b.Eb(t);this.EG.HIb(Tf.StyleReader.wordStyleIdNormal,A,t)?Nq.a.Ouj():(u.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),Nq.a.recordQosError(this.lPg,[Nq.a.myc],"Style could not be modified"));b.dispose()}else u.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),Nq.a.recordQosError(this.lPg,
[Nq.a.myc],"PageContentNode not found")}sao(b,h){this.TOo(b,h)}Efo(b,h){if(this.Meh){var t=new ji.DictionaryPropertySet;this.hdd.execute(A=>{A.GJc(b)});t.setValue(Af.a.IK,b);t.setValue(Lc.a.noProof,h);h=new Te.GraphTransaction(15);h.set(Jb.App.jk.Kl);this.Meh.u4(t);h.dispose()}}jf(){return nf.SelectionEditor.jf(this.HSe)}}Object(m.a)(gp,"LanguageEditor",null,[630]);var sp=c(627),xq=c(236),so=c(94);class to{constructor(b=!1,h=0){this.languages=to.zci(Sf.a.hLl());this.xmd=new xq.a;this.CRa=[];this.fXb=
new sp.a;this.U0i=b;this.x9g=0>=h?7:h;this.w9g=this.bNe=0;this.iUg=!1;b&&(this.Lrm(),v.AFrameworkApplication.uJ(()=>{this.Y_m()}))}Lrm(){for(var b of this.languages)this.xmd.Z(b.LCID,b);b=[];try{const A=dc.a.get("RecentlyUsedLcids");if(A&&""!==A){const O=decodeURIComponent(A).split(",").slice(0,this.x9g);for(const aa of O){let ua;({value:ua}=this.xmd.Ec(parseInt(aa),ua)).returnValue&&b.push(ua)}}}catch(A){u.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",
A.message),Array.clear(b)}if(b.length)for(var h of b){var t=h.LCID;this.fXb.contains(t)||(this.CRa.push(h),this.fXb.add(t))}else h=v.AFrameworkApplication.lcid,({value:t}=this.xmd.Ec(h,t)).returnValue&&(this.CRa.push(t),this.fXb.add(h));this.paj()}paj(){const b=so.toArray(so.select(so.asEnumerable(this.CRa),h=>h.LCID)).join(",");dc.a.ASa("RecentlyUsedLcids",b,180)}PTl(b){let h,t=-1,A=null;var O=to.zci(this.CRa);this.U0i&&0<O.length&&(A=so.toArray(so.Si(so.asEnumerable(O),(Ra,ub)=>{b===Ra.LCID&&-1===
t&&(t=ub);return{["key"]:ub,["text"]:Ra.displayName,["value"]:Ra.LCID.toString()}})));let aa=0;A&&(aa=A.length);O=aa;const ua=so.toArray(so.Si(so.asEnumerable(this.languages),(Ra,ub)=>{b===Ra.LCID&&-1===t&&(t=aa+ub);return{["key"]:aa+ub,["text"]:Ra.displayName,["value"]:Ra.LCID.toString()}}));h=t;return 0<aa?{returnValue:A.concat.apply(A,ua),selectedIndex:h,goj:O}:{returnValue:ua,selectedIndex:h,goj:O}}zco(b,h){if(this.U0i&&({value:t}=this.xmd.Ec(b,t)).returnValue){h=b!==h;if(this.fXb.contains(b))b=
Array.indexOf(this.CRa,t),0<=b&&(Array.removeAt(this.CRa,b),this.CRa.push(t)),h&&this.bNe++;else{this.fXb.add(b);this.CRa.push(t);if(this.CRa.length>this.x9g){var t=this.CRa.shift();this.fXb.remove(t.LCID)}h&&this.w9g++}this.paj()}}Y_m(){const b=this.bNe+this.w9g;!this.iUg&&0<b&&(u.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.bNe/b),this.iUg=!0)}static zci(b){b=Array.clone(b);b.sort((h,t)=>h.displayName.localeCompare(t.displayName));return b}}Object(m.a)(to,"LanguageListHelper",
null,[629]);var Or=c(199);class uo extends Or.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(m.a)(uo,"NumberButtonProps",Or.a,[]);var Ik=c(235);class Ah{static get E4(){return null!=Ah.kDg?Ah.kDg:Ah.kDg=Sa.a.instance.Ma("Box4.ISpacingCommands")}static get Vg(){return Ik.ContextSetEditor.instance}static get sFa(){return null!=Ah.gAg?Ah.gAg:Ah.gAg=Sa.a.instance.Ma("Box4.ILineSpacingHelper")}static get fkj(){return!!Ah.E4}static Ub(){const b=v.AFrameworkApplication.xa;
b.pa(qa.a.Wec,mc.a.view,Ah.Wec);b.Uc(qa.a.Wec,1124);b.pa(qa.a.Wec,mc.a.paragraph,Ah.$Oo)}static Wec(b,h,t,A,O){if(1===t||!Ah.fkj)return Ah.fkj?32:8;if(!Ah.Nui){var aa=[];aa.push(Object.assign(new uo,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));aa.push(Object.assign(new uo,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));aa.push(Object.assign(new uo,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));aa.push(Object.assign(new uo,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));aa.push(Object.assign(new uo,
{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));aa.push(Object.assign(new uo,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));O.MenuItems=Sk.e(aa);Ah.Nui=!0}u.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.nb;aa=null;h&&h.hb.lb&&(aa=h.hb.lb);h=Ah.Vg.EZh(aa.Qa);v.AFrameworkApplication.xa.Nf(h,b,t,!0,A,O);return 32}static $Oo(b,h){let t=b=!0;h=Ah.sFa.VDa(h.node);var A=h.beforeSpacing;let O=!1;1===A.unit&&(O=!0);if(O||0<A.value)b=!1;h=h.afterSpacing;A=!1;1===h.unit&&(A=
!0);if(A||0<h.value)t=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ah.hok,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ah.mUn,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ah.gok,!t));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ah.lUn,t));return 32}}Ah.hok="AddSpaceBeforeParagraph";Ah.gok="AddSpaceAfterParagraph";Ah.mUn="RemoveSpaceBeforeParagraph";Ah.lUn="RemoveSpaceAfterParagraph";Ah.Nui=!1;Object(m.a)(Ah,
"LineSpacingRibbonMenu",null,[]);var oh=c(158),Wl=c(1665),zr=c(1371);const jr=(b,h,t)=>{if(1===t)return 32;b=Jb.App.ya.notificationBar.Jla("Automation test",!1);b.image=3;Jb.App.ya.notificationBar.Kz(b);return 32},$n=(b,h,t,A,O)=>{let aa;if(!({ZBj:aa}=Jp(O)).returnValue)return 16;oh.UISurfaces.fM().then(ua=>{let Ra=null;var ub=Object.assign(new Wl.a,{label:"OK",onExecute:()=>{Ra&&ua.removeNotification(Ra)}});ub=Object.assign(new zr.a,{target:"#"+Hh.AppFrame.o5f,content:"Here's the text for the callout",
title:"Your title",primaryButtonProps:ub,useTeachingStyles:aa});ub=ua.callout(ub);Ra=ua.addNotification(ub);return null},ua=>{u.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",ua);return null});return 32},Jp=b=>{let h=!1;if(!b)return{returnValue:!1,ZBj:h};h=Boolean.parse(b);return{returnValue:!0,ZBj:h}};var On=c(1450);let Wk,Xl,cn,Dk;class vl{constructor(){this.p6=new Mb.a;this.nZg=!1}Kcb(b){const h=this.p6.indexOf(b);let t=!0;if(-1!==h){t=!1;if(!h)return t;this.p6.removeAt(h)}this.p6.insert(0,
b);u.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.p6.count&&(u.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.p6.J(10)),this.p6.removeAt(10));this.wQo();return t}Gjg(b){let h="#";for(let A=0;A<this.p6.count;A++){var t="#"+this.p6.J(A).substring(4,6)+this.p6.J(A).substring(2,4)+this.p6.J(A).substring(0,2);t=Object.assign(new On.a,{Color:this.p6.J(A),Alt:t,DisplayColor:t});if(t.DisplayColor.toLowerCase()===b.toLowerCase()){h=
t.Color;break}}for(const A of vl.t9g)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(A,h))}wQo(){u.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let t=0;t<this.p6.count;t++){var h="#"+this.p6.J(t).substring(4,6)+this.p6.J(t).substring(2,4)+this.p6.J(t).substring(0,2);h=Object.assign(new On.a,{Color:this.p6.J(t),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const t of vl.t9g)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(t,
b));this.nZg||this.vPo();this.nZg=!0}vPo(){for(const b of Object.keys(vl.U2g)){u.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=vl.U2g[b],t=[];for(const A of h)t.push(appChrome.api.menuSection([A],A in vl.$He?vl.$He[A].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,t,vl.$He[b].toString()))}}}vl.U2g={["FontColor"]:(Dk=new Mb.a,Dk.add("AutomaticFontColor"),Dk.add("ThemeFontColorPickerMCU"),Dk.add("ThemeFontColorPicker"),Dk.add("StandardFontColorPicker"),
Dk.add("RecentFontColorPicker"),Dk.add("MoreFontColors"),Dk),["CellShading"]:(cn=new Mb.a,cn.add("ThemeShadingColorPickerMCU"),cn.add("ThemeShadingColorPicker"),cn.add("StandardShadingColorPicker"),cn.add("RecentCellShadingColorPicker"),cn.add("ClearShadingColor"),cn.add("MoreCellShadingColors"),cn),["PictureBorders"]:(Xl=new Mb.a,Xl.add("ThemePictureBorderColorPickerMCU"),Xl.add("ThemePictureBorderColorPicker"),Xl.add("StandardPictureBorderColorPicker"),Xl.add("RecentPictureBorderColorPicker"),Xl.add("MorePictureBorderColors"),
Xl.add("NoPictureBorder"),Xl.add("PictureBorderWeightOptions"),Xl.add("PictureBorderStyleOptions"),Xl)};vl.$He={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:"Picture Border"};vl.t9g=(Wk=new Mb.a,Wk.add("RecentFontColorPicker"),Wk.add("RecentCellShadingColorPicker"),Wk.add("RecentPictureBorderColorPicker"),Wk);Object(m.a)(vl,"RecentColorsSectionHandler",null,[]);var Up=c(1397),em=c(1044);class tp{constructor(b){this.H8j=b}U3(){}T3(b){this.H8j.xbn(b)}}Object(m.a)(tp,"DataBuddyActionListener",
null,[38]);class Oq{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(m.a)(Oq,"DataBuddyTaskPaneProps",null,[]);class Yl{constructor(b){this.isVisible=!1;this.zY=new Mb.a;this.Vpe=null;this.k2=b;this.QA=new Up.a;this.Vb=yd.FocusManager.instance()}initialize(){this.Vpe=new tp(this);this.k2.lNa();this.QA.UK(this.onk());this.QA.UK(this.pkk())}toggle(){this.isVisible?this.hide():this.show()}xbn(b){if(2===b.behavior){const h=Kf.ActionManager.Q$(b.actionId)||
b.actionId.toString();h.startsWith("Query")||(this.zY.add(h+": "+Yl.lDl(b.response)),this.wm())}}hide(){oh.UISurfaces.uu().then(b=>{b.hideTaskPane(Yl.BB,2);return null})}show(){oh.UISurfaces.uu().then(b=>{b.showTaskPane(Yl.BB,this.Pz());return null});this.isVisible&&oh.UISurfaces.uu().then(b=>{b.setSelectedTaskPane(Yl.BB);return null})}onk(){return b=>{b.actions=this.zY.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}pkk(){return b=>{b.onClearClick=()=>{this.zY.clear();
this.wm()}}}Ub(){v.AFrameworkApplication.xa.fR(this.Vpe)}Z6a(){v.AFrameworkApplication.xa.yPb(this.Vpe)}Pz(){const b=new Oq;this.QA.snb(b);return Object.assign(new em.a,{title:"Data Buddy",hideHeader:!1,width:Yl.width,location:2,contentProps:b,onOpen:()=>{this.g9();this.Ub();this.isVisible=!0;v.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.tca();this.Z6a();this.isVisible=!1;this.wm();v.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0})}wm(){oh.UISurfaces.uu().then(b=>{b.updateTaskPane(Yl.BB,
this.Pz());return null})}g9(){this.Vb.mg(Yl.BB)}tca(){this.G2a()&&this.Vb.mg(this.Vb.fT)}G2a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===Yl.BB}static lDl(b){switch(b){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}Yl.BB="DataBuddyTaskPane";Yl.width=300;Object(m.a)(Yl,"Box4DataBuddyTaskPane",null,
[628]);class Qm{constructor(b){this.Fh=b}lIa(b){this.Fh&&this.Fh.CG(b)}f$c(){this.Fh&&this.Fh.w$c(void 0)}}Object(m.a)(Qm,"RibbonButtonUpdater",null,[627]);var vo=c(400);class Oi{constructor(){this.UQe=this.W=null}get name(){return"Box4.UI"}yc(b){this.W=b;b.ha("Box4.IGeneralCuiUser",()=>new fq(b.resolve("Box4.UI.CuiActionBridge"),v.AFrameworkApplication.xa)).singleInstance();b.ha("Box4.UI.TableAltTextDialogFactory",()=>new vq(b.resolve("Box4.ITableEditor"),new vo.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();
b.ha("Box4.UI.ILanguageEditor",()=>new gp(he.a.instance.pg,b.Ma("Box4.ITextFormattingCommands"),b.Sa("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ha("CommandUI.StandaloneRootController",()=>new ds(v.AFrameworkApplication.Ks)).as("Common.IStandaloneRootController").singleInstance();b.ha("Box4.UI.IAutoCorrectOptionsDialog",()=>new ro(b.resolve("Box4.IAutoCorrectOptionsInfo"),v.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ha("Box4.UI.LanguageListHelper",()=>
new to(v.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").singleInstance();b.register(Zn,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").singleInstance();b.ha("Box4.UI.DefaultProofingContextMenuCreator",()=>new Ip(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).singleInstance();b.ha("Box4.UI.ProofingContextMenuSectionFactory",()=>new uq(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),
b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").singleInstance();b.ha("Box4.RibbonButtonUpdater",()=>new Qm(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").singleInstance();b.ha("Box4.UI.RecentColorsSectionHandler",()=>new vl).singleInstance();b.ha("Common.IDataBuddyTaskPane",()=>new Yl(Oo.a.instance)).singleInstance()}init(){var b=Jb.App.ya;const h=b.Ob;Rc.Gpm(Object(z.a)(h,h.lJb,"onAuthenticationLost"),Object(z.a)(h,
h.mJb,"onAuthenticationRestored"),b.gMk);b=v.AFrameworkApplication.xa;b.pa(qa.a.aAn,mc.a.application,wq);b.gb(qa.a.joo,mc.a.application,Xq,96);b.gb(qa.a.Roo,mc.a.application,Tp,96);b=v.AFrameworkApplication.xa;b.gb(qa.a.Aqo,mc.a.application,jr,96);b.gb(qa.a.Zno,mc.a.application,$n,96);Ah.Ub();this.Srm();this.UQe=this.W.resolve("Common.IStandaloneRootController")}Srm(){this.W.Sa("Box4.IGeneralCuiUser").execute(b=>{this.W.Sa("Common.IStandaloneRootController").execute(h=>{h.zca.eF=b})})}dispose(){this.UQe.dispose();
this.UQe=null}static main(){P.a.instance.Gc(new Oi,6)}}Object(m.a)(Oi,"Box4UIPackage",null,[1,2]);var Fj=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},Jl=c(1821);class qm{get name(){return"Box4.Insights"}init(){}dispose(){}yc(b){b.ha("Box4.Insights.Box4InsightsSelection",
()=>new Jl.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance()}}Object(m.a)(qm,"Box4InsightsPackage",null,[1,2]);const El=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var ej=c(443),Am=c(415),Io=c(1791);class Pq{zkb(){return!1}reset(){}update(){}}Object(m.a)(Pq,"NullTaskYieldStrategy",null,[609]);var wo=c(1401);class io{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=
this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(m.a)(io,"CatchUpConfiguration",null,[]);class xn{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=
this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(m.a)(xn,"SharedControllerFactoryParameters",null,[]);var vm=c(167),Vc=c(18);class Pr{constructor(b,h,t,A){this.kon=(O,aa)=>{(this.hkd=!this.hkd)&&aa.Yj&&aa.Yj.contextId===mc.a.Vc&&this.qzh(aa.Yj.node,aa.Yj.zj);return 32};this.Ex=b;this.Mp=h;this.ga=t;this.Vb=A;this.Vld=this.Wld=null;this.hkd=!1;this.ga.pa(Vc.a.dtj,mc.a.view,this.kon);this.Vb.fe(vf.AFrame.qp).bindAction(sb.KeyInputManager.mc(rc.a.Umc,
6),Vc.a.dtj)}Y3(b,h){this.hkd&&this.Mp&&h&&h.sl&&h.sl.lb&&h.sl.lb.Qa&&h.sl.lb.Qa.node&&h.sl.lb.Qa.contextId===mc.a.Vc&&this.qzh(h.sl.lb.Qa.node,h.sl.lb.Qa.zj)}qzh(b,h){b&&(this.EKi(b)?(this.Wld&&this.Wld.id.equals(b.id)||(this.Mp.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.Wld=b),this.i3m(b,h)):this.Vld=this.Wld=null)}EKi(b){return 0<this.Ex.CDb(b).count}i3m(b,h){if(b){var t=-1,A=null,O=null;for(let aa=0;aa<b.qa.length;aa++){const ua=b.qa.J(aa);
if(!(null==O||ua.changeStart&&ua.changeStart.equals(A))&&h>=t&&h<=ua.cp&&!A.equals(this.Vld))if(this.Ex.rGb(A)){(b=this.Ex.LLc(A,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Mp.sendNotification(b,!1),this.Vld=A);break}else this.Vld=null;ua.changeStart&&!ua.changeStart.equals(A)&&(t=ua.cp,A=ua.changeStart);O=ua.changeStart}}}}Object(m.a)(Pr,
"ActivityAnnouncementManager",null,[]);var xs=c(1372),Qr=c(477),Pn=c(773),Z=c(529);class na{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(m.a)(na,"Activity",null,[]);var qb=c(433);class Xb extends na{constructor(){super();this.qv=this.objectId=null}static zG(b){const h=new Z.a(new qb.a);if(b.qv)for(const t of b.qv)h.add(t);return h}}Object(m.a)(Xb,"RevisionSetActivity",na,[]);class wc{constructor(b,
h,t,A=!1){this.sue=null;this.dismiss=()=>{this.YKi.then(O=>{O.removeNotification(this.sue);return this.sue=null})};this.GW=b;this.rc=h;this.YKi=t;this.P$b=A}JHo(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.rc.Rb(ab.a.K3a,2,null);break;default:this.Cbn()}else u.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}Cbn(){this.YKi.then(b=>{var h=Object.assign(new zr.a,{target:'[data-unique-id~="CatchUpWithChanges"]',
showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new xs.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const t=Object.assign(new Qr.a,{expirationOptions:Object.assign(new Pn.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.sue=b.addNotification(h,t)})}doesContentExist(b){if(!b)return u.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return u.ULS.sendTraceTag(593049025,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.rc.Rb(ab.a.ZHd,2,h))return!1;break;case 1:return this.Ail(b)}return!0}Ail(b){b=Xb.zG(b);return b?0<this.GW.cOd(b).count:(u.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(m.a)(wc,"ActivityContentManager",null,[513]);var Zc=c(1465),vd=c(1998),ud=c(432),Ie=c(707);class ig{constructor(){this.qv=this.uX=null}compare(b){if(!b)return!1;
if(this.uX&&b.uX){if(this.uX.count!==b.uX.count)return!1;for(const h of this.uX)if(!b.uX.contains(h))return!1}else if(!b.uX&&this.uX||!this.uX&&b.uX)return!1;if(b.qv&&this.qv){if(b.qv.count!==this.qv.count)return!1;for(const h of this.qv)if(!b.qv.contains(h))return!1}else if(!this.qv&&b.qv||!b.qv&&this.qv)return!1;return!0}}Object(m.a)(ig,"ActivityHighlightableObject",null,[]);class cg extends Zc.a{constructor(b,h){super();this.mMe=this.TWb=null;this.qcd=b;this.Ex=h;this.L1=[new vd.a(ud.a.$xh,ud.a.Zxh),
new vd.a(ud.a.Xxh,ud.a.Wxh),new vd.a(ud.a.CBd,ud.a.DBd),new vd.a(ud.a.EBd,ud.a.Y3e)]}get Jhb(){return 1}get m1a(){return this.L1}get Xaa(){return!0}D0a(b,h){if(b=Object(Da.a)(ig,b))if(b.uX)for(const t of b.uX)h.add(t);else u.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}ZFa(b,h){if(this.Uu.JCa){var t=this.qcd.y5a,A=this.qcd.Lhb,O=!!t&&t.compare(A),aa=this.Uu.JCa,ua=aa.action,Ra=this.Sko(aa,b),ub=!1;2!==ua&&ua&&(ub=(ub=this.Uu.zVc)?1===ub.type:!!t||!!A);h=h.uGa("*");
for(let Nb=0,Yb=h.length;Nb<Yb;Nb++){const bc=h[Nb],Dc=this.FNl(bc,ud.a.IEc);if(Dc&&Dc.Kt)if(this.dTn(bc),1===aa.type)switch(ua){case 0:Ra&&t.qv.contains(Dc.Kt)&&this.wzd(bc,2,Dc,!1);break;case 2:Ra&&A.qv.contains(Dc.Kt)&&this.wzd(bc,O?2:1,Dc,!1);break;default:this.t8b(b,bc,Dc,!1)}else ub?this.t8b(b,bc,Dc,!1):this.t8b(b,bc,Dc,!0)}this.TWb&&(this.TWb.classList.add(ud.a.EBd),this.mMe=this.TWb=null)}}FNl(b,h){return ph.a.Db(b,h)}Sko(b,h){if(b&&b.eA){const t=b.eA,A=b.action;if(1===b.type&&(2===A||!A)&&
t.uX)return t.uX.contains(h);if(t.qv)for(const O of t.qv){b=this.Ex.dNc(O);for(const aa of b)if(aa===h)return!0}}return!1}t8b(b,h,t,A){const O=this.qcd.y5a,aa=this.qcd.Lhb;O&&O.qv.contains(t.Kt)&&(!O.uX||O.uX.contains(b))?this.wzd(h,2,t,A):aa&&aa.qv.contains(t.Kt)&&(!aa.uX||aa.uX.contains(b))&&this.wzd(h,1,t,A)}wzd(b,h,t,A){b&&Ie.a(b)&&(b.classList.add(this.yRl(2===h,A)),this.Obo(b,t,A))}Obo(b,h,t){this.TWb?-1!==h.cpEnd&&this.mMe.cpEnd!==h.cpBegin&&(this.TWb.classList.add(t?ud.a.Y3e:ud.a.EBd),b.classList.add(t?
ud.a.DBd:ud.a.CBd)):b.classList.add(t?ud.a.DBd:ud.a.CBd);b.classList.add(ud.a.Yxh);this.TWb=b;this.mMe=h}dTn(b){this.Uu.MRa(b);this.WRn(b)}WRn(b){b.classList.remove(ud.a.CBd,ud.a.DBd,ud.a.Yxh,ud.a.EBd,ud.a.Y3e)}yRl(b,h){return h?b?ud.a.Wxh:ud.a.Zxh:b?ud.a.Xxh:ud.a.$xh}}Object(m.a)(cg,"ActivityHighlightActor",Zc.a,[]);var Jg=c(1999),Kg=c(185);class oi{constructor(b,h,t,A,O,aa,ua,Ra){this.FV=b;this.pN=h;this.Ex=t;this.uxc=O;this.ib=aa;this.Mp=Ra;this.Vb=ua;this.pN.oYd=!1}XQi(b,h,t){b?this.Okm(b,h,t):
this.pN.y5a&&(b=Object.assign(new Jg.a,{action:1,type:1,eA:null,lJ:this.pN.y5a}),this.pN.y5a=null,this.FV.gF(b))}Okm(b,h,t){if(h){b=new Z.a(new qb.a);for(O of h){var A=this.Ex.jMc(O);for(let aa=0;aa<A.length;aa++){const ua=A[aa];this.Ex.rGb(ua)&&b.add(ua)}}var O=this.Ex.cOd(b);O=this.vGh(O,b);A=this.pN.y5a;this.pN.y5a=O;O=Object.assign(new Jg.a,{action:0,type:1,eA:this.pN.y5a,lJ:A});this.FV.gF(O);t&&!this.j5n(h.J(0),b)||this.V6n(h.J(0),b)}else u.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",
b.activityId)}j5n(b,h){if(!b)return u.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return u.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.NKl(b,h);return this.uxc.SGa(b.id,h)?this.setSelection(b,h)?!0:!1:(u.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}V6n(b,h){b=this.zRl(b,h);h=new Sys.StringBuilder;for(let t=
0;t<b.count;t++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,t+1,b.count,b.J(t)));this.Mp.sendNotification(h.toString(),!0)}setSelection(b,h){if(!b||!qe.ParagraphReader.Yb(b))return u.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return u.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.pN.oYd=!0;b=pf.a.Tc(b,h);b=new Kg.Selection([b],!0);this.ib.setSelection(b);yd.FocusManager.DJ()&&
this.Vb.mg(vf.AFrame.$n);return!0}NKl(b,h){if(h&&0<h.count)for(let t=0;t<b.qa.length;t++){const A=b.qa.J(t);if(A.changeStart&&h.contains(A.changeStart))return A.cp}u.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}zRl(b,h){const t=new Mb.a;if(h&&0<h.count&&b){let A=-1;for(let O=0;O<b.qa.length;O++){const aa=b.qa.J(O);if(-1!==A&&aa.isChangeEnd)if(aa.changeStart&&h.contains(aa.changeStart))continue;else t.add(b.characterData.substring(A,
aa.cp)),A=-1;aa.changeStart&&h.contains(aa.changeStart)&&(A=aa.cp)}}return t}dQi(b,h){if(b)switch(b.type){case 1:if(h){b=new Z.a(new qb.a);for(var t of h){h=this.Ex.jMc(t);for(let A=0;A<h.length;A++){const O=h[A];this.Ex.rGb(O)&&b.add(O)}}}else b=Xb.zG(b);h=this.Ex.cOd(b);this.pN.Lhb=this.vGh(h,b);t=Object.assign(new Jg.a,{action:2,type:1,eA:this.pN.Lhb,lJ:null});this.FV.gF(t)}else this.pN.Lhb&&(t=Object.assign(new Jg.a,{action:3,type:1,eA:null,lJ:this.pN.Lhb}),this.pN.Lhb=null,this.FV.gF(t))}vGh(b,
h){var t=null;if(b){t=new Ca.a;for(const A of b)12===A.type&&t.add(A)}b=new ig;b.uX=t;b.qv=h?h:this.iXl(t);return b}iXl(b){const h=new Z.a(new qb.a);if(!b)return h;for(const t of b)for(const A of this.Ex.CDb(t))h.add(A);return h}}Object(m.a)(oi,"ActivityHighlightManager",null,[]);var lj=c(531),Sh=c(498),Yi=c(1463),sk=c(125),pg=c(65);class Bm{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(m.a)(Bm,"CreateIndicatorTooltipParameters",null,[]);class Jo{constructor(){this.clearSticky=
!1}}Object(m.a)(Jo,"DismissIndicatorTooltipParameters",null,[]);class nl{constructor(){this.target=null;this.isSticky=!1}}Object(m.a)(nl,"UpdateIndicatorTooltipParameters",null,[]);class Hn extends Sys.EventArgs{constructor(b,h,t){super();this.fCb=b;this.ami=h;this.Wlo=t}}Object(m.a)(Hn,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class gq{constructor(){this.bmi=new Map;this.cmi=new Set}HEo(b,h){this.cmi.add(b);this.bmi.set(b,h)}lEm(b){return ff.a.usi(b.htmlElement)}Oam(){const b=new Set;for(const h of this.cmi){const t=
this.bmi.get(h);t&&this.kEm(t)&&b.add(h)}return b}kEm(b){return b.parentElement&&ff.a.usi(b.parentElement)}}Object(m.a)(gq,"IndicatorVisibilityTracker",null,[]);class Aj extends Yi.a{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){super();this.ra=new If.a;this.itb=this.f$=null;this.Bgm=(bc,Dc,Pc,jd,Cd)=>{if(!Cd)return u.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Dc=Xb.zG(Cd.Activity);bc=null;if(Cd.NodeId&&(Cd=sk.b(Cd.NodeId),!W.a.Sp(Cd,W.a.nil)&&(Cd=this.Ex.F5h(Cd),
this.Dhg(Cd,!1))))return 32;for(const ee of Dc)if(this.Ex.rGb(ee)){Cd=this.Ex.r6b(ee);if(this.Dhg(Cd,!0))return 32;Cd&&!bc&&(bc=Cd)}if(this.Dhg(bc,!1))return 32;u.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.zgm=(bc,Dc,Pc,jd,Cd)=>{u.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");Cd&&Dc&&Dc.Xk&&(bc=Dc.node)&&((bc=this.nnc.qOd(bc))?this.qxd(bc,!1,!1):u.ULS.sendTraceTag(595126289,
377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.Cqo=bc=>{(bc=this.nnc.qOd(bc.customData))&&this.qxd(bc,!1,!1)};this.onMouseEnter=bc=>this.gPi(bc.xw,!0);this.Eoa=bc=>{bc=bc.xw;if(bc===this.f$)return!0;this.e4i(bc);return!0};this.MFa=bc=>{this.itb=null;return this.gPi(bc.xw,!1)};this.P_=()=>{this.Obg();this.CCd(!0);return!1};this.Ns=()=>{this.bUi()};this.F7d=()=>{this.f$&&this.Azj(this.f$);this.itb&&this.e4i(this.itb);this.Sin()};this.bUi=()=>{this.f$?
this.Azj(this.f$):this.a5e()};this.Ex=b;this.eqe=h;this.bWg=t;this.b0j=A;this.nl=O;this.L5=null;this.Gb=ua;this.nnc=Ra;this.fCe=new gq;this.Xw=ub;this.YJ=Nb;this.eI=Yb;this.qf&&(this.qf.Xka(this.F7d),this.qf.Qmh(this.bUi));aa&&aa.execute(bc=>{bc.i4(this.Ns)})}get qf(){return this.nl&&this.nl.Yi?this.nl:(u.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}GCa(b,h,t){if(this.f$){var A=pg.a(this.f$);if(b===A)return this.f$}const O=b.Og.ownerDocument;A=lj.a.createElement(O,Sh.a.div);
A.className=ud.a.FBd;A.style.left=h+"px";A.style.top=t+"px";h=lj.a.createElement(O,Sh.a.div);h.className=this.Xw?ud.a.fyh:ud.a.ayh;A.style.cursor="pointer";h.style.cursor="pointer";this.eI&&(h.style.backgroundColor=this.YJ.rHl(),h.style.outlineWidth="1px",h.style.outlineStyle="solid",h.style.outlineColor=this.YJ.sHl());A.appendChild(h);Ud.a.instance.mb(db.a.SQ,A,this.onMouseEnter);Ud.a.instance.mb(db.a.LK,A,this.Eoa);Pd.a.instance.mb(db.a.click,A,this.MFa);Ud.a.instance.mb(db.a.contextMenu,A,this.P_);
u.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.zYm(b);h=this.eYl(b);this.fCe.HEo(h,A);this.fCe.lEm(b)&&this.wOi(h);return A}Lnb(b){return this.Njo(b)}reb(b){const h=this.UJk(b),t=[];t.push(this.GCa(b.b4,h,b.Vlc[0].y-b.cba[0].y));return t}UJk(b){let h=ud.a.Jom+(0>b.OVc?-b.OVc:0);const t=Hc.a.Ki(b.leftMargin,0)/2;1>=t&&u.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>t?t:h;h=h<ud.a.byh?ud.a.byh:h;return v.AFrameworkApplication.isRtl?
b.cba[0].width/this.zoom+h:-h}rjj(b){if(b&&393230===b.Nc||393251===b.Nc){const h=this.Ex.CDb(b);if(h)for(const t of h)if(b===this.Ex.r6b(t))return!0}return!1}Njo(b){for(const h of qe.ParagraphReader.Wv(b.Cb,!0,!1))if(this.rjj(h))return!0;return!1}Ub(b){b.pa(Vc.a.dlj,mc.a.Vc,this.zgm);b.pa(Vc.a.gbg,mc.a.Vc,this.Bgm)}Dhg(b,h){if(!b)return!1;const t=this.nnc.qOd(b);if(t)return this.qxd(t,!1,!0),!0;if(!h){let A;this.J1c((A=new Mb.a,A.add(b),A),!1,!0,!0);h=new Vb.a(3,1,0,this.Cqo,181);h.customData=b;this.Gb.Wb(h);
return!0}return!1}k4k(b,h=!1){h&&this.CCd(!0);if(b&&b.parentNode){var t=this.osf(b);t=this.wDl(t);this.L5||(this.L5=document.createElement("Div"),document.getElementById(v.AFrameworkApplication.X_b).appendChild(this.L5));this.eqe.createActivityIndicatorTooltip(Object.assign(new Bm,{target:b,container:this.L5,activityIds:t,isSticky:h,dirHint:9}));h&&(this.f$=b)}else u.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}cnl(b){b&&
b.classList.add(ud.a.GBd)}gPi(b,h){return this.qxd(b,h,!1)}qxd(b,h,t){if(h&&b===this.f$)return!0;const A=this.osf(b);h||this.Obg();this.k4k(b,!h);this.cnl(b.getElementsByClassName(this.Xw?ud.a.fyh:ud.a.ayh)[0]);this.J1c(A,h,!0,t);this.wDi(A,h?1:2);this.b0j.o1d();h&&(this.itb=b);return!0}CCd(b=!1){this.eqe.dismissActivityIndicatorTooltips(Object.assign(new Jo,{clearSticky:b}));this.itb=null;b&&(this.f$=null)}Fmj(b){b&&b.classList.remove(ud.a.GBd)}Obg(){this.f$&&this.Fmj(this.f$.getElementsByClassName(ud.a.GBd)[0])}e4i(b){const h=
this.osf(b);this.J1c(h,!0,!1,!1);this.Fmj(b.getElementsByClassName(ud.a.GBd)[0]);this.CCd(!1);this.itb=null}osf(b){let h=null;(b=(b=pg.a(b))?b.Cb:null)&&11===b.type&&(h=qe.ParagraphReader.Wv(b,!0,!1));return h}a5e(){const b=!!this.itb;if(this.f$||b)this.Obg(),this.CCd(!0),this.J1c(null,!1,!1,!1),this.J1c(null,!0,!1,!1)}qpk(b){this.ra.addHandler(Aj.ujh,b)}rpk(b){this.ra.addHandler(Aj.vjh,b)}J1c(b,h,t,A){let O=null;if(t&&b){for(const aa of b)if(t=this.Ex.jMc(aa))for(let ua=0;ua<t.length;ua++){const Ra=
t[ua];if(this.Ex.rGb(Ra)){O=this.Ex.LLc(Ra,aa.id);break}}if(!O){u.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.ra.raiseEvent(Aj.ujh,new Hn(O,b,!1)):this.ra.raiseEvent(Aj.vjh,new Hn(O,b,A))}wDl(b){const h=[];if(b)for(const A of b){var t=this.Ex.CDb(A);for(const O of t)(t=this.Ex.LLc(O,A.id))&&h.push(t.activityId)}!h.length&&b&&b.count&&u.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return h}Azj(b){b&&b.parentNode?(this.eqe.updateActivityIndicatorTooltip(Object.assign(new nl,{target:b,isSticky:!0})),this.f$=b):u.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}Sin(){const b=this.fCe.Oam();for(const h of b)this.wOi(h)}wOi(b){this.bWg.vDi(b,3)}eYl(b){return(b=qe.ParagraphReader.Wv(b.Cb,!0,!1))&&b.count?b.J(0).id:null}zYm(b){b=qe.ParagraphReader.Wv(b.Cb,!0,!1);this.wDi(b,0)}wDi(b,
h){b&&b.count&&this.yYm(b.J(0).id,h)}yYm(b,h){this.bWg.vDi(b,h)}}Aj.ujh="ActivityIndicatorPreviewed";Aj.vjh="ActivityIndicatorSelected";Object(m.a)(Aj,"ActivityIndicatorActor",Yi.a,[]);var wg=c(40);class Ko{constructor(b,h,t){this.Ex=b;this.nvd=h;this.nl=t}get qf(){return this.nl&&this.nl.Yi?this.nl:(u.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}qOd(b){u.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");
const h=this.H6h(b);if(!h){u.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.Ex.CDb(b);for(const t of b)if(b=this.Ex.r6b(t),b=this.H6h(b))return b}return h}H6h(b){if(!b||12!==b.type)return u.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return u.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),
null;var h=this.nvd.FOc(b);if(!h||11!==h.type)return u.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.Ee(this.qf.jc);if(!h||!h.htmlElement)return u.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var t=vc.a.kMc(h.htmlElement,Ko.tjh);if(t)return t;h=h.Rhf();if(!h)return u.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),
null;h=vc.a.gIl(h,Ko.tjh);if(!h)return u.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(t=0;t<h.length;t++){const A=pg.a(h[t]),O=wg.OutlineElementNavigator.El(b);if(A&&A.Cb&&O&&A.Cb.id.equals(O.id))return h[t]}u.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}MSl(b){b=this.Ex.F5h(b);if(!b||12!==b.type)return u.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),
W.a.nil;b=this.qOd(b);if(!b)return u.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),W.a.nil;b=pg.a(b);return b?b.Cb.id:(u.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),W.a.nil)}}Ko.tjh="CatchUpActivityIndicatorContainer";Object(m.a)(Ko,"ActivityIndicatorHelper",null,[]);var hp=c(1666);class Rr{constructor(b,h,t,A,O,aa,ua){this.w1a=
b;this.pageContentNode=h;this.uWe=t;this.rc=A;this.GW=O;this.Qe=aa;this.cWd=ua;this.jzi=!1;this.g4m=(Ra,ub,Nb)=>{if(1===Nb)return this.Vuf?32:8;2===Nb&&(this.Vuf&&(this.uWe.a5e(),this.AQk()),u.ULS.sendTraceTag(38138719,377,50,E.c({["MarkAsRead invoked"]:!0})));Jb.App.ya.updateCommandUI();return 8};this.w1a.Q4a(this.uWe)}initialize(){this.rc.pa(Vc.a.oGi,yc.a.frame,this.g4m)}get Vuf(){return!!this.GW.UQ&&0<this.GW.UQ.count||!!this.GW.Rcc&&0<this.GW.Rcc.count}get oNm(){return this.jzi}MTf(b){const h=
b&&b.wywaActivities?b.wywaActivities.length:0;if(!this.cWd||0<h||!b){const t=new Map;t.set("activityCount",h.toString());this.Qe.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:t})}b?(this.ydn(b.wywaActivities),this.jzi=!0):(u.ULS.shipAssertTag(36538305,377,!1),this.cWd||Object(hp.a)(),this.Qe.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}ydn(b){b?(u.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.jio(b),b=this.GW.Lok(b),this.kio(b)):u.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}jio(b){if(b){var h=new Mb.a;for(const t of b)switch(t.type){case 2:case 3:case 4:case 10:b=4===t.type?t.IUi:t.contentId,h.add(b),this.GW.Rcc.add(b)}0<h.count&&(u.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.rc.Rb(ab.a.VJi,2,h.toArray()))}}kio(b){const h=new Z.a(new qb.a),t=new Te.GraphTransaction(3);try{t.Eb(this.pageContentNode);for(const A of b){const O=this.GW.r6b(A);O&&this.uWe.rjj(O)&&
(h.add(O.id),this.w1a.q9b(O,!0))}}finally{t&&t.dispose()}0<b.count&&Jb.App.ya.updateCommandUI();b={};b.highlightedNodeCount=h.count;u.ULS.sendTraceTag(36509257,377,50,"{0}",E.c(b))}AQk(){u.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.GW.Rcc.count&&(this.rc.Rb(ab.a.vOh,2,this.GW.Rcc.toArray()),this.GW.Rcc.clear());const b=this.zSk(this.GW.UQ);this.QRn(b)}QRn(b){u.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");
const h=new Te.GraphTransaction(3);try{h.Eb(this.pageContentNode);for(const t of b){this.GW.UQ.remove(t);for(const A of this.GW.dNc(t))this.w1a.q9b(A,!0)}this.GW.aAh()}finally{h&&h.dispose()}}zSk(b){const h=new Z.a(new qb.a);for(const t of b)h.add(t);return h}}Object(m.a)(Rr,"ActivityIndicatorManager",null,[]);class Yq{constructor(){this.Lhb=this.y5a=null;this.isFirstDocumentOpen=this.oYd=!1}}Object(m.a)(Yq,"ActivityStateManager",null,[512]);class Um{constructor(b,h){this.Odd={};this.MRb=b;this.ZJ=
h;this.Rcc=new Mb.a}get UQ(){return this.MRb.UQ}CDb(b){const h=new Z.a(new qb.a);if(!b)return h;b=this.MRb.zMd(b);for(let t=0;t<b.length;t++){const A=b[t];this.rGb(A)&&h.add(A)}return h}dNc(b){return this.MRb.dNc(b)}cOd(b){const h=new Mb.a;if(b)for(const t of b)h.addRange(this.dNc(t));return h}Lok(b){const h=new Z.a(new qb.a);if(b)for(const t of b)if(1===t.type&&(b=t))for(const A of b.qv){h.add(A);this.UQ.add(A);const O=A.toString();this.Odd[O]||(this.Odd[O]=new Mb.a);this.Odd[O].add(b)}this.aAh();
return h}rGb(b){return this.UQ&&b?this.UQ.contains(b):!1}LLc(b,h){if(b&&(b=this.Odd[b.toString()])&&0<b.count){for(const t of b)if(t.objectId.equals(h))return t;return b.J(0)}return null}r6b(b){return this.MRb.r6b(b)}aAh(){this.MRb.mQk()}jMc(b){return this.MRb.jMc(b)}F5h(b){if(!this.ZJ)return null;const h=this.ZJ.Mc;return h?h.Db(b):null}}Object(m.a)(Um,"ChangeIdCache",null,[]);var Kp=c(174),Ka=c(110);class Bb extends Kp.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=
null;this.H_=Object.assign(new Ka.a,{T_:Bb.getTypeName(),B_:Bb.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(m.a)(Bb,"ChangeSummariesResponse",Kp.a,[]);var lc=c(476);class Kc extends lc.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new Ka.a,{T_:Kc.getTypeName(),B_:Kc.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(m.a)(Kc,"ChangeSummariesRequest",lc.a,[]);var gd=c(358),Wd=c(399),af=c(254),Ce=c(397);class ef{constructor(){this.Vfc=this.G3c=null}}Object(m.a)(ef,"ActionPair",null,[]);class Ff{constructor(b,h,t,A){this.Uml=O=>{O=O.customData;const aa=this.D3i(O);aa&&(u.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.Epf(O)),aa.Vfc("Request timeout"))};this.gD=b;this.g5=h;this.Ze=t;this.Gb=A;this.hCe=null;this.wMe=
new xb.a;this.o$g=new xb.a}$wo(b){const h=Object.assign(new gd.a,{parentPath:["Signal",Kc.getTypeName()],items:[Object.assign(new Wd.a,{body:b})]});return this.initialize().then(()=>{const t=new Promise((A,O)=>{this.wMe.Z(b.requestId,Object.assign(new ef,{G3c:A,Vfc:O}))});this.o$g.Z(b.requestId,new Date);u.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",Ff.requestTimeoutMs);this.g5.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ce.a,
{operation:h}));this.$eo(b.requestId);return t})}initialize(){this.hCe||(this.hCe=this.gD.Bl().then(()=>{this.Ze.mb(this,Bb.getTypeName())}));return this.hCe}xD(b,h){if(b&&af.a.getTypeNameFor(b.content)===Bb.getTypeName())if(b=b.content){var t=this.D3i(b.correspondingRequest);t?h!==gd.a.getTypeName()?t.Vfc("Invalid operation type"):(u.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.Epf(b.correspondingRequest)),
t.G3c(b)):u.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.Epf(b.correspondingRequest))}else u.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else u.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}$eo(b){const h=new Vb.a(3,1,Ff.requestTimeoutMs,
this.Uml,176);h.dxd=0;h.customData=b;this.Gb.Wb(h)}D3i(b){if(!b)return null;let h;if(!({value:h}=this.wMe.Ec(b,h)).returnValue)return null;this.wMe.remove(b);return h}Epf(b){if(!b)return-1;let h;return({value:h}=this.o$g.Ec(b,h)).returnValue?(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return v.AFrameworkApplication.K.pc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(m.a)(Ff,"ChangeSummariesAugloopProvider",null,[126]);class di{constructor(){this.activityGroups=null}}Object(m.a)(di,
"FeaturedActivityGroupPayload",null,[]);class Bg{constructor(b,h,t,A,O){this.lak=b;this.eQj=h;this.WRj=t;this.EVj=A;this.fqb=O}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.EVj.Evb.then(()=>this.zOl(b)):Bg.Qef}Ydm(b,h,t){if(!h)return u.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;El("TranslateFeaturedActivityGroups");t=this.WRj.qFo(b,h,t.wywaActivities);u.ULS.sendTraceTag(542942800,377,
50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<h.inferences.length,0<t.length);this.fqb.set(h.correspondingRequest,t);return Object.assign(new di,{activityGroups:t})}zOl(b){El("BuildFeaturedActivityGroupRequest");const h=this.lak.QFk();if(!h||!h.documentContent||!h.activityChanges)return u.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),
Bg.Qef;if(!h.documentContent.length||!h.activityChanges.length)return Bg.Qef;u.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+h.requestId);El("SubmitFeaturedActivityGroupRequest");return this.eQj.$wo(h).then(t=>this.Ydm(h,t,b))}}Bg.Qef=Promise.resolve(Object.assign(new di,{activityGroups:[]}));Object(m.a)(Bg,"ChangeSummariesDataProvider",null,[511]);class Na{constructor(b,h){this.Ex=b;this.Yek=h}QFk(){const b=new Mb.a,
h=new Mb.a,t=new Z.a(new qb.a);var A=this.Ex.UQ;if(!A||!A.count)return Na.Tef;A=this.Ex.cOd(A);if(!A||!A.count)return u.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),Na.Tef;for(const O of A)t.contains(O.id)||(t.add(O.id),this.TBn(O,b,h));return h.count&&b.count?Object.assign(new Kc,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:sk.a(W.a.create())}):Na.Tef}TBn(b,h,t){if(qe.ParagraphReader.Yb(b)){var A=
qe.ParagraphReader.plainText(b);if(A&&A.length){h.add(A);A=this.Ex.CDb(b);A=this.hdm(A);for(const O of A){A=new Mb.a;const aa=this.getTextRanges(b,O);for(const ua of aa)A.add({changeEnd:ua.endIndex,changeSpanId:ua.a9n,changeStart:ua.startIndex,contentIndex:h.count-1,locationId:sk.a(b.id)});(A=this.i1k(O,A.toArray()))&&t.add(A)}}else u.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else u.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}hdm(b){const h=
new xb.a;for(const t of b)(b=this.H$h(t))?(h.ob(b)||h.Z(b,new Z.a(new qb.a)),h.J(b).add(t)):u.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return h.values}i1k(b,h){const t=[];let A=null;for(const O of b)if(b=this.Ex.LLc(O,W.a.nil)){if(!A){const aa=this.H$h(O);if(!aa||!aa.length){u.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}A=
aa}t.push(b)}else u.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return t.length?A?h.length?{activityId:t[0].activityId,changes:h,personId:A,timestamp:t[0].displayTimestamp.toISOString()}:(u.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(u.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),
null):(u.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}H$h(b){b=this.Ex.LLc(b,W.a.nil);if(!b)return u.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return u.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),
null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const t=new Mb.a;if(!h||!h.count||!b)return t;let A=-1,O=new Z.a(new qb.a);for(let aa=0;aa<b.qa.length;aa++){const ua=b.qa.J(aa);if(-1!==A&&ua.isChangeEnd){if(ua.changeStart&&h.contains(ua.changeStart)){O.add(ua.changeStart);continue}t.add({startIndex:A,endIndex:ua.cp,a9n:this.Yek.cdj(O)});A=-1;O=new Z.a(new qb.a)}ua.changeStart&&h.contains(ua.changeStart)&&(A=ua.cp,O.add(ua.changeStart))}return t}}Na.Tef=Object.assign(new Kc,
{activityChanges:[],documentContent:[],requestId:sk.a(W.a.nil)});Object(m.a)(Na,"ChangeSummariesRequestBuilder",null,[]);class $a{constructor(){this.changes=this.content=null}}Object(m.a)($a,"ContentChange",null,[]);class wb{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(m.a)(wb,"FeaturedActivityGroup",null,[]);class qc{constructor(){this.end=this.start=0}}Object(m.a)(qc,"TextRange",null,[]);class Ic{constructor(b){this.nnc=b}qFo(b,h,t){if(!h)return u.ULS.sendTraceTag(588379906,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),Ic.zId;if(!h.inferences)return u.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),Ic.zId;if(!h.activityClassifications)return u.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),Ic.zId;if(!h.inferences.length||!h.activityClassifications.length)return u.ULS.sendTraceTag(561111455,
377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),Ic.zId;const A=[],O=new Ba.a(new qb.a);for(const aa of h.inferences){const ua=this.pFo(aa,b,h,t);if(!ua)continue;const Ra=this.nnc.MSl(sk.b(ua.locationId));Ra.equals(W.a.nil)?A.push(ua):O.ob(Ra)?O.J(Ra).ranking>ua.ranking&&O.Z(Ra,ua):O.add(Ra,ua)}b=[...Array.from(O.values),...A];b.sort((aa,ua)=>aa.ranking-ua.ranking);return b.slice(0,Ic.t5m)}pFo(b,h,t,A){if(!b||gl.a.mf(b.activitiesInGroup))return u.ULS.sendTraceTag(588379909,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const O=new Mb.a,aa=new xb.a;let ua=null;for(const ub of b.activitiesInGroup){if(!ub){u.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>ub.activityIndex||ub.activityIndex>=t.activityClassifications.length){u.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");
continue}const Nb=t.activityClassifications[ub.activityIndex];if(!Nb||gl.a.mf(Nb.contents))u.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Ra=this.rul(A,Nb.activityId);if(Ra){O.add(Ra);for(const Yb of ub.changes){if(!Yb){u.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Ra=Yb.value;if(0>Ra||Ra>=Nb.contents.length){u.ULS.sendTraceTag(576251592,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Ra=Nb.contents[Ra];if(!Ra){u.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const bc=h.documentContent[Ra.contentIndex],Dc=Object.assign(new qc,{start:Ra.changeStart,end:Ra.changeEnd});if(aa.ob(bc))aa.J(bc).add(Dc);else{let Pc;aa.Z(bc,(Pc=new Mb.a,Pc.add(Dc),Pc))}ua||(ua=Ra.locationId)}}else u.ULS.sendTraceTag(588379913,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!O.count)return u.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.b$l(aa);return h.count?Object.assign(new wb,{ranking:b.ranking.value,reasons:[1],activities:O.toArray(),contentChanges:h.toArray(),locationId:ua}):(u.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),
null)}rul(b,h){for(const t of b)if(t&&t.activityId&&t.activityId===h)return t;return null}b$l(b){const h=new Mb.a;for(const A of b){b=A.key;const O=A.value;O.Sc((aa,ua)=>aa.start-ua.start);var t=O.J(0).start;if(t>Ic.QGi){t-=Ic.QGi;b=b.substring(t,b.length);for(const aa of O)aa.start-=t,aa.end-=t}h.add(Object.assign(new $a,{content:b,changes:O.toArray()}))}return h}}Ic.zId=[];Ic.QGi=10;Ic.t5m=4;Object(m.a)(Ic,"ChangeSummariesResponseTranslator",null,[]);class ed{constructor(){this.fqb=new xb.a;this.GNe=
new xb.a}set(b,h){if(h.length&&b){this.fqb.Z(b,h);for(const t of h)if(t.activities)for(const A of t.activities)A&&A.activityId?this.GNe.Z(A.activityId,b):u.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else u.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.fqb.ob(b)?this.fqb.J(b):null}l2m(b){return b&&this.GNe.ob(b)?this.GNe.J(b):null}}Object(m.a)(ed,"FeaturedActivityGroupCache",null,
[]);class Ed{constructor(b){this.J0d=(h,t,A,O,aa)=>{if(!aa)return u.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),8;h=aa.Activity;if(!h)return u.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;t=this.fqb.l2m(h.activityId);if(!t)return u.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),
8;A=Xb.zG(h);u.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",t,h.activityId,this.cdj(A));return 32};this.fqb=b;this.KKg=new Map}Ub(b){b.pa(Vc.a.J0d,yc.a.frame,this.J0d)}cdj(b){let h=0;const t=Array(b.count);for(const A of b)b=this.XYl(A),t[h]=sk.a(b),h++;return t.join(",")}XYl(b){let h=this.KKg.get(b);if(h&&h!=W.a.nil)return h;h=W.a.create();this.KKg.set(b,h);return h}}Object(m.a)(Ed,"FeaturedActivityGroupTelemetryActor",
null,[]);var Qd=c(92);class Re extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(m.a)(Re,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class of{constructor(b,h,t){this.uS=null;this.vFo=A=>{this.YXa.reset();A=this.T9l(A.customData);let O=null;for(;A.moveNext();){const aa=A.currentNode;if(aa&&(qe.ParagraphReader.Yb(aa)&&this.ra.raiseEvent("OPV",new Re(aa)),this.YXa.update(),this.YXa.zkb())){O=aa;break}}O?this.Slh(O):this.uS(!0)};this.Gb=b;this.YXa=h;this.ZJ=t;this.ra=new If.a;this.Evb=new Promise(A=>
{this.uS=A})}erk(b){this.ra.addHandler("OPV",b)}PCk(){this.Slh(null)}Slh(b){const h=new Vb.a(3,1,0,this.vFo,182);h.customData=b;this.Gb.Wb(h)}T9l(b){if(!b)return Qd.a.So(this.ZJ);b=ue.GraphIterator.$a(b);b.Ab(7);return Qd.a.at(b,this.ZJ)}}Object(m.a)(of,"DocumentTraverser",null,[]);class Fh{constructor(b){this.rc=b}shouldShowEmptyExperienceButton(){return v.AFrameworkApplication.sZd()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.rc.Rb(ab.a.ehe,
2,null)}onInviteOthersButtonClick(){this.rc.Rb(ab.a.A7,2,null)}}Object(m.a)(Fh,"EmptyCatchUpBehaviorManager",null,[510]);class Nj{constructor(b,h){this.Gyl=()=>{const t=document.getElementById("flyoutItem0");t&&(u.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),t.focus())};this.Zo=b;this.Vb=h}initialize(){const b=this.Vb.fe(vf.AFrame.l1b);b.zH=!0;b.parent=vf.AFrame.qp;b.pea(this.Gyl);this.Zo.GS(vf.AFrame.l1b)}enableF6Focus(){this.Zo.nI(vf.AFrame.l1b)}disableF6Focus(){this.Zo.nx(vf.AFrame.l1b)}}
Object(m.a)(Nj,"FlyoutFocus",null,[509]);var Ig=c(350);class Zi{constructor(b,h,t){this.OJg=this.aUg=this.$tc=this.Jkd=!1;this.cze=this.xdd=null;this.zln=(A,O,aa,ua,Ra)=>{Ra[Ng.a.Visible]=!0;Ra[Ng.a.On]=this.$tc&&this.Jkd;return 32};this.mon=(A,O,aa)=>{if(1===aa)return this.Jkd?(this.aUg||(this.aUg=!0,u.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.xdd)return u.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),
8;this.OJg=!0;this.xdd();return 32};this.ga=b;this.hSg=h;this.Vb=t}get Pif(){return this.cze?this.cze:(u.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set Pif(b){this.cze=b}initialize(){this.Ub()}registerButtonClickedEvent(b){this.xdd&&u.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.xdd=b.buttonClickedCallback}onFlyoutInitialized(){var b;this.Jkd&&u.ULS.sendTraceTag(588129367,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const h=(new Date).getTime()-this.Pif.getTime();u.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",h);this.Jkd=!0;(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1))||Ig.a.L3a("ribbon","catchUp");lb.c(ab.a.PMk,!0,void 0,void 0,void 0,h)}onFlyoutVisibilityChanged(b){this.$tc!==b.flyoutIsVisible&&
(this.$tc=b.flyoutIsVisible,Jb.App.ya&&Jb.App.ya.updateCommandUI(!0),this.$tc&&this.OJg&&this.Vb.mg(vf.AFrame.l1b),this.$tc||this.hSg&&this.hSg.sWm())}logFlightTriggers(b){b.hasFlyoutData&&v.AFrameworkApplication.ye("WoCha187;WoCha187cf")}Ub(){this.ga.pa(ab.a.htj,yc.a.frame,this.mon);this.ga.gb(ab.a.l_i,yc.a.frame,this.zln,96)}}Object(m.a)(Zi,"FlyoutRibbonButton",null,[508]);var Kh=c(162);class ik{constructor(b,h){this.UQ=null;this.IVd=this.Nvi=!1;this.GW=b;this.Qe=h;this.qib=new Kh.a;this.mVd=new Map;
this.qib.Z(1,new Z.a(new qb.a));this.qib.Z(0,new Z.a(new qb.a));this.qib.Z(2,new Z.a(new qb.a));this.qib.Z(3,new Z.a(new qb.a));this.mVd.set(3,"CatchUpIndicatorVisible");this.mVd.set(1,"CatchUpIndicatorPreviewed");this.mVd.set(2,"CatchUpIndicatorSelected");this.Nbe=0}vDi(b,h){if(this.qib.J(h).add(b)){this.AYm(h);switch(h){case 0:u.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:u.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");
break;case 2:u.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:u.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.lzh()}}Skn(b){this.hol();b=this.GW.CDb(b);for(const h of b)if(this.UQ.remove(h)){this.Nbe++;break}}hol(){if(!this.UQ){this.UQ=new Z.a(new qb.a);for(const b of this.GW.UQ)this.UQ.add(b)}}yuk(){u.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.Nbe);this.lzh()}lzh(){this.Nbe&&
(this.DOk(),this.oOk())}DOk(){!this.Nvi&&.5<=this.qib.J(0).count/this.Nbe&&(this.Nvi=!0,lb.c(ab.a.RMk),u.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}oOk(){if(!this.IVd){var b="";1<=this.qib.J(1).count&&(this.IVd=!0,b="previews");1<=this.qib.J(2).count&&(this.IVd=!0,b="selections");this.IVd&&(lb.c(ab.a.KMk),u.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}AYm(b){(b=this.mVd.get(b))&&this.Qe.logKpiUsage(b,0)}}Object(m.a)(ik,"IndicatorTelemetryActor",
null,[]);var xf=c(515);c(1063);class Ye{constructor(b,h){this.k6c=b;this.JEc=h}Ram(){return this.JEc.promise.then(b=>b.getWywaActivitiesResponse)}getActivities(b,h){return xf.b(this.k6c.requestActivities(b,h))}getRelevantActivities(b,h){return this.JEc.promise.then(t=>t.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(t.getRelevantActivitiesResponse):xf.b(this.k6c.requestRelevantActivities(b,h)))}updateActivityState(b){return xf.b(this.k6c.updateActivityState(b))}getActivityFeed(){return this.JEc.promise.then(b=>
void 0!==b.activityFeed?Promise.resolve(b.activityFeed):xf.b(this.k6c.requestActivityFeed()))}updateWaterline(){return xf.b(this.k6c.fZn())}}Object(m.a)(Ye,"ActivityRepository",null,[]);var rf=c(1065),xg=c(1031);class Lg{constructor(b,h,t,A,O,aa=!1){this.activityContentManager=b;this.rc=h;this.rjl=t;this.Qe=A;this.Kom=O;this.P$b=aa}BIf(b){const h=new Map;h.set("activityType",b.type.toString());this.Qe.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}RHf(b){this.Qe.logKpiFailure("CatchUpNavigateToActivity",
b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}j$m(b){try{const h=b.activity;this.BIf(b.activity);1==h.type&&this.Kom.o1d();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.JHo(h),this.RHf("Content does not exist"),Promise.resolve(2);const t={};let A=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:t.ActivityId=h.activityId;t.NavigationId=atob(h.navigationId);A=this.rc.Rb(ab.a.p6e,2,t);break;case 1:t.Activity=
h,t.NodeId=b.locationId,A=this.rc.Rb(Vc.a.gbg,2,t),t.NodeId&&this.rc.Rb(Vc.a.J0d,2,t)}8==A&&this.RHf("Action failed")}catch(h){return u.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.RHf("Exception was thrown"),Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.rjl.Evb.then(()=>this.j$m(b))}}Object(m.a)(Lg,"WordActivityNavigationManager",null,[507]);var Tk;(function(b){b[b.default=0]="default";b[b.D48X48=1]="D48X48";
b[b.D64X64=2]="D64X64";b[b.D96X96=3]="D96X96";b[b.D120X120=4]="D120X120";b[b.D240X240=5]="D240X240";b[b.D360X360=6]="D360X360";b[b.D432X432=7]="D432X432";b[b.D504X504=8]="D504X504";b[b.D648X648=9]="D648X648"})(Tk||(Tk={}));Object(m.b)("ProfilePhotoDimension",Tk);var Ii=c(776),$i=c(1464);class cl{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(m.a)(cl,"ActivityFeedEntry",null,[]);const dk=(b,h)=>h.YUc?so.toArray(so.select(so.asEnumerable(b),
t=>{if(!t||!t.activityFeedItemPayload)return t;const A=JSON.parse(t.activityFeedItemPayload);var O=A.actor;if(!O||O.pictureUrl)return t;const aa=O.userPrincipalName||O.email;if(!aa)return t;O=h.vAb(aa,O.provider,v.AFrameworkApplication.fm,0);if(!O)return t;A.actor.pictureUrl=O;return Object.assign(new cl,{id:t.id,type:t.type,collectionId:t.collectionId,activityState:t.activityState,activityFeedItemPayload:JSON.stringify(A),timestamp:t.timestamp})})):b,es=(b,h)=>{const t=new Map,A=new Map;for(const O of b){if(!O||
!O.activityFeedItemPayload)continue;b=JSON.parse(O.activityFeedItemPayload).actor;if(!b)continue;const aa=b.email||b.userPrincipalName;aa&&!A.has(aa)&&A.set(aa,new Ii.a(aa,null,b.name))}A.forEach(O=>{const aa=h.Q7b(O,6);t.set(O.UserId,aa)});return t};var fs=c(534);class kr{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(m.a)(kr,"ActivityRequestPayload",null,[]);class ao{constructor(){this.color=
this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(m.a)(ao,"Person",null,[]);class St extends na{constructor(){super();this.relationship=0}}Object(m.a)(St,"TaskActivity",na,[]);class ct extends na{constructor(){super();this.contentId=null}}Object(m.a)(ct,"CommentActivity",na,[]);class lu extends ct{constructor(){super()}}Object(m.a)(lu,"CommentReplyActivity",ct,[]);class cv extends ct{constructor(){super();this.IUi=null}}Object(m.a)(cv,"MentionActivity",ct,[]);class jo{constructor(b,
h,t,A){this.gqb=b;this.nLa=h;this.jyc=t;this.pN=A;this.pN.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.gqb.Ram().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.L9e("GetWYWAActivities",b);155===b.StatusCode&&(u.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.pN.isFirstDocumentOpen=!0);const h=this.$gg(b.People);return Object.assign(new kr,{activities:this.yke(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,
lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.gqb.getActivities(b,h).then(t=>{if(!t||t.StatusCode)throw this.L9e("GetActivities",t);const A=this.$gg(t.People);return Object.assign(new kr,{activities:this.yke(t.Activities,A),actors:A,hasMore:!t.RequestedRetrieved,highWaterline:t.HighWaterline,lowWaterline:t.LowWaterline})})}requestRelevantActivities(b){return this.gqb.getRelevantActivities(b,this.pN.isFirstDocumentOpen).then(h=>
{if(!h||h.StatusCode)throw this.L9e("GetRelevantActivities",h);const t=this.$gg(h.People),A=this.yke(h.NewActivities,t,2);h=this.yke(h.OutstandingActivities,t,3);for(const O of h)A.push(O);return Object.assign(new kr,{activities:A,actors:t})})}updateActivityState(b){return this.gqb.updateActivityState(b)}requestActivityFeed(){return this.gqb.getActivityFeed().then(b=>({activityFeedItems:this.ssm(b),personaColorMap:this.gHk(b)}))}yke(b,h,t=1){const A=[];if(!b)return A;for(const ua of b){var O=null;
b=[];b.push(h[ua.CreatorIndex]);switch(ua.ActivityType){case 1:O=ua;var aa=new Xb;aa.qv=new Mb.a;for(const Ra of O.ChangeIds)aa.qv.add(sk.b(Ra));aa.objectId=sk.b(O.ObjectId);O=aa;break;case 2:O=ua;aa=new ct;aa.contentId=O.ContentId;aa.navigationId=O.NavigationId;O=aa;break;case 4:O=ua;aa=new cv;b.push(h[O.MentioneeIndex]);aa.IUi=O.ParentContentId;aa.navigationId=O.NavigationId;O=aa;break;case 3:case 10:O=ua;aa=new lu;b.push(h[O.RepliedIndex]);aa.contentId=O.ContentId;aa.navigationId=O.NavigationId;
O=aa;break;case 6:case 7:case 8:case 9:O=ua,aa=new St,b.push(h[O.MentioneeIndex]),aa.navigationId=O.NavigationId,aa.relationship=O.Relationship,O=aa}O&&(O.actors=b,O.displayTimestamp=new Date(ua.DisplayTimestamp),O.activityId=sk.b(ua.ActivityId).toString(),O.type=ua.ActivityType,1!==t&&(O.relevancy=t),A.push(O))}return A}S0n(b,h,t){return this.jyc&&this.jyc.YUc?this.jyc.vAb(h,t,v.AFrameworkApplication.fm,Tk.default):b}$gg(b){if(!b)return null;const h=Array(b.length);for(let t=0;t<b.length;t++){if(!b[t])continue;
const A=new ao;A.id=b[t].Id;A.provider=b[t].Provider;A.displayName=b[t].DisplayName;A.email=b[t].Email;A.imageUrl=this.S0n(b[t].PictureUrl,b[t].Email,b[t].Provider);this.nLa&&(A.color=this.nLa.Q7b(new Ii.a(A.email,void 0,A.displayName),$i.a.catchUpFlyout));h[t]=A}return h}L9e(b,h){let t="null";h&&(t=fs.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,t))}ssm(b){return this.jyc?dk(b,this.jyc):b}gHk(b){return this.nLa?es(b,this.nLa):new Map}}Object(m.a)(jo,"WordActivityRequestManager",
null,[506]);class dv{constructor(b,h,t){this.Qnd=0;this.syc=!1;this.Z_g=null;this.updateWaterline=()=>{if(Jb.App.lostSession)u.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.syc||3>=this.Qnd){this.syc?this.syc=!1:this.Qnd++;const A=Math.max(this.Na.pc("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.Z_g),0);u.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",A);nd.Task.delay(A).continueWith(()=>
{this.gqb.updateWaterline().then(()=>{this.lde();return null}).catch(()=>{this.lde();this.syc=!0;this.Qnd=0})})}else this.lde()};this.Na=b;this.gqb=t;h.vyd(()=>{this.syc=!0;this.Z_g=new Date;this.Qnd=0})}start(){this.lde()}lde(){window.setTimeout(this.updateWaterline,6E4)}}Object(m.a)(dv,"WordEditorActivityScheduler",null,[]);class lr{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}i$n(b){this.resolve(b)}}Object(m.a)(lr,"CatchUpNetworkRequestWorkerCache",null,[]);class mu{constructor(b,
h,t){this.b$k=b;this.K=h;this.Qe=t}MTf(b){b&&b.authors&&this.tYm(b.authors)}tYm(b){for(const h of b)h&&h.displayName===this.b$k&&(this.Qe.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),u.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",h.id===this.K.kb("PresenceUserId"),h.email===this.K.kb("UserPrincipalName")))}}Object(m.a)(mu,
"WywaAuthorComparator",null,[]);class Ju{constructor(b){this.p0=b}o1d(){this.p0&&this.p0.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(m.a)(Ju,"IndicatorSurveyActor",null,[]);var Gj=c(1035),Fv=c(1027);class fw{constructor(){this.SMk={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get MMk(){return v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get uzf(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",
!1)}get isi(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get Ari(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",!1)}get KVd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get cWd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCatchUpActivitiesReadyTelemetryFixV2Enabled",
!1)}get hMm(){return v.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}get P$b(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}yc(b){El("Configure");this.container=b;b.ha("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new lr).singleInstance()}init(){El("Init");this.MMk&&(P.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,
4,v.AFrameworkApplication.rootQuerySignature,Jb.App.webServiceBase+"OneNote.ashx",2,this.KVd)}),El("HotStore"),Jb.App.Bia.oFb.execute(()=>{El("ChromeReady");rk.a.get_instance().Vk(7,()=>{El("ScriptDownload");(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").HA.loadScript("catchUpActivity")).catch(b=>{u.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",
b)}).then(()=>this.jfn()).catch(b=>{u.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}jfn(){El("CreateObjectsAndInitializeState");this.vXm();this.t1k();return this.Nqm()}vXm(){u.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");u.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");u.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.uzf&&u.ULS.sendTraceTag(588130079,
3012,50,"ChangeSummaries is enabled");this.isi&&u.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.Ari&&u.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");u.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.hMm);this.KVd&&u.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}Nqm(){this.srm();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").Pif=new Date;El("InitializeCatchUpApp");return this.k1b.initialize(Object.assign(new io,
{featuredActivityGroupsEnabled:this.uzf,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.isi,customDynamicEntryPointEnabled:this.Ari,activityFeedDataEnabled:this.KVd})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}t1k(){this.container.ha("WordEditor.CatchUpActivity.ChangeIdCache",()=>new Um(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),vm.App.Hn.jb.xc.Zc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",
()=>new Gj.a(wa.Health.instance,new Fv.a,this.SMk)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IActivityStateManager",()=>new Yq).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityContentManager",()=>new wc(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),v.AFrameworkApplication.xa,oh.UISurfaces.fM(),this.P$b)).as("Common.App.CatchUpActivity.IActivityContentManager").singleInstance();this.container.ha("WordEditor.CatchUpActivity.Network.ActivityRepository",
()=>new Ye(new rf.a(eg.a.ctj(this.container.Sa("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>v.AFrameworkApplication.rootQuerySignature,Jb.App.webServiceBase+"OneNote.ashx",2,eg.a.ctj(this.container.Sa("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityRequestManager",()=>new jo(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),
this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.P$b)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new oi(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
vm.App.Hn.jb.xc,new xg.a(vm.App.Hn.jb.xc),he.a.instance,yd.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new Io.a(50,ff.a.Ue):new Pq;return new of(v.AFrameworkApplication.oc,b,vm.App.Hn.jb.xc.Zc)}).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorSurveyActor",
()=>new Ju(this.container.Sa("Common.ISystemInitiatedFeedback"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new Lg(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),v.AFrameworkApplication.xa,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),this.P$b)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new Zi(v.AFrameworkApplication.xa,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),yd.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutFocus",()=>new Nj(ej.a.instance,yd.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",
()=>new ed).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new Ko(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),vm.App.Hn.jb.xc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new Ed(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IChangeSummariesDataProvider",
()=>new Bg(new Na(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new Ff(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),v.AFrameworkApplication.oc),new Ic(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),
this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),this.P$b)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new Fh(v.AFrameworkApplication.xa)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").singleInstance();this.k1b=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new xn,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),
activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:v.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:v.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.KVd?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),
flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:v.AFrameworkApplication.uiCulture,ulsLogger:new Am.a}));this.k1b.setWebpackPublicPath(v.AFrameworkApplication.I4);this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new cg(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WordEditorActivityScheduler",
()=>new dv(v.AFrameworkApplication.K,wo.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new ik(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new Aj(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.k1b.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),vm.App.Hn.jb.xc,this.container.Sa("Common.IZoomManager"),v.AFrameworkApplication.oc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!Jb.App.instance&&Jb.App.instance.Nna,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Jb.App.instance&&Jb.App.instance.wC)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new Rr(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,vm.App.Hn.jb.xc.Zc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),v.AFrameworkApplication.xa,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.cWd)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityAnnouncementManager",
()=>new Pr(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),v.AFrameworkApplication.xa,yd.FocusManager.instance())).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new mu(v.AFrameworkApplication.userName,v.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance()}srm(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),
h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");b.P4a(h);const t=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const A=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const O=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),
aa=he.a.instance,ua=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");aa.gx(()=>{O.oYd?O.oYd=!1:(O.y5a&&t.XQi(null,null,!1),O.Lhb&&t.dQi(null,null),A.a5e())});aa.gx(Object(z.a)(h,h.Y3,"onSelectionChanged"));this.k1b.getWywaEvent().addListener(Object(z.a)(b,b.MTf,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.k1b.getWywaEvent().addListener(Object(z.a)(b,b.MTf,"onWywaActivityReady"));const Ra=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");
ua.erk((ub,Nb)=>{Nb&&Ra.Skn(Nb.node)});ua.Evb.then(()=>{Ra.yuk()});this.k1b.getWywaEvent().addListener(()=>{ua.PCk()});A.qpk((ub,Nb)=>{Nb&&t.dQi(Nb.fCb,Nb.ami)});A.rpk((ub,Nb)=>{Nb&&t.XQi(Nb.fCb,Nb.ami,Nb.Wlo)});A.Ub(v.AFrameworkApplication.xa);this.uzf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").Ub(v.AFrameworkApplication.xa);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();
this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.fqo()}fqo(){Rh.c()&&(u.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(m.a)(fw,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var Zq=c(160),$q=c(441),nu=c(1493),yt=c(491),Jk=c(1598),Tt=c(1494),ys=c(1661),ev=c(1662),ly=c(654),bo=c(1663),
zt=c(858),dn=c(149),Qq=c(1502);class Cm{constructor(){this.ot=this.annotation=null}}Object(m.a)(Cm,"AnnotationChangedData",null,[]);class fv{constructor(b,h,t,A,O,aa,ua,Ra=!1,ub){this.annotationType=b;this.wW=h;this.vq=t;this.pie=A;this.dad=O;this.STo=aa;this.jb=ua;this.pjj=Ra;this.K=ub;this.jz=null;this.Qvi=!1;this.kd=new If.a;this.wYc=0}zF(b){this.kd.addHandler("AnnotationChangedEvent",b)}GH(b){this.kd.removeHandler("AnnotationChangedEvent",b)}register(){return this.dad().then(()=>{0===this.wYc&&
(this.pjj&&(this.jz=this.vq.eg("WebServiceCall",this.annotationType)),this.wW.mb(this,this.annotationType));this.wYc++})}unregister(){return this.dad().then(()=>(new Promise(b=>setTimeout(b,this.K.pc(dn.a.eel,3E3)))).then(()=>{0<this.wYc&&(this.wYc--,0===this.wYc&&this.wW.sc(this,this.annotationType))}))}R5b(){return this.dad().then(()=>this.wW.getAnnotationsByType(this.annotationType))}d0h(b){b=$q.a.eM(b);return(b=this.wW.c0h(b))&&0<b.count?b.toArray().filter(h=>af.a.matchesTypesFor(h.content,[this.annotationType])):
[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.STo(this.jb.Wc.ud,b.parentPath):null:(u.ULS.shipAssertTag(575930380,3016,!1),null)}Bua(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new zt.a,{parentPath:["Signal",af.a.getTypeNameFor(b)],items:[Object.assign(new Wd.a,{body:b})]});this.pie.submitOperation(b)}Yll(b,h){b=Object.assign(new gd.a,{parentPath:["Signal",h],items:b});this.pie.submitOperation(b)}xD(b,h){b?h?(this.pjj&&!this.Qvi&&(this.jz.stop(),this.Qvi=!0),this.kd.Q7&&
(b=new Qq.a(Object.assign(new Cm,{annotation:b,ot:h})),this.kd.raiseEvent("AnnotationChangedEvent",b))):u.ULS.shipAssertTag(575930382,3016,!1):u.ULS.shipAssertTag(575930381,3016,!1)}}Object(m.a)(fv,"AnnotationManager",null,[523,126]);class gv{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){this.CI=b;this.Oce=h;this.uCb=t;this.Q_a=A;this.q7=O;this.rsj=aa;this.E0=ua;this.SOb=Ra;this.$3b=ub;this.UKb=Nb;this.Ozo=Yb}}Object(m.a)(gv,"AnnotationManagerHolder",null,[522]);class up{constructor(b,h){this.FBa=b;this.dad=
h}submitOperation(b){return this.dad().then(()=>{this.FBa.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ce.a,{operation:b}))})}}Object(m.a)(up,"SubmitOperationHelper",null,[]);var In=c(875),Q=c(1664),za=c(1061),hb=c(134),Tb=c(139),zc=c(91),kd=c(1091);class ce{constructor(b,h,t){this.q7=b;this.xn=h;this.STi=t;this.eDa={};this.qPh=!1;this.Vkb=(A,O)=>{var aa;O.data.ot!==gd.a.getTypeName()&&O.data.ot!==kd.n.getTypeName()||!O.data.annotation||O.data.annotation.annotationType!==Q.a.getTypeName()||
(A=O.data.annotation.content)&&null!==(aa=A.documentTypeConfidences)&&void 0!==aa&&aa.length&&(this.pPh=A.documentTypeConfidences[0].documentTypeLabel,u.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.pPh))};this.q7.zF(this.Vkb);this.q7.register();this.eDa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}rOd(){this.qPh||(this.q7.Bua(new za.a),
u.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.qPh=!0);this.til();this.eDa.docType=this.pPh;this.eDa.characterCount=this.characterCount;this.eDa.paragraphCount=this.X_;this.eDa.imageCount=this.BQ;this.eDa.tableCount=this.bqa;this.eDa.listElementsCount=this.BBi;this.eDa.blobsCount=this.Ush;this.eDa.pageCount=this.STi.GOc();this.eDa.currentPage=this.STi.$9h();return this.eDa}til(){this.X_=this.Ush=this.BBi=this.bqa=this.BQ=this.characterCount=0;var b=this.xn.KDa(vm.App.Hn.jb.xc.Zc,
7,7).currentNode,h=ue.GraphIterator.$a(b);for(b=Qd.a.at(h,b);b.moveNext();)if(h=b.currentNode)if(Be.ImageReader.Wu(h))this.BQ++;else if(ni.TableReader.QX(h))this.bqa++;else if(hb.ListItemReader.Kh(h))this.BBi++;else if(qe.ParagraphReader.Yb(h)){var t=zc.e(h);for(let A=0;A<t.length;A++)5===t[A].zh?this.BQ++:this.Ush++;t=Tb.AParagraphNode.CU(h.characterData);t=t.trim();this.characterCount+=t.length;0<t.length&&!qe.ParagraphReader.g8(h)&&!qe.ParagraphReader.MX(h)&&this.X_++}}}Object(m.a)(ce,"LoggingDocumentInfo",
null,[515]);class df{constructor(){this.ra=new If.a}zrk(b){this.ra.addHandler("OnTaskPaneReviewStateChanged",b)}xVn(b){this.ra.removeHandler("OnTaskPaneReviewStateChanged",b)}yqk(b){this.ra.addHandler("BlueDotClickedEvent",b)}dVn(b){this.ra.removeHandler("BlueDotClickedEvent",b)}Lqk(b){this.ra.addHandler("OnFormattingMarkedForReview",b)}Nqk(b){this.ra.addHandler("OnFormattingReviewCompleted",b)}Kqk(b){this.ra.addHandler("OnFormattingAccept",b)}Mqk(b){this.ra.addHandler("OnFormattingReject",b)}qrk(b){this.ra.addHandler("OnReviewInvalidated",
b)}bnh(b){this.ra.addHandler("OnTraigeAction",b)}qYe(b){this.ra.addHandler("OnReviewVisibilityChanged",b)}pVn(b){this.ra.removeHandler("OnReviewVisibilityChanged",b)}vqk(b){this.ra.addHandler("OnBeforeReviewNavigation",b)}mrk(b){this.ra.addHandler("OnRegisterEnhancement",b)}Brk(b){this.ra.addHandler("onTooltipVisibilityChanged",b)}yVn(b){this.ra.removeHandler("onTooltipVisibilityChanged",b)}M1c(b){b?this.ra.raiseEvent("OnTaskPaneReviewStateChanged",new Qq.a(b)):u.ULS.shipAssertTag(575930374,3016,
!1)}eHn(b){b?this.ra.raiseEvent("BlueDotClickedEvent",new Qq.a(b)):u.ULS.shipAssertTag(575930375,3016,!1)}hHn(b){b?this.ra.raiseEvent("OnFormattingMarkedForReview",new Qq.a(b)):u.ULS.shipAssertTag(575930376,3016,!1)}P_i(b){b?this.ra.raiseEvent("OnFormattingReviewCompleted",new Qq.a(b)):u.ULS.shipAssertTag(573850377,3016,!1)}gHn(b){b?this.ra.raiseEvent("OnFormattingAccept",new Qq.a(b)):u.ULS.shipAssertTag(575930377,3016,!1)}iHn(b){b?this.ra.raiseEvent("OnFormattingReject",new Qq.a(b)):u.ULS.shipAssertTag(575930378,
3016,!1)}jHn(b){b?this.ra.raiseEvent("OnReviewInvalidated",new Qq.a(b)):u.ULS.shipAssertTag(575930379,3016,!1)}H_f(b){b?this.ra.raiseEvent("OnTraigeAction",new Qq.a(b)):u.ULS.shipAssertTag(573850378,3016,!1)}Q_i(b){b?this.ra.raiseEvent("OnReviewVisibilityChanged",new Qq.a(b)):u.ULS.shipAssertTag(573850379,3016,!1)}dHn(b){b?this.ra.raiseEvent("OnBeforeReviewNavigation",new Qq.a(b)):u.ULS.shipAssertTag(573687395,3016,!1)}Ifc(b){b?this.ra.raiseEvent("OnRegisterEnhancement",new Qq.a(b)):u.ULS.shipAssertTag(555055117,
3016,!1)}i0i(b){b?this.ra.raiseEvent("onTooltipVisibilityChanged",new Qq.a(b)):u.ULS.shipAssertTag(540587343,3016,!1)}}Object(m.a)(df,"ReviewEvents",null,[500]);class bf{constructor(b){this.Gt=b;if(!b)throw Zq.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}yc(b){this.W=b;b.ha("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new up(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),$q.a.Bl)).singleInstance();b.ha("WordEditor.Designer.IDesignerControl",
()=>new In.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),v.AFrameworkApplication.uiCulture)).singleInstance();b.ha("WordEditor.Designer.Common.Review.IReviewEvents",()=>new df).singleInstance();b.ha("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new gv(this.ECa(Tt.DocumentRoleDetectionAnnotation.getTypeName()),this.ECa(Tt.RoleDetectionAnnotation.getTypeName()),this.ECa(nu.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.ECa(nu.FormattingSuggestionsAnnotation.getTypeName()),
this.ECa(yt.DocumentTypeClassifierAnnotation.getTypeName()),this.ECa(ev.ThemeExtractorAnnotation.getTypeName()),this.ECa(ly.ThemeGeneratorAnnotation.getTypeName()),this.ECa(ys.TextToImageAnnotation.getTypeName()),this.ECa(Jk.DocumentPullQuoteAnnotation.getTypeName()),this.ECa(Jk.PullQuoteAnnotation.getTypeName()),this.ECa(bo.TableTypeAnnotation.getTypeName()))).singleInstance();b.ha("WordEditor.Designer.DocumentInfo",()=>new ce(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").q7,
b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).singleInstance()}dispose(){}ECa(b,h=!1){return new fv(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),$q.a.Bl,$q.a.Qgb,this.Gt,h,this.W.resolve("Common.IAppSettingsManager"))}}Object(m.a)(bf,"PackageManager",null,[1,2]);var Vf=c(1023),rh=c(1487),ij=c(1667);class vi extends Sys.EventArgs{constructor(b,
h){super();this.node=b;this.gOf=h}}Object(m.a)(vi,"RoleChangeArgs",Sys.EventArgs,[]);class ti{constructor(b){this.Gh=!1;this.wP=b;this.wP.fkd++}dispose(){this.Gh||(this.Gh=!0,this.wP.fkd--)}}Object(m.a)(ti,"InvalidationSuspension",null,[9]);class nk{constructor(){this.g8c=null;this.role=this.K2d=0;this.zyb=this.vYd=this.xga=this.Jac=!1;this.T1d=this.YWc=this.$Na=null;this.removed=this.placeholder=!1;this.qzd=this.z$e=null;this.pzd=0}get f2a(){return!this.role||!this.$Na||!this.$Na.length}Tvm(){this.zyb=
this.vYd=!0}xMm(){return!!this.role||!!this.$Na||!!this.g8c}}Object(m.a)(nk,"RoleState",null,[529]);class Wj{constructor(b,h,t,A,O){this.xh=!1;this.uVd=null;this.AJf=new Tc.a;this.RUg=0;this.g2n=(aa,ua)=>{ua.data.ot===gd.a.getTypeName()&&(ua=ua.data.annotation,(aa=ua.content)?(ua=this.uXb.getParent(ua))&&this.E5c(ua,rh.e(aa.roleType),!1,void 0,null!=aa.listID?aa.listID:0,aa.listItemlevel,aa.listItemPrefix):u.ULS.shipAssertTag(575813856,3016,!1))};this.djl=(aa,ua)=>{if(ua.data.ot===gd.a.getTypeName())if(aa=
ua.data.annotation.content)for(u.ULS.sendTraceTag(556074199,3016,50,aa.confidence.toString()),this.AJf=new Tc.a,ua=0;aa.listInfos&&ua<aa.listInfos.length;ua++){const Ra=aa.listInfos[ua];this.AJf.Z(Ra.listID,Ra)}else u.ULS.shipAssertTag(556323522,3016,!1)};this.Kui=(aa,ua)=>{aa=aa.$O;if(!aa||aa.ia(Lc.a.ZA,!1))return!1;aa=aa.getValue(Lc.a.ma);if(!aa)return!1;aa=rh.f(aa);return 1!=aa&&aa!=ua.role};this.vAl=(aa,ua)=>{aa=ua.data.annotation;const Ra=this.Vhd.getParent(aa);if(Ra)if(ua.data.ot===gd.a.getTypeName()){const ub=
ua.data.annotation.content;ub?this.uca(Ra,Nb=>{this.uVd&&Nb.z$e&&this.uVd>Nb.z$e&&!Nb.zyb||Nb.role!==Nb.K2d||this.Kui(Ra,Nb)?(u.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",this.uVd,Nb.zyb,Nb.role===Nb.K2d),Nb.g8c=ub.suggestions):(Nb.$Na=ub.suggestions,Nb.zyb=!1)}):u.ULS.shipAssertTag(575813859,3016,!1)}else ua.data.ot===Vf.a.getTypeName()&&this.uca(Ra,ub=>{ub.$Na=null;ub.g8c=null});else u.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${aa.id} parentPath: ${aa.parentPath}`)};
this.Ohn=(aa,ua)=>{(aa=ua.data.paragraphNode)?this.uca(aa,Ra=>{ua.data.qCj?(Ra.qzd=Ra.$Na,Ra.pzd=Ra.role):(Ra.qzd=null,Ra.pzd=0);Ra.xga=!0}):u.ULS.shipAssertTag(575930368,3016,!1)};this.Qhn=(aa,ua)=>{(aa=ua.data.paragraphNode)?this.uca(aa,Ra=>{Ra.xga=!1;Ra.qzd=null;Ra.pzd=0;5!==ua.data.state&&(Ra.$Na=null)}):u.ULS.shipAssertTag(573850380,3016,!1)};this.Mhn=(aa,ua)=>{(aa=ua.data.paragraphNode)?this.uca(aa,Ra=>{Ra.xga=!0}):u.ULS.shipAssertTag(575930369,3016,!1)};this.Phn=(aa,ua)=>{(aa=ua.data.paragraphNode)?
this.E5c(aa,1,!0,!0):u.ULS.shipAssertTag(575930370,3016,!1)};this.vTf=(aa,ua)=>{(aa=ua.data.paragraphNode)?this.E5c(aa,ua.data.gOf,!0,!0):u.ULS.shipAssertTag(575484484,3016,!1)};this.Jcm=(aa,ua)=>{if(ua.node){var Ra=ua.node;aa=this.bA(Ra);27==aa.role&&u.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");aa.xga&&27!==aa.role&&28!==aa.role&&this.kij(this.sMb-1);aa.f2a||27===aa.role||28===aa.role||this.dij(this.inconsistenciesCount-1);this.uca(Ra,ub=>{ub.removed=!0});setTimeout(()=>this.removeNode(Ra),
1E4)}else u.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=aa=>{let ua;({value:ua}=this.eu.Ec(aa.id));(null===ua||void 0===ua?0:ua.removed)&&this.eu.remove(aa.id)};this.Icm=(aa,ua)=>{ua.node?(aa=ua.node,this.GTc(aa)?this.uca(aa,Ra=>{Ra.removed=!1}):this.uca(aa,Ra=>{Ra.zyb=!1})):u.ULS.shipAssertTag(540672206,3016,!1)};this.Kcm=(aa,ua)=>{ua.node?this.U$f(ua.property,ua.node)&&(aa=ua.node,this.fkd||aa.j9d?this.uca(aa,Ra=>{Ra.zyb=!1}):this.uca(aa,Ra=>{Ra.Tvm();Ra.g8c&&(Ra.$Na=Ra.g8c,Ra.role=Ra.K2d)}).xga&&
this.eXa.jHn(new ij.a(ua.node))):u.ULS.shipAssertTag(575930372,3016,!1)};this.Qln=(aa,ua)=>{switch(ua.data.role){case 27:const Ra=ua.data;this.uca(ua.data.paragraphNode,Nb=>{Nb.role=27;Nb.Jac=!0;Nb.placeholder=Ra.placeholder});break;case 28:const ub=ua.data;this.uca(ua.data.paragraphNode,Nb=>{Nb.role=28;Nb.Jac=!0;Nb.placeholder=ub.placeholder;Nb.mna=ub.mna});break;case 2:this.uca(ua.data.paragraphNode,Nb=>{Nb.role=2})}};this.Vhd=b;this.uXb=h;this.Rwe=t;this.Oo=A;this.eXa=O;this.eu=new Tc.a;this.ra=
new If.a;this.fkd=this.Urd=this.Ljd=0}get owm(){return this.fkd}Qqk(b){this.ra.addHandler(Wj.vOi,b)}trk(b){this.ra.addHandler(Wj.GQi,b)}Vmh(b){this.ra.addHandler(Wj.SSf,b)}sVn(b){this.ra.removeHandler(Wj.SSf,b)}get inconsistenciesCount(){return this.Ljd}dij(b){this.Ljd!==b&&(this.Ljd=b,this.ra.raiseEvent(Wj.vOi,new Qq.a(this.Ljd)))}get sMb(){return this.Urd}kij(b){this.Urd!==b&&(this.Urd=b,this.ra.raiseEvent(Wj.GQi,new Qq.a(this.Urd)))}get Cvf(){return this.RUg}GTc(b){return this.eu.ob(b.id)}KVl(b){var h,
t;return null===(t=null===(h=this.AJf)||void 0===h?void 0:h.Ec(b))||void 0===t?void 0:t.value}s$h(b,h){var t,A,O;const aa=new Map;for(const ua of h)if(h=ua){const Ra=null!==(O=null===(A=null===(t=this.eu.Ec(h.id))||void 0===t?void 0:t.value)||void 0===A?void 0:A.role)&&void 0!==O?O:1;b.has(Ra)&&(aa.has(Ra)?aa.get(Ra).add(h):aa.set(Ra,new Mb.a([h])))}return aa}bA(b){if(!b)return u.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.eu.Ec(b.id)).returnValue?h:Object.assign(new nk,
{role:1,Jac:!1})}TYn(){this.uVd=new Date;return new ti(this)}register(){this.Vhd.register();this.uXb.register();this.Rwe.register()}unregister(){this.Vhd.unregister();this.uXb.unregister();this.Rwe.unregister()}initialize(){if(!this.xh){const b=this.Oo.af(12);b.Lv(this.Jcm);b.ku(this.Icm);b.Ro(this.Kcm);this.Vhd.zF(this.vAl);this.uXb.zF(this.g2n);this.Rwe.zF(this.djl);this.eXa.Mqk(this.Phn);this.eXa.Kqk(this.Mhn);this.eXa.Lqk(this.Ohn);this.eXa.Nqk(this.Qhn);this.eXa.bnh(this.vTf);this.eXa.mrk(this.Qln);
this.xh=!0}}Pd(){}E5c(b,h,t,A=!1,O=0,aa=0,ua){let Ra=0,ub=!1;this.uca(b,Nb=>{const Yb=Nb.vYd||!Nb.role||1==Nb.role;t||(Nb.K2d=h);if(A||Yb)ub=Nb.role!==h,Ra=Nb.role,Nb.role=h,Nb.Jac=t,Nb.vYd=!1,Nb.YWc=O,Nb.T1d=aa,Nb.listItemPrefix=ua,Nb.z$e=new Date});if(ub){const Nb=h-4;Nb>this.Cvf&&8>Nb&&(this.RUg=Nb);1===h&&this.uca(b,Yb=>{Yb.$Na=null});this.ra.raiseEvent(Wj.SSf,new Qq.a(new vi(b,h,Ra)))}}uca(b,h){let t;if(({value:t}=this.eu.Ec(b.id)).returnValue){b=t.f2a;const A=t.xga;h(t);if(27!==t.role&&28!==
t.role){if(t.removed)return t;b!==t.f2a&&this.dij(this.inconsistenciesCount+(b?1:-1));A!==t.xga&&this.kij(this.sMb+(A?-1:1))}}else h(t=new nk),t.xMm()&&this.eu.add(b.id,t);return t}U$f(b,h){({value:h}=this.eu.Ec(h.id));return 28===(null===h||void 0===h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===Af.a.yo:!(null===h||void 0===h?0:h.placeholder)&&(b===Af.a.yo||b===Af.a.En||Array.contains(Tb.AParagraphNode.dga(),b))}}Wj.vOi="OnInconsistenciesChanged";Wj.GQi="OnRoleReviewCount";Wj.SSf=
"OnRoleChanged";Object(m.a)(Wj,"RoleLifecycleManager",null,[503,504,505]);class Dm{constructor(b,h,t,A,O){this.eXa=b;this.uXb=h;this.Ze=t;this.Oo=A;this.wP=O;this.xh=!1;this.vTf=(aa,ua)=>{(aa=ua.data.paragraphNode)?this.Nyj(aa,()=>!0,Ra=>Ra.userSetRole=rh.d(ua.data.gOf)):u.ULS.shipAssertTag(557057378,3016,!1)};this.Okn=(aa,ua)=>{0<this.wP.owm||this.U$f(ua.property)&&this.Nyj(ua.node,Ra=>!(Ra&&Ra.isInvalidated),Ra=>Ra.isInvalidated=!0)}}initialize(){this.xh||(this.eXa.bnh(this.vTf),this.Oo.af(12).Ro(this.Okn),
this.xh=!0)}Pd(){}Nyj(b,h,t){if(b=(b=this.uXb.d0h(b))&&1===b.length&&b[0]){var A=b.content;A=A&&A.M_&&A.M_.customMetadata;h(A)&&(h=new Tt.RoleDetectionCustomMetadata,h.isInvalidated=A&&A.isInvalidated,h.userSetRole=A&&A.userSetRole,t(h),this.Ze.BLo(b,h))}}U$f(b){return b===Af.a.yo||b===Af.a.En||Array.contains(Tb.AParagraphNode.dga(),b)}}Object(m.a)(Dm,"RoleDetectionMetadataUpdater",null,[502]);class ek{constructor(b,h){this.pie=b;this.lBb=h;this.XYc=(t,A)=>{t=A.data;if(t.ot==kd.a.getTypeName()||t.ot==
kd.n.getTypeName())if(t=t.annotation&&t.annotation.content)this.runId=t.runId};this.revisionId=0}initialize(){this.lBb.zF(this.XYc)}Pd(){this.lBb.GH(this.XYc)}ten(){if(void 0===this.runId)Promise.resolve();else{var b=new Tt.RoleDetectionSettings({acceptedRunId:this.runId});b=new kd.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.pie.submitOperation(b)}}}Object(m.a)(ek,"RoleDetectionSettingsUpdater",null,[]);class co{constructor(b,
h,t){this.evm=b;this.wW=h;this.ie=t;this.joi=this.initialized=!1;this.uMi=()=>{this.Rjj()&&(this.Mmi(),this.wW.WUn(this.uMi))}}initialize(){this.initialized||(this.zxf(),this.initialized=!0)}Pd(){}zxf(){this.Rjj()?this.Mmi():this.wW.jqk(this.uMi)}Rjj(){return!this.joi&&(this.ie.Nri()||this.wW.B9b(Tt.DocumentRoleDetectionAnnotation.getTypeName())||this.wW.B9b(Tt.RoleDetectionAnnotation.getTypeName()))}Mmi(){for(const b of this.evm)b.initialize();this.joi=!0}}Object(m.a)(co,"RLMInitializer",null,[]);
class Sr{constructor(b,h,t){this.j5=b;this.Gt=h;this.Tcd=t;this.W=null;this.qia=()=>{this.IRc();this.Gt.Amb(this.qia)};if(!b)throw Zq.a.argument("AppLifecycleManager is null");if(!h)throw Zq.a.argument("Workspace is null");if(!t)throw Zq.a.argument("ApplicationInstance is null");}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>this.$m())}yc(b){this.W=b;b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",
()=>new ek(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").CI)).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new Dm(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Oce,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();
b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new Wj(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Q_a,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").Oce,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").CI,b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).singleInstance();
b.ha("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new co([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance()}dispose(){}$m(){this.Tcd.ZI?this.j5.Vk(16,()=>this.YQc()):this.YQc()}YQc(){this.Gt.Sva?this.IRc():this.Gt.sea(this.qia)}IRc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();
this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(m.a)(Sr,"PackageManager",null,[1,2]);class xo{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,h){const t=new xo;t.ContractVersion=b;t.FileName=h;t.Paragraphs=[];return t}}Object(m.a)(xo,"DocumentSwayPreviewContent",null,[]);class Zl{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static $Zk(b,h,t,A){const O=
new Zl;O.RawText=b;O.ParagraphFormatting=h;O.TextRuns=t;O.IsRTL=A;O.ParagraphIndex=0;return O}}Object(m.a)(Zl,"ParagraphContent",null,[]);var Vm=c(102),xa=c(1196);class Ua{constructor(){this.Name=null;this.Size=0}static construct(b,h){const t=new Ua;t.Name=b;t.Size=h;return t}}Object(m.a)(Ua,"FontData",null,[]);class Ja{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,t,A,O,aa){const ua=new Ja;ua.IsBold=b;ua.IsUnderline=
h;ua.IsUppercase=t;ua.Font=A;ua.Alignment=O;ua.LeftIndent=aa;return ua}}Object(m.a)(Ja,"TextFormatting",null,[]);class va{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const t=new va;t.RawText=b;t.RunFormatting=h;return t}}Object(m.a)(va,"TextRunContent",null,[]);var Wa=c(111),mb=c(42);class Lb{constructor(b,h){this.mSb=null;this.K3j=b;this.dN=h||""}get fsn(){return this.K3j.value}Brl(){var b=Date.now();const h=xo.construct(2,this.dN);h.Paragraphs=this.oEl();b=Date.now()-
b;const t={};t.ExtractionDurationInMs=b.toString();u.ULS.sendTraceTag(25268374,382,50,"{0}",t);return h}oEl(){const b=new Mb.a;var h=0;let t=0,A=!1;var O=new ue.GraphIterator;O.set(this.fsn);O=Qd.a.So(O.currentNode);const aa=new Tc.a(0);for(;O.moveNext()&&2100>t&&25>h;){var ua=O.currentNode;if(qe.ParagraphReader.Yb(ua)&&!qe.ParagraphReader.g8(ua)){!A&&qe.ParagraphReader.MX(ua)&&(A=!0);let Ra=Tb.AParagraphNode.CU(ua.characterData);Ra=Ra.trim();if(0<Ra.length){const ub=this.UDa(ua);ub.ParagraphIndex=
h;h++;t+=Ra.length;b.add(ub);this.SOo(aa,qe.ParagraphReader.language(ua))}}}this.mSb=this.gLl(aa);h={};h.documentHasList=A;u.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}gLl(b){let h=-1,t=1033;for(const A of b.keys.toArray())A&&b.J(A)>h&&(h=b.J(A),t=A);return Sf.a.lg(t)}SOo(b,h){b.ob(h)?b.Z(h,b.J(h)+1):b.Z(h,1)}UDa(b){const h=Tb.AParagraphNode.CU(b.characterData),t=this.o_l(b),A=this.L8l(b);b=this.lHm(b);return Zl.$Zk(h,t,A,b)}o_l(b){const h=qe.ParagraphReader.Mn(b,Af.a.bold,!1),t=
qe.ParagraphReader.Mn(b,Af.a.underline,!1);var A=qe.ParagraphReader.Mn(b,Af.a.fontSize,Vm.a.XL);const O=qe.ParagraphReader.Mn(b,Af.a.font,Vm.a.OF);var aa=qe.ParagraphReader.Uv(b);aa=this.Nkf(aa);const ua=!!qe.ParagraphReader.Mn(b,fh.a.capitalization,0);b=(new xa.a).zT(b).value/20;A=Ua.construct(O,A);return Ja.construct(h,t,ua,A,aa,b)}L8l(b){const h=new Mb.a;for(let O=0;O<b.qa.length-1;O++){var t=b.qa.J(O),A=b.qa.J(O+1);t.formatting&&(A=Tb.AParagraphNode.CU(b.characterData.substr(t.cp,A.cp-t.cp)),
t=this.M8l(t.formatting),t=va.construct(A,t),h.add(t))}return h.toArray()}M8l(b){const h=Wa.FormattingReader.tOc(b,Af.a.bold,!1),t=Wa.FormattingReader.tOc(b,Af.a.underline,!1);var A=Wa.FormattingReader.tOc(b,Af.a.fontSize,Vm.a.XL);const O=Wa.FormattingReader.tOc(b,Af.a.font,Vm.a.OF);A=Ua.construct(O,A);b=!!Wa.FormattingReader.tOc(b,fh.a.capitalization,0);return Ja.construct(h,t,b,A,5,0)}Nkf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}lHm(b){const h=
new ue.GraphIterator;h.set(b);h.Ab(11);return(b=h.fd(11))?mb.OutlineElementReader.Mm(b):!1}}Object(m.a)(Lb,"DocumentContentExtractor",null,[477]);class ec{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}yc(b){b.ha("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new Lb(new Pg.a(()=>vm.App.Hn.jb.xc.Zc),v.AFrameworkApplication.Mt.Oy)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").singleInstance()}static main(){P.a.instance.Gc(new ec)}}Object(m.a)(ec,
"DocumentContentExtractorPackage",null,[1,2]);class Gc{}Gc.Wg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(m.a)(Gc,"EmbedDialogHtml",null,[]);class Mc{constructor(b,h,t,A){this.gec=b;this.q1a=h;this.f7d=t;this.value=A}}Object(m.a)(Mc,"OptionInfo",null,[]);class hd{constructor(b,h,t){this.x6f=b;this.J8b=h;this.q1a=t}}Object(m.a)(hd,"SectionInfo",null,[]);var wd=c(238);
class cd extends Pf.a{constructor(b,h=!1){super(!1,!1,h);this.Ggd=476;this.qTb=288;this.iwe=798;this.I9j=476;this.H9j=288;this.I_c={};this.Xmb=[];this.zV=this.EWa=this.Wub=this.Erb=this.Wod=this.RWb=null;this.hrc=v.AFrameworkApplication.eQc;this.xvb=b;this.nKe=Object(z.a)(this,this.yqn,"optionClickHandler");this.exc=Object(z.a)(this,this.zqn,"optionKeyHandler");this.kre=Object(z.a)(this,this.pAk,"arrowClickHandler");this.qRb=Object(z.a)(this,this.qAk,"arrowKeyHandler");this.Rud=Object(z.a)(this,this.aBo,
"textAreaOnFocusHandler");this.k2j=h;this.Wg=Gc.Wg;this.zd=0;this.sg="EmbedDialog"}get vs(){return this.qTb}set vs(b){this.qTb=b}jmj(b){const h={["id"]:this.sg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:ia.a.fp(this.xvb,"wdPreview","1"),["initialEmbedUrl"]:this.hrc,["getEmbedCode"]:cd.h4h,
["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const t of Object.keys(b))h[t]=b[t];this.zd=1;this.Ge(1,CommonUIStrings.l_CopyAction);this.Ge(0,CommonUIStrings.l_Close);this.Yh(CommonUIStrings.l_Embed,null,h)}Bic(){if(this.k2j)this.jmj({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.RWb=document.getElementById("embedpreviewpane");this.Wod=document.getElementById("embedoptionpane");this.RWb.style.width=String.format("{0}px",this.I9j);this.EWa=document.createElement("iframe");
this.EWa.className=cd.G9j;this.EWa.frameBorder="0";this.EWa.style.height=String.format("{0}px",this.H9j);this.EWa.tabIndex=-1;this.RWb.appendChild(this.LFd(CommonUIStrings.l_Preview,this.EWa,cd.A8g,cd.z8g,cd.A8g,!0));this.zV=document.createElement("textarea");this.zV.className=cd.YVj;Sys.UI.DomElement.addCssClass(this.zV,wd.a.qZe);this.zV.id=cd.cQg;ba.a.si||(this.zV.readOnly=!0);this.zV.rows=4;this.zV.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.zV.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;
this.zV.setAttribute(Mf.a.Cea,String.format("{0} {1}",cd.bQg,cd.aQg));this.RWb.appendChild(this.LFd(CommonUIStrings.l_EmbedCode,this.zV,cd.bQg));Hf.a.addHandler(this.zV,"focus",this.Rud);var b=document.createElement("span");b.className=cd.KXj;b.innerText=CommonUIStrings.l_CopyText;b.id=cd.aQg;this.RWb.appendChild(b);this.Erb=document.createElement("div");this.Erb.className=cd.cVj;this.Wod.appendChild(this.LFd(CommonUIStrings.l_Dimensions,this.Erb));this.Wub=document.createElement("div");this.Wod.appendChild(this.j2k(cd.o6g,
this.Wub));this.zd=0;this.Ge(1,CommonUIStrings.l_Close);this.Nig();this.DAj();ba.a.si||this.zV.focus()}}dispose(){if(this.I_c){var b=this.I_c;for(let h in b){const t=b[h];this.Bq.sc(db.a.click,t.gec,this.nKe);this.$d.sc(db.a.fi,t.gec,this.exc);this.$d.sc(db.a.sh,t.gec,this.exc)}this.exc=this.nKe=this.I_c=null}if(this.Xmb){for(b=0;b<this.Xmb.length;++b)this.Bq.sc(db.a.click,this.Xmb[b].J8b,this.kre),this.$d.sc(db.a.fi,this.Xmb[b].J8b,this.qRb),this.$d.sc(db.a.St,this.Xmb[b].J8b,this.qRb),this.$d.sc(db.a.sh,
this.Xmb[b].J8b,this.qRb);this.$d=this.kre=this.Xmb=null}this.Rud&&this.zV&&(Hf.a.removeHandler(this.zV,"focus",this.Rud),this.Rud=null);this.zV=this.EWa=this.Wub=this.Erb=this.Wod=this.RWb=null;super.dispose()}fca(){super.fca();this.Kc.style.width=String.format("{0}px",this.iwe);this.eCa()}tNo(b,h){const t=ia.a.fp(this.hrc,b,h);return this.hrc!==t?(this.hrc=t,this.xvb=ia.a.fp(this.xvb,b,h),!0):!1}Nig(){this.zV&&(this.zV.innerText=cd.h4h(this.hrc,this.Ggd,this.qTb))}DAj(){this.EWa&&this.EWa.contentWindow.location.replace(ia.a.fp(this.xvb,
"wdPreview","1"))}Rle(b,h){this.tNo(b,h)&&(this.Nig(),this.DAj())}LFd(b,h,t=null,A=null,O=null,aa=!1){const ua=document.createElement("div");ua.className=cd.mbk;A&&(ua.id=A);O&&ua.setAttribute(Mf.a.Cea,O);aa&&(ua.tabIndex=0);A=document.createElement("span");A.className=cd.nbk;A.innerText=b;t&&(A.id=t);ua.appendChild(A);ua.appendChild(h);return ua}j2k(b,h){const t=this.LFd(CommonUIStrings.l_Interaction,h),A=this.gj.createElement("div");A.className=cd.KPj;A.id=cd.uIg+b;A.setAttribute(Mf.a.oh,Mf.a.z2);
A.tabIndex=0;t.insertBefore(A,h);b=dh.createClusteredImage(16,16,cd.LPj,cd.MPj,!0,"");A.appendChild(b);b=b.childNodes[0];b.className=dh.getImageClass(cd.tPg);b.title=CommonUIStrings.l_Expand;A.title=CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new hd(h,A,b);Array.add(this.Xmb,h);this.Bq.JD(db.a.click,A,this.kre,h);this.$d.JD(db.a.fi,A,this.qRb,h);this.$d.JD(db.a.St,A,this.qRb,h);this.$d.JD(db.a.sh,A,this.qRb,h);return t}pAk(b){this.uyh(b);return!0}qAk(b){return this.kVc(b,Object(z.a)(this,
this.uyh,"changeArrowState"))}uyh(b){b=b.Io;"visible"===b.x6f.style.visibility?(b.x6f.style.visibility="hidden",b.q1a.className=dh.getImageClass(cd.tPg),b.q1a.title=CommonUIStrings.l_Expand,b.J8b.title=CommonUIStrings.l_Expand):(b.x6f.style.visibility="visible",b.q1a.className=dh.getImageClass(cd.Cgk),b.q1a.title=CommonUIStrings.l_Collapse,b.J8b.title=CommonUIStrings.l_Collapse)}RGh(b,h){const t=document.createElement("div");t.className=cd.l6g;t.id=b+cd.m6g;var A=this.gj.createElement("div");A.tabIndex=
0;A.className=cd.PKg;A.id=b+cd.Hoc;A.setAttribute(Mf.a.oh,Mf.a.V_e);A.setAttribute(Mf.a.QBa,Mf.a.gp);A.setAttribute(Mf.a.Cea,b+cd.OSb);t.appendChild(A);t.setAttribute(Mf.a.oh,Mf.a.Ny);var O=dh.createClusteredImage(16,16,cd.VKg,cd.UKg,!0,"");A.appendChild(O);O=O.childNodes[0];O.id=b+cd.n6g;O.className=dh.getImageClass(cd.fte);A=new Mc(t,O,A,1);this.I_c[b]=A;this.Bq.JD(db.a.click,t,this.nKe,b);A=document.createElement("span");A.className=cd.OSb;A.innerText=h;A.id=b+cd.OSb;t.appendChild(A);this.$d.JD(db.a.fi,
t,this.exc,b);this.$d.JD(db.a.sh,t,this.exc,b);return t}yqn(b){this.PSi(b);return!0}zqn(b){return this.kVc(b,Object(z.a)(this,this.PSi,"optionHandler"))}PSi(b){const h=this.I_c[b.Io.toString()];h.value?(h.value=0,h.q1a.className=dh.getImageClass(cd.XTe),h.f7d.setAttribute(Mf.a.QBa,Mf.a.NL)):(h.value=1,h.q1a.className=dh.getImageClass(cd.fte),h.f7d.setAttribute(Mf.a.QBa,Mf.a.gp));this.Rle(b.Io.toString(),h.value.toString())}aBo(){this.zV.select()}static h4h(b,h,t){if(!cd.TIe){const A=String.format('<a target="_blank" href="{0}">{1}</a>',
F.a.B8b("https://office.com"),CommonUIStrings.l_Office),O=String.format('<a target="_blank" href="{0}">{1}</a>',F.a.B8b("https://office.com/webapps"),CommonUIStrings.l_WebAppName);cd.TIe=String.format(CommonUIStrings.l_NoFrames,A,O)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',F.a.B8b(b),h,t,cd.TIe)}}cd.TIe=null;cd.fte="CheckboxChecked_16x16x32";cd.XTe="CheckboxUnchecked_16x16x32";cd.Cgk="OutlookSearchChevronUp_16x16x32";cd.tPg="OutlookSearchChevronDown_16x16x32";
cd.VKg="CommentChecked";cd.LPj="UpArrowServer";cd.OSb="EmbedDescription";cd.mbk="EmbedSectionHeader";cd.nbk="EmbedSectionName UIFontBold";cd.KXj="EmbedCodeFooter";cd.UKg="EmbedOptionImage";cd.G9j="EmbedPreviewFrame";cd.YVj="EmbedCodeTextArea";cd.l6g="EmbedOption";cd.cVj="EmbedDimensionSection";cd.MPj="EmbedArrowIcon";cd.KPj="WACGlyph EmbedArrowHolder";cd.PKg="EmbedCheckBoxHolder";cd.m6g="Option";cd.n6g="OptionImage";cd.cQg="EmbedCode";cd.bQg="EmbedCodeHeader";cd.A8g="Preview";cd.z8g="PreviewHeader";
cd.o6g="Options";cd.uIg="Arrow";cd.Hoc="Check";cd.aQg="EmbedCodeFooter";Object(m.a)(cd,"EmbedDialog",Pf.a,[]);class Ld extends Mc{constructor(b,h,t,A,O){super(b,h,t,A);this.y1a=O}}Object(m.a)(Ld,"OptionInputInfo",Mc,[]);class Ae extends cd{constructor(b,h){super(b,Ae.fL);this.I$=null;this.zqc=[];this.Mtd=Object(z.a)(this,this.Xuo,"startOnOptionClickHandler");this.tYb=Object(z.a)(this,this.Yuo,"startOnOptionKeyHandler");this.npd=Object(z.a)(this,this.Fkn,"onPageNumberChanged");this.uwe=Object(z.a)(this,
this.Tgn,"onDimensionChanged");this.KG=h}Bic(){if(Ae.fL){var b=Ae.HIn,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.KG.$Xi,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.KG.Y1i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.KG.Koj,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.KG.Loj}});this.jmj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,
["defaultWidth"]:this.Ggd,["defaultHeight"]:this.qTb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.KG.cEj,["heightLabel"]:this.KG.pji},["interactionOptions"]:h})}else super.Bic(),this.fkh(this.KG.cEj,"EmbedWidthInput",this.Ggd),this.fkh(this.KG.pji,"EmbedHeightInput",this.qTb),this.Wub.appendChild(this.RGh("wdPrint",this.KG.$Xi)),this.Wub.appendChild(this.RGh("wdEmbedCode",this.KG.Y1i)),this.kkk(this.KG.Koj),this.eCa(),yd.FocusManager.DJ()&&(b=yd.FocusManager.instance(),h=[document.getElementById(cd.cQg),
document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(cd.uIg+cd.o6g),document.getElementById("wdPrint"+cd.Hoc),document.getElementById("wdEmbedCode"+cd.Hoc),document.getElementById("wdStartOn"+cd.Hoc),document.getElementById("wdStartOnText"),document.getElementById(Ri.a.kcd),document.getElementById(cd.z8g)],h=new gf(h),b.Hs().Xj=h,ba.a.si?this.l0(document.getElementById(Ri.a.kcd)):this.zV.select())}dispose(){if(!Ae.fL){if(this.zqc){for(let b=
0;b<this.zqc.length;++b)Hf.a.removeHandler(this.zqc[b],"change",this.uwe);this.zqc=this.uwe=null}this.npd&&(Hf.a.removeHandler(this.I$.y1a,"change",this.npd),this.npd=null);this.Mtd&&(this.Bq.sc(db.a.click,this.I$.gec,this.Mtd),this.Mtd=null);this.tYb&&(this.$d.sc(db.a.fi,this.I$.gec,this.tYb),this.$d.sc(db.a.sh,this.I$.gec,this.tYb),this.tYb=null);this.I$=null}super.dispose()}fkh(b,h,t){const A=document.createElement("label");A.className="EmbedInputPrefix";A.innerText=b;this.Erb.appendChild(A);b=
document.createElement("input");b.className=h;b.id=h;b.value=t.toString();b.type="text";b.setAttribute("data-lpignore","true");A.setAttribute("for",h);this.Erb.appendChild(b);this.zqc.push(b);Hf.a.addHandler(b,"change",this.uwe);this.Erb.appendChild(document.createElement("br"))}Tgn(b){"EmbedWidthInput"===b.target.id?this.Ggd=this.$Id(b.target,375):this.qTb=this.$Id(b.target,250);this.Nig()}$Id(b,h){let t=parseInt(b.value);if(isNaN(t)||t<h)t=h;b.value=t.toString();return t}Fkn(b){b=this.$Id(b.target,
1);1===this.I$.value&&this.Rle("wdStartOn",b.toString())}kkk(b){const h=document.createElement("div");h.className=cd.l6g+" EmbedInlineOption";h.id="wdStartOn"+cd.m6g;const t=this.gj.createElement("div");t.tabIndex=0;t.className=cd.PKg;t.id="wdStartOn"+cd.Hoc;t.setAttribute(Mf.a.oh,Mf.a.V_e);t.setAttribute(Mf.a.QBa,Mf.a.NL);t.setAttribute(Mf.a.Cea,"wdStartOn"+cd.OSb);h.appendChild(t);h.setAttribute(Mf.a.oh,Mf.a.Ny);var A=dh.createClusteredImage(16,16,cd.VKg,cd.UKg,!0,"");t.appendChild(A);A=A.childNodes[0];
A.id="wdStartOn"+cd.n6g;A.className=dh.getImageClass(cd.XTe);const O=document.createElement("span");O.className=cd.OSb;O.innerText=b;O.id="wdStartOn"+cd.OSb;h.appendChild(O);this.Wub.appendChild(h);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.KG.Loj;b.setAttribute("data-lpignore","true");this.Wub.appendChild(b);Hf.a.addHandler(b,"change",this.npd);this.I$=new Ld(h,A,t,0,b);this.Rle("wdStartOn","1");this.Bq.mb(db.a.click,h,this.Mtd);
this.$d.mb(db.a.fi,h,this.tYb);this.$d.mb(db.a.sh,h,this.tYb)}Xuo(b){this.Ioj(b);return!0}Yuo(b){return this.kVc(b,Object(z.a)(this,this.Ioj,"startOnOptionHandler"))}Ioj(){let b=1;this.I$.value?(this.I$.value=0,this.I$.q1a.className=dh.getImageClass(cd.XTe),this.I$.f7d.setAttribute(Mf.a.QBa,Mf.a.NL)):(this.I$.value=1,this.I$.q1a.className=dh.getImageClass(cd.fte),b=this.$Id(this.I$.y1a,1),this.I$.f7d.setAttribute(Mf.a.QBa,Mf.a.gp));this.Rle("wdStartOn",b.toString())}static get fL(){return v.AFrameworkApplication.ta.Ob.VE}static HIn(b,
h,t,A=null){if("wdPrint"===h||"wdEmbedCode"===h)return ia.a.fp(b,h,t?"1":"0");if("wdStartOn"===h){let O="1";t&&A&&(A=parseInt(A),!isNaN(A)&&1<=A&&(O=A.toString()));return ia.a.fp(b,h,t?O:"1")}return b}}Object(m.a)(Ae,"WordEmbedDialog",cd,[]);class te{constructor(b,h,t,A,O){this.zda=null;this.ga=b;this.v$a=h;this.dP=t;this.KG=A;this.Oqa=O}Ub(){this.ga.pa(this.dP,yc.a.frame,Object(z.a)(this,this.Boo,"showEmbedCode"));this.v$a.execute(Object(z.a)(this,this.qRf,"onHostPostmessengerCreated"))}qRf(b){u.ULS.shipAssertTag(4994850,
332,!!b);this.zda=b;v.AFrameworkApplication.qga||(this.zda.pv(K.a.fxh),this.zda.uB(K.a.fxh,Object(z.a)(this,this.Bic,"showEmbedDialog")))}Bic(b){b=b.Values.HostEmbeddedViewUrl.toString();v.AFrameworkApplication.eQc=b;this.Oqa.Mef=b;(new Ae(b,this.KG)).Bic()}Boo(b,h,t){if(2===t)if(v.AFrameworkApplication.eQc)(new Ae(this.Oqa.Mef,this.KG)).Bic();else return v.AFrameworkApplication.Om.t1a(te.qHj),v.AFrameworkApplication.fkg&&this.zda.sendMessage(K.a.ptl,null)?32:v.AFrameworkApplication.ta.qU(!0,v.AFrameworkApplication.rhf);
return 32}}te.qHj=10381;Object(m.a)(te,"EmbedActor",null,[]);class xe{}Object(m.a)(xe,"WordEmbedDialogStrings",null,[]);var Ke=c(272);class mf extends te{constructor(b,h){super(b,h,Vc.a.$ag,Object.assign(new xe,{cEj:WordEditorIntl.WordEditorStrings.l_Width,pji:WordEditorIntl.WordEditorStrings.l_Height,$Xi:WordEditorIntl.WordEditorStrings.l_PrintOption,Y1i:WordEditorIntl.WordEditorStrings.l_ReembedOption,Koj:WordEditorIntl.WordEditorStrings.l_StartOnOption,Loj:WordEditorIntl.WordEditorStrings.l_StartPage}),
Ke.WoncaApp.instance)}}Object(m.a)(mf,"EmbedActor",te,[]);class Ve{constructor(){this.W=null}get name(){return"WordEditor.Embed"}yc(b){this.W=b;b.ha("WordEditor.Embed.EmbedActor",()=>new mf(v.AFrameworkApplication.xa,b.Sa("Postmessage.IHostPostmessenger"))).singleInstance()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Ub()}dispose(){}}Object(m.a)(Ve,"EmbedPackage",null,[1,2]);class Zf{constructor(b,h,t){this.Iv=this.IJa=this.ULa=null;this.wJa=0;this.YUb=this.SUb=this.FUb=this.gVb=this.pVa=
this.oVa=!1;this.Nj=b;this.Um=t}sO(b){return Jb.App.ya.jb.isEditingAllowed?""!==this.fNc(b.zf):!1}PK(b){if(!this.sO(b))return!1;this.Q$n(b);this.R$n();this.S$n();this.ULa=b.IH;this.Iv=new Sys.UI.Point(0,0);u.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}rU(b){this.IJa=b.IH;this.CJk();this.Nj.xzj(this.Iv.x,this.Iv.y,this.gVb,this.FUb,this.SUb,this.YUb,!1);return!0}ED(){this.Nj.xzj(this.Iv.x,this.Iv.y,this.gVb,this.FUb,this.SUb,this.YUb,!0);u.ULS.sendTraceTag(22381024,322,50,
"Image Crop drag succeeded")}fY(){this.Nj.uMk();u.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}R$n(){this.YUb=this.SUb=this.FUb=this.gVb=!1;switch(this.wJa){case 1:this.gVb=!0;break;case 5:this.FUb=!0;break;case 3:this.YUb=!0;break;case 7:this.SUb=!0;break;case 0:this.SUb=this.gVb=!0;break;case 2:this.YUb=this.gVb=!0;break;case 6:this.SUb=this.FUb=!0;break;case 4:this.YUb=this.FUb=!0}}S$n(){this.pVa=this.oVa=!1;switch(this.wJa){case 0:this.pVa=this.oVa=!0;break;case 1:case 2:this.pVa=
!0;break;case 7:case 6:this.oVa=!0}}fNc(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const t=b[h].toString();if(t.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==t)return t}return""}Q$n(b){switch(this.fNc(b.zf)){case "WACImageCropHandleNW":this.wJa=0;break;case "WACImageCropHandleN":this.wJa=1;break;case "WACImageCropHandleNE":this.wJa=2;break;case "WACImageCropHandleE":this.wJa=3;break;case "WACImageCropHandleSE":this.wJa=
4;break;case "WACImageCropHandleS":this.wJa=5;break;case "WACImageCropHandleSW":this.wJa=6;break;case "WACImageCropHandleW":this.wJa=7}}CJk(){var b=1;this.Um.instance&&(b=this.Um.instance.ij);const h=(this.IJa.x-this.ULa.x)/b;b=(this.IJa.y-this.ULa.y)/b;this.Iv.x=this.oVa?-h:h;this.Iv.y=this.pVa?-b:b}}Object(m.a)(Zf,"ImageCropDragAdapter",null,[153]);class qg{constructor(b,h){this.ga=b;this.Um=h}eSl(b){return new Zf(b,this.ga,this.Um)}}Object(m.a)(qg,"ImageCropDragAdapterFactory",null,[473]);var mg=
c(243),Nf=c(200),zf=c(44),yg=c(471),Ji=c(705),gg=c(96),uf=c(64),Kk=c(445),wm=c(973),Ek=c(543),Hj=c(904),Lk=c(142),og=c(388),Po=c(265),Wm=c(866),ip=c(215),mj=c(95),Wh=c(22),hq=c(304),mr=c(783),Tr=c(403),Xm=c(131);class Ci{constructor(b,h,t,A,O,aa,ua,Ra,ub=null){this.Xb=ub;this.zRc=null;this.XJ=b;this.Hh=h;this.Ic=t;this.As=A;this.Jd=O;this.ib=aa;this.Rm=ua;this.hE=Ra}get HW(){return null!=this.Ysg?this.Ysg:this.Ysg=Sa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get uc(){return null!=
this.rGg?this.rGg:this.rGg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get lf(){return Lk.PageReader.instance}bco(b,h,t){const A=this.Ic.Qc(15);A.Eb(h.node);this.uSa(b,t);A.dispose()}aco(b,h,t){const A=this.Ic.Qc(15);A.Eb(h.node);this.$Mb(b,t);A.dispose()}uSa(b,h){b.setValue(Af.a.imageAltText,h)}$Mb(b,h){b.setValue(Lc.a.xX,h)}ico(b,h){b.setValue(Af.a.Mhb,h)}mfj(b,h){var t=Be.ImageReader.sk(b);Jb.App.instance&&Jb.App.instance.h8(t)?(t=b.ia(zf.a.h4d,null),h=mr.a.W5k(h,t),b.setValue(zf.a.h4d,
h)):b.setValue(Lc.a.yX,h)}eco(b,h,t,A,O){let aa=0;var ua=0;({width:aa,height:ua}=Be.ImageReader.Kgb(b));ua-=(h+t)/1E5*ua;this.cHa(b,aa-(A+O)/1E5*aa);this.bHa(b,ua);this.Efj(b);b.setValue(Lc.a.fFb,h);b.setValue(Lc.a.cFb,t);b.setValue(Lc.a.dFb,A);b.setValue(Lc.a.eFb,O)}cgo(b,h,t,A){const O=this.Ic.Qc(15);O.Eb(h.node);this.qee(b,t,A);O.dispose()}qee(b,h,t){this.cHa(b,h);this.bHa(b,t);this.Efj(b);b.removeProperty(Gd.a.A8d);b.removeProperty(Gd.a.y8d)}cHa(b,h){b.setValue(Af.a.xba,h);b.setValue(Gd.a.sEa,
-1)}bHa(b,h){b.setValue(Af.a.Jga,h);b.setValue(Gd.a.rEa,-1)}LD(b,h){b.setValue(Lc.a.$Pc,h);b.setValue(Af.a.Sh,h);b.setValue(Af.a.tq,h)}Pgo(b,h){b.setValue(Lc.a.TOb,h)}V9n(b,h){b.setValue(Lc.a.c1e,h)}Tgo(b){if(!Be.ImageReader.w3(b)&&b.Xk){var h=b.node;if(Be.ImageReader.a8(h)){const O=this.Ic.Qc(15);O.Eb(b.node);b=ue.GraphIterator.$a(h);b.Ab(12);b=b.parentNode;var t=b.properties.Lf(Lc.a.$p),A=h.properties.getValue(Lc.a.runId);h.ia(Lc.a.Lc,Tn.a.DR);const aa=b.qa,ua=[Lc.a.$Pc,Af.a.Sh,Af.a.tq,Lc.a.c1e,
Lc.a.TOb,Lc.a.sYa];Jb.App.instance&&Jb.App.instance.h8(Be.ImageReader.sk(h))&&ua.push(zf.a.Ntf,zf.a.Mtf);h.Qg.apply(h,ua);t=this.Emf(A,t,aa);A=pf.a.Tc(b,t);this.As.bFh(h,A);(h=this.hE.nK(b,t,t+1))&&this.ib.setSelection(h);this.HW.Epa(b,t,t+1);O.dispose()}}}K7f(b,h){if(b.properties.hasProperty(Lc.a.G6)){const t=b.properties.Lf(Lc.a.G6);t.push(h);b.properties.setValue(Lc.a.G6,Array.clone(t))}else b.properties.setValue(Lc.a.G6,[h])}Dfe(b,h,t=0,A=!1){if(b.Xk){var O=this.Ic.Qc(15),aa=b.node;O.Eb(aa);if(Be.ImageReader.w3(b)){const Nb=
this.Xb&&this.Xb.isFeatureEnabled(44)?new Hj.a:new Ek.a;Nb.Aw(Be.ImageReader.Wm(b));var ua=aa.qa,Ra=this.gvl(b.cpBegin,ua);this.zzk(b.cpEnd,ua,Ra)&&u.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");ua=ua.J(Ra).blob;Ra=ua.ze;var ub=aa.properties.Lf(Lc.a.$p);ub=this.gIn(ub);Ra=ub[Ra];ub=aa.ia(Lc.a.Lc,Tn.a.DR);if(ua=Object(Da.a)(wm.ImageBlobObject,ua))ua.yNb=!1;this.Jd.replaceTextRange(b,"");ua&&(ua.yNb=!0);Nb.properties.setValue(Lc.a.runId,Ra);Nb.properties.setValue(Lc.a.Lc,
ub);b=ue.GraphIterator.$a(aa);b.Ab(12);b.Qf(Nb,6);this.K7f(b.currentNode,Nb.anchor.node.id);aa=Nb}t&&this.LD(aa.properties,t);this.V9n(aa.properties,A);this.Pgo(aa.properties,h);this.HW.Chc(aa);(h=this.hE.mq(aa))&&this.ib.setSelection(h);O.dispose()}}f6f(b,h){if(!(0>=h)){var t=Hc.a.Tl(h,0),A=Be.ImageReader.JE(b),O=Be.ImageReader.bG(b);A>t&&(O*=t/A,this.cHa(b,t),this.bHa(b,O),u.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",h))}}zzk(b,h,t){const A=
h.length;if(t>=A||!h.J(t).uf)return!1;const O=new sp.a;for(;t<A;t++){const aa=h.J(t);if(aa.cp>b||!aa.uf)break;for(let ua=0;ua<aa.uf.length;ua++){if(O.contains(aa.uf.J(ua).Tj))return!0;O.add(aa.uf.J(ua).Tj)}}return!1}gIn(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var t=0;t<b.length;)b[t]=t+1,t++;else{var A=b[h];t=h-1;for(var O=A-1;0<=t;)b[t]=O,t--,O--;O=0;for(t=h+1;t<b.length;)(h=b[t])?h<A?(A=h+O,b[t]=A):A=h:(O+=2,A++,b[t]=A),t++}return b}bif(b,h){let t=0;for(;t<h.length&&!(b<h[t]);)t++;
return t}Emf(b,h,t){let A=0;const O=this.bif(b,h);let aa=0;if(O===h.length)aa=t.length-1;else for(;aa<t.length;){h=t.J(aa);if(h.formatting&&h.formatting.ze===O)break;aa++}aa<t.length?A=t.J(aa).cp:u.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:aa,["RunId"]:b,["CharacterPropertiesArrayLength"]:t.length});return A}gvl(b,h){let t=0;for(;t<h.length&&h.J(t).cp!==b;)t++;t===h.length&&u.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",
{["Index"]:t,["CharacterPropertiesArrayLength"]:h.length});return t}Efj(b){b.setValue(Af.a.yga,!0)}g9d(b,h,t,A=!1){h&&t?(h=Math.max(h,Ji.a.gIi),t=Math.max(t,Ji.a.gIi)):t=h=Ji.a.zLh;b.setValue(Af.a.xba,Hc.a.Tl(h,0));b.setValue(Af.a.Jga,Hc.a.Tl(t,1));b.setValue(Af.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(fh.a.l_,1);b.setValue(Lc.a.wga,A)}YUd(){return null}$Oh(b,h,t){let A=null;h=({UIb:A}=this.aPh(b,h,t)).returnValue;A&&b.view.nb.setSelection(A);return h}aPh(b,h,t){var A=
null;if(!this.Mea(b))return{returnValue:null,UIb:A};var O=b.view;const aa=this.Ic.Qc(15,qa.a.AFb);aa.Eb(O.Zc);h||(h=new ji.DictionaryPropertySet);h.setValue(Gd.a.Qjl,!0);let ua=O.nb.pg;var Ra=new Wm.a;if(!nf.SelectionEditor.jf(ua)){if(2===v.AFrameworkApplication.xa.processAction(qa.a.Ula,2))return aa.dispose(),{returnValue:null,UIb:A};ua=O.nb.pg}else if(ua.Xk&&qe.ParagraphReader.Yb(ua.node)){Jb.App.xd.Yp&&Jb.App.xd.Vq.aH(ua.node);O=Wa.FormattingReader.Ar(ua);if(!O)return aa.dispose(),{returnValue:null,
UIb:A};O.cache.lB&&(O=O.Sf(null),Ci.oq.j4(O));Ra.formatting=O.Dj;Ra.languageId=Wa.FormattingReader.language(O);Ra.xqa=this.uc.Uo(ua.node)}if(!ua.Xk)return aa.dispose(),{returnValue:null,UIb:A};if(!this.jyf(b.Yj,h))return aa.dispose(),this.zRc=null,{returnValue:null,UIb:A};b=this.zRc;this.zRc=null;1===b.location?(A=b.node,h=Tr.a.instance.Usf(A),wg.OutlineElementNavigator.Ir(h,!1,!1)||(ip.OutlineNavigator.Ace(h),this.XJ.I6(h,!0,Ra)),wg.OutlineElementNavigator.Fe(h),ni.TableReader.isTable(h)&&(Object(hc.a)(Xm.a,
h)||Object(hc.a)(og.a,h)?(Ra=new ue.GraphIterator,Ra.set(h.currentNode),Wh.moveToCellContent(Ra,0,0),h.set(Ra.currentNode)):Wh.moveToCellContent(h,0,0),mb.OutlineElementReader.Lh(h)?wg.OutlineElementNavigator.Fe(h):h=Tr.a.instance.Usf(A)),A=qe.ParagraphReader.Jt(h.currentNode)?this.hE.te(h.currentNode,0):this.hE.mq(h.currentNode)):b.location||(Ra=b.blob.Kb.cp+1,A=this.hE.nK(b.node,Ra-1,Ra));aa.zFa(t,1);aa.kk=qa.a.AFb;aa.dispose();return{returnValue:b,UIb:A}}jyf(){return!1}Mea(b){b.contextId===mc.a.view&&
b.view.re&&b.view.nb&&(b=b.view.nb.pg);if(!b)return Ci.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.noSelection}),!1;if(Ci.Zf.JZ(b))return Ci.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.tE}),!1;if(Ci.Zf.Gna(b))return Ci.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.Fni}),!1;if(this.Rm&&this.Rm.instance&&this.Rm.instance.aU(b))return Ci.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.externalSelection}),!1;if(this.lf.s3)return Ci.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.compatMode}),!1;if(b.Xk)return mj.OutlineReader.aYd(b)?(Ci.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.x7e}),
!1):Be.ImageReader.SWd(b)?(Ci.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.p7e}),!1):hq.c(b)?(Ci.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.q7e}),!1):Po.a.OAf(b)?(Ci.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.o7e}),!1):qe.ParagraphReader.ZT(b)||Be.ImageReader.Bxm(b)?(Ci.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.IN}),!1):!0;if(Kk.a.dCf(b)){let h=!0;for(let t=0;t<b.length;++t){const A=b.getContext(t);if(!A.Xk)return!1;h&&!qe.ParagraphReader.ZT(A)&&(h=!1)}return h?(Ci.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.IN}),!1):!0}return!1}l2f(b,h){const t=this.Ic.Qc(7);
t.Eb(b);if(12===b.type){h=h.Kb.cp;var A=qe.ParagraphReader.textLength(b);A=pf.a.ZP(h,h+1,h+1===A?!0:!1,b);this.Jd.replaceTextRange(A,"");b=pf.a.Tc(b,h);this.ib.setSelection(wf.SelectionFactory.Zn(b))}else this.Hh.GGa(b);t.dispose()}static get oq(){return null!=Ci.Fwg?Ci.Fwg:Ci.Fwg=Sa.a.instance.resolve("Box4.IFormattingEditor")}static get Zf(){return rl.a.instance}static get Jc(){return zk.a.instance}}Object(m.a)(Ci,"ImageEditor",null,[472]);class Os{constructor(b,h,t,A=0){this.node=b;this.blob=h;
this.location=t;this.WT=A}}Object(m.a)(Os,"InsertPictureResult",null,[]);var yq=c(824),Ar=c(305),zq=c(1181);class Ku extends Ci{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc){super(b,h,t,A,O,aa,ua,Ra,Pc);this.aUj="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.h9a="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.LJ=this.nKa=this.Iza=null;this.mja=Array(8);this.yjd=this.cAa=null;this.oKa=!1;this.xjd=this.PBe=null;this.efd=this.ogd=!1;this.lS=this.kS=this.jS=this.mS=this.uV=this.tV=this.sV=this.vV=this.PV=this.QV=0;this.Y3=()=>{this.oKa&&this.dff()};this.Pwa=jd=>{this.oKa&&jd.Ib.keyCode!==rc.a.ks&&this.dff(!0);return!1};this.LVg=Dc;aa.gx(this.Y3);this.$d=bc;this.v1=mg.a.instance;this.ga=v.AFrameworkApplication.xa;this.Wd=Nb;this.iq=ub;this.jd=Pc}Jee(b,h,t,A,O){b.hasProperty(Gd.a.iQa)&&b.removeProperty(Gd.a.iQa);
const aa=Array(4);aa[0]=h;aa[1]=t;aa[2]=A;aa[3]=O;b.setValue(Lc.a.bca,aa)}LSn(b){b.setValue(Lc.a.uEa,0);b.setValue(Lc.a.mKb,"");this.Jee(b,0,0,0,0)}G8f(b,h,t,A,O){b.setValue(Lc.a.fFb,h);b.setValue(Lc.a.cFb,t);b.setValue(Lc.a.dFb,A);b.setValue(Lc.a.eFb,O)}Lee(b,h,t,A){b.setValue(Lc.a.WI,h);b.setValue(Lc.a.yPc,t);b.setValue(Lc.a.KPc,A);b.setValue(Gd.a.WI,-1)}WUd(b,h){b=b.node;const t=ue.GraphIterator.$a(b);if(qe.ParagraphReader.Yb(b)&&qe.ParagraphReader.isEmpty(t)){var A=b.properties.Lf(Lc.a.Lc);h.setValue(Lc.a.Lc,
A);h.setValue(Lc.a.runId,1);A=new zq.a;h&&A.Aw(h);t.Qf(A,6);this.K7f(b,A.anchor.node.id);this.HW.Chc(A);return new Os(A,null,3)}return null}YUd(b,h){var t=yq.a.instance.Abd;h&&t.Aw(h);t.setValue(Lc.a.imageType,1);let A=0;A=Nf.a.aF();t.setValue(Lc.a.WT,A);const O=b.node.Mc.Du(t,t.id);t=this.Jd.jga(b,aa=>new wm.ImageBlobObject(aa,O));Ar.GraphTransactionManager.instance.ZQf(b.node);if(this.Wd.Cg){const aa=new Te.GraphTransaction(15);aa.Eb(b.node);this.iq.Lpa(b.node,b.cpBegin,b.cpBegin+1,1,null);aa.dispose()}this.HW.KMa&&
!h.ia(Lc.a.wga,!1)&&this.HW.Epa(b.node,b.cpBegin,b.cpBegin+1);return new Os(b.node,t,0,A)}jyf(b,h){if(!this.Mea(b))return!1;const t=this.Ic.Qc(7);t.Eb(b.node);v.AFrameworkApplication.K.$("ContentAppIsEnabled")&&h.ia(Lc.a.Ppi,!1)?this.zRc=this.WUd(b,h):this.zRc=this.YUd(b,h);t.dispose();return!0}$fc(b,h,t,A){if(!t.Yb(b))return!1;t=this.Ic.Qc(7,qa.a.Ycm);t.Eb(b);var O=b.properties.ia(Af.a.sm,[]);O.push(0);for(const aa of O)if((O=A.qlf(b,aa))&&5===O.zh&&O.id.equals(h))return this.Jd.replaceTextRange(pf.a.createTextRange(b,
aa,aa+1),""),t.dispose(),!0;t.dispose();u.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}ZRn(b,h,t,A){if(!Be.ImageReader.a8(b))return!1;h.set(b);h.Ab(12);const O=h.jo(12);if(!O)return u.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(t.DTc(O))return u.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),
!1;A(b);t=this.Ic.Qc(7);t.Eb(b);h.Dg();t.dispose();return!0}HXn(b,h,t,A){return Be.ImageReader.N1a(b)?this.vXn(b,t):Be.ImageReader.w3(b)?this.KXn(b,h,t,A):null}KXn(b,h,t,A){const O=yq.a.instance.Abd;t&&O.Aw(t);t=0;t=Nf.a.aF();O.setValue(Lc.a.WT,t);t=b.node.Mc;b=b.node;A=A.bMc(b,5);for(const aa of A)if(aa.id.equals(h)){this.Jd.replaceTextRange(pf.a.createTextRange(b,aa.Kb.cp,aa.Kb.cp+1),"");const ua=t.Du(O,O.id);h=pf.a.Tc(b,aa.Kb.cp);this.Jd.jga(h,Ra=>new wm.ImageBlobObject(Ra,ua));return O}return null}vXn(b,
h){if(!Be.ImageReader.N1a(b))return null;h.setValue(Lc.a.WT,Nf.a.aF());b=b.node;var t=b.anchor.node.id;b=ue.GraphIterator.$a(b);b.Ab(12);const A=b.parentNode;let O;A.properties.hasProperty(Lc.a.G6)?(O=A.properties.Lf(Lc.a.G6),t=W.a.indexOf(O,t),-1!==t&&Array.removeAt(O,t)):O=[];A.properties.setValue(Lc.a.G6,Array.clone(O));b.Dg();t=this.jd&&this.jd.isFeatureEnabled(44)?new Hj.a:new Ek.a;t.Aw(h);b.Qf(t,6);this.K7f(A,t.anchor.node.id);return t}U8c(b,h){this.oKa?this.dff():this.xuo(b,h)}kco(b,h){b.setValue(Gd.a.WI,
h)}iSl(b){let h=null,t=null;if(!b)return u.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:h,Hi:t};if(!pc.InteractiveViewManager.instance.vd)return u.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,Hi:t};const A=b.node;if(!A)return u.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),
{returnValue:null,view:h,Hi:t};t=A.Mc;var O=A.Ee(pc.InteractiveViewManager.instance.vd.jc);if(!O)return u.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:h,Hi:t};h=O.Og;if(b.Xk&&Be.ImageReader.w3(b)){b=Be.ImageReader.NDa(b);if(!b)return u.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:h,Hi:t};O=b.nva(h,O);if(!O)return u.ULS.sendTraceTag(22381058,
322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,Hi:t};O=O.element}else if(Be.ImageReader.Wu(A))O=O.htmlElement;else return u.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,Hi:t};return{returnValue:O,view:h,Hi:t}}oio(b){for(let A=0;A<this.mja.length;A++){this.mja[A]=b.Hk(Sh.a.span);this.mja[A].className="WACImageCropHandles "+
this.aUj[A];if(2>=A){var h=b.Hk(Sh.a.span);h.className=this.h9a[0];var t=b.Hk(Sh.a.span);t.className=this.h9a[1];this.mja[A].appendChild(h);this.mja[A].appendChild(t)}else 4<A&&(h=b.Hk(Sh.a.span),h.className=this.h9a[2],t=b.Hk(Sh.a.span),t.className=this.h9a[3],this.mja[A].appendChild(h),this.mja[A].appendChild(t));if(!A||3===A||5===A)h=b.Hk(Sh.a.span),h.className=this.h9a[4],t=b.Hk(Sh.a.span),t.className=this.h9a[5],this.mja[A].appendChild(h),this.mja[A].appendChild(t);else if(2===A||4===A||7===
A)h=b.Hk(Sh.a.span),h.className=this.h9a[6],t=b.Hk(Sh.a.span),t.className=this.h9a[7],this.mja[A].appendChild(h),this.mja[A].appendChild(t)}}xuo(b,h){u.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.oKa)u.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var t=null,A=null;if((this.cAa=({view:t,Hi:A}=this.iSl(h)).returnValue)&&t){this.cAa.classList.add("ImageCropMode");this.Iza=t.Hk(Sh.a.div);this.Iza.className="WACImageCropMode";
this.nKa=t.Hk(Sh.a.r1a);this.nKa.className="WACImageCropBase";this.LJ=t.Hk(Sh.a.span);this.LJ.className="WACImageCropSrcRect";this.oio(t);this.Iza.appendChild(this.LJ);for(t=0;t<this.mja.length;t++)this.LJ.appendChild(this.mja[t]);this.Iza.appendChild(this.nKa);this.nKa.style.visibility="";this.nKa.style.display="";this.cAa.appendChild(this.Iza);this.Wxn(b);A=Be.ImageReader.XDa(b,A);t=Be.ImageReader.S4(b,Gd.a.Loa,null);this.nKa.src=t?t:Be.ImageReader.mDb(A);this.LVg&&this.LVg.execute(O=>{this.yjd||
(this.yjd=O.eSl(this))});this.ogd||(this.v1.IO(this.cAa,this.yjd),this.ogd=!0);this.$d&&this.$d.mb(db.a.CF,pc.InteractiveViewManager.instance.editingView.editingElement,this.Pwa);this.oKa=!0;this.PBe=b;this.xjd=h;this.efd=!1;b=new Te.GraphTransaction(4);b.Eb(this.xjd.node);this.PBe.setValue(Gd.a.Yva,this.oKa);b.dispose()}else u.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}Wxn(b){const h=Hc.a.ef(Be.ImageReader.JE(b),
0),t=Hc.a.ef(Be.ImageReader.bG(b),1),A=Math.max(Be.ImageReader.Oma(b),0),O=Math.max(Be.ImageReader.Lma(b),0),aa=Math.max(Be.ImageReader.Mma(b),0),ua=Math.max(Be.ImageReader.Nma(b),0);this.QV=1E5*h/(1E5-(aa+ua));this.PV=1E5*t/(1E5-(A+O));this.vV=Math.floor(A*this.PV/1E5);this.sV=Math.floor(O*this.PV/1E5);this.tV=Math.floor(aa*this.QV/1E5);this.uV=Math.floor(ua*this.QV/1E5);this.LJ.style.top=this.vV+"px";this.LJ.style.bottom=this.sV+"px";this.LJ.style.left=this.tV+"px";this.LJ.style.right=this.uV+"px";
this.nKa.style.width=this.QV+"px";this.nKa.style.height=this.PV+"px";Be.ImageReader.Zx(b)&&(this.Iza.style.width=this.QV+"px",this.Iza.style.height=this.PV+"px");this.mS=this.vV;this.jS=this.sV;this.kS=this.tV;this.lS=this.uV}dff(b=!1){u.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.oKa?(b||this.bWk(),this.nKa?vc.a.eC(this.nKa):u.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.cAa?(this.Iza?this.Iza.parentNode===
this.cAa?this.cAa.removeChild(this.Iza):u.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):u.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.cAa.classList.remove("ImageCropMode"),this.oKa=!1,b=new Te.GraphTransaction(4),b.Eb(this.xjd.node),this.PBe.setValue(Gd.a.Yva,this.oKa),b.dispose(),this.ogd&&(this.v1.ZO(this.cAa,this.yjd),this.ogd=!1),this.$d&&this.$d.sc(db.a.CF,
pc.InteractiveViewManager.instance.editingView.editingElement,this.Pwa),this.cAa=this.Iza=null):u.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):u.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}xzj(b,h,t,A,O,aa,ua){if(t){t=Math.max(this.vV-h,0);const Ra=Math.floor(this.PV)-this.sV-t;5<=Ra?(this.mS=t,this.jS=this.sV):5>Ra&&0<=Ra||0>Ra&&!this.sV?(this.mS=t-(5-Ra),
this.jS=this.sV):0>Ra&&5>=Math.abs(Ra)?(this.mS=Math.floor(this.PV)-this.sV,this.jS=Math.max(this.sV-(t-(this.PV-this.sV))-(5-Math.abs(Ra)),0)):(this.mS=Math.floor(this.PV)-this.sV,this.jS=Math.max(this.sV-(t-(this.PV-this.sV)),0));this.LJ.style.top=this.mS+"px";this.LJ.style.bottom=this.jS+"px";ua&&(this.vV=this.mS,this.sV=this.jS)}A&&(h=Math.max(this.sV-h,0),A=Math.floor(this.PV)-this.vV-h,5<=A?(this.jS=h,this.mS=this.vV):5>A&&0<=A||0>A&&!this.vV?(this.jS=h-(5-A),this.mS=this.vV):0>A&&5>=Math.abs(A)?
(this.jS=Math.floor(this.PV)-this.vV,this.mS=Math.max(this.vV-(h-(this.PV-this.vV))-(5-Math.abs(A)),0)):(this.jS=Math.floor(this.PV)-this.vV,this.mS=Math.max(this.vV-(h-(this.PV-this.vV)),0)),this.LJ.style.top=this.mS+"px",this.LJ.style.bottom=this.jS+"px",ua&&(this.vV=this.mS,this.sV=this.jS));O&&(O=Math.max(this.tV-b,0),h=Math.floor(this.QV)-this.uV-O,5<=h?(this.kS=O,this.lS=this.uV):5>h&&0<=h||0>h&&!this.uV?(this.kS=O-(5-h),this.lS=this.uV):0>h&&5>=Math.abs(h)?(this.kS=Math.floor(this.QV)-this.uV,
this.lS=Math.max(this.uV-(O-(this.QV-this.uV))-(5-Math.abs(h)),0)):(this.kS=Math.floor(this.QV)-this.uV,this.lS=Math.max(this.uV-(O-(this.QV-this.uV)),0)),this.LJ.style.left=this.kS+"px",this.LJ.style.right=this.lS+"px",ua&&(this.tV=this.kS,this.uV=this.lS));aa&&(b=Math.max(this.uV-b,0),aa=Math.floor(this.QV)-this.tV-b,5<=aa?(this.lS=b,this.kS=this.tV):5>aa&&0<=aa||0>aa&&!this.tV?(this.lS=b-(5-aa),this.kS=this.tV):0>aa&&5>=Math.abs(aa)?(this.lS=Math.floor(this.QV)-this.tV,this.kS=Math.max(this.tV-
(b-(this.QV-this.tV))-(5-Math.abs(aa)),0)):(this.lS=Math.floor(this.QV)-this.tV,this.kS=Math.max(this.tV-(b-(this.QV-this.tV)),0)),this.LJ.style.left=this.kS+"px",this.LJ.style.right=this.lS+"px",ua&&(this.tV=this.kS,this.uV=this.lS));ua&&(this.efd=!0,Jb.App.ya.updateCommandUI())}uMk(){this.mS=this.vV;this.jS=this.sV;this.kS=this.tV;this.lS=this.uV;this.LJ.style.top=this.mS+"px";this.LJ.style.bottom=this.jS+"px";this.LJ.style.left=this.kS+"px";this.LJ.style.right=this.lS+"px"}bWk(){if(this.efd){u.ULS.sendTraceTag(22381066,
322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.vV/this.PV),h=Math.floor(1E5*this.sV/this.PV),t=Math.floor(1E5*this.tV/this.QV),A=Math.floor(1E5*this.uV/this.QV),O=new ji.DictionaryPropertySet;O.setValue(Gd.a.Uhb,b);O.setValue(Gd.a.Rhb,h);O.setValue(Gd.a.Shb,t);O.setValue(Gd.a.Thb,A);this.ga.Nf(this.xjd,Vc.a.Yki,2,!1,null,O)}else u.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}Yva(){return this.oKa}lLl(){return{top:this.mS,bottom:this.jS,left:this.kS,
right:this.lS}}yOo(b,h){if(0>b)u.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.vV=this.mS=Math.min(Math.floor(this.PV)-this.jS-5,b);this.LJ.style.top=this.mS+"px";break;case 1:this.sV=this.jS=Math.min(Math.floor(this.PV)-this.mS-5,b);this.LJ.style.bottom=this.jS+"px";break;case 2:this.tV=this.kS=Math.min(Math.floor(this.QV)-this.lS-5,b);this.LJ.style.left=this.kS+"px";break;case 3:this.uV=this.lS=Math.min(Math.floor(this.QV)-this.kS-
5,b),this.LJ.style.right=this.lS+"px"}this.efd=!0}}}Object(m.a)(Ku,"ImageEditor",Ci,[471,472]);class Ut{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}yc(b){this.W=b;this.W.ha("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new qg(v.AFrameworkApplication.xa,Sa.a.instance.Sa("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").singleInstance();this.W.ha("WordEditor.ImageEditors.ImageEditor",()=>new Ku(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Sa("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),sb.KeyInputManager.instance,b.Sa("WordEditor.IImageCropDragAdapterFactory"),b.Ma("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").singleInstance()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){P.a.instance.Gc(new Ut)}}
Object(m.a)(Ut,"WordEditorImageEditorsPackage",null,[1,2]);class Lp{}Object(m.a)(Lp,"FolderContentEditor",null,[1551]);class Pl{}Object(m.a)(Pl,"PageEditor",null,[1474]);var fm=c(169);class At extends Pl{constructor(){super()}get eh(){return fm.PageNavigator.instance}}Object(m.a)(At,"PageEditor",Pl,[]);class $o{get name(){return"WordEditor.NotebookLevelEditors"}yc(b){b.ha("Box4.NotebookLevelEditors.FolderContentEditor",()=>new Lp).as("Box4.Folder.IFolderContentEditor").singleInstance();b.ha("WordEditor.NotebookLevelEditors.PageEditor",
()=>new At).as("Box4.Pages.IPageEditor").singleInstance()}init(){}dispose(){}static main(){P.a.instance.Gc(new $o)}}Object(m.a)($o,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class dt{get JKb(){return v.AFrameworkApplication.privacyUrl}xta(){u.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");ff.a.km(this.JKb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(m.a)(dt,"PrivacyLinkHandler",null,[828]);class Jm{constructor(b,h){this.IJe=null;this.Ebk=
b;this.Dbk=h}showDialog(b){this.IJe=b;this.Dbk.create().Yh(Object(z.a)(this,this.zem,"handleDialog"))}zem(b){1===b&&this.Ebk.Vcj();this.IJe();this.IJe.prototype}}Object(m.a)(Jm,"SendUsYourFileController",null,[806]);class zs extends cf.StandardDialog{constructor(b,h,t){super();this.WWb=null;this.hg=b;this.hyc=h;this.KG=t}Yh(b){this.zd=1;this.Ge(1,this.KG.send);this.Ge(0,this.KG.yan);u.ULS.shipAssertTag(37034013,342,!this.WWb,"privacy anchor should be null before initializing it.");const h=this.dialogContent();
this.pkb(this.KG.hwk,null,"CancelRequest_32x32x32",null,b,h);this.s4(this.kj(zs.adj))}dialogContent(){const b=document.createElement("span");b.innerText=this.KG.UAn;const h=document.createElement("span");h.innerText=this.KG.KAo;h.style.fontWeight=this.KG.MTo;const t=document.createElement("span");t.innerText=this.KG.F8n;const A=this.fYk(),O=document.createElement("span");O.id=this.kj(zs.adj);O.appendChild(b);O.appendChild(document.createElement("br"));O.appendChild(document.createElement("br"));O.appendChild(h);
O.appendChild(document.createElement("br"));O.appendChild(t);O.appendChild(document.createElement("br"));O.appendChild(document.createElement("br"));O.appendChild(document.createElement("br"));O.appendChild(A);return O}fYk(){const b=document.createElement("span"),h=document.createElement("a");h.innerText=this.KG.CAn;h.href=this.hyc.JKb||"";b.appendChild(h);this.WWb=h;this.hg.mb(db.a.click,this.WWb,Object(z.a)(this.hyc,this.hyc.xta,"clickHandler"));return b}dispose(){this.WWb&&(this.hg.sc(db.a.click,
this.WWb,Object(z.a)(this.hyc,this.hyc.xta,"clickHandler")),this.WWb=null);super.dispose()}}zs.adj="sendUsYourFileId";Object(m.a)(zs,"SendUsYourFileDialog",cf.StandardDialog,[827]);class Lu{create(){return Sa.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(m.a)(Lu,"Factory",null,[826]);var ou=c(595);class gs extends ou.a{constructor(){super();this.FileId=null}Cl(){return 38}static construct(b){const h=new gs;h.FileId=b;return h}}Object(m.a)(gs,"CreateSendUsYourFileRequest",
ou.a,[]);var Mk=c(989);class As{constructor(b,h,t){this.l5=b;this.dS=h;this.u4j=t}Vcj(b=!1){if(this.dS){const h=gs.construct(this.dS()),t=new Mk.a;t.Jr=h;t.status=1;t.FH="BootErrorReport";b=b?this.l5(null):this.l5(A=>{this.K3c(t,A)});b.pI(t);b.jT();this.u4j()}}K3c(b){5===b.statusCode&&this.Vcj(!0)}}Object(m.a)(As,"SendUsYourFileManager",null,[805]);class et{constructor(b,h){this.W=null;this.KG=b;this.dS=h}yc(b){this.W=b;this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.KG).singleInstance();
this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new zs(Pd.a.instance,new dt,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new As(h=>this.Ifa(0,h),this.dS,()=>{u.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new Lu;return new Jm(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),
h)}).singleInstance()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(m.a)(et,"SendUsYourFilePackageManager",null,[]);var jh=c(542),gm=c(1022),en;(function(b){b[b.none=0]="none";b[b.oneNote=1]="oneNote";b[b.word=2]="word";b[b.wordViewer=3]="wordViewer";b[b.powerPoint=4]="powerPoint"})(en||(en={}));Object(m.b)("AppMode",en);class wl{get hwk(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get yan(){return CommonUIStrings.l_NoThanks}get UAn(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get KAo(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get MTo(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get F8n(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get CAn(){return CommonUIStrings.l_PrivacyStatement}}
Object(m.a)(wl,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class Lo extends et{constructor(){super(new wl,()=>v.AFrameworkApplication.rootQuerySignature)}Ifa(b,h){return new gm.a(b,h,"SendUsYourFile.ashx",en.word,Jb.App.webServiceBase,jh.a.amIAlone,jh.a.M3c,jh.a.w3c)}get name(){return"WordEditor.SendUsYourFile"}static main(){P.a.instance.Gc(new Lo)}}Object(m.a)(Lo,"PackageManager",et,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var ok=c(564),Di=c(659),rm=c(1822),Oj=c(130),Gh=c(30),yn=c(173),Fl=c(84),xl=c(950),Mh=c(165),ko=c(996);class Br{constructor(b,h,t,A,O,aa){this.xZh=b;this.gallerySectionId=h;this.hrl=t;this.tuk=A;this.commandId=O;this.queryCommandId=aa}}Object(m.a)(Br,"BorderStyleMenuPropsArguments",null,[]);class nr{constructor(b,h,t,A,O,aa,ua){this.C0b=b;this.Rpj=h;this.width=t;this.xLi=A;this.height=O;this.wBi=aa;this.altText=ua}}Object(m.a)(nr,"TableBorderStyleProperties",null,[]);class tg{constructor(){this.Cth=
[new nr(tg.znj,"","2",1,8,0,"Solid Line"),new nr(tg.RKh,"5,3","1",1,8,0,"Dashed Line"),new nr(tg.WPh,"1,1","1",1,8,0,"Dotted Line"),new nr(tg.YPh,"","1",2,8,3,"Double Line")];this.Dth=[new nr(tg.Kth,"","1",1,8,0,"0.25pt"),new nr(tg.Hth,"","1",1,8,0,"0.5pt"),new nr(tg.Nth,"","2",1,8,0,"0.75pt"),new nr(tg.Ith,"","2",1,8,0,"1pt"),new nr(tg.Gth,"","3",1,8,0,"1.5pt"),new nr(tg.Oth,"","4",1,8,0,"2.25pt"),new nr(tg.Mth,"","4",1,8,0,"3pt"),new nr(tg.Fth,"","5",1,8,0,"4.5pt"),new nr(tg.Lth,"","6",1,8,0,"6pt")]}initialize(){this.n1f()}YBl(){const b=
new Br("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.Cth,qa.a.ynb,qa.a.q_f);return this.YZh(b)}ZBl(){const b=new Br("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.Dth,qa.a.znb,qa.a.r_f);return this.YZh(b)}R0h(b){switch(b){case tg.znj:return Mh.a.D0b;case tg.RKh:return Mh.a.pdb;case tg.WPh:return Mh.a.YDc;case tg.YPh:return Mh.a.D2;default:return Mh.a.pta}}S0h(b){switch(b){case tg.Kth:return Mh.a.Jth;case tg.Hth:return Mh.a.J1e;case tg.Nth:return Mh.a.A0b;
case tg.Ith:return Mh.a.odb;case tg.Gth:return Mh.a.jla;case tg.Oth:return Mh.a.WBa;case tg.Mth:return Mh.a.Iea;case tg.Fth:return Mh.a.EYa;case tg.Lth:return Mh.a.VBa;default:return Mh.a.FF}}YZh(b){const h=new gj.a,t=new eh.a,A=Object.assign(new Di.a,{Id:b.xZh,ExternalId:b.gallerySectionId,ExternalGalleryId:b.hrl,Type:4,Width:1,GalleryItems:[]});for(const aa of b.tuk){var O={};const ua={};ua.width=tg.uRm;ua.height=tg.tRm;O.root=ua;O=Object.assign(new rm.a,{Id:aa.C0b,ExternalId:String.format("{0}_GalleryButton",
aa.C0b),Icon:aa.C0b,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:aa.C0b,FullIconStyle:O,ShouldSetTitle:"true",Alt:aa.altText});A.GalleryItems.push(O)}t.ControlList=[];h.MenuSectionList=[];t.ControlList.push(A);h.MenuSectionList.push(t);h.UpdateDynamically=!0;return h}n1f(){const b={};for(const h of this.Cth)b[h.C0b]=appChrome.buildBorderStyleIcon(h.Rpj,h.width,h.xLi,h.height,h.wBi);for(const h of this.Dth)b[h.C0b]=appChrome.buildBorderStyleIcon(h.Rpj,h.width,
h.xLi,h.height,h.wBi);appChrome.api.registerIconProvider(()=>b)}d$n(b,h,t){if(!b)return u.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==mc.a.L4)return u.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.n0(Oj.a.oQ(b),b.node,5,t,h);break;case 0:this.n0(Oj.a.oQ(b),b.node,3,t,h);break;case 1:this.n0(Oj.a.oQ(b),b.node,4,t,h);break;case 3:this.n0(Oj.a.oQ(b),
b.node,0,t,h);break;case 7:this.n0(Oj.a.oQ(b),b.node,1,t,h);break;case 8:this.n0(Oj.a.oQ(b),b.node,2,t,h);break;case 6:this.n0(Oj.a.oQ(b),b.node,1,t,h);this.n0(Oj.a.oQ(b),b.node,2,t,h);break;case 5:this.n0(Oj.a.oQ(b),b.node,3,t,h);this.n0(Oj.a.oQ(b),b.node,5,t,h);this.n0(Oj.a.oQ(b),b.node,4,t,h);this.n0(Oj.a.oQ(b),b.node,0,t,h);break;case 4:this.n0(Oj.a.oQ(b),b.node,3,t,h),this.n0(Oj.a.oQ(b),b.node,5,t,h),this.n0(Oj.a.oQ(b),b.node,4,t,h),this.n0(Oj.a.oQ(b),b.node,0,t,h),this.n0(Oj.a.oQ(b),b.node,
1,t,h),this.n0(Oj.a.oQ(b),b.node,2,t,h)}return!0}U7f(b,h,t,A){if(!h)return u.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==mc.a.t0)return u.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",h.contextId),!1;var O=h.node;const aa=new ue.GraphIterator;aa.set(O);aa.Ab(14);O=Gh.TableCellReader.kOa(aa);switch(h.border){case 2:this.rSa(b,h.node,5,A,t,O);this.dfe(h.node,5,t);this.aee(b,h.T_a(),3,t,A,O);
break;case 0:this.rSa(b,h.node,3,A,t,O);this.dfe(h.node,3,t);this.aee(b,h.T_a(),1,t,A,O);break;case 1:this.rSa(b,h.node,4,A,t,O);this.dfe(h.node,4,t);this.aee(b,h.T_a(),0,t,A,O);break;case 3:this.rSa(b,h.node,0,A,t,O),this.dfe(h.node,0,t),this.aee(b,h.T_a(),2,t,A,O)}return!0}IFn(b,h){if(nf.SelectionEditor.EUc(b)&&h)switch(b=Object(Da.a)(yn.TableNodeBorderContext,b),b.border){case 2:this.jO(b.node,tg.Co.gM(5),h);break;case 0:this.jO(b.node,tg.Co.gM(3),h);break;case 3:this.jO(b.node,tg.Co.gM(0),h);
break;case 1:this.jO(b.node,tg.Co.gM(4),h);break;case 7:this.jO(b.node,tg.Co.gM(1),h);break;case 8:this.jO(b.node,tg.Co.gM(2),h);break;case 5:h=this.jO(b.node,tg.Co.gM(5),h);h=this.jO(b.node,tg.Co.gM(3),h);h=this.jO(b.node,tg.Co.gM(0),h);this.jO(b.node,tg.Co.gM(4),h);break;case 6:h=this.jO(b.node,tg.Co.gM(1),h);this.jO(b.node,tg.Co.gM(2),h);break;case 4:h=this.jO(b.node,tg.Co.gM(5),h),h=this.jO(b.node,tg.Co.gM(3),h),h=this.jO(b.node,tg.Co.gM(0),h),h=this.jO(b.node,tg.Co.gM(4),h),h=this.jO(b.node,
tg.Co.gM(1),h),this.jO(b.node,tg.Co.gM(2),h)}}gEn(b,h){if(nf.SelectionEditor.FUc(b)&&h)switch(b=Object(Da.a)(yn.TableNodeBorderContext,b),b.border){case 2:this.jO(b.node,tg.Co.cO(5),h);break;case 0:this.jO(b.node,tg.Co.cO(3),h);break;case 3:this.jO(b.node,tg.Co.cO(0),h);break;case 1:this.jO(b.node,tg.Co.cO(4),h)}}xlf(b,h,t){t=null;if(!b)return u.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),t;b.properties.hasProperty(h.size)&&(t=new ko.a,t.weight=b.properties.ia(h.size,Mh.a.FF),t.style=
b.properties.ia(h.style,Mh.a.pta),t.color=b.properties.ia(h.color,0));return t}T7f(b,h,t){b?t?(b.properties.setValue(h.size,t.weight),b.properties.setValue(h.style,t.style),b.properties.setValue(h.color,t.color)):u.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):u.ULS.sendTraceTag(575980877,306,15,"Node should not be null")}MLb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),b.properties.removeProperty(h.color)):u.ULS.sendTraceTag(575980879,
306,15,"Node should not be null")}n0(b,h,t,A,O){O=this.yRo(b,h,t,A,O);this.xhc(h,tg.Co.gM(t),O);switch(t){case 5:this.PRa(h,2,A,O);break;case 4:this.PRa(h,1,A,O);break;case 0:this.PRa(h,3,A,O);break;case 3:this.PRa(h,0,A,O);break;case 1:this.PRa(h,7,A,O);break;case 2:this.PRa(h,8,A,O)}}yRo(b,h,t,A,O){if(3!==A){var aa=tg.qg.uNd(b,h,t,3);void 0!==aa&&null!==aa&&aa!==Mh.a.zZ&&(aa=Fl.a.Egc(aa),O.color=tg.lkc.WMa(h,aa))}1!==A&&(aa=tg.qg.uNd(b,h,t,1),void 0!==aa&&null!==aa&&aa!==Mh.a.EF&&(O.weight=parseFloat(aa)*
Mh.a.B0b));2!==A&&(b=tg.qg.uNd(b,h,t,2),void 0!==b&&null!==b&&b!==Mh.a.EF&&(O.style=b));return O}rSa(b,h,t,A,O,aa){A&&(O=this.hMo(b,h,aa,t,A,O));this.xhc(h,tg.Co.cO(t),O)}hMo(b,h,t,A,O,aa){if(3!==O){var ua="",Ra=tg.qg.cDb(b,h,A,!1,!0,t,3);Ra&&(ua=Ra.Uyb);void 0!==ua&&null!==ua&&ua!==Mh.a.zZ&&(ua=Fl.a.Egc(ua),aa.color=tg.lkc.WMa(h,ua))}if(1!==O){ua="";if(Ra=tg.qg.cDb(b,h,A,!1,!0,t,1))ua=Ra.Uyb;void 0!==ua&&null!==ua&&ua!==Mh.a.EF&&(aa.weight=parseFloat(ua)*Mh.a.B0b)}if(2!==O){O="";if(b=tg.qg.cDb(b,
h,A,!1,!0,t,2))O=b.Uyb;void 0!==O&&null!==O&&O!==Mh.a.EF&&(aa.style=O)}return aa}Q8m(b){let h=0,t=0;({r8m:h,W5m:t}=this.pWl(b.style,h,t));b.weight<h&&(b.weight=h);b.weight>t&&(b.weight=t);return b}pWl(b,h,t){switch(b){case Mh.a.D0b:case Mh.a.pdb:case Mh.a.YDc:h=2;t=48;break;case Mh.a.D2:h=2;t=24;break;default:h=2,t=48}return{r8m:h,W5m:t}}aee(b,h,t,A,O,aa){if(h)if(A)for(let ua=0;ua<h.length;ua++)switch(t){case 2:this.rSa(b,h[ua],5,O,A,aa);break;case 0:this.rSa(b,h[ua],3,O,A,aa);break;case 1:this.rSa(b,
h[ua],4,O,A,aa);break;case 3:this.rSa(b,h[ua],0,O,A,aa)}else u.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else u.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}dfe(b,h,t){const A=new ue.GraphIterator;A.set(b);A.Ab(14);const O=Gh.TableCellReader.Yma(b);b=Gh.TableCellReader.dO(b);Wh.forEachCell(A,O,b,(aa,ua,Ra)=>{aa=aa.currentNode;Gh.TableCellReader.Er(aa)&&0==Ra&&0<ua&&this.xhc(aa,tg.Co.cO(h),t)})}xhc(b,h,t){b?(t=this.Q8m(t),b.properties.setValue(h.color,
t.color),b.properties.setValue(h.size,t.weight),b.properties.setValue(h.style,t.style)):u.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}PRa(b,h,t,A){if(b){var O=ni.TableReader.ag(b),aa=ni.TableReader.Xg(b),ua=new ue.GraphIterator,Ra=[];for(let ub=0;ub<O;ub++)for(let Nb=0;Nb<aa;Nb++)if(ua.set(b),Wh.moveToCell(ua,ub,Nb),ua&&ua.currentNode&&!Gh.TableCellReader.gg(ua))switch(h){case 2:Gh.TableCellReader.tga(ua)&&Ra.push(yn.TableNodeBorderContext.i7(ua.currentNode,2));break;case 0:Gh.TableCellReader.uga(ua)&&
Ra.push(yn.TableNodeBorderContext.i7(ua.currentNode,0));break;case 3:Gh.TableCellReader.GBf(b,ua.currentNode)&&Ra.push(yn.TableNodeBorderContext.i7(ua.currentNode,3));break;case 1:Gh.TableCellReader.HBf(b,ua.currentNode)&&Ra.push(yn.TableNodeBorderContext.i7(ua.currentNode,1));break;case 7:Gh.TableCellReader.HBf(b,ua.currentNode)||Ra.push(yn.TableNodeBorderContext.i7(ua.currentNode,1));break;case 8:Gh.TableCellReader.GBf(b,ua.currentNode)||Ra.push(yn.TableNodeBorderContext.i7(ua.currentNode,3))}for(b=
0;b<Ra.length;b++)switch(h=Ra[b],h.border){case 2:this.z2c(h.node,tg.Co.cO(5),t,A);this.cbe(h.T_a(),tg.Co.cO(0),t,A);break;case 0:this.z2c(h.node,tg.Co.cO(3),t,A);this.cbe(h.T_a(),tg.Co.cO(4),t,A);break;case 1:this.z2c(h.node,tg.Co.cO(4),t,A);this.cbe(h.T_a(),tg.Co.cO(3),t,A);break;case 3:this.z2c(h.node,tg.Co.cO(0),t,A),this.cbe(h.T_a(),tg.Co.cO(5),t,A)}}else u.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}cbe(b,h,t,A){if(b)for(let O=0;O<b.length;O++)this.z2c(b[O],h,t,A);else u.ULS.sendTraceTag(578062292,
306,15,"Adjacent cell array should not be null")}z2c(b,h,t,A){if(b){var O=b.ia(h.color,tg.Oaf),aa=b.ia(h.size,tg.Qaf),ua=b.ia(h.style,tg.Paf),Ra=new ko.a;Ra.weight=A.weight;Ra.style=A.style;Ra.color=A.color;2!==t||O===tg.Oaf&&aa===tg.Qaf?3!==t||ua===tg.Paf&&aa===tg.Qaf?1!==t||O===tg.Oaf&&ua===tg.Paf?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Ra.color=O,Ra.style=ua,this.xhc(b,h,Ra)):(Ra.style=ua,Ra.weight=aa,this.xhc(b,h,Ra)):(Ra.color=
O,Ra.weight=aa,this.xhc(b,h,Ra))}else u.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}jO(b,h,t){var A=b.properties.ia(h.style,Mh.a.EF);A!==Mh.a.EF&&(t.lineStyle!==Mh.a.EF?t.lineStyle!==A&&(t.lineStyle=Mh.a.KEk):t.lineStyle=A);A=b.properties.ia(h.size,Mh.a.FF);A!==Mh.a.FF&&(t.dWc!==Mh.a.FF?t.dWc!==A&&(t.dWc=Mh.a.CEk):t.dWc=A);b=b.properties.ia(h.color,0);b=Fl.a.wI(b);b!==Mh.a.zZ&&(t.borderColor!==Mh.a.zZ?t.borderColor!==b&&(t.borderColor=Mh.a.uEk):t.borderColor=b);return t}static get Co(){return null!=
tg.Rsg?tg.Rsg:tg.Rsg=Mh.a.instance}static get qg(){return null!=tg.LGg?tg.LGg:tg.LGg=Sa.a.instance.Ma("WordEditor.IWACTableStyleReader")}static get lkc(){return null!=tg.vEg?tg.vEg:tg.vEg=xl.a.instance}}tg.uRm="110px";tg.tRm="20px";tg.znj="SolidLineStyle";tg.RKh="DashedLineStyle";tg.WPh="DottedLineStyle";tg.YPh="DoubleLineStyle";tg.Kth="BorderPointSizeOneQuarter";tg.Hth="BorderPointSizeOneHalf";tg.Nth="BorderPointSizeThreeQuarters";tg.Ith="BorderPointSizeOne";tg.Gth="BorderPointSizeOneAndHalf";tg.Oth=
"BorderPointSizeTwoAndQuarter";tg.Mth="BorderPointSizeThree";tg.Fth="BorderPointSizeFourAndHalf";tg.Lth="BorderPointSizeSix";tg.Paf="single";tg.Qaf=4;tg.Oaf=0;Object(m.a)(tg,"TableBorderManager",null,[476]);var Vp=c(850),vp=c(58),Wp=c(201);class Rq{constructor(b,h){this.E9g=this.l4g=null;this.MMa=b;this.L6g=h}get fTi(){return this.L6g}get yoa(){return this.l4g}get N0f(){return this.E9g}tgj(b,h){this.E9g=b;this.l4g=h}deo(b){this.L6g=b}}Object(m.a)(Rq,"CellNodeAndOutlineElementInfoForInsertion",null,
[]);var Xk=c(104),Cr=c(202),or=c(392),Ps=c(164),Aq=c(266),Bt=c(602),Gv=c(88),pr=c(507),Nw=c(1039);class fj extends Vp.a{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb=null,bc=null){super(b,h,t,bc,Yb);this.V8a=Nw.a.instance;this.ra=new If.a;this.b4e=[Lc.a.Ijc,Lc.a.xob,Lc.a.GOb,Lc.a.Gjc,Lc.a.vob,Lc.a.EOb,Lc.a.Fjc,Lc.a.uob,Lc.a.DOb,Lc.a.Hjc,Lc.a.wob,Lc.a.FOb];this.URj=[Lc.a.va,Lc.a.ua,Af.a.Sh,Af.a.tq];this.Nh=A;this.Swb=O;this.Xc=aa;this.ib=ua;this.K5=Ra;this.Qm=ub;this.qsc=Nb;this.Ifh=Yb;this.Wfk=bc;this.VCn=
this.YYf.bind(this)}get Hi(){return this.Nh.value}get Gs(){return this.K5?this.K5.instance:null}pYe(b){this.ra.addHandler("OnParagraphDelete",b)}get kh(){return!!this.qsc.instance&&this.qsc.instance.kh}vRc(b,h,t,A,O){h.setValue(Lc.a.Lc,Nf.a.aF());h.setValue(Lc.a.vzm,O);Bt.b(A,h,[Lc.a.v0]);super.vRc(b,h,t,A,O)}LUd(b,h,t,A,O){const aa=this.jPc(h,t,A,O);this.JEd(aa,h,!1);return super.LUd(b,h,t,A,O)}Cxd(b,h,t,A,O){const aa=this.jPc(h,t,A,O);this.JEd(aa,h,!0);super.Cxd(b,h,t,A,O);return aa}q8e(b,h,t,A){h=
this.jPc(b,h,t,A);this.JEd(h,b,!0);return h}insertRows(b,h,t,A){const O=vp.a.Wr(b),aa=new ue.GraphIterator;aa.$c(b);const ua=aa.currentNode;aa.Tb(1);let Ra;Ra=h?b.wD(1):b.currentNode;const ub=b.wc();if(!ub)throw Error.create("table row insertion cannot be performed on a null tableNode");const Nb=ni.TableReader.ag(ub),Yb=ub.$S.qg;let bc=!1;try{ub.Lxa=1;const Dc=this.V8a.tgb(ub,Yb.LE(ub));this.zSa(b.currentNode);this.qqa(b);this.Bmk(t,b,Ra,aa,ua,h,A);const Pc=this.V8a.tgb(ub,Yb.LE(ub));this.Q5a(ub,
ni.TableReader.ag(ub)+t);bc=!0;this.sVd(ub,Dc,Pc)}finally{ub.Lxa=0,bc||this.Q5a(ub,ni.TableReader.ag(ub)+t)}O+1!==Nb||h?!O&&h&&fj.Dyf(ub,t):fj.Dyf(ub,O);h=O+t+(h?0:1);h<Nb+t&&this.mpi(ub,h);return b.currentNode}Bmk(b,h,t,A,O,aa,ua){let Ra=null,ub=null;for(var Nb=0;Nb<b;++Nb){var Yb=Wp.a.instance.createInstance(393251);ub||(ub=Yb);Ra=Yb;this.vRc(h,Yb,t,O,aa)}b=ni.TableReader.Xg(h.currentNode);t=!0;do{t?(h.Fi(Ra),t=!1):h.wf(1);O=Array(b);for(Nb=0;Nb<b;++Nb){Yb=this.nNa();const bc=this.q8e(Yb,A.currentNode,
aa,!0);let Dc=null;bc.gg||(Dc=ua(bc));O[Nb]=new Rq(Yb,Dc);O[Nb].tgj(bc,null);A.wf(1)}for(Nb=0;Nb<b;++Nb)Yb=O[Nb].MMa,h.q2(Yb,1,Vp.a.cKa?Vp.a.cKa():null),Gh.TableCellReader.Er(Yb)||(this.tyb(h,Yb,O[Nb].fTi),this.KFh(O[Nb].N0f,Yb,!0));A.ega(1)}while(h.currentNode!==ub)}insertColumns(b,h,t,A,O){let aa=b.currentNode,ua=!1,Ra=ni.TableReader.Xg(b.currentNode);const ub=Ra;try{this.zSa(b.currentNode);this.qqa(b);const Nb=aa.$S.qg;aa.Lxa=1;const Yb=this.V8a.tgb(aa,Nb.LE(aa));Ra=ni.TableReader.Xg(b.currentNode);
-1===h&&(h=Ra);this.zmk(b,A,t,h,O);aa=b.currentNode;Ra+=A;this.i0f(b,Ra,A,h);ua=!0;const bc=this.V8a.tgb(aa,Nb.LE(aa));this.sVd(aa,Yb,bc)}finally{aa.Lxa=0,ua||this.i0f(b,Ra,A,h)}h!==ub||t?!h&&t&&fj.Cyf(aa,A):fj.Cyf(aa,h-1)}zmk(b,h,t,A,O){var aa=b.currentNode;A=t?A:A-1;b.Tb(1);var ua=new Mb.a;do{var Ra=b.gG(A,1);b.wc();var ub=Array(h);for(let Yb=0;Yb<h;++Yb){var Nb=this.nNa();const bc=this.fYl(b,Ra,t),Dc=this.q8e(Nb,Ra,t,!1);Nb=new Rq(Nb,null);Nb.tgj(Dc,bc);ub[Yb]=Nb}ua.add(ub)}while(b.Ti(1));t=ua.toArray();
for(A=0;A<t.length;A++)for(ua=0;ua<h;ua++)Ra=t[A][ua],ub=Ra.N0f,ub.gg||Ra.deo(O(ub));b.set(aa);b.Tb(1);O=0;do{for(aa=0;aa<h;++aa)A=t[O][aa],ua=A.MMa,b.wFb(ua,A.yoa,1,Vp.a.cKa?Vp.a.cKa():null),Gh.TableCellReader.Er(ua)||(this.tyb(b,ua,A.fTi),this.KFh(A.N0f,ua,!1));O++}while(b.Ti(1))}sVd(b,h,t){if(h){var A=2===b.Lxa,O=[],aa=new ue.GraphIterator;aa.set(b);for(var ua=aa.Tb(1);ua;){for(ua=aa.Tb(1);ua;){const Ra=ua.id.toString();Ra in h&&h[Ra]===t[Ra]&&(!A||!Gh.TableCellReader.uga(aa)&&!Gh.TableCellReader.tga(aa))||
O.push(ua);ua=aa.Ti(1)}ua=aa.Ti(1)}if(0<O.length){h=new Te.GraphTransaction(3);try{h.set(b.Wi);for(const Ra of O)Ra.Eyf()}finally{h&&h.dispose()}}}}deleteRows(b,h){const t=vp.a.Wr(b),A=t+h;let O=b.wc();const aa=O.$S.qg;let ua=!1;u.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",O.id.toString(),O.type,t,h);const Ra=ni.TableReader.ag(O);try{O.Lxa=2;const ub=this.V8a.tgb(O,aa.LE(O));this.zSa(b.currentNode);
this.qqa(b);for(let Yb=A-1;Yb>=t;--Yb){b.gG(Yb,1);let bc=b.Tb(1);for(;bc;)this.PYc(bc,!0),bc=b.Ti(1);this.$0a(b);u.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.Xe);b.Dg()}O=b.currentNode;const Nb=this.V8a.tgb(O,aa.LE(O));this.Q5a(O,ni.TableReader.ag(O)-h);this.Q4d(b);ua=!0;this.sVd(O,ub,Nb)}finally{O.Lxa=0,ua||(this.Q5a(b.currentNode,ni.TableReader.ag(b.currentNode)-h),this.Q4d(b))}Ra===A&&0<=t-1&&fj.Dyf(O,t-1);t<Ra-h&&this.mpi(O,t)}deleteColumns(b,
h,t){b=Object(Da.a)(ue.GraphIterator,b);let A=Object(Da.a)(pr.a,b.currentNode),O=ni.TableReader.Xg(b.currentNode);const aa=A.$S.qg;let ua=!1;u.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",A.id.toString(),A.type,h,t);const Ra=O;try{A.Lxa=2;const ub=this.V8a.tgb(A,aa.LE(A));this.zSa(b.currentNode);this.qqa(b);-1===h&&(h=O-t);b.Tb(1);do for(let Yb=h+t-1;Yb>=h;--Yb)b.gG(Yb,1),this.PYc(b.currentNode,
!1),this.$0a(b),b.Dg();while(b.Ti(1));O-=t;this.h0f(b,O,h,t);ua=!0;A=Object(Da.a)(pr.a,b.currentNode);const Nb=this.V8a.tgb(A,aa.LE(A));this.sVd(A,ub,Nb);this.P4d(b)}finally{A&&(A.Lxa=0),ua||(this.h0f(b,O,h,t),this.P4d(b))}Ra===h+t&&0<=h-1&&fj.Cyf(A,h-1)}mergeCells(b,h,t){if(b&&(1!==h||1!==t)){var A=new ue.GraphIterator;A.$c(b);A.Ab(14);this.K9e(A,h,t);this.PLo(A,h,t);A.wc();A.wc();this.WOi(A)}}boj(b,h,t){if(b&&(1!==h||1!==t)){var A=new ue.GraphIterator;A.$c(b);A.Ab(14);this.J7k(A,h,t);A.wc();A.wc();
this.oRi(A)}}PYc(b,h){u.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.qem(b,h,this.VCn)}YYf(b,h){const t=b.currentNode;t.gg=!1;this.JEd(h.currentNode,b.currentNode,!0);t.removeProperty(Lc.a.skippedCell);t.removeProperty(Lc.a.renderCell);1===t.colSpan&&1===t.rowSpan&&t.iFc();Vp.a.XJ.I6(b,!0,Vp.a.M9h(h.currentNode));Wh.returnToCell(b);this.q0k(h,b)}duf(b,h,t){super.duf(b,h,t);1===h.controlCell.colSpan&&1===h.controlCell.rowSpan?h.controlCell.iFc():
!t&&h.Rce&&(b.OOa?1<b.colSpan&&(h=new ue.GraphIterator,h.set(b),h.Ab(15),Wh.moveToNextColumn(h),h.currentNode.colSpan=b.colSpan-1):(t=new ue.GraphIterator,t.set(h.controlCell),t.Ab(15),h=Gv.a(t),t=new ue.GraphIterator,t.set(b),t.Ab(15),Wh.moveToColumnByIndex(t,h),--t.currentNode.colSpan))}jPc(b,h,t,A){const O=super.jPc(b,h,t,A);if(b.gg&&!A){var aa=h.Dwa;aa.Rce&&(A=Vp.a.Z5b(aa.controlCell,A),!aa.$Cd&&t||aa.$Cd===A-1&&!t?b.colSpan=1:(t=new ue.GraphIterator,t.set(aa.controlCell),t.Ab(15),aa=Gv.a(t),
t=new ue.GraphIterator,t.set(h),t.Ab(15),Wh.moveToColumnByIndex(t,aa),t.currentNode.colSpan+=1))}O.ia(Lc.a.skippedCell,!1)&&(b.gg=!0,b.F3=!0,b.Qnb=!0);return O}Q4d(b){this.HPb(b,Lc.a.complexTable)}P4d(b){this.HPb(b,Lc.a.complexTable)}WOi(b){this.HPb(b,Lc.a.complexTable)}oRi(b){this.HPb(b,Lc.a.complexTable)}q0k(b,h){if(b&&h){let t;b=ue.GraphIterator.$a(b.currentNode);ip.OutlineNavigator.B8(b)&&(b.Tb(2),b=b.currentNode,12==b.type&&(t=b.Lf(Af.a.Sh)));t&&(b=new ue.GraphIterator,b.$c(h),ip.OutlineNavigator.B8(b)&&
b.Tb(2)&&(h=b.currentNode,12==h.type&&h.Yg(Af.a.Sh,t)))}}JEd(b,h,t){b&&(Bt.b(b,h,this.b4e),Bt.b(b,h,[Af.a.eH]),t&&Bt.b(b,h,[Lc.a.TO,Lc.a.qR,Lc.a.DHa,Lc.a.BHa,Lc.a.aqa,Lc.a.skippedCell,Lc.a.renderCell]))}KFh(b,h,t){b&&(b=ue.GraphIterator.$a(b),b.yd(),b.Sd(),h=ue.GraphIterator.$a(h),h.yd(),h.Sd(),mb.OutlineElementReader.Lh(b)&&wg.OutlineElementNavigator.Fe(b)&&mb.OutlineElementReader.Lh(h)&&wg.OutlineElementNavigator.Fe(h)&&Bt.b(b.currentNode,h.currentNode,this.URj),t&&(wg.OutlineElementNavigator.Zd(b),
wg.OutlineElementNavigator.Zd(h),hb.ListItemReader.Kh(b)&&(t=fj.fSm.Fw(b),t.vB=Xk.a.vl,{Mva:t}=fj.Qn.cla(t.propertySet,h,t))))}$0a(b){this.kh&&this.Qm.BRn(b.currentNode);for(b=Cr.a.Tp(b);b.moveNext();)if(qe.ParagraphReader.Yb(b.currentNode)){const h=zc.e(b.currentNode);for(const t of h)t.gha();this.ra.raiseEvent("OnParagraphDelete",b.currentNode)}else hb.ListItemReader.Kh(b.iterator)&&this.Gs&&this.Gs.Oha(b.iterator)}LD(b,h){let t=null;if(this.Ifh.Cg){const A=Object(Da.a)(pr.a,b);A&&(t=A.eR())}ni.TableReader.Mm(b)&&
(1===h?h=3:3===h&&(h=1));super.LD(b,h);this.Ifh.Cg&&this.Wfk.iia(b,t);Object(hc.a)(pr.a,b)&&Vp.a.Hh.ghj(Object(Da.a)(pr.a,b),(new or.a(1,0)).wt)}b9f(b,h){const t=Array(h),A=this.Ddi(b)/h;for(let O=0;O<h;O++)t[O]=Math.max(Hc.a.Tl(Ps.a.Ica,0),A);b.setValue(Af.a.lz,t)}Xfj(b){b.setValue(Lc.a.tableLayout,0)}Jnh(b,h,t,A,O){const aa=Array(t);for(var ua=0,Ra=0;ua<A;++ua)aa[ua]=h[ua],Ra+=aa[ua];for(;ua<t;++ua)aa[ua]=0>ua-O?h[0]:h[ua-O],Ra+=aa[ua];ua=this.Ddi(b.currentNode);if(Ra>ua)for(Ra=ua/Ra,ua=0;ua<t;++ua)aa[ua]=
Math.max(Hc.a.Tl(Ps.a.Ica,0),aa[ua]*Ra);return aa}Ddi(b){var h=ue.GraphIterator.$a(b);b=Hc.a.Tl(Hc.a.Ki(ni.TableReader.qdi(h),0),0);if(h.Ab(16))return Wh.returnToCell(h),h=Ps.a.Dkc(h.currentNode),Hc.a.Tl(Hc.a.Ki(h,0),0)-b;h=Aq.a.b9c(h);return Hc.a.Tl(Hc.a.Ki(h,0),0)-b}dO(b,h,t){const A=new ue.GraphIterator;A.set(b);Wh.moveToCell(A,h,t);return A.currentNode.ia(Lc.a.colSpan,1)}Ehc(b){var h=Jb.App.ya.jb.ju;if(h.re&&(h=b.Ee(h.jc))){var t=!1,A=ni.TableReader.Xg(b),O=b.ia(Af.a.lz,Array(A));for(var aa of O)if(!aa){t=
!0;break}if(t){O=gl.a.clone(O);aa=b.ia(Lc.a.complexTable,!1);u.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",A,O,aa);t=1;var ua=0;for(let ub=0;ub<A;)if(aa&&(t=this.dO(b,0,ub)),1<t){for(var Ra=0;Ra<t;Ra++)O[ub]||(O[ub]=this.p8h(0)),ub++;ua+=t-1}else(Ra=h.kLl(ub-ua))||u.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",ub,ua),O[ub]||(O[ub]=this.p8h(Ra)),ub++;b.setValue(Af.a.lz,O)}}}p8h(b){return Hc.a.Tl(Math.max(b,
Ps.a.Ica),0)}zSa(b){b=ue.GraphIterator.$a(b);this.Ehc(b.currentNode);b.Ab(14)&&(Wh.returnToContainingTable(b),this.Ehc(b.currentNode))}dhj(b,h){h&&b.setValue(Lc.a.v9,h)}E9f(b,h){h&&b.setValue(Lc.a.Ejc,h)}sAh(b,h){const t=ni.TableReader.Xg(b);Vp.a.OQk(b,h,t)}eao(b,h,t){let A;if(!({tableNode:A}=this.Bac(b)).returnValue)return!1;if(h&&t&&h.length===t.length){if(!this.Vhl(A,h))return!1;for(let O=0;O<h.length;++O){const aa=this.Swb.o5c(b,h[O],t[O]);if(aa)return u.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
aa),!1}this.U2d(A);return!0}return!1}Hwk(b,h){let t;if(!({tableNode:t}=this.Bac(b)).returnValue||ni.TableReader.kB(t))return!1;var A=Object(Da.a)(ue.GraphIterator,this.Xc.Wf(t));Wh.moveToLastRow(A);var O=ni.TableReader.ag(t);if(h&&0<h.length){this.insertRows(A,!1,h.length,()=>null);A=ni.TableReader.ag(t);var aa=this.Xc.Wf(t);O=this.ldi(aa,O,A-1);for(A=0;A<O.length;++A){aa=O[A];const ua=h[A];for(let Ra=0;Ra<aa.length;++Ra){let ub;if(ub=ua&&ua[Ra]?this.Swb.o5c(b,aa[Ra],ua[Ra].toString()):this.Swb.o5c(b,
aa[Ra],""))return u.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",ub),!1}}}this.U2d(t);return!0}pwk(b,h){let t;if(!({tableNode:t}=this.Bac(b)).returnValue||ni.TableReader.kB(t))return!1;var A=this.Xc.Wf(t),O=ni.TableReader.Xg(t);if(h&&0<h.length){this.insertColumns(Object(Da.a)(ue.GraphIterator,A),O,!1,h[1].length,()=>null);var aa=ni.TableReader.Xg(t);A=this.H7l(A,O,aa-1);for(O=0;O<A.length;++O){aa=h[O];const ua=A[O];for(let Ra=
0;Ra<ua.length;++Ra){let ub;if(ub=aa&&aa[Ra]?this.Swb.o5c(b,ua[Ra],aa[Ra].toString()):this.Swb.o5c(b,ua[Ra],""))return u.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",ub),!1}}}this.U2d(t);return!0}Hbl(b){let h;if(!({tableNode:h}=this.Bac(b)).returnValue)return!1;let t=this.p0a(h);const A=ni.TableReader.ag(h);var O=this.Xc.Wf(h);O=this.ldi(O,t,A-1);for(let aa=0;aa<O.length;++aa){const ua=O[aa];for(let Ra=0;Ra<ua.length;++Ra){const ub=
this.Swb.s3i(b,ua[Ra]);if(ub)return u.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",ub),!1}}t=t?t:1;b=this.Xc.Wf(h);b.fG(t)&&15===b.Xe&&this.deleteRows(Object(Da.a)(ue.GraphIterator,b),A-t);this.U2d(h);return!0}p0a(b){let h=0;const t=this.Xc.Wf(b);let A=t.Sd();for(;A&&A.ia(Lc.a.rjb,!1);)h++,A=t.gt();return!h&&Tf.StyleReader.bTa.DT(b)&32?1:h}PLo(b,h,t){var A,O;const aa=b.currentNode,ua=new ue.GraphIterator;ua.$c(b);let Ra=null,ub=
null,Nb=null;const Yb=Mh.a.instance.cO(3),bc=Mh.a.instance.cO(4),Dc=Mh.a.instance.cO(5),Pc=Mh.a.instance.cO(0);Wh.forEachCell(ua,h,t,(jd,Cd,ee)=>{jd=jd.currentNode;Cd||ee||(Ra=fj.kz.xlf(jd,Yb,Ra));Cd||ee!==t-1||(ub=fj.kz.xlf(jd,bc,ub));0<Cd&&!ee&&(Ra?fj.kz.T7f(jd,Yb,Ra):fj.kz.MLb(jd,Yb),ub?fj.kz.T7f(jd,bc,ub):fj.kz.MLb(jd,bc),fj.kz.MLb(jd,Dc),Cd!==h-1&&fj.kz.MLb(jd,Pc));ee||Cd!==h-1||(Nb=fj.kz.xlf(jd,Pc,Nb))});b=null===(O=null===(A=null===Jb.App||void 0===Jb.App?void 0:Jb.App.ya)||void 0===A?void 0:
A.jb)||void 0===O?void 0:O.ju;ub?(A=yn.TableNodeBorderContext.i7(aa,1),fj.kz.U7f(Oj.a.lp(b),A,ub,0)):fj.kz.MLb(aa,bc);A=yn.TableNodeBorderContext.i7(aa,0);if(Ra)fj.kz.U7f(Oj.a.lp(b),A,Ra,0);else for(A=Object(Da.a)(yn.TableNodeBorderContext,A).T_a(),O=0;O<A.length;O++)fj.kz.MLb(A[O],bc);Nb?fj.kz.T7f(aa,Pc,Nb):fj.kz.MLb(aa,Pc)}Vhl(b,h){for(let A=0;A<h.length;++A){var t=this.Xc.Wf(h[A]);if(t.Ab(14)&&(t=t.fd(14),b.id===t.id))continue;return!1}return!0}Bac(b){let h=null;if(b&&b.Zt.toString()!==b.Vy.toString())return{returnValue:!1,
tableNode:h};h=this.Hi.Db(b.Zt);return 14===h.type&&this.Swb.Bac(b)?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:h}}ldi(b,h,t){const A=[];Wh.forEachCellInTable(Object(Da.a)(ue.GraphIterator,b),(O,aa,ua)=>{if(aa>=h&&aa<=t)ua||A.push([]),Gh.TableCellReader.gg(O)||Array.add(A[aa-h],O.currentNode);else if(aa>t)return!1;return!0});return A}H7l(b,h,t){const A=[];Wh.forEachCellInTable(Object(Da.a)(ue.GraphIterator,b),(O,aa,ua)=>{ua>=h&&ua<=t&&(ua===h&&A.push([]),Gh.TableCellReader.gg(O)||Array.add(A[aa],
O.currentNode));return!0});return A}U2d(b){if(b&&14===b.type){b=Object(Da.a)(ue.GraphIterator,this.Xc.Wf(b));const h=new Mb.a;qe.ParagraphReader.Vgb(b,!0,!1,h);b=wf.SelectionFactory.te(h.J(h.count-1),0);this.ib.setSelection(b)}}static get kz(){fj.Csa||(fj.Csa=Sa.a.instance.Ma("WordEditor.ITableBorderManager"));return fj.Csa}static get fSm(){return null!=fj.tAg?fj.tAg:fj.tAg=Sa.a.instance.resolve("Box4.List.IListReader")}static get Qn(){return null!=fj.nAg?fj.nAg:fj.nAg=Sa.a.instance.resolve("Box4.List.IListEditor")}mpi(b,
h){const t=new ue.GraphIterator;t.set(b);Wh.moveToFirstRow(t);Wh.moveToRowByIndex(t,h);do t.currentNode.Wk(4,!0);while(Wh.moveToNextRow(t))}static Dyf(b,h){if(b){var t=ni.TableReader.ag(b),A=ni.TableReader.Xg(b);if(!(!Jb.App.ya.jb.ju.re||0>h||h>=t))for(t=new ue.GraphIterator,t.set(b),b=0;b<A;b++){b?Wh.moveToNextColumn(t):Wh.moveToCell(t,h,b);if(!t||!t.currentNode||16!==t.currentNode.type)continue;let O=t.currentNode;Gh.TableCellReader.Er(O)&&(O=Gh.TableCellReader.Bfa(O));O&&O.Wk(4,!0)}}else u.ULS.sendTraceTag(577868247,
306,15,"Can not invalidate row when there is no table node")}static Cyf(b,h){if(b){var t=ni.TableReader.ag(b),A=ni.TableReader.Xg(b),O=new ue.GraphIterator;if(!(!Jb.App.ya.jb.ju.re||0>h||h>=A))for(A=0;A<t;A++){O.set(b);Wh.moveToCell(O,A,h);if(!O||!O.currentNode)continue;let aa=O.currentNode;Gh.TableCellReader.Er(aa)&&(aa=Gh.TableCellReader.Bfa(aa));aa&&aa.Wk(4,!0)}}else u.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}fj.Csa=null;Object(m.a)(fj,"TableEditor",
Vp.a,[474,475]);class gw{get name(){return"WordEditor.TableEditors"}yc(b){v.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&(b.ha("WordEditor.TableEditors.TableEditor",()=>new fj(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new Pg.a(()=>Jb.App.ya.jb.Wc.ud),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new ok.a,he.a.instance,b.Sa("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),
b.Sa("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").singleInstance(),b.ha("WordEditor.TableEditors.TableBorderManager",()=>new tg).as("WordEditor.ITableBorderManager").singleInstance())}init(){}dispose(){}static main(){P.a.instance.Gc(new gw)}}Object(m.a)(gw,"WordEditorTableEditorsPackage",null,[1,2]);class Ow{get name(){return"WordEditor.TextLevelEditors"}yc(){}init(){}dispose(){}static main(){P.a.instance.Gc(new Ow)}}
Object(m.a)(Ow,"WordEditorTextLevelEditorsPackage",null,[1,2]);var Oz=c(1927);c(444);var Pz=c(772),Hv=c(229),Iv=c(263);class Qs{constructor(b){this.j8j=b}a6k(){const b=Wp.a.instance.createInstance(393228);b.setValue(Af.a.SK,Hv.a.first);b.setValue(Af.a.fth,0);b.setValue(Af.a.xba,mj.OutlineReader.HLh);(new Pz.OutlineIndentInfo(!0)).yaj(b);return b}I6(b,h,t=null){const A=b.currentNode;if(!b.ME(1))return this.hib(b,null,h,t);mb.OutlineElementReader.HK(b)&&wg.OutlineElementNavigator.rLf(b,!0);return mb.OutlineElementReader.Lh(b)?
Qs.vg.uC(b,!1,h,t):(b.T3c(A),null)}FLk(b){return mj.OutlineReader.yCf(b.currentNode)||mb.OutlineElementReader.Lh(b)||mb.OutlineElementReader.HK(b)||Gh.TableCellReader.isTableCell(b)}hib(b,h=null,t=!1,A=null){if(!this.FLk(b))return null;const O=Qs.vg.pAb();this.vfo(O,b);b.wFb(O,h,1,null);b.Fi(O);t&&(Qs.vg.UL(b,A),wg.OutlineElementNavigator.Zd(b));return O}vfo(b,h){if(h=this.S3l(h))switch(h.type){case 11:Qs.vg.cef(h,b,!0);break;case 8:h=Qs.lf.isRtl(h),Qs.vg.kNb(b,h)}}S3l(b){return this.j8j.T3l(b)}jNb(b,
h){b.setValue(Af.a.tq,h?11:9)}mao(b,h){const t=Iv.WordSectionNavigator.instance.gJ(b);return t?mj.OutlineReader.eX(b)!==h?(t.setValue(Lc.a.Zaf,h),!0):!1:null}static get lf(){return Lk.PageReader.instance}static get vg(){return Qs.Hh||(Qs.Hh=Sa.a.instance.resolve("Box4.IOutlineElementEditor"))}static set vg(b){Qs.Hh=b}}Qs.Hh=null;Qs.ue=null;Object(m.a)(Qs,"OutlineEditor",null,[514]);const Ct=b=>{b.ha("Box4.OutlineLevelEditors.OutlineEditor",()=>new Qs(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").singleInstance();
b.ha("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new Oz.a(b.We("Box4.IOutlineEditor"),b.We("Box4.List.IListEditor"),b.We("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"),b.Sa("Common.ISystemInitiatedFeedback"))).as("Box4.IOutlineElementEditor").singleInstance()};
class Mu{get name(){return"Box4.OutlineLevelEditors"}yc(b){Ct(b)}init(){}dispose(){}static main(){P.a.instance.Gc(new Mu)}}Object(m.a)(Mu,"Box4OutlineLevelEditorsPackage",null,[1,2]);class Vt{constructor(b){this.jGd=null;this.QLi=b.kb("OfficeOnlineChromeExtensionId");this.YLi=b.kb("ChromeClipboardAccessExtensionId");this.Cym=b.$("OfficeOnlineChromeExtensionIsEnabled");this.cch=!this.CGm();this.jGd=this.ANb?this.YLi:this.QLi}GZn(){this.jGd===this.QLi&&this.wui&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),
localStorage.removeItem("IsCopyPasteSupported"));this.jGd=this.YLi;this.cch=!0}get ANb(){return this.cch}CGm(){if(this.Cym&&this.wui){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get wui(){let b=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){u.ULS.sendTraceTag(19452045,
307,50,h.toString())}return b}}Object(m.a)(Vt,"ChromeExtensionHelper",null,[966]);var Em=c(1434),Pw=c(520),Nu=c(1389);class Dt{create(b){return new Nu.a(b)}}Object(m.a)(Dt,"Factory",null,[603]);var Qo=c(154);class hv{constructor(b,h,t){this.Mgk=b;this.ve=h;this.HXa=t}Ub(){this.HXa.gb(qa.a.U8d,mc.a.application,this.U8d.bind(this),96);this.HXa.pa(qa.a.slc,mc.a.view,this.pRo.bind(this));this.HXa.gb(qa.a.p_i,mc.a.view,this.rRo.bind(this),96)}U8d(b,h,t,A,O){if(1===t)return 32;b=Object.assign(new gj.a,
{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];t=Object.assign(new eh.a,{ControlList:[]});t.ControlList.push(Object.assign(new Eh.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));h.push(t);Array.addRange(b.MenuSectionList,h);O.MenuItems=b;return 32}rRo(b,h,t,A,O){if(1===t)return 32;b=ck.a.Xpj();null==b&&8;b=this.ve.CK(b);O[Ck.a.LabelText]=String.format(F.a.Af(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}pRo(b,h,t){b=ck.a.WGb(h);if(1===
t||b)return b?8:32;t=new Map;t.set("Source","StyleContextMenuActor");t.set("Action","UpdateStyle");wa.Health.instance.recordKpiUsage(Qo.a.Tya,0,Qo.a.dB,t);this.Mgk.uRo(h)?Jc.b(539842578,3018,50,"User Successfully Updated styles from UI"):(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new Hb.a,{extendedProperties:h}),wa.Health.instance.recordKpiFailure(Qo.a.Tya,"UpdateStyleFailed",!1,!0,h),Jc.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));
return 32}}Object(m.a)(hv,"StyleContextMenuActor",null,[]);var Jv=c(1024),my=c(1501),Ex=c(480),Ur=c(1743);class tk extends Ur.a{constructor(b,h,t,A,O,aa,ua=null,Ra=null){super(b,aa,ua,Ra);this._formatting=null;this.XJa=!1;this.psb=v.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.Aub=0;this.IAc=new Mb.a;Jc.a(8128527,307,mb.OutlineElementReader.Lh(b));this.GL=h;this.GL.s0b(this);this.Xp=t;this.Qn=A;this.Ad=O;this.d2e=Ra;this.rLe=hb.ListItemReader.Kh(this.Fc)}get paragraphEditor(){return null!=
this.TBg?this.TBg:this.TBg=Sa.a.instance.resolve("Box4.IParagraphEditor")}get bGd(){return null}get t2b(){return this.rLe&&!this.GL.QCa}get KAb(){return 0<this.Aub}Qba(b,h){if(!this.e1.vhg(this.Fc,h,!0)){Jc.a(8701077,307,qe.ParagraphReader.rh(this.Fc));var t=this.Fc.currentNode,A=pf.a.Bw(t);this.psb&&this._formatting.kQ&&(t=t.qa.last,this.XJa&&(t.formatting=this._formatting.kQ.Sf(t),this.XJa=!1),b=this.e1.nuf(b,h),this.e1.fHa(this.Fc.currentNode,this._formatting.Xba,h));this.characterPropertiesEditor.replaceTextRange(A,
b)}}UFa(){Jc.a(8701078,307,qe.ParagraphReader.rh(this.Fc));const b=pf.a.Bw(this.Fc.currentNode);this.characterPropertiesEditor.jga(b,h=>new Ex.a(h))}nlb(){this.e1.uuf(this.Fc)}PFa(){this.psb&&(this.XJa=!0)}RQa(){Jc.a(8701079,307,qe.ParagraphReader.rh(this.Fc))}QQa(){Jc.a(8701080,307,qe.ParagraphReader.rh(this.Fc))}nG(b){this.GL.QCa||(this.psb?(this.VZe(b),this._formatting.Kke(this.Fc.currentNode),b&&"P"===b.H8.NTd&&this.d2e.vca(this.Fc.currentNode,this._formatting.bR),this.e1.fHa(this.Fc.currentNode,
this._formatting.Xba,b)):this.RCk(b))}mG(){this.GL.QCa||this.yJc()}XQa(){}Y3a(){}XFa(){Jc.a(8701081,307,mb.OutlineElementReader.Lh(this.Fc)||mj.OutlineReader.Kw(this.Fc)||qe.ParagraphReader.rh(this.Fc)&&this.GL.QCa);let b=!1;this.KAb||(b=this.t2b||!0);b||(this.xU+=1);this.Aub++}VFa(){this.Aub--;let b=!1;this.KAb||(b=this.t2b||!0,this.Qn.G4i(this.IAc));b||--this.xU}WQa(b){Jc.a(8701082,307,mb.OutlineElementReader.Lh(this.Fc)||mj.OutlineReader.Kw(this.Fc)||qe.ParagraphReader.rh(this.Fc)&&this.GL.QCa);
Jc.a(8701083,307,!!b.listStyleType)}WFa(){Jc.a(8701084,307,mb.OutlineElementReader.Lh(this.Fc)||qe.ParagraphReader.rh(this.Fc)&&this.GL.QCa);this.GL.QCa||Jc.a(8701085,307,this.Fc.Xr(2))}Pba(b){this.GL.Pba(b)}Mba(){this.GL.Mba()}vke(b){this.IAc.add(b)}Oba(b){this.GL.Oba(b)}Nba(){this.GL.Nba()}Lba(b){this.GL.Lba(b)}Kba(){this.GL.Kba()}RCk(b){this.Kcc(!1);(new ue.GraphIterator).$c(this.Fc);b=Ur.a.vg.UL(this.Fc,this.ENc(b));Jc.a(8128534,307,b===this.Fc.currentNode);Jc.a(8128535,307,qe.ParagraphReader.Yb(b))}yJc(){Jc.a(8128536,
307,qe.ParagraphReader.rh(this.Fc));wg.OutlineElementNavigator.Zd(this.Fc)}reset(){this.psb&&(super.reset(),this._formatting=this.Xmf(!0))}VZe(b){this.Kcc(!1);(new ue.GraphIterator).$c(this.Fc);b=Ur.a.vg.UL(this.Fc,this.ENc(b));Jc.a(36577367,307,b===this.Fc.currentNode);Jc.a(36577368,307,qe.ParagraphReader.Yb(b));-1!==this._formatting.Xv&&this.paragraphEditor.LD(b,this._formatting.Xv);this._formatting.lineSpacing&&this.d2e.KC(b,this._formatting.lineSpacing);this._formatting.F4&&this.d2e.rfe(b,this._formatting.F4);
this.XJa=!0;this._formatting.paragraph=b}static l8e(b,h){let t=0;switch(h){case 3:t=Ad.a.wv(b);break;case 7:t=Hc.a.ny(b,0);break;case 1:t=Ad.a.j4e(b);break;case 5:t=Ad.a.wv(Ad.a.BWf(b));break;default:u.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return t}}Object(m.a)(tk,"TextOnlyBox4PasteSteward",Ur.a,[]);class wp{constructor(b,h,t,A){this.K6g=b;this.zL=h;this.If=t;this.e1=A}create(b,h,t,A,O=null,aa=null,ua=null){return 1===
b?new tk(h,A,this.K6g,this.zL,this.If,O,aa,this.e1):new my.Box4PasteSteward(h,t,A,this.K6g,this.zL,this.If,O,aa,this.e1,ua)}}Object(m.a)(wp,"Box4PasteStewardFactory",null,[602]);var Uk=c(197),Bq=c(401),Gl=c(1559);class qr{constructor(b,h,t){this.yy=null;this.Bub=0;this.vL=null;this.Fc=b;this.tk=t}s0b(b){this.yy=b}get QCa(){return 0<this.Bub}Pba(b){var h;Jc.a(7869459,307,!!this.yy);Jc.a(7869460,307,mb.OutlineElementReader.Lh(this.Fc)||mj.OutlineReader.Kw(this.Fc));Jc.b(38563978,307,50,"Table pasting started");
this.yy.Kcc(!0);const t=new ue.GraphIterator;t.$c(this.Fc);let A=Gl.a.Qlm[b.styleId];A||(v.AFrameworkApplication.ye("gdea6103;0df65435"),(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))?(u.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),A=Gl.a.Ran):A=Gl.a.RLh);h=this.tk.uMn(this.Fc,b.rowCount,b.Tdb,A,b.tableLook,this.yy.ENc(b),b.xqi);b.peg&&(Jc.b(573691298,3022,100,"Applying table border properties"),
Gl.a.Nph(b.peg,this.Fc,!1,!0));b.xUd&&(Jc.b(573691299,3022,100,"Applying indentation properties"),Gl.a.Axk(this.Fc,b.xUd.spaceBefore,b.xUd.spaceAfter));b.aDd&&(Jc.b(573691328,3022,100,"Applying column widths"),Gl.a.jxk(b.aDd,this.Fc,Object(Da.a)(Bq.TableNode,h),b.z2a));this.yy.zzd(t,!1);this.Bub++;hb.ListItemReader.Kh(t)&&this.yy.vke(t.currentNode);Jc.a(7869461,307,ni.TableReader.isTable(this.Fc))}Mba(){Jc.a(7869462,307,!!this.yy);Jc.a(7869463,307,vp.a.isTableRow(this.Fc));Jc.b(38563979,307,50,"Table pasting finished");
this.hU&&this.Fc.rt(14)&&Gl.a.Daj(this.Fc.Kn);wg.OutlineElementNavigator.Zd(this.Fc);this.Bub--}Oba(b){Jc.a(7869464,307,!!this.yy);Jc.b(573691329,3022,100,"Table row pasting started");ni.TableReader.isTable(this.Fc)?Wh.moveToFirstRow(this.Fc):vp.a.isTableRow(this.Fc)&&Wh.moveToNextRow(this.Fc);b.height&&(Jc.b(573691330,3022,100,"Applying table row height"),Gl.a.pyk(this.Fc,b.height));Jc.a(7869465,307,vp.a.isTableRow(this.Fc))}Nba(){Jc.a(7869466,307,!!this.yy);Jc.a(7869467,307,Gh.TableCellReader.isTableCell(this.Fc));
Wh.returnToContainingRow(this.Fc)}Lba(b){Jc.a(7869468,307,!!this.yy);Jc.a(7869469,307,!this.yy.xU);vp.a.isTableRow(this.Fc)?Wh.moveToFirstColumn(this.Fc):Gh.TableCellReader.isTableCell(this.Fc)?Wh.moveToNextColumn(this.Fc):Jc.a(7869471,307,!1);if(this.Fc.currentNode){Jc.b(573691331,3022,100,"Table cell pasting started");var h=Object(Da.a)(Uk.TableCellNode,this.Fc.currentNode);Jc.a(50689760,307,!h&&16!==this.Fc.currentNode.type||!!h&&16===this.Fc.currentNode.type);if(h){var t=new ue.GraphIterator;
t.$c(this.Fc);if(b.wac)Jc.b(573691332,3022,100,"Processing skipped cell"),Gl.a.sCn(t,b);else{if(1<b.colSpan||1<b.rowSpan){const A=Wh.returnToContainingTable(t);if(!A)return;A.setValue(Lc.a.complexTable,!0);t.$c(this.Fc);Jc.b(573691333,3022,100,"Processing merged cell");Gl.a.LBn(t,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}Gl.a.vyk(this.Fc,b.shadingColor);Gl.a.kzk(this.Fc,b.verticalAlignment);Gl.a.Ywk(this.Fc,b.Wie);Gl.a.Nph(b.wia,this.Fc,!b.colSpan&&!b.rowSpan,!1);(new ue.GraphIterator).$c(this.Fc);
Wh.forEachCell(t,b.rowSpan,b.colSpan,(A,O,aa)=>{Jc.b(573691334,3022,100,"Setting ghost cell borders");Gl.a.afj(A,b.wia,O,aa,b.rowSpan,b.colSpan)});Gl.a.mzk(this.Fc,b.width,b.z2a);Jc.a(7869472,307,mj.OutlineReader.Kw(this.Fc))}}}}Kba(){Jc.a(7869473,307,!!this.yy);Jc.a(7869474,307,mb.OutlineElementReader.Lh(this.Fc)||Gh.TableCellReader.isTableCell(this.Fc));Wh.returnToCell(this.Fc);Jc.a(7869475,307,0>=this.yy.xU);this.yy.i5e()}get hU(){null==this.vL&&(v.AFrameworkApplication.ye("he991617;3eed2178"),
this.vL=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.vL}}Object(m.a)(qr,"Box4TableSteward",null,[626,467]);class Dr{constructor(b,h,t){this.yy=null;this.Bub=0;this.Fc=b;this.tk=t}s0b(b){this.yy=b}get QCa(){return 0<this.Bub}Pba(){this.QCa&&(Jc.a(8787101,307,qe.ParagraphReader.rh(this.Fc)),wg.OutlineElementNavigator.Zd(this.Fc));Jc.a(8701086,307,!!this.yy);Jc.a(8701087,307,mb.OutlineElementReader.Lh(this.Fc)||
mj.OutlineReader.Kw(this.Fc));this.Bub++}Mba(){Jc.a(8701088,307,!!this.yy);wg.OutlineElementNavigator.Zd(this.Fc);this.Bub--;if(this.QCa){this.yy.Kcc(!0);const b=Dr.vg.UL(this.Fc);Jc.a(8787102,307,b===this.Fc.currentNode);Jc.a(8787103,307,qe.ParagraphReader.rh(this.Fc))}}Oba(b){Jc.a(8701089,307,!!this.yy);this.yy.Kcc(!0);const h=new ue.GraphIterator;h.$c(this.Fc);this.yy.zzd(h,!1);hb.ListItemReader.Kh(h)&&this.yy.vke(h.currentNode);b=Dr.vg.UL(this.Fc,this.yy.ENc(b));Jc.a(8701090,307,b===this.Fc.currentNode);
Jc.a(8701091,307,qe.ParagraphReader.rh(this.Fc))}Nba(){Jc.a(8701120,307,!!this.yy);Jc.a(8701121,307,qe.ParagraphReader.rh(this.Fc));wg.OutlineElementNavigator.Zd(this.Fc)}Lba(){Jc.a(8701122,307,!!this.yy);Jc.a(8701123,307,qe.ParagraphReader.rh(this.Fc));Jc.a(8701124,307,!this.yy.xU);var b=this.Fc.currentNode;qe.ParagraphReader.textLength(b)&&(b=pf.a.Bw(b),this.yy.characterPropertiesEditor.replaceTextRange(b,", "))}Kba(){Jc.a(8701125,307,!!this.yy);Jc.a(8701126,307,qe.ParagraphReader.rh(this.Fc));
Jc.a(8701127,307,0>=this.yy.xU);this.yy.i5e()}static get vg(){return null!=Dr.hBg?Dr.hBg:Dr.hBg=Sa.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(m.a)(Dr,"TextOnlyBox4TableSteward",null,[626,467]);class Wt{constructor(b,h,t=!1,A=!1){this.zL=b;this.Iz=h;this.P8j=t;this.X8j=A}create(b,h){return 1===b?new Dr(h,this.zL,this.Iz):new qr(h,this.zL,this.Iz,this.P8j,this.X8j)}}Object(m.a)(Wt,"Box4TableStewardFactory",null,[601]);class Et{create(){return new Xm.a}}Object(m.a)(Et,"Factory",null,[600]);
class Wy{constructor(b){this.ga=b}h9m(b){if(4===b)b=qa.a.qFa;else if(2===b)b=qa.a.Sha;else if(1===b)b=qa.a.APb;else if(3===b)b=qa.a.j_a;else return;this.ga.processAction(b,2)}yfb(){this.ga.processAction(qa.a.yfb,2)}}Object(m.a)(Wy,"SelectionCommands",null,[599]);var Er=c(268),rr=c(1095),Rs=c(151),Xy=c(651);class Xt{constructor(){this.cVc=!1;this.UVo=v.AFrameworkApplication.K.kb("WordEditorVisiFontFileUri");this.WVo=v.AFrameworkApplication.K.kb("WordEditorVisiRtlFontFileUri");this.VVo=v.AFrameworkApplication.K.kb("WordEditorVisiPilcrowFontFileUri");
this.RVo=v.AFrameworkApplication.K.kb("WordEditorVisiCarriageReturnFontFileUri");this.TVo=v.AFrameworkApplication.K.kb("WordEditorVisiCarriageReturnRtlFontFileUri")}uDo(){this.cVc=!this.cVc}tDo(b){this.uDo();let h=b.getElementsByClassName("VisiFontStyle")[0],t=b.getElementsByClassName("VisiFontRtlStyle")[0],A=b.getElementsByClassName("VisiFontPilcrowStyle")[0],O=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],aa=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),
h.className="VisiFontStyle",vc.a.uy(h,""),b.appendChild(h));t||(t=document.createElement("Style"),t.className="VisiFontRtlStyle",vc.a.uy(t,""),b.appendChild(t));A||(A=document.createElement("Style"),A.className="VisiFontPilcrowStyle",vc.a.uy(A,""),b.appendChild(A));O||(O=document.createElement("Style"),O.className="VisiFontCarriageReturnStyle",vc.a.uy(O,""),b.appendChild(O));aa||(aa=document.createElement("Style"),aa.className="VisiFontCarriageReturnRtlStyle",vc.a.uy(aa,""),b.appendChild(aa));if(this.cVc)return u.ULS.sendTraceTag(593294047,
324,50,"Formatting markers are inserted"),this.pDc(h)&&this.pDc(t)&&this.pDc(A)&&this.pDc(O)&&this.pDc(aa);u.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");return this.R2c(h)&&this.R2c(t)&&this.R2c(A)&&this.R2c(O)&&this.R2c(aa)}pDc(b){return""===vc.a.Zz(b)?("VisiFontStyle"===b.className?vc.a.uy(b,this.WMc("WordVisi_MSFontService",this.UVo)):"VisiFontRtlStyle"===b.className?vc.a.uy(b,this.WMc("WordVisiRtl_MSFontService",this.WVo)):"VisiFontPilcrowStyle"===b.className?vc.a.uy(b,
this.WMc("WordVisiPilcrow_MSFontService",this.VVo)):"VisiFontCarriageReturnStyle"===b.className?vc.a.uy(b,this.WMc("WordVisiCarriageReturn_MSFontService",this.RVo)):"VisiFontCarriageReturnRtlStyle"===b.className&&vc.a.uy(b,this.WMc("WordVisiCarriageReturnRtl_MSFontService",this.TVo)),!0):!1}R2c(b){return""!==vc.a.Zz(b)?(vc.a.uy(b,""),!0):!1}WMc(b,h){return"@font-face { font-family: "+b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(m.a)(Xt,"VisiMarkersOperation",
null,[597]);var Qw=c(487),hs=c(404);class Rw extends Qw.a{constructor(b,h){super(b,h);this.jCe=-1;this.nsb=0;this.aze=null;this.SVg=!1;this.nAe=[];this.ald=!1;this.T3g=!0;this.NJe=this.Sid=null;this.preventDismissOnScroll=this.l9d=this.gfc=!1;this.e7=null;this.Bvd=!1;this.FPc=!0;this.ys=!1;this.fYg=v.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");Rw.K9g||(v.AFrameworkApplication.xa.pa(ab.a.showFloatie,yc.a.frame,Kf.ActionManager.Kf),Rw.K9g=!0)}get uXh(){return this.EN}set uXh(b){this.EN=
b}get Qtj(){return this.Bvd}get LQc(){return this.SVg}set LQc(b){this.SVg=b;this.nsb=0}get DA(){return!0}get cssClass(){return v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.o8?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.ys}tSa(){for(let b of this.children)if(b.tSa())return!0;return!1}get a9(){return 9}Qf(b){this.nAe[this.nAe.length]=b;super.Qf(b)}rm(){super.rm();Za.c(this.Pc)&&this.kC();this.Pc=Rb.a.QRa(this.Pc);this.yW(this.Pc);this.dirty=!1}Adc(b){3===b.ig||
this.l9d||this.Dw(b);return!1}Ddc(){return!1}Bdc(b){3!==b.ig&&this.FPc&&!this.gfc&&this.MPo(b);return!1}Cdc(){return!1}ydc(b){3===b.ig&&this.Dw(b);return!1}zdc(b){void 0!==this.e7&&null!==this.e7||this.preventDismissOnScroll||this.Dw(b);return!1}zC(){this.xff();return!1}F5d(){this.LQc=!0}MPo(b){if(b=Nf.a.U3b(b.clientPoint,this.aze)){if(this.LQc){if(!this.nsb||b<this.nsb)this.nsb=b;b-=this.nsb}b-=this.jCe;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.Dw():ba.a.setOpacity(this.Pc,Math.max(h/255,0))}else this.LQc=
!1,this.nsb=0,ba.a.setOpacity(this.Pc,1)}gOo(b){let h=null;void 0!==this.Sid&&null!==this.Sid&&(h=this.Sid(b));b=null;for(const t of this.nAe){let A=!this.Qtj&&t.yyi;if(!A&&void 0!==h&&null!==h)for(let O=0;O<h.length;O++)if(t.id===h[O]){A=!0;break}t.Pc.style.display=A?"none":"";t.R3b=!A;A||(b=t)}b&&(b.R3b=!1)}e5h(){const b=this.Pc.style.top,h=this.Pc.style.left;this.Pc.style.top="0px";this.Pc.style.left="0px";const t=this.hDb();this.Pc.style.top=b;this.Pc.style.left=h;return t}hDb(){const b=this.Pc.style.visibility,
h=this.Pc.style.display;this.Pc.style.visibility="hidden";this.Pc.style.display="";const t=ff.a.getElementBounds(this.Pc);this.Pc.style.display=h;this.Pc.style.visibility=b;return t}d2i(b){3===b||this.qke?(Sys.UI.DomElement.addCssClass(this.Pc,hs.a.dPb),this.Bvd=!0):(Sys.UI.DomElement.removeCssClass(this.Pc,hs.a.dPb),this.Bvd=!1);this.gOo(b)}Z5a(b,h,t,A=!1){this.isVisible||(this.e7||!this.T3g&&this.preventDismissOnScroll||(this.T3g=!1,ff.a.r2d("ShowLegacyFloatie",""),v.AFrameworkApplication.xa.processAction(ab.a.showFloatie,
2)),this.d2i(t),this.FPc=!0,this.nsb=0,this.LQc=!1,!this.fYg||void 0!==this.e7&&null!==this.e7?(this.ald=!1,this.Gea(this,!1)):(this.ald=!0,this.QCk(this)),h=A?b:this.Uxn(b,h),this.Pc.style.top=h.y.toString()+"px",this.Pc.style.left=h.x.toString()+"px",this.Xt(),this.aze=this.hDb(),this.jCe=Nf.a.U3b(b,this.aze),ba.a.setOpacity(this.Pc,1),this.Pc.style.zIndex=String(v.AFrameworkApplication.ta.Vsa),this.Pc.style.display="",this.ys=!0)}Uxn(b,h){const t=this.Qtj?30:17,A=this.e5h(),O=vc.a.kEb(),aa=vc.a.mX();
b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=A.height:3===h?(b.y-=A.height,b.x-=A.width):2===h&&(b.x-=A.width);b.x+A.width>O&&(b.x=Math.floor(O-A.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-t:b.y+t;0>b.y&&(b.y=0);b.y+A.height>aa&&(b.y=aa-A.height);return b}Vxn(b,h){const t=b.CHi;if(t){this.d2i(h);var A=this.e5h();this.e7=b;b=t.dlg-t.mLc>A.width;var O=t.mLc+t.Qif>A.width,aa=t.q5b>A.height+17,ua=t.sDj-(t.q5b+t.Nif)>A.height+17;A=new Sys.UI.Point(t.mLc,t.q5b);O||b||(O=!0,A.x=t.dlg);b=t.Ojb?t.pGf?ua?O?2:0:
O?3:1:aa?O?3:1:O?2:0:t.pGf?ua?b?0:2:b?1:3:aa?b?1:3:b?0:2;if(3===b||2===b)A.x=t.mLc+t.Qif;if(2===b||0===b)A.y=t.q5b+t.Nif;this.Z5a(A,b,h);this.FPc=!1;h=this.e7.pWe.Pc;void 0!==h&&null!==h&&(h.style.zIndex=String(v.AFrameworkApplication.ta.Vsa))}}W2(){let b=super.W2();this.Dw()&&(b=!0);return b}Dw(b=null){if(!this.isVisible)return!1;void 0!==this.mCc&&null!==this.mCc&&this.mCc.hua(null);void 0!==this.e7&&null!==this.e7&&this.e7.I2();this.I2();this.fYg&&this.ald?this.Oml(this):this.zaa(this,!1);this.ald=
!1;this.jCe=-1;this.e7=null;this.Pc.style.display="none";this.ys=!1;this.NJe&&this.NJe(b);return!0}xff(){void 0!==this.e7&&null!==this.e7&&(this.e7.cYa=null,this.e7.I2(),this.e7=null,this.J2d.style.zIndex=String(v.AFrameworkApplication.ta.vBa),this.Pc.style.zIndex=String(v.AFrameworkApplication.ta.Vsa))}XOn(b){this.Sid=b}JPn(b){this.NJe=b}set DA(b){super.DA=b}}Rw.K9g=!1;Object(m.a)(Rw,"Floatie",Qw.a,[673,164,165]);class Fx{constructor(b,h){this.jv=this.UJa=null;this.UEi=b;this.D$i=h}get wXh(){return this.UJa}Qho(b){this.UJa=
b}hDb(){return this.jv.hDb()}r_(){return this.jv?this.jv.isVisible:!1}Qsh(b){this.Qho(b)}showFloatie(b,h){this.Z5a(h.location,h.ux,h.isRtl)}Z5a(b,h,t){t=t?this.D$i:this.UEi;this.ZId();this.jv&&this.jv.Z5a(b,t,h)}Dw(){this.jv&&this.jv.Dw()}ZId(){this.UJa&&!this.jv&&(this.jv=Object(Da.a)(Rw,this.UJa()))}OJd(){}}Object(m.a)(Fx,"AFloatieManager",null,[625]);class Gx extends Fx{constructor(){super(1,3);this.Zrj=!1;this.dNh=""}Z5a(b,h,t){t=t?this.D$i:this.UEi;this.ZId();this.jv&&(this.jv.isVisible&&this.jv.Dw(),
this.Zrj||this.jv.qm(),this.jv.Z5a(b,t,h,!0))}ZId(){this.wXh&&!this.jv&&(this.jv=this.UJa())}OJd(){if(this.jv&&this.jv.isVisible){const b=Object(Da.a)(Uj.Control,this.jv.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.Ew(b.Cgb(),1,null)}}y9f(b){this.dNh=b}jWn(b){b=b.Umf("Menu16",null);Rh.a("renderIcon")&&b&&appChrome.api.renderIcon(Gx.SUj,b.firstElementChild)}rlc(b,h,t){if(this.jv){const A=this.jv.controls[this.dNh];A&&(Gx.CXg||(this.jWn(A),Gx.CXg=!0),A.Od[Cb.a.labelText]=b,A.Od[Cb.a.alt]=h,t&&
A.behavior.qm())}}}Gx.CXg=!1;Gx.SUj="Designer_20";Object(m.a)(Gx,"PasteFloatieManager",Fx,[]);var sm=c(1032);class ug{constructor(){this.Md=null}get zw(){return null}getTitle(){return null}F3h(){return null}reset(b){this.Md=b.node}YHa(b){b=zc.d(this.Md,b);let h=null;if(!b||b.zh!==this.zh)return{returnValue:!1,xF:h};h=Object.assign(new sm.a,{rG:this.key,contentObject:b,title:this.getTitle(b),description:this.F3h(b)});return{returnValue:!0,xF:h}}}Object(m.a)(ug,"BlobDetailsProvider",null,[376,59]);
class jn extends ug{constructor(){super()}get key(){return"EQUATION"}get zh(){return 11}get zw(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(m.a)(jn,"EquationDetailsProvider",ug,[]);class gy{constructor(){this.AVg=null}get key(){return"LINK"}get zw(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.AVg=Ge.HyperlinkReader.jNc(b.node)}YHa(b){let h=null;for(const t of this.AVg)if(t.cpBegin<=b&&b<t.cpEnd)return h=Object.assign(new sm.a,{rG:this.key,contentObject:t.hyperlink}),
{returnValue:!0,xF:h};return{returnValue:!1,xF:h}}}Object(m.a)(gy,"HyperlinkDetailsProvider",null,[376,59]);var hy=c(1369),QA=c(906);class Mz{constructor(){this.g_g=!1}get key(){return"IFRAMENODE"}get zw(){return this.g_g?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}Vkc(b){let h=null;b=b?qe.ParagraphReader.vOa(b.currentNode):null;if(!b)return{returnValue:!1,Fla:h};h=Object.assign(new hy.a,{rG:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,Fla:h}}VCb(b,
h){b=b?Object(Da.a)(QA.a,b.contentObject):null;h=h?Object(Da.a)(QA.a,h.contentObject):null;let t="";h&&b.id===h.id||(this.g_g=b.K2a,t=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.zw,this.zw));return t}}Object(m.a)(Mz,"IFrameDetailsProvider",null,[58,59]);class Cx extends ug{constructor(){super()}get key(){return"IMAGE"}get zh(){return 5}reset(b,h){super.reset(b,h);this.j2j=!nf.SelectionEditor.hm(h)}get zw(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return Be.ImageReader.iX(b.properties)}F3h(b){var h;
b=Be.ImageReader.xOa(b.properties);return null!==(h=Jb.App.instance)&&void 0!==h&&h.NEf&&this.j2j?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,b):b}}Object(m.a)(Cx,"ImageDetailsProvider",ug,[]);class Kz{get key(){return"IMAGENODE"}get zw(){return Box4Intl.Box4Strings.l_ImageContentTitle}Vkc(b){let h=null;if(!b||!Be.ImageReader.Wu(b.currentNode))return{returnValue:!1,Fla:h};h=Object.assign(new hy.a,{rG:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,
Fla:h}}VCb(b,h){b=b.contentObject;const t=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let A="";h&&b.id===h.contentObject.id||(A=String.format(t,Be.ImageReader.iX(b.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return A}}Object(m.a)(Kz,"ImageNodeDetailsProvider",null,[58,59]);let ew,Op;class $u{constructor(b,h){this.CQg=null;this.kn=h;this.CMe=b;this.key=$u.keys.J(b);this.zw=$u.tZk.J(b)}reset(b){this.CQg=this.kn.j3(b.node)}YHa(b){var h=$u.Nwl(this.CQg||[],t=>this.eAm(b,t));h=this.B2k(h);
return{returnValue:!!h,xF:h}}eAm(b,h){return h.begin<=b&&b<h.end&&(!h.errorDetails||this.CMe===h.errorDetails.proofingType)}B2k(b){return b?Object.assign(new sm.a,{rG:this.key,contentObject:b.errorDetails,description:this.zgb()}):null}zgb(){return v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static Nwl(b,h){for(const t of b)if(h(t))return t;return null}}$u.keys=(Op=new Kh.a,Op.add(1,"SPELLINGERROR"),
Op.add(2,"GRAMMATICALERROR"),Op.add(3,"ADVANCEDERROR"),Op);$u.tZk=(ew=new Kh.a,ew.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),ew.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),ew.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),ew);Object(m.a)($u,"ProofingDetailsProvider",null,[376,59]);class RA{constructor(){this.tableNode=null;this.ZCd=this.Qce=this.columns=this.rows=0}}Object(m.a)(RA,"TableInfo",null,[]);class wt{get key(){return"TABLE"}get zw(){return Box4Intl.Box4Strings.l_TableContentTitle}Vkc(b){var h=
null;if(!Gh.TableCellReader.isTableCell(b))return{returnValue:!1,Fla:h};h=new ue.GraphIterator;h.$c(b);b=new RA;b.Qce=vp.a.Wr(h)+1;b.ZCd=Gv.a(h)+1;Wh.returnToContainingTable(h);b.tableNode=h.currentNode;b.columns=ni.TableReader.Xg(b.tableNode);b.rows=ni.TableReader.ag(b.tableNode);h=Object.assign(new hy.a,{rG:this.key,contentId:b.tableNode.id,contentObject:b});return{returnValue:!0,Fla:h}}VCb(b,h){b=b.contentObject;const t=new Uh.a;h||t.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,
b.columns,b.rows));h&&h.contentObject.ZCd===b.ZCd||t.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.ZCd));h&&h.contentObject.Qce===b.Qce||t.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.Qce));return t.toArray().join(" ")}}Object(m.a)(wt,"TableDetailsProvider",null,[58,59]);class mh{constructor(b,h){this.ZJa=b;this.kn=h}get J$c(){return null!=this.AFg?this.AFg:this.AFg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",
!1)}c1f(){this.ZJa.execute(b=>{b.g4(new gy);this.J$c||(b.g4(new $u(1,this.kn)),b.g4(new $u(2,this.kn)));b.g4(new $u(3,this.kn));b.g4(new jn);b.g4(new Cx);b.Ufc(new wt);b.Ufc(new Kz);b.Ufc(new Mz)})}}Object(m.a)(mh,"AccessibilityActor",null,[]);class hr{constructor(b,h,t){this.Apn=(A,O,aa)=>{if(1===aa)return 32;this.mQj().kbg();return 32};this.HXa=b;this.mQj=t}Ub(){this.HXa.gb(qa.a.pSi,mc.a.view,this.Apn,1028)}}Object(m.a)(hr,"AutoCorrectActor",null,[]);var xt=c(1928);class Fp{constructor(){this.m2d=
!0}Swa(){}$3a(){}s0b(){}sSf(){}Kee(){}get Lec(){return!1}get Lkb(){return 0}get WGi(){return!1}get gT(){return Ya.a.nil}}Object(m.a)(Fp,"TextOnlyBox4ImageSteward",null,[621]);class Gu{constructor(b,h,t,A,O,aa,ua=!1){this.mO=b;this.taskManager=h;this.Ug=t;this.xnm=A;this.notificationBar=O;this.Xb=aa;this.RVm=ua}create(b,h,t,A){return 1===b?new Fp:new xt.a(h,this.mO,this.taskManager,this.Ug,this.Xb,this.xnm,this.notificationBar,this.RVm,t,A)}}Object(m.a)(Gu,"Box4ImageStewardFactory",null,[594]);var lm=
c(41);class Cv{constructor(b){this.hYd=b}$Gm(b){if(!b||!b.gB||1>b.gB.count)return!1;const h=[lm.a.aKh,lm.a.$Jh];return!!this.GMd(b.gB,1,t=>this.aEd(t,h))}jsi(b){return!b||!b.gB||1>b.gB.count?!1:!!this.GMd(b.gB,1,h=>this.aEd(h,[lm.a.XF]))}cEm(b){return!b||!b.gB||1>b.gB.count?!1:!!this.GMd(b.gB,2,h=>this.aEd(h,[lm.a.YVc]))}rh(b){return!b||!b.gB||1>b.gB.count?!1:!!this.GMd(b.gB,1,h=>this.aEd(h,[lm.a.Qoa]))}XWd(b){if(!b||!b.gB)return!1;b=b.gB;for(let h=0;h<b.count;++h)if(!b.J(h)||0<b.J(h).bBk)return!1;
return!0}vpl(b,h){return this.jsi(h)||this.cEm(h)?"":b}GMd(b,h,t){if(b&&0<b.count)for(let A=b.count-1;0<=A;--A){if(t(b.J(A)))return b.J(A);if(b.count-A>=h)break}return null}aEd(b,h){b=b&&b.oki?b.oki.split(" "):null;if(!b)return!1;for(const t of h)if(0<=Array.indexOf(b,t))return!0;return!1}}Object(m.a)(Cv,"Box4PasteStewardUtils",null,[593]);var Li=c(731);class Jn{constructor(){this.YBi={};this.iGd=-1}}Object(m.a)(Jn,"LevelLists",null,[]);class Dv{constructor(b,h,t){this.z9=this.level=0;this.LUh=null;
this.Eec=!1;this.level=b;this.emc=h;this.WSi=t}}Object(m.a)(Dv,"ListItemMetadata",null,[]);class ju{constructor(){this.z9=0;this.tagName="UL";this.XKc=null;this.ignore=!1;this.vYc=0}}Object(m.a)(ju,"ListMetadata",null,[]);class Vq{constructor(b){this.nodes=b;this.S2=0;this.lists={};this.koa=[];this.obc=null;this.KCa=[];this.KCa[0]=new Jn}}Object(m.a)(Vq,"WordConverterArguments",null,[]);var Wq=c(1526);class op{constructor(b=null){this.Wnd=1;this.nW=b||Wq.a.otf("")}get Hc(){return this.nW}process(b,
h){b&&b.querySelectorAll&&(b=b.querySelectorAll("p"))&&0<b.length&&(b=new Li.a(h,Object(z.a)(this,this.vYf,"processNodesDiscovery"),new Vq(b)),b.ul("Word Converter Operation"),b.Hg=!h||h.Hg,b.run())}vYf(b,h){const t=h.nodes[h.S2];var A=op.epf(t);if(A){let O=h.KCa[A.level-1];O||(O=new Jn,h.KCa[A.level-1]=O);h.obc&&op.gOc(t)!==h.obc&&op.BZn(h);let aa=O.YBi[A.emc];if(!aa)aa=new ju,aa.z9=this.Wnd++,aa.XKc=op.Anf(t,5),aa.ignore=!aa.XKc||!aa.XKc.length,aa.tagName=op.HNd(aa.XKc),O.YBi[A.emc]=aa,h.lists[aa.z9.toString()]=
aa;else if(!aa.ignore&&1===aa.vYc){const ua=op.Anf(t,5);aa.tagName=aa.XKc===ua?"UL":"OL"}A.z9=aa.z9;aa.ignore||"OL"===aa.tagName&&0<aa.vYc&&O.iGd!==A.z9?(aa.ignore=!0,h.KCa[0].iGd=-1,h.KCa=h.KCa.slice(0,1)):(h.KCa.length>A.level&&(h.KCa=h.KCa.slice(0,A.level)),O.iGd=A.z9,h.koa[h.koa.length]=A,aa.vYc++);h.obc=t}else if((A=h.obc)&&op.gOc(t)===A&&t.tagName===A.tagName&&t.className===A.className){A.appendChild(A.ownerDocument.createElement("BR"));for(A.appendChild(A.ownerDocument.createElement("BR"));t.firstChild;)A.appendChild(t.firstChild);
t.parentNode.removeChild(t)}h.S2++;if(h.nodes.length<=h.S2){if(!h.koa.length)return!1;h.S2=0;b.ai(Object(z.a)(this,this.uYf,"processNodeConvert"))}return!0}uYf(b,h){var t=h.koa[h.S2];b=t.WSi;const A=h.lists[t.z9.toString()];if(!A.ignore&&(t=op.ZYl(b,t,A))){op.hFc(b,5);const O=b.ownerDocument.createElement("LI");for(;b.firstChild;)O.appendChild(b.firstChild);t.appendChild(O);b.parentNode.removeChild(b);"UL"===A.tagName?this.Hc.b++:this.Hc.c++}h.S2++;return h.S2<h.koa.length}static ZYl(b,h,t){let A=
op.Q1i(b,h.level,t);const O=ph.a.Db(A,"UniqueListId");if(O&&O!==h.z9||!O&&A.firstChild)b=b.ownerDocument.createElement(t.tagName),A.parentNode.insertBefore(b,A.nextSibling),A=b;ph.a.jl(A,"UniqueListId",h.z9);return op.f8e(A,t)}static f8e(b,h){if(h.tagName!==b.tagName){h=b.ownerDocument.createElement(h.tagName);for(ph.a.jl(h,"UniqueListId",ph.a.Db(b,"UniqueListId"));b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static Q1i(b,h,t){let A=
null,O;1===h?O=op.gOc(b):(A=op.Q1i(b,h-1,null),O=A.lastChild);if(O&&1===O.nodeType){const aa=O.tagName.toUpperCase();if("UL"===aa||"OL"===aa)return O}t=b.ownerDocument.createElement(t?t.tagName:"UL");1===h?b.parentNode.insertBefore(t,b):A.appendChild(t);return t}static hFc(b,h){for(let t=0;t<b.childNodes.length;t++){const A=b.childNodes[t];1===A.nodeType&&1<h&&op.hFc(A,h-1);if(op.xAf(A)||op.VSc(A))b.removeChild(A),t--}}static epf(b){if(1===b.nodeType){const h=op.C7b(b,"mso-list");if(h&&0<h.length)try{const t=
h.split(" ");if(3===t.length){const A=Number.parseInvariant(t[1].substr(5));return new Dv(A,h,b)}}catch(t){}}return null}static HNd(b){return"o"!==b&&"\u00b7"!==b&&"\u00a7"!==b&&"-"!==b?"OL":"UL"}static Anf(b,h){let t=null;for(let A=0;!t&&A<b.childNodes.length;A++){const O=b.childNodes[A];op.VSc(O)?(t="string"===typeof O.innerText?O.innerText.trim():O.textContent.trim(),t.length||(t="o")):1===O.nodeType&&1<h&&(t=op.Anf(O,h-1))}return t}static VSc(b){return 1===b.nodeType&&(b=op.C7b(b,"mso-list"))&&
0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static xAf(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static C7b(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let t=0;t<b.length;t++){const A=b[t].split(":");if(2===A.length&&A[0].trim()===h)return A[1].trim()}}return null}static gOc(b){do b=b.previousSibling;while(b&&op.zSc(b));return b}static zSc(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(op.RGe,""),!b.trim().length):
1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:op.zSc(b.firstChild):!0}static BZn(b){for(let h=0;h<b.KCa.length;h++){const t=b.KCa[h];t&&(t.iGd=-1)}}}op.RGe=RegExp("[\n|\r]","gi");Object(m.a)(op,"WordConverter",null,[465]);class aC{constructor(){this.z9=0;this.Fbc=Array(9)}}Object(m.a)(aC,"FullListMetadata",null,[]);var Yt=c(1562);class Sw{constructor(){this.level=0;this.tagName="UL";this.skb=null;this.ignore=!1;this.vYc=0;this.listStyle="BulletListStyle1";this.koa=
new Yt.a;this.font=this.levelText=""}}Object(m.a)(Sw,"ListLevelMetadata",null,[]);var pj=c(599);class jl{}jl.J$k="data-ccp-timestamp";jl.tGd="data-clipservice-ccpid";jl.N$k="data-shapeids";jl.ycm="docs-internal-guid-";jl.rpn="SCXO";jl.ryn="SCXP";jl.$Xo="SCXW";jl.V9m="MsoListParagraphCxSpFirst";jl.W9m="MsoListParagraphCxSpLast";jl.Caf="data-pkey";jl.Daf="data-clipservice-type";jl.Aaf="data-clipservice-count";jl.Baf="data-clipservice-dc";jl.JHc="data-clipservice-client";jl.Eaf="data-clipservice-version";
Object(m.a)(jl,"HtmlContentMetadataConstants",null,[]);class Mr{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(m.a)(Mr,"AbsolutePosition",null,[]);var cj=c(857);class Gp{constructor(b,h,t="",A=0){this.Yw=!1;this.oVg=this.pVg=null;let O=!1;Gp.oDm(b)&&(O=!0,this.pVg=b);Gp.GDm(h)&&(this.oVg=h);this.g_j=t;this.VPj=A;this.Yw=O&&this.NTd?!0:!1}get isValid(){return this.Yw}get rki(){return this.pVg}get NTd(){return this.oVg}get oki(){return this.g_j}get bBk(){return this.VPj}static oDm(b){return b?
-1===b.indexOf(" ")&&0<b.length:!0}static GDm(b){return b?-1===b.indexOf(" ")&&0<b.length:!1}}Object(m.a)(Gp,"HtmlElementInfo",null,[]);class av{constructor(b){this.next=null;this.data=b}}Object(m.a)(av,"StackNode",null,[]);class Hu{constructor(){this.Fq=null;this.fj=0}get count(){return this.fj}get isEmpty(){return!this.count||!this.Fq}push(b){b=new av(b);b.next=this.Fq;this.Fq=b;this.fj=this.count+1}tA(){return this.count&&this.Fq?this.Fq.data:null}pop(){if(!this.count||!this.Fq)return null;const b=
this.Fq;this.Fq=b.next;this.fj=this.count-1;return b.data}clear(){this.Fq=null;this.fj=0}toArray(){const b=Array(this.count);let h=this.Fq;for(let t=this.count-1;0<=t&&h;t--)b[t]=h.data,h=h.next;return b}}Object(m.a)(Hu,"Stack",null,[]);class Pj{constructor(b){this.isc=this.xod=null;this.wgd=!1;this.Ui=b}get bGd(){return this.isc.tA()}reset(){this.Ui.reset();this.xod=new Hu;this.isc=new Hu;this.isc.push(this.Ui.SHc);this.wgd=!1}w4d(){this.wgd=!1}oJ(b){this.wgd||(this.xod.push(null),this.wgd=!0);this.xod.push(b)}onClose(){for(;;){const b=
this.xod.pop();if(!b)break;b()}}Zej(){return!1}Qbn(){this.Tu(()=>!0)}Tu(b){const h=this.bGd.clone();return b(h)?(this.isc.push(h),this.Ui.PFa(h),this.oJ(Object(z.a)(this,this.Nhn,"onFormattingEnd")),!0):!1}Ytf(b){return b.style?this.Tu(h=>this.Zej(h,b))?1:2:2}Nhn(){this.isc.pop();this.Ui.PFa(this.bGd)}Qba(){}p4d(){return 2}vPf(){return 2}wPf(){return 2}APf(){return 2}QPf(){return 3}SPf(){}v4d(){return 2}TPf(){}UPf(){}VPf(){return 2}y4d(){return 2}z4d(){return 2}iQf(){return 2}A4d(){}kQf(){return 2}B4d(){return 2}C4d(){return 2}F4d(){return 2}G4d(){return 2}wQf(){}xQf(){return 2}N4d(){return 2}O4d(){return 2}R4d(){return 2}S4d(){return 2}U4d(){return 2}V4d(){return 2}X4d(){return 2}Z4d(){return 2}XQf(){return 2}f5d(){return 2}dRf(){return 2}fRf(){}gRf(){return 2}i5d(){return 2}j5d(){return 2}k5d(){return 2}l5d(){return 2}m5d(){return 2}n5d(){return 2}lRf(){return 3}o5d(){}rRf(){return 2}p5d(){return 2}sRf(){return 3}s5d(){}yRf(){}t5d(){return 2}ERf(){return 3}w5d(){return 2}y5d(){return 2}A5d(){return 2}B5d(){return 2}RRf(){}VRf(){return 3}D5d(){return 2}onMenuOpen(){return 2}ZRf(){}gSf(){return 2}hSf(){return 2}iSf(){return 3}P5d(){return 2}kSf(){return 2}Q5d(){return 2}U5d(){return 2}rSf(){}a6d(){return 2}CSf(){return 2}i6d(){return 2}j6d(){return 2}XSf(){return 3}cTf(){return 2}r6d(){return 2}s6d(){return 2}u6d(){return 2}v6d(){return 2}gTf(){return 3}w6d(){return 2}z6d(){return 2}B6d(){return 2}jTf(){return 2}DZc(){return 2}mTf(){return 2}nTf(){return 2}E6d(){return 2}oTf(){return 2}rTf(){return 3}I6d(){return 2}J6d(){return 2}K6d(){return 2}L6d(){return 2}O6d(){return 2}static $fa(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(F.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static Bai(b){if(!b||""===b)return-1;const h=F.a.fh(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(F.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(F.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static n8h(b){b=Pj.Bai(b);return-1===b?0:b}static S5l(b){return Pj.Bai(b)}static X$h(b){return b&&""!==b?Pj.$fa(b):null}static HD(b){let h=null,t=null,A=
null,O=null;b&&b.tf&&(h=Pj.fO(b.tf,"id"),t=Pj.fO(b.tf,"lang"),A=b.tf.tagName,b.Vwk&&(O=Object.assign(new Mr,{x:Pj.$fa(b.tf.style.left),y:Pj.$fa(b.tf.style.top),left:Pj.X$h(b.tf.style.left),top:Pj.X$h(b.tf.style.top)})),void 0===h&&(h=""),void 0===t&&(t=""));return new cj.a(new Gp(h,A),b.gB,null,t,O)}static fO(b,h){return b[h]}}Object(m.a)(Pj,"AHtmlTranslator",null,[520]);class Qz extends cj.a{constructor(b,h,t,A=0,O=0,aa=null){super(aa?aa.H8:null,aa?aa.gB:null,aa?aa.Moa:null,aa?aa.cultureName:null,
aa?aa.tBa:null);this.width=A;this.height=O}}Object(m.a)(Qz,"AugmentationSemanticArgs",cj.a,[]);class Rz{constructor(b,h,t,A,O,aa,ua){this.ccpId=b;this.pKey=h;this.type=t;this.count=A;this.dc=O;this.client=aa;this.version=ua}}Object(m.a)(Rz,"ClipServiceArgs",null,[]);var Yy;(Yy||(Yy={})).Chart="chart";Object(m.b)("ClipServiceDataType",Yy);var iy;(iy||(iy={})).ExcelOnline="XLO";Object(m.b)("ClipServiceClientApp",iy);class jy{constructor(){this.stop=this.color=null}}Object(m.a)(jy,"ColorStopPair",null,
[]);var Ao=c(1934);class Dx{constructor(){this.direction=null;this.GFc=new Yt.a}jii(){return!!this.direction&&0<this.direction.length}}Object(m.a)(Dx,"LinearGradient",null,[]);class ku{constructor(){this.X9b=!1}}Object(m.a)(ku,"HtmlTranslatorContext",null,[]);class us{constructor(b=!1,h=!1,t=!1,A=!1,O=!1,aa=!0,ua=!1,Ra=!0,ub=!0,Nb=!0,Yb=!1,bc=!1,Dc=!1,Pc=!1,jd=!1,Cd=!1,ee=!1,Od=!1,fe=!1,Ee=null,re=null,Fg=null,Gg=null,bm=null,An=null,Zr=null,Av=null,KA=null){this.X9b=!1;this.U8j=b;this.Q8j=h;this.W8j=
t;this.ick=A;this.gck=O;this.bck=aa;this.cck=ua;this.eck=Ra;this.fck=ub;this.dck=Nb;this.tck=Yb;this.Ock=bc;this.sck=Dc;this.kek=Pc;this.mck=jd;this.k0j=Cd;this.Hck=ee;this.Pck=Od;this.QRj=fe;this.kck=Ee;this.rck=re;this.hck=bm;this.pck=Fg;this.jck=Gg;this.ock=An;this.qck=Zr;this.lck=Av;this.nck=KA}get Qlb(){return this.U8j}get bVi(){return this.Q8j}get Lun(){return this.W8j}get Gjj(){return this.ick}get Fjj(){return this.gck}get Ako(){return this.bck}get Bko(){return this.cck}get Dko(){return this.eck}get Eko(){return this.fck}get Cko(){return this.dck}get Onb(){return this.mck}get Csm(){return this.k0j}get nkj(){return this.Hck}get Rkj(){return this.Pck}get BMk(){return this.QRj}get Jjj(){return this.tck}get Hmo(){return this.Ock}get Nko(){return this.sck}get txo(){return this.kek}get Hjj(){return this.kck||
Object(z.a)(this,this.ygc,"returnFalse")}get Mko(){return this.rck||Object(z.a)(this,this.ygc,"returnFalse")}get Lko(){return this.pck||Object(z.a)(this,this.Z4f,"returnTrue")}get Gko(){return this.jck||Object(z.a)(this,this.Z4f,"returnTrue")}get Fko(){return this.hck||Object(z.a)(this,this.ygc,"returnFalse")}get Kko(){return this.ock||Object(z.a)(this,this.Z4f,"returnTrue")}get Ijj(){return this.qck||Object(z.a)(this,this.ygc,"returnFalse")}get Hko(){return this.lck||Object(z.a)(this,this.ygc,"returnFalse")}get Jko(){return this.nck||
Object(z.a)(this,this.ygc,"returnFalse")}Z4f(){return!0}ygc(){return!1}}Object(m.a)(us,"HtmlTranslatorSettings",null,[517]);var bv=c(1825);class Nz{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(m.a)(Nz,"IndentationProperties",null,[]);var at=c(1375);class Ev extends cj.a{constructor(b,h,t,A,O=null,aa=0,ua=null,Ra=null,ub=!1,Nb=!1,Yb=69905,bc=null){super(bc?bc.H8:null,bc?bc.gB:null,bc?bc.Moa:null,bc?bc.cultureName:null,bc?bc.tBa:null);this.colSpan=b;this.rowSpan=h;this.width=t;this.wac=
Nb;this.height=A;this.z2a=ub;this.shadingColor=O;this.verticalAlignment=aa;this.wia=ua;this.Wie=Ra;this.U6=Yb}}Object(m.a)(Ev,"TableCellSemanticArgs",cj.a,[]);class Vy extends cj.a{constructor(b,h=null){super(h?h.H8:null,h?h.gB:null,h?h.Moa:null,h?h.cultureName:null,h?h.tBa:null);this.height=b}}Object(m.a)(Vy,"TableRowSemanticArgs",cj.a,[]);class ky extends cj.a{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb=null,Yb=-1,bc=null){super(bc?bc.H8:null,bc?bc.gB:null,bc?bc.Moa:null,bc?bc.cultureName:null,bc?bc.tBa:
null);this.aDd=null;this.rowCount=b;this.Tdb=h;this.width=t;if(O)for(this.aDd=Array(O.length),b=0;b<O.length;++b)this.aDd[b]=O[b];this.xqi=aa;this.peg=Ra;this.vym=ua;this.z2a=A;this.xUd=ub;this.styleId=Nb;this.tableLook=Yb}}Object(m.a)(ky,"TableSemanticArgs",cj.a,[]);let Iu;class mo extends Pj{constructor(b,h=null,t=null,A=null){super(b);this.Ztb=null;this.f4j=ob.a.N4("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",
7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Qdo=new Set(["DIV","P"]);this.Rd=h||new us;this._context=t||new ku;this.bHe=A}get TBi(){return this.f4j}W7h(b,h){var t;if((t=b.style?b.style.listStyleType:"")&&""!==t&&(t=this.TBi[F.a.fh(t)])||(t=Pj.fO(b,"type"))&&""!==t&&(t=this.TBi[t]))return t;if(this.Rd.Qlb&&(t=b.tagName.toLowerCase())&&("ol"===t||"ul"===t)&&(b=b.className)&&""!==b)if("ul"===t)switch(b=mo.iRd(b,"BulletListStyle"),
b){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===t)switch(b=mo.iRd(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}P7h(b){let h=-1,t=b.tagName.toLowerCase();if("ol"===t||"ul"===t){b=vc.a.O4h(b,"li");if(!b)return h;t="li"}if("li"===t){h=(h=this.rMd(b,"data-aria-level",0))?h:-1;if(0<
h)return h-1;if(b=vc.a.O4h(b,"p"))return mo.LUl(b)-1}return h}rMd(b,h,t){b=this.Rd.Qlb?b.getAttribute(h):Pj.fO(b,h);b=parseInt(b);return isNaN(b)||0>b?t:b}Ajn(){this.Ztb.pop();this.Ui.VFa()}kPc(b,h){this.Tu(O=>O.vca(0,0));const t=this.W7h(b.tf,h?6:2);let A=1;h&&(A=this.rMd(b.tf,"start",1));h=!1;this.Rd.Qlb&&(h=b.tf.getAttribute("data-pasteFromRc"),(h=!!h&&"true"===h)&&b.tf.removeAttribute("data-pasteFromRc"),(ba.a.y3||ba.a.jj)&&mo.ECd(b.tf));b=new at.a(t,A,Pj.HD(b),0,-1,h,this.Rd.Qlb);this.Ztb.push(b);
this.Ui.XFa(b);this.oJ(Object(z.a)(this,this.Ajn,"onListElementClose"));return 1}O7k(b,h,t){return(h=h.getAttribute(t))?b.l$e(h):!1}reset(){super.reset();this.Ztb=new Hu}Zej(b,h){var t;let A=!1;try{var O=h.getAttribute("xml:lang")||Pj.fO(h,"lang")}catch(Ra){O=null}O&&""!==O&&(A=b.N8f(O)||A);(O=Pj.fO(h,"dir"))&&(A=b.Zhc(O)||A);if(this.Rd.Hko(this._context)&&h.getAttribute)for(O=0;O<mo.Spj.length;O++)A=this.O7k(b,h,mo.Spj[O])||A;if(O=h.style){if(O.fontWeight){var aa=F.a.BA(O.fontWeight),ua=parseInt(aa);
isNaN(ua)?"BOLD"===aa?A=b.XK(!0)||A:"NORMAL"===aa&&(A=b.XK(!1)||A):A=600<=ua?b.XK(!0)||A:b.XK(!1)||A}this.Rd.Fjj&&O.fontSize&&(aa=Pj.S5l(O.fontSize),0<aa&&(A=b.Bee(Math.floor(2*aa))||A));(null===(t=v.AFrameworkApplication.K)||void 0===t?0:t.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&this.Qdo.has(h.tagName)&&((null===O||void 0===O?0:O.marginTop)||(null===O||void 0===O?0:O.marginBottom))&&(t=Pj.n8h(null===O||void 0===O?void 0:O.marginTop),aa=Pj.n8h(null===
O||void 0===O?void 0:O.marginBottom),A=b.vca(t,aa)||A);this.Rd.Lko(this._context)&&(this.Rd.Jjj&&h.getAttribute?(t=h.getAttribute("data-indent"))&&0<t.length&&(t=Hc.a.Ki(parseInt(t),0)+"px",A=b.zfe(t)||A):O.textIndent&&(A=b.zfe(O.textIndent)||A));this.Rd.Gko(this._context)&&O.marginLeft&&(this.Rd.Jjj&&h.getAttribute?(t=h.getAttribute("data-margin"))&&0<t.length&&(A=b.dia(O.marginLeft)||A):"TABLE"!==h.tagName&&(A=b.dia(O.marginLeft)||A));if(this.Rd.Jko(this._context)&&(t=h.getAttribute("style"))&&
""!==t)for(t=t.split(";"),aa=0;aa<t.length;aa++)ua=t[aa].trim(),ua.startsWith("tab-stops")&&(A=b.D9f(ua.replace("tab-stops:",""))||A);this.Rd.Fko(this._context)&&O.lineHeight&&(A=b.KC(O.lineHeight)||A);this.Rd.Cko&&(t=O.textTransform?F.a.fh(O.textTransform):null,aa=O.fontVariantCaps?F.a.fh(O.fontVariantCaps):null,ua=O.fontVariant?F.a.fh(O.fontVariant):null,"uppercase"===t?A=b.W5c("uppercase")||A:"small-caps"===aa||ua&&0<=ua.indexOf("small-caps")?A=b.W5c("small-caps")||A:this.Rd.BMk&&"none"===t&&(A=
b.W5c("none")||A));this.Rd.Kko(this._context)&&O.textAlign&&(A=b.pNb(F.a.fh(O.textAlign))||A);O.fontStyle&&(t=F.a.BA(O.fontStyle),"ITALIC"===t||"OBLIQUE"===t?A=b.nnb(!0)||A:"NORMAL"===t&&(A=b.nnb(!1)||A));t=mo.F8l(h);if(O.textDecoration||t)aa=F.a.fh(O.textDecoration||""),t=F.a.fh(t||""),h.parentNode&&h.parentNode.tagName&&"a"===F.a.fh(h.parentNode.tagName)?(ua=(h.querySelector(".TextRun")||h).className)&&-1<ua.indexOf("Underlined")&&(A=b.x4(!0)||A):O.mgp||mo.isUnderline(aa)||mo.isUnderline(t)?A=b.x4(!0)||
A:this.Rd.Rkj&&(A=b.x4(!1)||A),O.lgp||mo.pui(aa)||mo.pui(t)?A=b.gia(!0)||A:this.Rd.Rkj&&(A=b.gia(!1)||A);if(O.verticalAlign){t=F.a.BA(O.verticalAlign);aa=this.XIn(t);if("SUB"===t||this.Rd.Ijj(this._context)&&h.className&&-1<h.className.indexOf("Subscript")||0>aa&&this.Rd.nkj)A=b.hHa(!0)||A;else if("SUPER"===t||this.Rd.Ijj(this._context)&&h.className&&-1<h.className.indexOf("Superscript")||0<aa&&this.Rd.nkj)A=b.Kpa(!0)||A;this.Rd.Fjj&&("SUB"===t||"SUPER"===t)&&h.getAttribute&&(t=parseFloat(h.getAttribute("data-fontsize")),
isNaN(t)||(A=b.Bee(Math.floor(2*t))||A))}t=!1;v.AFrameworkApplication.K&&(t=v.AFrameworkApplication.K.$("CopyAndPasteFontTelemetryIsEnabled"));this.Rd.Eko&&O.fontFamily&&(this.Rd.Nko&&h.getAttribute?(aa=h.getAttribute("data-usefontface"))&&"true"===aa&&(t&&u.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),A=this.Xej(b,O.fontFamily,A)):A=this.Xej(b,O.fontFamily,A));aa=null;this.Rd.Dko&&O.color&&(aa=Ao.a.Pta(O.color));ua=!!aa;this.Rd.Mko(this._context)&&h.getAttribute&&(aa=h.getAttribute("data-scheme-color"),
aa=null!==aa?aa:"",ua=""!==aa||!this._context.X9b||mo.ALm(h));ua&&(A=b.Ev(aa)||A);this.Rd.Ako&&O.backgroundColor&&(h.tagName&&mo.Mzo.contains(F.a.BA(h.tagName))||(A=b.Yxa(Ao.a.Pta(O.backgroundColor))||A));if(this.Rd.Bko&&O.backgroundImage&&h.className&&-1<h.className.indexOf("Highlight")&&(O=mo.uam(O.backgroundImage))&&0<O.GFc.count){aa=O.GFc.J(0).color;ua=!0;for(let Ra=0;Ra<O.GFc.count&&(ua=ua&&aa===O.GFc.J(Ra).color,ua);Ra++);ua&&(t&&u.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),
A=b.Yxa(Ao.a.Pta(aa))||A)}}this.Rd.Hjj(this._context)&&h.getAttribute&&(O=h.getAttribute("data-ccp-props"))&&(A=b.fHa(O)||A);h.getAttribute&&((O=h.getAttribute("data-ccp-charstyle"))&&this.Rd.Onb&&(A=b.gee(O)||A),(h=h.getAttribute("data-ccp-parastyle"))&&this.Rd.Onb&&(A=b.kfe(h)||A));return A}Gmo(b){if(this.Rd.Hmo)for(b=b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<F.a.BA(b.className).indexOf("MSOCOM"))return!0;if("DIV"===F.a.BA(b.tagName))break;b=b.parentNode}return!1}Xej(b,
h,t){h=mo.i5h(h);return b.G5a(h,this.Rd.txo)||t}XIn(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}Qba(b,h){"\u200b"===b&&(b="\u00a0");h&&h.tf&&this.Gmo(h.tf)&&(b="");this.Ui.Qba(b,Pj.HD(h))}p4d(b){const h=Pj.fO(b.tf,"href");return h&&""!==h?(this.Ui.RQa(h,Pj.HD(b)),this.oJ(Object(z.a)(this.Ui,this.Ui.QQa,"onAnchorEnd")),1):2}v4d(){return this.Tu(b=>b.XK(!0))?1:2}y4d(){return this.Tu(b=>b.Stf())?1:2}z4d(b){this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));
return 1}A4d(b){this.Ui.UFa(Pj.HD(b))}B4d(b){this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}F4d(){return this.Tu(b=>b.nnb(!0))?1:2}C4d(b){this.Tu(h=>h.pNb("center"));this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}G4d(){return this.Tu(b=>b.G5a("consolas"))?1:2}O4d(){return this.Tu(b=>b.gia(!0))?1:2}N4d(b){return this.kPc(b,!1)}R4d(){return this.Tu(b=>b.nnb(!0))?1:2}S4d(b){return this.kPc(b,!1)}U4d(b){var h=b.tf.getAttribute("data-render-src");
const t=b.tf.getAttribute("data-render-method");if(h&&""!==h&&t&&""!==t){const ua=b.tf.getAttribute("data-render-fallback");let Ra=0,ub=0;if(b.tf.currentStyle){var A=b.tf.currentStyle.width,O=b.tf.currentStyle.height;A&&-1!==A.indexOf("px")&&(A=parseInt(F.a.substring(A,0,A.indexOf("px"))),isNaN(A)||(Ra=A));O&&-1!==O.indexOf("px")&&(O=parseInt(F.a.substring(O,0,O.indexOf("px"))),isNaN(O)||(ub=O))}b=new Qz(h,t,ua,Ra,ub,Pj.HD(b));this.Ui.$3a(b);return 2}this.Rd.Qlb&&(ba.a.y3||ba.a.jj)&&(h=b.tf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")),
this.Rd.Qlb&&h&&h.length&&mo.ECd(b.tf));const aa=b.tf.getAttribute("align");this.Tu(ua=>ua.pNb(aa));this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}V4d(b){this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}X4d(b){this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}Z4d(){return this.Tu(b=>b.nnb(!0))?1:2}f5d(b){return this.Tu(h=>{var t=mo.i5h(b.tf.getAttribute("face"));t=h.G5a(t);h=h.Ev(Ao.a.Pta(b.tf.getAttribute("color")));
return t||h})?1:2}i5d(b){this.Tu(h=>this.Rd.Onb?h.pnb(1):h.rnb(1));this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}j5d(b){this.Tu(h=>this.Rd.Onb?h.pnb(2):h.rnb(2));this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}k5d(b){this.Tu(h=>this.Rd.Onb?h.pnb(3):h.rnb(3));this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}l5d(b){this.Tu(h=>this.Rd.Onb?h.pnb(4):h.rnb(4));this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,
this.Ui.mG,"onParagraphEnd"));return 1}m5d(b){this.Tu(h=>this.Rd.Onb?h.pnb(5):h.rnb(5));this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}n5d(b){this.Tu(h=>this.Rd.Onb?h.pnb(6):h.rnb(6));this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}o5d(b){this.Ui.UFa(Pj.HD(b))}s5d(b){var h=b.tf;const t=h.src,A=h.alt,O=h.cbp,aa=h.getAttribute("data-external-content-url");let ua=0,Ra=0;h.style&&(ua=Pj.$fa(h.style.width),Ra=Pj.$fa(h.style.height));
ua&&Ra||(ua=h.width,Ra=h.height);let ub=0,Nb=0;b.tf.currentStyle&&(ua||Ra||(ua=Pj.$fa(b.tf.currentStyle.width),Ra=Pj.$fa(b.tf.currentStyle.height)),ub=Pj.$fa(b.tf.currentStyle.maxWidth),Nb=Pj.$fa(b.tf.currentStyle.maxHeight));let Yb=null;const bc=h.getAttribute(jl.tGd);if(bc&&(u.ULS.sendTraceTag(524038492,307,50,"Chart paste from xlo"),v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ChartsPasteFromXLOIsEnabled"))){const Dc=h.getAttribute(jl.Caf),Pc=h.getAttribute(jl.Daf),jd=h.getAttribute(jl.Aaf),
Cd=h.getAttribute(jl.Baf),ee=h.getAttribute(jl.JHc);h=h.getAttribute(jl.Eaf);Dc&&Cd&&(Yb=new Rz(bc,Dc,Pc,jd,Cd,ee,h))}b=new bv.a(t,A,ua,Ra,Pj.HD(b),ub,Nb,O,null,aa,Yb);this.Ui.Swa(b)}p5d(){return this.Tu(b=>b.nnb(!0))?1:2}t5d(){return this.Tu(b=>b.x4(!0))?1:2}w5d(){return this.Tu(b=>b.G5a("consolas"))?1:2}y5d(b){this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}A5d(b){this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}B5d(b){let h;
const t=this.W7h(b.tf,0);let A=this.rMd(b.tf,"value",0);var O=!1;0<this.Ztb.count?h=this.Ztb.tA():(h=new at.a(2,1,Pj.HD(b)),A||(A=1));var aa=mo.XUl(b.tf,at.a.Pwj);3!==aa&&(h.Gr=aa);if(this.Rd.Qlb){O=h.listLevel;aa=h.listId;this.Rd.Gjj?(O=this.P7h(b.tf),O=0>O&&0>h.listLevel&&0<this.Ztb.count?h.listLevel=this.Ztb.count-1:h.listLevel=0<=O?O:h.listLevel,this.bHe&&this.bHe.b<O&&(this.bHe.b=O)):0>O&&(O=h.listLevel=this.P7h(b.tf));1>aa&&(aa=h.listId=this.rMd(b.tf,at.a.iWc,0));b.tf.getAttribute(at.a.x_d)&&
(h.levelText=b.tf.getAttribute(at.a.x_d));var ua=b.tf.getAttribute(at.a.aHf);ua&&(h.font=ua);ua=!1;v.AFrameworkApplication.K&&(ua=v.AFrameworkApplication.K.$("FollowDestinationThemePasteIsEnabled"));if(ua){var Ra=b.tf.getAttribute("data-charcodes");ua=[];if(Ra&&""!==Ra)if(-1<Ra.indexOf(",")){Ra=Ra.split(",");for(var ub=0;ub<Ra.length;ub++)ua.push(parseInt(Ra[ub]))}else ua.push(parseInt(Ra));if(ua&&0<ua.length){Ra=Array(ua.length);for(ub=0;ub<ua.length;ub++)Ra[ub]=ua[ub];h.w4e=Ra}(ua=b.tf.getAttribute("data-buAutoNum"))&&
0<ua.length&&(h.buAutoNum=parseInt(ua))}(O=0<=O&&0<aa)&&mo.ECd(b.tf)}h.Uxk(t,A,O);h.$Gf=this.CUl(b.tf);this.Ui.WQa(h.clone());this.oJ(Object(z.a)(this.Ui,this.Ui.WFa,"onListItemEnd"));return 1}CUl(b){var h=b.getAttribute(at.a.CBi);if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch(t){u.ULS.sendTraceTag(524038493,307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;h=new ji.DictionaryPropertySet;for(const t in b)h.Ihj(+t,
b[t]);return h}onMenuOpen(b){return this.kPc(b,!1)}D5d(b){if(this.Tu(h=>h.Nhc(!0))){const h=b.tf.getAttribute("OuterHtml");this.Ui.XQa(h,Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.Y3a,"onMathEnd"))}return 1}P5d(b){return this.kPc(b,!0)}Q5d(b){this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}U5d(b){const h=b.tf.getAttribute("align");this.Tu(t=>t.pNb(h));if(this.Rd.Qlb){const t=b.tf.parentNode;t&&t.tagName.toLowerCase().startsWith("li")&&mo.ECd(b.tf,ba.a.y3||
ba.a.jj)}this.Ui.nG(Pj.HD(b));this.oJ(Object(z.a)(this.Ui,this.Ui.mG,"onParagraphEnd"));return 1}a6d(){this.Tu(b=>b.G5a("consolas"));this.Ui.klb();this.oJ(Object(z.a)(this.Ui,this.Ui.jlb,"onPreFormattedTextEnd"));return 1}i6d(){return this.Tu(b=>b.gia(!0))?1:2}j6d(){return this.Tu(b=>b.G5a("consolas"))?1:2}r6d(){return this.Tu(b=>b.Mbg())?1:2}s6d(b){var h=b.tf.attributes.getNamedItem("style"),t="";h&&h.value&&(t=h.value);h=Ao.a.Ztn(t);if(0<h&&this.Rd.Csm){for(t=0;t<h;t++)this.Ui.nlb(Pj.HD(b));return 3}return 2}u6d(){return this.Tu(b=>
b.gia(!0))?1:2}v6d(){return this.Tu(b=>b.XK(!0))?1:2}w6d(){return this.Tu(b=>b.hHa(!0))?1:2}z6d(){return this.Tu(b=>b.Kpa(!0))?1:2}B6d(b){this.Tu(Yb=>Yb.clearFormatting()&&Yb.m4f());Ao.a.NSd(b.tf,this);const h=Ao.a.rfi(b.tf),t=Ao.a.m1h(b.tf),A=Ao.a.OI(b.tf),O=Ao.a.zK(b.tf),aa=!parseInt(Pj.fO(b.tf,"border")),ua=Ao.a.aLm(b.tf);let Ra=-1,ub="";var Nb=-1;b.tf.attributes.hasOwnProperty("style")&&-1!==(Nb=b.tf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?Ra=parseInt(b.tf.attributes.getNamedItem("style").value.substr(Nb+
17)):b.tf.attributes.hasOwnProperty(pj.a.uGd.toString())&&(Ra=parseInt(b.tf.attributes.getNamedItem(pj.a.uGd.toString()).value));Nb=-1;b.tf.attributes.hasOwnProperty("class")&&-1!==(Nb=b.tf.attributes.getNamedItem("class").value.indexOf("Mso"))?ub=b.tf.attributes.getNamedItem("class").value.substr(Nb).split(" ")[0]:b.tf.attributes.hasOwnProperty(pj.a.KHc.toString())&&(ub=b.tf.attributes.getNamedItem(pj.a.KHc.toString()).value);this.Ui.Pba(new ky(0,0,h.value,h.zwi,null,aa,ua,t,new Nz(A.value,O.value),
ub,Ra,Pj.HD(b)));this.oJ(Object(z.a)(this.Ui,this.Ui.Mba,"onTableEnd"));v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}DZc(b){const h=Ao.a.V5h(b.tf),t=Ao.a.rfi(b.tf);if(!t.value&&t.$Wd&&(v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Rd.bVi))return 3;let A=parseInt(Pj.fO(b.tf,"colSpan"));if(void 0===A||null===A||""===A+"")A=t.value?1:0;let O=parseInt(Pj.fO(b.tf,
"rowSpan"));if(void 0===O||null===O||""===O+"")O=h.value?1:0;let aa=!1;b.tf.attributes.hasOwnProperty("style")&&(aa=-1!==b.tf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==b.tf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!aa&&b.tf.attributes.hasOwnProperty("class")&&(aa=-1!==b.tf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let ua=69905;if(b.tf.attributes.hasOwnProperty(pj.a.zaf.toString())){var Ra=
parseInt(b.tf.attributes.getNamedItem(pj.a.zaf.toString()).value);isNaN(Ra)||(ua=Ra)}Ra=Ao.a.Pta(b.tf.style.backgroundColor);const ub=Ao.a.xam(b.tf);this.Tu(bc=>bc.vca(0,0));Ao.a.NSd(b.tf,this);const Nb=Ao.a.m1h(b.tf),Yb=this.Rd.Lun?Ao.a.xHl(b.tf):null;b=new Ev(A,O,t.value,h.value,Ra,ub,Nb,Yb,t.zwi,aa,ua,Pj.HD(b));this.Ui.Lba(b);this.oJ(Object(z.a)(this.Ui,this.Ui.Kba,"onTableCellEnd"));this.Qbn();return 1}E6d(b){const h=this.DZc(b);if(3===h)return h;this.Tu(t=>{const A=t.XK(!0);t=t.pNb("center");
return A||t});Ao.a.NSd(b.tf,this);return 1}I6d(b){Ao.a.NSd(b.tf,this);const h=Ao.a.V5h(b.tf);if(h.$Wd&&!h.value&&(v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Rd.bVi))return 3;this.Ui.Oba(new Vy(h.value,Pj.HD(b)));this.oJ(Object(z.a)(this.Ui,this.Ui.Nba,"onTableRowEnd"));return 1}J6d(){return this.Tu(b=>b.G5a("consolas"))?1:2}K6d(){return this.Tu(b=>b.x4(!0))?1:2}L6d(b){return this.kPc(b,!1)}O6d(){return this.Tu(b=>b.x4(!0))?1:2}static yNl(b){return b?
b.split(",")[0]:null}static bGo(b){if(!b)return null;b=F.a.z2f(b,'"');return b=F.a.z2f(b,"'")}static i5h(b){if(!b)return null;b=mo.yNl(b);return b=mo.bGo(b)}static Clh(b,h){h=h.trim();var t=h.match(RegExp("^-?[0-9]+deg$"));if(t&&0<t.length){if(b.jii())return!1;b.direction=h;return!0}if((t=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<t.length){if(b.jii())return!1;b.direction=h;return!0}var A=(t=h.match(RegExp("^rgb\\(.*\\)")))&&0<t.length?h.indexOf(")")+
1:h.indexOf(" ");t=-1===A?h:Ao.a.Pta(h.substr(0,A).trim());if(!t||""===t)return!1;h=-1===A?"":h.substr(A).trim();A=new jy;A.color=t;A.stop=h;b.GFc.add(A);return!0}static uam(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const t=new Dx;for(;0<h.trim().length;){let A=h.indexOf(",");const O=h.indexOf("(");if(0<O&&O<A){const aa=h.indexOf(")");if(aa<O)return null;A=h.indexOf(",",aa)}if(-1===A){if(!mo.Clh(t,
h))return null;h=""}else{const aa=h.substr(0,A);h=h.substr(A+1);if(!mo.Clh(t,aa))return null}}return t}catch(h){return null}}static iRd(b,h){b=b.split(" ");if(0<b.length)for(let t=0;t<b.length;t++)if(0<=b[t].indexOf(h))return b[t];return""}static ECd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&mo.rAh(b,h))}static rAh(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&(b.style.margin=""),h&&mo.rAh(b,h)),b=b.nextSibling}static LUl(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&
0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let t=0;t<b.length;t++){var h=b[t].split(":");if(2===h.length&&"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static XUl(b,h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;default:return 3}}static ALm(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static F8l(b){b=
b.style.textDecorationLine;return void 0===b||null===b?null:b}static pui(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=b.indexOf("underline")}}mo.Mzo=(Iu=new Mb.a,Iu.add("TABLE"),Iu.add("THEAD"),Iu.add("TBODY"),Iu.add("TFOOT"),Iu.add("TR"),Iu.add("TH"),Iu.add("TD"),Iu);mo.Spj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn","data-ccp-parastyle-linked-defn"];Object(m.a)(mo,"DefaultHtmlTranslator",Pj,[]);class il{constructor(b=null){this.nW=
b||Wq.a.otf("");this.Wnd=Number.parseInvariant((new Date).format("HHmmss"))}get Hc(){return this.nW}process(b,h){if(b&&b.querySelectorAll){const aa=b.querySelectorAll("p");if(aa&&0<aa.length){for(var t=0,A=!1,O=aa[0].parentNode;5>t&&O&&O!==b;){t++;const ua=O.id.toLowerCase();if(ua&&ua.length&&-1!==ua.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(O,"WACEditing")&&Sys.UI.DomElement.containsCssClass(O,"EditingSurfaceBody")){A=!0;break}O=O.parentNode}if(A&&O!==b){t=b.firstChild;for(A=
!1;0<O.children.length&&O.children[0]!==t;)b.insertBefore(O.children[0],t),A=!0;if(A)for(;t;)O=t.nextSibling,b.removeChild(t),t=O}b=new Li.a(h,Object(z.a)(this,this.vYf,"processNodesDiscovery"),new Vq(aa));b.ul("Word Converter Operation");b.Hg=!h||h.Hg;b.run()}}}vYf(b,h){const t=h.nodes[h.S2];var A=il.epf(t);if(A){let aa=A.emc.replace(RegExp("level[0-9]"),"").trim();aa=aa&&aa.length?aa:A.emc;let ua=h.lists[aa];ua||(ua=new aC,ua.z9=this.Wnd++);let Ra=ua.Fbc[A.level-1];Ra||(Ra=new Sw,Ra.level=A.level);
var O=t.parentNode;if(O&&"li"===O.tagName.toLowerCase()){if(O=O.parentNode)!(O=O.tagName.toUpperCase())||"OL"!==O&&"UL"!==O||(Ra.tagName=O)}else Ra.skb=il.A4h(t,5),Ra.skb&&Ra.skb.length||(Ra.skb=il.$rf(t,5)),Ra.ignore=!Ra.skb||!Ra.skb.length,Ra.tagName=il.HNd(Ra.skb),"UL"===Ra.tagName&&(Ra.font=this.l5h(t,5));A.z9=ua.z9;Ra.vYc++;Ra.ignore||"li"===t.parentNode.tagName.toLowerCase()||(O=(O=il.$rf(t,5))?O:Ra.skb)&&O.length&&(A.LUh=O,(O=il.kdo(t,O,Ra.listStyle,A.level-1))&&O.length&&(Ra.listStyle=O));
h.koa[h.koa.length]=A;Ra.koa.contains(A)||Ra.koa.add(A);if(void 0===ua.Fbc[A.level-1]||null===ua.Fbc[A.level-1]||ua.Fbc[A.level-1]!==Ra)ua.Fbc[A.level-1]=Ra;h.lists[aa]&&h.lists[aa]===ua||(h.lists[aa]=ua);h.obc=t}else if((A=h.obc)&&il.gOc(t)===A&&t.tagName===A.tagName&&t.className===A.className){A.appendChild(A.ownerDocument.createElement("BR"));for(A.appendChild(A.ownerDocument.createElement("BR"));t.firstChild;)A.appendChild(t.firstChild);t.parentNode.removeChild(t)}h.S2++;if(h.nodes.length<=h.S2){if(!h.koa.length)return!1;
h.S2=0;b.ai(Object(z.a)(this,this.uYf,"processNodeConvert"))}return!0}uYf(b,h){b=h.koa[h.S2];var t=b.WSi,A=b.emc.replace(RegExp("level[0-9]"),"").trim();A=A&&A.length?A:b.emc;A=h.lists[A];var O=A.Fbc[b.level-1],aa=t.parentNode.tagName.toLowerCase();if(!O.ignore&&t.parentNode&&"li"!==aa){if(aa=il.O4k(t,O)){il.hFc(t,5);const ua=t.ownerDocument.createElement("LI");ua.setAttribute("data-aria-level",String.format("{0}",b.level));ua.setAttribute(at.a.iWc,String.format("{0}",A.z9));"UL"===O.tagName&&(ua.setAttribute(at.a.x_d,
String.format("{0}",b.LUh)),ua.setAttribute(at.a.aHf,String.format("{0}",O.font)));for(;t.firstChild;)ua.appendChild(t.firstChild);aa.appendChild(ua);t.parentNode.removeChild(t);"UL"===O.tagName?this.Hc.b++:this.Hc.c++}}else"li"===aa&&(O=O.tagName,t=t.parentNode,b.Eec&&(b=t.parentNode)&&b.tagName.toUpperCase()===O&&b.setAttribute("data-pasteFromRc","true"),t.setAttribute(at.a.iWc,String.format("{0}",A.z9)),"UL"===O?this.Hc.b++:this.Hc.c++);h.S2++;return h.S2<h.koa.length}l5h(b,h){let t=null;for(let A=
0;!t&&A<b.childNodes.length;A++){const O=b.childNodes[A];t=il.MPl(O);!t&&1===O.nodeType&&1<h&&(t=this.l5h(O,h-1))}return t}static O4k(b,h){b=il.M4k(b,h.tagName);return il.f8e(b,h)}static f8e(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static M4k(b,h){h=b.ownerDocument.createElement(h?h:"UL");var t=b.getAttribute("start");t&&0<t.length&&(h.setAttribute("start",
t),b.removeAttribute("start"));(t=b.className)&&0<t.length&&(t="OL"===h.tagName?mo.iRd(t,"NumberListStyle"):mo.iRd(t,"BulletListStyle"),0<t.length&&(Sys.UI.DomElement.addCssClass(h,t),Sys.UI.DomElement.removeCssClass(b,t)));b.parentNode.insertBefore(h,b);return h}static hFc(b,h){for(let t=0;t<b.childNodes.length;t++){const A=b.childNodes[t];1===A.nodeType&&1<h&&il.hFc(A,h-1);if(il.xAf(A)||il.VSc(A))b.removeChild(A),t--}}static epf(b){if(1===b.nodeType){var h=il.C7b(b,"mso-list");if(h&&0<h.length)try{var t=
h.split(" ");if(3===t.length){const A=Number.parseInvariant(t[1].substr(5)),O=new Dv(A,h,b);O.Eec=!0;return O}}catch(A){}else if((t=b.parentNode)&&"li"===t.tagName.toLocaleLowerCase()&&(h=t.getAttribute("data-"+Mf.a.Mzd),t=t.getAttribute(at.a.iWc),h&&t&&0<h.length&&0<t.length))return b=new Dv(Number.parseInvariant(h),t+" level"+h,b),b.Eec=!1,b}return null}static kdo(b,h,t,A){if("p"===b.tagName.toLowerCase()&&h&&h.length){if("UL"===il.HNd(h))return t=il.OGl(h),Sys.UI.DomElement.addCssClass(b,t),t;
var O=h.match(RegExp("^[0-9]+"));return O&&O.length?(t="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,t),b.setAttribute("start",O[0]),t):(O=h.match(RegExp("^[a-zA-Z]+")))&&O.length&&(O=O[0],A=(h=O.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?il.C3l(t,A):1,1!==A&&((t=il.BEd(b,O,RegExp("^[ivxlcdm]+"),F.a.kFh,"NumberListStyle3"))||(t=il.BEd(b,O,RegExp("^[IVXLCDM]+"),F.a.kFh,"NumberListStyle5")))||A&&((t=il.BEd(b,O,RegExp("^[a-z]+"),F.a.iFh,"NumberListStyle2"))||(t=il.BEd(b,O,RegExp("^[A-Z]+"),
F.a.iFh,"NumberListStyle4"))))?t:"NumberListStyle1"}return null}static OGl(b){switch(b){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static C3l(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static BEd(b,h,t,A,O){return(h=h.match(t))&&
h.length?(A=A(h[0]),A=1>A?1:A,Sys.UI.DomElement.addCssClass(b,O),b.setAttribute("start",A+""),O):null}static HNd(b){return il.Dym(b)?"UL":"OL"}static Dym(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static $rf(b,h){let t=null;var A;let O,aa;for(let ua=-1;!t&&ua<b.childNodes.length;ua++){const Ra=-1===ua?b:b.childNodes[ua];if(Ra)if((A=Ra.innerHTML)&&0<A.length){if(O=A.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=O&&(aa=
A.indexOf("\x3c!--[endif]--\x3e"),0<=aa)){A=A.substring(O,aa+14);Ra.innerHTML=Ra.innerHTML.replace(A,"");if(A.length){b=b.ownerDocument.createElement("span");b.innerHTML=A;t=b.innerText.trim();break}t&&t.length||(t="o")}}else 0<=ua&&1===Ra.nodeType&&1<h&&(t=il.$rf(Ra,h-1))}return t}static MPl(b){let h=null;1===b.nodeType&&((h=il.k5h(b,"font-family"))||(h=il.k5h(b,"mso-ascii-font-family")));return h}static k5h(b,h){return(b=il.C7b(b,h))&&0<b.length?b.trim():null}static A4h(b,h){let t=null;for(let A=
0;!t&&A<b.childNodes.length;A++){const O=b.childNodes[A];il.VSc(O)?(t="string"===typeof O.innerText?O.innerText.trim():O.textContent.trim(),t.length||(t="o"),O.parentNode.removeChild(O)):1===O.nodeType&&1<h&&(t=il.A4h(O,h-1))}return t}static VSc(b){return 1===b.nodeType&&(b=il.C7b(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static xAf(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static C7b(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=
b.split(";");for(let t=0;t<b.length;t++){const A=b[t].split(":");if(2===A.length&&A[0].trim()===h)return A[1].trim()}}return null}static gOc(b){do b=b.previousSibling;while(b&&il.zSc(b));return b}static zSc(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(il.RGe,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:il.zSc(b.firstChild):!0}}il.RGe=RegExp("[\n|\r]","gi");Object(m.a)(il,"WacAndRichClientWordConverter",null,[465]);class Sz{constructor(b){this.SZ=
b.$("ExternalPasteImprovementsEnabled")&&b.$("ListMarkerIsEnabled")}create(b=null){return this.SZ?new il(b):new op(b)}}Object(m.a)(Sz,"Box4WordConverterFactory",null,[592]);var is=c(1746);class yl{constructor(b,h,t,A,O){this.wQg=0;this.vWo=aa=>{let ua=!0;const Ra=this.bea.kol;null!=Ra?(aa.Koa=Ra,ua=!1):Date.now()-this.wQg>this.pte&&(u.ULS.sendTraceTag(18354843,307,50,null),this.nd.Zb(gg.a.oma,{["Reason"]:uf.a.MSi}),ua=aa.Koa=!1);return ua};this.nd=b;this.Re=h;this.pte=O;this.bea=t;this.QLa=A}BPk(b,
h,t){u.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,t,this.Re.GF);b.Hg&&this.Re.qq&&window.chrome&&u.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",h);this.bea.NJc(!!(h&16));this.QLa.create(b,this.vWo,null).ul("ClipboardPreProcess");this.wQg=Date.now()}p_n(){this.bea.reset()}}Object(m.a)(yl,"ClipboardOperationClipboardAccessHelper",null,[591]);var Cg=c(364);class Bs{constructor(b,
h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd){this.IVa=null;this.ga=b;this.nd=h;this.Az=t;this.Hh=A;this.ib=O;this.bea=aa;this.eb=ua;this.Ie=Ra;this.qo=ub;this.Xc=Nb;this.Pab=Yb;this.rNe=bc;this.hE=Dc;this.ek=jd;this.rUb=Pc?Pc.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.hld=Pc?Pc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.jd=Cd;this.Mh=Tg.a.getInstance(Cg.a.TYa)}get vg(){return this.Hh}get Jc(){return this.nd}get qSc(){if(null==this.IVa)if(this.jd)if(this.jd.Ip.isCompleted)this.IVa=this.jd.isFeatureEnabled(3);
else return!1;else this.IVa=!1;return this.IVa}oWo(b){b.cV();return!0}NFh(b,h){b=h.ex;u.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let A=!1,O;ba.a.iFa&&v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");this.qSc&&h.je&&h.je.qh&&(A=this.ek.Hkh(h.je.qh.editingElement));O=this.ek.xuf(h.je.qh.editingElement,!1);var t=h.je.qh.editingElement;this.ek.Qyf(t,!1,1);this.rUb&&ba.a.iFa?(t=h.je.qh.editingElement,this.ek.B3f(t,"data-src","data-srcurl"),
b=this.bea.copy(),this.ek.B3f(t,"data-srcurl","data-src")):this.hld&&h.je&&h.je.qh?(t=this.ek.n4e(h.je.qh.editingElement,h.je.Ux,!0),b=this.bea.copy(),t&&this.ek.n4e(h.je.qh.editingElement,h.je.Ux,!1)):(this.ek.w5i(h.je.qh.editingElement),b=this.bea.copy());this.qSc&&A&&this.ek.oUn(h.je.qh.editingElement);O&&this.ek.xuf(h.je.qh.editingElement,!0);t=h.je.qh.editingElement;this.ek.Qyf(t,!1,0);if(!b)return u.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,b.set("ErrorLevel",
"info"),this.Mh.logKpiFailure({kpiName:Cg.a.KBd,errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Jc.Zb(gg.a.UBb,{["Reason"]:uf.a.leg}),h.ZQ&&h.ZQ.fail("SystemClipboard did not copy",!1),h.failed=!0,!1}return!0}s8e(b,h){const t=h.je;u.ULS.shipAssertTag(18130961,307,!!(h.ex&16));h.Dro?this.Az.AAh():this.Az.PEd(t,b);return!0}wMh(b,h){var t=h.context,A=h.qd;const O=h.Z8;var aa=!1;b=this.ib.hb.lb.Rc;if(this.eb.im(b)||this.Ie.Dk(b)){const ua=this.Xc.Wf(b.node),
Ra=ua.yd();u.ULS.shipAssertTag(18130962,307,Ra);this.qo.Zd(ua);this.Pab.Uib(ua)&&(aa=!0)}A=h.ex&64?new ji.DictionaryPropertySet:A||new ji.DictionaryPropertySet;A.setValue(Gd.a.LIc,!1);t=this.ga.Nf(t,qa.a.kH,2,!0,O,A);8===t&&(u.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Jc.Zb(gg.a.oma,{["Reason"]:uf.a.vMh}),h.ZQ&&h.ZQ.fail("DeleteKey failed",!1),this.Mh.logKpiFailure({kpiName:Cg.a.a4e,errorName:"DeleteForCutFailed"}),h.failed=!0);32===t&&this.Mh.logKpiSuccess({kpiName:Cg.a.a4e});32===
t&&aa&&(h=this.ib.hb.lb,this.Ie.hm(h)&&h.Qa.node===b.node&&!this.eb.textLength(h.Qa.node)&&(h=this.Xc.Wf(h.Qa.node),b=this.Ie.au(h),u.ULS.shipAssertTag(18130964,307,b),this.qo.Zd(h),this.Pab.NWd(h)||(b=this.rNe.create(),b.$c(h),this.qo.N_(b,!1,!1),aa=this.qo.Fe(b),this.eb.Yb(aa)&&(this.qo.Zd(b),this.vg.merge(b,h,!1,!1),this.ib.setSelection(this.hE.te(aa,this.eb.textLength(aa)))))));return!0}}Object(m.a)(Bs,"ClipboardOperationCutCopy",null,[617]);class iq{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,
Dc,Pc,jd,Cd){this.ga=b;this.nd=h;this.Az=t;this.bea=aa;this.ib=O;this.Hh=A;this.eb=ua;this.Ie=Ra;this.qo=ub;this.Xc=Nb;this.Pab=Yb;this.rNe=bc;this.hE=Dc;this.Na=Pc;this.ek=jd;this.jd=Cd}create(){return new Bs(this.ga,this.nd,this.Az,this.Hh,this.ib,this.bea,this.eb,this.Ie,this.qo,this.Xc,this.Pab,this.rNe,this.hE,this.Na,this.ek,this.jd)}}Object(m.a)(iq,"Factory",null,[590]);var Xp=c(1669);class Zy{constructor(b,h){this.Ged=null;this.k0k=(t,A)=>{if(!Object(hc.a)(114,A.qd))return!1;const O=Object(Da.a)(114,
A.qd);if(!O.hasProperty(Gd.a.wtf))return!1;const aa=O.getValue(Gd.a.wtf),ua=A.je,Ra=ua.nb;this.Az.aCj();Ra.xMb(()=>{Ra.setSelection(aa,void 0,!0);this.Az.PEd(ua,t)},!0);return!0};this.Az=b;this.r5=h;this.YH=0}process(b,h){this.YH||(this.Ged=[this.k0k,Object(z.a)(this.r5,this.r5.Eun,"pasteGlossaryPlaceholder")]);let t=!0;this.YH<this.Ged.length&&(t=this.Ged[this.YH++](b,h));return t?this.YH<this.Ged.length:!1}}Object(m.a)(Zy,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[618]);class Kv{constructor(b){this.qrb=
null;this.g1=b;this.YH=-1}process(b,h){-1===this.YH&&(this.v$k(b,h),this.YH=0);let t=!1;this.YH<this.qrb.length&&(t=this.qrb[this.YH++](b,h));return t?this.YH<this.qrb.length:!1}v$k(b,h){ba.a.A3||h.ex&512?(this.qrb=[Object(z.a)(this.g1,this.g1.s8e,"copyInternal")],u.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.Hg&&h.ex&256?(this.qrb=[Object(z.a)(this.g1,this.g1.oWo,"waitBeforeCopy"),Object(z.a)(this.g1,this.g1.NFh,"copyExternal"),Object(z.a)(this.g1,
this.g1.s8e,"copyInternal")],u.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.qrb=[Object(z.a)(this.g1,this.g1.NFh,"copyExternal"),Object(z.a)(this.g1,this.g1.s8e,"copyInternal")],u.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));h.ex&32&&(b=Object(z.a)(this.g1,this.g1.wMh,"deleteForCut"),this.qrb.push(b),u.ULS.sendTraceTag(18158337,307,
50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));Cg.a.IWm(h)}}Object(m.a)(Kv,"ClipboardOperationCutCopyProcessor",null,[616]);class hw{constructor(b,h,t,A){this.Ind=null;this.n0k=(O,aa)=>{aa=aa.je;this.Az.cTo();this.Az.PEd(aa,O);return!0};this.KXc=(O,aa)=>{aa=new Kg.Selection([aa.qd],!0);this.ib.setSelection(aa,O);return!0};this.Az=b;this.ib=h;this.g1=t;this.r5=A;this.YH=0}process(b,h){this.YH||(this.Ind=[this.n0k,Object(z.a)(this.g1,this.g1.wMh,"deleteForCut"),this.KXc,
Object(z.a)(this.r5,this.r5.fVi,"pasteInternal"),Object(z.a)(this.r5,this.r5.Ngj,"setSelectionAfterPaste")]);let t=!0;this.YH<this.Ind.length&&(t=this.Ind[this.YH++](b,h));return t?this.YH<this.Ind.length:!1}}Object(m.a)(hw,"ClipboardOperationMoveProcessor",null,[615]);var jq=c(1668);class SA{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd,ee,Od){this.Az=b;this.ga=h;this.Koc=t;this.nd=A;this.Ie=O;this.Re=aa;this.Ic=ua;this.Ydd=Ra;this.nSj=ub;this.XRb=Nb;this.Dte=Yb;this.woc=bc;this.QLa=Dc;
this.fD=Pc;this.Wd=jd;this.Dm=Cd;this.cZ=ee;this.dea=Od}create(b,h,t,A,O,aa,ua,Ra,ub=!0){const Nb=this.Ydd.create(A,Object(Da.a)(114,Ra));var Yb=this.nSj.create();const bc=new Zy(this.Az,Nb),Dc=new hw(this.Az,he.a.instance,Yb,Nb);Yb=new Kv(Yb);A=new jq.a(v.AFrameworkApplication.K,Em.a.instance,A,zk.a.instance,Nb,this.XRb);return new Xp.a(b,h,t,O,aa,ua,Ra,this.Koc,this.ga,this.nd,this.Ie,this.Re,this.Ic,bc,Dc,Yb,A,this.XRb,this.Dte,this.woc,this.QLa,this.fD,this.Wd,this.Dm,this.cZ,this.dea,v.AFrameworkApplication.Hag(),
ub)}}Object(m.a)(SA,"Factory",null,[589]);var iw=c(276);class Tz{constructor(b,h){this.qEb=b.gof(h);this.C8e=b.QKl(h);this.yzb=b.Tlf(h);this.jdb=b.rlf(h)}static GE(b){return Tz.zr(b)}static zr(b){return new Tz(Xy.a.instance,b)}}Object(m.a)(Tz,"CpUsageHelper",null,[]);class ap{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc){this.vL=null;this.c2=!1;this.nd=b;this.Az=h;this.Fxc=t;this.Nsa=A;this.ib=O;this.ga=aa;this.mBe=ua;this.YTe=ub;this.oLe=Ra;this.Vwe=Nb;this.Bte=Yb;this.Wd=bc;this.Mh=Tg.a.getInstance(Cg.a.TYa);
this.c2=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis")}get Ug(){return this.YTe.value}get sqa(){return this.Nsa}get Jc(){return this.nd}get lRa(){return this.oLe.lRa}paste(b,h){const t=this.Wd.DYa();try{const A=h.je,O=h.ex;this.hU&&(this.ib&&this.ib.hb&&this.ib.hb.lb&&iw.TableBorderSelectionCache.Tho(this.ib.hb.lb.Lw||this.ib.hb.lb.bHb),Gl.a.Qfo(this.ib));u.ULS.shipAssertTag(18131010,307,!!(O&1));Object(hc.a)(114,h.qd)&&h.qd.setValue(Jh.a.ofa,A.qh.editingElement.clientWidth);
this.Bte.eIo(b,h);let aa;if(!({qEd:aa}=this.mBe.value.Jvj()).returnValue)return this.DWc(h,"HTML import strategy failed",!1),this.c2?this.Mh.logKpiFailure({kpiName:Cg.a.LMa,errorName:"HtmlImportStrategyFailed",optionalVeto:{name:Cg.a.Plb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):wa.Health.instance.recordQosError("HtmlImportStrategyFailed",[Cg.a.Plb],!1,!0,!0,!1,null),!1;this.Ug.QE();let ua=!0,Ra=null;const ub=this.Vwe.create(aa),Nb=h.YBj;if(!A||!A.nb)return this.DWc(h,
"Fail to set selection.",!1),this.c2?this.Mh.logKpiFailure({kpiName:Cg.a.LMa,errorName:"SetSelectionFailed",optionalVeto:{name:Cg.a.Plb,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):wa.Health.instance.recordQosError("SetSelectionFailed",[Cg.a.Plb],!1,!0,!0,!1,null),!1;A.nb.xMb(()=>{Nb&&2===this.ga.processAction(qa.a.Ula,2)?ua=!1:(Ra=Nb?this.ib&&this.ib.hb&&this.ib.hb.lb?this.ib.hb.lb.Qa:null:h.qd)?(u.ULS.shipAssertTag(18158338,307,nf.SelectionEditor.jf(Ra)),this.IDi(Ra,
"paste")):u.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Nb)},this.oLe.Pvi);if(!ua)return this.DWc(h,"fail to deleteForReplace.",!0),!1;if(!Ra)return this.DWc(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Ra.node||!Ra.node.isConnected)return this.DWc(h,"node is null or not connected in ip context.",!0),!1;A.editingView.disable(!0,25);ub.restore();this.Fxc.yun(aa,Ra,b);return!0}finally{t&&t.dispose()}}DWc(b,h,t){b.failed=!0;b.ZQ&&b.ZQ.fail(h,t)}Eun(b,
h){const t=Object(Da.a)(114,h.qd).getValue(Gd.a.dgi);u.ULS.shipAssertTag(20492440,307,nf.SelectionEditor.jf(t));if(!this.Gzh(t,h))return!1;this.Ug.QE();h=(new vo.a).Qc(15);h.Eb(this.Az.Aia);this.Fxc.Ooi(t,b);this.Az.AAh();h.dispose();return!0}fVi(b,h){const t=this.ib.hb.lb.Qa;if(!this.Gzh(t,h))return!1;this.Ug.QE();this.ga.processAction(qa.a.Ula,2);this.IDi(t,"intPaste");this.Fxc.Ooi(t,b);return!0}Gzh(b,h){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||
!b.isValid)return u.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.LUc),h.ZQ&&(h.ZQ.fail("Invalid ipContext before InternalPasteAtIp",!0),h.failed=!0),h=new Map,h.set("ErrorLevel","warning"),this.Mh.logKpiFailure({kpiName:Cg.a.LMa,errorName:"InvalidIpContextBeforeInternalPasteAtIp",optionalProperties:{additionalValues:{extendedProperties:h}}}),!1;if(!nf.SelectionEditor.jf(b))return u.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",
!!h&&h.LUc,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),b=new Map,b.set("ErrorLevel","warning"),this.Mh.logKpiFailure({kpiName:Cg.a.LMa,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:b}}}),h.ZQ&&(h.ZQ.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.failed=!0),!1}return!0}IDi(b,h){h=Tz.GE(h);this.sqa.XJn(h,b.node,b.cpBegin);this.sqa.KWm(h.C8e);this.sqa.YHf(h.qEb);this.sqa.MHf(h.yzb);this.sqa.JHf(h.jdb)}Ngj(b,h){if(!h.YBj)return!1;
h.ex&64&&this.Az.$Bj();if(!h.E_a)return u.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Jc.Zb(gg.a.J0,{["Reason"]:uf.a.rib}),h.ZQ&&h.ZQ.fail("No selection after paste",!1),h.failed=!0,!1;this.oLe.uSo(h);this.Ug.QE();return!1}get hU(){null==this.vL&&(v.AFrameworkApplication.ye("he991617;3eed2178"),this.vL=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.vL}}Object(m.a)(ap,"ClipboardOperationPaste",
null,[613]);class Ou{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){this.nd=b;this.Az=h;this.Fxc=t;this.Nsa=A;this.ib=O;this.ga=aa;this.YTe=Ra;this.V8j=ua;this.Vwe=ub;this.Bte=Nb;this.Wd=Yb}create(b,h){h=this.V8j.create(this.ib,h);return new ap(this.nd,this.Az,this.Fxc,this.Nsa,this.ib,this.ga,b,h,this.YTe,this.Vwe,this.Bte,this.Wd)}}Object(m.a)(Ou,"Factory",null,[588]);var TA=c(1600);class UA{constructor(b,h){this.Kwo=b;this.vtn=h}}Object(m.a)(UA,"ParagraphFormatStore",null,[]);class Hx{constructor(b,
h,t){this.ib=b;this.eb=h;this.ve=t}eIo(b,h){if(h.V$b){h=b.Koa;var t=this.ib.hb.lb.Qa.node,A=null;this.eb.Yb(t)&&(A=this.ve.Uo(t),t=this.eb.C0a(t),A=new UA(A,t));h=new TA.a(h.context,h.ex,h.ZQ,h.Z8,h.qd,A);b.Koa=h}}}Object(m.a)(Hx,"ClipboardOperationPasteOvertypeStrategy",null,[586]);class pu{constructor(b){this.cHe=null;this.ib=b;b.xMb(h=>{this.cHe=h},!1)}get Pvi(){return!1}uSo(b){b=this.WYe(b);this.setSelection(this.ib,b)}WYe(b){let h=b.E_a;(b.HTa||b.Yha)&&b.Uhe&&(h=wf.SelectionFactory.Vz(b.Uhe,
h.Qa));return h}setSelection(b,h){b.setSelection(h)}}Object(m.a)(pu,"AClipboardOperationPasteStrategy",null,[641]);class VA extends pu{constructor(b){super(b)}get lRa(){return this.cHe}}Object(m.a)(VA,"ClipboardOperationPasteToLiveSelectionStrategy",pu,[]);class iv extends pu{constructor(b,h){super(b);this.aVe=null;this.i5j=h;b.xMb(t=>{this.aVe=t},!0)}get Pvi(){return!0}get lRa(){return this.aVe}WYe(b){let h=super.WYe(b);b.qd.setValue(Gd.a.jVi,h);return h=this.i5j.x8h(this.cHe.lb,this.aVe.lb,h)}}
Object(m.a)(iv,"ClipboardOperationPasteToVirtualSelectionStrategy",pu,[]);class nj{constructor(b){this.$Ue=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ia(Gd.a.HTa,!1)&&this.$Ue?new iv(b,this.OVo):new VA(b)}get OVo(){return null!=this.UFg?this.UFg:this.UFg=Sa.a.instance.Ma("Box4.Actors.IVirtualSelectionMerger")}}Object(m.a)(nj,"ClipboardOperationPasteStrategyFactory",null,[585]);class Tw{constructor(b,h,t,A){this.Jc=b;this.nb=h;this.qn=t;this.Zf=A}hzn(b){(b&1||b&32)&&this.qn.Yp&&
this.nb.MZb()}$ym(b,h){return b&1&&this.Zf.JZ(h,!0)?(this.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.tE}),!1):!0}}Object(m.a)(Tw,"ClipboardOperationWordStrategy",null,[]);class Uz{constructor(){}L_k(b,h){if(h)if(h=h.sheet)if(h=h.cssRules){var t=Array.clone(h);t.reverse();var A=h=0,O=0,aa=0;for(const Ra of t){t=Ra.style;var ua=Ra.selectorText;t=t?t.cssText:null;ua=ua?ua.split(","):null;if(t&&ua&&Ra.type===Ra.STYLE_RULE){aa+=ua.length;for(const ub of ua){0<=ub.indexOf("#")&&h++;0<=ub.indexOf(".")&&A++;0>ub.indexOf("#")&&
0>ub.indexOf(".")&&O++;ua=null;try{ua=b.querySelectorAll(ub)}catch(Nb){u.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",ub,Nb.message)}if(ua)for(let Nb=0;Nb<ua.length;Nb++)ua[Nb].setAttribute("style",t+(ua[Nb].getAttribute("style")||""))}}}u.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",aa,h,A,O)}else this.oEi();else this.oEi()}oEi(){u.ULS.sendTraceTag(41211202,
307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",ba.a.GF)}}Object(m.a)(Uz,"ExternalPasteCssConverter",null,[584]);class $y{constructor(b){this.S2=0;this.YAh=null;this.node=b}}Object(m.a)($y,"ChartConverterArguments",null,[]);class js{constructor(b=null){this._imgNodesConverted=0;this.nW=b||Wq.a.B1h("")}get Hc(){return this.nW}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&
(b=new Li.a(h,this.vrl.bind(this),new $y(b[0])),b.ul("Chart Converter Operation"),b.Hg=!h||h.Hg,b.run())))}vrl(b,h){var t=h.node;if(1<h.S2)return!1;if(1===t.nodeType&&"DIV"===t.tagName){const A=t.getAttribute(jl.tGd);if(A){const O=t.getAttribute(jl.Caf),aa=t.getAttribute(jl.Daf),ua=t.getAttribute(jl.Aaf),Ra=t.getAttribute(jl.Baf),ub=t.getAttribute(jl.JHc);t=t.getAttribute(jl.Eaf);O&&Ra&&aa&&"chart"===aa&&ub&&"XLO"===ub&&(h.YAh=new Rz(A,O,aa,ua,Ra,ub,t))}}b.ai(this.J8m.bind(this));return!0}J8m(b,h){var t=
h.node;if(b=h.YAh)1===t.childElementCount&&1===t.firstChild.nodeType&&"IMG"===t.firstChild.tagName?(t=t.firstChild,t.setAttribute(jl.tGd,b.ccpId),t.setAttribute(jl.Caf,b.pKey),t.setAttribute(jl.Daf,b.type),t.setAttribute(jl.Baf,b.dc),t.setAttribute(jl.JHc,b.client),b.version&&t.setAttribute(jl.Eaf,b.version),b.count&&t.setAttribute(jl.Aaf,b.count),this._imgNodesConverted++):u.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.nW._imgNodesConverted=this._imgNodesConverted;h.S2++;return!1}}
Object(m.a)(js,"ChartConverter",null,[]);class ft{constructor(b,h=null,t=null){this.rf=b;this.nW=h||Wq.a.aci("");this.Jek=t||Wq.a.bci("")}get Hc(){return this.nW}get Meg(){return this.Jek}Pba(b){this.Meg.b++;this.rf.Pba(b)}Mba(){this.rf.Mba()}Oba(b){this.Meg.c++;this.rf.Oba(b)}Nba(){this.rf.Nba()}Lba(b){this.Meg.d++;this.rf.Lba(b)}Kba(){this.rf.Kba()}reset(){this.rf.reset()}get SHc(){return this.rf.SHc}Qba(b,h){this.Hc.b++;this.rf.Qba(b,h)}UFa(b){this.Hc.c++;this.rf.UFa(b)}nlb(b){this.Hc.b++;this.rf.nlb(b)}Swa(b){this.Hc.d++;
this.rf.Swa(b)}PFa(b){this.Hc.f++;this.rf.PFa(b)}RQa(b,h){this.Hc.g++;this.rf.RQa(b,h)}QQa(){this.rf.QQa()}nG(b){this.Hc.h++;this.rf.nG(b)}mG(){this.rf.mG()}klb(){this.rf.klb()}jlb(){this.rf.jlb()}XQa(b,h){this.Hc.i++;this.rf.XQa(b,h)}Y3a(){this.rf.Y3a()}XFa(b){this.Hc.j++;this.rf.XFa(b)}VFa(){this.rf.VFa()}WQa(b){this.Hc.k++;this.rf.WQa(b)}WFa(){this.rf.WFa()}$3a(b){this.Hc.l++;this.rf.$3a(b)}}Object(m.a)(ft,"SemanticEventUsageCollector",null,[466,467]);class bC{constructor(b,h=null,t=null,A=null){this.USj=
"span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");this.rf=b;this.nW=h||Wq.a.f6h(ba.a.Vyb,"");this.Iu=t;this.Cck=A?A.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.Dck=A?A.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):!1;this.aMg=new Z.a(Pa.a.Xh());for(const O of this.USj)this.aMg.add(O)}get Hc(){return this.nW}get Al(){return this.Iu}Ch(b){return b?b+1:1}reset(){this.rf.reset()}w4d(){this.rf.w4d()}Ytf(b){if(b&&this.Al&&(b.getAttribute&&(b.getAttribute(jl.J$k)&&
(this.Al.$Yh=!0),b.getAttribute(jl.tGd)&&(this.Al.xAl=!0),b.getAttribute(jl.JHc)&&(this.Al.C5e=b.getAttribute(jl.JHc)),b.getAttribute(jl.N$k)&&(this.Al.aZh=!0)),b.id&&b.id.startsWith&&b.id.startsWith(jl.ycm)&&(this.Al.bZh=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(jl.rpn)&&(this.Al.fZh=!0);h.startsWith(jl.ryn)&&(this.Al.gZh=!0);h.startsWith(jl.$Xo)&&(this.Al.hZh=!0);if(h.startsWith(ba.a.p2e)&&h.length===ba.a.p2e.length+1){const t=parseInt(F.a.substring(h,
h.length-1,h.length));isNaN(t)||(this.Al.FGc=t)}if(h===jl.V9m||h===jl.W9m)this.Al.vLc=!0}return this.rf.Ytf(b)}onClose(){this.rf.onClose()}uGm(b){for(const h of b)if("\n"!==h)return!0;return!1}Qba(b,h){this.Al&&(this.Al.zAl=!0);this.Al&&!this.Al.Njf&&b&&(this.Al.Njf=this.uGm(b));this.Hc.d=this.Ch(this.Hc.d);this.rf.Qba(b,h)}p4d(b){this.Al&&(this.Al.dZh=!0);this.Hc.e=this.Ch(this.Hc.e);this.oi(b);return this.rf.p4d(b)}vPf(b){this.Hc.f=this.Ch(this.Hc.f);this.oi(b);return this.rf.vPf(b)}wPf(b){this.Hc.g=
this.Ch(this.Hc.g);this.oi(b);return this.rf.wPf(b)}APf(b){this.Hc.h=this.Ch(this.Hc.h);this.oi(b);return this.rf.APf(b)}QPf(b){this.Hc.i=this.Ch(this.Hc.i);this.oi(b);return this.rf.QPf(b)}SPf(b){this.Hc.j=this.Ch(this.Hc.j);this.oi(b);this.rf.SPf(b)}v4d(b){this.Hc.k=this.Ch(this.Hc.k);this.oi(b);return this.rf.v4d(b)}TPf(b){this.Hc.l=this.Ch(this.Hc.l);this.oi(b);this.rf.TPf(b)}UPf(b){this.Hc.m=this.Ch(this.Hc.m);this.oi(b);this.rf.UPf(b)}VPf(b){this.Hc.n=this.Ch(this.Hc.n);this.oi(b);return this.rf.VPf(b)}y4d(b){this.Hc.o=
this.Ch(this.Hc.o);this.oi(b);return this.rf.y4d(b)}z4d(b){this.Hc.p=this.Ch(this.Hc.p);this.oi(b);return this.rf.z4d(b)}iQf(b){this.Hc.q=this.Ch(this.Hc.q);this.oi(b);return this.rf.iQf(b)}A4d(b){this.Hc.r=this.Ch(this.Hc.r);this.oi(b);this.rf.A4d(b)}kQf(b){this.Hc.s=this.Ch(this.Hc.s);this.oi(b);return this.rf.kQf(b)}B4d(b){this.Hc.t=this.Ch(this.Hc.t);this.oi(b);return this.rf.B4d(b)}C4d(b){this.Hc.u=this.Ch(this.Hc.u);this.oi(b);return this.rf.C4d(b)}F4d(b){this.Hc.v=this.Ch(this.Hc.v);this.oi(b);
return this.rf.F4d(b)}G4d(b){this.Hc.w=this.Ch(this.Hc.w);this.oi(b);return this.rf.G4d(b)}wQf(b){this.Hc.x=this.Ch(this.Hc.x);this.oi(b);this.rf.wQf(b)}xQf(b){this.Hc.y=this.Ch(this.Hc.y);this.oi(b);return this.rf.xQf(b)}N4d(b){this.Hc.z=this.Ch(this.Hc.z);this.oi(b);return this.rf.N4d(b)}O4d(b){this.Hc.ba=this.Ch(this.Hc.ba);this.oi(b);return this.rf.O4d(b)}R4d(b){this.Hc.bb=this.Ch(this.Hc.bb);this.oi(b);return this.rf.R4d(b)}S4d(b){this.Hc.bc=this.Ch(this.Hc.bc);this.oi(b);return this.rf.S4d(b)}U4d(b){this.Hc.bd=
this.Ch(this.Hc.bd);this.oi(b);return this.rf.U4d(b)}V4d(b){this.Hc.be=this.Ch(this.Hc.be);this.oi(b);return this.rf.V4d(b)}X4d(b){this.Hc.bf=this.Ch(this.Hc.bf);this.oi(b);return this.rf.X4d(b)}Z4d(b){this.Hc.bg=this.Ch(this.Hc.bg);this.oi(b);return this.rf.Z4d(b)}XQf(b){this.Hc.bh=this.Ch(this.Hc.bh);this.oi(b);return this.rf.XQf(b)}f5d(b){this.Hc.bi=this.Ch(this.Hc.bi);this.oi(b);return this.rf.f5d(b)}dRf(b){this.Hc.bj=this.Ch(this.Hc.bj);this.oi(b);return this.rf.dRf(b)}fRf(b){this.Hc.bk=this.Ch(this.Hc.bk);
this.oi(b);this.rf.fRf(b)}gRf(b){this.Hc.bl=this.Ch(this.Hc.bl);this.oi(b);return this.rf.gRf(b)}i5d(b){this.Hc.bm=this.Ch(this.Hc.bm);this.oi(b);return this.rf.i5d(b)}j5d(b){this.Hc.bm=this.Ch(this.Hc.bm);this.oi(b);return this.rf.j5d(b)}k5d(b){this.Hc.bm=this.Ch(this.Hc.bm);this.oi(b);return this.rf.k5d(b)}l5d(b){this.Hc.bm=this.Ch(this.Hc.bm);this.oi(b);return this.rf.l5d(b)}m5d(b){this.Hc.bm=this.Ch(this.Hc.bm);this.oi(b);return this.rf.m5d(b)}n5d(b){this.Hc.bm=this.Ch(this.Hc.bm);this.oi(b);
return this.rf.n5d(b)}lRf(b){this.Hc.bn=this.Ch(this.Hc.bn);return this.rf.lRf(b)}o5d(b){this.Hc.bo=this.Ch(this.Hc.bo);this.oi(b);this.rf.o5d(b)}rRf(b){this.Hc.bp=this.Ch(this.Hc.bp);return this.rf.rRf(b)}p5d(b){this.Hc.bq=this.Ch(this.Hc.bq);this.oi(b);return this.rf.p5d(b)}sRf(b){this.Hc.br=this.Ch(this.Hc.br);this.oi(b);return this.rf.sRf(b)}s5d(b){this.Al&&(this.Al.cZh=!0);this.oi(b);this.Hc.bs=this.Ch(this.Hc.bs);this.rf.s5d(b)}yRf(b){this.Hc.bt=this.Ch(this.Hc.bt);this.oi(b);this.rf.yRf(b)}t5d(b){this.Hc.bu=
this.Ch(this.Hc.bu);this.oi(b);return this.rf.t5d(b)}ERf(b){this.Hc.bv=this.Ch(this.Hc.bv);this.oi(b);return this.rf.ERf(b)}w5d(b){this.Hc.bw=this.Ch(this.Hc.bw);this.oi(b);return this.rf.w5d(b)}y5d(b){this.Hc.bx=this.Ch(this.Hc.bx);this.oi(b);return this.rf.y5d(b)}A5d(b){this.Hc.by=this.Ch(this.Hc.by);this.oi(b);return this.rf.A5d(b)}B5d(b){this.Al&&(this.Al.vLc=!0);this.Hc.bz=this.Ch(this.Hc.bz);this.oi(b);return this.rf.B5d(b)}RRf(b){this.Hc.ca=this.Ch(this.Hc.ca);this.oi(b);this.rf.RRf(b)}VRf(b){this.Hc.cb=
this.Ch(this.Hc.cb);this.oi(b);return this.rf.VRf(b)}D5d(b){this.Al&&(this.Al.yAl=!0);this.Hc.cc=this.Ch(this.Hc.cc);this.oi(b);return this.rf.D5d(b)}onMenuOpen(b){this.Hc.cd=this.Ch(this.Hc.cd);this.oi(b);return this.rf.onMenuOpen(b)}ZRf(b){this.Hc.ce=this.Ch(this.Hc.ce);this.rf.ZRf(b)}gSf(b){this.Hc.cf=this.Ch(this.Hc.cf);this.oi(b);return this.rf.gSf(b)}hSf(b){this.Hc.cg=this.Ch(this.Hc.cg);this.oi(b);return this.rf.hSf(b)}iSf(b){this.Hc.ch=this.Ch(this.Hc.ch);this.oi(b);return this.rf.iSf(b)}P5d(b){this.Al&&
(this.Al.vLc=!0);this.Hc.ci=this.Ch(this.Hc.ci);this.oi(b);return this.rf.P5d(b)}kSf(b){this.Hc.cj=this.Ch(this.Hc.cj);this.oi(b);return this.rf.kSf(b)}Q5d(b){this.Hc.ck=this.Ch(this.Hc.ck);this.oi(b);return this.rf.Q5d(b)}U5d(b){this.Hc.cl=this.Ch(this.Hc.cl);this.oi(b);return this.rf.U5d(b)}rSf(b){this.Hc.cm=this.Ch(this.Hc.cm);this.oi(b);this.rf.rSf(b)}a6d(b){this.Hc.cn=this.Ch(this.Hc.cn);this.oi(b);return this.rf.a6d(b)}CSf(b){this.Hc.co=this.Ch(this.Hc.co);this.oi(b);return this.rf.CSf(b)}i6d(b){this.Hc.cp=
this.Ch(this.Hc.cp);this.oi(b);return this.rf.i6d(b)}j6d(b){this.Hc.cq=this.Ch(this.Hc.cq);this.oi(b);return this.rf.j6d(b)}XSf(b){this.Hc.cr=this.Ch(this.Hc.cr);return this.rf.XSf(b)}cTf(b){this.Hc.cs=this.Ch(this.Hc.cs);this.oi(b);return this.rf.cTf(b)}r6d(b){this.Hc.ct=this.Ch(this.Hc.ct);this.oi(b);return this.rf.r6d(b)}s6d(b){this.Hc.cu=this.Ch(this.Hc.cu);this.oi(b);return this.rf.s6d(b)}u6d(b){this.Hc.cv=this.Ch(this.Hc.cv);this.oi(b);return this.rf.u6d(b)}v6d(b){this.Hc.cw=this.Ch(this.Hc.cw);
this.oi(b);return this.rf.v6d(b)}gTf(b){this.Hc.cx=this.Ch(this.Hc.cx);return this.rf.gTf(b)}w6d(b){this.Hc.cy=this.Ch(this.Hc.cy);this.oi(b);return this.rf.w6d(b)}z6d(b){this.Hc.cz=this.Ch(this.Hc.cz);this.oi(b);return this.rf.z6d(b)}B6d(b){this.Al&&(this.Al.wma=!0);this.Hc.da=this.Ch(this.Hc.da);this.oi(b);return this.rf.B6d(b)}jTf(b){this.Al&&(this.Al.wma=!0);this.Hc.db=this.Ch(this.Hc.db);this.oi(b);return this.rf.jTf(b)}DZc(b){this.Al&&(this.Al.wma=!0);this.Hc.dc=this.Ch(this.Hc.dc);this.oi(b);
return this.rf.DZc(b)}mTf(b){this.Hc.dd=this.Ch(this.Hc.dd);this.oi(b);return this.rf.mTf(b)}nTf(b){this.Hc.de=this.Ch(this.Hc.de);this.oi(b);return this.rf.nTf(b)}E6d(b){this.Al&&(this.Al.wma=!0);this.Hc.df=this.Ch(this.Hc.df);this.oi(b);return this.rf.E6d(b)}oTf(b){this.Al&&(this.Al.wma=!0);this.Hc.dg=this.Ch(this.Hc.dg);this.oi(b);return this.rf.oTf(b)}rTf(b){this.Hc.dh=this.Ch(this.Hc.dh);this.oi(b);return this.rf.rTf(b)}I6d(b){this.Al&&(this.Al.wma=!0);this.Hc.di=this.Ch(this.Hc.di);this.oi(b);
return this.rf.I6d(b)}J6d(b){this.Hc.dj=this.Ch(this.Hc.dj);this.oi(b);return this.rf.J6d(b)}K6d(b){this.Hc.dk=this.Ch(this.Hc.dk);this.oi(b);return this.rf.K6d(b)}L6d(b){this.Al&&(this.Al.vLc=!0);this.Hc.dl=this.Ch(this.Hc.dl);this.oi(b);return this.rf.L6d(b)}O6d(b){this.Hc.dm=this.Ch(this.Hc.dm);this.oi(b);return this.rf.O6d(b)}XWm(b){var h,t,A;v.AFrameworkApplication.ye("ec3e8394;h715g427");null!==(h=this.Al)&&void 0!==h&&h.vsi&&(h=b.cssText)&&(b=h.match(/[0-9]+em;/g),h=h.match(/[0-9]+rem;/g),
this.Al.qOf+=null!==(t=null===b||void 0===b?void 0:b.length)&&void 0!==t?t:0,this.Al.rOf+=null!==(A=null===h||void 0===h?void 0:h.length)&&void 0!==A?A:0)}oi(b){const h=b.tf;if(h&&this.Al){var t=h.tagName.toLowerCase();this.XWm(h.style);if(this.Cck&&this.Wqi(t)||this.Dck&&!this.Wqi(t)||this.Al.Cri)if("font"===t&&this.kun(b),h.style&&(b=h.style))for(const A of b)A&&0<A.length&&this.Al.uUd(h.tagName,A)}}kun(b){if((b=b.tf)&&"font"===b.tagName.toLowerCase()&&this.Al){var h=b.getAttribute("face");h&&0<
h.length&&this.Al.uUd(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.Al.uUd(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.Al.uUd(b.tagName,"font-attr-size")}}Wqi(b){return this.aMg.contains(b)}}Object(m.a)(bC,"HtmlEventUsageCollector",null,[520]);class Ix{constructor(b,h,t=!1){this.tf=b;this.gB=h;this.Vwk=t}}Object(m.a)(Ix,"TagEventParam",null,[]);class ny{constructor(b,h=null){this.jgd=this._prunedElements=this.LTe=this._voidElements=null;this.od=
b;this.nW=h||Wq.a.g6h("");this.lho()}get Hc(){return this.nW}ccn(b,h,t){this.LTe[h]?this.kLi():(this.Hc.e++,(h=this.jgd[h])&&h(new Ix(b,t,!1)),this.Hc.b++)}kLi(){this.Hc.d++}Ybn(){this.Hc.c++}Kbn(b,h,t){if(this.LTe[h])this.kLi();else{if(h=this.jgd[h])return this.Hc.b++,h(new Ix(b,t,!1));this.Hc.f++}return 2}lho(){this._voidElements=ob.a.N4("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.LTe=ob.a.N4("ABBR",!0,"ACRONYM",
!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=ob.a.N4("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.od,h=this.od,t=this.od,A=this.od,O=this.od,aa=this.od,ua=this.od,Ra=this.od,ub=this.od,Nb=this.od,
Yb=this.od,bc=this.od,Dc=this.od,Pc=this.od,jd=this.od,Cd=this.od,ee=this.od,Od=this.od,fe=this.od,Ee=this.od;this.jgd=ob.a.N4("A",Object(z.a)(this.od,this.od.p4d,"onAOpen"),"ABBR",Object(z.a)(this.od,this.od.vPf,"onAbbrOpen"),"ACRONYM",Object(z.a)(this.od,this.od.wPf,"onAcronymOpen"),"ADDRESS",Object(z.a)(this.od,this.od.APf,"onAddressOpen"),"APPLET",Object(z.a)(this.od,this.od.QPf,"onAppletOpen"),"AREA",Object(z.a)(this.od,this.od.SPf,"onAreaTag"),"B",Object(z.a)(this.od,this.od.v4d,"onBOpen"),
"BASE",Object(z.a)(this.od,this.od.TPf,"onBaseTag"),"BASEFONT",Object(z.a)(this.od,this.od.UPf,"onBasefontTag"),"BDO",Object(z.a)(this.od,this.od.VPf,"onBdoOpen"),"BIG",Object(z.a)(this.od,this.od.y4d,"onBigOpen"),"BLOCKQUOTE",Object(z.a)(this.od,this.od.z4d,"onBlockquoteOpen"),"BODY",Object(z.a)(this.od,this.od.iQf,"onBodyOpen"),"BR",Object(z.a)(this.od,this.od.A4d,"onBrTag"),"BUTTON",Object(z.a)(this.od,this.od.kQf,"onButtonOpen"),"CAPTION",Object(z.a)(this.od,this.od.B4d,"onCaptionOpen"),"CENTER",
Object(z.a)(this.od,this.od.C4d,"onCenterOpen"),"CITE",Object(z.a)(this.od,this.od.F4d,"onCiteOpen"),"CODE",Object(z.a)(this.od,this.od.G4d,"onCodeOpen"),"COL",Object(z.a)(this.od,this.od.wQf,"onColTag"),"COLGROUP",Object(z.a)(this.od,this.od.xQf,"onColgroupOpen"),"DD",Object(z.a)(this.od,this.od.N4d,"onDdOpen"),"DEL",Object(z.a)(this.od,this.od.O4d,"onDelOpen"),"DFN",Object(z.a)(this.od,this.od.R4d,"onDfnOpen"),"DIR",Object(z.a)(this.od,this.od.S4d,"onDirOpen"),"DIV",Object(z.a)(this.od,this.od.U4d,
"onDivOpen"),"DL",Object(z.a)(this.od,this.od.V4d,"onDlOpen"),"DT",Object(z.a)(this.od,this.od.X4d,"onDtOpen"),"EM",Object(z.a)(this.od,this.od.Z4d,"onEmOpen"),"FIELDSET",Object(z.a)(this.od,this.od.XQf,"onFieldsetOpen"),"FONT",Object(z.a)(this.od,this.od.f5d,"onFontOpen"),"FORM",Object(z.a)(this.od,this.od.dRf,"onFormOpen"),"FRAME",Object(z.a)(this.od,this.od.fRf,"onFrameTag"),"FRAMESET",Object(z.a)(this.od,this.od.gRf,"onFramesetOpen"),"H1",Object(z.a)(this.od,this.od.i5d,"onH1Open"),"H2",Object(z.a)(this.od,
this.od.j5d,"onH2Open"),"H3",Object(z.a)(this.od,this.od.k5d,"onH3Open"),"H4",Object(z.a)(this.od,this.od.l5d,"onH4Open"),"H5",Object(z.a)(this.od,this.od.m5d,"onH5Open"),"H6",Object(z.a)(this.od,this.od.n5d,"onH6Open"),"HEAD",Object(z.a)(this.od,this.od.lRf,"onHeadOpen"),"HR",Object(z.a)(this.od,this.od.o5d,"onHrTag"),"HTML",Object(z.a)(this.od,this.od.rRf,"onHtmlOpen"),"I",Object(z.a)(this.od,this.od.p5d,"onIOpen"),"IFRAME",Object(z.a)(this.od,this.od.sRf,"onIframeOpen"),"IMG",Object(z.a)(this.od,
this.od.s5d,"onImgTag"),"INPUT",Object(z.a)(this.od,this.od.yRf,"onInputTag"),"INS",Object(z.a)(this.od,this.od.t5d,"onInsOpen"),"ISINDEX",Object(z.a)(this.od,this.od.ERf,"onIsindexOpen"),"KBD",Object(z.a)(this.od,this.od.w5d,"onKbdOpen"),"LABEL",Object(z.a)(this.od,this.od.y5d,"onLabelOpen"),"LEGEND",Object(z.a)(this.od,this.od.A5d,"onLegendOpen"),"LI",Object(z.a)(this.od,this.od.B5d,"onLiOpen"),"LINK",Object(z.a)(this.od,this.od.RRf,"onLinkTag"),"MAP",Object(z.a)(this.od,this.od.VRf,"onMapOpen"),
"MATH",Object(z.a)(this.od,this.od.D5d,"onMathOpen"),"MENU",Object(z.a)(this.od,this.od.onMenuOpen,"onMenuOpen"),"META",Object(z.a)(this.od,this.od.ZRf,"onMetaTag"),"NOFRAMES",Object(z.a)(this.od,this.od.gSf,"onNoframesOpen"),"NOSCRIPT",Object(z.a)(this.od,this.od.hSf,"onNoscriptOpen"),"OBJECT",Object(z.a)(this.od,this.od.iSf,"onObjectOpen"),"OL",Object(z.a)(this.od,this.od.P5d,"onOlOpen"),"OPTGROUP",Object(z.a)(this.od,this.od.kSf,"onOptgroupOpen"),"OPTION",Object(z.a)(this.od,this.od.Q5d,"onOptionOpen"),
"P",Object(z.a)(this.od,this.od.U5d,"onPOpen"),"PARAM",Object(z.a)(this.od,this.od.rSf,"onParamTag"),"PRE",Object(z.a)(this.od,this.od.a6d,"onPreOpen"),"Q",Object(z.a)(this.od,this.od.CSf,"onQOpen"),"S",Object(z.a)(this.od,this.od.i6d,"onSOpen"),"SAMP",Object(z.a)(this.od,this.od.j6d,"onSampOpen"),"SCRIPT",Object(z.a)(this.od,this.od.XSf,"onScriptOpen"),"SELECT",Object(z.a)(this.od,this.od.cTf,"onSelectOpen"),"SMALL",Object(z.a)(b,b.r6d,"onSmallOpen"),"SPAN",Object(z.a)(h,h.s6d,"onSpanOpen"),"STRIKE",
Object(z.a)(t,t.u6d,"onStrikeOpen"),"STRONG",Object(z.a)(A,A.v6d,"onStrongOpen"),"STYLE",Object(z.a)(O,O.gTf,"onStyleOpen"),"SUB",Object(z.a)(aa,aa.w6d,"onSubOpen"),"SUP",Object(z.a)(ua,ua.z6d,"onSupOpen"),"TABLE",Object(z.a)(Ra,Ra.B6d,"onTableOpen"),"TBODY",Object(z.a)(ub,ub.jTf,"onTbodyOpen"),"TD",Object(z.a)(Nb,Nb.DZc,"onTdOpen"),"TEXTAREA",Object(z.a)(Yb,Yb.mTf,"onTextareaOpen"),"TFOOT",Object(z.a)(bc,bc.nTf,"onTfootOpen"),"TH",Object(z.a)(Dc,Dc.E6d,"onThOpen"),"THEAD",Object(z.a)(Pc,Pc.oTf,"onTheadOpen"),
"TITLE",Object(z.a)(jd,jd.rTf,"onTitleOpen"),"TR",Object(z.a)(Cd,Cd.I6d,"onTrOpen"),"TT",Object(z.a)(ee,ee.J6d,"onTtOpen"),"U",Object(z.a)(Od,Od.K6d,"onUOpen"),"UL",Object(z.a)(fe,fe.L6d,"onUlOpen"),"VAR",Object(z.a)(Ee,Ee.O6d,"onVarOpen"))}}Object(m.a)(ny,"AHtmlProcessor",null,[]);class WA{constructor(b,h){this.childNodes=b.childNodes;this.gB=h;this.O$e=0;this.yWd=!1}}Object(m.a)(WA,"HtmlProcessorArguments",null,[]);class jv extends ny{constructor(b,h=null){super(b,h);this.cEe=null}get wHm(){null==
this.cEe&&(this.cEe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.cEe}process(b,h=null){b&&(this.od.reset(),this.tYi(new WA(b,new Yt.a),h))}tYi(b,h){b.childNodes.length&&(b=new Li.a(h,Object(z.a)(this,this.jBn,"processChild"),b),b.ul("HTML Processing Operation"),h||(b.Hg=!0),b.run())}jBn(b,h){const t=h.childNodes[h.O$e];if(3===t.nodeType)return this.od.w4d(),this.od.Qba(t.nodeValue,new Ix(t,h.gB.U2h())),jv.blc(h);if(1!==t.nodeType)return jv.blc(h);
if(!h.yWd){const O=F.a.BA(t.tagName);if(!jv.Fhm(t))if(this._prunedElements[O])this.Ybn();else{jv.c4m(t);this.od.w4d();var A=t.id;const aa=t.tagName,ua=h.gB.U2h(),Ra=t.getAttribute?t.getAttribute("class"):null;A=new Gp(A,aa,Ra?Ra:"",t.attributes?t.attributes.length:0);A.isValid&&ua.add(A);if(this._voidElements[O])return this.ccn(t,O,ua),jv.blc(h);A=!1;switch(this.Kbn(t,O,ua)){case 1:A=!0;break;case 3:return jv.blc(h)}switch(this.od.Ytf(t)){case 1:A=!0}h.yWd=A;this.tYi(new WA(t,ua),b);if(!b.Hg)return!0}}if(h.yWd){if(this.wHm&&
!this.jgd[F.a.BA(t.tagName)])return jv.blc(h);this.od.onClose()}return jv.blc(h)}static c4m(b){3!==b.nodeType&&ph.a.jl(b,"alreadyPasted",!0)}static Fhm(b){return 3!==b.nodeType&&ph.a.Db(b,"alreadyPasted")}static blc(b){b.O$e++;b.yWd=!1;return b.O$e<b.childNodes.length}}Object(m.a)(jv,"HtmlProcessor",ny,[]);var XA=c(1993),gt=c(781);const Qn={["font-size"]:0,["box-sizing"]:1,["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,
["border-right-width"]:9,["border-bottom-style"]:10,["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,["border-top-color"]:17,["border-right-color"]:18,["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,["border-image-outset"]:22,["border-image-slice"]:23,["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,
["padding-left"]:31,["padding-bottom"]:32,["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,["font-variant-ligatures"]:41,["font-variant-caps"]:42,["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,["font-stretch"]:47,["font-variant-east-asian"]:48,["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,["background-repeat-y"]:52,["background-position-y"]:53,
["background-position-x"]:54,["background-image"]:55,["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,["text-decoration-color"]:62,["text-decoration-style"]:63,["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,["word-spacing"]:69,["orphans"]:70,["widows"]:71,["top"]:72,["border-top-right-radius"]:73,["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,
["border-bottom-left-radius"]:76,["text-decoration-line"]:77,["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,["word-break"]:94,["font-attr-size"]:95,["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,["transition-duration"]:99,["transition-property"]:100,
["transition-timing-function"]:101,["transition-delay"]:102,["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,["align-items"]:107,["flex-direction"]:108,["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,["flex-basis"]:117,["transform-origin"]:118,["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,
["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,["-webkit-border-horizontal-spacing"]:130,["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,["animation-name"]:138,["animation-timing-function"]:139,["animation-fill-mode"]:140,["animation-delay"]:141,["animation-iteration-count"]:142,["animation-direction"]:143,
["animation-play-state"]:144,["pointer-events"]:145,["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,["counter-increment"]:149,["touch-action"]:150,["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,["-webkit-box-align"]:160,["tab-size"]:161,["-webkit-appearance"]:162,["table-layout"]:163,["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,
["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,["empty-cells"]:172,["backface-visibility"]:173,["object-fit"]:174,["--transition-duration"]:175,["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,["-webkit-box-decoration-break"]:181,["filter"]:182,["perspective-origin"]:183,["fill"]:184,["align-content"]:185,["align-self"]:186,
["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,["--darkreader-inline-border-left"]:194,["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,["padding-inline-end"]:200,["padding-block-end"]:201,["padding-block-start"]:202,["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,
["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,["line-break"]:211,["grid-template-rows"]:212,["perspective"]:213,["justify-self"]:214,["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,["--darkreader-inline-outline"]:221,["-webkit-hyphenate-character"]:222,["row-gap"]:223,["scroll-behavior"]:224,
["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,["--message-border-radius-bottom-right"]:230,["--message-border-radius-top-left"]:231,["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,["--chat-default-message-background-color"]:237,["overscroll-behavior-x"]:238,["overscroll-behavior-y"]:239,["contain"]:240,
["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,["column-rule-width"]:247,["--avatar-size"]:248,["--chat-message-align"]:249,["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,["--headerbadgetext"]:258,["--headerbrandtext"]:259,
["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,["--headersearchboxbackground"]:264,["--headersearchboxicon"]:265,["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,["--headertexticons"]:273,["--neutraldark"]:274,
["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,["--neutralquaternaryalt"]:281,["--neutralsecondary"]:282,["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,["--themelighteralt"]:293,["--themeprimary"]:294,
["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,["fill-opacity"]:301,["--mousedown-x"]:302,["--mousedown-y"]:303,["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,["-webkit-mask-position-y"]:312,["No Style Present"]:313,["OTHERS"]:314},oy={["a"]:1,["b"]:2,["big"]:3,
["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,["applet"]:41,["head"]:42,
["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,["tr"]:84,["tt"]:85,
["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89};class YA{constructor(){this.ex=0;this.FGc=6;this.xAl=this.$Yh=!1;this.C5e=null;this.hZh=this.gZh=this.fZh=this.bZh=this.aZh=!1;this.progId=null;this.Njf=this.dZh=this.cZh=this.wma=this.vLc=this.yAl=this.zAl=!1;this.Sun=this.gKb=0;this.aUf=this.platform=null;this.sqi=this.AEf=!1;this.rOf=this.qOf=0;this.Ddk={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,["Excel"]:6,["Word"]:7,["PowerPoint"]:8,["OneNote"]:9,
["Other"]:10};this.Thl=[1,3,4,2,5];this.Vsb={}}get vAm(){if(null!=this.Azg)var b=this.Azg;else{var h;b=this.Azg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent2Enabled",!1)}return b}get Cri(){if(null!=this.zzg)var b=this.zzg;else{var h;b=this.zzg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent1Enabled",!1)}return b}get vsi(){if(null!=
this.Dzg)var b=this.Dzg;else{var h;b=this.Dzg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isEmRemLoggingInPasteEnabled",!1)}return b}get whe(){if(null!==this.C5e)switch(this.C5e){case "XLO":return"Excel Online"}if(this.hZh)return"Word Online";if(this.gZh||this.aZh)return"PowerPoint Online";if(this.$Yh)return"Excel Online";if(this.bZh)return"Google Docs";if(this.fZh)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";
case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}cfa(b,h){const t=new sa.a;t.name=b;"number"===typeof h?t.int64=h:t.bool=h;return t}Ecj(b,h){const t=new gt.a;t.name=b;t.dataFields=h;t.dnmInterval=2;t.dnmAllowedPartA=this.Thl;ja.a.sendDirectNumericEvent(t)}hYm(){const b=this.DGk();if(this.vAm){var h=[];const t=[this.cfa("isUserConsumer",this.AEf),this.cfa("isDocumentBlank",this.sqi),this.cfa("FoundText",this.Njf),this.cfa("FoundTable",
this.wma),this.cfa("FoundImage",this.cZh),this.cfa("FoundList",this.vLc),this.cfa("FoundLink",this.dZh),this.cfa("Browser",this.gKb),this.cfa("SourceApp",this.Ddk[this.whe])];for(const A of t)h.push(A);this.Ecj("Office.DNM.Word.Online.ExternalPasteEvent2",h)}this.vsi&&(h=[this.cfa("NumberOfEm",this.qOf),this.cfa("NumberOfRem",this.rOf)],Object(lb.a)("NoOfTimesEmRemAppeared_PerPaste",!0,void 0,h));u.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}cHh(b,h){var t,A;const O=[];b=this.cfa("tag",null!==
(t=oy[b])&&void 0!==t?t:oy.OTHERS);h=this.cfa("style",null!==(A=Qn[h])&&void 0!==A?A:Qn.OTHERS);A=this.cfa("IsUserConsumer",this.AEf);O.push(b);O.push(h);O.push(A);this.Ecj("Office.DNM.Word.Online.ExternalPasteEvent1",O)}iYm(){const b=this.Vsb;for(const t in b){var h=t;const A=b[t];if(this.Cri){0===Object.keys(A).length&&this.cHh(h,"No Style Present");for(const O of Object.keys(A))this.cHh(h,O)}A&&(A.SourceApp=this.whe,A.Browser=XA.a[this.gKb],A.TagName=h,A.OperationId=this.aUf,u.ULS.sendTraceTag(51406242,
307,50,JSON.stringify(A)))}}uUd(b,h){b&&b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.Vsb||(this.Vsb[b]={}),this.Vsb[b][h]=this.K6l(b,h)+1)}K6l(b,h){if(!(b&&b.length&&h&&h.length&&this.Vsb&&b in this.Vsb))return 0;b=b.toLowerCase();h=h.toLowerCase();return(b=this.Vsb[b])&&h in b?b[h]:0}DGk(){const b={};b.ActionIdFlags=this.ex;b.SourceApp=this.whe;b.CopySourceBrowser=this.FGc;b.PasteBrowser=this.gKb;b.IsSameBrowserPaste=this.lJm(this.FGc,this.gKb);b.IsCrossBrowserPaste=this.iAm(this.FGc,
this.gKb);b.IsUncategorizedBrowserPaste=this.YLm(this.FGc,this.gKb);b.Platform=this.platform;b.OperationId=this.aUf;return b}lJm(b,h){return 5===b||6===b?!1:b===h}iAm(b,h){return 6===b?!1:b!==h}YLm(b,h){return 5===b&&5===h}}Object(m.a)(YA,"HtmlContentMetadata",null,[]);var kv=c(260),gh=c(1432),az=c(1050),kq=c(313),Km=c(150),ZA=c(1670),pi=c(55);class fn{get Dn(){return null!=this.BDg?this.BDg:this.BDg=Sa.a.instance.Ma("Box4.Styles.StyleSettings")}constructor(b,h,t,A,O,aa){this.BZg=!1;this.Ctj=this.lDe=
null;this.Cun=ua=>{Ok.a.mark(5568);this.RTh(ua);let Ra=this.x6m;if(this.Oui){const ub=this.Fkj();ub&&(Ra=this.Rlb);u.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",ub)}ua.ai(Ra);return!0};this.x6m=ua=>{Ok.a.mark(5569);var Ra=new ue.GraphIterator;this.qRa.restore(Ra);fn.hU||(this.qRa=null);var ub=new ue.GraphIterator;this.Xif.restore(ub);this.Xif=null;u.ULS.shipAssertTag(6305489,307,mb.OutlineElementReader.Lh(Ra));u.ULS.shipAssertTag(6305490,307,mb.OutlineElementReader.Lh(ub));
wg.OutlineElementNavigator.Fe(Ra);var Nb=qe.ParagraphReader.rh(Ra)?qe.ParagraphReader.textLength(Ra.currentNode):0;wg.OutlineElementNavigator.Zd(Ra);wg.OutlineElementNavigator.Fe(ub);u.ULS.shipAssertTag(6305491,307,qe.ParagraphReader.rh(ub));var Yb=qe.ParagraphReader.textLength(ub.currentNode);wg.OutlineElementNavigator.Zd(ub);let bc=this.w6c;var Dc=new Xm.a;Dc.$c(Ra);wg.OutlineElementNavigator.Ir(Dc,!1,!1);var Pc=Dc.currentNode===ub.currentNode,jd=!!this.Ji&&!!(this.Ji.ex&8192);let Cd=!1;if(!jd&&
this.Ji.qd&&Object(hc.a)(ji.DictionaryPropertySet,this.Ji.qd)){var ee=this.Ji.qd.Lf(Gd.a.hKb);jd=ee&&""!==ee?!0:!1}ee=!1;this.Ji.qd instanceof kv.APropertySet&&(ee=this.Ji.qd.ia(Gd.a.v3,!1));if(Pc){Nb=ue.GraphIterator.$a(Ra.currentNode);qe.ParagraphReader.Jt(wg.OutlineElementNavigator.Fe(Nb))||(Ra=ub);Ra.currentNode.id!==ub.currentNode.id&&(u.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",hb.ListItemReader.Kh(Ra),hb.ListItemReader.Kh(ub)),
jd=fn.vg.merge(Ra,ub,!0,jd),u.ULS.shipAssertTag(6305492,307,jd));ub=Ra;var Od=!0}else{Pc=!!(this.Ji.ex&4);Od=this.Kd.Cg&&Pc&&this.Ji.b2a;var fe=!!(this.Ji.ex&262144);this.IVf&&this.Ji&&!Pc&&!fe&&(this.IVf.Hhi(Ra,!1),this.IVf.Hhi(ub,!0));wg.OutlineElementNavigator.Fe(Dc);Pc=qe.ParagraphReader.rh(Dc)?qe.ParagraphReader.textLength(Dc.currentNode):0;wg.OutlineElementNavigator.Zd(Dc);pi.a.fr&&this.Ji.ex&65536||this.fzk(Dc,Ra,ub);fe=new Xm.a;fe.$c(Dc);wg.OutlineElementNavigator.Ir(fe,!1,!1);fn.hU&&fe.currentNode.id===
ub.currentNode.id&&(this.BZg=!0);if(this.HW.KMa||this.Iko)if(fe.Kn.id!==ub.Kn.id){for(;Dc.currentNode.id!==ub.currentNode.id;)wg.OutlineElementNavigator.Fe(Dc,!1),this.HW.$Ga(pf.a.create(Dc.currentNode)),Dc.wc(),wg.OutlineElementNavigator.Ir(Dc,!1,!1);Dc.$c(Ra);wg.OutlineElementNavigator.Ir(Dc,!1,!1)}else Cd=!0;this.KY&&({w6c:bc,Pua:Dc}=this.KY.ZBn(Ra,ub,bc,Dc));if(this.Ji.Vbe&&(u.ULS.shipAssertTag(6305493,307,this.Ji.V$b),fe=new ue.GraphIterator,fe.$c(Dc),fe=wg.OutlineElementNavigator.Fe(fe))){var Ee=
this.Ji.Vbe.Sf(fe.qa.J(0));fe.qa.J(0).formatting=Ee}fe=0;jd&&this.pLe&&(fe=1);Ee=this.ilo(Ra,Dc,fe);this.Ji.Uhe=null;if(this.Ji.Yha||this.Ji.HTa)this.Ji.Uhe=this.r6l(Ee?Ra.currentNode:Dc.currentNode,Ee);var re=!1;Ee&&(re=hb.ListItemReader.Kh(Ra),u.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",re,hb.ListItemReader.Kh(ub)),this.lDe=re=fn.vg.merge(Ra,Dc,!0,jd,ub,void 0,Cd,Od,this.pLe),this.jlo(Ra,fe)&&this.V6m(Ra,ub,fe,jd));fe=fn.Qun.Crm(Ra,
Dc,ub,Nb,re,this.CSc);var Fg=!1;if(bc){const Gg=new Xm.a;Gg.$c(ub);wg.OutlineElementNavigator.N_(Gg,!1,!1);Fg=hb.ListItemReader.Kh(Gg);const bm=hb.ListItemReader.Kh(ub),An=ee;u.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",An);Od=fn.vg.merge(Gg,ub,!0,jd,void 0,!0,void 0,Od,this.pLe,An);u.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",Fg,bm,Od?"True":"False, will cause IP to reset to zero.");
ub=(Fg=Od)?Gg:ub}else Od=!1,u.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.HW.KMa&&Cd&&(Ee&&!this.xCm(fe,re)?(Dc=new ue.GraphIterator,Dc.$c(Ra),Ra=wg.OutlineElementNavigator.Fe(Dc),this.HW.Epa(Ra,Nb,Nb+Pc)):bc&&!this.aFm(fe,Fg)?(Ra=new ue.GraphIterator,Ra.$c(Dc),Ra=wg.OutlineElementNavigator.Fe(Ra),this.HW.Epa(Ra,0,Pc)):(Ra=new ue.GraphIterator,Ra.$c(Dc),Ra=wg.OutlineElementNavigator.Fe(Ra),this.HW.$Ga(pf.a.create(Ra))));this.iyn(fe);this.isProgressiveStyleEnabled&&
!jd&&this.oH.bCn(fe)}u.ULS.shipAssertTag(6305494,307,ub.isValid);jd=wg.OutlineElementNavigator.Fe(ub);Yb=Od?qe.ParagraphReader.textLength(jd)-Yb:0;this.Ji.E_a=ee?wf.SelectionFactory.nK(jd,Yb-1,Yb):wf.SelectionFactory.te(jd,Yb);this.Ji&&this.Ji.V$b&&qe.ParagraphReader.Yb(jd)&&this.Ji.h7d&&((Yb=this.Ji.h7d.Kwo)&&this.EG.rJ(Yb,jd,!0),(Yb=this.Ji.h7d.vtn)&&this.paragraphEditor.sqh(jd,Yb));ua.ai(this.Rlb);return!0};this.Ofo=ua=>{const Ra=ue.GraphIterator.$a(this.Ctj);Ra.ME(1);this.Ji.E_a=wf.SelectionFactory.Yn(Ra.currentNode,
!1);ua.ai(this.Rlb);return!0};this.Rlb=()=>{var ua=void 0===this.Ji.ex||null===this.Ji.ex?"not available":Object(gh.a)(ZA.a,this.Ji.ex);u.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Ji.ex,ua);u.ULS.shipAssertTag(6305497,307,!!this.Ji.E_a);this.CSc?Object(lb.a)("ExternalPasteAction",!0):Object(lb.a)("InternalPasteAction",!0);fn.hU&&this.qRa&&(ua=new ue.GraphIterator,this.qRa.restore(ua),this.qRa=null,this.Tgm(ua));this.transaction.dispose();ua=this.Gt.ju;if(!ua.re||!ua.editingView.Pj)return!1;
ua.editingView.uAo();return!1};this.SEa=b;this.Xif=this.qRa=null;this.Ji=h;this.transaction=t;this.KY=A;this.Gt=O;this.O5=aa}get K(){return v.AFrameworkApplication.K}get pLe(){return!!this.K&&this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get oH(){return null!=this.qwg?this.qwg:this.qwg=Sa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get isProgressiveStyleEnabled(){return this.Dn&&this.Dn.isProgressiveStyleEnabled}get EG(){return null!=this.ZFg?this.ZFg:this.ZFg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get uc(){return null!=
this.BGg?this.BGg:this.BGg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get paragraphEditor(){return null!=this.$Bg?this.$Bg:this.$Bg=Sa.a.instance.resolve("Box4.IParagraphEditor")}get Ad(){return null!=this.GAg?this.GAg:this.GAg=Sa.a.instance.resolve("Box4.List.IListReader")}get Qn(){return null!=this.sAg?this.sAg:this.sAg=Sa.a.instance.resolve("Box4.List.IListEditor")}get c_(){return null!=this.bxg?this.bxg:this.bxg=Sa.a.instance.resolve("Box4.IBox4GraphWriter")}get g7c(){return null!=this.fDg?
this.fDg:this.fDg=Sa.a.instance.Ma("Box4.List.ISingleLevelListEditor")}get lj(){return null!=this.OEg?this.OEg:this.OEg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get yh(){return null!=this.oFg?this.oFg:this.oFg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Kd(){return null!=this.XEg?this.XEg:this.XEg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get HW(){return null!=this.Zsg?this.Zsg:this.Zsg=Sa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get IVf(){return null!=
this.lCg?this.lCg:this.lCg=Sa.a.instance.Ma("Box4.IPastedParagraphSpaceHandler")}get tVi(){return!1}STh(){}get CSc(){return!1}iVi(b){var h=void 0===this.Ji.ex||null===this.Ji.ex?"not available":Object(gh.a)(ZA.a,this.Ji.ex);u.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Ji.ex,h);u.ULS.shipAssertTag(6305487,307,nf.SelectionEditor.jf(this.SEa));if(this.S3d)return u.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.Ji.E_a=wf.SelectionFactory.Zn(this.SEa),b.ai(this.Rlb),!0;if(!this.SEa.node)return u.ULS.sendTraceTag(572330334,
307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new ue.GraphIterator;h.set(this.SEa.node);nf.SelectionEditor.au(h);wg.OutlineElementNavigator.Zd(h);this.Ctj=h.origin;if(this.tVi)return h.rt(10),this.STh(h,b),b.ai(this.Ofo),!0;this.KY&&this.KY.Men(this.SEa);if(!this.Oto(this.SEa))return this.Ji.ZQ&&(this.Ji.ZQ.fail("SplitLine Failed",!0),this.Ji.failed=!0),this.Ji.E_a=wf.SelectionFactory.Zn(this.SEa),b.ai(this.Rlb),!0;const t=new Xm.a;t.$c(h);wg.OutlineElementNavigator.Ir(t,
!1,!1);this.qRa=new az.a(h);this.Xif=new az.a(t);b.ai(this.Cun);return!0}Fkj(){return!1}get Oui(){return this.K.$("PptCcpFix2IsEnabled")}get Iko(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}xCm(b,h){return!h&&!!b&&mb.OutlineElementReader.Lh(b.Pua)&&mb.OutlineElementReader.deb(b.Pua)}aFm(b,h){return!h&&!!b&&mb.OutlineElementReader.Lh(b.Jjb)&&mb.OutlineElementReader.deb(b.Jjb)}iyn(b){fn.bXi&&b&&fn.bXi.XBn(b)}ilo(b,h,t){var A;hb.ListItemReader.Kh(b)?(null===(A=this.g7c)||void 0===
A?void 0:A.$wf(b),h=hb.ListItemReader.Kh(h)?this.Yjj:!0):mb.OutlineElementReader.isEmpty(b,!0)&&!t?(fn.vg.d_a(b),h=!1):h=!0;this.KY&&(h=this.KY.tPk(b,h));return h}jlo(b,h){return hb.ListItemReader.Kh(b)||1===h?!0:!1}V6m(b,h,t,A){const O=hb.ListItemReader.Kh(b);if(O){if(A=new Xm.a,A.$c(b),wg.OutlineElementNavigator.Ir(A,!1,!1),A.Kn.id!==h.Kn.id){t=this.Ad.Fw(b);this.Ad.rM(b);var aa=b.currentNode.ia(Lc.a.listID,0);b.wc();var ua=this.Ad.inj,Ra=!0;for(t.vB=Xk.a.vl;A.currentNode.id!==h.currentNode.id;){if(!ua||
!mb.OutlineElementReader.Mmo(A))if(!hb.ListItemReader.Kh(A))Km.a.getInstance().xv?(mb.OutlineElementReader.IPc(A)||({Mva:t}=this.Qn.cla(t.propertySet,A,t)),this.Qn.Pia()):{Mva:t}=this.Qn.cla(t.propertySet,A,t),Ra=!1;else if(O){Ra=this.Ad.hpf(A);var ub=this.Ad.px(b.currentNode,aa,Ra);ub=ub?kq.a.j7(ub,null):t;Ra=kq.a.dT(ub.listType,t.listStyle,null,0,Ra,"","");Ra.Okb=b.currentNode;this.Qn.veo(Ra);this.Qn.Zee(A,!0);Ra=!1}wg.OutlineElementNavigator.Ir(A,!1,!1)}ua&&Ra&&this.Qn.sBk()}}else if(1===t)for(t=
new Xm.a,t.$c(b),wg.OutlineElementNavigator.Fe(t),b=qe.ParagraphReader.rh(t)?t.currentNode:null,aa=this.uc.Srf(t),wg.OutlineElementNavigator.Zd(t),wg.OutlineElementNavigator.Ir(t,!1,!1);t.currentNode.id!==h.currentNode.id;)wg.OutlineElementNavigator.Fe(t),ua=qe.ParagraphReader.rh(t)?t.currentNode:null,wg.OutlineElementNavigator.Zd(t),ua&&b&&A&&(aa&&this.EG.rJ(aa,ua,!0),this.O5.NHi(b,ua,O),this.O5.CFa(b,ua,1,!0)),wg.OutlineElementNavigator.Ir(t,!1,!1)}fzk(b,h,t){var A=!1;if(this.Kd.Cg)if(pi.a.fr)A=
!0;else{var O=!1;this.KY&&(O=h.currentNode,O=this.KY.zHm(O)||this.KY.HCf(O));O?this.Kd.q4a=4:A=!0}if(A){for(;b.currentNode!==t.currentNode;){wg.OutlineElementNavigator.Fe(b,!1);A=this.yh.t7c(pf.a.create(b.currentNode));let aa;({type:aa}=A.jRd()).returnValue&&this.Kd.Bs(aa);for(O=0;O<A.length;O++){let ua;const Ra=({hZd:ua}=A.getContext(O)).returnValue;ua&&(fn.hyperlinkEditor.Ikb(Ra,1),this.lj.Bnb(Ra,1,null,!0))}b.wc();wg.OutlineElementNavigator.Ir(b,!1,!1)}b.$c(h);wg.OutlineElementNavigator.Ir(b,!1,
!1)}}r6l(b,h){b=ue.GraphIterator.$a(b);wg.OutlineElementNavigator.Fe(b);return qe.ParagraphReader.Yb(b.currentNode)?(h=h?qe.ParagraphReader.textLength(b.currentNode):0,wf.SelectionFactory.te(b.currentNode,h)):ni.TableReader.QX(b.currentNode)?wf.SelectionFactory.mq(b.currentNode):null}Tgm(b){if(b){if(this.CSc&&ni.TableReader.Jw(b)&&this.BZg){if(null!=this.lDe&&0==this.lDe){var h=new Xm.a;h.$c(b);wg.OutlineElementNavigator.Ir(h,!1,!1);b.$c(h)}h=Gl.a.RXn(b);const t=qe.ParagraphReader.Rl(h);h&&t&&(this.Ji.E_a=
wf.SelectionFactory.te(t,0),b=ue.GraphIterator.$a(h))}else fn.vHm&&Gl.a.Kun(b);b&&ni.TableReader.Jw(b)&&Wh.returnToContainingCell(b)&&Gl.a.htk(b.currentNode)}else u.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}Hjo(b,h){const t=new ue.GraphIterator;t.$c(b);b=wg.OutlineElementNavigator.Fe(t);h=qe.ParagraphReader.Yb(b)&&h===qe.ParagraphReader.textLength(b);u.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}Oto(b){var h;u.ULS.shipAssertTag(6305498,
307,nf.SelectionEditor.jf(b));if(null===(h=this.c_)||void 0===h?0:h.splitParagraph)return!!this.c_.splitParagraph(b.node,b.cpBegin,{Fb:b.Fb,Sb:b.Sb});h=ue.GraphIterator.$a(b.node);var t=h.yd();wg.OutlineElementNavigator.Zd(h);t&&b.isValid||u.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:t,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!mb.OutlineElementReader.Lh(h)&&(u.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),
this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;t=fn.vg.tna(h,!0);const A=this.Hjo(h,b.cpBegin);fn.vg.p9(h,t,b,!1,!1,!0,A);return!0}static get hyperlinkEditor(){return null!=fn.jxg?fn.jxg:fn.jxg=Sa.a.instance.resolve("Box4.IHyperlinkEditor")}static get lf(){return Lk.PageReader.instance}static get vg(){return null!=fn.lBg?fn.lBg:fn.lBg=Sa.a.instance.resolve("Box4.IOutlineElementEditor")}static get Gl(){return Km.a.getInstance()}static get Xb(){return null!=fn.yvg?fn.yvg:fn.yvg=
Sa.a.instance.Ma("Box4.IFeatureHelper")}static get bXi(){return null!=fn.pCg?fn.pCg:fn.pCg=Sa.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get Qun(){return null!=fn.kCg?fn.kCg:fn.kCg=Sa.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get hU(){null==this.vL&&(v.AFrameworkApplication.ye("he991617;3eed2178"),this.vL=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",
!1):!1);return this.vL}static get vHm(){null==this.bEe&&(v.AFrameworkApplication.ye("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.bEe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",!1):!1);return this.bEe}}fn.vL=null;fn.bEe=null;Object(m.a)(fn,"APasteExecutionManager",null,[]);class Vz{constructor(b){this.Kj=b}reset(){this.Kj.reset()}get SHc(){return this.Kj.SHc}Qba(b,
h){this.Kj.Qba(b,h)}UFa(b){this.Kj.UFa(b)}nlb(b){this.Kj.nlb(b)}Swa(b){this.Kj.Swa(b)}PFa(b){this.Kj.PFa(b)}RQa(b,h){this.Kj.RQa(b,h)}QQa(){this.Kj.QQa()}nG(b){this.Kj.nG(b)}mG(){this.Kj.mG()}klb(){this.Kj.klb()}jlb(){this.Kj.jlb()}XFa(b){this.Kj.XFa(b)}VFa(){this.Kj.VFa()}WQa(b){this.Kj.WQa(b)}WFa(){this.Kj.WFa()}$3a(b){this.Kj.$3a(b)}Pba(b){this.Kj.Pba(b)}Mba(){this.Kj.Mba()}Oba(b){this.Kj.Oba(b)}Nba(){this.Kj.Nba()}Lba(b){this.Kj.Lba(b)}Kba(){this.Kj.Kba()}XQa(b,h){this.Kj.XQa(b,h)}Y3a(){this.Kj.Y3a()}}
Object(m.a)(Vz,"AHtmlNormalizer",null,[466,467]);class $A extends Vz{constructor(b){super(b);this.mJ=!1}Qba(b,h){this.mJ?this.CM.$L(()=>{this.LYf(b,h)}):this.LYf(b,h)}LYf(b,h){this.Kj.Qba(b,h)}UFa(b){this.mJ?this.CM.$L(()=>{this.nYf(b)}):this.nYf(b)}nYf(b){this.Kj.UFa(b)}Swa(b){this.mJ?this.CM.$L(()=>{this.z0c(b)}):this.z0c(b)}z0c(b){this.Kj.Swa(b)}PFa(b){this.mJ?this.CM.$L(()=>{this.mYf(b)}):this.mYf(b)}mYf(b){this.Kj.PFa(b)}RQa(b,h){this.mJ?this.CM.$L(()=>{this.hYf(b,h)}):this.hYf(b,h)}hYf(b,h){this.Kj.RQa(b,
h)}QQa(){this.mJ?this.CM.$L(Object(z.a)(this,this.gYf,"processAnchorEnd")):this.gYf()}gYf(){this.Kj.QQa()}nG(b){this.mJ?this.CM.$L(()=>{this.yYf(b)}):this.yYf(b)}yYf(b){this.Kj.nG(b)}mG(){this.mJ?this.CM.$L(Object(z.a)(this,this.xYf,"processParagraphEnd")):this.xYf()}xYf(){this.Kj.mG()}klb(){this.mJ?this.CM.$L(Object(z.a)(this,this.AYf,"processPreFormattedTextStart")):this.AYf()}AYf(){this.Kj.klb()}jlb(){this.mJ?this.CM.$L(Object(z.a)(this,this.zYf,"processPreFormattedTextEnd")):this.zYf()}zYf(){this.Kj.jlb()}XFa(b){this.mJ?
this.CM.$L(()=>{this.rYf(b)}):this.rYf(b)}rYf(b){this.Kj.XFa(b)}VFa(){this.mJ?this.CM.$L(Object(z.a)(this,this.oYf,"processListEnd")):this.oYf()}oYf(){this.Kj.VFa()}WQa(b){this.mJ?this.CM.$L(()=>{this.qYf(b)}):this.qYf(b)}qYf(b){this.Kj.WQa(b)}WFa(){this.mJ?this.CM.$L(Object(z.a)(this,this.pYf,"processListItemEnd")):this.pYf()}pYf(){this.Kj.WFa()}Pba(b){this.mJ?this.CM.$L(()=>{this.KYf(b)}):this.KYf(b)}KYf(b){this.Kj.Pba(b)}Mba(){this.mJ?this.CM.$L(Object(z.a)(this,this.HYf,"processTableEnd")):this.HYf()}HYf(){this.Kj.Mba()}Oba(b){this.mJ?
this.CM.$L(()=>{this.JYf(b)}):this.JYf(b)}JYf(b){this.Kj.Oba(b)}Nba(){this.mJ?this.CM.$L(Object(z.a)(this,this.IYf,"processTableRowEnd")):this.IYf()}IYf(){this.Kj.Nba()}Lba(b){this.mJ?this.CM.$L(()=>{this.GYf(b)}):this.GYf(b)}GYf(b){this.Kj.Lba(b)}Kba(){this.mJ?this.CM.$L(Object(z.a)(this,this.FYf,"processTableCellEnd")):this.FYf()}FYf(){this.Kj.Kba()}XQa(b,h){this.mJ?this.CM.$L(()=>{this.tYf(b,h)}):this.tYf(b,h)}tYf(b,h){this.Kj.XQa(b,h)}Y3a(){this.mJ?this.CM.$L(Object(z.a)(this,this.OYi,"processMathEnd")):
this.OYi()}OYi(){this.Kj.Y3a()}}Object(m.a)($A,"AQueuingHtmlNormalizer",Vz,[]);var RC=c(1937);class ks{constructor(){this.NMe=new RC.a}$L(b){this.NMe.enqueue(b)}flush(b=!1){for(b&&this.mee();!this.NMe.isEmpty;)this.NMe.dequeue()();b&&this.ice()}mee(){}ice(){}}Object(m.a)(ks,"QueuedEventManager",null,[]);class lo extends ks{constructor(b){super();this.id=void 0;this.baf=null;this.uXd=!1;this.Soa="";this.tXd=this.lYd=!1;this.S$e=this.f3b=null;this.ZXc=0;this.jTc=this.PUc=this.wEf=!1;this.table=null;
this.NNf=0;this.aZ=b}get ZCc(){return!!this.table}mee(){this.aZ.kec.push(this.aZ.currentState);this.aZ.currentState=this}ice(){this.aZ.currentState=this.aZ.kec.pop()}}lo.nextId=void 0;Object(m.a)(lo,"ContentState",ks,[]);class cC{constructor(b,h,t){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.z2a=b.z2a;this.shadingColor=b.shadingColor;this.verticalAlignment=b.verticalAlignment;this.wia=b.wia;this.Wie=b.Wie;this.wac=b.wac;this.U6=b.U6;this.contents=t;this.mcm=
h}}Object(m.a)(cC,"TableCell",null,[]);var Fr=c(1671),dC=c(1672);class aB extends ks{constructor(b,h){super();this.aZ=b;this.yeh=new Yt.a;this.lja=new Yt.a;this.aIe=[];this.bsd=[];this.rJa=-1;this.EUa=0;this.e1j=h.xqi;this.d1j=h.vym;this.Aek=h.peg;this.kq=h.width;this.pZg=h.z2a;this.mZj=new cj.a(new Gp(h.H8.rki,h.H8.NTd),h.gB,h.Moa,h.cultureName,h.tBa);this.Y_j=h.xUd;this.Dud=h.styleId;this.Fek=h.tableLook}get Kj(){return this.aZ.Kj}yzn(b){this.rJa++;this.yeh.add(b);this.bsd[this.rJa]=b.height;this.EUa=
0}get K9k(){for(;this.EUa>=this.lja.count;)this.lja.add(Array(this.rJa+1));return this.lja.J(this.EUa)}gkk(b,h,t,A,O,aa,ua){if(0>this.rJa)return!1;for(;this.aIe[this.EUa]>=this.rJa;)this.EUa++;b=new cC(b,new cj.a(h,t,A,O,aa),ua);this.K9k[this.rJa]=b;if(1<b.rowSpan)for(h=this.rJa+b.rowSpan-1,A=this.EUa,t=this.EUa+b.colSpan-1;A<=t;A++)this.aIe[A]>=h||(this.aIe[A]=h);this.EUa+=b.colSpan;this.bsd[this.rJa]<b.height&&(this.bsd[this.rJa]=b.height);return!0}mee(){this.aZ.currentState.table=this}ice(){this.aZ.currentState.table=
null}get San(){if(null!=this.TAg)var b=this.TAg;else{var h;b=this.TAg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.HtmlNormalizedTableFixes",!1)}return b}HXh(){v.AFrameworkApplication.ye("fd8b6402;j6e17681");this.flush(!0);const b=this.rJa+1;var h=Array(b);for(var t=0;t<b;t++)h[t]=Array(this.lja.count);t=!0;var A=0;for(var O=0;O<this.lja.count;O++){var aa=this.lja.J(O),ua=!0;for(var Ra=0;Ra<b;Ra++){var ub=aa[Ra];ub&&(ua=!1,h[Ra][O+A]=
new Ev(ub.colSpan,ub.rowSpan,ub.width,ub.height,void 0,void 0,void 0,void 0,ub.z2a,ub.wac))}ua?(this.lja.removeAt(O),O--,++A):t=!1}if(!t){(h=this.pZg?this.aZ.Lwh(h,this.kq/100):this.aZ.Lwh(h,1,this.kq))&&h.length!==this.lja.count&&(h=null);this.aZ.sfb(!0);this.aZ.TCd();this.Kj.Pba(new ky(b,this.lja.count,this.kq,this.pZg,h,this.e1j,this.d1j,this.Aek,this.Y_j,this.Dud,this.Fek,this.mZj));for(h=0;h<b;h++){t=this.yeh.J(h);this.Kj.Oba(new Vy(this.bsd[h],new cj.a(t.H8,t.gB,t.Moa,t.cultureName,t.tBa)));
for(t=0;t<this.lja.count;t++){A=this.lja.J(t)[h];var Nb=!!this.Dud&&""!==this.Dud&&"Custom"!==this.Dud;O=A?A.colSpan:0;aa=A?A.rowSpan:0;this.San&&A&&(O=Math.min(A.colSpan,this.lja.count-t),aa=Math.min(A.rowSpan,b-h));ua=A?A.width:0;Ra=A?A.height:0;ub=A?A.U6:0;const Yb=A?A.z2a:!1,bc=A&&(65536&ub||!Nb)?A.shadingColor:"",Dc=A?A.verticalAlignment:0,Pc=A?A.wac:!1;Nb=A?this.aZ.mYl(A.wia,t,h,this.lja,Nb,A.U6):new Fr.a;const jd=A?A.Wie:new dC.a,Cd=A?A.mcm:null;this.Kj.Lba(new Ev(O,aa,ua,Ra,bc,Dc,Nb,jd,Yb,
Pc,ub,new cj.a(Cd?Cd.H8:null,Cd?Cd.gB:null,Cd?Cd.Moa:null,Cd?Cd.cultureName:null,Cd?Cd.tBa:null)));A&&!A.wac&&(A.contents.mee(),A.contents.flush(),this.aZ.sfb(!1),this.aZ.TCd(),A.contents.ice());this.Kj.Kba()}this.Kj.Nba()}this.Kj.Mba();this.aZ.currentState.jTc=!1;this.aZ.JSh(!1)}}}Object(m.a)(aB,"NormalizedTable",ks,[]);class Jx{constructor(b=!1,h=!1){this.O1j=b;this.yka=h}get pEm(){return this.O1j}get j6a(){return this.yka}}Object(m.a)(Jx,"HtmlNormalizerSettings",null,[563]);class Ch extends $A{constructor(b,
h=null){super(b);this.VEe=null;this.kec=new Hu;this.pUb=h||new Jx}reset(){super.reset();this.currentState=new lo(this);this.kec.clear();this.mJ=!1}get CM(){return this.currentState&&this.currentState.ZCc?this.currentState.table:this.currentState}cJd(b=!1){this.currentState.uXd||(this.TCd(),this.Kj.nG(this.currentState.baf),this.currentState.uXd=!0,this.currentState.jTc=!1);b||!this.currentState.f3b||this.currentState.tXd||(this.Kj.RQa(this.currentState.f3b,this.currentState.S$e),this.currentState.tXd=
!0)}MJc(){this.currentState.tXd&&(this.Kj.QQa(),this.currentState.tXd=!1)}lol(){this.currentState.uXd&&(this.Kj.mG(),this.currentState.uXd=!1,this.currentState.Soa="")}JSh(b){this.currentState.PUc&&(this.currentState.jTc?b||(this.Kj.nG(null),this.Kj.mG(),this.Kj.WFa(),this.currentState.PUc=!1):(this.Kj.WFa(),this.currentState.PUc=!1,this.currentState.jTc=!0))}sfb(b){this.MJc();this.lol();this.JSh(b)}gqn(b){this.Kj.XFa(new at.a(2,1,b));this.currentState.ZXc++;this.currentState.wEf=!0}TCd(){!this.currentState.PUc&&
this.currentState.wEf&&(this.Kj.VFa(),this.currentState.ZXc--,this.currentState.wEf=!1)}LYf(b,h){b=this.dbn(b);if(""!==b)if(this.cJd(),this.currentState.lYd)this.MYf(b,h);else{b=b.split(Ch.SIk);for(let t=0;t<b.length-1;t++)this.MYf(b[t],h),this.Kj.nlb(h);this.MYf(b[b.length-1],h)}}tYf(b,h){""!==b&&(this.cJd(),this.Kj.XQa(b,h))}nYf(b){this.pUb.j6a||this.MJc();this.cJd(!0);this.Kj.UFa(b)}mYf(b){this.currentState.ZCc||this.Kj.PFa(b)}z0c(b){this.currentState.f3b&&(b.href=this.currentState.f3b);super.z0c(b)}hYf(b,
h){this.MJc();this.currentState.f3b=b;this.currentState.S$e=h}gYf(){this.MJc();this.currentState.f3b=null;this.currentState.S$e=null}yYf(b){this.currentState.baf=b;this.sfb(!0)}xYf(){this.currentState.baf=null;this.sfb(!0)}AYf(){this.currentState.lYd=!0}zYf(){this.currentState.lYd=!1}rYf(b){this.sfb(!1);this.TCd();this.Kj.XFa(b);this.currentState.ZXc++}oYf(){this.sfb(!1);this.Kj.VFa();this.currentState.ZXc--}qYf(b){this.sfb(!1);this.currentState.ZXc||this.gqn(b);this.Kj.WQa(b);this.currentState.PUc=
!0;this.currentState.jTc=!0}pYf(){this.sfb(!1)}Pba(b){this.currentState.ZCc||(this.mJ=!0,this.currentState.table=new aB(this,b))}KYf(){}Mba(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=null;this.kec.isEmpty?(this.mJ=!1,b.HXh()):this.CM.$L(Object(z.a)(b,b.HXh,"flushTable"))}}HYf(){}Oba(b){this.currentState.ZCc&&this.currentState.table.yzn(b)}JYf(){}Nba(){}IYf(){}Lba(b){let h=!1;if(this.currentState.ZCc){const t=new lo(this);this.currentState.table.gkk(b,new Gp(b.H8.rki,
b.H8.NTd),b.gB,b.Moa,b.cultureName,b.tBa,t)?(this.kec.push(this.currentState),this.currentState=t):h=!0}else h=!0;h&&this.currentState.NNf++}GYf(){}Kba(){0<this.currentState.NNf?this.currentState.NNf--:this.currentState=this.kec.pop()}FYf(){}Lwh(b,h=1,t=0){if(!b)return null;const A=b.length;if(!A)return null;const O=b[0].length;for(var aa=1;aa<A;aa++)if(b[aa].length!==O)return null;aa=Array(O+1);aa[0]=0;const ua=Array(O+1);for(var Ra=0;Ra<ua.length;Ra++)ua[Ra]=!1;const ub=new Mb.a;Ra=0;for(let Yb=
0;Yb<O;Yb++){for(var Nb=0;Nb<A;Nb++){const bc=b[Nb][Yb];if(bc&&0<bc.width){const Dc=Math.min(Yb+bc.colSpan,O);aa[Dc]=aa[Yb]+bc.width*(bc.z2a?h:1);ua[Dc]=!0}}if(ua[Yb+1]){Nb=aa[Yb+1]-aa[Yb];if(0>=Nb)return null;ub.add(Nb)}else aa[Yb+1]=aa[Yb],0<t&&this.Vxi&&(ub.add(-1),Ra++)}b=ub.toArray();if(0<Ra&&0<t&&this.Vxi)for(u.ULS.sendTraceTag(509125462,3022,50,"CalculateTableWidths: All Table Column width not set"),t=(t-aa[aa.length-1])/Ra,h=0;h<b.length;h++)-1===b[h]&&(b[h]=t);return b}get Vxi(){null==this.VEe&&
(v.AFrameworkApplication.ye("2i46g603;2fc7g589"),this.VEe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1):!1);return this.VEe}L4m(b,h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}mYl(b,h,t,A,O,aa){if(!b)return null;O&&(b=this.L4m(b,aa));if(0>t||0>h||h>A.count-1)return b;0<=h-1&&t<=A.J(h-1).length-1&&1===b.borderLeftStyle&&
(O=A.J(h-1)[t])&&1!==O.wia.borderRightStyle&&(b.borderLeftStyle=O.wia.borderRightStyle,b.borderLeftColor=O.wia.borderRightColor,b.borderLeftWidth=O.wia.borderRightWidth);0<=t-1&&t<=A.J(h).length-1&&1===b.borderTopStyle&&(h=A.J(h)[t-1])&&1!==h.wia.borderBottomStyle&&(b.borderTopStyle=h.wia.borderBottomStyle,b.borderTopColor=h.wia.borderBottomColor,b.borderTopWidth=h.wia.borderBottomWidth);return b}dbn(b){this.currentState.lYd||(b=this.pUb.pEm?b.replace(Ch.amm," "):b.replace(Ch.$lm," "));b.startsWith(" ")&&
(this.currentState.Soa.endsWith(" ")||""===this.currentState.Soa)&&(b=F.a.substring(b,1,b.length));return b}MYf(b,h){""!==b&&(this.Kj.Qba(b,h),this.currentState.Soa+=b)}}Ch.$lm=RegExp("[ \t\f\u200b\r\n]+","g");Ch.amm=RegExp("[ \f\u200b\r\n]+","g");Ch.SIk="\t";Object(m.a)(Ch,"DefaultHtmlNormalizer",$A,[]);class py extends Ch{constructor(b,h,t){super(b,t);this.CUg=!1;this.$sb=h}static PAm(b){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?
(b=py.Kdl.exec(b))&&0<b.length:!1}z0c(b){this.$sb.Lec&&(v.AFrameworkApplication.ioa?this.CUg||(b=new cf.StandardDialog,b.zd=0,b.Ge(1,CommonUIStrings.l_DialogClose),b.Au(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.CUg=!0):this.$sb.WGi?this.$sb.m2d=!0:b.src&&""!==b.src?ia.a.getOrigin(b.src)!==ia.a.getOrigin(window.location.href)||py.PAm(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?v.AFrameworkApplication.xa.processAction(qa.a.oVi,2):b.src.startsWith("webkit-fake-url")?
v.AFrameworkApplication.xa.processAction(qa.a.nVi,2):(this.MJc(),this.cJd(!0),this.Kj.Swa(b)):v.AFrameworkApplication.xa.processAction(qa.a.qVi,2):v.AFrameworkApplication.xa.processAction(qa.a.pVi,2))}}py.Kdl=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");Object(m.a)(py,"Box4HtmlNormalizer",Ch,[]);class $g{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){this.htmlProcessor=b;this.Cwf=h;this.MNk=t;this.tEj=A;this.uAl=O;this.L6n=aa;this.M6n=ua;this.MTd=Ra;this.Tlm=ub;this.Wlm=Nb;this.kSm=Yb}}
Object(m.a)($g,"ExecutePasteArguments",null,[]);class lv extends fn{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd){super(h,t,A,Nb,bc,jd);this.Pja=null;this.Xan=ee=>{this.djd.$zi(this.eka)&&v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");this.Kck&&this.djd.gGo(this.eka);ee.ai(this.Dzn);return!0};this.Dzn=ee=>{if(this.Xbk){const Od=this.eka.getElementsByTagName("style");if(Od&&0<Od.length){u.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");
for(let fe=0;fe<Od.length;fe++)this.pye.L_k(this.eka,Od[fe]),Od[fe]&&(Od[fe].parentNode.removeChild(Od[fe]),fe--)}}ee.ai(this.a0k);return!0};this.a0k=(ee,Od)=>{this.uVe.value.create(Od.tEj).process(this.eka,ee);(Od=Sa.a.instance.Ma("Box4.IFeatureHelper"))&&Od.isFeatureEnabled(11)?ee.ai(this.e_k):ee.ai(this.HYi);return!0};this.e_k=(ee,Od)=>{(new js(Od.MNk)).process(this.eka,ee);ee.ai(this.HYi);return!0};this.HYi=(ee,Od)=>{Od.htmlProcessor.process(this.eka,ee);ee.ai(Od.Cwf&&Od.Cwf.Lec?this.aMb:this.VRh);
return!0};this.aMb=(ee,Od)=>{if(Od=Od.Cwf){let Ee=!1,re=!1,Fg=!1,Gg=!1;var fe=-1;const bm=new ji.DictionaryPropertySet,An=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(hc.a)(114,this.Ji.qd)?(Ee=this.Ji.qd.ia(Lc.a.wga,!1),fe=this.Ji.qd.ia(Gd.a.EO,""),Fg=this.Ji.qd.ia(Gd.a.v3,!1),Gg=this.Ji.qd.ia(Af.a.yga,!1),An.test(fe)&&(re=!0),fe=this.Ji.qd.ia(Jh.a.ofa,-1)):this.Ji.ex&256&&this.eka&&(Ee=!0,An.test(this.eka.innerHTML)&&(re=!0));bm.setValue(Lc.a.wga,Ee);bm.setValue(Gd.a.VUc,re);
bm.setValue(Gd.a.v3,Fg);bm.setValue(Jh.a.ofa,fe);bm.setValue(Af.a.yga,Gg);Od.Kee(bm);Od.sSf();Od.Lkb&&(this.Ji.$Sc=!0,this.Ji.Xwf=Od.gT,this.Ji.aPf=Od.Lkb,Ee&&!Fg&&lb.c(qa.a.nrl),v.AFrameworkApplication.xa.processAction(qa.a.aMb,2))}ee.ai(this.VRh);return!0};this.VRh=(ee,Od)=>{Wq.a.V1m(Od.tEj);Wq.a.kYm(Od.Wlm);Wq.a.u0m(Od.L6n);Wq.a.v0m(Od.M6n);Wq.a.QYm(Od.kSm);ee="Others";Od.MTd&&(Od.MTd.hYm(),Od.MTd.iYm(),ee=Od.MTd.whe);Wq.a.jYm(Od.Tlm,ee);Wq.a.OXm(Od.uAl,ee);return!1};this.eka=b;this.dse=O;this.TBe=
aa;this.iSe=ua;this.uVe=Ra;this.ctc=ub;this.pUb=Pc;this.Na=Yb;this.sVg=Object.assign(new ku,{X9b:2===this.Ji.v2b||3===this.Ji.v2b});this.pye=Dc;this.djd=Cd;this.dYb=Yb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.Xbk=Yb.$("ParseStyleFromRawHtmlHeadIsEnabled");this.Kck=Yb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get S3d(){return!1}get CSc(){return!0}RTh(b){this.Pja=new ue.GraphIterator;this.qRa.restore(this.Pja);u.ULS.shipAssertTag(6305550,307,mb.OutlineElementReader.Lh(this.Pja));
this.Ji.ZQ&&this.Ji.ZQ.V_b("external");var h=this.Ji.ex&8192?1:0,t=this.TBe.value.create(h,this.Pja,this.Ji.vFc,this.Ji.Mmb);const A=this.iSe.value.create(h,this.Pja),O=Wq.a.B1h(v.AFrameworkApplication.userSessionId),aa=Wq.a.otf(v.AFrameworkApplication.userSessionId),ua=Wq.a.$nf(ba.a.Vyb,this.Ji.vFc),Ra=Wq.a.aci(v.AFrameworkApplication.userSessionId),ub=Wq.a.bci(v.AFrameworkApplication.userSessionId),Nb=this.dYb?this.grm():null,Yb=Wq.a.f6h(ba.a.Vyb,this.Ji.vFc),bc=Wq.a.g6h(v.AFrameworkApplication.userSessionId),
Dc=this.ctc.Gjj?Wq.a.lVl(v.AFrameworkApplication.userSessionId):null;h=this.dse.value.create(h,this.Pja,t,A,null,ua,this.bvk);h=new ft(h,Ra,ub);h=new py(h,t,this.pUb);h=new mo(h,this.ctc,this.sVg,Dc);h=new bC(h,Yb,Nb,this.Na);h=new jv(h,bc);t=new $g(h,t,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc);t=new Li.a(b,this.Xan,t);t.ul("paste and request pictures");t.Hg=!b||b.Hg;t.run()}get bvk(){return this.eka.getElementsByTagName("a").length}grm(){const b=new YA;b.gKb=ba.a.Vyb;this.Ji&&(b.ex=this.Ji.ex,b.aUf=this.Ji.vFc,
this.Ji.qd&&(b.progId=this.Ji.qd.ia(Gd.a.mVi,"")));this.eka&&this.eka.innerHTML&&(b.Sun=this.eka.innerHTML.length);v.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=v.AFrameworkApplication.sessionStartInfoSettings.Platform,b.AEf=v.AFrameworkApplication.K.$("IsO365ConsumerHost"),b.sqi=qe.ParagraphReader.hta(Jb.App.ya.jb.xc.Zc));return b}get Yjj(){return!0}get w6c(){u.ULS.shipAssertTag(6305551,307,!!this.Pja);if(this.ctc.Hjj(this.sVg)){let b=!1;mb.OutlineElementReader.Lh(this.Pja)&&(this.Pja.Taa(),
b=!0);const h=qe.ParagraphReader.rh(this.Pja)&&!this.Pja.currentNode.ia(Gd.a.zsi,!1);b&&this.Pja.wc();return h}return qe.ParagraphReader.rh(this.Pja)}}Object(m.a)(lv,"ExternalPasteExecutionManager",fn,[]);class bB{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){this.dse=b;this.TBe=h;this.iSe=t;this.uVe=A;this.ctc=O;this.KY=aa;this.Na=ua;this.pye=Ra;this.pUb=ub;this.O5=Nb;this.djd=Yb}create(b,h,t,A){return new lv(b,h,t,A,this.dse,this.TBe,this.iSe,this.uVe,this.ctc.value,this.KY,this.Na,Jb.App.ya.jb,this.pye,
this.pUb,this.O5,this.djd)}}Object(m.a)(bB,"Factory",null,[583]);class cB{$zi(b){if(!b||!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.NBm(b.childNodes[h-2])&&this.cNm(b.childNodes[h-1])}gGo(b){this.$zi(b)&&(b.removeChild(b.lastChild),u.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}pzm(b){return!!b&&8===b.nodeType}xLm(b){return!!b&&3===b.nodeType}NBm(b){return this.pzm(b)&&"EndFragment"===b.nodeValue}cNm(b){if(!this.xLm(b))return!1;b=b.nodeValue;return!!b&&
!b.trim().length}}Object(m.a)(cB,"HtmlNormalizerHelper",null,[582]);var mv=c(1926),eC=c(653);class lq extends fn{constructor(b,h,t,A,O,aa,ua,Ra){super(b,h,t,O,aa,Ra);this.Az=A;this.hI=ua}get nl(){return this.hI.value}get S3d(){return this.Az.S3d()}get tVi(){const b=this.Az;return b.y7e&&!b.Hoi()}STh(b,h){u.ULS.shipAssertTag(6305616,307,mj.OutlineReader.Kw(b));const t=eC.a(b.currentNode);if(mj.OutlineReader.isEmpty(b)){var A=pf.a.create(b.currentNode);b.rt(8);v.AFrameworkApplication.xa.Nf(A,qa.a.kH,
2,!0,null,null)}else b.rt(8);(A=b.ME(1))&&b.wc();this.Az.dVi(this.Ji.je,b.currentNode,A,-1,t,h)}RTh(b){const h=new ue.GraphIterator;this.qRa.restore(h);u.ULS.shipAssertTag(6305618,307,mb.OutlineElementReader.Lh(h));this.Ji.ZQ&&this.Ji.ZQ.V_b("internal");let t=-1;if(Object(hc.a)(114,this.Ji.qd))t=this.Ji.qd.ia(Jh.a.ofa,-1);else{const A=this.LLl(h.currentNode);t=A?A.clientWidth:t}this.Az.dVi(this.Ji.je,h.parentNode,h.currentNode,t,null,b);this.Oui&&(this.qRa.restore(h),mb.OutlineElementReader.Lh(h)&&
this.Az.Sxi(h)&&(b=wg.OutlineElementNavigator.Fe(h)))&&(this.Ji.E_a=wf.SelectionFactory.te(b,0))}LLl(b){return b?(b=b?b.Ee(this.nl.jc):null)?b.htmlElement:null:null}Fkj(){const b=new ue.GraphIterator;this.qRa.restore(b);return this.Az.Sxi(b)}get Yjj(){return!0}get w6c(){return!this.Az.Hua&&!this.Az.y7e}}Object(m.a)(lq,"InternalPasteExecutionManager",fn,[]);class $l{constructor(b,h,t,A){this.Az=b;this.KY=h;this.hI=t;this.O5=A}create(b,h,t){return new lq(b,h,t,this.Az,this.KY,Jb.App.ya.jb,this.hI,this.O5)}}
Object(m.a)($l,"Factory",null,[581]);var qy;(function(b){b[b.unknown=0]="unknown";b[b.differentBox4App=1]="differentBox4App";b[b.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";b[b.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(qy||(qy={}));Object(m.b)("CopySource",qy);class jw{constructor(b,h,t,A){this.Az=b;this.EWg=h;this.EWj=t;this.Fk=A}yun(b,h,t){u.ULS.shipAssertTag(6305620,307,!!b);u.ULS.shipAssertTag(6305621,307,nf.SelectionEditor.jf(h));u.ULS.shipAssertTag(6305622,307,!!t);
u.ULS.shipAssertTag(6305623,307,Object(hc.a)(TA.a,t.Koa));const A=t.Koa;A.v2b=this.Az.W2h(b);this.BYm(b,A);pi.a.pEd&&this.Fk.Gna(h)&&(A.ex|=8192);const O=this.FEm(A);var aa=new Te.GraphTransaction(7,qa.a.paste);aa.Eb(h.node);h.node.pH().NE.Q6(8);O?(u.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",A.ex,A.browserName),b=this.EWg.create(h,A,aa)):(u.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",A.ex,A.v2b,A.browserName),jw.rYm(b),b=this.EWj.create(b,
h,A,aa));t=new Li.a(t,Object(z.a)(b,b.iVi,"pasteSetup"),null);t.ul("Paste");t.run()}FEm(b){return!this.xHm(b)&&3===b.v2b}xHm(b){return 1===(b.ex&8192?1:0)}Ooi(b,h){u.ULS.shipAssertTag(6305624,307,nf.SelectionEditor.jf(b));u.ULS.shipAssertTag(6305625,307,!!h);u.ULS.shipAssertTag(6305626,307,Object(hc.a)(TA.a,h.Koa));const t=new Te.GraphTransaction(7,qa.a.oVd);t.Eb(b.node);b=this.EWg.create(b,h.Koa,t);h=new Li.a(h,Object(z.a)(b,b.iVi,"pasteSetup"),null);h.ul("InternalPasteAtIp");h.run()}BYm(b,h){if(b){let t=
!1,A=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?A=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(t=!0);(t||A)&&u.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",qy[h.v2b],t,A)}}static rYm(b){b&&jw.Ohk.test(b.innerText)&&u.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}jw.Ohk=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");
Object(m.a)(jw,"PasteCoordinator",null,[]);class dB{constructor(b,h,t,A,O){this.Pua=b;this.Jjb=h;this.Pun=t;this.Oun=A;this.CSc=O}}Object(m.a)(dB,"PastedContentsPostProcessorParams",null,[]);class ry{Crm(b,h,t,A,O,aa){b=this.rPl(b,h,O);t=this.aUl(t);if(!b||!t)return null;A=this.m0l(b,A,O);O=this.l0l(t);return new dB(b,t,A,O,aa)}rPl(b,h,t){b=t?b:h;if(!mb.OutlineElementReader.Lh(b))return null;h=new Xm.a;h.$c(b);return h}aUl(b){if(!mb.OutlineElementReader.Lh(b))return null;const h=new Xm.a;h.$c(b);
wg.OutlineElementNavigator.N_(h,!1,!1);return h}m0l(b,h,t){wg.OutlineElementNavigator.Fe(b);let A=-1;qe.ParagraphReader.rh(b)&&(A=t?h:0);wg.OutlineElementNavigator.Zd(b);return A}l0l(b){wg.OutlineElementNavigator.Fe(b);const h=qe.ParagraphReader.rh(b)?qe.ParagraphReader.textLength(b.currentNode):-1;wg.OutlineElementNavigator.Zd(b);return h}}Object(m.a)(ry,"PastedContentsPostProcessorHelper",null,[]);var SC=c(619),Uw=c(1088),qu=c(1087);class bz{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc=null){this.Toa=
b;this.M8=h;this.vo=t;this.LXi=A;this.ta=O;this.n4a=aa;this.K=ua;this.Dun=Ra;this.Wba=ub;this.rEb=Nb;this.Ota=Yb;this.nb=bc;this.Cga=Dc;this.XKh=100;this.Hac=!1;this.fve=null;this.LDe=!1;this.Ipd=null;this.Ild=this.xKa=!1;this.Wxl=(Pc,jd)=>{this.Dw(jd.nul)};this.Soo=(Pc,jd)=>{this.w3k(Pc,jd)};this.W3=(Pc,jd)=>{jd.property===Af.a.lastModifiedTime?(u.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.rEb.Z$e.contains(qa.a.xjg)||this.D_f(jd)):u.ULS.sendTraceTag(520734532,307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};
this.HJb=(Pc,jd)=>{this.D_f(jd)};this.iha=(Pc,jd)=>{jd.$zf||this.D_f(jd)};this.qPi=()=>{SC.a.instance.keyCode===rc.a.Lya&&this.M8.J_i()};this.Euo()}Euo(){this.M8.Xmh(this.Soo);this.M8.Emh(this.Wxl)}w3k(b,h){var t,A,O;(null===(A=null===(t=this.nb.hb)||void 0===t?void 0:t.lb)||void 0===A?0:A.GSc)?u.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):(this.n4a.Byf(),1===this.Dun.L3k(h.O_c)?u.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",
h.correlationId):this.showFloatie(b,h)?(this.xKa?this.xKa=!1:this.fRn(),this.j2c(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",qa.a.GT(h.iY)||"Unknown",h.correlationId),u.ULS.sendTraceTag(40379588,307,50,b),lb.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new sa.a,{name:"PasteCommand",int64:qa.a.GT(h.iY)||"Unknown"}),Object.assign(new sa.a,{name:"CorrelationId",string:null===(O=h.correlationId)||void 0===O?void 0:O.toString()})]),this.DPb()):u.ULS.sendTraceTag(575255108,
307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId))}Dw(b){var h;!this.LDe&&(this.xKa||(this.Cga?null===(h=this.Ota)||void 0===h?0:h.r_:this.Toa.r_()))&&(b&&(this.n4a.Byf(),this.uxj(),u.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.Ipd)),this.xKa=!b,this.zle(),this.Cga?v.AFrameworkApplication.xa.processAction(qa.a.OEb,2):this.Toa.Dw())}fRn(){this.Ild||(this.fve=this.vo.vd,Hf.a.addHandler(this.fve.container,"scroll",
Object(z.a)(this,this.FMb,"scrollHandler")),this.ta.uZ(Object(z.a)(this,this.Pha,"resizeHandler")),this.Ild=!0)}uxj(){this.Ild&&(Hf.a.removeHandler(this.fve.container,"scroll",Object(z.a)(this,this.FMb,"scrollHandler")),this.ta.jca(Object(z.a)(this,this.Pha,"resizeHandler")),this.Ild=!1)}DPb(){if(this.Cga)this.Ota.r_&&v.AFrameworkApplication.xa.processAction(qa.a.OEb,2),v.AFrameworkApplication.xa.processAction(qa.a.U6c,2),this.Hac=!1;else{const b=new qu.a(0,v.AFrameworkApplication.isRtl);b.location=
this.n4a.uOa();this.n4a.DCm(b.location)?this.showFloatie(null,b):this.M8.yGa(new Uw.a(!1))}}Pha(){this.Cga?(v.AFrameworkApplication.xa.processAction(qa.a.OEb,2),this.MHc()):this.DPb()}FMb(){this.Cga?(v.AFrameworkApplication.xa.processAction(qa.a.OEb,2),this.MHc()):this.DPb()}j2c(){this.LXi.Sqk(this.qPi);this.M8.Jmh(Object(z.a)(this.Toa,this.Toa.OJd,"expandFloatie"));this.M8.Tmh(Object(z.a)(this,this.kVi,"pastedFloatieStatusChange"));this.Wba.ku(this.iha);this.Wba.Lv(this.HJb);this.Wba.Ro(this.W3)}zle(){this.LXi.kVn(this.qPi);
this.M8.Q5i(Object(z.a)(this.Toa,this.Toa.OJd,"expandFloatie"));this.M8.Y5i(Object(z.a)(this,this.kVi,"pastedFloatieStatusChange"));this.Wba.DU(this.iha);this.Wba.ica(this.HJb);this.Wba.EU(this.W3)}kVi(b,h){this.LDe=h.FSc;h.iY&&(this.Ipd=h.iY);h.Aag&&this.Toa.r_()&&this.DPb()}D_f(b){b.node.loading||this.M8.yGa(new Uw.a(!0))}showFloatie(b,h){h||(h=new qu.a(0,v.AFrameworkApplication.isRtl));h.location||(h.location=this.n4a.uOa());if(!h.location)return!1;this.xKa&&(this.xKa=!1,this.j2c());this.Cga?v.AFrameworkApplication.xa.processAction(qa.a.U6c,
2):this.Toa.showFloatie(b,h);return!0}MHc(){if(!this.Hac){const b=new Vb.a(3,1,this.XKh,()=>{this.DPb()},215);sf.a.instance.Wb(b);this.Hac=!0}}}Object(m.a)(bz,"PasteFloatieEventManager",null,[]);class sy{constructor(b,h){this.ek=b;this.TH=h}L3k(b){return so.any(so.where(so.asEnumerable(sy.wxo),h=>this.TH.eUc(h)))?(b=this.ek.Mlb(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}sy.wxo=[qa.a.reformatPastedContent.toString(),qa.a.GRa.toString(),qa.a.xxa.toString()];Object(m.a)(sy,"PasteFloatieFeatureSetBuilder",
null,[]);class eB{constructor(){this.gxa=null;this.Gec=0}}Object(m.a)(eB,"PasteFloatieAnchorData",null,[]);class kw{constructor(b,h,t,A,O,aa=!1){this.lvb=null;this.ib=b;this.Esa=h;this.ed=t;this.qYj=A;this.mLe=O;this.kEe=aa}Byf(){this.lvb=null}uOa(){const b=this.Qnf(this.lvb)||this.xwh();if(!b){let h="null",t="null";if(this.lvb&&this.lvb.gxa){if(!this.ed.vd)return u.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.lvb.gxa).getName();
const A=this.ed.vd.Ej(this.lvb.gxa);A&&(t=Object.getType(A).getName())}u.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,t)}return b}DCm(b){if(!b)return!1;const h=this.mLe.hDb(),t=this.qYj(this.ed.vd.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=t.y&&b.y+b.height<=t.y+t.height}xwh(){if(!this.ib||!this.ib.hb||!this.ib.hb.lb)return u.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),
null;var b=this.ib.hb.lb.Qa,h=!b.cpBegin&&!b.cpEnd;let t=b.node;if(t&&h){do t=this.hai(t);while(t&&Object(hc.a)(Tb.AParagraphNode,t)&&!t.characterData.trim().length)}let A="";const O=Object(Da.a)(Tb.AParagraphNode,t);O&&(A=O.characterData.length===b.cpBegin||h?O.characterData.trimEnd():O.characterData.substring(0,b.cpBegin).trimEnd());h=O?A.length:b.cpBegin;b=Object.assign(new eB,{gxa:Object(Da.a)(222,(O?Object(Da.a)(222,O):Object(Da.a)(222,t))||b.node),Gec:h});return this.Qnf(b)}hai(b){const h=new ue.GraphIterator;
if(!b.anchor)return null;h.set(b);if(!h.yd())return null;h.fd(11);return h.QI()?h.Tb(2):null}Qnf(b){if(!b||!b.gxa)return null;this.lvb=b;const h=this.ed.vd;if(!h)return u.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.i6h(b,h);if(!b)return null;v.AFrameworkApplication.isRtl&&this.mLe.r_()&&(b.x-=this.mLe.hDb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}i6h(b,h){h=h.Ee(b.gxa);if(!h)return null;let t=null;if(Object(hc.a)(Tb.AParagraphNode,
b.gxa)){const A=Object(Da.a)(210,h);if(!A)return null;try{t=this.Esa.AZ(b.Gec,A,0<b.Gec,!1,!1,!1),t.height+=this.kEe?kw.sIn:kw.Zxl}catch(O){u.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",O),t=null}}else Object(hc.a)(Bq.TableNode,b.gxa)&&(t=Object(Da.a)(579,h).isf());t||(t=h.getBounds());return t}}kw.Zxl=2;kw.sIn=60;Object(m.a)(kw,"PasteFloatiePositionProvider",null,[]);class Ss{constructor(b,h){this.vqc=b;this.jSj=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get ZYh(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get vaf(){return CommonUIStrings.l_ClipboardCut}get sJf(){return CommonUIStrings.l_ClipboardCut_Mac}get v8e(){return CommonUIStrings.l_ClipboardCopy}get rJf(){return CommonUIStrings.l_ClipboardCopy_Mac}get FVf(){return CommonUIStrings.l_ClipboardPaste}get tJf(){return CommonUIStrings.l_ClipboardPaste_Mac}get N8(){return CommonUIStrings.l_ClipboardPasteText}get uJf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get D5e(){return this.jSj}get $Ah(){return CommonUIStrings.l_ClipboardExtensionLink}get Qdb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}iUh(){u.ULS.sendTraceTag(8716421,
307,50,null);ff.a.km(this.D5e,"_blank",void 0,"ClipboardAccessExtensionLink")}kca(b,h){let t=ba.a.Yk;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(t=ba.a.si||t);return t?String.format(h,"\u2318"):b}dispose(){this.vqc=null}S_f(b){this.SFh(b)}UQm(b){this.SFh(b)}SFh(b){this.vqc&&this.vqc(b)}}Ss.id="CopyPasteShortcutDialog";Ss.bsj="CopyPasteText";Object(m.a)(Ss,"ACopyPasteShortcutDialog",null,[9]);class fC extends Ss{constructor(b,h,t){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=Ss.bsj;var A=document.createElement("span");A.innerText=this.ZYh;var O=document.createElement("span");O.className="UIFontBold";O.innerText=this.kca(this.vaf,this.sJf);const aa=document.createElement("span");aa.className="UIFontBold";aa.innerText=this.kca(this.v8e,this.rJf);const ua=document.createElement("span");ua.className="UIFontBold";ua.innerText=this.kca(this.FVf,this.tJf);h.appendChild(A);h.appendChild(document.createElement("br"));
h.appendChild(O);h.appendChild(aa);h.appendChild(ua);t.$("PasteTextOnlyShortcutDialogIsEnabled")&&(ba.a.qq||ba.a.jj)&&(t=document.createElement("span"),t.className="UIFontBold",t.innerText=this.kca(this.N8,this.uJf),h.appendChild(t));b.appendChild(h);this.D5e?(u.ULS.sendTraceTag(8716420,307,50,null),t=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.$Ah,Hf.a.addHandler(h,"click",Object(z.a)(this,this.iUh,"extensionLinkHandler")),t.appendChild(h),O=this.Qdb.indexOf("{0}"),
-1!==O&&(A=this.Qdb.substring(0,O),O=this.Qdb.substring(O+3,this.Qdb.length),A=document.createTextNode(A),O=document.createTextNode(O),t.insertBefore(A,h),t.appendChild(O)),b.appendChild(document.createElement("br")),b.appendChild(t)):u.ULS.sendTraceTag(8716422,307,50,null);t=new cf.StandardDialog;t.zd=0;t.sg=Ss.id;t.Au(this.titleText,null,0,Object(z.a)(this,this.UQm,"legacyCopyPasteShortcutDialogHandler"),b);t.s4(Ss.bsj)}}Object(m.a)(fC,"CopyPasteShortcutDialog",Ss,[]);class Wz extends Ss{constructor(b,
h){super(b,h);h={};b=this.dvm;h.extensionStartText=this.crl;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.qjo;h.cutText=this.kca(this.vaf,this.sJf);h.copyText=this.kca(this.v8e,this.rJf);h.pasteText=this.kca(this.FVf,this.tJf);4!==v.AFrameworkApplication.ta.Ob.jm&&(h.pasteTextOnly=this.kca(this.N8,this.uJf));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const t=new Pf.a(!1,!1,!0);t.sg="CopyPasteInstallDialog";t.zd=0;t.Ge(1,this.cvm);t.MU(1);t.Yh(b,Object(z.a)(this,
this.S_f,"reactCopyPasteShortcutDialogHandler"),h)}get qjo(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get cvm(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get dvm(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get crl(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static Ano(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(m.a)(Wz,"ReactCopyPasteInstallDialog",Ss,[]);class fB extends Ss{constructor(b){super(b,null);this.hBi="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.man;var t="";let A="";this.messageText&&(t=this.messageText.split(" {")[0],A=this.messageText.split("} ")[1]);h.startText=t;h.endText=A;h.cutText=this.w$k;h.copyText=this.m0k;h.pasteText=this.Gun;
h.cutShortcutText=this.kca(this.x$k,this.Y2m);h.copyShortcutText=this.kca(this.w0k,this.X2m);h.pasteShortcutText=this.kca(this.Jun,this.$2m);h.imageSrc=ah.a.laa("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.sAn;this.hBi&&(u.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.Qjb,["onExecute"]:()=>{this.OQm()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
t=new Pf.a(!1,!1,!0);t.zd=0;t.sg="CopyPasteNoClipboardAccessDialog";t.Yh(b,Object(z.a)(this,this.S_f,"reactCopyPasteShortcutDialogHandler"),h)}get man(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get Qjb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get sAn(){return CommonUIStrings.l_DialogOk}get w$k(){return CommonUIStrings.l_CutString}get x$k(){return CommonUIStrings.l_CutShortcut}get Y2m(){return CommonUIStrings.l_CutShortcut_Mac}get m0k(){return CommonUIStrings.l_CopyString}get w0k(){return CommonUIStrings.l_CopyShortcut}get X2m(){return CommonUIStrings.l_CopyShortcut_Mac}get Gun(){return CommonUIStrings.l_PasteString}get Jun(){return CommonUIStrings.l_PasteShortcut}get $2m(){return CommonUIStrings.l_PasteShortcut_Mac}OQm(){u.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");ff.a.km(this.hBi,"_blank",void 0,"learnMoreLink")}}Object(m.a)(fB,"ReactCopyPasteNoClipboardAccessDialog",Ss,[]);class Kx extends Ss{constructor(b,h,t){super(b,h);b={};b.forwardElementText=this.ZYh;b.cutText=this.kca(this.vaf,this.sJf);b.copyText=this.kca(this.v8e,this.rJf);b.pasteText=this.kca(this.FVf,this.tJf);t.$("PasteTextOnlyShortcutDialogIsEnabled")&&(ba.a.qq||ba.a.jj)&&(b.pasteTextOnly=this.kca(this.N8,this.uJf));this.D5e?(u.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.$Ah,["onExecute"]:A=>{this.iUh(A)}},t=this.Qdb.indexOf("{0}"),-1!==t&&(b.suggestionPrefixElement=this.Qdb.substring(0,t),b.suggestionSuffixElement=this.Qdb.substring(t+3,this.Qdb.length))):u.ULS.sendTraceTag(40726915,307,50,null);t={["id"]:Ss.id,["bodyControls"]:b};b=new Pf.a(!1,!1,!0);b.zd=0;b.sg=Ss.id;b.Yh(this.titleText,Object(z.a)(this,this.S_f,"reactCopyPasteShortcutDialogHandler"),t)}}Object(m.a)(Kx,"ReactCopyPasteShortcutDialog",
Ss,[]);class sr{constructor(){this.zKa=!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.VE}V8e(b,h,t=!1){u.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.zKa,t));this.zKa?t?new Wz(b,h):new Kx(b,h,v.AFrameworkApplication.K):new fC(b,h,v.AFrameworkApplication.K)}static get instance(){return sr._instance||(sr._instance=new sr)}}sr._instance=null;Object(m.a)(sr,"CopyPasteShortcutDialogFactory",null,[1206]);class ls{constructor(b,h,t,A,
O,aa,ua,Ra){this.mch=this.xYg=this.mRe=!1;this.tek=b;this.ed=h;this.Gt=t;this.Vb=A;this.Be=O;this.fg=aa;this.Re=ua;Ra&&(this.mch=Ra.$("ShouldLogExecCommandCopySuccess"))}get ZSa(){return this.tek}get q2a(){return this.xYg}set q2a(b){this.xYg=b;this.fg.ignoreClipboardEvents=b}NJc(b){this.ZSa.NJc(b);b||this.z8c(!0)}get kol(){return this.ZSa.I4f}prepareForPaste(b){this.q2a=!0;this.ZSa.prepareForPaste(b,this.Reg)}reset(){this.q2a=!1}paste(){var b=null;let h=null;if(!this.ZSa.jQb){(b=this.ed.vd)&&this.Vb.mg(b.GI);
var t=this.Gt.ju;if(!t.re||!t.editingView.Pj)return null;h=t.editingView;b=this.Be.Tv();this.q2a=!0;t.r7a()}t=null;try{h&&h.ezn(),t=b=this.ZSa.bKc(this.Reg,b)}catch(A){u.ULS.shipAssertTag(6305672,307,!1),this.Xgi()}this.q2a=!1;return t}copy(){var b=this.ed.vd;b&&this.Vb.mg(b.GI);b=this.Gt.ju;if(!b.re||1!==b.editingView.mode)return!1;this.q2a=!0;let h;try{const t=new Map;t.set("View","ContentEditableView");wa.Health.instance.recordKpiUsage(Cg.a.q1b,0,Cg.a.MBd,t);const A=this.ZSa.wgf(this.Reg);h=!0;
this.mch&&u.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",A,this.Re.GF);if(!A){const O=Object.assign(new Hb.a,{extendedProperties:t});wa.Health.instance.recordKpiFailure(Cg.a.q1b,Cg.a.$3e,!0,!0,O)}}catch(t){u.ULS.shipAssertTag(6305673,307,ba.a.jj),u.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",ba.a.GF),h=!1}this.q2a=!1;return h?!0:!1}z8c(){if(this.mRe)return!0;var b=this.Gt.ju;if(!b.re||!b.editingView.Pj)return!1;
const h=b.editingView;b=this.Be.Tv();this.q2a=!0;const t=new Nu.a(b);let A=!1;try{A=this.ZSa.z8c(b,()=>{h.GCd()},()=>{h.UGa()})}catch(O){}t.restore();this.q2a=!1;A?this.mRe=!0:(u.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",ba.a.GF),this.Xgi());return A}Xgi(){this.mRe=!1;if(v.AFrameworkApplication.dWo)sr.instance.V8e(null,null);else{const b=new cf.StandardDialog;b.zd=0;b.PU(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,
null)}}get Reg(){const b=this.Be.Dgb();return b?b.Ln:null}}Object(m.a)(ls,"SystemClipboard",null,[580]);class gn{constructor(b,h,t){this.pwd=!1;this.Pwd=this.vS=this.n0g=this.Ate=this.Xdd=null;this.Oxn=A=>{1===A?(u.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.ote)),this.uZb&&(u.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.uZb)),ff.a.km(this.gAe+this.tJe,"_blank",void 0,"ChromeCCPInstallDialog"))):A||u.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",
this.ote))};this.ote=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");this.gAe=b.kb("ChromeClipboardAccessExtensionLink");this.S9a=h;this.ek=t;this.tJe=b.kb("ChromeClipboardAccessExtensionId");this.Vgk=b.$("UseGetClipboardDataIsEnabled");this.z9g=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.uZb=!1;b.$("CcpInstallDialogIsEnabled")&&v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.VE&&(this.uZb=Wz.Ano()||b.$("IgnoreDomainCheckCcpInstallDialog"),u.ULS.sendTraceTag(587314304,
307,50,"_useInstallDialog: {0}",this.uZb));this.Brc=null}NJc(b){b?this.vS=!0:(this.vS=null,chrome.runtime&&chrome.runtime.sendMessage?(this.Brc=this.S9a.jGd,this.S9a.ANb?(this.pwd=this.Vgk,this.izh()):(this.pwd=!0,this.izh(),u.ULS.sendTraceTag(19256732,307,50,W.a.create().toString()))):(this.WNb(),this.vS=!1))}get I4f(){return this.vS}get jQb(){return this.Pwd}z8c(){return!0}wgf(b){u.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=ff.a.NBb(b,"copy"))||u.ULS.sendTraceTag(24402116,307,10,
String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)));return b}Vlf(b){if(!b)return null;var h=b.img;const t=b.text;b=b.html;const A=this.ek.Mbj(!!h,!!t,b);let O=null;if(3===A){if(!b)return null;h=this.ek.sUh(b);(h=this.ek.zUh(h))&&(b+=h);O=this.ek.Mlb(b)}else 2===A?O=this.ek.vVf(t,!0):1===A&&(O=this.ek.Mlb(h));return O}bKc(b,h){if(this.jQb)h=this.Vlf(this.Ate),this.Ate=null;else{if(!this.Xdd)return h;b=document.implementation.createHTMLDocument("doc");
b.body.innerHTML=this.Xdd;h=b.body;this.Xdd=null}return h}prepareForPaste(b){const h=W.a.create();this.n0g=h;this.S9a.ANb?u.ULS.sendTraceTag(7377737,307,50,h.toString()):u.ULS.sendTraceTag(19256735,307,50,h.toString());const t={};t.command=this.jQb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.Brc,t,A=>{h.equals(this.n0g)?this.jQb?this.Ate=A:this.Xdd=A:u.ULS.sendTraceTag(7385868,307,50,null);u.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&(this.nkl(),this.S9a.ANb?
u.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):u.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));b()})}WNb(){u.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.uZb?b=this.gAe+this.tJe:this.ote&&(b=this.gAe+this.Brc);sr.instance.V8e(this.Oxn,b,this.uZb)}nkl(){this.S9a.GZn();this.WNb()}Zcj(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}YNk(){const b=W.a.create();this.S9a.ANb?u.ULS.sendTraceTag(592491466,307,50,b.toString()):u.ULS.sendTraceTag(591984031,
307,50,b.toString());chrome.runtime.sendMessage(this.Brc,{command:"getAvailableCommands"},h=>{u.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(hc.a)(Array,h)?(u.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.Pwd=-1!==Array.indexOf(h,"getClipboardData")):(u.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.Pwd=!1):(u.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:
null),this.Pwd=!1)})}izh(){const b=W.a.create();this.S9a.ANb?u.ULS.sendTraceTag(7726105,307,50,b.toString()):u.ULS.sendTraceTag(591984032,307,50,b.toString());this.pwd&&this.YNk();this.Zcj(this.Brc,h=>{u.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.vS=!0:(h?"ping"!==h&&u.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):u.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",
chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.WNb(),this.vS=!1);this.pwd&&!this.jQb&&u.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}zDi(b,h){const t={};t.OfficeOnlineExtensionInstallationStatus=b;t.OfficeClipboardExtensionInstallationStatus=h;u.ULS.sendTraceTag(51144839,307,50,JSON.stringify(t));this.z9g&&(b&&wa.Health.instance.recordKpiSuccess(gn.V4g,null),h&&wa.Health.instance.recordKpiSuccess(gn.S4g,null))}oXm(){this.z9g&&(wa.Health.instance.recordKpiUsage(gn.V4g,
1,gn.RQg,null),wa.Health.instance.recordKpiUsage(gn.S4g,1,gn.RQg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.S9a.ANb;this.Zcj(this.tJe,h=>{this.zDi(b,!!h)})}else this.zDi(!1,!1)}}gn.V4g="OfficeOnlineExtensionInstallationStatus";gn.S4g="OfficeClipboardExtensionInstallationStatus";gn.RQg="wwccp";Object(m.a)(gn,"ChromeSystemClipboardAccessManager",null,[612]);class ty{constructor(b,h){this.vS=null;this.Re=b;this.Na=h;this.EQj=!this.Na.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&
this.Na.$("BlockCopyCutOnFirefoxIsEnabled");this.Pbk=h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}NJc(b){this.EQj&&b&&this.Re.jj?(this.WNb(),this.vS=!1):this.vS=!0}get I4f(){return this.vS}get jQb(){return!1}wgf(b){return ff.a.NBb(b,"copy")}bKc(b,h){ff.a.NBb(b,"paste");return h}prepareForPaste(b){b()}z8c(b,h,t){if(this.Re.u3)return this.Pbk&&(this.vS=!1),!1;h();t();b=this.bKc(b.ownerDocument,b);h=b.innerHTML;b.innerHTML=Ya.a.create().toString();t();b=this.bKc(b.ownerDocument,b);return this.vS=
b=h===b.innerHTML}WNb(){sr.instance.V8e(null,null)}}Object(m.a)(ty,"DefaultSystemClipboardAccessManager",null,[612]);class uy{constructor(b,h,t){this.vS=this.d$=this.HWb=this.fka=this.zWa=this.Tdd=null;this.ek=h;this.IWa=t;this.P4j=b.pc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.uck=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}NJc(b){this.uck&&b&&(this.vS=!0)}get I4f(){return this.vS}get jQb(){return!1}wgf(b){return b?ff.a.NBb(b,
db.a.copy):!1}bKc(b,h){this.zWa&&(h=this.zWa,this.zWa=null);return h}prepareForPaste(b,h=null){if(b&&h){this.Tdd=b;this.HWb=h;$addHandler(this.HWb,db.a.paste,Object(z.a)(this,this.JPi,"onPasteEvent"));this.d$=this.fka=null;if(this.owj(this.HWb)){if(this.d$&&0<this.d$.length&&(!this.fka||this.ek.yme(this.fka))){this.IWa.lFh(this.d$,Object(z.a)(this,this.Hin,"onImageConverted"));this.zWa&&!this.zWa.hasChildNodes()&&u.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.fka&&
this.fka.innerHTML&&((this.zWa=this.ski(this.fka.innerHTML))&&!this.zWa.hasChildNodes()&&u.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),vc.a.eC(this.fka))}this.OWh()}else b&&b()}z8c(b){return this.vS=b=this.owj(b.ownerDocument)}JPi(b){try{b&&b.rawEvent&&((this.fka=b.rawEvent.target)&&this.fka.id&&-1<this.fka.id.indexOf("Paste")?(u.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.fka.id),this.fka=null):this.d$=this.bSl(b.rawEvent))}catch(h){u.ULS.sendTraceTag(22073952,
307,15,"Exception while processing context menu paste event: "+h.toString())}}Hin(b){b&&(this.IWa.ekj&&(b=String.format('<img src="{0}">',b)),this.zWa=this.ski(b));this.OWh()}OWh(){this.HWb&&($removeHandler(this.HWb,db.a.paste,Object(z.a)(this,this.JPi,"onPasteEvent")),this.HWb=null);this.Tdd&&(this.Tdd(),this.Tdd=null)}bSl(b){let h=null;(b=this.ek.U1h(b))&&({swf:h}=this.ek.Qvj(b,this.P4j,this.IWa.NGi));return h}owj(b){return ff.a.NBb(b,db.a.paste)}ski(b){const h=document.implementation.createHTMLDocument("doc");
h.body.innerHTML=b;return h.body}WNb(){}}Object(m.a)(uy,"EdgeSystemClipboardAccessManager",null,[612]);class Sq{constructor(b,h,t,A){this.Na=b;this.$Rj=h;this.ek=t;this.Re=A}create(){let b=null;v.AFrameworkApplication.Dag()&&this.Re.qq&&window.chrome?(u.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new gn(this.Na,this.$Rj,this.ek),this.Na.$("LogChromeExtensionInstallationStatusIsEnabled")&&b.oXm()):this.Na.$("EdgeContextMenuPasteFixIsEnabled")&&this.Re.Rt?(u.ULS.sendTraceTag(22073953,
307,50,"EdgeSystemClipboardAccessManager"),b=new uy(this.Na,Sa.a.instance.resolve("Box4.IClipboardDataHelper"),Sa.a.instance.resolve("Box4.IProcessImageStrategy"),Sa.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(u.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new ty(this.Re,this.Na));return b}}Object(m.a)(Sq,"SystemClipboardAccessManagerFactory",null,[578]);class Lv{Qpl(b){return b}}Object(m.a)(Lv,"DeleteTableSegmentStrategy",null,[577]);
var Cq=c(603),Xf=c(1025);class Bj{get Xp(){return Jv.a.JDb}get paragraphEditor(){return null!=this.SBg?this.SBg:this.SBg=Sa.a.instance.resolve("Box4.IParagraphEditor")}get Y_(){return this.paragraphEditor.Xp}get Jc(){return zk.a.instance}get sA(){return null!=this.cCg?this.cCg:this.cCg=Sa.a.instance.resolve("Box4.IParagraphIndentationReader")}oDc(b,h,t,A,O,aa,ua){let Ra=2;if(!b.re)return 2;const ub=b.nb;if(!ub)return this.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.Gba}),8;if(v.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=
this.mxh(h===qa.a.pG,t,!0);if(1===A)return b?32:8;b&&(Ra=Xf.a.Jec(h,t,A,O,aa,ua))}else Ra=Xf.a.Jec(h,t,1,O,aa,ua),1!==A&&32===Ra?(b.nb.n6d(),b=new Te.GraphTransaction(15),b.Eb(t.view.Zc),Ra=this.mxh(h===qa.a.pG,t,!1)?Xf.a.Jec(h,t,A,O,aa,ua):8,b.dispose()):1!==A&&8===Ra&&(b.nb.n6d(),this.HWk(h,t,ub));return Ra}mxh(b,h,t){h=h.view.nb;if(!h||!h.hb.lb)return this.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.YIb}),!1;if(h.hb.YI)return this.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.x7e}),!1;h=Cq.OutlineElementGeneralizer.xma(h.hb,
!1);if(!h)return this.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.ZJd}),!1;let A=!1;for(let O=0;O<h.length;O++){const aa=h.getContext(O),ua=new ue.GraphIterator;ua.set(aa.node);nf.SelectionEditor.au(ua);if(!mb.OutlineElementReader.Lh(ua))if(t)continue;else return this.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.Ueb}),!1;if(b?!this.Xp.lzb(ua):!this.Xp.b1b(ua))if(t)continue;else return this.Jc.Zb(gg.a.V3b,{["Reason"]:uf.a.T3e}),!1;A=!0}return t?A:!0}HWk(b,h,t){const A=new Te.GraphTransaction(15);try{A.Eb(h.view.Zc);h=!0;const O=
Cq.OutlineElementGeneralizer.xma(t.hb,!1);for(let aa=0;aa<O.length;aa++){const ua=O.getContext(aa),Ra=new ue.GraphIterator;Ra.set(ua.node);nf.SelectionEditor.au(Ra);if(!mb.OutlineElementReader.Lh(Ra))h=!1;else if(b===qa.a.pG?this.Xp.lzb(Ra):this.Xp.b1b(Ra))switch(h=!1,b){case qa.a.pG:this.Xp.tRa(Ra,-1,0);break;case qa.a.RN:this.Xp.dIc(Ra,1)}}if(h){const aa=t.hb.lb;for(t=0;t<aa.length;t++){const ua=aa.J(t);if(ua.Xk){const Ra=this.sA.Mgb(ua.node),ub=Ra.Cca;if(b===qa.a.pG?Ra.iB>ub:Ra.iB<18*ub){const Nb=
new ue.GraphIterator;Nb.set(ua.node);this.Y_.$xa(Nb,1,b===qa.a.pG?Ra.iB>=2.5*ub?Ra.iB-2*ub:ub:Ra.iB<16*ub?Ra.iB+2*ub:18*ub)}}}}}finally{A&&A.dispose()}}}Object(m.a)(Bj,"IndentationActorExtension",null,[576]);var vy=c(750),Dq=c(1217);class Xz{constructor(b,h){this.Un=new ji.DictionaryPropertySet;this.vqd=new ji.DictionaryPropertySet;this.ttb=!1;this.EAa=this.Yqb=null;this.M5=b;this.rSg=h}get Iob(){return null!=this.jEg?this.jEg:this.jEg=Sa.a.instance.Ma("Box4.ITextFormattingCommands")}get oq(){return null!=
this.Dwg?this.Dwg:this.Dwg=Sa.a.instance.resolve("Box4.IFormattingEditor")}get uc(){return null!=this.uGg?this.uGg:this.uGg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}c5a(){this.ttb||(0<this.mPa.yI()&&(this.vqd=this.Un.clone()),this.Un.O1f(),this.Yqb=null,this.qTn())}v0k(b){var h;const t=null!==(h=Wa.FormattingReader.Ar(b))&&void 0!==h?h:Wa.FormattingReader.QNd(b.node,b.cpBegin,-1);!t.cache.lB&&(b=t.sn)&&(h=new ji.DictionaryPropertySet,h.Aw(b),h.Aw(this.Un),h.hasProperty(fh.a.Qv)&&(this.Yqb=
t.paragraph.Mc),this.Un=h)}hasProperty(b){return this.Un.hasProperty(b)}CPc(){return 0<this.Un.yI()}get mPa(){return this.Un}freeze(){this.ttb=!0}JHa(){this.ttb=!1}eG(b,h){return this.mPa.ia(b,h)}wA(b){this.Un.setValue(Af.a.fontSize,this.oq.d2b(b));this.m0();Vm.a.w0f(this.vqd,this.Un)}fontSize(){return this.Un.ia(Af.a.fontSize,Vm.a.XL)}Aee(b){this.Un.setValue(Af.a.font,b);this.rSg&&this.rSg.execute(h=>{null==h?u.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):
h.Aee(this.Un)});this.M5&&this.M5.enabled&&(Jc.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.M5.vbo(this.Un,b));this.m0();Vm.a.w0f(this.vqd,this.Un)}J9f(b){this.Un.setValue(Lc.a.He,b);this.M5&&this.M5.enabled&&(Jc.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.M5.Qgo(this.Un,b));this.m0()}Ev(b){b=xl.a.instance.WMa(he.a.instance.hb.lb.Qa.node,b);this.Un.setValue(Af.a.fontColor,b);this.m0();Vm.a.w0f(this.vqd,this.Un)}Nea(){this.Un.setValue(Af.a.fontColor,
Fl.a.auto);this.m0()}fontColor(){return this.Un.ia(Af.a.fontColor,Fl.a.nil)}Yxa(b){this.Un.setValue(Af.a.highlight,parseInt(b,16));this.m0()}ACd(){this.Un.setValue(Af.a.highlight,Fl.a.auto);this.m0()}isBold(){return this.Un.ia(Af.a.bold,!1)}XK(b){this.Un.setValue(Af.a.bold,b);this.m0()}isItalic(){return this.Un.ia(Af.a.italic,!1)}setItalic(b){this.Un.setValue(Af.a.italic,b);this.m0()}isUnderline(){return this.Un.ia(Af.a.underline,!1)}x4(b){this.Un.setValue(Af.a.underline,b);this.Un.setValue(Af.a.underlineType,
b?Vm.a.uPb:Vm.a.ZU);this.m0()}underlineType(){return this.Un.ia(Af.a.underlineType,Vm.a.ZU)}jia(b){b<Vm.a.uPb||b>Vm.a.ZU||(this.Un.setValue(Af.a.underline,b!==Vm.a.ZU),this.Un.setValue(Af.a.underlineType,b),this.m0())}isSuperscript(){return this.Un.ia(Af.a.superscript,!1)}Kpa(b){this.Un.setValue(Af.a.superscript,b);b&&this.isSuperscript()&&this.Un.setValue(Af.a.subscript,!1);this.m0()}isSubscript(){return this.Un.ia(Af.a.subscript,!1)}hHa(b){this.Un.setValue(Af.a.subscript,b);b&&this.isSubscript()&&
this.Un.setValue(Af.a.superscript,!1);this.m0()}isStrikethrough(){return this.Un.ia(Af.a.strikethrough,!1)}gia(b){this.Un.setValue(Af.a.strikethrough,b);this.m0()}isDoubleStrikethrough(){return this.Un.ia(fh.a.Ou,!1)}uee(b){this.Un.setValue(fh.a.Ou,b);this.m0()}A1h(){return this.Un.ia(fh.a.Qv,null)}Fnb(b,h){this.Un.O1f();this.Un.setValue(fh.a.Qv,b.id);this.Yqb=h.Mc;this.m0()}u4(b){let h=Af.a.IK;const t=vy.a.l_d(b);switch(t){case 1:h=Lc.a.hbc;break;case 2:h=Lc.a.ibc}this.Un.setValue(Lc.a.S2a,t);this.Un.setValue(h,
b);this.m0()}language(){let b=Af.a.IK;switch(this.Un.ia(Lc.a.S2a,0)){case 1:b=Lc.a.hbc;break;case 2:b=Lc.a.ibc}return this.Un.ia(b,0)}Ldo(b){this.Un.setValue(Lc.a.noProof,b);this.m0()}tGb(){return this.Un.ia(Lc.a.noProof,!1)}oGm(){return this.Un.hasProperty(Lc.a.noProof)}XEm(){return this.Un.hasProperty(Af.a.IK)||this.Un.hasProperty(Lc.a.hbc)||this.Un.hasProperty(Lc.a.ibc)}m0(){if(ba.a.Ajc){var b=he.a.instance.hb.lb.Qa,h=b.node;if(h===this.EAa)this.EAa.Wk(16,!0);else{this.EAa=h;h=this.EAa.uY();try{this.EAa.Y2(b.cpBegin).$va=
!0}finally{h&&h.dispose()}}}}qTn(){if(ba.a.Ajc&&this.EAa){var b=0,h=this.EAa.uY();try{for(let t=this.EAa.qa.length-1;0<=t;t--){const A=this.EAa.qa.J(t);A.$va&&(A.$va=!1,b++,A.isEmpty&&this.EAa.qa.removeAt(t))}}finally{h&&h.dispose()}this.EAa=null}}yZk(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.qa.ei(b.cpBegin);return!!b&&b.$va}l_e(b){if(this.Iob){this.freeze();var h=new Te.GraphTransaction(7);h.Eb(b.node);this.Iob.Cee(b);this.JHa();this.c5a();h.dispose()}}yrf(b){const h=qe.ParagraphReader.text(b.node);
return b.cpBegin&&b.cpBegin!==h.length&&!F.a.yv(h.charCodeAt(b.cpBegin))&&Dq.a.instance.m0a(h,b.cpBegin-1)!==b.cpBegin&&nf.SelectionEditor.mjb(b)?(b=nf.SelectionEditor.b3(b,!1))?1<b.length||nf.SelectionEditor.gl(b.Qa)?b:null:null:null}}Object(m.a)(Xz,"InsertionPointFormatting",null,[575]);class wy{constructor(b){this.ga=b}get rc(){return this.ga}qIk(b,h,t=null){const A=new ji.DictionaryPropertySet;A.setValue(Gd.a.lA,b);A.setValue(Gd.a.gQa,h);t&&A.Aw(t);A.CommandSource="autobulleting";this.rc.Rb(qa.a.PC,
2,A)}numbering(b,h,t,A,O){const aa=new ji.DictionaryPropertySet;aa.setValue(Gd.a.lA,b);aa.setValue(Gd.a.gQa,h);aa.setValue(Gd.a.c3a,t);O&&aa.setValue(Jh.a.IP,O);A&&aa.setValue(Lc.a.Vt,A);Km.a.NX&&(aa.setValue(Jh.a.joa,"autocorrect"),O&&aa.setValue(Jh.a.Lga,O));aa.CommandSource="autonumbering";return 32===this.rc.Rb(qa.a.bL,2,aa)}}Object(m.a)(wy,"ListCommands",null,[574]);var Ft=c(241);class Ts extends Ft.a{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){super();this.$Wb=this.Qo=this.pJa=null;this.pBn=(bc,
Dc)=>{Dc=this.jsa.w9d(this.pJa,Dc);bc.ai(this.bBl);return Dc};this.bBl=(bc,Dc)=>{if(this.Qo.moveNext())return bc=this.Qo.currentNode,12!==bc.type||bc===this.pJa.node?!0:this.jsa.B0c(bc,Dc);this.HHk();bc.ai(this.cBl);return!0};this.cBl=(bc,Dc)=>{if(this.Qo.moveNext()){const Pc=this.Qo.currentNode;return 12!==Pc.type?!0:Pc===this.pJa.node?(bc.ai(this.qBn),!0):this.jsa.B0c(Pc,Dc)}return!1};this.qBn=(bc,Dc)=>{this.jsa.x9d(this.pJa,Dc);return!1};this.init(b);this.ul(Yb);this.bib(Ra,h,A,O,aa);this.kL=aa;
this._context=t;this.ib=ub;this.Ie=Nb;this.jsa=ua;this.Dz=0}run(){this.E4e();this.Dz||this.Dio();1===this.Dz&&this.tCn();2===this.Dz&&this.wAo();3===this.Dz&&this.zwl()}E4e(){this.ib.hb&&this.ib.hb.lb?1===this.behavior&&(this.jsa.E4e(this._context)?this.ar=32:this.ar=2,this.Dz=3):(u.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.ar=2,this.Dz=3)}Dio(){this.iHk();this.jsa.k$f(this.pJa)?(this.BGk(),this.Dz=1):(this.ar=8,this.Dz=3)}tCn(){this.dC||new Li.a(this,this.pBn,this.kL);
do if(this.dC.run(),this.dC.inProgress&&!this.Hg)return;while(this.dC.inProgress);this.wCd();this.Dz=2}wAo(){this.jsa.bfg(this)?this.ar=32:this.ar=8;this.Dz=3}zwl(){this.Ipa()}iHk(){let b=this.ib.hb.lb;if(b=this.Ie.Bj(b,!0,!1))this.pJa=b.Qa;this.pJa&&this.pJa.node&&(this.$Wb=this.jsa.yai(this.pJa.node))}BGk(){if(!this.$Wb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Xm.a;b.set(this.pJa.node);b.Ab(this.$Wb.type);this.Qo=Cr.a.at(b,this.$Wb);this.Qo.Sn(Object(z.a)(this.jsa,
this.jsa.$ic,"spellErrorFilter"),null)}HHk(){if(!this.$Wb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Xm.a;b.set(this.$Wb);this.Qo=Cr.a.Tp(b);this.Qo.Sn(Object(z.a)(this.jsa,this.jsa.$ic,"spellErrorFilter"),null)}}Object(m.a)(Ts,"ProofingWholeDocumentOperation",Ft.a,[]);var Vw=c(296);class xy extends Nl{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(m.a)(xy,"ContextMenuRootProperties",Nl,[]);var gB=c(1355);class Ww{constructor(b){const h=new xy;
h.ImageSideArrow=v.AFrameworkApplication.Ks;h.ImageSideArrowClass=dh.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=qa.a.S8d.toString();this.Xeh=new gB.ContextMenuRoot("ContextMenuRootName",h);b.execute(t=>{this.C0.eF=t});this.C0.refresh();v.AFrameworkApplication.xa.pa(ab.a.showContextMenu,yc.a.frame,Kf.ActionManager.Kf);v.AFrameworkApplication.xa.pa(ab.a.zic,yc.a.frame,Kf.ActionManager.Kf)}get C0(){return this.Xeh}dispose(){this.C0&&
(this.C0.dispose(),this.Xeh=null)}showContextMenu(b,h){this.Rnb(b,h.clientPoint,h.ig)}B2b(b,h,t,A,O){this.C0.B2b(b,h,t,A,O)}X5a(b,h,t){ff.a.r2d(this.C0.cYa?"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu","");Jb.App.ya.Uzl();this.Xt();this.C0.X5a(b,h,t);this.C0.cYa?v.AFrameworkApplication.xa.processAction(ab.a.zic,2):v.AFrameworkApplication.xa.processAction(ab.a.showContextMenu,2)}Rnb(b,h,t){this.X5a(b,new Sys.UI.Bounds(h.x,h.y,0,0),t)}Xt(){this.C0.root.qm()}W2(){return this.C0.W2()}zic(b,
h,t,A){const O=this.C0;let aa=!1;t=Object(Da.a)(Rw,t);O.cYa=t;A.dya(b,h);O.pWe?t&&(t.Vxn(O,h),aa=!0):(u.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",A.Y9k()),O.cYa=null);return aa}}Object(m.a)(Ww,"AContextMenuController",null,[611,9]);class xp{}xp.nfc="faProofing";xp.HQh="EditorMenuSection";Object(m.a)(xp,"ContextMenuControlId",null,[]);var lw=c(554);class Xw{constructor(b){this.Ie=b}E4e(b){b=Object(Da.a)(lw.a,b);return!!b&&!!b.view&&b.view.re}k$f(){return!0}w9d(){return!0}B0c(){return!0}x9d(){}bfg(){return!0}$ic(b){if(b.Dr)return!0;
b=b.role;return 1===b||2===b||3===b||4===b||5===b}yai(b){if(!b||!this.Ie)return b;const h=new Xm.a;h.set(b);if(this.Ie.au(h)){for(;!h.Dr;)h.wc();return h.currentNode}return b}}Object(m.a)(Xw,"SimpleProofingWholeDocumentCallBacks",null,[518]);class hB{constructor(b){this.value=b}}Object(m.a)(hB,"RefBool",null,[]);class Cs{constructor(){this.VJc=this.WIb=null;this.Zwj=new hB(!1)}}Object(m.a)(Cs,"FindNextErrorOperationParam",null,[]);class Gt{constructor(){this.Priority=0;this.Context=null;this.Length=
this.StartInContext=this.Start=0;this.Metadata=Gt.fml;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}Gt.fml=[];Object(m.a)(Gt,"Critique",null,[]);class Bx{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(m.a)(Bx,
"Suggestion",null,[]);var Mv=c(623);class Lz extends Sys.EventArgs{constructor(b,h,t,A,O,aa){super();this.sZj=b;this.v0j=h;this.w0j=t;this.Upe=A;this.pz=O;this.e8a=aa}}Object(m.a)(Lz,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var $B=c(361);class Ms{constructor(b,h,t){this.Wxe=b;this.zm=h;this.ra=t}mFh(b){const [h,t,A]=this.afi(b);return this.q4h(h,t,A)}gAm(b){return af.a.getTypeNameFor(b.content)===$B.a.getTypeName()}q4h(b,h,t){if(t&&this.gAm(t)){if(this.I_b(t.content))return null;const O=
t.content;var A=new Gt;A.ExplanationTitle=O.explanationTitle;A.Suggestions=this.g7l(t);A.CategoryTitle=O.categoryName;A.TypeId=O.typeId;A.CritiqueActions=O.critiqueActions;A.Priority=O.priority;t=this.Wxe.create(A);A=O.context;t.token=A.substring(O.range.start,O.range.start+O.range.length);t.lcid=Sf.a.lg(O.language).LCID;t.originalText=A;return new Mv.a(b,h,t)}return null}g7l(b){var h=b.content.suggestions;b=[];for(const t of h)h=new Bx,h.Action=t.suggestionActions,h.Text=t.text,h.Description=t.description,
b.push(h);return b}I_b(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}afi(b){const h=this.zm.rNc(b,0),t=b.cpBegin,A=b.cpEnd,O=nf.SelectionEditor.jf(b);b=qe.ParagraphReader.text(b.node,0);for(const aa of h)if(O){if(aa.begin<=t&&aa.end>=A)return[aa.begin,aa.end,aa.intent]}else if(aa.begin<=t&&aa.end>=t&&F.a.vEh(b,aa.end,A))return[aa.begin,aa.end,aa.intent];return[null,null,null]}static jB(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1)}Ztf(b,h,t){const [A,O,aa]=this.afi(b);aa&&this.ra.raiseEvent(Ms.hsh,new Lz(b,A,O,h,aa,t))}nqk(b){this.ra.addHandler(Ms.hsh,b)}Wsl(b,h,t){b=this.zm.wOd(b,0,0,b.characterData.length);for(let A=0;A<b.count;A++){const O=b.J(A);if(O.intent){const aa=O.intent;if(aa.content&&(0==aa.content.priority||1==aa.content.priority)&&O.begin>=h&&(!t||t(O.intent)))return this.q4h(O.begin,O.end,O.intent)}}return null}}Ms.hsh="augloopProofingContextMenuActionEventKey";Object(m.a)(Ms,"AugLoopProofingErrorDetailHelper",
null,[]);class Zt extends Xw{constructor(b,h,t,A){super(h);this.kn=b;this.Szc=t;this.cQj=A}w9d(b,h){return!this.CHf(b.node,b.cpBegin,h)}B0c(b,h){return!this.CHf(b,0,h)}x9d(b,h){this.CHf(b.node,0,h);Object(Da.a)(Cs,h)}CHf(b,h,t){t=Object(Da.a)(Cs,t);if(qe.ParagraphReader.Yb(b)&&!b.XI)if(Wa.FormattingReader.Ar(pf.a.Tc(b,h)).cache.tGb)t.Zwj.value=!0;else{if(Ms.jB())return h=this.cQj.Wsl(b,h,this.Szc),null!=h?(t.WIb=h,t.VJc=b,!0):!1;const A=this.kn.j3(b);for(let O=0;O<A.length;O++){const aa=A[O];if(aa.begin>=
h&&!aa.errorDetails.l2a()&&(!this.Szc||this.Szc(aa.errorDetails)))return t.WIb=aa,t.VJc=b,!0}return!1}}}Object(m.a)(Zt,"FindNextErrorCallbackSteps",Xw,[]);var Uo=c(321);class Mw{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd){this.ETk=(ee,Od,fe,Ee,re)=>{Od=this.ib.hb.lb;if(!Od)return this.nd.Zb(gg.a.kf,{["Reason"]:uf.a.noSelection}),2;Od=this.Ie.Bj(Od,!0,!1);return this.ga.Nf(Od.Qa,ee,fe,!1,Ee,re)};this.aqn=(ee,Od,fe)=>{if(1===fe)return this.ga.processAction(qa.a.u4,1);this.o3j().kbg();return 32};
this.WCa=(ee,Od,fe)=>{if(1===fe)return 32;Ok.a.mark(4670);fe=this.kn.Hma(Od);if(this.Tke(fe))return 8;Od=Od.node;const Ee=this.Ic.Qc(15);let re=fe.begin;" "===qe.ParagraphReader.text(Od).charAt(re-1)&&re--;Ee.Eb(Od);const Fg=this.Jd.replaceTextRange(pf.a.createTextRange(Od,0<fe.begin?fe.begin-1:0,fe.end),"",!0,!1);this.ib.setSelection(wf.SelectionFactory.te(Od,Fg+re));Ee.dispose();fe.errorDetails.Uob(ee);Ok.a.mark(4671);return 32};this.Eva=(ee,Od,fe)=>{if(1===fe)return 32;u.ULS.sendTraceTag(7660830,
324,50,"Ignore spelling error triggerred");if(Ms.jB())return this.u8a.Ztf(Od,null,Uo.b.IgnoreOnce),32;Ok.a.mark(4670);fe=this.kn.Hma(Od);if(this.Tke(fe))return 8;Od=Od.node;const Ee=this.Ic.Qc(15);Ee.Eb(Od);this.kn.ymb(Od,[fe],!0);Od.setValue(Af.a.t7e,!0);Ee.dispose();fe.errorDetails.Uob(ee);Ok.a.mark(4671);u.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.Z_m(fe);this.MWa.Qki(fe,Od,!0);return 32};this.I0k=(ee,Od,fe)=>{var Ee,re=!this.Fk.i8(Od);this.Rm&&this.Rm.instance&&
this.Rm.instance.aU(Od)&&(re=!1);if(1===fe||!re)return re?32:8;this.ga.processAction(qa.a.dqa,2);Ok.a.mark(4670);re=this.EKl(ee);if(0>re)return 8;if(Ms.jB())return this.u8a.Ztf(Od,re,Uo.b.Apply),32;fe=this.kn.Hma(Od);if(this.Tke(fe))return 8;Od=Od.node;var Fg=fe.errorDetails.suggestions;if(!Fg)return this.nd.Zb(gg.a.UBb,{["Reason"]:"NoSuggestionsFound"}),Ok.a.mark(4671),8;re=re<Fg.length?Fg[re]:null;if(!re)return this.nd.Zb(gg.a.UBb,{["Reason"]:"RequestedSuggestionIsNull"}),Ok.a.mark(4671),8;(null===
(Ee=Jb.App.xd)||void 0===Ee?0:Ee.Yp)&&Jb.App.xd.Vq.aH(Od);re=re.replace("  "," \u00a0");Ee=this.Ic.Qc(15);Ee.Eb(Od);Fg=this.Jd.replaceTextRange(pf.a.createTextRange(Od,fe.begin,fe.end),re,!0,!1,qa.a.dqa);this.ib.setSelection(wf.SelectionFactory.te(Od,fe.begin+re.length+Fg));Ee.dispose();fe.errorDetails.Uob(ee);Ok.a.mark(4671);this.OVm(fe);return 32};this.a7n=(ee,Od)=>{Od=this.kn.Hma(Od);if(this.Tke(Od))return 8;Od.errorDetails.Uob(ee);return 32};this.Dvl=(ee,Od,fe,Ee,re)=>{if(!Od.view.re)return 2;
const Fg=Od.view;if(!this.ib.hb.lb)return this.nd.Zb(gg.a.kf,{["Reason"]:uf.a.noSelection}),2;if(1===fe)return 32;const Gg=new Cs,bm=new Zt(this.kn,this.Ie,this.Szc,this.u8a);Od=new Ts(null,ee,Od,fe,Ee,Gg,bm,this.ga,this.ib,this.Ie,null);Od.Hg=!0;Od.run();if(Od.isCompleted&&Gg.WIb){if(Od=wf.SelectionFactory.te(Gg.VJc,Gg.WIb.begin),Od=wf.SelectionFactory.Vz(Od,pf.a.Tc(Gg.VJc,Gg.WIb.end)),!this.V8g.instance||!this.V8g.instance.Mzn(Gg.WIb,Od,Fg)){this.ib.setSelection(Od);let An=0;re&&(An=re.ux);Fg.ige=
!1;sf.a.instance.Wb(new Vb.a(1,1,1,()=>{this.g5n(Fg,An,Gg.VJc,Gg.WIb)}))}}else{const An=new cf.StandardDialog;An.zd=0;Jb.App.KM.uUc?An.nia(CommonUIStrings.l_DefaultDialogTitle,Gg.Zwj.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(An.nia(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),Jb.App.KM.cyd(()=>{An.Ega&&(An.hide(),this.ga.processAction(ee,2))}))}return 32};this.S8d=(ee,Od,fe)=>
{if(1===fe)return 32;this.jda&&this.jda.C0&&(ee=this.jda.C0.ctf(xp.nfc))&&!ee.KK&&(ee.x_(0),ee.menu.sK(0));return 32};this.ga=h;this.kn=b;this.o3j=t;this.Jd=A;this.Ic=O;this.ib=aa;this.Rm=ua;this.Ie=Ra;this.wbk=ub;this.Fk=Nb;this.nd=Yb;this.u8a=Cd;this.jda=Object(Da.a)(Ww,bc);this.TUb=Dc.STc;this.V8g=Pc;this.MWa=jd;this.Zmc=new Map;this.Zmc.set(1,qa.a.xcg);this.Zmc.set(2,qa.a.Dtf);this.Zmc.set(3,qa.a.sdg);this.Dyc=new Map;this.Dyc.set(1,qa.a.ycg);this.Dyc.set(2,qa.a.Etf);this.Dyc.set(3,qa.a.tdg)}Ub(){const b=
this.ga,h=this.I0k,t=this.ETk;b.gb(qa.a.X6d,mc.a.view,this.aqn,1028);b.pa(qa.a.WCa,mc.a.Vc,this.WCa);b.pa(qa.a.Eva,mc.a.Vc,this.Eva);b.pa(qa.a.Cob,mc.a.Vc,h);b.pa(qa.a.Dob,mc.a.Vc,h);b.pa(qa.a.Eob,mc.a.Vc,h);b.pa(qa.a.JOb,mc.a.Vc,h);b.pa(qa.a.KOb,mc.a.Vc,h);b.pa(qa.a.WCa,mc.a.view,t);b.pa(qa.a.Eva,mc.a.view,t);b.pa(qa.a.Cob,mc.a.view,t);b.pa(qa.a.Dob,mc.a.view,t);b.pa(qa.a.Eob,mc.a.view,t);b.pa(qa.a.JOb,mc.a.view,t);b.pa(qa.a.KOb,mc.a.view,t);b.Uc(qa.a.WCa,1028);b.Uc(qa.a.Eva,1028);b.Uc(qa.a.Cob,
1028);b.Uc(qa.a.Dob,1028);b.Uc(qa.a.Eob,1028);b.Uc(qa.a.JOb,1028);b.Uc(qa.a.KOb,1028);b.pa(qa.a.dqa,yc.a.frame,Kf.ActionManager.Kf);this.TUb&&b.gb(qa.a.S8d,mc.a.view,this.S8d,1124);b.gb(qa.a.fYc,mc.a.view,this.Dvl,1028);b.gb(qa.a.ZYf,mc.a.Fd,this.a7n,1124);this.vPn([qa.a.Fhe,qa.a.xcg,qa.a.ycg,qa.a.DRd,qa.a.Dtf,qa.a.Etf,qa.a.kie,qa.a.sdg,qa.a.tdg,qa.a.nZi,qa.a.xJi,qa.a.Pnj])}vPn(b){for(let h=0;h<b.length;h++)this.ga.gb(b[h],mc.a.view,Kf.ActionManager.eQ,1028)}HQn(b){this.Szc=b}Tke(b){return b?b.errorDetails?
!1:(u.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.nd.Zb(gg.a.UBb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),Ok.a.mark(4671),!0):(u.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.nd.Zb(gg.a.UBb,{["Reason"]:"RequestedErrorRangeNotFound"}),Ok.a.mark(4671),!0)}Z_m(b){b=b.errorDetails.proofingType;if(this.Dyc.has(b)){const h=this.Dyc.get(b);this.ga.processAction(h,2);u.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",
h,b)}}EKl(b){switch(b){case qa.a.Cob:return 0;case qa.a.Dob:return 1;case qa.a.Eob:return 2;case qa.a.JOb:return 3;case qa.a.KOb:return 4;default:return-1}}OVm(b){b=b.errorDetails.proofingType;if(this.Zmc.has(b)){const h=this.Zmc.get(b);this.ga.processAction(h,2);u.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}g5n(b,h,t,A){b.p4();(b=t.Ee(b.jc))?(A=Vw.a.Gq(b,v.AFrameworkApplication.isRtl?A.begin:A.end),this.wbk.dya(new Sys.UI.Point(A.x,A.y+A.height),
h)):u.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(m.a)(Mw,"ProofingActor",null,[]);var mw=c(449),Ds=c(1544),nw=c(1829),Gr=c(561);class yy{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){this.rjc=null;this.fyl="StyleUsageActivity";this.gyl="StylesFloodgateSurveyIsEnabled";this.AMa=(bc,Dc,Pc,jd)=>{bc=this.J6l(bc);return 0>bc||bc>this.rjc.length?2:(bc=this.rjc[bc])?v.AFrameworkApplication.xa.Nf(Dc,qa.a.applyStyle,Pc,!0,jd,bc):2};this.wKb=(bc,Dc,Pc,jd,Cd)=>{bc=!0;Dc.contextId!==
mc.a.paragraph&&Dc.contextId!==mc.a.Fd&&Dc.contextId!==mc.a.Vc&&(bc=!1);if(1===Pc||!bc)return bc?32:8;if(2===Pc&&!Cd)return 8;Dc=this.uc.qC(Dc.node);Cd.MenuItems=mw.a.OWl(Dc);return 32};this.DFn=(bc,Dc,Pc,jd,Cd)=>{bc=!0;Dc.contextId!==mc.a.paragraph&&(bc=!1);if(1===Pc&&!bc)return 8;Dc=Dc.node;Pc=this.uc.Uo(Dc);if(!Pc||!Cd)return u.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",Cd,Dc,Pc),8;Cd.SSa.Aw(Pc.Ik());return 32};this.Fyk=(bc,Dc,Pc,jd,Cd)=>{if(Dc.contextId!==
mc.a.paragraph)return 8;if(this.Zf.y2a(Dc,!1))return this.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.tE}),8;if(1===Pc)return 32;const ee=Dc.node;if(qe.ParagraphReader.Kta(ee)||!Cd)return 8;const Od=this.Wrf(Cd,ee);if(!Od)return this.Jc.Zb(gg.a.J0,{["Reason"]:uf.a.VBb}),8;if(2!==this.uc.vD(Od))return 2;Pc=new Te.GraphTransaction(15);this.Dn&&this.Dn.isProgressiveStyleEnabled&&this.oH.Kic(Cd);Pc.Eb(ee);this.qj.c5a();const fe=[];bc!=qa.a.clearFormatting&&fe.push(zf.a.vIa);this.Fca.rJ(Od,ee,!1,void 0,void 0,void 0,
pi.a.Oj?new nw.a(fe,!1,!0):null);(bc=this.uc.qC(ee))&&this.uc.ke(Od,bc)&&Jc.b(593078098,3017,50,"Custom linked style applied by user");ee.jr&&(bc=[Object.assign(new sa.a,{name:"Source",string:"ApplyStyle"})],lb.a("TOCFormatting",!0,void 0,bc));Pc.dispose();Cd=F.a.FW(Cd);jd.Ur=Cd>>>16^Cd&65535;jd&&Ds.a.Gob&&(jd.gC|=Ds.a.xgb(Dc.node));return 32};this.EFn=(bc,Dc,Pc,jd,Cd)=>{bc=!0;Dc.contextId!==mc.a.Fd&&(bc=!1);if(1===Pc&&!bc)return 2;Dc=Wa.FormattingReader.Ar(Dc);Dc=Wa.FormattingReader.bna(Dc);if(!Dc)return 2;
if(!Cd)return 8;Cd.SSa.Aw(Dc.Ik());return 32};this.Gyk=(bc,Dc,Pc,jd,Cd)=>{if(Dc.contextId!==mc.a.Fd)return 8;this.Zf.y2a(Dc);if(1===Pc)return 32;bc=Dc;pi.a.pEd&&(Dc=this.Ao.LPd(bc))&&(bc=Dc);Dc=bc.node;if(!Cd)return 8;const ee=this.Wrf(Cd,bc.node);if(!ee)return this.Jc.Zb(gg.a.J0,{["Reason"]:uf.a.VBb}),8;if(1!==this.uc.vD(ee))return 2;Pc=this.uc.qC(Dc);if(!Pc)return this.Jc.Zb(gg.a.J0,{["Reason"]:uf.a.HUh}),8;if(!Pc.Ni(this.uc.jg(ee)))return this.Jc.Zb(gg.a.J0,{["Reason"]:uf.a.VBb}),8;const Od=new Te.GraphTransaction(7);
try{if(this.Dn&&this.Dn.isProgressiveStyleEnabled&&this.oH.Kic(Cd),Od.Eb(Dc),this.Fca.Kjg(Dc,Pc),this.IHa.w2(bc,fe=>{this.oq.ula(fe);this.oq.Fnb(fe,ee)}),Dc.jr){const fe=[Object.assign(new sa.a,{name:"Source",string:"ApplyStyle"})];lb.a("TOCFormatting",!0,void 0,fe)}}finally{Od&&Od.dispose()}Pc&&this.uc.ke(ee,Pc)&&Jc.b(593078097,3017,50,"Custom linked style applied by user");Cd=F.a.FW(Cd);jd.Ur=Cd>>>16^Cd&65535;jd&&Ds.a.Gob&&(jd.gC|=Ds.a.xgb(bc.node));return 32};this.CFn=(bc,Dc,Pc,jd,Cd)=>{bc=!0;
Dc.contextId!==mc.a.Vc&&(bc=!1);if(1===Pc&&!bc)return 2;Dc=this.Fca.O6l(Dc);if(!Dc)return 2;if(!Cd)return 8;Cd.SSa.Aw(Dc.Ik());return 32};this.Eyk=(bc,Dc,Pc,jd,Cd)=>{if(Dc.contextId!==mc.a.Vc)return 8;if(this.Zf.y2a(Dc,!1))return this.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.tE}),8;if(1===Pc)return 32;var ee=Dc.node;if(!Cd)return 8;Pc=this.Wrf(Cd,Dc.node);if(!Pc)return this.Jc.Zb(gg.a.J0,{["Reason"]:uf.a.VBb}),8;const Od=this.uc.vD(Pc);if(1!==Od&&2!==Od)return 2;(Dc=this.qj.yrf(Dc))?(Dc=he.a.mAb(Dc),bc=v.AFrameworkApplication.xa.Nf(Dc,
bc,2,!1,jd,Cd)):(bc=new Te.GraphTransaction(7),this.Dn&&this.Dn.isProgressiveStyleEnabled&&this.oH.Kic(Cd),bc.Eb(ee),this.Fca.qgo(Pc,ee),bc.dispose(),bc=32);ee.jr&&(Dc=[Object.assign(new sa.a,{name:"Source",string:"ApplyStyle"})],lb.a("TOCFormatting",!0,void 0,Dc));(ee=this.uc.qC(ee))&&this.uc.ke(Pc,ee)&&Jc.b(593078096,3017,50,"Custom linked style applied by user");Cd=F.a.FW(Cd);jd.Ur=Cd>>>16^Cd&65535;return bc};this.FFn=(bc,Dc,Pc,jd,Cd)=>{const ee=this.qad.Voa(bc,Dc,Pc,jd,Cd,null,0);return 2!==ee?
ee:this.qad.Voa(bc,Dc,Pc,jd,Cd,null,12)};this.Hyk=(bc,Dc,Pc,jd,Cd)=>{var ee;const Od={};Od[this.qad.yIa]=6168;Od[this.qad.xIa]=6169;let fe=12;if(!Dc.view.re)return 2;var Ee=Dc.view.nb,re=Ee?Ee.pg:null;if(!re)return this.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.noSelection}),8;if(this.Vg.zCa(Be.ImageReader.N1a,re))return this.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.iGc}),8;if(this.Vg.Oya(qe.ParagraphReader.ZT,re))return this.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.IN}),8;if(this.Zf.W9b(re,!1))return this.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.tE}),
8;re=this.uc.Cr();if(Cd&&re){const Fg=re.Ni(Cd);if(Fg){(null===(ee=v.AFrameworkApplication.K)||void 0===ee?0:ee.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Gr.a.instance.W4a("Style");ee=this.uc.iva(Fg,re);let Gg=this.uc.vD(Fg);ee&&(Ee=Ee.hb.J(0),Ee.Sx&&Ee.Qa.contextId===mc.a.Fd||2===Ee.length&&Ee.Qa.contextId===mc.a.Fd&&Ee.Rc.contextId===mc.a.endOfParagraph)&&(Gg=1,Cd=ee.getValue(fh.a.ja));1===Gg?fe=0:3===Gg&&(fe=14);!this.uc.ke(Fg,re)&&this.uc.Hd(Fg)&&(Ee=this.uc.jg(Fg),
Jc.b(562317522,3017,50,String.format("{0}: style applied by user",Ee)));this.jqa(this.fyl,this.gyl)}}return this.qad.Voa(bc,Dc,Pc,jd,Cd,Od,fe)};this.FL=h;this.ue=t;this.ZM=A;this.yz=O;this.Fk=aa;this.nd=ua;this.fW=Ra;this.zhk=ub;this.ve=Nb;this.Ao=Yb}get Dn(){return null!=this.FDg?this.FDg:this.FDg=Sa.a.instance.Ma("Box4.Styles.StyleSettings")}get Fca(){return this.FL}get Vg(){return this.ZM}get qj(){return this.yz}get oq(){return this.ue}get Zf(){return this.Fk}get Jc(){return this.nd}get IHa(){return this.fW}get qad(){return this.zhk}get uc(){return this.ve}Ub(){const b=
v.AFrameworkApplication.xa,h=Jb.App.iTa.gHh(12);b.pa(qa.a.applyStyle,mc.a.Fd,this.Gyk);b.pa(qa.a.wGa,mc.a.Fd,this.EFn);b.pa(qa.a.applyStyle,mc.a.Vc,this.Eyk);b.pa(qa.a.wGa,mc.a.Vc,this.CFn);b.pa(qa.a.applyStyle,mc.a.paragraph,this.Fyk);b.pa(qa.a.applyStyle,mc.a.view,this.Hyk);b.Uc(qa.a.applyStyle,1036);b.pa(qa.a.wGa,mc.a.view,this.FFn);b.pa(qa.a.wGa,mc.a.paragraph,this.DFn);b.Uc(qa.a.wGa,99);b.pa(qa.a.wKb,mc.a.view,h);b.pa(qa.a.wKb,mc.a.paragraph,this.wKb);b.Uc(qa.a.wKb,1127);b.gb(qa.a.w_e,mc.a.view,
this.AMa,4);b.gb(qa.a.x_e,mc.a.view,this.AMa,4);b.gb(qa.a.y_e,mc.a.view,this.AMa,4);b.gb(qa.a.z_e,mc.a.view,this.AMa,4);b.gb(qa.a.A_e,mc.a.view,this.AMa,4);b.gb(qa.a.B_e,mc.a.view,this.AMa,4);b.gb(qa.a.C_e,mc.a.view,this.AMa,4);b.gb(qa.a.Cqh,mc.a.view,this.AMa,4);b.gb(qa.a.Dqh,mc.a.view,this.AMa,4);b.gb(qa.a.Eqh,mc.a.view,this.AMa,4);this.rjc=Array(10);Tf.StyleReader.Ygj(this.rjc)}J6l(b){switch(b){case qa.a.w_e:return 0;case qa.a.x_e:return 1;case qa.a.y_e:return 2;case qa.a.z_e:return 3;case qa.a.A_e:return 4;
case qa.a.B_e:return 5;case qa.a.C_e:return 6;case qa.a.Cqh:return 7;case qa.a.Dqh:return 8;case qa.a.Eqh:return 9;default:return-1}}jqa(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const t=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");t&&t.execute(A=>{A.logActivity(b,h)})},yy.VCa)}Wrf(b,h){if(b&&h&&qe.ParagraphReader.Yb(h))h=this.uc.qC(h);else return null;return h.Ni(b)}get oH(){return null!=this.rwg?this.rwg:this.rwg=Sa.a.instance.resolve("Box4.IFontStylesGalleryCache")}}
yy.VCa=5E3;Object(m.a)(yy,"StyleActor",null,[]);var gC=c(1936);class zy{constructor(b){this.ga=b}get rc(){return this.ga}Cee(b,h=!1){this.rc.Nf(b,qa.a.mPa,2,!0,null,h)}u4(b){this.rc.Rb(qa.a.u4,2,b)}}Object(m.a)(zy,"TextFormattingCommands",null,[572]);class Eq{constructor(b,h,t,A){this.yTe=this.Efh=!1;this.cEo=(O,aa,ua)=>{if(2!==ua)return 2;this.Efh||(this.Efh=!0);v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");
return 32};this.CBn=(O,aa,ua,Ra,ub)=>{if(2!==ua)return 2;this.IYi(ub,!0);return 32};this.BBn=(O,aa,ua,Ra,ub)=>{if(2!==ua)return 2;this.IYi(ub,!1);return 32};this.uCn=(O,aa,ua)=>{if(2!==ua)return 2;if(!this.n$a)return 8;this.n$a.qkm();return 32};this.xBn=(O,aa,ua)=>{if(2!==ua)return 2;if(!this.n$a)return 8;this.n$a.o0n();return 32};this.Foa=(O,aa)=>{3===aa.ux&&nf.SelectionEditor.hm(aa.sl.lb)&&(lb.c(qa.a.YDo),v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),
this.yTe=!0)};this.ga=b;this.Na=h;this.n$a=t;this.ib=A}get bEo(){return this.yTe}Ub(){var b;this.ga.gb(ab.a.YO,mc.a.view,this.cEo,4);this.ga&&this.Na&&(this.Na.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.gb(qa.a.Mgg,mc.a.view,this.CBn,4),this.ga.gb(qa.a.Ogg,mc.a.view,this.BBn,4)),this.ga.gb(ab.a.Noj,mc.a.application,this.uCn,4),this.ga.gb(ab.a.iff,mc.a.application,this.xBn,4),Ln.EventHandlerManager.instance.OPn(()=>{this.son()}));(null===(b=Jb.App.ya.jb.xc)||void 0===b?0:b.re)&&Jb.App.ya.jb.xc.Xka(()=>
{this.k5n()});this.ib&&this.ib.gx(this.Foa)}YHn(){lb.c(qa.a.aEo);this.yTe=!0}k5n(){const b=window.performance.now();Eq.sGe&&250>b-Eq.sGe&&1E3<b-Eq.A0g&&(lb.c(qa.a.$Do),Eq.A0g=b);this.n$a&&Eq.Xb&&Eq.Xb.iA(115)&&this.n$a.showFloatie()}Rwm(b,h){if(h){var t=null;ba.a.vJ&&b&&(t=b.getSelection());b=null;t&&"Caret"===t.type&&(b=t.getRangeAt(0))&&this.n$a&&this.n$a.eOo(b.getBoundingClientRect(),h)}}son(){Eq.sGe=window.performance.now()}IYi(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(Eq.tnm)){for(b=
b.firstChild;b;)this.ntk(b,h),b=b.nextSibling;break}b=b.nextSibling}}ntk(b,h){if(b.classList.contains(Eq.jli)){const t="WACImageResizeHandleTouch"+this.SQl(b);h?b.classList.add(Eq.kli,t):b.classList.remove(Eq.kli,t)}}SQl(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==Eq.jli)return F.a.substring(h,20,h.length);return""}static get Xb(){return null!=Eq.lvg?Eq.lvg:Eq.lvg=Sa.a.instance.Ma("Box4.IFeatureHelper")}}Eq.jli="WACImageResizeHandles";Eq.kli="WACImageResizeHandlesTouch";
Eq.tnm="WACImgSelection";Eq.sGe=0;Eq.A0g=0;Object(m.a)(Eq,"TouchInputActor",null,[573]);class ow{get yIa(){return Xf.a.yIa}get xIa(){return Xf.a.xIa}get Ulc(){return Xf.a.Ulc}Voa(b,h,t,A,O,aa,ua){return Xf.a.Voa(b,h,t,A,O,aa,ua)}Jec(b,h,t,A,O,aa){return Xf.a.Jec(b,h,t,A,O,aa)}static get instance(){ow._instance||(ow._instance=new ow);return ow._instance}}ow._instance=null;Object(m.a)(ow,"ViewActionHandlerProxy",null,[571]);class Uy{constructor(b,h){this.kpiName="VisiMarkersUsage";this.y7="wwaengidc";
this.Djb=new Map;this.Tqo=(t,A,O,aa,ua)=>{if(1===O)return 32;if(!ua)return 2;this.Djb.set("Source",hf.a[this.ga.p_]);this.bVe.cVc?this.Djb.set("Action","Removed"):this.Djb.set("Action","Applied");wa.Health.instance.recordKpiUsage(this.kpiName,1,this.y7,this.Djb);t=document.getElementsByTagName("head")[0];if(!this.bVe.tDo(t))return u.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;Jb.App.ya.CG({ShowVisiMarkers:"ToggleButtonModel"});return 32};this.VEn=(t,A,O,aa,ua)=>{if(1===
O)return 32;ua[Ng.a.On]=this.bVe.cVc;return 32};this.ga=b;this.bVe=h}Ub(){this.ga.gb(qa.a.fhe,mc.a.application,this.Tqo,1);this.ga.gb(qa.a.h_i,mc.a.application,this.VEn,96)}}Object(m.a)(Uy,"VisiMarkersActor",null,[]);var ru=c(120);class cz{constructor(b,h,t,A,O){this.Qn=b;this.Scn=h;this.lj=t;this.Kd=A;this.characterPropertiesEditor=O}get ELi(){return this.Scn.value}execute(b,h,t,A){const O=zk.a.instance.vp(qa.a.Xco);mb.OutlineElementReader.isEmpty(b,!1)?this.sql(b):this.tql(b,h,t,A);O.end()}sql(b){this.ELi.C3e(b,
-1)?this.ELi.tRa(b,-1,0):this.Qn.SRa(b,{w4i:!0})}tql(b,h,t,A){h=A(b,h,t);b=qe.ParagraphReader.Rl(b.currentNode);!this.Qn.dOb&&this.PLm(b)&&this.Uok(h);this.Qn.Pia();(null===b||void 0===b?0:b.qa)&&!b.qa.last.formatting&&this.characterPropertiesEditor.u_a(b)}PLm(b){return b.Vi&&!b.GC.hasProperty(Lc.a.listID)}Uok(b){wg.OutlineElementNavigator.Fe(b);b=b.currentNode;const h=new ru.a;b.Mc.Du(h);this.lj.NU(b,h,this.Kd.Cg)}}Object(m.a)(cz,"ListNewLineStrategy",null,[]);var dz=c(1049),Lx=c(447);class Ay{yc(b){b.ha("Box4.Actors.Box4PasteStewardFactory",
()=>new wp(Jv.a.JDb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").singleInstance();b.ha("Box4.Actors.Box4PasteStewardUtils",()=>new Cv(v.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").singleInstance();b.ha("Box4.Actors.ClipboardActor",()=>new is.ClipboardActor(b.We("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),
zk.a.instance,b.resolve("Box4.IClipboardDataHelper"),he.a.instance,v.AFrameworkApplication.xa,b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.K,yd.FocusManager.instance(),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),v.AFrameworkApplication.Hag(),v.AFrameworkApplication.Wkj(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Sa.a.instance.resolve("Common.IReactContextualUILauncher"),
!!Jb.App.instance&&Jb.App.instance.Cga)).singleInstance();b.ha("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new Vt(v.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new Sq(v.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),Em.a.instance)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).singleInstance();
b.ha("Box4.Actors.ISystemClipboard",()=>new ls(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),pc.InteractiveViewManager.instance,Jb.App.ya.jb,yd.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),Em.a.instance,v.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IDeleteTableSegmentStrategy",()=>new Lv).singleInstance();b.ha("Box4.ISelectionFactory",()=>new rr.a).singleInstance();b.ha("Box4.IRenderOrderGraphIteratorFactory",()=>
new Et).singleInstance();b.ha("Common.IDomElementContentStateFactory",()=>new Dt).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new Hx(he.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();b.ha("Box4.Actors.PastedContentsPostProcessorHelper",()=>new ry).singleInstance();b.ha("Box4.Actors.PasteFloatiePositionProvider",()=>new kw(he.a.instance,b.resolve("Box4.ITextMetricsAdapter"),pc.InteractiveViewManager.instance,
ff.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!Jb.App.instance&&Jb.App.instance.Cga)).singleInstance();b.ha("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new sy(b.resolve("Box4.IClipboardDataHelper"),Jb.App.Ov.tI)).singleInstance();b.ha("Box4.Actors.PasteFloatieEventManager",()=>new bz(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),pc.InteractiveViewManager.instance,Pw.a.instance(),v.AFrameworkApplication.ta,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),
b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Jb.App.jk.Kl.af(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!Jb.App.instance&&Jb.App.instance.Cga)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteFactory",()=>new Ou(zk.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.PasteCoordinator"),Xy.a.instance,he.a.instance,v.AFrameworkApplication.xa,
b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.We("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();b.ha("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new iq(v.AFrameworkApplication.xa,zk.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.IOutlineElementEditor"),he.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),
b.resolve("Box4.IParagraphReader"),Er.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Ma("Box4.IFeatureHelper"))).singleInstance();b.ha("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new yl(zk.a.instance,Em.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),
b.resolve("Common.ISimpleOperationFactory"),v.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new nj(v.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IClipboardOperationFactory",()=>new SA(b.resolve("Box4.Actors.InternalClipboard"),v.AFrameworkApplication.xa,v.AFrameworkApplication.Dag(),zk.a.instance,Er.a.instance,Em.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.IPasteFloatieEventSource"),
b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new bB(b.We("Box4.Actors.IBox4PasteStewardFactory"),b.We("Box4.Actors.IBox4ImageStewardFactory"),b.We("Box4.Actors.IBox4TableStewardFactory"),b.We("Box4.Actors.IBox4WordConverterFactory"),b.We("HtmlImport.IHtmlTranslatorSettings"),b.Ma("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),b.resolve("HtmlImport.IHtmlNormalizerSettings"),
b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"))).singleInstance();b.ha("Box4.Actors.InternalClipboard",()=>new mv.a(b.resolve("Box4.Images.IImageEditor"),b.We("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),Jb.App.jk,b.resolve("Box4.IParagraphIndentationReader"),v.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.Ma("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").bdj,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();b.ha("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new $l(b.resolve("Box4.Actors.InternalClipboard"),b.Ma("Box4.IContentControlCopyPasteHelper"),new Pg.a(()=>Jb.App.ya.jb.xc),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();
b.ha("Box4.List.IListCommands",()=>new wy(v.AFrameworkApplication.xa)).singleInstance();b.ha("Box4.List.ListNewLineStrategy",()=>new cz(b.resolve("Box4.List.IListEditor"),b.We("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.ICharacterPropertiesEditor"))).singleInstance();b.ha("Box4.Actors.PasteCoordinator",()=>new jw(b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),rl.a.instance)).singleInstance();b.ha("Box4.Actors.Box4ImageStewardFactory",()=>new Gu(b.resolve("Box4.Images.IImageEditor"),v.AFrameworkApplication.oc,b.resolve("Box4.IUndoManager"),b.Ma("Box4.Actors.IImageStewardBridge"),Jb.App.ya.notificationBar,b.Ma("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").singleInstance();
b.ha("Box4.Actors.Box4TableStewardFactory",()=>new Wt(Sa.a.instance.resolve("Box4.List.IListEditor"),Sa.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").singleInstance();b.ha("Box4.Actors.ClipboardOperationWordStrategy",()=>new Tw(zk.a.instance,he.a.instance,Jb.App.xd,rl.a.instance)).singleInstance();b.ha("Box4.Actors.Box4WordConverterFactory",
()=>new Sz(v.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").singleInstance();b.ha("Box4.Actors.IExternalPasteCssConverter",()=>new Uz(v.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IHtmlNormalizerHelper",()=>new cB).singleInstance();b.ha("Box4.ISelectionCommands",()=>new Wy(v.AFrameworkApplication.xa)).singleInstance();b.ha("Box4.ITextFormattingCommands",()=>new zy(v.AFrameworkApplication.xa)).singleInstance();b.ha("Box4.Actors.AccessibilityActor",()=>new mh(b.Sa("Box4.Accessibility.IAccessibilityContextManager"),
b.resolve("Box4.Proofing.IErrorRangeEditor"))).singleInstance();b.ha("Box4.Actors.InsertionPointFormatting",()=>new Xz(b.Ma("Box4.IFontSlotProvider"),b.Sa("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").singleInstance();b.ha("Box4.UI.PasteFloatieManager",()=>new Gx).as("Box4.UI.IFloatieManager").singleInstance();b.ha("Box4.Actors.ProofingActor",()=>new Mw(Sa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),v.AFrameworkApplication.xa,()=>Sa.a.instance.resolve("Box4.UI.ILanguageDialog"),
Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Sa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),he.a.instance,Sa.a.instance.Sa("Box4.IExternalSelectionManager"),Er.a.instance,Sa.a.instance.resolve("Box4.ISelectionContextMenuProvider"),rl.a.instance,zk.a.instance,Sa.a.instance.resolve("Box4.IContextMenuController"),Sa.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Sa.a.instance.Sa("Box4.Actors.IProofingErrorPresenter"),Sa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),
Sa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();b.ha("Box4.Actors.StyleActor",()=>new yy(Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Sa.a.instance.resolve("Box4.IFormattingEditor"),Ik.ContextSetEditor.instance,Sa.a.instance.resolve("Box4.IInsertionPointFormatting"),rl.a.instance,zk.a.instance,Sa.a.instance.resolve("Box4.TextFormattingHelper"),ow.instance,Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),
Sa.a.instance.resolve("Box4.IContentControlChpHelper"))).singleInstance();b.ha("Box4.Actors.StyleContextMenuActor",()=>new hv(Sa.a.instance.resolve("Box4.IUpdateStyleManager"),Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.xa)).singleInstance();b.ha("Box4.Actors.TextFormattingActor",()=>new gC.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Ma("Box4.IFontSlotProvider"),b.Ma("Box4.IContentControlChpHelper"),
Sa.a.instance.resolve("Box4.IFormattingEditor"),Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Sa.a.instance.resolve("Box4.IParagraphEditor"),Sa.a.instance.resolve("Box4.ILineSpacingHelper"),Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Sa.a.instance.resolve("Box4.IOutlineElementEditor"),Sa.a.instance.resolve("Box4.List.IListFormattingEditor"),Sa.a.instance.resolve("Box4.IParagraphIndentationReader"))).singleInstance();b.ha("Box4.Actors.AutoCorrectActor",
()=>new hr(v.AFrameworkApplication.xa,zk.a.instance,()=>Sa.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).singleInstance();b.ha("Box4.Actors.TouchInputActor",()=>new Eq(v.AFrameworkApplication.xa,v.AFrameworkApplication.K,Rs.GrippersManager.instance,he.a.instance)).as("Box4.ITouchInputActor").singleInstance();b.register(Xt,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").singleInstance();b.ha("Box4.Actors.VisiMarkersActor",()=>new Uy(v.AFrameworkApplication.xa,b.resolve("Box4.IVisiMarkersOperation"))).singleInstance();
b.ha("Box4.Actors.IndentationActorExtension",()=>new Bj).as("Box4.Actors.IIndentationActorExtension").singleInstance();dz.a.ACf&&b.ha("Box4.Actors.PageColorActor",()=>new dz.a(Lx.a.instance)).singleInstance()}}Object(m.a)(Ay,"Box4ActorsComponentConfiguration",null,[2]);var By=c(233),iB=c(1089);const pw=()=>{const b=Yz;v.AFrameworkApplication.xa.pa(qa.a.Ndf,mc.a.embeddedFile,b);v.AFrameworkApplication.xa.pa(qa.a.Ndf,mc.a.o5b,b);v.AFrameworkApplication.xa.pa(qa.a.Mdf,mc.a.embeddedFile,Mx);v.AFrameworkApplication.xa.pa(qa.a.Mdf,
mc.a.o5b,Mx)},Yz=(b,h,t)=>Jb.App.uHd?8:2===t?(b=new cf.StandardDialog,b.zd=4,b.MU(1),b.Ge(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.Ge(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.vbg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,hC),32):2,hC=b=>{1===b&&v.AFrameworkApplication.xa.processAction(qa.a.Mdf,2)},Mx=(b,h,t)=>{if(Jb.App.uHd)return 8;if(1===t)return h.node.hasProperty(Af.a.embeddedFileContainer)?32:2;if(2===
t&&(h.contextId===mc.a.view&&h.view.nb&&(h=h.view.nb.pg),By.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=iB.a.LOl(h.node);dc.a.Eho();try{Zz(b)}catch(A){u.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",A)}}return 32},Zz=b=>{ff.a.km(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var jB=c(786),qw=c(951),Cy=c(985);class su{constructor(b){this.jAa=this.nV=null;this.mha=(h,t,A,O,aa)=>{if(1===A)return 32;v.AFrameworkApplication.xa.Rb(qa.a.C4a,2,aa);h=aa&&0<=aa.fontColor&&16777215>=
aa.fontColor?aa.fontColor:0;Jb.App.ya.Dw();(new qw.a(su.FFc,qa.a.Hpa)).xic(h);return 32};this.vKb=(h,t,A,O,aa)=>{if(1===A)return 32;if(2===A&&!aa)return 8;h=su.lf.ONc(t);t=new jB.a;A=null;32===v.AFrameworkApplication.xa.Rb(qa.a.C4a,2,t)&&t&&(A=t.fontColor);O="";A&&!t.s5b&&(O=Fl.a.wI(A)||"");this.ZXh.LMb=O;this.$Tc&&this.recentColors.Gjg(O);h=this.ZXh.CLc(h,Jb.App.Gzb);if(!h)return 8;aa.MenuItems=h;u.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.WHe=b}get ZXh(){this.nV||
(this.nV=new Cy.a(su.FFc),this.AEa(this.nV));return this.nV}AEa(b){b.tW(1,qa.a.Nea);b.tW(3,qa.a.Ev);b.tW(4,qa.a.Ev);b.tW(5,qa.a.Hpa);b.tW(6,qa.a.mha);b.fyb(this.WHe,1)}Ub(){const b=v.AFrameworkApplication.xa;b.pa(qa.a.mha,mc.a.view,this.mha);b.pa(qa.a.vKb,mc.a.view,this.vKb);b.Uc(qa.a.vKb,1127)}static IPl(){return new su(Lx.a.instance)}static get instance(){return null!=su.pyg?su.pyg:su.pyg=su.IPl()}get recentColors(){return null!=this.xCg?this.xCg:this.xCg=Sa.a.instance.Ma("Box4.UI.RecentColorsSectionHandler")}static get lf(){return Lk.PageReader.instance}get $Tc(){null==
this.jAa&&(v.AFrameworkApplication.ye("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.jAa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.jAa}}su.FFc="Font";Object(m.a)(su,"FontColorActor",null,[]);class Yw{constructor(b){this.mha=(h,t,A,O,aa)=>{if(1===A)return 32;v.AFrameworkApplication.xa.Rb(qa.a.C4a,2,aa);h=aa&&0<=aa.highlight&&16777215>=aa.highlight?aa.highlight:0;Jb.App.ya.Dw();
(new qw.a("Highlighter",qa.a.h9)).xic(h);return 32};this.ga=b}Ub(){this.ga.pa(qa.a.DSi,mc.a.view,this.mha)}static ARl(){return new Yw(v.AFrameworkApplication.xa)}static get instance(){return null!=Yw.azg?Yw.azg:Yw.azg=Yw.ARl()}}Object(m.a)(Yw,"HighlighterColorActor",null,[]);var Fq=c(323),jp=c(98);class ez{static get Wg(){return Pf.a.Xz(ez.Hm,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}ez.Hm="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(m.a)(ez,"InsertLinkDialogHtml",null,[]);class kp extends Pf.a{constructor(b){super();this.C5d=()=>{const h=document.getElementById("txtLink");this.Dpa(1,!h||!h.value.length||Ge.HyperlinkReader.I2a(h.value))};this.$xf=(h,t)=>{if(this.mh.Qt){var A=this.mh.nb.hb.lb;if(A)if(A.equals(this.$w)&&0!==h){h=new Te.GraphTransaction(15);h.Eb(this.yS[0].node);for(A=0;A<this.yS.length;A++)this.yS[A].node.pH().NE.Q6(4);A=t.txtLink.trim();t=this.Ibl();A=this.ztm(A);(t||A)&&kp.Kd.Bs(7);this.hide();h.dispose()}else this.mh.K4()}};
this.yS=b;this.mh=pc.InteractiveViewManager.instance.vd;this.$w=this.mh.nb.hb.lb;this.jif=b[0].cpBegin;this.GFf=b[b.length-1].cpEnd;this.sg="InsertMultiParagraphLinkDialog";b=this.DNo();this.showDialog("",b)}showDialog(b,h){u.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.Wg=ez.Wg;""===h.trim()&&this.Ge(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Yh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.$xf,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();
document.getElementById("txtDisplay").disabled=!0;kp.kBf&&(b=document.getElementById("txtLink"),Hf.a.addHandler(b,db.a.input,this.C5d),Hf.a.addHandler(b,db.a.change,this.C5d))}hide(){if(kp.kBf){const b=document.getElementById("txtLink");b&&(Hf.a.removeHandler(b,db.a.change,this.C5d),Hf.a.removeHandler(b,db.a.input,this.C5d))}super.hide()}mua(b){return kp.kBf?this.RGl(this.$pc)?super.mua(b):!1:super.mua(b)}DNo(){let b;var h="";const t=this.yS.length,A=Ge.HyperlinkReader.rD(this.yS[0],!1);0<A.length&&
({cpBegin:O,cpEnd:b}=kp.j_.Ufa(this.yS[0],A[0]),O<=this.yS[0].cpBegin&&(h=A[0].hyperlink.url),this.jif=Math.min(this.jif,O));var O=Ge.HyperlinkReader.rD(this.yS[t-1],!1);0<O.length&&({cpBegin:O,cpEnd:b}=kp.j_.Ufa(this.yS[t-1],O[O.length-1]),this.GFf=Math.max(this.GFf,b));this.GGo(this.jif,this.GFf);return h}GGo(b,h){const t=this.yS.length;if(b!==this.yS[0].cpBegin||h!==this.yS[t-1].cpEnd){b=pf.a.Tc(this.yS[0].node,b);b=wf.SelectionFactory.Zn(b);h=pf.a.Tc(this.yS[t-1].node,h);h=wf.SelectionFactory.Vz(b,
h);b=this.aei(h.Qa.clone());const A=this.aei(h.Rc.clone());b&&A&&(this.yS[0]=b,this.yS[t-1]=A,this.mh.nb.setSelection(h),this.$w=h)}}ztm(b){if(!b)return!1;b=Ge.HyperlinkReader.DOa(b);for(let t=0;t<this.yS.length;t++){var h=this.yS[t];if(kp.Ysa&&nf.SelectionEditor.gl(h)&&(h=nf.SelectionEditor.jhg(h),!nf.SelectionEditor.gl(h)))continue;h=pf.a.createTextRange(this.yS[t].node,h.cpBegin,h.cpEnd);this.jGo(h);kp.hyperlinkEditor.jH(h,b,!1)}return!0}jGo(b){jp.a.instance.J(1)&&kp.Kd.jvj(b)}aei(b){return qe.ParagraphReader.im(b)&&
!nf.SelectionEditor.d8(b)&&qe.ParagraphReader.textLength(b.node)?pf.a.createTextRange(b.node,0,qe.ParagraphReader.textLength(b.node)):nf.SelectionEditor.gl(b)?b:null}Ibl(){let b=!1;for(const h of this.yS){const t=Ge.HyperlinkReader.rD(h,!1);t&&(b=kp.j_.t4i(h,t)||b)}return b}static get j_(){return null!=kp.vxg?kp.vxg:kp.vxg=Sa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Kd(){return null!=kp.YEg?kp.YEg:kp.YEg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get hyperlinkEditor(){return null!=
kp.mxg?kp.mxg:kp.mxg=Sa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Ysa(){null==kp.E9&&(kp.E9=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return kp.E9}static get kBf(){null==kp.yDe&&(kp.yDe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return kp.yDe}}kp.E9=null;kp.yDe=null;Object(m.a)(kp,"InsertMultiParagraphLinkDialog",Pf.a,[]);var rw;(function(b){b.Heading="Heading";b.Bookmark="Bookmark";
b.Url="Url";b.RecentLinks="RecentLinks"})(rw||(rw={}));Object(m.b)("InsertLinkUserActivitySource",rw);class kB{constructor(b,h,t,A,O){this.linkurl=b;this.isHeading=h;this.startCp=t;this.endCp=A;this.paragraphNode=O}}Object(m.a)(kB,"HeadingDataForLinkDialog",null,[]);class lB{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(m.a)(lB,"BookmarkDataForLinkDialog",null,[]);class ht{constructor(b,h,t,A,O,aa){this.key=b;this.name=h;this.startIndex=t;this.count=A;this.level=O;this.isCollapsed=aa}}
Object(m.a)(ht,"GroupHeaderDataForLinkDialog",null,[]);class ki{constructor(b,h){this.selectedIndex=b;this.selectedGroupId=h}}Object(m.a)(ki,"SelectedItemFromLinkDialogGroupedList",null,[]);class Dy{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){this.Tq=b;this.qd=h;this.Til=t;this.bookmarkManager=A;this.j_=O;this.hyperlinkEditor=aa;this.characterPropertiesEditor=ua;this.Kd=Ra;this.lj=ub;this.Gk=Nb;this.Qva=Yb;this.wCb=null;this.Wri=!1;this.$xf=(Pc,jd)=>{var Cd;if(this.je.Qt){var ee=Ge.HyperlinkReader.nOc(this.Tq),
Od=this.je.nb.hb.lb;if(Od){Od=Od.Qa;qe.ParagraphReader.im(Od)&&(Od=pf.a.createTextRange(Od.node,0,qe.ParagraphReader.textLength(Od.node)));var fe=nf.SelectionEditor.mPb(Od);nf.SelectionEditor.gl(fe)&&(Od=fe);if(0!==Pc&&32===v.AFrameworkApplication.xa.Nf(Od,qa.a.insertHyperlink,1,!0,null,null)&&this.Tq.equals(Od)){Ok.a.mark(5562);(null===(Cd=Jb.App.xd)||void 0===Cd?0:Cd.Yp)&&this.je.nb.MZb();Pc=new Te.GraphTransaction(15);Pc.Eb(this.Tq.node);this.Tq.node.pH().NE.Q6(4);Cd=jd.txtDisplay;Od=!1;if(null!=
jd.linkurl)if(Od=!0,jd.isHeading){l(this.qd,"Heading");fe=jd.paragraphNode;const Ee=jd.startCp,re=jd.endCp;jd=this.bookmarkManager.jGl(fe);this.bookmarkManager.rCc(jd,Ee,re,fe,fe,!1)}else l(this.qd,"Bookmark"),jd=jd.linkurl;else l(this.qd,"Url"),jd=jd.txtLink.trim();this.insertLink(Cd,jd,ee,Od);Pc.kk=qa.a.insertHyperlink;Pc.dispose();Ok.a.mark(5563);this.Tq.node.tfb()}else this.je.K4()}else u.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};
this.je=pc.InteractiveViewManager.instance.vd;this.Tq=b;t=nf.SelectionEditor.mPb(this.Tq);nf.SelectionEditor.gl(t)&&(this.Tq=t);const bc=new Pf.a(!1,!1,!0);t=this.KQl();A={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:t};O=this.wCb="";O=qe.ParagraphReader.text(this.Tq.node);
ua=this.Tq.cpBegin;Ra=this.Tq.cpEnd;({L6f:O,Egf:ua,Fgf:Ra,$vf:aa}=this.wMl(O));if((h="object"===typeof h?h:null)&&(h.Source&&"CommandingInterface"===h.Source||h.Url&&h.DisplayText))this.insertLink(h.DisplayText,h.Url,aa);else{aa[0]&&this.Lql(ua,Ra,aa[0].paragraph);h=""===O.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;bc.Ge(1,h);(null===O||void 0===O?0:O.startsWith(F.a.kdb))?(h=this.F4l(O,t))?t.selectedItem=h:A.txtLink=O:A.txtLink=O;A.txtDisplay=this.wCb;1>=aa.length&&
this.j_.wYk(b,aa[0],1===aa.length)&&(this.Wri=!0,A.textDisplayDisabled=!0);var Dc={["id"]:"InsertLinkDialog",["bodyControls"]:A};this.Gk.he(()=>{bc.Yh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.$xf,Dc)},"RILD:IAS")}}wMl(b){const h=Ge.HyperlinkReader.nOc(this.Tq);let t=this.Tq.cpBegin,A=this.Tq.cpEnd,O="";if(!h.length)return this.wCb=b.substring(this.Tq.cpBegin,this.Tq.cpEnd),{returnValue:!0,L6f:O,Egf:t,Fgf:A,$vf:h};if(h[0].hyperlink){let aa,ua=0,Ra=Math.max(0,b.length-1),ub=0;for(let Nb=0;Nb<h.length;Nb++)h[Nb].cpBegin>=
ua&&({cpBegin:aa,cpEnd:ua}=this.j_.Ufa(this.Tq,h[Nb]),Ra=Math.min(aa,Ra),ub=Math.max(ua,ub));t=Math.min(Ra,t);A=Math.max(ub,A);this.wCb=b.substring(t,A);t===Ra&&(O=h[0].hyperlink.url);return{returnValue:!0,L6f:O,Egf:t,Fgf:A,$vf:h}}return{returnValue:!1,L6f:O,Egf:t,Fgf:A,$vf:h}}Lql(b,h,t){if(h!==this.Tq.cpEnd||b!==this.Tq.cpBegin)b=wf.SelectionFactory.nK(t,b,h),this.je.nb.setSelection(b),this.Tq=nf.SelectionEditor.mPb(b.Qa.clone())}DEo(b,h,t,A,O,aa=!1){A?(A=pf.a.createTextRange(this.Tq.node,this.Tq.cpBegin,
this.Tq.cpBegin+b.length),this.hyperlinkEditor.Mkl(A,t,h),b=wf.SelectionFactory.te(this.Tq.node,this.Tq.cpBegin+b.length)):(this.hyperlinkEditor.Ikb(this.Tq,2),this.lj.Bnb(this.Tq,2),t=pf.a.Tc(this.Tq.node,this.Tq.cpEnd),this.characterPropertiesEditor.replaceTextRange(t,b,!0),A=pf.a.createTextRange(this.Tq.node,this.Tq.cpEnd,this.Tq.cpEnd+b.length),this.hyperlinkEditor.jH(A,h,O,!1,!0,aa),b=wf.SelectionFactory.te(this.Tq.node,this.Tq.cpEnd+b.length));b&&this.je.nb.setSelection(b)}insertLink(b,h,t,
A=!1){var O=null;b||(b=h,v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!t.length||h!==t[0].hyperlink.url)&&!A){h=Ge.HyperlinkReader.DOa(h);var aa="";this.Qva&&({D1f:aa}=this.Qva.ohg(h)).returnValue&&(h=aa)}this.Wri||(b=this.hyperlinkEditor.WXn(b));aa=!1;if(h){O=0<t.length;const ua=qe.ParagraphReader.text(this.Tq.node).substring(this.Tq.cpBegin,this.Tq.cpEnd)!==b,Ra=this.Kd.Cg;if(Ra&&1===t.length&&!t[0].hyperlink.iG&&
!(t[0].cpBegin>this.Tq.cpBegin&&t[0].cpEnd<=this.Tq.cpEnd)){this.DEo(b,h,t[0].hyperlink,!ua,O,A);return}if(O)for(let ub=0;ub<t.length;ub++)t[ub].hyperlink.iG&&(aa=!0),this.hyperlinkEditor.iR(this.Tq.node,t[ub].hyperlink,!1);ua?this.characterPropertiesEditor.replaceTextRange(this.Tq,b,!aa):Ra&&!aa&&this.lj.Bnb(this.Tq,1);t=pf.a.createTextRange(this.Tq.node,this.Tq.cpBegin,this.Tq.cpBegin+b.length);this.hyperlinkEditor.jH(t,h,O,aa,!0,A);O=wf.SelectionFactory.te(this.Tq.node,this.Tq.cpBegin+b.length)}else 0<
t.length&&(b=t[0],b.hyperlink.iG&&(aa=!0),this.hyperlinkEditor.iR(b.paragraph,b.hyperlink));aa&&this.Kd.Bs(aa?2:7);O&&this.je.nb.setSelection(O);Jb.App.WFo()}F4l(b,h){h=h.items;const t=b.substring(F.a.kdb.length),A=this.bookmarkManager.f$h(t);b=-1;let O=0;for(let aa=0;aa<h.length;aa++)if(h[aa].isHeading&&0!=A.count&&h[aa].paragraphNode.id==A.J(0).id){b=aa;break}else if(!h[aa].isHeading&&h[aa].linkurl==t){b=aa;O=1;break}h=new ki(b,O);return-1!=b?h:null}KQl(){const b={};let h=[],t=0,A=0;var O=this.Til.mRl();
O&&(t=O.count,h=h.concat(this.rRl(O)));if(O=this.bookmarkManager.jMd(!1))A=O.count,h=h.concat(this.nGl(O));b.groups=this.eRl(t,A);b.items=h;return b}eRl(b,h){const t=[],A=new ht("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);t.push(A);b=new ht("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,b,h,0,!0);t.push(b);return t}rRl(b){const h=[],t=/\uFFFC/;for(const A of b)b=A.characterData.replace(t," "),b=new kB(b,!0,A.begin,A.end,A.paragraphNode),h.push(b);
return h}nGl(b){const h=[];for(const t of b)b=t.Lf(Lc.a.$s).toString(),b=new lB(b,!1),h.push(b);return h}}Object(m.a)(Dy,"ReactInsertLinkDialog",null,[]);class jf{static get Zf(){return rl.a.instance}static get N2(){return null!=jf.ztg?jf.ztg:jf.ztg=Sa.a.instance.Ma("Box4.IContentControlChpHelper")}static get j_(){return null!=jf.wxg?jf.wxg:jf.wxg=Sa.a.instance.resolve("Box4.IHyperlinkStrategy")}static Gw(){return jf.Rm||(jf.Rm=Sa.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Kd(){return null!=
jf.jFg?jf.jFg:jf.jFg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get yh(){return null!=jf.qFg?jf.qFg:jf.qFg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Vg(){return Ik.ContextSetEditor.instance}static get Jc(){return zk.a.instance}static get QXc(){null==jf.Zpb&&(jf.Zpb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return jf.Zpb}static get Ysa(){null==jf.E9&&(jf.E9=
v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return jf.E9}static get hyperlinkEditor(){return null!=jf.sxg?jf.sxg:jf.sxg=Sa.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=jf.ntg?jf.ntg:jf.ntg=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get x2a(){jf.WDe||(jf.WDe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost"):
!1);return jf.WDe}static get gCo(){jf.hfh||(jf.hfh=v.AFrameworkApplication.K?v.AFrameworkApplication.K.pc("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return jf.hfh}static Ub(){const b=v.AFrameworkApplication.xa;b.pa(qa.a.insertHyperlink,mc.a.view,jf.YEb);b.pa(qa.a.insertHyperlink,mc.a.Vc,jf.insertLink);b.pa(qa.a.insertHyperlink,mc.a.Fd,jf.insertLink);b.Uc(qa.a.insertHyperlink,1028);b.pa(qa.a.l4b,mc.a.view,jf.YEb);b.pa(qa.a.l4b,mc.a.Vc,jf.insertLink);b.pa(qa.a.l4b,mc.a.Fd,jf.insertLink);
b.Uc(qa.a.l4b,1028);b.pa(qa.a.iR,mc.a.view,jf.YEb);b.pa(qa.a.iR,mc.a.Vc,jf.D4i);b.pa(qa.a.iR,mc.a.Fd,jf.D4i);b.Uc(qa.a.iR,1028);b.pa(qa.a.xde,mc.a.view,jf.YEb);b.pa(qa.a.xde,mc.a.Vc,jf.Qbj);b.pa(qa.a.xde,mc.a.Fd,jf.Qbj);b.pa(qa.a.a4a,mc.a.view,jf.YEb);b.pa(qa.a.a4a,mc.a.Vc,jf.GSi);b.pa(qa.a.a4a,mc.a.Fd,jf.GSi);b.pa(qa.a.a4a,mc.a.image,jf.UTf);b.pa(qa.a.a4a,mc.a.jCb,jf.UTf);b.pa(qa.a.a4a,mc.a.anchoredObject,jf.UTf);b.pa(qa.a.nFc,mc.a.application,jf.nFc);b.pa(qa.a.NEd,mc.a.view,jf.YEb);jf.x2a&&(b.gb(ab.a.L4a,
mc.a.view,this.YEb.bind(this),1028),b.pa(ab.a.L4a,mc.a.Vc,this.L4a.bind(this)),b.pa(ab.a.L4a,mc.a.Fd,this.L4a.bind(this)),b.Uc(ab.a.L4a,1028),b.pa(ab.a.ayf,mc.a.Vc,this.L4a.bind(this)),b.pa(ab.a.ayf,mc.a.Fd,this.L4a.bind(this)),b.Uc(ab.a.ayf,1028),b.pa(ab.a.YWf,mc.a.view,this.YWf.bind(this)),b.pa(ab.a.SWf,mc.a.view,this.SWf.bind(this)),b.gb(ab.a.iib,mc.a.Vc,this.iib.bind(this),1028),b.gb(ab.a.iib,mc.a.Fd,this.iib.bind(this),1028))}static nFc(){return 32}static L4a(b,h,t){if(!jf.x2a)return 2;b=jf.MCj(h);
if(32!=b)return b;if(!jf.TPa(h,!0).returnValue||jf.h2b(h))return 8;1!==t||jf.$Wh||(jf.eme(!0),jf.$Wh=!0);return 32}static YWf(b,h,t,A,O){if(!jf.x2a)return 2;if(1===t)return 32;jf.Hae(jf.t9j,jf.u9j,jf.v9g);Fq.a.instance.he(()=>{jf.eme();O.MenuItems=Object.assign(new gj.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const aa=this.SIh();aa?(u.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),O.MenuItems.MenuSectionList.push(aa)):jf.FWi(O,jf.v9g)},"HA:PRLF");
return 32}static SWf(b,h,t,A,O){if(!jf.x2a)return 2;if(1===t)return 32;jf.Hae(jf.r9j,jf.s9j,jf.u9g);Fq.a.instance.he(()=>{jf.eme();O.MenuItems=Object.assign(new gj.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});O.MenuItems.MenuSectionList.push(this.o4k());const aa=this.SIh(!0);aa?(u.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),O.MenuItems.MenuSectionList.push(aa)):jf.FWi(O,jf.u9g)},"HA:PILF");return 32}static FWi(b,h){u.ULS.sendTraceTag(524911777,
324,50,"Recent Links could not load in "+h);jf.Hae(jf.V5j,jf.W5j,h);b.MenuItems.MenuSectionList.push(this.O6k());jf.eme(!0)}static O6k(){const b=this.Y9e("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new Eh.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static o4k(){const b=this.Y9e("InsertLinkSection");b.ControlList.push(Object.assign(new Eh.a,{ExternalId:"InsertLink"}));return b}static SIh(b=!1){if(Jd.instance.ard){var h=
this.Y9e("RecentLinksSection",b);b=JSON.parse(Jd.instance.ard);this.$qd.clear();b.forEach((t,A)=>{this.$qd.set(A,[t.FileName,t.DocumentUrl]);const O=jf.y2l(t.FileName);var aa=jf.hQl(t.TimeStamp),ua=h.ControlList,Ra=ua.push,ub=Object,Nb=ub.assign,Yb=new Eh.a,bc=ab.a.iib,Dc=ab.a.iib;aa=O!==t.FileName?t.FileName+"\n"+aa:aa;var Pc=t.FileName;let jd="SaveAsWordDocx_32";switch(t.App){case "Word":jd="SaveAsWordDocx_32";break;case "PowerPoint":jd="SaveAsPowerPointPptx_32";break;case "Excel":jd="SaveAsExcelXlsx_32"}Ra.call(ua,
Nb.call(ub,Yb,{ExternalId:A,Command:bc,CommandValueId:Dc,LabelText:O,Alt:aa,AriaDescription:Pc,ExternalImageId:jd,KeyTip:t.FileName}))});return h}}static Y9e(b,h=!1){return Object.assign(new eh.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static iib(b,h,t,A,O){if(!jf.x2a)return 2;if(!O||O.CommandValueId!=ab.a.iib)return 32;jf.Hae(jf.n0j,jf.o0j,jf.F$j);t=h;h=new Te.GraphTransaction(15);h.kk=b;h.Eb(t.node);
A=jf.TPa(t,!0).hyperlink;t=nf.SelectionEditor.mPb(t);if(A)jf.v2f(t),b=wf.SelectionFactory.nK(t.node,Math.min(t.cpBegin,A.cpBegin),Math.max(t.cpEnd,A.cpEnd)),he.a.instance.setSelection(b),t=b.Qa;else if(nf.SelectionEditor.jf(t)){var aa;nf.SelectionEditor.mjb(t)&&(aa=nf.SelectionEditor.b3(t,!1));aa||(aa=this.$qd.get(O.SourceControlId)[0],jf.characterPropertiesEditor.replaceTextRange(t,aa,!0,void 0,b),aa=wf.SelectionFactory.nK(t.node,t.cpBegin,t.cpBegin+aa.length));if(aa&&(he.a.instance.setSelection(aa),
t=aa.Qa,jf.h2b(t)))return jf.Kd.VNb(!1),8}try{jf.hyperlinkEditor.jH(t,this.$qd.get(O.SourceControlId)[1],0<Ge.HyperlinkReader.nOc(t).length);const ua=wf.SelectionFactory.te(t.node,t.cpEnd);ua&&he.a.instance.setSelection(ua);l(O,"RecentLinks")}finally{h&&h.dispose()}u.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static YEb(b,h,t,A,O){if(jf.QXc)return jf.jmm(b,h,t,A,O);if(!h.view.re)return 2;var aa=h.view.nb;if(!aa||!aa.hb||!aa.hb.length)return 8;var ua=aa.hb.lb;let Ra=ua.Qa.clone();
if(2===ua.length){if(ua=ua.J(1),!nf.SelectionEditor.gl(Ra)||!nf.SelectionEditor.Dk(ua)||Ra.node!==ua.node)return 8}else if(2<ua.length)return 8;if(aa.hb.YI)return 8;if(jf.Vg.Oya(qe.ParagraphReader.ZT,aa.pg))return jf.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.IN}),8;qe.ParagraphReader.im(Ra)&&!nf.SelectionEditor.d8(Ra)&&(aa=Ra.node,Ra=pf.a.createTextRange(aa,0,qe.ParagraphReader.textLength(aa)));return b===qa.a.NEd?jf.RFh(h,Ra,t,A):v.AFrameworkApplication.xa.Nf(Ra,b,t,!0,A,O)}static jmm(b,h,t,A,O){if(!h.view.re)return 2;
var aa=h.view.nb;if(!aa||!aa.hb||!aa.hb.length||aa.hb.YI)return 8;var ua=aa.hb.lb;if(aa=jf.IDf(ua))ua=jf.vsf(ua.Qa.clone(),!0);else{let Ra=ua.J(0).clone(),ub=1;for(;ub<ua.length&&(!qe.ParagraphReader.textLength(Ra.node)||nf.SelectionEditor.Dk(Ra)||jf.Ysa&&zc.l(Ra));)Ra=ua.J(ub).clone(),ub++;ua=jf.vsf(Ra,!1)}return jf.Ysa&&nf.SelectionEditor.gl(ua)&&zc.l(ua)||!nf.SelectionEditor.gl(ua)&&!aa?8:b===qa.a.NEd?jf.RFh(h,ua,t,A):v.AFrameworkApplication.xa.Nf(ua,b,t,!0,A,O)}static IDf(b){if(1===b.length)return!0;
if(2===b.length){const h=b.Qa.clone();b=b.J(1);return nf.SelectionEditor.gl(h)&&nf.SelectionEditor.Dk(b)&&h.node===b.node?!0:!1}return!1}static oDh(b){let h=null;const t=[];for(let A=0;A<b.length;A++){const O=jf.vsf(b.J(A).clone(),!1);if(nf.SelectionEditor.gl(O))jf.Ysa&&zc.l(O)||t.push(O);else if(!nf.SelectionEditor.Dk(O)&&!qe.ParagraphReader.im(O))return{returnValue:!1,jeb:h}}h=t;return{returnValue:!jf.Ysa||0<h.length?!0:!1,jeb:h}}static insertLink(b,h,t,A,O){if(jf.QXc)return jf.Htm(h,t,O);A=jf.MCj(h);
if(32!==A)return A;let aa;if(!({hyperlink:aa}=jf.TPa(h,!0)).returnValue||jf.h2b(h)||!aa&&b==qa.a.l4b)return 8;if(1===t)return 32;if(!aa&&nf.SelectionEditor.jf(h)&&nf.SelectionEditor.mjb(h)&&(b=nf.SelectionEditor.b3(h,!1))&&(he.a.instance.setSelection(b),h=b.Qa,jf.h2b(h)))return jf.Kd.VNb(!1),8;aa&&u.ULS.sendTraceTag(593875799,324,50,"Edit link");a(h,O);return 32}static MCj(b){return!jf.A3e()||!jf.oBd(b)||b.node.jr||he.a.instance.hb.YI?8:nf.SelectionEditor.w3(b)||Po.a.QAf(b)?2:32}static Htm(b,h,t){var A=
he.a.instance.hb.lb;const O=jf.IDf(A);if(O)b=[b];else if(!({jeb:b}=jf.oDh(A)).returnValue)return 8;if(!jf.A3e())return 8;for(A=0;A<b.length;A++)if(!jf.oBd(b[A]))return 8;if(he.a.instance.hb.YI)return 8;A=Array(b.length);let aa=null;for(let ua=0;ua<b.length;ua++)if(A[ua]=b[ua],!({hyperlink:aa}=jf.TPa(A[ua],!0)).returnValue||jf.h2b(A[ua]))return 8;if(1===h)return 32;if(!aa&&1===A.length&&O&&nf.SelectionEditor.jf(A[0])&&nf.SelectionEditor.mjb(A[0])&&(h=nf.SelectionEditor.b3(A[0],!1))&&(he.a.instance.setSelection(h),
A[0]=h.Qa,jf.h2b(A[0])))return jf.Kd.VNb(!1),8;O?a(A[0],t):new kp(A,t);return 32}static D4i(b,h,t){if(jf.QXc)return jf.rTn(b,h,t);if(!jf.oBd(h)||nf.SelectionEditor.w3(h))return 2;let A;if(!({hyperlink:A}=jf.TPa(h,!1)).returnValue)return 2;if(2===t){t=new Te.GraphTransaction(15);try{t.kk=b,t.Eb(A.paragraph),jf.v2f(h)}finally{t&&t.dispose()}A.hyperlink.iG&&jf.Kd.Bs(2)}return 32}static rTn(b,h,t){var A=he.a.instance.hb.lb;if(jf.IDf(A))h=[h];else if(!({jeb:h}=jf.oDh(A)).returnValue)return 8;if(!jf.A3e())return 8;
for(A=0;A<h.length;A++)if(!jf.oBd(h[A]))return 8;if(1===t&&!jf.TPa(h[0],!1).returnValue)return 2;if(2===t){for(t=0;t<h.length;t++)if(!jf.TPa(h[t],!0).returnValue)return 2;t=new Te.GraphTransaction(15);try{const O=h[0];t.kk=b;t.Eb(O.node);for(b=0;b<h.length;b++)jf.v2f(h[b])}finally{t&&t.dispose()}jf.Kd.Bs(7)}return 32}static v2f(b){const h=Ge.HyperlinkReader.nOc(b);let t=0;for(let A=0;A<h.length;A++)if(h[A].cpBegin>=t){const O=({cpEnd:t}=jf.j_.Ufa(b,h[A])).returnValue;jf.j_.t4i(b,O)}}static Qbj(b,
h,t){if(Be.ImageReader.O1a(h)||!({hyperlink:b}=jf.TPa(h,!1)).returnValue)return 2;if(2===t){const {cpBegin:A,cpEnd:O}=jf.j_.Ufa(h,b);he.a.instance.setSelection(wf.SelectionFactory.nK(b.paragraph,A,O))}return 32}static GSi(b,h,t){if(({hyperlink:b}=jf.AMm(h)).returnValue)u.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=jf.TPa(h,!1)).returnValue)return 2;2===t&&Jb.App.Ufb(b.hyperlink.url);return 32}static UTf(b,h,t){b=Be.ImageReader.Ufa(h.node);
if(!b)return 2;2===t&&Jb.App.Ufb(b);return 32}static RFh(b,h,t,A){if(Be.ImageReader.O1a(h)||!pc.InteractiveViewManager.instance.editingView.Pj)return 2;let O;if(!({hyperlink:O}=jf.TPa(h,!1)).returnValue)return 2;if(1===t)return 32;const {cpBegin:aa,cpEnd:ua}=jf.j_.Ufa(h,O);he.a.instance.setSelection(wf.SelectionFactory.nK(O.paragraph,aa,ua));h=pc.InteractiveViewManager.instance.nCa.ownerDocument.createElement("span");h.innerText=O.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return v.AFrameworkApplication.xa.Nf(b,
qa.a.MEd,2,!0,A,h)}static TPa(b,h){if(nf.SelectionEditor.gl(b)){const t=zc.g(b),A=gl.a.all(t,O=>6===O.zh);if(0<t.length&&(!jf.Ysa||!A)||jf.Zf.kh&&jf.N2&&0<jf.N2.XMd(b).count)return{returnValue:!1,hyperlink:null}}return jf.pMm(b,h)}static AMm(b){let h=null;return Be.ImageReader.O1a(b)&&(h=Ge.HyperlinkReader.D6b(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static pMm(b,h){let t=null;const A=Ge.HyperlinkReader.nOc(b);return A.length?A[0].hyperlink?(t=A[0],b.cpBegin<A[0].cpBegin?{returnValue:h,
hyperlink:t}:{returnValue:!0,hyperlink:t}):{returnValue:!1,hyperlink:t}:{returnValue:h,hyperlink:t}}static h2b(b){if(jp.a.instance.J(1)){b=jf.yh.FOa(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.J(h).Gd.changeType)return!0}return!1}static A3e(){return jp.a.instance.J(1)?!0:!jp.a.instance.J(1)||!Jb.App.Ov.iPb}static oBd(b){return jf.Zf.JZ(b)||jf.Zf.Gna(b)||jf.Gw()&&jf.Gw().instance&&jf.Gw().instance.aU(b)?!1:!0}static vsf(b,h){return qe.ParagraphReader.im(b)&&!nf.SelectionEditor.d8(b)&&
(qe.ParagraphReader.textLength(b.node)||h)?pf.a.createTextRange(b.node,0,qe.ParagraphReader.textLength(b.node)):b}static y2l(b){return b&&b.length<=jf.T0i?b:b.substring(0,jf.T0i)+"..."}static hQl(b){try{const h=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static eme(b=!1){const h=Date.now();if(b||h-jf.kAi>jf.gCo)Jd.instance.n3m(),jf.kAi=h}static Hae(b,
h,t){const A=new Map;A.set("Source",t);A.set("Action",h);wa.Health.instance.recordKpiUsage(b,0,this.mVa,A)}}jf.Rm=null;jf.Zpb=null;jf.E9=null;jf.$qd=new Map;jf.WDe=null;jf.T0i=35;jf.kAi=Date.now();jf.$Wh=!1;jf.mVa="wwaengidc";jf.F$j="RecentLinks";jf.v9g="RecentLinksRibbonOptions";jf.u9g="RecentLinksContextMenuOptions";jf.t9j="PopulateRecentLinksRibbon";jf.u9j="PopulateRecentLinksRibbonAction";jf.r9j="PopulateRecentLinksContextMenu";jf.s9j="PopulateRecentLinksContextMenuAction";jf.V5j="PopulateRecentLinksContextMenu";
jf.W5j="PopulateRecentLinksContextMenuAction";jf.n0j="InsertRecentLinks";jf.o0j="InsertRecentLinksAction";Object(m.a)(jf,"HyperlinkActor",null,[]);class Nx{}Nx.Bjb=Object.freeze({vom:"WordIndentationShortcutUsage"});Nx.dB="wwaengidc";Object(m.a)(Nx,"IndentationConstants",null,[]);class hm{static get Xp(){return Jv.a.JDb}static get Vg(){return Ik.ContextSetEditor.instance}static get Zf(){return rl.a.instance}static get Jc(){return zk.a.instance}static get vo(){return pc.InteractiveViewManager.instance}static Gw(){return hm.Rm||
(hm.Rm=Sa.a.instance.Sa("Box4.IExternalSelectionManager"))}static get uom(){return null!=hm.Dxg?hm.Dxg:hm.Dxg=Sa.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Ub(){const b=v.AFrameworkApplication.xa;b.pa(qa.a.pG,mc.a.view,hm.oDc);b.pa(qa.a.pG,mc.a.outlineElement,hm.yqh);b.Uc(qa.a.pG,1036);b.pa(qa.a.RN,mc.a.view,hm.oDc);b.pa(qa.a.RN,mc.a.outlineElement,hm.yqh);b.Uc(qa.a.RN,1036)}static RKn(b){const h=new Map;b=b?b.ia(Jh.a.Pli,"Unknown"):"tab";h.set("actionCallSource",b);wa.Health.instance.recordKpiUsage(Nx.Bjb.vom,
1,Nx.dB,h)}static oDc(b,h,t,A,O){const aa=h.view;if(!aa.re)return 2;var ua=aa.nb;if(!ua)return hm.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.Gba}),8;ua=ua.pg;if(!ua)return hm.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.noSelection}),8;if(Po.a.vga(h))return 8;if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&hm.Zf.W9b(ua))return hm.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.tE}),8;if(1===t)return 32;if(hm.Vg.zCa(hm.zZe,ua))return hm.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.iGc}),8;if(hm.Vg.Oya(qe.ParagraphReader.ZT,
ua))return hm.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.IN}),8;if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&hm.Zf.W9b(ua))return hm.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.tE}),8;if(hm.Gw()&&hm.Gw().instance&&hm.Gw().instance.aU(ua))return hm.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.externalSelection}),8;ua={};ua[Xf.a.yIa]=5794;ua[Xf.a.xIa]=5795;return hm.uom.oDc(aa,b,h,t,A,O,ua)}static yqh(b,h,t,A,O){var aa,ua;if(h.contextId!==mc.a.outlineElement)return 2;var Ra=h.clone().tcg();
if(ni.TableReader.Wxi(Ra)){if(hm.Zf.Xxi(Ra))return hm.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.tE}),8}else if(hm.Zf.y2a(Ra))return hm.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.tE}),2;Ra=new ue.GraphIterator;Ra.set(h.node);nf.SelectionEditor.au(Ra);if(!mb.OutlineElementReader.Lh(Ra))return 2;let ub;switch(b){case qa.a.pG:ub=hm.Xp.lzb(Ra);break;case qa.a.RN:ub=hm.Xp.b1b(Ra);break;default:return 2}if(1===t||!ub)return ub?32:8;t=0;b===qa.a.RN&&O&&O.ia(Gd.a.rsh,!1)&&(t|=2);if(mb.OutlineElementReader.UP(Ra))return hm.Jc.Zb(gg.a.Ym,
{["Reason"]:uf.a.IN}),2;(null===(ua=null===(aa=hm.vo)||void 0===aa?void 0:aa.vd)||void 0===ua?0:ua.bU)&&hm.vo.editingView&&(hm.vo.editingView.LH=!0);switch(b){case qa.a.pG:hm.Xp.tRa(Ra,-1,t);break;case qa.a.RN:hm.Xp.dIc(Ra,1)}A&&Ds.a.Gob&&(A.Ur|=Ds.a.xgb(h.node,!0));hm.RKn(O);return 32}}hm.Rm=null;hm.zZe=Be.ImageReader.N1a;Object(m.a)(hm,"IndentationActor",null,[]);var hn=c(1563);class ol{static get paragraphEditor(){return null!=ol.QBg?ol.QBg:ol.QBg=Sa.a.instance.resolve("Box4.IParagraphEditor")}static get tk(){return null!=
ol.bEg?ol.bEg:ol.bEg=Sa.a.instance.resolve("Box4.ITableEditor")}static get Zf(){return rl.a.instance}static get Jc(){return zk.a.instance}static Gw(){return ol.Rm||(ol.Rm=Sa.a.instance.Sa("Box4.IExternalSelectionManager"))}static Ub(){const b=v.AFrameworkApplication.xa;b.pa(qa.a.$rj,mc.a.view,(h,t)=>Po.a.vga(t)?8:32);b.pa(qa.a.leftJustify,mc.a.view,hn.a.Mv);b.pa(qa.a.leftJustify,mc.a.paragraph,ol.KBa);b.pa(qa.a.leftJustify,mc.a.table,ol.D_e);b.Uc(qa.a.leftJustify,1036);b.pa(qa.a.centerJustify,mc.a.view,
hn.a.Mv);b.pa(qa.a.centerJustify,mc.a.paragraph,ol.KBa);b.pa(qa.a.centerJustify,mc.a.table,ol.D_e);b.Uc(qa.a.centerJustify,1036);b.pa(qa.a.rightJustify,mc.a.view,hn.a.Mv);b.pa(qa.a.rightJustify,mc.a.paragraph,ol.KBa);b.pa(qa.a.rightJustify,mc.a.table,ol.D_e);b.Uc(qa.a.rightJustify,1036);b.pa(qa.a.fullJustify,mc.a.view,hn.a.Mv);b.pa(qa.a.fullJustify,mc.a.paragraph,ol.KBa);b.Uc(qa.a.fullJustify,1036);b.pa(qa.a.GIc,mc.a.view,hn.a.Mv);b.pa(qa.a.GIc,mc.a.paragraph,ol.KBa);b.Uc(qa.a.GIc,1036);b.pa(qa.a.rHb,
mc.a.view,hn.a.Mv);b.pa(qa.a.rHb,mc.a.paragraph,ol.KBa);b.Uc(qa.a.rHb,1036);b.pa(qa.a.X5c,mc.a.view,hn.a.Mv);b.pa(qa.a.X5c,mc.a.paragraph,ol.KBa);b.Uc(qa.a.X5c,1036);b.pa(qa.a.zbc,mc.a.view,hn.a.Mv);b.pa(qa.a.zbc,mc.a.paragraph,ol.KBa);b.Uc(qa.a.zbc,1036);b.pa(qa.a.t1b,mc.a.view,hn.a.Mv);b.pa(qa.a.t1b,mc.a.paragraph,ol.KBa);b.Uc(qa.a.t1b,1036);b.pa(qa.a.Fgc,mc.a.view,hn.a.Mv);b.pa(qa.a.Fgc,mc.a.paragraph,ol.KBa);b.Uc(qa.a.Fgc,1036);b.pa(qa.a.G5b,mc.a.view,hn.a.Mv);b.pa(qa.a.G5b,mc.a.paragraph,ol.KBa);
b.Uc(qa.a.G5b,1036)}static D_e(b,h,t,A){let O=!0;if(!h)return 8;ni.TableReader.Wxi(h)?ol.Zf.Xxi(h)?(ol.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.tE}),O=!1):ol.Gw()&&ol.Gw().instance&&ol.Gw().instance.aU(h)&&(ol.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.externalSelection}),O=!1):(ol.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.Gdf}),O=!1);if(1===t||!O)return O?32:8;h=h.node;switch(b){case qa.a.leftJustify:ol.tk.LD(h,1);break;case qa.a.centerJustify:ol.tk.LD(h,2);break;case qa.a.rightJustify:ol.tk.LD(h,3)}A&&Ds.a.Gob&&(A.Ur|=2);return 32}static KBa(b,
h,t,A,O){let aa=!0;h.contextId!==mc.a.paragraph?aa=!1:ol.Zf.y2a(h)?(ol.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.tE}),aa=!1):ol.Gw()&&ol.Gw().instance&&ol.Gw().instance.aU(h)&&(ol.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.externalSelection}),aa=!1);if(1===t||!aa)return aa?32:8;h=h.node;t=qe.ParagraphReader.Uv(h);switch(b){case qa.a.leftJustify:case qa.a.zbc:ol.paragraphEditor.LD(h,1===t&&ol.eZd(O)?6:1);break;case qa.a.centerJustify:case qa.a.t1b:ol.paragraphEditor.LD(h,2===t&&ol.eZd(O)?1:2);break;case qa.a.rightJustify:case qa.a.Fgc:ol.paragraphEditor.LD(h,
3===t&&ol.eZd(O)?1:3);break;case qa.a.fullJustify:case qa.a.G5b:ol.paragraphEditor.LD(h,6===t&&ol.eZd(O)?1:6);break;case qa.a.rHb:ol.paragraphEditor.LD(h,11);break;case qa.a.GIc:ol.paragraphEditor.LD(h,7);break;case qa.a.X5c:ol.paragraphEditor.LD(h,13)}A&&Ds.a.Gob&&(A.Ur|=Ds.a.xgb(h));return 32}static eZd(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}ol.Rm=null;Object(m.a)(ol,"JustificationActor",null,[]);const mB=()=>{const b=v.AFrameworkApplication.xa;
b.pa(qa.a.save,yc.a.frame,Ox);b.pa(qa.a.sync,yc.a.frame,iC)},iC=(b,h,t)=>{if(1===t)return 32;v.AFrameworkApplication.xa.processAction(qa.a.nzb,2);Jb.App.jk.Rie();return 32},Ox=(b,h,t)=>{if(1===t)return 2===Jb.App.ya.mode?32:8;v.AFrameworkApplication.xa.processAction(qa.a.nzb,2);if(2!==Jb.App.ya.mode)return 32;Jb.App.jk.maj(null,null);return 32};class sw{constructor(){this.activateRibbonTab=(b,h,t,A,O)=>{Jb.App.Ov.tI.Hce(O.toString());return 32};this.fQm=(b,h,t,A,O)=>{v.AFrameworkApplication.moa("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");
Jb.App.Ov.tI.Czi(1,O.toString());return 32};this.pon=(b,h)=>{if(h.contextId!==yc.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Ub(){const b=v.AFrameworkApplication.xa;b.pa(qa.a.activateRibbonTab,mc.a.view,this.activateRibbonTab);b.Uc(qa.a.activateRibbonTab,5);b.pa(qa.a.Dzi,mc.a.view,this.fQm);b.pa(qa.a.stj,yc.a.frame,this.pon)}static get instance(){return null!=sw.fyg?sw.fyg:sw.fyg=sw.Sl()}static Sl(){return new sw}}Object(m.a)(sw,"RibbonActor",null,[]);var Ht=c(576);class $t{constructor(b,
h){this.Dm=null;this.lJo=(t,A,O,aa,ua)=>{let Ra;aa=A.view;if(!aa.re)return $t.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.YIb}),8;Ra=t===qa.a.undo?this.Ug.rX:this.Ug.QOa;if(1===O)return Po.a.vga(A)&&Po.a.l$b()?8:Ra?32:8;if(!Ra)return u.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",t===qa.a.undo?"undo":"redo"),this.cJa.value.bxj(),$t.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.gJo}),2;A=new Te.GraphTransaction(3);A.Eb(aa.Zc);A.P7f();t=t===qa.a.undo?this.Ug.undo():this.Ug.redo();A.dispose();ua&&
Rs.GrippersManager.instance.MPb(ua.ux);if(t)return 32;$t.Jc.Zb(gg.a.V3b,{["Reason"]:uf.a.xKi});return 8};this.Nka=b;this.cJa=h}get Ug(){return this.Dm||(this.Dm=this.Nka())}Ub(){const b=v.AFrameworkApplication.xa,h=this.lJo;b.gb(qa.a.undo,mc.a.view,h,1028);b.gb(qa.a.redo,mc.a.view,h,1028)}static get instance(){return null!=$t.Pxg?$t.Pxg:$t.Pxg=$t.Sl()}static Sl(){const b=Sa.a.instance;return new $t(()=>b.resolve("Box4.IUndoManager"),b.We("Box4.ICoauthCashTelemetry"))}static get Jc(){return zk.a.instance}}
Object(m.a)($t,"UndoActor",null,[]);class Px{constructor(){this.W=null}get name(){return"Box4.Actors"}yc(b){this.W=b;(new Ay).yc(b)}init(){var b=this.W.resolve("Box4.Actors.ClipboardActor");dz.a.ACf&&this.W.resolve("Box4.Actors.PageColorActor").Ub();b.Ub();b.h4();pw();su.instance.Ub();jf.Ub();hm.Ub();ol.Ub();this.W.resolve("Box4.Actors.TouchInputActor").Ub();Yw.instance.Ub();this.W.resolve("Box4.ISelectAllHandlers").Ub();mB();this.W.resolve("Box4.Actors.ProofingActor").Ub();sw.instance.Ub();(b=this.W.Ma("Box4.IFeatureHelper"))?
b.Ip.continueWith(()=>{this.b3i()}):this.b3i();Ht.a.Ub(Jb.App.iTa);this.W.resolve("Box4.Actors.TextFormattingActor").Ub();$t.instance.Ub();this.W.resolve("Box4.Actors.AccessibilityActor").c1f();this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");Jb.App.ya.updateCommandUI()}b3i(){this.W.resolve("Box4.Actors.StyleContextMenuActor").Ub();this.W.resolve("Box4.Actors.StyleActor").Ub()}dispose(){}static main(){P.a.instance.Gc(new Px)}}Object(m.a)(Px,"Box4ActorsPackage",
null,[1,2]);class nB extends Xw{constructor(b,h,t,A){super(b);this.lma=t;this.m5a=A;this.mmg=0;this.jz=h.vQa("UserAction","WordOnlineAddToDictionary")}k$f(b){this.qJd=this.lma.Hma(b);if(!this.lOk())return!1;const h=this.qJd.errorDetails.token;this.m5a.Ylh(h);if(!this.m5a.A8c(h))return u.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;u.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.jz.start();
this.transaction=new Te.GraphTransaction(15);this.transaction.Eb(b.node);return!0}w9d(b){this.NKb(b.node);return!0}B0c(b){this.NKb(b);return!0}x9d(b){this.NKb(b.node)}bfg(b){this.transaction.dispose();this.qJd.errorDetails.Uob(b.actionId);this.m5a.d6f("unused corelation id.");this.jz.stop();u.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.mmg,this.jz.ri,this.qJd.errorDetails.proofingType));return!0}$ic(b,
h){const t=b.role;return super.$ic(b,h)||9===t||10===t||13===t||7===t||8===t}NKb(b){if(b){var h=this.lma.j3(b,t=>this.m5a.A8c(t.errorDetails.token));this.lma.ymb(b,h,!0);this.mmg+=h.length}}lOk(){var b,h;return null!==(h=null===(b=this.qJd)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(u.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(m.a)(nB,"AddToDictionaryCallbackSteps",Xw,[]);class Es{constructor(b,h,t,A,O,
aa,ua){this.rc=b;this.nb=h;this.c9=t;this.lma=A;this.vq=O;this.m5a=aa;this.$Cn=ua;this.Bdm=(Ra,ub,Nb,Yb,bc,Dc)=>{const Pc=new nB(this.c9,this.vq,this.lma,this.m5a);return new Ts(Ra,ub,Nb,Yb,bc,Dc,Pc,this.rc,this.nb,this.c9,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Ub(){this.rc.FS(qa.a.addToDictionary,mc.a.view,this.Bdm,1124);this.$Cn.AQn(this.m5a)}}Object(m.a)(Es,"PersonalDictionaryOrchestrator",null,[]);class nv{get name(){return"Box4.PersonalDictionary"}yc(b){this.container=b;b.register(Es,
"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").singleInstance().Qd(()=>new Es(v.AFrameworkApplication.xa,he.a.instance,Er.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Ub()}dispose(){}static main(){rk.a.get_instance().Vk(7,()=>{P.a.instance.Gc(new nv)})}}
Object(m.a)(nv,"PersonalDictionaryPackage",null,[1,2]);class Us{constructor(b,h,t,A,O,aa){this.jAa=this.P8a=this.nV=null;this.MEc=(ua,Ra,ub,Nb,Yb)=>this.mxi(Ra,ub,Yb,!1)?32:8;this.eH=(ua,Ra,ub,Nb,Yb)=>{if(!({Qx:ua}=this.zjj(Ra,ub,Yb,!0)).returnValue)return ua;u.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");Yb=this.ufk.WMa(Ra.node,Yb);this.wvn(Ra.node,Yb);this.bP();return 32};this.Azb=(ua,Ra,ub,Nb,Yb)=>{if(!({Qx:ua}=this.zjj(Ra,ub,Yb,!1)).returnValue)return ua;
this.svn(Ra.node);return 32};this.hEn=(ua,Ra,ub,Nb,Yb)=>{if(1===ub)return 32;if(!Ra||!Ra.view.re)return 2;ua=Ra.view.nb;if(!ua)return 2;ua=ua.pg;if(!ua)return 2;ua=Us.Vg.lQ(ua,16);if(!ua||!ua.length)return 2;Ra=null;for(ub=0;ub<ua.length;ub++){Nb=ua.getContext(ub);if(!Nb||Nb.contextId!==mc.a.tableCell)return 2;const bc={};this.Bhi(Nb,bc);if(bc.CellShading)if(Ra&&Ra!==bc.CellShading){Ra=null;break}else Ra=bc.CellShading;else{Ra=null;break}}Yb.CellShading=Ra;return 32};this.YKb=(ua,Ra,ub,Nb,Yb)=>1===
ub?32:this.Bhi(Ra,Yb);this.tKb=(ua,Ra,ub,Nb,Yb)=>{if(1===ub)return 32;ua=Ra.contextId===mc.a.view?this.BAa.ONc(Ra):this.mqf(Ra);ub={};Ra=null;32===v.AFrameworkApplication.xa.Rb(qa.a.YKb,2,ub)&&ub&&(Ra=ub.CellShading);ub="";Ra&&(ub=Fl.a.wI(Ra)||"");this.yij.LMb=ub;this.$Tc&&this.recentColors.Gjg(ub);ua=this.yij.CLc(ua,Jb.App.Gzb);if(!ua)return 8;Yb.MenuItems=ua;u.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.mha=(ua,Ra,ub,Nb,Yb)=>{if(1===ub)return 32;Jb.App.ya.Dw();
v.AFrameworkApplication.xa.Rb(qa.a.YKb,2,Yb);this.P8a=new qw.a("Shading",qa.a.Bhc);this.P8a.xic(Yb&&Yb.CellShading?Yb.CellShading:0);return 32};this.fNk=(ua,Ra,ub,Nb,Yb)=>{if(1===ub)return 32;v.AFrameworkApplication.xa.Rb(qa.a.f9,2,Yb);this.recentColors.Kcb(Yb)||u.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.ufk=h;this.WHe=t;this.BAa=A;this.Wd=O;this.iq=aa}get recentColors(){return null!=this.wCg?this.wCg:this.wCg=Sa.a.instance.Ma("Box4.UI.RecentColorsSectionHandler")}get yij(){this.nV||
(this.nV=new Cy.a("Shading"),this.AEa(this.nV));return this.nV}AEa(b){b.tW(2,qa.a.Azb);b.tW(3,qa.a.f9);b.tW(4,qa.a.f9);b.fyb(this.WHe,1)}Ub(){this.ga.pa(qa.a.tKb,mc.a.view,this.tKb);this.ga.pa(qa.a.tKb,mc.a.tableCell,this.tKb);this.ga.Uc(qa.a.tKb,1126);this.ga.pa(qa.a.MEc,mc.a.view,Ht.a.GLc);this.ga.pa(qa.a.MEc,mc.a.tableCell,this.MEc);this.ga.Uc(qa.a.MEc,1028);this.ga.pa(qa.a.f9,mc.a.view,Ht.a.GLc);this.ga.pa(qa.a.f9,mc.a.tableCell,this.eH);this.ga.Uc(qa.a.f9,1028);this.ga.pa(qa.a.Azb,mc.a.view,
Ht.a.GLc);this.ga.pa(qa.a.Azb,mc.a.tableCell,this.Azb);this.ga.Uc(qa.a.Azb,1028);this.ga.pa(qa.a.YKb,mc.a.view,this.hEn);this.ga.pa(qa.a.YKb,mc.a.tableCell,this.YKb);this.ga.Uc(qa.a.YKb,1124);this.ga.pa(qa.a.Bhc,mc.a.view,Ht.a.GLc);this.ga.pa(qa.a.Bhc,mc.a.tableCell,this.fNk);this.ga.Uc(qa.a.Bhc,1028);this.ga.pa(qa.a.XTf,mc.a.view,this.mha);this.ga.Uc(qa.a.XTf,1028)}bP(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=
Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}zjj(b,h,t,A){return this.mxi(b,h,t,A)?{returnValue:2===h,Qx:32}:(2==h&&Ht.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],uf.a.dsl),{returnValue:!1,Qx:8})}mxi(b,h,t,A){return b.contextId!==mc.a.tableCell||2===h&&(A&&!t||!b.node)?!1:!0}wvn(b,h){const t=new Te.GraphTransaction(15);t.Eb(b);this.fhj(b);b.properties.setValue(Af.a.eH,
h);t.dispose()}svn(b){const h=new Te.GraphTransaction(15);h.Eb(b);this.fhj(b);b.properties.removeProperty(Af.a.eH);h.dispose()}mqf(b){return b.contextId!==mc.a.tableCell?null:(b=Us.eh.Ms(b.node))?b:null}fhj(b){if(this.Wd&&this.Wd.Cg&&(b=Object(Da.a)(Uk.TableCellNode,b))){const h=b.eR();this.iq.V5c(b,h)}}Bhi(b,h){if(b.contextId!==mc.a.tableCell)return 8;(b=b.node)&&b.hasProperty(Af.a.eH)&&(h.CellShading=b.getValue(Af.a.eH));return 32}static DHl(){return new Us(v.AFrameworkApplication.xa,xl.a.instance,
Lx.a.instance,Lk.PageReader.instance,Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get eh(){return fm.PageNavigator.instance}static get Vg(){return null!=Us.Xtg?Us.Xtg:Us.Xtg=Ik.ContextSetEditor.instance}static get instance(){return null!=Us.kzg?Us.kzg:Us.kzg=Us.DHl()}get $Tc(){null==this.jAa&&(v.AFrameworkApplication.ye("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.jAa=
v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.jAa}}Object(m.a)(Us,"CellShadingActor",null,[]);class $z{constructor(){this.W=null}get name(){return"Box4.CellShading"}yc(b){this.W=b}init(){const b=this.W.Ma("Box4.IFeatureHelper");b?b.Ip.continueWith(()=>{this.$m()}):this.$m()}$m(){Us.instance.Ub();Jb.App.ya.updateCommandUI()}dispose(){}}Object(m.a)($z,"CellShadingPackage",null,[1,2]);var Hr;
(function(b){b[b.none=0]="none";b[b.style1=1]="style1";b[b.style2=2]="style2";b[b.style3=3]="style3";b[b.style4=4]="style4";b[b.style5=5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})(Hr||(Hr={}));Object(m.b)("ListStyle",Hr);const Ey={[Hr.style1]:{[1]:"disc",[0]:"decimal"},[Hr.style2]:{[1]:"circle",[0]:"lower-alpha"},[Hr.style3]:{[1]:"square",[0]:"lower-roman"},[Hr.style4]:{[0]:"upper-alpha"},[Hr.style5]:{[0]:"upper-roman"},[Hr.bullet]:{[1]:"bullet"}};var yp;(function(b){b[b.number=
0]="number";b[b.bullet=1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.noList=16]="noList";b[b.invalid=42]="invalid"})(yp||(yp={}));Object(m.b)("ListType",yp);var fz=c(661);class Mp{constructor(b,h){this.qB=this.VVc=null;this.levelText=b;this.font=h}get m9d(){return this.levelText}get listStyle(){return 6}get Xv(){return"left"}}Object(m.a)(Mp,"ListMarkerBullet",null,[496]);class gi{static get Qn(){return null!=gi.kAg?gi.kAg:gi.kAg=Sa.a.instance.resolve("Box4.List.IListEditor")}static get Ad(){return gi.If||
(gi.If=Sa.a.instance.resolve("Box4.List.IListReader"))}static set Ad(b){gi.If=b}static get qj(){return null!=gi.Ixg?gi.Ixg:gi.Ixg=Sa.a.instance.resolve("Box4.IInsertionPointFormatting")}static Gw(){return gi.Rm||(gi.Rm=Sa.a.instance.Sa("Box4.IExternalSelectionManager"))}static get Vg(){return Ik.ContextSetEditor.instance}static get Zf(){return rl.a.instance}static get Jc(){return zk.a.instance}static get Gl(){return Km.a.getInstance()}static get g7c(){return null!=gi.eDg?gi.eDg:gi.eDg=Sa.a.instance.Ma("Box4.List.ISingleLevelListEditor")}static Ub(){const b=
v.AFrameworkApplication.xa;b.pa(qa.a.PC,mc.a.view,gi.lDc);b.pa(qa.a.PC,mc.a.outlineElement,gi.cla);b.Uc(qa.a.PC,1036);b.pa(qa.a.bL,mc.a.view,gi.lDc);b.pa(qa.a.bL,mc.a.outlineElement,gi.cla);b.Uc(qa.a.bL,1036);b.pa(qa.a.Fba,mc.a.view,gi.lDc);b.pa(qa.a.Fba,mc.a.outlineElement,gi.cla);b.Uc(qa.a.Fba,1036);b.pa(qa.a.q_e,mc.a.view,Kf.ActionManager.Kf);b.pa(qa.a.CAh,mc.a.view,Kf.ActionManager.Kf);b.pa(qa.a.joinList,mc.a.view,gi.wZn);b.pa(qa.a.$Ze,mc.a.view,Kf.ActionManager.Kf);b.pa(qa.a.r_e,mc.a.view,Kf.ActionManager.Kf);
b.pa(qa.a.eeg,mc.a.view,Kf.ActionManager.Kf);b.pa(qa.a.Jqj,mc.a.view,Kf.ActionManager.Kf);b.pa(qa.a.jle,mc.a.view,Kf.ActionManager.Kf)}static wZn(){fz.a.p8i();return 32}static lDc(b,h,t,A,O){var aa,ua,Ra;if(!h.view.re)return 2;const ub=gi.Jc.vp(qa.a.lDc);A.Ur=42;A.gC=42;const Nb={[Xf.a.yIa]:5796,[Xf.a.xIa]:5797};var Yb=h.view;if(gi.Vg.zCa(gi.Umm,Yb.nb.pg))return gi.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.u7e}),ub.end(),8;if(gi.Vg.zCa(gi.zZe,Yb.nb.pg))return gi.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.iGc}),ub.end(),
8;if(gi.Vg.Oya(qe.ParagraphReader.ZT,Yb.nb.pg))return gi.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.IN}),ub.end(),8;if(gi.Zf.W9b(Yb.nb.pg))return gi.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.tE}),ub.end(),8;if(null===(ua=null===(aa=gi.Gw())||void 0===aa?void 0:aa.instance)||void 0===ua?0:ua.aU(h))return gi.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.externalSelection}),ub.end(),8;if(1===t)return ub.end(),32;O||(O=new ji.DictionaryPropertySet);aa=null;if(2===t){aa=new Te.GraphTransaction(15);aa.Eb(h.view.Zc);gi.CUc=!1;ua=Cq.OutlineElementGeneralizer.xma(Yb.nb.hb,
!1);if(!ua)return aa.dispose(),gi.Jc.Zb(gg.a.oma,{["Reason"]:uf.a.ZJd}),ub.end(),8;1<ua.length&&O.setValue(Gd.a.yJi,null);const bc=O.ia(Gd.a.bJ,-1),Dc=O.ia(Gd.a.lA,-1);null===(Ra=gi.g7c)||void 0===Ra?void 0:Ra.DPk(ua);if(Ra=gi.Ejo(bc,Dc,ua))O.setValue(Gd.a.lA,16),O.setValue(Gd.a.gQa,0);if(!nf.SelectionEditor.jf(Yb.nb.pg)&&!Ra&&0<ua.length&&bc){Yb=new ue.GraphIterator;Ra=Array(ua.length);for(let Pc=0;Pc<ua.length;Pc++)Yb.set(ua.getContext(Pc).node),Ra[Pc]=gi.Ad.Fw(Yb);gi.Djo(Ra,O)&&(Yb=new ji.DictionaryPropertySet,
Yb.setValue(Gd.a.lA,16),Yb.setValue(Gd.a.gQa,0),Km.a.NX&&(Yb.setValue(Jh.a.joa,"clean-list-before-apply-new-list-style"),Yb.setValue(Jh.a.Lga,O.ia(Jh.a.joa,"unknown")+"@"+O.ia(Jh.a.Lga,"undefined"))),Xf.a.Voa(b,h,t,A,Yb,Nb,11),v.AFrameworkApplication.xa.processAction(qa.a.Jqj,2),u.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),gi.CUc=!0)}Yb=new ue.GraphIterator;Yb.set(ua.getContext(0).node);Yb=gi.Ad.Fw(Yb);gi.PYm(bc,Dc,Yb,ua.length)}b=Xf.a.Voa(b,h,t,A,O,Nb,11);
32===b&&O.ia(Gd.a.rsh,!1)&&(b=Xf.a.Voa(qa.a.RN,h,t,A,O,Nb,11));aa&&aa.dispose();ub.end();return b}static Djo(b,h){let t=null;var A=!1;for(let O=b.length-1;0<=O&&(t?(A=b[O],A=-1!==h.ia(Gd.a.bJ,-3)?A?t.listType!==A.listType||t.listStyle!==A.listStyle:!0:A?t.listType!==A.listType:!0):t=b[O],!A);O--);return t&&(b=!1,A||(b=h.ia(Gd.a.lA,42),h=h.ia(Gd.a.bJ,-3),b=b!==t.listType||0<h),A||b)?!0:!1}static PYm(b,h,t,A){0>=A||gi.CUc||(b?t?(t=t.listType,-1===b&&h===t?(v.AFrameworkApplication.xa.processAction(qa.a.jle,
2),u.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<b&&(!h||1===h)&&(v.AFrameworkApplication.xa.processAction(h?qa.a.$Ze:qa.a.r_e,2),u.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(v.AFrameworkApplication.xa.processAction(h?qa.a.$Ze:qa.a.r_e,2),gi.XFo(),u.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(v.AFrameworkApplication.xa.processAction(qa.a.jle,2),u.ULS.sendTraceTag(39715533,
393,50,"List Actions: Clean List Style - None list style")))}static Ejo(b,h,t){if(-1!==b&&b||!t.length)return!1;b=new ue.GraphIterator;let A=null;for(let O=t.length-1;0<=O&&!(b.set(t.getContext(O).node),A=gi.Ad.Fw(b));O--);return A&&h===A.listType?!0:!1}static cla(b,h,t,A,O){var aa;if(h.contextId!==mc.a.outlineElement)return 2;var ua=h.clone().tcg();if(gi.Zf.y2a(ua))return gi.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.tE}),2;const Ra=new ue.GraphIterator;Ra.set(h.node);nf.SelectionEditor.au(Ra);if(!mb.OutlineElementReader.Lh(Ra))return 2;
if(1===t)switch(b){case qa.a.PC:return 32;case qa.a.bL:return 32;case qa.a.Fba:return 32;default:return 2}if(mb.OutlineElementReader.UP(Ra))return gi.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.IN}),2;h=gi.Ad.Fw(Ra);var ub;Km.a.NX&&(ub=Object.freeze(null===h||void 0===h?void 0:h.clone()));let Nb=O;if(!Nb)return 8;b===qa.a.bL||b===qa.a.PC||b===qa.a.Fba?(Nb=gi.Qn.OJc(b,Nb),ua=kq.a.dT(Nb.getValue(Gd.a.lA),Nb.getValue(Gd.a.gQa))):ua=null;gi.D_(b,Nb);gi.hdo(ua,Nb);let Yb=!1;b===qa.a.PC&&Nb&&(Nb.hasProperty(Lc.a.Vt)&&
(ua.levelText=Nb.ia(Lc.a.Vt,"")),Nb.hasProperty(Af.a.font)&&(ua.font=Nb.ia(Af.a.font,"")),Nb.hasProperty(Gd.a.rjf)&&(Yb=Nb.ia(Gd.a.rjf,!1)));gi.Seo(Nb,Ra);ua=gi.Qn.cla(Nb,Ra,ua,Yb);if(!ua.returnValue)return gi.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.dHf}),2;ua=ua.Mva;Km.a.NX&&gi.XKn(O,ub,ua);2===t&&(t=O.ia(Gd.a.lA,-1),ua&&-1!==t&&((ub=O.ia(Lc.a.Gr,"Invalid MultiLevel Type"),b===qa.a.bL&&u.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===O||void 0===
O?void 0:O.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:Hr[null==(null===h||void 0===h?void 0:h.listStyle)?null===ua||void 0===ua?void 0:ua.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:yp[null==(null===h||void 0===h?void 0:h.listType)?null===ua||void 0===ua?void 0:ua.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===ua||void 0===ua?void 0:ua.listType)})),h)?ua.listType&&1!==ua.listType||gi.CUc||(v.AFrameworkApplication.xa.processAction(qa.a.eeg,
2),u.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",t?"Bullet":"Numbering",ub)):16===ua.listType?(v.AFrameworkApplication.xa.processAction(qa.a.CAh,2),u.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",t?"Bullet":"Numbering",ub)):ua.listType&&1!==ua.listType||gi.CUc||(v.AFrameworkApplication.xa.processAction(qa.a.q_e,2),u.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",t?"Bullet":"Numbering",ub))),(b=yd.FocusManager.instance())&&
b.currentScope&&b.currentScope.name===Hh.AppFrame.upa&&b.JC(vf.AFrame.$n));A.Ur=ua.listType;A.gC=ua.listStyle;(null===(aa=v.AFrameworkApplication.K)||void 0===aa?0:aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Gr.a.instance.W4a("List");return 32}static XKn(b,h,t){var A,O,aa,ua,Ra,ub,Nb,Yb;const bc=new Map;bc.set("actionCallSource",b.ia(Jh.a.joa,"unknown"));bc.set("actionCallSourceTrigger",b.ia(Jh.a.Lga,"undefined"));bc.set("fromListType",yp[null!==(A=null===h||
void 0===h?void 0:h.listType)&&void 0!==A?A:16]);bc.set("fromListStyle",Hr[null!==(O=null===h||void 0===h?void 0:h.listStyle)&&void 0!==O?O:0]);bc.set("fromListMarkerType",null!==(Ra=k(null!==(aa=null===h||void 0===h?void 0:h.listStyle)&&void 0!==aa?aa:0,null!==(ua=null===h||void 0===h?void 0:h.listType)&&void 0!==ua?ua:16))&&void 0!==Ra?Ra:"undefined");bc.set("fromLevelText",(null===h||void 0===h?0:h.gna)?h.levelText:"undefined");bc.set("toListType",null!==(ub=yp[null===t||void 0===t?void 0:t.listType])&&
void 0!==ub?ub:"undefined");bc.set("toListStyle",null!==(Nb=Hr[null===t||void 0===t?void 0:t.listStyle])&&void 0!==Nb?Nb:"undefined");bc.set("toListMarkerType",null!==(Yb=k(null===t||void 0===t?void 0:t.listStyle,null===t||void 0===t?void 0:t.listType))&&void 0!==Yb?Yb:"undefined");bc.set("toLevelText",(null===t||void 0===t?0:t.gna)?t.levelText:"undefined");wa.Health.instance.recordKpiUsage(Xk.a.Bjb.nSm,0,Xk.a.dB,bc)}static Seo(b,h){var t=new ue.GraphIterator;t.$c(h);(h=t.Tb(2))&&qe.ParagraphReader.Yb(h)&&
(t=he.a.instance.hb.lb)&&t.Qa&&t.Qa.node===h&&nf.SelectionEditor.HYd(t)&&(gi.ubo(b),gi.sbo(b))}static hdo(b,h){h.hasProperty(Lc.a.Gr)&&b.$ee(h.getValue(Lc.a.Gr));h.hasProperty(Jh.a.IP)&&(b.IP=h.getValue(Jh.a.IP));h.hasProperty(Lc.a.Vt)&&(b.levelText=h.getValue(Lc.a.Vt));b.bJ=h.ia(Gd.a.bJ,-1);let t=null;b.Wna&&(t=gi.NUl(b,h));b.Wna&&t?gi.Neo(b,t):(b.Wna?u.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",
b.bJ,b.Gr,b.Zy):u.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),gi.jao(b))}static jao(b){if(b.Zy)b.jTd&&-1===b.bJ||(b.levelText="%1.",b.propertySet.hasProperty(Af.a.Q3)||b.i9(0,1));else if(1===b.listType)b.jTd&&-1===b.bJ||(b.font=Xk.a.QHc,b.levelText=Xk.a.zGd,b.propertySet.hasProperty(Af.a.Q3)||b.i9(1,6));else return;b.Xv="left"}static Neo(b,h){1===b.Gr?gi.Ddo(b,h):gi.Tbo(b,h)}static Ddo(b,h){(b.qB=h.qB)?b.U4=h.qB.U4:h.qB||u.ULS.sendTraceTag(588022422,
393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",b.bJ,b.Gr,b.Zy)}static Tbo(b,h){b.levelText=h.levelText;b.Zy?b.i9(0,h.listStyle):(b.font=h.font,b.i9(1,1));b.Xv=h.Xv}static NUl(b,h){let t=null;2===b.Gr?t=b.Zy?Sa.a.instance.Ma("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Sa.a.instance.Ma("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.Gr&&(t=Sa.a.instance.Ma("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let A=t.RHb.value;
const O=b.bJ+"";O in A||(A=t.v8,u.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",O,b.Gr,b.Zy));if(!(O in A)){u.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",O,b.Gr,b.Zy);if(h.hasProperty(Af.a.font))return u.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",
O,b.Gr,b.Zy),b=h.ia(Af.a.font,""),new Mp(F.a.fromCharCode(parseInt(O)),b);u.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",O,b.Gr,b.Zy)}return A[O]}static sbo(b){gi.qj.hasProperty(Af.a.fontColor)&&b.setValue(Af.a.fontColor,gi.qj.fontColor())}static ubo(b){gi.qj.hasProperty(Af.a.fontSize)&&b.setValue(Af.a.fontSize,gi.qj.fontSize())}static D_(b,h){b=b===qa.a.PC?0:b===qa.a.bL?1:b===qa.a.Fba?2:-1;h=h.ia(Gd.a.bJ,-1);u.ULS.sendTraceTag(22923024,
324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static XFo(){const b=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");if(b){var h=v.AFrameworkApplication.K.pc("WordDefaultToEditFloodgateDelayInMilliseconds",6E4);b.execute(t=>{window.setTimeout(()=>{t.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else u.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}gi.Umm=Be.ImageReader.XSc;gi.zZe=Be.ImageReader.N1a;gi.If=null;
gi.Rm=null;gi.CUc=!1;Object(m.a)(gi,"ListActor",null,[]);class Fs{constructor(){this.RHb=new Pg.a(()=>this.E9e());this.v8={}}n_h(b){return b}}Object(m.a)(Fs,"AListMarkerGalleryLoader",null,[497]);var tu=c(1373),ov=c(474);class zp extends Fs{constructor(){super();this.$tb=new Z.a(Pa.a.Xh())}n_h(b){zp.JP||this.f$n();b in zp.JP&&(b=zp.JP[b]);return b}E9e(){const b={};b["0"]=new Mp(Box4Intl.Box4Strings.L_ListStyleNone,tu.a.Yoi);b["1"]=new Mp(String.fromCharCode(61623),"Symbol");b["2"]=new Mp(String.fromCharCode(111),
"Courier New");b["3"]=new Mp(String.fromCharCode(61607),"Wingdings");b["4"]=new Mp(String.fromCharCode(9643),"Courier New");b["5"]=new Mp(String.fromCharCode(61611),"Wingdings");b["6"]=new Mp(String.fromCharCode(61614),"Symbol");b["7"]=new Mp(String.fromCharCode(61483),"Symbol");b["8"]=new Mp(String.fromCharCode(61485),"Symbol");b["9"]=new Mp(String.fromCharCode(9830),"Courier New");b["10"]=new Mp(String.fromCharCode(61664),"Symbol");b["11"]=new Mp(String.fromCharCode(61558),"Wingdings");b["12"]=
new Mp(String.fromCharCode(61656),"Wingdings");b["13"]=new Mp(String.fromCharCode(61514),"Wingdings");b["14"]=new Mp(String.fromCharCode(61516),"Wingdings");b["15"]=new Mp(String.fromCharCode(61692),"Wingdings");b["16"]=new Mp(String.fromCharCode(61691),"Wingdings");b["17"]=new Mp(String.fromCharCode(61553),"Wingdings");return b}Wle(b){b&&b.length&&this.E2e(b)}wXf(){if(this.v8){var b=ov.a(this.v8),h=b.length;for(let t=0;t<h;t++){const A=this.v8[b[t]];this.$tb.add(A.levelText+"_"+A.font)}}}E2e(b){this.wXf();
for(const h of b)if(h&&!h.Zy&&h.gna&&h.xPc&&(b=h.levelText+"_"+h.font,!this.$tb.contains(b))){const t=ov.a(this.v8).length+ov.a(this.RHb.value).length+"";this.v8[t]=new Mp(h.levelText,h.font);this.$tb.add(b)}}f$n(){zp.JP={};zp.JP["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;zp.JP["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;zp.JP["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;zp.JP["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;zp.JP["Wingdings 0x00ab"]=
Box4Intl.Box4Strings.L_Star;zp.JP["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;zp.JP["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;zp.JP["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;zp.JP["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;zp.JP["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;zp.JP["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;zp.JP["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;zp.JP["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;
zp.JP["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;zp.JP["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;zp.JP["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;zp.JP["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}zp.JP=null;Object(m.a)(zp,"ListMarkerBulletLoader",Fs,[]);class Lm{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(m.a)(Lm,"InfoAtLevel",null,[]);class Pu{constructor(b){this.qB=b}get font(){return"Calibri"}get listStyle(){return 42}get Xv(){return"left"}get m9d(){return this.qB?
this.gAn():this.iAn()}get VVc(){return this.qB?this.hAn():null}get levelText(){return""}jPl(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}gAn(){let b="";for(let h=0;3>h;h++)b+=this.aOc(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Pu.Jmf(),b)}hAn(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new Lm,{textAtLevel:this.fai(h),styleAtLevel:this.L6l(h)}));return b}iAn(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
Pu.Kmf(),Box4Intl.Box4Strings.L_ListStyleNone)}fai(b){b=this.qB.WVc[b];for(let h=0;9>h;h++)b=F.a.replaceAll(b,"%"+(h+1),this.jPl(this.qB.THb[h]));return b}L6l(b){const h={};h.fontFamily=6===this.qB.THb[b]?this.qB.zDa[b]:this.font;return h}aOc(b){const h=this.fai(b),t=new Sys.StringBuilder;6===this.qB.THb[b]&&t.append(String.format("font-family:{0};",this.qB.zDa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,t.toString(),h)}static Jmf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Kmf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(m.a)(Pu,"ListMarkerMultilevel",null,[496]);var gz=c(788);class hz extends Fs{constructor(){super()}E9e(){const b=new gz.a,h={};h["0"]=new Pu(null);h["1"]=new Pu(b.Y8e());h["2"]=new Pu(b.Q9e("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new Pu(b.LGh([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}Wle(){}}Object(m.a)(hz,"ListMarkerMultilevelLoader",Fs,[]);var Ap=c(147);class Np{constructor(b,h){this.qB=null;this.levelText=b;this.Emd=h}get font(){return"Calibri"}get listStyle(){return this.Emd}get Xv(){switch(this.Emd){case 3:case 5:return"right";default:return"left"}}get m9d(){switch(this.Emd){case 1:return this.hfc("1",
"2","3");case 2:return this.hfc("a","b","c");case 3:return this.hfc("i","ii","iii");case 4:return this.hfc("A","B","C");case 5:return this.hfc("I","II","III");case 0:return this.jAn();default:return this.hfc("1","2","3")}}get VVc(){const b=[],h={};h.fontFamily=Ap.FontUtils.DCa(this.font);switch(this.Emd){case 1:return b.push(Object.assign(new Lm,{textAtLevel:this.kX("1"),styleAtLevel:h})),b.push(Object.assign(new Lm,{textAtLevel:this.kX("2"),styleAtLevel:h})),b.push(Object.assign(new Lm,{textAtLevel:this.kX("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new Lm,{textAtLevel:this.kX("a"),styleAtLevel:h})),b.push(Object.assign(new Lm,{textAtLevel:this.kX("b"),styleAtLevel:h})),b.push(Object.assign(new Lm,{textAtLevel:this.kX("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new Lm,{textAtLevel:this.kX("i"),styleAtLevel:h})),b.push(Object.assign(new Lm,{textAtLevel:this.kX("ii"),styleAtLevel:h})),b.push(Object.assign(new Lm,{textAtLevel:this.kX("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new Lm,
{textAtLevel:this.kX("A"),styleAtLevel:h})),b.push(Object.assign(new Lm,{textAtLevel:this.kX("B"),styleAtLevel:h})),b.push(Object.assign(new Lm,{textAtLevel:this.kX("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new Lm,{textAtLevel:this.kX("I"),styleAtLevel:h})),b.push(Object.assign(new Lm,{textAtLevel:this.kX("II"),styleAtLevel:h})),b.push(Object.assign(new Lm,{textAtLevel:this.kX("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new Lm,{textAtLevel:this.kX("1"),
styleAtLevel:h})),b.push(Object.assign(new Lm,{textAtLevel:this.kX("2"),styleAtLevel:h})),b.push(Object.assign(new Lm,{textAtLevel:this.kX("3"),styleAtLevel:h})),b}}hfc(b,h,t){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Np.Jmf(),this.aOc(b),this.aOc(h),this.aOc(t))}jAn(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Np.Kmf(),Box4Intl.Box4Strings.L_ListStyleNone)}aOc(b){b=this.kX(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}kX(b){return F.a.replaceAll(this.levelText,"%1",b)}static Jmf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Kmf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(m.a)(Np,"ListMarkerNumbering",null,[496]);class oB extends Fs{constructor(){super();this.$tb=new Z.a(Pa.a.Xh())}fKm(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}E9e(){const b=
{};b["0"]=new Np(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new Np("%1.",5);b["2"]=new Np("%1.",4);b["3"]=new Np("%1.",1);b["4"]=new Np("%1.",2);b["5"]=new Np("%1.",3);b["6"]=new Np("%1)",5);b["7"]=new Np("%1)",4);b["8"]=new Np("%1)",1);b["9"]=new Np("%1)",2);b["10"]=new Np("%1)",3);b["11"]=new Np("(%1)",5);b["12"]=new Np("(%1)",4);b["13"]=new Np("(%1)",1);b["14"]=new Np("(%1)",2);b["15"]=new Np("(%1)",3);return b}Wle(b){b&&b.length&&this.E2e(b)}wXf(){if(this.v8){var b=ov.a(this.v8),h=b.length;
for(let t=0;t<h;t++){const A=this.v8[b[t]];this.$tb.add(A.levelText+"_"+A.listStyle)}}}E2e(b){this.wXf();for(const h of b)if(h&&h.Zy&&h.gna&&this.fKm(h.levelText)&&h.listStyle&&(b=tu.a.ekf(h.levelText))){const t=b+"_"+h.listStyle;if(!this.$tb.contains(t)){const A=ov.a(this.v8).length+ov.a(this.RHb.value).length+"";this.v8[A]=new Np(b,h.listStyle)}this.$tb.add(t)}}}Object(m.a)(oB,"ListMarkerNumberingLoader",Fs,[]);class Vr{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){gi.Ub()}dispose(){}yc(b){this.W=
b;this.W.ha("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new zp).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new oB).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new hz).singleInstance()}static main(){P.a.instance.Gc(new Vr)}}Object(m.a)(Vr,"Box4ListMarkerPackage",null,[1,2]);class tw{static get Wg(){return Pf.a.Xz(tw.Hm,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,
"")}}tw.Hm="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(m.a)(tw,"DefineNewBulletDialogHtml",null,[]);class Ir extends Pf.a{constructor(b,h,t,A){super();this.nvc=this.XGe=this.xVb=this.pVb=null;this.Lub=0;this.DDc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.xmi=!0;this.ibl=O=>{if(this.pVb&&O.target!==this.pVb){const aa=this.tg.Hs();aa&&aa.Xj&&(aa.Xj.wy(O.target),this.pVb=O.target)}this.$mn(O.target.id)};this.WRm=O=>{O=O.zf;if(!this.Wyi(O))return!1;this.tg.Hs().Xj.wy(O);O.focus();return!0};this.XRm=O=>{var aa=O.zf;if(!this.Wyi(aa))return!1;
var ua=aa.id;ua=parseInt(ua.substr(ua.lastIndexOf("_")+1))-this.Lub;if(O.Ib.ctrlKey||O.Ib.altKey||O.Ib.keyCode>=rc.a.HQb&&O.Ib.keyCode<=rc.a.IQb)return!1;const Ra=O.Ib.keyCode;if(O.eventName===db.a.fi){O=-1;if(Ra===Sys.UI.Key.enter)return this.tg.Hs().Xj.wy(aa),aa.focus(),this.AOi(aa.id),this.hide(),!0;Ra===Sys.UI.Key.up?O=ua-17:Ra===Sys.UI.Key.down?O=ua+17:Ra===Sys.UI.Key.left?O=v.AFrameworkApplication.isRtl?ua+1:ua-1:Ra===Sys.UI.Key.right&&(O=v.AFrameworkApplication.isRtl?ua-1:ua+1);0<=O&&(aa=this.R7h(Ir.A3b+
"_"+(O+this.Lub)))&&aa.focus()}return!0};this.hbl=O=>{1===O&&this.AOi(this.xVb);this.hide()};this.hu=b;this.tg=h;this.ga=t;this.YR=!1;A&&(b=A.indexOf(","),-1!==b&&(A=A.substring(0,b)));this.fontName=A;this.sg="DefineNewBulletDialog";this.Wg=tw.Wg;this.Ge(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ge(0,CommonUIStrings.l_DialogClose);this.Yh(Box4Intl.Box4Strings.L_SymbolSingle,this.hbl,null);this.Z9=!1;this.AGa();document.getElementById(Ir.wLd).focus()}AGa(){this.tg.Hs().scope.Xq(yd.FocusManager.instance().dW);
this.tg.Hs().scope.Xq(yd.FocusManager.instance().eW);this.tg.Hs().scope.bindAction(yd.FocusManager.instance().dW,qa.a.KGd);this.tg.Hs().scope.bindAction(yd.FocusManager.instance().eW,qa.a.JGd)}E8(){this.OAd(Ir.wLd,"DefineNewBulletFontPlaceholder",qa.a.IGd.toString(),qa.a.bLb.toString(),qa.a.b0c.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.bGk()}$K(){super.$K();document.getElementById(this.kj("WACDialogPanel")).style.width="auto"}OAd(b,h,t,A,O,aa,ua){t=Sk.c(b,t,!0,!0,A,O,F.a.Af(aa),!0,
ua);this.mFd(b,h,t,"Medium")}bGk(){const b=document.getElementById(Ir.A3b);b&&(b.innerHTML=this.B3h(),this.K2i(b))}K2i(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)Hf.a.addHandler(b[h],db.a.focus,this.ibl)}NNo(){var b=document.getElementById(Ir.A3b);if(b){let h=this.fontName;const t=tu.a.izf(this.fontName);t&&61472!==this.Lub||!t&&32!==this.Lub?(b.innerHTML=this.B3h(),this.K2i(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&h&&(h=this.jlh(h),b[0].style.fontFamily=
h)}}$mn(b){this.Ofj(this.xVb,!1);this.xVb=b;this.Ofj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.xVb){let h=parseInt(this.xVb.substr(this.xVb.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.Lub?61440:0,b.innerText=F.a.xI(h,4))}}Ofj(b,h){(b=this.R7h(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}R7h(b){const h=document.getElementById(Ir.A3b);return h?h.querySelector("#"+b):null}hla(){const b=document.getElementById(Ir.A3b);b&&(this.XGe||(this.XGe=this.WRm,
this.Bq.mb(db.a.click,b,this.XGe)),this.nvc||(this.nvc=this.XRm,this.$d.mb(db.a.fi,b,this.nvc),this.$d.mb(db.a.St,b,this.nvc),this.$d.mb(db.a.sh,b,this.nvc)));super.hla()}Wyi(b){return b.classList.contains("DefineNewBulletTableCell")}AOi(b){if(b){b=b.split("_");const h=new ji.DictionaryPropertySet;h.setValue(Gd.a.bJ,parseInt(b[1]));h.setValue(Af.a.font,this.fontName);h.setValue(Gd.a.lA,1);Km.a.NX&&(h.setValue(Jh.a.joa,"command-ui"),h.setValue(Jh.a.Lga,"define-new-bullet-dialog"));this.ga.Rb(qa.a.PC,
2,h)}this.tg.TK(this.uK,!0)}B3h(){const b=new Sys.StringBuilder,h=tu.a.izf(this.fontName);let t=this.fontName;t=this.jlh(t);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',t));h?(this.Lub=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.Lub=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}jlh(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}mFd(b,h,t,A){h=document.getElementById(h);this.hu.fYa(b,t);t=this.hu.ZCb(b,A);h.appendChild(t);this.hu.$oa(b)}dispose(){this.YR||(this.hu.kY(Ir.wLd),this.YR=!0);super.dispose()}}Ir.wLd="DefineNewBulletFontStyleComboBox";Ir.A3b="DefineNewBulletTableContainer";Object(m.a)(Ir,"DefineNewBulletDialog",Pf.a,[]);class Fy{wNc(){return qa.a.SRm}$Nc(){return qa.a.TWf}}Object(m.a)(Fy,"ListMarkerGalleryBulletCommands",
null,[495]);class Gy{wNc(){return qa.a.URm}$Nc(){return qa.a.vxn}}Object(m.a)(Gy,"ListMarkerGalleryMultilevelCommands",null,[495]);class iz{wNc(){return qa.a.VRm}$Nc(){return qa.a.UWf}}Object(m.a)(iz,"ListMarkerGalleryNumberingCommands",null,[495]);class It{constructor(b,h,t,A,O){this.Gza=this.IKa=null;this.VLh=aa=>{if(!this.Gza)return 2;if(this.Gza.tg.Hs().Xj.R2.id.startsWith(Ir.A3b)){let ua=null;aa===qa.a.KGd?ua=this.Gza.JYa:aa===qa.a.JGd&&(ua=document.getElementById(Ir.wLd));if(!ua)return 2;this.Gza.tg.Hs().Xj.wy(ua);
ua.focus()}else if(aa===qa.a.KGd)this.Gza.tg.Hs().Icc();else if(aa===qa.a.JGd)this.Gza.tg.Hs().Gcc();else return 2;return 32};this.MBi=(aa,ua)=>{aa=null;ua.view.re&&(aa=ua.view);return aa&&aa.nb?32:(Jc.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ua.toString()),8)};this.OPm=(aa,ua,Ra)=>{var ub;return 1===Ra?32:2===Ra?((null===(ub=v.AFrameworkApplication.K)||void 0===ub?0:ub.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",
!1))&&Gr.a.instance.W4a("ListDefine"),aa=this.t7b(ua),aa=Wa.FormattingReader.Ar(aa).cache.BE,this.Gza=new Ir(this.Jdk,yd.FocusManager.instance(),v.AFrameworkApplication.xa,aa),32):8};this.b0c=(aa,ua,Ra,ub,Nb)=>{if(1===Ra)return 32;if(2===Ra&&!Nb)return 8;if(this.Gza.xmi){for(aa=0;aa<tu.a.DDc.length;aa++)Ap.FontUtils.Awj(tu.a.DDc[aa]);this.Gza.xmi=!1}Vm.a.GUd(ua);Nb.PopulationXML=Ap.FontUtils.SZh(Vm.a.nge,Vm.a.Gjf,qa.a.IGd);return 32};this.uxn=(aa,ua,Ra,ub,Nb)=>{aa=ua.contextId===mc.a.outlineElement;
if(1===Ra||!aa)return aa?32:8;if(2===Ra&&!Nb)return 8;Nb.MenuItems=this.b4j.RUl();return 32};this.gbl=(aa,ua,Ra,ub,Nb)=>{if(1===Ra)return 32;if(2===Ra){aa=Object(Da.a)(22,Nb);if(!aa||!aa.qd)return 8;this.Gza.fontName=aa.qd.fontName;this.Gza.NNo();return 32}return 8};this.ga=b;this.If=A.resolve("Box4.List.IListReader");this.Z5=h;this.Jdk=t;switch(this.Z5){case 0:b=A.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.IKa=new Fy;break;case 1:b=A.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");
this.IKa=new iz;break;case 2:b=A.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.IKa=new Gy;break;default:b=A.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),this.IKa=new Fy}O=this.If?this.If.GUl(O):null;b.Wle(O);this.b4j=new tu.a(h,b,O,!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.QGb)}Ub(){this.ga.pa(this.IKa.$Nc(),mc.a.view,Jb.App.iTa.gHh(11));this.ga.pa(this.IKa.$Nc(),mc.a.outlineElement,this.uxn);this.ga.Uc(this.IKa.$Nc(),1124);this.Z5||(this.ga.gb(qa.a.eGf,
mc.a.view,this.OPm,1028),this.ga.gb(qa.a.b0c,mc.a.view,this.b0c,1124),this.ga.gb(qa.a.IGd,mc.a.view,this.gbl,1028),this.ga.gb(qa.a.KGd,yc.a.frame,this.VLh,64),this.ga.gb(qa.a.JGd,yc.a.frame,this.VLh,64));this.ga.pa(this.IKa.wNc(),mc.a.view,this.MBi);this.ga.pa(this.IKa.wNc(),mc.a.outlineElement,this.MBi);this.ga.Uc(this.IKa.wNc(),1124)}t7b(b){return this.IMd(b).Qa}IMd(b){let h=null;b=b.view;return b?h=nf.SelectionEditor.Bj(b.nb.hb.J(0),!1,!1):h}}Object(m.a)(It,"ListMarkerGalleryActor",null,[470]);
class au{constructor(){this.Te=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(pc.InteractiveViewManager.instance){var b=pc.InteractiveViewManager.instance;b.editingView&&(this.Te=b.editingView.Zc,this.sPn())}}dispose(){}yc(b){this.W=b}sPn(){(new It(v.AFrameworkApplication.xa,1,this.W.resolve("Common.IStandaloneRootController").zca,this.W,this.Te)).Ub();(new It(v.AFrameworkApplication.xa,0,this.W.resolve("Common.IStandaloneRootController").zca,this.W,this.Te)).Ub();(new It(v.AFrameworkApplication.xa,
2,this.W.resolve("Common.IStandaloneRootController").zca,this.W,this.Te)).Ub()}static main(){P.a.instance.Gc(new au)}}Object(m.a)(au,"Box4ListMarkerGalleryPackage",null,[1,2]);var Nv=c(342),jk=c(407),Vs=c(373),Tq=c(103);const Zw=b=>{b.element.style.top=""};var Qu=c(719);class uw{constructor(b,h,t){this.ZG=!1;this.p9a=0;this.kda=this.z6g=null;this.ol=b;this.Mek=h;this.Xs=t;this.R5=b.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.tw=!!v.AFrameworkApplication.ta&&
v.AFrameworkApplication.ta.Ob.uO)&&!this.Xs.$cf&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";ba.a.jj&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.R5}get visible(){return this.ZG}set_visible(b){if(this.ZG!==b)return(this.ZG=b)?this.p0e():this.hIc(),b}dispose(){this.visible&&this.hIc();vc.a.FZ(this.htmlElement);this.ol=this.R5=null}olj(b,h){const t=b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?
this.htmlElement.appendChild(t):this.htmlElement.insertBefore(t,this.htmlElement.childNodes[h]);b.F8i();this.p9a+=b.htmlElement.clientHeight;var A=this.htmlElement.childNodes,O=b.toh,aa=Object(z.a)(this,this.Udn,"onAfterShowEntry");Tq.WacAirSpace.JU(t,"Shared_BasicClass");var ua=new Vs.a(t);ua.cta(0,1);const Ra=new jk.a(t);Ra.HBa(t.clientTop-30,t.clientTop);O?(Tq.WacAirSpace.ukb(ua,null,null),Tq.WacAirSpace.ukb(Ra,null,aa)):(Tq.WacAirSpace.animate(ua,null,null),Tq.WacAirSpace.animate(Ra,null,aa));
for(h+=1;h<A.length;h++)aa=A[h],Tq.WacAirSpace.JU(aa,"Shared_BasicClass"),ua=new jk.a(aa),ua.HBa(aa.clientTop-t.clientHeight,aa.clientTop),O?Tq.WacAirSpace.ukb(ua,null,null):Tq.WacAirSpace.animate(ua,null,null);b.Doo();this.set_visible(!0)}Aji(b){const h=b.htmlElement;if(vc.a.z$b(h)){this.p9a-=b.htmlElement.clientHeight;var t=h.parentNode.children;b=b.toh;var A=Object(z.a)(this,this.Mdn,"onAfterHideEntry");Tq.WacAirSpace.JU(h,"Shared_BasicClass");var O=new Nv.a(h);O.cta(1,0);b?Tq.WacAirSpace.ukb(O,
null,A):Tq.WacAirSpace.animate(O,null,A);A=!1;for(O=0;O<t.length;O++){if(A){const aa=t[O];Tq.WacAirSpace.JU(aa,"Shared_BasicClass");const ua=new jk.a(aa);ua.HBa(aa.clientTop,-h.clientHeight);b?Tq.WacAirSpace.ukb(ua,null,Zw):Tq.WacAirSpace.animate(ua,null,Zw)}A||t[O]!==h||(A=!0)}}}Udn(b){b.element.style.top="";v.AFrameworkApplication.ta.rYc()}Mdn(b){b.element.parentNode.removeChild(b.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);v.AFrameworkApplication.ta.rYc()}p0e(){""===this.ol.style.top.trim()&&
(this.ol.style.top=this.ol.offsetTop+"px");this.htmlElement.style.left=this.ol.style.left;this.htmlElement.style.top=this.ol.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.z6g=this.ol.style.top;this.p9a=b.height;this.jme();v.AFrameworkApplication.ta.uZ(Object(z.a)(this,this.onResize,"onResize"));Hf.a.addHandler(this.htmlElement,db.a.Ade,Hf.a.g1b);this.kda=Object(z.a)(this,this.BCa,"contextMenuHandler");
v.AFrameworkApplication.ta.sya.mb(this.htmlElement,this.kda,null);if(yd.FocusManager.DJ()){var h=yd.FocusManager.instance();b=h.fe(Qu.a.GMa);b.parent=vf.AFrame.qp;const t=new $f.DOMFocusListing(()=>this.htmlElement);t.In(1);t.In(2);t.In(8);h.nla(()=>this.htmlElement,b,t);h=h.getRegion(Qu.a.GMa);h.LRa();h.lU=!0;h.mZa=!0;const A=v.AFrameworkApplication.ta.Tw;b.gYa(()=>{A.nx(Qu.a.GMa)});A.GS(Qu.a.GMa);(t.Dfa||v.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&A.nI(Qu.a.GMa)}}hIc(){this.Tkj()&&
(this.ol.style.top=this.z6g);this.htmlElement.style.visibility="hidden";v.AFrameworkApplication.ta&&(yd.FocusManager.DJ()&&yd.FocusManager.instance().X4a(Qu.a.GMa),this.kda&&(v.AFrameworkApplication.ta.sya.sc(this.htmlElement,this.kda),this.kda=null));Hf.a.removeHandler(this.htmlElement,db.a.Ade,Hf.a.g1b)}jme(){if(this.Tkj()&&this.visible){var b=this.ol,h=this.p9a+this.Mek;const t=vc.a.zM(b.style.top);Tq.WacAirSpace.JU(b,"Shared_BasicClass");b=new jk.a(b);b.HBa(t,h);Tq.WacAirSpace.animate(b,null,
null)}}Tkj(){return!this.tw&&!this.Xs.$cf}onResize(){const b=this.Xs.entries.length,h=Sys.UI.DomElement.getBounds(this.htmlElement).height;let t;for(let A=0;A<b;++A)t=this.Xs.entries[A],t.htmlElement&&t.F8i();this.p9a=Sys.UI.DomElement.getBounds(this.htmlElement).height;h!==this.p9a&&this.jme()}BCa(){return!0}}Object(m.a)(uw,"BusinessBarDom",null,[1234,9]);var Gq;(function(b){b[b.none=0]="none";b[b.corruptPage=1]="corruptPage";b[b.currentPageStatus=2]="currentPageStatus";b[b.documentMarkedAsFinal=
3]="documentMarkedAsFinal";b[b.documentSigned=4]="documentSigned";b[b.fileAccess=5]="fileAccess";b[b.kickoutWithDataLoss=6]="kickoutWithDataLoss";b[b.lostSession=7]="lostSession";b[b.malformedHyperlinkUris=8]="malformedHyperlinkUris";b[b.odt=9]="odt";b[b.readonlyRecommended=10]="readonlyRecommended";b[b.saveReplaySuccess=11]="saveReplaySuccess";b[b.saveReplayFailed=12]="saveReplayFailed";b[b.unsupportedObjects=13]="unsupportedObjects";b[b.word11Compat=14]="word11Compat";b[b.unsupportedBrowser=15]=
"unsupportedBrowser";b[b.applicationNotification=16]="applicationNotification";b[b.skypeDocChatFailed=17]="skypeDocChatFailed";b[b.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";b[b.sessionExpired=19]="sessionExpired";b[b.irmPolicyDescription=20]="irmPolicyDescription";b[b.policyWarningMessage=21]="policyWarningMessage";b[b.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";b[b.gdprPrivacyNotice=23]="gdprPrivacyNotice";b[b.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";
b[b.graphMergePrompt=25]="graphMergePrompt";b[b.readOnlyDocument=26]="readOnlyDocument";b[b.dictationSilence=27]="dictationSilence";b[b.autoSensitivityLabel=28]="autoSensitivityLabel";b[b.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";b[b.dictationDebugInfo=30]="dictationDebugInfo";b[b.oneNoteCovid19Message=31]="oneNoteCovid19Message";b[b.citationStylePrompt=32]="citationStylePrompt";b[b.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";b[b.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";
b[b.oneNotePagePrintReady=35]="oneNotePagePrintReady";b[b.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";b[b.mandatoryLabel=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.minorVersionLimit=39]="minorVersionLimit";b[b.testEntry1=40]="testEntry1";b[b.testEntry2=41]="testEntry2";b[b.testEntry3=42]="testEntry3";b[b.testEntry4=43]="testEntry4";b[b.testEntry5=44]="testEntry5";b[b.testEntry6=45]="testEntry6";b[b.testEntry7=46]="testEntry7"})(Gq||(Gq={}));Object(m.b)("BusinessBarId",
Gq);class ms{constructor(b,h=0,t=null,A=null){this.lZg=this.aPg=!1;this.UWb=null;this.IA=[];this.iUa=A||new uw(b,h,this);this.Drm(t)}Drm(b){if(b){this.UWb={};b=b.ranking;for(let h=0;h<b.length;h++)this.UWb[Gq[b[h]]]=h}}dispose(){this.iUa.dispose();yb.a.M5f(this.IA);this.IA=null}get htmlElement(){return this.iUa.htmlElement}get visible(){return this.iUa.visible}get $cf(){return this.aPg}set $cf(b){this.aPg=b}get aDf(){return this.lZg}set aDf(b){this.lZg=b}get entries(){return this.IA}set entries(b){this.IA=
b}KX(b){for(let h=0;h<this.IA.length;h++)if(this.IA[h].id===b)return!0;return!1}Kz(b,h=!1,t=null,A=null,O=null){b.FN=this;let aa=this.ESl(b.id);h&&!this.UWb&&(aa=0);aa<ms.zIb&&(this.iUa.olj(b,aa),this.IA.length>=ms.zIb&&this.iUa.Aji(this.IA[ms.zIb-1]),this.iUa.jme());Array.insert(this.IA,aa,b);u.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Gq[b.id],void 0===b.nZa||null===b.nZa?"":b.nZa);b.errorCode&&v.AFrameworkApplication.jR(b.errorCode,t,A,O)}removeEntry(b){const h=
Array.indexOf(this.IA,b);-1!==h&&h<ms.zIb&&(this.IA.length>ms.zIb&&this.iUa.olj(this.IA[ms.zIb],ms.zIb),this.iUa.Aji(b),this.iUa.jme());Array.remove(this.IA,b);b.FN=null;b.dispose()}ESl(b){if(!this.UWb||0===b)return this.IA.length;b=this.UWb[Gq[b]];if(void 0===b||null===b)return this.IA.length;for(let h=0;h<this.IA.length;h++)if(b<this.UWb[Gq[this.IA[h].id]])return h;return this.IA.length}}ms.zIb=2;Object(m.a)(ms,"BusinessBar",null,[1217,9,1218]);class vw{create(b,h,t){return new Sb.a(b,h,t)}}Object(m.a)(vw,
"Factory",null,[1233]);class Qx{static pXk(b,h){b.register(ms,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").singleInstance().Qd(()=>new ms(h.value,0,b.Ma("CommonUI.IBusinessBarRankProvider")));b.register(vw,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").singleInstance()}}Object(m.a)(Qx,"CommonUIComponentConfiguration",null,[]);var Jt=c(997);class pv extends Jt.a{constructor(){super()}static get instance(){return pv._instance||pv.Cxf()}static Cxf(){pv._instance=
new pv;return pv._instance}}pv._instance=null;Object(m.a)(pv,"ReactRootManager",Jt.a,[401,402]);class ar extends Eh.a{constructor(){super()}get ControlType(){return 3}}Object(m.a)(ar,"CompoundButtonProps",Eh.a,[]);class jz{constructor(b,h,t,A,O,aa,ua){this.WV=h;this.Jyc=b;this.EXg=h.fBm;this.TUb=h.STc;this.BDe=aa;this.vjd=A;this.wjd=O;this.qjd=t;this.RJ=ua;this.B$a=new Kh.a;this.B$a.Z(1,"SpellingIssue_16x16x32");this.B$a.Z(2,"GrammarIssue_16x16x32");this.B$a.Z(3,"WritingIssue_16x16x32");this.B$a.Z(4,
null);this.B$a.Z(0,null)}create(b,h,t){h=Object(Da.a)(eq.a,h);if(!h)return u.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const A=new Sys.StringBuilder;b=this.q7h(b);this.nHc(A,h,t,b);this.y9e(A,h);this.E6k(A,h,b);return A.toString()}ueb(b,h,t){const A=Object(Da.a)(eq.a,h);if(!A)return u.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.q7h(b);this.i$e(h,A,t,b);this.z9e(h,A);this.F6k(h,A,b);for(t=0;t<h.length;t++)h[t].Id=`${xp.HQh}_${t}`;
return h}nHc(b,h,t,A=null){h.errorType?1===h.errorType&&(this.M4b(h)||b.append(this.A2e(h,t,A))):b.append(this.Jyc.build())}i$e(b,h,t,A=null){h.errorType?1===h.errorType&&(this.M4b(h)||b.push(this.ZFk(h,t,A))):b.push(this.Jyc.avh())}y9e(b,h){const t=new Sys.StringBuilder;this.imj(h)?t.append(Sk.a("btnIgnoreAllSpellingError",(2===h.errorType?qa.a.hIa:qa.a.lna).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.M4b(h)||t.append(Sk.a("btnIgrnoreSpellingError",this.n6h(h.errorType).toString(),
Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.nmj(h)&&(this.WV.Xri&&t.append(Sk.a("btnDoNotCheckForThisIssue",qa.a.hBb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),t.append(Sk.a("btnGrammarOptions",qa.a.slb.toString(),F.a.Af(Box4Intl.Box4Strings.l_GrammarOptions),null)));t.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(t.toString()),b.append("</Controls></MenuSection>"))}z9e(b,h){const t=Object.assign(new eh.a,
{ControlList:[]});if(this.imj(h)){var A=Ms.jB()?Object.assign(new Eh.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:qa.a.lna,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new Eh.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});t.ControlList.push(A)}else this.M4b(h)||(A=Object.assign(new Eh.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.n6h(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),t.ControlList.push(A));
this.nmj(h)&&(this.WV.Xri&&(h=Object.assign(new Eh.a,{ExternalId:"DoNotCheckForThisIssue"}),t.ControlList.push(h)),h=Object.assign(new Eh.a,{ExternalId:"GrammerSettingsContext"}),t.ControlList.push(h));b.push(t)}q7h(b){if(!this.RJ)return null;b=this.RJ.language(this.RJ.Ar(b.Qa));return Sf.a.lg(b)?Sf.a.lg(b).name:null}n6h(b){return 2===b?qa.a.hIa:this.WV.QDm?qa.a.Gmm:qa.a.Eva}E6k(b,h,t=null){if(this.J$f(h)){var A=F.a.Af(h.ft.CategoryTitle);A=Sk.m(xp.nfc,ab.a.$ka,this.B$a.J(h.proofingType),""!==A?A:
Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[b.toString()],this.vjd,this.wjd);A=Sk.d("cgProofingOuter",[A]);b.clear();b.append(Sk.g("msProofingOuter",A,"Menu16",void 0,void 0,t,"ariaLabelledById"));u.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}F6k(b,h,t=null){if(this.J$f(h)){var A=F.a.Af(h.ft.CategoryTitle);t=Object.assign(new Jj.a,{ExternalId:String.format("{0}_{1}",xp.nfc,h.proofingType),Command:ab.a.$ka.toString(),
Image16by16Class:this.B$a.J(h.proofingType),LabelText:""!==A?A:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:t,Menu:Object.assign(new gj.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.qFl(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});t.Menu.MenuSectionList.push(...b);Array.clear(b);A=Object.assign(new eh.a,{ControlList:[]});A.ControlList.push(t);b.push(A);u.ULS.sendTraceTag(39188234,375,
50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}A2e(b,h,t=null){const A=this.NNl(b);var O=[];let aa=!1;var ua=b.ft.Suggestions;if(ua)if(ua=ua.slice(0,Math.min(3,ua.length)),this.EXg&&(aa=!gl.a.any(ua,Ra=>!Ra||!Ra.Description)),1!==ua.length||ua[0].Action){let Ra=0,ub=null;aa&&(ub="font-weight: bold;");for(const Nb of ua){if(!Nb)continue;ua=null;let Yb="";const bc=F.a.Af(Nb.Text);aa&&(ua=this.$0h(Nb.Description),Yb=this.Z0h(Nb.Description));O.push(Sk.a("btnCorrectWord"+
Ra,h[Ra].toString(),bc,null,null,null,null,null,ub,null,ua,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,A,bc),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.vFh(b.token)),"ariaDescribedById",Yb));Ra++}}else h=F.a.Af(ua[0].Text),O.push(Sk.a("btnCorrectWord0",qa.a.hIa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,
A,h)));h="Menu16";0<O.length?aa&&(h="Menu16DescriptionEnabled"):O=[Sk.a("btnNoSuggestions",qa.a.hIa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return Sk.g("msUnknownWord",Sk.d(null,O),h,A,this.WVl(b),t,"ariaLabelledById")}ZFk(b,h,t=null){var A=1!==b.proofingType&&0!==b.proofingType?b.ft.ExplanationTitle:"";A=Object.assign(new eh.a,{Title:A,Lang:t,ControlList:[]});let O=!1;var aa=b.ft.Suggestions;if(aa)if(aa=aa.slice(0,Math.min(3,aa.length)),this.EXg&&(O=!gl.a.any(aa,ua=>!ua||!ua.Description)),
1!==aa.length||aa[0].Action){let ua=0;for(const Ra of aa){if(!Ra)continue;aa=null;let ub="";O&&(aa=this.$0h(Ra.Description),ub=this.Z0h(Ra.Description));if(ua>=h.length)break;aa?(aa=Object.assign(new ar,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",ua,b.proofingType),Command:h[ua].toString(),LabelText:Ra.Text,Description:aa,Lang:t,AriaDescription:ub}),A.ControlList.push(aa)):(aa=Object.assign(new Eh.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",ua,b.proofingType),
Command:h[ua].toString(),LabelText:Ra.Text,Lang:t,RoleInMenu:"menuitem"}),A.ControlList.push(aa));ua++}}else b=aa[0],b=Object.assign(new Eh.a,{ExternalId:"NoSuggestion",Command:qa.a.hIa.toString(),LabelText:b.Text}),A.ControlList.push(b);0>=A.ControlList.length&&A.ControlList.push(Object.assign(new Eh.a,{ExternalId:"btnNoSuggestions",Command:qa.a.hIa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return A}NNl(b){return F.a.Af(0!==b.proofingType?b.ft.ExplanationTitle:"")}WVl(b){return this.J$f(b)?
null:this.B$a.J(b.proofingType)}J$f(b){return this.TUb&&2!==b.errorType&&(1!==b.errorType||!this.M4b(b))}imj(b){return this.BDe&&!!b.errorType&&1===b.proofingType&&!this.M4b(b)}qFl(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.vFh(b.token)):""}nmj(b){return this.WV.pYd&&this.TUb&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}M4b(b){return!!b.errorType&&!!this.qjd&&this.qjd.contains(b.token,b.lcid)}$0h(b){return""===
b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):b}Z0h(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}vFh(b){let h="";if(b){let t;for(t=0;t<b.length-1;t++)h=h+b.charAt(t)+",";h+=b.charAt(t)}return h}}Object(m.a)(jz,"EditorServiceProofingContextMenuCreator",null,[]);class Bp{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(m.a)(Bp,
"BusinessBarRankProvider",null,[468]);class kz{constructor(){this.W=null}get name(){return"Wonca.UI"}yc(b){this.W=b;b.ha("CommonUI.IBusinessBarRankProvider",()=>new Bp).singleInstance();Qx.pXk(b,new Pg.a(()=>Jb.App.ya.nfa));b.ha("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new jz(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.Proofing.IIgnoreAllKeywords"),v.AFrameworkApplication.Yaa,v.AFrameworkApplication.Ks,
v.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).singleInstance();b.ha("CommandUI.ReactRootManager",()=>pv.instance).as("Common.IReactRootManager").singleInstance()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){P.a.instance.Gc(new kz)}}Object(m.a)(kz,"WoncaUIPackage",null,[1,2]);class pB{constructor(b){this.$M=this.Nwc=null;this.hn=b}get key(){return"BOOKMARK"}get zw(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get T2(){return this.$M}reset(b){this.$M=
b.node}YHa(b){let h=null;v.AFrameworkApplication.ye("bookmarks-core-ex;bookmarks-core-ex-cf");if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.Nwc&&this.hn.vri(b,this.T2,this.Nwc))return h=Object.assign(new sm.a,{rG:this.key,contentObject:this.Nwc}),{returnValue:!0,xF:h};this.Nwc=null;if(!this.T2.hasBookmark)return{returnValue:!1,xF:h};const t=new ue.GraphIterator;t.set(this.T2.Ei());this.hn.NXc(t);if(this.hn.pym(t)){let A=
t.Sd();for(;A;){if(this.hn.vri(b,this.T2,A))return this.Nwc=A,h=Object.assign(new sm.a,{rG:this.key,contentObject:A,description:this.zgb()}),{returnValue:!0,xF:h};A=t.Wj()}}}return{returnValue:!1,xF:h}}zgb(){return null}}Object(m.a)(pB,"BookmarkDetailsProvider",null,[376,59]);class $w{constructor(b,h,t,A,O=null){this.bXg=this.xh=!1;this.Mnd=this.tpd=null;this.KMi=(aa,ua)=>{aa=ua.node;1074135152!==aa.Nc?u.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",aa.Nc):(u.ULS.sendTraceTag(24155019,
324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.mSh(!0))};this.UB=t;this.pi=A;this.Ix=h;this.oJg=b;this.IR=O}get my(){return this.Ix.value}initialize(){this.i1f();this.xh=!0}mSh(b=!1){if(!this.xh)return u.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.bXg)return!0;let h=!1;this.pi.he(()=>{this.tpd={};this.Mnd={};if(this.my){const t=new ue.GraphIterator;t.set(this.my);if(this.z9m(t)){if(t.Tb(1)){do this.Dmk(t.currentNode);while(t.wf(1))
}h=this.bXg=!0}}},"BGM:EBGL");return h}Xua(b){return this.mSh()?b in this.Mnd?this.Mnd[b]:null:null}dispose(){this.xh?this.eKo():u.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}z9m(b){if(this.UB.TQ(b))return(b=b.Tb(30))||u.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;u.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}i1f(){u.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.oJg.Rmh(this.KMi)}eKo(){u.ULS.sendTraceTag(24691924,
324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.oJg.U5i(this.KMi)}Dmk(b){var h,t,A,O;b?(this.Skh(null!==(t=this.IR.ndb.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==t?t:W.a.nil,b),this.Skh(null!==(O=this.IR.x0b.get(null===(A=b.id)||void 0===A?void 0:A.toString()))&&void 0!==O?O:W.a.nil,b),(h=b.properties.ia(Lc.a.$s,null))&&(this.Mnd[h]=b)):u.ULS.sendTraceTag(24155022,324,50,"Node is null")}Skh(b,h){b===W.a.nil?u.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=
b.toString(),b in this.tpd||(this.tpd[b]=new Mb.a),b=this.tpd[b],b.contains(h)||b.add(h))}}Object(m.a)($w,"BookmarkGraphManager",null,[469]);var qB=c(807),jC=c(1116);class lz{create(){return new jC.a}}Object(m.a)(lz,"BookmarkContainerNodeFactory",null,[378]);class aA{constructor(b,h,t,A=null){this.Pkn=(O,aa)=>{this.hn.DPi(aa)};this.pSf=(O,aa)=>{var ua=this.OVh(aa.clone);O=aa.original.Mc;const Ra=new xb.a;for(const ub of ua)ua=ub.an.toString(),Ra.ob(ua)||(Ra.add(ua,!0),(ua=O.Db(ub.an))&&!ua.anchor&&
(ua=this.hn.HCb(ub.an)),ua?ua.anchor?this.o0k(ua,aa.clone):u.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",ua.id,ua.ia(Lc.a.Syb,-1))):u.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.qSf=(O,aa)=>{O=aa.clone;aa=this.OVh(O);this.hn.y2c(O,aa)};this.Iz=h;this.hn=t;this.JQj=A||new lz}init(){qB.a.nNn(Object(z.a)(this.hn,this.hn.CPf,"onAfterFullBookmarkRangeDeleted"));this.Iz.pYe(this.Pkn);mv.a.oYe(this.pSf);mv.a.uyd(this.qSf)}OVh(b){const h=
new Mb.a;for(let t=0;t<b.qa.length;t++){const A=b.qa.J(t);if(A.Ah)for(let O=0;O<A.Ah.length;O++)h.add(A.Ah.J(O))}return h}o0k(b,h){var t=h.Ei().ud;t=Bt.a(b,t,!0);h=ue.GraphIterator.$a(h);this.lnl(h);h.Tb(30);h.q2(t,1,b.id);h.Fi(t)}lnl(b){if(b.Ab(25)&&b.fd(25)&&!b.Xr(30)){const h=this.JQj.create(1074135152);b.Qf(h,30)}}}Object(m.a)(aA,"BookmarksEventHandler",null,[]);var hi=c(213),am=c(267),br=c(488),ng=c(1172),rB=c(145),it=c(1052);class Ov{create(){return new it.a}}Object(m.a)(Ov,"BookmarkNodeFactory",
null,[378]);class ax{constructor(b,h){this.baa=b;this.UQj=h}get sLb(){return this.UQj}}Object(m.a)(ax,"FoundBookmarkRangeObject",null,[492]);class sB{constructor(b,h,t,A,O,aa,ua,Ra=null,ub,Nb=null){this.K1="_";this.rJg=40;this.Fdk=" ";this.Ix=b;this.UB=h;this.Jd=t;this.HGe=A;this.Ic=O;this.eb=aa;this.ib=ua;this.TQj=Ra||new Ov;this.IR=Nb}SNc(b,h){return b?this.IR.ndb.get(null===h||void 0===h?void 0:h.toString()):this.IR.x0b.get(null===h||void 0===h?void 0:h.toString())}get my(){return this.Ix.value}get zIa(){return this.HGe.value}AWe(b,
h){if(!h||!h.Qa||!h.Rc)return u.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const t=h.Qa.node,A=h.Rc.node,O=hi.a.Agb(h,!0);h=hi.a.Agb(h,!1);return this.rCc(b,O,h,t,A)}rCc(b,h,t,A,O,aa=!1){u.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",aa));const ua=this.Xua(b);if(ua)if(aa)this.N3i(ua);else return u.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!A||!O)return u.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),
!1;aa=this.Ic.Qc(15);aa.Eb(this.zIa);b=this.Xjk(b);if(!b)return!1;this.Tjk(A,h,b,O,t);aa.dispose();return!0}Xua(b){u.ULS.shipAssertTag(34936482,3029,!!b);return this.RVh(h=>b===h.properties.ia(Lc.a.$s,null))}HCb(b){return b&&b!==W.a.nil?this.RVh(h=>b.equals(h.id)):(u.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}CPf(b){const h=this.HCb(b);h?(u.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.M3i(h),this.x2c(h)):
u.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}Yua(b,h){var t;const A=null!==(t=this.SNc(h,b.id))&&void 0!==t?t:W.a.nil;if(A===W.a.nil)return u.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new ax(null,2);t=this.my.ud.Db(A);return t?t.isConnected?this.getBookmarkRange(t,b,h):(u.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new ax(null,3)):(u.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),
new ax(null,2))}DPi(b){const h=this.awl(b);h[Symbol.iterator]().next().done||this.w9m(b,h)}y2c(b,h){const t=new Mb.a;let A=0,O=!1;for(const aa of h)aa&&aa.Kb.Ah?(A++,aa.Kb.Ah.remove(aa),0<=aa.ze&&aa.ze<b.Ae.length&&(aa.Kb.cp||(O=!0),t.add(aa.ze))):u.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.npa(t);u.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",A,t.count));O&&!b.Ae.length&&b.Ae.append(am.CharacterPropertiesEditor.sM,
1024)}jMd(b=!1){u.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const h=new Mb.a,t=ue.GraphIterator.$a(this.my);if(null!==this.NXc(t)){var A=t.pq();u.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",A);if(0<A)for(A=t.Sd();null!==A;){const O=A.ia(Lc.a.$s,"");F.a.mf(O)||(b?h.add(A):O.startsWith(this.K1)||h.add(A));A=t.Wj()}}!b&&0<h.count&&u.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}Hhm(){return this.my?this.xYk():!1}xYk(){u.ULS.sendTraceTag(524321506,
3029,50,"Finding bookmarks with includeHidden: {0}",!1);const b=ue.GraphIterator.$a(this.my);if(null!==this.NXc(b)&&0<b.pq())for(var h=b.Sd();null!==h;){h=h.ia(Lc.a.$s,"");if(!F.a.mf(h)&&!h.startsWith(this.K1))return!0;h=b.Wj()}return!1}f$h(b){var h=this.Xua(b);const t=new Mb.a;if(h){b=this.SNc(!0,h.id);h=this.SNc(!1,h.id);var A=this.my.ud.Db(b);A&&t.add(A);if(b.equals(h))return t;b=A;do(b=A=this.eb.ug(b,!1,!1,!0))&&t.add(A);while(A&&!A.id.equals(h))}else u.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",
b);return t}L3i(b){if(null===b)return u.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.HCb(b);return this.N3i(b)}jGl(b){let h="";const t=b.id;b=b.characterData.split(this.Fdk);for(let A=0;3>A&&A<b.length;A++)h+=this.K1+b[A];h.length>this.rJg&&(h=h.substring(0,this.rJg));return this.tGj(h,t)}tGj(b,h){const t=this.jMd(!0),A=[];let O;for(let ua=0;ua<t.count;ua++){var aa=t.J(ua);O=aa.ia(Lc.a.$s,"");aa=this.SNc(!0,aa.id);O.startsWith(b)&&!h.equals(aa)&&A.push(O)}return 0<
A.length?(A.sort((ua,Ra)=>ua.localeCompare(Ra,void 0,{numeric:!0})),(h=A[A.length-1].substring(b.length+1))?b+this.K1+(parseInt(h)+1):b+this.K1+1):b}fgi(b){F.a.mf(b)?u.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.Xua(b),null===b?u.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.Yua(b,!0))?(b=wf.SelectionFactory.te(b.baa.paragraph,b.baa.Kb.cp))&&this.ib.setSelection(b):u.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}N3i(b){if(!b)return u.ULS.sendTraceTag(559228888,
3029,15,"Could not find bookmark node with given id"),!1;u.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const h=this.Ic.Qc(15);h.Eb(this.zIa);this.M3i(b);this.x2c(b);h.dispose();return!0}ANd(b,h){if(!b||0>h)return u.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;let t=null;const A=new Mb.a,O=new Mb.a;var aa=b.qa;for(var ua=0;ua<aa.length;ua++){var Ra=aa.J(ua);if(Ra.cp>h||Ra.cp===h&&0<A.count)break;if(Ra.Ah){var ub=
Ra.Ah;if(2===ub.length&&ub.J(0).an.equals(ub.J(1).an)&&Ra.cp===h){A.add(ub.J(0).an.toString());break}for(let Nb=0,Yb=ub.length;Nb<Yb;Nb++){Ra=ub.J(Nb);const bc=b.Mc.Db(Ra.an).ia(Lc.a.$s,"");F.a.mf(bc)||bc.startsWith(this.K1)||(Ra.Oc?A.add(Ra.an.toString()):A.contains(Ra.an.toString())?A.remove(Ra.an.toString()):O.add(Ra.an.toString()))}}}0<A.count&&(t=b.Mc.Db(W.a.Gf(A.J(A.count-1))));if(!t)for(h=qe.ParagraphReader.ug(b,!0);h&&!t;){for(aa=0;aa<h.qa.length;aa++)if(ua=h.qa.J(aa),ua.Ah){ua=ua.Ah;for(let Nb=
0,Yb=ua.length;Nb<Yb;Nb++)ub=ua.J(Nb),Ra=b.Mc.Db(ub.an).ia(Lc.a.$s,""),F.a.mf(Ra)||Ra.startsWith(this.K1)||(ub.Oc?O.contains(ub.an.toString())?O.remove(ub.an.toString()):A.add(ub.an.toString()):A.contains(ub.an.toString())?A.remove(ub.an.toString()):O.add(ub.an.toString()))}0<A.count?t=h.Mc.Db(W.a.Gf(A.J(A.count-1))):h=qe.ParagraphReader.ug(h,!0)}return t}NLo(b,h){if(null===b)return u.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.qym(h)||this.zjl(h))return!1;const t=this.Ic.Qc(15);
t.Eb(this.zIa);this.MLo(b,h);t.dispose();return!0}RVh(b){if(!this.my)return u.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new ue.GraphIterator;h.set(this.my);if(!this.NXc(h))return u.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Tb(1))return null;do{const t=h.currentNode;if(b(t))return t}while(h.wf(1));return null}getBookmarkRange(b,h,t){for(let A=0;A<b.qa.length;A++){const O=b.qa.J(A);if(O.Ah)for(let aa=0;aa<O.Ah.length;aa++){const ua=
O.Ah.J(aa);if(ua.an.equals(h.id)&&t===ua.Oc)return new ax(ua,0)}}u.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ia(Lc.a.Syb,-1),t,h.id,b.qa.length,this.eM(b));return new ax(null,1)}NXc(b){if(this.UB.TQ(b))return b=b.Tb(30),u.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;u.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}awl(b){const h=new xb.a;
for(let t=0;t<b.qa.length;t++){const A=b.qa.J(t);if(A.Ah)for(let O=0;O<A.Ah.length;O++){const aa=A.Ah.J(O),ua=aa.an.toString();h.ob(ua)?(u.ULS.shipAssertTag(36218379,3029,aa.Oc!==h.J(ua).Oc),h.remove(ua)):h.add(ua,aa)}}return h.values}w9m(b,h){this.y2c(b,h);this.c9m(b,h)}c9m(b,h){let t=qe.ParagraphReader.ug(b,!1,!0);b=qe.ParagraphReader.ug(b,!0,!0);t||b?(t||this.uth(h,!0)&&u.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||
this.uth(h,!1)&&u.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),t=t||b,b=b||t,this.FIi(t,h,0,!0),this.FIi(b,h,b.qa.last.cp,!1)):u.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}uth(b,h){for(const t of b)if(h===t.Oc)return!0;return!1}FIi(b,h,t,A){const O=new Mb.a;t=this.Slf(b,t);for(const aa of h)aa.Oc===A&&(t?(h=this.Zjk(b,A,t,aa.an))&&O.add(h):u.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",A));
O.count&&(b.Pm(),this.Vjg(b,O),u.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",O.count,A)))}Zjk(b,h,t,A){const O=this.HCb(A);return O?this.BWe(b,h,t,O):(u.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",A)),null)}BWe(b,h,t,A){var O;if(!A)return u.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!t)return u.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;t.Ah||(t.Ah=new br.a(t));const aa=new ng.a(t,null,A.id,h);t.Ah.add(aa);(h?this.IR.ndb:this.IR.x0b).set(null===(O=A.id)||void 0===O?void 0:O.toString(),b.id);return aa}Vjg(b,h){if(h){u.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((t,A)=>t.ze-A.ze);for(let t=0;t<h.count;t++){const A=h.J(t);A.ze?b.Ae.BX(A.ze-1,1024):b.Ae.sna(A.ze,1024);b.Ae.$p.Z(A.ze,am.CharacterPropertiesEditor.sM);b.Ae.Ps.Z(A.ze,am.CharacterPropertiesEditor.VQ)}}else u.ULS.shipAssertTag(36218383,
3029,!1,"Null BookmarksToUpdate.")}Slf(b,h){if(!b||!b.qa||!b.qa.last)return null;u.ULS.shipAssertTag(36471766,3029,h<=b.qa.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.qa.last.cp===h){var t=b.qa.length-1;if(!b.qa.J(t).formatting)for(var A=t-1;0<=A;A--){var O=b.qa.J(A);if(O.formatting){this.Jd.tY(b,t,h,O.formatting);break}}return b.qa.last}t=null;for(A=0;A<b.qa.length;A++){O=b.qa.J(A);if(O.cp>=h){if(O.cp>h||!O.formatting)this.Jd.tY(b,A,h,t),O=b.qa.J(A);O.Ah||(O.Ah=new br.a(O));
u.ULS.shipAssertTag(36471768,3029,O!==b.qa.last);return O}O.formatting&&(t=O.formatting)}return null}Xjk(b){const h=new ue.GraphIterator;h.set(this.my);if(!this.NXc(h))return u.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.R1k(b);h.q2(b,1,null);h.Fi(b);return b}R1k(b){const h=this.TQj.create(1074135153);h.setValue(Lc.a.$s,b);h.setValue(Lc.a.Syb,Nf.a.aF());return h}x2c(b){if(b&&b.anchor){u.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",
b.ia(Lc.a.Syb,-1),b.id);var h=new ue.GraphIterator;h.set(b);h.Ab(64);h.Dg()}}eM(b){const h=[];let t=0;for(;b.anchor.Wp&&7!==b.type;)h[t]=rB.a[b.type],b=b.anchor.Wp.lr.node,t++;h[t]=rB.a[b.type];return h.join(" ")}MLo(b,h){b.setValue(Lc.a.$s,h)}M3i(b){const h=this.Yua(b,!0).baa;b=this.Yua(b,!1).baa;if(h&&b&&h.paragraph===b.paragraph){let t;this.y2c(h.paragraph,(t=new Mb.a,t.add(h),t.add(b),t))}else{if(h){let t;this.y2c(h.paragraph,(t=new Mb.a,t.add(h),t))}if(b){let t;this.y2c(b.paragraph,(t=new Mb.a,
t.add(b),t))}}}Tjk(b,h,t,A,O){if(h=this.BWe(b,!0,this.Slf(b,h),t)){b.Pm();var aa;this.Vjg(b,(aa=new Mb.a,aa.add(h),aa));(t=this.BWe(A,!1,this.Slf(A,O),t))?(A.Pm(),this.Vjg(b,(aa=new Mb.a,aa.add(t),aa))):u.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else u.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}g$h(b,h){var t;if(!b)return null;h=null!==(t=this.SNc(h,
b.id))&&void 0!==t?t:W.a.nil;return b.Mc.Db(h)?b.Mc.Db(h):null}pym(b){return!!b&&64===b.Xe}ZUf(b){var h;if(0===b.q9)return!1;for(let t=0;t<(null===(h=b.qa)||void 0===h?void 0:h.length);t++){const A=b.qa.J(t);if(null!=A.Ah)for(let O=0;O<A.Ah.length;O++){const aa=A.Ah.J(O),ua=b.Mc.Db(aa.an).hOa();if(!F.a.mf(ua)&&!ua.startsWith(this.K1)&&aa.Oc)return!0}}return!1}O0h(b){var h;const t=[];if(0===b.q9)return t;for(let A=0;A<(null===(h=b.qa)||void 0===h?void 0:h.length);A++){const O=b.qa.J(A);if(null!=O.Ah)for(let aa=
0;aa<O.Ah.length;aa++){const ua=O.Ah.J(aa),Ra=b.Mc.Db(ua.an),ub=Ra.hOa();F.a.mf(ub)||ub.startsWith(this.K1)||!ua.Oc||t.push(Ra)}}return t}Imo(b){return b.ia(Lc.a.jG,!1)}qym(b){return F.a.mf(b)?(u.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}zjl(b){return null!==this.Xua(b)?(u.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}N0h(b,h,t){return this.getBookmarkRange(b,h,t).baa}vri(b,h,t){if(this.Imo(t)||this.zDm(t))return!1;
const A=this.g$h(t,!0),O=this.g$h(t,!1);if(A&&O&&this.eb.ETc(h,A,O)){if(h!==A&&h!==O)return!0;const aa=this.N0h(A,t,!0);if(aa&&(A!==h||aa.Kb.cp<=b)&&(t=this.N0h(O,t,!1))&&(O!==h||t.Kb.cp>=b))return!0}return!1}zDm(b){b=null===b||void 0===b?void 0:b.ia(Lc.a.$s,"");return!F.a.mf(b)&&b.startsWith(this.K1)?!0:!1}}Object(m.a)(sB,"FullBookmarkManager",null,[464]);class Hy{constructor(){this.Xre=this.Oo=this.W=null}get name(){return"WordEditor.Bookmark"}yc(b){this.W=b;this.Oo=this.W.resolve("Box4.INotebookManager").Kl;
const h=new sB(new Pg.a(()=>Jb.App.ya.jb.Wc),fm.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new Pg.a(()=>Jb.App.ya.jb.xc.Zc),vo.a.instance,this.W.resolve("Box4.IParagraphReader"),this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ha("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").singleInstance();this.W.ha("WordEditor.Bookmark.BookmarksEventHandler",()=>new aA(this.Oo.af(12),
this.W.resolve("WordEditor.ITableEditor"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).singleInstance();vm.App.IEj&&(this.Xre=new $w(this.Oo.af(64),new Pg.a(()=>Jb.App.ya.jb.Wc),fm.PageNavigator.instance,Fq.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ha("WordEditor.Bookmark.BookmarkGraphManager",()=>this.Xre).as("WordEditor.Bookmark.IBookmarkGraphManager").singleInstance())}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>{this.$m()})}dispose(){this.Xre.dispose()}$m(){u.ULS.sendTraceTag(36209186,
324,50,"Registering paragraph events");this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();u.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.tNn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}tNn(b,h){b&&b.execute(t=>{t.g4(new pB(h))})}static main(){P.a.instance.Gc(new Hy)}}Object(m.a)(Hy,"BookmarkPackage",null,[1,2]);var mz=c(879),tB=c(1043),jt=c(1531),Yp=c(1395);class bA extends Yp.a{constructor(b){super();
this.Dgk=b}get index(){return 3}run(){this.Dgk()}sJ(){this.eY()}}Object(m.a)(bA,"FootnoteEndnoteGraphUpdateTracker",Yp.a,[]);class cA{constructor(){this.xid=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}yc(){}init(){cA.Xb.Ip.continueWith(()=>{this.$m()})}$m(){mz.a.Xfb=jt.a.instance;this.Hvf()}dispose(){}Hvf(){this.xid=new bA(()=>{jt.a.instance.Hu()});tB.a.Sae(Object(z.a)(this.xid,this.xid.sJ,"setUpdateNeeded"));Ar.GraphTransactionManager.instance.Cpa(this.xid,3)}static get Xb(){return Sa.a.instance.resolve("Box4.IFeatureHelper")}}
Object(m.a)(cA,"PackageManager",null,[1,2]);var bx=c(775),ww=c(211),Iy=c(557),dA=c(505),cx=c(1632);class dx extends ug{constructor(){super()}get zw(){return null}getTitle(b){b=b.Jma();if(!b||!Iy.a.instance.Ena(b))return"";const h=new Sys.StringBuilder,t=Iy.a.instance.L7(b);h.append(1===t?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(Iy.a.instance.v6b(b));return h.toString()}}Object(m.a)(dx,"FootnoteEndnoteBaseDetailsProvider",
ug,[]);class Pv extends dx{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get zh(){return 7}}Object(m.a)(Pv,"FootnoteEndnoteDetailsProvider",dx,[]);var Qv=c(1582),kC=c(1601),lC=c(1675);class eA extends dx{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get zh(){return 10}}Object(m.a)(eA,"FootnoteEndnoteRefMarkDetailsProvider",dx,[]);class nz{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd,ee,Od){this.zni=(fe,Ee,re,Fg,Gg)=>{Fg=Ee.view;if(!Fg.features.Bie||this.ZC.ori)return 8;
const bm=Fg.nb.pg;if(!bm)return 2;if(this.Fk.JZ(bm))return 8;Fg=fe===Vc.a.insertFootnote?1:0;var An=this.IMd(Ee);if(!An)return u.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;Ee=!0;An=An.Qa;Gg&&Gg.kac&&Gg.SEa&&(An=Gg.SEa,Ee=!Gg.keepCurrentFocus);if(1===re&&Po.a.vga(bm)||!An||!nf.SelectionEditor.jf(An)||this.pMg.instance&&this.pMg.instance.NEm(An)||Ge.HyperlinkReader.awa(An,!0))return 8;if(1===re)return 32;2===re&&(re=this.bW.eg("UserAction","InsertFootnoteEndnote"),fe=this.LXj.Ptm(An,
Fg,fe),Gg&&Gg.kac&&(Gg.SKi=fe),Ee&&this.W6d(fe,!0,!0),re.stop(),this.Wd.Bs(6));return 32};this.Vcc=(fe,Ee,re)=>{const Fg=Ee.view;if(fe===Vc.a.$5a||fe===Vc.a.Snb){if(!Fg.features.Bie)return 8}else if(!Fg.features.Vdg)return 8;if(!Fg.nb.pg)return 2;Ee=this.t7b(Ee);return Ee?fe!==Vc.a.$5a&&fe!==Vc.a.Snb||this.WJa.cim(Ee.node,fe===Vc.a.$5a?1:0)?1===re?32:2===re&&32===this.ga.Rb(Vc.a.p7,2,!0)?(this.ga.Rb(Vc.a.CNf,2,fe),32):8:8:2};this.rzl=(fe,Ee,re,Fg,Gg)=>{if(1===re)return 32;if(2===re){fe=this.Z4l(Ee);
if(!fe)return 8;re=Ee=null;switch(Gg){case Vc.a.q3d:re=fe.Rc;Ee=this.TTb.CRd(re,1);break;case Vc.a.p3d:re=fe.Rc;Ee=this.TTb.CRd(re,0);break;case Vc.a.s3d:re=fe.Qa;Ee=this.TTb.tgi(re,1);break;case Vc.a.r3d:re=fe.Qa;Ee=this.TTb.tgi(re,0);break;case Vc.a.$5a:re=fe.Qa;(Ee=this.TTb.CRd(re,1,!0))||(Ee=this.WJa.P4h(re.node,1));break;case Vc.a.Snb:re=fe.Qa,(Ee=this.TTb.CRd(re,0,!0))||(Ee=this.WJa.P4h(re.node,0))}if(Ee)this.W6d(Ee);else{if(!this.Gt.xc)return 8;(Gg=zc.d(re.node,re.cpBegin))&&7===Gg.zh&&this.WJa.Obj(Gg)}}return 32};
this.Voo=(fe,Ee,re,Fg,Gg)=>1===re?32:2===re?(u.ULS.shipAssertTag(4520066,308,!!Gg),u.ULS.shipAssertTag(4520067,308,!!Gg.qZa),fe=Gg.qZa,u.ULS.shipAssertTag(4520068,308,this.nF.Ena(fe)),this.W6d(fe,Gg.Yfe)?32:8):32;this.Woo=(fe,Ee,re,Fg,Gg)=>{if(1===re)return 32;2===re&&(fe=Gg.footnoteEndnoteNode,Gg=Gg.uzl)&&(this.xra.I4b(),Ee=this.nF.Iib(fe),Gg.title=this.nF.fQl(fe)+(Ee?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};
this.rlb=(fe,Ee,re,Fg,Gg)=>2===re?(u.ULS.shipAssertTag(4520069,308,!!Gg),u.ULS.shipAssertTag(4520070,308,!!Gg.qZa),u.ULS.shipAssertTag(4520071,308,qe.ParagraphReader.Yb(Gg.qZa)),fe=this.nF.t6b(Gg.qZa),this.W6d(fe,Gg.Yfe)?32:8):32;this.ebo=(fe,Ee,re)=>{2===re&&this.ZC.oY();return 32};this.Mgl=(fe,Ee,re,Fg,Gg)=>{if(1===re)return 32;if(2===re)return void 0!==Gg&&null!==Gg?this.ZC.Mcf(Gg,Gg):this.ZC.Mcf(),32;u.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};
this.aQm=(fe,Ee,re)=>{fe=this.t7b(Ee);return fe&&nf.SelectionEditor.jf(fe)?1===re?32:2===re?(re=0<this.Po.k3(fe.node).wt,this.ZC.h9e(),this.ZC.dialog.xhb=re,32):8:(u.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.pzl=(fe,Ee,re)=>1===re?32:2===re?(this.ZC.dialog.xhb=!1,32):8;this.sEn=(fe,Ee,re,Fg,Gg)=>this.rYh(fe,re,Gg);this.qEn=(fe,Ee,re,Fg,Gg)=>1===re?32:this.ZC.dialog&&this.ZC.dialog.fontName?(Gg[Hk.a.Value]=this.ZC.dialog.fontName,32):this.bUj.NNa(qa.a.bLb.toString(),
Gg,null)?32:8;this.ozl=(fe,Ee,re)=>1===re?32:2===re?(this.ZC.dialog.xhb=!0,32):8;this.rEn=(fe,Ee,re,Fg,Gg)=>this.rYh(fe,re,Gg);this.mzl=(fe,Ee,re)=>{if(1===re)return 32;if(2===re){fe=this.t7b(Ee);if(!fe)return u.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;Ee=this.nF.t6b(fe.node);this.nF.Ena(Ee)&&(re=this.Ic.Qc(15),re.Eb(Ee),this.ezj(fe),this.WJa.Zph(Ee,this.ZC.dialog),re.dispose());this.ZC.C3c();return 32}return 8};this.lzl=(fe,Ee,re)=>{if(1===re)return 32;if(2===re){fe=
this.t7b(Ee);if(!fe)return u.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;Ee=this.nF.t6b(fe.node);this.nF.Ena(Ee)&&(re=this.Ic.Qc(15),re.Eb(Ee),this.ezj(fe),this.WJa.wxk(Ee,this.ZC.dialog),re.dispose());this.ZC.C3c();return 32}return 8};this.nzl=(fe,Ee,re)=>1===re?32:2===re?(this.ZC.C3c(),32):8;this.jzl=(fe,Ee,re,Fg,Gg)=>{if(1===re)return 32;if(2===re){fe=Object(Da.a)(22,Gg);if(!fe||!fe.qd)return 8;this.ZC.dialog.fontName=fe.qd.fontName;return 32}return 8};this.kzl=(fe,
Ee,re,Fg,Gg)=>{if(1===re)return 32;if(2===re){fe=Object(Da.a)(22,Gg);if(!fe||!fe.qd)return 8;this.ZC.dialog.STb=fe.qd;return 32}return 8};this.ga=b;this.Gt=h;this.bUj=t;this.ed=A;this.nF=O;this.LXj=aa;this.WJa=ua;this.xra=Ra;this.ZC=ub;this.Po=Nb;this.TTb=Yb;this.Ic=bc;this.Fk=Dc;this.Gb=Pc;this.bW=jd;this.Wd=Cd;this.UNj=ee;this.pMg=Od}ezj(b){(b=Wa.FormattingReader.Ar(b))?(this.ZC.dialog.fontName||(this.ZC.dialog.fontName=b.cache.BE),-1===this.ZC.dialog.fontSize&&(this.ZC.dialog.STb=b.cache.fontSize)):
u.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}rYh(b,h,t){return 1===h&&this.ZC.dialog?32:2===h&&this.ZC.dialog?(t[Cl.a.On]=b===Vc.a.IZf?this.ZC.dialog.xhb:!this.ZC.dialog.xhb,32):8}Ub(){var b;(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.PageViewFootnoteEndnoteNavigationBugFix",!1))&&Jb.App.instance.Oki([Vc.a.q3d,Vc.a.p3d,Vc.a.s3d,Vc.a.r3d,Vc.a.CNf,Vc.a.$5a,Vc.a.Snb,Vc.a.p7]);this.ga.gb(Vc.a.insertFootnote,
mc.a.view,this.zni,4);this.ga.gb(Vc.a.insertEndnote,mc.a.view,this.zni,4);this.ga.pa(Vc.a.q3d,mc.a.view,this.Vcc);this.ga.pa(Vc.a.CNf,mc.a.view,this.rzl);this.ga.pa(Vc.a.p3d,mc.a.view,this.Vcc);this.ga.pa(Vc.a.s3d,mc.a.view,this.Vcc);this.ga.pa(Vc.a.r3d,mc.a.view,this.Vcc);this.ga.pa(Vc.a.$5a,mc.a.view,this.Vcc);this.ga.pa(Vc.a.Snb,mc.a.view,this.Vcc);this.ga.pa(Vc.a.xlj,mc.a.view,this.Voo);this.ga.gb(Vc.a.pYh,mc.a.view,this.ozl,4);this.ga.gb(Vc.a.IZf,mc.a.view,this.rEn,100);this.ga.gb(Vc.a.qYh,mc.a.view,
this.pzl,4);this.ga.gb(Vc.a.RZi,mc.a.view,this.sEn,100);this.ga.pa(Vc.a.ylj,mc.a.view,this.Woo);this.ga.gb(Vc.a.rlb,mc.a.view,this.rlb,96);this.ga.gb(Vc.a.gjf,mc.a.view,this.ebo,96);this.ga.pa(Vc.a.p7,mc.a.view,this.Mgl);this.ga.gb(Vc.a.PAi,mc.a.view,this.aQm,4);this.ga.gb(Vc.a.mYh,mc.a.view,this.mzl,4);this.ga.gb(Vc.a.nYh,mc.a.view,this.lzl,4);this.ga.gb(Vc.a.oYh,mc.a.view,this.nzl,4);this.ga.gb(Vc.a.zLd,mc.a.view,this.jzl,4);this.ga.gb(Vc.a.QZi,mc.a.view,this.qEn,100);this.ga.gb(Vc.a.ALd,mc.a.view,
this.kzl,4);this.ga.gb(Vc.a.e0c,mc.a.view,nz.e0c,100);this.ga.gb(Vc.a.f0c,mc.a.view,nz.f0c,100)}b1f(){this.UNj.execute(b=>{b.g4(new Pv);b.g4(new eA)})}t7b(b){b=this.IMd(b);return b?b.Qa:(u.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}IMd(b){let h=null;b=b.view;if(!b)return u.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),h;b=b.nb;if(!b)return u.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.hb;if(!b||
!b.length)return u.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.J(0);if(!b)return u.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),h;(h=nf.SelectionEditor.Bj(b,!1,!1))||u.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}Z4l(b){return(b=b.view)?b.nb.hb.J(0):null}W6d(b,h=!0,t=!1){if(b){this.xra.I4b();var A=b.tma;if(A){var O=A.Kb,aa=wf.SelectionFactory.nK(O.paragraph,O.cp,O.cp+1);O=this.Gt.xc;
if(!O)return!1;this.ed.xca(O,aa);O.Umb=150;O.p4();b=new dA.a(b,h);aa=ww.a.C6b(A,O);A=A.nva(O,aa);if(!A)return u.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;t||A.element?this.ZC.Qag(b):(this.ZC.Qag(new dA.a(b.qZa,!1)),h&&(h=new Vb.a(2,1,10,()=>{this.ZC.oY()}),this.Gb.Wb(h)));return!0}}return!1}static XPl(){return new nz(v.AFrameworkApplication.xa,Jb.App.ya.jb,Sa.a.instance.resolve("Box4.IGeneralCuiUser"),pc.InteractiveViewManager.instance,Iy.a.instance,kC.a.instance,Qv.a.instance,
jt.a.instance,cx.FootnoteEndnoteControlManager.instance,Sa.a.instance.resolve("Box4.IParagraphIndentationReader"),lC.a.instance,new vo.a,rl.a.instance,sf.a.instance,v.AFrameworkApplication.ta.xq,Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Sa.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager"),Sa.a.instance.Sa("Box4.IContentControlReader"))}static WPl(){return nz.XPl()}static e0c(b,h,t,A,O){if(1===t)return 32;if(2===t&&!O)return 8;Vm.a.GUd(h);O.PopulationXML=
Ap.FontUtils.SZh(Vm.a.nge,Vm.a.Gjf,Vc.a.zLd);return 32}static f0c(b,h,t,A,O){if(1===t)return 32;if(2===t&&!O)return 8;O.PopulationXML=Ap.FontUtils.TZh(Vc.a.ALd);return 32}}Object(m.a)(nz,"FootnoteEndnoteActor",null,[532]);class ex extends Yp.a{constructor(b){super();this.pUe=b}get index(){return 1}run(){this.pUe()}sJ(){this.eY()}}Object(m.a)(ex,"FootnoteEndnoteControlUpdateTracker",Yp.a,[]);var fx=c(378);class fA extends fx.a{constructor(b,h,t,A,O,aa,ua,Ra){super(b,h,t,A);this.Ns=()=>{this.e$c(this.Cb)};
this.UH=b.container;this.Gv=document.createElement("div");b.container.appendChild(this.Gv);this.sG(this.Gv);this.kak=O;this.uo.execute(ub=>{ub.i4(this.Ns)});this.$Ja=aa;this.YJ=ua;this.eI=Ra;this.$Ja.execute(ub=>{ub.j$f(this.fc,this.UH)});this.eI&&(this.UH.style.backgroundColor=this.YJ.Z6b())}dispose(){super.dispose();this.uo.instance&&this.uo.instance.zmb(this.Ns)}get uo(){return null!=this.Vwg?this.Vwg:this.Vwg=Sa.a.instance.Sa("Common.IZoomManager")}IB(b){this.UH.classList.add("FootnoteEndnoteViewElement");
this.e$c(b.currentNode)}e$c(b){this.uo.instance&&(this.uo.instance.Wad(this.Gv),this.Gv.style.width=Math.round(100/this.uo.instance.ij)+"%");this.kak(b)}}Object(m.a)(fA,"FootnoteEndnoteViewElement",fx.a,[]);class gA{constructor(){this._initialized=!1;this.Sed=this.gze=this.W=null;this.wzl=(b,h,t,A)=>b.j2a?new fA(b,h,t,A,O=>{cx.FootnoteEndnoteControlManager.instance.JYn(O)},this.W.Sa("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),
!!Jb.App.instance&&Jb.App.instance.wC):null}get name(){return"WordEditor.FootnoteEndnote"}yc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>{this.$m()})}$m(){Iv.WordSectionNavigator.instance.FNf=Object(z.a)(Qv.a.instance,Qv.a.instance.q$m,"navigateToWordSectionNodeWithFootnoteEndnote");bx.a.Z9f(this.wzl);cx.FootnoteEndnoteControlManager.instance.bind(Jb.App.ya.QC);this.gze=nz.WPl();this.gze.Ub();this.gze.b1f();Jb.App.ya.updateCommandUI();this.Hvf();this._initialized=
!0}dispose(){this._initialized&&(this._initialized=!1,cx.FootnoteEndnoteControlManager.instance.dispose())}Hvf(){this.Sed=new ex(()=>{cx.FootnoteEndnoteControlManager.instance.f$c()});tB.a.Sae(Object(z.a)(this.Sed,this.Sed.sJ,"setUpdateNeeded"));Ar.GraphTransactionManager.instance.Cpa(this.Sed,3)}}Object(m.a)(gA,"PackageManager",null,[1,2]);class Rx{constructor(b,h,t,A){this.ib=h;this.Gda=A}get bookmarkManager(){return this.Gda.value}EEm(b){return vm.App.IEj?b.startsWith(F.a.kdb):!1}mfm(b){try{this.nfm(b)}catch(h){u.ULS.sendTraceTag(24691935,
324,10,String.format("Error parsing bookmark url. Error: {0}",h.message))}}ohg(b){return{returnValue:!1,D1f:b,wCb:""}}nfm(b){if(this.bookmarkManager){b=b.split("/");var h=this.bookmarkManager.Xua(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.Yua(h,!0).baa,h=this.bookmarkManager.Yua(h,!1).baa,b||h?b?this.Pgj(b):(u.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.Pgj(h)):(u.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.Gzi(!1))):(u.ULS.sendTraceTag(35992275,
324,15,"Cannot find bookmark node"),this.Gzi(!0))}}Gzi(b){b=wf.SelectionFactory.Yn(Jb.App.ya.jb.Wc.wmf(),b);this.ib.setSelection(b)}Pgj(b){b.paragraph&&b.Kb?(b=wf.SelectionFactory.te(b.paragraph,b.Kb.cp),b.wqi=!0,this.ib.setSelection(b)):u.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(m.a)(Rx,"InternalLinkManager",null,[463]);class oz{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}yc(b){b.ha("WordEditor.InternalLinks.InternalLinkManager",
()=>new Rx(new Pg.a(()=>b.Ma("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new Pg.a(()=>b.Ma("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").singleInstance()}static main(){P.a.instance.Gc(new oz)}}Object(m.a)(oz,"WordEditorInternalLinksPackage",null,[1,2]);class ns{constructor(b){this.EKa=null;this.checkAndDeleteEphemeralOutline=h=>{h=h.customData;if(h.anchor){Ok.a.mark(4763);
var t=ue.GraphIterator.$a(h);if(t.Ab(8)&&t.fd(8)&&t.Zvj(h)===h){if(mj.OutlineReader.isEmpty(t)){let A=!1;for(let O=0;O<he.a.instance.hb.length;O++){const aa=he.a.instance.hb.J(O);for(let ua=0;ua<aa.length;ua++)if(aa.J(ua).node===h){A=!0;break}}A||this.AMh(t)}Ok.a.mark(4764)}}};ns.XJ=b}AFd(b){if(!ns.lf.fYd(b))return null;b.Tb(1)&&(b.currentNode.Wk(8,!0),b.wc());const h=ns.XJ.a6k();ns.lf.isRtl(b.currentNode)?h.setValue(Af.a.tq,11):h.setValue(Af.a.tq,9);b.Qf(h,1);b.Fi(h);return h}Cco(b){if(this.EKa&&
b!==this.EKa){const h=new Vb.a(2,1,0,this.checkAndDeleteEphemeralOutline,120);h.customData=this.EKa;v.AFrameworkApplication.oc.Wb(h)}this.EKa=b}AMh(b){this.EKa===b.currentNode&&(this.EKa=null);const h=new Te.GraphTransaction(7);h.Fu(b);b.Dg();h.dispose()}Zzh(){if(this.EKa&&this.EKa.anchor){const b=ue.GraphIterator.$a(this.EKa);b.Yo()&&mj.OutlineReader.BSc(b)&&this.AMh(b);this.EKa=null}}static get lf(){return Lk.PageReader.instance}}ns.XJ=null;Object(m.a)(ns,"PageContentEditor",null,[1475]);var xw=
c(1168),Rv=c(652);class uB extends Jq{constructor(){super()}$jj(b,h,t,A,O){let aa=!1,ua=!0;nf.SelectionEditor.jf(O)&&(h=hb.ListItemReader.Kh(b)&&h,O=mb.OutlineElementReader.jA(b,O,!1)&&!mb.OutlineElementReader.jA(b,O,!0),h&&t.C3e(b,A)&&(aa=!0),Jb.App.xd.Yp&&(O||h&&!aa)&&(ua=!1));return{Zjj:ua,eEj:aa}}}Object(m.a)(uB,"CursorMoveValidator",Jq,[]);class Ro{constructor(b,h,t,A,O){this.gy=O;this.bLe=b;this.K5=A;this.vra=h;this.Hh=t}get Kd(){return null!=this.WEg?this.WEg:this.WEg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=
this.GEg?this.GEg:this.GEg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get uc(){return null!=this.zGg?this.zGg:this.zGg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Gs(){return this.K5.value}get vg(){return this.Hh.value}get Hp(){return this.vra}jdm(b){const h=window.performance.now(),t=new mk.ScriptSharpLegacyMap,A=new sp.a,O=new mk.ScriptSharpLegacyMap;if(b&&b.Hw){var aa=null;for(let ua=0;ua<b.length;ua++){const Ra=b.getContext(ua);aa=aa||Ro.eh.Ms(Ra.node);
let ub;if(!({groupId:ub}=this.aHo(Ra.node,aa)).returnValue)continue;let Nb;t.ob(ub)||(Nb=[],t.add(ub,Nb));Nb=t.J(ub);Nb.push(Ra)}for(const ua of so.toArray(t.keys))b=t.J(ua),aa=new ue.GraphIterator,aa.set(b[0].node),({X8i:b,Ut:aa}=this.vra.yGo(aa)).returnValue?(t.Z(ua,b),O.add(ua,aa)):A.add(ua)}u.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:t,mdm:A,ldm:O}}lzb(b){return this.ULk(b)}b1b(b){return this.tLk(b)}qBd(b,
h,t=!0){return ue.GraphIterator.v7(()=>{var A=!1;if(hb.ListItemReader.Kh(b))return this.C3e(b,h,t);A||(wg.OutlineElementNavigator.Fe(b),A=qe.ParagraphReader.rh(b)||ni.TableReader.isTable(b),wg.OutlineElementNavigator.Zd(b),A=A&&this.SLk(b,h));return A})}C3e(b,h,t=!0){return ue.GraphIterator.v7(()=>{const A=mb.OutlineElementReader.PDa(b),O=mj.OutlineReader.eX(b.currentNode);if(t?!this.cGm(b,h):!this.dGm(b,h))return!1;var aa=ue.GraphIterator.$a(b.currentNode);if(0<h&&aa.Ab(14)){aa.fd(16);var ua=aa.currentNode;
const Ra=Gh.TableCellReader.gsf(aa);aa.fd(14);const ub=aa.currentNode;aa=Ps.a.hM(ua,ub,Lc.a.TO,Lc.a.za,0);ua=Ps.a.hM(ua,ub,Lc.a.qR,Lc.a.Aa,0);aa=Hc.a.ny(aa,0);ua=Hc.a.ny(ua,0);return A+O<Ra-aa-ua}return!0})}SLk(b,h){const t=mb.OutlineElementReader.PDa(b);var A=mb.OutlineElementReader.aG(b);if(0<h){h=mj.OutlineReader.eX(b.currentNode);A=0;const {xo:Ra,marginLeft:ub,marginRight:Nb}=Ro.qPd(b.currentNode);var O=ue.GraphIterator.$a(b.currentNode);wg.OutlineElementNavigator.Fe(b);if(ni.TableReader.isTable(b)){A=
ni.TableReader.Lfa(b);var aa=0;for(var ua of A)aa+=ua;A=Hc.a.ny(Hc.a.ef(aa,0),0)}wg.OutlineElementNavigator.Zd(b);return O.Ab(14)?(O.fd(16),ua=O.currentNode,b=Gh.TableCellReader.gsf(O),O.fd(14),aa=O.currentNode,O=Ps.a.hM(ua,aa,Lc.a.TO,Lc.a.za,0),ua=Ps.a.hM(ua,aa,Lc.a.qR,Lc.a.Aa,0),O=Hc.a.ny(O,0),ua=Hc.a.ny(ua,0),t+h<b-O-ua-A):t+h<Ra-ub-Nb-A}return 0<t-A}tRa(b,h){this.gTi(b,-1*Math.abs(h))}dIc(b,h){this.gTi(b,Math.abs(h))}Iel(b,h,t,A,O){let aa=Ro.bIi;if(h>=Ro.bIi){aa=h-=t;const ua=A*O,Ra=Math.abs(ua),
ub=Math.abs(h)%Ra;ub&&(aa=0>aa?0>A?aa+ub:aa-(Ra-ub):0<A?aa-ub:aa+(Ra-ub));aa+=ua;aa+=t;Ro.O7d&&(t=mb.OutlineElementReader.k3(b),aa=Ro.O7d.V1h(b.currentNode,h+t,aa+t,O,aa<h)-t)}return aa}QLk(b,h,t){if(!b||!b.length)return!1;h=t?h?-1:1:this.E3h(b[0].node,h);return this.RLk(b,h,t)}drn(b,h,t){if(!b)return u.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return u.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),
8;if(!t)return u.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!t.length)return u.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const A=b[0].node;h=this.E3h(A,h);if(!this.K8m(A,t[0],h)||!this.H8m(b,h))return 8;this.Gs.Pia();return 32}H8m(b,h){for(let t=0;t<b.length;t++){const A=new ue.GraphIterator;A.set(b[t].node);let O=null;wg.OutlineElementNavigator.Fe(A);if(qe.ParagraphReader.rh(A)){if(O=A.currentNode,
!O)return u.ULS.shipAssertTag(589592461,338,!O,"The paraNode is null for the list OE node"),!1}else if(!qe.ParagraphReader.rh(A)&&!ni.TableReader.isTable(A))return u.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;A.wc();if(O){if(this.jim(O)){const aa=O.qD(),ua=mb.OutlineElementReader.PDa(A);this.vg.$xa(A,1,ua+h);aa&&this.lj.NU(O,aa,this.Kd.Cg)}Km.a.getInstance().xv||O.setValue(Af.a.iU,new Date)}}return!0}K8m(b,h,t){for(let A=0;A<Xk.a.Yga;A++){const O=
this.vra.px(b,h,A);if(!O)return u.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const aa=O.getValue(Lc.a.ee);aa&&O.setValue(Lc.a.ee,aa+t)}return!0}jim(b){return b.hasProperty(Lc.a.ee)||b.hasProperty(Lc.a.qt)||b.hasProperty(Lc.a.GD)}tLk(b){return this.qBd(b,1,!0)}ULk(b){return this.qBd(b,-1,!0)}E3h(b,h){var t=new ue.GraphIterator;t.set(b);const A=mb.OutlineElementReader.PDa(t),O=mb.OutlineElementReader.aG(t),aa=mb.OutlineElementReader.k3(t);t=mj.OutlineReader.eX(b);
Ro.qPd(b);b=(O?A-O:aa)%t;return h?-1*(b?b:t):t-b>Ro.ALh?Ro.ALh:t-b}aHo(b,h){let t;const A=new ue.GraphIterator;A.set(b);b=A.Tb(4).getValue(Lc.a.listID);return({id:t}=this.vra.Ukc(b,h)).returnValue?{returnValue:!0,groupId:t}:{returnValue:!1,groupId:t}}RLk(b,h,t){var A=!1;for(let O=0;O<b.length;O++){A=b[O];const aa=new ue.GraphIterator;aa.set(A.node);nf.SelectionEditor.au(aa);if(!mb.OutlineElementReader.Lh(aa))return Ro.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.Ueb}),!1;if(this.qBd(aa,h,t))A=!0;else return Ro.Jc.Zb(gg.a.V3b,
{["Reason"]:uf.a.T3e}),!1}return A}gTi(b,h){if(this.qBd(b,h,!0)){var t=!1;if(hb.ListItemReader.Kh(b)){var A=new ue.GraphIterator;A.$c(b);this.Hp.rM(A);var O=A.currentNode;A.wc();const ua=O.getValue(Lc.a.listLevel);t=!0;var aa=O.getValue(Lc.a.listID);if(aa=this.H6l(aa,ua+h))wg.OutlineElementNavigator.Fe(A),qe.ParagraphReader.rh(A)&&Ro.EG.rJ(aa,A.currentNode,!1),A.wc();else{aa=null;let Ra;wg.OutlineElementNavigator.Fe(A);qe.ParagraphReader.rh(A)&&(aa=A.currentNode);A.wc();Ra=aa?aa.qD():null;aa||(wg.OutlineElementNavigator.Fe(A),
qe.ParagraphReader.rh(A)&&(aa=A.currentNode),A.wc());aa&&(aa.hasProperty(Lc.a.ee)&&aa.removeProperty(Lc.a.ee),aa.hasProperty(Lc.a.qt)&&aa.removeProperty(Lc.a.qt));Km.a.getInstance().$I||this.gy.g7a(O,ua+h);Km.a.getInstance().xv&&this.gy.g7a(aa,ua+h);O.removeProperty(Lc.a.XX);aa&&Ra&&(this.lj.NU(aa,Ra,this.Kd.Cg),this.Gs.Pia());this.vyo(b,O)}}t||(t=mb.OutlineElementReader.PDa(b),A=mb.OutlineElementReader.aG(b),O=mj.OutlineReader.eX(b.currentNode),h=this.Iel(b,t,A,h,O),this.vg.$xa(b,1,h))}}dGm(b,h){const t=
mb.OutlineElementReader.PDa(b),A=mb.OutlineElementReader.aG(b),O=mb.OutlineElementReader.k3(b),{xo:aa,marginLeft:ua,marginRight:Ra}=Ro.qPd(b.currentNode);if(0<h){if(b=aa-ua-Ra,O&&O+h+Jb.App.Sya>b||t+h+Jb.App.Sya>b)return!1}else if(O&&0>t+h||0>t-A+h)return!1;return!0}cGm(b,h){var t=this.Gs.cG(b);const A=t.level+h;if(Hv.a.BPm<A||A<Hv.a.$wl)return!1;t=this.Hp.px(b.currentNode,t.listID,A);if(!t)return u.ULS.shipAssertTag(590700875,338,!!t),!1;if(0<h&&t.hasProperty(Lc.a.ee)){h=t.getValue(Lc.a.ee);const {xo:O,
marginLeft:aa,marginRight:ua}=Ro.qPd(b.currentNode);if(h+Jb.App.Sya>O-aa-ua)return!1}return!0}H6l(b,h){const t=this.uc.Cr();for(let A=0;A<t.VP;A++){const O=t.EOa(A);if(this.Hp.mBb(O)&&O.ia(Lc.a.listID,this.Gs.s8+1)===b&&O.ia(Lc.a.listLevel,-1)===h)return O}return null}vyo(b,h){wg.OutlineElementNavigator.Fe(b);if(qe.ParagraphReader.rh(b)&&b.currentNode.hasProperty(Lc.a.ee)&&(h=this.Hp.yNc(h))){if(h.hasProperty(Lc.a.qt)){var t=h.getValue(Lc.a.qt);this.bLe.lnb(b.currentNode,t)}h.hasProperty(Lc.a.ee)&&
(t=h.getValue(Lc.a.ee),this.bLe.$xa(b,1,t));h.hasProperty(Lc.a.GD)&&(h=h.getValue(Lc.a.GD),this.bLe.sca(b.currentNode,h))}wg.OutlineElementNavigator.Zd(b)}static get EG(){return null!=Ro.$Fg?Ro.$Fg:Ro.$Fg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get O7d(){return null!=Ro.gCg?Ro.gCg:Ro.gCg=Sa.a.instance.Ma("WordEditor.ParagraphIndentationUtility")}static get paragraphEditor(){return Ro.As||(Ro.As=Sa.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(b){Ro.As=
b}static get Jc(){return zk.a.instance}static get Vf(){return Aq.a.instance}static get eh(){return fm.PageNavigator.instance}static qPd(b){var h=Iv.WordSectionNavigator.instance.gJ(b);b=Ro.Vf.Ot(h);const t=Ro.Vf.OI(h);h=Ro.Vf.zK(h);return{xo:b,marginLeft:t,marginRight:h}}}Ro.ALh=Ad.a.wv(.25);Ro.As=null;Ro.bIi=Ad.a.wv(-11);Object(m.a)(Ro,"OutlineElementIndentationEditor",null,[358,359]);var Rn=c(563),Sx=c(224),yw;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";
b[b.table=3]="table"})(yw||(yw={}));Object(m.b)("StyleTargetType",yw);var bu=c(225);class qv{constructor(b,h){this.pW=null;this.zL=h;this.If=b}get paragraphEditor(){return null!=this.PBg?this.PBg:this.PBg=Sa.a.instance.resolve("Box4.IParagraphEditor")}get oH(){return null!=this.owg?this.owg:this.owg=Sa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get Dn(){return null!=this.IDg?this.IDg:this.IDg=Sa.a.instance.Ma("Box4.Styles.StyleSettings")}get oq(){return null!=this.Gwg?this.Gwg:this.Gwg=Sa.a.instance.resolve("Box4.IFormattingEditor")}get uc(){return null!=
this.CGg?this.CGg:this.CGg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get CR(){return this.pW||(this.pW=new Rv.WACStyleSet)}set CR(b){this.pW=b}get Xb(){return null!=this.Tvg?this.Tvg:this.Tvg=Sa.a.instance.Ma("Box4.IFeatureHelper")}get Qn(){return this.zL.value}get qj(){return null!=this.Lxg?this.Lxg:this.Lxg=Sa.a.instance.Ma("Box4.IInsertionPointFormatting")}get C_d(){return this.If||(this.If=Sa.a.instance.resolve("Box4.List.IListReader"))}get characterPropertiesEditor(){return null!=
this.ptg?this.ptg:this.ptg=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Kd(){return null!=this.nFg?this.nFg:this.nFg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=this.NEg?this.NEg:this.NEg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}O6l(b){const h=b.node;var t=this.qj?this.qj.A1h():null;if(t&&!t.equals(W.a.nil)){b=h.Mc;if(!b)return null;t=b.Db(t);if(!t||(t=new bu.a(t),1!==this.uc.vD(t)))return null}else t=
Wa.FormattingReader.Ar(b),t=Wa.FormattingReader.bna(t);return t}qgo(b,h){const t=this.uc.qC(h);t&&t.Ni(this.uc.jg(b))&&(this.Kjg(h,t),this.qj&&(this.qj.c5a(),this.qj.Fnb(b,h)))}Zwk(b,h){if(h)if(h.vCb&&0<h.vCb.length){let O=new Ca.a;for(var t of h.vCb)O.add(t);if(h.Lzi){t=Wa.FormattingReader.J_h(b);const aa=[];for(var A of t)A.formatting&&A.formatting.sn&&aa.push(A.formatting.sn);if(0<aa.length){A=kv.APropertySet.a7h(aa);t=new Ca.a;for(const ua of O)(!A.hasProperty(ua)||h.oOm&&ua===zf.a.vIa)&&t.add(ua);
O=t}}this.paragraphEditor.G1b(b,!0,O)}else this.paragraphEditor.G1b(b,!0);else Jc.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}rJ(b,h,t,A=!1,O=!1,aa=!1,ua=null){if(qe.ParagraphReader.Yb(h))if(b)if(this.uc.WX(b.Ik()))if(2!==this.uc.vD(b))u.ULS.shipAssertTag(593506381,324,!1);else{var Ra=this.uc.qC(h);if(Ra){var ub=this.uc.jg(b);if(!ub)u.ULS.shipAssertTag(593506377,324,!1);else if(Ra.Ni(ub)){var Nb=null,Yb=jp.a.instance.J(1)&&!A?h.qD():
null;t||(ua&&ua.kLk&&this.Xb&&this.Xb.isFeatureEnabled(99)?(this.Zwk(h,ua),pi.a.Oj&&1==ua.vCb.length&&ua.vCb[0]==zf.a.vIa?Nb=this.Qn.Q0i(Nb,h):this.nPo(h,b,ua)):(Nb=this.Qn.Q0i(Nb,h),this.paragraphEditor.G1b(h,!0)));this.Kjg(h,Ra);O&&Yb&&Yb.hasProperty(fh.a.paragraphStyle)&&Yb.removeProperty(fh.a.paragraphStyle);h.properties.setValue(fh.a.paragraphStyle,b.id);pi.a.Oj&&this.C_d.pC(h)&&this.Xb&&this.Xb.isFeatureEnabled(99)&&this.Vyj(h,b,ua);h.$O=b;h.RSa=null;for(t=0;t<h.qa.length;t++)h.qa.J(t).formatting&&
h.qa.J(t).formatting.p9b();this.C_d.mBb(b)&&(Nb||(Nb=new ue.GraphIterator,Nb.set(h),Nb.yd(),wg.OutlineElementNavigator.Zd(Nb)),hb.ListItemReader.Kh(Nb)||(h.Qg(Lc.a.ee,Lc.a.yM,Lc.a.GD,Lc.a.W_,Lc.a.iRa,Lc.a.$v),this.yzd(Nb,b)));this.Dn&&this.Dn.isProgressiveStyleEnabled&&null!=this.oH&&this.oH.Kic(ub);A||!Yb||aa||this.lj.NU(h,Yb,this.Kd.Cg)}}else u.ULS.shipAssertTag(593506379,324,!1)}else u.ULS.shipAssertTag(593506382,324,!1);else u.ULS.shipAssertTag(593506383,324,!1);else u.ULS.shipAssertTag(593506384,
324,!1)}nPo(b,h,t){const A=this.C_d.pC(b),O=this.C_d.mBb(h);A&&(this.Vyj(b,h,t),O||A.removeProperty(Lc.a.XX))}Vyj(b,h,t){const A=b.Mc;if(b=this.characterPropertiesEditor.u_a(b)){var O=null==b.sn?new Sx.a:b.sn.clone();ck.a.rQo(O,h,t&&!t.Lzi&&t.vCb?t.vCb:null);O.Tna?h=A.gR(O,!0):(A.Du(O,null),h=O);b.Dj=h.id}else u.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}yzd(){}tfe(b,h){if(h){u.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");
var t=this.uc.qC(h);t?(b=t.cEa(b))?this.uc.WX(b.Ik())?this.rJ(b,h,!1,void 0,void 0,void 0,null):u.ULS.shipAssertTag(593506368,324,this.uc.WX(b.Ik())):u.ULS.shipAssertTag(593506369,324,!!b):u.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else u.ULS.shipAssertTag(593506372,324,!1)}n5e(b,h=!1,t=!1){const A=this.uc.qC(b).Ni(Tf.StyleReader.wordStyleIdNormal);this.rJ(A,b,h,void 0,t)}Kjg(b,h){(b=qv.eh.Ms(b))&&h.Vhc(b)}ecl(b){var h=null;if(this.Xb&&this.Xb.isFeatureEnabled(33)){if(!b||
!b.count)return u.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=ck.a.Nt(),!h))return u.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var t=this.CR.tQ(h);if(!t)return u.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var A=new Map;A.set("NumberOfStyles",b.count.toString());A.set("Source","DeleteStyleAPI");wa.Health.instance.recordKpiUsage(Qo.a.nne,0,Qo.a.dB,A);A=0;const ua=(new Date).getTime();
var O=null;let Ra=null,ub=null,Nb=null;const Yb=this.Xb.isFeatureEnabled(32)&&!0;Yb&&(O=new Mb.a,Ra=new Mb.a,ub=new Mb.a,Nb=new Mb.a);for(var aa of b){if(!aa)return u.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const bc=t.Ni(aa);if(!bc||!this.uc.ke(bc,t))return u.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!bc,!!bc&&this.uc.ke(bc,t)),!1;const Dc=this.uc.vD(bc);if(2!==Dc&&1!==Dc)return u.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",
Dc),!1;const Pc=this.uc.iva(bc,t);let jd=0;if(Pc){if(!this.uc.ke(Pc,t))return u.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;jd=this.uc.vD(Pc);if(2!==jd&&1!==jd)return u.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",Dc,jd),!1}else u.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let Cd=this.YAb(bc,t);if(!Cd)return!1;A++;Yb&&(1===Dc?(Ra.add(aa),Nb.add(bc.id)):
(O.add(aa),ub.add(bc.id)));if(Pc){Cd=this.YAb(Pc,t);if(!Cd)return!1;A++;Yb&&(1===jd?(Ra.add(this.uc.jg(Pc)),Nb.add(Pc.id)):(O.add(this.uc.jg(Pc)),ub.add(Pc.id)))}}mw.a.NRc();t=ck.a.Urf(t);aa=new Te.GraphTransaction(15);aa.Eb(h);Yb&&this.qUn(O,Ra,ub,Nb,h);h.setValue(fh.a.tia,t);Jc.b(572302817,3018,50,String.format("Style Object Ids - {0}",t));aa.ree();aa.dispose();h=(new Date).getTime();O=new Map;O.set("Source","DeleteStyleAPI");O.set("NumberOfStyles",b.count.toString());O.set("TrueStyleCount",A.toString());
O.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new Hb.a,{extendedProperties:O,durationMs:h-ua});wa.Health.instance.recordKpiSuccess(Qo.a.nne,b);return!0}return!1}qUn(b,h,t,A,O){if(b&&b.count||h&&h.count)if(O){var aa=(new Date).getTime();if(O=this.fNl(O)){for(;O.moveNext();){if(!qe.ParagraphReader.rh(O.iterator))continue;const ua=O.currentNode;this.bUn(ua,b,t);this.cUn(ua,h,A)}t=(new Date).getTime();u.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",
t-aa));A=new Map;A.set("Source","DeleteStyleRemoveStylesReferences");A.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new Hb.a,{extendedProperties:A,durationMs:t-aa});wa.Health.instance.recordKpiSuccess(Qo.a.nne,b)}}else Jc.b(577520338,3018,50,"PageContentNode not provided.");else Jc.b(577520337,3018,50,"No style IDs provided")}bUn(b,h,t){if(h&&h.count&&b){var A=b.GC;A&&A.hasProperty(fh.a.paragraphStyle)&&t.contains(A.getValue(fh.a.paragraphStyle))&&(A.removeProperty(fh.a.paragraphStyle),
b.GC=A,b.qD()&&this.lj.NU(b,b.qD(),this.Kd.Cg));(t=this.uc.Uo(b))&&(t=this.uc.jg(t))&&h.contains(t)&&this.n5e(b,!0,!0)}}cUn(b,h,t){if(b&&b.qa&&b.qa.length&&h&&h.count)for(let ua=0;ua<b.qa.length;ua++){var A=b.qa.J(ua);if(A&&A.formatting&&(A=A.formatting)&&A.Kb){var O=Wa.FormattingReader.bna(A);O&&(O=this.uc.jg(O))&&h.contains(O)&&this.oq.c5e(A);if(O=A.Kb.Rn){var aa=O.sn;aa&&(aa=aa.clone(),aa.hasProperty(fh.a.Qv)&&t.contains(aa.getValue(fh.a.Qv))&&this.mSn(b,aa,O,A));jp.a.instance.J(1)&&(aa=ua===b.qa.length-
1?b.characterData.length:b.qa.J(ua+1).cp,this.lj.YMb(b,A.Kb,A.Kb.cp,aa,O,A,this.Kd.Cg))}}}}mSn(b,h,t,A){b&&h&&t&&A&&(b=b.Mc)&&(h.removeProperty(fh.a.Qv),h.Tna?h=b.gR(h,!0):b.Du(h,null),t.Dj=h.id,A.Kb.Rn=t)}fNl(b){if(!b)return null;b=ue.GraphIterator.$a(b);return b.Yo()?Qd.a.at(b,b.origin):null}YAb(b,h){if(!b)return u.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var t=b.Ik();return this.uc.WX(t)?h.pUn(b)?!0:(t=new Map,t.set("Source","DeleteStyle"),t.set("StyleType",
yw[this.uc.vD(b)]),t.set("IsCustomStyle",this.uc.ke(b,h).toString()),t.set("IsLinkedStyle",(!!this.uc.iva(b,h)).toString()),b=Object.assign(new Hb.a,{extendedProperties:t}),wa.Health.instance.recordKpiFailure(Qo.a.nne,"UnableToDeleteStyle",!1,!0,b),u.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(u.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}HIb(b,h,t,A){var O,aa,ua;if(this.Xb&&this.Xb.isFeatureEnabled(80)){if(!b)return u.ULS.sendTraceTag(591138959,
3018,15,"No style IDs provided for delete."),!1;if(!t&&(t=ck.a.Nt(),!t))return u.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ub=this.CR.tQ(t);if(!ub)return u.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=ub.Ni(b);if(!b)return u.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var Ra=this.uc.vD(b);if(2!==Ra&&1!==Ra)return u.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",
Ra),!1;wa.Health.instance.recordKpiUsage(Qo.a.Zlg,0,Qo.a.dB,new Map([["Source","ModifyStyleAPI"]]));Ra=Date.now();const Nb=new Te.GraphTransaction(15);let Yb,bc;try{Nb.Eb(t);if(!(A&&0!=A.length||h&&0!=h.count))return!1;if(A&&0!=A.length){if(null===(O=Rn.a.Gl)||void 0===O?0:O.BTc)Yb=ck.a.OOd(b);if(!ub.Qcl(b,A))return this.ywa("ModifyStyleAPI",b,ub,Ra,"UnableToDeleteStyleProperties"),!1}if(h&&0!=h.count){const ee=ub.oRo(b,h);if(null===(aa=Rn.a.Gl)||void 0===aa?0:aa.BTc)bc=ck.a.OOd(b);if(!ee)return this.ywa("ModifyStyleAPI",
b,ub,Ra,"UnableToModifyStyle"),!1}(null===(ua=Rn.a.Gl)||void 0===ua?0:ua.BTc)&&this.M8m(b,t,bc,Yb);mw.a.NRc();const Dc=ck.a.Urf(ub);t.setValue(fh.a.tia,Dc);Jc.b(572302818,3018,50,String.format("Style Object Ids - {0}",Dc));const Pc=Date.now(),jd=new Map([["Source","ModifyStyleAPI"]]),Cd=Object.assign(new Hb.a,{extendedProperties:jd,durationMs:Pc-Ra});wa.Health.instance.recordKpiSuccess(Qo.a.Zlg,Cd);return!0}finally{Nb&&Nb.dispose()}}return!1}M8m(b,h,t,A){var O,aa;if(null!==b){var ua;A&&((ua=null===
(O=this.Qn)||void 0===O?void 0:O.ame(h,A,b,!0))||Jc.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));t&&((ua=null===(aa=this.Qn)||void 0===aa?void 0:aa.ame(h,t,b,!1))||Jc.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}ywa(b,h,t,A,O){const aa=Date.now();b=new Map([["Source",b],["StyleType",yw[this.uc.vD(h)]],["IsCustomStyle",this.uc.ke(h,t).toString()],["IsLinkedStyle",(!!this.uc.iva(h,t)).toString()]]);
A=Object.assign(new Hb.a,{extendedProperties:b,durationMs:aa-A});wa.Health.instance.recordKpiFailure(Qo.a.Zlg,O,!1,!0,A)}static get eh(){return fm.PageNavigator.instance}}Object(m.a)(qv,"WACStyleEditor",null,[1300]);class zw extends qv{constructor(b,h,t){super(b,t);this.K5=h}get Gs(){return this.K5.value}yzd(b,h){this.Gs.yzd(b,h)}}Object(m.a)(zw,"WACStyleEditor",qv,[]);class hA{M5a(b,h){b.properties.setValue(Lc.a.marginTop,h)}K5a(b,h){b.properties.setValue(Lc.a.marginBottom,h)}dia(b,h){b.properties.setValue(Lc.a.marginLeft,
h)}L5a(b,h){b.properties.setValue(Lc.a.marginRight,h)}f9f(b,h){b.properties.setValue(Lc.a.xo,h)}e9f(b,h){b.properties.setValue(Lc.a.Zv,h)}Afj(b,h){b.properties.setValue(Lc.a.Xzi,h)}VMb(b,h){b.properties.setValue(zf.a.rE,h)}A$n(b,h){b.properties.setValue(zf.a.zla,h)}Ehc(b,h){b.properties.setValue(zf.a.JF,h)}Wfo(b,h){b.properties.setValue(zf.a.separator,h)}}Object(m.a)(hA,"WordSectionEditor",null,[149]);class iA{get name(){return"WordEditor.OutlineLevelEditors"}yc(b){b.ha("WordEditor.OutlineLevelEditors.WordSectionEditor",
()=>new hA).as("Box4.IWordSectionEditor").singleInstance();v.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ha("Box4.OutlineLevelEditors.PageContentEditor",()=>new ns(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Ro(Jv.a.BOa,b.resolve("WordEditor.List.IFlatListReader"),b.We("Box4.IOutlineElementEditor"),b.We("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("Box4.IOutlineElementIndentationEditor"),
b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Ro(Jv.a.BOa,b.resolve("WordEditor.List.IFlatListReader"),b.We("Box4.IOutlineElementEditor"),b.We("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ha("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new uB).as("Box4.List.ICursorMovementValidator").singleInstance(),b.ha("Box4.Styles.WACStyleReader",()=>new xw.a(b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"),
new Rv.WACStyleSet)).as("Box4.Styles.IWACStyleReader").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new zw(b.resolve("Box4.List.IListReader"),b.We("WordEditor.IFlatListEditor"),b.We("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").singleInstance())}init(){}dispose(){}static main(){P.a.instance.Gc(new iA)}}Object(m.a)(iA,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var gx=c(1198),hx=c(812),kt=c(345),rv=c(191);class tr{constructor(b,h,t,A,O,aa){this.If=
O;this._pageContent=t;this.Dub=Array(tr.Yga);this.rYb=Array(tr.Yga);this.rdh=Array(tr.Yga);this.UNe=Array(tr.Yga);this.y$g=Array(tr.Yga);this.Z1=A;this.BBc=aa;for(A=0;A<tr.Yga;A++){var ua=this.I7h(b,A,t,O);ua?(aa=ua.ia(Af.a.C_,Xk.a.vl),ua=ua.ia(Lc.a.O3c,Xk.a.vl)):ua=aa=Xk.a.vl;this.rYb[A]=aa!==Xk.a.vl?aa:Xk.a.VHc;this.UNe[A]=ua===Xk.a.vl?A-1:ua-1;tr.w8(h)&&(this.rdh[A]=Xk.a.vl,this.y$g[A]=Xk.a.vl);this.Dub[A]=this.rYb[A]}}I7h(b,h,t,A){A.a3(t);return Km.a.getInstance().gSc&&this.BBc?this.If.npf(b,
h,this.Z1,t):this.If.zNc(b,h,t.Mc,t)}restart(b){this.Dub[b]=this.rYb[b]}nKi(b){for(var h=0;h<b;h++)this.Dub[h]===this.rYb[h]&&this.Dub[h]++;for(h=b+1;h<tr.Yga;h++)this.UNe[h]>=b&&this.restart(h);return this.Dub[b]++}static w8(b){return!!b&&b.isFeatureEnabled(70)}}tr.Yga=9;Object(m.a)(tr,"AWordList",null,[45]);class uu{constructor(b,h,t,A){this.lab=new mk.ScriptSharpLegacyMap;this.If=b;this.ZJ=h;this.Z1=t;this.BBc=A}Fw(b,h){this.lab.ob(b)||this.lab.Z(b,new tr(b,h,this.ZJ,this.Z1,this.If,this.BBc));
return this.lab.J(b)}nOf(b,h,t){return this.Fw(b,t).nKi(h)}}Object(m.a)(uu,"AListNumberingMap",null,[1531]);class jA extends tr{constructor(b,h,t,A,O,aa){super(b,h,t,A,O,aa)}BZl(b,h,t,A){A.a3(t);return Km.a.getInstance().gSc&&this.BBc?this.If.cVl(b,h,this.Z1):this.If.bVl(b,h,this._pageContent.Mc)}Pyj(b,h,t){var A=this.BZl(b,h,this._pageContent,this.If);A?(b=A.ia(Af.a.C_,Xk.a.VHc),A=A.ia(Lc.a.O3c,Xk.a.vl),this.Dub[h]=this.rdh[h]=this.rYb[h]=b,A!==Xk.a.vl&&(this.y$g[h]=this.UNe[h]=A-1)):t&&(A=this.I7h(b,
h,this._pageContent,this.If),b=Xk.a.VHc,A&&(b=A.ia(Af.a.C_,Xk.a.VHc)),this.Dub[h]=this.rYb[h]=b)}}Object(m.a)(jA,"WordList",tr,[]);class Jy extends uu{constructor(b){super(b.Ad,b.pageContentNode,b.iSa,b.WBj);this.S8g=new Mb.a}EUl(b,h,t){let A;Km.a.getInstance().VX?{value:A}=this.If.aJ.Ec(b,A):{value:A}=this.If.z_.Ec(b,A);this.lab.ob(A)||this.lab.Z(A,new jA(b,t,this.ZJ,this.Z1,this.If,this.BBc));if(!this.S8g.contains(b))for(this.S8g.add(b);h<Xk.a.Yga;h++)this.lab.J(A).Pyj(b,h,!1);else if(!h)for(h+=
1;h<Xk.a.Yga;h++)this.lab.J(A).Pyj(b,h,!0);return this.lab.J(A)}nOf(b,h,t){return tr.w8(t)?this.EUl(b,h,t).nKi(h):super.nOf(b,h,t)}}Object(m.a)(Jy,"ListNumberingMap",uu,[]);class ix{constructor(){this.OQa=0;this.JDj=!1}}Object(m.a)(ix,"LastNumber",null,[]);var vB=c(838),Ql=c(633),vu=c(893);class Ky{constructor(){this.startAt=this.eSa=0}}Object(m.a)(Ky,"WordListRestartInfo",null,[]);class lp{constructor(b,h,t,A){this.P3d=!1;this.Gs=b;this.gui=t;this.z9b=A;this.Ow=this.Gs.cG(h);this.outlineElement=
new ue.GraphIterator;this.outlineElement.$c(h)}static get Ad(){return lp.If||(lp.If=Sa.a.instance.resolve("Box4.List.IListReader"))}static set Ad(b){lp.If=b}static get Gl(){return Km.a.getInstance()}static nvl(b,h,t,A=!1,O=!1){var aa=h.currentNode;let ua=null;new ue.GraphIterator;let Ra=!1,ub=!1;h=h.SPb();const Nb=Qd.a.So(h);Nb.moveNext();for(h=Nb.iterator;h.currentNode!==aa;){let bc=ub=Ra=!1;var Yb=lp.Gjl(h);if(mb.OutlineElementReader.Lh(h)&&!Yb){Yb=!1;if(h.Xr(4))if(lp.FLi(h,t,!0,A,O))if(rv.a.SZ){if(bc=
!0,ua=new lp(b,h,!1,!1),Nb.moveNext(),Nb.iterator===aa&&(Ra=!0),A)break}else ua=new lp(b,h,!1,!1),Ra=!0;else mb.OutlineElementReader.isEmpty(h,!1)||(Yb=!0),ub=!0;else!mb.OutlineElementReader.isEmpty(h,!1)&&h.vhb(12)&&(mb.OutlineElementReader.UP(h)||(Yb=!0));!A&&Yb&&ua&&(t.propertySet.hasProperty(Lc.a.listLevel)?ua.Ow.level=0:ua=null)}bc||Nb.moveNext();h=Nb.iterator}ua&&(ua.z9b=Ra);if(!ua&&h.wf(1))for(aa=!0;h.currentNode;){if(mb.OutlineElementReader.Lh(h)){if(h.Xr(4)&&lp.FLi(h,t,!1,A,O)){ua=new lp(b,
h,!0,aa);break}if(!mb.OutlineElementReader.isEmpty(h,!1))break}if(!h.wf(1))break;aa=!1}ua&&(ua.P3d=ub);return ua}static Gjl(b){var h=b.Tb(2);if(!h)return!1;h=qe.ParagraphReader.rh(b)&&lp.kHm(h);b.wc();return h}static kHm(b){return zc.a(b,8)}static FLi(b,h,t,A=!1,O=!1){lp.Ad.rM(b);var aa=b.currentNode;b.wc();const ua=lp.Ad.BT(aa);(b=h.Zy===ua.Zy)&&h.listStyle&&1!==h.Gr&&(b=h.listStyle===ua.listStyle);b&&(h.Wna&&1!==h.Gr||h.D5b||O)&&(b=lp.iFm(h,ua),h.Zy||(b=b&&h.font===ua.font));if(1===h.Gr)if(1===
ua.Gr&&ua.propertySet.hasProperty(Jh.a.akb))b=h.U4===ua.U4;else return!1;b&&h.Zy&&h.vB!==Xk.a.vl&&(b=ua.wu,t&&(A&&1===h.vB&&1===b||b++),b=h.vB===b);b&&(A||h.D5b)&&(h=h.propertySet.ia(Lc.a.listID,0),aa=aa.ia(Lc.a.listID,0),0<h&&0<aa&&(b=h===aa));return b}static iFm(b,h){h=h.RGf;b.Wna&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.RGf.toLocaleLowerCase()}static ovl(b,h,t){var A=h.currentNode;let O=null;const aa=new ue.GraphIterator,ua=b.Xma(A,t);var Ra=!1;let ub=!1;aa.$c(h);aa.wc();
for(aa.Tb(1);aa.currentNode!==A;)ub=Ra=!1,mb.OutlineElementReader.Lh(aa)&&aa.Xr(4)&&(h=b.cG(aa),lp.GLi(h,t,!0)?(O=new lp(b,aa,!1,!1),Ra=!0):(ub=!0,h.listID===t.listID&&h.level<=ua.eSa&&(O=null))),aa.wf(1);O&&(O.z9b=Ra);if(!O&&aa.wf(1))for(A=!0;aa.currentNode;){if(mb.OutlineElementReader.Lh(aa)&&aa.Xr(4)){Ra=b.cG(aa);if(Ra.listID===t.listID&&Ra.level<=ua.eSa)break;if(lp.GLi(Ra,t,!1)){O=new lp(b,aa,!0,A);break}}if(!aa.wf(1))break;A=!1}O&&(O.P3d=ub);return O}static GLi(b,h,t){let A=b.listID===h.listID&&
b.level===h.level;A&&h.wu!==Xk.a.vl&&(b=b.wu,t&&b++,A=h.wu===b);return A}}lp.If=null;Object(m.a)(lp,"JoinTargetInfo",null,[]);class cr{constructor(b,h){this.Ow=null;this.action=b;h&&(this.Ow=h)}static Zcc(){return new cr(0)}static QBi(){return new cr(1)}static BRm(b){return new cr(3,b)}static RRm(b){return new cr(2,b)}static DRm(b){return new cr(4,b)}}Object(m.a)(cr,"ApplyListInfoResult",null,[]);class Sg{constructor(b,h,t){this.fjc=t;this.Eqn=h;this.V9=t-h.wu;this.TZc=h.listID}get delta(){-1!==this.V9&&
(this.V9=this.fjc-this.Eqn.wu);return this.V9}set delta(b){this.V9=b}}Object(m.a)(Sg,"ListTransferInfo",null,[]);class Mo extends Rn.a{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc){super(b,t,ub);this.gy=Dc;this.Wch=!1;this.bqc=this.Mfd=this.LSb=null;this.jhe=(Pc,jd)=>jd.listID===Pc.listID&&jd.level===Pc.level;this.aro=(Pc,jd,Cd)=>jd.listID!==Pc.listID&&jd.listID!==Cd.TZc||jd.level!==Pc.level?!1:!0;this.Y4m=(Pc,jd,Cd)=>jd.listID===Pc.listID||Cd&&jd.listID===Cd.TZc?!0:!1;this.Jmj=(Pc,jd,Cd,ee)=>{const Od=
Pc.ia(Rn.a.Gl.eV,-1);this.Imj(Pc,Od+jd,Cd,ee)};this.Imj=(Pc,jd,Cd,ee)=>{Km.a.getInstance().$I||this.gy.Dya(Pc,Cd);jd=this.RDa(Pc);Pc=ue.GraphIterator.$a(Pc);Pc.yd();Pc.wc();this.Bzl(Pc,jd,this.Y4m,this.Zwo,ee)};this.bro=(Pc,jd,Cd,ee)=>{const Od=this.Hp.v0a(Pc),{Ow:fe,iterator:Ee}=this.OIc(Od,()=>{Km.a.getInstance().$I||this.gy.Dya(Pc,Cd);Km.a.getInstance().xv&&this.gy.Dya(Od,Cd);const re=this.RDa(Pc),Fg=ue.GraphIterator.$a(Pc);Fg.yd();Fg.wc();return{Ow:re,iterator:Fg}});this.ELd(Ee,fe,this.cqj,this.nie,
ee)};this.Xwo=(Pc,jd,Cd,ee,Od)=>{this.u0i(Pc,jd,Cd,ee,Od)};this.nie=(Pc,jd,Cd,ee)=>{Cd.listID=jd.listID;ee.Tb(4);const Od=this.Hp.v0a(ee.currentNode);this.OIc(Od,()=>{this.Y_b(ee.currentNode,Cd,Od);ee.wc()})};this.Zwo=(Pc,jd,Cd,ee)=>{hb.ListItemReader.Kh(ee)&&(Pc=new ue.GraphIterator,Pc.$c(ee),Pc.yd(),this.Ad.rM(Pc),this.gpi(ee.currentNode,Pc.currentNode))};this.Ywo=(Pc,jd,Cd,ee,Od)=>{Cd.listID=jd.listID;this.u0i(Pc,jd,Cd,ee,Od);this.nie(Pc,jd,Cd,ee,Od)};this.bqj=(Pc,jd)=>jd.listID===Pc.listID;this.Wwo=
(Pc,jd)=>jd.level<=Pc.level;this.cqj=(Pc,jd,Cd)=>jd.listID===Cd.TZc;this.Po=O;this.vra=b;this.Njd=h;this.Ic=A;this.GVf={};this.$3j=aa;this.Wd=ua;this.iq=Ra;this.jd=Nb;this.ax=Yb;this.FL=bc}get w8(){return this.vra.zga}get dOb(){return this.Wch}set dOb(b){this.Wch=b}get Hp(){return this.vra}get Fca(){return this.FL}get uc(){return this.ax}get Ut(){return this.Hp.Ut}get uq(){return this.Hp.uq}get Usa(){return this.Hp.Usa}get s8(){return this.Hp.s8}set s8(b){this.Hp.s8=b}get ZPa(){return this.Hp.ZPa}set ZPa(b){this.Hp.ZPa=
b}get g7c(){return null!=this.dDg?this.dDg:this.dDg=Sa.a.instance.Ma("Box4.List.ISingleLevelListEditor")}dtk(b,h,t,A){u.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const O=t.ia(Gd.a.dWd,!1);let aa=!1,ua=-1;!O||h.listStyle&&1!==h.Gr||(aa=!t.ia(Gd.a.XEf,!1),ua=t.ia(Gd.a.QGf,-1));b=this.nDc(b,h,{emi:aa,eRm:ua,Lzl:A,propertySet:t});O||t.setValue(Gd.a.XEf,2===b.action);3===b.action&&!t.hasProperty(Gd.a.QGf)&&b.Ow&&t.setValue(Gd.a.QGf,b.Ow.level)}merge(b,h,t,A=null){const O=
hb.ListItemReader.Kh(b)||hb.ListItemReader.Kh(h);b=super.merge(b,h,t,A);O&&this.Pia();return b}PYi(b,h){this.HMk(b,h)}HMk(b,h){b=this.Ad.hpf(b);const t=this.Ad.hpf(h);-1!==b&&-1!==t&&(b-=t,0<b?this.Njd.value.dIc(h,b):0>b&&this.Njd.value.tRa(h,b,0))}M4i(b){this.Ad.rM(b);b.Dg();jp.a.instance.J(1)&&this.Pia()}WEo(b,h,t,A){var O=ue.GraphIterator.$a(t);O=this.cG(O);this.XEo(O,b,h,t,A)}cG(b){this.Ad.rM(b);const h=this.RDa(b.currentNode);b.wc();return h}Wfj(b,h){this.Ad.rM(b);const t=b.currentNode;b.wc();
Km.a.getInstance().$I||this.gy.Dya(t,h);Km.a.getInstance().xv&&(b=mb.OutlineElementReader.UDa(b),this.gy.Dya(b,h));return this.RDa(t)}RDa(b){const h=new hx.a;if(jp.a.instance.J(1)){var t=this.Ad.hO(b,!1,!0);h.listID=t.listId;h.level=t.listLevel}else h.listID=b.ia(Lc.a.listID,0),h.level=b.ia(Lc.a.listLevel,-1);h.XX=b.ia(Lc.a.XX,!1);t=this.TOd(b);h.qbo(t);h.wu=b.ia(Rn.a.Gl.eV,Xk.a.vl);h.UIc=b.ia(Rn.a.Gl.$ca,Xk.a.vl);return h}Y_b(b,h,t=null,A=!1){b||zk.a.instance.Zb("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});
!Km.a.getInstance().xv||A||t||(ii.Debug.Hrh(509364288),Jc.b(509364259,393,15,"Apply list info called without para node"));h||zk.a.instance.Zb("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});Km.a.getInstance().$I||this.gy.Wee(b,h.listID,h.level);Km.a.getInstance().xv&&t&&!A&&this.gy.Wee(t,h.listID,h.level);!Km.a.getInstance().$I&&h.XX&&b.setValue(Lc.a.XX,!0)}Rzj(b){this.Hp.a3(b);b=Mo.eh.Ms(b);let h=b.ia(Lc.a.uq,null);h=h?Array.clone(h):[];b.setValue(Lc.a.uq,h);this.Hp.r9b()}Upj(b){switch(b){case 0:return 0;
case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}KUl(b){b=b.view;if(!b.nb||!b.nb.hb)return null;b=Cq.OutlineElementGeneralizer.xma(b.nb.hb,!1);if(1!==b.length)return null;b=ue.GraphIterator.$a(b.getContext(0).node);if(!hb.ListItemReader.Kh(b))if(14===b.Sd().type){const h=this.Hp.scm(b.currentNode);h&&b.set(h)}else Jc.b(589177753,393,15,"Encountered an OE of non list type."),b.wc();b.yd();return b}w5k(b,h,t,A){const O=b.pH(),aa=new hx.a;aa.listID=this.rIh(b);
this.w8?(aa.t_d=Rn.a.Gl.VX?this.sIh(b):this.jIh(b),this.y1i(b,aa.listID,aa.t_d)):this.A1i(b,aa.listID);aa.Hfj(h.propertySet,this.UVc(t));this.TId(b);t=this.M7h(b,h);for(let Ra=0;9>Ra;Ra++){const ub=new ru.a;O.ud.Du(ub);this.z1i(b,this.w8?W.a.nil:ub.id,this.w8?ub.id:W.a.nil);this.Zkk(ub,h.Zy,Ra);this.alh(ub,t,Ra);var ua=A.THb[Ra];ua=6===ua?kq.a.dT(1,1):kq.a.dT(0,ua);ua.Mga&&ub.setValue(Af.a.Q3,ua.Mga);h.vB!==Xk.a.vl&&Ra===aa.level&&ub.setValue(Af.a.C_,h.vB);A.zDa&&A.zDa[Ra]&&ub.setValue(Af.a.font,
A.zDa[Ra]);ua=A.WVc[Ra];u.ULS.shipAssertTag(22127636,338,!!ua);ub.setValue(Lc.a.Vt,ua);ub.setValue(Lc.a.yba,A.FZd[Ra]);kt.a.Jfe(A.U4,ub)}return aa}v5k(b,h,t){const A=b.pH(),O=new hx.a;O.listID=this.rIh(b);this.w8?(O.t_d=Rn.a.Gl.VX?this.sIh(b):this.jIh(b),this.y1i(b,O.listID,O.t_d)):this.A1i(b,O.listID);O.Hfj(h.propertySet,this.UVc(t));if(!h.listStyle)switch(O.level%3){case 0:h.i9(h.listType,1);break;case 1:h.i9(h.listType,2);break;case 2:h.i9(h.listType,3)}this.TId(b);t=this.M7h(b,h);for(let aa=0;9>
aa;aa++){const ua=new ru.a;A.ud.Du(ua);this.z1i(b,this.w8?W.a.nil:ua.id,this.w8?ua.id:W.a.nil);this.Ykk(ua,h.Zy,aa);this.alh(ua,t,aa);2===aa%3&&h.Zy?ua.setValue(Lc.a.yba,"right"):ua.setValue(Lc.a.yba,"left");aa===O.level&&(h.Mga&&ua.setValue(Af.a.Q3,h.Mga),h.vB!==Xk.a.vl&&ua.setValue(Af.a.C_,h.vB),h.Zy?this.Lfj(h,ua,aa):(Mo.Ifj(h,ua),Mo.Kfj(h,ua)),Mo.Jfj(h,ua),h.D5b&&ua.Qta(h.propertySet,Lc.a.listID,Lc.a.listLevel))}return O}Lfj(b,h,t){b.Wna?(b=b.levelText,b=F.a.replaceAll(b,"%1","%"+(t+1))):b=b.URc||
b.gna?b.levelText:"%"+(t+1)+".";u.ULS.shipAssertTag(22127638,338,!!b);h.setValue(Lc.a.Vt,b)}Lkj(b,h,t,A){if(b.URc)return!1;if(1===b.Gr)return A;if(A)return!0;if(h){A=b.listType===h.listType;const O=!b.listStyle&&b.vB===Xk.a.vl;let aa=b.listStyle===h.listStyle&&b.vB===h.vB;b=(!b.Wna||this.P5f(h,b))&&!t;aa=aa&&b;return A&&(O||aa)}return!1}TId(b){this.LSb||(this.LSb=b.ia(Lc.a.Dal,null));this.Mfd||(this.Mfd=b.ia(Lc.a.Cal,null));this.bqc||(this.bqc=b.ia(Lc.a.Eal,null))}UVc(b){720>b&&(b=0);return Math.max(0,
Math.min(Math.floor(b/720),8))}BSl(b){return b?this.Po.zT(b).wt-this.Po.aG(b).wt:-1}A1i(b,h){const t=b.ia(Lc.a.Ut,null),A=t?t.length:0,O=Array(A+1);let aa=0;for(;aa<A;aa++)O[aa]=t[aa];O[aa]=h;b.setValue(Lc.a.Ut,O);this.Hp.r9b()}y1i(b,h,t){this.gXe(Lc.a.Ut,b,h);if(Rn.a.Gl.VX){this.gXe(zf.a.N3a,b,t);var A=this.Hp.QOd(b);A.add(h,t);b.setValue(zf.a.aJ,Ql.b(gx.a.vkc(A)))}else this.gXe(Lc.a.Usa,b,t),A=this.Hp.POd(b),A.add(h,t),b.setValue(Lc.a.z_,Ql.b(gx.a.vkc(A)))}z1i(b,h,t){this.w8?(this.Qkh(Lc.a.uq,b,
t),this.Qkh(Lc.a.G8,b,h)):(t=(t=b.ia(Lc.a.uq,null))?Array.clone(t):[],t.push(h),b.setValue(Lc.a.uq,t),this.Hp.r9b())}gXe(b,h,t){const A=h.ia(b,null),O=A?A.length:0,aa=Array(O+1);let ua=0;for(;ua<O;ua++)aa[ua]=A[ua];aa[ua]=t;h.setValue(b,aa)}Qkh(b,h,t){let A=h.ia(b,null);A=A?Array.clone(A):[];A.push(t);h.setValue(b,A)}Ykk(b,h,t){var A=t%3+1;const O=h?this.bqc:this.Mfd;O&&t<O.length?b.setValue(Lc.a.qt,O[t]):b.setValue(Lc.a.qt,360);A=rv.a.SZ?kq.a.dT(h?0:1,this.Upj(A),null,0,t):kq.a.dT(h?0:1,this.Upj(A));
b.Aw(A.propertySet);b.setValue(Lc.a.S0e,h?-1:-2);h?b.setValue(Lc.a.Vt,"%"+(t+1)+"."):(b.setValue(Af.a.font,this.jMl(t)),b.setValue(Lc.a.Vt,String.fromCharCode(this.$Ll(t))));kt.a.Mhc(2,b)}Zkk(b,h,t){const A=h?this.bqc:this.Mfd;A&&t<A.length?b.setValue(Lc.a.qt,A[t]):b.setValue(Lc.a.qt,360);b.setValue(Lc.a.S0e,h?-1:-2);kt.a.Mhc(1,b)}$Ll(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}jMl(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";
default:return"Symbol"}}rIh(b){if(this.w8)this.s8<Xk.a.jWc&&this.Hp.a3(b),this.s8=this.I8h(this.Ut,this.s8,Xk.a.jWc);else{if(this.s8<Xk.a.jWc&&(this.Hp.a3(b),this.Ut&&this.uq)){b=this.Ut.length;for(let h=0;h<b;h++)this.Ut[h]>=this.s8&&(this.s8=this.Ut[h])}this.s8+=1}return this.s8}jIh(b){this.ZPa<Xk.a.$wd&&this.Hp.a3(b);return this.ZPa=this.I8h(this.Usa,this.ZPa,Xk.a.$wd)}sIh(b){var h;this.Hp.a3(b);do b=Math.floor(Math.random()*(Mo.C5m-Mo.hIi))+Mo.hIi;while(null===(h=this.Hp.$Ib)||void 0===h?0:h.includes(b));
return b}I8h(b,h,t){if(h<t&&b){t=b.length;for(let A=0;A<t;A++)b[A]>h&&(h=b[A])}h++;return h}oXn(b,h){this.wYh(b,h,1,this.jhe,this.Jmj,null,!1)}nXn(b,h,t){this.Czl(b,h,t,this.jhe,this.Imj)}sBk(){this.Pia()}Pia(){var b=null,h,t;if(jp.a.instance.J(1)){var A=new ue.GraphIterator;if(b)if(8===b.type)A.set(b);else{u.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else A.set(Jb.App.ya.jb.Wc),Mo.eh.Chg(A),b=Mo.eh.Ms(A.currentNode);if(A.Ab(7)||
A.fd(7)){A=Qd.a.at(A,A.origin);var O=new Jy({Ad:this.Hp,pageContentNode:b,iSa:null,WBj:!1});for(b=new Jy({Ad:this.Hp,pageContentNode:b,iSa:null,WBj:!1});A.moveNext();){var aa=A.iterator;if(!aa.Xr(4)&&!aa.Xr(31))continue;this.Ad.NIb(aa);const Ra=aa.currentNode;aa.wc();if(!Ra){u.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",aa.isValid);continue}if(!this.w8&&63!==Ra.type&&this.Ad.BT(Ra).listType)continue;var ua=this.Ad.hO(Ra,!1,!1);if(this.w8&&
ua&&this.Ad.wXd(ua.listId)){u.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",ua.listId);continue}const ub=Object(Da.a)(Tb.AParagraphNode,wg.OutlineElementNavigator.Fe(aa,!0));ub&&(ub.qa?(null==ub.qa.last&&u.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),aa.wc(),this.w8&&this.Hp.a3(aa.currentNode),12===ub.type&&(ub.Vi&&ub.GC.hasProperty(Lc.a.listID)||null===(h=ub.qa.last)||void 0===h||!h.aj)&&((aa=this.Ad.hO(Ra,
!0,!0))?this.Mfj(Ra,b,Rn.a.Gl.Gmc,aa):u.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Ra.type)),!ua||null!==(t=ub.qa.last)&&void 0!==t&&t.gi||!this.Mfj(Ra,O,Rn.a.Gl.eV,ua)||(ua=Ra.getValue(Rn.a.Gl.eV),this.w8&&this.Ad.BT(Ra).listType||Ra.setValue(Rn.a.Gl.$ca,ua))):u.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else u.ULS.shipAssertTag(593234060,376,7===A.Xe,"Couldnt reach to page manifest node")}}Mfj(b,
h,t,A){t||u.ULS.shipAssertTag(571757918,393,!!t,"Prop definition is null");h=h.nOf(A.listId,A.listLevel,this.jd);A=-1;b.hasProperty(t)&&(A=b.getValue(t));return h===A||this.w8&&63!==b.type&&this.Ad.BT(b).listType&&(t!==Rn.a.Gl.Gmc||1!==this.Ad.BT(b).listType)?!1:(b.setValue(t,h),!0)}WDm(b,h){let t=!1,A=!0,O=0;const aa=this.cG(b),ua=b.currentNode;b=b.SPb();b=Qd.a.So(b);for(b.Sn(vu.a.mWc,null);b.moveNext();){var Ra=b.iterator.currentNode;if(Ra===ua)break;hb.ListItemReader.Kh(Ra)&&(Ra=this.cG(b.iterator),
Ra.listID===aa.listID&&(Ra.level>aa.level?(t=!0,O++):Ra.level===aa.level?(A=!1,O=0):Ra.level<=h.eSa&&(A=!0,O=0)))}return t&&A&&!0}xyh(b,h){this.Ad.rM(b);const t=b.currentNode;b.wc();const A=this.cG(b);A&&this.Hp.lWc(t,A.listID,A.level)&&this.nXn(b.currentNode,A,h)}O7h(b){const h=this.Ad.Fw(b);h.D5b=!0;this.Ad.rM(b);const t=b.currentNode.ia(Lc.a.listID,0);h.propertySet.setValue(Lc.a.listID,t);b.fd(11);return h}KFf(b,h,t){const A=new ue.GraphIterator,O=h.currentNode;let aa;var ua=Xk.a.vl;let Ra=!1,
ub=!1,Nb=!1,Yb=null;var bc=h.SPb();bc=Qd.a.So(bc);for(bc.Sn(vu.a.mWc,null);bc.moveNext();){A.$c(bc.iterator);if(A.currentNode===O)break;Ra=!1;A.Xr(4)&&(aa=this.cG(A),aa.listID===b.listID&&(aa.level===b.level?(this.Ad.rM(A),ua=A.currentNode,A.wc(),ua=ua.ia(Rn.a.Gl.eV,Xk.a.vl),Ra=!0,Yb=A.zlc(1),ub=!0):aa.level>b.level?Nb=!0:aa.level<=t.eSa&&(ua=Xk.a.vl,Nb=ub=!1)))}!ub&&Nb&&(ua=t.startAt);Ra&&(Ra=h.zlc(1)===Yb);b=new ix;b.OQa=ua;b.JDj=Ra;return b}jXn(b,h){if(Mo.EIm)this.fPo(b,h);else{const O=this.RDa(b),
aa=this.Xma(b,O),ua=this.Hp.u0a(b,O);var t=new ue.GraphIterator;const Ra=ua.Zy;let ub=aa.startAt,Nb=!1,Yb=!1;u.ULS.shipAssertTag(22127639,338,ua.gna,"Info does not have a level Text.");t.set(b);if(t.yd()&&(b=t.gSa()))for(b=Qd.a.So(b),b.Sn(vu.a.mWc,O);b.moveNext();){t=b.iterator.currentNode;if(!hb.ListItemReader.Kh(t))continue;var A=this.cG(b.iterator);A.listID===h&&(A=this.Wfj(b.iterator,O.listID));if(A.listID!==O.listID)continue;const bc=b.iterator.Tb(4);bc&&b.iterator.wc();A.level>O.level?(this.Hp.lWc(bc,
O.listID,A.level)&&this.gpi(t,bc),Yb=!0):(A.level<=aa.eSa?(ub=aa.startAt,Yb=Nb=!1):(A=b.iterator,this.Ad.rM(A),Rn.a.Gl.xv||A.currentNode.setValue(Lc.a.Vt,ua.RGf),{K5n:Nb,OQa:ub}=this.mXn(Ra,Yb,Nb,A,ub,t)),Mo.Qvm(b))}}}fPo(b,h){const t=this.RDa(b),A=new ue.GraphIterator;A.set(b);if(A.yd()&&(b=A.gSa())){b=Qd.a.So(b);for(b.Sn(vu.a.mWc,t);b.moveNext();)hb.ListItemReader.Kh(b.iterator.currentNode)&&this.cG(b.iterator).listID===h&&this.Wfj(b.iterator,t.listID);u.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}gpi(b,
h){u.ULS.shipAssertTag(22819227,338,!!b&&!!h);h.setValue(yg.a.JBi,W.a.create().toString())}mXn(b,h,t,A,O,aa){b?(h&&!t&&O++,wg.OutlineElementNavigator.Zd(A),this.xyh(A,O),O++,t=!0,A.Tb(2),vB.a.QBf(A.currentNode)&&A.currentNode.Wk(4,!0)):(A.currentNode.removeProperty(Rn.a.Gl.eV),wg.OutlineElementNavigator.Zd(A));aa.Wk(4,!0);(b=A.jo(16))&&b.Wk(8,!0);return{K5n:t,OQa:O}}Xma(b,h){const t=zk.a.instance.vp(qa.a.Xma),A=new Ky;(b=this.Hp.px(b,h.listID,h.level))?(A.eSa=b.ia(Lc.a.O3c,h.level-1),A.startAt=b.ia(Af.a.C_,
1)):zk.a.instance.Zb("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});t.end();return A}x7k(b){const h=Wp.a.instance.createInstance(1074135151);b.Qf(h,31)}XEo(b,h,t,A,O){const aa=this.createList(h);this.Y_b(aa,b,null,!0);h=this.Hp.u0a(h.currentNode,b);h.listType||(aa.setValue(Rn.a.Gl.eV,b.wu),aa.setValue(Rn.a.Gl.$ca,b.UIc),this.P6i(aa,b,t?A:O));switch(h.listType){case 0:t="Numbering";break;case 1:t="Bullet";break;default:t="Invalid List Type"}v.AFrameworkApplication.xa.processAction(qa.a.joinList,
2);u.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",t);rv.a.SZ&&!Km.a.getInstance().$I&&this.gy.Wee(aa,b.listID,b.level)}F4i(b){var h=this.uc.Uo(b);h?this.uc.jg(h)===Tf.StyleReader.wordStyleIdListParagraph&&(h=this.uc.qC(b),this.Fca.rJ(h.Ni(Tf.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.dOb)):u.ULS.shipAssertTag(8271188,315,!1)}fdo(b){if(this.uc.jg(this.uc.Uo(b))===Tf.StyleReader.wordStyleIdNormal){const h=this.uc.qC(b);this.Fca.rJ(h.Ni(Tf.StyleReader.wordStyleIdListParagraph),
b,!0,!0)}b.Qg(Lc.a.ee,Lc.a.yM,Lc.a.GD,Lc.a.W_,Lc.a.qt,Lc.a.sha);b.setValue(Lc.a.iRa,0)}wNk(b,h){const t=b.getValue(Lc.a.listID),A=b.getValue(Lc.a.listLevel);for(let aa=0;9>aa;aa++){const ua=this.Hp.px(b,t,aa);if(!ua)return zk.a.instance.Zb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var O=h.THb[aa];O=6===O?kq.a.dT(1,1):kq.a.dT(0,O);O.Mga&&ua.setValue(Af.a.Q3,O.Mga);ua.hasProperty(Af.a.font)&&ua.removeProperty(Af.a.font);h.zDa&&h.zDa[aa]&&ua.setValue(Af.a.font,h.zDa[aa]);O=h.WVc[aa];
u.ULS.shipAssertTag(22127641,338,!!O);ua.setValue(Lc.a.Vt,O);ua.setValue(Lc.a.Gr,kt.a.Mcc);kt.a.Jfe(h.U4,ua);ua.setValue(Lc.a.yba,h.FZd[aa]);ua.Qg(Lc.a.O3c,Af.a.C_);this.Rzj(b)}b=new hx.a;b.listID=t;b.level=A;return b}uNk(b,h,t,A){if(A)return this.wNk(b,A);A=b.getValue(Lc.a.listID);const O=b.getValue(Lc.a.listLevel),aa=this.Hp.px(b,A,O);if(!aa)return zk.a.instance.Zb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&u.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",
h.listStyle,h.listType,A,O),null;h.D5b&&(aa instanceof kv.APropertySet?aa.Qta(h.propertySet,Lc.a.listID,Lc.a.listLevel):u.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===aa||void 0===aa?void 0:aa.constructor.name));var ua=aa.ia(Lc.a.Gr,null);ua&&ua===kt.a.Mcc&&this.tNk(b,A);if(!h.listStyle){ua=0;if(-1!==t){for(ua+=O-t;0>ua;)ua+=3;ua%=3}switch(ua){default:t=1;break;case 1:t=2;break;case 2:t=3}h.i9(h.listType,t)}h.Mga&&aa.setValue(Af.a.Q3,
h.Mga);h.Zy?(this.Lfj(h,aa,O),aa.hasProperty(Af.a.font)&&aa.removeProperty(Af.a.font)):(Mo.Ifj(h,aa),Mo.Kfj(h,aa));Mo.Jfj(h,aa);aa.Qg(Lc.a.O3c,Af.a.C_,Lc.a.MTc);this.Rzj(b);b=new hx.a;b.listID=A;b.level=O;return b}tNk(b,h){let t;for(let A=0;9>A;A++){t=this.Hp.px(b,h,A);if(!t){u.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,A);break}t.setValue(Lc.a.Gr,kt.a.QTd);t.removeProperty(Jh.a.akb)}}Zee(b,h){const t=zk.a.instance.vp(qa.a.Zee);this.Njd.value||zk.a.instance.Zb("PossibleIncorrectListIndentation",
{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.mLa?(t.properties.Z("PendingListInfo","true"),hb.ListItemReader.Kh(b)&&(t.properties.Z("RemoveCurrentListInfo","true"),this.dOb=!0,this.SRa(b),this.Njd.value.tRa(b,-1,0),this.dOb=!1),16!==this.mLa.listType&&this.nDc(b,this.mLa,{emi:!0,lBl:rv.a.SZ}),this.mLa=null):h||(t.properties.Z("CurrentlyUnderPastedList","true"),this.SRa(b,{w4i:!0}));t.end()}Ufe(b,h){var t;if(hb.ListItemReader.Kh(b))return!1;b.Tb(2);var A=ll.a.TBk;const O=[!0,!1].map(aa=>
qe.ParagraphReader.ug(b.currentNode,aa,void 0,!1));b.wc();for(let aa=0;aa<O.length;aa++){const ua=O[aa];if(ua&&!rv.a.dwa(ua))for(const Ra of A)if(Ra.test(ua.characterData))return A=null===(t=Ra.exec(ua.characterData))||void 0===t?void 0:t[0],this.nLn(h,aa?"nextPara":"prevPara",A),!1}return!0}nLn(b,h,t){const A=new Map;A.set("CurrentAutoListPreventedAutoListText",b);A.set("UndoAutoListPreferenceFoundIn",h);A.set("UndoAutoListPreferenceAutoListText",t);wa.Health.instance.recordKpiUsage(Xk.a.Bjb.KRn,
0,Xk.a.dB,A)}ano(b,h){return b&&h}G4i(b){for(let h=0;h<b.count;h++){const t=ue.GraphIterator.$a(b.J(h));t.Yo();this.Oha(t)}b.clear()}lXn(b){hb.ListItemReader.Kh(b)&&this.Pia()}Q0i(b,h){b=new ue.GraphIterator;b.set(h);b.yd();wg.OutlineElementNavigator.Zd(b);b.uhb(h)||zk.a.instance.Zb("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.SRa(b);return b}Kco(b,h,t){this.Hh.$xa(b,h,t,!0)}Sco(b){b.i9(1,1)}yzd(b,h){const t=zk.a.instance.vp(qa.a.Rxk);if(this.uc.WX(h.Ik())){if(hb.ListItemReader.Kh(b)&&
this.SRa(b),h=this.Hp.U7h(h)){t.properties.Z("EarlyReturn","False");this.Hp.u0a(b.currentNode,h);var A=lp.ovl(this,b,h),O=this.createList(b);if(A)this.joinList(O,A,!0);else{if(A=this.ELd(b,h,this.bqj,this.Xwo)){const aa=this.cG(A);if(aa.listID===h.listID&&aa.level<h.level&&this.Ad.Fw(A).Zy){const ua=this.Xma(A.currentNode,aa);aa.wu===(ua.startAt===Xk.a.vl?1:ua.startAt)&&(aa.UIc=aa.wu,this.P6i(O,aa,A.currentNode))}}A=this.Xma(O,h);b=this.KFf(h,b,A);b=b.OQa!==Xk.a.vl?b.OQa+1:A.startAt===Xk.a.vl?1:A.startAt;
Km.a.getInstance().$I||this.Y_b(O,h,null,!0);O.setValue(Rn.a.Gl.eV,b);O.setValue(Rn.a.Gl.$ca,b)}Km.a.getInstance().$I||O.setValue(Lc.a.XX,!0);t.end()}}else zk.a.instance.Zb("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}P6i(b,h,t){this.Hp.lWc(b,h.listID,h.level)&&this.oXn(t,h)}oqh(b,h,t,A,O=null,aa){b=O?this.w5k(b,t,A,O):this.v5k(b,t,A);let ua;Rn.a.Gl.xv?(aa&&aa.currentNode&&(393229==aa.currentNode.Nc?ua=mb.OutlineElementReader.UDa(aa):Jc.b(509367497,393,15,"Expected a OE node to extract para node")),
ua?this.Y_b(h,b,ua):(Jc.b(509386772,393,15,"Encountered a list node but paragraph node is not present"),ii.Debug.b6o(!1,"Encountered a list node but paragraph node is not present",509367496))):this.Y_b(h,b);t.listType||(aa=t.vB,aa===Xk.a.vl&&(aa=1),h.setValue(Rn.a.Gl.eV,aa),h.setValue(Rn.a.Gl.$ca,aa));Rn.a.Gl.xv||(t.gna?(t=t.levelText,O||(t=t.replace("%1","%"+(b.level+1))),h.setValue(Lc.a.Vt,t)):(u.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),
h.setValue(Lc.a.Vt,"")));return b}joinList(b,h,t,A=null){if(b)if(22!==b.type&&63!==b.type)u.ULS.sendTraceTag(587851670,393,15,"Graph node {0} received is not list node : skipping join list action.",b.type);else{var O=this.Hp.v0a(b);this.OIc(O,()=>{this.Y_b(b,h.Ow,O,t);if(this.Hp.u0a(b,h.Ow).Zy){var aa=new ue.GraphIterator;aa.set(b);aa.yd();aa.wc();const ua=this.Kxl(aa,h,A);aa=this.Cxl(aa,b,h,t,A,ua);this.Hxl(h,t,A,ua,aa)}})}else u.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}Kxl(b,
h,t){if(h.gui)h=h.outlineElement;else{let A,O;t?(A=this.cqj,O=this.nie):h.z9b?(A=this.bqj,O=this.nie):(A=this.Wwo,O=this.Ywo);h=this.ELd(b,h.Ow,A,O,t)}!h&&t&&(t=new ue.GraphIterator,t.$c(b),t.UOc()&&hb.ListItemReader.Kh(t)&&(h=t));return h}Cxl(b,h,t,A,O,aa){A?(O?b=O.fjc:(aa=this.Xma(h,t.Ow),t=this.KFf(t.Ow,b,aa),b=t.OQa!==Xk.a.vl?t.OQa+1:aa.startAt===Xk.a.vl?1:aa.startAt),h.setValue(Rn.a.Gl.eV,b),h.setValue(Rn.a.Gl.$ca,b)):(b=Xk.a.vl,this.Ndo(h,aa,t));return b}Hxl(b,h,t,A,O){if(A){var aa=!1,ua=this.cG(A),
Ra=ua.level===b.Ow.level,ub=!!t&&ua.listID===t.TZc;(ua.listID===b.Ow.listID||ub)&&Ra&&(Ra=this.Xma(A.currentNode,ua),ub=Ra.startAt===Xk.a.vl?1:Ra.startAt,ua.wu===ub+1&&(aa=h?O===ub:this.WDm(A,Ra)));if(!aa||t)t?(h=t.delta,O=this.aro,aa=this.bro):(h=1,O=this.jhe,aa=this.Jmj),ua=new ue.GraphIterator,ua.set(A.currentNode),ua.yd(),this.Ad.rM(ua),ua.wc(),this.wYh(A.currentNode,b.Ow,h,O,aa,t)}}Ndo(b,h,t){let A=null;h&&(A=this.cG(h));if(A&&A.listID===t.Ow.listID&&A.level===t.Ow.level){const O=this.Ad.Fw(h),
aa=O.wu;b.setValue(Rn.a.Gl.eV,aa);b.setValue(Rn.a.Gl.$ca,aa);rv.a.SZ&&(O.propertySet.setValue(Lc.a.listID,A.listID),O.propertySet.setValue(Lc.a.listLevel,A.level));if(!t.z9b||t.P3d)t.gui&&!t.P3d&&(this.Ad.rM(h),b=h.currentNode,wg.OutlineElementNavigator.Zd(h)),b.setValue(Rn.a.Gl.$ca,b.getValue(Rn.a.Gl.eV))}else h=t.Ow.wu+1,b.setValue(Rn.a.Gl.eV,h),b.setValue(Rn.a.Gl.$ca,h)}nDc(b,h,{emi:t=!1,eRm:A=-1,Lzl:O=!1,lBl:aa=!1}={}){return h&&16!==h.listType?ue.GraphIterator.v7(()=>{if(!mb.OutlineElementReader.Lh(b))return u.ULS.sendTraceTag(578331469,
393,15,"Iterator not pointing to OE in apply list info word."),cr.Zcc();const ua=mb.OutlineElementReader.UDa(b);return ua&&zc.a(ua,8)?(u.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),cr.Zcc()):jp.a.instance.J(1)&&(null===ua||void 0===ua?0:ua.qa.last.gi)?(u.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),cr.Zcc()):this.OIc(ua,()=>{var Ra=Mo.eh.Ms(b.currentNode);const ub=h.qB,Nb=this.infoAtLevel(b,h);var Yb=b.Tb(4);if(Yb)return b.wc(),
Ra=this.iqh(Nb,Yb,A,ub),Ra.Ow=this.cG(b),Ra;Yb=this.R4k(b);const bc=h.propertySet.ia(Lc.a.listID,-1),Dc=this.DUl(bc,aa),Pc=this.BSl(ua),jd=this.ATl(h,b,Nb,aa,O,t);this.rbo(jd,Nb);ua&&this.fdo(ua);return null==jd||O||Nb.Zy!==this.Ad.u0a(Yb,jd.Ow).Zy?this.Ejl(Nb,Dc,jd,Yb)?(this.ido(Yb,Nb,Dc,Pc,ua),this.iqh(Nb,Yb,-1,ub)):this.Sxk(Yb,Nb,b,Ra,Pc,ub,Dc,bc,ua):(Nb.listStyle||(jd.z9b=!0),this.Txk(Dc,jd,Yb))})}):(h||u.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+h),this.SRa(b))}ATl(b,
h,t,A,O,aa){var ua;O=b.Okb?new lp(this,ue.GraphIterator.$a(b.Okb),!1,!0):lp.nvl(this,h,t,A,O);if(!O)return null;aa?(O.Ow.level=this.NSl(h,t,A),this.nxl(h,O)):O.Ow&&(null===(ua=b.propertySet)||void 0===ua?0:ua.hasProperty(Lc.a.listLevel))&&(O.Ow.level=b.propertySet.getValue(Lc.a.listLevel));return O}DUl(b,h){return rv.a.SZ&&h&&0<b&&b+""in this.GVf?this.GVf[b+""]:-1}ido(b,h,t,A,O){var aa;Km.a.getInstance().$I||this.gy.Dya(b,t);Km.a.getInstance().xv&&this.gy.Dya(O,t);b.properties.hasProperty(Lc.a.listLevel)||
(t=(null===(aa=h.propertySet)||void 0===aa?0:aa.hasProperty(Lc.a.listLevel))?h.propertySet.Lf(Lc.a.listLevel):this.UVc(A),Km.a.getInstance().$I||this.gy.g7a(b,t),Km.a.getInstance().xv&&this.gy.g7a(O,t),h.propertySet&&h.gna&&!Rn.a.Gl.xv&&(h=h.levelText.replace("%1","%"+(t+1)),b.setValue(Lc.a.Vt,h)))}iqh(b,h,t,A){b=this.uNk(h,b,t,A);return cr.BRm(b)}Txk(b,h,t){let A=null;rv.a.SZ&&0<b&&(A=new Sg(0,h.Ow,-1),A.TZc=b,A.delta=-1);this.joinList(t,h,!1,A);return cr.RRm(h.Ow)}Sxk(b,h,t,A,O,aa,ua,Ra,ub){const Nb=
mb.OutlineElementReader.k3(t);0<Nb&&(O+=Nb);h=this.oqh(A,b,h,O,aa,t);this.ePo(ua,Ra,h,b,ub);return cr.DRm(h)}SRa(b,{w4i:h=!1}={}){return ue.GraphIterator.v7(()=>{if(!mb.OutlineElementReader.Lh(b))return u.ULS.sendTraceTag(509678220,393,15,"Iterator not pointing to OE in remove list info word."),cr.Zcc();const t=mb.OutlineElementReader.UDa(b);if(jp.a.instance.J(1)&&(null===t||void 0===t?0:t.qa.last.gi))return u.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),
cr.Zcc();const A=b.Tb(4);return A?t?this.OIc(t,()=>{var O;this.F4i(t);this.tTn(t);t.aT=null;this.Ad.wXd(A.ia(Lc.a.listID,0))?(A.F6c=!1,b.Dg(),Km.a.getInstance().xv&&this.gy.Oha(t)):b.wc();h||this.iao(b);b.Tb(4)&&(A.F6c=!1,b.Dg(),Km.a.getInstance().xv&&this.gy.Oha(t));(this.Wd.Cg&&!this.dOb||!this.Wd.Cg&&t.Vi)&&(!t.Vi||(null===(O=t.GC)||void 0===O?0:O.hasProperty(Lc.a.listID)))&&this.x7k(b);return cr.QBi()}):(u.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),
A.F6c=!1,b.Dg(),cr.QBi()):cr.Zcc()})}iao(b){const h=Mo.eh.Ms(b.currentNode),t=mb.OutlineElementReader.PDa(b),A=mb.OutlineElementReader.aG(b),O=mb.OutlineElementReader.k3(b);this.TId(h);this.Hh.$xa(b,1,Math.max(0,t+(O||-1*A)-this.bqc[0]))}OIc(b,h){let t=null;jp.a.instance.J(1)&&b&&(t=b.qD());h=h();jp.a.instance.J(1)&&!this.dOb&&(b&&t&&this.iq.NU(b,t,this.Wd.Cg),this.Pia());return h}R4k(b){b.Tb(31)&&b.Dg();return this.createList(b)}tTn(b){b.hasProperty(Lc.a.ee)&&b.removeProperty(Lc.a.ee);b.hasProperty(Lc.a.GD)&&
b.removeProperty(Lc.a.GD);b.hasProperty(Lc.a.qt)&&b.removeProperty(Lc.a.qt)}infoAtLevel(b,h){if(!h)return null;const t=h.qB;if(1===h.Gr){if(h.Wna&&!h.bJ||!h.O4e(!1))return h;b=mb.OutlineElementReader.PDa(b);const A=this.UVc(b),O=t.THb[A];b=kq.a.j7(h.propertySet,h.propertySet);6===O?b.i9(1,1):b.i9(0,O);b.$ee("multilevel");b.levelText=t.WVc[A];t.zDa&&t.zDa[A]&&(b.font=t.zDa[A]);b.Xv=t.FZd[A];b.U4=t.U4;b.u_d=h.u_d}else b=h;return b}rbo(b,h){null!==b&&void 0!==b&&b.Ow&&(h.levelText=b.Ow.levelText,h.Zy||
(h.font=b.Ow.font))}NSl(b,h,t){let A=mb.OutlineElementReader.PDa(b);const O=mb.OutlineElementReader.k3(b);0<O?A+=O:(b=mb.OutlineElementReader.aG(b),0<b&&(A-=b));h=h.propertySet.ia(Lc.a.listLevel,-1);return t&&0<=h?h:this.UVc(A)}nxl(b,h){if(!this.Hp.u0a(b.currentNode,h.Ow).listType){const t=this.Xma(b.currentNode,h.Ow);b=this.KFf(h.Ow,b,t);h.Ow.UIc=h.Ow.wu=b.OQa===Xk.a.vl?t.startAt-1:b.OQa;h.z9b=b.JDj}}ePo(b,h,t,A,O){rv.a.SZ&&(0>=b?this.GVf[h+""]=t.listID:(Km.a.getInstance().$I||this.gy.Dya(A,b),Km.a.getInstance().xv&&
this.gy.Dya(O,b),t.listID=b))}Ejl(b,h,t,A){if(!rv.a.SZ||0>=h)return!1;const O=(aa,ua)=>v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixIncorrectListFormatComparison",!1)?aa.length!==ua.length||aa.some((Ra,ub)=>Ra!==ua[ub]):aa!==ua;if(t)return h=this.Ad.u0a(A,t.Ow),b.Zy!==h.Zy||O(b.Mga,h.Mga);t=b.propertySet.ia(Lc.a.listLevel,-1);return 0<=t&&(h=this.Hp.px(A,h,t))&&(h=h.ia(Af.a.Q3,null))&&b.Mga?O(h,b.Mga):!1}sTn(b,h){const t=!!h&&qe.ParagraphReader.Yb(h);let A=0,O=0;
t&&(A=this.Po.zT(b.currentNode).wt,O=this.Po.aG(h).wt);t&&this.F4i(h);b.Dg();t&&this.Hh.$xa(b,1,A-O)}oaa(b,h,t,A=-1,O=!1,aa=null,ua=!1){u.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const Ra=zk.a.instance.vp(qa.a.oaa),ub=this.Ic.Qc(15);ub.Fu(b);let Nb=null,Yb=0;({WNm:Nb,kcn:Yb,returnValue:A}=this.Pvl(b,h,A,Nb,Yb,O,aa));if(!Nb||ua&&(1===t||0>t-Nb.Ow.wu||2<t-Nb.Ow.wu))return ub.dispose(),Ra.end(),!1;for(;0<Yb;)b.UOc(),Yb--;this.aPo(b,h,A,Nb);ub.dispose();
Ra.end();return!0}aPo(b,h,t,A){for(;b.UOc();)if(b.Tb(4)){const O=this.RDa(b.currentNode);if(O.listID===h.listID){h=new Sg(0,h,t);Km.a.getInstance().xv?this.joinList(b.currentNode,A,O.XX,h):this.joinList(b.currentNode,A,!0,h);break}b.wc()}}Pvl(b,h,t,A,O,aa=!1,ua=null){for(var Ra;b.BRd();){if(b.Xr(4)){const ub=this.cG(b),Nb=this.Ad.Fw(b);if(Nb.listType!==ua.listType){O++;continue}if(aa&&Nb.listStyle!==ua.listStyle||!aa&&h.level<ub.level){O++;continue}-1===t&&(t=ub.wu+1);A=null;if(h.level===ub.level||
aa)null===(Ra=this.g7c)||void 0===Ra?void 0:Ra.$wf(b),A=new lp(this,b,!1,!1);aa&&ub.level!==h.level&&b.Xr(4)&&(b.Tb(4).setValue(Lc.a.listLevel,ub.level),b.wc());break}O++}return{returnValue:t,WNm:A,kcn:O}}TOd(b){let h=0;var t=0;jp.a.instance.J(1)&&(t=this.Ad.hO(b,!1,!0),h=t.listId,t=t.listLevel);return this.Ad.px(b,h,t)}startNewList(b,h,t){u.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var A=zk.a.instance.vp(qa.a.startNewList),O=this.Ic.Qc(15);O.Fu(b);
var aa=kq.a.dT(0,h.listStyle,null,0,h.propertySet.ia(Lc.a.listLevel,-1));b.Tb(4);var ua=b.currentNode.ia(Lc.a.listID,0),Ra=b.currentNode.ia(Lc.a.listLevel,-1);b.wc();aa.u_d=ua;var ub=h.propertySet.ia(Lc.a.ee,0);0<ub&&aa.propertySet.setValue(Lc.a.ee,ub);-1===aa.propertySet.ia(Lc.a.listLevel,-1)&&aa.propertySet.setValue(Lc.a.listLevel,Ra);1===h.Gr&&((Ra=new gz.a,ua=h.Qei(b.currentNode,ua),ua)?1===ua&&(aa.$ee(kt.a.Mcc),aa.qB=Ra.Q9e(Ra.ePf,Ra.fPf),aa.U4=aa.qB.U4):(aa.$ee(kt.a.Mcc),aa.qB=Ra.Y8e(),aa.U4=
aa.qB.U4));h.Rma()&&1>t&&(t=1);aa.vB=t;ua=new ji.DictionaryPropertySet;ua=this.OJc(qa.a.bL,ua);Ra=b.Tb(2);b.wc();b.Tb(4);h=this.RDa(b.currentNode);if(ub=this.TOd(b.currentNode))aa.levelText=ub.ia(Lc.a.Vt,""),aa.bJ=42,aa.Xv=ub.ia(Lc.a.yba,"left");this.sTn(b,Ra);({Mva:aa}=this.cla(ua,b,aa,!0));b.Tb(4);22!==b.currentNode.type&&63!==b.currentNode.type&&u.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);Km.a.getInstance().$I||this.gy.g7a(b.currentNode,h.level);Km.a.getInstance().xv&&
this.gy.g7a(Ra,h.level);b.wc();aa=new lp(this,b,!1,!1);this.Ad.rM(b);t=new Sg(1,h,t);Km.a.getInstance().xv?this.joinList(b.currentNode,aa,!1,t):this.joinList(b.currentNode,aa,!0,t);O.dispose();A.end()}else u.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}CCf(b){if(!b)return!1;const h=b.Tb(2);h&&b.wc();return jp.a.instance.J(1)&&h&&12===h.type&&h.qa&&h.qa.last&&h.qa.last.gi?!0:!1}n8d(b,h,t,A){return this.$3j.n8d(b,h,t,A)}P5f(b,h){if(!b||!h)return!1;const t=b.propertySet.ia(Lc.a.Vt,
null);h=h.propertySet.ia(Lc.a.Vt,null);if(!t||!h)return!1;const A=b.propertySet.ia(Af.a.font,null);b=b.propertySet.ia(Af.a.font,null);return t===h&&A===b}ygj(b,h,t){t||h.listType||(h.vB=b.ia(Af.a.C_,Xk.a.vl))}M7h(b,h){if(!h)return null;const t=Array(9),A=h.u_d;if(!this.pFm(h,b)||1>A)return null;for(h=0;9>h;h++){const O=this.Ad.px(b,A,h);if(null===O||void 0===O?0:O.hasProperty(Lc.a.ee))t[h]=O.getValue(Lc.a.ee);else return null}return t}pFm(b,h){if(!b)return!1;const t=b.propertySet.ia(Lc.a.listLevel,
-1);b=b.propertySet.ia(Lc.a.ee,-1);if(0>t||0>b)return!1;this.TId(h);return b!==this.LSb[t]?!0:!1}alh(b,h,t){b&&b.setValue(Lc.a.ee,h?h[t]:this.LSb&&t<this.LSb.length?this.LSb[t]:720*(t+1))}wYh(b,h,t,A,O,aa=null,ua=!1){const Ra=new ue.GraphIterator,ub=this.Xma(b,h);Ra.set(b);Ra.yd();b=Cr.a.at(Ra,Ra.SPb());b.Sn(vu.a.mWc,null);let Nb=-1;for(;b.moveNext();){if(!hb.ListItemReader.Kh(Ra))continue;this.Ad.rM(Ra);const Yb=Ra.currentNode,bc=this.RDa(Yb);Ra.wc();if(A!==this.jhe||bc.listID===h.listID){if(ua){if(-1!==
Nb&&Nb>bc.level)break;if(-1===Nb)Nb=bc.level;else if(bc.level!==Nb)continue}else{if(bc.level<=ub.eSa)break;if(!A(h,bc,aa))continue}O(Yb,t,h.listID,aa)}}}Czl(b,h,t,A,O){const aa=new ue.GraphIterator,ua=this.Xma(b,h);aa.set(b);aa.yd();if(hb.ListItemReader.Kh(aa)){this.Ad.rM(aa);b=aa.currentNode;var Ra=this.RDa(b);aa.wc();Ra.level<=ua.eSa||A(h,Ra,null)&&O(b,t,h.listID,null)}}Bzl(b,h,t,A,O=null){const aa=new ue.GraphIterator;aa.$c(b);A(b,h,this.cG(aa),aa,0);this.ELd(b,h,t,A,O)}ELd(b,h,t,A,O=null){let aa=
new ue.GraphIterator;const ua=this.Xma(b.currentNode,h);let Ra=null,ub=0;var Nb=new ue.GraphIterator;Nb.$c(b);Nb.Ab(10);const Yb=Qd.a.at(Nb,Nb.origin);for(Yb.moveNext();Yb.moveNext();)if(Ra=null,aa=Yb.iterator,1===aa.role&&(Ra=Yb.currentNode,aa.Xr(4)&&(Nb=this.cG(aa),t(h,Nb,O))))if(Nb.level>h.level)A(b,h,Nb,aa,ub),ub++;else if(Nb.level===h.level||Nb.level<=ua.eSa)break;return Ra?aa:null}u0i(b,h,t,A,O){b=this.Xma(b.currentNode,t);b.eSa>=h.level&&this.xyh(A,b.startAt+O)}static get EIm(){null==Mo.hrd&&
(v.AFrameworkApplication.K?(v.AFrameworkApplication.ye("i75ig452;a229j208"),Mo.hrd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveRedundantRenumberingForListActions",!1)):Mo.hrd=!1);return Mo.hrd}static get eh(){return fm.PageNavigator.instance}static Ifj(b,h){h.setValue(Af.a.font,b.Wna||b.URc||b.xPc?b.font:"Symbol")}static Kfj(b,h){b=b.Wna||b.URc||b.gna?b.levelText:Xk.a.zGd;u.ULS.shipAssertTag(22127637,338,!!b);h.setValue(Lc.a.Vt,b)}static Jfj(b,h){b=b.propertySet.ia(Lc.a.yba,
"left");h.setValue(Lc.a.yba,b)}static Qvm(b){b=b.iterator.parentNode;const h=ue.GraphIterator.$a(b);b&&mb.OutlineElementReader.wCf(h,null)&&b.Wk(8,!0)}}Mo.C5m=2147450879;Mo.hIi=1;Mo.hrd=null;Object(m.a)(Mo,"FlatListEditorCssVersion",Rn.a,[398,399]);class jx{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc){this.Hp=b;this.ern=h;this.vg=t;this.Is=A;this.sA=O;this.xRm=aa;this.Kd=ua;this.lj=Ra;this.JRm=ub;this.Xb=Nb;this.uc=Yb;this.EG=bc;this.gy=Dc}create(){return new Mo(this.Hp,this.ern,this.vg,this.Is,
this.sA,this.xRm,this.Kd,this.lj,this.JRm,this.Xb,this.uc,this.EG,this.gy)}}Object(m.a)(jx,"FlatListEditorFactory",null,[]);class kx{constructor(){this.startAt=this.listLevel=this.listId=0;this.Okb=null}}Object(m.a)(kx,"ListAutoCorrectionRefInfo",null,[]);class kA{get tNm(){if(null!=this.Xzg)var b=this.Xzg;else{var h;b=this.Xzg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isZeroSupportedForListAutocorrect",!1)}return b}constructor(b,
h){this.A3j=b;this.If=h}n8d(b,h,t,A){if(!b.hasProperty(Gd.a.c3a))return!0;h=ue.GraphIterator.$a(h.currentNode);nf.SelectionEditor.au(h);let O=!0;if(!t.listType&&!A){23===h.Xe&&h.ME(1);A=b.ia(Gd.a.c3a,1);if(this.tNm?1<A:1!==A){var aa=new ue.GraphIterator;aa.$c(h);aa.Ab(10);aa=Qd.a.So(aa.origin);A=this.Ovl(aa,A,t,h.currentNode);t.Okb||(O=!1)}b.setValue(Gd.a.c3a,A)}return O}Ovl(b,h,t,A){const O=new Mb.a;for(;b.moveNext()&&b.iterator.currentNode!==A;){const aa=b.iterator;if(!aa.Xr(4))continue;const ua=
this.A3j.value.cG(aa),Ra=this.If.Fw(aa);this.YDn(O,ua);Ra.listType===t.listType&&Ra.listStyle===t.listStyle&&(0>h-ua.wu||2<h-ua.wu||O.add(Object.assign(new kx,{listId:ua.listID,listLevel:ua.level,Okb:aa.currentNode,startAt:ua.wu+1})))}0<O.count&&(h=O.J(O.count-1).startAt,t.Okb=O.J(O.count-1).Okb);return h}YDn(b,h){let t=0;for(;t<b.count;){const A=b.J(t);A.listId===h.listID&&A.listLevel>=h.level?b.removeAt(t):t++}}}Object(m.a)(kA,"ListAutoCorrector",null,[363]);class lA{constructor(b,h,t,A,O){this.m6a=
(aa,ua,Ra)=>{var ub;aa=this.dHc(ua);if(!aa||this.Gs.CCf(aa))return 8;ua=this.Gs.cG(aa);if(1===ua.wu||this.eTc(ua.level))return 8;ua=null===(ub=this.Ad)||void 0===ub?void 0:ub.Fw(aa);if(!ua||this.tui(ua))return 8;if(1===Ra)return 32;this.Gs.startNewList(aa,ua,1);return 32};this.l6a=(aa,ua,Ra)=>{aa=this.dHc(ua);if(!aa||this.Gs.CCf(aa))return 8;ua=this.Gs.cG(aa);if(this.eTc(ua.level))return 8;const ub=this.Ad.Fw(aa);if(!ub||this.tui(ub))return 8;if(1===Ra)return 32;this.mIc.oXl(aa.currentNode,ua.wu,
this.Ad,this.Gs,this.jTa);return 32};this.oaa=(aa,ua,Ra)=>{aa=this.dHc(ua);if(!aa||this.Gs.CCf(aa))return 8;ua=this.Gs.cG(aa);if(1!==ua.wu||this.eTc(ua.level))return 8;if(1===Ra)return 32;Ra=this.Ad.Fw(aa);return this.Gs.oaa(aa,ua,Ra.vB,-1,!1,Ra)?32:8};this.eob=(aa,ua,Ra,ub,Nb)=>{aa=this.dHc(ua);if(!aa)return 8;ua=this.Gs.cG(aa);if(this.eTc(ua.level))return 8;if(1===Ra)return 32;Ra=this.Ad.Fw(aa);this.Gs.startNewList(aa,Ra,Nb);return 32};this.keb=(aa,ua,Ra,ub,Nb)=>{aa=this.dHc(ua);if(!aa)return 8;
ua=this.Gs.cG(aa);return this.eTc(ua.level)?8:1===Ra?32:this.Gs.oaa(aa,ua,ua.wu,Nb)?32:8};this.rc=b;this.Ad=t;this.Gs=A;this.mIc=O}eTc(b){return 0>b}Ub(){this.rc.pa(qa.a.m6a,mc.a.outlineElement,this.m6a);this.rc.pa(qa.a.m6a,mc.a.Vc,this.m6a);this.rc.pa(qa.a.m6a,mc.a.view,this.m6a);this.rc.Uc(qa.a.m6a,12);this.rc.pa(qa.a.l6a,mc.a.outlineElement,this.l6a);this.rc.pa(qa.a.l6a,mc.a.Vc,this.l6a);this.rc.pa(qa.a.l6a,mc.a.view,this.l6a);this.rc.Uc(qa.a.l6a,12);this.rc.pa(qa.a.oaa,mc.a.outlineElement,this.oaa);
this.rc.pa(qa.a.oaa,mc.a.Vc,this.oaa);this.rc.pa(qa.a.oaa,mc.a.view,this.oaa);this.rc.Uc(qa.a.oaa,12);this.rc.pa(qa.a.eob,mc.a.outlineElement,this.eob);this.rc.pa(qa.a.eob,mc.a.Vc,this.eob);this.rc.pa(qa.a.eob,mc.a.view,this.eob);this.rc.Uc(qa.a.eob,12);this.rc.pa(qa.a.keb,mc.a.outlineElement,this.keb);this.rc.pa(qa.a.keb,mc.a.Vc,this.keb);this.rc.pa(qa.a.keb,mc.a.view,this.keb);this.rc.Uc(qa.a.keb,12)}get jTa(){return Sa.a.instance.resolve("Common.IStandaloneRootController").zca}dHc(b){return this.Gs.KUl(b)}tui(b){return 1===
(null===b||void 0===b?void 0:b.listType)}}Object(m.a)(lA,"ListContextMenuSectionActor",null,[]);var im=c(605);class Kt{static get HRm(){return Pf.a.Xz(Kt.Hm,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}Kt.Hm="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(Kt,"ListSetStartValueDialogHtml",null,[]);class os extends Pf.a{constructor(b,h,t,A,O){super();this.yod=this.Bue=this.Rod=this.YQe=null;this.vwe=!0;this.YR=!1;this.xab=0;this.Qnj=[qa.a.S8f,qa.a.Acg,qa.a.QZf];this.hgo=(aa,ua)=>{aa=ua[Ue.a.Number];this.S9=Number.isInteger(ua[Ue.a.Number])&&aa>=this.xab?aa:this.xab};this.d6l=(aa,ua)=>{this.S9=this.S9>=this.xab?this.S9:this.xab;ua[Ue.a.Number]=this.S9;ua[Ue.a.UnitType]=0};this.jdo=(aa,ua)=>{if(1===aa){var Ra=ua.ListRadioStartNew,ub=ua.ListRadioContinue,
Nb=ue.GraphIterator.$a(this.Te);Nb.yd();ua=this.Gs.cG(Nb);aa=this.If.Fw(Nb);if(Ra)this.Gs.startNewList(Nb,aa,this.S9);else if(ub)if(this.vwe)this.Gs.oaa(Nb,ua,this.rKe,-1,!1,aa);else{Ra=!0;for(ub=null;Nb.QI();)if(Nb.Xr(4)){ub=new lp(this.Gs,Nb,!1,!1);break}if(!ub||this.Gs.cG(Nb).wu>=this.S9)Ra=!1;Ra?(Nb=ue.GraphIterator.$a(this.Te),Nb.yd(),this.Gs.oaa(Nb,ua,this.rKe,this.S9,!1,aa)):(this.dispose(),this.aHa(CommonUIStrings.l_ErrorDialogMessage,this.GRm))}}};this.GRm=()=>{new os(this.Te,this.rKe,this.If,
this.Gs,this.Ed)};this.Enn=()=>{document.getElementById(os.RBi).style.visibility="visible"};this.ngn=()=>{document.getElementById(os.RBi).style.visibility="hidden"};this.sg="ListSetStartValueDialog";this.Wg=Kt.HRm;this.Te=b;this.S9=h;this.If=t;this.rKe=h;this.K5=A;h=new ue.GraphIterator;b?(h.set(b),h.yd(),mb.OutlineElementReader.Lh(h)||wg.OutlineElementNavigator.Zd(h),hb.ListItemReader.Kh(h)&&(h.Tb(4),b=h.currentNode,22===b.type&&(this.If.BT(b).Rma()?this.xab=1:this.xab=0))):this.xab=1;this.Ed=O;
this.Yh(Box4Intl.Box4Strings.l_SetNumberingValueList,this.jdo,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.vwe&&(this.YQe=document.getElementById("ListRadioStartNew"),this.Rod=this.Enn,this.Bue=document.getElementById("ListRadioContinue"),this.yod=this.ngn,Hf.a.addHandler(this.YQe,"click",this.Rod),Hf.a.addHandler(this.Bue,"click",this.yod));for(const aa of this.Qnj)Object(im.a)(aa,this.hgo,this.d6l);this.Ed.qm()}get Gs(){return this.K5}dispose(){if(!this.YR){for(const b of this.Qnj)Object(im.b)(b);
this.vwe&&(this.Rod&&Hf.a.removeHandler(this.YQe,"click",this.Rod),this.yod&&Hf.a.removeHandler(this.Bue,"click",this.yod));this.Ed.kY("ListStartSpinner");super.dispose();this.YR=!0}}LGk(){const b=Sk.l("none",this.xab+"","100","1");return Sk.j(os.SBi,qa.a.S8f,qa.a.QZf,Box4Intl.Box4Strings.l_SetValueTo,[b],null,qa.a.Acg)}Dyb(b){const h=document.getElementById(os.SBi);this.Ed.fYa("ListStartSpinner",b);b=this.Ed.ZCb("ListStartSpinner","Medium");h.appendChild(b)}E8(){const b=this.LGk();this.Dyb(b)}}os.SBi=
"SetListStartSpinnerContainer";os.RBi="ListStartAtSpinnerBox";Object(m.a)(os,"ListSetStartValueDialog",Pf.a,[]);class Tx{oXl(b,h,t,A,O){new os(b,h,t,A,O)}static get instance(){return Tx._instance||(Tx._instance=new Tx)}}Tx._instance=null;Object(m.a)(Tx,"ListDialogFactory",null,[140]);class mA{constructor(b,h,t){this.K5=b;this.If=h;this.Ic=t}$wf(b){u.ULS.shipAssertTag(40420184,393,mb.OutlineElementReader.Lh(b));const h=b.Tb(4);b.wc();if(h){const t=this.If.BT(h);t.Gr||this.Lom(b,h,t)}}DPk(b){for(let h=
0;h<b.length;h++){const t=new ue.GraphIterator;t.set(b.getContext(h).node);this.$wf(t)}}Lom(b,h,t){const A=fm.PageNavigator.instance.Ms(h),O=this.K5.RDa(h),aa=this.Ic.Qc(15);aa.Fu(b);b=this.K5.oqh(A,h,t,0,null,b);this.K5.jXn(h,O.listID);aa.dispose();this.If.u0a(h,b)}}Object(m.a)(mA,"SingleLevelListEditor",null,[139]);var Ux=c(339);class sv extends dp{constructor(b){super();sv.ytc=b}xYi(b,h,t,A,O,aa){if(!b||!b.length)return 8;let ua;const Ra=({mdm:b,ldm:ua}=sv.Xp.jdm(b)).returnValue;let ub=1;for(const Yb of Ra.keys){var Nb=
b.contains(Yb);const bc=Ra.J(Yb);sv.Xp.QLk(Ra.J(Yb),this.XEc(h),Nb)?Nb?(u.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.XEc(h)?"Promote":"Demote"),Nb=v.AFrameworkApplication.xa.Nf(Ux.a.HCa(bc),h,t,A,O,aa)):(u.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.XEc(h)?"Promote":"Demote"),Nb=sv.Xp.drn(Ra.J(Yb),this.XEc(h),ua.J(Yb))):(u.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",
this.XEc(h)?"Promote":"Demote"),Nb=8);ub=Kf.ActionManager.yXc(ub,Nb)}return ub}XEc(b){return b===qa.a.pG?!0:!1}static get Xp(){return sv.ytc||(sv.ytc=Sa.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}sv.ytc=null;Object(m.a)(sv,"WordEditorListContextManager",dp,[]);class Ru{get name(){return"WordEditor.ListEditors"}yc(b){v.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ha("WordEditor.ListEditors.IListAutoCorrector",()=>new kA(b.We("WordEditor.IFlatListEditor"),
b.resolve("Box4.List.IListReader"))).singleInstance(),b.ha("WordEditor.IFlatListEditor",()=>(new jx(b.resolve("WordEditor.List.IFlatListReader"),b.We("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new vo.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.List.IListFormattingEditor"),
b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.List.ListItemEditor"))).create()).singleInstance(),b.ha("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).singleInstance(),b.ha("Box4.List.ISingleLevelListEditor",()=>new mA(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance(),b.ha("Box4.ListEditors.WordEditorListContextManager",
()=>new sv(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new lA(v.AFrameworkApplication.xa,new ok.a,Ru.Ad,Ru.Gs,Tx.instance)).Ub();const b=v.AFrameworkApplication.xa;b.gb(qa.a.QZf,mc.a.view,im.d,96);b.gb(qa.a.Acg,mc.a.view,im.c,96);b.gb(qa.a.S8f,mc.a.view,im.c,96)}dispose(){}static get Ad(){return null!=Ru.AAg?Ru.AAg:Ru.AAg=Sa.a.instance.resolve("Box4.List.IListReader")}static get Gs(){return null!=Ru.dwg?Ru.dwg:
Ru.dwg=Sa.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){P.a.instance.Gc(new Ru)}}Object(m.a)(Ru,"WordEditorListEditorsPackage",null,[1,2]);var wB=c(1676),Sv=c(532),Rl=c(66),lx=c(2E3);class tv extends cc.a{constructor(b,h,t,A,O,aa){super(b,h);this.styleId=null;this.Zh=0;this.eQa=null;this.characterData=t;this.paragraphNode=A;this.listMarker=O;this.R7=aa}}Object(m.a)(tv,"HeadingText",cc.a,[]);var Ws=c(376);class Vx{constructor(b,h,t,A,O,aa,ua){this.$Vg=!0;this.f2g=0;this.Hgh=8;this.rha=
null;this.Ujm=Ra=>{if(Ra.Dr)return!0;Ra=Ra.role;return 1===Ra||2===Ra||4===Ra};this.u3j=b;this.UB=h;this.ve=t;this.If=A;this.rF=O;this.l5=aa;this.GGe=ua}get my(){return this.u3j.value}get Twf(){return this.$Vg}set Twf(b){this.$Vg=b}get jIb(){return this.f2g}set jIb(b){this.f2g=b}get NPb(){return this.Hgh}set NPb(b){this.Hgh=b}lRl(){return Object(Rl.__awaiter)(this,void 0,void 0,function*(){var b=this.GGe.value;if(!isNullOrUndefined(b)&&b.$y)return b=yield this.NZl(),this.vXf(b,!0);b=this.rha;return isNullOrUndefined(b)?
null:Promise.resolve(this.vXf(b,!0))})}mRl(){return this.vXf([],!1)}vXf(b,h){const t=window.performance.now(),A=this.T5h();if(!A)return null;const O=new Mb.a;let aa=0;for(;A.moveNext();){var ua=A.iterator;if(11===ua.Xe){const Ra=this.If.xNc(ua),ub=wg.OutlineElementNavigator.Fe(ua,!0);h&&b[aa]&&b[aa].ParaId===qe.ParagraphReader.rQ(ub)&&aa++;wg.OutlineElementNavigator.Zd(ua);if(!ub||!qe.ParagraphReader.Yb(ub)||ub.jr||""===ub.characterData||"\ufffc"===ub.characterData)continue;const Nb=this.eOd(ub);
Nb&&(Ra&&(Nb.listMarker=this.rF.bkb(Ra,!1).u8,ua=this.If.Fw(ua),1===ua.listType&&ua.xPc&&(Nb.eQa=ua.font)),h&&(b[aa-1]&&b[aa-1].ParaId===qe.ParagraphReader.rQ(ub)?Nb.Zh=aa:Nb.Zh=aa+1),O.add(Nb))}}u.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-t));return O}NZl(){const b=new xm.a;var h=lx.a.maa(v.AFrameworkApplication.rootQuerySignature,null);const t=new Mk.a;t.Jr=h;t.status=1;this.W7j=window.performance.now();h=this.l5.Ifa(0,()=>
{if(2!=t.statusCode||null==t.Ij||0==t.Ij.length||null==t.Ij[0]){const A=String.format("GetPageEndsOperation Failed with status code: {0};",t.statusCode);b.setException(Error.create(A));u.ULS.sendTraceTag(543802465,3019,10,A)}else b.xg(t.Ij[0].PageEnds),u.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.W7j))});h.pI(t);h.jT();return xf.b(b.task)}iRl(){const b=this.T5h();if(!b)return-1;let h=0;for(;b.moveNext();){const t=b.iterator;
if(11===t.Xe){const A=wg.OutlineElementNavigator.Fe(t,!0);wg.OutlineElementNavigator.Zd(t);A&&qe.ParagraphReader.Yb(A)&&!A.jr&&""!==A.characterData&&"\ufffc"!==A.characterData&&this.eOd(A)&&h++}}return h}T5h(){if(!this.my)return u.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),null;var b=this.UB.HT(this.my);if(!b)return u.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=ue.GraphIterator.$a(b);if(!b.Yo())return u.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),
null;b=Qd.a.at(b,b.origin);b.Sn(this.Ujm,null);return b}eOd(b){var h;return null!==(h=this.bbm(b))&&void 0!==h?h:this.e_l(b)}bbm(b){if(!pi.a.Oj)return this.cbm(b);if(!this.dNm(b))return null;var h=Object(Ws.c)(9);h=Object(Ws.a)(h);h=[...qe.ParagraphReader.Dhf(b,h)];if(0===h.length)return null;const t=qe.ParagraphReader.Sma(b)+1;return this.SDh(b,h,t)}e_l(b){var h,t,A,O;if(!pi.a.Oj)return this.fRl(b);var aa=Object(Ws.c)(9);aa=Object(Ws.a)(aa);const ua=qe.ParagraphReader.fOc(b),Ra=this.ve.qC(b),{Wjm:ub,
Wwl:Nb}=this.t7l(ua,Ra,aa);aa=null!==(O=null!==(t=null===(h=Nb.linkedStyle)||void 0===h?void 0:h.R7)&&void 0!==t?t:null===(A=Nb.Qv)||void 0===A?void 0:A.R7)&&void 0!==O?O:10;return this.xGb(aa-1)?this.SDh(b,ub,aa):null}SDh(b,h,t){var A;if(!this.xGb(t-1))return null;const {ovj:O,nvj:aa}=this.hGo(b,h);return 0===O.length?null:(h=null===(A=qe.ParagraphReader.WQd(b,O))||void 0===A?void 0:A.trim())&&""!=h?new tv(aa.rd,aa.endCp,h,b,null,t):null}t7l(b,h,t){const A=[];let O={linkedStyle:null,Qv:null},aa=
null,ua=null;for(const Ra of b)if(aa=Ra.chp.formatting?this.hRl(h,Ra.chp):aa,b=t(Ra)){if(!ua&&b){ua=aa;if(!ua)break;O=aa}else if(!this.vDm(aa,ua))break;A.push(Ra)}return{Wjm:A,Wwl:O}}hGo(b,h){var t;let A=-1,O;for(O=0;O<h.length;O++){var aa=h[O],ua=b.characterData.substring(aa.chp.cp,aa.cpEnd),Ra=null===ua||void 0===ua?void 0:ua.trimStart();if(Ra){A=aa.chp.cp+(ua.length-Ra.length);break}}if(-1===A)return{ovj:[],nvj:{rd:-1,endCp:-1}};aa=-1;for(ua=h.length;0<ua;ua--){Ra=h[ua-1];const ub=b.characterData.substring(Ra.chp.cp,
Ra.cpEnd),Nb=null===ub||void 0===ub?void 0:ub.trimEnd();if(Nb){aa=Ra.cpEnd-(ub.length-Nb.length);break}}return{ovj:null!==(t=h.slice(O,ua))&&void 0!==t?t:[],nvj:{rd:A,endCp:aa}}}vDm(b,h){return null==b&&null==h&&b===h?!0:null==b||null==h?!1:h.linkedStyle&&b.linkedStyle&&h.linkedStyle.R7===b.linkedStyle.R7||h.Qv&&b.Qv&&h.Qv.Myh==b.Qv.Myh?!0:!1}hRl(b,h){h=Wa.FormattingReader.bna(h.formatting);b=this.kRl(b,h);h=this.gRl(h);return b||h?{linkedStyle:b,Qv:h}:null}kRl(b,h){b=this.ve.iva(h,b);if(!b)return null;
h=b.ia(Lc.a.Zi,9);return this.A6c(h)?{Vap:b.id,R7:h+1}:null}gRl(b){var h;b=this.ve.jg(b);if(!b||!ck.a.nZd(b))return null;const t=null!==(h=ck.a.B6b(b))&&void 0!==h?h:"0";h=Number.parseInvariant(t);return this.xGb(h-1)?{Myh:b,R7:h}:null}cbm(b){const h=qe.ParagraphReader.Sma(b);if(this.A6c(h))return new tv(0,b.characterData.length,b.characterData,b,null,h+1);if(this.xGb(h)){var t=this.ve.Uo(b);t=this.ve.jg(t);if(ck.a.iHb(t))return new tv(0,b.characterData.length,b.characterData,b,null,h+1)}return null}fRl(b){var h;
let t=h=null,A=-1;var O=-1,aa=this.ve.qC(b);for(let Ra=0;Ra<b.qa.length;Ra++)if(h=b.qa.J(Ra),h.formatting){var ua=Wa.FormattingReader.bna(h.formatting);const ub=this.ve.jg(ua);if(!t&&(t=ub,O=(O=ck.a.B6b(t))?Number.parseInvariant(O):0,!this.xGb(O-1)))break;ua=(ua=this.ve.iva(ua,aa))?ua.ia(Lc.a.Zi,9):9;A=-1===A?ua:A;if(!(this.A6c(ua)&&A===ua||ck.a.nZd(ub)&&t===ub))break}h=h.cp;aa=b.characterData.substring(0,h);return this.A6c(A)?new tv(0,h,aa,b,null,A+1):ck.a.nZd(t)?new tv(0,h,aa,b,null,O):null}dNm(b){const h=
qe.ParagraphReader.Sma(b);if(!this.xGb(h))return!1;if(this.A6c(h))return!0;b=this.ve.Uo(b);b=this.ve.jg(b);return ck.a.iHb(b)?!0:!1}A6c(b){return this.Twf&&this.xGb(b)}xGb(b){return b>=this.jIb&&b<=this.NPb}}Object(m.a)(Vx,"StyleBasedDocumentHeadings",null,[296]);var mC=c(1004);class mx{constructor(){this.startTime=0}}Object(m.a)(mx,"TocCallbackData",null,[]);class Wr{static get COf(){if(null!=Wr.cod)return Wr.cod;v.AFrameworkApplication.ye("53i00313-t;gd0ad849-c");Wr.cod=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.NormalizeGraphAfterTOCRemoval",
!1);return Wr.cod}constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){this.Mjg=(bc,Dc,Pc)=>{const jd=Dc.node;if(!jd)return u.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),2;if(12!==jd.type)return u.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!jd.jr)return 2;if(1===Pc)return fc.SessionStatusManager.instance.xj?8:32;this.jd&&this.jd.isFeatureEnabled(119)?this.pvd.GNo(jd).then(Cd=>{Cd||this.sBj(jd)}):this.sBj(jd);
return 32};this.XRo=bc=>{bc=window.performance.now()-bc.startTime;u.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",bc));bc=Object.assign(new Hb.a,{durationMs:bc});wa.Health.instance.recordKpiSuccess(Wr.ZEj,bc);Wr.P6a()};this.Jum=(bc,Dc,Pc)=>{if(qe.ParagraphReader.Yb(Dc.node)&&Dc.node.jr)return 2;if(1===Pc)return fc.SessionStatusManager.instance.xj?8:32;if(Dc.contextId!==mc.a.Vc||this.Fk.i8(Dc)||!qe.ParagraphReader.Yb(Dc.node))return 32;this.Wd.Bs(17);this.pvd.o2k(Dc);
return 32};this.C2f=(bc,Dc,Pc)=>{bc=Dc.node;if(!bc)return u.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==bc.type)return u.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!bc.jr)return 2;if(1===Pc)return fc.SessionStatusManager.instance.xj?8:32;Pc=null;bc.isConnected&&Wr.COf&&(Pc=mC.a.T6b(bc,!0),Pc.Hkc(bc));Dc=new ue.GraphIterator;Dc.set(bc);Dc.Ab(8);Dc.fd(8);const jd=this.Ic.Qc(15);jd.Fu(Dc);
this.pvd.RSn(bc)?(jd.dispose(),Pc&&Wr.COf&&Pc.normalize(),Wr.P6a()):(Pc&&Wr.COf&&Pc.cancel(),jd.dispose(),u.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.kdd=h;this.Xc=A;this.Ic=O;this.Fk=aa;this.pvd=ua;this.Wd=Ra;this.jd=ub;this.WSg=Nb;this.kN=Yb}Ub(){this.ga.pa(qa.a.tlc,mc.a.paragraph,this.Mjg);this.ga.pa(qa.a.tlc,mc.a.Fd,this.Mjg);this.ga.pa(qa.a.tlc,mc.a.Vc,this.Mjg);this.ga.Uc(qa.a.tlc,1028);this.ga.pa(Vc.a.nyf,mc.a.Vc,this.Jum);this.ga.Uc(Vc.a.nyf,1028);
this.ga.pa(Vc.a.N2c,mc.a.paragraph,this.C2f);this.ga.pa(Vc.a.N2c,mc.a.Fd,this.C2f);this.ga.pa(Vc.a.N2c,mc.a.Vc,this.C2f);this.ga.Uc(Vc.a.N2c,1028)}sBj(b){wa.Health.instance.recordKpiUsage(Wr.ZEj,1,Wr.dB,null);const h=this.BFl(b),t=new mx;t.startTime=window.performance.now();this.kdd.Wcj(h,Lc.a.Sig,this.E$l(this.b_l(b)),this.XRo,null,t);this.pvd.kOk()}gJj(b){if(null!=b&&b.jr)if(null==this.WSg.instance)u.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var h=this.WSg.instance.$9h();
b=this.Hvl(b);var t=!1;1===this.kN.tv&&(t=!0);0!=b&&h!=b&&(h=[Object.assign(new sa.a,{name:"TOCPageNo",string:b}),Object.assign(new sa.a,{name:"HeadingPageNo",string:h}),Object.assign(new sa.a,{name:"isPageView",string:t})],lb.a("TOCPageNoMismatch",!0,void 0,h))}}Hvl(b){for(let h=0;h<b.qa.length;h++){const t=b.qa.J(h);if(null!=t.pe)for(let A=0;A<t.pe.length;A++){const O=t.pe.J(A);if(1===O.uj&&O.instruction.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(t.cp,b.characterData.length-
t.cp))}}return 0}b_l(b){return b?b.ia(Lc.a.NM,null):(u.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}BFl(b){return this.Xc.KDa(b,7,7).Tb(35)}E$l(b){const h=[];h.push(b+",TOC,0");return h}static P6a(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},Wr.VCa)}}
Wr.VCa=5E3;Wr.cod=null;Wr.ZEj="WordUpdateTOC";Wr.dB="wwaengidc";Object(m.a)(Wr,"TableOfContentsActor",null,[182]);class xB{}Object(m.a)(xB,"FieldData",null,[]);class nA extends xB{constructor(){super();this.Oob=null}}Object(m.a)(nA,"TOCFieldData",xB,[]);class nx{constructor(b,h,t,A,O,aa=null){this.Yjm=b;this.$s=h;this.Zh=t;this.Vpj=A;this.listMarker=O;this.eQa=aa}}Object(m.a)(nx,"TOCHeadingData",null,[]);class Su{constructor(b,h){this.$Ua=b;this.hn=h}U5h(b){return Object(Rl.__awaiter)(this,void 0,
void 0,function*(){this.$Ua.Twf=b.Uwf;this.$Ua.jIb=b.jIb;this.$Ua.NPb=b.NPb;return this.$Ua.lRl()})}lGl(b){if(b=this.kGl(b))return this.hn.Xua(b)}kGl(b){const h=b.qa.length;for(let t=0;t<h;t++){const A=b.qa.J(t);if(A.hyperlink&&A.hyperlink.oga&&A.hyperlink.url.startsWith(F.a.kdb))return A.hyperlink.url.substr(A.hyperlink.url.indexOf("_Toc"))}return null}fbe(b){(b=this.lGl(b))&&this.hn.CPf(b.id)}u7l(){return this.$Ua.iRl()}zXi(b,h){const t=new nA,A=new Mb.a;for(const O of b){b=this.s7l(O,h);if(!b)return null;
A.add(b)}t.Oob=A;return t}s7l(b,h){let t;if(h&&(t=this.P1k(b),!t))return u.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=Tb.AParagraphNode.CU(b.characterData.trim());const A=this.i9l(b.R7);return new nx(h,t,b.Zh,A,b.listMarker,b.eQa)}P1k(b){const h=String.format("{0}{1}","_Toc",Nf.a.aF());return this.hn.rCc(h,b.begin,b.end,b.paragraphNode,b.paragraphNode)?h:null}i9l(b){return String.format("toc {0}",b)}}Object(m.a)(Su,"TOCDataManager",null,[181]);class Xj{pbg(){const b=
Object.assign(new cf.StandardDialog,{ht:v.AFrameworkApplication.hba,zd:0,nHa:!1});b.MU(1);b.nia(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=Xj.Tyg?Xj.Tyg:Xj.Tyg=new Xj}}Object(m.a)(Xj,"TOCDialogHelper",null,[]);var nC=c(195),TC=c(694),Ly=c(300),pz=c(176);class mq{constructor(b,h,t,A,O,aa,ua){this.qbg=b;this.Mib=h;this.Uwf=t;this.jIb=A;this.NPb=O;this.Zxb=aa;this.$9c=[];this.instruction=ua}toString(){return"showPageNumber:"+
this.qbg+"  isHyperlink:"+this.Mib+" includeOutlineLevels:"+this.Uwf+" lowerOutlineLevel:"+this.jIb+" upperOutlineLevel:"+this.NPb+" addContentControl:"+this.Zxb+" unsupportedSwitches:"+this.$9c.toString()}}Object(m.a)(mq,"TOCSettings",null,[]);class Dd{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd,ee,Od,fe){this.BWg="TOC";this.ohf=this.ove=this.gTe=null;this.E6a=b;this.Hh=h;this.qF=t;this.FL=A;this.ax=O;this.Fk=aa;this.ib=ua;this.Jd=Ra;this.tfh=ub;this.ue=Nb;this.eTe=Yb;this.No=Dc;this.kI=
Pc;this.qo=jd;this.Ic=Cd;this.Gb=ee;this.Cd=Od;this.eb=fe}static get vNo(){if(null!=Dd.bwd)return Dd.bwd;v.AFrameworkApplication.ye("i430a979-t;a1f4j306-c");Dd.bwd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateEmptyTOCFormattingRunId",!1);return Dd.bwd}get CRc(){return this.BWg}set CRc(b){this.BWg=b}get Pob(){this.gTe||(this.gTe=this.A3h());return this.gTe}A3h(){return new mq(!0,!0,!0,0,8,!0,this.bzn())}o2k(b){Object(Rl.__awaiter)(this,void 0,void 0,function*(){lb.a(Dd.p8k);
const h=window.performance.now();if(this.eb.Yb(b.node))if(this.Fk.i8(b))u.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),Dd.nQa("IP is in locked range");else{var t=yield this.E6a.U5h(this.Pob);if(t){var A=new Vb.a(2,1,0,()=>{this.r8k(b,t,this.Pob.Mib,h)});this.Gb.Wb(A)}else u.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),Dd.nQa("Failed to get TOC data")}else u.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),
Dd.nQa("Context should be paragraph")})}r8k(b,h,t,A=0){let O;try{if(0==A&&(A=window.performance.now()),this.jVh(b.node)){var aa=new ue.GraphIterator;aa.set(b.node);aa.Ab(7);aa.fd(7);O=this.Ic.Qc(15);O.Fu(aa);var ua=this.E6a.zXi(h,t);ua||Dd.nQa("Failed to prepare TOC Field data");var Ra=ua.Oob?ua.Oob.count:0;if(Ra){h=null;var ub;for(t=0;t<Ra;t++){const Dc=ua.Oob.J(t);if(!({FAb:ub}=this.Xni(b,h,t,Ra,Dc,Yb?Yb.toString():void 0)).returnValue){Dd.nQa("Failed to populate new TOC paragraph");return}if(0==
t){var Nb=ub.currentNode;var Yb=qe.ParagraphReader.rQ(Nb)}h=ub}if(this.Pob.Zxb&&!this.S8e(Nb.id,h.Kn.id))Dd.nQa("Failed to add content control block");else{var bc=window.performance.now()-A;lb.a(Dd.r$e,!0,bc)}}else if(this.eTe.pbg(),this.f3k(b)){const Dc=window.performance.now()-A;lb.a(Dd.r$e,!0,Dc)}}else Dd.nQa("Failed to fetch style set")}catch(Dc){Dd.nQa(String.format("{0} {1}",Dc.message,Dc.stack))}finally{O&&O.dispose()}}jVh(b){this.ove=this.ax.qC(b);return this.ove?!0:(u.ULS.sendTraceTag(592233796,
3019,15,"Failed to fetch style set"),!1)}static xFa(b){b=[Object.assign(new sa.a,{name:Dd.VRo,string:b})];lb.a(Dd.Ojg,!1,void 0,b)}static xIf(b){b=[Object.assign(new sa.a,{name:Dd.vUn,string:b})];lb.a(Dd.o5i,!1,void 0,b)}static nQa(b){b=[Object.assign(new sa.a,{name:Dd.q8k,string:b})];lb.a(Dd.r$e,!1,void 0,b)}GNo(b){return Object(Rl.__awaiter)(this,void 0,void 0,function*(){const h=this.jdi(b);if(null==h)Dd.xFa("Cannot update TOC when firstTocPara = null");else{var t=this.w7l(h);if(0<t.$9c.length)return this.y1m(t.$9c),
!1;lb.a(Dd.URo);var A=window.performance.now(),O=yield this.E6a.U5h(t);if(!O)return u.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),Dd.xFa("Failed to fetch TOC data"),!1;var aa=new Vb.a(1,1,0,()=>{this.WRo(h,O,t,A)});this.Gb.Wb(aa);return!0}})}WRo(b,h,t,A=0){let O;try{if(null==b)Dd.xFa("Attempt to update TOC when firstTocPara = null");else{0==A&&(A=window.performance.now());var aa=new ue.GraphIterator;aa.set(b);aa.Ab(7);aa.fd(7);O=this.Ic.Qc(15);O.Fu(aa);var ua=this.E6a.zXi(h,
t.Mib);if(null==ua)Dd.xFa("Attempt to update TOC when tocFieldData = null");else{var Ra;if(({Z3e:Ra}=this.N4i(b,t)).response){u.ULS.sendTraceTag(559018207,3019,50,String.format("Attempting to update TOC with settings: {0}",t.toString()));var ub=ua.Oob?ua.Oob.count:0;if(this.jVh(b)){var Nb;this.Dvi(b)&&(this.n5i(b),(b=this.eb.ug(b,!1,!0))&&(Nb=b.ia(Lc.a.Lc,null).toString()));var Yb=b.ia(Lc.a.NM,null);h=Yb;Nb=null!==Nb&&void 0!==Nb?Nb:Yb;if(ub){for(var bc=0,Dc;b.jr&&h==Yb&&bc<ub;){const Cd=ua.Oob.J(bc);
t.Mib&&this.E6a.fbe(b);if(!this.xRo(b,bc,ub,Cd,t)){u.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");Dd.xFa("Failed to update TOC paragraph");return}b.setValue(Lc.a.NM,Nb);bc++;Dc=b;b=this.eb.ug(Dc,!1,!0);if(!b){h=null;break}this.Jvi(b)&&this.m5i(b);h=b.ia(Lc.a.NM,null)}h==Yb&&this.q2f(b);var Pc;if(({NFf:Pc}=this.tnk(ua,bc,ub,Dc,Nb)).response)if(t.Zxb&&!this.S8e(Ra,Pc.id))Dd.xFa("Failed to add content control block");else{var jd=window.performance.now()-A;lb.a(Dd.Ojg,!0,jd)}else Dd.xFa("Failed to add new paragraph")}else this.eTe.pbg(),
this.RRo(b,t.Zxb,Ra,t.instruction,Nb)&&(bc=window.performance.now()-A,lb.a(Dd.Ojg,!0,bc))}else Dd.xFa("Failed to fetch style set")}else Dd.xFa("Failed to remove Content Control")}}}catch(Cd){Dd.xFa(String.format("{0} {1}",Cd.message,Cd.stack))}finally{O&&O.dispose()}}tnk(b,h,t,A,O){let aa=new ue.GraphIterator;for(aa.set(A);h<t;){A=b.Oob.J(h);if(!({FAb:A}=this.Xni(null,aa,h,t,A,O)).returnValue)return{NFf:aa.currentNode,response:!1};aa=A;h++}return{NFf:aa.currentNode,response:!0}}N4i(b,h){var t,A,O;
let aa,ua;const Ra=null===(t=null===b||void 0===b?void 0:b.qa)||void 0===t?void 0:t.first.Jb;if(Ra&&0<Ra.length)if(b=b.qa.first.Jb.J(0),b.Uf){t=b.contentControlNode.getValue(Lc.a.jx);aa=pi.a.Hj?this.Cd.Mq(b.contentControlNode.id,!0):this.Cd.Es.get(null===(A=b.contentControlNode.id)||void 0===A?void 0:A.toString());ua=pi.a.Hj?this.Cd.Mq(b.contentControlNode.id,!1):this.Cd.Lt.get(null===(O=b.contentControlNode.id)||void 0===O?void 0:O.toString());if(0!=this.No.JLb(t))return u.ULS.sendTraceTag(558952907,
3019,10,"Failed to release content control"),{response:!1,Z3e:aa,kyh:ua};h.Zxb=!0}else u.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),h.Zxb=!1;else h.Zxb=!1;return{response:!0,Z3e:aa,kyh:ua}}RRo(b,h,t,A,O){u.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.E6a.fbe(b);const aa=this.aNd(b);if(!this.GWi(aa,h,t,A))return Dd.xFa("Failed to populate empty TOC."),!1;if(h=this.eb.ug(b,!1,!0))t=b.ia(Lc.a.NM,null),A=h.ia(Lc.a.NM,null),t==A&&this.q2f(h);b.setValue(Lc.a.NM,
O);return!0}GWi(b,h,t,A){this.Jd.replaceTextRange(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.UIi(b);const O=b.qa.first;this.ue.XK(O.formatting,!0);this.d9e(b,0,1,A);Dd.vNo&&O.E$f&&b.Ae.$p.Z(O.formatting.ze,am.CharacterPropertiesEditor.sM);return h&&t&&!this.S8e(t,b.id)?!1:!0}aNd(b){b.qa.reset();b.aZa();const h=new nC.a(b,0);h.formatting=new pz.a(h,W.a.nil);h.Rh=!0;b.qa.add(h);return pf.a.createTextRange(b,0,b.characterData.length)}Dvi(b){if(qe.ParagraphReader.wQ(b)){var h=b.qa.last.pe;
if(!h||!h.length)return!1;if(4<=h.length){b=0===h.J(h.length-4).uj;const t=1===h.J(h.length-3).uj&&h.J(h.length-3).instruction.trim().startsWith(this.CRc),A=2===h.J(h.length-2).uj;h=5===h.J(h.length-1).uj;return b&&t&&A&&h}}return!1}Jvi(b){if(qe.ParagraphReader.wQ(b)){var h=b.qa.first.pe;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.J(0).uj,h=3===h.J(1).uj,b&&h}return!1}n5i(b){const h=b.qa.last.pe,t=h.J(h.length-4),A=h.J(h.length-3),O=h.J(h.length-2),aa=h.J(h.length-1);h.remove(t);h.remove(A);
h.remove(O);h.remove(aa);b.removeProperty(Lc.a.NM)}m5i(b){const h=b.qa.first.pe,t=h.J(0),A=h.J(1);h.remove(t);h.remove(A);b.removeProperty(Lc.a.NM)}q2f(b){if(b){var h=b.ia(Lc.a.NM,null),t=b.ia(Lc.a.Lc,null).toString(),A=h;t==h&&this.Dvi(b)&&(this.n5i(b),(b=this.eb.ug(b,!1,!0))&&(A=b.ia(Lc.a.NM,null)));t=new ue.GraphIterator;t.set(b);t.Ab(8);u.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var O;b&&b.jr&&A==h&&O!=b;){if(this.Jvi(b)){this.m5i(b);break}this.E6a.fbe(b);
this.qo.Zd(t);A=this.qo.Ir(t,!1,!0);this.Hh.GGa(b);if(!A)return null;O=b;t.Tb(2);A=(b=t.currentNode)?b.ia(Lc.a.NM,null):null}return b}}w7l(b){var h=b.qa,t=h?h.length:0,A=null;b=new mq(!0,!1,!1,0,8,!0,void 0);for(let O=0;O<t&&(A=this.v7l(h.J(O)),b.instruction=A,A=this.v4l(A),A[0]!==this.CRc);O++);h=A?A.length:0;for(t=1;t<h;t++)switch(A[t]){case "\\h":b.Mib=!0;break;case "\\u":b.Uwf=!0;break;case "\\o":this.feo(A[t+1],b)&&t++;break;case "\\z":break;case "\\n":b.qbg=!1;b.$9c.push(A[t]);break;default:b.$9c.push(A[t])}return b}feo(b,
h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===b.length?(h.jIb=Number.parseInvariant(b[1])-1,h.NPb=Number.parseInvariant(b[2])-1,!0):!1}RSn(b){try{lb.a(Dd.uUn);const h=window.performance.now(),t=this.jdi(b);if(null==t){Dd.xIf("Attempt to remove TOC when firstTocPara = null");return}let A,O,aa;const ua=this.A3h();if(!({Z3e:A,kyh:O}=this.N4i(t,ua)).response)return Dd.xIf("Failed to remove content control"),!1;if(void 0==A&&void 0==O)aa=this.q2f(t);else{aa=t.Mc.Db(A);const ub=new ue.GraphIterator;
ub.set(aa);ub.Ab(8);b=!1;let Nb;for(;!b&&aa&&Nb!=aa;){aa.id.equals(O)&&(b=!0);aa&&aa.jr&&this.E6a.fbe(aa);this.qo.Zd(ub);const Yb=this.qo.Ir(ub,!1,!0);this.Hh.GGa(aa);if(!Yb){aa=null;break}ub.Tb(2);Nb=aa;aa=ub.currentNode}}aa&&this.KXc(aa);const Ra=window.performance.now()-h;lb.a(Dd.o5i,!0,Ra)}catch(h){Dd.xIf(String.format("{0} {1}",h.message,h.stack))}return!0}KXc(b){b=pf.a.Tc(b,0);b=new Kg.Selection([b],!0);this.ib.setSelection(b)}S8e(b,h){return this.No.Uka(b,h,null,Dd.Kil,!0).returnValue?(u.ULS.sendTraceTag(573653840,
3019,10,"Failed to create content control block for table of contents."),!1):!0}kOk(){this.E6a.u7l()||this.eTe.pbg()}jdi(b){if(!b.jr)return u.ULS.sendTraceTag(528320659,3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ia(Lc.a.NM,null);return this.kI.l_l(b)}y1m(b){b.length&&(b=[Object.assign(new sa.a,{name:"UnsupportedSwitches",string:b.toString()})],lb.a("UnsupportedTocInstruction",void 0,void 0,b))}v7l(b){const h=(b=b.pe)?b.length:0;for(let t=0;t<h;t++)if(1===b.J(t).uj&&b.J(t).instruction.trim().startsWith(this.CRc))return b.J(t).instruction.trim();
return null}v4l(b){const h=[];if(!b)return h;b=b.split(" ");return b.length?b:h}f3k(b){b=this.tIh(b,null,!0,void 0).returnValue;if(!b)return Dd.nQa("Failed to create paragraph"),!1;const h=pf.a.Tc(b,0);if(!this.GWi(h,!0,b.id,this.Pob.instruction))return Dd.nQa("Failed to populate empty TOC"),!1;u.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}tIh(b,h,t,A){let O,aa;t&&b?(O=this.v3k(b),aa=O.currentNode,A=qe.ParagraphReader.rQ(aa).toString()):h&&(O=this.qXl(h),aa=
this.Hh.UL(O));if(!aa)return u.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,FAb:O};aa.setValue(Lc.a.NM,A);return{returnValue:aa,FAb:O}}bzn(){const b=new Sys.StringBuilder(this.CRc);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}qzn(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.Pob.Mib&&h.append(" \\h");return h.toString()}qXl(b){b.yd();this.qo.Zd(b);return this.Hh.tna(b,!1)}v3k(b){const h=new ue.GraphIterator;
h.set(b.node);h.yd();this.qo.Zd(h);let t=this.J8h(h);const A=!b.cpBegin;if(mb.OutlineElementReader.isEmpty(h,!0))return this.Hni(t);if(A)return this.Hh.uC(t,!0,!1),this.Hh.p9(h,t,b,!1,!1,!1),b=this.J8h(t),this.Hni(b);t=this.Hh.tna(h);this.Hh.p9(h,t,b,!1,!1,!0);b=this.Hh.tna(h);this.Hh.kNb(b.currentNode,!1);this.Hh.UL(b);this.qo.Fe(b);return b}J8h(b){const h=new ue.GraphIterator;h.$c(b);h.yd();return h}Hni(b){this.Hh.uC(b,!0,!0);this.Hh.kNb(b.currentNode,!1);this.qo.Fe(b);return b}UIi(b){const h=b.qa;
1===h.length&&(h.first.Rh=!1,b.RId().Rh=!0)}xRo(b,h,t,A,O){const aa=this.aNd(b);this.Jd.replaceTextRange(aa,"");this.KWi(b,A,O);this.d9e(b,h,t,O.instruction);return O.Mib&&!this.jH(b,A.$s)?!1:!0}Xni(b,h,t,A,O,aa){h=({FAb:b}=this.tIh(b,h,0==t,aa)).returnValue;if(!h)return{returnValue:!1,FAb:b};this.KWi(h,O,this.Pob);this.d9e(h,t,A,this.Pob.instruction);return this.Pob.Mib&&!this.jH(h,O.$s)?{returnValue:!1,FAb:b}:{returnValue:!0,FAb:b}}KWi(b,h,t){this.ttm(b,h.Yjm,h.listMarker,h.Vpj,h.eQa);this.tfh.Uum(b,
b.characterData.length);t.qbg&&this.mum(b,h);this.UIi(b);this.vgo(b,h.Vpj)}SUl(b,h){if(!b)return 0;const t=Dd.j9l();return 4<b.length?t.J(h)+.5*Math.floor(b.length/3):t.J(h)}ttm(b,h,t,A,O){t&&this.Itm(b,t,A);t=pf.a.Tc(b,b.characterData.length);this.Jd.replaceTextRange(t,h);O&&(b=b.qa.ei(0),this.ue.bia(b.formatting,O))}Itm(b,h,t){t=this.SUl(h,t);const A=pf.a.Tc(b,0);this.Jd.replaceTextRange(A,h);this.tfh.Jtm(b,h.length,t)}mum(b,h){var t=pf.a.Tc(b,b.characterData.length);this.Jd.replaceTextRange(t,
h.Zh.toString());t=b.qa.ei(b.characterData.length-h.Zh.toString().length);h=this.qzn(h.$s);this.fPa(b,t,0,2,h);this.fPa(b,t,1,2,h);this.fPa(b,t,2,2,h);t=b.qa.ei(b.characterData.length);this.fPa(b,t,3,2,h)}vgo(b,h){h=this.ove.Ni(h);this.FL.rJ(h,b,!0)}d9e(b,h,t,A){const O=b.qa.first,aa=b.qa.last;h?this.fPa(b,O,4,1,A):(this.fPa(b,O,0,1,A),this.fPa(b,O,1,1,A),this.fPa(b,O,2,1,A));h===t-1?this.fPa(b,aa,3,1,A):this.fPa(b,aa,5,1,A)}fPa(b,h,t,A,O=null){t=new TC.a(h,null,t,A,!0,!1,!1,O);h.pe||(h.pe=new Ly.a(h));
h.pe.add(t);b.Pm();this.W8k(t,b)}W8k(b,h){b.ze?h.Ae.BX(b.ze-1,2):h.Ae.sna(b.ze,2);h.Ae.$p.Z(b.ze,am.CharacterPropertiesEditor.sM);h.Ae.Ps.Z(b.ze,am.CharacterPropertiesEditor.VQ)}jH(b,h){b=pf.a.createTextRange(b,0,b.characterData.length);return this.qF.jH(b,h,!1,!1,!1,!0)?!0:(u.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static j9l(){Dd.Jsa||(Dd.Jsa=new xb.a,Dd.Jsa.Z("toc 1",1),Dd.Jsa.Z("toc 2",1.5),Dd.Jsa.Z("toc 3",2),Dd.Jsa.Z("toc 4",2.5),Dd.Jsa.Z("toc 5",
3),Dd.Jsa.Z("toc 6",3.5),Dd.Jsa.Z("toc 7",4),Dd.Jsa.Z("toc 8",4.5),Dd.Jsa.Z("toc 9",5));return Dd.Jsa}}Dd.Jsa=null;Dd.Kil="Table of Contents";Dd.p8k="CreateTocClient";Dd.r$e="CreateTocSuccess";Dd.q8k="CreateTocFailureCause";Dd.URo="UpdateTocClient";Dd.Ojg="UpdateTocSuccess";Dd.VRo="UpdateTocFailureCause";Dd.uUn="RemoveTocClient";Dd.o5i="RemoveTocSuccess";Dd.vUn="RemoveTocFailureCause";Dd.bwd=null;Object(m.a)(Dd,"TOCField",null,[179,180]);var Tu=c(655);class uj{constructor(b,h){this.Dza=b;this.OIa=
h}Uum(b,h){if(qe.ParagraphReader.Yb(b)&&!(0>h)){var t=Aq.a.Y0b(b);t=new Tu.a(t,4,1,1);this.Dza.NUd(b,t);b=pf.a.Tc(b,h);this.OIa.$Ud(b)}}Jtm(b,h,t){var A=Vm.a.XL/2;const O=b.qa.fDb(h);A=Wa.FormattingReader.Mn(O.formatting,Af.a.fontSize,2*A)/2;t=new Tu.a(Ad.a.wv(A/36)*t,1,0,1);this.Dza.NUd(b,t);b=pf.a.Tc(b,h);this.OIa.$Ud(b)}}Object(m.a)(uj,"TOCTabUtility",null,[176]);class zl{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}yc(b){this.W=b;this.W.ha("WordEditor.AutoSaveParamsUpdateService",
()=>new wB.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Sv.a.jQ)).singleInstance();this.W.ha("WordEditor.TableOfContents.StyleBasedDocumentHeadings",()=>new Vx(new Pg.a(()=>Jb.App.ya.jb.Wc),fm.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),new jh.a,new Pg.a(()=>Jb.App.ya.jb.xc))).as("WordEditor.TableOfContents.IDocumentHeadings").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCDataManager",
()=>new Su(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCTabUtility",()=>new uj(this.W.resolve("WordEditor.ICustomTabStopUtility"),this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCField",()=>new Dd(this.W.resolve("Box4.ITOCDataManager"),this.W.resolve("Box4.IOutlineElementEditor"),
this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),rl.a.instance,this.W.resolve("Box4.ISelectionManager"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.W.resolve("Box4.IFormattingEditor"),Xj.instance,this.W.resolve("Box4.IFeatureHelper"),this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Ma("WordEditor.ParagraphWordIdMapping"),
this.W.resolve("Box4.IOutlineElementNavigator"),vo.a.instance,v.AFrameworkApplication.oc,this.W.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").singleInstance();this.W.ha("WordEditor.TableOfContents.TableOfContentsActor",()=>new Wr(v.AFrameworkApplication.xa,this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),vo.a.instance,
rl.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.Sa("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").singleInstance()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Ub()}dispose(){}}Object(m.a)(zl,"PackageManager",null,[1,2]);class So{constructor(b,h,t,
A,O,aa,ua,Ra){this.ARa=(ub,Nb,Yb,bc,Dc)=>{if(!({Qx:ub}=this.Mnb(Nb,Yb,Dc,!0,!0)).returnValue)return ub;this.Eud.FHh(Dc,Nb.node);return 32};this.txa=(ub,Nb,Yb,bc,Dc)=>this.Ohi(Nb,Yb,bc,Dc,!0);this.xKb=(ub,Nb,Yb,bc,Dc)=>{if(!({Qx:ub}=this.Mnb(Nb,Yb,Dc,!1,!0)).returnValue)return ub;this.Eud.h5k(Dc,Nb.node);u.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.fla=(ub,Nb,Yb,bc,Dc)=>{if(!({Qx:bc}=this.Mnb(Nb,Yb,Dc,!1,!0)).returnValue)return 2==Yb&&8==bc&&Ht.a.recordQosError("TableStyleButtonClickNoResponse",
["TableInteractionFailed"],uf.a.VBb),bc;const Pc=Nb.node;let jd=null;(jd=ub===qa.a.fla?this.Eud.cQb(Dc[Ng.a.SourceControlId],Pc):this.Px.B7b(Pc,Dc))?(this.m8d(Pc,()=>{this.Iwd.S5a(jd,Pc)}),this.bP(),bc=32):(Ht.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],uf.a.VBb),bc=8);ub===qa.a.fla&&32===bc&&u.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");u.ULS.shipAssertTag(0,324,32===bc);return bc};this.fta=(ub,Nb,Yb,bc,Dc)=>this.Ohi(Nb,Yb,bc,Dc,!1);this.fje=(ub,
Nb,Yb,bc,Dc)=>Xf.a.Voa(ub,Nb,Yb,bc,Dc,{},14);this.Czb=(ub,Nb,Yb,bc,Dc)=>{if(!({Qx:ub}=this.Mnb(Nb,Yb,Dc,!1,!1)).returnValue)return ub;const Pc=Nb.node;this.m8d(Pc,()=>{this.Iwd.ORk(Pc)});return 32};this.Px=b;this.Eud=h;this.ga=t;this.Iwd=A;this.Ic=O;this.yz=aa;this.H2j=Ra}Ub(){this.Rfc(Jb.App.iTa.hHh())}Rfc(b){this.ga.pa(qa.a.ARa,mc.a.view,b);this.ga.pa(qa.a.ARa,mc.a.table,this.ARa);this.ga.Uc(qa.a.ARa,1127);this.ga.pa(qa.a.fla,mc.a.view,this.fje);this.ga.pa(qa.a.fla,mc.a.table,this.fla);this.ga.Uc(qa.a.fla,
1030);this.ga.pa(qa.a.applyStyle,mc.a.table,this.fla);this.ga.pa(qa.a.fta,mc.a.view,this.fje);this.ga.pa(qa.a.fta,mc.a.table,this.fta);this.ga.Uc(qa.a.fta,1038);this.ga.pa(qa.a.txa,mc.a.view,b);this.ga.pa(qa.a.txa,mc.a.table,this.txa);this.ga.Uc(qa.a.txa,1127);this.ga.pa(qa.a.xKb,mc.a.view,b);this.ga.pa(qa.a.xKb,mc.a.table,this.xKb);this.ga.Uc(qa.a.xKb,1126);this.ga.pa(qa.a.Czb,mc.a.view,this.fje);this.ga.pa(qa.a.Czb,mc.a.table,this.Czb);this.ga.Uc(qa.a.Czb,1028)}bP(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}Ohi(b,h,t,A,O){if(!({Qx:aa}=this.Mnb(b,h,A,O,!0)).returnValue)return 2==h&&8==aa&&Ht.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],uf.a.esl),aa;b=b.node;h=this.Px.DT(b);var aa=A[Ng.a.On];const ua=So.P7l(A.MenuItemId);O?A[Ng.a.On]=So.emo(h,ua):(this.Lyk(h,ua,aa,b),t.Ur=
ua,t.gC=aa?0:1,u.ULS.shipAssertTag(0,324,!!ua));return 32}m8d(b,h){const t=this.Ic.Qc(15);try{t.Eb(b),this.yz.c5a(),h()}finally{t&&t.dispose()}}Mnb(b,h,t,A,O){return this.lLm(b,h,t,A,O)?{returnValue:A||2===h,Qx:32}:{returnValue:!1,Qx:8}}lLm(b,h,t,A,O){if(b.contextId!==mc.a.table)return!1;if(A||2===h)if(O&&!t||!Object(hc.a)(Bq.TableNode,b.node)||this.H2j(b.node))return!1;return!0}Lyk(b,h,t,A){const O=(512===h||1024===h?!t:t)?b|h:b&~h;O!==b&&this.m8d(A,()=>{this.Iwd.bya(O,A)})}static EA(){So.$bb[So.Qwl]=
32;So.$bb[So.Hwl]=128;So.$bb[So.sPm]=64;So.$bb[So.jPm]=256;So.$bb[So.rCk]=512;So.$bb[So.qCk]=1024}static emo(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static P7l(b){let h=0;b in So.$bb&&(h=So.$bb[b]);return h}}So.Qwl="buttonFirstRow";So.Hwl="buttonFirstColumn";So.sPm="buttonLastRow";So.jPm="buttonLastColumn";So.rCk="buttonBandedRow";So.qCk="buttonBandedColumn";So.$bb={};Object(m.a)(So,"TableStyleActor",null,[]);So.EA();var qz=c(779),Ih=c(446);class lt extends Ih.a{constructor(){super();this.TableStyles=
this.TableCellStyles=null;this.columns=0}}Object(m.a)(lt,"TableGalleryButtonProps",Ih.a,[]);class Wx extends lt{constructor(){super()}get Type(){return 6}}Object(m.a)(Wx,"TableStyleGalleryButtonProps",lt,[]);class mt{}mt.ibn=2147483647;Object(m.a)(mt,"TableStyleUtil",null,[]);class Gs{constructor(b,h,t){this.q5e="Clear";this.SBb=null;this.Hek=b;this.ve=h;this.Px=t;this.Yaa=v.AFrameworkApplication.Yaa;this.Ks=v.AFrameworkApplication.Ks}t_a(){}Flk(b,h){this.t_a(b);const t=this.T_h(b),A=t.length;if(!(0>=
A)){var O=mt.ibn,aa=null;for(let ub=0;ub<A;ub++){var ua=t[ub],Ra=this.Px.c8l(ua);O!==Ra&&(O=Object.assign(new eh.a,{Id:"msMoreTableStyles"+Ra,Title:this.d8l(Ra),ControlList:[]}),aa=Object.assign(new Di.a,{Type:6,Id:"galleryMoreTableStyles"+Ra,ExternalGalleryId:"TableStylesGallery",Width:Gs.ydg,ElementDimensions:"Size64by48",GalleryItems:[]}),this.SBb&&(aa.ExternalId=this.SBb[Ra.toString()]),O.ControlList.push(aa),h.MenuSectionList.push(O),O=Ra);Ra=this.ve.CK(ua);ua=Gs.Keg+ub;Ra=Object.assign(new Wx,
{Id:ua,ExternalId:ua,Command:qa.a.fla.toString(),QueryCommand:qa.a.ARa.toString(),LabelText:Ra?F.a.Af(Ra):"",Alt:Ra,VerticalCenterAlign:"true"});Ra.TableCellStyles=this.LQd(ua,b);Ra.TableStyles=this.wOc(ua,b);aa&&aa.GalleryItems.push(Ra)}}}Elk(b){const h=Object.assign(new eh.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),t=Object.assign(new Eh.a,{Id:"fseaClearTableFormatting",Command:qa.a.Czb.toString(),LabelText:F.a.Af(this.q5e),Alt:F.a.Af(this.q5e),
Image16by16:this.Ks,Image16by16Class:dh.getImageClassWithCluster(this.Yaa,Gs.NRk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(t);b.MenuSectionList.push(h)}FHh(b,h){this.t_a(h);const t=b[Ng.a.SourceControlId];var A=this.cQb(t,h);if(A){var O=this.Px.LE(h);O=O?this.ve.jg(O):null;var aa=this.ve.CK(A);A=this.ve.jg(A);b[Cl.a.Alt]=aa;b[Cl.a.On]=A===O;h=Object.assign(new Wx,{Id:t,ExternalId:t,Command:qa.a.fla.toString(),QueryCommand:qa.a.ARa.toString(),TableCellStyles:this.LQd(t,
h),TableStyles:this.wOc(t,h),Alt:aa});b[Cl.a.GalleryButtonProps]=h}else b[Cl.a.InnerHTML]=null,b[Cl.a.Alt]=null,b[Cl.a.On]=!1,b[Cl.a.GalleryButtonProps]=null}LQd(b,h){this.t_a(h);return(b=this.cQb(b,h))?this.Hek.s1h(b,h):null}wOc(b,h){this.t_a(h);return this.cQb(b,h),null}h5k(b,h){b.MenuItems=this.PWl(h)}PWl(b){const h=Object.assign(new gj.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.Flk(b,h);this.Elk(h);return h}cQb(b,h){return b?b.startsWith(Gs.Keg)?this.mtf(parseInt(b.substr(Gs.Keg.length)),
h):this.Q_n(parseInt(b.substr(Gs.Gzo.length)),h):null}}Gs.Keg="buttonTableStyleMenu";Gs.Gzo="buttonTableStyleRibbon";Gs.ydg=7;Gs.NRk="ClearTableStyle_16x16x32";Object(m.a)(Gs,"ATableStyleRibbonControl",null,[175]);class Tv extends Gs{constructor(b,h,t){super(null,h,t);this.Beh=b}FHh(b,h){this.t_a(h);const t=b[Ng.a.SourceControlId];var A=this.cQb(t,h);if(A){var O=this.Px.LE(h);O=O?this.ve.jg(O):null;var aa=this.ve.CK(A);A=this.ve.jg(A);b[Cl.a.Alt]=aa;b[Cl.a.On]=A===O;h=Object.assign(new Wx,{Id:t,ExternalId:t,
Command:qa.a.fla.toString(),QueryCommand:qa.a.ARa.toString(),TableCellStyles:this.LQd(t,h),TableStyles:this.wOc(t,h),Alt:aa});b[Cl.a.GalleryButtonProps]=h}else b[Cl.a.InnerHTML]=null,b[Cl.a.Alt]=null,b[Cl.a.On]=!1,b[Cl.a.GalleryButtonProps]=null}LQd(b,h){this.t_a(h);return(b=this.cQb(b,h))?this.Beh.s1h(b,h,5,5):null}wOc(b,h){this.t_a(h);return this.cQb(b,h),null}}Object(m.a)(Tv,"ATableStyleRibbonControlVariableSizePreviews",Gs,[]);var rz=c(1453),oA=c(1107);class wu{constructor(b,h,t,A){this.AGl=(O,
aa)=>this.getBorder(O,this.d1.gM(aa));this.zGl=(O,aa)=>this.getBorder(O,this.d1.cO(aa));this.ax=b;this.Ku=h;this.Twb=t;this.d1=A;this.YQj=new Pg.a(()=>this.yGl());this.D8a=new Pg.a(()=>this.xGl())}yGl(){const b={},h=v.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}xGl(){const b={};b[Mh.a.XBa]=Mh.a.qdb;b[Mh.a.qdb]=
Mh.a.qdb;b[Mh.a.FYa]=Mh.a.FYa;return b}q2k(b,h,t,A){const O=new oA.a;O.rowCount=t;O.Tdb=A;O.USa=this.Twb.n7l(b);O.Ha=b.ia(Lc.a.Ha,1);O.Ga=b.ia(Lc.a.Ga,1);O.tableLook=h;O.$ie=1;return O}s1h(b,h,t,A){if(!this.ax.jg(b)||!Object(hc.a)(177,b)||!Object(hc.a)(pr.a,h))return null;const O=this.Ku.DT(h);t=this.q2k(b,O,t,A);A=[];for(t.rowIndex=0;t.rowIndex<t.rowCount;t.rowIndex++)this.Nnk(b,h,t,A);return A}wOc(){return null}X7(){}Nnk(b,h,t,A){t.P8b=!t.rowIndex;for(t.cellIndex=0;t.cellIndex<t.Tdb;t.cellIndex++)this.hkk(b,
h,t,A)}hkk(b,h,t,A){h=this.Twb.BWk(t,this.Twb.hmf(t),h,b);const O={};var aa=this.Ku.Ylf(b,h,Af.a.fontColor,!0,Oj.a.tK(),"None");O.color=aa?aa:"inherit";aa=this.Ku.Ylf(b,h,Af.a.eH,!0,Oj.a.tK(),"None");O["background-color"]=aa?aa:"inherit";this.nok(t,b,h,O);A.push(O)}nok(b,h,t,A){b=this.Twb.kOa(b);this.Kxd(5,b,h,t,A);this.Kxd(3,b,h,t,A);this.Kxd(0,b,h,t,A);this.Kxd(4,b,h,t,A)}Kxd(b,h,t,A,O){h=this.wNl(b,h,t,A);h!==Mh.a.EF&&(O[this.YQj.value[rz.a[b]]]=h)}wNl(b,h,t,A){let O=Mh.a.EF;if(({kla:O}=this.$Ha(A,
b,1,h,this.zGl,O)).returnValue)return O;({kla:O}=this.$Ha(t,b,3,h,this.AGl,O));return O}$Ha(b,h,t,A,O,aa){return this.d1.Bjj(t,h,A)&&(aa=O(b,h))!==Mh.a.EF||!h&&({kla:aa}=this.$Ha(b,1,t,A,O,aa)).returnValue||4===h&&({kla:aa}=this.$Ha(b,2,t,A,O,aa)).returnValue?{returnValue:!0,kla:aa}:{returnValue:aa!==Mh.a.EF,kla:aa}}getBorder(b,h){let t="",A,O;({borderStyle:A,borderWidth:O}=this.CGl(b,h));if(A===Mh.a.FYa)return t;t=String.format(Mh.a.zAd,O,A,this.Q0h(b,h));return t.trim()}Q0h(b,h){if(!h)return Mh.a.zZ;
b=this.Ku.tKc(b,h.color,Fl.a.auto);return b!==Fl.a.auto?Fl.a.wI(b):Mh.a.zZ}CGl(b,h){var t=Mh.a.pta;let A=Mh.a.FF+Mh.a.G0b;if(!h)return{borderStyle:t,borderWidth:A};t=this.Ku.tKc(b,h.style,Mh.a.FYa);b=this.Ku.tKc(b,h.size,Mh.a.FF);A=this.BGl(t,b)+Mh.a.G0b;t=this.sGl(t);return{borderStyle:t,borderWidth:A}}BGl(b,h){let t=2;b===Mh.a.D0b&&h<Mh.a.jla&&(t=1);return t}sGl(b){return this.D8a.value[b]||Mh.a.E0b}static f8l(){return new wu(Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Sa.a.instance.resolve("WordEditor.IWACTableStyleReader"),
Nw.a.instance,Mh.a.instance)}static get instance(){return null!=wu.cyg?wu.cyg:wu.cyg=wu.f8l()}}Object(m.a)(wu,"TableStylePreviewGenerator",null,[178]);var Xr;(function(b){b[b.d6o=0]="background1";b[b.jgp=1]="text1";b[b.e6o=2]="background2";b[b.kgp=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.z9o=11]="followedHyperlink";b[b.u7o=12]="dark1";b[b.Oap=13]=
"light1";b[b.v7o=14]="dark2";b[b.Pap=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(Xr||(Xr={}));Object(m.b)("ThemeColor",Xr);class Uv{constructor(b){this.WKa=b}BEl(b,h,t){let A;({q0i:h,Esh:A}=this.r2l(h));b=[];const O=[];for(let ua=0;16>ua;ua++){if(!(Xr[ua]in t.bxb))continue;const Ra=ua,ub=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,WoncaIntl.WoncaStrings[A[Ra]],this.MTl(ua));var aa=h[Ra];aa=aa&4278190080|(aa&255)<<16|aa&65280|(aa&16711680)>>>16;O.push(Object.assign(new On.a,
{Color:Ra.toString(),DisplayColor:"#"+F.a.xI(aa,6),Alt:F.a.Af(ub)}));b[b.length]=ua}return{returnValue:O,KBo:b}}MTl(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;
case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}r2l(b){let h=null,t=null;b=this.WKa(b);if(!b)return{q0i:h,Esh:t};h=b.properties.ia(Lc.a.themeColors,null);t=b.properties.getValue(Lc.a.Oje).split(" ");return{q0i:h,Esh:t}}static h8l(){return new Uv(Object(z.a)(Uv.eh,Uv.eh.Ms,"navigateToPageContentNode"))}static get eh(){return fm.PageNavigator.instance}static get instance(){return null!=Uv.vyg?Uv.vyg:Uv.vyg=Uv.h8l()}}Object(m.a)(Uv,
"TableStyleThemeHelper",null,[277]);var Aw=c(867);class xu{constructor(b,h){this.jSe={};this.bxb={};this.ve=b;this.Px=h}Tff(b,h){const t=this.jSe[Xr[h]];return t&&t.length?t:this.yCl(b,h)}G6h(b,h,t){if(h=this.Tff(h,t))for(b=this.ve.jg(b),t=0;t<h.length;t++)if(this.ve.jg(h[t])===b)return t;return-1}X7(){this.jSe={};this.bxb={}}yCl(b,h){const t=[];this.bxb={};b=this.Px.dhb(b);this.mzd(t,this.bxb,0,h,b);this.mzd(t,this.bxb,1,h,b);this.mzd(t,this.bxb,2,h,b);this.mzd(t,this.bxb,3,h,b);return this.jSe[Xr[h]]=
t}mzd(b,h,t,A,O){const aa=O.VP;for(let ua=0;ua<aa;ua++){const Ra=O.EOa(ua);if(3!==this.ve.vD(Ra))continue;const ub=this.Px.b8l(Ra),Nb=this.Px.RQd(Ra);h[Xr[Nb]]=!0;ub!==t||Nb!==A&&16!==Nb||this.ve.jg(Ra)===Aw.a.jmg||(b[b.length]=Ra)}}static Qam(){return new xu(Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Sa.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static P8k(){return xu.Qam()}}Object(m.a)(xu,"WACTableStyleRibbonList",null,[199]);class nq extends Tv{constructor(b,h,t,A,O){super(b,
h,t);this.zSb=4;this.Zud=[];this.jwm=()=>{this.BZb.X7();this.Beh.X7()};this.Iek=O;this.BZb=A;this.q5e=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.lxn()}k2k(b,h){b.MenuItems=this.GBl(h)}lxn(){this.SBb={};this.SBb["0"]="CustomTableStyles";this.SBb["1"]="PlainTableStyles";this.SBb["2"]="GridTableStyles";this.SBb["3"]="ListTableStyles"}GBl(b){const h=Object.assign(new gj.a,{Id:"menuTableTheme"});h.MenuSectionList=[];if(this.zKm(b))return h;const t=Object.assign(new eh.a,{Id:"msTableStyleTheme",
ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),A=Object.assign(new qz.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Vc.a.Wcb.toString(),QueryCommand:Vc.a.nLb.toString(),Width:nq.LBo});A.Colors=({KBo:this.Zud}=this.Iek.BEl(this.Zud,b,this.BZb)).returnValue;t.ControlList.push(A);h.MenuSectionList.push(t);return h}t_a(b){if(b=this.Px.LE(b))b=this.Px.RQd(b),16!==b&&(this.zSb=b)}T_h(b){return this.BZb.Tff(b,this.zSb)}mtf(b,h){h=this.BZb.Tff(h,this.zSb);return 0>b||
b>=h.length?null:h[b]}Q_n(b,h){var t=this.Px.LE(h);t=this.BZb.G6h(t,h,this.zSb);t=-1!==t?Math.floor(t/Gs.ydg)*Gs.ydg:0;return this.mtf(t+b,h)}d8l(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}zKm(b){this.t_a(b);return 0>=this.T_h(b).length}PRo(b,
h){if(!b||!h)return null;b=parseInt(b[Nd.Color]);var t=this.Px.LE(h);const A=this.Px.RQd(t);if(A===b)return null;if(16===A)return this.zSb=b,null;t=this.BZb.G6h(t,h,A);this.zSb=b;return this.mtf(t,h)}Oel(b){b=this.Px.LE(b);b=this.Px.RQd(b);if(16!==b)for(let h=0;h<this.Zud.length;h++)if(this.Zud[h]===b)return h;return-1}fyb(b){b.DWe(this.jwm,2)}static g8l(){return new nq(wu.instance,Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Sa.a.instance.resolve("WordEditor.IWACTableStyleReader"),xu.P8k(),
Uv.instance)}static get instance(){return null!=nq.$yg?nq.$yg:nq.$yg=nq.g8l()}}nq.LBo=4;Object(m.a)(nq,"TableStyleRibbonControls",Tv,[174,175]);var Uu=c(1545);class Bw extends So{constructor(b,h,t,A,O,aa,ua,Ra){super(b,h,t,A,O,aa,ua,Ra);this.Xec=(ub,Nb,Yb,bc,Dc)=>{if(!({Qx:ub}=this.Mnb(Nb,Yb,Dc,!1,!0)).returnValue)return ub;this.Leg.k2k(Dc,Nb.node);return 32};this.Wcb=(ub,Nb,Yb,bc,Dc)=>{if(!({Qx:ub}=this.Mnb(Nb,Yb,Dc,!1,!0)).returnValue)return 2==Yb&&8==ub&&Ht.a.recordQosError("TableStyleColorButtonClickNoResponse",
["TableInteractionFailed"],uf.a.fsl),ub;const Pc=Nb.node,jd=this.Leg.PRo(Dc,Pc);jd&&this.m8d(Pc,()=>{this.Iwd.S5a(jd,Pc)});return 32};this.nLb=(ub,Nb,Yb,bc,Dc)=>{if(!({Qx:ub}=this.Mnb(Nb,Yb,Dc,!0,!0)).returnValue)return ub;Dc[Nd.IndexColorSelected]=this.Leg.Oel(Nb.node);return 32}}Rfc(b){super.Rfc(b);this.ga.pa(Vc.a.Wcb,mc.a.view,this.fje);this.ga.pa(Vc.a.Wcb,mc.a.table,this.Wcb);this.ga.Uc(Vc.a.Wcb,1030);this.ga.pa(Vc.a.Xec,mc.a.view,b);this.ga.pa(Vc.a.Xec,mc.a.table,this.Xec);this.ga.Uc(Vc.a.Xec,
1126);this.ga.pa(Vc.a.nLb,mc.a.view,b);this.ga.pa(Vc.a.nLb,mc.a.table,this.nLb);this.ga.Uc(Vc.a.nLb,1127)}get Leg(){return this.Eud}static a8l(){return new Bw(Sa.a.instance.resolve("WordEditor.IWACTableStyleReader"),nq.instance,v.AFrameworkApplication.xa,Uu.a.instance,new vo.a,Sa.a.instance.resolve("Box4.IInsertionPointFormatting"),Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(rl.a.instance,rl.a.instance.sjb,"isTableNodeInLockedRange"))}static get instance(){return null!=
Bw.jyg?Bw.jyg:Bw.jyg=Bw.a8l()}}Object(m.a)(Bw,"TableStyleActor",So,[]);var Cw=c(1602);class Vu{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}yc(b){this.W=b;this.W.ha("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>wu.instance).singleInstance();this.W.ha("Box4.TableEditors.ITableStyleEditor",()=>Cw.a.instance).singleInstance();this.W.ha("Box4.TableEditors.IWACTableStyleEditor",()=>Uu.a.instance).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>
{this.$m()})}$m(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(110)&&(Bw.instance.Ub(),nq.instance.fyb(Lx.a.instance),Tf.StyleReader.gje=Cw.a.instance,Jb.App.ya.updateCommandUI())}dispose(){}}Object(m.a)(Vu,"TableStylePackage",null,[1,2]);var yB=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",
ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},
children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",
LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",
QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},
children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",
Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",
Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",
Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},ox=c(1446);class Xx{constructor(b,h){this.jKa=b;this.yza=h}KPn(b){this.jKa.tyd(b)}uCa(b){this.yza.uCa(b)}ENb(b,
h){return this.yza.ENb(b,h)}DNb(b,h){return this.yza.DNb(b,h)}Ake(b,h,t){this.yza.Ake(b,h,t)}}Object(m.a)(Xx,"ClientPaginationHeaderFooterBridge",null,[328]);class zB{constructor(b,h){this.Yl=b;this.ga=h;this.p$=new xq.a;this.q$=new xq.a}uCa(b){b=ue.GraphIterator.$a(b);if(b.Yo()&&b.pq()){b.Sd();do 10===b.Xe&&this.QWf(b.currentNode),b.gt();while(8!==b.Xe)}}ENb(b,h){var t=this.ZDb(h);if(!this.p$.ob(t))return u.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+
t),!1;h=this.p$.J(t);u.ULS.shipAssertTag(573400389,336,this.q$.ob(t),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");t=this.q$.J(t);return this.ivf(h,b,t)}DNb(b,h){var t=this.ZDb(h);if(!this.p$.ob(t))return u.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+t),!1;h=this.p$.J(t);u.ULS.shipAssertTag(573400391,336,this.q$.ob(t),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");
t=this.q$.J(t);return this.djf(h,b,t)}Ake(b,h,t){h=this.qsf(h,t);this.ga.Rb(b?Vc.a.Vme:Vc.a.tad,2,h)}qsf(b,h){h=this.Yl.iDb(h);if(!h)return u.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.Yl.bga(h);const t=1===b;b=!(b%2);return 1===h?1:2===h?t?2:1:3===h?b?3:4:t?2:b?3:4}QWf(b){if(10===b.type){var h=new xq.a,t=this.Yl.iDb(b);u.ULS.shipAssertTag(573400393,336,!!t,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");
var A=this.Yl.bga(t);b=this.ZDb(b);this.Fjg(b,A);this.Ejg(b,h);t=ue.GraphIterator.$a(t);if(t.pq()){t.Sd();do b=t.currentNode,A=this.Yl.hNc(b),b=this.Yl.jji(b),h.add(A,b),t.gt();while(36===t.Xe)}}}Fjg(b,h){this.q$.ob(b)?this.q$.Z(b,h):this.q$.add(b,h)}Ejg(b,h){this.p$.ob(b)?this.p$.Z(b,h):this.p$.add(b,h)}ZDb(b){u.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ia(Lc.a.Xha,0)}ivf(b,h,t){const A=1===h;h=!(h%2);switch(t){case 2:if(A){if(b.ob(2))return b.J(2)}else if(b.ob(0))return b.J(0);
break;case 3:if(h){if(b.ob(1))return b.J(1)}else if(b.ob(0))return b.J(0);break;case 4:if(A){if(b.ob(2))return b.J(2)}else if(h){if(b.ob(1))return b.J(1)}else if(b.ob(0))return b.J(0);break;case 1:if(b.ob(0))return b.J(0)}return!1}djf(b,h,t){const A=1===h;h=!(h%2);switch(t){case 2:if(A){if(b.ob(5))return b.J(5)}else if(b.ob(3))return b.J(3);break;case 3:if(h){if(b.ob(4))return b.J(4)}else if(b.ob(3))return b.J(3);break;case 4:if(A){if(b.ob(5))return b.J(5)}else if(h){if(b.ob(4))return b.J(4)}else if(b.ob(3))return b.J(3);
break;case 1:if(b.ob(3))return b.J(3)}return!1}}Object(m.a)(zB,"ClientPaginationPageAdornmentContentManager",null,[327]);class sz{constructor(b,h,t,A,O,aa){this.wXk=ua=>{1===ua&&this.$D.dE&&(ua=this.Xc.KDa(this.$D.dE,8,8),this.Yl.pLk(ua)?this.rcl(ua):this.$no())};this.YIo=ua=>{1===ua&&this.ga.Rb(qa.a.openInClient,2,!1)};this.$D=b;this.Yl=h;this.Xc=t;this.Ic=A;this.Lsc=O;this.ga=aa}poo(){const b=new cf.StandardDialog;b.zd=1;b.Ge(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);
b.MU(0);b.Au(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.wXk)}rcl(b){b.fd(8);const h=this.Ic.Qc(15);h.set(b.Kn.Wi);this.Lsc.URn(b);this.$D.dismiss();h.dispose();u.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}$no(){const b=new cf.StandardDialog;b.zd=1;b.Ge(1,Box4Intl.Box4Strings.L_OpenInWord);b.Ge(0,CommonUIStrings.l_Close);b.MU(0);b.Au(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,
0,this.YIo);u.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(m.a)(sz,"DeleteHeaderFooterDialog",null,[]);class pA{constructor(b,h,t,A,O){this.Yl=b;this.Xc=h;this.Ic=t;this.Lsc=A;this.ga=O}create(b){return new sz(b,this.Yl,this.Xc,this.Ic,this.Lsc,this.ga)}}Object(m.a)(pA,"DeleteHeaderFooterDialogFactory",null,[326]);class Vv{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb){this.Y9=null;this.qgg=(Yb,bc,Dc,Pc,jd)=>{var Cd=this.qtf(bc);return Cd?1===Dc?32:(Dc=this.control)?
(bc=this.Ic.Qc(15),bc.Eb(Cd),bc.kk=Yb,Dc.xaa?this.ga.processAction(Vc.a.iT,2):(Cd=this.PSh(Cd),Pc.Ur=Cd?1:0,Pc=Yb!==Vc.a.tad,(Yb=this.kof(Yb,jd))&&Dc.Xxa(Yb),this.ga.Rb(Vc.a.EHd,2,Pc)),bc.dispose(),32):8:8};this.hbf=(Yb,bc,Dc)=>{if(1===Dc)return 32;this.MUj.create(this.control).poo();return 32};this.DEn=(Yb,bc,Dc,Pc,jd)=>1===Dc?32:(Yb=this.control)?(jd[Ng.a.On]=Yb.xaa,32):8;this.Anb=(Yb,bc,Dc,Pc,jd)=>{if(1===Dc||!this.control.xaa)return 32;bc=this.S5h(Yb,jd);Dc=Vv.yfi(this.control.dE);Pc=this.Ic.Qc(15);
Pc.Eb(Dc);Pc.kk=Yb;Yb=this.Xc.Ck();Yb.set(Dc);this.kKa.Rff(Yb.currentNode,bc);this.Yl.LIb(Yb);this.Lsc.jhj(Yb,bc);Pc.dispose();return 32};this.Xxa=(Yb,bc,Dc,Pc,jd)=>{if(1===Dc)return 32;Yb=this.kof(Yb,jd);this.control.xaa&&this.control.Xxa(Yb);return 32};this.Zde=(Yb,bc,Dc,Pc,jd)=>{if(1===Dc)return 32;Yb=this.Pbi(Yb,jd);Pc.Ur=Yb;bc=this.qtf(bc);if(!bc)return 8;Pc=this.Xc.Ck();Pc.set(bc);Pc.Ab(8);Pc.rt(8);if(!this.Ok.G9m(Pc,Yb))return 8;this.Yl.LIb(Pc);this.control.ufa(Pc.currentNode);return 32};this.RWf=
(Yb,bc,Dc,Pc,jd)=>{if(1===Dc)return 32;Yb=this.Qfk.q7k(this.qtf(bc));jd.PopulationXML=Yb;return 32};this.O$d=(Yb,bc,Dc,Pc,jd)=>{Yb=this.S5h(Yb,jd);bc=this.control.dE;Dc=this.Yl.bga(bc);jd[Ng.a.On]=Yb===Dc;1===Yb&&(jd[Ng.a.LabelText]=this.zgi(bc)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.U9d=(Yb,bc,Dc,Pc,jd)=>{if(1===Dc||!this.control.xaa)return 32;bc=this.control.dE;void 0!==bc&&null!==bc&&(bc=this.Yl.bga(bc),
Yb=this.kof(Yb,jd),Dc=this.control.BSb,jd[Ng.a.Visible]=this.LAo(Yb,bc),jd[Ng.a.On]=Yb===Dc);return 32};this.SEn=(Yb,bc,Dc,Pc,jd)=>{if(1===Dc||!this.control.xaa)return 32;Yb=this.control.dE;void 0!==Yb&&null!==Yb&&this.Hxn(Yb,jd);return 32};this.cEn=(Yb,bc,Dc,Pc,jd)=>{if(1===Dc||!this.control.xaa)return 32;Yb=this.Pbi(Yb,jd);bc=this.control.dE;Dc=0;void 0!==bc&&null!==bc&&(Dc=bc.getValue(Lc.a.Xha));jd[Ng.a.On]=Yb===Dc;return 32};this.iT=(Yb,bc,Dc)=>{if(1===Dc)return 32;this.control.dismiss();return 32};
this.wTd=()=>32;this.EHd=(Yb,bc,Dc,Pc,jd)=>{if(1===Dc)return 32;this.control.show(jd);return 32};this.Njb=(Yb,bc,Dc,Pc,jd)=>{if(1===Dc)return 32;if(!jd)return 8;bc=jd.qZa;if(!bc||!bc.isConnected)return 8;Yb=this.Yl.u3d(bc);if(!({isHeader:Dc,tfg:bc}=this.Yl.Udi(bc)).returnValue)return 8;this.control.ufa(Yb);this.control.Xxa(bc);this.control.show(Dc,jd.Yfe);return 32};this.ga=b;this.Yl=h;this.Lsc=t;this.kKa=A;this.Ok=O;this.Xc=aa;this.Ic=ua;this.Qfk=Ra;this.kZj=ub;this.MUj=Nb}get control(){return this.Y9}set control(b){this.Y9=
b}Ub(){this.ga.pa(Vc.a.QUd,mc.a.view,this.qgg);this.ga.gb(Vc.a.NZf,mc.a.application,this.DEn,96);this.ga.pa(Vc.a.Vme,mc.a.view,this.qgg);this.ga.pa(Vc.a.tad,mc.a.view,this.qgg);this.ga.gb(Vc.a.wTd,mc.a.view,this.wTd,64);this.ga.pa(Vc.a.EHd,mc.a.view,this.EHd);this.ga.gb(Vc.a.iT,mc.a.application,this.iT,96);this.ga.gb(Vc.a.Njb,mc.a.application,this.Njb,96);this.ga.gb(Vc.a.s9n,mc.a.view,this.Xxa,96);this.ga.pa(Vc.a.vdj,mc.a.view,this.Xxa);this.ga.pa(Vc.a.xdj,mc.a.view,this.Xxa);this.ga.pa(Vc.a.wdj,
mc.a.view,this.Xxa);this.ga.pa(Vc.a.ydj,mc.a.view,this.Xxa);this.ga.gb(Vc.a.Lbo,mc.a.view,this.Anb,100);this.ga.gb(Vc.a.efj,mc.a.view,this.Anb,4);this.ga.gb(Vc.a.dfj,mc.a.view,this.Anb,4);this.ga.gb(Vc.a.bfj,mc.a.view,this.Anb,4);this.ga.gb(Vc.a.cfj,mc.a.view,this.Anb,4);this.ga.pa(Vc.a.Zde,mc.a.view,this.Zde);this.ga.pa(Vc.a.H7f,mc.a.view,this.Zde);this.ga.gb(Vc.a.RWf,mc.a.view,this.RWf,96);this.ga.gb(Vc.a.hbf,mc.a.view,this.hbf,4);this.ga.gb(Vc.a.CZi,mc.a.view,this.U9d,97);this.ga.gb(Vc.a.EZi,mc.a.view,
this.U9d,97);this.ga.gb(Vc.a.DZi,mc.a.view,this.U9d,97);this.ga.gb(Vc.a.FZi,mc.a.view,this.U9d,97);this.ga.gb(Vc.a.VZi,mc.a.view,this.O$d,97);this.ga.gb(Vc.a.UZi,mc.a.view,this.O$d,97);this.ga.gb(Vc.a.SZi,mc.a.view,this.O$d,97);this.ga.gb(Vc.a.TZi,mc.a.view,this.O$d,97);this.ga.gb(Vc.a.xEn,mc.a.view,this.SEn,97);this.ga.gb(Vc.a.kZf,mc.a.view,this.cEn,97)}PSh(b){const h=this.Yl.iDb(b),t=this.Yl.bga(h);b=this.kKa.Rff(b,t);this.control.ufa(h);return b}S5h(b,h){switch(b){case Vc.a.efj:case Vc.a.VZi:b=
1;break;case Vc.a.dfj:case Vc.a.UZi:b=2;break;case Vc.a.bfj:case Vc.a.SZi:b=3;break;case Vc.a.cfj:case Vc.a.TZi:b=4;break;default:b=h}return b}kof(b,h){switch(b){case Vc.a.vdj:case Vc.a.CZi:b=1;break;case Vc.a.xdj:case Vc.a.EZi:b=2;break;case Vc.a.wdj:case Vc.a.DZi:b=3;break;case Vc.a.ydj:case Vc.a.FZi:b=4;break;case Vc.a.Vme:case Vc.a.tad:b=h;break;case Vc.a.QUd:b=0;break;default:b=h}return b}Pbi(b,h){return b===Vc.a.H7f||b===Vc.a.kZf?parseInt(h.MenuItemId):h}qtf(b){return this.Ok.O7(b.Yj)}LAo(b,
h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}Hxn(b,h){const t=this.zgi(b);if(h[fp.a.Visible]=t)b=this.Ok.zfi(this.kZj(b)),b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[fp.a.LabelText]=b}zgi(b){const h=this.Xc.Ck();h.set(b);h.Ab(8);h.rt(8);return 1<this.Ok.Osf(h)}static yfi(b){const h=new ue.GraphIterator;h.set(b);h.Ab(10);return Iv.WordSectionNavigator.p1n(h)}}Object(m.a)(Vv,
"HeaderFooterActor",null,[]);var yu=c(618),uv=c(713);class tz{constructor(b,h,t,A,O){this.Z5j=b;this.Yl=h;this.Ok=t;this.Xc=A;this.ga=O}BSh(b,h){this.Yl.LIb(b);h=this.Snl(b,h);b.wc();return h}Rff(b,h){b=this.Xc.KDa(b,8,8);let t=!1;this.Ok.YNa(b,A=>{const O=this.Xc.Ck();O.set(A);t=(A=this.BSh(O,h))||t;return A});return t}Snl(b,h){if(3!==this.ga.mode)return!1;let t=!1;h=uv.a.Vbf(h);for(let A=0;A<h.length;++A)t=this.Z5j.Rnl(b,h[A])||t;return t}}tz.Zal=1;Object(m.a)(tz,"HeaderFooterInserter",null,[319]);
class vv{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){this.Kbh=this.cPg=!1;this.dE=null;this.uDe=!1;this.BSb=0;this.rJb=()=>{this.uDe=!0};this.x5=b;b.bind(this);this.nUe=A;this.lVj=ub;this.q5g=O;this.R6j=aa;this.k$a=ua;this.header=h;this.footer=t;this.header.t8k();this.x5.gz();this.wSe=tz.Zal;this.kKa=Ra;vv.ga=Nb;this.YM=Yb}get xaa(){return this.cPg}show(b=!0,h=!0){this.xaa||(this.nBj(),this.Bej(!0),this.header.$Mn(),this.lVj(),this.Suo(),v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.Una&&
(Rh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new yu.a,{state:0,disablePopover:!0}))):u.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));(this.Kbh=h)&&this.q5g(b)}dismiss(b=!1){this.xaa&&(this.R6j(b),this.Bej(!1),this.dBb(),this.BSb=0,this.Zvo(),v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.Una&&(Rh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new yu.a,{disablePopover:!1}))):u.ULS.sendTraceTag(509384031,
3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}Bej(b){this.cPg=b;vv.ga.processAction(qa.a.Cjf,2);this.x5.k0(b);this.header.k0(b);this.footer.k0(b);this.nUe()}ufa(b){this.dE!==b&&(this.dE=b,this.header.ufa(b),this.footer.ufa(b),this.BSb=0,this.Anb(this.k$a.bga(b)))}dBb(){this.dE&&(this.header.Peb(),this.footer.Peb(),this.dE=null)}update(){this.xaa&&this.GPb()}GPb(){this.dE&&(this.k$a.Bjl(this.dE)&&this.k$a.Ijm(this.dE)?this.nBj():this.dismiss())}nBj(){const b=this.k$a.bga(this.dE);
b!==this.wSe&&this.Anb(b)}Anb(b){this.wSe=b;this.Xxa(this.C8l(b))}C8l(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}Xxa(b,h=!0){this.BSb!==b&&(this.kKa.Rff(this.dE,this.wSe),this.header.udj(b),this.header.Trh(Hh.AppFrame.Waa),this.footer.udj(b),this.footer.Trh(Hh.AppFrame.Faa),this.BSb=b,this.xaa&&this.Kbh&&this.Aol(h))}Aol(b){this.q5g(b);b?this.header.setInitialSelection():this.footer.setInitialSelection()}dispose(){this.x5.A9();this.header.dispose();this.footer.dispose()}Suo(){this.YM.HCc(this.rJb);
this.uDe=!1}Zvo(){this.YM.Cbe(this.rJb);this.uDe&&vv.ga.processAction(Vc.a.wTd,2)}static Rgl(){vv.ga.Rb(ab.a.Fhb,2,!0);vv.ga.processAction(Vc.a.p7,2)}}vv.ga=null;Object(m.a)(vv,"HeaderFooterControl",null,[357,9]);class Yx{constructor(b,h,t,A,O){this.nUe=b;this.k$a=h;this.kKa=t;this.ga=A;this.YM=O}create(b,h,t,A,O){return new vv(b,h,t,this.nUe,A,O,this.k$a,this.kKa,vv.Rgl,this.ga,this.YM)}}Object(m.a)(Yx,"Factory",null,[325]);class Zx{constructor(){this.Y9=null}get control(){return this.Y9}set control(b){this.Y9=
b}mkf(b){return this.nkf(this.control.dE,this.control.BSb,b.isHeader,b)}nkf(b,h,t,A){return()=>{if(!b.isConnected)return null;this.control.ufa(b);this.control.Xxa(h);this.control.show(t);return A}}dismiss(){this.Y9.xaa&&this.Y9.dismiss()}}Object(m.a)(Zx,"HeaderFooterControlLauncher",null,[]);var oC=c(1156),pC=c(539),ps=c(293),My=c(816);class Dw{constructor(b,h,t){this.zkc=null;const A=h?"Header":"Footer";this.pr=b.ownerDocument.createElement("div");this.pr.id=h?"HeaderPane":"FooterPane";this.pr.classList.add(Dw.Ljm,
A);this.Cxb=(new My.a(this.pr,"WACViewPanel_"+A)).OH;this.pr.appendChild(this.Cxb);b.appendChild(this.pr);h&&(this.zkc=b.ownerDocument.createElement("div"),this.zkc.classList.add(Dw.Qjm),this.pr.appendChild(this.zkc));this.VHg=t.XZl(this.pr)}bind(){}k0(b){b?this.VHg.dvk():this.VHg.fvk()}nDk(b){b.Nyb(this.Cxb)}}Dw.Qjm="HeaderToolbarContainer";Dw.Ljm="HeaderFooterPane";Object(m.a)(Dw,"PaneControlDom",null,[394]);class Hs{constructor(b,h,t,A,O){this.$D=this.Dq=null;this.wPi=()=>{this.$D.dismiss(!0);
if(this.DTb){const aa=new Uw.a(!0);this.DTb.yGa(aa)}return!0};this.rB=aa=>{aa.Ib.preventDefault();return!1};this.pr=b.ownerDocument.createElement("div");this.pr.id=Hs.YEh;this.pr.className=Hs.YEh;this.cZ=A;this.DTb=O;this.hji=new Dw(this.pr,!0,h);this.c6k(this.pr);this.lYh=new Dw(this.pr,!1,h);this.k0(!1);b.appendChild(this.pr)}c6k(b){this.Dq=b.ownerDocument.createElement("div");this.Dq.id=Hs.srn;this.Dq.className=Hs.qrn;this.Dq.tabIndex=0;this.Dq.setAttribute(Mf.a.oh,Mf.a.z2);this.Dq.setAttribute(Mf.a.Bea,
WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.Dq)}bind(b){this.$D=b}k0(b){if(!b&&this.cZ){var h=new Uw.a(!0);this.cZ.yGa(h)}!b&&this.DTb&&(h=new Uw.a(!0),this.DTb.yGa(h));this.pr.style.display=b?"":"none";this.hji.k0(b);this.lYh.k0(b)}fbo(){this.Dq.focus()}gz(){Pd.a.instance.mb(db.a.click,this.Dq,this.wPi);Ud.a.instance.mb(db.a.yx,this.pr,this.rB)}A9(){Pd.a.instance.sc(db.a.click,this.Dq,this.wPi);Ud.a.instance.sc(db.a.yx,this.pr,this.rB)}}Hs.YEh="HeaderFooterControl";
Hs.srn="HeaderFooterOverlay";Hs.qrn="EditingSurfaceOverlay HeaderFooterOverlay";Object(m.a)(Hs,"HeaderFooterControlDom",null,[356]);class Wv{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb){this.x5=null;this.ra=new If.a;this.$D=this.psd=null;this.nRf=Yb=>{this.g9(Yb);this.ra.raiseEvent("OnShowEventKey")};this.mRf=Yb=>{this.qf&&(this.psd=new oC.a(this.qf));this.Vb.LHc(Hh.AppFrame.Waa);this.Vb.LHc(Hh.AppFrame.Faa);this.tca(Yb);this.ra.raiseEvent("OnDismissEventKey")};this.F7d=()=>{this.psd&&(this.psd.dispose(),
this.psd=null)};this.Vb=b;this.Zo=h;this.e7g=t;this.JZj=A;this.I8j=O;this.ga=aa;this.CMg=pC.a.create();this.xQg=sb.KeyInputManager.mc(rc.a.ks,0);this.TY=sb.KeyInputManager.mc(rc.a.Q0,0);this.Gdk=sb.KeyInputManager.mc(rc.a.rIa,0);this.hI=ua;this.Na=Ra;this.cZ=ub;this.DTb=Nb;this.qf&&this.qf.Xka(this.F7d)}Wmh(b){this.ra.addHandler("OnShowEventKey",b)}tVn(b){this.ra.removeHandler("OnShowEventKey",b)}tyd(b){this.ra.addHandler("OnDismissEventKey",b)}O5i(b){this.ra.removeHandler("OnDismissEventKey",b)}get qf(){const b=
this.hI.value;return b?b.Yi?b:(u.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(u.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.$D}get RZk(){return this.CMg}bind(b){this.$D=this.ZXk(b);this.CMg.instance=this.$D}ZXk(b){this.x5=new Hs(b,this.I8j.value,this.Na,this.cZ,this.DTb);b=this.e7g.value.create(this.ga,this.x5.hji,!0,Hh.AppFrame.Waa);const h=this.e7g.value.create(this.ga,
this.x5.lYh,!1,Hh.AppFrame.Faa);this.$D=this.JZj.value.create(this.x5,b,h,this.nRf,this.mRf);this.xxf();this.GS();return this.control}xxf(){var b=3===this.ga.mode?Hh.AppFrame.xE:Hh.AppFrame.Nfc;const h=this.Vb.fe(Hh.AppFrame.Waa);h.parent=b;this.Vb.RWe(Hh.AppFrame.Waa);const t=this.Vb.fe(Hh.AppFrame.Faa);t.parent=b;this.Vb.RWe(Hh.AppFrame.Faa);b=this.Vb.fe(ps.a.LEb);b.parent=vf.AFrame.qp;b.pea(()=>{this.x5.fbo()});b.bindAction(this.xQg,Vc.a.iT);b.bindAction(this.TY,Vc.a.iT);b.bindAction(this.Gdk,
Vc.a.iT);h.bindAction(this.TY,Vc.a.iT);t.bindAction(this.TY,Vc.a.iT)}GS(){this.Zo.GS(Hh.AppFrame.Waa);this.Zo.GS(ps.a.g1a);this.Zo.GS(Hh.AppFrame.Faa);this.Zo.GS(ps.a.LEb)}g9(b){this.Zo.nI(Hh.AppFrame.Waa);this.Zo.nI(ps.a.g1a);this.Zo.nI(Hh.AppFrame.Faa);this.Zo.nI(ps.a.LEb);this.Zo.nx(vf.AFrame.$n);this.Vb.iCc(Hh.AppFrame.Waa);this.Vb.iCc(Hh.AppFrame.Faa);b?this.Vb.mg(Hh.AppFrame.Waa):this.Vb.mg(Hh.AppFrame.Faa)}tca(b){this.Zo.nx(Hh.AppFrame.Waa);this.Zo.nx(ps.a.g1a);this.Zo.nx(Hh.AppFrame.Faa);
this.Zo.nx(ps.a.LEb);this.Zo.nI(vf.AFrame.$n);(b||this.Vb.currentScope&&(this.Vb.currentScope.name===Hh.AppFrame.Waa||this.Vb.currentScope.name===ps.a.g1a||this.Vb.currentScope.name===Hh.AppFrame.Faa||this.Vb.currentScope.name===ps.a.LEb))&&this.Vb.mg(vf.AFrame.$n)}dispose(){const b=this.Vb.fe(ps.a.LEb);b.Xq(this.xQg);b.Xq(this.TY);this.Vb.fe(Hh.AppFrame.Waa).Xq(this.TY);this.Vb.fe(Hh.AppFrame.Faa).Xq(this.TY);this.qf&&this.qf.Ebe(this.F7d);this.control.dispose()}}Object(m.a)(Wv,"HeaderFooterControlOwner",
null,[323,324]);var qC=c(1105);class qA{constructor(b,h,t,A,O,aa){this.Yl=b;this.Xc=h;this.i8j=t;this.Zl=A;this.l8j=O;this.LZj=aa}jtm(b,h){const t=this.Xc.Ck();t.set(b);this.Yl.MIb(t,h);this.i8j(t);this.l8j(t.currentNode,this.Zl);this.LZj.ktm(t,qC.a(h))}}Object(m.a)(qA,"HeaderFooterDefaultContentInserter",null,[321]);class Hq{constructor(b,h,t,A,O,aa,ua,Ra){this.AS=b;this.Dek=h;this.Tse=t;this.Zl=A;this.k8j=O;this.Zck=aa;this.AZj=ua;Hq.Hh=Ra}ktm(b,h){this.Dek(b,1,3,null,!1);this.AS.U5c(Aw.a.jmg,1696,
b.currentNode);this.Tse(b,0,this.Zl?3:1,h);this.Tse(b,1,2,h);this.Tse(b,2,this.Zl?1:3,h);this.k8j(b);this.Zck(b,!1,!0,null);this.AZj(b,h)}static get EG(){return null!=Hq.XFg?Hq.XFg:Hq.XFg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get paragraphEditor(){return null!=Hq.YBg?Hq.YBg:Hq.YBg=Sa.a.instance.resolve("Box4.IParagraphEditor")}static o$n(b,h,t){Wh.moveToCellContent(b,0,h);wg.OutlineElementNavigator.Fe(b);Hq.EG.tfe(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);Hq.paragraphEditor.LD(b.currentNode,
t);h||Hq.paragraphEditor.Xp.$xa(b,1,-115);2===h&&Hq.paragraphEditor.Xp.aNb(b.currentNode,1,-115);Wh.returnToContainingTable(b)}static Jbo(b,h){wg.OutlineElementNavigator.Fe(b);Hq.EG.tfe(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);wg.OutlineElementNavigator.Zd(b)}static CHl(){return(b,h,t)=>{Hq.o$n(b,h,t)}}static OQl(){return(b,h)=>{Hq.Jbo(b,h)}}static M7l(b){return(h,t,A,O,aa)=>b.ICa(h,t,A,O,aa)}static L5l(){return(b,h,t,A,O)=>Hq.Hh.uC(b,h,t,A,O)}}
Hq.Hh=null;Object(m.a)(Hq,"HeaderFooterDefaultTableInserter",null,[322]);class zu{constructor(b,h,t,A){this.Yl=b;this.lpd=h;this.Xc=t;this.Ok=A}jhj(b,h){b.Kn.properties.setValue(Lc.a.Juf,2===h||4===h);b.Ab(8);b.O$c(8).properties.setValue(Lc.a.gTd,3===h||4===h)}URn(b){this.Ok.YNa(b,h=>{const t=this.Xc.Ck();t.set(h);this.Yl.LIb(t);this.jhj(t,1);this.VRn(t);return!0})}VRn(b){for(;b.Sd();)b.Dg()}}Object(m.a)(zu,"HeaderFooterEditor",null,[320]);var AB=c(1110);class BB extends Yp.a{constructor(b){super();
this.pUe=b}get index(){return 0}run(){this.pUe()}Hjm(b,h){h.property===Lc.a.Juf&&this.sJ()}Qrn(b,h){h.property===Lc.a.gTd&&this.sJ()}sJ(){this.eY()}}Object(m.a)(BB,"ControlUpdateNeededTracker",Yp.a,[]);class Ny{constructor(b,h,t,A,O,aa){this.Z8a=null;this.KZj=t;this.Lid=h;this.iUb=b;this.z8j=A;this.iLa=aa}start(){this.iUb.bind(Jb.App.ya.QC);this.Lid.control=this.iUb.control;this.Lid.Ub();this.KZj.control=this.iUb.control;this.z8j.value.create(this.iUb.control,Object(z.a)(this.Lid,this.Lid.PSh,"ensureSectionHeaderFooterAttachedToControl")).Ub();
this.jlm()}jlm(){this.Z8a=new BB(()=>{this.iUb.control.update()});const b=Jb.App.jk.Kl;b.af(35).Ro(Object(z.a)(this.Z8a,this.Z8a.Hjm,"headerFooterContainerNodePropertyChanged"));b.af(8).Ro(Object(z.a)(this.Z8a,this.Z8a.Qrn,"pageContentNodePropertyChanged"));AB.a.Sae(Object(z.a)(this.Z8a,this.Z8a.sJ,"setUpdateNeeded"));Ar.GraphTransactionManager.instance.Cpa(this.Z8a,3)}dispose(){this.iUb.dispose();this.iLa.sOh()}}Object(m.a)(Ny,"HeaderFooterManager",null,[]);class rA{constructor(b,h,t,A){this.Ok=
b;this.Yl=h;this.Y5j=t;this.Hve=A}Rnl(b,h){let t=!1;const A=uv.a.Tpf(h);b.Xr(A)||(this.stm(b,h),this.Hve.jtm(b.currentNode,h),t=!0);return t}stm(b,h){const t=this.Y5j.create(1074135123),A=b.currentNode.ia(Lc.a.Xha,0);t.properties.setValue(Lc.a.Xha,A);t.properties.setValue(Lc.a.l8b,h);h=uv.a.Tpf(h);b.Qf(t,h)}}Object(m.a)(rA,"HeaderFooterNodeLevelInserter",null,[314]);var qs=c(239),Ai=c(429);class wv extends qs.a{constructor(b,h,t){super(b,h,"","");this.$ub=null;this.sji=wv.xLh;this.QPc=[];this.VAe=
t}get DA(){return!0}get cssClass(){return"cui-herodock"}rm(){this.TMn();super.rm()}HNa(){for(const b of this.QPc)b.PId();super.HNa()}Mto(){let b,h,t;b=[];h=[];t=[];for(let A=0;A<this.QPc.length;A++){const O=this.QPc[A];O.visible?b.length<this.sji?b.push(O):Object(hc.a)(Ai.FlyoutAnchor,O)?Array.addRange(h,O.yKl()):h.push(O):t.push(O)}return{LDo:b,orn:h,qwm:t}}b6k(b){if(!b||!b.length)return null;const h=new zh.Menu(this.root,this.id+"OverflowMenu",null,null,null),t=new Lq.a(this.root,this.id+"OverflowMenuSection",
null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const A of b)t.Qf(A.YP("Menu20"));h.Qf(t);return h}TMn(){this.jbe();this.Pc=Rb.a.QRa(this.Pc);this.kC();var b;({LDo:t,orn:b,qwm:A}=this.Mto());for(var h of t){var t=h.YP("Medium20");t.enabled=!0;this.TZb(t,this.children.count);this.Pc.appendChild(t.Pc);t.jma()}if(b=this.b6k(b))this.$ub?this.$ub.menu=b:(h=this.id+"OverflowMenuLauncher",t={},t.Image20by20=this.VAe.OverflowMenuImage20by20,t.Image20by20Class=this.VAe.OverflowMenuImage20by20Class,
t.PopulateDynamically="false",t.HideDefaultArrow="true",t.Alt=this.VAe.OverflowMenuTooltip,t.Command="798637440",t.Id=h,this.$ub=new Ai.FlyoutAnchor(this.root,h,t,b)),b=this.$ub.YP("Small20"),b.enabled=!0,this.TZb(b,this.children.count),this.Pc.appendChild(b.Pc),b.jma();if(v.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const O of A){var A=O.YP("Medium20");this.Qf(A);A.jma()}}dispose(){this.$ub&&(this.$ub.dispose(),this.$ub=null);for(const b of this.QPc)b.dispose();
this.jbe();super.dispose()}set DA(b){super.DA=b}}wv.xLh=4;Object(m.a)(wv,"HeroDock",qs.a,[]);var $x=c(624);class sA extends $x.a{constructor(){super();this.Aie=this.HGm=this.Bvo=!1;this.n5m=v.AFrameworkApplication.$Bf?1:wv.xLh}}Object(m.a)(sA,"ToolbarBuildOptions",$x.a,[]);var Pi=c(51),uz=c(873),Is=c(722);class ay extends qs.a{constructor(b,h,t){super(b,h,"","");this.wnc=t.Alignment;this.HPg=t.ScalingDirection===Pi.a.RHj}rm(){this.Iua();this.yW(this.Pc);super.rm()}yW(b){for(let h of this.children){h.kC();
switch(this.wnc){case Pi.a.uoe:Rb.a.Xf(h.Pc,"cui-toolbar-button-left");break;case Pi.a.R7a:Rb.a.Xf(h.Pc,"cui-toolbar-button-center");break;case Pi.a.AQb:Rb.a.Xf(h.Pc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.wnc);}h.visible&&b.appendChild(h.Pc);h.jma()}}YN(b){if(!Object(hc.a)(Mi.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");}get cssClass(){switch(this.wnc){case Pi.a.uoe:return"cui-toolbar-buttondock alignleft";case Pi.a.R7a:return"cui-toolbar-buttondock aligncenter";
case Pi.a.AQb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.wnc);}}get DA(){return!0}get alignment(){return this.wnc}R7b(){let b=0;if(this.alignment===Pi.a.R7a)for(let h of this.children){const t=h;t.visible&&(b+=t.Pc.offsetWidth)}else b=this.Pc.offsetWidth;return b}BQd(){let b=null;if(this.alignment===Pi.a.R7a)for(let h of this.children){if(h.visible){b=Sys.UI.DomElement.getBounds(h.Pc);break}}else b=Sys.UI.DomElement.getBounds(this.Pc);return b?0===this.root.x0?
b.x:b.x+b.width:0}BNd(){let b=null;if(this.alignment===Pi.a.R7a){if(0<this.children.count){const h=this.children.CNd(this.children.count-1);for(;h.F3a();){const t=h.get_current();if(t.visible){b=Sys.UI.DomElement.getBounds(t.Pc);break}}}}else b=Sys.UI.DomElement.getBounds(this.Pc);return b?0===this.root.x0?b.x+b.width:b.x:0}Kff(){for(let b of this.children){const h=b;if(!Object(hc.a)(Mi.a,h)||h.control.visible)h.visible=!0}}x4n(b){const h=this.children.toArray(),t=new Is.a;let A=this.HPg?0:h.length-
1;const O=this.children.count,aa=this.root.VSa;for(;this.R7b()>=b&&!(A>=O||0>A);){const ua=h[A];aa&&Object(hc.a)(Mi.a,ua)&&ua.control.visible&&(t.add(ua),ua.bqh());A+=this.HPg?1:-1}for(let ua of t)ua.s4i(),ua.visible=!1}set DA(b){super.DA=b}}Object(m.a)(ay,"ButtonDock",qs.a,[]);class nt extends Xn.a{constructor(b,h,t,A,O,aa,ua=!1){super(b,h,aa);this.nra=this.GY=this.Aka=null;this.BIe=!1;this.E2a=A;this.Aie=O;this.tvd=0;Za.c(h.Size)||(h.Size===Pi.a.Lpg||t.options.HGm?this.tvd=0:h.Size===Pi.a.SKj&&
(this.tvd=1));this.Rfk=ua}get VSa(){return!0}Qf(b){super.Qf(b);Object(hc.a)(ay,b)&&!this.BIe&&(b.alignment===Pi.a.uoe?(this.Aka&&this.a9f(),this.Aka=b):b.alignment===Pi.a.R7a?(this.GY&&this.a9f(),this.GY=b):b.alignment===Pi.a.AQb&&(this.nra&&this.a9f(),this.nra=b))}a9f(){this.BIe=!0;this.nra=this.GY=this.Aka=null}hnb(b,h){b=this.yMc(b);Za.c(b)||b.visible===h||(b.visible=h,this.refresh())}rm(){super.rm();this.e2i(!0)}e2i(b){const h=this.root.Xzb;Za.c(this.Pc)&&this.u8k();this.Pc=Rb.a.QRa(this.Pc);
this.RPc&&this.Pc.appendChild(this.RPc);for(let t of this.children)t.visible&&(t.kC(),this.Pc.appendChild(t.Pc),t.jma());this.GY&&b&&this.qnl();h&&h.oY();this.dirty=!1}qnl(){if(this.GY.visible&&this.GY.children.count&&(this.nqh(0,0),this.Ajl(this.Aka,this.GY,this.nra))){let b=0,h=0;const t=this.Aka?this.Aka.R7b():0,A=this.nra?this.nra.R7b():0;if(0<A||0<t)A>t?(b=0,h=A-t):(b=t-A,h=0);this.nqh(b,h)}}Ajl(b,h,t){let A=!1;0===this.root.x0?(b&&(A=b.BNd()>h.BQd()),!A&&t&&(A=h.BNd()>t.BQd())):(b&&(A=b.BNd()<
h.BQd()),!A&&t&&(A=h.BNd()<t.BQd()));return A}nqh(b,h){0===this.x0?(this.GY.Pc.style.marginLeft=b+"px",this.GY.Pc.style.marginRight=h+"px"):(this.GY.Pc.style.marginRight=b+"px",this.GY.Pc.style.marginLeft=h+"px")}u8k(){this.kC()}Xt(){this.iPh(()=>{Qw.a.prototype.Xt.call(this)})}$oa(b){b=this.yMc(b);Za.c(b)||this.iPh(Object(z.a)(b,b.qm,"pollForStateAndUpdate"))}iPh(b){this.Occ=this.I3a=!1;b();if(this.I3a||this.Occ)this.Rfk||this.refresh(),this.scale()}YN(b){if(!Object(hc.a)(wv,b)&&!Object(hc.a)(ay,
b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(hc.a)(ay,b)&&b.alignment===Pi.a.R7a)for(let h of this.children)if(h.alignment===Pi.a.R7a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.tvd?(b+="cui-toolbar-onerow ",v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.o8||(b+="UITextTranformUpperCase ")):1===this.tvd&&(b+="cui-toolbar-singledock ");
return b+super.cssClass}get vua(){return"div"}get a9(){return 26}get ztj(){return this.EN}set ztj(b){this.EN=b}X1k(b){b=b[Pi.a.jw];return new ay(this.root,b.Id,b)}kC(){super.kC();this.Pc.setAttribute("role","toolbar");this.properties.Title&&this.Pc.setAttribute("title",this.properties.Title)}oIa(b){return this.root&&this.root.Qfc(b)?!0:!1}ibo(){this.tSa()}scale(){super.scale();if(!Rb.a.Fr(this.properties.Scale)||this.BIe)return!1;Za.c(this.Aka)||(this.Aka.visible=!0,this.Aka.Kff());Za.c(this.GY)||
(this.GY.visible=!0,this.GY.Kff());Za.c(this.nra)||(this.nra.visible=!0,this.nra.Kff());this.e2i(!1);const b=this.Pc.offsetWidth,h=Za.c(this.Aka)?0:this.Aka.R7b(),t=Za.c(this.GY)?0:this.GY.R7b(),A=Za.c(this.nra)?0:this.nra.R7b();A+t+h>=b&&(A+h>=b?(this.xji(this.GY),A>=b?(this.xji(this.Aka),this.e6f(this.nra,b)):this.e6f(this.Aka,b-A)):this.e6f(this.GY,b-A-h));this.I3a=!1;this.rm();return!1}xji(b){b&&(b.visible=!1)}e6f(b,h){b&&b.x4n(h)}}Object(m.a)(nt,"Toolbar",Xn.a,[864]);class vz extends nt{constructor(b,
h,t,A,O=!1){super(b,h,t,!1,!1,A,O);this.W0g=!0}get a9(){return 7}get cssClass(){return vz.Cvo+" "+super.cssClass}static get Cvo(){let b="cui-statusbar";v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.o8||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(m.a)(vz,"StatusBar",nt,[]);var by=c(516);class wz extends by.a{constructor(){super();this.toolbar=null;this.RYd=!1}}Object(m.a)(wz,"ToolbarBuildContext",by.a,[]);class tA extends Il.Builder{constructor(b,h,t,A){super(b,h,nd.Task.F7(t),
A);if(Za.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}f$f(b){this.root=b}get Agg(){return this.options}ZHk(){const b=new wz,h=new uz.a;h.id="toolbar";h.D1c=1;h.handler=Object(z.a)(this,this.rmn,"onReturnToolbarData");h.data=b;this.gua.dde(h)}rmn(b){this.f$f(this.aIk(b.Z0c,b.tGc));this.toolbar.ztj=this;this.toolbar.rm();this.placeholder.appendChild(this.toolbar.Pc);Rb.a.Xf(this.placeholder,"loaded");this.rta.continueWith(()=>{this.rta.result.pJb(this.toolbar)},
11)}aIk(b,h){var t=Pi.a.Rfa(b,Pi.a.CLj);Za.c(t)&&(t=Pi.a.Rfa(b,Pi.a.ZKj),h.RYd=!0);if(Za.c(t))throw Error.create("No toolbar element was present in the data");b=new Pi.a(t);t=v.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");h.RYd?this.f$f(new vz(b.attributes[Pi.a.id],b.attributes,this,this.C$,t)):this.f$f(new nt(b.attributes[Pi.a.id],b.attributes,this,this.Agg.Bvo,this.Agg.Aie,this.C$,t));this.toolbar.zta=this.options.zta;this.toolbar.ume=!0;this.toolbar.rm();b=Pi.a.Vv(Pi.a.Rfa(b.node,
Pi.a.zHj));h=this.CFk(b,h);for(const A of h)this.toolbar.Qf(A);return this.toolbar}CFk(b,h){const t=[];for(let A=0;A<b.length;A++)this.FPa(b[A])||Array.add(t,this.eGk(b[A],h));return t}eGk(b,h){const t=Pi.a.JNc(b);let A=null;t===Pi.a.bGj?A=this.LFk(b,h):t===Pi.a.eIj&&(A=this.CGk(b,h));return A}CGk(b,h){var t=new Pi.a(b);t=new wv(this.root,t.attributes[Pi.a.id],b[Pi.a.jw]);t.sji=this.Agg.n5m;b=Pi.a.Rfa(b,Pi.a.Ppb);b=Pi.a.Vv(b);const A=[];for(let aa=0;aa<b.length;aa++){var O=b[aa];this.FPa(O)||(O=this.Jea(O,
h),Array.add(A,O))}t.QPc=A;return t}LFk(b,h){new Pi.a(b);const t=this.toolbar.X1k(b);b=Pi.a.Rfa(b,Pi.a.Ppb);b=Pi.a.Vv(b);for(let A=0;A<b.length;A++){if(this.FPa(b[A]))continue;const O=this.$Hk(b[A],h);t.Qf(O)}return t}$Hk(b,h){var t=new Pi.a(b);const A=t.name;t=t.attributes[Pi.a.wmc];let O;O=h.RYd?"Small14":"Small";switch(A){case Pi.a.button:return b=this.Jea(b,h),b.YP(Za.b(t)?O:t);case Pi.a.xDa:return O=h.RYd?"Medium14":"Medium",b=this.Jea(b,h),b.YP(Za.b(t)?O:t);case Pi.a.label:return b=this.Jea(b,
h),b.YP(Za.b(t)?O:t);case Pi.a.separator:return b=this.Jea(b,h),b.YP("Small");case Pi.a.toggleButton:return b=this.Jea(b,h),b.YP(Za.b(t)?O:t);default:throw Error.create("Invalid control type.");}}}Object(m.a)(tA,"ToolbarBuilder",Il.Builder,[]);var zn=c(1458);class vj{constructor(b,h,t,A,O,aa){this.Ukb=()=>{this.toolbar.qm()};this.UH=b;b=new Fo.CuiHelper(tl.a.HYa,WordEditorIntl.WordEditorStrings,null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);A=new sA;A.AG={};aa=3!==aa.mode;A.AG.HeaderToolbarControlsRight=
aa;A.AG.HeaderToolbarButtonDockRight=aa;A.AG.HeaderToolbarButtonRemovePageNumbers=aa;O=new tA(A,this.UH,this,O);O.gua=new zn.a(vj.Rjm,b);O.ZHk();this.Mka=O.toolbar;t.execute(ua=>{this.toolbar.eF=ua});this.toolbar.refresh();this.toolbar.qm();this.Fh=h;h.mYa(this.Ukb)}get toolbar(){return this.Mka}dispose(){this.Fh.dgc(this.Ukb);this.toolbar&&(this.toolbar.dispose(),this.Mka=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.ibo()}Qgl(){this.toolbar.W2()}pJb(){}}vj.Rjm="WordEditorHeaderToolbarData";
Object(m.a)(vj,"HeaderFooterToolbar",null,[254,343]);class uA{constructor(b,h,t,A,O){this.Fh=b;this.Xue=h;this.jd=t;this.C$=A;this.ga=O}create(b){return new vj(b,this.Fh,this.Xue,this.jd,this.C$,this.ga)}}Object(m.a)(uA,"Factory",null,[313]);class Au{constructor(b,h){this.Xc=b;this.Ok=h}q7k(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.p7k(b)+"</Controls></MenuSection></Menu>"}yQl(b){const h=
this.Xc.Ck();h.set(b);h.Ab(8);h.fd(8);return h}p7k(b){if(!b)return"";let h="";b=this.yQl(b);this.Ok.YNa(b,t=>{const A=this.Ok.zfi(t);t=t.getValue(Lc.a.Xha);h+=Sk.k(t.toString(),t.toString(),Vc.a.H7f.toString(),Vc.a.kZf.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,A));return!0});return h}}Object(m.a)(Au,"HeaderFooterToolbarGenerator",null,[312]);var xz=c(136);class px extends fx.a{constructor(b,h,t,A,O,aa,ua,Ra){super(b,h,t,A);this.Ns=()=>{this.e$c(this.Cb)};
this.UH=b.container;this.Gv=document.createElement("div");this.sG(this.Gv);this.HAa=O;this.$Ja=aa;this.uo.execute(ub=>{ub.i4(this.Ns)});this.YJ=ua;if(this.eI=Ra)this.UH.style.backgroundColor=this.YJ.Z6b()}dispose(){super.dispose();this.uo.instance&&this.uo.instance.zmb(this.Ns)}get uo(){return null!=this.Rwg?this.Rwg:this.Rwg=Sa.a.instance.Sa("Common.IZoomManager")}IB(b){this.UH.classList.add("HeaderFooterViewElement");this.Gv.classList.add("HeaderFooterViewContent");this.e$c(b.currentNode)}Sca(b){this.Gv.parentNode&&
this.Gv.parentNode===this.UH||(this.UH.appendChild(this.Gv),this.$Ja.instance&&this.$Ja.instance.j$f(this.fc,this.UH));super.Sca(b)}FPb(b){xz.a.he(()=>{xz.a.prototype.FPb.call(this,b);this.Dyj();this.$Ja.instance&&this.$Ja.instance.Kxj(this.fc,this.Gv.style.paddingLeft,this.Gv.style.paddingTop)},"HFVE:UFO")}e$c(b){this.uo.instance&&this.uo.instance.Wad(this.Gv);this.Dyj();b=this.HAa.v7b(b);this.Gv.style.paddingLeft=b.p2b+"px";this.Gv.style.width=b.sGc+"px";this.$Ja.instance&&this.$Ja.instance.Kxj(this.fc,
this.Gv.style.paddingLeft,this.Gv.style.paddingTop)}Dyj(){if(this.uo.instance){this.Gv.style.paddingTop="";var b=om.a.mC(this.Gv);b.paddingTop&&(b=vc.a.zM(b.paddingTop),this.Gv.style.paddingTop=Math.round(b/this.uo.instance.ij)+"px")}}}Object(m.a)(px,"HeaderFooterViewElement",fx.a,[]);class CB{constructor(b,h,t,A){this.HAa=b;this.$Ja=h;this.YJ=t;this.eI=A}create(b,h,t,A){return new px(b,h,t,A,this.HAa,this.$Ja,this.YJ,this.eI)}}Object(m.a)(CB,"Factory",null,[311]);var qx=c(377),DB=c(205),wi=c(970),
Lt=c(588);class cy extends qx.a{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd,ee,Od){super(h,aa,ua,Ra,ub,DB.a.tki,Nb,Yb,bc,Dc,Pc,jd,Cd,ee,Od);this.isHeader=this.isHeader=b;this.YWa=O;this.YWa.s8c=this;A(this);this.Ned=t;this.Oza=document.createElement("div");this.Oza.setAttribute("Unselectable","on");this.Oza.setAttribute("hideselection","hideselection");this.Oza.setAttribute("style","outline:none;");this.Oza.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;
this.Oza.tabIndex=0;this.features.Ckj=!0;this.features.H3e=!0}get gBf(){return!0}jtf(){const b=this.Ned.mkf(this);return wi.ViewReference.GE(this,b)}Pcf(b){Object(hc.a)(cy,b)||this.Ned.dismiss()}get mvf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}mOc(){return Lt.a.sIi}onResize(){super.onResize();this.YWa.OSh()}nE(b,h=null){this.Oza.parentNode&&this.Oza.parentNode.removeChild(this.Oza);super.nE(b,h);this.YWa.ASh(this.Zc.Wi)}detach(){this.YWa.NSh();super.detach();this.Oza.parentNode||
this.container.insertBefore(this.Oza,this.container.firstChild)}O5c(){this.Qt?super.O5c():this.Oza.focus()}JLd(){this.onResize()}}Object(m.a)(cy,"HeaderFooterView",qx.a,[338,339,256,134,9,202,340,341,342]);class Zp{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd){this.Ned=b;this.Chk=h;this.Bhk=t;this.Gt=A;this.ed=O;this.Nka=aa;this.ga=ua;this.DVa=Ra;this.Fsa=ub;this.r6=Nb;this.iik=Yb;this.zt=bc;this.zy=Dc;this.Pf=Pc;this.uh=jd;this.Hed=Cd}create(b,h){return new cy(b,h,this.Ned,this.Chk,this.Bhk(),
this.Gt,this.ed,this.Nka,this.ga,this.DVa,this.Fsa,this.r6,this.iik,this.zt,this.zy,this.Pf,this.uh,this.Hed)}}Object(m.a)(Zp,"Factory",null,[310]);class Mt{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd,ee,Od){this.Z6g=!1;this.gdh="SourceControlId";this.cCo=1;this.dCo=1E3;this.q$d=(fe,Ee,re,Fg,Gg)=>{if(1===re)return 32;this.iid(Gg[this.gdh]);Gg[Cl.a.Text]=this.UKe.esn(this.Uab.kFb);return 32};this.CEn=(fe,Ee,re,Fg,Gg)=>{if(1===re)return 32;Gg[Ng.a.On]=this.Uab.kFb;return 32};this.bom=(fe,
Ee,re,Fg,Gg)=>{if(1===re)return 32;this.Uab.FOo(Gg[Ng.a.On]);return 32};this.Q4i=(fe,Ee,re)=>{if(1===re)return 32;if(this.Y9){Ee=Mt.eh.Ms(Ee.view.Zc);re=ue.GraphIterator.$a(Ee);const Fg=this.Wd.DYa();try{const Gg=this.Ic.Qc(15);try{Gg.Eb(Ee),Gg.kk=fe,Aq.a.instance.YNa(re,bm=>{this.AWb.J2c(bm,this.vLl,this.uco);return!0})}finally{Gg&&Gg.dispose()}}finally{Fg&&Fg.dispose()}}return 32};this.g0c=(fe,Ee,re,Fg,Gg)=>{if(1===re)return 32;Gg.MenuItems=this.B8j.value;this.Z6g?this.Uab.MZn():this.Z6g=!0;return 32};
this.num=(fe,Ee,re,Fg,Gg)=>{if(1===re)return 32;const bm=this.iid(Gg[this.gdh]);if(this.Y9){Ee=Mt.eh.Ms(Ee.view.Zc);re=ue.GraphIterator.$a(Ee);Fg=this.Ic.Qc(15);try{Fg.Eb(Ee);Fg.kk=fe;let An=null;const Zr=this.ge.eg("UserAction","InsertPageNumber");Aq.a.instance.YNa(re,Av=>{this.Y9.xaa||this.lWj(Av);An=this.TKe.kum(Av,bm,this.Uab.kFb)||An;return!0});Zr.stop();if(!An)return 8;this.bpo(An,bm)}finally{Fg&&Fg.dispose()}this.Wd.Bs(12)}return 32};this.dsn=()=>32;this.Hpo=(fe,Ee,re,Fg,Gg)=>{if(1===re)return 32;
2===re&&this.iLa.showCallout(Gg);return 32};this.Gpo=(fe,Ee,re,Fg,Gg,bm)=>this.iQe.create(fe,Ee,re,Fg,Gg,bm);this.Tgl=(fe,Ee,re)=>{if(1===re)return 32;this.iLa.sOh();return 32};this.Vno=fe=>{v.AFrameworkApplication.xa.dpa(null,Vc.a.emj,fe.customData,null)};this.vLl=fe=>{const Ee=he.a.instance.hb.lb;let re=-1;for(const Fg of Ee)if(Fg.node===fe){re=Fg.cpBegin;break}return{returnValue:re,AXd:nf.SelectionEditor.hm(Ee)}};this.uco=(fe,Ee)=>{fe=wf.SelectionFactory.te(fe,Ee);he.a.instance.setSelection(fe)};
this.ga=b;this.Ic=h;this.Gb=t;this.Uab=A;this.Y9=O;this.Yl=aa;this.UKe=ua;this.TKe=Ra;this.AWb=ub;this.iLa=Nb;this.ib=Yb;this.iQe=bc;this.ge=Dc;this.Wd=Pc;this.iid=jd;this.lWj=Od;this.B8j=new Pg.a(()=>this.Uab.RZl())}Ub(){this.ga.gb(Vc.a.g0c,mc.a.view,this.g0c,100);this.ga.gb(Vc.a.VTi,mc.a.view,this.dsn,68);this.ga.gb(Vc.a.Nni,mc.a.view,this.num,4);this.ga.gb(Vc.a.kFb,mc.a.view,this.bom,4);this.ga.gb(Vc.a.J2c,mc.a.view,this.Q4i,4);this.ga.gb(Vc.a.PTn,mc.a.view,this.Q4i,4);this.ga.gb(Vc.a.LZf,mc.a.application,
this.CEn,97);this.ga.gb(Vc.a.q$d,mc.a.application,this.q$d,97);this.ga.gb(Vc.a.dmj,mc.a.view,this.Hpo,4);this.ga.FS(Vc.a.emj,mc.a.view,this.Gpo,100);this.ga.gb(Vc.a.Sgl,mc.a.view,this.Tgl,4)}bpo(b,h){const t=b.Kb.paragraph;if(t){var A=this.Yl.u3d(t);A&&this.Y9.ufa(A)}A=this.Y9.xaa;this.Y9.show(4>h);t&&this.Kbo(t)&&(this.Pfo(b,t),this.xok(b,A))}Kbo(b){let h;if(!({isHeader:h,tfg:b}=this.Yl.Udi(b)).returnValue)return!1;this.Y9.Xxa(b,h);return!0}Pfo(b,h){b=wf.SelectionFactory.te(h,b.Kb.cp);this.ib.setSelection(b)}xok(b,
h){h=new Vb.a(2,1,h?this.cCo:this.dCo,this.Vno);h.customData=b;this.Gb.Wb(h)}static get eh(){return fm.PageNavigator.instance}}Object(m.a)(Mt,"PageNumbersActor",null,[337]);class yz{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc){this.ga=b;this.Gb=h;this.Uab=t;this.UKe=A;this.TKe=O;this.AWb=aa;this.iLa=ua;this.iQe=Ra;this.Yl=ub;this.Wd=Nb;this.iid=Yb;this.Lgk=bc;this.hea=Dc}create(b,h){return new Mt(this.ga,new vo.a,this.Gb,this.Uab,b,this.Yl,this.UKe,this.TKe,this.AWb,this.iLa,he.a.instance,this.iQe,
Jb.App.ya.xq,this.Wd,this.iid,this.Lgk,this.hea,h)}}Object(m.a)(yz,"Factory",null,[309]);var rx=c(1930),Xv;(function(b){b[b.small=0]="small";b[b.mediumSmall=1]="mediumSmall";b[b.medium=2]="medium";b[b.large=3]="large"})(Xv||(Xv={}));Object(m.b)("ModalCalloutSize",Xv);var $p;(function(b){b[b.topCenter=0]="topCenter";b[b.topJustified=1]="topJustified";b[b.topLeft=2]="topLeft";b[b.topRight=3]="topRight";b[b.bottomCenter=4]="bottomCenter";b[b.bottomLeft=5]="bottomLeft";b[b.bottomRight=6]="bottomRight"})($p||
($p={}));Object(m.b)("BeakLocation",$p);class vA{constructor(b,h,t){this.bCo=1;this.lNe=!1;this.RXb=null;this.yOn=()=>{this.ib.gx(this.epa);this.lNe=!0;this.RXb=null};this.epa=(A,O)=>{if(A=O.sl.lb)1<A.length||!A.length?A=!0:(A=A.Qa,A=A.cpEnd-A.cpBegin,A=1<A||!A),A&&this.jVj()};this.Gb=b;this.ib=h;this.jVj=t}gz(){this.wok()}A9(){this.lNe?(this.ib.lY(this.epa),this.lNe=!1):this.RXb&&(this.Gb.Se(this.RXb),this.RXb=null)}wok(){this.RXb=new Vb.a(2,1,this.bCo,this.yOn);this.Gb.Wb(this.RXb)}}Object(m.a)(vA,
"CalloutDismissManager",null,[]);class Ew{constructor(b,h,t,A){this.dismiss=()=>{this.Iw&&(this.Dqc.A9(),this.FXc.dismiss())};this.FXc=b;this.Mp=A;this.Dqc=new vA(h,t,this.dismiss)}get Iw(){return this.FXc.Iw}show(){if(!this.Iw){const b=document.createElement("div");b.classList.add(Ew.csn);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.FXc.content=b;this.FXc.show();this.Mp&&this.Mp.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.Dqc.gz()}}dispose(){this.dismiss();
this.FXc.dispose()}static n5k(b,h){h=rx.a.hIh(ff.a.getElementBounds(b.targetElement),h,Jb.App.ya.QC,Xv.small);h.Fea=Ew.Llf(b);h.ht=!1;return h}static Llf(b){let h=$p.bottomCenter;Object(hc.a)(338,b.view)&&b.view.isHeader&&(h=$p.topCenter);return h}}Ew.csn="PageNumbersCalloutControl";Object(m.a)(Ew,"PageNumbersCallOutControl",null,[336]);class zz{constructor(b,h,t){this.pS=null;this.hS=!1;this.dismiss=()=>{this.Iw&&this.pS&&oh.UISurfaces.fM().then(A=>{this.Dqc.A9();A.removeNotification(this.pS);this.hS=
!1;return null},A=>{u.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",A);return null})};this.ol=b;this.Dqc=new vA(h,t,this.dismiss)}get Iw(){return this.hS}show(){this.Iw||oh.UISurfaces.fM().then(b=>{const h=b.callout(Object.assign(new zr.a,{target:this.ol,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),t=Object.assign(new Qr.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.hS=!0},expirationOptions:Object.assign(new Pn.a,{displayTimeoutSeconds:7,
onExpire:()=>{this.dismiss()}})});this.pS=b.addNotification(h,t);this.Dqc.gz();return null},b=>{u.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(m.a)(zz,"ReactPageNumbersCallOutControl",null,[336]);class EB{constructor(b,h,t){this.ib=h;this.Gb=b;this.Mp=t}create(b,h){if(v.AFrameworkApplication.ta.Ob&&v.AFrameworkApplication.ta.Ob.LPa)return new zz(h.targetElement,this.Gb,this.ib);b=Ew.n5k(h,b);return new Ew(b,this.Gb,this.ib,this.Mp,v.AFrameworkApplication.ta.WO)}}
Object(m.a)(EB,"Factory",null,[308]);class Fw{constructor(b,h){this.$D=null;this.A8j=b;this.Ri=h}get control(){return this.$D}showCallout(b){this.control&&this.control.Iw&&this.control.dismiss();this.$D=this.rzn(b);this.control.show()}sOh(){this.control&&(this.control.dismiss(),this.$D=null)}rzn(b){const h=this.Ri.Dma();this.$D=this.A8j.value.create(h,b);return this.control}}Object(m.a)(Fw,"PageNumbersCalloutControlManager",null,[307]);var wA=c(769);class FB extends Ih.a{constructor(){super();this.Text=
null}get Type(){return 7}}Object(m.a)(FB,"PageNumberGalleryButtonProps",Ih.a,[]);const Js=(b,h,t)=>{b=b.Ck();b.set(t);h.LIb(b);return b};class Xs{constructor(b,h,t){this.eCe=!1;this.hea=h;this.Zl=t}get kFb(){return this.eCe}RZl(){const b=Object.assign(new gj.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.amk());b.MenuSectionList.push(this.Smk());b.MenuSectionList.push(this.unk());return b}FOo(b){this.eCe=b;this.c2i()}MZn(){this.eCe=!1;const b={};b[Xs.Ili]="CheckboxModel";
this.hea(b);this.c2i()}amk(){const b=Object.assign(new eh.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:F.a.Af(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new wA.a,{Id:Xs.com,Command:Vc.a.kFb.toString(),QueryCommand:Vc.a.LZf.toString(),LabelText:F.a.Af(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:F.a.Af(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,
UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}Smk(){const b=Object.assign(new eh.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),h=Object.assign(new Di.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.Zl){for(var t=3;1<=t;t--)h.GalleryItems.push(this.dof(t));for(t=6;4<=t;t--)h.GalleryItems.push(this.dof(t))}else for(t=
1;6>=t;t++)h.GalleryItems.push(this.dof(t));b.ControlList.push(h);return b}unk(){const b=Object.assign(new eh.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new Eh.a,{Id:"btnRemovePageNumber",Command:Vc.a.J2c.toString(),LabelText:F.a.Af(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:F.a.Af(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:v.AFrameworkApplication.Ks,Image16by16Class:dh.getImageClass("WordRemovePageNumbers_16x16x32"),
KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}dof(b){const h=Xs.DUf+b.toString();var t=Object,A=t.assign,O=new FB,aa=Vc.a.Nni.toString(),ua=Vc.a.q$d.toString(),Ra=F.a,ub=Ra.Af;let Nb="";switch(b){case 1:Nb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Nb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Nb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Nb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;
break;case 5:Nb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Nb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return A.call(t,O,{Id:h,Command:aa,QueryCommand:ua,Alt:ub.call(Ra,Nb)})}c2i(){const b={};for(let h=1;6>=h;h++)b[Xs.DUf+h.toString()]="PageNumberGalleryButtonModel";b[Xs.Ili]="CheckboxModel";this.hea(b)}static SZl(b){return b?parseInt(b.substr(Xs.DUf.length)):1}}Xs.com="btnIncludePageCount";Xs.Ili="IncludePageCount";Xs.DUf="btnPageNumbersPosition";
Object(m.a)(Xs,"PageNumbersControl",null,[306]);class xv{constructor(b,h,t,A,O=null,aa=null,ua=null,Ra=null){this.aRl=(ub,Nb)=>{const Yb=new Uh.a;ub=4>ub;switch(Nb){case 1:case 2:Yb.add(ub?0:3);break;case 3:case 4:Yb.add(ub?0:3),Yb.add(ub?1:4)}return Yb};this.bKl=(ub,Nb,Yb)=>{var bc=Js(this.Xc,this.Yl,ub);this.Yl.MIb(bc,Yb);let Dc=this.DTj(bc,Nb);if(Dc)this.AWb.q5i(Dc);else{bc=Js(this.Xc,this.Yl,ub);this.Yl.MIb(bc,Yb);bc.Sd();if(mb.OutlineElementReader.Lh(bc)&&(wg.OutlineElementNavigator.Fe(bc),qe.ParagraphReader.rh(bc))){bc=
bc.currentNode;const Pc=this.Zdi(Nb);qe.ParagraphReader.Uv(bc)===Pc&&this.AWb.q5i(bc)&&(Dc=bc)}Dc||(bc=Js(this.Xc,this.Yl,ub),this.Yl.MIb(bc,Yb),this.QK.hib(bc,null,!0),Dc=wg.OutlineElementNavigator.Fe(bc),this.LD(Nb,Dc))}return Dc};this.cKl=(ub,Nb)=>{let Yb=null;ub.Tb(1);if(mb.OutlineElementReader.Lh(ub)&&(ub.Tb(2),ni.TableReader.isTable(ub))){var bc=ub.currentNode;if(3===ni.TableReader.Xg(bc)){let Dc=0;bc=ni.TableReader.Mm(bc);switch(Nb){case 1:case 4:Dc=bc?2:0;break;case 2:case 5:Dc=1;break;case 3:case 6:Dc=
bc?0:2}Wh.moveToCellContent(ub,0,Dc);ub.currentNode&&mb.OutlineElementReader.Lh(ub)&&(ub=wg.OutlineElementNavigator.Fe(ub),qe.ParagraphReader.Yb(ub)&&(Yb=ub))}}return Yb};this.rDm=(ub,Nb)=>{const Yb=Js(this.Xc,this.Yl,ub);ub=Yb.currentNode.ia(Lc.a.Xha,0);this.Yl.MIb(Yb,Nb);Nb=Yb.currentNode.ia(Lc.a.Xha,0);return ub===Nb};this.Xc=b;this.C8j=h;this.AWb=t;this.Yl=A;this.Msc=O||this.aRl;this.ETj=aa||this.bKl;this.DTj=ua||this.cKl;this.I1j=Ra||this.rDm}get QK(){return null!=this.$Ag?this.$Ag:this.$Ag=
Sa.a.instance.resolve("Box4.IOutlineEditor")}kum(b,h,t){var A=Js(this.Xc,this.Yl,b).Kn;A=this.Yl.bga(A);A=this.Msc(h,A);let O=null;for(let ua=0;ua<A.length;ua++){var aa=A.$f(ua);this.I1j(b,aa)&&(aa=this.ETj(b,h,aa),O=this.C8j.Rmk(aa,t)||O)}return O}LD(b,h){xv.Fca.tfe(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);xv.paragraphEditor.LD(h,this.Zdi(b))}Zdi(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get paragraphEditor(){return null!=
xv.WBg?xv.WBg:xv.WBg=Sa.a.instance.resolve("Box4.IParagraphEditor")}static get Fca(){return null!=xv.tDg?xv.tDg:xv.tDg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(m.a)(xv,"PageNumbersInserter",null,[305]);var Gw=c(885),GB=c(894);class Nt{constructor(b,h,t=null,A=null,O=null){this.s1k=(aa,ua)=>{aa=pf.a.Tc(aa,qe.ParagraphReader.textLength(aa));const Ra=aa.node.Mc;return Ra?Nt.characterPropertiesEditor.jga(aa,ub=>{ub=GB.a.getInstance(ub);this.dFd(ub,15,Ra,ua);this.dFd(ub,47,Ra,ua);this.dFd(ub,
16,Ra);this.dFd(ub,17,Ra);return ub}):null};this.Pum=(aa,ua)=>{aa=pf.a.Tc(aa,qe.ParagraphReader.textLength(aa));Nt.characterPropertiesEditor.replaceTextRange(aa,ua)};this.Ic=b;this.mpd=t||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.Sue=A||this.s1k;this.Reh=O||this.Pum}Rmk(b,h){const t=this.Ic.Qc(15);t.Eb(b);var A=qe.ParagraphReader.text(b),O=!1;0<A.length&&" "!==A.charAt(A.length-1)&&(O=!0);if(h){h=String.format(this.mpd,"#","$");O&&(h=" "+h);O=h.indexOf("#");A=h.indexOf("$");
u.ULS.shipAssertTag(4256717,309,-1!==O,"{0}",{["PageNumberIndex"]:O});u.ULS.shipAssertTag(4256718,309,-1!==A,"{0}",{["PageCountIndex"]:A});u.ULS.shipAssertTag(4256719,309,O!==A,"{0}",{["PageNumberIndex"]:O,["PageCountIndex"]:A});let Ra;let ub;if(O<A){var aa=O;Ra=A;var ua=Gw.a.SMc(0);ub=Gw.a.SMc(1)}else aa=A,Ra=O,ua=Gw.a.SMc(1),ub=Gw.a.SMc(0);this.oyf(b,h,0,aa);ua=this.Sue(b,ua);this.oyf(b,h,aa+1,Ra);aa=this.Sue(b,ub);this.oyf(b,h,Ra+1,h.length);b=O<A?ua:aa}else O&&this.Reh(b," "),b=this.Sue(b,Gw.a.SMc(0));
t.dispose();return b}dFd(b,h,t,A=null){const O=new ru.a;O.setValue(Af.a.w9,!0);O.setValue(Lc.a.$Bb,1);O.setValue(Lc.a.Rs,h);switch(h){case 15:O.setValue(Lc.a.PPa,!0);O.setValue(Lc.a.fieldInstruction,A);break;case 47:O.setValue(Lc.a.fieldInstruction,A);break;case 17:O.setValue(Lc.a.XGb,!0)}h=t.Du(O,W.a.create());this.Qnk(b,h)}Qnk(b,h){b.Zsa(h,W.a.nil,Tb.AParagraphNode.jC,null)}oyf(b,h,t,A){h=h.substring(t,A);0<h.length&&this.Reh(b,h)}static get characterPropertiesEditor(){return Nt.Jd||(Nt.Jd=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(b){Nt.Jd=
b}}Nt.Jd=null;Object(m.a)(Nt,"PageNumbersNodeLevelInserter",null,[304]);class Bu{esn(b){return Bu.m1l(b)}static m1l(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,Bu.GTi,Bu.GTi)}}Bu.GTi="1";Object(m.a)(Bu,"PageNumbersPositionPreviewGenerator",null,[303]);class rC{constructor(){this.eMg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");
this.YSj=this.eMg.length}fjm(b){let h=b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===qe.ParagraphReader.textLength(b)?{returnValue:!0,j0c:h}:{returnValue:!1,j0c:-1}}Lhm(b){let h=b.characterData.lastIndexOf(this.eMg);return-1!==h&&h+this.YSj===qe.ParagraphReader.textLength(b)?{returnValue:!0,j0c:h}:{returnValue:!1,j0c:-1}}Eim(b){return zc.a(b,9)?!0:!1}}Object(m.a)(rC,"PageNumbersReader",null,[302]);class Az{constructor(b,h,t,A,O,aa=null,ua=null){this.OTn=(Ra,ub,Nb,Yb)=>{Ra=Js(this.Xc,this.Yl,
Ra);this.Yl.MIb(Ra,ub);ub=Cr.a.Tp(Ra);for(Ra=!1;ub.moveNext();){const bc=ub.currentNode;if(qe.ParagraphReader.Yb(ub.currentNode)&&zc.a(ub.currentNode,9)){Ra=!0;let Dc;const Pc=({AXd:Dc}=Nb(bc,Dc)).returnValue;let jd=Pc;jd=this.sSn(bc,jd);jd=this.iUn(bc,jd);-1<Pc&&(jd===Pc&&Dc||Yb(bc,jd))}}Ra&&this.Wd.Bs(12)};this.Xc=b;this.Yl=h;this.VKe=t;this.Wd=A;this.Lyc=O;this.Msc=aa||uv.a.Vbf;this.O$j=ua||this.OTn;this.mpd=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.ISg=String.format(this.mpd,
"#","$");this.$_j=this.ISg.indexOf("#");this.Z_j=this.ISg.indexOf("$");this.pze=String.format(this.mpd,"\ufffc","\ufffc");this.BSg=this.pze.length}J2c(b,h,t){var A=Js(this.Xc,this.Yl,b).Kn;A=this.Yl.bga(A);A=this.Msc(A);for(const O of A)this.O$j(b,O,h,t)}q5i(b){if(this.VKe.Eim(b)){let h=-1;if(({j0c:h}=this.VKe.Lhm(b)).returnValue&&this.Yyh(b,h)||({j0c:h}=this.VKe.fjm(b)).returnValue&&this.TNk(b,h))return!0}return!1}iUn(b,h){var t=b.qa.length;for(let O=0;O<t;O++){var A=b.qa.J(O);A.blob&&9===A.blob.zh&&
(A=A.cp,t=pf.a.createTextRange(b,A,A+1),this.Lyc(t,""),t=b.qa.length,O--,h=this.Mnh(h,A,1))}return h}sSn(b,h){let t=b.characterData.indexOf(this.pze);for(;-1!==t;)this.Yyh(b,t)&&(h=this.Mnh(h,t,this.BSg)),t=b.characterData.indexOf(this.pze);return h}TNk(b,h){const t=b.qa.ei(h);return t&&t.blob&&9===t.blob.zh?(b=pf.a.createTextRange(b,h,h+1),this.Lyc(b,""),!0):!1}Yyh(b,h){const t=b.qa.ei(h+this.$_j),A=b.qa.ei(h+this.Z_j);return t&&t.blob&&9===t.blob.zh&&A&&A.blob&&9===A.blob.zh?(b=pf.a.createTextRange(b,
h,h+this.BSg),this.Lyc(b,""),!0):!1}Mnh(b,h,t){-1<b&&b>h&&(h=b-h,b=h>t?b-t:b-h);return b}}Object(m.a)(Az,"PageNumbersRemover",null,[301]);class xA{constructor(b,h){this.qqb=this.pqb=null;this.pr=b;this.Gb=h}dvk(){this.pr.style.display="";this.pqb||(this.qqb&&(this.Gb.Se(this.qqb),this.qqb=null),this.pqb=new Vb.a(0,1,10,()=>{this.pr.classList.add("Displayed");this.pqb=null}),this.Gb.Wb(this.pqb))}fvk(){this.pr.classList.remove("Displayed");this.qqb||(this.pqb&&(this.Gb.Se(this.pqb),this.pqb=null),
this.qqb=new Vb.a(0,1,200,()=>{this.pr.style.display="none";this.qqb=null}),this.Gb.Wb(this.qqb))}}Object(m.a)(xA,"PaneControlAnimationHelper",null,[330]);class HB{constructor(b){this.Gb=b}XZl(b){return new xA(b,this.Gb)}}Object(m.a)(HB,"PaneControlAnimationHelperFactory",null,[300]);class yA{constructor(b,h,t,A,O,aa,ua,Ra,ub=!1){this.cHg=this.Mka=this.Mid=null;this.Kjm=()=>{this.lu.sendNotification(this.cHg+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=
b;this.x5=h;this.x5.bind(this);this.tDe=t;this.nsa=O;this.kTe=ua;this.Vb=Ra;this.gkd=ub;this.tda=aa.value.create(t,A);this.x5.nDk(this.tda);this.TY=sb.KeyInputManager.mc(rc.a.Q0,0)}get lu(){return null!=this.Gsg?this.Gsg:this.Gsg=Sa.a.instance.resolve("Common.Utils.IAriaNotifier")}k0(b){this.x5.k0(b);this.Mka&&!b&&this.Mka.Qgl()}ufa(b){this.Mid!==b&&(this.Peb(),this.Mid=b)}udj(b){if(this.Mid){var h=this.nsa.o0a(this.Mid,uv.a.$Ql(b,this.tDe));this.gkd?(this.cHg=this.y_h(b,this.tDe),this.tda.XMb(Mf.a.Jzd)):
this.mLo(b);h&&this.q0e(h)}}Trh(b){this.gkd&&this.Vb&&(b=this.Vb.fe(b))&&b.E6(this.Kjm)}y_h(b,h){let t="";switch(b){case 1:t=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:t=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:t=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:t=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return t}mLo(b){this.tda.Fej(this.y_h(b,this.tDe),Mf.a.Jzd)}setInitialSelection(){this.tda.O5c()}q0e(b){this.Peb();this.tda.nE(b,b.Wi)}Peb(){this.tda.detach()}t8k(){this.Mka=
this.kTe.value.create(this.x5.zkc);this.Iio(this.Mka)}Iio(b){if(this.Vb){const h=this.Vb.fe(ps.a.g1a);h.parent=vf.AFrame.qp;h.pea(()=>{b.setFocus();this.Wgo()});h.bindAction(this.TY,Vc.a.iT)}}Wgo(){if(this.Vb){var b=this.Vb.fe(ps.a.g1a);const h=new $f.DOMFocusListing(()=>this.x5.zkc);h.Dxa=!0;h.In(1);this.Vb.O0b(this.x5.zkc,b,h);b=this.Vb.getRegion(ps.a.g1a);b.LRa();b.lU=!0;h.Dfa&&h.wy(h.Dfa)}}dispose(){void 0!==this.Mka&&null!==this.Mka&&(this.Vb.fe(ps.a.g1a).Xq(this.TY),this.Mka.dispose())}$Mn(){void 0!==
this.Mka&&null!==this.Mka&&this.Mka.refresh()}}Object(m.a)(yA,"PaneControl",null,[198]);class sC{constructor(b,h,t,A){this.Yl=b;this.MZj=h;this.kTe=t;this.Vb=A}create(b,h,t,A){return new yA(b,h,t,A,this.Yl,this.MZj,this.kTe,this.Vb,v.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(m.a)(sC,"Factory",null,[171]);var tC=c(1103);class cu extends Ft.a{constructor(b,h,t,A,O,aa,ua,Ra,ub){super();this.init(b);this.ul("ShowCalloutForPageNumberOperation");this.cOj=Ra;
this.bib(this.cOj,h,A,O,aa);this.Dz=0;this.Sab=aa;this.iLa=ua;this.Fh=ub;1===this.behavior&&(this.ar=32,this.Ipa())}run(){var b=this.Fh.jb.ju;if(!this.Dz){var h=ww.a.C6b(this.Sab,b);this.Sab.BPc(b,h)&&this.Sab.nva(b,h).element&&(this.Dz=1)}1===this.Dz&&(h=ww.a.C6b(this.Sab,b),h=this.Sab.nva(b,h),b=new tC.a(h.element,b),this.iLa.showCallout(b),this.Dz=2);2===this.Dz&&(this.ar=32,this.Ipa())}}Object(m.a)(cu,"ShowCalloutForPageNumberOperation",Ft.a,[]);class zA{constructor(b,h,t){this.iLa=b;this.ga=
h;this.SQb=t}create(b,h,t,A,O,aa){return new cu(b,h,t,A,O,aa,this.iLa,this.ga,this.SQb)}}Object(m.a)(zA,"Factory",null,[170]);class li{get QK(){return null!=this.YAg?this.YAg:this.YAg=Sa.a.instance.resolve("Box4.IOutlineEditor")}yc(b){b.ha("WordEditor.HeaderFooter.HeaderFooterManager",()=>new Ny(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.We("WordEditor.HeaderFooter.IPageNumbersActorFactory"),
b.resolve("WordEditor.IHeaderFooterViewElementFactory"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new Zp(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),ox.a.b7e,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),Jb.App.ya.jb,pc.InteractiveViewManager.instance,()=>b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.xa,b.resolve("Box4.IInteractiveEventNotifier"),
b.Sa("Box4.ITextMetricsAdapter"),b.resolve("Box4.IRotatingCoordinateConverter"),b.Sa("Common.IZoomManager"),b.Ma("Box4.IContentControlViewElementManager"),b.Ma("Box4.CpConversionManagerImpl"),b.Ma("Box4.ContentControlConfigSettings"),b.Ma("Box4.IContentControlReader"),b.Ma("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new CB(b.resolve("Box4.SectionAlignedViewPositionProvider"),
b.Sa("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Jb.App.instance&&Jb.App.instance.wC)).as("WordEditor.IHeaderFooterViewElementFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new uA(vm.App.Hn,b.Sa("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),vm.App.Hn,v.AFrameworkApplication.xa)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PaneControl.Factory",
()=>new sC(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.We("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.We("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),yd.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new Yx(()=>{Jb.App.ya.updateCommandUI()},b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),v.AFrameworkApplication.xa,
b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new yz(v.AFrameworkApplication.xa,sf.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),
b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Xs.SZl,Object(z.a)(Jb.App.ya,Jb.App.ya.w$c,"updateRibbonControl"),Object(z.a)(Jb.App.ya,Jb.App.ya.CG,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new Zx).singleInstance();b.ha("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",
()=>new HB(sf.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new Wv(yd.FocusManager.instance(),Jb.App.ya.Tw,b.We("WordEditor.HeaderFooter.IPaneControlFactory"),b.We("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.We("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),v.AFrameworkApplication.xa,new Pg.a(()=>Jb.App.ya.jb.xc),v.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").singleInstance();
b.ha("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new zu(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Lk.PageReader.instance,new ok.a,Aq.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new Au(new ok.a,Aq.a.instance));b.ha("WordEditor.HeaderFooter.HeaderFooterActor",()=>new Vv(v.AFrameworkApplication.xa,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),
Aq.a.instance,new ok.a,new vo.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),Vv.yfi,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new Hq(Uu.a.instance,Hq.M7l(b.resolve("Box4.ITableEditor")),Hq.CHl(),v.AFrameworkApplication.isRtl,wg.OutlineElementNavigator.Zd,Hq.L5l(),Hq.OQl(),b.resolve("Box4.IOutlineElementEditor")));b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",
()=>new qA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new ok.a,h=>this.QK.hib(h),v.AFrameworkApplication.isRtl,Object(z.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").kNb,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter")));b.ha("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new rA(Aq.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).singleInstance();
b.ha("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new pA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new ok.a,new vo.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),v.AFrameworkApplication.xa)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new tz(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Aq.a.instance,new ok.a,v.AFrameworkApplication.xa)).singleInstance();
b.ha("WordEditor.HeaderFooter.PageNumbersControl",()=>new Xs(Object(z.a)(Jb.App.ya,Jb.App.ya.w$c,"updateRibbonControl"),Object(z.a)(Jb.App.ya,Jb.App.ya.CG,"updateRibbonControls"),v.AFrameworkApplication.isRtl)).singleInstance();b.register(Bu,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new Nt(new vo.a,b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersInserter",
()=>new xv(new ok.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersReader",()=>new rC).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersRemover",()=>new Az(new ok.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Object(z.a)(li.characterPropertiesEditor,li.characterPropertiesEditor.replaceTextRange,"replaceTextRange"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new Fw(b.We("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Jb.App.ya)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new EB(sf.a.instance,he.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").singleInstance();
b.ha("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new zA(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),v.AFrameworkApplication.xa,Jb.App.ya)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").singleInstance();b.ha("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new zB(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),v.AFrameworkApplication.xa)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").singleInstance();
b.ha("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new Xx(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").singleInstance()}static get characterPropertiesEditor(){return null!=li.gtg?li.gtg:li.gtg=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(m.a)(li,"HeaderFooterComponentConfiguration",null,[2]);class n{constructor(){this.Oid=
this.W=null}get name(){return"WordEditor.HeaderFooter"}yc(b){this.W=b;(new li).yc(b)}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>{this.$m()})}$m(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(110)&&(this.Oid=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.Oid.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.Oid&&this.Oid.dispose()}static main(){P.a.instance.Gc(new n)}}Object(m.a)(n,"PackageManager",null,[1,2]);
var C=c(391),R=c(523);class ha{constructor(b,h){this.Pf=b;this.Qm=h}create(){return new R.a(this.Pf.instance,this.Qm.instance)}}Object(m.a)(ha,"ContentControlNodeFactory",null,[378]);var Ia=c(1677),cb=c(1051);class Eb{create(){return new cb.a}}Object(m.a)(Eb,"ContentControlContainerNodeFactory",null,[378]);class oc{constructor(b,h,t,A,O){this.Mta=b;this.DEh=h;this.oEd=t;this.kJ=A;this.lj=O;this.QYk=new Eb;this.Den=(aa,ua)=>{this.kJ.he(()=>{if(ua){ua.Go.selectedContentControls||(ua.Go.selectedContentControls=
{});var Ra=ua.Go.selectedContentControls,ub=ua.oSa;if(ub&&ub.length){var Nb=ub[0];ub=ub[ub.length-1];Nb=this.Mta.vmf(pf.a.Tc(Nb.node,Nb.zj),pf.a.Tc(ub.node,ub.Ep),!1);for(const Yb of Nb)Ra[Yb.contentControlNode.id.toString()]=!0}}},"CC:OnBeforeCopy")};this.pSf=(aa,ua)=>{this.kJ.he(()=>{if(ua){var Ra=ua.clone,ub=ua.original;try{const Nb=ua.Go.selectedContentControls,Yb=this.Mta.Flf(ub,0,ub.characterData.length,!0,!0,!1);for(const bc of Yb){const Dc=bc.le.toString();Nb[Dc]?bc.pp&&!this.f0k(bc.contentControlNode,
Ra,Nb)&&(u.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",Dc)),this.U1f(Ra,bc.le)):this.U1f(Ra,bc.le)}}catch(Nb){u.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",Nb.toString()),this.DEh.SRn(Ra)}}},"CC:onParagraphCopy")};this.qSf=(aa,ua)=>{this.kJ.he(()=>{if(ua){var Ra=ua.clone,ub=ua.original;try{const Nb=this.Mta.Flf(Ra,0,ub.characterData.length);ua.Go.ccObjectIdMapping||(ua.Go.ccObjectIdMapping={});const Yb=
ua.Go.ccObjectIdMapping;for(let bc=0;bc<Nb.count;bc++){const Dc=Nb.J(bc),Pc=Dc.le.toString();if(this.yIm(Dc))if(Dc.Oc){const jd=ub.Ei().ud.Db(Pc),Cd=this.k0l(Dc),ee=this.wSk(jd,Cd.HUi,Cd.lni,Ra.Ei().ud);Yb[Pc]=ee.id;this.oEd.Cyj(Yb[Pc],Ra.id,W.a.nil);this.lj.ccc(ee)}else this.oEd.Cyj(Yb[Pc],null,Ra.id);Yb[Pc]?(Dc.le=Yb[Pc],Dc.Pu=null):this.U1f(Ra,Dc.le)}}catch(Nb){u.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Nb.toString())}}},"CC:onParagraphPaste")}}init(){mv.a.Fpk(this.Den);
mv.a.oYe(this.pSf);mv.a.uyd(this.qSf)}vIl(b){if(!b.Ab(25)||!b.fd(25))return null;if(!b.Xr(25)){const h=this.QYk.create(1074135144);b.Qf(h,25)}return b.Tb(25)}f0k(b,h,t){var A=b.ia(Lc.a.c7,null);const O=ue.GraphIterator.$a(h);h=h.Ei().ud;t=A&&t[A.toString()]?h.Db(A):this.vIl(O);if(!t)return u.ULS.sendTraceTag(521172765,368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;A=Bt.a(b,h,!0);ue.GraphIterator.$a(t).q2(A,26,b.id);54!==t.type&&A.setValue(Lc.a.c7,
t.id);return A}U1f(b,h){this.DEh.bcl(new Mb.a([b]),h)}yIm(b){var h=b.Kb.paragraph.Mc;if(!h)return u.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.le.toString())),!1;h=h.Db(b.Pu);if(!h)return u.ULS.sendTraceTag(520152149,368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.le.toString())),!1;b=h.getValue(Lc.a.Rs);return 38===b||39==b}$Gl(b,h){var t,A=b.qa.J(b.qa.length-1);let O=
b.characterData.length;A=(null===(t=null===A||void 0===A?void 0:A.Jb)||void 0===t?void 0:t.length)||0;b.id.equals(h.Kb.paragraph.id)&&(O=h.Kb.cp,A=h.Kb.Jb.MI(h.le,h.Oc));return this.Mta.Glf(b,0,O,0,A)}k0l(b){let h=null,t=b.Kb.paragraph;const A={};for(;t;){const O=this.$Gl(t,b);for(let aa=O.count-1;0<=aa;aa--){const ua=O.J(aa);if(!ua.pp)continue;const Ra=ua.le.toString();if(ua.Oc){if(!A[Ra])return{HUi:ua.contentControlNode,lni:h}}else A[Ra]=!0,h||(h=ua.contentControlNode)}t=qe.ParagraphReader.ug(t,
!0,!0)}return{HUi:null,lni:h}}wSk(b,h,t,A){let O;h?O=this.oEd.bva(h):(O=this.oEd.cva(),h=O.currentNode);b=Bt.a(b,A,!0);b.Yg(Lc.a.jx,Nf.a.aF());54!==h.type&&b.setValue(Lc.a.c7,h.id);O.rH(b,t,26);return b}}Object(m.a)(oc,"ContentControlCCP",null,[]);var Ac=c(196),qd=c(727);class Yc{constructor(b,h,t,A){this.Jd=b;this.Pf=h;this.eb=t;this.Cd=A}get EX(){return!!this.Pf.instance&&this.Pf.instance.EX}get XFb(){return!!this.Pf.instance&&this.Pf.instance.XFb}Xsa(b,h,t,A,O,aa=Ac.a.TAb,ua=Ac.a.u3b,Ra=null,ub=
Ac.a.Saf,Nb=-1){(b=this.MNc(b,t))?(b.Jb||(b.Jb=new C.a(b)),this.Nkk(h,b.Jb,A,O,aa,ua,Ra,ub,Nb)):u.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}sMh(b,h,t){if(b){new Mb.a;for(let O=0;O<b.count;O++){var A=this.rmf(b.J(O),h,!1);for(const aa of A)this.tSn(aa,t)}}}acl(b,h){this.sMh(b,h,!0)}bcl(b,h){this.sMh(b,h,!1)}replaceTextRange(b,h,t){this.Jd.replaceTextRange(b,h,t===qa.a.M6c)}MNc(b,h){var t=pf.a.Tc(b,h);this.Jd.i6a(t);for(t=0;t<b.qa.length;t++){const A=
b.qa.J(t);if(A.cp>h)break;if(A.cp===h)return A}return null}Nkk(b,h,t,A,O=Ac.a.TAb,aa=Ac.a.u3b,ua=null,Ra=Ac.a.Saf,ub=-1){const Nb=h.Kb.paragraph;b=new qd.a(h.Kb,!0,!0,!0,null,b,A,t,O,aa,ua,Ra,null,this.Cd);if(!this.EX||-1>=ub||ub>h.length)ub=h.length;h.insert(b,ub);Nb.Pm();b.ze?Nb.Ae.BX(b.ze-1,512):Nb.Ae.sna(b.ze,512);Nb.Ae.$p.Z(b.ze,am.CharacterPropertiesEditor.sM);Nb.Ae.Ps.Z(b.ze,am.CharacterPropertiesEditor.VQ)}rmf(b,h,t){const A=new Mb.a;for(let O=0;O<b.qa.length;O++){const aa=b.qa.J(O);if(aa.Jb)for(let ua=
0;ua<aa.Jb.length;ua++)if(aa.Jb.J(ua).le.equals(h)&&(A.add(aa.Jb.J(ua)),t))return A}return A}b$c(b,h,t){if(this.XFb&&b){var A=b.node,O=b.zj,aa=b.Ep,ua=this.F2h(A,O,h,!0);h=this.F2h(A,aa,h,!1);t?-1!==ua&&ua++:-1!==h&&h++;O||-1===ua||(ua=Math.max(ua,this.eb.vv(A)));aa===this.eb.textLength(A)&&-1!==h&&(h=Math.min(h,this.eb.Qu(A)));b.Fb=ua;b.Sb=h}}F2h(b,h,t,A){return(b=(b=b.qa.ei(h))?b.Jb:null)&&b.length?b.MI(t,A):-1}tSn(b,h){b&&b.Kb.Jb&&(h?b.Kb.Jb.remove(b):b.Kb.Jb.opa(b),h=b.Kb.paragraph,0<=b.ze&&b.ze<
h.Ae.length&&(b.Kb.cp||1!==h.Ae.length||(h.Ae.BX(0,512),h.Ae.$p.Z(1,am.CharacterPropertiesEditor.sM),h.Ae.Ps.Z(1,am.CharacterPropertiesEditor.VQ)),h.Ae.removeAt(b.ze,512)),h.Pm())}SRn(b){const h=b.qa;if(h){var t=new Mb.a;for(let A=0;A<h.length;A++){const O=h.J(A);if(O&&O.Jb){for(let aa=0;aa<O.Jb.length;aa++)t.add(O.Jb.J(aa).ze);O.Jb=null}}b.npa(t)}}zJo(b,h,t){if(!(0>h||0>t))for(this.Jd.i6a(pf.a.Tc(b,h)),this.Jd.i6a(pf.a.Tc(b,t)),h=b.qa.Vfa(h),t=b.qa.Vfa(t),--t;t>h;t--){const A=b.qa.J(t);A.vAf?b.qa.removeAt(t):
A.formatting=null}}}Object(m.a)(Yc,"ContentControlChpManager",null,[373]);class Id{constructor(b,h,t,A,O){this.eb=b;this.Ao=h;this.uh=t;this.jd=A;this.Cd=O}slf(b){if(!b||!nf.SelectionEditor.jf(b))return null;if(!b.cpBegin){const h=this.J0h(b.node,b.Fb,!0);if(h)return h}return b.cpBegin===this.eb.textLength(b.node)?this.J0h(b.node,b.Fb-1,!1):null}cGl(b,h){b=this.VHh(b,h);return this.slf(b)}J0h(b,h,t){return b.qa&&b.qa.length?(b=t?b.qa.first.Jb:b.qa.last.Jb)&&0<=h&&h<b.length&&b.J(h).Uf&&b.J(h).Oc===
t&&this.Hzf(b.J(h))?b.J(h):null:null}Jof(b){if(!b||!nf.SelectionEditor.Xu(b))return null;var h=this.Ao.YMd(b,b);b=0<h.count?h.J(h.count-1):null;return b&&!b.Uf&&this.Hzf(b)?(h=1<h.count?h.J(h.count-2):null)&&!h.Uf&&this.Hzf(h)?null:b:null}Hzf(b){if(!b)return!1;var h=this.d$h(b);if(!h)return!1;if(b.Oc)var t=b;else t=h,h=b;var A=this.eb.textLength(b.Kb.paragraph);if(t.Kb.cp||h.Kb.cp!==A||!t.pp||t.mwa||!h.pp||h.mwa)return!1;t=t.Kb.Jb;h=h.Kb.Jb;for(A=0;A<t.length&&!t.J(A).le.equals(b.le);A++)if(!t.J(A).Oc)return!1;
for(t=h.length-1;0<=t&&!h.J(t).le.equals(b.le);t--)if(h.J(t).Oc)return!1;return!0}J9c(b){b=this.slf(b);this.zEd(b,!1)}Ewj(b,h){b=this.VHh(b,h);this.J9c(b)}aIa(b){b=this.Jof(b);return this.zEd(b,!0)?b:null}mym(b,h){b=this.slf(b);return!!b&&b.le.equals(h)}L9b(b,h,t){b=this.cGl(b,h);return!!b&&b.le.equals(t)}qBf(b,h){b=this.Jof(b);return!!b&&b.le.equals(h)}zEd(b,h){if(!b)return!1;const t=this.d$h(b);return this.gFh(b,h)&&(!t||this.gFh(t,h))}gFh(b,h){if(!b||b.Uf===h)return!1;var t=this.Ao.ble(b.Kb.paragraph,
b.Oc);const A=b.Kb.Jb;-1!==t||b.Oc||(t=A.length);const O=h===b.Oc?1:-1;t+=h?O:0;b=A.MI(b.le,b.Oc)+O;if(t===b||0<O!==b>t)return u.ULS.shipAssertTag(24933847,368,t!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",t,b,O),u.ULS.shipAssertTag(24933848,368,0<O===b>t,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",t,b,O),!1;for(var aa=t;aa!==b;aa+=O){var ua=
A.J(aa);A.opa(ua);ua.Uf=h;A.Yum(ua,aa);this.JOo(A.J(aa))}if(this.q_)for(A.Kb.paragraph.Pm(),aa=t;aa!==b;aa+=O)ua=A.J(aa),ua.paragraph.Ae.$p.Z(ua.ze,am.CharacterPropertiesEditor.sM),ua.paragraph.Ae.Ps.Z(ua.ze,am.CharacterPropertiesEditor.VQ);h||this.iRo(A,t,b,O);u.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",Math.abs(b-t),h?"block":"inline");return!0}JPd(b){var h,t;return b.Oc&&(pi.a.Hj?this.Cd.Mq(b.contentControlNode.id,!0):this.Cd.Es.get(null===(h=b.contentControlNode.id)||
void 0===h?void 0:h.toString())).equals(b.Kb.paragraph.id)?38:!b.Oc&&(pi.a.Hj?this.Cd.Mq(b.contentControlNode.id,!1):this.Cd.Lt.get(null===(t=b.contentControlNode.id)||void 0===t?void 0:t.toString())).equals(b.Kb.paragraph.id)?39:b.Uf&&b.Oc?40:b.Uf&&!b.Oc?41:!b.Uf&&b.Oc?38:39}JOo(b){const h=b.Kb.paragraph.Mc;if(h){var t=h.Db(b.Pu),A=b.contentControlNode;if(t){t=t.clone();t.setValue(Lc.a.$Df,b.Uf);const O=this.JPd(b);t.setValue(Lc.a.Rs,O);h.Du(t,null);b.Pu=t.id}A&&A.setValue(Lc.a.c8,b.Uf)}}d$h(b){if(b.Kb.cp&&
b.Kb.cp!==this.eb.textLength(b.Kb.paragraph)||!b.Kb.paragraph.qa||!b.Kb.paragraph.qa.length)return null;const h=b.Oc?b.Kb.paragraph.qa.last:b.Kb.paragraph.qa.first;if(!h.Jb)return null;b=h.Jb.MI(b.le,!b.Oc);return-1===b?null:h.Jb.J(b)}iRo(b,h,t,A){var O,aa,ua,Ra,ub=b.J(h).contentControlNode;if(ub){var Nb=b.J(h).Oc,Yb=Nb?this.Cd.Es:this.Cd.Lt;ub=pi.a.Hj?this.Cd.Mq(ub.id,Nb):null!==(aa=Yb.get(null===(O=ub.id)||void 0===O?void 0:O.toString()))&&void 0!==aa?aa:W.a.nil;if(!ub.equals(W.a.nil))if(b.Kb&&
b.Kb.paragraph&&b.Kb.paragraph.id.equals(ub)){for(h+=A;h!==t;h+=A){O=b.J(h).contentControlNode;if(!O)return;pi.a.Hj?this.Cd.PD(O.id,ub,Nb):Yb.set(null===(ua=O.id)||void 0===ua?void 0:ua.toString(),ub)}0<=t&&t<b.length&&b.J(t).Uf&&this.PDf(b.J(t))&&(b=b.J(t).contentControlNode)&&(pi.a.Hj?this.Cd.PD(b.id,ub,Nb):Yb.set(null===(Ra=b.id)||void 0===Ra?void 0:Ra.toString(),ub))}else u.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}PDf(b){return b.pp&&
!b.mwa}VHh(b,h){if(!b||!this.uh)return null;const t=h?pf.a.Tc(b,0):pf.a.Bw(b);b=this.uh.Nq(b,h);t.Sb=t.Fb=b;return t}get q_(){return this.jd.isFeatureEnabled(28)}}Object(m.a)(Id,"ContentControlConverter",null,[371]);var Ne;(function(b){b[b.T0o=0]="BoundingBox";b[b.a4o=1]="Tags";b[b.b2o=2]="Hidden";b[b.X2o=3]="NumberOfContentControlAppearance"})(Ne||(Ne={}));Object(m.b)("ContentControlAppearance",Ne);var qf=c(1603);class zg{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){this.O9a=this.ZAa=this.orc=this.qAc=
this.qod=null;this.aja=this.yk=this.Exc=this._id=0;this.aTb=this.MWb=this.Fud=this._title=this.qza=null;this.dld=this.cld=this.OZg=this.jrd=this.Xtc=this.Ttc=this.egd=!1;this.h0g=null;this.Uf=!1;this.rue=null;this.Nh=t;this.Ix=h;this.$g=A;this.Yq=O;this.Qm=aa;this.k1=ua;this.zra=Ra;this.jea=ub;this.Lxb=Nb;this.Cd=Yb;b?(this.qod=b.id,this.rue=b,this.pT(!1)):this._id=Nf.a.aF()}get Hi(){return this.Nh.value}get id(){this.pT();return this._id}set id(b){this._id=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.jx,
this._id),this.M0())}get parentId(){this.pT();return this.Exc}set parentId(b){this.Exc=b}get title(){this.pT();return this._title}set title(b){this._title=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.eeb,this._title),this.M0(),this.d$c(h=>{h.title=this._title?this._title:Ac.a.TAb}))}get tag(){this.pT();return this.Fud}set tag(b){this.Fud=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.heb,this.Fud),this.M0())}get type(){this.pT();return this.yk}set type(b){this.yk=b;this.isValid()&&
(this.contentControlNode.setValue(Lc.a.Wzb,qf.a[this.yk]),this.M0())}get appearance(){this.pT();return this.aja}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.aja=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.feb,Ne[this.aja].toLowerCase()),this.M0(),this.d$c(h=>{h.appearance=Ne[this.aja].toLowerCase()}))}get color(){this.pT();return this.qza}set color(b){if(b&&16777215>=b)this.qza=b,this.isValid()&&(this.contentControlNode.setValue(Lc.a.nGc,
this.qza),this.M0(),this.d$c(h=>{h.color=this.qza}));else throw Error.argumentOutOfRange("The color value is out of range.");}get v8d(){this.pT();return this.MWb}set v8d(b){this.MWb=b}get MHd(){this.pT();return this.aTb}set MHd(b){this.aTb=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.k2b,this.aTb),this.M0())}get rdf(){this.pT();return this.egd}set rdf(b){b&&(this.egd=b,this.isValid()&&(this.contentControlNode.setValue(Lc.a.mEd,this.egd),this.M0()))}get removeWhenEdited(){this.pT();return this.jrd}set removeWhenEdited(b){if(b&&
!this.pga)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.jrd=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.FEh,this.jrd),this.M0())}get pga(){this.pT();return this.Ttc}set pga(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.Ttc=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.m2b,this.Ttc),
this.d$c(h=>{h.QN=this.Ttc}),this.M0())}get isEditable(){this.pT();return this.Xtc}set isEditable(b){this.Xtc=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.Uzb,this.Xtc),this.d$c(h=>{h.editable=this.Xtc}),this.M0())}get isSupported(){this.pT();return this.OZg}get CIm(){return this.isSupported&&11!==this.type&&10!==this.type}get ILm(){this.pT();return this.aTb&&"table of contents"===this.aTb.toLowerCase()?!0:!1}get $Xd(){this.pT();return this.cld}set $Xd(b){this.cld=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.HEh,
this.cld),this.M0())}get T$b(){this.pT();return this.dld}set T$b(b){this.dld=b;this.isValid()&&(this.contentControlNode.setValue(Lc.a.IEh,this.dld),this.M0())}get wO(){return this.contentControlNode.ia(Lc.a.d7,!1)}set wO(b){this.isValid()&&this.contentControlNode.setValue(Lc.a.d7,b)}get Zt(){this.pT();return this.qAc}set Zt(b){this.qAc=b}get Vy(){this.pT();return this.orc}set Vy(b){this.orc=b}get objectId(){return this.qod}set objectId(b){this.qod=b;this.rue=this.Hi.Db(this.qod)}get start(){this.$Aj();
return this.ZAa}set start(b){this.ZAa=b}get end(){this.$Aj();return this.O9a}set end(b){this.O9a=b}get contentControlNode(){return this.rue}Jtn(b){for(let h=0;3>h;++h)if(Ne[h].toLowerCase()===b)return h;return 0}Ktn(b){for(let h=0;12>h;++h)if(qf.a[h]===b)return h;return-1}M0(){const b=this.start.node;b&&b.setValue(Af.a.iU,new Date)}s$c(){var b,h,t,A;this._id=this.contentControlNode.ia(Lc.a.jx,0);this.aja=this.Jtn(this.contentControlNode.ia(Lc.a.feb,null));this.qza=this.contentControlNode.ia(Lc.a.nGc,
null);this._title=this.contentControlNode.ia(Lc.a.eeb,null);this.Fud=this.contentControlNode.ia(Lc.a.heb,null);this.Uf=this.contentControlNode.ia(Lc.a.c8,!1);this.Ttc=this.contentControlNode.ia(Lc.a.m2b,!1);this.Xtc=this.contentControlNode.ia(Lc.a.Uzb,!1);this.OZg=this.contentControlNode.ia(Lc.a.Xea,!1);this.aTb=this.contentControlNode.ia(Lc.a.k2b,null);this.egd=this.contentControlNode.ia(Lc.a.mEd,!1);pi.a.Hj?(this.qAc=this.Cd.Mq(this.contentControlNode.id,!0),this.orc=this.Cd.Mq(this.contentControlNode.id,
!1)):(this.qAc=null!==(h=this.Cd.Es.get(null===(b=this.contentControlNode.id)||void 0===b?void 0:b.toString()))&&void 0!==h?h:W.a.nil,this.orc=null!==(A=this.Cd.Lt.get(null===(t=this.contentControlNode.id)||void 0===t?void 0:t.toString()))&&void 0!==A?A:W.a.nil);this.dld=this.contentControlNode.ia(Lc.a.IEh,!1);this.cld=this.contentControlNode.ia(Lc.a.HEh,!1);this.jrd=this.contentControlNode.ia(Lc.a.FEh,!1);this.yk=this.Ktn(this.contentControlNode.ia(Lc.a.Wzb,"RichText"));b=null;try{const O=this.contentControlNode.ia(Lc.a.c7,
W.a.nil);if(W.a.Sp(O,W.a.nil))this.Exc=0;else if(b=this.Hi.Db(O))this.Exc=b.ia(Lc.a.jx,0)}catch(O){this.Exc=0}this.iQo()}iQo(){if(this.Lxb){var b=this.contentControlNode.ia(Lc.a.E7e,"");if((b=this.zra.nfi(b))&&0<b.length){this.MWb=this.R_h(b.Qa,b.Rc);return}}this.MWb=(b=this.$g.cva())&&b.currentNode?b.currentNode.ia(Lc.a.oGc,null):null}pT(b=!0){if(!b||this.isValid())b=this.contentControlNode.ia(Af.a.lastModifiedTime,new Date(0)),this.h0g!==b?(u.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),
this.s$c(),this.h0g=b):u.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}hRo(b,h){var t,A;this.qAc=b;this.orc=h;pi.a.Hj?this.Cd.PD(this.contentControlNode.id,b,!0):this.Cd.Es.set(null===(t=this.contentControlNode.id)||void 0===t?void 0:t.toString(),b);pi.a.Hj?this.Cd.PD(this.contentControlNode.id,h,!1):this.Cd.Lt.set(null===(A=this.contentControlNode.id)||void 0===A?void 0:A.toString(),h)}$Aj(){if(this.contentControlNode){var b=
this.Zt,h=this.Vy;if(!b||!h||b.equals(W.a.nil)||h.equals(W.a.nil))u.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(b=this.$g.zma(b,!0),h=this.$g.zma(h,!1),b&&h)if(b.isConnected&&h.isConnected||u.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.Uf)b=pf.a.create(b),this.Yq.b$c(b,this.objectId,!0),this.start=b,b=pf.a.create(h),this.Yq.b$c(b,this.objectId,!0),this.end=b;else{let t=
h=-1;if(b.qa){for(let A=0;A<b.qa.length&&(-1===h||-1===t);A++){const O=b.qa.J(A);if(O.Jb)for(let aa=0;aa<O.Jb.length&&(-1===h||-1===t);aa++){const ua=O.Jb.J(aa);W.a.Sp(ua.le,this.objectId)&&(ua.Oc?h=O.cp:t=O.cp)}}0<=h&&0<=t&&(b=pf.a.ZP(h,t,!1,b),this.Yq.b$c(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const t=this.end;if(!h||!t)return b;this.Uf?b=this.R_h(h,t):(h=qe.ParagraphReader.text(h.node).substring(h.cpBegin,t.cpEnd),b+=Tb.AParagraphNode.CU(h));return b}isValid(){return!!this.contentControlNode&&
this.contentControlNode.isConnected}yfe(b){return this.jea?this.Qm.mhj(this,b)?0:2:2}clear(){return this.jea?this.Qm.mhj(this,"")?0:2:2}N1h(){const b=new Mb.a;var h=this.contentControlNode.ia(Lc.a.contentControlNode,[]);for(const t of h)if(!W.a.Sp(t,W.a.nil)){h=this.Nh.value.Db(t);try{b.add(this.k1.iAb(h,this.Ix,this.Nh,this.$g,this.Yq,this.Qm,this.zra,this.jea,this.Lxb))}catch(A){}}return b}Pkf(){const b=new Mb.a;this.I_h(this,b);return b}I_h(b,h){b=b.N1h();if(b.count)for(const t of b)h.add(t),this.I_h(t,
h)}EE(b=!1){const h=new Mb.a;if(this.Uf){var t=this.Qm.wT(this.start,this.end);for(var A of t)t=pf.a.create(A),this.Yq.b$c(t,this.objectId,b),h.add(t)}else A=this.start.clone(),this.Yq.b$c(A,this.objectId,b),h.add(A);return h}d$c(b){const h=this.Qm.wT(this.start,this.end);for(let t=0;t<h.count;t++){const A=this.Yq.rmf(h.J(t),this.objectId,!1);if(A){for(let O=0;O<A.count;O++)b(A.J(O));h.J(t).Zj()}}}R_h(b,h){const t=new Sys.StringBuilder;h=this.Qm.wT(b,h);for(const A of h)A.id.equals(b.node.id)||t.append("\r"),
t.append(qe.ParagraphReader.plainText(A));return t.toString()}}Object(m.a)(zg,"ContentControl",null,[405]);class hh{constructor(b){this.Cd=b}iAb(b,h,t,A,O,aa,ua,Ra,ub){return new zg(b,h,t,A,O,aa,this,ua,Ra,ub,this.Cd)}}Object(m.a)(hh,"ContentControlFactory",null,[369]);class sh{constructor(b,h,t,A,O){this.Nh=b;this.Yq=h;this.mfk=t;this.fW=A;this.Na=O}OMo(b,h,t){var A,O;if(!(pi.a.F7e&&b&&h&&t))return!1;const aa=b.contentControlNode;if(!aa)return!1;var ua=aa.ia(Lc.a.Vzb,W.a.nil);ua&&!ua.equals(W.a.nil)?
b=this.Nh.value.Db(ua):(b=this.Yq.MNc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0),b=null===(A=null===b||void 0===b?void 0:b.formatting)||void 0===A?void 0:A.sn,b||(b=new Sx.a,this.Nh.value.Du(b,null)),aa.setValue(Lc.a.Vzb,b.id));A=this.Nh.value.Db(b.id);ua="boolean"===typeof t&&t;const Ra=null===(O=this.Na)||void 0===O?void 0:O.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);h=this.mfk.Znf(aa,A,h,t,Ra?null:ua);h=this.fW.Lme(h);for(const [ub,Nb]of h)b.setValue(ub,
Nb);return!0}}Object(m.a)(sh,"ContentControlFormattingManager",null,[370]);var xj=c(933);class pl{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){this.Ix=b;this.Nh=h;this.Xc=t;this.zWb=A;this.uTj=O;this.XJ=aa;this.Hh=ua;this.eb=Ra;this.Apd=ub;this.Yhd=Nb;this.Cd=Yb}get Es(){return this.Cd.Es}get Lt(){return this.Cd.Lt}get my(){return this.Ix.value}cva(){const b=this.Xc.Ck();b.set(this.my);this.zWb.TQ(b);if(b.Tb(25))return b;this.Yhd.instance&&this.Yhd.instance.Dna&&u.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");
u.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}eNc(b,h,t=!1){this.H4b();const A=new Mb.a;let O;if(b){O=b.Tb(26);if(!O)return A;for(;O&&(!h(O)||(A.add(O),!t));){A.addRange(this.eNc(b,h));if(t&&0<A.count)break;O=b.wf(26)}b.wc()}return A}PZl(){const b=this.Xc.Ck();b.set(this.Ix.value);this.zWb.TQ(b);return b.currentNode}JPa(b,h,t){let A;A=b.equals(h);A||(A=(b=this.zma(b,t))?b.id.equals(h):!1);return A}eOa(b,h){var t,A,O,aa;b=this.tu(b);if(!b)return null;
let ua=null;for(;55===b.type;){let Ra;Ra=pi.a.Hj?this.Cd.Mq(b.id,h):h?null!==(A=this.Cd.Es.get(null===(t=b.id)||void 0===t?void 0:t.toString()))&&void 0!==A?A:W.a.nil:null!==(aa=this.Cd.Lt.get(null===(O=b.id)||void 0===O?void 0:O.toString()))&&void 0!==aa?aa:W.a.nil;if(Ra.equals(ua)){b=null;break}else b=this.tu(Ra);ua=Ra}return b}zma(b,h){return(b=this.eOa(b,h))?qe.ParagraphReader.Yb(b)?b:h?this.eb.Rl(b):this.eb.KE(b):null}qMh(b,h=!1){this.ULo(b);this.rMh(b,h)}ULo(b){var h,t,A,O,aa,ua,Ra,ub,Nb=this.bva(b);
Nb=this.bva(Nb.parentNode);Nb=55===Nb.currentNode.type?Nb.currentNode.id:null;let Yb;Yb=this.tu(pi.a.Hj?this.Cd.Mq(b.id,!0):null!==(t=this.Cd.Es.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==t?t:W.a.nil);for(h=this.tu(pi.a.Hj?this.Cd.Mq(b.id,!1):null!==(O=this.Cd.Lt.get(null===(A=b.id)||void 0===A?void 0:A.toString()))&&void 0!==O?O:W.a.nil);Yb&&55===Yb.type;)Yb=this.tu(pi.a.Hj?this.Cd.Mq(Yb.id,!0):null!==(ua=this.Cd.Es.get(null===(aa=Yb.id)||void 0===aa?void 0:aa.toString()))&&
void 0!==ua?ua:W.a.nil);for(;h&&55===h.type;)h=this.tu(pi.a.Hj?this.Cd.Mq(h.id,!1):null!==(ub=this.Cd.Lt.get(null===(Ra=h.id)||void 0===Ra?void 0:Ra.toString()))&&void 0!==ub?ub:W.a.nil);Yb&&h&&this.Byj(Yb.id,h.id,Nb,bc=>{bc=bc.ia(Lc.a.OW,W.a.nil);return!bc||bc.equals(W.a.nil)||b.id.equals(bc)})}rMh(b,h=!1){var t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc;u.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");const jd=this.bva(b),Cd=this.bva(jd.parentNode);let ee=W.a.nil,Od=W.a.nil;
var fe=Cd.currentNode.ia(Lc.a.contentControlNode,[]);const Ee=new Mb.a;for(let Fg=0;Fg<fe.length;Fg++)Ee.add(fe[Fg]);if(h){if(54!==Cd.currentNode.type){ee=pi.a.Hj?this.Cd.Mq(Cd.currentNode.id,!0):this.Cd.Es.get(null===(t=Cd.currentNode.id)||void 0===t?void 0:t.toString());Od=pi.a.Hj?this.Cd.Mq(Cd.currentNode.id,!1):this.Cd.Lt.get(null===(A=Cd.currentNode.id)||void 0===A?void 0:A.toString());fe=this.tu(ee);for(t=this.tu(Od);fe&&55===fe.type;)ee=pi.a.Hj?this.Cd.Mq(fe.id,!0):this.Cd.Es.get(null===(O=
fe.id)||void 0===O?void 0:O.toString()),fe=this.tu(ee);for(;t&&55===t.type;)Od=pi.a.Hj?this.Cd.Mq(t.id,!1):this.Cd.Lt.get(null===(aa=t.id)||void 0===aa?void 0:aa.toString()),t=this.tu(Od)}O=this.bva(b);if(O.Tb(26)){aa=new Mb.a;for(aa.add(O.currentNode);O.wf(26);)aa.add(O.currentNode);for(var re of aa)this.rMh(re,h)}}else if(ee=pi.a.Hj?this.Cd.Mq(b.id,!0):this.Cd.Es.get(null===(ua=b.id)||void 0===ua?void 0:ua.toString()),Od=pi.a.Hj?this.Cd.Mq(b.id,!1):this.Cd.Lt.get(null===(Ra=b.id)||void 0===Ra?void 0:
Ra.toString()),h=this.HSl(Ee,b.id),re=this.bva(b),re.Tb(26))for(O=this.bva(re.currentNode),aa=O.currentNode,fe=b;aa;)t=re.currentNode,Ee.insert(h++,t.id),aa=O.wf(26),A=this.bva(t),54!==Cd.currentNode.type?t.setValue(Lc.a.c7,Cd.currentNode.id):t.removeProperty(Lc.a.c7),Bt.g(A,Cd,fe,26),fe=A.currentNode,aa&&(re.set(aa),re.I0(this.cva().currentNode));54!==Cd.currentNode.type&&(h=pi.a.Hj?this.Cd.Mq(Cd.currentNode.id,!0):null!==(Nb=this.Cd.Es.get(null===(ub=Cd.currentNode.id)||void 0===ub?void 0:ub.toString()))&&
void 0!==Nb?Nb:W.a.nil,ub=pi.a.Hj?this.Cd.Mq(Cd.currentNode.id,!1):null!==(bc=this.Cd.Lt.get(null===(Yb=Cd.currentNode.id)||void 0===Yb?void 0:Yb.toString()))&&void 0!==bc?bc:W.a.nil,h.equals(b.id)&&(pi.a.Hj?this.Cd.PD(Cd.currentNode.id,ee,!0):this.Cd.Es.set(null===(Dc=Cd.currentNode.id)||void 0===Dc?void 0:Dc.toString(),ee)),ub.equals(b.id)&&(pi.a.Hj?this.Cd.PD(Cd.currentNode.id,Od,!1):this.Cd.Lt.set(null===(Pc=Cd.currentNode.id)||void 0===Pc?void 0:Pc.toString(),Od)));jd.Dg();u.ULS.sendTraceTag(528537621,
368,50,"Disconnected nodeToDelete");this.remove(Ee,b.id);fe=Array(Ee.count);for(Yb=0;Yb<Ee.count;Yb++)fe[Yb]=Ee.J(Yb);Cd.currentNode.setValue(Lc.a.contentControlNode,fe);xj.a.wFa(b.id)}Mkk(b,h,t,A,O,aa,ua=null){var Ra,ub,Nb,Yb,bc,Dc,Pc,jd;let Cd,ee;h?(Cd=this.tu(h.objectId),ee=this.bva(Cd)):(ee=this.cva(),Cd=ee.currentNode);const Od=this.uTj.create(1074135145);ua&&Od.properties.Aw(ua.properties);54!==Cd.type&&Od.setValue(Lc.a.c7,Cd.id);ua?ee.wFb(Od,t,26,ua.id):ee.rH(Od,t,26);pi.a.contentControlAroundTableFix?
(this.aBj(b,Od.id,O,!0),this.aBj(b,Od.id,aa,!1)):(pi.a.Hj?this.Cd.PD(Od.id,O,!0):this.Cd.Es.set(null===(Ra=Od.id)||void 0===Ra?void 0:Ra.toString(),O),pi.a.Hj?this.Cd.PD(Od.id,aa,!1):this.Cd.Lt.set(null===(ub=Od.id)||void 0===ub?void 0:ub.toString(),aa));b.Uf&&(h&&(t=pi.a.Hj?this.Cd.Mq(Cd.id,!0):null!==(Yb=this.Cd.Es.get(null===(Nb=Cd.id)||void 0===Nb?void 0:Nb.toString()))&&void 0!==Yb?Yb:W.a.nil,Nb=pi.a.Hj?this.Cd.Mq(Cd.id,!1):null!==(Dc=this.Cd.Lt.get(null===(bc=Cd.id)||void 0===bc?void 0:bc.toString()))&&
void 0!==Dc?Dc:W.a.nil,t.equals(O)&&(pi.a.Hj?this.Cd.PD(Cd.id,Od.id,!0):this.Cd.Es.set(null===(Pc=Cd.id)||void 0===Pc?void 0:Pc.toString(),Od.id)),Nb.equals(aa)&&(pi.a.Hj?this.Cd.PD(Cd.id,Od.id,!1):this.Cd.Lt.set(null===(jd=Cd.id)||void 0===jd?void 0:jd.toString(),Od.id))),this.Byj(O,aa,Od.id,fe=>{fe=fe.ia(Lc.a.OW,W.a.nil);const Ee=h?h.objectId:null;return!fe||fe.equals(W.a.nil)||fe.equals(Ee)}));O=this.bva(Od);aa=Array(A.count);for(bc=A.count-1;0<=bc;bc--)aa[bc]=A.J(bc).objectId,Dc=this.tu(A.J(bc).objectId),
Dc=this.bva(Dc),Dc.currentNode.setValue(Lc.a.c7,Od.id),Bt.g(Dc,O,null,26);0<aa.length&&Od.setValue(Lc.a.contentControlNode,aa);pl.Xb.isFeatureEnabled(35)&&(b.MHd&&Od.setValue(Lc.a.k2b,b.MHd),b.rdf&&Od.setValue(Lc.a.mEd,!0));return Od}aBj(b,h,t,A){12===this.tu(t).type?this.Cd.PD(h,t,A):(this.Cd.Jjg(h,t,A),this.Cd.PD(h,A?b.start.node.id:b.end.node.id,A))}kao(b,h,t,A,O){b.setValue(Lc.a.c8,h);b.setValue(Lc.a.m2b,!0);b.setValue(Lc.a.Uzb,!0);b.setValue(Lc.a.jx,t);b.setValue(Lc.a.feb,Ne[0]);b.setValue(Lc.a.Xea,
!0);b.setValue(Lc.a.Wzb,qf.a[O]);A&&b.setValue(Lc.a.Rob,A);b.setValue(Lc.a.n2b,0)}Cyj(b,h=null,t=null){h&&(pi.a.Hj?this.Cd.PD(b,h,!0):this.Cd.Es.set(b.toString(),h));t&&(pi.a.Hj?this.Cd.PD(b,t,!1):this.Cd.Lt.set(b.toString(),t))}EMh(b){if(!b||!b.count||!b.J(0))return null;const h=this.Nqf(b);for(let t=0;t<b.count;t++)this.Hh.GGa(b.J(t));return h}Nqf(b){if(!b||!b.J(0))return null;const h=this.Xc.Ck();h.set(b.J(0));h.yd();h.wc();return h.QI()?h.currentNode:null}Y_l(b){const h=this.Xc.Ck();h.set(b);
h.yd();h.wc();h.wc();return h}blh(b,h,t){const A=new Mb.a;for(let O=0;O<t;O++){h=this.XJ.hib(b,h,!0,null);if(!h||!b.Sd())return null;const aa=b.currentNode;b.wc();b.wc();A.add(aa)}return A}N7b(b){const h=this.Xc.Ck();h.set(b);for(h.Ab(7);h.wc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}Q9h(b){const h=this.Xc.Ck();h.set(b);h.yd();return(b=h.gSa())?b.id:null}Pof(b){const h=this.Xc.Ck();h.set(b);return h.Ab(7)?h:null}tu(b){return this.Nh.value.Db(b)}H4b(){if(!pl.rXg){var b=
this.cva();b&&this.bhg(b);pl.rXg=!0}}MSa(b){return this.Apd.MSa(b)}itk(b,h){const t=this.Xc.Ck();t.set(b.node);const A=this.Xc.Ck();A.set(h.node);t.yd();A.yd();const O=this.Xc.Ck();O.set(t.currentNode);const aa=this.Xc.Ck();aa.set(A.currentNode);const ua=Wh.returnToLowestCommonTableCell(t,A);return ua?(O.yd(),aa.yd(),{returnValue:({rl:b}=this.xzb(O,!0,ua,b)).returnValue&&({rl:h}=this.xzb(aa,!1,ua,h)).returnValue,D7c:b,wJc:h}):{returnValue:({rl:b}=this.xzb(t,!0,null,b)).returnValue&&({rl:h}=this.xzb(A,
!1,null,h)).returnValue,D7c:b,wJc:h}}xzb(b,h,t,A){let O=null,aa=b.fd(16);for(;aa!==t;){if(h&&Gh.TableCellReader.Tsi(b)||!h&&Gh.TableCellReader.IBf(b))O=b.fd(14);else return{returnValue:!1,rl:A};aa=b.fd(16)}O&&(A=pf.a.create(O));return{returnValue:!0,rl:A}}bhg(b){if(b.Tb(26)){for(this.bhg(b);b.wf(26);)this.bhg(b);b.wc()}}remove(b,h){for(let t=0;t<b.count;t++)if(b.J(t).toString()===h.toString()){b.removeAt(t);break}}bva(b){const h=this.Xc.Ck();h.set(b);h.I0(this.cva().currentNode);return h}HSl(b,h){for(let t=
0;t<b.count;t++)if(b.J(t).equals(h))return t;return-1}Byj(b,h,t,A){b=this.IJl(b,h);for(h=0;h<b.count;h++)A(b.J(h))&&(t?b.J(h).setValue(Lc.a.OW,t):b.J(h).removeProperty(Lc.a.OW),this.Yhd.instance&&this.Yhd.instance.cri&&b.J(h).Wk(16,!0))}IJl(b,h){const t=new Mb.a;var A=this.tu(b);const O=this.tu(h);if(!A||!O)return t;const aa=({RVc:ua}=this.kMd(A,O)).returnValue;A=ua[aa];if(14===A.type)t.add(A);else if(15===A.type&&1<=aa){const Ra=ua[aa-1];1===ni.TableReader.ag(Ra)&&t.add(Ra)}var ua=ue.GraphIterator.$a(aa>=
ua.length-1?A:ua[aa+1]);ua.Ab(7);for(A=Qd.a.at(ua,A);A.moveNext()&&A.currentNode!==O;)14===A.currentNode.type&&t.add(A.currentNode);if(!W.a.Sp(h,b)&&14===O.type)for(ua=ue.GraphIterator.$a(O),A=Qd.a.at(ua,O);A.moveNext();)14===A.currentNode.type&&t.add(A.currentNode);return t}kMd(b,h){b=this.kgb(b);h=this.kgb(h);let t=0;for(;t<b.length&&t<h.length&&b[t]===h[t];++t);return{returnValue:0<t?t-1:t,RVc:b,p5f:h}}kgb(b){const h=[];h.push(b);b=ue.GraphIterator.$a(b);for(b.Ab(7);b.wc();)h.push(b.currentNode);
h.reverse();return h}static get Xb(){return null!=pl.jvg?pl.jvg:pl.jvg=Sa.a.instance.Ma("Box4.IFeatureHelper")}}pl.rXg=!1;Object(m.a)(pl,"ContentControlGraphManager",null,[372]);class f{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb){this.pue=Nb;this.Nqa=null;this.OGm=(Yb,bc)=>{if(this.EX)return this.PGm(Yb,bc);if(!Yb||!Yb.count)return u.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let Dc=!0;switch(bc){case 0:bc=this.xK(Yb.J(0),Yb.J(Yb.count-1),1);if((Yb=this.xK(Yb.J(0),Yb.J(Yb.count-
1),3))&&0<Yb.count){if(!Yb.J(0).isSupported||!Yb.J(0).isEditable){Dc=!1;break}for(Yb=Yb.J(0);Yb;)this.C2c(bc,Yb.id),Yb=this.getById(Yb.parentId)}if(bc)for(var Pc of bc)if(!Pc.isSupported||!Pc.isEditable){Dc=!1;break}break;case 1:if(Yb.J(0).contextId!==mc.a.Vc){u.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");Dc=!1;break}(bc=this.xK(Yb.J(0),Yb.J(0),1))&&0<bc.count&&(Dc=!1);break;case 2:if(Yb.J(0).contextId!==mc.a.Vc){u.ULS.sendTraceTag(17424994,
368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");Dc=!1;break}(bc=this.xK(Yb.J(0),Yb.J(0),3))&&0<bc.count&&(Dc=!1);break;case 3:case 4:bc=this.xOd(Yb.J(0),!0);Pc=this.xOd(Yb.J(Yb.count-1),!1);if(!bc||!Pc){u.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");Dc=!1;break}if((bc=this.xK(bc,bc,3))&&0<bc.count){Dc=!1;break}if((bc=this.xK(Pc,Pc,3))&&0<bc.count){Dc=!1;break}if(bc=
this.Qm.xK(Yb.J(0),Yb.J(Yb.count-1),1))for(const jd of bc)if(!jd.pga){Dc=!1;break}break;default:Dc=!1}return Dc};f.Ix=b;f.Nh=h;this.$g=t;this.Yq=A;this.Qm=O;this.k1=aa;this.zra=ua;this.Pf=Ra;this.Ao=ub}get sPa(){return!!this.Pf.instance&&this.Pf.instance.sPa}get Dna(){return!!this.Pf.instance&&this.Pf.instance.Dna}get nWd(){return!!this.Pf.instance&&this.Pf.instance.nWd}get EX(){return!!this.Pf.instance&&this.Pf.instance.EX}get qWd(){return!!this.Pf.instance&&this.Pf.instance.qWd}XFb(){return!!this.Pf.instance&&
this.Pf.instance.XFb}Uka(b,h,t=null,A=null,O=!1){if(!this.sPa)return{returnValue:2,id:0};b=this.$g.zma(b,!0);h=this.$g.zma(h,!1);if(!b||!h)return{returnValue:2,id:0};b=pf.a.create(b);h=pf.a.create(h);return this.Ojh(b,h,t,A,O,0,!1)}Sjk(b,h,t=0,A=!1){return this.sPa&&b&&h?this.Ojh(b,h,null,null,!1,t,A):{returnValue:2,id:0}}hYa(b,h=null,t=0,A=!1){let O=0;if(!this.sPa)return{returnValue:2,id:O};const aa=this.k1.iAb(h,f.Ix,f.Nh,this.$g,this.Yq,this.Qm,this.zra,this.sPa,this.nWd);aa.type=t;aa.start=b;
aa.end=b;aa.Zt=b.node.id;aa.Vy=b.node.id;aa.Uf=!1;return this.Qm.Pkh(aa,h,A)?(O=aa.id,{returnValue:0,id:O}):{returnValue:2,id:O}}Lkk(b,h=null){if(!this.sPa||!this.hDm(b))return{returnValue:2,id:0};var t=b.J(0).contextId===mc.a.endOfParagraph?b.J(1):b.J(0);const A=b.J(b.count-1);if(this.m7e(b,mc.a.paragraph)||this.m7e(b,mc.a.endOfParagraph)){b=t.node.id;let O=A.node.id;const aa=b.equals(O);t=this.Qm.foj(t,!0);void 0!==t&&null!==t&&(b=t,O=aa?b:O);this.Qm.foj(A,!1);h.setValue(Lc.a.c8,!0);return this.Uka(b,
O,h)}return t!==A||t.contextId!==mc.a.Fd&&t.contextId!==mc.a.Vc?{returnValue:2,id:0}:(h.setValue(Lc.a.c8,!1),this.hYa(t,h))}getById(b){if(!this.Dna)return null;const h=this.$g.eNc(this.$g.cva(),t=>t.getValue(Lc.a.jx)===b,!0);return 0<h.count?this.Qm.nQ(h.J(0)):null}getByTitle(b){if(!this.Dna)return null;const h=this.$g.eNc(this.$g.cva(),A=>A.ia(Lc.a.eeb,null)===b,!1),t=new Mb.a;for(const A of h)t.add(this.Qm.nQ(A));return t}getByTag(b){if(!this.Dna)return null;const h=this.$g.eNc(this.$g.cva(),A=>
A.ia(Lc.a.heb,null)===b,!1),t=new Mb.a;for(const A of h)t.add(this.Qm.nQ(A));return t}xK(b,h,t,A=!1){return this.Dna?this.EX?this.Qm.Bma(b,h,t):this.Qm.xK(b,h,t,A):null}wT(b,h){return this.Qm.wT(b,h)}cEl(){if(!this.Dna)return null;const b=this.$g.eNc(this.$g.cva(),()=>!0,!1),h=new Mb.a;for(const t of b)h.add(this.Qm.nQ(t));return h}JLb(b){if(!this.sPa)return u.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;b=this.getById(b);return this.Qm.Bxa(b)?
0:2}Rbl(b){if(!this.sPa)return 2;b=this.getById(b);return this.Qm.deleteContentControl(b)?0:2}blk(b){this.Qm.RNn(b)}cDk(b){this.Nqa=b;this.Nqa.PPn(this.OGm)}XJl(b){if(!this.XFb())return null;let h;var t=b.EE();h=this.xOd(t.J(t.count-1),!1);t=this.Yq.MNc(t.J(t.count-1).node,h.cpBegin).Jb;b=this.o8l(t,b);if(-1===b)return null;h.Fb=b;h.Sb=h.Fb;return h}PGm(b,h){if(!b||!b.count)return u.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(h){case 0:return this.xBm(b);
case 3:case 4:case 6:return this.NIm(b,6===h);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==mc.a.Vc?(u.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.Qti(b.J(0),5===h,!1);default:return!1}}xBm(b){const h=this.Qm.Bma(b.J(0),b.J(b.count-1),3);if(h&&0<h.count){var t=h.J(0);if(!t.isSupported||!t.isEditable)return!1}b=this.Qm.Bma(b.J(0),b.J(b.count-1),1);for(t=0;h&&t<h.count;t++)this.C2c(b,
h.J(t).id);if(b)for(const A of b)if(!A.isSupported||!A.isEditable)return!1;return!0}NIm(b,h){var t=b.J(0),A=b.J(b.count-1),O=t.zj,aa=A.Ep;if(-1===O||-1===aa)return!1;O=this.Ao.I7(t.node,O,t.Fb);aa=this.Ao.I7(A.node,aa,A.Sb);var ua=-1,Ra=Math.min(O.count,aa.count);for(--Ra;0<=Ra;Ra--){const ub=O.J(Ra).le,Nb=aa.J(Ra).le;if(ub.equals(Nb)){ua=Ra;break}}if(-1<ua&&(Ra=this.Qm.nQ(O.J(ua).contentControlNode),!Ra.isEditable||!Ra.isSupported||Ra.wO&&!this.cBm(Ra,b)))return!1;t=this.Qm.Bma(t,A,1);for(A=0;A<=
ua;A++)this.C2c(t,this.Qm.nQ(O.J(A).contentControlNode).id);for(A=ua+1;A<O.count;A++){Ra=this.Qm.nQ(O.J(A).contentControlNode);if(!Ra.isEditable||!Ra.pga||!Ra.isSupported||Ra.wO)return!1;this.C2c(t,Ra.id)}for(O=ua+1;O<aa.count;O++){ua=this.Qm.nQ(aa.J(O).contentControlNode);if(!ua.isEditable||!ua.pga||!ua.isSupported||ua.wO)return!1;this.C2c(t,ua.id)}if(t)for(const ub of t)if(!ub.isSupported||!ub.pga)return!1;return h&&(b=this.xOd(b.J(0),!0))?this.Qti(b,!0,!0):!0}cBm(b,h){h=this.Ao.U_l(h.J(0),h.J(h.count-
1));return!!b&&!!h&&b.objectId.equals(h.le)}Qti(b,h,t){return(b=this.Qm.Bma(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||!b.isEditable||!this.qWd&&h&&!b.Uf||!t&&b.wO||pi.a.xWf&&h&&1===b.type)?!1:!0}xOd(b,h){if(!b)return null;let t=null;switch(b.contextId){case mc.a.paragraph:t=h?pf.a.Tc(b.node,0):pf.a.Bw(b.node);break;case mc.a.endOfParagraph:t=pf.a.Bw(b.node);break;case mc.a.Fd:t=h?pf.a.Tc(b.node,b.cpBegin):pf.a.Tc(b.node,b.cpEnd);break;case mc.a.Vc:t=b}t&&(t.Sb=t.Fb=h?b.Fb:b.Sb);return t}C2c(b,
h){if(b)for(const t of b)if(t.id===h){b.remove(t);break}}o8l(b,h){if(!b)return-1;let t=-1;for(let A=0;A<b.length;A++)if(b.J(A).le.equals(h.objectId)&&!1===b.J(A).Oc){t=A;if(h.Uf&&0<A&&b.J(A-1).Uf&&!b.J(A-1).Oc)return-1;break}return t}hDm(b){if(void 0===b||null===b)return!1;for(let h=0;h<b.count;h++){const t=b.J(h).contextId;if(t!==mc.a.paragraph&&t!==mc.a.endOfParagraph&&t!==mc.a.Fd&&t!==mc.a.Vc||0<h&&h<b.count-1&&t===mc.a.Fd&&(b.J(h).cpBegin||b.J(h).cpEnd!==b.J(h).node.characterData.length))return!1}return b.J(0).contextId===
mc.a.endOfParagraph&&1===b.count||this.m7e(b,mc.a.Vc)&&1<b.count?!1:!0}m7e(b,h){for(const t of b)if(t.contextId===h)return!0;return!1}Ojh(b,h,t=null,A=null,O=!1,aa=0,ua=!1){let Ra=0;var ub=h.node;let Nb=pf.a.create(b.node);ub=pf.a.create(ub);if(pi.a.contentControlAroundTableFix){if(!({D7c:Nb,wJc:ub}=this.pue.Hzh(Nb,ub)).success)return{returnValue:2,id:Ra}}else if(!({D7c:Nb,wJc:ub}=this.$g.itk(Nb,ub)).returnValue)return{returnValue:2,id:Ra};const Yb=this.k1.iAb(t,f.Ix,f.Nh,this.$g,this.Yq,this.Qm,
this.zra,this.sPa,this.nWd);Yb.type=aa;Yb.start=b;Yb.end=h;Yb.Zt=Nb.node.id;Yb.Vy=ub.node.id;Yb.Uf=!0;Yb.MHd=A;Yb.rdf=O;return this.Qm.Pkh(Yb,t,ua)?(Ra=Yb.id,{returnValue:0,id:Ra}):{returnValue:2,id:Ra}}}f.Ix=null;f.Nh=null;Object(m.a)(f,"ContentControlManager",null,[368]);var w=c(706),G=c(163),X=c(198);class la extends Sys.EventArgs{constructor(b){super();this.K$k=b}}Object(m.a)(la,"ContentControlChangeEventArgs",Sys.EventArgs,[]);class La{constructor(){this.HKi=0;this.MUi=null}}Object(m.a)(La,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",
null,[]);const fb=b=>!(null===b||void 0===b?0:b.length),tb=b=>null==b?!1:[...b].some(h=>h.Oc),Ob=b=>null==b?!1:[...b].some(h=>!h.Oc);class ic{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd,ee,Od,fe,Ee,re,Fg,Gg,bm){this.lj=bm;this.f9g=[];this.OMe=[];this.Ix=b;this.Nh=h;this.$g=t;this.Yq=A;this.k1=O;this.ue=ub;this.ax=Nb;this.ib=aa;this.hE=ua;this.BAa=Ra;this.zra=Pc;this.Lxb=jd;this.jea=Yb;this.VH=bc;this.ga=Dc;this.Ao=Cd;this.Pf=ee;this.uh=Od;this.eb=fe;this.Ic=Ee;this.thh=re;this.jd=Fg;this.Cd=
Gg;this.VH&&(this.VH.addHandler(w.a.ILb,Object(z.a)(this,this.gRi,"onShowingPlaceholder")),this.VH.addHandler(w.a.ybe,Object(z.a)(this,this.nQi,"onRemoveWhenEdited")))}get my(){return this.Ix.value}get Hi(){return this.Nh.value}get EX(){return!!this.Pf.instance&&this.Pf.instance.EX}get q_(){return!!this.jd&&this.jd.isFeatureEnabled(28)}dispose(){this.VH&&(this.VH.removeHandler(w.a.ILb,Object(z.a)(this,this.gRi,"onShowingPlaceholder")),this.VH.removeHandler(w.a.ybe,Object(z.a)(this,this.nQi,"onRemoveWhenEdited")))}xK(b,
h,t,A=!1){if(this.EX)return this.Bma(b,h,t);if(!b||!h)return null;const O=this.$g.zma(b.node.id,!0);var aa=this.$g.zma(h.node.id,!1);if(!O||!aa)return null;b=b.contextId===mc.a.endOfParagraph?b:pf.a.Tc(O,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===mc.a.endOfParagraph?h:pf.a.Tc(aa,-1===h.cpEnd?aa.characterData.length:h.cpEnd);aa=null;switch(t){case 0:aa=this.cOl(b,h);break;case 1:aa=this.e0l(b,h);break;case 3:aa=this.v$h(b,h,A);break;case 2:aa=this.r9l(b,h);break;case 4:aa=this.vmf(b,h,!1)}return aa}Bma(b,
h,t){if(!b||!h||b.contextId!==mc.a.endOfParagraph&&(b=this.hFh(b,!0),!b)||h.contextId!==mc.a.endOfParagraph&&(h=this.hFh(h,!1),!h))return null;let A=null;switch(t){case 0:A=this.dOl(b,h);break;case 1:A=this.f0l(b,h);break;case 3:A=this.w$h(b,h);break;case 2:A=this.s9l(b,h);break;case 4:A=this.vmf(b,h,!0)}return A}hFh(b,h){var t=this.$g.zma(b.node.id,h);if(!t)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(h=-1===b.cpEnd?t.characterData.length:b.cpEnd,b=b.Sb);t=pf.a.Tc(t,h);t.Fb=b;t.Sb=b;return t}cOl(b,
h){const t=new Mb.a;if(b.contextId===mc.a.endOfParagraph||h.contextId===mc.a.endOfParagraph||b.equals(h))return t;const A=new sp.a,O=this.KCb(b,b),aa=this.KCb(h,h);for(let ua=0;ua<O.count;ua++)if(O.J(ua).Oc)for(let Ra=0;Ra<aa.count;Ra++)aa.J(Ra).Oc||O.J(ua).le.equals(aa.J(Ra).le)&&(!O.J(ua).Uf||this.$g.JPa(O.J(ua).le,b.node.id,!0)&&this.$g.JPa(aa.J(Ra).le,h.node.id,!1))&&this.Gxd(t,A,O.J(ua).le);return t}dOl(b,h){const t=new Mb.a;if(b.contextId===mc.a.endOfParagraph||h.contextId===mc.a.endOfParagraph||
b.equals(h)&&b.Fb===b.Sb||-1===b.Fb||-1===h.Sb)return t;var A=b.node.qa.ei(b.cpBegin),O=h.node.qa.ei(h.cpEnd);A&&A.Jb&&0<A.Jb.length&&b.Fb<=A.Jb.length&&O&&O.Jb&&0<O.Jb.length&&h.Sb<=O.Jb.length&&(b=b.Fb,h=h.Sb,b===A.Jb.length&&b--,0<h&&h--,A=A.Jb.J(b),O=O.Jb.J(h),A.Oc&&!O.Oc&&W.a.Sp(A.le,O.le)&&A.pp&&O.pp&&(O=A.contentControlNode)&&t.add(this.nQ(O)));return t}e0l(b,h){const t=new Mb.a,A=new sp.a,O=this.KCb(b,h);for(let aa=0;aa<O.count;aa++)this.Gxd(t,A,O.J(aa).le);b=this.v$h(b,h,!1,!1);for(const aa of b)A.contains(aa.objectId)||
(t.add(aa),A.add(aa.objectId));return t}f0l(b,h){const t=new Mb.a,A=new sp.a,O=this.Elf(b,h);for(let aa=0;aa<O.count;aa++)this.GWe(t,A,O.J(aa));b=this.w$h(b,h);for(const aa of b)A.contains(aa.objectId)||(t.add(aa),A.add(aa.objectId));return t}v$h(b,h,t,A=!0){const O=new Mb.a;b.equals(h)&&(t=!1);const aa=new sp.a;let ua=!1;b=this.KCb(null,b,!0,t);h=this.KCb(h,null,t,!0);for(t=b.count-1;0<=t;t--){for(let Ra=0;Ra<h.count&&!(b.J(t).le.equals(h.J(Ra).le)&&(b.J(t),this.Gxd(O,aa,b.J(t).le)&&(ua=!this.$g.tu(b.J(t).le).ia(Lc.a.c7,
null),A||ua)));Ra++);if(0<O.count&&(A||ua))break}return O}w$h(b,h){const t=new Mb.a,A=new sp.a,O=b.node;var aa=h.node;const ua=h.contextId===mc.a.endOfParagraph?aa.characterData.length:h.cpEnd;b=this.Ao.I7(O,b.contextId===mc.a.endOfParagraph?O.characterData.length:b.cpBegin,b.Fb);h=this.Ao.I7(aa,ua,h.Sb);aa=b.count>h.count?h.count:b.count;for(--aa;0<=aa;aa--)b.J(aa).le.equals(h.J(aa).le)&&this.GWe(t,A,b.J(aa));return t}r9l(b,h){const t=new Mb.a;let A=new sp.a;const O=this.KCb(b,h);let aa=0,ua=null;
if(b.equals(h))return t;for(b=0;b<O.count;b++)!O.J(b).Oc||O.J(b).Uf&&!this.$g.JPa(O.J(b).le,O.J(b).Kb.paragraph.id,!0)?O.J(b).Oc||O.J(b).Uf&&!this.$g.JPa(O.J(b).le,O.J(b).Kb.paragraph.id,!1)||(aa--,0>aa?(aa=0,A=new sp.a):!aa&&ua&&O.J(b).le.equals(ua)&&this.Gxd(t,A,ua)):(aa||(ua=O.J(b).le),aa++);return t}s9l(b,h){const t=new Mb.a;if(b.equals(h)&&b.Fb===h.Sb)return t;let A=new sp.a;b=this.Elf(b,h);h=0;let O=null;for(let aa=0;aa<b.count;aa++){const ua=b.J(aa);!ua.Oc||ua.Uf&&!this.$g.JPa(ua.le,ua.Kb.paragraph.id,
!0)?ua.Oc||ua.Uf&&!this.$g.JPa(ua.le,ua.Kb.paragraph.id,!1)||(h--,0>h?(h=0,A=new sp.a):!h&&O&&ua.le.equals(O.le)&&this.GWe(t,A,O)):(h||(O=ua),h++)}return t}vmf(b,h,t){const A=new Mb.a;b=t?this.Elf(b,h):this.KCb(b,h);h=0;for(t=0;t<b.count;t++){var O=b.J(t);O.pp&&(O.Oc?h++:(h--,0>h?h=0:(O=this.nQ(O.contentControlNode))&&A.add(O)))}return A}KCb(b,h,t=!0,A=!0){const O=new Mb.a,aa=this.wT(b,h);if(!aa.count)return O;let ua,Ra,ub,Nb;for(let Yb=0;Yb<aa.count;Yb++){ua=0;Ra=aa.J(Yb).characterData.length;ub=
Nb=!0;if(b&&aa.J(Yb).id.equals(b.node.id)){if(b.contextId===mc.a.endOfParagraph)continue;0<=b.cpBegin&&(ua=b.cpBegin)}h&&aa.J(Yb).id.equals(h.node.id)&&0<=h.cpEnd&&(Ra=h.cpEnd);Yb||(ub=t);Yb!==aa.count-1||h&&h.contextId===mc.a.endOfParagraph||(Nb=A);O.addRange(this.Flf(aa.J(Yb),ua,Ra,ub,Nb))}return O}Elf(b,h){const t=new Mb.a,A=this.wT(b,h);let O,aa,ua;for(let ub=0;ub<A.count;ub++){const Nb=A.J(ub);if(Nb.qa.length){var Ra=Nb.qa.J(Nb.qa.length-1);O=0;aa=Nb.characterData.length;ua=0;Ra=Ra&&Ra.Jb?Ra.Jb.length:
0;b&&Nb.id.equals(b.node.id)&&(O=b.zj,ua=b.Fb);h&&Nb.id.equals(h.node.id)&&(aa=h.Ep,Ra=h.Sb);t.addRange(this.Glf(Nb,O,aa,ua,Ra))}}return t}Flf(b,h,t,A=!0,O=!0,aa=!0){const ua=new Mb.a;b=b.qa;for(let Ra=0;Ra<b.length;Ra++){if(b.J(Ra).cp<h)continue;if(b.J(Ra).cp>t)break;const ub=b.J(Ra);if(ub.Jb&&0<ub.Jb.length&&(ub.cp!==h||A)&&(ub.cp!==t||O))for(let Nb=0;Nb<ub.Jb.length;Nb++){const Yb=ub.Jb.J(Nb);(aa||Yb.Oc)&&ua.add(Yb)}}return ua}Glf(b,h,t,A,O){const aa=new Mb.a;b=b.qa;for(let ua=0;ua<b.length;ua++){if(b.J(ua).cp<
h)continue;if(b.J(ua).cp>t)break;const Ra=b.J(ua);if(Ra.Jb&&0<Ra.Jb.length){let ub=0,Nb=Ra.Jb.length;Ra.cp===h&&-1!==A&&(ub=A);for(Ra.cp===t&&-1!==O&&(Nb=O);ub<Nb&&ub<Ra.Jb.length;ub++)aa.add(Ra.Jb.J(ub))}}return aa}Gxd(b,h,t){let A=null;if(h.contains(t)||!(A=this.Hi.Db(t)))return!1;b.add(this.nQ(A));h.add(t);return!0}GWe(b,h,t){let A=null;!h.contains(t.le)&&(A=t.contentControlNode)&&(b.add(this.nQ(A)),h.add(t.le))}Dvj(b,h){let t,A=!1;t=({e4a:h,d4a:b,t6c:A}=this.Evj(b,h,!1,A)).returnValue||A;A&&(t=
t||({e4a:h,d4a:b,t6c:A}=this.Evj(h,b,!0,A)).returnValue);return{returnValue:t,e4a:h,d4a:b}}Evj(b,h,t,A){var O,aa,ua,Ra;let ub,Nb;if(t)return ub=Nb=null,{returnValue:!1,e4a:Nb,d4a:ub,t6c:!1};let Yb=!1;Nb=b;ub=h;const bc=b.cpBegin,Dc=h.cpEnd;A=!1;var Pc=t?this.M_h(h):this.pEl(b);let jd=!1,Cd=!1,ee=0,Od=0;for(const fe of Pc)for(Pc=0;Pc<fe.qa.length;Pc++){const Ee=fe.qa.J(Pc);!Cd&&fe.id.equals(h.node.id)&&(Cd=!0);if(!jd&&(fe.id.equals(h.node.id)&&-1!==Dc&&Ee.cp>Dc||Cd&&!fe.id.equals(h.node.id)))if(jd=
!0,ee!==Od)Yb=!0;else return{returnValue:!1,e4a:Nb,d4a:ub,t6c:A};if((!fe.id.equals(b.node.id)||Ee.cp>=bc||-1===bc)&&Ee.Jb)for(let re=0;re<Ee.Jb.length;re++){const Fg=Ee.Jb.J(re),Gg=this.Hi.Db(Fg.le);if(!Gg.getValue(Lc.a.c8)||(!Fg.Oc||this.$g.JPa(pi.a.Hj?this.Cd.Mq(Gg.id,!0):null!==(aa=this.Cd.Es.get(null===(O=Gg.id)||void 0===O?void 0:O.toString()))&&void 0!==aa?aa:W.a.nil,fe.id,!0))&&(Fg.Oc||this.$g.JPa(pi.a.Hj?this.Cd.Mq(Gg.id,!1):null!==(Ra=this.Cd.Lt.get(null===(ua=Gg.id)||void 0===ua?void 0:
ua.toString()))&&void 0!==Ra?Ra:W.a.nil,fe.id,!1))){Fg.Oc?ee++:ee--;if(Yb&&ee===Od)return{e4a:Nb,d4a:ub}=this.z2k(b.node,fe,b.cpBegin,Ee.cp),{returnValue:!0,e4a:Nb,d4a:ub,t6c:A};!t&&ee<Od&&(A=!0,Od--)}}}return{returnValue:Yb,e4a:Nb,d4a:ub,t6c:A}}z2k(b,h,t,A){let O;h.id.equals(b.id)?b=0<t||A<qe.ParagraphReader.textLength(h)?O=pf.a.createTextRange(h,t,A):O=pf.a.create(h):(O=0<t?pf.a.createTextRange(b,t,qe.ParagraphReader.textLength(b)):pf.a.create(b),b=A<qe.ParagraphReader.textLength(h)?pf.a.createTextRange(h,
0,A):pf.a.create(h));return{e4a:O,d4a:b}}dXl(b){var h,t,A,O;const aa=b.cpBegin,ua=this.M_h(b);for(let ub=ua.count-1;0<=ub;ub--){const Nb=ua.J(ub);for(let Yb=Nb.qa.length-1;0<=Yb;Yb--){const bc=Nb.qa.J(Yb);if((!Nb.id.equals(b.node.id)||bc.cp<=aa||-1===aa&&!bc.cp)&&bc.Jb){var Ra=bc.Jb.length-1;for((bc.cp===aa||-1===aa&&!bc.cp)&&this.EX&&Nb.id.equals(b.node.id)&&(Ra=b.Fb-1);0<=Ra;Ra--){const Dc=bc.Jb.J(Ra),Pc=this.Hi.Db(Dc.le);if(Dc.Oc){if(Pc.getValue(Lc.a.c8)&&!this.$g.JPa(pi.a.Hj?this.Cd.Mq(Pc.id,
!0):null!==(O=this.Cd.Es.get(null===(A=Pc.id)||void 0===A?void 0:A.toString()))&&void 0!==O?O:W.a.nil,Nb.id,!0))continue;return null}if(!Pc.getValue(Lc.a.c8)||this.$g.JPa(pi.a.Hj?this.Cd.Mq(Pc.id,!1):null!==(t=this.Cd.Lt.get(null===(h=Pc.id)||void 0===h?void 0:h.toString()))&&void 0!==t?t:W.a.nil,Nb.id,!1))return this.nQ(Pc)}}}}return null}nQ(b){if(!b)return null;this.$g.H4b();return this.k1.iAb(b,this.Ix,this.Nh,this.$g,this.Yq,this,this.zra,this.jea,this.Lxb)}wT(b,h){b=this.L_h(b,h,ic.vDb(12));
if(!b)return null;h=new Mb.a;for(const t of b)h.add(t);return h}nEl(b,h){const t=ic.uTl();return this.L_h(pf.a.create(b.node),pf.a.create(h.node),t)}L_h(b,h,t){if(!t||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var A=b.node;if(A&&t(A)){var O;return O=new Mb.a,O.add(A),O}}A=Object.assign(new La,{HKi:35,MUi:t});b=b?b.node:null;h=h?h.node:null;O=this.j4l(b,h);if(!O)return null;h=this.ltk(h,t,ic.Evh,A);return this.jEl(b,h,O,t,ic.Evh,A)}j4l(b,h){return(b=b?this.k7h(b):this.k7h(h))?
b.fd(35):this.$g.PZl()}ltk(b,h,t,A){if(!b)return null;h(b)||(h=this.kEl(b,h,t,A),h.count&&(b=h.J(h.count-1)));return b}jEl(b,h,t,A,O,aa){b?(b=ue.GraphIterator.$a(b),b.Ab(7),t=Qd.a.at(b,t)):t=Qd.a.So(t);O&&t.Sn(O,aa);for(O=new Mb.a;t.moveNext()&&(A(t.currentNode)&&O.add(t.currentNode),!h||!t.currentNode.id.equals(h.id)););return O}kEl(b,h,t,A){b=Qd.a.So(b);t&&b.Sn(t,A);for(t=new Mb.a;b.moveNext();)h(b.currentNode)&&t.add(b.currentNode);return t}k7h(b){b=ue.GraphIterator.$a(b);return b.Ab(35)?b:null}Eii(b,
h){b=this.wT(b,h);for(const t of b)if((b=this.$g.Pof(t))&&b.ega(4))return!0;return!1}Pkh(b,h=null,t=!1){if(!b)return!1;let A=b.start;var O=b.end;if(!nf.SelectionEditor.Xu(A)&&A.contextId!==mc.a.paragraph||!nf.SelectionEditor.Xu(O)&&O.contextId!==mc.a.paragraph||!this.EX&&({e4a:A,d4a:O}=this.Dvj(b.start,b.end)).returnValue||this.EX&&!({start:A,end:O}=this.DLk(A,O)).returnValue)return!1;b.start=A;b.end=O;const aa=this.FBm(A,O);if(this.EX){var ua=this.Bma(b.start,b.end,3);var Ra=this.Bma(b.start,b.end,
2)}else ua=this.xK(b.start,b.end,3),Ra=this.xK(b.start,b.end,2);const ub=ua&&0<ua.count?ua.J(0):null,Nb=Ra&&0<Ra.count?Ra.J(0):null;if(t)return this.pSc(b,0,ua)?!0:!1;if(this.pSc(b,0,ua)){t=(t=Object(Da.a)(zg,this.dXl(b.start)))?this.$g.tu(t.objectId):null;Ra=this.$g.Mkk(b,ub,t,Ra,b.Zt,b.Vy,h);this.lj.ccc(Ra);if(b.Uf)for(O=this.wT(b.start,b.end),t=0;t<O.count;t++)if(this.EX){ua=ub?ub.objectId:null;const Yb=this.R6h(ua,O.J(t),!0);this.Yq.Xsa(O.J(t),Ra.id,0,!0,!0,void 0,void 0,void 0,void 0,Yb);ua=
this.R6h(ua,O.J(t),!1);this.Yq.Xsa(O.J(t),Ra.id,O.J(t).characterData.length,!0,!1,void 0,void 0,void 0,void 0,ua)}else this.Yq.Xsa(O.J(t),Ra.id,0,!0,!0),this.Yq.Xsa(O.J(t),Ra.id,O.J(t).characterData.length,!0,!1);else this.EX?(t=-1===A.Fb?0:A.Fb,this.Yq.Xsa(b.start.node,Ra.id,A.cpBegin,!1,!0,void 0,void 0,void 0,void 0,t),this.Yq.Xsa(b.end.node,Ra.id,O.cpEnd,!1,!1,void 0,void 0,void 0,void 0,aa?t+1:O.Sb)):(this.Yq.Xsa(b.start.node,Ra.id,b.start.cpBegin,!1,!0),this.Yq.Xsa(b.start.node,Ra.id,b.start.cpEnd,
!1,!1));h||this.$g.kao(Ra,b.Uf,b.id,this.$g.N7b(this.$g.tu(b.Zt)),b.type);1===b.type&&this.Yq.zJo(b.start.node,A.zj,A.Ep);b.objectId=Ra.id;h=this.$g.cva().currentNode;h.hasProperty(Lc.a.oGc)||h.setValue(Lc.a.oGc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);ub&&this.sAj(ub.contentControlNode,b);Nb&&this.sAj(Ra,Nb);aa&&this.ga.Rb(qa.a.M6c,2,b.id);return!0}return!1}deleteContentControl(b){if(!this.pSc(b,3))return u.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),
!1;if(this.lj.G9c(b.contentControlNode))return!0;b.wO&&(b.wO=!1);const h=this.ib.hb.lb;b=b.EE();const t=new Kg.Selection(b.toArray(),!0);let A=!1;this.ib.xMb(()=>{this.ib.setSelection(t);if(32===this.ga.processAction(qa.a.kH,2)){if(this.thh.instance){const O=this.thh.instance.x8h(h,t,this.ib.hb.lb);this.ib.sLo(new G.SelectionCollection([O],0))}A=!0}});return A}Bxa(b,h=!1,t=!1){if(this.pSc(b,2)){if(b.wO)return u.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),
this.deleteContentControl(b);const A=pi.a.fr?b.contentControlNode:this.$g.tu(b.objectId);let O=new Mb.a;h&&(O=b.Pkf());O.add(b);if(t||!this.lj.G9c(b.contentControlNode)){A&&A.anchor&&this.$g.qMh(A,h);for(const aa of O)b=this.wT(aa.start,aa.end),this.Yq.acl(b,aa.objectId);this.F_i(O)}u.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}u.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}mhj(b,h){var t;if(this.pSc(b,1)){let Ra=!1;h||
(Ra=!0,{wlo:A,returnValue:h}=this.RDb(b),A&&this.$g.cva().currentNode.setValue(Lc.a.oGc,h));var A=b.N1h().toArray();for(var O=0;O<A.length;O++)this.Bxa(A[O],!0);A=this.Ito(h);if(b.Uf){O=this.wT(b.start,b.end);if(!O.count)return!1;if(1===O.count&&v.AFrameworkApplication.nD){A=A.join(" ");if(null===(t=v.AFrameworkApplication.K)||void 0===t?0:t.getBooleanFeatureGate("Microsoft.Office.WordOnline.rtfSupportCA",!1))A=h;this.Yq.replaceTextRange(pf.a.createTextRange(O.J(0),0,O.J(0).characterData.length),
A)}else{t=this.$g.Y_l(O.J(0));h=O.J(0).V5b();O=this.$g.EMh(O);t=this.$g.blh(t,O,A.length);for(O=0;O<t.count;O++){this.Yq.replaceTextRange(pf.a.createTextRange(t.J(O),0,0),A[O]);for(var aa=0;aa<h.count;aa++)this.Yq.Xsa(t.J(O),h.J(aa),0,!0,!0),this.Yq.Xsa(t.J(O),h.J(h.count-aa-1),t.J(O).characterData.length,!0,!1)}b.hRo(t.J(0).id,t.J(t.count-1).id);A=this.hE.te(t.J(0),0);this.ib.setSelection(A)}}else{O=0;1<A.length&&u.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");
h=b.start;t=h.node;for(var ua=0;ua<t.qa.length&&h.contextId===mc.a.Fd;ua++)if(aa=t.qa.J(ua),aa.cp===h.cpBegin&&aa.blob){O++;for(ua+=1;ua<t.qa.length;ua++)if(aa=t.qa.J(ua),aa.cp>h.cpBegin&&aa.cp<=h.cpEnd)if(aa.blob)O++;else break;else if(aa.cp>h.cpEnd)break;break}if(0<O&&O+h.cpBegin<h.cpEnd)t=pf.a.createTextRange(h.node,h.cpBegin,h.cpBegin+O),h=pf.a.createTextRange(h.node,h.cpBegin+O,h.cpEnd),this.Yq.replaceTextRange(h,A[0]),this.Yq.replaceTextRange(t,"");else if(0<O&&O+h.cpBegin===h.cpEnd)for(this.Yq.replaceTextRange(b.start,
A[0]),A=0;A<t.qa.length;A++){if(O=t.qa.J(A),O.cp===h.cpBegin){O.blob=null;break}}else v.AFrameworkApplication.nD?(A=A.join(" "),this.Yq.replaceTextRange(b.start,A)):this.Yq.replaceTextRange(b.start,A[0])}this.Ezd(b,Ra);let ub;this.EGn((ub=new Mb.a,ub.add(b),ub));return!0}return!1}Ezd(b,h){const t=this.Yq.MNc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(t){const A=this.$g.tu(b.objectId);if(h){h=this.ax.qC(b.start.node);let O=h.Ni(ic.vwn);O||(O=h.cEa(ic.twn));O&&(this.ue.ula(t.formatting),
this.ue.Fnb(t.formatting,O));A&&(b.wO=!0)}else A&&b.wO&&(this.q0n(b,t),b.wO=!1)}else u.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}q0n(b,h){b=this.$g.tu(b.objectId);let t=null;b&&(t=b.ia(Lc.a.Vzb,W.a.nil));this.ue.ula(h.formatting);t&&!t.equals(W.a.nil)&&(b=this.Nh.value.Db(t),h.formatting=b)}RDb(b){let h=!1;b=b.v8d;this.yKm(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,wlo:h}}zRn(b,h=!0){this.jea&&(h&&
this.vRn(b),this.DRn(b))}ARn(b){if(this.jea&&(b=this.xK(b,b,4)))for(const h of b)this.Bxa(h,!1)}ign(b,h){if(h&&!b.Oc&&(this.$g.H4b(),(b=b.Kb.paragraph.Mc.Db(b.le))&&b.anchor)){this.$g.qMh(b);b=this.k1.iAb(b,this.Ix,this.Nh,this.$g,this.Yq,this,this.zra,this.jea,this.Lxb);let t;this.F_i((t=new Mb.a,t.add(b),t))}}nQi(b,h){this.$g.H4b();b=this.$g.tu(h.le);const t=this.nQ(b);if(t&&t.isValid()&&t.removeWhenEdited){const A=this.Ic.Qc(7);A.Eb(b);this.Bxa(t,!1);h.state=2;A.dispose()}}gRi(b,h){this.$g.H4b();
b=this.$g.tu(h.le);this.Kzm(b)&&(b=b.ia(Lc.a.jx,0),this.ga&&(this.ga.Rb(qa.a.M6c,2,b),ic.Kd.iZe()))}Kzm(b){return b&&b.isConnected&&!b.ia(Lc.a.d7,!1)?pi.a.fr?this.pWd(b)&&!b.dv:this.pWd(b):!1}pWd(b){b=this.k1.iAb(b,this.Ix,this.Nh,this.$g,this.Yq,this,this.zra,this.jea,this.Lxb);if(!b.isValid())return!1;if(b.Uf){if(b.Zt.toString()===b.Vy.toString()){var h=this.$g.tu(b.Zt);if(!h)return u.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===h.type&&
1===h.qa.length)return this.dri(h.qa.J(0),b.objectId)}}else{h=b.start;if(!h)return u.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(h.cpBegin===h.cpEnd)return h=this.$g.tu(b.Zt).qa.ei(h.cpBegin),this.dri(h,b.objectId)}return!1}dri(b,h){b=b?b.Jb:null;if(!b)return!1;const t=b.MI(h,!0);return-1<t&&t+1<b.length&&b.J(t+1).le.toString()===h.toString()}RNn(b){this.OMe.push(b)}foj(b,h){if(void 0===b||null===b||b.contextId!==mc.a.Fd)return null;
b=pf.a.Tc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<qe.ParagraphReader.textLength(b.node)?this.$g.MSa(b):null}select(b,h){if(b&&!b.equals(W.a.nil)){var t=this.$g.tu(b);if(t&&55===t.type){t=this.nQ(t);if(t.Uf)t=this.dGl(t);else{t=t.start;pi.a.Oj&&(t.contextId=mc.a.Fd);if(!t)return;t=this.hE.Zn(t)}if(t&&t.length)return this.mej(t.Qa,b,h,!0,!0),this.mej(t.Rc,b,h,!1,!1),this.ib.setSelection(t),t}}}L5n(b,h){if(!nf.SelectionEditor.jf(b)||b.Fb!==b.Sb)return!1;const t=b.Fb;return-1===t?!1:
(b=this.Ao.a0a(b.node,b.cpBegin,t,!h))&&h===b.Oc?(h=this.nQ(b.contentControlNode),this.select(b.le,!h.isEditable),!0):!1}dGl(b){var h=this.$g.eOa(b.Zt,!0);b=this.$g.eOa(b.Vy,!1);if(!h||!b)return null;h=this.nEl(pf.a.create(h),pf.a.create(b));if(!h||!h.count)return null;b=new Mb.a;for(let t=0;t<h.count;t++){let A;if(12===h.J(t).type)A=t===h.count-1?pf.a.createTextRange(h.J(t),0,qe.ParagraphReader.textLength(h.J(t))):pf.a.create(h.J(t)),this.uh&&(A.Fb=this.uh.Nq(A.node,!0),A.Sb=this.uh.Nq(A.node,!1));
else if(15===h.J(t).type)A=X.TableNodeContext.create(h.J(t));else continue;b.add(A)}return new Kg.Selection(b.toArray(),!0)}H$n(b){if(b&&!b.equals(W.a.nil)&&(this.$g.H4b(),(b=this.$g.tu(b))&&55===b.type&&b.isConnected)){var h=b.ia(Lc.a.d7,!1);b.setValue(Lc.a.d7,!1);h&&this.DMn(b)}}DMn(b){var h,t;const A=pi.a.Hj?this.Cd.Mq(b.id,!0):null!==(t=this.Cd.Es.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==t?t:W.a.nil;A.equals(W.a.nil)||(h=this.$g.zma(A,!0))&&(b=this.Yq.rmf(h,b.id,!0))&&0<
b.count&&(b=b.J(0),h=b.Kb,h.formatting=b.kQ?b.kQ.Sf(h):new pz.a(h,W.a.nil))}v3i(b){if(b=this.M2h(b))for(const h of b)this.lj.A$f()&&(h.wO=!1),this.Bxa(h,!1)}K2h(b){const h=new Mb.a;if(b=this.M2h(b))for(const t of b)h.add(t.contentControlNode);return h}BRn(b){if(b&&(11===b.type||14===b.type||15===b.type||16===b.type)){var h=this.eb.Rl(b),t=this.eb.KE(b);if(this.uh&&h&&t){b=this.uh.Nq(h,!0);const A=this.uh.Nq(t,!1);h=pf.a.create(h);t=pf.a.create(t);h.Fb=b;t.Sb=A;if(b=this.Bma(h,t,4))for(const O of b)this.Bxa(O,
!1)}}}qEl(b){var h,t,A,O;const aa=pi.a.Hj?this.Cd.Mq(b.id,!0,b.loading):null!==(t=this.Cd.Es.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==t?t:W.a.nil;b=pi.a.Hj?this.Cd.Mq(b.id,!1,b.loading):null!==(O=this.Cd.Lt.get(null===(A=b.id)||void 0===A?void 0:A.toString()))&&void 0!==O?O:W.a.nil;if(aa.equals(W.a.nil)||b.equals(W.a.nil))return new Mb.a;A=this.$g.zma(aa,!0);O=this.$g.zma(b,!1);return A&&O?this.wT(pf.a.create(A),pf.a.create(O))||new Mb.a:new Mb.a}eOa(b,h){return this.$g.eOa(b,
h)}wof(b,h){if(b&&55===b.type&&(b=this.nQ(b),b=h?b.start:b.end)){const t=pf.a.Tc(b.node,h?b.zj:b.Ep);t.Fb=t.Sb=(h?b.Fb:b.Sb)+(h?-1:1);return t}return null}UJl(b){return(b=this.nQ(b))?b.start:null}mej(b,h,t,A,O){if((b.contextId===mc.a.Fd||b.contextId===mc.a.Vc||b.contextId===mc.a.paragraph)&&(O=b.node.qa.ei(O?b.zj:b.Ep))&&O.Jb)for(let aa=0;aa<O.Jb.length;aa++){const ua=O.Jb.J(aa);if(ua.le.equals(h)&&ua.pp)if(A&&ua.Oc){b.Fb=t?aa:aa+1;break}else if(!A&&!ua.Oc){b.Sb=t?aa+1:aa;break}}}EGn(b){for(let h=
0;h<this.f9g.length;++h)(0,this.f9g[h])(this,new la(b))}F_i(b){for(let h=0;h<this.OMe.length;++h)(0,this.OMe[h])(this,new la(b))}DRn(b){b=pf.a.create(b);if(b=this.xK(b,b,4))for(const h of b)h.Uf||this.Bxa(h,!1)}vRn(b){if(b=b.V5b())for(let t=0;t<b.count;t++){var h=this.$g.tu(b.J(0));h=this.k1.iAb(h,this.Ix,this.Nh,this.$g,this.Yq,this,this.zra,this.jea,this.Lxb);this.Bxa(h)}}pEl(b){return this.wT(b,null)}pSc(b,h,t=null){let A=!0;try{if(!b)return u.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),
!1;u.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.pga));if(!pi.a.fr&&this.BAa&&jp.a.instance.J(1)&&this.BAa.UX(this.Ix.value))return u.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.QGm(h)&&this.RGm(h)&&!this.Lzm(b))return!1;if(!t){const ua=this.T_l(b);ua&&(t=new Mb.a,t.add(ua))}var O=this.$g.Q9h(b.start.node);const aa=this.$g.Q9h(b.end.node);
if(O&&aa&&!O.equals(aa)||!O&&aa||O&&!aa)return!1;O=!0;if(t&&0<t.count){if(!t.J(0).isSupported)return!1;O=t.J(0).isEditable}switch(h){case 0:A=this.exm(b,O);break;case 1:A=(this.q_||!this.sXd(b))&&b.isSupported&&b.isEditable&&this.Vqh(b)&&this.gri(b);v.AFrameworkApplication.nD||(A=A&&!this.Eii(b.start,b.end));break;case 2:const ua=b.ILm?!0:b.isSupported;A=(this.q_||!this.sXd(b))&&ua&&b.pga&&O;u.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:A=b.isSupported&&b.pga&&O&&this.Vqh(b)&&this.gri(b)&&
!this.Eii(b.start,b.end)}}catch(aa){u.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+", Exception: "+aa),A=!1}return A}RGm(b){return!(v.AFrameworkApplication.nD&&1===b)}QGm(b){return!(this.EX&&(!b||2===b||3===b))}exm(b,h){if(pi.a.xWf)return this.fxm(b,h);let t=!0;if(!this.q_&&this.sXd(b))t=!1;else if(this.EX)this.EX?b.Uf||nf.SelectionEditor.Xu(b.start)||b.start.contextId===mc.a.endOfParagraph?b.Uf&&(b.start.contextId!==mc.a.paragraph&&b.start.contextId!==
mc.a.endOfParagraph||b.end.contextId!==mc.a.paragraph&&b.end.contextId!==mc.a.endOfParagraph)&&(t=!1):t=!1:t=h?this.uqi(b):!1;else if(!(b.Uf||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&b.start.equals(b.end)))t=!1;else if(b.Uf&&(b.start.contextId!==mc.a.paragraph||b.end.contextId!==mc.a.paragraph||b.start.equals(b.end)&&!qe.ParagraphReader.textLength(b.start.node)))t=!1;else if(b.start.contextId===mc.a.Vc||b.end.contextId===mc.a.Vc||b.start.contextId===mc.a.endOfParagraph||b.end.contextId===mc.a.endOfParagraph)t=
!1;return t}fxm(b,h){return(this.q_||!this.sXd(b))&&this.gxm(b)&&this.iDm(b)&&h&&!this.AEm(b)&&this.uqi(b)?!0:!1}iDm(b){var h;const t=b.start,A=t.contextId,O=null===(h=b.end)||void 0===h?void 0:h.contextId;return b.Uf?A!==mc.a.paragraph&&A!==mc.a.endOfParagraph||O!==mc.a.paragraph&&O!==mc.a.endOfParagraph?!1:!0:nf.SelectionEditor.Xu(t)||A===mc.a.endOfParagraph?!0:!1}M2h(b){if(!b||!b.length)return null;const h=b[0];b=b[b.length-1];this.uh&&(this.eb.im(h)&&12===h.node.type&&(h.Fb=this.uh.Nq(h.node,
!0)),this.eb.im(b)&&12===b.node.type&&(b.Sb=this.uh.Nq(b.node,!1)));return this.Bma(h,b,4)}Vqh(b){b=b.Pkf();for(const h of b)if(!h.isSupported||!h.pga)return!1;return!0}Lzm(b){if(this.Dvj(b.start,b.end).returnValue)return!1;const h=this.xK(b.start,b.end,2);if(!h)return!0;for(const t of h)if(!t.objectId.equals(b.objectId)&&(t.Uf&&(t.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||t.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===qe.ParagraphReader.textLength(t.end.node)))||
!t.Uf&&(b.start.node.id.equals(t.start.node.id)&&(-1!==b.start.cpBegin?t.start.cpBegin===b.start.cpBegin:!t.start.cpBegin)||b.end.node.id.equals(t.end.node.id)&&(-1!==b.end.cpEnd?t.end.cpEnd===b.end.cpEnd:t.end.cpEnd===qe.ParagraphReader.textLength(b.end.node)))))return!1;return!0}gri(b){if(b.Uf){var h=this.$g.tu(b.Zt),t=this.$g.tu(b.Vy);let A=null;if(12===h.type&&12===t.type){h=this.$g.N7b(h);h=this.$g.tu(h);t=this.$g.N7b(t);t=this.$g.tu(t);if(!h||!t)return!1;16===h.type&&16===t.type&&h.id.equals(t.id)&&
(A=h)}b=this.wT(b.start,b.end);if(!b.count)return!1;for(const O of b)if(b=this.$g.N7b(O),b=this.$g.tu(b),!b||!(16!==b.type||A&&b.id.equals(A.id)))return!1}return!0}sXd(b){return b.Uf?!1:(b=b.start.node)?!b.ia(Lc.a.Jib,!0):!0}gxm(b){return 1!==b.type?!0:b.Zt.equals(b.Vy)&&qe.ParagraphReader.Yb(b.start.node)&&!this.Qim(b)?!0:!1}Qim(b){const h=b.start;var t=h.node;const A=t.qa;if(b.Uf){if(t.Js||t.fEa||t.hasBookmark)return!0;for(var O of A)if(this.Jii(O))return!0;return!1}b=h.zj;t=h.Ep;let aa=O=null;
for(const ua of A.DNm(b,t))if(!(ua.cp<b))if(ua.cp===b)O=ua;else if(ua.cp===t)aa=ua;else if(this.Jii(ua))return!0;return this.Rim(h,O,aa)?!0:!1}Jii(b){return fb(b.Jb)&&fb(b.uf)&&fb(b.Ah)&&fb(b.pe)&&null==b.hyperlink&&!b.Km&&null==b.blob?!1:!0}Rim(b,h,t){if(null==h&&null==t)return!1;const A=b.Fb;b=b.Sb;return null!=h&&(h.Jb&&A<h.Jb.length||null!=h.blob)||null!=t&&t.Jb&&0<b||null!=h&&null!=t&&(tb(h.uf)&&Ob(t.uf)||tb(h.Ah)&&Ob(t.Ah)||!fb(h.pe)&&!fb(t.pe)&&[...h.pe].some(O=>0===O.uj)&&[...t.pe].some(O=>
3===O.uj)||null!=h.hyperlink&&t.Km)?!0:!1}AEm(b){var h,t;return(null!==(t=null===(h=this.xK(b.start,b.end,3))||void 0===h?void 0:h.toArray())&&void 0!==t?t:[]).some(A=>1===A.type)?!0:!1}uqi(b){if(!b.Uf)return!0;var h=this.$g.tu(b.Zt);b=this.$g.tu(b.Vy);if(Gh.TableCellReader.nwa(h)||Gh.TableCellReader.nwa(b)||vp.a.Zna(h)||vp.a.Zna(b))return!1;h=this.$g.N7b(h);h=this.$g.tu(h);b=this.$g.N7b(b);b=this.$g.tu(b);return h&&b&&(16!==h.type&&16!==b.type||h.id.equals(b.id))?!0:!1}T_l(b){if(!b)return null;b=
this.$g.tu(b.objectId);if(!b)return null;b=b.ia(Lc.a.c7,W.a.nil);return b.equals(W.a.nil)?null:(b=this.$g.tu(b))?this.nQ(b):null}M_h(b){return this.wT(null,b)}Ito(b){return(b||"").split(RegExp("\r\n|\r|\n"))}yKm(b){return b&&""!==b?!1:!0}R6h(b,h,t){h=h.qa.ei(t?0:h.characterData.length);if(!h)return u.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Jb||!h.Jb.length)return 0;if(!b)return t?0:h.Jb.length;for(let A=0;A<h.Jb.length;A++){const O=h.Jb.J(A);
if(W.a.Sp(O.le,b)&&O.Oc===t)return t?A+1:A}return t?0:h.Jb.length}DLk(b,h){var t=b.node,A=h.node,O=b.contextId===mc.a.paragraph?0:b.cpBegin,aa=h.contextId===mc.a.paragraph?qe.ParagraphReader.textLength(A):h.cpEnd;t=this.Ao.I7(t,O,b.Fb);A=this.Ao.I7(A,aa,h.Sb);aa=!t||!t.count;O=!A||!A.count;if(aa&&O)return{returnValue:!0,start:b,end:h};if(aa)return{returnValue:this.ale(b,A.J(A.count-1).le,!0),start:b,end:h};if(O)return{returnValue:this.ale(h,t.J(t.count-1).le,!1),start:b,end:h};if(t.count===A.count)return t=
t.J(t.count-1),A=A.J(A.count-1),{returnValue:t.le.equals(A.le),start:b,end:h};t=(aa=t.count<A.count)?A.J(A.count-1):t.J(t.count-1);return{returnValue:aa?this.ale(b,t.le,!0):this.ale(h,t.le,!1),start:b,end:h}}ale(b,h,t){var A=b.node;let O;if(t){O=b.contextId===mc.a.paragraph?0:b.cpBegin;var aa=b.Fb}else O=b.contextId===mc.a.paragraph?qe.ParagraphReader.textLength(A):b.cpEnd,aa=b.Sb;A=A.qa.ei(O);if(-1===aa||!A||!A.Jb||!A.Jb.length)return!1;A=A.Jb;if(t)for(t=aa;t<A.length;t++){aa=A.J(t);if(!aa.Oc)break;
if(aa.le.equals(h))return b.Fb=t+1,!0}else for(t=aa-1;0<=t;t--){aa=A.J(t);if(aa.Oc)break;if(aa.le.equals(h))return b.Sb=t,!0}return!1}FBm(b,h){return this.Dzk(b,h)&&b.Fb===b.Sb&&(b.contextId===mc.a.Vc||b.contextId===mc.a.paragraph&&!b.node.characterData.length)}Dzk(b,h){return b.equals(h)&&b.Fb===h.Fb&&b.Sb===h.Sb}sAj(b,h){var t,A,O,aa,ua,Ra;if(b&&h.Uf){var ub=pi.a.Hj?this.Cd.Mq(b.id,!0):null!==(A=this.Cd.Es.get(null===(t=b.id)||void 0===t?void 0:t.toString()))&&void 0!==A?A:W.a.nil;t=this.$g.zma(h.Zt,
!0);ub.equals(t?t.id:null)&&(pi.a.Hj?this.Cd.PD(b.id,h.objectId,!0):this.Cd.Es.set(null===(O=b.id)||void 0===O?void 0:O.toString(),h.objectId));O=pi.a.Hj?this.Cd.Mq(b.id,!1):null!==(ua=this.Cd.Lt.get(null===(aa=b.id)||void 0===aa?void 0:aa.toString()))&&void 0!==ua?ua:W.a.nil;aa=this.$g.zma(h.Vy,!1);O.equals(aa?aa.id:null)&&(pi.a.Hj?this.Cd.PD(b.id,h.objectId,!1):this.Cd.Lt.set(null===(Ra=b.id)||void 0===Ra?void 0:Ra.toString(),h.objectId))}}static get Kd(){return null!=ic.VEg?ic.VEg:ic.VEg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static vDb(b){return h=>
h.type===b}static uTl(){return b=>12===b.type||15===b.type}static Evh(b,h){return b.Xe===h.HKi||b.parentNode&&h.MUi(b.parentNode)?!1:!0}}ic.vwn="Placeholder Text";ic.twn="Placeholder Text";Object(m.a)(ic,"ContentControlOperator",null,[366,9,367]);class Qc{constructor(b,h,t){this.Xc=b;this.Ix=h;this.zWb=t}nfi(b){const h=this.xTl();return h&&b&&this.rcm(h,b)?this.Kam(h):null}rcm(b,h){if(!b)return!1;do{const t=b.currentNode;if(!t)break;if(t.ia(Lc.a.ocm,null)===h)return!0}while(b.wf(29));return!1}Kam(b){var h=
b.Tb(1);b.wc();b=b.ME(1);if(!h||!b)return null;h=wf.SelectionFactory.s7k(h,b);b=nf.SelectionEditor.Bj(h,!1,!1);return wf.SelectionFactory.Vz(h,b.Rc)}xTl(){const b=this.Xc.Ck();b.set(this.Ix.value);this.zWb.TQ(b);return b.Tb(28)&&b.Tb(29)?b:null}}Object(m.a)(Qc,"GlossaryNavigator",null,[365]);class od{constructor(b,h,t,A,O,aa){this.Yq=b;this.$g=h;this.Qm=t;this.eb=A;this.nh=O;this.jea=aa}o5c(b,h,t){if(!this.jea)return 1;if(!({tableNode:O}=this.bEf(b)).returnValue||!this.nh.Rxi(O,h)||this.s3i(b,h))return 2;
var A=this.nh.N_h(h);var O=A.J(0).V5b();O&&O.count||(O=new Mb.a,O.add(b.objectId));b=this.$g.EMh(A);t=t.split("\n");h=Object(Da.a)(ue.GraphIterator,this.$g.Pof(h));h=this.$g.blh(h,b,t.length);for(b=0;b<h.count;++b){A=h.J(b);this.Yq.replaceTextRange(pf.a.createTextRange(A,0,0),t[b]);for(let aa=0;aa<O.count;++aa)this.Yq.Xsa(A,O.J(aa),0,!0,!0),this.Yq.Xsa(A,O.J(O.count-aa-1),A.characterData.length,!0,!1)}return 0}s3i(b,h){if(!this.jea)return 1;let t;if(!({tableNode:t}=this.bEf(b)).returnValue||!this.nh.Rxi(t,
h))return 2;h=this.nh.N_h(h);if(0<h.count&&(h=this.Qm.xK(pf.a.create(h.J(0)),pf.a.create(h.J(h.count-1)),2)))for(const A of h)if(A.id!==b.id&&!this.Qm.Bxa(A,!0))return 2;return 0}Bac(b){if(!this.jea||!({tableNode:t}=this.bEf(b)).returnValue)return!1;b=b.Pkf();for(var h of b)if(!h.pga||!h.isSupported)return!1;if(this.nh.Azm(t))return!1;var t=Object(Da.a)(ue.GraphIterator,this.$g.Pof(t));h=new Mb.a;this.eb.Vgb(t,!0,!1,h);for(const A of h)if(0<A.ia(Lc.a.$Bb,0)||this.eb.C0a(A).wx)return!1;return!0}bEf(b){let h=
null;return b&&b.Zt.toString()===b.Vy.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.$g.tu(b.Zt))&&14===h.type?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:null}:{returnValue:!1,tableNode:h}}}Object(m.a)(od,"TableContentControlEditor",null,[364]);class ae{Azm(b){let h=!1;const t=new ue.GraphIterator;t.set(b);Wh.forEachCellInTable(t,A=>{if(!Gh.TableCellReader.gg(A)){let O=ip.OutlineNavigator.B8(A);for(;O;){if(mb.OutlineElementReader.IPc(A))return h=!0,!1;O=A.Ti(1)}}return!0});
return h}Rxi(b,h){const t=new ue.GraphIterator;t.set(h);return Gh.TableCellReader.nwa(h)&&t.Ab(14)&&t.fd(14).id===b.id?!0:!1}N_h(b){const h=new Mb.a,t=new ue.GraphIterator;t.set(b);b=new Mb.a;qe.ParagraphReader.Vgb(t,!0,!1,b);for(const A of b)h.add(A);return h}}Object(m.a)(ae,"TableReader",null,[137]);class Me{constructor(){this.Qm=null}get name(){return"WordEditor.ContentControl"}init(){v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&(C.a.JRa(Object(z.a)(Sa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),
Sa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").ign,"onContentControlRangeChanged")),this.Qm=Sa.a.instance.Ma("WordEditor.ContentControl.IContentControlOperator"),Sa.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init())}dispose(){this.Qm&&(this.Qm.dispose(),this.Qm=null)}yc(b){b.ha("WordEditor.ContentControl.Perf.IPerfLogger",()=>new Ia.a(ff.a.Ue)).singleInstance();b.ha("WordEditor.ContentControl.ContentControlFactory",()=>new hh(Sa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").singleInstance();
b.ha("WordEditor.ContentControlNodeFactory",()=>new ha(Sa.a.instance.Sa("Box4.ContentControlConfigSettings"),Sa.a.instance.Sa("Box4.ContentControl.IContentControlOperator"))).singleInstance();b.ha("WordEditor.ContentControl.ContentControlGraphManager",()=>new pl(new Pg.a(()=>Jb.App.ya.jb.Wc),new Pg.a(()=>Jb.App.ya.jb.Wc.ud),new ok.a,fm.PageNavigator.instance,Sa.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Sa.a.instance.resolve("Box4.IOutlineEditor"),Sa.a.instance.resolve("Box4.IOutlineElementEditor"),
Sa.a.instance.resolve("Box4.IParagraphReader"),Sa.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Sa.a.instance.Sa("Box4.ContentControlConfigSettings"),Sa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlGraphManager").singleInstance();b.ha("WordEditor.ContentControl.GlossaryNavigator",()=>new Qc(new ok.a,new Pg.a(()=>Jb.App.ya.jb.Wc),fm.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").singleInstance();b.ha("WordEditor.ContentControl.ContentControlOperator",
()=>new ic(new Pg.a(()=>Jb.App.ya.jb.Wc),new Pg.a(()=>Jb.App.ya.jb.Wc.ud),Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Sa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),he.a.instance,Sa.a.instance.resolve("Box4.ISelectionFactory"),Lk.PageReader.instance,Sa.a.instance.resolve("Box4.IFormattingEditor"),Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),
Sa.a.instance.Ma("Box4.IContentControlDataChangedManager"),v.AFrameworkApplication.xa,Sa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Sa.a.instance.resolve("Box4.IContentControlChpHelper"),Sa.a.instance.Sa("Box4.ContentControlConfigSettings"),Sa.a.instance.Ma("Box4.IContentControlReader"),Sa.a.instance.resolve("Box4.IParagraphReader"),Sa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),
Sa.a.instance.Sa("Box4.Actors.IVirtualSelectionMerger"),Sa.a.instance.resolve("Box4.IFeatureHelper"),Sa.a.instance.resolve("Box4.ContentControlParagraphMapping"),Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").singleInstance();b.ha("WordEditor.ContentControl.ContentControlManager",()=>new f(new Pg.a(()=>Jb.App.ya.jb.Wc),new Pg.a(()=>Jb.App.ya.jb.Wc.ud),Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Sa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),Sa.a.instance.Sa("Box4.ContentControlConfigSettings"),Sa.a.instance.resolve("Box4.IContentControlChpHelper"),Sa.a.instance.resolve("Box4.IContentControlAroundTableChecker"))).as("WordEditor.ContentControl.IContentControlManager").singleInstance();
b.ha("WordEditor.ContentControl.ContentControlChpManager",()=>new Yc(Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Sa.a.instance.Sa("Box4.ContentControlConfigSettings"),Sa.a.instance.resolve("Box4.IParagraphReader"),Sa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").singleInstance();b.ha("WordEditor.ContentControl.TableContentControlEditor",()=>new od(Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),
Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Sa.a.instance.resolve("Box4.IParagraphReader"),new ae,v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").singleInstance();v.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&b.ha("Box4.ContentControlConverter",()=>new Id(b.resolve("Box4.IParagraphReader"),
b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").singleInstance();b.ha("WordEditor.ContentControl.ContentControlCCP",()=>new oc(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),
b.resolve("Box4.TrackChange.ITrackChangeEditor"))).singleInstance();b.ha("WordEditor.ContentControl.ContentControlFormattingManager",()=>new sh(new Pg.a(()=>Jb.App.ya.jb.Wc.ud),Sa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Sa.a.instance.resolve("Box4.Actors.TextFormattingActor"),Sa.a.instance.resolve("Box4.TextFormattingHelper"),v.AFrameworkApplication.K)).as("WordEditor.ContentControl.IContentControlFormattingManager").singleInstance()}static main(){P.a.instance.Gc(new Me)}}
Object(m.a)(Me,"ContentControlPackage",null,[1,2]);var we=c(1400),Df=c(555),hg=c(1742),ih=c(787);class zd{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(m.a)(zd,"UxManagerMenuActionTelemetryData",null,[]);class ve extends Sys.EventArgs{constructor(b,h,t){super();this.definition=b;this.source=h;this.hWk=t}}Object(m.a)(ve,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class si extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=
h}}Object(m.a)(si,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class Xi{constructor(b,h,t,A,O,aa,ua=!1,Ra=null,ub=null,Nb=null,Yb=!1,bc=null,Dc=!1,Pc=!0,jd=null,Cd=!1,ee=10){this.target=this.container=this.menu=null;this.isDismissed=!1;this.cZc=this.KYc=this.mUh=this.onScroll=this.onResize=this.Q_=this.Pwa=this.bGa=this.documentElement=this.kR=this.editingElement=null;this.isFocused=!1;this.xHd=null;this.QVf=this.CAf=!1;this.kme=null;this.$8d=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=t;this.definition=
A;this.cjk=O;this.XPa=aa;this.wNa=ua;this.alj=Ra;this.Xla=ub;this.hostServices=Nb;this.soo=Yb;this.qTi=bc;this.mlj=Dc;this.Pgl=Pc;this.mUh=jd;this.showDictationCommandUx=Cd;this.source=ee}}Object(m.a)(Xi,"UxManagerState",null,[]);var lh=c(1604);class Qg{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb){this.Vb=b;this.ib=h;this.uz=t;this.ed=A;this.$d=O;this.Gb=aa;this.Ri=ua;this.nk=Ra;this.mI=ub;this.KRb=Nb;this.kQe=!1;this._state=this.QYg=null;this.shouldIgnoreFocusEvent=Yb=>{var bc;return this.ed.vd.$y&&!this.ed.vd.bU&&
Yb===(null===(bc=this.ed.editingView)||void 0===bc?void 0:bc.editingElement)};this.ra=new If.a;this.rtd=new xb.a;this.qyd((Yb,bc)=>{Qg.fZm(t,bc.definition,bc.source)});this.mmh((Yb,bc)=>{Qg.eZm(t,bc.definition,bc.source,bc.hWk)});this.Vb.fe(Qg.qLd).zH=!0;v.AFrameworkApplication.xa.pa(Vc.a.zIc,mc.a.view,this.zIc.bind(this))}qyd(b){this.ra.addHandler(Qg.fKf,b)}K2f(b){this.ra.removeHandler(Qg.fKf,b)}aHn(b,h){this.ra.raiseEvent(Qg.fKf,new si(b,h))}mmh(b){this.ra.addHandler(Qg.eKf,b)}RUn(b){this.ra.removeHandler(Qg.eKf,
b)}$Gn(b,h,t){this.ra.raiseEvent(Qg.eKf,new ve(b,h,t))}GRo(b){var h;if(!b.isDismissed&&b.kR){var t=lh.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(t&&t.length){t=lh.b(t);var A=ff.a.getElementBounds(b.kR);t.width||t.height?t.x+t.width<A.x||t.x>A.x+A.width||t.y+t.height<A.y||t.y>A.y+A.height?this.dismiss():(A=b.target,A.style.left=t.x+"px",A.style.top=t.y+"px",A.style.width=t.width+"px",A.style.height=t.height+"px",null===(h=b.menu)||void 0===h?void 0:h.updatePosition(),b.menu||u.ULS.sendTraceTag(512255777,
341,50,"Menu is null so can't update position")):(u.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else u.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}y_i(b){b.isDismissed||b.kme||(b.kme=new Vb.a(2,1,1,()=>{b.kme=null;this.GRo(b)},147),this.Gb.Wb(b.kme))}bGa(b,h){!b.isDismissed&&b.Pgl&&0<h.qJ.length&&(this.dismiss(),u.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}Cuk(b){return!!b&&
b.id===Qg.fjk}Pwa(b,h){if(b.isDismissed||!h||!h.Ib)return!1;h=h.Ib;const t=h.keyCode,A=!b.isFocused&&!!b.menu,O=h.altKey||h.ctrlKey||h.shiftKey;let aa=!1;t===rc.a.Q0?(this.dismiss(),u.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),aa=!0):t!==rc.a.ks&&t!==rc.a.iw||!A||O||!this.Cuk(b.definition)?t!==rc.a.tpb&&t!==rc.a.Mlc||!A||O||(this.iZf(b),b.menu?(b.menu.focus(),aa=!0,u.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):u.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.menu.executeDefaultAction(),u.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),aa=!0);aa&&(h.preventDefault(),h.stopPropagation());return aa}KYc(b,h){if(b.isDismissed||!b.menu)return u.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.invokeBadgeId(h);u.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}cZc(b,h){if(b.isDismissed||!b.menu)return u.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.executeActionFromString(h);u.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}Q_(b,h){if(b.isDismissed||!h||!h.Ib||!b.menu)return u.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===
h?0:h.Ib),!b.menu),!1;const t=b.target;b=b.menu.getElementBounds();var A=h.Ib;h=A.clientX;A=A.clientY;t&&Qg.pWi(h,A,ff.a.getElementBounds(t),16)||b&&Qg.pWi(h,A,Qg.SEk(b),4)||this.dismiss();return!1}sio(b){var h=lh.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=lh.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=Qg.SGc();b.target=h;b.editingElement=this.ed.editingView.editingElement;b.kR=this.ed.vd.container;b.documentElement=document.documentElement;b.bGa=(t,A)=>{this.bGa(b,
A)};b.Pwa=t=>this.Pwa(b,t);b.Q_=t=>this.Q_(b,t);b.onScroll=()=>{this.y_i(b)};b.onResize=()=>{this.y_i(b)};b.showDictationCommandUx&&(b.KYc=t=>this.KYc(b,t),b.cZc=t=>this.cZc(b,t),this.KRb&&this.KRb.execute(t=>{t.Tdo(b.KYc);t.Vdo(b.cZc)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.ib.gx(b.bGa);this.Ri.uZ(b.onResize);this.$d.mb(db.a.CF,b.editingElement,b.Pwa);b.wNa&&this.nk.mb(db.a.Dba,b.documentElement,b.Q_);Hf.a.addHandler(b.kR,"scroll",b.onScroll);b.XPa||this.iZf(b);
return!0}tEb(b,h){const t=!!b.menu;this.$Gn(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Vb.currentScope.name===Qg.qLd&&this.Vb.cR(Qg.qLd);b.bGa&&this.ib.lY(b.bGa);b.Pwa&&b.editingElement&&this.$d.sc(db.a.CF,b.editingElement,b.Pwa);this.KRb&&this.KRb.execute(A=>{b.showDictationCommandUx&&(A.XZn(),A.YZn());A.xfj(!1,b.showDictationCommandUx)});b.Q_&&b.documentElement&&b.wNa&&this.nk.sc(db.a.Dba,b.documentElement,
b.Q_);b.onScroll&&b.kR&&Hf.a.removeHandler(b.kR,"scroll",b.onScroll);b.onResize&&this.Ri.jca(b.onResize);b.menu=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.kR=null;b.bGa=null;b.Pwa=null;b.Q_=null;b.onScroll=null;b.onResize=null;b.KYc=null;b.cZc=null;t&&b.Xla&&(b.CAf?b.QVf=!0:b.Xla(b.xHd))}X0a(b,h){var t;if(!h)return!1;switch(h.actionType){case Uo.b.Toggle:if(h.objectFulfillment===Qg.jDo)return this.kQe=!this.kQe,this.ljg(),this.vIc(b),!0;if(h.objectFulfillment===
Qg.nDo)return{value:t}=this.rtd.Ec(h.suggestionGroup.type,!1),this.rtd.Z(h.suggestionGroup.type,!t),this.vIc(b),!0;break;case Uo.b.GiveFeedback:if(hg.a.QAm(null===(t=h.suggestionGroup)||void 0===t?void 0:t.type)||ih.a.FKm(h.objectName))break;this.focus();this.ljg();this.vIc(b);return!0;case Uo.b.RevealSuggestions:this.vIc(b)}b.CAf=!0;h=b.cjk.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.CAf=!1;h&&this.vIc(b);b.QVf&&(b.QVf=!1,b.Xla(b.xHd),b.xHd=null);return h}vIc(b){b.Q_&&b.documentElement&&
b.wNa&&(this.nk.sc(db.a.Dba,b.documentElement,b.Q_),b.wNa=!1)}jmo(b,h){return b.id===Df.a.PVe?!1:!(0<=b.positionInSet&&0<b.setSize)&&!h}xwj(b){var h;if(this.sio(b)){var t=1;v.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(t=3);var A=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(A=b.definition.suggestionGroups[0].type,A=this.rtd.ob(A)?this.rtd.J(A):b.soo);h=!1;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",
!1)&&(h=!0);t={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:O=>this.X0a(b,O),onDismiss:O=>{this.tEb(b,O)},keepCurrentFocus:b.XPa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.kQe,showDescription:A,showEditorButton:b.mlj,showEditorBranding:this.jmo(b.definition,b.mlj),hostServices:b.hostServices,maxSuggestionGroupNumber:t,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.mUh,showDictationCommandUx:b.showDictationCommandUx,
editingElement:b.editingElement};b.qTi&&b.qTi(t);this.uz.createContextualUi(t).then(O=>{this.aHn(b.definition,b.source);b.menu=O;u.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.alj&&b.alj();this.KRb&&9!==b.source&&this.KRb.execute(aa=>aa.xfj(!0,b.showDictationCommandUx))}).catch(O=>{this.tEb(b,{F5o:we.a.Unknown});u.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",O)});0<b.$8d&&u.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.$8d)}else 5<
++b.$8d?(u.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Gb.Wb(new Vb.a(2,1,Math.pow(3,b.$8d),()=>{b.isDismissed||this.xwj(b)},146))}get UE(){return!!this._state&&!this._state.isDismissed}set Oee(b){this.QYg=b}get HFm(){return this.QYg}Hig(b,h){this.UE&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.UE?this._state.definition:null}set definition(b){this.UE&&(this._state.definition=b,this._state.menu&&
this._state.menu.setDefinition(b))}focus(){this.UE&&this._state.menu&&(this._state.isFocused||this.iZf(this._state),this._state.menu.focus())}ljg(){this.UE&&this._state.menu&&this._state.menu.updatePosition()}iZf(b){this.Vb.TK(Qg.qLd,!1);b.isFocused=!0}Ppa(b,h,t,A,O,aa=null,ua=null,Ra=null,ub=!1,Nb=null,Yb=!1,bc=!0,Dc=null,Pc=!1,jd=10){if(!h||this._state&&!this._state.isDismissed)return!1;let Cd,ee;if(!({paragraphNode:ee,start:b,end:Cd}=Qg.AGo(b)).returnValue)return!1;this._state=new Xi(ee,b,Cd,h,
t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd);this.xwj(this._state);return!0}see(){this._state&&(this._state.xHd=!0)}zIc(b,h,t){if(1===t)return this.UE?32:0;this.UE&&this.dismiss();return 32}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.menu)||void 0===b?void 0:b.dismiss())}static fZm(b,h,t){t=new zd(t);b.logAction({actionType:Uo.b.SessionStart,engagement:Uo.a.Try,objectName:Qg.Prj,objectId:h.id,data:t});if(h.suggestionGroups)for(const A of h.suggestionGroups)b.logAction({actionType:Uo.b.Presented,
engagement:Uo.a.See,objectName:A.type,objectId:A.id,data:t})}static eZm(b,h,t,A){t=new zd(t);b.logAction({actionType:Uo.b.SessionEnd,engagement:Uo.a.None,objectName:Qg.Prj,objectId:h.id,data:t},A)}static SGc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static SEk(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static pWi(b,h,t,A){const O=t.y-A,aa=t.x+t.width+A,ua=t.y+t.height+A;return t.x-A<=b&&b<=aa&&O<=h&&h<=ua}static AGo(b){let h,t;if(!b||!qe.ParagraphReader.Yb(b.node)||
b.contextId!==mc.a.Vc&&b.contextId!==mc.a.Fd&&b.contextId!==mc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};t=b.node;b.contextId!==mc.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=t.characterData.length);return{returnValue:!0,paragraphNode:t,start:h,end:b}}Obc(){this.mI&&this.mI.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}Qg.fjk="ActionSet";Qg.Prj="IntentGroup";Qg.qLd="CanvasContextualUxReact";Qg.jDo="Context";Qg.nDo="Description";Qg.fKf="MenuDidOpen";Qg.eKf="MenuDidClose";
Object(m.a)(Qg,"UxManager",null,[]);class Pk{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}yc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>{this.$m()})}$m(){v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const b=v.AFrameworkApplication.K.$("EditorGoalsEnabled"),h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",
!1);(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(61)||v.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")||v.AFrameworkApplication.K.$("RewriteIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").HA.loadScript("canvasContextual")).then(()=>{this.W.ha("CanvasContextual.ICanvasContextualController",
()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:v.AFrameworkApplication.uiCulture,dataCulture:v.AFrameworkApplication.dataCulture,isRightToLeft:v.AFrameworkApplication.isRtl,ulsLogger:new Am.a,dimeCallback:()=>Object(Rl.__awaiter)(this,void 0,void 0,function*(){this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")}),loadUpsellDependencies:()=>Object(Rl.__awaiter)(this,void 0,void 0,function*(){this.W.Sa("Common.IInProductMessagingUIManager").execute(t=>
{t.hCi()})}),getSoftPaywallData:()=>this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),getPremiumPreviewCritiquesList:()=>this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),logSystemInitiatedFeedback:t=>Object(Rl.__awaiter)(this,void 0,void 0,function*(){this.W.Sa("Common.ISystemInitiatedFeedback").execute(A=>A.logActivity(t,null))})})).singleInstance();this.W.ha("WordEditor.CanvasContextualProvider.UxManager",()=>new Qg(yd.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),
this.W.resolve("CanvasContextual.ICanvasContextualController"),pc.InteractiveViewManager.instance,sb.KeyInputManager.instance,v.AFrameworkApplication.oc,v.AFrameworkApplication.ta,v.AFrameworkApplication.ta.B0,this.W.Sa("Common.ISystemInitiatedFeedback"),this.W.Sa("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).singleInstance();this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ha("CanvasContextual.IEditorInitializer",
()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:v.AFrameworkApplication.uiCulture,ulsLogger:new Am.a})).singleInstance(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),this.W.ha("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new Am.a})).singleInstance(),this.W.resolve("CanvasContextual.ISkittleControllerV2"),h&&(this.W.ha("CanvasContextual.IAIFeedbackSkittleController",()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new Am.a})).singleInstance(),
this.W.resolve("CanvasContextual.IAIFeedbackSkittleController")))}).catch(t=>{u.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",t)})}dispose(){}static main(){P.a.instance.Gc(new Pk)}}Object(m.a)(Pk,"PackageManager",null,[1,2]);class Bl{constructor(b,h,t,A){this.Etm=(O,aa,ua)=>{O=null;aa.view.re&&(O=aa.view);if(!O||!O.nb)return 8;if(!this.dI.vBf())return 2;if(1===ua)return 32;this.f9j.O2k();return 32};this.pGi=(O,aa,ua)=>{let Ra=null;
aa.view.re&&(Ra=aa.view);if(!Ra||!Ra.nb)return 8;if(!this.dI.vBf())return 2;if(1===ua)return 32;if(1!==this.dI.u7b(this.ib.hb,!0).count)return 2;aa=new Te.GraphTransaction(15);try{if(aa.Eb(Ra.Zc),!this.dI.CHo(O===Vc.a.GJf))return 8}finally{aa&&aa.dispose()}return 32};this.ga=b;this.ib=h;this.dI=t;this.f9j=A}Ub(){this.ga.pa(Vc.a.SUd,mc.a.view,this.Etm);this.ga.pa(Vc.a.GJf,mc.a.view,this.pGi);this.ga.pa(Vc.a.qGi,mc.a.view,this.pGi)}}Object(m.a)(Bl,"IntelligentPlaceholderActor",null,[]);class gk{constructor(){this.Ync=
new xb.a;this.med=new xb.a}Wjk(b,h){let t;({value:t}=this.Ync.Ec(b,t)).returnValue||this.Ync.Z(b,t=new Ca.a);t.add(h)}Bkk(b,h){this.med.ob(b)&&u.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.med.Z(b,h)}Ujk(b,h,t){this.Wjk(b,h);this.Bkk(h,t)}mGl(b){let h;return({value:h}=this.Ync.Ec(b,h)).returnValue?h:null}dJl(b){let h;return({value:h}=this.med.Ec(b,h)).returnValue?h:null}BUn(b){let h;if(({value:h}=this.Ync.Ec(b,h)).returnValue){for(const t of h)this.med.remove(t);
this.Ync.remove(b)}else u.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(m.a)(gk,"IntelligentPlaceholderAtMentionManager",null,[384]);var yi=c(1658);class bk extends yi.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get zw(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}Dkj(b){return!b.ia(Lc.a.jG,!1)}zgb(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(m.a)(bk,"IntelligentPlaceholderDetailsProvider",yi.a,[]);
var kj=c(1798),wj=c(1995),lk=c(1802);class wh{constructor(){this.tza=""}lga(b){this.tza+=b}Rni(b){this.tza+=b}Qxf(b){this.tza+=b}insertImage(b){this.tza+=b}Ani(b){this.tza+=b}}Object(m.a)(wh,"PlainTextFormatCreator",null,[891]);var ep=c(1595),Td=c(1994);c(390);var le=c(1657),hj=c(1497);class um{constructor(){this.xqc=new xb.a}contains(b){return this.xqc.ob(um.lFf(b))}add(b){this.xqc.Z(um.lFf(b),b)}remove(b){this.xqc.remove(um.lFf(b))}AJo(b){for(const h of b.xqc)this.add(h.value)}hUh(){const b=new Mb.a;
for(const h of this.xqc)b.add(h.value.Tj);return b}static lFf(b){return b.Tj.toString()}}Object(m.a)(um,"CommentRangeSet",null,[]);class dq extends Sys.EventArgs{constructor(b){super();this.commentNode=b}}Object(m.a)(dq,"OnFollowUpEventArgs",Sys.EventArgs,[]);class vs extends dq{constructor(b,h){super(b);this.swn=h}}Object(m.a)(vs,"OnCreateEventArgs",dq,[]);class d extends dq{constructor(b,h){super(b);this.FIm=h}}Object(m.a)(d,"OnResolveEventArgs",dq,[]);var r=c(228);class B{}B.Aoe="MentionExperienceDegraded";
Object(m.a)(B,"AtMentionsConstants",null,[]);class S{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb){this.rXc=b;this.HAk=h;this.D8c=t;this.ABd=A;this.nb=O;this.vo=aa;this.jVd=ua;this.zoi=Ra;this.lu=ub;this.f0b=Nb;this.mRa=null;this.gmn=(Yb,bc,Dc)=>{u.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");Yb=this.jVd.G1a(Yb,Dc.displayName,Dc.email,Dc.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,bc),!0);Yb?u.ULS.sendTraceTag(558113739,
323,50,"Successfully inserted at mentions"):this.f0b.logKpiFailure("LPPWordEditorKPI","FailedToInsertAtMention",{isInternal:!0},{name:B.Aoe,isInternal:!0})};this.Xkn=(Yb,bc)=>{u.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");bc&&this.f0b.hy(Vc.a.AMk);this.jVd.Sfm(Yb.id,bc)};this.Xgn=()=>{this.vo.vd.$y&&!this.vo.vd.bU&&this.vo.editingView.fef?this.Oxh=!0:(this.rXc.reset(),u.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};this.snn=()=>{u.ULS.sendTraceTag(41178055,
323,50,"People picker shown on canvas");this.Zmk()};this.Wkn=(Yb,bc,Dc,Pc=new Map)=>{Pc=Object.assign(new Hb.a,{extendedProperties:Pc});this.f0b.logKpiFailure("LPPWordEditorKPI",Yb,{isIntentional:bc,isInternal:Dc,additionalValues:Pc},{name:B.Aoe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:bc,isInternal:Dc,additionalValues:Pc})};(b=Sa.a.instance.Ma("Box4.IEditStateEventManager"))&&b.addHandler(r.a.DBa,this.t0n.bind(this))}JCf(){return!!this.mRa}t0n(){this.JCf()&&this.Oxh&&(this.mRa.updateInputText(this.rVc,
!1),this.Oxh=!1)}ariaNotify(b,h){this.lu.sendNotification(b,h)}Zmk(){const b=this.vo.editingView.editingElement;if(b){var h=b.getAttribute(Mf.a.wDc);b.setAttribute(Mf.a.wDc,h?h.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else u.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}UTn(){const b=this.vo.editingView.editingElement;if(b){var h=b.getAttribute(Mf.a.wDc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?b.setAttribute(Mf.a.wDc,
h.join(" ")):b.removeAttribute(Mf.a.wDc)):u.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else u.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}jQk(){this.UTn();this.mRa&&this.mRa.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.mRa=null;this.zoi.Hej(!0)}V2i(){this.rXc.d3i(()=>{this.jQk()});this.rXc.Q2i((b,h)=>{this.rVc=b;if(this.mRa)1<this.rVc.length&&"@"===this.rVc.trimEnd()?(this.f0b.hy(Vc.a.zMk),
this.rXc.reset()):this.mRa.updateInputText(this.rVc,!1);else if(this.f0b.logKpiUsage("LPPWordEditorKPI",0),this.f0b.hy(Vc.a.Epn),(b=this.TRl(h))&&b.height){h=b.y;const t=b.height,A=document.createElement("div");A.id="PeoplePicker";A.style.position="absolute";A.style.top=h-5+"px";A.style.left=b.x+"px";A.style.height=t+10+"px";document.body.appendChild(A);this.HAk.createPeoplePicker({editingElementId:this.vo.editingView.editingElement.id,containerElement:A,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:this.gmn,
onPermissionsReceivedCallback:this.Xkn,onDismiss:this.Xgn,onShow:this.snn,onFailure:this.Wkn}).then(O=>{O.updateInputText(this.rVc,!1);this.mRa=O;this.zoi.Hej(!1)})}});this.rXc.R2i(b=>{if(this.mRa)this.mRa.onKeyDown(b.Ib.rawEvent)})}TRl(b){var h=this.nb.hb;if(!h)return null;h=h.lb;if(!h)return null;h=h.Qa;if(!h)return null;h=h.node;if(!h)return null;h=Object(Da.a)(222,h);if(!h)return null;h=Object(Da.a)(249,h.Ej(this.vo.vd.jc));if(!h)return null;h=Object(Da.a)(210,h);if(!h)return null;let t=null;
try{t=this.D8c.AZ(this.ABd.X5b(2,b),h,!1,!1,!1,!1)}catch(A){u.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",A)}return t}}Object(m.a)(S,"WordEditorAtMentionsHandler",null,[331]);var ea=c(1488);class Fa{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd){this.ga=b;this.Xc=h;this.kLa=t;this.ib=A;this.Rp=O;this.Jd=aa;this.qF=ua;this.Yjd=Ra;this.Wd=ub;this.iq=Nb;this.PPj=bc;this.Nh=Dc;this.Ic=Yb;this.ra=new If.a;this.ih=Pc;this.AIg=jd;hj.a.fYe((Cd,
ee)=>{this.jG(ee.commentNode,!0)&&this.ra.raiseEvent(Fa.UYc)})}Cmh(b){this.ra.addHandler(Fa.kNi,b)}ork(b){this.ra.addHandler(Fa.vQi,b)}Wqk(b){this.ra.addHandler(Fa.Ojn,b)}fYe(b){this.ra.addHandler(Fa.UYc,b)}jG(b,h){let t=b.ia(Lc.a.jG,!1);h&&(t=t&&!b.ia(Lc.a.jaa,!1));return t}L$b(b){return this.Rp.L$b(b)}xYl(b){for(const h of b)for(const t of h)if(Fa.CEf(t.contextId))return t.node.Mc;return null}D4l(b,h,t){const A=new um,O=b.Mc;for(let aa=0;aa<b.qa.length;aa++){const ua=b.qa.J(aa);if(ua.cp>=h)break;
if(ua.uf&&ua.uf.length)for(let Ra=0;Ra<ua.uf.length;Ra++){const ub=ua.uf.J(Ra);this.jG(O.Db(ub.Tj),t)&&(ub.Oc?A.add(ub):A.remove(ub))}}return A}E4l(b,h,t,A){const O=new um,aa=b.Mc;for(let ua=0;ua<b.qa.length;ua++){const Ra=b.qa.J(ua);if(Ra.cp>t)break;if(Ra.uf&&Ra.uf.length)for(let ub=0;ub<Ra.uf.length;ub++){const Nb=Ra.uf.J(ub);this.jG(aa.Db(Nb.Tj),A)&&(Nb.Oc?Ra.cp<t&&O.add(Nb):Ra.cp<=h&&O.remove(Nb))}}return O}Tbi(b,h){let t;const A=b.node;b.contextId!==mc.a.paragraph?(t=b.cpBegin,b=b.cpEnd):(t=
0,b=A.characterData.length);return t===b?this.D4l(A,t,h):this.E4l(A,t,b,h)}oOc(b,h){return Fa.CEf(b.contextId)?this.Tbi(b,h).hUh():new Mb.a}u7b(b,h){const t=new um;for(const A of b)for(const O of A)Fa.CEf(O.contextId)&&t.AJo(this.Tbi(O,h));return t.hUh()}vBf(){var b=this.ib.hb;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Qa.node;return qe.ParagraphReader.Yb(b)&&!qe.ParagraphReader.Kta(b)&&this.Rp.zib(this.ga,!0)?!0:!1}Cni(b,h){if(!this.vBf())return null;if(this.Rp.Shm())return u.ULS.sendTraceTag(592761861,
323,15,"Placeholder insertion failed because of draft comment"),null;let t=!1;var A=this.ib.hb.J(0).Qa;A.contextId===mc.a.Vc?(b=b?nf.SelectionEditor.b3(A,!1):null)&&b.Sx&&b.Qa.contextId===mc.a.Fd?this.ib.setSelection(b):(this.Jd.replaceTextRange(A,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.ib.setSelection(wf.SelectionFactory.nK(A.node,A.cpBegin,A.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):t=!0;this.ih.WAb||
kj.a.instance.eRc();b=this.Rp.nAb(this.ib.hb.lb);if(!b)return null;this.L$b(b)&&this.AIg.hy(ab.a.newComment,{succeeded:!0,U6a:29});var O=this.Xc.Wf(b);const aa=O.Tb(1);if(!aa||393229!==aa.Nc)return null;O=O.Tb(2);if(!O||393230!==O.Nc)return null;this.Dig(b.Mc,b.id);this.ra.raiseEvent(Fa.kNi,new vs(b,h));t&&(h=A.node,A=A.contextId!==mc.a.paragraph?A.cpEnd:h.characterData.length,this.ib.setSelection(wf.SelectionFactory.nK(h,A,A)));return b}SUd(b){return!!this.Cni(!0,b)}rRc(b,h,t,A,O,aa){if(0>h)return!1;
A="@"+A;const ua=A+" ",Ra=new Te.GraphTransaction(15);try{Ra.Eb(b);this.Jd.replaceTextRange(pf.a.createTextRange(b,h,t),ua);this.Wd.Cg&&(this.iq.t5e(b,h,h+A.length),this.iq.Lpa(b,h+A.length,h+ua.length,1));const ub=this.qF.jH(pf.a.createTextRange(b,h,h+A.length),"mailto:"+O,!1,!0,!1);if(!ub)return!1;const Nb=ub.hx;if(!Nb)return u.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.ib.setSelection(wf.SelectionFactory.nK(b,h,h+A.length));const Yb=this.Cni(!1,
2);if(!Yb)return!1;aa&&this.Yjd.Ujk(aa,Nb,Yb.id);this.ib.setSelection(wf.SelectionFactory.te(b,h+ua.length))}finally{Ra&&Ra.dispose()}return!0}G1a(b,h,t,A){const O=this.ib.pg;return nf.SelectionEditor.jf(O)?this.rRc(O.node,O.cpBegin-b,O.cpBegin,h,t,A):!1}J0l(b){if(1===b.length&&b.J(0).Sx&&(b=b.J(0).Qa,b.contextId===mc.a.Vc&&qe.ParagraphReader.Yb(b.node))){const h=b.node;for(let t=0;t<h.qa.length;t++){const A=h.qa.J(t);if(A.cp===b.cpBegin){b=A.QPd(!0,!0);if(0<b.length)return b[0].Tj;break}}}return null}eAb(b,
h,t){return this.Rp.LGc(b,h,t).returnValue}mMd(b,h,t,A,O){let aa=!1;const ua=b.characterData;if(h>=ua.length||t>ua.length||t<h)return{returnValue:!1,aOa:aa};let Ra=h,ub=null;for(let Yb=0;Yb<b.qa.length;Yb++){const bc=b.qa.J(Yb),Dc=bc.cp;if(!(Dc<h)){if(bc.Km&&ub)try{const Pc=ua.substring(Ra,Dc),jd=new wj.a;jd.fullName=Pc.startsWith("@")?Pc.substr(1):Pc;le.a(ub,jd);const Cd=new lk.a;le.b(ub,Cd);O&&(Cd.contentId=this.PPj.gkf());A.Qxf(Pc,jd,Cd);aa=!0;ub=null;Ra=Dc}catch(Pc){var Nb=Object.assign(new Hb.a,
{extendedProperties:new Map});Nb.extendedProperties.set("exception",Pc.message);this.AIg.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:Nb},{name:B.Aoe,isInternal:!0,additionalValues:Nb})}Dc<=t&&!ub&&(Nb=Math.min(Dc,t),Nb>Ra&&A.lga(ua.substring(Ra,Nb)),Ra=Dc);bc.hyperlink&&bc.hyperlink.iG&&(ub=bc.hyperlink);if(Dc>=t)break}}return{returnValue:!0,aOa:aa}}Z_h(b,h,t,A,O=-1){var aa=!1,ua=b.Db(h),Ra=b.Db(ea.k(ua));ua=b.Db(ea.h(ua));O=0<O?O:Number.MAX_VALUE;b=
this.eAb(Ra,h,!0);h=this.eAb(ua,h,!1);if(-1===b||-1===h)return{returnValue:!1,aOa:aa};if(Ra===ua)return this.mMd(Ra,b,h,t,A);const ub=this.kLa.Uta(Ra,!1,!1);if(!ub)return{returnValue:!1,aOa:aa};Ra=new Mb.a;let Nb=0;do Ra.add(ub.mx),Nb+=ub.mx.characterData.length;while(ub.mx!==ua&&ub.Uaa()&&Nb<O);for(O=0;O<Ra.count;O++)if(aa=Ra.J(O),ua=aa.characterData,O)if(O===Ra.count-1){if(!({aOa:aa}=this.mMd(aa,0,h,t,A)).returnValue)return{returnValue:!1,aOa:aa}}else{if(!({aOa:aa}=this.mMd(aa,0,ua.length,t,A)).returnValue)return{returnValue:!1,
aOa:aa};t.lga("\n")}else{if(!({aOa:aa}=this.mMd(aa,b,ua.length,t,A)).returnValue)return{returnValue:!1,aOa:aa};t.lga("\n")}return{returnValue:!0,aOa:aa}}lMd(b,h){const t=new wh;return this.Z_h(b,h,t,!1,-1).returnValue?t.tza:null}MJd(b,h){var t=b.Db(h);if(!t)return null;b=b.Db(ea.h(t));if(!b)return null;h=this.eAb(b,h,!1);if(-1===h)return null;t=b.characterData;if(h>=t.length||!F.a.sba(t.charAt(h))){t=this.Ic.Qc(15);try{t.Eb(b),this.Jd.replaceTextRange(pf.a.Tc(b,h)," ")}finally{t&&t.dispose()}}return wf.SelectionFactory.te(b,
h+1)}Dig(b,h){const t=b.Db(h),A=new ep.a;this.Z_h(b,h,A,!0).returnValue&&(A.lga("\n"),this.Rp.tyj(t,A.V9),this.ra.raiseEvent(Fa.Ion))}z6n(b,h){for(const t of b){if(t.contains(h))return!0;for(const A of t)for(const O of h)if(A.node===O.node&&A.zj>=O.zj)return!0}return!1}pMh(b,h,t,A,O){const aa=this.ib.hb.clone(),ua=new lw.a(Jb.App.ya.jb.xc);b=wf.SelectionFactory.te(b,h);t=pf.a.Tc(t,A);b=wf.SelectionFactory.Vz(b,t);this.ib.setSelection(b);t=!this.z6n(aa,b);return 32===this.ga.Nf(ua,qa.a.kH,2,!0,null,
null)?(t?this.ib.qY(aa):O!==W.a.nil&&(O=this.MJd(this.Nh.value,O),this.ib.setSelection(O)),!0):!1}ASn(b,h){var t=b.Db(h);const A=b.Db(ea.k(t));b=b.Db(ea.h(t));if(A===b){t=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var O=A.characterData.indexOf(t);-1!==O&&this.pMh(A,O,b,O+t.length,h)}}xMh(b,h,t){var A=b.Db(h);if(!A)return!1;const O=b.Db(ea.k(A));b=b.Db(ea.h(A));A=this.eAb(O,h,!0);const aa=this.eAb(b,h,!1);if(-1===A||-1===aa||!this.pMh(O,A,b,aa,W.a.nil))return!1;t&&
this.GMh(h);return!0}GMh(b){this.Rp.m2f(b,!0)}CHo(b){var h=this.xYl(this.ib.hb);if(!h)return!1;const t=this.u7b(this.ib.hb,!0);if(1!==t.count)return!1;const A=h.Db(t.J(0));if(b)h=this.xMh(h,t.J(0),!1);else{const O=ea.k(A),aa=ea.h(A);W.a.Sp(O,aa)||u.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.A_k(t.J(0));h.Db(O).Wk(16,!0);h=!0}h&&(A.setValue(Lc.a.jaa,!0),this.ra.raiseEvent(Fa.vQi,new d(A,b)));return h}Jsh(b,h){b=this.u7b(this.ib.hb,!1);
h.Go[Fa.fOh]=!!b.count}COi(b,h){if(h.Go[Fa.fOh]&&qe.ParagraphReader.Yb(h.clone)&&(h=h.clone,b=h.Mc)&&(h=pf.a.createTextRange(h,0,h.characterData.length),h=this.oOc(h,!1),h.count))for(const t of h)(h=b.Db(t))&&h.setValue(Lc.a.jG,!1)}RKl(b,h,t){let A;const O=({bFc:ub}=this.Rp.LGc(h,t,!0)).returnValue;t=({bFc:A}=this.Rp.LGc(h,t,!1)).returnValue;let aa=null,ua=-1,Ra=-1;for(;ub<A;ub++){const Nb=h.qa.J(ub);if(Nb.hyperlink&&Nb.hyperlink.iG&&Nb.hyperlink.hx===b){aa=Nb.hyperlink;ua=Nb.cp;break}}if(!aa||ua<
O)return{returnValue:!1,oGh:ua,nGh:Ra};for(b=ub;b<h.qa.length;b++){var ub=h.qa.J(b);if(ub.cp>t)break;if(ub.UT){Ra=ub.cp;break}}return{returnValue:-1!==Ra,oGh:ua,nGh:Ra}}BTn(b){var h=this.Yjd.dJl(b);if(h){var t=null;Jb.App.ya&&(t=Jb.App.ya.jb.Wc.ud);if(t){var A=t.Db(h);h=t.Db(ea.k(A));var O=t.Db(ea.h(A));if(h!==O)u.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({oGh:b,nGh:O}=this.RKl(b,h,A.id)).returnValue){var aa=new Te.GraphTransaction(7);try{aa.Eb(h);const ua=
pf.a.createTextRange(h,b,O);this.Jd.replaceTextRange(ua,"");this.Dig(t,A.id)}finally{aa&&aa.dispose()}this.ib.hb&&0<this.ib.hb.length?(t=this.ib.hb.J(0).Qa,t.node===h?u.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",t.cpBegin,b):u.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):u.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.ib.setSelection(wf.SelectionFactory.te(h,b))}else u.ULS.sendTraceTag(50954440,323,15,
"Unable to compute hyperlink CPs for bookmark")}else u.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else u.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}Sfm(b,h){if(!h){h=this.Yjd.mGl(b);if(!h){u.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(const t of h)this.BTn(t)}this.Yjd.BUn(b)}fEl(){kj.a.instance.eRc();const b=new Mb.a;for(const t of this.Rp.nZe)if(t.er!==Td.a.beingCreated){var h=W.a.Gf(t.objectId);
h=this.Nh.value.Db(h);this.jG(h,!0)&&b.add(h)}return b}a6n(b){b=this.Rp.xrf(b);this.ib.setSelection(b)}A_k(b){b?this.Nh.value.Db(b).setValue(Lc.a.jG,!1):u.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static CEf(b){return b===mc.a.Fd||b===mc.a.Vc||b===mc.a.paragraph}}Fa.fOh="DisableNestedIntelligentPlaceholder";Fa.kNi="CreateIntelligentPlaceholder";Fa.vQi="ResolveIntelligentPlaceholder";Fa.Ion="UpdateIntelligentPlaceholder";Fa.UYc="DeleteIntelligentPlaceholder";
Fa.Ojn="MentionAddedToFollowUpEventKey";Object(m.a)(Fa,"IntelligentPlaceholderEditor",null,[380,381,382]);class kb{constructor(b,h,t,A){this.Nra=!1;this.xs=!0;this.$d=null;this.DMa=O=>{if(!this.xs||!this.xLk(O,this.ib.hb))return!1;O.Ib.preventDefault();O.Ib.stopPropagation();this.ed.vd&&this.ed.vd.JJc(!1);O=this.MJd(this.ib.hb);if(!O)return!1;this.ib.setSelection(O);return!0};this.ed=b;this.Nh=h;this.ib=t;this.U5=A}Kyb(b,h){this.Nra||(b.Sva?(this.hdb(h),this.Nra=!0):b.sea(()=>{this.Nra||(this.hdb(h),
this.Nra=!0)}))}dispose(){this.$d&&this.$d.sc(db.a.CF,this.ed.editingView.editingElement,this.DMa)}hdb(b){this.$d=b;this.ed.vd.Yi&&this.$d.mb(db.a.CF,this.ed.editingView.editingElement,this.DMa)}xLk(b,h){if(b.Ib.keyCode!==rc.a.iw&&b.Ib.keyCode!==rc.a.ks||1!==h.length||!h.J(0).Sx)return!1;var t=this.U5.u7b(h,!0);if(1!==t.count)return!1;const A=h.J(0).Qa.node;if(!qe.ParagraphReader.Yb(A))return!1;b=this.U5.eAb(A,t.J(0),!0);t=this.U5.eAb(A,t.J(0),!1);return h.J(0).Qa.cpBegin<b||h.J(0).Qa.cpEnd>t?!1:
!0}MJd(b){b=this.U5.u7b(b,!0);if(1!==b.count)return null;b=b.J(0);return this.U5.MJd(this.Nh.value,b)}Hej(b){this.xs=b}}Object(m.a)(kb,"IntelligentPlaceholderKeyboardListener",null,[379,9]);class Pb{constructor(b,h){this.nvm=t=>{1===t&&this.ga.processAction(ab.a.newComment,2);2===t&&(this.Aah.instance?this.Aah.instance.Ykc("https://go.microsoft.com/fwlink/?linkid=2154656")&&F.a.eU("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):
u.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));t=[Object.assign(new sa.a,{name:"DialogResult",int64:t})];lb.d(Vc.a.YXh,void 0,void 0,void 0,void 0,void 0,t)};this.ga=b;this.Aah=h}O2k(){const b=new cf.StandardDialog;b.zd=11;b.Ge(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.Ge(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.Au(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,
0,this.nvm);lb.a("FollowUpsPhaseOutDialogShown")}}Object(m.a)(Pb,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var uc=c(1468);class Oc{constructor(b,h,t,A,O,aa){this.m6=this.LLe=null;this.Z3=()=>{this.m6||(this.m6=new Vb.a(3,1,0,()=>{this.m6=null;this.YSd(this.ib.hb)},130),this.Gb.Wb(this.m6))};this.Ic=b;this.dI=h;this.ib=t;this.Gb=A;this.$Te=O;this.Nh=aa;this.B1=new qb.a;this.ps=new uc.a;this.p7g=new Z.a(this.B1);this.dI.Cmh((ua,Ra)=>{this.enk(Ra.commentNode)})}enk(b){b=b.id;const h=this.R$h(this.Nh.value,
b);h&&this.ps.Z(b,h)}R$h(b,h){const t=b.Db(h);return!t||this.dI.L$b(t)?null:this.dI.lMd(b,h)}MFk(b){const h=new uc.a;var t=this.dI.u7b(b,!0);if(!t)return h;b=this.Nh.value;for(const A of t)(t=this.R$h(b,A))&&h.Z(A,t);return h}m2f(b){if(this.LLe){const h=this.Ic.Qc(15);try{h.Eb(this.$Te()),this.dI.GMh(this.LLe)}finally{h&&h.dispose()}}this.LLe=b?this.dI.J0l(b):null}ugm(b){const h=this.Nh.value;if(b=b?this.MFk(b):new uc.a){var t=new Z.a(this.B1),A=new Z.a(this.B1);Oc.TNl(this.ps,b,t,A);for(var O of t)this.ps.Z(O,
b.J(O));for(const aa of A)if(t=this.ps.J(aa),A=this.dI.lMd(h,aa),this.ps.remove(aa),A&&(b=O=!1,Pa.a.ROc().equals(A,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,t=!1):t=-1<A.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?O=!0:!Pa.a.ROc().equals(t,A),t||O||b)){A=this.Ic.Qc(15);try{A.Eb(this.$Te()),b?this.dI.xMh(h,aa,!0):(O&&this.dI.ASn(h,aa),t&&this.dI.Dig(h,aa))}finally{A&&A.dispose()}}}}J_l(b){const h=new Z.a(this.B1);for(const t of b)for(const A of t)b=
A.node,qe.ParagraphReader.Yb(b)&&h.add(b.id);return h}Pem(b){var h=this.Nh.value;const t=b?this.J_l(b):new Z.a(this.B1);if(t){b=new Mb.a;for(const aa of this.p7g)if(!t.contains(aa)){var A=h.Db(aa);if(A){A=A.qa;for(let ua=0;ua<A.length;ua++){const Ra=A.J(ua).uf;if(Ra)for(let ub=0;ub<Ra.length;ub++){var O=Ra.J(ub);O.Oc&&(O=h.Db(O.Tj))&&O.ia(Lc.a.Hyi,!1)&&W.a.Sp(aa,ea.h(O))&&this.dI.L$b(O)&&b.add(O)}}}}this.p7g=t;if(b.count){h=this.Ic.Qc(7);try{h.Eb(this.$Te());for(const aa of b)aa.Qg(Lc.a.Hyi)}finally{h&&
h.dispose()}}}}YSd(b){this.m2f(b);this.ugm(b);this.Pem(b)}Dxh(){this.m6&&(this.Gb.Se(this.m6),this.m6=null)}LYc(){if(this.m6||this.Nh.fvf)this.Dxh(),this.YSd(null)}bF(){this.ib.gx(this.Z3);v.AFrameworkApplication.uJ(()=>{this.LYc()})}dispose(){this.ib.lY(this.Z3);this.Dxh()}static TNl(b,h,t,A){for(const O of h){const aa=O.key;b.ob(aa)||t.add(aa)}for(const O of b)b=O.key,h.ob(b)||A.add(b)}}Object(m.a)(Oc,"IntelligentPlaceholderSelectionCache",null,[9]);var ld;(function(b){b[b.unknown=0]="unknown";
b[b.contextMenu=1]="contextMenu";b[b.atMention=2]="atMention";b[b.ngp=3]="textGesture";b[b.paste=4]="paste";b[b.v_o=5]="workItemIntent";b[b.P6o=6]="characterTrigger"})(ld||(ld={}));Object(m.b)("IntelligentPlaceholderCreation",ld);class Hd{constructor(b,h,t,A){this.Mza=b;this.Dm=h;this.HRb=t;this.Ix=A}ege(b){return b&&b.Mc&&b.Mc.id.equals(this.Ix.value.ud.id)?!0:!1}Vjj(b){return this.ege(b)&&b.ia(Lc.a.jG,!1)?!0:!1}l_m(){this.HRb.execute(b=>{b.logAction({actionType:Uo.b.SessionStart,engagement:Uo.a.Offer,
objectName:Hd.Wjc})})}V0d(b,h){const t=2==h&&this.ege(b);if(this.Vjj(b)||t){var A=b.getValue(Lc.a.wE);this.HRb.execute(O=>{O.logAction({actionType:Uo.b.Created,engagement:Uo.a.None,objectName:Hd.Wjc,objectId:A.toString(),objectFulfillment:ld[h]})})}}QWm(b){if(this.Vjj(b)){var h=b.getValue(Lc.a.wE);this.HRb.execute(t=>{t.logAction({actionType:Uo.b.Deleted,engagement:Uo.a.None,objectName:Hd.Wjc,objectId:h.toString()})})}}d0m(b,h){if(this.ege(b)){var t=b.getValue(Lc.a.wE);this.HRb.execute(A=>{A.logAction({actionType:Uo.b.Resolved,
engagement:Uo.a.None,objectName:Hd.Wjc,objectId:t.toString(),objectFulfillment:h?"RemoveText":"KeepText"})})}}m1m(b){b===Vc.a.SUd&&this.HRb.execute(h=>{h.logAction({actionType:Uo.b.Deleted,engagement:Uo.a.None,objectName:Hd.Wjc,objectFulfillment:Hd.FAo})})}dZm(b){if(this.ege(b)){var h=b.getValue(Lc.a.wE);this.HRb.execute(t=>{t.logAction({actionType:Uo.b.Modified,engagement:Uo.a.None,objectName:Hd.Wjc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}NCk(){this.l_m();this.Mza.Cmh((b,h)=>
{this.V0d(h.commentNode,h.swn)});this.Mza.ork((b,h)=>{this.d0m(h.commentNode,h.FIm)});this.Mza.Wqk((b,h)=>{this.dZm(h.commentNode)});this.Dm.u_b((b,h)=>{this.m1m(h.actionId)});hj.a.fYe((b,h)=>{this.QWm(h.commentNode)})}}Hd.Wjc="IntelligentPlaceholder";Hd.FAo="Undo";Object(m.a)(Hd,"IntelligentPlaceholderTelemetry",null,[]);class $d{constructor(){this.U5=this.Pld=this.Fsd=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}yc(b){this.W=b;b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",
()=>new Pb(v.AFrameworkApplication.xa,b.Sa("Common.App.SafeLinks.ISafeLinksManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new gk).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new Fa(v.AFrameworkApplication.xa,new ok.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),
b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new Pg.a(()=>Jb.App.ya.jb.Wc.ud),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").singleInstance();
b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",()=>new Bl(v.AFrameworkApplication.xa,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new Oc(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),
b.resolve("Box4.ISelectionManager"),v.AFrameworkApplication.oc,()=>Jb.App.ya.jb.xc.Zc,new Pg.a(()=>Jb.App.ya.jb.Wc.ud))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new kb(pc.InteractiveViewManager.instance,new Pg.a(()=>Jb.App.ya.jb.Wc.ud),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").singleInstance();
b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",()=>new Hd(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Sa("CanvasContextual.ICanvasContextualController"),new Pg.a(()=>Jb.App.ya.jb.Wc))).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>{this.$m()})}$m(){const b=this.W.resolve("Box4.IFeatureHelper");this.W.Sa("WordEditor.CanvasContextualProvider.UxManager");this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Ub();
this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").NCk();this.U5=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");mv.a.Hpk(Object(z.a)(this.U5,this.U5.Jsh,"beforeIntelligentPlaceholderPaste"));mv.a.uyd(Object(z.a)(this.U5,this.U5.COi,"onIntelligentPlaceholderPaste"));this.Fsd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(96)||this.Fsd.bF();this.Pld=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");
this.Pld.Kyb(Jb.App.ya.jb,sb.KeyInputManager.instance);this.mPn(this.W.Sa("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.Fsd&&this.Fsd.dispose();this.Pld&&this.Pld.dispose();this.U5&&(mv.a.JUn(Object(z.a)(this.U5,this.U5.Jsh,"beforeIntelligentPlaceholderPaste")),mv.a.nVn(Object(z.a)(this.U5,this.U5.COi,"onIntelligentPlaceholderPaste")))}mPn(b,h,t){b&&b.execute(A=>{A.g4(new bk(h,
t))})}static main(){P.a.instance.Gc(new $d)}}Object(m.a)($d,"PackageManager",null,[1,2]);var ie=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",
DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",
attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",
IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},
children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",
LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},Qe=c(2036),We=c(1925),He=c(2001);class Eg{}Eg.Dto="Search_16x16x32";Eg.vto="ClosePaneGlyph_16x16x32";Object(m.a)(Eg,"SearchBoxIcons",
null,[]);var oj=c(2004),Vk=c(2005),uk=c(2003);class yo{constructor(){this.JRg=null}get key(){return"FIND_HIT"}get zw(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.JRg=b.node.Kma()}YHa(b){let h=null;for(const t of this.JRg)if(t.begin<=b&&b<t.end)return h=Object.assign(new sm.a,{rG:this.key,contentObject:t}),{returnValue:!0,xF:h};return{returnValue:!1,xF:h}}}Object(m.a)(yo,"FindHitDetailsProvider",null,[376,59]);var zo=c(1631),Jr=c(1565),Rm=c(1607);class dl{constructor(b,
h,t,A,O,aa,ua,Ra=null,ub=null){this.am=null;this.find=(Nb,Yb,bc,Dc,Pc)=>1===bc?32:void 0===Pc||null===Pc?8:Pc.length?this.Ucg(Pc):(this.N3e(He.a.initial),32);this.findInDocument=(Nb,Yb,bc,Dc,Pc)=>this.fmj(Vc.a.Tnb,Nb,Yb,bc,Dc,Pc);this.wul=(Nb,Yb,bc,Dc,Pc)=>this.fmj(Vc.a.Unb,Nb,Yb,bc,Dc,Pc);this.xWh=(Nb,Yb,bc)=>1===bc?32:this.Ucg(this.mo.sOa());this.$0c=(Nb,Yb,bc,Dc,Pc)=>{Nb=!this.mo.NF;Pc[Rk.a.Image16by16Class]=Nb?dh.getImageClass(Eg.Dto):dh.getImageClass(Eg.vto);Pc[Rk.a.LabelText]=Nb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:
WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Pc[Rk.a.ApplyLabelTextToControlOnly]=!0;Pc[Rk.a.EnsureControlRoleIsButton]=!0;Pc[Rk.a.On]=!1;return 32};this.Avl=(Nb,Yb,bc)=>{if(1===bc)return 32;this.mgi(!1);return 32};this.Lvl=(Nb,Yb,bc)=>{if(1===bc)return 32;this.mgi(!0);return 32};this.TZf=(Nb,Yb,bc,Dc,Pc)=>{Pc[Ck.a.Visible]=this.mo.lmj;return 32};this.c_f=(Nb,Yb,bc,Dc,Pc)=>{Pc[Ck.a.Visible]=this.mo.lmj;return 32};this.wRd=(Nb,Yb,bc,Dc,Pc)=>{if(1===bc)return 32;this.JA.R3c.rgi(Pc);
return 32};this.cancelSearch=(Nb,Yb,bc)=>{if(1===bc)return 32;this.N3e(He.a.initial);return 32};this.xFc=(Nb,Yb,bc)=>{if(1===bc)return 32;this.N3e(He.a.initial);this.mo.AB(!1);return 32};this.clearSearch=(Nb,Yb,bc)=>{if(1===bc)return this.Wym(Nb===ab.a.LAh);this.mo.clearSearch();return 32};this.Sle=(Nb,Yb,bc)=>{if(1===bc)return 32;switch(Nb){case ab.a.Shf:this.mo.matchCase=!this.mo.matchCase;break;case ab.a.fif:this.mo.matchWholeWord=!this.mo.matchWholeWord}return this.Ucg(this.mo.sOa())};this.$9d=
(Nb,Yb,bc,Dc,Pc)=>{Pc[Ng.a.On]=this.mo.matchCase;return 32};this.b$d=(Nb,Yb,bc,Dc,Pc)=>{Pc[Ng.a.On]=this.mo.matchWholeWord;return 32};this.EZf=(Nb,Yb,bc,Dc,Pc)=>{Nb=this.mo.matchCase;Yb=this.mo.matchWholeWord;bc="";Nb&&Yb?bc=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Nb?bc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
Yb&&(bc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Pc[Vj.a.Value]=bc;Pc[Vj.a.Visible]=Nb||Yb;return 32};this.Afc=(Nb,Yb,bc,Dc,Pc)=>{Nb=this.mo.M1;Yb="";switch(this.mo.NF){case He.a.startSearch:Yb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case He.a.searching:Yb=Nb?this.drf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case He.a.searchComplete:Yb=
this.drf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case He.a.tooManyResults:Yb=this.drf(this.mo.aFa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case He.a.noMatchesFound:Yb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case He.a.replaceAllInProgress:Yb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case He.a.replaceAllComplete:Yb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Pc[Vj.a.Value]=
Yb;return 32};this.a$d=(Nb,Yb,bc,Dc,Pc)=>{Pc&&(Pc.CommandValueId=this.mo.sOa());return 32};this.replace=(Nb,Yb,bc,Dc,Pc)=>{if(1===bc)return this.hDf()?32:8;if(!this.hDf())return 8;Nb=this.mo.VDb();"string"===typeof Pc&&Pc&&(Nb=Pc);u.ULS.sendTraceTag(6033813,312,50,"Replace Called");lb.a("NavigationPaneReplace");Pc=this.Xvb.replace(Nb);this.mo.N9n(Pc);return 32};this.replaceAll=(Nb,Yb,bc,Dc,Pc)=>{if(1===bc)return this.MIm()?32:8;Nb=this.mo.VDb();"string"===typeof Pc&&Pc&&(Nb=Pc);lb.a("NavigationPaneReplace");
this.am=this.ge.eg("UserAction","ReplaceAll");this.mo.V6(He.a.replaceAllInProgress);u.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");Rm.a.uXn(this.mo.sOa(),this.mo.VDb());this.Xvb.replaceAll(Nb,this.emn);return 32};this.emn=(Nb,Yb)=>{this.am&&(this.am.stop(),this.am=null);u.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Nb,["TotalCount"]:Yb});Rm.a.rXn(Nb,Yb);this.mo.V6(He.a.replaceAllComplete)};this.PZi=(Nb,Yb,bc,Dc,Pc)=>{Yb=!1;if(!Pc)return 8;
this.mo.hj.isVisible&&(Yb=Nb===Vc.a.t1c===this.mo.iOc());Nb!==Vc.a.t1c||this.tZg||(Yb=!1);Pc[Ng.a.On]=Yb;return 32};this.FZf=(Nb,Yb,bc,Dc,Pc)=>{if(!Pc||!this.mo.hj.isVisible)return 32;Pc[Ng.a.On]=this.mo.aFa;return 32};this.HZf=(Nb,Yb,bc,Dc,Pc)=>{if(!Pc)return 32;Pc.currentFindReplaceViewType=this.mo.NF;return 32};this.JEn=(Nb,Yb,bc,Dc,Pc)=>{if(1===bc)return 32;Nb=Pc[Ng.a.On];Pc&&(Pc[Ng.a.On]=this.mo.hj.isVisible);Nb&&!Pc[Ng.a.On]&&(dl.Vuj(),lb.a("NavigationPaneCrossClick"));return 32};this.F6a=(Nb,
Yb,bc,Dc,Pc)=>{const jd=this.mo.hj.isVisible;u.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",jd);return jd?this.xFc(Nb,Yb,bc,Dc,Pc):this.Dic(Nb,Yb,bc,Dc,Pc)};this.Dic=(Nb,Yb,bc,Dc,Pc)=>{if(1===bc)return fc.SessionStatusManager.instance.vH?32:8;if(2===bc){v.AFrameworkApplication.moa("AutoDetectedHeadingsIsEnabled");dl.Vuj();this.h4();zo.FindReplaceUIManager.fJk(Nb,Pc,this.mo.hj.isVisible);Yb=!0;Nb===Vc.a.Iic&&void 0!==Pc&&null!==Pc&&(Yb=Pc);this.mo.AB(!0,Yb);Pc=uk.a.initial;switch(Nb){case Vc.a.Eic:u.ULS.sendTraceTag(42501022,
367,50,"");Pc=uk.a.headings;break;case Vc.a.Tnb:Pc=uk.a.find;break;case Vc.a.Unb:Pc=uk.a.replace;break;case Vc.a.Iic:Pc=uk.a.intelligentPlaceholder;break;case Vc.a.F6a:Pc=this.mo.m3b,Pc||(u.ULS.sendTraceTag(42501023,367,50,""),Pc=uk.a.headings)}this.mo.Fdo(Pc,Yb);return 32}return 8};this.KFa=()=>{this.mo.NF&&!this.mo.aFa&&u.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.mo=h;this.JA=t;this.Xvb=A;this.tZg=O;this.ge=ua;ub&&ub(1,this.KFa,null);this.ZJa=Ra}h4(){}Ub(){this.ga.gb(Vc.a.t_f,
mc.a.view,this.JEn,96);this.ga.pa(Vc.a.F6a,mc.a.view,this.F6a);this.ga.pa(Vc.a.Eic,mc.a.view,this.Dic);this.ga.pa(Vc.a.Tnb,mc.a.view,this.Dic);this.ga.pa(qa.a.KKd,mc.a.view,this.find);this.ga.pa(ab.a.findInDocument,mc.a.view,this.findInDocument);this.ga.pa(qa.a.findOnPage,mc.a.view,this.xWh);this.ga.gb(ab.a.kEn,mc.a.view,this.$0c,97);this.ga.pa(qa.a.L3d,mc.a.view,this.Avl);this.ga.pa(qa.a.r9d,mc.a.view,this.Lvl);this.ga.gb(qa.a.TZf,mc.a.view,this.TZf,97);this.ga.gb(qa.a.c_f,mc.a.view,this.c_f,97);
this.ga.pa(Vc.a.wRd,mc.a.view,this.wRd);this.ga.pa(qa.a.nzb,mc.a.view,this.cancelSearch);this.ga.pa(ab.a.clearSearch,mc.a.view,this.clearSearch);this.ga.pa(ab.a.LAh,mc.a.application,this.clearSearch);this.ga.pa(Vc.a.xFc,mc.a.view,this.xFc);this.ga.pa(ab.a.Shf,mc.a.view,this.Sle);this.ga.pa(ab.a.fif,mc.a.view,this.Sle);this.ga.gb(ab.a.$9d,mc.a.view,this.$9d,97);this.ga.gb(ab.a.b$d,mc.a.view,this.b$d,97);this.ga.gb(Vc.a.EZf,mc.a.view,this.EZf,97);this.ga.gb(Vc.a.Afc,mc.a.view,this.Afc,97);this.ga.gb(Vc.a.FZf,
mc.a.view,this.FZf,97);this.ga.gb(Vc.a.HZf,mc.a.view,this.HZf,97);this.ga.gb(Vc.a.GZf,mc.a.view,this.PZi,97);Object(Jr.b)()&&this.ga.gb(Vc.a.a$d,mc.a.view,this.a$d,96);this.tZg&&(this.ga.gb(Vc.a.Unb,mc.a.view,this.Dic,1028),this.ga.gb(Vc.a.t1c,mc.a.view,this.PZi,97),this.ga.gb(Vc.a.replace,mc.a.view,this.replace,1028),this.ga.gb(Vc.a.replaceAll,mc.a.view,this.replaceAll,1028),v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)&&this.ga.gb(ab.a.$hf,mc.a.view,this.wul,1028));this.ga.pa(Vc.a.Iic,mc.a.view,this.Dic)}b1f(){this.ZJa&&this.ZJa.execute(b=>{b.g4(new yo)})}fmj(b,h,t,A,O,aa){if(1===A)return fc.SessionStatusManager.instance.vH?32:8;if(void 0===aa||null===aa)return 8;this.Dic(b,t,2,O,aa);b=this.mo;b.r8f(aa.CommandValueId);Object(Jr.b)()&&("MatchCase"in aa&&(b.matchCase=aa.MatchCase),"MatchWholeWord"in aa&&(b.matchWholeWord=aa.MatchWholeWord));return this.xWh(h,t,A,O,aa)}Ucg(b){if(void 0===b||null===b||!b.length)return 32;
b=oj.a.createQuery(b,this.oEn);if(void 0===b||null===b)return u.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.JA.find(b);return 32}get oEn(){let b=Vk.a.none;this.mo.matchCase&&(b|=Vk.a.matchCase);this.mo.matchWholeWord&&(b|=Vk.a.wholeWordOnly);return b}mgi(b){this.mo.m3b!==uk.a.headings&&this.mo.M1&&(b?this.JA.R3c.ucm():this.JA.R3c.ogi())}N3e(b){this.mo.NF&&(this.mo.aFa||u.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.JA.RYa(),this.mo.V6(b))}Wym(b){return this.mo.NF===
He.a.replaceAllInProgress||b&&!this.mo.NF?8:32}drf(b){return String.format(b,this.mo.mfd,this.mo.M1)}hDf(){return this.mo.iOc()&&0<this.mo.M1}MIm(){return this.hDf()&&this.mo.aFa}static Vuj(){null!=v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},dl.VCa)}static ROl(b,h,t,A){return new dl(v.AFrameworkApplication.xa,
b,h,t,A,yd.FocusManager.instance(),Jb.App.ya.xq,Sa.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager"),Object(z.a)(v.AFrameworkApplication.ta.WO,v.AFrameworkApplication.ta.WO.mb,"registerHandler"))}static QOl(b,h,t,A){return dl.ROl(b,h,t,A)}}dl.VCa=5E3;Object(m.a)(dl,"FindReplaceActor",null,[]);var tm=c(905),Nh=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.QB},set:function(h){this.QB=h},enumerable:!1,configurable:!0});
Object.defineProperty(b.prototype,"last",{get:function(){return this.PVa},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,t){this.removeItem(h);t={key:h,dca:this.PVa,next:void 0,data:t};this.first||(this.first=t);this.PVa&&(this.PVa.next=t);this.PVa=t;this._map.set(h,t)};b.prototype.insertAfter=function(h,t,A){h=this._map.get(h);if(!h)return!1;A={key:t,dca:h,next:h.next,data:A};
var O=h.next;O&&(O.dca=A);h.next=A;this._map.set(t,A);return!0};b.prototype.insertBefore=function(h,t,A){h=this._map.get(h);if(!h)return!1;A={key:t,dca:h.dca,next:h,data:A};var O=h.dca;O&&(O.next=A);h.dca=A;this._map.set(t,A);return!0};b.prototype.removeItem=function(h){var t=this._map.get(h);t&&(this.first===t&&(this.first=t.next),this.PVa===t&&(this.PVa=t.dca),t.dca&&(t.dca.next=t.next),t.next&&(t.next.dca=t.dca),this._map.delete(h))};return b}();class Yj{constructor(){this.type="heading"}}Object(m.a)(Yj,
"NavPaneHeadingItem",null,[]);class oq{constructor(){this.type="bookmark"}}Object(m.a)(oq,"NavPaneBookmarkItem",null,[]);class To{constructor(b,h,t,A,O,aa,ua){var Ra,ub;this.eb=b;this.ib=h;this.Vb=t;this.hn=A;this.Nh=O;this.rF=aa;this.NZj=ua;this.NWa=0;this.jod=new Map;this.FUg=!1;this.fza=new Map;this.AHg=null===(Ra=v.AFrameworkApplication.K)||void 0===Ra?void 0:Ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneADHToggleDefaultOff",!1);this.n6j=null===(ub=v.AFrameworkApplication.K)||void 0===
ub?void 0:ub.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneShowNumberListedHeadings",!1)}get headingsReady(){return this.FUg}set headingsReady(b){this.FUg=b}get VKb(){return this.NWa}get L8(){this.EWb&&0!=this.EWb.length()||(this.EWb=this.kzn());return this.EWb}set L8(b){this.EWb=b}get fhc(){return this.qbk}set fhc(b){this.fhc&&(this.fhc.isSelected=!1);b.isSelected=!0;this.qbk=b}Gpf(b,h){return"bookmark"===b.type?b.text:h.id.toString()}kzn(){var b;const h=new Nh;var t=null===(b=this.Nh.value)||
void 0===b?void 0:b.YUf;if(!t)return h;this.jod=new Map;b=t.ZKc();let A;const O=[];for(;b;){const aa=this.Nh.value.Db(b.id);t=this.G8h(aa,O);null===t||void 0===t?void 0:t.forEach(ua=>{(A=this.y$h(ua,O))&&"heading"===A.type&&A.indentLevel<ua.indentLevel&&(1>=A.indentLevel?(A.isCollapsed=!1,ua.isHidden=!1):(A.isCollapsed=!0,ua.isHidden=!0));h.insert(this.Gpf(ua,aa),ua)});b=b.next}return h}y$h(b,h){return"heading"===b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}njg(b){var h;
let t=qe.ParagraphReader.Sma(b),A=!1;9===t&&this.fza.has(b.id.toString())&&(t=this.fza.get(b.id.toString()),A=!0);const O=null===(h=this.L8.get(b.id.toString()))||void 0===h?void 0:h.data;if(O){if(O.indentLevel===t){h=Tb.AParagraphNode.CU(b.characterData.trim());b=this.hn.value.ZUf(b);if(h!==O.text||O.hasBookmark!==b)return O.text=h,O.hasBookmark=b,!0;!A&&O.isPurelyADH&&(O.isPurelyADH=!1,--this.NWa);return!1}this.n0c();return!0}if(9===t)return this.Gxm(b)?(this.n0c(),!0):!1;this.n0c();return!0}Gxm(b){var h;
const t=this.hn.value.O0h(b);b=null!==(h=this.jod.get(b.id.toString()))&&void 0!==h?h:0;if(b!==t.length)return!0;for(h=0;h<b;++h)if(!this.L8.get(t[h].hOa()))return!0;return!1}vcl(b){if(this.L8.get(b.id.toString())||this.hn.value.ZUf(b))return this.n0c(),!0;this.fza.has(b.id.toString())&&(this.fza.delete(b.id.toString()),--this.NWa);return!1}n0c(){var b,h=null===(b=this.Nh.value)||void 0===b?void 0:b.YUf;const t=new Nh;this.NWa=0;if(h){this.jod=new Map;var A=[];b=h.ZKc();for(var O,aa;b;){const ua=
this.Nh.value.Db(b.id);h=this.G8h(ua,A);null===h||void 0===h?void 0:h.forEach(Ra=>{var ub=this.Gpf(Ra,ua);aa=this.y$h(Ra,A);this.G0n(ub,Ra,aa);t.insert(ub,Ra);"heading"===(null===O||void 0===O?void 0:O.type)&&(ub=O,ub.indentLevel>=Ra.indentLevel&&(ub.isCollapsed=void 0));O=Ra});b=b.next}}this.L8=t}G0n(b,h,t){var A,O;if(b=null===(A=this.EWb.get(b))||void 0===A?void 0:A.data)b.isSelected&&(h.isSelected=!0,this.fhc=h),h.isHidden=b.isHidden;if(t){if(A=null===(O=this.EWb.get(this.Gpf(t,t.paragraphNode)))||
void 0===O?void 0:O.data)t.isCollapsed=A.isCollapsed;t.isCollapsed?h.isHidden=!0:t.isHidden?(t.isCollapsed=!0,h.isHidden=!0):(t.isCollapsed=!1,h.isHidden=!1)}}G8h(b,h){var t=qe.ParagraphReader.Sma(b),A=!this.hBf(b);const O=this.uDm(t)&&A?!0:!1;A=this.fza.has(b.id.toString())&&A;const aa=[];if(O)aa.push(this.KHh(b,t,!1,h));else if(A)this.NWa+=1,this.dKc&&(t=this.fza.get(b.id.toString()),aa.push(this.KHh(b,t,!0,h)));else{let ua=0;this.hn.value.O0h(b).forEach(Ra=>{const ub=new oq;ub.text=Ra.hOa();ub.isSelected=
!1;ub.bookmarkManager=this.hn;ub.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;ua+=1;aa.push(ub)});this.jod.set(b.id.toString(),ua)}return aa}KHh(b,h,t,A){var O,aa;const ua=new Yj;ua.text=Tb.AParagraphNode.CU(b.characterData.trim());ua.indentLevel=h;ua.paragraphNode=b;ua.isSelected=!1;ua.isPurelyADH=t;this.n6j&&(ua.listMarker=this.Ypf(b));ua.hasBookmark=this.hn.value.ZUf(b);for(b=null===(O=A[A.length-1])||void 0===O?void 0:O.indentLevel;b&&b>=h;)A.pop(),b=null===(aa=A[A.length-1])||void 0===
aa?void 0:aa.indentLevel;(!b||b<h)&&A.push(ua);return ua}hBf(b){return this.eb.Yb(b)&&0===this.eb.textLength(b,9)}Fql(b){(b=this.L8.get(b))&&(1==b.data.isCollapsed?this.qmj(b):this.Bkm(b))}onClickHeading(b){var h;this.fhc=b=null===(h=this.L8.get(b))||void 0===h?void 0:h.data;h=wf.SelectionFactory.te(b.paragraphNode,0);this.ib.setSelection(h);this.Vb.mg(vf.AFrame.$n)}onClickBookmark(b){var h;this.fhc=b=null===(h=this.L8.get(b))||void 0===h?void 0:h.data;this.hn.value.fgi(b.text);this.Vb.mg(vf.AFrame.$n)}onShareHeadingClick(b){var h;
v.AFrameworkApplication.ye("NavPaneShareHeadingLink-tf;NavPaneShareHeadingLink-cf");lb.a("CreateHeadingLinkThroughNavPane",!0,void 0);if(b=null===(h=this.L8.get(b))||void 0===h?void 0:h.data)h=b.paragraphNode.getValue(Lc.a.Lc),this.NZj.value.LHh(h)}yig(b,h){const t=b.id.toString(),A=this.fza.has(t);if(!A||this.fza.get(t)!==h){this.fza.set(t,h);if(this.dKc)return this.njg(b);!this.AHg||A||this.L8.get(t)||(this.NWa+=1)}return!1}Pbl(b){const h=b.id.toString(),t=this.fza.has(h);if(t){this.fza.delete(h);
if(this.dKc)return this.njg(b);this.AHg&&t&&!this.L8.get(h)&&--this.NWa}return!1}gDo(b){this.dKc=b;this.n0c()}Yig(b){var h;const t=null===(h=this.L8.get(b.id.toString()))||void 0===h?void 0:h.data;if(!t)return!1;b=this.Ypf(b);if(t.listMarker===b)return!1;this.vLo();return!0}pbf(b){var h;b=null===(h=this.L8.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}qmj(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;
let t;for(;b&&b.data.indentLevel>h;)t=b,b=t.next,t.data.isHidden=!1,"heading"==t.data.type&&(b=t.data.isCollapsed?this.Kro(t):this.qmj(t));return b}Bkm(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let t;for(;b&&b.data.indentLevel>h;)t=b,b=t.next,t.data.isHidden=!0}Kro(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}uDm(b){return 0<=b&&8>=b}vLo(){let b=this.L8.first;for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.Ypf(h.paragraphNode)}b=
b.next}}Ypf(b){var h;if(b.aT instanceof tm.a)return this.jam(null===(h=this.rF.bkb(b.aT))||void 0===h?void 0:h.u8)}jam(b){for(let h=0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(m.a)(To,"NavPaneHeadingsManager",null,[]);var Yr=c(1566);class Bz{constructor(){this.Xvb=this.JA=this.Urc=this.shd=this.W=null}get name(){return"WordEditor.FindReplace"}yc(b){this.W=b;const h=new To(Sa.a.instance.resolve("Box4.IParagraphReader"),Sa.a.instance.resolve("Box4.ISelectionManager"),
yd.FocusManager.instance(),Sa.a.instance.We("WordEditor.Bookmark.IBookmarkManager"),new Pg.a(()=>Jb.App.ya.jb.Wc.ud),b.resolve("Box4.IListMarkerUtility"),b.We("WordEditor.Actors.HeadingsActor"));this.W.ha("WordEditor.FindReplace.NavPaneHeadingsManager",()=>h).as("WordEditor.FindReplace.NavPaneHeadingsManager").singleInstance()}init(){Bz.Xb.Ip.continueWith(()=>{this.$m()})}$m(){if(Jb.App.Qlg){const b=Jb.App.qne;this.Urc=zo.FindReplaceUIManager.getInstance(b);this.JA=We.FindManager.createInstance(this.Urc,
Qe.a.instance,Yr.a.instance,!0);this.Xvb=this.JA.VLb;this.shd=dl.QOl(this.Urc,this.JA,this.Xvb,b);this.shd.Ub();this.shd.h4();this.shd.b1f();Jb.App.ya.updateCommandUI()}}dispose(){this.Urc&&this.Urc.dispose()}static get Xb(){return null!=Bz.evg?Bz.evg:Bz.evg=Sa.a.instance.resolve("Box4.IFeatureHelper")}}Object(m.a)(Bz,"FindReplacePackageManager",null,[1,2]);class sx{constructor(){}gkf(){return"_@_"+Ya.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}jOo(b,h,t,A){h.P9n(b,A);h.Wl(b,
Af.a.w9,!0);h.Wl(b,Lc.a.PPa,!0);h.Wl(b,Lc.a.fieldInstruction,sx.oVh(t));h.Wl(b,Lc.a.Rs,15)}Ysk(b,h,t,A){const O=b.cFd(A);h.Wl(O,Af.a.w9,!0);h.Wl(O,Lc.a.Rs,47);h.Wl(O,Lc.a.fieldInstruction,sx.oVh(t));b=b.cFd(A);h.Wl(b,Af.a.w9,!0);h.Wl(b,Lc.a.Rs,16);return[O.Dj,b.Dj]}VBl(b,h,t){b=b.cFd(t);h.Wl(b,Af.a.w9,!0);h.Wl(b,Lc.a.XGb,!0);return b.Dj}static oVh(b){return String.format(' HYPERLINK "{0}"',b)}}Object(m.a)(sx,"AtMentionHyperlinkConfigurator",null,[333]);class Zv{constructor(b,h,t){this.UVb=b;this.ib=
h;this.Whi=this.iqi=this.EDe=!1;this.wRf=this.wRf.bind(this);this.MRf=this.MRf.bind(this);this.PSf=this.PSf.bind(this);t&&t.execute(A=>{this.zUa=A});$q.a.Yzd.Pmf.then(A=>{this.Whi=!0;this.iqi=A.isSuccess})}V2i(){this.UVb.Q2i(this.wRf);this.UVb.R2i(this.MRf);this.UVb.d3i(this.PSf)}JCf(){return!1}wRf(b,h,t){var A,O;h=Date.now();if(this.zUa)if(this.Whi&&!this.iqi)u.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");else{var aa=null===(O=
null===(A=this.ib.hb)||void 0===A?void 0:A.lb)||void 0===O?void 0:O.Rc;aa?(A=aa.node,qe.ParagraphReader.Yb(A)?(O=qe.ParagraphReader.text(A),0>t||t>O.length?u.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):1<b.length&&"@"===b.trimEnd()?(lb.c(Vc.a.zZk,!0,void 0,void 0,void 0,void 0),this.UVb.reset()):(this.EDe?this.zUa.MOo():(this.EDe=!0,this.zUa.Pqo(aa)),this.zUa.Hig(t,t+b.length),b=O.substring(0,t)+b,
this.zUa.tkf(A,b,t,h))):u.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):u.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else u.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}MRf(b){if(this.zUa)this.zUa.onKeyDown(b)}PSf(){this.EDe=!1;this.zUa&&this.zUa.sBh()}}Object(m.a)(Zv,
"ContextIQUserInitHandler",null,[331]);var tx=c(1641);class Ys{constructor(){this.uz=null}get name(){return"WordEditor.AtMentions"}yc(b){this.W=b;b.ha("Box4.IAtMentionHyperlinkConfigurator",()=>new sx(b.resolve("Box4.IFeatureHelper"))).singleInstance();const h={crewAlias:Ys.mGj,featureName:Ys.QHj,topLevelKpiName:Ys.DLj,vetoPillar:7};b.ha("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new Gj.a(wa.Health.instance,new Fv.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>
{this.$m()})}dispose(){}$m(){this.W.Sa("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>{v.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(h=h&&v.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));(h||tx.a.pbd())&&this.vSm()})});this.W.resolve("Box4.IAtMentionHyperlinkConfigurator")}vSm(){(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve("Common.IDynamicScriptLoaderProvider").HA.loadScript("canvasAtMentions")).then(()=>
{v.AFrameworkApplication.K.Wo(()=>{this.INn()})})}INn(){const b={peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:v.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.wLm()};this.uz=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(t=>{t&&tx.a.qbd()||
!t&&tx.a.pbd()?(tx.a.Ezf=!t,this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new Zv(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.Sa("WordEditor.CanvasContextual.ContextIQIntentProvider"))).singleInstance()):this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new S(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.uz,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),
this.W.resolve("Box4.ISelectionManager"),pc.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).singleInstance();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").V2i()})})}wLm(){var b,h;const t=null!==(b=v.AFrameworkApplication.sessionStartInfoSettings.Ring)&&
void 0!==b?b:"-1";b=null!==(h=v.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return t===Ys.aGj&&b===Ys.$Fj}}Ys.aGj="-4";Ys.$Fj="DC2";Ys.mGj="webasynccollabeng";Ys.QHj="AtMentions";Ys.DLj="AtMentionsFeatureUsage";Object(m.a)(Ys,"PackageManager",null,[1,2]);var mp=c(1673),dr=c(1385);class Ot{constructor(b,h,t,A){this.ga=b;this.Ze=h;this._augLoopRuntimeManager=t;this.Uhk=A;this.Isa=0;this.Ywd=this.cYb=!1;this.uKg=this.k$g=this.ZHe=this.l$g=0;this.brb=null;this.JVj=new Map([["ReferencesSmartLookUp",
!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0]]);this.sUj=[{id:`${xp.nfc}_${1}`},{id:`${xp.nfc}_${2}`},{id:`${xp.nfc}_${3}`},{id:dr.a.qGd},{id:dr.a.LEd},{id:dr.a.e8d},{id:dr.a.b8d}];this.FOj=[{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"ReviewDesignerSuggestion"}];this.jed=
new Map;this.P0j=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.Y4j=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",8);this.ORj=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.Ze.mb(this,mp.SearchSuggestionAnnotation.getTypeName());(v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&
this.jed.set("InsertLink","InsertLinkFlyout");this.jed.set("GraphicsEditor","");this.Xxj();this.Ub(this.ga)}vBn(b,h){const t=Date.now();this.ZHe&&1250>t-this.ZHe||this.Zub||(this.ZHe=t,this.brb=b,this.Jtd=this.o6l(h),this.w_n(),this.PYn())}xD(b,h){if(b.annotationType===mp.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===kd.a.getTypeName()&&(h=Date.now(),b=b.content,this.Zub&&this.Zub===b.correlationId)){window.clearTimeout(this.Isa);this.Zub=void 0;var t=this.cYb,A=this.XVl(b),O=A&&0<A.length;
O&&(this.wPo(A),this.Ywd&&(t=!1));t&&this.K6i();h={["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:b.correlationId,["requestPreparationTime"]:this.k$g,["canvasContextRetrievalTime"]:this.uKg,["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,["latencyMs"]:h-this.l$g,["containsZTM"]:O,["shouldFallBack"]:this.cYb,["fallBack"]:t};u.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}XVl(b){const h=this.getSuggestions(b.intentSuggestions,
mp.IntentIds.ZeroTermMenu,mp.ObjectSemantic.GenericSuggestions,mp.ObjectSchemaType.RankedSuggestion);return 1===h.length?h[0]:b.menuSuggestions}getSuggestions(b,h,t,A){return Array.isArray(b)?b.filter(O=>O.intent===h&&O.result.semantic===t&&O.result.type===A).map(O=>O.result.value):[]}Ub(b){b.gb(ab.a.TCi,mc.a.application,this.QYn.bind(this),96)}o6l(b){const h=[],t=new Map,A=Date.now();for(const O of b){if(!O)continue;b=[];const aa={itemsMetadata:new xb.a};for(let ua=0;ua<O.ControlList.length;ua++){const Ra=
O.ControlList[ua];if(Ra&&!Ra.ExternalId)continue;b.push(Ra.ExternalId);const ub={timeStamp:A,source:"FallbackZeroTermMenu",confidenceScore:-1};aa.itemsMetadata[Ra.ExternalId]=ub;t.set(Ra.ExternalId,ub)}h.push(appChrome.api.menuSection(b,O.Title,O.Lang,O.Id,aa))}return{sections:h,commands:t}}xuj(b){return this.jed.has(b)?this.jed.get(b):b}lIa(b){const h={};for(const t of b)b=this.xuj(t.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));Jb.App.ya.NLd(h)}mzm(b){return!appChrome.selectors.isControlDefined(b)||
appChrome.selectors.isControlDisabled(b)?!1:this.JVj.has(b)?this.Jtd.commands.has(b):!0}NJh(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.brb})}hgb(b=!1){b=b?Wn.a.instance.Qrc:Wn.a.instance.hgb();const h=[],t=Date.now();for(const A of b)A.commandId&&h.push({Id:A.commandId,TimeElapsedSinceClick:(t-A.timeStamp)/1E3,ContentType:A.contentType,CommandSurface:A.commandSurface,InputMethod:A.ux});return h}qMc(){const b=Wn.a.instance.qMc(),h=[],t=Date.now();
for(const A of b)A.controlId&&h.push({Id:A.controlId,TimeElapsedSinceClick:(t-A.timeStamp)/1E3,ContentType:A.contentType,CommandSurface:A.commandSurface,InputMethod:A.ux});return h}Nlf(){const b={semantic:mp.ObjectSemantic.CanvasContext,type:mp.ObjectSchemaType.WordCanvasContext,value:{contentType:this.brb}};if(this.ORj){const h=Date.now(),t=this.Uhk.Nlf(he.a.instance.hb.lb);t&&t.value.contentType&&(b.value=t.value);this.uKg=Date.now()-h}return b}R2h(){const b=this.qMc(),h=this.hgb(),t=this.hgb(!0),
A=[];A.push({semantic:mp.ObjectSemantic.ControlIdHistory,type:mp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:mp.SequenceType.ControlId,Sequence:b}});A.push({semantic:mp.ObjectSemantic.CommandIdHistory,type:mp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:mp.SequenceType.CommandId,Sequence:h}});A.push({semantic:mp.ObjectSemantic.FilteredCommandIdHistory,type:mp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:mp.SequenceType.CommandId,Sequence:t}});A.push(this.Nlf());
return A}Xxj(){this._augLoopRuntimeManager.getSession().then(b=>this.fdd=b).catch(()=>{this.fdd=void 0})}PYn(){const b=Date.now(),h=this.R2h(),t=[mp.IntentIds.ZeroTermMenu,mp.IntentIds.Logging];this.k$g=Date.now()-b;this.fqj(t,h,"ContextualMenu")}QYn(b,h,t){2===t&&(b=this.R2h(),this.fqj([mp.IntentIds.Logging],b,"Floatie"));return 32}fqj(b,h,t){if(0===b.length||0===h.length)u.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var A=new mp.SearchSuggestionSignal({correlationId:this.GKl(),
intents:b,contextObjects:h,entryPoint:t});this.cYb=0<=b.indexOf(mp.IntentIds.ZeroTermMenu);this.l$g=Date.now();this.Zub=A.correlationId;this.Isa=window.setTimeout(()=>{this.jmn(A.correlationId)},750);h=new kd.l({parentPath:["Signal",mp.SearchSuggestionSignal.getTypeName()],items:[{id:Ya.a.create().toString(),body:A}]});this.fdd&&!this.fdd.isClosed?this.fdd.submitOperation(h):(this._augLoopRuntimeManager.submitOperation({operation:h}),this.Xxj());u.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",
["correlationId"]:A.correlationId,["shouldFallBack"]:this.cYb,["intents"]:b}))}}GKl(){const b=Ya.a.create().toString();appChrome.api.setOfeCorrelationId("ACM",b);return b}jmn(b){this.Zub&&this.Zub===b&&(this.Zub=void 0,this.cYb&&this.K6i(),u.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.cYb})))}K6i(){const b=this.NJh(this.Jtd.sections);appChrome.api.dispatch(b);this.fDh()}fDh(){this.Ywd=
!0}JSn(b){var h,t;const A=[],O=new Map;if(!b||0===b.length)return A;for(const aa of b){if(!aa||!aa.controlIds||0===aa.controlIds.length)continue;b={controlIds:[],id:aa.id,title:aa.title,lang:aa.lang,data:{itemsMetadata:new xb.a}};const ua="CommandsZTM"===aa.id;for(const Ra of aa.controlIds){if(O.has(Ra))continue;if(ua&&b.controlIds.length>=this.Y4j)break;const ub=null===(t=null===(h=aa.data)||void 0===h?void 0:h.itemsMetadata)||void 0===t?void 0:t[Ra];O.set(Ra,ub);b.controlIds.push(Ra);ub&&(b.data.itemsMetadata[Ra]=
ub)}0<b.controlIds.length&&A.push(b)}return A}w_n(){this.Ywd=!1;if(this.P0j){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}wPo(b){this.Ywd||(b=this.RCl(b),0<b.length&&appChrome.api.dispatch(b))}RCl(b){const h=[];let t=[];var A=this.g0l();A&&0<A.length&&t.push(...A);(A=this.MBl())&&t.push(A);Array.isArray(b)&&0<b.length&&(b=this.Vta(b))&&(b.id="CommandsZTM",t.push(b));(b=
this.CBl())&&t.push(b);t=this.JSn(t);if(0===t.length)return[];h.push(this.NJh(t));this.fDh();return h}g0l(){var b,h;const t=null===(b=this.Jtd)||void 0===b?void 0:b.sections.filter(A=>{var O;return null===(O=A.id)||void 0===O?void 0:O.startsWith(xp.HQh)});for(const A of t)if(null===(h=A.data)||void 0===h?0:h.itemsMetadata)for(const O in A.data.itemsMetadata)A.data.itemsMetadata[O].source="PassThroughZeroTermMenu";return t}MBl(){const b=this.RZh(this.sUj,"DefaultZeroTermMenu");return this.Vta(b)}CBl(){const b=
this.RZh(this.FOj,"AdvertizedZeroTermMenu");return this.Vta(b)}RZh(b,h){const t=[];for(const A of b)A&&this.omo(A)&&this.Jtd.commands.has(A.id)&&t.push({suggestion:A.id,rankingScore:-1,suggestionSource:h});return t}omo(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}Vta(b){const h=[],t={itemsMetadata:new xb.a},A=Date.now();this.lIa(b);for(const O of b)b=this.xuj(O.suggestion),this.mzm(b)&&(h.push(b),t.itemsMetadata[b]={timeStamp:A,source:O.suggestionSource,
confidenceScore:O.rankingScore});return 0<h.length?appChrome.api.menuSection(h,null,null,null,t):null}}Object(m.a)(Ot,"AugLoopSearchSuggestionManager",null,[126,127]);class IB{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}yc(b){this.W=b;this.W.ha("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new Ot(v.AFrameworkApplication.xa,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>
{$q.a.Bl().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){P.a.instance.Gc(new IB)}}Object(m.a)(IB,"PackageManager",null,[1,2]);var UC=c(338),ot=c(955);class JB extends ot.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(m.a)(JB,"BootMessage",ot.a,[]);var VC=c(1047);class KB{constructor(){this.$G=null;this.Ujn=b=>{if(b.target===this.$G)if(void 0===b.data||null===b.data)u.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=E.a(b.data);this.xie(h.api)?this.Pcd.J(h.api).xcc(h.method,h):u.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){u.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.Pcd=new Kh.a}REf(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",
!1)}create(b,h){let t=!1;try{this.$G=new Worker(b);this.$G.onmessage=this.Ujn;const A=Object.assign(new JB,{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(A);this.REf()&&VC.a.mNj(this.$G);t=!0}catch(A){u.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",A)}return t}postMessage(b){try{const h=E.c(b);this.$G.postMessage(h)}catch(h){u.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}xie(b){return this.Pcd.ob(b)}xjk(b,
h){this.xie(b)&&u.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",b);this.Pcd.Z(b,h)}bFl(b){return this.xie(b)?this.Pcd.J(b):null}}Object(m.a)(KB,"WebWorker",null,[71]);class Cz{constructor(){this.omg=[]}S8k(b,h){if(h){var t=v.AFrameworkApplication.qy(b.bbj,7),A=[];for(let O=0;O<b.qOb.length;O++){let aa;switch(b.qOb[O].format){case 5:case 6:aa=UC.a.bhb(b.qOb[O].name);break;default:aa=b.qOb[O].name}A.push(v.AFrameworkApplication.qy(aa,
b.qOb[O].format))}try{const O=URL.createObjectURL(new Blob(["importScripts('"+t+"');"],{type:"application/javascript"})),aa=new KB;if(aa.create(O,A))for(this.omg.push(aa),t=0;t<b.wie.length;t++){const ua=h.B1k(aa,b.wie[t]);ua&&aa.xjk(b.wie[t],ua)}}catch(O){u.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",O.message)}}else u.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(m.a)(Cz,"WebWorkerCollection",null,
[]);class ux{constructor(b,h){this.FVe=new Cz;if(b){b=b.create();for(let t=0;t<b.length;t++)this.FVe.S8k(b[t],h)}else u.ULS.sendTraceTag(50442779,3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...t){let A=!1;for(let aa=0;aa<this.FVe.omg.length;aa++){var O=this.FVe.omg[aa];O.xie(b)&&((O=O.bFl(b))?A=O.KP(h,t)||A:u.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}A||u.ULS.sendTraceTag(50442781,
3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(m.a)(ux,"WebWorkerRouter",null,[20]);class $v{constructor(){this.D=this.ST=0}}Object(m.a)($v,"LongTaskInfo",null,[]);class eo{constructor(b,h){this.xVe=null;this.i2m=t=>{if(t){var A=[];for(const O of t.getEntries())O.duration>=this.UXo&&(t=new $v,t.ST=O.startTime,t.D=Math.round(O.duration),A.push(t));if(0<A.length){let O;(O=this.GP).sendMessage.apply(O,[1,3].concat(A))}}};
b.fR(this.i2m);this.GP=h}get UXo(){null==this.xVe&&(this.xVe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.pc("WordHangDetectionHangThresholdTime",2E3):2E3);return this.xVe}}Object(m.a)(eo,"HangDetector",null,[]);class aw{constructor(){this.M7g=null;this.wvm=b=>{for(const h of this.Jx)h(b)};this.Jx=[];this.gWb=0}fR(b){this.gWb||this.Pcn();1===this.gWb&&this.Jx.push(b)}h2m(){return!!window.PerformanceObserver&&!!window.PerformanceLongTaskTiming&&!!PerformanceObserver.supportedEntryTypes&&-1!==
Array.indexOf(PerformanceObserver.supportedEntryTypes,"longtask")}Pcn(){if(!this.gWb)if(this.h2m())try{this.M7g=new PerformanceObserver(this.wvm),this.M7g.observe({type:"longtask"}),this.gWb=1}catch(b){this.gWb=2,u.ULS.sendTraceTag(592479427,3008,10,"Failed to create PerformanceObserver with message {0}",b.message)}else this.gWb=2}}Object(m.a)(aw,"LongTaskListeners",null,[386]);class uC extends ot.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=
this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(m.a)(uC,"SettingsMessage",ot.a,[]);class Iw{constructor(b){this.$G=b}}Object(m.a)(Iw,"WebWorkerApiMain",null,[]);class RD extends Iw{constructor(b){super(b)}REf(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}KP(b,h){if(!h)return u.ULS.sendTraceTag(591972375,
3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.NKk(h);u.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",b);return!1}xcc(b,h){switch(b){case 14:this.gfm(h);break;default:u.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}NKk(b){if(2!==b.length)return u.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",
b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return u.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}","object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new uC,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:v.AFrameworkApplication.userSessionId,LocalCobaltSessionId:tn.a.instance.PQ,LocalCobaltMachineId:tn.a.instance.YHb,
LocalCobaltClusterId:tn.a.instance.Nbc,LocalCobaltSessionHasBackup:tn.a.instance.xwa,WaciiEnabledRequests:tn.a.instance.yqa,SettingsRoutedToServer:tn.a.instance.i$f,WacClusterId:v.AFrameworkApplication.Ke.c5});this.$G.postMessage(b);return!0}gfm(b){this.REf()&&b&&b.result&&(u.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.BTo())}BTo(){Object(Rl.__awaiter)(this,void 0,void 0,function*(){try{const b=yield new VC.a.nNj.WorkerUtilsTestClass(10);yield b.Ch(5);15==(yield b.counter)?
u.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):u.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){u.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}})}}Object(m.a)(RD,"InitializeWorkerApiMain",Iw,[]);class yE extends ot.a{constructor(){super();this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=0;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(m.a)(yE,"CatchUpNetworkRequestWorkerRequestMessage",
ot.a,[]);class zE extends Iw{constructor(b,h){super(b);this.JEc=h}KP(b,h){if(4===b)return b=Object.assign(new yE,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.$G.postMessage(b),!0;u.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",b);return!1}xcc(b,h){switch(b){case 5:u.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.JEc.i$n(h);
break;default:u.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(m.a)(zE,"CatchUpNetworkRequestWorkerExternalApi",Iw,[]);class AE extends ot.a{constructor(){super();this.taskInfo=null}}Object(m.a)(AE,"HangDetectionMessage",ot.a,[]);class Wu extends ot.a{constructor(){super();this.taskInfo=null}}Object(m.a)(Wu,"ReportLongTasksMessage",ot.a,[]);class Zs extends Iw{constructor(b){super(b)}KP(b,h){if(!h)return u.ULS.sendTraceTag(591972370,
3008,10,"HangDetectionWorkerApiMain: HangDetection called with a null methodParams value."),!1;switch(b){case 2:return this.MKk(h);case 3:return this.xYn(h);default:return u.ULS.sendTraceTag(591972371,3008,10,"HangDetectionWorkerApiMain: Unknown method called.  MethodId: {0}",b),!1}}xcc(b){u.ULS.sendTraceTag(591972372,3007,10,"HangDetectionWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}MKk(b){if(1!==b.length||"object"!==typeof b[0])return u.ULS.sendTraceTag(591972373,
3008,10,"HangDetectionWorkerApiMain: HangDetection called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=Object.assign(new AE,{api:1,method:2,taskInfo:b[0]});this.$G.postMessage(b);return!0}xYn(b){if(!b.length||!Object(hc.a)($v,b[0]))return u.ULS.sendTraceTag(591972374,3008,10,"HangDetectionWorkerApiMain: ReportLongTasks called with incorrect parameters. Params length is {0}, Param[0] is LongTaskInfo is {1}",b.length,0<b.length?Object(hc.a)($v,
b[0]):!1),!1;b=Object.assign(new Wu,{api:1,method:3,taskInfo:b});this.$G.postMessage(b);return!0}}Object(m.a)(Zs,"HangDetectionWorkerApiMain",Iw,[]);class Uq extends ot.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=null}}Object(m.a)(Uq,"LocalInferenceMessage",ot.a,[]);class AA{constructor(){this.prediction=this.context=null}}Object(m.a)(AA,"LocalInferenceOutput",null,[]);class yv{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=
null}}Object(m.a)(yv,"TextPredictionConfig",null,[]);class Cp{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(m.a)(Cp,"TextPredictionSettings",null,[]);class rF{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(m.a)(rF,"TextPredictionDynamicPayload",null,[]);class BE extends Iw{constructor(b,h){super(b);this.bik=h}KP(b,h){if(!h)return u.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),
!1;switch(b){case 8:return this.TKk(h);case 7:return this.OKk(h);case 9:return this.SKk(h);case 10:return this.PKk(h);case 13:return this.QKk(h);case 14:return this.RKk(h);default:return u.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",b),!1}}xcc(b,h){switch(b){case 9:this.kgm(h);break;default:u.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}kgm(b){b&&b.prediction&&
(b=Object.assign(new AA,{prediction:b.prediction,context:b.context}),this.bik.esh().FBn(b))}OKk(b){if(1>b.length)return u.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Uq,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.$G.postMessage(b);return!0}TKk(b){if(1>b.length)return u.ULS.sendTraceTag(575959824,
3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Uq,{api:4,method:8,paragraphContent:b});this.$G.postMessage(b);return!0}SKk(b){if(2>b.length)return u.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===
typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new Uq,{api:4,method:9,paragraphContent:b,context:h});this.$G.postMessage(h);return!0}PKk(b){if(1>b.length)return u.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Uq,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.$G.postMessage(b);return!0}QKk(b){if(1>b.length)return u.ULS.sendTraceTag(556827920,
3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Uq,{api:4,method:13,textPredictionConfig:this.$3h(b)});this.$G.postMessage(b);return!0}RKk(b){if(1>b.length)return u.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(hc.a)(Object,
b[0])),!1;b=b[0];b=Object.assign(new Uq,{api:4,method:14,textPredictionConfig:this.$3h(b)});this.$G.postMessage(b);return!0}getConfig(b=null){return Object.assign(new yv,{scriptDirectory:v.AFrameworkApplication.I4+"/intelligence/",settings:Object.assign(new Cp,{extendedRankLimit:0}),modelFilesUrl:b})}$3h(b=null){return Object.assign(new yv,{scriptDirectory:v.AFrameworkApplication.I4+"/intelligence/",settings:Object.assign(new Cp,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}
Object(m.a)(BE,"LocalInferenceWorkerApiMain",Iw,[]);class CE extends Iw{constructor(b){super(b);v.AFrameworkApplication.uJ(()=>{this.LYc()})}KP(b){u.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}xcc(b){u.ULS.sendTraceTag(591689870,3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}LYc(){const b=Object.assign(new ot.a,{api:3,method:6});this.$G.postMessage(b)}}Object(m.a)(CE,
"ShutdownWorkerApiMain",Iw,[]);var sF=c(872),DE=c(613);class EE extends ot.a{constructor(){super();this.args=null;this.numLogs=0}}Object(m.a)(EE,"UlsWorkerMessage",ot.a,[]);var SD=c(862),LB=c(1002),Pt=c(1064);class FE extends LB.a{constructor(b,h,t,A,O){super(b,h,t,A,O);this.cIe=null;this.SPe=!1;if(this.$Zg=this.tEf())if(b=A.kb("ContentBaseUrl")?6:5,A=A.kb("AppScriptBaseName"))A=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerScriptName",A+".{0}ulsworker.js"),
A=UC.a.bhb(A),A=v.AFrameworkApplication.qy(A,b),SD.createWorker({createMode:"Thread"},{local:SD.paramInsideDef(Pt.ulsWorkerInsideInit),VBo:SD.paramInsideDef(Object(Pt.ulsWorkerInsideScript)(A))}).then(aa=>{aa.onClose=()=>{this.WTe=void 0};this.WTe=aa},aa=>{var ua=new Date;aa=`UlsWorkerDefererHost threw an error: ${this.J7m(aa)}`;console.error(aa);ua=new DE.a(ua.getTime(),3007,545653664,10,aa,0,!1,null,null);super.nX(ua);this.SPe=!0})}tEf(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",
!1)}get S7m(){this.cIe||(this.cIe=Sa.a.instance.resolve("Box4.Workers.IWebWorkerRouter"));return this.cIe}rDa(b){this.SPe=b}nX(b){if(this.SPe)super.nX(b);else if(this.$Zg)null!=this.WTe&&this.WTe.call.nX(b);else{let h;(h=this.S7m).sendMessage.apply(h,[5,11].concat([b]))}}J7m(b){if(null==b||"object"!==typeof b)return"unknown";const h=String(b.name),t=String(b.message);return null!=b.stack?(b=String(b.stack),0<=b.indexOf(t)&&0<=b.indexOf(h)?b:`${h}: ${t}\n${b}`):0<=t.indexOf(h)?t:`${h}: ${t}`}}Object(m.a)(FE,
"UlsWorkerDefererHost",LB.a,[]);class GE extends Iw{constructor(b){super(b);this.x4g=0;b=Sa.a.instance.Ma("Common.IRefreshableAppSettings");this.kZb=new FE(sF.a.DGd,!0,v.AFrameworkApplication.Ke,null!==b&&void 0!==b?b:v.AFrameworkApplication.K,b);b=u.ULS.host;null!=b&&b.$7b(this.kZb);u.ULS.Dnb(this.kZb);this.J_g=ff.a.Ue();this.Wdk=2*v.AFrameworkApplication.K.pc("UlsWorkerStayAliveIntervalMS",6E4);this.kZb.rDa(!0)}KP(b,h){if(11!==b||!h||1!==h.length||!Object(hc.a)(DE.a,h[0]))return!1;if(ff.a.Ue()-
this.J_g>this.Wdk)return this.kZb.rDa(!0),this.kZb.nX(h[0]),u.ULS.sendTraceTag(570770058,3008,15,"UlsWorkerApiMain: Haven't heard from UlsWorkerApi recently"),!1;b=Object.assign(new EE,{api:5,method:b,args:h[0],numLogs:this.x4g});this.x4g++;this.$G.postMessage(b);return!0}xcc(b,h){void 0!==h&&null!==h&&12===b&&(this.J_g=ff.a.Ue(),this.kZb.rDa(!1))}}Object(m.a)(GE,"UlsWorkerApiMain",Iw,[]);class HE{constructor(b){this.container=b}B1k(b,h){var t=null;switch(h){case 0:t=new RD(b);break;case 1:t=new Zs(b);
break;case 2:t=new zE(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:t=new CE(b);break;case 4:t=new BE(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));break;case 5:h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsWorkerIsEnabled",!1);t=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1);t=(h||t)&&v.AFrameworkApplication.MAd?new GE(b):
null;break;default:u.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",h)}return t}}Object(m.a)(HE,"WordWebWorkerApiFactory",null,[385]);var TD=c(261);class vC{constructor(b,h){this.name=b;this.format=h}}Object(m.a)(vC,"ImportedScript",null,[]);class UD{constructor(){this.wie=this.qOb=this.bbj=null}}Object(m.a)(UD,"WebWorkerConfig",null,[]);var tF=c(1439);class IE{constructor(b){this.KRe=[];this.T1j=b;if(v.AFrameworkApplication.K){b=
v.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||v.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const h=v.AFrameworkApplication.K.kb("ContentBaseUrl")?6:5,t=v.AFrameworkApplication.K.kb("AppScriptBaseName"),A=b?"":".";if(t){const O=b?"":"{0}",aa=t+`${A}${O}worker.js`;this.KRe.push(new vC(`MicrosoftAjax${b?"":"DS"}.${O}js`,h),new vC(aa,h));this.tEf()&&this.KRe.push(new vC(t+`${A}${O}ulsworker.js`,h))}else u.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else u.ULS.sendTraceTag(558465107,
3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=[],h=Object.assign(new UD,{bbj:"workerboot",qOb:this.KRe,wie:[0,1,2,3,4,5]});this.T1j&&this.qBm()&&h.qOb.push(new vC("intelligence/edge-inference-web.js",5));b.push(h);return b}qBm(){return(new TD.a("arrowFunction",()=>{try{Object(tF.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}tEf(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",
!1)}}Object(m.a)(IE,"WordWebWorkerConfigFactory",null,[125]);class Oy{constructor(){this.Na=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");b.sendMessage.apply(b,[0,1].concat([this.Na.appSettings,v.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}yc(b){this.W=b;this.Na=this.W.resolve("Common.IAppSettingsManager");const h=this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ha("Box4.Workers.WebWorkerRouter",
()=>new ux(new IE(h),new HE(b))).as("Box4.Workers.IWebWorkerRouter").singleInstance();b.ha("WordEditor.Workers.LongTaskListeners",()=>new aw).as("WordEditor.Workers.ILongTaskListeners").singleInstance();b.ha("WordEditor.Workers.HangDetector",()=>new eo(b.resolve("WordEditor.Workers.ILongTaskListeners"),b.resolve("Box4.Workers.IWebWorkerRouter"))).singleInstance()}static main(){P.a.instance.Gc(new Oy)}}Object(m.a)(Oy,"WordEditorWorkersPackage",null,[1,2]);var BA=c(1174);class zv{constructor(){this.Erd=
[]}lbi(b,h){let t=-1,A=null;A=O=>{O?h(this.Erd[t]):(++t,t<this.Erd.length?this.Erd[t].d1b(b,A):h(null))};A(!1)}d1b(b,h){this.lbi(b,t=>{h(!!t)})}pgc(b,h,t){this.lbi(b,A=>{if(!A)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");A.pgc(b,h,t)})}plh(b){this.Erd.push(b)}}Object(m.a)(zv,"CompositeExternalContentURLResolver",null,[128,129]);var MB=c(1433);class CA extends MB.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=
0;this.ProviderName=this.IFrameHtml=null}}Object(m.a)(CA,"ExternalContentEmbedResponse",MB.a,[]);var Py=c(1448),NB=c(1827),Zj=c(1826),JE=c(1354),KE=c(721),OB=c(528),DA=c(182),jD=c(863),dy;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.externalComponentPaste=1]="externalComponentPaste";b[b.externalHyperlinkPaste=2]="externalHyperlinkPaste";b[b.K8o=3]="externalContentFloatieConversion"})(dy||(dy={}));Object(m.b)("ExternalContentConversionContext",dy);class xh{constructor(){this.AHb=this.zHb=null;
this.Sgf=new JE.ExternalContentEmbedRetriever;this.Rzc=!0;this.Drc=this.fo=this.Aki=this.zki=this.Nl=this.Ap=null;this.picturePasteRequestSucceeded=()=>{u.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.Mec=()=>{u.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=xh.nma&&xh.nma.T2h()}get yNb(){return this.Rzc}set yNb(b){this.Rzc=b}B3e(b,h){let t=!1;if(b){switch(b.contextId){case mc.a.Vc:t=!h;break;case mc.a.Fd:t=
!0}t&&!jD.a(b.node)&&(t=!1)}return t}OMm(b){const h=b.startsWith(Ge.HyperlinkReader.pfc),t=b.startsWith(Ge.HyperlinkReader.R0c),A=b.startsWith(Ge.HyperlinkReader.R9d);return(h||t||A)&&Ge.HyperlinkReader.I2a(b)}t0i(){this.fo=W.a.create();xh.vf.oAb(this.fo,4);xh.vf.f4(this.fo,0,xh.vf.un());this.zFb(this.zHb,3,this.AHb,!0)}ePa(b,h,t){this.fo=W.a.create();xh.vf.oAb(this.fo,t?0:2);xh.vf.f4(this.fo,0,xh.vf.un());this.Drc();this.zFb(b,t?0:2,h)}d8d(b,h){this.fo=W.a.create();xh.vf.oAb(this.fo,1);xh.vf.f4(this.fo,
0,xh.vf.un());this.zFb(b,1,h)}RUd(b,h,t,A){if(!b||!b.isConnected||!Be.ImageReader.Wu(b))return null;const O=new KE.a;O.setValue(fh.a.E8b,t);O.setValue(fh.a.ZOa,h);O.pZa=this.zki;O.zw=this.Aki;O.providerName=A;O.K2a=1===t;ue.GraphIterator.$a(b).Qf(O,2);this.aXc(O);return O}r2i(b){this.Drc=b}jpe(b,h){const t=xh.q0.I3b(h)||0;h=xh.q0.WZa(h)||0;const A=b.Width/b.Height;1<=A?(b.Width=t,b.Height=t/A):(b.Height=h,b.Width=h/A)}sog(b,h,t){if(null!=b&&null!=h&&!F.a.mf(t)){var A=xh.xYc.Y6b(t);v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",!1)?A.Opa=!1:A.Opa=!0;A.hideFloatie=!0;this.jpe(b,h.node);this.f9b(b,h,!1,!1,A,t)}}ahb(b){return b?b.Ve:0}Hkg(b,h,t){let A=null;const O=b.node;if(!qe.ParagraphReader.Yb(O)||!O.isConnected)return{returnValue:!1,tqa:A};if(t)return{returnValue:!0,tqa:b};t=b.cpBegin;const aa=b.cpEnd,ua=qe.ParagraphReader.text(O);if(0<=t&&aa<=ua.length&&ua.substring(t,aa)===h)return{returnValue:!0,
tqa:b};const Ra=ua.indexOf(h);return 0<=Ra?(A=pf.a.createTextRange(O,Ra,Ra+h.length),{returnValue:!0,tqa:A}):0<=t&&aa<=ua.length&&this.j8b(b)?{returnValue:!0,tqa:b}:{returnValue:!1,tqa:A}}j8b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=pf.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Ge.HyperlinkReader.rD(h,!1);if(1===h.length){h=h[0];const t=qe.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==t)return!0}return!1}GEf(b){return null==b.width&&
null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}P6a(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const t=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");t&&t.execute(A=>{A.logActivity(b,h)})},xh.VCa)}ynf(b,h){const t=!F.a.Y6(h);switch(b){case 1:b=t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:b=t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}zFb(b,h,t,A=!1){if(this.OMm(t)){var O=xh.xYc.Y6b(t);if(O)if(this.GEf(O)){u.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(Da.a)(pf.a,b);var aa=!h;this.B3e(b,aa)?this.HSc(t)?(h=1===h,A=this.EPl(b),O.hideFloatie=!0,this.f9b(A,
b,aa,h,O,t)):this.tXf(b,h,O,t,A):xh.vf.hQ(this.fo,2,"URL inserted in Non-Embedable context",xh.vf.un())}else u.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),xh.vf.hQ(this.fo,2,"Size provided is not valid for OEmbed",xh.vf.un())}else u.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),xh.vf.hQ(this.fo,2,"URL inserted is not valid for ExternalContent",xh.vf.un())}EPl(b){const h=new CA;h.Width=
xh.q0.I3b(b.node)||0;h.Height=xh.q0.WZa(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}HSc(b){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=xh.Sga&&xh.Sga.Kxi(b)}tXf(b,h,t,A,O){const aa=!h,ua=1===h,Ra=xh.q0.I3b(b.node)||0,ub=xh.q0.WZa(b.node)||0,Nb=Py.a.i7e(t.$jg,!0,Ra,ub);this.EWc(b,A,h,!0);this.Sgf.Xyh(Nb,Yb=>{xh.vf.f4(this.fo,4,xh.vf.un());xh.vf.v5c(this.fo,this.ahb(Yb.data));if(Yb=this.zXf(Yb)){u.ULS.sendTraceTag(592307859,
324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var bc=DA.r(Yb.MediaType);xh.vf.Fae(this.fo,7,bc);bc=b;({tqa:bc}=this.Hkg(b,A,ua)).returnValue?(this.EWc(bc,A,h,!1),null==t.width?0<Ra&&Yb.Width>Ra&&(u.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Yb.Width=Ra):(u.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),
Yb.Width=this.had(t.width,Yb.Width,Ra)),null==t.height?0<ub&&Yb.Height>ub&&(u.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Yb.Height=ub):(u.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Yb.Height=this.had(t.height,Yb.Height,ub)),xh.nma.$8a||O?this.f9b(Yb,bc,aa,ua,t,A):(this.zHb=b,this.AHb=A,this.WGc(A))):(u.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
xh.vf.hQ(this.fo,2,"No conversion as the context is no longer valid for the external content conversion",xh.vf.un()));ua&&this.bZa(bc.node)}else ua&&this.bZa(b.node),xh.vf.hQ(this.fo,1,"URL not oEmbedable",xh.vf.un())},Yb=>{xh.vf.f4(this.fo,4,xh.vf.un());xh.vf.v5c(this.fo,this.ahb(Yb.data));ua&&this.bZa(b.node);u.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Yb.data.we);xh.vf.hQ(this.fo,2,"ExternalContentEmbedRequest failed",xh.vf.un())},Yb=>{ua&&this.bZa(b.node);
u.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Yb)},this.fo)}had(b,h,t){!b&&0<t&&h>t||b>t?(u.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=t):b>t?h=t:b&&b<t&&(h=b);return h}f9b(b,h,t,A,O,aa){this.Nl=Ya.a.create();b.Width=b.Width/b.Height*(b.Height-(OB.a.PPc+OB.a.E2))+2*OB.a.E2;const ua=new Te.GraphTransaction(15);ua.Eb(h.node);ua.kk=Vc.a.ePa;const Ra=this.j8b(h);null!=O.Opa&&!O.Opa||
A||Ra||(b.Title=""===O.title||O.title?O.title:b.Title,!b.Title&&""!==b.Title)||(h=this.pyf(h,ua,b.Title,aa,t));if(h){A&&(h=this.nbf(h));var ub=this.tFd(h,A);if(ub){t=DA.r(b.MediaType);var Nb=this.$Pd(b,t);this.zki=b.IFrameHtml;this.Aki=b.Title;if(ub=this.Yxf(ub,Nb,ua,A,aa,t,b.ProviderName))ua.zFa(this.Nl,1),ua.dispose(),this.zHb=h,this.AHb=aa,this.pUf(O,b,ub),this.gXf(aa,A||O.hideFloatie,Ra,t,b.Title)}else ua.dispose(),u.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),
xh.vf.hQ(this.fo,2,"Could not create IP context on splitting the paragraph",xh.vf.un())}else xh.vf.hQ(this.fo,2,"GraphNodeContext is null",xh.vf.un())}$Pd(b,h){const t=new ji.DictionaryPropertySet;xh.mO.g9d(t,b.Width,b.Height);b=this.xnf(h,b.Title);t.setValue(Af.a.imageAltText,b);t.setValue(Lc.a.WT,Nf.a.aF());t.setValue(Lc.a.imageType,0);return t}Yxf(b,h,t,A,O,aa,ua){if(!b)return null;b=xh.mO.WUd(b,h);if(!b)return t.dispose(),u.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),
xh.vf.hQ(this.fo,2,"The anchored image could not be inserted",xh.vf.un()),null;t=b.node;O=this.RUd(t,O,aa,ua);xh.vf.djg(this.fo,O.id);A||this.i8f(t);return t}pUf(b,h,t){F.a.Y6(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(xh.vf.f4(this.fo,8,xh.vf.un()),u.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.KHd(t,h.Thumbnail))}gXf(b,h,t,A,O){h||this.WGc(b);this.P6a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");
this.k7d("IsHyperlinkWithNonURLDisplayText",t);this.ariaNotify(A,O);xh.vf.f4(this.fo,5,xh.vf.un())}k7d(b,h){u.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");ja.a.sendTelemetryEvent(Object.assign(new ta.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new sa.a,{name:b,bool:h})]}))}ariaNotify(b,h){this.yNb&&xh.lu&&(b=this.ynf(b,h),xh.lu.sendNotification(b,!0))}pyf(b,h,t,A,O){if(O){if((O=Ge.HyperlinkReader.rD(b,
!1))&&1!==O.length)return h.dispose(),u.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;xh.hyperlinkEditor.iR(O[0].paragraph,O[0].hyperlink)}return this.z3f(b,t,A)}nbf(b){const h=b.node,t=qe.ParagraphReader.text(h);return 0<t.length&&!t.trim().length?(b=pf.a.createTextRange(h,0,t.length),xh.characterPropertiesEditor.replaceTextRange(b,""),pf.a.Tc(h,0)):b}tFd(b,h){return h?b:this.vof(b)}vof(b){const h=qe.ParagraphReader.text(b.node),
t=ue.GraphIterator.$a(b.node);if(t.yd()){b=pf.a.Tc(b.node,b.cpEnd);wg.OutlineElementNavigator.Zd(t);const A=xh.vg.tna(t);xh.Hh.p9(t,A,b,!0,!0,!0,!0);""!=h&&xh.Hh.uC(t,!1,!0);t.Sd();return pf.a.Tc(t.currentNode,0)}return null}zXf(b){if(!({group:b}=sl.a.H0(b.data.we)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}z3f(b,h,t){const A=b.cpBegin+h.length;xh.characterPropertiesEditor.replaceTextRange(b,h);b=pf.a.createTextRange(b.node,b.cpBegin,A);xh.hyperlinkEditor.jH(b,t,!1);return b}xnf(b,
h){const t=!F.a.Y6(h);switch(b){case 1:return t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}KHd(b,h){b.Ei().contentReplicator.forceOutbound(()=>{this.xXf(h,b)},()=>{u.ULS.sendTraceTag(592996173,
324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}aXc(b){b=ue.GraphIterator.$a(b);b.Ab(12);b.fd(12);b.Kn.UP=!0}bZa(b){b.Hec=null}i8f(b){b=ue.GraphIterator.$a(b);b.Ab(11)&&(b.fd(11),b.yd()&&b.Wj()&&b.Sd()&&qe.ParagraphReader.Yb(b.currentNode)&&(b=wf.SelectionFactory.te(b.currentNode,0),he.a.instance.setSelection(b)))}EWc(b,h,t,A){const O=b.cpBegin,aa=b.cpEnd;b=qe.ParagraphReader.text(b.node).trim();O||b!==h&&""!==b?O?aa===b.length?u.ULS.sendTraceTag(590958601,324,
50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",dy[t],A):0<O&&aa<b.length&&u.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",dy[t],A):u.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
dy[t],A):u.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",dy[t],A)}WGc(b){this.P3b();const h=new qu.a(1,v.AFrameworkApplication.isRtl);h.O_c=b;xh.Bfb.O1c(h)}P3b(){const b=new Uw.a(!0);xh.M8.yGa(b)}xXf(b,h){if(b=this.Aqf(b,h))h=Array(1),h[0]=b,b=NB.a.construct(h,!1,v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Ap.Fs:null),h=this.s$e(),
this.cnb(h,b)}Aqf(b,h){if(!h)return u.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Ap=h.Ei();(new ue.GraphIterator).set(h);if(!h.anchor||!h.anchor.Wp||!h.anchor.Wp.lr)return u.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var t=h.anchor.Wp.lr.node;if(!t)return u.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),
null;t=t.ia(Jh.a.eJ,Tn.a.nt);const A=h.getValue(Af.a.mK),O=Hc.a.ef(Be.ImageReader.sD(h.properties),0),aa=Hc.a.ef(Be.ImageReader.LI(h.properties),1);return Zj.a.construct(h.id.toString(),b,h.ia(Af.a.imageAltText,""),O,aa,h.ia(Lc.a.xX,""),t,h.ia(Lc.a.WT,0),h.ia(Lc.a.wga,!1),h.ia(Jh.a.ofa,-1),h.ia(Lc.a.ckb,Box4Intl.Box4Strings.l_Picture),h.ia(Af.a.yga,!1),A,h.ia(Lc.a.runId,1),h.ia(Lc.a.Lc,0))}cnb(b,h){v.AFrameworkApplication.Ke.oj(b,2,E.c(h),{},!1,2,this.picturePasteRequestSucceeded,this.Mec,null,void 0,
void 0,void 0,void 0,"26");u.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}s$e(){let b=ia.a.ILc("PicturePaste.ashx");v.AFrameworkApplication.K&&!v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=ia.a.Xn(b,ag.a.fileId,this.Ap.Fs));b=ia.a.Xn(b,ag.a.cellId,this.Ap.Zm.toString());this.Nl||(this.Nl=Ya.a.create(),u.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=ia.a.Xn(b,ag.a.gT,this.Nl.toString());
b=ia.a.Xn(b,ag.a.classId,(393233).toString());this.Ap.DI&&(b=ia.a.Xn(b,ag.a.DI,this.Ap.DI));b=ia.a.Xn(b,ag.a.Dpb,"1");b=ia.a.Xn(b,Bh.a.imageType,"0");b=tn.a.instance.MXe(b);this.Ap.contentReplicator&&this.Ap.contentReplicator.hHb&&(b=ia.a.Xn(b,ag.a.q1e,"1"));b=ia.a.Xn(b,ag.a.ota,this.Ap.contentReplicator.kt.toString());b=ia.a.Xn(b,ag.a.Fec,"0");return b=ia.a.Xn(b,ag.a.TPb,"1")}static get Bfb(){return null!=xh.Nug?xh.Nug:xh.Nug=Sa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get nma(){xh.Qza||
(xh.Qza=Sa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return xh.Qza}static get M8(){return null!=xh.iCg?xh.iCg:xh.iCg=Sa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get lu(){return null!=xh.Isg?xh.Isg:xh.Isg=Sa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get q0(){return null!=xh.iDg?xh.iDg:xh.iDg=Sa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get mO(){return null!=xh.Bxg?xh.Bxg:xh.Bxg=Sa.a.instance.resolve("WordEditor.IImageEditor")}static get vg(){return xh.Hh||
(xh.Hh=Sa.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hyperlinkEditor(){return null!=xh.txg?xh.txg:xh.txg=Sa.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=xh.otg?xh.otg:xh.otg=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get vf(){return null!=xh.Wug?xh.Wug:xh.Wug=Sa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get xYc(){return null!=xh.WAg?xh.WAg:xh.WAg=Sa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get Sga(){return null!=
xh.MAg?xh.MAg:xh.MAg=Sa.a.instance.resolve("Fluid.Host.LoopComponentManager")}}xh.Hh=null;xh.VCa=5E3;xh.Qza=null;Object(m.a)(xh,"ExternalContentEditor",null,[133]);var wC=c(278),LE=c(1215);class kD{constructor(b,h){this.$8a=!0;this.Z3a=t=>{if(null!=t.result)return t.result.Value;u.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.$8a};this.QFa=t=>{t.wo||t.Ai?u.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):
(this.Ovh(t.result),u.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.$8a};this.ov=b;this.cK=h}T2h(){const b=new xm.a;this.Mwi()&&this.cK?this.cK.R4a(wC.a.yGc).CWRCo(this.Z3a,0).CWRCo(this.QFa,8):b.xg(this.$8a)}O0(b){this.cK&&this.cK.O0(wC.a.yGc,new LE.a(wC.a.yGc,b))}S3n(b){this.Mwi()&&(this.ov.kia("saveConvertExternalContentIsEnabled",b.toString()),u.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),
this.Ovh(b),this.O0(b))}Mwi(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser");if(v.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)u.ULS.sendTraceTag(559437387,324,50,"User is anonymous ");else return!0;return!1}Ovh(b){this.$8a=b}}Object(m.a)(kD,"ExternalContentSettingInfo",null,[132]);var uF=c(1147);class ME{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(m.a)(ME,"FluidComponentProperties",
null,[]);class vF{constructor(){this.loopType=this.zw=this.pZa=this.url=null;this.mediaType=0;this.OEi=null}}Object(m.a)(vF,"IFrameProps",null,[]);class Sl{static get q0(){return null!=Sl.gDg?Sl.gDg:Sl.gDg=Sa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get mO(){return Sl.Nj||(Sl.Nj=Sa.a.instance.resolve("WordEditor.IImageEditor"))}static get lu(){return null!=Sl.Hsg?Sl.Hsg:Sl.Hsg=Sa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get hyperlinkEditor(){return null!=
Sl.nxg?Sl.nxg:Sl.nxg=Sa.a.instance.resolve("Box4.IHyperlinkEditor")}static get vg(){return null!=Sl.oBg?Sl.oBg:Sl.oBg=Sa.a.instance.resolve("Box4.IOutlineElementEditor")}static get characterPropertiesEditor(){return null!=Sl.mtg?Sl.mtg:Sl.mtg=Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static I2a(b){const h=b.startsWith(Ge.HyperlinkReader.pfc),t=b.startsWith(Ge.HyperlinkReader.R0c),A=b.startsWith(Ge.HyperlinkReader.R9d);return(h||t||A)&&Ge.HyperlinkReader.I2a(b)}static B3e(b,h){let t=
!1;if(b){switch(b.contextId){case mc.a.Vc:t=!h;break;case mc.a.Fd:t=!0}t&&!jD.a(b.node)&&(t=!1)}return t}static j8b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=pf.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Ge.HyperlinkReader.rD(h,!1);if(1===h.length){h=h[0];const t=qe.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==t)return!0}return!1}static xnf(b,h){const t=!F.a.Y6(h);switch(b){case 1:return t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static aXc(b){b=ue.GraphIterator.$a(b);b.Ab(12);b.fd(12);b.Kn.UP=!0}static $Pd(b,h,t,A){const O=new ji.DictionaryPropertySet;Sl.mO.g9d(O,h,b);b=Sl.xnf(A,t);O.setValue(Af.a.imageAltText,b);O.setValue(Lc.a.WT,Nf.a.aF());O.setValue(Lc.a.imageType,
0);return O}static RUd(b,h,t){if(!b||!b.isConnected||!Be.ImageReader.Wu(b))return null;const A=new KE.a;A.setValue(fh.a.E8b,h.mediaType);A.setValue(fh.a.ZOa,h.url);A.setValue(Gd.a.loopComponentType,h.loopType);A.pZa=h.pZa;A.zw=h.zw;A.providerName=t;A.K2a=1===h.mediaType;A.createMode=h.OEi;ue.GraphIterator.$a(b).Qf(A,2);Sl.aXc(A);return A}static tFd(b,h){return h?b:Sl.vof(b)}static vof(b){const h=qe.ParagraphReader.text(b.node),t=ue.GraphIterator.$a(b.node);if(t.yd()){b=pf.a.Tc(b.node,b.cpEnd);wg.OutlineElementNavigator.Zd(t);
const A=Sl.vg.tna(t);Sl.vg.p9(t,A,b,!0,!0,!0,!0);""!=h&&Sl.vg.uC(t,!1,!0);t.Sd();return pf.a.Tc(t.currentNode,0)}return null}static i8f(b){b=ue.GraphIterator.$a(b);b.Ab(11)&&(b.fd(11),b.yd()&&b.Wj()&&b.Sd()&&qe.ParagraphReader.Yb(b.currentNode)&&(b=wf.SelectionFactory.te(b.currentNode,0),he.a.instance.setSelection(b)))}static ynf(b,h){const t=!F.a.Y6(h);switch(b){case 1:b=t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:b=t?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,h){Sl.lu&&(b=Sl.ynf(b,h),Sl.lu.sendNotification(b,!0))}static k7d(b,h,t){u.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");ja.a.sendTelemetryEvent(Object.assign(new ta.a,{name:t,dataFields:[Object.assign(new sa.a,
{name:b,bool:h})]}))}}Object(m.a)(Sl,"ExternalContentHelper",null,[]);var xC=c(739);class Qy{constructor(){this.Nl=this.Ap=null}KHd(b,h,t){b.Ei().contentReplicator.forceOutbound(()=>{this.xXf(h,b,t)},()=>{u.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}xXf(b,h,t){if(b=this.Aqf(b,h))h=Array(1),h[0]=b,t=NB.a.construct(h,t,v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Ap.Fs:null),b=this.s$e(),this.cnb(b,
t)}Aqf(b,h){if(!h)return u.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Ap=h.Ei();(new ue.GraphIterator).set(h);if(!h.anchor||!h.anchor.Wp||!h.anchor.Wp.lr)return u.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var t=h.anchor.Wp.lr.node;if(!t)return u.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),
null;t=t.ia(Jh.a.eJ,Tn.a.nt);const A=h.getValue(Af.a.mK),O=Hc.a.ef(Be.ImageReader.sD(h.properties),0),aa=Hc.a.ef(Be.ImageReader.LI(h.properties),1);return Zj.a.construct(h.id.toString(),b,h.ia(Af.a.imageAltText,""),O,aa,h.ia(Lc.a.xX,""),t,h.ia(Lc.a.WT,0),h.ia(Lc.a.wga,!1),h.ia(Jh.a.ofa,-1),h.ia(Lc.a.ckb,Box4Intl.Box4Strings.l_Picture),h.ia(Af.a.yga,!1),A,h.ia(Lc.a.runId,1),h.ia(Lc.a.Lc,0))}cnb(b,h){v.AFrameworkApplication.Ke.oj(b,2,E.c(h),{},!1,2,this.picturePasteRequestSucceeded.bind(this),this.Mec.bind(this),
null,void 0,void 0,void 0,void 0,"26");u.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){u.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}Mec(){u.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}s$e(){let b=ia.a.ILc("PicturePaste.ashx");v.AFrameworkApplication.K&&!v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=ia.a.Xn(b,
ag.a.fileId,this.Ap.Fs));b=ia.a.Xn(b,ag.a.cellId,this.Ap.Zm.toString());this.Nl||(this.Nl=Ya.a.create(),u.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=ia.a.Xn(b,ag.a.gT,this.Nl.toString());b=ia.a.Xn(b,ag.a.classId,(393233).toString());this.Ap.DI&&(b=ia.a.Xn(b,ag.a.DI,this.Ap.DI));b=ia.a.Xn(b,ag.a.Dpb,"1");b=ia.a.Xn(b,Bh.a.imageType,"0");b=tn.a.instance.MXe(b);this.Ap.contentReplicator&&this.Ap.contentReplicator.hHb&&(b=ia.a.Xn(b,ag.a.q1e,"1"));
b=ia.a.Xn(b,ag.a.ota,this.Ap.contentReplicator.kt.toString());b=ia.a.Xn(b,ag.a.Fec,"0");return b=ia.a.Xn(b,ag.a.TPb,"1")}}Object(m.a)(Qy,"ExternalContentThumbnailHelper",null,[]);class er extends Qy{constructor(){super(...arguments);this.fo=null}static get vf(){return null!=er.Vug?er.Vug:er.Vug=Sa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}$Cj(b,h,t){return Sl.I2a(h)?Sl.B3e(b,t)?!0:(er.vf.hQ(this.fo,2,"URL inserted in Non-Embedable context",er.vf.un()),!1):(u.ULS.sendTraceTag(591267584,
324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),er.vf.hQ(this.fo,2,"URL inserted is not valid for ExternalContent",er.vf.un()),!1)}}Object(m.a)(er,"AbstractExternalContentEditor",Qy,[133]);var pk=c(911),wF=c(1175);class du extends er{constructor(b){super();du.bWa=b;this.pHf()}pHf(){this.pkg&&wF.a.pHf(du.bWa.z3h())}static get paragraphEditor(){return null!=du.NBg?du.NBg:du.NBg=Sa.a.instance.resolve("Box4.IParagraphEditor")}x3k(b,h){h=this.h8h(b,h);this.yni(h,b,5)}ePa(b,
h,t){if(this.$Cj(b,h,t)){var A=this.h8h(b,null);A.url=h;this.yni(A,b,t?0:2)}}d8d(b,h){this.ePa(b,h,!1)}yni(b,h,t){this.Nl=Ya.a.create();const A=new Te.GraphTransaction(15);A.Eb(h.node);A.kk=Vc.a.qtm;const O=Sl.j8b(h),aa=DA.r(b.mediaType),ua=Sl.$Pd(b.height,b.width,b.title,aa);h=this.aOo(h,1==t);(h=Sl.Nj.WUd(h,ua))?(h=h.node,Sl.RUd(h,{url:b.url,mediaType:aa,zw:b.title,loopType:b.type,OEi:t},void 0)||u.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),A.zFa(this.Nl,
1),A.dispose(),this.KHd(h,b.thumbnail,!1),this.lyn(O,aa,b.type)):u.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}aOo(b,h){Sl.characterPropertiesEditor.replaceTextRange(b,"");return Sl.tFd(b,h)}lyn(b,h,t){Sl.k7d("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");Sl.ariaNotify(h,this.rFl(t))}rFl(b){switch(b){case xC.a.CheckList:return"Checklist Component";case xC.a.TaskAssignment:return"Task List Component";case xC.a.Poll:return"Poll Component";
default:return"Fluid Component"}}h8h(b,h){const t=new ME;t.width=Sl.q0.I3b(b.node)||0;DA.j()?t.height=null!=du.bWa&&du.bWa.x3h(h)||Sl.q0.WZa(b.node)||0:t.height=null!=du.bWa&&du.bWa.x3h(h)+2*OB.a.E2||Sl.q0.WZa(b.node)||0;t.title="Fluid Component";t.mediaType="fluid";t.type=h;t.thumbnail=this.FPl();t.url=null!=du.bWa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2210.23001/en-us_web/assets/fallback.jpg";return t}FPl(){return du.bWa.z3h()}get pkg(){return null!=
this.HFg?this.HFg:this.HFg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabledV3",!1)}static HSc(b){v.AFrameworkApplication.ye("2cejb611;b0jjh576");return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=du.bWa&&du.bWa.Kxi(b)&&pk.a.Zsi()}}Object(m.a)(du,"FluidComponentEditor",er,[]);class NE{get grl(){return null!=this.Mug?this.Mug:this.Mug=Sa.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get kLd(){return null!=
this.fwg?this.fwg:this.fwg=Sa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}gyn(b,h){b&&(du.HSc(h)?this.kLd.ePa(b,h,!0):this.grl.ePa(b,h,!0))}}Object(m.a)(NE,"PostHyperlinkAutoCorrectStrategy",null,[130]);class yC{d1b(b,h){h(yC.pyn.test(b))}pgc(b,h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",
960,960,b);b=Object.assign(new CA,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:yC.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}yC.pyn=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");yC.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(m.a)(yC,"PowerBIURLResolver",null,[128,129]);class zC{constructor(b){this.Lgh=b}d1b(b,h){let t=!1;try{if(zC.PKm(b)){const A=this.Lgh.Y6b(b);t=null!=A.width&&null!=A.height&&
!!A.thumbnailUrl&&!!A.title&&null!=A.Opa}}catch(A){}h(t)}pgc(b,h){var t=this.Lgh.Y6b(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
t.width,t.height,b);t=Object.assign(new CA,{Height:t.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:t.thumbnailUrl,Title:t.title,Width:t.width});h(t)}static PKm(b){for(const h of zC.Dxo)if(b.startsWith(h))return!0;return!1}static h7(){return new zC(Sa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}zC.Dxo=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(m.a)(zC,"WedgeComponentExperimentsURLResolver",null,[128,
129]);var lD=c(717);class Xu{static Wlj(b){Xu.uui||Xu.addEventListener();const h=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");h&&h.execute(t=>{t.logActivity(b,null)})}static addEventListener(){window.addEventListener(Xu.jyo,Xu.iyo,!0);Xu.uui=!0}static dSk(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click()}}Xu.rAo="LoopsTeachingCalloutOnInsertTabActivity";Xu.o2m="LoopHomeTabFlightActivity";Xu.jyo="switchToInsertTabAndClickLoopButtonEvent";Xu.uui=
!1;Xu.iyo=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));const t=null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.pc("WordLoopsTUIButtonDropdownDelayInMs",50);b=new Vb.a(0,1,t,()=>{Xu.dSk()});null===(h=v.AFrameworkApplication.oc)||void 0===h?void 0:h.Wb(b)};Object(m.a)(Xu,"FluidComponentsTUIHelper",null,[]);class VD{constructor(b,h,t){this.ga=b;this.BXj=h;this.Fk=t}Ub(){this.ga.gb(Vc.a.Eni,mc.a.Vc,this.Ltm.bind(this),1028);this.ga.gb(Vc.a.xRc,mc.a.Vc,this.byf.bind(this),
1028);this.ga.gb(Vc.a.lRc,mc.a.Vc,this.byf.bind(this),1028);this.ga.gb(Vc.a.kyf,mc.a.Vc,this.byf.bind(this),1028);this.ga.gb(Vc.a.gBi,mc.a.Vc,this.SIj.bind(this),1028)}Ltm(){return 32}byf(b,h,t){var A,O,aa;if(1===t){if(!this.TWd(b)||!lD.a.RAf())return 2;(null===(A=v.AFrameworkApplication.K)||void 0===A?0:A.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsTUIEnabled",!1))&&Xu.Wlj(Xu.rAo);if(!h.Xk||!nf.SelectionEditor.jf(h)||(null===(O=this.Fk)||void 0===O?0:O.JZ(h))||(null===(aa=this.Fk)||
void 0===aa?0:aa.Gna(h)))return 2;if(h&&h.node&&jD.a(h.node))return 32}else if(2===t)return this.BXj.x3k(h,VD.DPl(b)),32;return 2}TWd(b){return b===Vc.a.lRc||b===Vc.a.xRc?pk.a.TWd():!0}SIj(b,h,t){2===t&&F.a.eU("https://go.microsoft.com/fwlink/?linkid=2194838")&&Jb.App.N5f.Ykc("https://go.microsoft.com/fwlink/?linkid=2194838");return 32}static DPl(b){switch(b){case Vc.a.xRc:return xC.a.TaskAssignment;case Vc.a.lRc:return xC.a.CheckList;case Vc.a.kyf:return xC.a.Poll;default:return null}}}Object(m.a)(VD,
"FluidComponentsActor",null,[]);class Qj extends er{constructor(){super();this.AHb=this.zHb=null;this.Sgf=new JE.ExternalContentEmbedRetriever;this.Drc=null;null!=Qj.nma&&Qj.nma.T2h()}t0i(){this.fo=W.a.create();Qj.vf.oAb(this.fo,4);Qj.vf.f4(this.fo,0,Qj.vf.un());this.zFb(this.zHb,3,this.AHb,!0)}ePa(b,h,t){this.fo=W.a.create();Qj.vf.oAb(this.fo,t?0:2);Qj.vf.f4(this.fo,0,Qj.vf.un());this.Drc();this.zFb(b,t?0:2,h)}d8d(b,h){this.fo=W.a.create();Qj.vf.oAb(this.fo,1);Qj.vf.f4(this.fo,0,Qj.vf.un());this.zFb(b,
1,h)}r2i(b){this.Drc=b}jpe(b,h){const t=Qj.q0.I3b(h)||0;h=Qj.q0.WZa(h)||0;const A=b.Width/b.Height;1<=A?(b.Width=t,b.Height=t/A):(b.Height=h,b.Width=h/A)}sog(b,h,t){if(null!=b&&null!=h&&!F.a.mf(t)){var A=Qj.xYc.Y6b(t);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",!1)?A.Opa=!1:A.Opa=!0;A.hideFloatie=!0;this.jpe(b,h.node);this.f9b(b,h,!1,!1,A,t)}}ahb(b){return b?b.Ve:0}Hkg(b,h,t){let A=null;const O=
b.node;if(!qe.ParagraphReader.Yb(O)||!O.isConnected)return{returnValue:!1,tqa:A};if(t)return{returnValue:!0,tqa:b};t=b.cpBegin;const aa=b.cpEnd,ua=qe.ParagraphReader.text(O);if(0<=t&&aa<=ua.length&&ua.substring(t,aa)===h)return{returnValue:!0,tqa:b};const Ra=ua.indexOf(h);return 0<=Ra?(A=pf.a.createTextRange(O,Ra,Ra+h.length),{returnValue:!0,tqa:A}):0<=t&&aa<=ua.length&&Sl.j8b(b)?{returnValue:!0,tqa:b}:{returnValue:!1,tqa:A}}GEf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&
0<b.width&&0<b.height?!0:!1}P6a(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const t=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");t&&t.execute(A=>{A.logActivity(b,h)})},Qj.VCa)}zFb(b,h,t,A=!1){if(this.$Cj(b,t,!h)){var O=Qj.xYc.Y6b(t);O&&(this.GEf(O)?(u.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.tXf(b,h,O,t,A)):(u.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),
Qj.vf.hQ(this.fo,2,"Size provided is not valid for OEmbed",Qj.vf.un())))}}tXf(b,h,t,A,O){const aa=!h,ua=1===h,Ra=Qj.q0.I3b(b.node)||0,ub=Qj.q0.WZa(b.node)||0,Nb=Py.a.i7e(t.$jg,!0,Ra,ub);this.EWc(b,A,h,!0);this.Sgf.Xyh(Nb,Yb=>{Qj.vf.f4(this.fo,4,Qj.vf.un());Qj.vf.v5c(this.fo,this.ahb(Yb.data));if(Yb=this.zXf(Yb)){u.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var bc=DA.r(Yb.MediaType);Qj.vf.Fae(this.fo,7,bc);bc=b;({tqa:bc}=
this.Hkg(b,A,ua)).returnValue?(this.EWc(bc,A,h,!1),null==t.width?0<Ra&&Yb.Width>Ra&&(u.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Yb.Width=Ra):(u.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Yb.Width=this.had(t.width,Yb.Width,Ra)),null==t.height?0<ub&&Yb.Height>ub&&(u.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),
Yb.Height=ub):(u.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Yb.Height=this.had(t.height,Yb.Height,ub)),Qj.nma.$8a||O?this.f9b(Yb,bc,aa,ua,t,A):(this.zHb=b,this.AHb=A,this.WGc(A))):(u.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),Qj.vf.hQ(this.fo,2,"No conversion as the context is no longer valid for the external content conversion",
Qj.vf.un()));ua&&this.bZa(bc.node)}else ua&&this.bZa(b.node),Qj.vf.hQ(this.fo,1,"URL not oEmbedable",Qj.vf.un())},Yb=>{Qj.vf.f4(this.fo,4,Qj.vf.un());Qj.vf.v5c(this.fo,this.ahb(Yb.data));ua&&this.bZa(b.node);u.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Yb.data.we);Qj.vf.hQ(this.fo,2,"ExternalContentEmbedRequest failed",Qj.vf.un())},Yb=>{ua&&this.bZa(b.node);u.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Yb)},this.fo)}had(b,
h,t){!b&&0<t&&h>t||b>t?(u.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=t):b>t?h=t:b&&b<t&&(h=b);return h}f9b(b,h,t,A,O,aa){this.Nl=Ya.a.create();b.Width=b.Width/b.Height*(b.Height-(OB.a.PPc+OB.a.E2))+2*OB.a.E2;const ua=new Te.GraphTransaction(15);ua.Eb(h.node);ua.kk=Vc.a.ePa;const Ra=Sl.j8b(h);null!=O.Opa&&!O.Opa||A||Ra||(b.Title=""===O.title||O.title?O.title:b.Title,!b.Title&&""!==b.Title)||(h=this.pyf(h,ua,b.Title,
aa,t));if(h){A&&(h=this.nbf(h));var ub=Sl.tFd(h,A);if(ub){t=DA.r(b.MediaType);var Nb=Sl.$Pd(b.Height,b.Width,b.Title,t);(ub=this.Yxf(ub,Nb,A,{url:aa,pZa:b.IFrameHtml,zw:b.Title,mediaType:t},b.ProviderName))?(ua.zFa(this.Nl,1),ua.dispose(),this.zHb=h,this.AHb=aa,this.pUf(O,b,ub),this.gXf(aa,A||O.hideFloatie,Ra,t,b.Title)):ua.dispose()}else ua.dispose(),u.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Qj.vf.hQ(this.fo,
2,"Could not create IP context on splitting the paragraph",Qj.vf.un())}else Qj.vf.hQ(this.fo,2,"GraphNodeContext is null",Qj.vf.un())}Yxf(b,h,t,A,O){if(!b)return null;b=Qj.mO.WUd(b,h);if(!b)return u.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Qj.vf.hQ(this.fo,2,"The anchored image could not be inserted",Qj.vf.un()),null;b=b.node;A=Sl.RUd(b,A,O);Qj.vf.djg(this.fo,A.id);t||Sl.i8f(b);return b}pUf(b,h,t){F.a.Y6(b.thumbnailUrl)||(h.Thumbnail=
b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Qj.vf.f4(this.fo,8,Qj.vf.un()),u.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.KHd(t,h.Thumbnail,!1))}gXf(b,h,t,A,O){h||this.WGc(b);this.P6a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Sl.k7d("IsHyperlinkWithNonURLDisplayText",t,"Office.Word.Online.ExternalContent.OEmbedInsertions");Sl.ariaNotify(A,O);Qj.vf.f4(this.fo,5,Qj.vf.un())}pyf(b,h,t,A,O){if(O){if((O=
Ge.HyperlinkReader.rD(b,!1))&&1!==O.length)return h.dispose(),u.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Sl.hyperlinkEditor.iR(O[0].paragraph,O[0].hyperlink)}return this.z3f(b,t,A)}nbf(b){const h=b.node,t=qe.ParagraphReader.text(h);return 0<t.length&&!t.trim().length?(b=pf.a.createTextRange(h,0,t.length),Sl.characterPropertiesEditor.replaceTextRange(b,""),pf.a.Tc(h,0)):b}zXf(b){if(!({group:b}=sl.a.H0(b.data.we)).returnValue)return null;
b=b.Responses[0];return b.StatusCode?null:b}z3f(b,h,t){const A=b.cpBegin+h.length;Sl.characterPropertiesEditor.replaceTextRange(b,h);b=pf.a.createTextRange(b.node,b.cpBegin,A);Sl.hyperlinkEditor.jH(b,t,!1);return b}bZa(b){b.Hec=null}EWc(b,h,t,A){const O=b.cpBegin,aa=b.cpEnd;b=qe.ParagraphReader.text(b.node).trim();O||b!==h&&""!==b?O?aa===b.length?u.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
dy[t],A):0<O&&aa<b.length&&u.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",dy[t],A):u.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",dy[t],A):u.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
dy[t],A)}WGc(b){this.P3b();const h=new qu.a(1,v.AFrameworkApplication.isRtl);h.O_c=b;Qj.Bfb.O1c(h)}P3b(){const b=new Uw.a(!0);Qj.M8.yGa(b)}static get Bfb(){return null!=Qj.Oug?Qj.Oug:Qj.Oug=Sa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get nma(){Qj.Qza||(Qj.Qza=Sa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Qj.Qza}static get M8(){return null!=Qj.jCg?Qj.jCg:Qj.jCg=Sa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get q0(){return null!=
Qj.hDg?Qj.hDg:Qj.hDg=Sa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get mO(){return null!=Qj.Axg?Qj.Axg:Qj.Axg=Sa.a.instance.resolve("WordEditor.IImageEditor")}static get xYc(){return null!=Qj.VAg?Qj.VAg:Qj.VAg=Sa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}Qj.VCa=5E3;Qj.Qza=null;Object(m.a)(Qj,"ExternalContentEditorV2",er,[]);class WD{constructor(){this.jd=this.W=null}get name(){return"WordEditor.ExternalContent"}get Xb(){return this.jd?
this.jd:this.jd=this.W.resolve("Box4.IFeatureHelper")}yc(b){var h;this.W=b;b.ha("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new BA.a(Aq.a.instance,Iv.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").singleInstance();b.ha("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new NE).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").singleInstance();b.ha("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new kD(b.resolve("Box4.IRoamingServiceRequestManager"),
b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").singleInstance();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ha("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new Qj).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance(),b.ha("WordEditor.ExternalContent.FluidComponentEditor",()=>new du(b.resolve("Fluid.Host.LoopComponentManager"))).singleInstance(),
b.ha("WordEditor.ExternalContent.FluidComponentsActor",()=>new VD(v.AFrameworkApplication.xa,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),rl.a.instance)).singleInstance(),(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&Xu.Wlj(Xu.o2m)):b.ha("WordEditor.ExternalContent.ExternalContentEditor",()=>new xh).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance()}init(){this.Xb.Ip.continueWith(()=>
{this.$m()});v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Ub()}dispose(){}p3k(){const b=new zv;this.CRh()&&b.plh(zC.h7());b.plh(new yC);return b}$m(){null==v.AFrameworkApplication.K||v.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ha("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new uF.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").singleInstance();
this.CRh()&&(this.W.ha("WordEditor.ExternalContent.IWordExternalContentURLResolver",()=>this.p3k()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").singleInstance(),this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}CRh(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){P.a.instance.Gc(new WD)}}Object(m.a)(WD,"ExternalContentPackage",null,[1,2]);var EA;
(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.decimal=6]="decimal";b[b.f6o=7]="bar";b[b.OQa=8]="num"})(EA||(EA={}));Object(m.b)("TabStopValues",EA);class Dp{}Dp.LLh=8;Dp.dbl=1;Dp.y7="wwaengidc";Dp.kpiName="WordRuler";Dp.precision=.0625;Dp.nzo=1;Dp.TTo="ShowHideRuler";Object(m.a)(Dp,"Constants",null,[]);var WC=c(768);class pt{static q7b(b,h){if(!pt.fUc)return null;switch(b){case "Left":return t=>
{const A=t.rulerCanvasProps;t=t.indents;return{KHb:0,qMb:A.scale-(A.margins[1].value+t[2].value+Math.max(t[0].value,t[1].value)+8*A.precision)}};case "Right":return t=>{const A=t.rulerCanvasProps;t=t.indents;return{KHb:0,qMb:A.scale-(t[2].value+(A.margins[0].value+Math.max(t[0].value,t[1].value))+8*A.precision)}};case "MoveTableColumn":return()=>{let t=0,A=0;if(0===h){var O={};32===pt.rc.Rb(qa.a.Cfc,2,O)&&(t=Ad.a.nz(O.MinIndent),A=Ad.a.nz(O.MaxIndent))}else O={so:h-1},32===pt.rc.Rb(qa.a.Bfc,2,O)&&
(t=Ad.a.nz(O.MinResize),A=Ad.a.nz(O.MaxResize));return{KHb:t,qMb:A}};case "Top":return t=>{t=t.rulerCanvasProps;return{KHb:0,qMb:t.scale-(t.margins[1].value+8*t.precision)}};case "Bottom":return t=>{t=t.rulerCanvasProps;return{KHb:0,qMb:t.scale-(t.margins[0].value+8*t.precision)}}}return null}static nQd(b){if(!pt.fUc)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>{var t=h.rulerCanvasProps,A=h.indents,O=h.ipContextIndex;h=t.margins;var aa=t.scale;t=t.precision;
if("MoveTableColumn"!==h[0].type){O=h[0].value;h=h[1].value+A[2].value;var ua=O;"LeftIndent"===b&&(ua+=Math.max(A[0].value,A[1].value));A=-1*O;t=aa-(ua+h+8*t)}else{aa=0;for(ua=0;ua<=O;ua++)aa+=h[ua].value;ua=0;if("LeftIndent"===b){ua=A[0].value;const Ra=A[1].value;aa+=Math.max(ua,Ra);ua=Math.max(ua,Ra)}h=h[O+1].value;ua+=A[2].value;A=-1*aa;t=h-ua-t}return{KHb:A,qMb:t}};case "RightIndent":return h=>{var t=h.rulerCanvasProps,A=h.indents,O=h.ipContextIndex,aa=t.margins;h=t.scale;t=t.precision;if("MoveTableColumn"!==
aa[0].type){var ua=aa[0].value;aa=aa[1].value;O=A[0].value;var Ra=A[1].value;A=-1*aa;h-=ua+aa+Math.max(O,Ra)+8*t}else{ua=0;for(Ra=0;Ra<=O;Ra++)ua+=aa[Ra].value;aa=aa[O+1].value;O=A[0].value;Ra=A[1].value;A=-1*(h-ua-aa);h=aa-Math.max(O,Ra)-t}return{KHb:A,qMb:h}}}return null}static a4l(){return b=>{var h=b.rulerCanvasProps,t=b.indents,A=b.ipContextIndex,O=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==O[0].type?(A=O[0].value,O=O[1].value+t[2].value,t=Math.min(t[0].value,t[1].value)+b,b=h-(A+
O+b)):(h=t[2].value,O=O[A+1].value,t=Math.min(t[0].value,t[1].value)+b,b=O-(h+b));return{KHb:t,qMb:b}}}static get rc(){return null!=pt.ysg?pt.ysg:pt.ysg=v.AFrameworkApplication.xa}static get fUc(){null==this.W$a&&(v.AFrameworkApplication.loa("WoRul910;WoRul910cf"),this.W$a=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.W$a}}pt.W$a=null;Object(m.a)(pt,"RulerPropertyBoundaryHelper",null,[]);var xF=
c(928),XD=c(1466),mD=c(1046),AC=c(1235),BC=c(1236);class Yu{constructor(b,h,t,A,O,aa){this.Yqn="OutlineContainer";this.Ggk="UpdateCustomTabFailed";this.Pvb="ReadRulerPropertiesFailed";this.Kgk="UpdateIndentFailed";this.zgh="UpdateMarginFailed";this.h6d=ua=>{ua.button===Sys.UI.MouseButton.rightButton&&this.EOe.show(new Sys.UI.Point(ua.clientX,ua.clientY),2)};this.PAj=()=>{this.BTa()};this.Um=b;this.dWb=h;this.ga=t;this.EOe=A;this.Hy=O;this.oS=aa;this.mTb=null;this.tw=!!v.AFrameworkApplication.ta&&
v.AFrameworkApplication.ta.Ob.uO;this.vPi=this.S5d.bind(this);this.gSi=this.Ns.bind(this);this.OAj=this.BTa.bind(this)}bF(){this.AXe();this.tlh();this.dWb.Kl.af(10).Ro(this.vPi);Hf.a.addHandler(this.eVe,db.a.scroll,this.PAj);this.Um.execute(h=>{h.i4(this.gSi)});const b=[this.oqf(),document.getElementById(Hh.AppFrame.vad),document.getElementById("PageContentContainer")];this.mTb?this.mTb.register(b,this.OAj):mD.a(XD.a.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(h=>{this.mTb=h.createResizeObserver();
this.mTb.register(b,this.OAj);return null})});Jb.App.ya.oI.registerBoundingWindowRectsChanged("documentPanel",(h,t)=>{"undefined"!==t&&this.i7a([1,0])})}oqf(){return 1===this.oS.tv?this.G8j:this.e8j}get eVe(){return document.getElementById(Hh.AppFrame.MTa)}get e8j(){const b=document.getElementsByClassName(this.Yqn);return b&&0<b.length?b[0]:null}get G8j(){var b=this.Hy.l5b;if(!b)return null;b=this.w5n(qe.ParagraphReader.rQ(b));return xF.a.a$h(b)}w5n(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+
b+"']"):null}get aN(){return this.Um&&this.Um.instance?this.Um.instance.ij:Dp.dbl}I6b(){const b={};return 32!==this.ga.Rb(qa.a.tGa,2,b)?(u.ULS.sendTraceTag(529065947,AC.a.msoulscat_Wac_WordRuler,BC.a.warning,"Unable to read page properties for Ruler"),Tl.recordQosError(this.Pvb,[Tl.Wda],"Unable to read page properties for Ruler"),null):b}dispose(){this.vji();this.dWb.Kl.af(10).EU(this.vPi);Hf.a.removeHandler(this.eVe,db.a.scroll,this.PAj);this.Um.execute(b=>{b.zmb(this.gSi)});this.mTb&&this.mTb.dispose();
Jb.App.ya.oI.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==h&&this.i7a([1,0])})}get Tui(){null==Yu.SDe&&(Yu.SDe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&v.AFrameworkApplication.K.$("RulerThemingIsEnabled"):!1);return Yu.SDe}}Yu.SDe=null;Object(m.a)(Yu,"ARuler",null,[195]);var CC=c(314);class rs extends Yu{constructor(b,h,t,
A,O,aa,ua){super(b,h,t,O,aa,ua);this.yO="HorizontalRuler";this.WGj="CustomTabModificationFromRuler";this.uIj="IndentModificationFromRuler";this.zoe="MarginModificationFromRuler";this.aVg=this.$Ug=this._tabStops=null;this.zgn=(Ra,ub,Nb)=>{if(!(Ra>=this._tabStops.length)){Ra=this._tabStops[Ra];var Yb="Modify"===Nb?this.ga.Rb(Vc.a.Fcc,2,{["tabStop"]:Ra,["value"]:Ad.a.wv(ub)}):this.ga.Rb(Vc.a.U4a,2,Ra);if(32===Yb){ub=1;var bc=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",
Nb,EA[Ra.Hca]);u.ULS.sendTraceTag(591213271,3014,50,bc)}else ub=0,bc=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",Nb,EA[Ra.Hca]),u.ULS.sendTraceTag(591213272,3014,15,bc),Tl.recordQosError(this.Ggk,[Tl.Wda],"Unable to modify custom tab using ruler");lb.a(this.WGj,32===Yb,void 0,[Object.assign(new sa.a,{name:"Operation",string:Nb}),Object.assign(new sa.a,{name:"TabType",int64:EA[Ra.Hca]})]);Nb=new Map;Nb.set("Command","OnCustomTabChange");Nb.set("Source",this.yO);
Nb.set("Response",bc);wa.Health.instance.recordKpiUsage(Dp.kpiName,ub,Dp.y7,Nb)}};this.Rin=(Ra,ub)=>{var Nb=new WC.a;Nb.unit=1;Nb.value=Ad.a.wv(ub);ub=8;switch(Ra){case "FirstLineIndent":ub=this.ga.Rb(qa.a.R5c,2,Nb);break;case "HangingIndent":ub=this.ga.Rb(qa.a.S5c,2,Nb);break;case "LeftIndent":ub=this.ga.Rb(qa.a.v1a,2,Nb);break;case "RightIndent":ub=this.ga.Rb(qa.a.u1a,2,Nb)}let Yb;32===ub?(Nb=1,Yb=String.format("Indents set using Ruler. Indent: {0}",Ra),u.ULS.sendTraceTag(592517017,3014,50,Yb)):
(Nb=0,Yb=String.format("Unable to set indent using Ruler. Indent: {0}",Ra),u.ULS.sendTraceTag(592496523,3014,15,Yb,Ra),Tl.recordQosError(this.Kgk,[Tl.Wda],"Unable to set indent using Ruler."));lb.a(this.uIj,32===ub,void 0,[Object.assign(new sa.a,{name:"Type",string:Ra})]);Ra=new Map;Ra.set("Command","OnIndentChange");Ra.set("Source",this.yO);Ra.set("Response",Yb);wa.Health.instance.recordKpiUsage(Dp.kpiName,Nb,Dp.y7,Ra)};this.WRf=(Ra,ub,Nb)=>{let Yb;Yb="Left"===Ra?this.ga.Rb(qa.a.dia,2,Ad.a.wv(ub)):
"Right"===Ra?this.ga.Rb(qa.a.L5a,2,Ad.a.wv(ub)):Nb?this.ga.Rb(qa.a.Yie,2,{["columnIndex"]:Nb-1,["width"]:Ad.a.wv(ub)}):this.ga.Rb(qa.a.Yhc,2,Ad.a.wv(ub));32===Yb?(ub=1,Nb=String.format("Margins set using Ruler. Margin: {0}",Ra),u.ULS.sendTraceTag(592517018,3014,50,Nb)):(ub=0,Nb=String.format("Unable to set margins using Ruler. Margin: {0}",Ra),u.ULS.sendTraceTag(592496524,3014,15,Nb),Tl.recordQosError(this.zgh,[Tl.Wda],"Unable to set margins using Ruler."));lb.a(this.zoe,32===Yb,void 0,[Object.assign(new sa.a,
{name:"Type",string:Ra})]);Ra=new Map;Ra.set("Command","OnMarginChange");Ra.set("Source",this.yO);Ra.set("Response",Nb);wa.Health.instance.recordKpiUsage(Dp.kpiName,ub,Dp.y7,Ra)};this.HLa=A;this.$q={}}get RT(){return this.$Ug}get nEa(){return this.aVg}renderRuler(){this.RT.classList.remove("HideWACHorizontalRulerContainer");this.RT.classList.add("ShowWACHorizontalRulerContainer");var b=this.I6b();if(b){var h=this.WRf,t=this.Rin,A=this.zgn,O=this.A9c(),aa=this.vvj(),ua=this.uvj();O&&aa&&ua||(this.$q.disabled=
!0);this.$q.onIndentChange=t;this.$q.onMarginChange=h;this.$q.onTabChange=A;this.BTa();b=Hc.a.Ki(b.xo,0);this.nEa.style.width=(b*this.aN).toString()+"px";return this.HLa().then(Ra=>{Ra.renderRuler(this.nEa,this.$q)})}}uvj(){const b=[];var h={};if(32!==this.ga.Rb(Vc.a.ZKb,2,h))return u.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),Tl.recordQosError(this.Pvb,[Tl.Wda],"Unable to read paragraph tabs for Ruler"),!1;var t=h.customTabs;if(!t||0>=t.length)return this.$q.tabs=
b,!0;this._tabStops=t;h="";for(const A of t){switch(A.Hca){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";break;case 7:h="BarTab"}t=Hc.a.r4a(A.AHa,0);b.push({["type"]:h,["value"]:t,["getRulerPropertyBoundary"]:pt.a4l()})}this.$q.tabs=b;return!0}i7a(b){var h;if(this.RT){this.RT.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.$q&&delete this.$q.disabled;for(const t of b)switch(t){case 0:b=this.vvj();const A=this.uvj();b&&A||(this.$q.disabled=
!0);break;case 1:this.A9c()||(this.$q.disabled=!0)}if(null===(h=this.Hy.lb)||void 0===h?0:h.GSc)this.$q.disabled=!0;this.HLa().then(t=>{t.renderRuler(this.nEa,this.$q);return null})}}A9c(){const b={};var h=this.I6b();if(!h)return!1;b.scale=Ad.a.nz(h.xo);b.precision=Dp.precision;b.rulerType="Horizontal";if(!this.vpn())return this.$q.ipContextIndex=0,this.$q.permittedUnits=Dp.LLh,h=[{["type"]:"Left",["value"]:Ad.a.nz(h.marginLeft),["getRulerPropertyBoundary"]:pt.q7b("Left",0)},{["type"]:"Right",["value"]:Ad.a.nz(h.marginRight),
["getRulerPropertyBoundary"]:pt.q7b("Right",1)}],b.margins=h,this.$q.rulerCanvasProps=b,!0;var t={};h={};var A=this.ga.Rb(qa.a.z1c,2,t);const O=this.ga.Rb(qa.a.lLb,2,h);if(32!==A||32!==O)return u.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),Tl.recordQosError(this.Pvb,[Tl.Wda],"Unable to read table properties for Ruler"),!1;t=t.ColumnWidths;A=h.TablePosition;if(!A||!t||0>=t.length)return u.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),
Tl.recordQosError(this.Pvb,[Tl.Wda],"Cannot show table properties on the ruler as they are null"),!1;h=Array(t.length+1);h[0]={["type"]:"MoveTableColumn",["value"]:Ad.a.nz(A.x/this.aN),["getRulerPropertyBoundary"]:pt.q7b("MoveTableColumn",0)};for(A=0;A<t.length;A+=1)h[A+1]={["type"]:"MoveTableColumn",["value"]:Ad.a.nz(t[A]),["getRulerPropertyBoundary"]:pt.q7b("MoveTableColumn",A+1)};this.$q.ipContextIndex=this.J7l();this.$q.permittedUnits=Dp.nzo;b.margins=h;this.$q.rulerCanvasProps=b;return!0}vvj(){var b=
{};if(32!==this.ga.Rb(qa.a.F4a,2,b))return u.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),Tl.recordQosError(this.Pvb,[Tl.Wda],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=pt.nQd("FirstLineIndent");const t={type:"HangingIndent"};t.getRulerPropertyBoundary=pt.nQd("HangingIndent");const A={type:"RightIndent"};A.getRulerPropertyBoundary=pt.nQd("RightIndent");const O={type:"LeftIndent"};O.getRulerPropertyBoundary=
pt.nQd("LeftIndent");this.$q.rtl=b.isRtl;b=b.it;h.value=1===b.specialIndentType?Ad.a.nz(b.Cca+b.iB):2===b.specialIndentType?Ad.a.nz(b.iB-b.Cca):Ad.a.nz(b.iB);t.value=Ad.a.nz(b.iB);O.value=Ad.a.nz(b.iB);A.value=Ad.a.nz(b.qna);this.$q.indents=[h,t,A,O];return!0}tlh(){Hf.a.addHandler(this.RT,db.a.yx,this.h6d)}vji(){this.RT&&(this.RT.classList.remove("ShowWACHorizontalRulerContainer"),this.RT.classList.add("HideWACHorizontalRulerContainer"),Hf.a.removeHandler(this.RT,db.a.yx,this.h6d));this.HLa().then(b=>
{b.dispose(this.nEa);return null})}Ns(){this.RAj();this.BTa();this.i7a([1,0])}S5d(b,h){b=h.property;if(b===Lc.a.xo||b===Lc.a.marginLeft||b===Lc.a.marginRight)this.RAj(),this.BTa(),this.i7a([1])}RAj(){var b=this.I6b();b&&(b=Hc.a.Ki(b.xo,0),this.nEa.style.width=Math.round(b*this.aN).toString()+"px")}BTa(){window.requestAnimationFrame(()=>{var b=this.oqf();b&&(b=ff.a.getElementBounds(b),v.AFrameworkApplication.isRtl?this.nEa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+
"px":this.nEa.style.marginLeft=b.x.toString()+"px")})}J7l(){const b=ue.GraphIterator.$a(this.Hy.l5b);if(b.Ab(14))return b.fd(16),Gv.a(b,!0);u.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");Tl.recordQosError(this.Pvb,[Tl.Wda],"Unable to read table column index for Ruler");return 0}vpn(){let b=!0;const h=this.Hy.lb.NN();if(null===h)return u.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),Tl.recordQosError(this.Pvb,[Tl.Wda],"Unable to get Context Iterator for the Ruler"),
!1;for(;h.moveNext()&&b;){const t=ue.GraphIterator.$a(h.current.node);t.yd();b=b&&ni.TableReader.Jw(t)}return b}AXe(){if(!this.nEa&&!this.RT){this.$Ug=document.createElement("div");this.RT.id=rs.ZZj;this.RT.className=rs.YZj;this.RT.setAttribute(Mf.a.Bea,WordEditorIntl.WordEditorStrings.L_Ruler);this.RT.setAttribute(Mf.a.oh,Mf.a.wrh);this.RT.classList.add("HideWACHorizontalRulerContainer");if(this.Tui){var b=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");const h=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");
dc.a.Jfa(b,!h)&&this.RT.classList.add(rs.q5j)}this.aVg=document.createElement("div");this.nEa.className=rs.XZj;this.nEa.id=rs.$Zj;this.RT.appendChild(this.nEa);b=null;this.tw&&((b=Object(CC.a)("EditorBars"))&&b.appendChild(this.RT),this.RT.classList.add("regionComposer"));b||(b=document.getElementById(Hh.AppFrame.vad),b.insertBefore(this.RT,b.firstChild))}}static vE(){return new rs(Sa.a.instance.Sa("Common.IZoomManager"),Jb.App.jk,v.AFrameworkApplication.xa,oh.UISurfaces.Ibi,Sa.a.instance.resolve("WordEditor.IRulerContextMenu"),
hi.a.instance,Sa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=rs.Xyg?rs.Xyg:rs.Xyg=rs.vE()}}rs.ZZj="WACHorizontalRulerContainer";rs.YZj="WACHorizontalRulerContainer";rs.$Zj="WACHorizontalRuler";rs.XZj="WACHorizontalRuler";rs.q5j="ModernUxWACHorizontalRulerContainer";Object(m.a)(rs,"HorizontalRuler",Yu,[]);var Ry=c(956);class eu extends Yu{constructor(b,h,t,A,O,aa,ua){super(b,h,t,O,aa,ua);this.yO="VerticalRuler";this.zoe="MarginModificationFromRuler";this.ohh=
this.nhh=null;this.WRf=(Ra,ub)=>{let Nb=8;"Top"===Ra?Nb=this.ga.Rb(qa.a.M5a,2,Ad.a.wv(ub)):"Bottom"===Ra&&(Nb=this.ga.Rb(qa.a.K5a,2,Ad.a.wv(ub)));let Yb;32===Nb?(ub=1,Yb=String.format("Margins set using Ruler. Margin: {0}",Ra),u.ULS.sendTraceTag(529065945,3014,50,Yb)):(ub=0,Yb=String.format("Unable to set margins using Ruler. Margin: {0}",Ra),u.ULS.sendTraceTag(529065946,3014,15,Yb),Tl.recordQosError(this.zgh,[Tl.Wda],"Unable to set margins using Ruler."));lb.a(this.zoe,32===Nb,void 0,[Object.assign(new sa.a,
{name:"Type",string:Ra})]);Ra=new Map;Ra.set("Command","OnMarginChange");Ra.set("Source",this.yO);Ra.set("Response",Yb);wa.Health.instance.recordKpiUsage(Dp.kpiName,ub,Dp.y7,Ra)};this.HLa=A;this.$q={}}get U0(){return this.nhh}get wIa(){return this.ohh}renderRuler(){this.U0.classList.remove("HideWACVerticalRulerContainer");this.U0.classList.add("ShowWACVerticalRulerContainer");var b=this.I6b();if(b){var h=this.WRf;this.A9c()||(this.$q.disabled=!0);this.$q.onMarginChange=h;this.BTa();b=Hc.a.Ki(b.Zv,
1);this.wIa.style.height=(b*this.aN).toString()+"px";this.HLa().then(t=>{t.renderRuler(this.wIa,this.$q);return null})}}i7a(b){var h;if(this.U0){this.U0.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.$q&&delete this.$q.disabled;for(const t of b)switch(t){case 1:this.A9c()?this.BTa():this.$q.disabled=!0}if(null===(h=this.Hy.lb)||void 0===h?0:h.GSc)this.$q.disabled=!0;this.HLa().then(t=>{t.renderRuler(this.wIa,this.$q);return null})}}A9c(){const b={},h=this.I6b();if(!h)return!1;b.scale=
Ad.a.nz(h.Zv);b.precision=Dp.precision;b.rulerType="Vertical";this.$q.ipContextIndex=0;this.$q.permittedUnits=Dp.LLh;b.margins=[{["type"]:"Top",["value"]:Ad.a.nz(h.marginTop),["getRulerPropertyBoundary"]:pt.q7b("Top",0)},{["type"]:"Bottom",["value"]:Ad.a.nz(h.marginBottom),["getRulerPropertyBoundary"]:pt.q7b("Bottom",1)}];this.$q.rulerCanvasProps=b;return!0}tlh(){this.AXe();Hf.a.addHandler(this.U0,db.a.yx,this.h6d)}vji(){this.U0&&(this.U0.classList.remove("ShowWACVerticalRulerContainer"),this.U0.classList.add("HideWACVerticalRulerContainer"),
Hf.a.removeHandler(this.U0,db.a.yx,this.h6d));this.HLa().then(b=>{b.dispose(this.wIa);return null})}Ns(){this.NAj();this.BTa();this.i7a([1])}S5d(b,h){b=h.property;if(b===Lc.a.Zv||b===Lc.a.marginTop||b===Lc.a.marginBottom)this.NAj(),this.BTa(),this.i7a([1])}NAj(){var b=this.I6b();b&&(b=Hc.a.Ki(b.Zv,1),this.wIa.style.height=Math.round(b*this.aN).toString()+"px")}BTa(){window.requestAnimationFrame(()=>{var b=this.oqf();if(b){const h=ff.a.getElementBounds(b);this.wIa.style.height=h.height.toString()+
"px";b=this.v9l(b);this.wIa.style.marginTop=b+"px"}})}v9l(b){b=b.getBoundingClientRect().y;const h=this.eVe.getBoundingClientRect().y;return b-h}AXe(){if(!this.wIa&&!this.U0){this.nhh=document.createElement("div");this.U0.id=eu.whk;this.U0.className=eu.vhk;this.U0.setAttribute(Mf.a.Bea,WordEditorIntl.WordEditorStrings.L_Ruler);this.U0.setAttribute(Mf.a.oh,Mf.a.wrh);this.U0.classList.add("HideWACVerticalRulerContainer");if(this.Tui){var b=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");
const h=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");dc.a.Jfa(b,!h)&&Sys.UI.DomElement.addCssClass(this.U0,eu.r5j)}this.ohh=document.createElement("div");this.wIa.className=eu.uhk;this.wIa.id=eu.xhk;this.U0.appendChild(this.wIa);b=document.getElementById(Hh.AppFrame.vad);b.insertBefore(this.U0,b.firstChild)}}static vE(){return new eu(Sa.a.instance.Sa("Common.IZoomManager"),Jb.App.jk,v.AFrameworkApplication.xa,oh.UISurfaces.Ibi,Sa.a.instance.resolve("WordEditor.IRulerContextMenu"),
hi.a.instance,Sa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=eu.Wyg?eu.Wyg:eu.Wyg=eu.vE()}}eu.whk="WACVerticalRulerContainer";eu.vhk="WACVerticalRulerContainer";eu.xhk="WACVerticalRuler";eu.uhk="WACVerticalRuler";eu.r5j="ModernUxWACVerticalRulerContainer";Object(m.a)(eu,"VerticalRuler",Yu,[]);class Tl{constructor(b,h,t,A,O,aa,ua,Ra,ub){this.ZAe=this.vDe=!1;this.yO="RulerActor";this.sah=null;this.Rna=!1;this.eSj="ClearAllTabStopsFailed";this.Ich="ShowHideRulerFailed";
this.fFe=null;this.uCd=(Nb,Yb,bc)=>{if(1===bc)return 32;Nb=this.ga.processAction(Vc.a.KLb,2,null);32===Nb?(bc=1,Yb=String.format("Clear all tab stops from ruler"),u.ULS.sendTraceTag(591213266,3014,50,Yb)):(bc=0,Yb=String.format("Unable to clear all tab stop from ruler"),u.ULS.sendTraceTag(591213267,3014,15,Yb),Tl.recordQosError(this.eSj,[Tl.Wda],Yb));const Dc=new Map;Dc.set("Command","ClearAllTabStops");Dc.set("Source",this.yO);Dc.set("Response",Yb);wa.Health.instance.recordKpiUsage(Dp.kpiName,bc,
Dp.y7,Dc);return Nb};this.oRc=(Nb,Yb,bc)=>{if(1===bc)switch(Nb){case Vc.a.Q0e:case Vc.a.Laf:return 2;default:return 32}Yb=this.EOe.M2l();switch(Nb){case Vc.a.NGf:var Dc=1;break;case Vc.a.q5f:Dc=4;break;case Vc.a.h4e:Dc=3;break;default:return u.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Nb=new Tu.a(Yb,Dc,0,1);Nb=this.ga.Rb(Vc.a.n5c,2,Nb);32===Nb?(bc=1,Yb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",EA[Dc],Yb.toString()),u.ULS.sendTraceTag(591213269,
3014,50,Yb)):(bc=0,Yb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",EA[Dc],Yb.toString()),u.ULS.sendTraceTag(591213270,3014,15,Yb));Dc=new Map;Dc.set("Command","InsertCustomTabStopRuler");Dc.set("Source",this.yO);Dc.set("Response",Yb);wa.Health.instance.recordKpiUsage(Dp.kpiName,bc,Dp.y7,Dc);return Nb};this.XNb=(Nb,Yb,bc,Dc,Pc)=>this.vDe||1===bc&&Po.a.vga(Yb.Yj)?8:this.Rna?this.TPc(Nb,Yb,bc,Dc,Pc):this.gqo(Yb,bc);this.I2n=()=>{this.Rna?u.ULS.sendTraceTag(574128526,
3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.processAction(qa.a.XNb,2)?(u.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),Tl.recordQosError(this.Ich,[Tl.Wda],"Ruler could not be enabled")):u.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.TPc=(Nb,Yb,bc)=>{if(1===bc||!this.Rna)return 32;this.Rna=!1;this.FOe.qaj(!1);this.u$a.dispose();this.tZd()&&this.fdf();this.QAj();u.ULS.sendTraceTag(593351623,
3014,50,"Ruler is disabled");Nb=new Map;Nb.set("Command","HideRuler");Nb.set("Source",this.yO);Nb.set("Response","");wa.Health.instance.recordKpiUsage(Dp.kpiName,1,Dp.y7,Nb);return 32};this.F$d=(Nb,Yb,bc,Dc,Pc)=>{if(1===bc)return 32;Pc&&(Pc[Ng.a.On]=this.Rna);return 32};this.Cpm=Nb=>{this.Rna=Nb.result};this.KEb=()=>{this.vDe=!1};this.kji=()=>{this.vDe=!0};this.ga=b;this.u$a=h;this.SUe=t;this.SQb=A;this.EOe=O;this.FOe=aa;Tl.Ok=Ra;this.jKa=ua;this.oS=ub;this.jKa.Wmh(this.kji);this.jKa.tyd(this.KEb)}initialize(){this.Ub();
this.sah=this.I2n;window.addEventListener("TurnRulerOnAction",this.sah,!0);return this.FOe.$3l().continueWith(this.Cpm,8)}Ub(){this.ga.pa(qa.a.XNb,mc.a.view,this.XNb);this.ga.gb(qa.a.F$d,mc.a.view,this.F$d,96);this.ga.pa(Vc.a.Q0e,mc.a.view,this.oRc);this.ga.pa(Vc.a.h4e,mc.a.view,this.oRc);this.ga.pa(Vc.a.uCd,mc.a.view,this.uCd);this.ga.pa(Vc.a.Laf,mc.a.view,this.oRc);this.ga.pa(Vc.a.TPc,mc.a.view,this.TPc);this.ga.pa(Vc.a.NGf,mc.a.view,this.oRc);this.ga.pa(Vc.a.q5f,mc.a.view,this.oRc);Ry.a.kd.addHandler(Ry.a.K5d,
this.IZc.bind(this));this.oS.kyb(this.HTf)}Qmi(){this.Rna&&(this.u$a.bF(),this.u$a.renderRuler(),this.tZd()&&this.I6i())}I6i(){this.SUe.bF();this.SUe.renderRuler()}fdf(){this.SUe.dispose()}tZd(){return this.izi()&&this.isPaginatedView()}izi(){null==this.fFe&&null!=v.AFrameworkApplication.K&&(this.fFe=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.fFe}tTa(){this.Rna||Sa.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(b=>
{b.logActivity("TurnRulerOnActivity",null)})}G2(){this.jKa.tVn(this.kji);this.jKa.O5i(this.KEb);this.Rna&&(this.u$a.dispose(),this.tZd()&&this.fdf())}QAj(){if(this.SQb){const b={};b[Dp.TTo]="ToggleButtonModel";this.SQb.CG(b)}}gqo(b,h){if(!Tl.Ok.O7(b.Yj))return u.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),Tl.recordQosError(this.Ich,[Tl.Wda],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.Rna=!0;this.FOe.qaj(!0);this.Qmi();this.QAj();
u.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.yO);b.set("Response","");wa.Health.instance.recordKpiUsage(Dp.kpiName,1,Dp.y7,b);return 32}isPaginatedView(){return 1===this.oS.tv}IZc(b,h){switch(h.documentMode){case "View":this.Rna&&(this.ga.processAction(qa.a.XNb,2),this.ZAe=!0);break;case "Edit":this.ZAe&&(this.ga.processAction(qa.a.XNb,2),this.ZAe=!1)}}HTf(b,h){if(Tl.instance.Rna&&Tl.instance.izi())switch(h.Ucc){case 1:Tl.instance.I6i();
break;case 0:Tl.instance.fdf()}}static recordQosError(b,h,t){const A=Object.assign(new Hb.a,{extendedProperties:new Map});t&&A.extendedProperties.set("exception",t);wa.Health.instance.recordQosError(b,h,!1,!0,!1,!1,A)}static vE(){return new Tl(v.AFrameworkApplication.xa,rs.instance,eu.instance,Jb.App.ya,Sa.a.instance.resolve("WordEditor.IRulerContextMenu"),Sa.a.instance.Ma("WordEditor.Ruler.IRulerSettingInfo"),Sa.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Aq.a.instance,
Sa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=Tl.Xxg?Tl.Xxg:Tl.Xxg=Tl.vE()}}Tl.Ok=null;Tl.Wda="RulerInteractionFailed";Object(m.a)(Tl,"RulerActor",null,[]);class Qt{constructor(b,h){this.fzc=null;this.Z3a=t=>t.result?t.result.Value.toString():"";this.QFa=t=>{t.wo||t.Ai?(u.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.fzc=!1):(t=t.result,""===t&&v.AFrameworkApplication.K&&(t=v.AFrameworkApplication.K.kb("RulerDefaultOn")),
this.fzc="true"===t.toLowerCase(),u.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.fzc};this.ov=b;this.cK=h}$3l(){const b=new xm.a;if(null==this.fzc){if(this.Qwi())return this.cK.R4a(wC.a.o4c).CWRCo(this.Z3a,0).CWRCo(this.QFa,8);b.xg(!1)}else b.xg(this.fzc);return b.task}O0(b){this.cK.O0(wC.a.o4c,new LE.a(wC.a.o4c,b))}qaj(b){this.Qwi()&&(this.ov.kia("saveRulerIsEnabled",b.toString()),u.ULS.sendTraceTag(591541276,
3014,50,"Try to save ruler settings value to Roaming Service."));this.O0(b)}Qwi(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser");if(v.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)u.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(m.a)(Qt,"RulerSettingInfo",null,[166]);class Yk{constructor(){this.nWg=this.W=null}get name(){return"WordEditor.Ruler"}yc(b){this.W=b;u.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ha("WordEditor.Ruler.RulerSettingInfo",
()=>new Qt(this.W.resolve("Box4.IRoamingServiceRequestManager"),this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").singleInstance();this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>{this.$m()});this.nWg=Tl.instance.initialize();u.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}$m(){this.nWg.continueWith(()=>{Tl.instance.Qmi();Tl.instance.tTa()});u.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){Tl.instance.G2();
u.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(m.a)(Yk,"PackageManager",null,[1,2]);class nD{constructor(){this.S8b=this.F_b=null}}Object(m.a)(nD,"CreatePickerCustomizationDictionaryOptions",null,[934]);class oD{}oD.Wg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(m.a)(oD,"InsertMediaM365DialogHtml",
null,[]);class XC{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd,ee){this.V2=ee;this.c9a=null;this.GAf=this.Gld=!1;this.bmj=Od=>{if(Od.rawEvent&&(Od=Od.rawEvent.data))try{const fe=Sys.Serialization.JavaScriptSerializer.deserialize(Od,!0),Ee=fe.MessageId?fe.MessageId.toString():null;fe&&Ee&&(Ee===K.a.insertImage||Ee===K.a.Uxf)&&this.$wc.start(Ee===K.a.insertImage?this.K$a:this.yWg)}catch(fe){}};this.xNo=(Od,fe,Ee,re,Fg)=>{if(1===Ee)return 32;this.cZg?Od=CommonUIStrings.l_OneDriveName:""!==
this.Yid?Od=this.Yid:(Od=CommonUIStrings.l_HostGeneric,u.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));Fg[Ck.a.LabelText]=Od;return 32};this.ANo=(Od,fe,Ee,re,Fg)=>{if(1===Ee)return 32;if(!v.AFrameworkApplication.tBf())return Fg[Ck.a.Visible]=!1,32;this.cZg?Od=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.Yid?Od=String.format(CommonUIStrings.l_ChangePictureFromHost,this.Yid):
(Od=CommonUIStrings.l_ChangePictureFromHostGeneric,u.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));Fg[Ck.a.LabelText]=Od;return 32};this.yNo=(Od,fe,Ee,re,Fg)=>{if(1===Ee)return 32;v.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(Fg[Ck.a.Visible]=!1);return 32};this.zNo=(Od,fe,Ee,re,Fg)=>{if(1===Ee)return 32;v.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(Fg[Ck.a.Visible]=
!1);return 32};this.Nge=(Od,fe,Ee)=>{var re;fe=this.utc.value.Mea(fe);if(1===Ee)return fe&&this.J$a.tEm?32:8;if(2!==Ee||!fe)return 8;(null===(re=v.AFrameworkApplication.K)||void 0===re?0:re.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Gr.a.instance.W4a("PictureBing");this.c9a=Ya.a.create();u.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");Od=this.cTl(Od,this.c9a);Od=this.LWe(Od);Od=this.Tjd.qNc(Od);Od.correlationId=
this.c9a;Od.i9b=this.zWg;Od.Zga=1;return this.Lge(Od,CommonUIStrings.L_PictureInsertTitle,this.K$a)};this.npo=(Od,fe,Ee)=>{Od=32===this.ga.Nf(fe,qa.a.insertHyperlink,1,!1,null,null);if(1===Ee)return Od&&this.J$a.Pti?32:8;if(2!==Ee||!Od)return 8;u.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.Lge(this.xWg.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.yWg)};this.Nlj=(Od,fe,Ee)=>{Od=this.utc.value.Mea(fe);
if(1===Ee)return Od&&this.J$a.sBf?32:8;if(2!==Ee||!Od)return 8;u.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.Lge(this.xWg.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.K$a)};this.Jge=(Od,fe,Ee)=>{var re;fe=this.utc.value.Mea(fe);if(1===Ee)return fe&&this.J$a.vEm?32:8;if(2!==Ee||!fe)return 8;u.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");(null===
(re=v.AFrameworkApplication.K)||void 0===re?0:re.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Gr.a.instance.W4a("PictureStock");this.c9a=Ya.a.create();Ee=v.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.HJ.isFreemiumUpsellEnabled();Ee=this.Gld?1:Ee?0:-1;Od=this.GVl(Od,this.c9a,Ee);Od=this.Tjd.qNc(Od);Od.Wg=oD.Wg;Od.correlationId=this.c9a;Od.Zga=2;Od.i9b=this.zWg;Od.yea=this.HJ;Od.mCj=Ee;return this.Lge(Od,CommonUIStrings.L_PictureInsertTitle,
this.K$a)};this.Oge=(Od,fe,Ee)=>{var re;fe=this.utc.value.Mea(fe);Od=Sa.a.instance.Ma("Common.App.SharedFilePicker.ISharedFilePicker");if(1===Ee)return fe&&!this.J$a.sBf&&Od&&Od.EDf()?32:8;if(2!==Ee||!fe||!Od)return 8;u.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");(null===(re=v.AFrameworkApplication.K)||void 0===re?0:re.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Gr.a.instance.W4a("PictureOneDrive");this.c9a=
Ya.a.create();Ee=XC.jhh;re=!1;v.AFrameworkApplication.uBf()&&(re=this.fDl());fe=new nD;fe.F_b=re;fe.S8b=!0;Ee=Od.m9e(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,Ee,"Insert Media",1,fe);Od.KNd(Ee).then(Fg=>{if(null!=Fg&&0<Fg.length){const Gg=[];for(let bm=0;bm<Fg.length;bm++){const An=Fg[bm][J.a.fWi],Zr=Fg[bm][J.a.eWi],Av={};Av.Extension=An;Av.OriginalUrl=Zr;Av.caption=An;Gg.push(Av)}this.K$a.gPa=qa.a.BZ;this.K$a.F1a(Gg)}});return 32};this.Mge=(Od,fe,Ee)=>{var re;const Fg=this.utc.value.Mea(fe);
fe=Sa.a.instance.Ma("Common.App.SharedFilePicker.ISharedFilePicker");if(1===Ee)return Fg&&fe&&fe.EDf()?32:8;if(2!==Ee||!Fg||!fe)return 8;Ee=Sa.a.instance.Ma("Common.App.PhoneLink.IPhoneLinkManager");null!=Ee&&Ee.Ysl(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));u.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");(null===(re=v.AFrameworkApplication.K)||void 0===re?
0:re.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Gr.a.instance.W4a("PictureMobile");this.c9a=Ya.a.create();re=XC.jhh;Ee=new nD;Ee.F_b=!0;Ee.S8b=!0;re=fe.m9e(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,re,"InsertPictureFromMobile",3,Ee);fe.KNd(re).then(Gg=>{if(null!=Gg&&0<Gg.length){var bm=[];const An=Od===qa.a.XUd;let Zr=!1;const Av=v.AFrameworkApplication.K.kb("PhoneLinkServiceEndpoint");for(let KA=0;KA<Gg.length;KA++){const LA=
Gg[KA][J.a.fWi],AD=Gg[KA][J.a.eWi],Sy={};Sy.Extension=LA;Sy.OriginalUrl=AD;Sy.caption=LA;bm.push(Sy);Zr||(Zr=-1!==Sy.OriginalUrl.indexOf(Av))}this.K$a.gPa=qa.a.BZ;this.K$a.F1a(bm);bm={};bm.InsertImageCount=Gg.length;Zr&&lb.c(An?qa.a.Mtm:qa.a.vNk,void 0,void 0,void 0,void 0,void 0,bm)}});return 32};this.$wc=A;this.Uod=O;this.Tjd=ua;this.xWg=Ra;this.O1=ub;this.ga=b;this.utc=aa;this.cZg=Dc;this.Yid=jd;this.J$a=t;this.K$a=Nb;this.yWg=Yb;this.zWg=Cd;(this.HJ=bc)&&this.HJ.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(Od=>u.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",Od)).then(Od=>{(this.Gld=Od)||this.HJ.Axa("MsoPremiumStockImages",()=>{this.Gld=!0;u.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Ub(){(this.J$a.sBf||this.J$a.Pti)&&this.J$a.uEm&&this.ozn();this.lPn();this.kPn();this.ga.gb(qa.a.Eyh,mc.a.view,this.Nlj,1284);this.ga.gb(qa.a.JZi,
mc.a.view,this.ANo,1124);this.ga.gb(qa.a.eyf,mc.a.view,this.Nlj,1284);this.ga.gb(qa.a.OZf,mc.a.view,this.xNo,1124);this.ga.gb(qa.a.Utm,mc.a.view,this.npo,1284)}lPn(){this.ga.gb(qa.a.insertOnlinePicture,mc.a.view,this.Nge,1284);this.ga.gb(qa.a.UUd,mc.a.view,this.Jge,1284);this.ga.Nha("word_insertOnlinePictures",qa.a.insertOnlinePicture,mc.a.view,this.Nge,b=>{Jb.App.ya.plc(b,Object(z.a)(new dr.a,(new dr.a).MCb,"getCommandById"))});this.ga.Nha("word_insertOnlinePictures",qa.a.UUd,mc.a.view,this.Jge,
b=>{Jb.App.ya.plc(b,Object(z.a)(new dr.a,(new dr.a).MCb,"getCommandById"))});this.ga.gb(qa.a.q4e,mc.a.view,this.Nge,1284);this.ga.gb(qa.a.s4e,mc.a.view,this.Oge,1284);this.ga.Nha("word_insertOnlinePictures",qa.a.s4e,mc.a.view,this.Oge);this.ga.gb(qa.a.t4e,mc.a.view,this.Jge,1284);this.ga.gb(qa.a.HZi,mc.a.view,this.yNo,1284);this.ga.gb(qa.a.IZi,mc.a.view,this.zNo,1284);this.ga.Nha("word_insertOnlinePictures",qa.a.q4e,mc.a.view,this.Nge);this.ga.Nha("word_insertOnlinePictures",qa.a.t4e,mc.a.view,this.Jge);
this.ga.gb(qa.a.gyf,mc.a.view,this.Oge,1284);this.ga.Nha("word_insertOnlinePictures",qa.a.gyf,mc.a.view,this.Oge,b=>{Jb.App.ya.plc(b,Object(z.a)(new dr.a,(new dr.a).MCb,"getCommandById"))})}kPn(){v.AFrameworkApplication.uBf()&&(this.ga.gb(qa.a.XUd,mc.a.view,this.Mge,1284),this.ga.gb(qa.a.r4e,mc.a.view,this.Mge,1284),this.ga.Nha("mso_insertMobileDevicePictures",qa.a.XUd,mc.a.view,this.Mge,b=>{Jb.App.ya.plc(b,Object(z.a)(new dr.a,(new dr.a).MCb,"getCommandById"))}),this.ga.Nha("mso_insertMobileDevicePictures",
qa.a.r4e,mc.a.view,this.Mge,b=>{Jb.App.ya.plc(b,Object(z.a)(new dr.a,(new dr.a).MCb,"getCommandById"))}))}ozn(){v.AFrameworkApplication.ta.get_element().appendChild(this.Uod.A_a);Hf.a.addHandler(this.Uod.A_a.contentWindow,"message",this.bmj);this.GAf=!0}cTl(b,h){let t=0;v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob&&5===v.AFrameworkApplication.ta.Ob.jm&&(t=12);const A=Sf.a.lg(v.AFrameworkApplication.lcid);return String.format(v.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,
b===qa.a.insertOnlinePicture?1:0,v.AFrameworkApplication.lcid,A?A.name:"en-us",v.AFrameworkApplication.buildVersion,h,t,v.AFrameworkApplication.K.kb("UserId"))}Lge(b,h,t){try{return b.Kge(h,t),u.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(A){return u.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",A.toString()),this.Lp(nm.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,
Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}GVl(b,h,t){if(qa.a.UUd===b)return b=this.O1.Puh(v.AFrameworkApplication.K.kb("InsertOnlineM365PictureEndpoint"),h.toString(),1,t),this.LWe(b);b=this.O1.Puh(v.AFrameworkApplication.K.kb("InsertOnlineM365PictureEndpoint"),h.toString(),0,t);return this.LWe(b)}Lp(b,h,t){const A=new cf.StandardDialog(!0);A.ht=v.AFrameworkApplication.hba;A.zd=0;A.Ge(1,CommonUIStrings.l_DialogClose);A.Sw(b,h,t,()=>{})}fDl(){const b=Sa.a.instance.Ma("Common.App.PhoneLink.IPhoneLinkManager");
return null!=b?b.cHl():!1}dispose(){this.GAf&&this.Uod.A_a.contentWindow&&(Hf.a.removeHandler(this.Uod.A_a.contentWindow,"message",this.bmj),this.GAf=!1)}LWe(b){return this.V2&&this.V2.oK?(b=new jb.QueryStringBuilder(b),b.De("theme","4"),b.toString()):b}}XC.jhh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(m.a)(XC,"InsertMediaActor",null,[9]);var DC=c(958);class OE extends DC.a{constructor(b,h){super(b,ia.a.getOrigin(h))}Sq(b,h){this.isEnabled()&&this.S$(this.A6a)&&(this.pv(b),this.uB(b,
h))}}Object(m.a)(OE,"InsertMediaCrossDocumentMessenger",DC.a,[387,72,9]);class PE{getInstance(b,h){return new OE(b,h)}}Object(m.a)(PE,"InsertMediaCrossDocumentMessengerFactory",null,[350]);var yF=c(774);class EC{}EC.Wg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(m.a)(EC,"InsertMediaDialogHtml",null,[]);var FA;(function(b){b[b.OK=
0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(FA||(FA={}));Object(m.b)("HubbleAction",FA);var GA;(function(b){b[b.unknown=0]="unknown";b[b.bing=1]="bing";b[b.M365=2]="M365";b[b.icons=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.hubble=5]="hubble"})(GA||(GA={}));Object(m.b)("InsertMediaProviders",GA);class pD extends Pf.a{constructor(b,h,t,A=null,O=!1){super(!1,!1,O);this.OA=null;this.Frc=!1;this.TWc=this.F_=null;this.c3e="KeepFocusDiv";this.aBd="KeepFocusStartDiv";this.correlationId=
null;this.Zga=0;this.yea=this.i9b=null;this.mCj=0;this.NGe=null;this.ajn=()=>{this.F_&&(this.F_.style.visibility="visible",window.setTimeout(()=>{if(this.gj){const aa=this.gj.getElementById(this.aBd);aa&&aa.focus()}},0))};this.uba=aa=>{aa.keyCode===Sys.UI.Key.tab&&(aa.target.id!==this.c3e||aa.shiftKey?aa.target.id===this.aBd&&aa.shiftKey&&(aa.preventDefault(),this.gj.getElementById(this.c3e).focus()):(aa.preventDefault(),this.gj.getElementById(this.aBd).focus()))};this.QMi=()=>{u.ULS.sendTraceTag(17662422,
352,100,"OnCancelDialog : Got message.");this.MBb(this.JYa);this.dnb(1)};this.dOi=()=>{this.OA&&(u.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.OA.sendMessage(K.a.$$n,{["CustomHeaders"]:""}))};this.gOi=()=>{this.OA&&(u.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.OA.sendMessage(K.a.Zfo,{["SessionId"]:v.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.cOi=()=>{this.OA&&(u.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),
this.OA.sendMessage(K.a.h$n,{["CID"]:""}))};this.vjn=()=>{this.yea&&(u.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.yea.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.Ujd=b;this.RSb="";this.O1=t;this.Yda=[];this.gqd=h;this.Wg=A||EC.Wg;this.sg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}Kge(b,h){this.RSb=b;
this.Frc=!1;this.showDialog(this.RSb,null);this.F_=this.m6b(this.kj("insertmediaframe"));if(!this.F_)throw this.MBb(this.JYa),Error.invalidOperation("Couldn't get InsertMediaIframe.");b=document.createElement("div");b.setAttribute("Id",this.aBd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.F_.parentNode.insertBefore(b,this.F_.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.c3e);
b.setAttribute("tabindex","0");this.F_.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.Wbf,"keydown",this.uba);this.F_.src=this.Ujd;this.F_.style.width="100%";this.F_.style.height="100%";this.F_.frameBorder="0";v.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&ba.a.jj?(this.F_.style.visibility="hidden",this.TWc=this.ajn,Hf.a.addHandler(this.F_,"load",this.TWc)):this.F_.style.visibility=
"visible";this.m6b(this.kj("WACDialogButtonPanel")).style.display="none";this.m6b(this.kj("WACDialogTitleText")).style.display="none";2===this.Zga&&(this.m6b(this.kj("WACDialogTitlePanel")).style.display="none",this.m6b(this.kj("WACDialogBodyPanel")).style.padding="0");yd.FocusManager.instance().Hs().scope.zH=!0;this.OA=this.gqd.getInstance(this.F_.contentWindow,this.Ujd);this.OA.S$("https://osiziwuspersimmon002.blob.core.windows.net");this.OA.S$("https://osizewuspersimmon001.blob.core.windows.net");
this.OA.S$("https://osizpscuspersimmon000.blob.core.windows.net");this.OA.S$("https://cdn.hubblecontent.msit.osi.office.net");this.OA.S$("https://cdn.hubblecontent.osi.office.net");this.OA.Sq(K.a.Ekh,t=>{this.hMi(t,Object(z.a)(h,h.F1a,"insertMediaCallback"))});this.OA.Sq(K.a.insert,t=>{this.u5d(t,Object(z.a)(h,h.F1a,"insertMediaCallback"))});this.OA.Sq(K.a.Omk,t=>{this.wkn(t)});this.OA.Sq(K.a.r3h,this.dOi);this.OA.Sq(K.a.getSessionId,this.gOi);this.OA.Sq(K.a.c1h,this.cOi);this.OA.Sq(K.a.tBd,this.QMi);
2!==this.Zga||this.mCj||(this.OA.Sq(K.a.gQm,this.vjn),this.NGe=this.yea.Axa("MsoPremiumStockImages",t=>{u.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.OA.sendMessage(K.a.vSo,{["LicenseTier"]:t.toString()})}));this.dnb(3)}dispose(){this.yea&&this.NGe&&this.yea.Yfc("MsoPremiumStockImages",this.NGe);this.OA&&(this.OA.dispose(),this.OA=null);this.TWc&&(Hf.a.removeHandler(this.F_,"load",this.TWc),this.TWc=null);super.dispose()}hMi(b,h){u.ULS.sendTraceTag(7135752,
352,100,"OnAddItem : Got message.");if(b=this.O1.$tn(b))this.Yda.push(b),this.Frc&&(h(this.Yda),this.Frc=!1)}Lp(){const b=new cf.StandardDialog(!0);b.ht=v.AFrameworkApplication.hba;b.zd=0;b.Ge(1,CommonUIStrings.l_DialogOk);b.Au(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}dnb(b){var h=RegExp("hubble","gi");if(this.i9b&&0<this.i9b.search(h)&&this.correlationId){h=v.AFrameworkApplication.sessionStartInfoSettings;var t={};t.InsertedFiles=this.Yda.length;
t.MediaDetails=this.Yda;t.DialogResult=FA[b];t.DialogMode=this.upf();t.CorrelationId="{"+this.correlationId.toString()+"}";t.Platform="Wac";t.Provider=GA[this.Zga]||"Unknown";t.AudienceGroup=h&&"AudienceGroup"in h?h.AudienceGroup.toString():"Unknown";t.Ring=h&&"Ring"in h?h.Ring.toString():"Unknown";t.AppId=2;t.Build=v.AFrameworkApplication.buildVersion;t.Locale=Sf.a.lg(v.AFrameworkApplication.lcid).name;this.tzn().send(JSON.stringify(t))}2===this.Zga&&(t=v.AFrameworkApplication.K.kb("InsertMediaDialogAriaTenantNameSpace"))&&
""!==t&&(h=[],h.push(Object.assign(new sa.a,{name:"InsertedFiles",int64:this.Yda.length})),h.push(Object.assign(new sa.a,{name:"MediaDetails",string:JSON.stringify(this.Yda)})),h.push(Object.assign(new sa.a,{name:"DialogResult",string:FA[b]})),h.push(Object.assign(new sa.a,{name:"DialogMode",string:this.upf()})),h.push(Object.assign(new sa.a,{name:"CorrelationId",string:this.correlationId.toString()})),h.push(Object.assign(new sa.a,{name:"Provider",string:GA[this.Zga]||"Unknown"})),ja.a.sendTelemetryEvent(Object.assign(new ta.a,
{name:String.format("{0}.{1}",t,this.telemetryEventName),dataFields:h})))}upf(){return 3===this.Zga?"Icons":5===this.Zga?"ExternalContent":"Images"}m6b(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return h}tzn(){const b=new XMLHttpRequest;b.open("POST",this.i9b,!0);b.setRequestHeader("Content-Type","");return b}u5d(b,h){u.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.MBb(this.JYa);h?this.Yda&&50<this.Yda.length?(this.Lp(),
this.dnb(0),u.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Yda.length,GA[this.Zga])):this.Yda&&0<this.Yda.length?(h(this.Yda),this.dnb(0),u.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Yda.length,GA[this.Zga])):(u.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.Frc=!0,h(this.Yda),this.dnb(2)):this.dnb(2)}wkn(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,
u.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),ja.a.sendOtelEvent(Object.assign(new yF.a,{otelEvent:b})))}}Object(m.a)(pD,"InsertMediaDialog",Pf.a,[349,9]);class QE{constructor(b,h){this.sCe=b;this.O1=h}qNc(b,h=!1){return new pD(b,this.sCe,this.O1,EC.Wg,h)}getInstance(){throw Error.notImplemented();}}Object(m.a)(QE,"InsertMediaDialogFactory",null,[348]);class PB{constructor(b,h,t){this.Dqi=!1;this.correlationId=null;this.Zga=0;this.i9b=null;this.d_j=b;this.rBc=[];this.Zid=
h;this.eeh=t.split(";")}Kge(b,h){Array.clear(this.rBc);b=this.d_j.value;b.S$(this.Zid);b.pv(h.dQc);this.Dqi||(b.uB(h.dQc,t=>{this.u5d(t,h)}),this.Dqi=!0);u.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.WJh,{["FileExtensionFilterList"]:this.eeh})}Wok(b){Array.contains(this.rBc,b)||this.rBc.push(b)}u5d(b,h){u.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.SUi(b);const t=[];
for(let A=0;A<b.length;A++){const O=b[A];h.LWd(O,this.eeh)?t.push(O):this.Wok(h.mbi(O))}t&&t.length?h.F1a(t):u.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.rBc.length&&(h=this.rBc.join(", "),u.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),this.Mqo(h))}Mqo(b){const h=new cf.StandardDialog;h.zd=0;h.PU(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,
b),null)}dispose(){}}Object(m.a)(PB,"InsertMediaFromHostManager",null,[349,9]);class aq{constructor(b){this.m0j=b}qNc(){throw Error.notImplemented();}getInstance(){return this.m0j}}Object(m.a)(aq,"InsertMediaFromHostManagerFactory",null,[347,348]);class YD{constructor(){this.A_a=document.createElement("iframe");this.A_a.src="about:blank";this.A_a.style.visibility="hidden";this.A_a.style.position="absolute";this.A_a.style.zIndex="-100"}}Object(m.a)(YD,"InsertMediaFromHostOneDriveHostFrame",null,[346]);
class RE extends DC.a{constructor(b,h){super(b,"*"===h?h:ia.a.getOrigin(h));this.Hjh(K.a.insertImage);this.Hjh(K.a.Uxf)}Zbe(){}}Object(m.a)(RE,"InsertMediaFromOneDriveCrossDocumentMessenger",DC.a,[345,72,9]);class qD{}Object(m.a)(qD,"OnlineMediaSearchResult",null,[]);class FC{Puh(b,h,t,A){const O=Sf.a.lg(v.AFrameworkApplication.lcid).name,aa=v.AFrameworkApplication.buildVersion,ua=F.a.FW(v.AFrameworkApplication.K.kb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Ra=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",
!1)?1:0;v.AFrameworkApplication.ye("ShIns226;ShIns226cf");return String.format(b,v.AFrameworkApplication.lcid,O,aa,h,FC.upe,ua,A,t,Ra)}return String.format(b,v.AFrameworkApplication.lcid,O,aa,h,FC.upe,ua,A,t)}$tn(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new qD,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",
ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||"",ProviderName:b.providerName||""})}aun(b){const h=[];if(!b||!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let A=0;A<b.length;A++){var t=b[A];t&&(t=Object.assign(new qD,{Type:t.Extension||"",OriginalUrl:t.SourceUrl||"",Caption:t.caption,Height:t.Height||0,Width:t.Width||0}),h.push(t))}return h}wVf(b){const h=
[];for(let A=0;A<b.data.files.length;A++){var t=b.data.files[A];t&&(t=Object.assign(new qD,{ContentType:t.itemType||"",Type:t.extension||"",OriginalUrl:t.urls&&t.urls.open?t.urls.open:"",Height:t.photo?t.photo.height:0,Width:t.photo?t.photo.width:0}),h.push(t))}return h}LWd(b,h){if(!b)return!1;for(let t=0;t<h.length;t++)if(0<=b.toLowerCase().indexOf(h[t]))return!0;return!1}jzn(b){let h="";if(b)for(let t=0;t<b.length;t++){const A=b[t];A&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',
A.OriginalUrl,A.Width,A.Height))}return h}}FC.upe=0;Object(m.a)(FC,"InsertMediaHelper",null,[344]);class QB{constructor(b,h,t,A,O){this.tEm=b;this.sBf=h;this.Pti=t;this.uEm=A;this.vEm=O}}Object(m.a)(QB,"InsertMediaSettingsManager",null,[]);class ur{constructor(b){this.Etc=qa.a.insertHyperlink;this.ga=b}get gPa(){return this.Etc}set gPa(b){this.Etc=b}F1a(b){try{u.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Rb(this.gPa,
2,b[h]);u.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(h){u.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",h.toString())}}}Object(m.a)(ur,"InsertOneDriveFileHandler",null,[335]);class ZD extends ur{constructor(b){super(b)}get WJh(){return K.a.Uxf}get dQc(){return K.a.otm}SUi(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}mbi(){Jc.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");
return""}LWd(){return!0}TYi(b,h,t){b=t(b);b.length&&(t={},t.Items=b,h.sendMessage(this.dQc,t))}UUi(b){const h=[];for(let t=0;t<b.data.files.length;t++){const A=b.data.files[t];if(A){const O={};O.DisplayText=String.format("{0}{1}",A.name,A.extension);O.Url=this.Zwl([A.urls.viewInBrowser,A.urls.open,A.urls.download]);h.push(O)}}return h}Zwl(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];u.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(m.a)(ZD,
"InsertOneDriveFileHelper",ur,[334,335]);class rD{constructor(b,h,t){this.Etc=qa.a.BZ;this.Mp=null;this.ga=b;this.O1=h;this.dea=t}get rc(){return this.ga}get lu(){return this.Mp||(this.Mp=Sa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get gPa(){return this.Etc}set gPa(b){this.Etc=b}F1a(b){try{u.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",b.length);const h=this.O1.jzn(b);let t=2;if(h&&0<h.length){const A=new ji.DictionaryPropertySet;
A.setValue(Gd.a.EO,h);A.setValue(Gd.a.v3,!0);if(this.dea){const O=this.dea.E7c();O.V_b("insertOnlineImage");A.setValue(Gd.a.Ata,O)}t=this.ga.Rb(this.gPa,2,A)}u.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===t,""===h)}catch(h){u.ULS.JH(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(m.a)(rD,"InsertOnlineImageHandler",null,[335]);class sD extends rD{constructor(b,
h,t=null){super(b,h,t)}get WJh(){return K.a.insertImage}get dQc(){return K.a.Atm}SUi(b){return this.O1.aun(b)}mbi(b){return b.Type}LWd(b,h){return this.O1.LWd(b.Type,h)}UUi(b){return this.O1.wVf(b)}TYi(b,h,t){t=t(b);if(t.length){b=[];for(let A=0;A<t.length;A++){const O=t[A],aa={};aa.Extension=O.Type;aa.SourceUrl=O.OriginalUrl;aa.caption=O.Type;aa.SourceUrl=O.OriginalUrl;aa.Width=O.Width;aa.Height=O.Height;b.push(aa)}t={};t.Items=b;h.sendMessage(this.dQc,t)}}}Object(m.a)(sD,"InsertOnlineImageHelper",
rD,[334,335]);class SE{constructor(b,h){this.jsb=b;this.gqd=h}start(b){this.jsb.start({mode:"open",select:"multi",lightbox:"white"},(h,t)=>{this.processResponse(h,t,b)})}processResponse(b,h,t){u.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.gqd.getInstance(window.frames[0].parent,window.document.URL),t.TYi(h,b,A=>t.UUi(A))):u.ULS.sendTraceTag(22090010,
352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(m.a)(SE,"OneDriveFilePickerHelperV5",null,[167]);class RB{constructor(){this.Sjd=this.W=null}get name(){return"Box4.Media"}yc(b){this.W=b;b.ha("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new YD).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").singleInstance();const h=new QB(Boolean.parse(v.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||"false"),v.AFrameworkApplication.tBf(),
!1,v.AFrameworkApplication.Eag(),v.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ha("Box4.Media.OneDriveFilePickerHelperV5",()=>new SE(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").singleInstance();b.ha("Box4.Media.InsertMediaActor",()=>new XC(v.AFrameworkApplication.xa,v.AFrameworkApplication.K,h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),
b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new Pg.a(()=>Sa.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),v.AFrameworkApplication.RGb,v.AFrameworkApplication.ioa,
v.AFrameworkApplication.wlm,v.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).singleInstance();b.ha("Box4.Media.InsertMediaDialogFactory",()=>new QE(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").singleInstance();b.ha("Box4.Media.InsertMediaFromHostManagerFactory",()=>new aq(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").singleInstance();
b.ha("Box4.Media.InsertMediaFromHostManager",()=>new PB(new Pg.a(()=>{if(v.AFrameworkApplication.Eag()){var t=Sa.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").A_a;t=new RE(t.contentWindow,"*")}else t=v.AFrameworkApplication.vX;return t}),v.AFrameworkApplication.Eag()?ia.a.getOrigin(window.document.URL):ia.a.getOrigin(v.AFrameworkApplication.CKb),v.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).singleInstance();b.register(PE,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").singleInstance();
b.register(FC,"Box4.Media.InsertMediaHelper").singleInstance();b.ha("Box4.Media.InsertOnlineImageHelper",()=>new sD(v.AFrameworkApplication.xa,b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Media.InsertOneDriveFileHelper",()=>new ZD(v.AFrameworkApplication.xa)).singleInstance()}init(){this.Sjd=this.W.resolve("Box4.Media.InsertMediaActor");this.Sjd.Ub()}dispose(){this.Sjd&&this.Sjd.dispose()}}Object(m.a)(RB,"MediaPackage",null,
[1,2]);var GC=c(289);class qt{constructor(){this.c2n="getAddinShortcutsPreference";this.d2n="saveAddinShortcutsPreference";this.e2n="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.IDl=6E4;this.I3d=this.Sla=this.n9=null}ubi(b){return String.format(this.e2n,v.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,v.AFrameworkApplication.fm)}executeRequest(b,h,t,A,O=null){return qt.NP.h_b(b,h,O,null,t,A,!1,null,this.IDl)}saveSetting(b,h,t,A,O){return this.raj(b,h,t,null,A,
O)}startBatchUpdateScope(){this.I3d=[]}saveShortcutInfoArrayBatch(b,h,t){this.g4n(t,b,h)}g4n(b,h,t){const A={action:"",addinId:"",ownerType:0};A.timestamp=(new Date).toUTCString();const O=this.getShortcutInfoArray(h.toString(),t.toString());b?(A.shortcutInfoArray=b,this.KWe(h,t,b)):O&&(A.shortcutInfoArray=O);b={};b[h.toString()]=A;h=new GC.a(t.toString(),b);this.I3d.push(h)}commitBatchUpdateScope(){return this.I6c()?this.i4n().then(()=>{this.N0b();return Promise.resolve(!0)}):this.k4n().then(()=>
{this.N0b();return Promise.resolve(!0)})}i4n(){return this.getSetting().then(b=>{let h=null;if(b&&!({Nu:h}=E.d(b)).returnValue)return u.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const t of this.I3d){(b=h[t.key])||(b={});const A=t.value;for(const O of ob.a.gO(A))b[O]=A[O];h[t.key]=b}this.n9=h;try{return localStorage.setItem("AddinShortcutPreferenceData",E.c(h)),Promise.resolve(!0)}catch(t){return u.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",t),Promise.resolve(!1)}})}k4n(){return this.X8n().then(b=>this.kde(b))}X8n(){return this.Drf().then(b=>{let h=null;b&&(({Nu:h}=E.d(b)).returnValue||u.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const t of this.I3d){(b=h[t.key])||(b={});const A=t.value;for(const O of ob.a.gO(A))b[O]=A[O];h[t.key]=b}this.n9=h;return E.c(h)})}saveShortcutInfoArray(b,h,t){return this.raj(0,
"","",t,b,h)}raj(b,h,t,A,O,aa){const ua=this.I6c(),Ra={};Ra.action=t;Ra.addinId=h;Ra.ownerType=b;Ra.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(O.toString(),aa.toString());0===b&&A?(Ra.shortcutInfoArray=A,this.KWe(O,aa,A)):h&&(Ra.shortcutInfoArray=h);b={};b[O.toString()]=Ra;O=new GC.a(aa.toString(),b);return ua?this.h4n(O):this.j4n(O)}h4n(b){return this.getSetting().then(h=>{let t=null;if(h&&!({Nu:t}=E.d(h)).returnValue)return u.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);t||(t={});t[b.key]=b.value;this.n9=t;try{return localStorage.setItem("AddinShortcutPreferenceData",E.c(t)),Promise.resolve(!0)}catch(A){return u.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",A),Promise.resolve(!1)}})}j4n(b){return this.W8n(b).then(h=>this.kde(h))}W8n(b){return this.Drf().then(h=>{let t=null;h&&(({Nu:t}=E.d(h)).returnValue||u.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
t||(t={});t[b.key]=b.value;this.n9=t;return E.c(t)})}saveSettings(b){this.n9=E.a(b);this.N0b();return this.I6c()?this.uaj(b):this.kde(b)}uaj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return u.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}kde(b){const h={};h.Wac=b;const t=E.c(h);return new Promise(A=>{try{if(void 0===t||null===t||!t.length||1E6<=t.length)A(!1);else{var O=this.executeRequest(this.ubi(this.d2n),
2,"SaveAddinShortcutsPreferenceRequest","38",t);O.continueWith(()=>{if(O.wo||O.Ai)u.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),A(!1);else{var aa=O.result;void 0!==aa.args&&null!==aa.args&&void 0!==aa.args.data&&null!==aa.args.data&&aa.args.data.Ve===ca.a.oz?A(!0):A(!1)}})}}catch(aa){u.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",aa.toString()),A(!1)}})}getSetting(){const b=this.I6c();return this.n9?Promise.resolve(E.c(this.n9)):
b?this.v5l():this.Drf()}I6c(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser"),h=v.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return b||!h}v5l(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return u.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),Promise.resolve("")}}Drf(){return new Promise((b,h)=>{try{const t=this.executeRequest(this.ubi(this.c2n),1,"GetSettingRequest","37");t.continueWith(()=>{if(t.wo||
t.Ai)u.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let O="";var A=t.result;A&&A.args&&A.args.data?A.args.data.Ve!==ca.a.oz?u.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",A.args.data.Ve):A.args.data.we?(A=E.a(A.args.data.we),A.Wac&&(O=A.Wac)):u.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):u.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(O)}})}catch(t){u.ULS.sendTraceTag(522739866,
0,10,"GetSettingFromRoaming Exception handling request {0}",t.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.I6c(),t=this;return this.getSetting().then(A=>{let O=null;A&&(O=E.a(A));if(!O)return u.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const aa of ob.a.gO(O)){A=O[aa.toString()];for(const ua of ob.a.gO(A)){const Ra=A[ua];if(Ra.addinId===b)delete A[ua.toString()];else if(0===Ra.ownerType&&
Ra.shortcutInfoArray){const ub=Ra.shortcutInfoArray,Nb=new Mb.a;for(let Yb=0;Yb<ub.length;++Yb)ub[Yb].addinId!==b&&Nb.add(ub[Yb]);Ra.shortcutInfoArray=Nb.toArray()}}ob.a.count(A)||delete A[aa]}t.n9=O;t.xSn(b);return h?t.uaj(E.c(O)):t.kde(E.c(O))})}N0b(){if(this.n9){this.Sla=null;const t=this.n9;for(let A in t){var b=A;const O=t[A];for(let aa in O){var h=aa;const ua=O[aa];ua.shortcutInfoArray&&this.KWe(parseInt(h),parseInt(b),ua.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>
{let h=null;if(b&&!({Nu:h}=E.d(b)).returnValue)return u.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.n9=h;this.N0b();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,h,t){return this.n9&&(t=this.n9[t])&&(h=t[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.n9&&(h=this.n9[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,
h,t){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),t)}setShortcutInfoArray(b,h,t){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),t).then(()=>{this.N0b();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.Sla)return Promise.resolve(!0);var t=this.Sla[b];if(!t)return Promise.resolve(!0);var A=t[h];t=A.modifiers;A=A.keyCode;const O=this.getShortcutInfoArray(t.toString(),A.toString());if(!O||!O.length)return Promise.resolve(!0);let aa=0;for(const ua of O){if(ua.addinId===
b&&ua.action===h)break;++aa}if(aa>=O.length)return Promise.resolve(!0);O.splice(aa,1);return this.saveShortcutInfoArray(t,A,O).then(()=>{this.N0b();return Promise.resolve(!0)})}KWe(b,h,t){this.Sla||(this.Sla={});for(const A of t){t=A.addinId;const O=A.action;let aa=this.Sla[t];aa||(aa={});const ua={};ua.modifiers=b;ua.keyCode=h;aa[O]=ua;this.Sla[t]=aa}}xSn(b){b in this.Sla&&delete this.Sla[b]}isActionCustomized(b,h){return this.Sla&&(b=this.Sla[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,
h){return this.Sla&&(b=this.Sla[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.n9}static instance(){qt.JYe||(u.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),qt.JYe=new qt,qt.NP=v.AFrameworkApplication.Ke);return qt.JYe}}qt.JYe=null;qt.NP=null;Object(m.a)(qt,"AddinShortcutsPreferenceSettingHelper",null,[]);class Cu{constructor(b,h){this.dfd=null;new Mb.a;this.pYg=!0;this.lid=b;this.ITg=h}XXe(b){this.ITg.addHandler("GoalChangedEvent",b)}Mbn(){this.ITg.raiseEvent("GoalChangedEvent")}Szf(b,
h){return this.dfd&&this.pYg?b in this.dfd?this.dfd[b]:"Formality"===h&&this.lid.trf().formality?!1:!0:!0}O$n(b,h){h===this.lid.trf().formality&&(this.dfd=b,this.Mbn())}ZNo(b){this.pYg=b}}Object(m.a)(Cu,"GoalChangeSource",null,[360,361,362]);var YC=c(981),Ks=c(925),HC=c(708);class ZC{constructor(b,h,t,A,O,aa){this.dKa=h;this.Xza=t;this.Ze=b;this.gD=A;this.Ag=O;this.qZj=aa;this.Xza.gGb()&&this.initialize()}initialize(){return this.gD.Bl().then(()=>{this.Ze.mb(this,YC.a.getTypeName());this.Ze.addHandler(this,
Ks.a.getTypeName())}).catch(b=>{this.Ag.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}xD(b,h){if(h===gd.a.getTypeName()||h===HC.a.getTypeName())if(!b||!b.content)this.Ag.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(af.a.getTypeNameFor(b.content)===YC.a.getTypeName()||af.a.getTypeNameFor(b.content)===Ks.a.getTypeName())if(af.a.getTypeNameFor(b.content)===YC.a.getTypeName()){var t=b.content;this.Ag.sendTraceTag(528274565,
2252,50,"Goal annotation received with formality goal: {0}",t.critiqueConfiguration.formalityGoal);this.dKa.O$n(t.critiqueConfiguration.mapping,t.critiqueConfiguration.formalityGoal)}else if(af.a.getTypeNameFor(b.content)===Ks.a.getTypeName())if(b=b.content,b.features){for(t of b.features)if("Goals"===t.featureName){this.qZj.ZNo(!!t.supportType);return}this.Ag.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Ag.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}
Object(m.a)(ZC,"GoalsAnnotationHandler",null,[126]);class IC{constructor(b){this.Na=b}gGb(){return this.Na.$("EditorGoalsEnabled")}}Object(m.a)(IC,"GoalsGate",null,[146]);var TE=c(1178),HA=c(1179),$D=c(876);class vr{}vr.AGd=0;vr.FGd="1.0";vr.settingType="Goals";Object(m.a)(vr,"GoalsConstants",null,[]);var SB=c(1060);class bw{constructor(b,h,t,A,O){this.KWb=null;this.pti=!1;this.R7g=b;this.pid=h;this.Ag=t;this.Xza=A;this.dAe=O;this.Xza.gGb()?this.OIn():this.Xza.gGb()&&this.k7f(vr.AGd,vr.FGd)}OIn(){new Promise(b=>
{this.R7g.F$h(vr.settingType,h=>{this.PIn(h)?(this.k7f(this.KWb.formality,this.KWb.version),b(this.KWb)):(this.k7f(vr.AGd,vr.FGd),b(null))})})}PIn(b){this.pti=!0;if(!b||!b.Inb)return this.Ag.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),!1;b=b.Inb.properties;var h=b.getValue(Lc.a.koi);h=parseInt(h);b=b.getValue(Lc.a.loi);if(!this.pid.Qkg(b))return this.Ag.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.KWb=
b=Object.assign(new SB.a,{formality:h,version:b});this.Ag.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}k7f(b,h){b=Object.assign(new $D.a,{formality:b,version:h});this.dAe.Ycj(b)}L_o(b){if(this.pid.Qkg(b.version)){var h=TE.a.S3k(b.version,b.formality.toString());this.R7g.elh(Object.assign(new HA.a,{Inb:h,settingType:vr.settingType}))?this.KWb=b:this.Ag.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Ag.sendTraceTag(528274560,
2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}v7h(){this.pti||this.Ag.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.KWb}}Object(m.a)(bw,"GoalsPersistenceHandler",null,[145]);class Dz{constructor(b,h,t,A){this.Ag=b;this.eAe=h;this.pid=t;this.Xza=A;this.nid=Object.assign(new SB.a,{formality:vr.AGd,version:vr.FGd});this.$Pe=this.Xza.gGb()}trf(){this.$Pe&&(this.$Pe=!1,this.eAe.v7h()&&(this.nid=this.eAe.v7h()));
return this.nid}Ffo(b){this.$Pe=!1;this.pid.Qkg(b.version)?(this.Xza.gGb()&&this.eAe.L_o(b),this.nid=b):(this.Ag.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",b.version),this.nid=Object.assign(new SB.a,{formality:vr.AGd,version:vr.FGd}))}}Object(m.a)(Dz,"GoalsProvider",null,[143,144]);class JC{constructor(b,h,t,A){this.Ze=b;this.gD=h;this.g5=t;this.Ag=A}Ycj(b){b=Object.assign(new gd.a,{parentPath:["Signal",$D.a.getTypeName()],items:[Object.assign(new Wd.a,{body:b})]});
this.NId(b)}NId(b){this.gD.Bl().then(()=>{this.gWe(b)}).catch(h=>{this.Ag.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}gWe(b){return this.Ze.activateAnnotation(YC.a.getTypeName(),JC.K_b).then(()=>{this.g5.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ce.a,{operation:b}))}).catch(h=>{this.Ag.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}JC.K_b="GoalSelected";Object(m.a)(JC,"GoalsSignalSender",null,[142]);class pq{constructor(){pq.RUe=
new RegExp(pq.rhk)}Qkg(b){return!!b.match(pq.RUe)&&1===b.match(pq.RUe).length}}pq.rhk="[0-9]+[.]?[0-9]*";pq.RUe=null;Object(m.a)(pq,"GoalsValidator",null,[141]);class $C{constructor(){this.W=null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}yc(b){this.W=b;this.W.ha("WordEditor.Goals.GoalsValidator",()=>new pq).as("WordEditor.Goals.IGoalsValidator").singleInstance();this.W.ha("WordEditor.Goals.IGoalsGate",()=>new IC(this.W.resolve("Common.IAppSettingsManager"))).singleInstance();
this.W.ha("WordEditor.Goals.GoalsProvider",()=>new Dz(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").singleInstance();this.W.ha("WordEditor.Goals.GoalChangeSource",()=>new Cu(this.W.resolve("WordEditor.Goals.IGoalReader"),new If.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").singleInstance();
this.W.ha("WordEditor.Goals.GoalsPersistenceHandler",()=>new bw(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsAnnotationHandler",()=>new ZC(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),
this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsSignalSender",()=>new JC(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").singleInstance()}static main(){P.a.instance.Gc(new $C)}}
Object(m.a)($C,"WordEditorGoalsPackage",null,[1,2]);var tD=c(754),IA=c(451);class TB{constructor(){this.annotation=null;this.languages=new Z.a(Pa.a.Xh())}}Object(m.a)(TB,"CritiqueCountWrapper",null,[]);class Wf{constructor(){this.$qa=new xb.a}dNd(){return this.$qa}Mli(b,h,t,A){if(this.$qa.ob(t)){this.$qa.J(t).annotation.count+=h;t=this.$qa.J(t).languages;for(var O of A)t.add(O)}else O=W.a.create().toString(),b=Object.assign(new IA.a,{id:O,categoryName:b,count:h}),this.$qa.add(t,Object.assign(new TB,
{annotation:b,languages:A}))}}Wf.Di=389;Object(m.a)(Wf,"BaseCritiquesByTypeCounter",null,[124]);class uD extends Wf{constructor(b){super();this.Uvb=new Ca.a;this.Oue=new Ca.a;this.Hwd=b}Kdm(b){const h=b.annotation;if(h&&tD.a(af.a.getTypeNameFor(h.content))){const t=h.content;if(b.opType===gd.a.getTypeName()){this.Hwd.DUn(h.parentPath,t);b=t.M_.state;if(60!==b&&70!==b)return this.Uvb.contains(h.id)&&this.Uvb.remove(h.id),this.mom(h.id,t),!0;this.Uvb.add(h.id)}else if(b.opType===Vf.a.getTypeName())if(this.Uvb.contains(h.id))this.Uvb.remove(h.id);
else return this.bLh(t.typeId,h.id)}return!1}Jdm(b){if((b=b.annotation)&&tD.a(af.a.getTypeNameFor(b.content))){const h=b.content,t=h.M_.state;if((60===t||70===t)&&!this.Uvb.contains(b.id))return this.Uvb.add(b.id),this.bLh(h.typeId,b.id)}return!1}mom(b,h){this.Oue.add(b);b=new Z.a(Pa.a.Xh());h.language&&b.add(h.language);this.Mli(h.categoryName,1,h.typeId,b)}bLh(b,h){if(!this.Oue.contains(h))return!1;if(!this.$qa.ob(b))return u.ULS.sendTraceTag(589866503,Wf.Di,15,"Unable to decrement the count for critique category {0}. Reason : {1}",
b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.$qa.J(b).annotation.count)return u.ULS.sendTraceTag(589866504,Wf.Di,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.Oue.remove(h);this.$qa.J(b).annotation.count--;return!0}}Object(m.a)(uD,"AlCritiquesByTypeCounter",Wf,[393,124]);var KC=c(999);class aE extends Yp.a{constructor(b,h,t,A,O,aa,ua,Ra,ub){var Nb;super();this.Ze=b;this.Hwd=h;this.Bqe=
t;this.NOg=A;this.dKa=O;this.hsa=aa;this.pi=ua;this.i$=this.fNg=!1;this.uJe=new xb.a;this.rhn=(Yb,bc)=>{this.Hwd.Kem(bc)&&(this.i$=!0,this.eY())};this.men=(Yb,bc)=>{this.Bqe.Kdm(bc)&&this.NMb()};this.xNi=()=>{this.NMb()};this.MPf=(Yb,bc)=>{this.Bqe.Jdm(bc)&&this.NMb()};this.Ykb=()=>{this.NMb()};this.NMb=()=>{let Yb=!1;this.pi.he(()=>{var bc=this.WKl();const Dc=new Mb.a;for(const Pc of bc)bc=Object.assign(new KC.a,{id:Pc.id,parentPath:$q.a.jBb,content:Pc,annotationType:af.a.getTypeNameFor(Pc)}),Dc.add(bc),
Yb||(Yb=0<Pc.count);this.Ze.N$n(Dc)},"CC:SATH");!this.fNg&&Yb&&(ja.a.sendTelemetryEvent(Object.assign(Object.assign({},new ta.a),{name:"Office.Word.Online.Editor.CritiquesAvailable"})),this.fNg=!0)};this.hAm=(Yb,bc,Dc)=>{const Pc=!this.dKa||this.dKa.Szf(Yb,Dc);Yb=this.hsa&&this.hsa.instance?this.hsa.instance.wWd(Yb,Dc,bc.substr(1,bc.length-2)):!0;return Pc&&Yb};null===Ra||void 0===Ra?void 0:Ra.XXe(this.Ykb);ub.Cpa(this,7);null===(Nb=this.hsa)||void 0===Nb?void 0:Nb.execute(Yb=>{Yb.vYe(this.NMb)})}get index(){return 3}run(){this.i$&&
(this.NMb(),this.i$=!1)}ZPi(){this.NMb()}Q0k(b){let h=0;if(({value:h}=this.uJe.Ec(b.categoryName,0)).returnValue)if(h!==b.count)this.uJe.Z(b.categoryName,b.count);else return!1;else this.uJe.add(b.categoryName,b.count);return!0}WKl(){const b=new xb.a;var h=this.Hwd.dNd();const t=this.Bqe.dNd();this.Iig(b,h);this.Iig(b,t);this.NOg&&(h=this.NOg.dNd(),this.Iig(b,h));h=new Mb.a;for(const A of b.values)this.Q0k(A)&&h.add(A);return h}Iig(b,h){for(const O of h){h=O.value.annotation;const aa=O.key;var t=
this.V8n(O.value.languages);if(!b.ob(h.categoryName)){var A=W.a.create().toString();A=Object.assign(new IA.a,{id:A,categoryName:h.categoryName,count:0,countsByTypeId:{}});b.add(h.categoryName,A)}this.hAm(aa,t,h.categoryName)&&(t=b.J(h.categoryName),t.count+=h.count,t.countsByTypeId[aa]=(t.countsByTypeId[aa]?t.countsByTypeId[aa]:0)+h.count)}}V8n(b){const h=[];let t=0;for(const A of b)h[t++]=A;return E.c(h)}}Object(m.a)(aE,"CritiquesCounter",Yp.a,[391,392]);class vD{constructor(b){this.p1=b}dNd(){const b=
new xb.a,h=new Z.a(Pa.a.Xh()),t=Object.assign(new IA.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.p1.upc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new TB,{annotation:t,languages:h}));return b}}Object(m.a)(vD,"DictationCritiquesByTypeCounter",null,[390,124]);class JA extends Wf{constructor(b){super();this.J8a=new xb.a;this.Ze=b}Kem(b){const h=$q.a.FPd(b.nodeId);if(!$q.a.mf(h)){if(b.ufb&&b.ufb.length){let t=null;for(const A of b.ufb)A.errorDetails.l2a()||
(b=this.d3h(A),$q.a.mf(b)||(t||(t=new xb.a),t.ob(b)||t.add(b,new Mb.a),t.J(b).add(A)));this.cLh(h);t?this.Jdo(h,t):this.J8a.remove(h)}else{if(!this.J8a.ob(h))return!1;this.cLh(h);this.J8a.remove(h)}return!0}return!1}DUn(b,h){var t;if(({value:t}=this.J8a.Ec(b,t)).returnValue)for(const O of t)if(b=O.value,0<b.count&&this.Gmf(b.J(0))===h.categoryName)for(t=b.count-1;0<=t;t--){var A=b.J(t).end-b.J(t).begin;b.J(t).begin===h.range.start&&A===h.range.length&&(A=this.d3h(b.J(t)),this.$qa.ob(A)&&(A=this.$qa.J(A).annotation,
A.count=Math.max(0,A.count-1)),b.removeAt(t))}}cLh(b){if(this.J8a.ob(b))for(const t of this.J8a.J(b)){var h=t.key;b=t.value;this.$qa.ob(h)&&(h=this.$qa.J(h).annotation,h.count=Math.max(0,h.count-b.count))}}Jdo(b,h){const t=new xb.a,A=new xb.a;for(const O of h){h=O.key;A.add(h,new Z.a(Pa.a.Xh()));for(const aa of O.value){const ua=aa.end-aa.begin,Ra=this.Gmf(aa);this.vOk(b,Ra,aa.begin,ua)?u.ULS.sendTraceTag(589866513,Wf.Di,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",
h,b,aa.begin,ua):(t.ob(h)||t.add(h,new Mb.a),t.J(h).add(aa),A.J(h).add(this.YKl(aa)))}}this.J8a.Z(b,t);for(const O of this.J8a.J(b))0<O.value.count&&(b=this.Gmf(O.value.J(0)),this.Mli(b,O.value.count,O.key,A.J(O.key)))}d3h(b){let h=null;b&&(b=Object(Da.a)(122,b.errorDetails))&&b.ft&&(h=b.ft.TypeId);return h}Gmf(b){let h=null;b&&(b=Object(Da.a)(122,b.errorDetails))&&b.ft&&(h=b.ft.CategoryTitle);return h}YKl(b){let h="";b&&b.errorDetails&&(h=Sf.a.lg(b.errorDetails.lcid).name);return h}vOk(b,h,t,A){if((b=
this.Ze.c0h(b))&&0<b.count)for(const O of b)if(b=af.a.getTypeNameFor(O.content),O&&tD.a(b)&&(b=O.content,b.categoryName===h&&b.range.start===t&&b.range.length===A))return!0;return!1}}Object(m.a)(JA,"WacCritiquesByTypeCounter",Wf,[123,124]);class aD{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}yc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.W.ha("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>
new JA(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).singleInstance();this.W.ha("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new uD(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).singleInstance();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.W.ha("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new vD(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).singleInstance();
this.W.ha("WordEditor.CritiqueCounts.ICritiquesCounter",()=>new aE(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Ma("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Ma("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.Sa("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),Fq.a.instance,this.W.Ma("WordEditor.Goals.IGoalChangeSource"),
this.W.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").Imh(b.rhn);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").kqk(b.men);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").umh(b.MPf);h&&(h=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.cmh(b.xNi),h.dmh(b.xNi))}}dispose(){}static main(){P.a.instance.Gc(new aD)}}Object(m.a)(aD,
"WordEditorCritiqueCountsPackage",null,[1,2]);class bD{get name(){return"WordEditor.GraphicsEditor"}yc(){}init(){}dispose(){}static main(){P.a.instance.Gc(new bD)}}Object(m.a)(bD,"PackageManager",null,[1,2]);var ui=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},
children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",
Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",
Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",
LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class wD{constructor(b){this.bWj={};this.Vb=b;this.dwb=new Tc.a}NNa(b,h){const t=this.Vb.ifc,A=parseInt(b);return b&&A!==Kf.ActionManager.Pef?this.dwb.ob(t)?(b=this.dwb.J(t).Y7b(A,h,2),
32===b||1===b):!1:!1}gFa(b){const h=parseInt(b),t=this.Vb.ifc;return b&&h!==Kf.ActionManager.Pef?this.dwb.ob(t)?32===this.dwb.J(t).Y7b(h,this.bWj,1):!1:!0}f3i(b,h){this.dwb.Z(b,h)}Kjj(b){b=parseInt(b);const h=this.Vb.ifc;return!!h&&!!this.dwb.J(h)&&this.dwb.J(h).lzm(b)}}Object(m.a)(wD,"NonCanvasCuiUser",null,[898,119]);var vx=c(1203),yj=c(53),cD;(function(b){b[b.UnspecifiedGallery=0]="UnspecifiedGallery";b[b.CharacterCodeGallery=1]="CharacterCodeGallery";b[b.FontStyleGallery=2]="FontStyleGallery";
b[b.InkThicknessGallery=3]="InkThicknessGallery";b[b.IconGallery=4]="IconGallery";b[b.ListGallery=5]="ListGallery";b[b.TableStyleGallery=6]="TableStyleGallery";b[b.PageNumberGallery=7]="PageNumberGallery";b[b.ChangeColorsGallery=8]="ChangeColorsGallery"})(cD||(cD={}));Object(m.b)("GalleryType",cD);class Zu{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(m.a)(Zu,"CommonGalleryButtonProps",null,[]);class xD extends Zu{constructor(){super();this.tableStyles=this.tableCellStyles=
null;this.columns=0}}Object(m.a)(xD,"AdditionalTableStyleGalleryButtonProps",Zu,[]);class UE extends xD{constructor(){super()}}Object(m.a)(UE,"AdditionalChangeColorsGalleryButtonProps",xD,[]);class bE extends Zu{constructor(){super();this.character=null}}Object(m.a)(bE,"AdditionalCharacterCodeGalleryButtonProps",Zu,[]);class VE extends Zu{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(m.a)(VE,"AdditionalFontStyleGalleryButtonProps",Zu,[]);class WE{constructor(){this.selectedId=
this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(m.a)(WE,"AdditionalGalleryProperties",null,[]);class XE extends Zu{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(m.a)(XE,"AdditionalIconButtonProperties",Zu,[]);class cE extends Zu{constructor(){super();this.styleDisplayName=null}}Object(m.a)(cE,"AdditionalInkThicknessGalleryButtonProps",
Zu,[]);class yD extends Zu{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(m.a)(yD,"AdditionalListGallerButtonProps",Zu,[]);class LC extends Zu{constructor(){super();this.text=null}}Object(m.a)(LC,"AdditionalPageNumberGalleryButtonProps",Zu,[]);var Ez=c(1135);const dD=(b,h)=>{var t=appChrome.selectors.getActiveControlStates();if(t=Object(Da.a)(Object,t[b])){if((b=Object(Da.a)(String,t.value))&&b===h)return!1;b=Object(Da.a)(String,t.selectedKey);if(!h&&!b)return!1;if(b){t=Array.isArray(t.options)?
t.options:null;let A=null;for(let O=0;O<t.length;O++){const aa=Object(Da.a)(Object,t[O]);if(Object(Da.a)(String,aa.key)===b){A=aa;break}}if(A&&Object(Da.a)(String,A.text)===h)return!1}}return!0},YE=(b,h,t,A)=>{if(0<(A&2)){A=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":A.push(zD(b,t[Ng.a.On]));break;case "CheckboxModel":A.push(appChrome.actions.toggleCheckbox(b,t[Ng.a.On]));break;case "ComboBoxModel":if(v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!dD(b,t[Hk.a.Value]))break;(h=t[Hk.a.Key])?A.push(appChrome.actions.updateComboBoxKey(b,h,t[Hk.a.Value])):A.push(appChrome.actions.updateComboBoxValue(b,t[Hk.a.Value]));break;case "FontPickerModel":A.push(appChrome.actions.updateFontPickerSelectedFont(b,t[Ez.a.SelectedFont]));break;case "SplitButtonModel":A.push(zD(b,t[Rk.a.On]));break;case "SpinButtonModel":A.push(appChrome.actions.updateSpinButton(b,
t[Ue.a.Number],Ad.a.uZa(t[Ue.a.UnitType]),t[Ue.a.Text],t[Ue.a.MaxValue],t[Ue.a.Alt]));break;case "ColorPickerModel":A.push(appChrome.actions.updateColorPickerSelectedColor(b,t[Nd.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":A.push(appChrome.actions.updatePageNumberGalleryButtonText(b,t[Cl.a.Text]));break;case "CompoundButtonModel":t[Ng.a.Description]&&A.push(appChrome.actions.updateCompoundButtonDescription(b,t[Ng.a.Description]));Ng.a.On in t&&A.push(zD(b,t[Ng.a.On]));break;case "SliderModel":t.snapToStep?
A.push(appChrome.actions.updateSliderSelectedValue(b,t[Im.Value])):A.push(appChrome.actions.updateSliderValue(b,t[Im.Value],t[Im.MinValue]||0,t[Im.MaxValue],t[Im.Text]));break;case "FlyoutAnchorModel":fp.a.ImageIsVisible in t&&A.push(appChrome.actions.hideFlyoutAnchorIcon(b,!t[fp.a.ImageIsVisible]));Ng.a.On in t&&A.push(zD(b,t[Ng.a.On]));break;case "InputBoxModel":A.push(appChrome.actions.updateInputBoxValue(b,t[Ho.a.Text]))}h=A;var O=Object(Da.a)(String,t[Cb.a.iconColor]);void 0!==O&&null!==O&&h.push(appChrome.actions.updateIconColor(b,
O));dE(b,t,A);h=A;(O=Object(Da.a)(Object,t[Cb.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,O));h=A;O=Object(Da.a)(String,t[Cb.a.customTooltip]);void 0!==O&&null!==O&&h.push(appChrome.actions.setControlCustomTooltip(b,O));b=A;(t=Array.isArray(t[Cb.a.L0f])?t[Cb.a.L0f]:null)&&b.push.apply(b,t);return A}return null},UB=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),zD=(b,h)=>appChrome.actions.toggleButton(b,h),dE=(b,h,t)=>{h=Object(Da.a)(String,h[Cb.a.Icon]);void 0!==h&&
null!==h&&t.push(appChrome.actions.setControlIcon(b,h))};class VB{constructor(b,h,t,A){this.Pl=A;this.qsa=b;this.Ez=h;this.wXb=t;this.Duc={}}qxn(b,h,t,A,O=null){const aa=b.ExternalGalleryId||b.ExternalId;var ua=b.ExternalId;A.push(aa);if(appChrome.selectors.isControlDefined(aa))b.GalleryStyle&&Rh.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(aa,b.GalleryStyle));else{if(4!==b.Type)return;t.push(appChrome.api.createGalleryModel(aa,Object.assign(new WE,{columns:b.Width,sections:[appChrome.api.gallerySection([],
ua)],styles:b.GalleryStyle,galleryType:"IconGallery"})))}t=0;A=!!v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(Rh.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){ua=[];const ub=[],Nb=[],Yb={};for(var Ra of b.GallerySections){ua.push(appChrome.api.gallerySection([],Ra.SectionId,Ra.Title));0===t&&Ra.GalleryButtons&&
0<Ra.GalleryButtons.length&&(t=Ra.GalleryButtons[0].Type);A&&this.W$h(Ra.GalleryButtons,O,Yb);const bc=this.VWe(ub,Ra.GalleryButtons,Yb);ub.push.apply(ub,this.Gqf(bc,aa,Ra.SectionId,!1,t,O,!0,Yb));Nb.push.apply(Nb,bc)}h.push(appChrome.actions.setGallerySections(aa,ua));h.push.apply(h,ub);h.push.apply(h,this.eof(aa,cD[t],Nb,null,5===b.Type,!0,null,Yb))}else b.GalleryItems&&0<b.GalleryItems.length&&(t=b.GalleryItems[0].Type),Ra=A?this.W$h(b.GalleryItems,O,null):null,h.push.apply(h,this.Gqf(this.VWe(h,
b.GalleryItems,Ra),aa,ua,!1,t,O,!1,Ra))}l1l(b,h){const t=[];let A=null,O=!1;if(!b)return null;const aa=this.qsa.Z_c(this.Ez,b.commandId,h);t.push(UB(b.externalUxCommand,!aa));if(b.previewControlIds){const ub=[];for(let Nb=0;Nb<b.previewControlIds.length;Nb++){var ua={},Ra=b.previewControlIds[Nb];ua.SourceControlId=Ra;const Yb=this.Pl.getCommandByExternalUxId(Ra);this.SPd(Yb||b,ua);ua[Cl.a.On]&&(A=ua.SourceControlId,ua[Cl.a.HighlightOn]&&(O=!0));dE(Ra,ua,t);if(ua=Object(Da.a)(Ih.a,ua[Cl.a.GalleryButtonProps]))ub.push(ua),
aa&&(Ra=this.qsa.Z_c(this.Ez,ua.Command,h),ua.IsDisabled=!Ra)}0<ub.length&&t.push.apply(t,this.Gqf(this.VWe(t,ub),b.externalUxCommand,b.externalUxCommand,!0,ub[0].Type));t.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,A));O&&(u.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",A),t.push(appChrome.actions.highlightSelectedFontStyle(A)))}return t}VWe(b,h,t=null){const A=[],O=[];for(let ua=0;ua<h.length;ua++){const Ra=h[ua],ub=Za.b(Ra.ExternalId)?
Ra.Id:Ra.ExternalId;A.push(ub);const Nb=t&&t[ub]?t[ub].result:-1;switch(Ra.Type){case 1:var aa=Ra;O.push(appChrome.api.createCharacterCodeGalleryButtonModel(ub,Object.assign(new bE,{disabled:-1!==Nb?1>(Nb&1):aa.IsDisabled,character:aa.Character,style:aa.Style,title:aa.Alt})));break;case 2:aa=Ra;O.push(appChrome.api.createFontStylesGalleryButtonModel(ub,Object.assign(new VE,{disabled:-1!==Nb?1>(Nb&1):aa.IsDisabled,styleDisplayName:aa.LabelText,style:aa.Style,title:aa.Alt,previewStyleLabel:aa.PreviewStyleLabel})));
break;case 3:aa=Ra;O.push(appChrome.api.createInkThicknessGalleryButtonModel(ub,Object.assign(new cE,{disabled:-1!==Nb?1>(Nb&1):aa.IsDisabled,styleDisplayName:aa.LabelText,style:aa.Style,title:aa.Alt})));break;case 4:aa=Ra;O.push(appChrome.api.createIconGalleryButtonModel(ub,Object.assign(new XE,{disabled:-1!==Nb?1>(Nb&1):aa.IsDisabled,icon:[aa.Icon],fullIconStyle:aa.FullIconStyle,previewIconStyle:aa.PreviewIconStyle,largePreviewIconStyle:aa.LargePreviewIconStyle,label:aa.LabelText,title:aa.Alt})));
break;case 5:aa=Ra;O.push(appChrome.api.createListGalleryButtonModel(ub,Object.assign(new yD,{disabled:-1!==Nb?1>(Nb&1):aa.IsDisabled,infoAtLevel:aa.LevelInfo,ariaLabel:aa.Alt})));break;case 6:aa=Ra;O.push(appChrome.api.createTableStyleGalleryButtonModel(ub,Object.assign(new xD,{disabled:-1!==Nb?1>(Nb&1):aa.IsDisabled,tableCellStyles:aa.TableCellStyles,tableStyles:aa.TableStyles,title:aa.Alt,columns:aa.columns})));break;case 8:aa=Ra;O.push(appChrome.api.createChangeColorsGalleryButtonModel(ub,Object.assign(new UE,
{disabled:-1!==Nb?1>(Nb&1):aa.IsDisabled,tableCellStyles:aa.TableCellStyles,tableStyles:aa.TableStyles,title:aa.Alt})));break;case 7:aa=Ra,O.push(appChrome.api.createPageNumberGalleryButtonModel(ub,Object.assign(new LC,{disabled:-1!==Nb?1>(Nb&1):aa.IsDisabled,text:aa.Text,title:aa.Alt})))}this.Pl.addCommandToMaps(Object.assign(new yj.a(ub,Ra.Command),{queryCommandId:Ra.QueryCommand,menuItemId:Ra.MenuItemId}))}b.push(appChrome.actions.addControls(O));return A}Gqf(b,h,t,A,O,aa=null,ua=!1,Ra=null){const ub=
[];A?ub.push(appChrome.actions.populateGalleryItems(h,b)):(this.Duc[h]=!1,ua||(A=!0,appChrome.selectors.isControlDefined(h)&&(A=appChrome.selectors.getGalleryState(h),A=A.disableIndividualButtons?A.disableIndividualButtons:!0),ub.push.apply(ub,this.eof(h,cD[O],b,null,5===O,A,aa,Ra))),ub.push(appChrome.actions.updateGallerySectionItems(h,t,b)));return ub}tQl(b){return this.eof(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}eof(b,
h,t,A,O,aa=!0,ua=null,Ra=null){const ub=[];if(b in this.Duc){if(this.Duc[b])return delete this.Duc[b],ub;this.Duc[b]=!0}let Nb=null,Yb=-1;if(t)({yZh:Yb,returnValue:Nb}=this.wkh(h,t,ub,aa,ua,Ra));else if(A)for(const bc of A)(t=({yZh:Yb}=this.wkh(h,bc.galleryButtons,ub,aa,null,Ra)).returnValue)&&(Nb=t);ub.push(appChrome.actions.updateGallerySelectedId(b,Nb));aa&&ub.push(UB(b,!1));O&&0<Yb&&ub.push(appChrome.actions.updateListGalleryTextDirection(b,2===Yb));return ub}V$h(b,h=null){const t={},A={};A.SourceControlId=
b;A.Location=h;b=this.Pl.getCommandByExternalUxId(b);if(!b)return t.result=-1,t.props=A,t;b=this.SPd(b,A);t.result=b;t.props=A;return t}W$h(b,h=null,t=null){t||(t={});for(const A of b)b=Za.b(A.ExternalId)?A.Id:A.ExternalId,t[b]=this.V$h(b,h);return t}wkh(b,h,t,A,O=null,aa=null){let ua,Ra=null;ua=-1;let ub=!1;for(const Yb of h){var Nb=this.qQl(b);h=aa&&aa[Yb]&&-1!==aa[Yb].result?aa[Yb]:this.V$h(Yb,O);const bc=h.result;h=h.props;A&&t.push(UB(Yb,1>(bc&1)));(Nb=YE(Yb,Nb,h,bc))&&t.push.apply(t,Nb);h[Cl.a.On]&&
(Ra=Yb,h[Cl.a.HighlightOn]&&h[Cl.a.HighlightOn]&&(ub=!0));void 0!==h[Cb.a.labelText]&&null!==h[Cb.a.labelText]&&(Nb=this.Pl.getCommandByExternalUxId(Yb),t.push(appChrome.actions.setControlLabel(Nb.externalUxCommand,h[Cb.a.labelText])));h[Cl.a.IsRtl]&&0>ua&&(ua=h[Cl.a.IsRtl])}ub&&(u.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Ra),t.push(appChrome.actions.highlightSelectedFontStyle(Ra)));return{returnValue:Ra,yZh:ua}}qQl(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}SPd(b,h){h.MenuItemId=b.menuItemId;return this.qsa.Zoa(this.Ez,this.wXb,
b.commandId,b.queryCommandId,h)}}Object(m.a)(VB,"ReactGalleryPoller",null,[]);var zF=c(702),eE=c(671),AF=c(1682),ZE=c(770),Hw=c(1683);class Yv{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(m.a)(Yv,"PopulateFontPickerDataProps",null,[]);var JH=c(307),Fz=c(1844);class wx{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;
this.shouldTakeFocus=!1}}Object(m.a)(wx,"CommonOptionalButtonProperties",null,[]);class BF extends wx{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(m.a)(BF,"OptionalButtonProperties",wx,[]);class KH extends wx{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(m.a)(KH,"OptionalCompoundButtonProperties",wx,[]);class LH extends wx{constructor(){super();
this.onRetryCommandId=this.retryButtonTitle=this.label=null}}Object(m.a)(LH,"OptionalErrorViewProperties",wx,[]);class MH extends wx{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(m.a)(MH,"OptionalFlyoutAnchorProperties",wx,[]);class NH extends wx{constructor(){super();this.isBanner=null}}Object(m.a)(NH,"OptionalLabelProperties",wx,[]);class OH extends wx{constructor(){super();
this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(m.a)(OH,"OptionalMultipActionButtonProperties",wx,[]);class PH extends BF{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(m.a)(PH,"OptionalPersonaButtonProperties",BF,[]);class CF extends wx{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(m.a)(CF,
"OptionalToggleButtonProperties",wx,[]);var iM=c(1685),jM=c(1684),kM=c(510);class QH{constructor(){this.kCh=this.actions=null;this.NDj=!1}}Object(m.a)(QH,"PopulateActions",null,[]);class yG{Oci(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.b2l(b);case "InkButtonModel":return this.a2l(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);
case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}b2l(b){const h={};h[Ng.a.On]=appChrome.selectors.getButtonToggleState(b);return h}a2l(b){const h={};h[Ng.a.On]=Rh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(m.a)(yG,"ReactStatePropsSelector",null,[]);class DF{constructor(b,h,t,A,O){this.qsa=b;this.Ez=h;this.wXb=t;this.Pl=A;this.BRe={};this.y$j=new yG;this.Ovb=O}jnj(b){const h=b.populationProps.populateQueryCommandId;
return b.populationProps.populateOnlyOnce&&h in this.BRe}A2l(b,h,t=null){const A=[],O={};if(!this.jnj(b)){const aa=b.populationProps.populateQueryCommandId,ua={};ua.MenuId=b.externalUxCommand;ua.IsShadowMenuOpen=this.isShadowMenuOpen(t);if(0<(this.qsa.Zoa(this.Ez,this.wXb,aa,aa,ua,this.aTl(t))&1))if("FontPickerModel"===h)this.BRe[aa]=!0,A.push(DF.Q0l(b,ua)),O[b.externalUxCommand]="FontPickerModel";else if(ua.MenuItems)switch(this.BRe[aa]=!0,h){case "ComboBoxModel":A.push(DF.O0l(b,ua));O[b.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":A.push.apply(A,this.Tei(b.externalUxCommand,h,ua.MenuItems,O,t&&"location"in t?t.location:null))}}return Object.assign(new QH,{actions:A,kCh:O,NDj:this.isShadowMenuOpen(t)})}r8h(b,h,t,A,O,aa,ua,Ra,ub=null){let Nb=null;const Yb=[];Za.c(b.Title)||(Nb=b.Title);for(let bc=0;bc<b.ControlList.length;bc++){const Dc=Object(Da.a)(Or.a,b.ControlList[bc]);
if(!Dc||Dc.ExternalId)aa&&this.VIl(Dc,aa),h.push.apply(h,this.P0l(Dc,ua,Yb,O,t,A,ub))}return Ra?appChrome.api.menuSection(Yb,Nb,b.Lang):null}Tei(b,h,t,A,O=null){const aa=[],ua=[],Ra=[],ub=[];for(var Nb=0;Nb<t.MenuSectionList.length;Nb++){var Yb=Object(Da.a)(eh.a,t.MenuSectionList[Nb]);Yb&&(Yb=this.r8h(Yb,aa,b,h,ub,A,ua,t.UpdateDynamically,O),t.UpdateDynamically&&Ra.push(Yb))}Nb=null;t.MenuFooterSection&&(Nb=this.r8h(t.MenuFooterSection,aa,b,h,ub,A,ua,t.UpdateDynamically,O));t.UpdateDynamically&&aa.push(appChrome.actions.updateMenu(b,
Ra,t.Title,t.AriaLabel,t.ShouldAutoOpen,t.AriaRoleDescription,t.MenuTargetDescriptor,Nb));0<ua.length&&aa.splice(0,0,appChrome.actions.addControls(ua));0<ub.length&&Rh.d("setStatefulSplitButtonMruBypassControls")&&aa.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,ub));return aa}VIl(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]="CheckboxModel";
break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(Da.a)(qz.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}P0l(b,h,t,A,O,aa,ua=null){const Ra=[];switch(b.ControlType){case 14:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&this.txn(Object(Da.a)(ZE.a,b),Ra,h,t);break;case 1:case 3:A=Object(Da.a)(Eh.a,b);this.$wn(A,Ra,h,t);A.MenuItemsStatefulData&&Rh.d("setStatefulSplitButtonMenuItemsStatefulData")&&
Ra.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(O,A.MenuItemsStatefulData));break;case 2:this.Mxn(Object(Da.a)(kM.a,b),Ra,h,t);break;case 6:this.axn(Object(Da.a)(wA.a,b),Ra,h,t);break;case 4:this.Fxn(Object(Da.a)(sg,b),Ra,h,t);break;case 7:this.dxn(Object(Da.a)(qz.a,b),Ra,h,t);break;case 12:this.kxn(Object(Da.a)(AF.a,b),Ra,h,t);break;case 13:this.Cxn(Object(Da.a)(Hw.a,b),Ra,h,t);break;case 9:O=Object(Da.a)(Jj.a,b);this.mxn(O,Ra,h,t);"StatefulSplitButtonModel"===aa&&A.push(O.ExternalId);
break;case 8:this.Ovb.qxn(Object(Da.a)(Di.a,b),Ra,h,t,ua)}return Ra}txn(b,h,t,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Fz.a(b.IconName)),t.push(appChrome.api.createLabelModel(b.ExternalId,b.LabelText,b.Id,Object.assign(new NH,{isBanner:b.IsBanner,
iconSet:h?h.iconSet:null}))))}$wn(b,h,t,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.Uyd()&&((t=this.wOa(b))&&0<t.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Fz.a(t)).iconSet)),
b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(hc.a)(ar,b)?t.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new KH,{iconSet:(new Fz.a(this.wOa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):(A=b.DismissHostingSurfaceOnExecute,t.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,Object.assign(new BF,
{iconSet:(new Fz.a(this.wOa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==A&&null!==A?A:!0})))),this.Pl.addCommandToMaps(Object.assign(new yj.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));b.Lang&&Rh.d("setControlLanguage")&&
h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}axn(b,h,t,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Uyd()&&((t=this.wOa(b))&&0<t.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Fz.a(t)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(t.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new CF,{iconSet:(new Fz.a(this.wOa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.Pl.addCommandToMaps(Object.assign(new yj.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}kxn(b,h,t,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Fz.a(b.IconName)),t.push(appChrome.api.createErrorViewModel(b.ExternalId,Object.assign(new LH,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,iconSet:h?h.iconSet:null}))))}Cxn(b,h,t,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(t={},b.Label&&(t.label=b.Label),b.SecondaryLabel&&(t.secondaryLabel=b.SecondaryLabel),b.Description&&(t.description=b.Description),b.iconSet&&(t.iconSet=b.iconSet),b.Links&&(t.links=b.Links),b.CommandValueId&&(t.commandValueId=b.CommandValueId),b.ActionCommandValueId&&(t.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(t.actionCommandId=b.ActionCommandId),b.CommandId&&(t.commandId=b.CommandId),h.push(appChrome.actions.updateMultiActionButton(b.ExternalId,t))):t.push(appChrome.api.createMultiActionButtonModel(b.Id,
Object.assign(new OH,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,iconSet:b.iconSet,links:b.Links,actionId:b.ActionId,commandId:b.CommandId,actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId})))}Mxn(b,h,t,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),
this.Uyd()&&((t=this.wOa(b))&&0<t.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Fz.a(t)).iconSet)),v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?t.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,
Object.assign(new CF,{iconSet:(new Fz.a(this.wOa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):t.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new CF,{iconSet:(new Fz.a(this.wOa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel}))),this.Pl.addCommandToMaps(Object.assign(new yj.a(b.ExternalId,b.Command),
{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}Fxn(b,h,t,A){A.push(b.ExternalId);A=this.r0l(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,A,b.LabelText)):Rh.a("createPersonaButtonModel")&&t.push(appChrome.api.createPersonaButtonModel(b.ExternalId,A,b.LabelText,Object.assign(new PH,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}mxn(b,h,t,A){A.push(b.ExternalId);
if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Uyd()&&((t=this.wOa(b))&&0<t.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Fz.a(t)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{A=!(void 0===
b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const O=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;t.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new MH,{iconSet:(new Fz.a(this.wOa(b))).iconSet,keytip:b.KeyTip,hideIcon:A,toggled:O,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.Pl.addCommandToMaps(Object.assign(new yj.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,populationProps:new zF.a(b.PopulateQueryCommand,
b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.Tei(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}dxn(b,h,t,A){b.McuLayout&&A.push(b.McuExternalId);A.push(b.ExternalId);A=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(A=this.y$j.Oci(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(t.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),this.Pl.addCommandToMaps(Object.assign(new yj.a(b.McuExternalId,
b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),A=b.Width),t.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.Pl.addCommandToMaps(Object.assign(new yj.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));t=[];const O=[];for(let aa=0;aa<b.Colors.length;aa++){const ua=b.Colors[aa];aa<A?t.push(appChrome.api.colorPickerCell(ua.Color,ua.DisplayColor,ua.Alt)):O.push(appChrome.api.colorPickerCell(ua.Color,
ua.DisplayColor,ua.Alt))}0<t.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,t));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,O));b.SelectedColorId&&(0<t.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}wOa(b){return b.Image32by32Class?this.Pl.x4h(b.Image32by32Class):b.Image16by16Class?this.Pl.x4h(b.Image16by16Class):
b.ExternalImageId}r0l(b){return b?Object.assign(new jM.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new iM.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}aTl(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}Uyd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",!1)}static Q0l(b,
h){return appChrome.actions.populateFontPickerDataAsync(new Promise((t,A)=>{Sa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(O=>{O.isFeatureEnabled(JH.a.MHb,!1).then(aa=>{let ua=h.fonts;aa||O.isFreemiumUpsellEnabled()||(ua=gl.a.Flg(ua,Ra=>Ra.fontType!==JH.a.qXf));aa=Object.assign(new Yv,{commandId:b.externalUxCommand,fonts:ua,isSubscriber:aa,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});t(aa)}).catch(A)})}))}static O0l(b,
h){const t=[];for(let A=0;A<h.MenuItems.MenuSectionList.length;A++){const O=h.MenuItems.MenuSectionList[A];O.Title&&t.push(appChrome.api.comboBoxHeader("Header-"+A.toString(),O.Title));for(let aa=0;aa<O.ControlList.length;aa++){const ua=Object(Da.a)(eE.a,O.ControlList[aa]);ua&&t.push(appChrome.api.comboBoxItem(ua.MenuItemId,ua.LabelText,ua.Styles,ua.CommandValueId,ua.AriaLabel,ua.Data,ua.Disabled))}A<h.MenuItems.MenuSectionList.length-1&&t.push(appChrome.api.comboBoxDivider("Divider-"+A.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,
t)}}Object(m.a)(DF,"ReactPopulateQueryCommandPoller",null,[]);class RH{constructor(b,h,t,A,O){this.Pl=t;this.qsa=b;this.Ez=h;this.wXb=A;this.Ovb=O}z2l(b,h,t){const A=[];if(this.Czm(h))b=this.t6l(b,h,t),void 0!==b&&null!==b&&A.push.apply(A,b);else if(b){var O=this.SPd(b,t);Cb.a.visible in t&&A.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!t[Cb.a.visible]));A.push(UB(b.externalUxCommand,1>(O&1)));void 0!==t[Cb.a.labelText]&&null!==t[Cb.a.labelText]&&A.push(appChrome.actions.setControlLabel(b.externalUxCommand,
t[Cb.a.labelText]));void 0!==h&&null!==h&&(O=YE(b.externalUxCommand,h,t,O),void 0!==O&&null!==O&&A.push.apply(A,O),"PeopleWell"===h&&this.$mk(b.externalUxCommand,t,A))}return A}LNl(b,h,t){const A=[];switch(h){case "FlyoutAnchorModel":var O=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var aa=appChrome.selectors.getSplitButtonState(b);if(aa=this.Pl.getCommandByExternalUxId(aa.command))t=this.qsa.Z_c(this.Ez,aa.commandId,t),A.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,
!t)),A.push(UB(b,!1));return A;default:return null}h=!1;for(aa in O)if(O=this.Pl.getCommandByExternalUxId(aa),Za.c(O))h=!0;else if(t.SourceControlId=O.externalUxCommand,this.qsa.Z_c(this.Ez,O.commandId,t))return A.push(UB(b,!1)),A;A.push(UB(b,!h));return A}t6l(b,h,t){switch(h){case "PreviewGalleryModel":return this.Ovb.l1l(b,t);case "GalleryModel":return this.Ovb.tQl(t)}return null}Czm(b){return"GalleryModel"===b||"PreviewGalleryModel"===b}SPd(b,h){h.MenuItemId=b.menuItemId;return this.qsa.Zoa(this.Ez,
this.wXb,b.commandId,b.queryCommandId,h)}$mk(b,h,t){const A=h[fp.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[fp.a.LabelText];A&&0<A.length&&(h=String.format.apply(null,[h].concat(A)));t.push(this.D$l(b,h))}D$l(b,h){return appChrome.actions.updatePeopleWell(this.CIl(b),h)}CIl(b){const h=[];var t={};b=this.Pl.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.qsa.Zoa(this.Ez,this.wXb,"1285265560",b,t);t=t.MenuItems;if(!t)return h;t=t.MenuSectionList[0];for(b=0;b<t.ControlList.length;b++){const A=
t.ControlList[b],O={};O.name=A.Alt;O.id=A.MenuItemId;O.description=A.Description;O.color=A.ImageBackColor;O.joinTime=A.JoinTimeInMS;O.imageUrl=A.ImageUrl;O.activeStatus=A.ActiveStatus;O.isAnonymous=A.IsAnonymous;O.canJump=A.CanJump;O.upn=A.Upn;h.push(O)}return h}}Object(m.a)(RH,"ReactQueryCommandPoller",null,[]);var lM=c(1122);class SH{constructor(b,h,t){this.Pl=b;this.Ez=h;b=new lM.a;this.Qdk=new yG;this.Ovb=new VB(b,this.Ez,t,this.Pl);this.n9g=new DF(b,this.Ez,t,this.Pl,this.Ovb);this.c9g=new RH(b,
this.Ez,this.Pl,t,this.Ovb)}ZDa(){const b=[];if(!Rh.c())return b;b.push.apply(b,this.B$l());var h=this.NMl();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const t=this.OMl();for(const A of t)b.push(appChrome.actions.updateControlEnabledDisabledState(A,!0)),delete h[A];b.push.apply(b,this.kRd(h))}return b}$_c(b,h){Rh.c()&&(b=this.kRd(b,h),appChrome.api.dispatch(b))}MWf(b,h,t=null){if(!Za.c(b)&&b.populationProps&&!this.n9g.jnj(b)){b=this.n9g.A2l(b,
h,t);if(!b.NDj){let A;(A=b.actions).push.apply(A,this.kRd(b.kCh,Rh.g(t)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}kRd(b,h=0){const t=[],A={};if(Rh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var O of appChrome.selectors.getActiveGroupIds())for(var aa of appChrome.selectors.getVisibleControlsInGroup(O))A[aa]=!0;for(let ua in b)O=ua,aa=b[ua],
0===h&&A[O]&&(h=2),t.push.apply(t,this.A$l(O,aa,h));return t}A$l(b,h,t=0){const A=[],O=this.Pl.getCommandByExternalUxId(b);let aa={};appChrome.selectors.isControlDefined(b)&&(aa=this.Qdk.Oci(b,h));aa[vx.a.U6a]=t;Za.c(O)?(aa.ExternalUxId=b,(b=this.c9g.LNl(b,h,aa))&&0<b.length&&A.push.apply(A,b)):(aa.MenuItemId=O.menuItemId,aa.SourceControlId=b);A.push.apply(A,this.c9g.z2l(O,h,aa));return A}B$l(){const b=[],h=!!v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),t=appChrome.selectors.getContextualTabIds();let A=[];h&&(A=appChrome.selectors.getActiveContextualTabIds());for(let aa=0;aa<t.length;aa++){var O=this.Pl.csf(t[aa]);if(O){O=this.Ez.gFa(O);let ua=!0;h&&(ua=0<=Array.indexOf(A,t[aa]));h&&ua===O||b.push(appChrome.actions.activateDeactivateContextualTab(t[aa],O))}}return b}NMl(){var b=appChrome.selectors.getSelectedTabId();const h=[],t=this.Pl.csf(b);
t&&(this.Ez.gFa(t)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}OMl(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const t of b)if(b=this.Pl.LQl(t))for(const A of b)this.Ez.gFa(A.commandId)||((b=A.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(A.externalUxGroupId)),h.push.apply(h,b));return h}}Object(m.a)(SH,"ReactRibbonRootPoller",null,[884]);class EF{constructor(b,h,t=null){this.Ez=this.lAa=this.nbb=null;this.cXb=
h;b.pMa(this);this.eF=t}get eoa(){this.lAa||(this.lAa=new Date,this.lAa.setTime(0));return this.lAa}set eoa(b){this.lAa=b}get a9(){return 2}get eF(){return this.Ez}set eF(b){this.Ez=b}get Lfc(){this.nbb||(this.nbb=new SH(this.cXb,this.eF,this.a9));return this.nbb}Ydb(){const b=document.activeElement;vc.a.isEditable(b)&&b.blur()}executeCommand(b,h,t,A,O,aa,ua,Ra=2){Za.c(this.eF)||(O=new tj.a,O.CommandLocation=Ra,O.InvocationMethod=A,O.CommandTabName=t,h[vx.a.U6a]=Ra,this.eF.NNa(b,h,O,aa,ua),this.wWm(b,
h))}ZDa(){return Za.c(this.eF)?[]:this.Lfc.ZDa()}qm(){const b=this.ZDa();0<b.length&&(this.eoa=new Date,appChrome.api.dispatch(b))}q$c(){Rh.c()&&this.Lfc.$_c({PeopleWell:"PeopleWell"},18)}f$c(){}wWm(b,h){try{const t=Sa.a.instance.Ma("Common.ISystemInitiatedFeedback");if(t&&h){const A=h.SourceControlId||h.launcherId||h.LegacyId||h.NewContextId;let O=(A?"_"+A:"")+(h.SqmControlId?"_"+h.SqmControlId:"");O=O.length?O:"_"+b;t.FHf("Ribbon"+O)}}catch(t){u.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+
(t?t.toString():""))}}}Object(m.a)(EF,"ReactRibbonRoot",null,[672,883]);var FF=c(1609);class TH{constructor(b){this.fVe=this.CAe=!1;this.Y8a=null;this.oKg=!1;this.cP=null;this.Mra=!1;this.UMe=b;Ud.a.instance.mb(db.a.yx,this.xMc(),Object(z.a)(this,this.mgn,"onContextualUIMouseDown"));(b=Sa.a.instance.Sa("Common.IActionContextProvider"))&&b.execute(h=>{this.cP=h});v.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&v.AFrameworkApplication.ta.Ob.ZI?rk.a.get_instance().Vk(16,
()=>{this.Ona?this.initializeContextualUI(this.xMc()):rk.a.get_instance().Vk(7,()=>{this.initializeContextualUI(this.xMc())})}):rk.a.get_instance().Vk(7,()=>{this.initializeContextualUI(this.xMc())})}get r_(){return this.Mra}get Ona(){return v.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&v.AFrameworkApplication.ta.Ob.ZI?rk.a.get_instance().isCompleted(16)&&rk.a.get_instance().isCompleted(7):rk.a.get_instance().isCompleted(7)}BLk(){if(this.oKg)return!0;try{return Promise.resolve(null),
this.oKg=!0}catch(b){return!1}}Whg(b){if(!this.Ona||this.fVe)return this.zIf("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.BLk())return this.zIf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(v.AFrameworkApplication.nD)return this.zIf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.fVe=!0;let h=ab.a.Gg;switch(b){case 1:h=ab.a.showContextMenu;break;case 0:h=ab.a.showFloatie;break;case 2:h=
ab.a.zic}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.fVe=!1;lb.c(h)},0)});return!1}ofi(b){return oh.UISurfaces.b0a().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=h.getBlockedSmallScreenFloatieGroupList();const t=[];for(const A of b)Array.contains(h,A)||t.push(A);return t}return b})}showFloatie(b,h,t,A=null){this.Whg(0)||this.ofi(h).then(O=>{if(0>=O.length)return null;this.l$f(O).then(()=>{const aa={};aa.target=b;oh.UISurfaces.b0a().then(ua=>
{appChrome.api.dispatch(ua.showFloatie(aa,t,void 0,this.vpf(),A));this.Mra=!0;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&v.AFrameworkApplication.xa&&v.AFrameworkApplication.xa.processAction(ab.a.TCi,2);return null})});return null})}showContextMenu(b,h,t=null,A=null){this.Whg(1)||this.jlj(b,h,t,A)}jlj(b,h,t=null,A=null){this.l$f(null).then(()=>{const O={};O.target=b;A&&(O.directionalHint=A);oh.UISurfaces.b0a().then(aa=>{appChrome.api.dispatch(aa.showContextMenu(O,
h,t,void 0,this.vpf()));return null})})}yic(b,h,t,A=null){this.Whg(2)||this.ofi(h).then(O=>{0>=O.length?this.jlj(b,t,A):this.l$f(O).then(()=>{const aa={};aa.target=b;const ua={};ua.target=b;oh.UISurfaces.b0a().then(Ra=>{appChrome.api.dispatch(Ra.showContextualUI(aa,ua,t,void 0,A,this.vpf()));this.Mra=!0;return null})});return null})}zIf(b){u.ULS.sendTraceTag(561394519,340,15,b)}AIc(){this.Ona&&oh.UISurfaces.isLoaded()&&oh.UISurfaces.b0a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}Dw(){this.Ona&&
oh.UISurfaces.isLoaded()&&oh.UISurfaces.b0a().then(b=>{this.Mra=!1;appChrome.api.dispatch(b.hideFloatie());return null})}O3b(){this.Ona&&oh.UISurfaces.isLoaded()&&oh.UISurfaces.b0a().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.Mra=!1;return null})}initializeContextualUI(b){return oh.UISurfaces.b0a().then(h=>{this.CAe||(h.initializeContextualUI(b),this.CAe=!0);return null})}l$f(b){if(!this.CAe)return this.initializeContextualUI(this.xMc()).then(()=>{this.setActiveFloatieGroups(b);return null});
this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);var t=[];oh.UISurfaces.b0a().then(A=>{t.push.apply(t,this.UMe.Lfc.kRd(A.selectors.getFloatieOnlyControlsMap(),9));0<t.length&&appChrome.api.dispatch(t);return null})}}xMc(){if(this.Y8a)return this.Y8a;this.Y8a=FF.a("div");this.Y8a.id="ReactContextualUIDiv";this.Y8a.style.position="absolute";this.Y8a.style.zIndex=
"1001";document.body.insertBefore(this.Y8a,document.body.firstChild);return this.Y8a}mgn(b){b.Ib&&b.Ib.target&&"input"===b.Ib.target.tagName.toLowerCase()&&yd.FocusManager.instance().JC("ribbon");return!1}vpf(){return this.cP?this.cP.contentType:"Unknown"}}Object(m.a)(TH,"ReactContextualUILauncher",null,[885]);class UH extends $x.a{constructor(){super()}}Object(m.a)(UH,"FloatieBuildOptions",$x.a,[]);class VH extends by.a{constructor(){super()}}Object(m.a)(VH,"FloatieBuildContext",by.a,[]);var mM=
c(664);class WH extends Il.Builder{constructor(b,h,t){super(b,h,t,null);if(Za.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get floatie(){return this.root}Pho(b){this.root=b}lGk(){const b=new VH,h=new uz.a;h.D1c=1;h.handler=Object(z.a)(this,this.omn,"onReturnFloatieData");h.data=b;this.gua.dde(h)}omn(b){this.mGk(b.Z0c,b.tGc);this.floatie.uXh=this;this.floatie.rm();this.floatie.Pc.style.display="none";this.placeholder.appendChild(this.floatie.Pc);this.rta.continueWith(()=>
{this.rta.result.pJb(this.floatie)},11);Yh.a.instance.mb(db.a.pointerDown,this.floatie.Pc,Object(z.a)(this.floatie,this.floatie.zC,"onPointerDown"))}mGk(b,h){b=Pi.a.Rfa(b,Pi.a.SHj);if(Za.c(b))throw Error.create("No floatie element was present in the data");b=new Pi.a(b);this.Pho(new Rw(b.attributes[Pi.a.id],b.attributes));b=Pi.a.Rfa(b.node,Pi.a.koe);this.x2e(b,h)}x2e(b,h){b=Pi.a.Vv(b);for(let t=0;t<b.length;t++){if(this.FPa(b[t]))continue;const A=this.C2e(b[t],h);this.floatie.Qf(A)}}C2e(b,h){var t=
new Pi.a(b);b=new mM.Group(this.floatie,t.attributes[Pi.a.id],t.attributes[Pi.a.ZTa],t.attributes[Pi.a.vmc],t.attributes[Pi.a.UTa],!1,t.name===Pi.a.ELj,!1,t.attributes);t=Pi.a.Vv(t.node);for(let A=0;A<t.length;A++)b.Qf(this.SAd(t[A],h));return b}SAd(b,h){b=new Pi.a(b);var t=b.attributes[Pi.a.id];b=Pi.a.Vv(b.node);var A=2;2===b.length&&(A=3);t=new Vo.a(this.floatie,t,A,2,1);for(A=0;A<b.length;A++){const aa=new Pi.a(b[A]);var O=Pi.a.Rfa(aa.node,Pi.a.Ppb);O=Pi.a.Vv(O);this.I2e(t.kQd(A+1),O,aa.attributes[Pi.a.id],
h)}return t}I2e(b,h,t,A){for(t=0;t<h.length;t++){if(this.FPa(h[t]))continue;const O=new Pi.a(h[t]),aa=this.Jea(h[t],A);aa&&b.Qf(aa.YP(O.attributes[Pi.a.wmc]))}}}Object(m.a)(WH,"FloatieBuilder",Il.Builder,[]);class $E{constructor(b,h){this.jv=null;this.MUk=b;this.Xue=h;this.Ghn=this.d5d.bind(this)}get floatie(){return this.jv}$db(b,h,t){h=new Fo.CuiHelper(tl.a.HYa,Box4Intl.Box4Strings,null,null,h);const A=new UH;A.AG=t||{};A.AG.floatieshadingColor=!1;const O=new WH(A,document.body,this.MUk.d$i);O.gua=
new zn.a(b,h);O.lGk();this.Xue.execute(aa=>{O.floatie.eF=aa});O.floatie.JPn(this.Ghn);O.floatie.XOn(()=>[]);this.jv=O.floatie;return this.floatie}}Object(m.a)($E,"AFloatieInitializer",null,[]);class XH extends $E{constructor(b,h,t,A){super(h,t);this.FWf=()=>{this.floatie.qm()};this.Fh=b;this.aI=A}$db(b,h,t){if(b=super.$db(b,h,t))b.gfc=!0,b.l9d=!0,b.preventDismissOnScroll=!0;this.Fh.mYa(this.FWf);return b}$Qc(b,h,t=null){this.aI.Qsh(()=>this.$db(b,h,t))}d5d(){this.floatie.gfc=!0}}Object(m.a)(XH,"PasteFloatieInitializer",
$E,[]);var YH=c(813);class Gz{dya(b,h){this.cMk&&this.koo(b,h,Gz.iKf,Gz.lb)}koo(b,h,t,A){switch(t){case 1:case 6:case 2:case 3:case 4:Gz.nef.show(A,b,h)}}uHi(){switch(Gz.iKf){case 5:case 1:return!0;default:return!1}}Y9k(){return Gz.iKf}get cMk(){return 1!==Jb.App.ya.state}static get nef(){return null!=Gz.Dug?Gz.Dug:Gz.Dug=Sa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static YVl(b){if(!b)return 0;if(2===Jb.App.ya.mode){const h=b.Qa.node,t=ue.GraphIterator.$a(h);t.Yo();return hq.e(t.currentNode)?
2:v.AFrameworkApplication.Elc||!By.isEmbeddedFileNode(h)||By.isInvalid(h)?Po.a.LDm(b.Qa)||Po.a.OAf(b.Qa)?6:1:3}return 4}static get lb(){return he.a.instance.hb.lb}static get iKf(){return Gz.YVl(Gz.lb)}}Object(m.a)(Gz,"SelectionContextMenuProvider",null,[1423]);var GF=c(1823);class HF{constructor(b,h){this.l9d=this.gfc=!1;this.FPc=!0;this.nL=b;this.Pl=h}get isVisible(){return this.nL.r_}get controls(){return null}Dw(){this.nL.Dw();return!0}xff(){}Z5a(b,h,t,A,O=null){this.nL.showFloatie(Object.assign(new GF.a,
{x:b.x,y:b.y}),this.Hkf(t),t,O)}hDb(){return new Sys.UI.Bounds(0,0,0,0)}W2(){return this.Dw()}Hkf(){return[]}}Object(m.a)(HF,"ReactFloatie",null,[164,165]);class ZH{constructor(b){this.lfd=null;this.nL=b}dispose(){}W2(){this.nL.O3b();return!0}showContextMenu(b,h){this.Rnb(b,h.clientPoint,h.ig)}Rnb(b,h,t){this.X5a(b,new Sys.UI.Bounds(h.x,h.y,0,0),t);u.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",b)}X5a(b,h,t,A=null){this.lfd?this.nL.yic(Object.assign(new GF.a,{x:h.x,y:h.y}),
this.lfd.Hkf(t),t,b):this.nL.showContextMenu(Object.assign(new GF.a,{x:h.x,y:h.y}),t,b,A);this.lfd=null}zic(b,h,t,A){this.lfd=Object(Da.a)(HF,t);A.dya(b,h);return!0}B2b(){}}Object(m.a)(ZH,"ReactContextMenuController",null,[611,9]);var nM=c(359);class $H{constructor(){this.Uha=this.text=this.yna=null}}Object(m.a)($H,"BusinessBarButtonData",null,[]);class zG{constructor(){this.text=this.yna=null}}Object(m.a)(zG,"BusinessBarLinkData",null,[]);var aI=c(206);class AG{constructor(b,h,t,A){this.uRg=this.OOg=
this.A9a=this.PMg=null;this.Xs=b;this.jza=h;this.ga=t;this.Na=A}gWf(){this.SEc();this.cCd();this.TEc()}cCd(){}SEc(){const b=Jb.App.ya.jb.Wc;b&&(this.PMg=this.k7a(this.PMg,1,2===Jb.App.ya.mode&&b.Ozf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}RMm(){return v.AFrameworkApplication.ta&&1===v.AFrameworkApplication.ta.mode}TEc(){let b=null;const h=Jb.App.ya.jb.activeSection;if(h){const t=h.VZc;aI.a.WVd(t)?22===t?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===t||20===t?b=ba.a.si?
Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===t?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===t?b=ba.a.si?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===t&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):aI.a.Yii(h.ZXa)||Jb.App.Lm||this.RMm()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.uRg=this.k7a(this.uRg,5,!!b,b)}Blj(b,h,t,A){b=this.jza.create(null,
b,null);b.closeable=!0;b.id=23;b.image=3;b.Uxd(h,()=>{ff.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+t)});A&&(b.xla=A);this.Xs.Kz(b,!0)}Yoo(b,h,t){this.Blj(b,h,t,null)}jpo(b){b=this.jza.create(null,b,null);b.closeable=!0;b.id=20;this.Xs.Kz(b)}uoo(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.A9a||(this.A9a=this.jza.create(b,h,null),this.A9a.closeable=!0,this.A9a.id=27,this.Xs.Kz(this.A9a))}kkm(){this.A9a&&
(this.A9a=this.k7a(this.A9a,27,!1,""))}Wag(b){this.OOg=this.k7a(this.OOg,30,!0,b)}k7a(b,h,t,A,O=!1,aa="",ua=null,Ra=null,ub=null){t?b?b.message=A:(b=this.jza.create(aa,A,null),b.id=h,b.closeable=O,ua&&b.addButton(ua.text,ua.yna,ua.Uha),Ra&&b.Uxd(Ra.text,Ra.yna),ub&&(b.xla=ub),this.Xs.Kz(b,!1)):b&&(this.Xs.removeEntry(b),b=null);return b}CWe(b){this.Xs.Kz(b,void 0)}}Object(m.a)(AG,"BusinessBarController",null,[273]);class BD extends AG{constructor(b,h,t,A){super(b,h,t,A);this.Rra=null}Qof(b,h,t=null,
A=null,O=null,aa=2){if(this.Rra)return null;this.Rra=this.jza.create(h,t||"",null);this.Rra.id=6;this.Rra.image=aa;this.Rra.TXd=!1;b&&(this.Rra.errorCode=b);this.Rra.closeable=!1;h=v.AFrameworkApplication.hF&&this.Na.$("ShowFeedbackButtonOnKickoutBusinessBar");A?(this.Rra.addButton(A,O,""),h&&this.Rra.xlh(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.Zfi(b)})):h&&this.Rra.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.Zfi(b)},"");this.Xs.Kz(this.Rra,void 0,null,null,null);return this.Rra}Zfi(b){u.ULS.sendTraceTag(36471966,
338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Rb(ab.a.giveFeedback,2,{["ErrorCode"]:b})}static get lf(){return Lk.PageReader.instance}}Object(m.a)(BD,"BusinessBarController",AG,[272,273]);class BG{static get DLi(){const b=F.a.Mj(Sf.a.lg(v.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}}Object(m.a)(BG,"OdtUtils",null,[]);class bI extends BD{constructor(b,h,t,A){super(b,h,t,A);this.Mqb=this.Dsc=
this.m2g=this.hMa=this.s2g=this.Tch=null;this.W3j="https://go.microsoft.com/fwlink/?linkid=2134357"}gWf(){super.gWf();this.kPk()}cCd(){const b=Jb.App.ya.jb.Wc;if(b){var h=Jb.App.v_;if(Jb.App.Ds||Jb.App.Lm||h&&v.AFrameworkApplication.Yu)this.Tch=this.k7a(this.Tch,4,BD.lf.pUc(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.s2g=this.k7a(this.s2g,3,BD.lf.M$b(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.m2g=this.k7a(this.m2g,8,BD.lf.EYk(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),BD.lf.eVc(b)?this.hMa||(this.hMa=this.jza.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.hMa.id=14,this.hMa.closeable=!0,this.hMa.image=3,this.hMa.addButton(Box4Intl.Box4Strings.L_LearnMore,Hh.AppFrame.MQm,""),this.Xs.Kz(this.hMa,!1)):this.hMa&&(this.Xs.removeEntry(this.hMa),this.hMa=null)}}kPk(){if(vm.App.xTc){const b=BG.DLi,h=this.jza.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);h.id=9;h.closeable=!0;h.hmk(b);this.Xs.Kz(h,!0)}}Zoo(b,h){if(Jb.App.ya.jb.Wc){const t=new $H;t.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;t.yna=()=>{b()};const A=new zG;A.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;A.yna=()=>{ff.a.openWindow(4,v.AFrameworkApplication.privacyUrl)};this.Dsc=this.k7a(this.Dsc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,
t,A,()=>{h()})}}skm(){this.Dsc&&(this.Dsc=this.k7a(this.Dsc,25,!1,""))}coo(){if(Jb.App.ya.jb.Wc){const b=new zG;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.yna=()=>{ff.a.openWindow(4,this.W3j)};this.Mqb||(this.Mqb=this.jza.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.Mqb.id=32,this.Mqb.closeable=!0,this.Mqb.image=3,this.Mqb.Uxd(b.text,b.yna),this.Xs.Kz(this.Mqb,!1))}}KX(b){return this.Xs.KX(b)}Kz(b,
h){this.Xs.Kz(b,h)}}Object(m.a)(bI,"BusinessBarController",BD,[400,272,273]);class cI{constructor(){this.menuTargetType=null}}Object(m.a)(cI,"MenuTargetDescriptor",null,[]);var Hz=c(584);class vk extends Hz.a{constructor(b,h,t,A=!1,O,aa=null,ua){super();this.L8d=(Ra,ub,Nb,Yb,bc)=>{if(1===Nb)return 32;Ra=bc.ux;bc=bc.qd;ub=Object.assign(new gj.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.i5k(ub,Ra,bc.IsShadowMenuOpen);bc.MenuItems=ub;return 32};this.aDn=h;this.kn=t;this.Pbb=
aa;this.aEe=A;this.Ub(b);this.u8a=ua;vk.mXa[1]=qa.a.Fhe;vk.mXa[2]=qa.a.DRd;vk.mXa[3]=qa.a.kie}get Pkl(){return dr.a.qGd}get Okl(){return dr.a.LEd}get Qkl(){return dr.a.e8d}get lef(){return dr.a.aVi}Ub(b){b.gb(qa.a.PWf,mc.a.application,this.L8d,96);b.gb(qa.a.EWi,mc.a.application,this.L8d,96)}show(b,h,t){let A=null,O=new Sys.UI.Bounds(0,0,0,0);const aa=this.P1l(b);if(aa&&(b=b.Qa.node)&&(b=b.Ee(pc.InteractiveViewManager.instance.vd.jc))){O=Vw.a.Gq(b,aa.end);if(v.AFrameworkApplication.isRtl&&O.x>h.x||
!v.AFrameworkApplication.isRtl&&O.x+O.width<h.x||O.y+O.height<h.y)O=Vw.a.Gq(b,aa.end-1);h.x=O.x+(v.AFrameworkApplication.isRtl?0:O.width);h.y=O.y+O.height;A=6}Hz.a.X5a("ContextMenu",new Sys.UI.Bounds(h.x,h.y,O.width,O.height),t,A)}f_(b,h){return this.$6c(b)||vk.REc(qa.a.mergeCells)||vk.REc(qa.a.uHa)||this.Hbg(b)||this.elj(b,h)||vk.Slj()||vk.Glj(b).returnValue}$6c(b){return 2===Jb.App.ya.mode&&this.oTc(b)}nHc(b,h,t=null){if(Ms.jB()&&2===Jb.App.ya.mode){h=this.u8a.mFh(b.Qa);if(!h||!this.YIm()&&!this.qKm(h.errorDetails))return;
h=h.errorDetails}else{if(!this.$6c(b))return;h=this.wai(b)}var A=Sf.a.lg(h.lcid);const O=A?A.name:"UNKNOWN";A=Object(hc.a)(eq.a,h)?h.typeId:"";u.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,A,O);if(b=this.aDn.S2b(b,h))t.push.apply(t,b),this.S0m(h,A)}qKm(b){return b&&(1===b.proofingType||2===b.proofingType)}YIm(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",
!1)}S0m(b,h){const t=vk.mXa[b.proofingType];t&&(v.AFrameworkApplication.xa.processAction(t,2),u.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",t,h,b.proofingType,Ms.jB()))}wai(b){return this.kn.Hma(b.Qa).errorDetails}oTc(b){return this.kn.Gde(b)}n6b(){return null}kFd(){}P1l(b){return this.oTc(b)?this.kn.Hma(b.Qa):(b=this.n6b(b))?new cc.a(b.Fp,b.cpEnd):null}Hbg(b){if(2!==Jb.App.ya.mode||!b)return!1;b=Ux.a.HCa(b.toArray());
return!!vk.Vg.MS(b,14)}tmj(b,h){return 2===h||3===h&&!this.oTc(b)}elj(b,h){return 3!==h||this.oTc(b)}$1k(){const b=[];b.push(Object.assign(new Eh.a,{ExternalId:this.Pkl}));b.push(Object.assign(new Eh.a,{ExternalId:this.Okl}));b.push(Object.assign(new Eh.a,{ExternalId:this.Qkl}));return b}m6k(){const b=[];this.aEe&&b.push(Object.assign(new Eh.a,{ExternalId:this.lef}));return b}static get Ad(){return null!=vk.zAg?vk.zAg:vk.zAg=Sa.a.instance.resolve("Box4.List.IListReader")}static get Vg(){return Ik.ContextSetEditor.instance}static get KDm(){null==
vk.xDe&&(vk.xDe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return vk.xDe}static get QXc(){null==vk.Zpb&&(vk.Zpb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return vk.Zpb}static get Ysa(){null==vk.E9&&(vk.E9=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return vk.E9}static REc(b){return 32===v.AFrameworkApplication.xa.processAction(b,
1)}static Slj(){return 2===Jb.App.ya.mode&&!!Jb.App.Ov.tI&&Jb.App.Ov.tI.eUc(qa.a.X6d.toString())}static Ulj(b){if(1!==b.length||!b.Qa.Xk)return!1;b=ue.GraphIterator.$a(b.Qa.node);b.Ab(11);b.wc();return b.Xr(4)&&!vk.Ad.Fw(b).listType?!0:!1}static Glj(b){let h=!1,t=!1;if(!b)return{returnValue:!1,zhb:h,nQc:t};if(vk.QXc)return vk.ipo(b,t);if(!(b.Sx||vk.KDm&&2===b.length&&b.Rc.contextId===mc.a.endOfParagraph))return{returnValue:!1,zhb:h,nQc:t};b=b.Qa.clone();h=32===v.AFrameworkApplication.xa.Nf(b,qa.a.a4a,
1,!0,null,null);t=32===v.AFrameworkApplication.xa.Nf(b,qa.a.insertHyperlink,1,!0,null,null);return{returnValue:h||t,zhb:h,nQc:t}}static ipo(b,h){let t;h=b.Qa.clone();t=vk.Ysa&&zc.l(h);let A=!t&&32===v.AFrameworkApplication.xa.Nf(h,qa.a.a4a,1,!0,null,null);if(b.Sx||2===b.length&&b.Rc.contextId===mc.a.endOfParagraph)h=!t&&32===v.AFrameworkApplication.xa.Nf(h,qa.a.insertHyperlink,1,!0,null,null);else{h=!0;const O=b.length;for(let aa=0;aa<O;aa++){const ua=b.J(aa).clone();if(ua.contextId===mc.a.paragraph||
ua.contextId===mc.a.Fd)(t=vk.Ysa&&zc.l(ua))||(h=32===v.AFrameworkApplication.xa.Nf(ua,qa.a.insertHyperlink,1,!0,null,null)&&h);else if(ua.contextId!==mc.a.endOfParagraph)return h=A=!1,{returnValue:!1,zhb:A,nQc:h}}}return{returnValue:A||h,zhb:A,nQc:h}}static bPd(b){const h=Object.assign(new eh.a,{ControlList:[]});for(const t of b)h.ControlList.push(Object.assign(new Eh.a,{ExternalId:t}));return h}static YF(b){const h=[];for(const t of b)h.push(Object.assign(new Eh.a,{ExternalId:t}));return h}}vk.xDe=
null;vk.Zpb=null;vk.E9=null;vk.mXa=[];Object(m.a)(vk,"AEditSurfaceContextMenu",Hz.a,[]);var oM=c(606),pM=c(861),qM=c(1750);class IF{static Y0l(b,h,t){h=[];t.Fzn.S2b(t.rEl(b),h);return h}static GMl(b,h,t){const A=[];if(t.$6c(b))return A;t.K.$("WordEditorIdeasCardsIsEnabled")&&!ba.a.jt||t.bcf.kFd(b,null,h,A);return A}static c6l(b,h,t){const A=[];t.nHc(b,h,A);return A}}Object(m.a)(IF,"ContextMenuSectionHelper",null,[]);class wr{static sMl(b,h,t){h=[];t.uel(b)&&h.push(Object.assign(new Eh.a,{ExternalId:"ReviewDesignerSuggestion",
LabelText:t.i3l(b)}));return h}static gWl(){return vk.REc(qa.a.mergeCells)?vk.YF(["MergeCells"]):vk.REc(qa.a.Khe)?vk.YF(["SplitCells"]):[]}static F9l(b,h,t){h=[];if(!t.yh.fEh(b))return h;b=t.yh.Dei(b);h.push(Object.assign(new Eh.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new Eh.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,
WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return h}static qHl(b,h,t){return v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&b&&b.Qa&&b.Qa.node&&t.Jc&&t.Jc.EKi(b.Qa.node)?vk.YF(["ShowCatchUpActivitiesForParagraph"]):[]}static mNl(b){return Ep.yoo(b)?vk.YF(["Draw"]):Ep.Klj(b)?vk.YF(["EditIllustration"]):[]}static ybm(b){return Ep.Uqo(b)?[Object.assign(new Jj.a,{ExternalId:"WrapTextMenu"})]:[]}static aQd(b,h,t){return t.Mel(b)?vk.YF(["CreatePullQuote"]):[]}static getContentControls(b,
h,t){return t.sel()?vk.YF(["RemoveContentControl"]):[]}static aJl(){return vk.YF(["NewComment"])}static LHl(b){const h=[];!Ep.Gbg(b)&&Ep.ibg(b)&&fc.SessionStatusManager.instance.vH&&b.uH&&h.push(Object.assign(new Jj.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static gTl(b,h,t){h=[];!Ep.Gbg(b)&&Ep.ibg(b)&&fc.SessionStatusManager.instance.vH&&(u.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.uH&&!v.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?
h.push(...vk.YF(["ChangePicture"])):h.push(...t.q4k().ControlList),(b=Ep.T6h())&&0<b.length&&(t=t.W7k(b),null!=t&&h.push(...t.ControlList)));return h}static M1l(){return vk.Slj()?vk.YF(["SetProofingLanguage"]):[]}static s3l(b,h,t){return t.XIm&&t.eqo(b)?vk.YF(["Rewrite"]):[]}static JUl(b){return vk.Ulj(b)?vk.YF(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static B_l(){return Ep.gmj()?vk.YF(["ParagraphOptions"]):[]}static $Rl(b){return Ep.Klj(b)?vk.YF(["EditIllustration"]):[]}static V5l(b){return Ep.Gbg(b)?
vk.YF(["ShowSmartLookupPane"]):[]}static Q9l(b){return Ep.Ylj(b)?vk.YF(["ModernTranslatorSplitButton"]):[]}static jRl(b,h,t){h=[];if(b.Sx){const A=b.Qa;if(A.contextId===mc.a.paragraph||A.contextId===mc.a.Vc||A.contextId===mc.a.Fd){b=b.Qa.node;if(!t.hl.Yb(b)||b.jr||""===b.characterData)return h;t.wdf.eOd(b)&&h.push(...vk.YF(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,t){h=[];if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.Sx){const A=
b.Qa;(nf.SelectionEditor.jf(A)||nf.SelectionEditor.R1a(A))&&t.kEk.ANd(b.Qa.node,b.Qa.cpBegin)&&(h.push(...vk.YF(["DeleteBookmarkContextMenu"])),v.AFrameworkApplication.ye("bookmarks-edit-ex;bookmarks-edit-ex-cf"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)&&h.push(...vk.YF(["EditBookmarkNameContextMenu"])))}return h}static Ufa(b){let h=!1,t=!1;const A=[];({zhb:h,nQc:t}=vk.Glj(b)).returnValue&&(h?t?A.push(...vk.YF(["EditHyperlink","SelectHyperlink",
"OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):A.push(...vk.YF(["OpenHyperlink"])):t&&(v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost")?A.push(...vk.YF(["InsertLinkFlyout"])):A.push(...vk.YF(["InsertLink"]))));return A}static wIl(b,h,t){const A=[];if(!t.elj(b,h))return A;2===Jb.App.ya.mode?(A.push(...t.$1k()),A.push(...t.m6k()),3===h&&t.oTc(b)&&A.push(Object.assign(new Eh.a,{ExternalId:"Delete"}))):(!v.AFrameworkApplication.protectFile&&
!v.AFrameworkApplication.qG||v.AFrameworkApplication.BBb)&&A.push(Object.assign(new Eh.a,{ExternalId:"Copy"}));return A}static Vkf(b,h,t){return t.Hbg(b)&&t.tmj(b,h)?vk.YF(["EditTableAltText"]):[]}static X6h(b,h,t){return t.Fel(b)?vk.YF(["ShowIntentSuggestion"]):[]}static O7l(b,h,t){const A=[];t.Hbg(b)&&!t.tmj(b,h)&&(A.push(Object.assign(new Jj.a,{ExternalId:"InsertTableMenu"})),A.push(Object.assign(new Jj.a,{ExternalId:"DeleteTableMenu"})),A.push(Object.assign(new Jj.a,{ExternalId:"SelectTableMenu"})));
return A}static U7l(b,h,t){return Ep.Xb.isFeatureEnabled(108)&&t.vqo(b)?vk.YF(["UpdateTableOfContents"]):[]}static XNl(b){return Ep.Eoo(b)?vk.YF(["ShowHideEquationToolsPane"]):[]}}Object(m.a)(wr,"ContextMenuSectionItemHelper",null,[]);class Ep extends vk{get hl(){return this.eb}get wdf(){return this.$Ua}constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd,ee,Od,fe=!1,Ee=null,re=null,Fg,Gg,bm,An){super(b,h,t,fe,void 0,Ee,Fg);this.hHd=An;this.aMe=this.cP=null;this.AUg=!1;this.tde=new Map;this.KD=
{};this.mkb={};this.ga=b;this.K=A;this.yh=O;this.WV=Ra;this.fI=ub;this.zm=Nb;this.Ygk=!!Ee;this.bcf=Yb;this.Fzn=bc;this.xOg=Cd;this.qja=ee;this.kEk=Od;this.$Ua=bm;this.eb=Gg;jd&&jd.execute(Zr=>{this.Mah=Zr});Dc&&Dc.execute(Zr=>{this.aMe=Zr});this.Jc=ua;this.qz=Pc;re&&re.execute(Zr=>{this.cP=Zr});this.rpm();this.Jxn();this.atl();this.Ixn()}get lef(){return this.Ygk?dr.a.b8d:super.lef}Amo(){const b=vm.App.Hn.jb.xc.nb.hb.lb;return this.$6c(b)&&2!==this.wai(b).errorType}f_(b,h){return super.f_(b,h)||
Ep.gmj()||vk.Ulj(b)||Ep.ibg(b)||Ep.Ylj(b)}i5k(b,h,t){const A=[];let O=null;try{O=vm.App.Hn.jb.xc.nb.hb.lb}catch(aa){u.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.xxn(O,h,A,this.oKl(O));b.MenuSectionList.push(...A);this.udo(b);!t&&this.Mah&&this.Mah.vBn(b.MenuTargetDescriptor.menuTargetType,A)}oKl(b){return vk.REc(qa.a.mergeCells)?Jw.hrg:b.GSc?Jw.Nng:b.uH?Jw.Upg:b.sac()?Jw.zng:Ep.lAf&&b.Z1a?Jw.sng:Jw.Vng}r4k(b){b=Ep.F4k(b);return Object.assign(new Eh.a,
{ExternalId:"SmartLookupContextMenu",LabelText:b})}X7k(b){return(b=Ep.RGj(b))?Object.assign(new Eh.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}q4k(){const b=Object.assign(new eh.a,{ControlList:[]}),h=Ep.T6h();b.ControlList.push(this.r4k(h));return b}W7k(b){const h=Object.assign(new eh.a,{ControlList:[]});if(b&&0<b.length){b=this.X7k(b);if(null==b)return null;h.ControlList.push(b)}return h}Lac(b){return b.uH||2<b.length||!b.length||2===b.length&&!nf.SelectionEditor.Dk(b.Rc)||1===b.length&&
nf.SelectionEditor.Dk(b.Rc)?!1:this.FEf(b.Qa)}FEf(b){return qe.ParagraphReader.Yb(b.node)?""!==qe.ParagraphReader.text(b.node).trim():!1}vqo(b){var h=ue.GraphIterator.$a(b.Qa.node);h=Object(Da.a)(oM.a,h.currentNode);return b.uH?!1:!!h&&h.jr}atl(){v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.qz.execute(b=>{b.isFeatureEnabled(pM.a.RJi,
!1).then(h=>{h||u.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.AUg=h;return null})}):u.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get XIm(){v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.AUg:!1}eqo(b){if(!this.Lac(b)||
b.Z1a||b.sac())return!1;b=b.Qa;if(qe.ParagraphReader.im(b)||nf.SelectionEditor.jf(b)||nf.SelectionEditor.gl(b)){b=this.fI.zOa(b);b||(b=v.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}Fel(b){if(1!==b.length||ba.a.jt)return!1;const h=v.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled");if(h&&this.Amo()||Ms.jB()&&!this.u8a.mFh(b.Qa))return!1;const t=Ep.Xb.isFeatureEnabled(61);
return b.J(0).contextId===mc.a.Vc&&(h||t)&&0<this.zm.rNc(b.J(0),0).count||h&&this.n6b(b)?!0:!1}uel(b){return 1===b.length&&this.xOg.bA(b.Qa.node).xga}i3l(b){var h,t;const A=null===(h=this.hHd)||void 0===h?void 0:h.MT(null===(t=null===b||void 0===b?void 0:b.Qa)||void 0===t?void 0:t.node);return qM.a.xei(A)}get Cw(){return null!=this.nug?this.nug:this.nug=Sa.a.instance.Ma("WordEditor.Designer.IDesignerTaskPane")}Mel(b){if(!this.qja.Nri()||!this.Cw||this.Cw.isVisible||!(1===b.length||2===b.length&&nf.SelectionEditor.Dk(b.Rc))||
b.wjb||!nf.SelectionEditor.gl(b.Qa)&&b.Qa.contextId!==mc.a.paragraph||b.axi()||this.xOg.bA(b.Qa.node).xga)return!1;const h=qe.ParagraphReader.text(b.Qa.node),t=b.Qa.contextId===mc.a.paragraph?0:b.Qa.cpBegin,A=b.Qa.contextId===mc.a.paragraph?h.length:b.Qa.cpEnd-t;return 1>A||1500<A||F.a.mf(F.a.FGa(h.substr(t,A)))||1!=Ds.a.xgb(b.Qa.node)?!1:!0}sel(){return 32==this.ga.processAction(qa.a.B2c,1)}n6b(b){return this.bcf.n6b(b)}kFd(b,h,t,A=null){this.$6c(b)||this.bcf.kFd(b,h,t,A)}rEl(b){return this.aMe?
this.aMe.sEl(b):[]}udo(b){const h=this.cP?this.cP.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new cI,{menuTargetType:h})}static get Xb(){return null!=Ep.Dvg?Ep.Dvg:Ep.Dvg=Sa.a.instance.resolve("Box4.IFeatureHelper")}static get lAf(){if(null!=Ep.Bzg)var b=Ep.Bzg;else{var h;b=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1);b=Ep.Bzg=b}return b}static ibg(b){return v.AFrameworkApplication.m_&&
!b.Z1a&&Sa.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").wMm()}static bQd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=F.a.Yy(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static F4k(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=Ep.bQd(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static RGj(b){b=Ep.bQd(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,
b):null}static T6h(){const b=(new Jl.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static Klj(b){const h=Ep.Xb.isFeatureEnabled(47);return!b.mGc&&h&&!ba.a.jt&&(b.Z1a||h&&!Ep.lAf&&b.uH)}static yoo(b){const h=Ep.Xb.isFeatureEnabled(47);return!b.mGc&&h&&!ba.a.jt&&Ep.lAf&&b.uH}static Gbg(b){return v.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&!b.sac()}static Ylj(b){return v.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&!b.Z1a&&!b.sac()}static Eoo(b){return b.bxi()&&
v.AFrameworkApplication.ta.Ob.XTc}static gmj(){return 2===vm.App.Hn.mode}static Uqo(b){return b.uH}xxn(b,h,t,A){this.mkb[A].forEach(O=>{const aa=Object.assign(new eh.a,{ControlList:[]}),ua=aa.ControlList;O.forEach(Ra=>{Ra instanceof Du?t.push(...this.tde.get(Ra)(b,h,this)):ua.push(...this.KD[Ra](b,h,this))});(null===ua||void 0===ua?0:ua.length)&&t.push(aa)})}Ixn(){this.tde.set(Du.wQb,IF.Y0l);this.tde.set(Du.eoe,IF.GMl);this.tde.set(Du.Toe,IF.c6l)}Jxn(){this.KD[ei.Qpb]=wr.wIl;this.KD[ei.Xoe]=wr.O7l;
this.KD[ei.Yoe]=wr.U7l;this.KD[ei.doe]=wr.sMl;this.KD[ei.yoe]=wr.gWl;this.KD[ei.Rne]=wr.Vkf;this.KD[ei.qoe]=wr.gTl;this.KD[ei.zbd]=wr.X6h;this.KD[ei.poe]=wr.$Rl;this.KD[ei.Soe]=wr.V5l;this.KD[ei.$oe]=wr.Q9l;this.KD[ei.Foe]=wr.M1l;this.KD[ei.Ioe]=wr.s3l;this.KD[ei.Bbd]=wr.JUl;this.KD[ei.Ebd]=wr.B_l;this.KD[ei.Goe]=wr.aQd;this.KD[ei.lbd]=wr.getContentControls;this.KD[ei.tpe]=wr.ybm;this.KD[ei.foe]=wr.mNl;this.KD[ei.Yne]=wr.LHl;this.KD[ei.Zoe]=wr.F9l;this.KD[ei.Xne]=wr.qHl;this.KD[ei.jbd]=wr.getBookmark;
this.KD[ei.loe]=wr.jRl;this.KD[ei.noe]=wr.Ufa;this.KD[ei.Opb]=wr.aJl;this.KD[ei.zbd]=wr.X6h;this.KD[ei.goe]=wr.XNl}rpm(){const b=[ei.yoe,ei.Rne,ei.Xoe];this.mkb[Jw.hrg]=[[ei.Qpb],b,[ei.Opb],[Du.wQb],[ei.lbd]];this.mkb[Jw.Upg]=[[ei.Qpb],[ei.Yne,ei.foe,ei.tpe],b,[ei.Opb],[Du.wQb]];this.mkb[Jw.zng]=[[ei.goe],[ei.Bbd,ei.Ebd],[ei.jbd,ei.Opb],[Du.wQb]];this.mkb[Jw.Vng]=[[ei.zbd],[ei.doe],[Du.Toe],[Du.eoe],[ei.Qpb],[ei.qoe,ei.poe,ei.Soe,ei.$oe],[ei.Foe,ei.Ioe,ei.Ebd],[ei.Bbd],b,[ei.lbd],[ei.noe,ei.jbd,ei.loe,
ei.Opb],[ei.Goe],[ei.Zoe],[ei.Xne],[ei.Yoe],[Du.wQb]];this.mkb[Jw.Nng]=[[ei.Qpb],[ei.Opb]];this.mkb[Jw.sng]=[[ei.Qpb],[ei.poe]];this.mkb[Jw.QIj]=[[ei.zbd],[ei.doe],[Du.Toe],[Du.eoe],[ei.Qpb],[ei.Yne],[ei.foe],[ei.tpe],[ei.qoe],[ei.Soe],[ei.$oe],[ei.Foe],[ei.Ioe],[ei.goe],[ei.Bbd],[ei.Ebd],[ei.noe],[ei.yoe],[ei.Rne],[ei.Xoe],[ei.jbd],[ei.loe],[ei.Opb],[ei.Goe],[ei.lbd],[ei.Zoe],[ei.Xne],[ei.Yoe],[Du.wQb]]}}Object(m.a)(Ep,"EditSurfaceContextMenu",vk,[]);var Jw;(function(b){b[b.hrg=1]="TABLE_MULTI_CELL";
b[b.Vng=2]="GENERIC";b[b.Upg=3]="PICTURE";b[b.zng=4]="EQUATION";b[b.QIj=5]="LEGACY";b[b.Nng=6]="FLUID";b[b.sng=7]="DRAWING"})(Jw||(Jw={}));Object(m.b)("Scenarios",Jw);class Du{}Du.wQb=new Du;Du.eoe=new Du;Du.Toe=new Du;Object(m.a)(Du,"Sections",null,[]);var ei;(function(b){b[b.zbd=1]="INTENT_SUGGESTION";b[b.Qpb=2]="ESSENTIALS";b[b.qoe=3]="INSIGHT";b[b.poe=4]="ILLUSTRATION";b[b.Soe=5]="SMART_LOOKUP";b[b.$oe=6]="TRANSLATE";b[b.Foe=7]="PROOFING";b[b.Ioe=8]="REWRITE_SUGGESTIONS";b[b.Bbd=9]="LISTS";b[b.Ebd=
10]="PARAGRAPH_OPTIONS";b[b.yoe=11]="MERGE_SPLIT_CELLS";b[b.Rne=12]="ALT_TEXT";b[b.noe=13]="HYPERLINK";b[b.jbd=14]="BOOKMARK";b[b.loe=15]="HEADING_LINK";b[b.Opb=16]="COMMENT";b[b.Goe=17]="PULL_QUOTE";b[b.tpe=18]="WRAP_TEXT";b[b.foe=19]="DRAW";b[b.Zoe=20]="TRACK_CHANGE";b[b.Xne=21]="CATCHUP_ACTIVITIES";b[b.Yoe=22]="TABLE_OF_CONTENTS";b[b.doe=23]="DESIGNER_REVIEW";b[b.Xoe=24]="TABLE_ITEMS";b[b.Yne=25]="CHANGE_PICTURE";b[b.goe=26]="EQUATION_TOOLS";b[b.lbd=27]="CONTENT_CONTROL"})(ei||(ei={}));Object(m.b)("SectionItem",
ei);class MC extends Hz.a{constructor(b,h,t){super();this.ol=null;this.T8d=(A,O,aa,ua,Ra)=>{if(1===aa)return 32;A=[];O=[];this.Bmo()&&O.push("InsertTabStopMenuSplitButton");this.lmo()&&O.push("ClearAllTabStops");O.push("HideRuler");A.push(MC.bPd(O));O=Object.assign(new gj.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});O.MenuSectionList.push(...A);Ra.MenuItems=O;return 32};this.ga=b;this.Um=h;this.Hy=t;this.Ub()}get u$a(){return document.getElementById("WACHorizontalRuler")}get aN(){return this.Um&&
this.Um.instance?this.Um.instance.ij:1}get target(){return this.ol}show(b,h){this.ol=b;Hz.a.Rnb("RulerContextMenu",b,h);u.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",MC.yO);b.set("Response","Ruler Context menu invoked.");wa.Health.instance.recordKpiUsage(MC.kpiName,1,MC.y7,b)}M2l(){var b=0,h=(this.target.x-ff.a.zlf(this.u$a))/this.aN;h=Hc.a.ny(h,0);var t={},A=this.Hy.l5b,O=ue.GraphIterator.$a(A);O.yd();if(!ni.TableReader.Jw(O))return 32===
this.ga.Rb(qa.a.tGa,2,t)&&(b=t.marginLeft),h-b;b={};O={};t=this.ga.Rb(qa.a.z1c,2,b);var aa=this.ga.Rb(qa.a.lLb,2,O);if(32!==t||32!==aa)return u.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;aa=O.TablePosition;if(!aa||!b||0>=b.length)return u.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;t=0;O=ue.GraphIterator.$a(A);O.Ab(14)&&(O.fd(16),t=Gv.a(O,!0));A=aa.x/this.aN;for(O=0;O<t;O++)A+=b[O];return h-
A}Ub(){this.ga.gb(Vc.a.T8d,mc.a.application,this.T8d,96)}Bmo(){var b={},h={},t=this.ga.Rb(qa.a.tGa,2,b),A=this.ga.Rb(qa.a.F4a,2,h);if(32===t&&32===A){A=h.it;t=Hc.a.Ki(A.qna,0);A=1===A.specialIndentType?Hc.a.Ki(A.iB,0):Hc.a.Ki(A.iB-A.Cca,0);const O=Hc.a.Ki(b.marginLeft,0);b=Hc.a.Ki(b.marginRight,0);const aa=ff.a.zlf(this.u$a),ua=ff.a.T0h(this.u$a);h.isRtl?(h=aa+this.aN*Math.max(b,b+t),t=ua-this.aN*Math.max(O,O+A)):(h=aa+this.aN*Math.max(O,O+A),t=ua-this.aN*Math.max(b,b+t));if(this.target.x>=h&&this.target.x<=
t)return!0}return!1}lmo(){var b={};if(32!==this.ga.Rb(Vc.a.ZKb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static bPd(b){const h=Object.assign(new eh.a,{ControlList:[]});for(const t of b)h.ControlList.push(Object.assign(new Eh.a,{ExternalId:t}));return h}}MC.y7="wwaengidc";MC.kpiName="WordRuler";MC.yO="RulerContextMenu";Object(m.a)(MC,"RulerContextMenu",Hz.a,[403]);let MA;class fr{static get uc(){return null!=fr.fGg?fr.fGg:fr.fGg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get EG(){return null!=
fr.YFg?fr.YFg:fr.YFg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get qj(){return null!=fr.Jxg?fr.Jxg:fr.Jxg=Sa.a.instance.resolve("Box4.IInsertionPointFormatting")}static kZi(b,h,t){if(1===h)return(b?fr.TLk(t):fr.sLk(t))?32:8;(b=fr.S6l(b,t))&&fr.cyk(b,t);return 32}static cyk(b,h){const t=new Te.GraphTransaction(15);t.Eb(h);fr.qj.c5a();fr.EG.rJ(b,h,!1);t.dispose()}static TLk(b){b=fr.uc.Uo(b);return!!b&&fr.uc.jg(b)!==Tf.StyleReader.wordStyleIdHeading1}static sLk(b){b=fr.uc.Uo(b);return!!b&&
fr.uc.jg(b)!==Tf.StyleReader.H7a}static S6l(b,h){const t=fr.uc.Uo(h);return t?fr.uc.qC(h).Ni(fr.Q6l(b,fr.uc.jg(t))):null}static Q6l(b,h){h=fr.headingsList.indexOf(h);b=b?h-1:h+1;return 0<=b&&b<fr.headingsList.count?fr.headingsList.J(b):null}}fr.headingsList=(MA=new Mb.a,MA.add(Tf.StyleReader.wordStyleIdHeading1),MA.add(Tf.StyleReader.wordStyleIdHeading2),MA.add(Tf.StyleReader.wordStyleIdHeading3),MA.add(Tf.StyleReader.E7a),MA.add(Tf.StyleReader.F7a),MA.add(Tf.StyleReader.G7a),MA.add(Tf.StyleReader.Fpb),
MA.add(Tf.StyleReader.Gpb),MA.add(Tf.StyleReader.H7a),MA);Object(m.a)(fr,"NavigationPaneEditor",null,[]);class aF extends Hz.a{constructor(){super();this.R2=null;this.L8d=(b,h,t,A,O)=>{if(1===t)return 32;b=new Sys.StringBuilder;b.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));b.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');b.append(Hz.a.IZh("promoteHeading",Vc.a.F9d,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));b.append(Hz.a.IZh("demoteHeading",
Vc.a.dHd,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));b.append("</Controls></MenuSection></Menu>");O.PopulationXML=b.toString();return 32};this.F9d=(b,h,t)=>fr.kZi(!0,t,this.R2.Cb);this.dHd=(b,h,t)=>fr.kZi(!1,t,this.R2.Cb)}show(b){aF.xh||(this.B2b(),aF.xh=!0);Hz.a.showContextMenu("mnuNavPaneWordEditor",b)}B2b(){const b={PopulateDynamically:"true",PopulateOnlyOnce:"false"};b.PopulateQueryCommand=""+Vc.a.MWi;b.Command=""+ab.a.$ka;Hz.a.w2k(b);v.AFrameworkApplication.xa.pa(Vc.a.MWi,
mc.a.application,this.L8d);v.AFrameworkApplication.xa.pa(Vc.a.F9d,mc.a.view,this.F9d);v.AFrameworkApplication.xa.pa(Vc.a.dHd,mc.a.view,this.dHd)}}aF.xh=!1;Object(m.a)(aF,"WordEditorNavigationPaneContextMenu",Hz.a,[404]);var xx=c(302),WB=c(1460),rM=c(489),sM=c(751),JF=c(1191),CG=c(1681),DG=c(995);class KF{constructor(){this.b8=this.Iti=!1;this.TOb=2;this.Xv=0;this.M7a=1}}Object(m.a)(KF,"WrapTextPropertiesData",null,[]);class jm extends JF.a{constructor(b=null){super(b);this.Sah=new CG.a;this.iih=new KF;
this.teh=new DG.a;this.zAe=!1;this.Pki=h=>{const t=new xx.a;t.pDa=!0;t.IL=h;return t};this.i0=()=>{const h=new xx.a;h.IEb=!1;h.IL=qa.a.tGa;h.qd=this.Sah;h.eac=!0;h.Bga=!0;return h};this.j_i=()=>{const h=new xx.a;h.IEb=this.zAe;this.zAe=!0;h.IL=qa.a.G4a;h.qd=this.teh;h.eac=!0;h.Bga=!0;return h};this.Qad=()=>{const h=new xx.a;h.IEb=!1;h.IL=Vc.a.Gfc;h.qd=this.iih;h.eac=!0;h.Bga=!0;return h};this.bUd=(h,t)=>{const A=new xx.a;A.qd=new ji.DictionaryPropertySet;switch(h){case Vc.a.zQc:A.qd.setValue(Gd.a.Uhb,
t[Ue.a.Number]);break;case Vc.a.wQc:A.qd.setValue(Gd.a.Rhb,t[Ue.a.Number]);break;case Vc.a.xQc:A.qd.setValue(Gd.a.Shb,t[Ue.a.Number]);break;case Vc.a.yQc:A.qd.setValue(Gd.a.Thb,t[Ue.a.Number])}return A};this.zEn=()=>{const h=new xx.a;h.qd=new ji.DictionaryPropertySet;h.Bga=!0;return h}}initialize(){super.initialize();this.hd.Z(Vc.a.dGf,WB.a.eib);this.hd.Z(Vc.a.iGf,WB.a.eib);this.hd.Z(Vc.a.kGf,WB.a.eib);this.hd.Z(Vc.a.NZf,jm.wRa);this.hd.Z(Vc.a.t1c,jm.wRa);this.hd.Z(Vc.a.GZf,jm.wRa);this.hd.Z(ab.a.oLb,
jm.wRa);this.hd.Z(qa.a.n$d,this.i0);this.hd.Z(qa.a.m$d,this.i0);this.hd.Z(qa.a.l$d,this.i0);this.hd.Z(qa.a.p$d,this.i0);this.hd.Z(qa.a.o$d,this.i0);this.hd.Z(qa.a.k$d,this.i0);this.hd.Z(qa.a.w$d,this.i0);this.hd.Z(qa.a.v$d,this.i0);this.hd.Z(qa.a.u$d,this.i0);this.hd.Z(qa.a.r$d,this.i0);this.hd.Z(qa.a.s$d,this.i0);this.hd.Z(qa.a.t$d,this.i0);this.hd.Z(qa.a.$Zf,this.i0);this.hd.Z(qa.a.ZZf,this.i0);this.hd.Z(qa.a.rZf,this.i0);this.hd.Z(qa.a.tZf,this.i0);this.hd.Z(qa.a.sZf,this.i0);this.hd.Z(qa.a.qZf,
this.i0);this.hd.Z(qa.a.N5a,jm.a4m);this.hd.Z(qa.a.vSa,jm.ksn);this.hd.Z(qa.a.gnb,jm.uUk);this.hd.Z(qa.a.fla,jm.wRa);this.hd.Z(qa.a.xKb,jm.wRa);this.hd.Z(qa.a.ARa,jm.wRa);this.hd.Z(qa.a.fta,jm.wRa);this.hd.Z(qa.a.txa,jm.wRa);this.hd.Z(Vc.a.g0c,jm.wRa);this.hd.Z(Vc.a.zLd,WB.a.Zif);this.hd.Z(Vc.a.ALd,this.r_h);this.Jm.Z(Vc.a.e0c,WB.a.vNa);this.Jm.Z(Vc.a.f0c,WB.a.vNa);this.hd.Z(qa.a.nNb,WB.a.z_a);this.hd.Z(qa.a.mNb,WB.a.z_a);this.hd.Z(qa.a.wnb,WB.a.z_a);this.hd.Z(qa.a.l_f,this.$E);this.hd.Z(qa.a.j_f,
this.$E);this.hd.Z(qa.a.k_f,this.$E);this.hd.Z(qa.a.YK,jm.RCn);this.Jm.Z(Vc.a.X$d,jm.w2c);this.Jm.Z(Vc.a.Y$d,jm.w2c);this.Jm.Z(Vc.a.Z$d,jm.w2c);this.Jm.Z(Vc.a.V$d,jm.w2c);this.Jm.Z(Vc.a.W$d,jm.w2c);this.hd.Z(Vc.a.X$d,this.Qad);this.hd.Z(Vc.a.Y$d,this.Qad);this.hd.Z(Vc.a.Z$d,this.Qad);this.hd.Z(Vc.a.V$d,this.Qad);this.hd.Z(Vc.a.W$d,this.Qad);this.hd.Z(Vc.a.Dne,jm.kmc);this.hd.Z(Vc.a.Ene,jm.kmc);this.hd.Z(Vc.a.Fne,jm.kmc);this.hd.Z(Vc.a.Gne,jm.kmc);this.hd.Z(Vc.a.Hne,jm.kmc);this.hd.Z(Vc.a.Ine,jm.kmc);
this.hd.Z(Vc.a.mHa,jm.A5b);this.hd.Z(Vc.a.zlj,jm.A5b);this.hd.Z(Vc.a.Alj,jm.A5b);this.hd.Z(Vc.a.Gge,jm.A5b);this.hd.Z(Vc.a.Hge,jm.A5b);this.hd.Z(Vc.a.O6c,jm.A5b);this.hd.Z(Vc.a.jmb,this.zEn);this.hd.Z(Vc.a.d1c,jm.cMd);this.hd.Z(Vc.a.d$d,jm.cMd);this.hd.Z(Vc.a.e$d,jm.cMd);this.hd.Z(Vc.a.f$d,jm.cMd);this.hd.Z(Vc.a.zQc,this.bUd);this.hd.Z(Vc.a.wQc,this.bUd);this.hd.Z(Vc.a.xQc,this.bUd);this.hd.Z(Vc.a.yQc,this.bUd);this.hd.Z(qa.a.lna,this.Pki);this.hd.Z(qa.a.hBb,this.Pki);this.hd.Z(Vc.a.hmb,jm.hmb);this.hd.Z(Vc.a.Pge,
WB.a.z_a);this.hd.Z(qa.a.q_f,this.j_i);this.hd.Z(qa.a.r_f,this.j_i)}clearCache(){super.clearCache();this.zAe=!1;this.Sah=new CG.a;this.iih=new KF;this.teh=new DG.a}Mmf(){const b=super.Mmf();b.LBa=jm.LBa;b.xYa=jm.xYa;return b}static get Mrn(){return null!=jm.yBg?jm.yBg:jm.yBg=Sa.a.instance.Ma("WordEditor.IPageCommandStringBuilder")}static get kz(){jm.Csa||(jm.Csa=Sa.a.instance.Ma("WordEditor.ITableBorderManager"));return jm.Csa}static wRa(b,h){b=new xx.a;b.qd=h;return b}static B5c(b,h,t){h[Ng.a.Description]=
b?b.Y3m(t):null}static LBa(b,h){const t=Object(Da.a)(CG.a,b.qd),A=Object(Da.a)(rM.a,b.qd),O=Object(Da.a)(KF,b.qd),aa=Object(Da.a)(DG.a,b.qd);let ua=!0;const Ra=jm.Mrn;switch(b.ulb){default:ua=JF.a.LBa(b,h);break;case qa.a.n$d:h[Cb.a.Icon]=t.bwa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[Ng.a.On]=!t.uIb;jm.B5c(Ra,h,0);break;case qa.a.m$d:h[Cb.a.Icon]=t.bwa?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[Ng.a.On]=1===t.uIb;jm.B5c(Ra,h,1);break;case qa.a.l$d:h[Cb.a.Icon]=
t.bwa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[Ng.a.On]=2===t.uIb;jm.B5c(Ra,h,2);break;case qa.a.p$d:h[Cb.a.Icon]=t.bwa?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[Ng.a.On]=3===t.uIb;jm.B5c(Ra,h,3);break;case qa.a.o$d:h[Cb.a.Icon]=t.bwa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[Ng.a.On]=4===t.uIb;jm.B5c(Ra,h,4);break;case qa.a.k$d:h[Cb.a.Icon]=t.bwa?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[Ng.a.On]=
5===t.uIb;break;case qa.a.w$d:h[Ng.a.On]=!t.XJb;h[Ng.a.Description]=Ra?Ra.k_c(0):null;break;case qa.a.v$d:h[Ng.a.On]=1===t.XJb;h[Ng.a.Description]=Ra?Ra.k_c(1):null;break;case qa.a.u$d:h[Ng.a.On]=2===t.XJb;h[Ng.a.Description]=Ra?Ra.k_c(2):null;break;case qa.a.r$d:h[Ng.a.On]=3===t.XJb;h[Ng.a.Description]=Ra?Ra.k_c(3):null;break;case qa.a.s$d:h[Ng.a.On]=4===t.XJb;h[Ng.a.Description]=Ra?Ra.k_c(4):null;break;case qa.a.t$d:h[Ng.a.On]=5===t.XJb;break;case qa.a.$Zf:h[Ng.a.On]=!t.bwa;break;case qa.a.ZZf:h[Ng.a.On]=
t.bwa;break;case qa.a.rZf:h[Ng.a.On]=1===t.IFc;break;case qa.a.tZf:h[Ng.a.On]=2===t.IFc;break;case qa.a.sZf:h[Ng.a.On]=3===t.IFc;break;case qa.a.qZf:h[Ng.a.On]=0===t.IFc;break;case qa.a.l_f:h[Ng.a.On]=A.it?!A.it.specialIndentType:!1;break;case qa.a.j_f:h[Ng.a.On]=A.it?1===A.it.specialIndentType:!1;h[Ck.a.Image16by16Class]=A.isRtl?dh.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):dh.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case qa.a.k_f:h[Ng.a.On]=A.it?2===A.it.specialIndentType:
!1;h[Ck.a.Image16by16Class]=A.isRtl?dh.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):dh.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case Vc.a.X$d:h[Ng.a.On]=1===O.M7a;break;case Vc.a.Y$d:h[Ng.a.On]=8===O.M7a;break;case Vc.a.Z$d:h[Ng.a.On]=9===O.M7a;break;case Vc.a.V$d:h[Ng.a.On]=3===O.M7a;break;case Vc.a.W$d:h[Ng.a.On]=4===O.M7a;break;case Vc.a.jmb:h[Ng.a.On]=b.qd.ia(Gd.a.Yva,!1);break;case Vc.a.hmb:h[Hk.a.IsFreeForm]=!0;h[Hk.a.Value]=b.qd[Vj.a.Value];break;case qa.a.q_f:h[Cl.a.On]=
jm.kz.R0h(h.MenuItemId)===aa.lineStyle;break;case qa.a.r_f:h[Cl.a.On]=jm.kz.S0h(h.MenuItemId)===aa.dWc}return ua}static a4m(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new xx.a;h.qd=b;return h}static ksn(b,h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=
2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new xx.a;h.qd=b;return h}static uUk(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}h=new xx.a;h.qd=b;return h}static hmb(){const b=new xx.a;b.IL=Vc.a.hmb;b.qd={};b.Bga=!0;b.eac=!0;return b}static kmc(b,h){const t=new xx.a;t.qd=new ji.DictionaryPropertySet;let A=1;switch(b){case Vc.a.Gne:A=1;break;case Vc.a.Hne:A=8;break;case Vc.a.Ine:A=9;break;case Vc.a.Ene:A=
3;break;case Vc.a.Fne:A=4}t.qd.setValue(Gd.a.M7a,A);t.qd.setValue(Gd.a.sHa,h[Ng.a.SourceControlId]);return t}static A5b(b,h,t){b=new xx.a;b.qd=t.InvocationMethod;return b}static RCn(b,h){b=new xx.a;b.qd=h;return b}static w2c(){const b=new sM.a;b.IL=Vc.a.Gfc;return b}static cMd(){const b=new xx.a;b.qd=new ji.DictionaryPropertySet;b.VTc=!0;return b}static xYa(b,h){let t=!0;switch(b.ulb){case Vc.a.d1c:b=b.qd.ia(Gd.a.Uhb,0);h[Ue.a.Number]=b;h[Ue.a.UnitType]=7;break;case Vc.a.d$d:b=b.qd.ia(Gd.a.Rhb,0);
h[Ue.a.Number]=b;h[Ue.a.UnitType]=7;break;case Vc.a.e$d:b=b.qd.ia(Gd.a.Shb,0);h[Ue.a.Number]=b;h[Ue.a.UnitType]=7;break;case Vc.a.f$d:b=b.qd.ia(Gd.a.Thb,0);h[Ue.a.Number]=b;h[Ue.a.UnitType]=7;break;default:t=JF.a.xYa(b,h)}return t}}jm.Csa=null;Object(m.a)(jm,"CuiActionBridge",JF.a,[]);class EG extends Pf.a{constructor(b){super();this.PUk=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.ojo=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.kHd=this.mwb=this.D5=this.gWa=this.PPe=null;this.Vb=
b;this.Wg="<div id='AccessibilityHelpDialogBody'></div>";this.sg="AAccessibilityHelpDialog";this.zd=6;this.Ge(0,CommonUIStrings.l_DialogClose)}get acf(){return null}get Sfe(){this.PPe||(this.PPe=this.Gqm());return this.PPe}get dzo(){return 300}get DIi(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get CIi(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get LZa(){return this.Vb.Hs()}sSa(b){super.sSa(b);this.hxn()}FSa(){this.showDialog(this.dialogTitle,Object(z.a)(this,this.zik,
"accHelpDialogResultHandler"));this.AGa();this.setFocus()}setFocus(){this.D5?(this.mwb=this.D5.tBodies[0].firstChild,this.l0(this.mwb)):this.GG&&"none"!==this.GG.style.display?this.l0(this.GG):this.l0(this.rz)}hla(){this.$d.mb(db.a.fi,this.kHd,Object(z.a)(this,this.Cih,"accHelpDialogKeydownHandler"));if(this.D5){this.$d.mb(db.a.sh,this.D5,Object(z.a)(this,this.srj,"tableOnKeyUpHandler"));const b=this.D5.tBodies[0].children;for(let h=0;h<b.length;h++)if(Hf.a.addHandler(b[h],db.a.focus,Object(z.a)(this,
this.s$i,"rowOnFocusHandler")),Hf.a.addHandler(b[h],db.a.blur,Object(z.a)(this,this.r$i,"rowOnBlurHandler")),ba.a.jt){const t=b[h].children;for(let A=0;A<t.length;A++)Hf.a.addHandler(t[A],db.a.focus,Object(z.a)(this,this.pyh,"cellOnFocusHandler"))}}super.hla()}Oeb(){this.$d&&(this.$d.sc(db.a.fi,this.kHd,Object(z.a)(this,this.Cih,"accHelpDialogKeydownHandler")),this.D5&&this.$d.sc(db.a.sh,this.D5,Object(z.a)(this,this.srj,"tableOnKeyUpHandler")));if(this.D5){const b=this.D5.tBodies[0].children;for(let h=
0;h<b.length;h++)if(Hf.a.removeHandler(b[h],db.a.focus,Object(z.a)(this,this.s$i,"rowOnFocusHandler")),Hf.a.removeHandler(b[h],db.a.blur,Object(z.a)(this,this.r$i,"rowOnBlurHandler")),ba.a.jt){const t=b[h].children;for(let A=0;A<t.length;A++)Hf.a.removeHandler(t[A],db.a.focus,Object(z.a)(this,this.pyh,"cellOnFocusHandler"))}}super.Oeb()}AGa(){this.LZa.scope.Xq(this.Vb.dW);this.LZa.scope.Xq(this.Vb.eW);this.LZa.scope.bindAction(this.Vb.dW,ab.a.eCc);this.LZa.scope.bindAction(this.Vb.eW,ab.a.dCc)}Kgm(b){if(!this.LZa.Xj||
!this.LZa.Xj.R2)return 2;var h=this.LZa.Xj.R2;if(this.D5&&(h===this.rz&&b===ab.a.eCc||h===this.gWa&&b===ab.a.dCc))this.l0(this.mwb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===ab.a.eCc?h=this.gWa:b===ab.a.dCc&&(h=this.rz),h&&this.l0(h);else if(b===ab.a.eCc)this.LZa.Icc();else if(b===ab.a.dCc)this.LZa.Gcc();else return 2;return 32}s$i(b){b.target.setAttribute(Mf.a.$cb,Mf.a.gp);Sys.UI.DomElement.removeCssClass(this.mwb,"inactiveRowSelection");this.mwb=b.target}r$i(b){b.target.removeAttribute(Mf.a.$cb);
Sys.UI.DomElement.addCssClass(b.target,"inactiveRowSelection")}pyh(b){(b=b.target.parentNode)&&b!==this.mwb&&this.l0(b)}srj(b){return b.Ib.keyCode===rc.a.ks?(b.Ib.stopPropagation(),!0):!1}Cih(b){if(!b.Ib)return!1;const h=b.Ib.keyCode;if(b.eventName===db.a.fi){b=this.KSl(this.mwb);let t=-1;const A=ob.a.count(this.Sfe)-1;h===Sys.UI.Key.down?t=b<A?b+1:0:h===Sys.UI.Key.up?t=0<b?b-1:A:h===Sys.UI.Key.home?t=0:h===Sys.UI.Key.end&&(t=A);-1!==t&&this.l0(this.D5.tBodies[0].children[t])}return!0}zik(){}hxn(){this.kHd=
document.getElementById("AccessibilityHelpDialogBody")||this.Np;this.T7k();this.z7k();this.p5k()}T7k(){if(this.acf){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.acf;b.appendChild(h);this.uja.appendChild(b)}}z7k(){if(this.Sfe&&!ob.a.isEmpty(this.Sfe)){this.D5=document.createElement("table");this.D5.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(Mf.a.oh,
Mf.a.ADc);b.appendChild(h);var t=vc.a.UGc(14,this.PUk);h.appendChild(t);t=vc.a.UGc(14,this.ojo);h.appendChild(t);this.D5.appendChild(b);b=document.createElement("tbody");h=0;t=this.Sfe;for(let aa in t){var A=aa,O=t[aa];const ua=document.createElement("tr");ua.tabIndex=0;ua.setAttribute(Mf.a.oh,Mf.a.ADc);ua.id="SelectableTableRow"+h++;A=vc.a.UGc(15,A);ua.appendChild(A);O=vc.a.UGc(15,O);ua.appendChild(O);b.appendChild(ua)}b.style.maxHeight=this.dzo+"px";this.D5.appendChild(b);this.kHd.appendChild(this.D5)}}p5k(){if(this.CIi&&
this.DIi){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.gWa=document.createElement("a");this.gWa.innerText=this.CIi;this.gWa.href=this.DIi;this.gWa.target="_blank";this.gWa.id=this.kj("AccessibilityHelpDialogLink");this.gWa.className=vf.AFrame.pZe;b.appendChild(this.gWa);this.Kc.insertBefore(b,this.Kc.lastChild)}}KSl(b){return Number.parseInvariant(b.id.substr(18))}rZ(b,h,t,A=null){b&&h&&t&&(t=A?String.format(t,A):t,b[h]=t)}Fci(b,h){return ba.a.Yk?h:b}}Object(m.a)(EG,
"AAccessibilityHelpDialog",Pf.a,[970]);class CD extends EG{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get acf(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}Gqm(){var b;const h=this.Fci(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),t=this.Fci(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),A={};this.rZ(A,CommonUIStrings.l_AccHelpDialogAccHelpCommand,
CommonUIStrings.l_AccHelpDialogAccHelpShortcut);this.rZ(A,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,h);this.rZ(A,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.rZ(A,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,t);this.rZ(A,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,h);this.rZ(A,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,h);this.rZ(A,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,h);this.rZ(A,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);this.rZ(A,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,h);this.rZ(A,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,h);this.rZ(A,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,h);this.rZ(A,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,
h);this.rZ(A,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,h);this.rZ(A,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,h);(null===(b=vm.App.instance)||void 0===b?0:b.Oib)&&this.rZ(A,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,
h);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.rZ(A,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&this.rZ(A,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(CD.Xb&&CD.Xb.isFeatureEnabled(61)||v.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled"))&&
this.rZ(A,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return A}static get Xb(){return null!=CD.wvg?CD.wvg:CD.wvg=Sa.a.instance.Ma("Box4.IFeatureHelper")}}Object(m.a)(CD,"AccessibilityHelpDialog",EG,[]);var dI=c(312);class LF{static get Wg(){return Pf.a.Xz(LF.Hm,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}LF.Hm="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(m.a)(LF,"ApplyStylesDialogHtml",null,[]);class fE extends Pf.a{constructor(b,h){super();this.UG=null;this.BAc=!1;this.zxb=this.v8a=this.Vwc=this.Ywc=this.QAc=null;this.Iyk=(t,A)=>{if(this.mh.Qt){if(t){t=A.styleList;A=A.styleText;if(-1===t||F.a.fh(A)!==F.a.fh(this.UG[t]))t=this.Xci(A);A=this.UG[t];t=this.uc.Cr();A=this.uc.jg(t.cEa(A));v.AFrameworkApplication.xa.Nf(this._context,qa.a.applyStyle,2,!1,new dI.a,A)}this.mh.K4()}};this.$nn=t=>{this.BAc?(this.BAc=!1,this.validate()):"value"===t.rawEvent.propertyName&&
(this.BAc=!0,this.lZ.value!==this.QAc&&(this.QAc=this.lZ.value,this.psh()))};this.Bjn=()=>{-1!==this.Dka.selectedIndex&&(ba.a.B3&&(this.BAc=!0),this.QAc=this.UG[this.Dka.selectedIndex],this.lZ.value=this.UG[this.Dka.selectedIndex],this.validate())};this.onKeyDown=t=>{ba.a.vJ?t.keyCode!==rc.a.JB&&t.keyCode!==rc.a.P0||this.v8a||this.zxb||(this.zxb=new Vb.a(0,1,1,this.MUo),v.AFrameworkApplication.oc.Wb(this.zxb)):ba.a.B3&&t.keyCode===rc.a.JB&&(this.BAc=!0)};this.lG=()=>{this.v8a||(this.v8a=new Vb.a(0,
1,1,this.mBk),v.AFrameworkApplication.oc.Wb(this.v8a));this.zxb&&(v.AFrameworkApplication.oc.Se(this.zxb),this.zxb=null)};this.mBk=()=>{this.v8a=null;this.psh()};this.MUo=()=>{this.zxb=null;this.validate()};this._context=b;this.jd=h;this.sg="ApplyStylesDialog";this.mh=this._context.view;this.Trf();b=this.Pwo();h="";this.UG.length>b&&(h=this.UG[b]);h={["styleText"]:h,["styleList"]:b};this.Wg=LF.Wg;this.Yh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.Iyk,h);this.Dka=document.getElementById("styleList");
this.aXf();this.Dka.selectedIndex=b;this.lZ=document.getElementById("styleText");this.lZ.focus();this.lZ.select();this.Iod=this.Bjn;Hf.a.addHandler(this.Dka,"change",this.Iod);this.Hod=this.onKeyDown;Hf.a.addHandler(this.lZ,"keydown",this.Hod);ba.a.B3?(this.Ywc=this.$nn,Hf.a.addHandler(this.lZ,"propertychange",this.Ywc),this.QAc=this.UG[b]):(this.Vwc=this.lG,Hf.a.addHandler(this.lZ,"keypress",this.Vwc))}get uc(){return null!=this.gGg?this.gGg:this.gGg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}Pwo(){var b=
this.mh.nb;if(!b||!b.hb)return Jc.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.hb.lb;if(!b)return Jc.b(579216409,3018,15,"CurrentSelection is null"),0;qe.ParagraphReader.im(b.Qa)&&(b=nf.SelectionEditor.Bj(b,!0,!1));b=b.Qa;if(!b||!nf.SelectionEditor.Xu(b))return Jc.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var h=Wa.FormattingReader.Ar(b);(h=Wa.FormattingReader.bna(h))||(h=this.uc.Uo(b.node));if(!h)return 0;b=this.uc.CK(h);b=Array.indexOf(this.UG,
b);0>b&&(b=0);return b}aXf(){const b=this.UG.length;for(let h=0;h<b;h++){const t=document.createElement("OPTION");t.value=h.toString();t.text=this.UG[h];this.Dka.add(t,null)}}Trf(){var b=ck.a.Nt();if(b){b=(new Rv.WACStyleSet).tQ(b);var h=b.VP,t=this.jd.isFeatureEnabled(110)&&!!this.uc.qg;this.UG=[];for(let A=0;A<h;A++){const O=b.EOa(A);if(this.uc.isHidden(O))continue;const aa=this.uc.vD(O);if(!t){if(3===aa)continue}else if(3===aa&&this.uc.jg(O)===Aw.a.jmg)continue;Array.add(this.UG,this.uc.CK(O))}this.UG.sort(fE.wWk)}else Jc.b(577644352,
3018,15,"Couldn't find PageContentNode")}dispose(){this.Ywc&&Hf.a.removeHandler(this.lZ,"propertychange",this.Ywc);this.Hod&&Hf.a.removeHandler(this.lZ,"keydown",this.Hod);this.Iod&&Hf.a.removeHandler(this.Dka,"change",this.Iod);this.Vwc&&Hf.a.removeHandler(this.lZ,"keypress",this.Vwc);this.v8a&&v.AFrameworkApplication.oc.Se(this.v8a);this.v8a=this.Vwc=this.Dka=this.lZ=this.Hod=this.Ywc=this.Iod=null;super.dispose()}psh(){var b=this.lZ.value,h=this.xom(b);const t=-1===h?b:this.UG[h];b=b.length;const A=
t.length;this.QAc=t;this.lZ.value=t;this.Dka.selectedIndex=h;A>b&&(ba.a.vJ?this.lZ.setSelectionRange(b,A):ba.a.B3&&(h=this.lZ.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",A-b),h.select()));this.validate();this.lZ.focus()}xom(b){let h=0,t=this.UG.length,A=-1;for(b=F.a.fh(b);h<t;){const O=Math.floor((h+t)/2),aa=fE.K6e(b,this.UG[O]);if(!aa){A=O;break}0<aa?h=O+1:t=O}if(A>h)for(;!fE.K6e(b,this.UG[A-1])&&(A--,A!==h););return A}validate(){const b=-1===this.Xci(this.lZ.value),
h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}Xci(b){b=F.a.fh(b);const h=this.UG.length;for(let t=0;t<h;t++)if(b===F.a.fh(this.UG[t]))return t;return-1}static K6e(b,h){const t=Math.min(b.length,h.length);b=F.a.fh(b);h=F.a.fh(h);for(let A=0;A<t;A++){const O=F.a.charCodeAt(b,A),aa=F.a.charCodeAt(h,A);if(O!==aa)return O-aa}return b.length<=h.length?0:1}static wWk(b,
h){return fE.K6e(b,h)}}Object(m.a)(fE,"ApplyStylesDialog",Pf.a,[]);var gE=c(346);class eI extends cf.StandardDialog{constructor(b){super();this.ov=b;this.qoo()}qoo(){this.zd=1;this.MU(1);this.Ge(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.Au(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.ybf.bind(this))}ybf(b){1===b&&this.ov.kia("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.Ai?Jc.b(524834400,
3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.exception,h.exception.stack):(this.u_n(),Jc.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}u_n(){gE.a.spb="{}"}}Object(m.a)(eI,"DeleteSavedStylesConfirmationDialog",cf.StandardDialog,[]);class fI extends cf.StandardDialog{constructor(b,h){super();this.ybf=O=>{if(1===O){O=new Map;O.set("Source","DeleteStyleConfirmationDialog");O.set("Action","DeleteStyle");wa.Health.instance.recordKpiUsage(Qo.a.Tya,0,Qo.a.dB,O);var aa=
ck.a.Nt();O=new Te.GraphTransaction(15);O.Eb(aa);O.kk=qa.a.YAb;this.EG.ecl(this.Odh)?Jc.b(578359694,3018,50,"User deleted a style via UI."):(aa=new Map,aa.set("Source","DeleteStyleConfirmationDialog"),aa.set("Action","DeleteStyle"),aa=Object.assign(new Hb.a,{extendedProperties:aa}),wa.Health.instance.recordKpiFailure(Qo.a.Tya,"DeleteStyleFailed",!1,!0,aa),Jc.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));O.dispose()}};h||Jc.b(590128417,3018,10,"styleId is null");
let t=null,A=null;if(this.mh=b.view)A=this.mh.nb;A&&(t=A.hb.lb.Qa);t?(b=t.node)?(this.ZJ=this.eh.Ms(b))?(this.Odh=new Mb.a,this.Odh.add(h),this.roo(h)):Jc.b(590128448,3018,10,"_pageContenNode is null."):Jc.b(590128419,3018,10,"node is null."):Jc.b(590128418,3018,10,"nodeContext is null.")}get EG(){return null!=this.WFg?this.WFg:this.WFg=Sa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get uc(){return null!=this.oGg?this.oGg:this.oGg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get eh(){return null!=
this.MBg?this.MBg:this.MBg=fm.PageNavigator.instance}roo(b){const h=(new Rv.WACStyleSet).tQ(this.ZJ);h?((b=h.Ni(b))||Jc.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.uc.CK(b),this.zd=4,this.MU(2),this.Au(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.ybf)):Jc.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(m.a)(fI,"DeleteStyleConfirmationDialog",cf.StandardDialog,
[]);class MF{static get Wg(){return Pf.a.Xz(MF.Hm)}}MF.Hm="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(m.a)(MF,"DeleteStyleDialogHtml",null,[]);class gI extends Pf.a{constructor(b){super();this.ZJ=this.UG=null;this.Ocl=(h,t)=>{this.mh.Qt&&(h?(h=t.styleList,-1!==h&&(h=this.UG[h],t=this.uc.Cr(),h=this.uc.jg(t.cEa(h)),this.mIc.Ncl(this._context,h),this.mh.K4())):this.mh.K4())};this._context=b;this.sg="DeleteStyleDialog";this.zd=
1;this.Ge(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.mh=this._context.view;this.Trf();this.Wg=MF.Wg;this.Yh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.Ocl,{["styleList"]:0});this.Dka=document.getElementById("styleList");this.aXf();this.Dka.selectedIndex=0;this.Dka.focus()}get uc(){return null!=this.iGg?this.iGg:this.iGg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get mIc(){return null!=this.pug?this.pug:this.pug=Sa.a.instance.resolve("WordEditor.UI.IDialogFactory")}aXf(){const b=
this.UG.length;for(let h=0;h<b;h++){const t=document.createElement("OPTION");t.value=h.toString();t.text=this.UG[h];this.Dka.add(t,null)}}Trf(){if(this.ZJ=ck.a.Nt()){var b=(new Rv.WACStyleSet).tQ(this.ZJ),h=b.VP;this.UG=[];for(let A=0;A<h;A++){const O=b.EOa(A);if(!this.uc.isHidden(O)&&this.uc.ke(O,b)){var t=this.uc.vD(O);if(2===t||1===t)O.hasProperty(Lc.a.linkedStyle)&&2!==t||(t=O.ia(Lc.a.PL,null))&&0<t.length||this.UG.push(this.uc.CK(O))}}this.UG.sort()}else Jc.b(578650370,3018,15,"PageContentNode is null")}}
Object(m.a)(gI,"DeleteStyleDialog",Pf.a,[]);var tM=c(777);class hI{constructor(b){this.customData=null;this.$N=b}}Object(m.a)(hI,"PropertySetChangedState",null,[]);class iI{static iBn(b,h,t){if(b&&h){var A=new hI(h),O=(aa,ua,Ra)=>{t.hBn(aa,ua,Ra,A)};b=new tM.a(h,b);b.Byd=O;b.VBd=O;b.Gbe=O;b.jfc()}}}Object(m.a)(iI,"PropertySetChangedManager",null,[]);class jI{constructor(b){this.vLa=b}hBn(b,h,t,A){const O=this.vLa[b.id.toString()];O&&O(b,h,t,A)}}Object(m.a)(jI,"PropertyChangedProcessor",null,[]);const NF=
(b,h,t)=>{const A=hi.a.instance.l5b;if(A){const O=new Te.GraphTransaction(15);O.Eb(A);iI.iBn(b,h,new jI(t));O.dispose()}};class OF{static get Wg(){return Pf.a.Xz(OF.Hm,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}OF.Hm="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(m.a)(OF,"MarginsDialogHtml",null,[]);class Kr{static get c4(){return null!=Kr.zBg?Kr.zBg:Kr.zBg=Sa.a.instance.Ma("WordEditor.IPageCommands")}static X3m(b,h,t){Kr.c4&&null!==t&&Kr.c4.afe(0,t)}static T3m(b,h,t){Kr.c4&&null!==t&&Kr.c4.afe(3,t)}static V3m(b,h,t){Kr.c4&&null!==t&&Kr.c4.afe(1,t)}static W3m(b,h,t){Kr.c4&&null!==t&&Kr.c4.afe(2,t)}static vsn(b,h,t){Kr.c4&&null!==t&&Kr.c4.vSa(0,t)}static Wrn(b,h,t){Kr.c4&&null!==t&&Kr.c4.vSa(1,t)}static vUk(b,h,t){Kr.c4&&null!==t&&(b==zf.a.rE?Kr.c4.hee(0,
t):b==zf.a.JF?Kr.c4.hee(1,t):b==zf.a.zla?Kr.c4.hee(2,t):b==zf.a.separator&&Kr.c4.hee(3,t))}}Object(m.a)(Kr,"PageLevelPropertyChangedHandlers",null,[]);const kI=[Vc.a.LZc,Vc.a.KZc,Vc.a.Y6d,Vc.a.Z6d,Vc.a.j$d,Vc.a.g$d,Vc.a.h$d,Vc.a.i$d];class Iz extends Pf.a{constructor(b,h,t,A,O,aa){super();this.twa=aa;this.PLc=(ua,Ra)=>{var ub=Iz.O0c(ua);ua=Jb.App.Oga;this.zp.hasProperty(ub)?(ub=this.zp.getValue(ub),Ra[Ue.a.Number]=Ad.a.u7a(ub,ua)):Ra[Ue.a.Number]=0;Ra[Ue.a.UnitType]=ua};this.h5c=(ua,Ra)=>{this.zp.setValue(Iz.O0c(ua),
Ad.a.dIa(Ra[Ue.a.Number],Ra[Ue.a.UnitType]));this.hu.qm()};this.Z3m=ua=>{let Ra=!1;1===ua&&(Math.abs(this.zp.getValue(Lc.a.marginTop))+Math.abs(this.zp.getValue(Lc.a.marginBottom))+Jb.App.Sya<=this.Osa.getValue(Lc.a.Zv)&&this.zp.getValue(Lc.a.marginLeft)+this.zp.getValue(Lc.a.marginRight)+Jb.App.Sya<=this.Osa.getValue(Lc.a.xo)?NF(this.eAa,this.zp,Iz.j7b()):Ra=!0);this.dispose();Ra&&this.aHa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.U3m)};this.U3m=()=>{Sa.a.instance.resolve("WordEditor.UI.IDialogFactory").dIh(this.eAa,
this.Osa,this.W5)};this.sg="MarginsDialog";this.Osa=h.clone();this.eAa=b.clone();this.zp=b.clone();this.W5=t;this.xV=!1;this.hu=O;this.Wg=OF.Wg;t&&(this.Upc=hs.a.dPb);this.Yh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.Z3m,null);this.dRc();this.twa&&(this.fRe=document.getElementById("DialogMarginTopSpinner"),this.l0(this.fRe))}E8(){this.QAd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Vc.a.LZc,Vc.a.j$d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.QAd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Vc.a.KZc,Vc.a.g$d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.QAd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Vc.a.Y6d,Vc.a.h$d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.QAd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Vc.a.Z6d,Vc.a.i$d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}dRc(){for(const b of kI)Object(im.a)(b,this.h5c,this.PLc);this.hu.$oa("DialogMarginTopSpinner");
this.hu.$oa("DialogMarginBottomSpinner");this.hu.$oa("DialogMarginLeftSpinner");this.hu.$oa("DialogMarginRightSpinner")}dispose(){for(const b of kI)Object(im.b)(b);this.hu.kY("DialogMarginTopSpinner");this.hu.kY("DialogMarginBottomSpinner");this.hu.kY("DialogMarginLeftSpinner");this.hu.kY("DialogMarginRightSpinner");super.dispose()}QAd(b,h,t,A,O){t=Iz.MGk(h,t,A,O);this.Dyb(t,b,h)}Dyb(b,h,t){h=document.getElementById(h);this.hu.fYa(t,b);b=this.hu.ZCb(t,"Medium");h.appendChild(b)}static j7b(){return Iz.vLa||
(Iz.vLa=Iz.R2b())}static R2b(){const b={};b[Lc.a.marginTop.id.toString()]=Kr.X3m;b[Lc.a.marginBottom.id.toString()]=Kr.T3m;b[Lc.a.marginLeft.id.toString()]=Kr.V3m;b[Lc.a.marginRight.id.toString()]=Kr.W3m;return b}static MGk(b,h,t,A){let O=!0;if(h===Vc.a.LZc||h===Vc.a.KZc)O=!1;return Sk.j(b,h,t,A,[Iz.OGk(O),Iz.NGk(O)])}static OGk(b){return Sk.l("inch",b?"0":"-22","22",".1")}static NGk(b){return Sk.l("centimeter",b?"0":"-55.8","55.8","1")}static O0c(b){let h=null;switch(b){case Vc.a.LZc:case Vc.a.j$d:h=
Lc.a.marginTop;break;case Vc.a.KZc:case Vc.a.g$d:h=Lc.a.marginBottom;break;case Vc.a.Y6d:case Vc.a.h$d:h=Lc.a.marginLeft;break;case Vc.a.Z6d:case Vc.a.i$d:h=Lc.a.marginRight}return h}}Iz.vLa=null;Object(m.a)(Iz,"MarginsDialog",Pf.a,[]);class PF{static get Wg(){return Pf.a.Xz(PF.Hm,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}PF.Hm="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(PF,"PaperSizeDialogHtml",null,[]);const lI=[Vc.a.b7d,Vc.a.a7d,Vc.a.y$d,Vc.a.x$d];class fu extends Pf.a{constructor(b,h,t,A,O,aa){super();this.twa=aa;this.PLc=(ua,Ra)=>{var ub=this.O0c(ua);ua=Jb.App.Oga;this.zp.hasProperty(ub)?(ub=this.zp.getValue(ub),Ra[Ue.a.Number]=Ad.a.u7a(ub,ua)):Ra[Ue.a.Number]=0;Ra[Ue.a.UnitType]=ua};this.h5c=(ua,Ra)=>{this.zp.setValue(this.O0c(ua),Ad.a.dIa(Ra[Ue.a.Number],Ra[Ue.a.UnitType]));this.hu.qm()};this.Hsn=ua=>{let Ra=!1;1===ua&&(this.zp.getValue(Lc.a.Zv)>=
Jb.App.Sya+this.Osa.getValue(Lc.a.marginTop)+this.Osa.getValue(Lc.a.marginBottom)&&this.zp.getValue(Lc.a.xo)>=Jb.App.Sya+this.Osa.getValue(Lc.a.marginLeft)+this.Osa.getValue(Lc.a.marginRight)?NF(this.eAa,this.zp,fu.j7b()):Ra=!0);this.dispose();Ra&&this.aHa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.Gsn)};this.Gsn=()=>{Sa.a.instance.resolve("WordEditor.UI.IDialogFactory").IIh(this.eAa,this.Osa,this.W5)};this.sg="PaperSizeDialog";this.Osa=h.clone();this.eAa=b.clone();this.zp=b.clone();
this.W5=t;this.xV=!1;this.hu=O;this.Wg=PF.Wg;t&&(this.Upc=hs.a.dPb);this.Yh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.Hsn,null);this.dRc();this.twa&&(this.fRe=document.getElementById("DialogWidthSpinner"),this.l0(this.fRe))}E8(){this.Wuh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Vc.a.b7d,Vc.a.y$d,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.Wuh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Vc.a.a7d,Vc.a.x$d,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}dRc(){for(const b of lI)Object(im.a)(b,
this.h5c,this.PLc);this.hu.$oa("DialogWidthSpinner");this.hu.$oa("DialogHeightSpinner")}dispose(){for(const b of lI)Object(im.b)(b);this.hu.kY("DialogWidthSpinner");this.hu.kY("DialogHeightSpinner");super.dispose()}Wuh(b,h,t,A,O){t=fu.cHk(h,t,A,O);this.Dyb(t,b,h)}Dyb(b,h,t){h=document.getElementById(h);this.hu.fYa(t,b);b=this.hu.ZCb(t,"Medium");h.appendChild(b)}O0c(b){let h=null;switch(b){case Vc.a.a7d:case Vc.a.x$d:h=Lc.a.Zv;break;case Vc.a.b7d:case Vc.a.y$d:h=Lc.a.xo}return h}static j7b(){return fu.vLa||
(fu.vLa=fu.R2b())}static R2b(){const b={};b[Lc.a.xo.id.toString()]=Kr.vsn;b[Lc.a.Zv.id.toString()]=Kr.Wrn;return b}static cHk(b,h,t,A){return Sk.j(b,h,t,A,[fu.eHk(),fu.dHk()])}static eHk(){return Sk.l("inch",fu.snj,fu.fPm,fu.cso)}static dHk(){return Sk.l("centimeter",fu.snj,fu.ePm,fu.bso)}}fu.snj="0";fu.fPm="22";fu.cso=".1";fu.bso="1";fu.ePm="55.8";fu.vLa=null;Object(m.a)(fu,"PaperSizeDialog",Pf.a,[]);const uM=RegExp("[{|}|;|\\\\]"),mI=b=>{if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,
t=b.VP;let A;for(A=1;A<=t;A++){const O=h+A;if(!(b.Ni(O)||b.rOc(O)||b.Ni(O+"Char")||b.rOc(O+"Char")))break}return h+A};class nI extends Pf.a{constructor(b,h,t,A,O){var aa,ua,Ra,ub;super(!1,!1,!0);this.context=b;this.rc=h;this.D7=t;this.uc=A;this.eh=O;this.sJd=null;this.x0i=(Nb,Yb)=>{if(this.je.Qt){if(0!==Nb){Nb="string"===typeof Yb.styleText?Yb.styleText:null;Yb=this.CR;var bc=Nb;const Dc=F.a.FGa(bc);let Pc=null;if(0===Dc.length)Pc=WordEditorIntl.WordEditorStrings.l_StyleNameEmpty;else if(253<bc.length)Pc=
WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength;else if(uM.test(bc))Pc=WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters;else if(Yb.cEa(bc)||Yb.rOc(Dc))Pc=WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;(Yb=Pc)?(this.sJd=Yb,Yb=mI(this.CR),Nb=this.XCb(Nb,Yb),this.sJd=null,this.xV=!1,this.hide(),this.Yh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.x0i,Nb),this.xV=!0):(this.hide(),Yb=new Map,Yb.set("Source","ReactCreateNewStyleDialog"),Yb.set("Action","CreateStyle"),
wa.Health.instance.recordKpiUsage(Qo.a.Tya,0,Qo.a.dB,Yb),this.Vxd(Nb)||(Nb=new Map,Nb.set("Source","ReactCreateNewStyleDialog"),Nb.set("Action","CreateStyle"),Nb=Object.assign(new Hb.a,{extendedProperties:Nb}),wa.Health.instance.recordKpiFailure(Qo.a.Tya,"CreateStyleFailed",!1,!0,Nb)))}else this.hide();this.je.K4()}};this.sg="CreateNewStyleDialog";this.je=b.view;(b=null===(ub=null===(Ra=null===(ua=null===(aa=this.je)||void 0===aa?void 0:aa.nb)||void 0===ua?void 0:ua.hb)||void 0===Ra?void 0:Ra.lb)||
void 0===ub?void 0:ub.Qa)?(aa=b.node)?(this.pageContentNode=this.eh.Ms(aa))?(this.CR=(new Rv.WACStyleSet).tQ(this.pageContentNode),(this.VIb=this.D7.nKd(b))?(aa=this.VIb.ia(Af.a.fontSize,22),16>aa?Jc.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=aa?Jc.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=aa?Jc.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Jc.b(593078047,3018,
50,"Font size more than 45pt in create new style dialog preview"),this.D2f(this.VIb),this.pageContentNode&&this.VIb&&(this.Z9=!1,aa=mI(this.CR),aa=this.XCb(aa,aa),this.Yh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.x0i,aa))):Jc.b(592737758,3018,10,"_newStyleProperties is null.")):Jc.b(592737757,3018,10,"_pageContenNode is null."):Jc.b(592725466,3018,10,"node is null."):Jc.b(556917206,3018,10,"nodeContext is null.")}D2f(b){b.Qg(fh.a.paragraphStyle,fh.a.Qv,...Qo.a.Saa())}XCb(b,h){const t=
52<=this.VIb.ia(Af.a.fontSize,Vm.a.XL),A=mw.a.Lmf(this.VIb,"97%",26,!1,!0,t);A["padding-left"]="5px";t||(A["line-height"]="40px");b={["styleNameLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,["styleName"]:b,["previewContainerText"]:h,["getPreviewStyle"]:()=>A};this.sJd&&(b.errorMessage=this.sJd);return{["id"]:this.sg,["bodyControls"]:b}}Vxd(b){const h=new Te.GraphTransaction(15);h.Eb(this.pageContentNode);
h.kk=qa.a.O2b;const t=ck.a.Vxd(b,ck.a.Aai(this.VIb),null,this.pageContentNode);t&&(Jc.b(593078046,3018,50,"User created linked style"),this.CR=(new Rv.WACStyleSet).tQ(this.pageContentNode),b=F.a.FGa(F.a.i_(b)),b=this.CR.rOc(b),this.rc.Nf(this.context,qa.a.applyStyle,2,!1,new dI.a,this.uc.jg(b)));h.dispose();return t}}Object(m.a)(nI,"ReactCreateNewStyleDialog",Pf.a,[]);class eD extends Pf.a{constructor(b,h=!1,t){super(!1,!1,h);let A=h=this.RJ=null;this.sg=eD.id;this.mh=b.view;this.hn=t;this.mh&&(A=
this.mh.nb);A&&A.hb&&A.hb.lb&&(h=A.hb.lb.Qa);h?(b=h.node)?(this.ZJ=eD.eh.Ms(b))||u.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):u.ULS.sendTraceTag(539762889,3029,10,"node is null"):u.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}xUo(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),t=this.$Dl();const A=""===F.a.FGa(b),O=b.length>eD.f5m;t=t.includes(b);h=h.test(b);b=b.startsWith("_");let aa=null;if(A||O||t||b||!h)aa=A?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:
O?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return aa}rym(b,h){return b?b===h:!1}static get eh(){return fm.PageNavigator.instance}$Dl(){const b=this.hn.jMd(!1),h=[];for(let t=0;t<b.count;t++){const A=b.J(t).ia(Lc.a.$s,"");h.push(A)}return h}}eD.id="BookmarkEditDialog";eD.f5m=40;Object(m.a)(eD,
"AEditBookmarkDialog",Pf.a,[]);class oI extends eD{constructor(b,h,t){super(b,!0,t);this.Zxe=null;this.mVa="wwaengidc";this.Huc="ReactCreateEditBookmarkNameDialog";this.x_g="EditBookmarkName";this.Sra="EditBookmarkNameDialog";this.Wre=h;this.hn=t;this.ZJ&&(this.Z9=!1,b=this.XCb(h.properties.ia(Lc.a.$s,null)),this.Yh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.z0i.bind(this),b))}z0i(b,h){if(this.mh.Qt){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var t;this.Wre.hasProperty(Lc.a.$s)?
t=this.Wre.getValue(Lc.a.$s):u.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.xUo(b);this.rym(b,t)?(u.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.Zxe=h,t=this.XCb(b),this.Zxe=null,this.xV=!1,this.hide(),this.Yh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.z0i.bind(this),t),this.xV=!0):(this.hide(),t=new Map,t.set("Source",this.Huc),t.set("Action",this.x_g),wa.Health.instance.recordKpiUsage(this.Sra,
0,this.mVa,t),this.mNk(b)||(t=new Map,t.set("Source",this.Huc),t.set("Action",this.x_g),t=Object.assign(new Hb.a,{extendedProperties:t}),wa.Health.instance.recordKpiFailure(this.Sra,"Unable to edit bookmark",!1,!0,t)))}else this.hide();this.mh.K4()}}mNk(b){b=F.a.FGa(F.a.i_(b));try{const h=this.hn.NLo(this.Wre,b);if(h)u.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");else return u.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),
h}catch(h){return u.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}XCb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.Zxe;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.sg,["bodyControls"]:h}}}Object(m.a)(oI,"ReactEditBookmarkNameDialog",eD,[]);const QF=(b,h,t)=>{const A=[];if(b.length!==h.length||t&&t.length!==h.length)return A;for(let O=0;O<b.length;O++){const aa={};aa.key=h[O];
aa.text=b[O];aa.type="AppComboBoxItem";t&&(aa.ariaLabel=t[O]);A[O]=aa}return A},XB=(b,h,t,A,O)=>({["unitType"]:b,["unitPlaceholder"]:F.a.x8d(h),["minValue"]:t,["maxValue"]:A,["step"]:O}),FG=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),pI=(b,h,t)=>{let A=!1;b.hasProperty(h)&&b.hasProperty(t)?(t=b.getValue(t),1===t?(b=Number.NaN,h=5,A=!0):(b=b.getValue(h),h=2===t?4:5)):(b=Number.NaN,
h=Jb.App.ZEa?4:5);return{Zic:b,X6a:h,F9b:A}};class qI{constructor(){this.Lnj=this.oUi=this.mUi=this.Msn=this.UUf=!1}}Object(m.a)(qI,"Box4PropertySetChangedState",null,[]);class Sm{static get X8b(){return null!=Sm.Exg?Sm.Exg:Sm.Exg=Sa.a.instance.Ma("Box4.IIndentationCommands")}static get Izi(){return null!=Sm.Yzg?Sm.Yzg:Sm.Yzg=Sa.a.instance.Ma("Box4.IJustificationCommands")}static get E4(){return null!=Sm.mDg?Sm.mDg:Sm.mDg=Sa.a.instance.Ma("Box4.ISpacingCommands")}static gOm(b,h,t){Sm.Izi&&t&&(null===
h||11!==t||10!==h&&9!==h)&&Sm.Izi.LD(t)}static rRm(b,h,t){Sm.E4&&t&&Sm.E4.KC(t)}static FZk(b,h,t){h!=t&&Sm.E4.Ghc(t)}static rOm(b,h,t){h!=t&&Sm.E4.A5c(t)}static YWo(b,h,t){h!=t&&Sm.E4.c6c(t)}static pOm(b,h,t){h!=t&&Sm.E4.z5c(t)}static tUi(b,h,t,A){Sm.E4&&void 0!==t&&null!==t&&(b=Sm.eMc(A),!b.UUf&&A.$N.hasProperty(Gd.a.uec)&&A.$N.hasProperty(Gd.a.vec)&&(h=A.$N.getValue(Gd.a.vec),A=A.$N.getValue(Gd.a.uec),b.UUf=!0,Sm.E4.vca(1,h,A)))}static sUi(b,h,t,A){Sm.E4&&void 0!==t&&null!==t&&(b=Sm.eMc(A),!b.Msn&&
A.$N.hasProperty(Gd.a.sec)&&A.$N.hasProperty(Gd.a.tec)&&(h=A.$N.getValue(Gd.a.tec),A=A.$N.getValue(Gd.a.sec),b.UUf=!0,Sm.E4.vca(0,h,A)))}static lUi(b,h,t,A){Sm.X8b&&void 0!==t&&null!==t&&(b=Sm.eMc(A),!b.mUi&&A.$N.hasProperty(Gd.a.hGa)&&A.$N.hasProperty(Gd.a.iGa)&&(h=A.$N.getValue(Gd.a.iGa),A=A.$N.getValue(Gd.a.hGa),b.mUi=!0,Sm.X8b.hgj(1,h,A)))}static nUi(b,h,t,A){Sm.X8b&&void 0!==t&&null!==t&&(b=Sm.eMc(A),!b.oUi&&A.$N.hasProperty(Gd.a.Glb)&&A.$N.hasProperty(Gd.a.Hlb)&&(h=A.$N.getValue(Gd.a.Hlb),A=
A.$N.getValue(Gd.a.Glb),b.oUi=!0,Sm.X8b.hgj(0,h,A)))}static rcg(b,h,t,A){Sm.X8b&&void 0!==t&&null!==t&&(b=Sm.eMc(A),!b.Lnj&&A.$N.hasProperty(Gd.a.KSa)&&A.$N.hasProperty(Gd.a.LSa)&&(h=0,A.$N.hasProperty(Gd.a.F4)&&(h=A.$N.getValue(Gd.a.F4)),t=A.$N.getValue(Gd.a.LSa),A=A.$N.getValue(Gd.a.KSa),b.Lnj=!0,Sm.X8b.rfe(h,t,A)))}static eMc(b){b.customData||(b.customData=new qI);return b.customData}}Object(m.a)(Sm,"ParagraphLevelPropertyChangedHandlers",null,[]);class fD{constructor(){this.vLa=null}m_l(b){const h=
{};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var t=XB("Point",5,0,1584,1),A=XB("Line",4,0,327,1),O=[t,A];A=FG();var aa=[Box4Intl.Box4Strings.L_SpinnerAuto];t=[""];({Zic:Ra,X6a:ua,F9b:ub}=pI(b,Gd.a.vec,Gd.a.uec));var ua={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,
["unitType"]:Ad.a.uZa(ua),["validUnits"]:O,["numberFormatInfo"]:A,["validReservedValues"]:aa};ub?ua.reservedValue=aa[0]:ua.value=isNaN(Ra)?"":Ra;h.beforeSpacingSpinButtonProps=ua;({Zic:Ra,X6a:ua,F9b:ub}=pI(b,Gd.a.tec,Gd.a.sec));O={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Ad.a.uZa(ua),["validUnits"]:O,["numberFormatInfo"]:A,["validReservedValues"]:aa};
ub?O.reservedValue=aa[0]:O.value=isNaN(Ra)?"":Ra;h.afterSpacingSpinButtonProps=O;if(aa=O=b.hasProperty(Gd.a.ua))aa=fD.sFa.zDb(b),aa=b.hasProperty(Gd.a.ua)&&b.hasProperty(Gd.a.a3a)&&2===b.getValue(Gd.a.a3a)?!Nf.a.Vva(aa,1)&&!Nf.a.Vva(aa,1.5)&&!Nf.a.Vva(aa,2):!1;if(O){var Ra=fD.sFa.zDb(b);O=0;var ub=!1;b.hasProperty(Gd.a.ua)&&b.hasProperty(Gd.a.a3a)||(ub=!0);ub||(2!==b.getValue(Gd.a.a3a)&&(ub=!0),O=Ra,1>O&&(ub=!0));ub?O="":(Ra="multiple",aa||(Nf.a.Vva(O,1)?Ra="1.00":Nf.a.Vva(O,1.5)?Ra="1.50":Nf.a.Vva(O,
2)&&(Ra="2.00")),O=Ra)}else O=null;Ra={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:QF([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50",
"2.00","multiple"]),["allowFreeForm"]:!1};O?Ra.selectedKey=O:Ra.defaultSelectedKey="";h.lineSpacingComboBoxProps=Ra;O=0;Ra=!1;b.hasProperty(Gd.a.ua)&&b.hasProperty(Gd.a.a3a)&&2===b.getValue(Gd.a.a3a)&&aa&&(O=fD.sFa.zDb(b),Ra=!0,1>O&&(O=Number.NaN));b=[XB("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,
["numberFormatInfo"]:A,["validReservedValues"]:t};Ra?b.value=O:b.reservedValue=t[0];h.atSpinButtonProps=b;return h}j7b(){return this.vLa||(this.vLa=this.R2b())}R2b(){const b={};b[Gd.a.ua.id.toString()]=Sm.rRm;b[Gd.a.tec.id.toString()]=Sm.sUi;b[Gd.a.sec.id.toString()]=Sm.sUi;b[Gd.a.vec.id.toString()]=Sm.tUi;b[Gd.a.uec.id.toString()]=Sm.tUi;return b}static get sFa(){return null!=fD.fAg?fD.fAg:fD.fAg=Sa.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(m.a)(fD,"ReactParagraphDialog",null,[]);const rI=
b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,GG=(b,h,t,A)=>{let O=Jb.App.Oga;b.hasProperty(h)&&b.hasProperty(t)&&!A?(h=b.getValue(h),b=b.getValue(t),h?2===b?O=2:h=Ad.a.u7a(h,O):Jb.App.ZEa&&(O=2)):(h=Number.NaN,Jb.App.ZEa&&(O=2));return{Zic:h,X6a:O}},vM=b=>{let h="0";b.hasProperty(Gd.a.F4)&&(b=b.getValue(Gd.a.F4),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},sI=(b,h)=>{if(h.hasProperty(Gd.a.F4)&&2===h.getValue(Gd.a.F4)&&h.hasProperty(Gd.a.LSa)&&h.hasProperty(Gd.a.KSa)&&
b.hasProperty(Gd.a.iGa)&&b.hasProperty(Gd.a.hGa)){var t=b.getValue(Gd.a.iGa),A=b.getValue(Gd.a.hGa);t=(new or.a(A,t)).wt;A=h.getValue(Gd.a.LSa);h=h.getValue(Gd.a.KSa);h=(new or.a(h,A)).wt;b.setValue(Gd.a.iGa,t+h);b.setValue(Gd.a.hGa,1)}},tI=b=>{const h=b.getValue(Gd.a.iGa);b=b.getValue(Gd.a.hGa);return(new or.a(b,h)).wt},uI=b=>{const h=b.getValue(Gd.a.Hlb);b=b.getValue(Gd.a.Glb);return(new or.a(b,h)).wt},vI=(b,h)=>h.hasProperty(Gd.a.iGa)&&h.hasProperty(Gd.a.hGa)&&h.hasProperty(Gd.a.Hlb)&&h.hasProperty(Gd.a.Glb)&&
b.hasProperty(Lc.a.marginLeft)&&b.hasProperty(Lc.a.marginRight)&&b.hasProperty(Lc.a.xo),wM=b=>b.hasProperty(Gd.a.v_c)?b.getValue(Gd.a.v_c):!1,xM=b=>b.hasProperty(zf.a.keepWithNext)?b.getValue(zf.a.keepWithNext):!1,yM=b=>b.hasProperty(zf.a.widowControl)?b.getValue(zf.a.widowControl):!1,zM=b=>b.hasProperty(zf.a.keepTogether)?b.getValue(zf.a.keepTogether):!1;class wI extends Pf.a{constructor(b,h,t,A,O){super(!1,!1,!0);this.hih=null;this.Usn=()=>{Sa.a.instance.resolve("Box4.UI.IBox4DialogFactory").DFd(this.eAa,
this.Osa,this.W5,this.GA)};this.Wsn=(ub,Nb)=>{var Yb,bc,Dc;if(Nb&&(1===ub||2===ub)){if(Nb.alignmentComboBoxProps){var Pc=parseInt(Nb.alignmentComboBoxProps.selectedKey);isNaN(Pc)||rI(Pc)&&this.zp.setValue(Gd.a.Xv,Pc)}var jd=Nb.bySpinButtonProps;Pc=!!jd&&""!==jd.value;var Cd=Nb.didChangeSpecialIndentationComboBoxValue;if(Nb.specialIndentationComboBoxProps){var ee=parseInt(Nb.specialIndentationComboBoxProps.selectedKey);1!==ee&&2!==ee&&ee||!(ee||Cd||Pc)||this.zp.setValue(Gd.a.F4,ee)}if(jd){ee=jd.value;
jd=Ad.a.gNa(jd.unitType.toLowerCase());let Od;0<=ee||(ee=0);2===jd?Od=2:(Od=1,ee=Ad.a.dIa(ee,jd));if(Pc||Cd)this.zp.setValue(Gd.a.LSa,ee),this.zp.setValue(Gd.a.KSa,Od)}Nb.beforeTextSpinButtonProps&&(Cd=Nb.beforeTextSpinButtonProps,Pc=Ad.a.gNa(Cd.unitType.toLowerCase()),Cd=""===Cd.value?Number.NaN:Cd.value,isNaN(Cd)||(ee=Cd,2===Pc?jd=2:(jd=1,ee=Ad.a.dIa(Cd,Pc)),this.zp.setValue(Gd.a.iGa,ee),this.zp.setValue(Gd.a.hGa,jd)));Nb.afterTextSpinButtonProps&&(Cd=Nb.afterTextSpinButtonProps,Pc=Ad.a.gNa(Cd.unitType.toLowerCase()),
Cd=""===Cd.value?Number.NaN:Cd.value,isNaN(Cd)||(ee=Cd,2===Pc?jd=2:(jd=1,ee=Ad.a.dIa(Cd,Pc)),this.zp.setValue(Gd.a.Hlb,ee),this.zp.setValue(Gd.a.Glb,jd)));Nb.beforeSpacingSpinButtonProps&&(Pc=Nb.beforeSpacingSpinButtonProps,Cd=Ad.a.gNa(Pc.unitType.toLowerCase()),ee=Pc.reservedValue,""!==Pc.value&&(ee===Box4Intl.Box4Strings.L_SpinnerAuto?(Cd=1,Pc=0):(Cd=4===Cd?2:4,Pc=Pc.value),this.zp.setValue(Gd.a.vec,Pc),this.zp.setValue(Gd.a.uec,Cd)));Nb.afterSpacingSpinButtonProps&&(Pc=Nb.afterSpacingSpinButtonProps,
Cd=Ad.a.gNa(Pc.unitType.toLowerCase()),ee=Pc.reservedValue,""!==Pc.value&&(ee===Box4Intl.Box4Strings.L_SpinnerAuto?(Cd=1,Pc=0):(Cd=4===Cd?2:4,Pc=Pc.value),this.zp.setValue(Gd.a.tec,Pc),this.zp.setValue(Gd.a.sec,Cd)));if(Nb.atSpinButtonProps||Nb.lineSpacingComboBoxProps)if(Pc=Nb.atSpinButtonProps.value,1<Pc)this.zp.setValue(Gd.a.ua,Pc),this.zp.setValue(Gd.a.a3a,2);else if(Pc=Nb.lineSpacingComboBoxProps.selectedKey)Pc="1.00"===Pc?1:"1.50"===Pc?1.5:"2.00"===Pc?2:0,Pc=1<=Pc?Pc:1,this.zp.setValue(Gd.a.ua,
Pc),this.zp.setValue(Gd.a.a3a,2);Nb.contextualSpacingCheckboxProps&&this.zp.setValue(Gd.a.v_c,Nb.contextualSpacingCheckboxProps.checked);(null===(Yb=this.GA)||void 0===Yb?0:Yb.oFa)&&Nb.keepWithNextCheckboxProps&&this.zp.setValue(zf.a.keepWithNext,Nb.keepWithNextCheckboxProps.checked);(null===(bc=this.GA)||void 0===bc?0:bc.BIa)&&Nb.widowOrphanCheckboxProps&&this.zp.setValue(zf.a.widowControl,Nb.widowOrphanCheckboxProps.checked);(null===(Dc=this.GA)||void 0===Dc?0:Dc.Fga)&&Nb.keepTogetherCheckboxProps&&
this.zp.setValue(zf.a.keepTogether,Nb.keepTogetherCheckboxProps.checked);sI(this.eAa,this.eAa);sI(this.zp,this.eAa);Nb="";Yb=this.Osa;bc=this.zp;if(Dc=vI(Yb,bc))Dc=bc.hasProperty(Gd.a.LSa)&&bc.hasProperty(Gd.a.KSa);Dc?(Dc=bc.getValue(Gd.a.LSa),Pc=bc.getValue(Gd.a.KSa),Dc=(new or.a(Pc,Dc)).wt,Yb=tI(bc)+uI(bc)+Yb.getValue(Lc.a.marginRight)+Yb.getValue(Lc.a.marginLeft)+Dc+Jb.App.Sya<=Yb.getValue(Lc.a.xo)):Yb=vI(Yb,bc)?tI(bc)+uI(bc)+Yb.getValue(Lc.a.marginRight)+Yb.getValue(Lc.a.marginLeft)+Jb.App.Sya<=
Yb.getValue(Lc.a.xo):!0;Yb?NF(this.eAa,this.zp,this.rbm(this.LPe?this.LPe.R2b():{})):Nb=""!==Nb?Nb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==Nb?this.aHa(Nb,this.Usn):2===ub&&(lb.c(Vc.a.Aic,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Rb(Vc.a.Aic,2,null))}};this.eAa=b.clone();this.zp=b.clone();this.Osa=h.clone();this.W5=t;this.ga=A;this.LPe=new fD;this.GA=O;b=this.LPe.m_l(this.zp);h=XB("Inch",3,-11,22,.1);t=XB("Inch",3,0,22,.1);var aa=XB("Centimeter",
1,-27.94,55.88,1);A=XB("Centimeter",1,0,55.88,1);var ua=XB("Character",2,-316.8,316.8,.5);O=XB("Character",2,0,316.8,.5);h=[h,aa,ua];A=[t,A,O];t=FG();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};aa=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,
Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ua=["1","2","3","6","7"];let Ra=5;O=this.zp.hasProperty(Gd.a.Xv)?this.zp.getValue(Gd.a.Xv):0;if(10===O||9===O)O=11;if(v.AFrameworkApplication.lcid===Sf.a.lg("AR-SA").LCID||11===O)b.isKashidaSupported=!0,aa[Ra]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,ua[Ra]="11",Ra=6;if(v.AFrameworkApplication.lcid===Sf.a.lg("TH-TH").LCID||13===O)b.isThaiSupported=!0,aa[Ra]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,ua[Ra]="13";aa={["type"]:"AppComboBoxProps",
["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:QF(aa,ua),["allowFreeForm"]:!1};rI(O)?aa.selectedKey=O.toString():aa.defaultSelectedKey="";b.alignmentComboBoxProps=aa;if(this.GA.oFa||this.GA.BIa||this.GA.Fga)b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};
this.GA.oFa&&(O={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:xM(this.zp)},b.keepWithNextCheckboxProps=O);this.GA.BIa&&(O={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:yM(this.zp)},b.widowOrphanCheckboxProps=O);this.GA.Fga&&(O={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,
["checked"]:zM(this.zp)},b.keepTogetherCheckboxProps=O);b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};aa=vM(this.zp);O="0"===aa;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:QF([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,
Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:aa,["allowFreeForm"]:!1};ua=Jb.App.Oga;aa=0;({Zic:aa,X6a:ua}=GG(this.zp,Gd.a.LSa,Gd.a.KSa,O));A={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Ad.a.uZa(ua),["validUnits"]:A,["numberFormatInfo"]:t};
A=this.tNb(aa,A);b.bySpinButtonProps=A;O=Jb.App.Oga;A=0;({Zic:A,X6a:O}=GG(this.zp,Gd.a.iGa,Gd.a.hGa,!1));O={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Ad.a.uZa(O),["validUnits"]:h,["numberFormatInfo"]:t};O=this.tNb(A,O);b.beforeTextSpinButtonProps=O;O=Jb.App.Oga;A=0;({Zic:A,X6a:O}=GG(this.zp,Gd.a.Hlb,Gd.a.Glb,!1));h={["type"]:"AppSpinButtonProps",
["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Ad.a.uZa(O),["validUnits"]:h,["numberFormatInfo"]:t};h=this.tNb(A,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};t={["type"]:"AppCheckboxInternalProps",["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:wM(this.zp)};b.contextualSpacingCheckboxProps=
t;h.dialogButtonsOption=9;h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:"left",["margin-left"]:"0"}}};this.Yh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.Wsn,h)}rbm(b){return this.hih||(this.hih=this.v$e(b))}v$e(b){var h,t,A;b[Gd.a.Xv.id.toString()]=Sm.gOm;b[Gd.a.hGa.id.toString()]=Sm.lUi;b[Gd.a.iGa.id.toString()]=Sm.lUi;b[Gd.a.Glb.id.toString()]=
Sm.nUi;b[Gd.a.Hlb.id.toString()]=Sm.nUi;b[Gd.a.F4.id.toString()]=Sm.rcg;b[Gd.a.KSa.id.toString()]=Sm.rcg;b[Gd.a.LSa.id.toString()]=Sm.rcg;b[Gd.a.v_c.id.toString()]=Sm.FZk;if(null===(h=this.GA)||void 0===h?0:h.oFa)b[zf.a.keepWithNext.id.toString()]=Sm.rOm;if(null===(t=this.GA)||void 0===t?0:t.BIa)b[zf.a.widowControl.id.toString()]=Sm.YWo;if(null===(A=this.GA)||void 0===A?0:A.Fga)b[zf.a.keepTogether.id.toString()]=Sm.pOm;return b}tNb(b,h){h.value=isNaN(b)?"":b;return h}}Object(m.a)(wI,"WordReactParagraphDialog",
Pf.a,[]);class Kw extends Pf.a{constructor(b,h,t,A){super(!1,!1,!0);this.sUk=()=>{this.mIc.UGh(this.umi,this.Ome,this.LUc)};this.tUk=(O,aa)=>{aa&&1===O&&(aa.columnsCountSpinButtonProps&&this.YX.setValue(zf.a.rE,aa.columnsCountSpinButtonProps.value),aa.columnsWidthSpinButtonProps&&(O=aa.columnsWidthSpinButtonProps,this.YX.setValue(zf.a.JF,[Ad.a.dIa(O.value,Ad.a.gNa(O.unitType.toLowerCase()))])),aa.columnsSpacingSpinButtonProps&&(O=aa.columnsSpacingSpinButtonProps,this.YX.setValue(zf.a.zla,Ad.a.dIa(O.value,
Ad.a.gNa(O.unitType.toLowerCase())))),aa.columnsLineBetweenCheckboxProps&&this.YX.setValue(zf.a.separator,aa.columnsLineBetweenCheckboxProps.checked),this.wUk()&&(aa=Kw.sAd,this.Hzk()?NF(this.umi,this.YX,this.j7b):aa=aa!==Kw.sAd?aa:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),aa!==Kw.sAd&&this.aHa(aa,this.sUk)))};this.wUk=()=>this.YX.hasProperty(zf.a.rE)&&this.YX.hasProperty(zf.a.JF)&&this.YX.hasProperty(zf.a.zla)&&this.YX.hasProperty(zf.a.separator);this.wMd=(O,aa,ua)=>Math.floor((O-
(aa-1)*ua)/aa);this.Klf=(O,aa,ua)=>1==aa?0:Math.floor((O-aa*ua)/(aa-1));this.Dtk=(O,aa,ua,Ra)=>{const ub=O/aa;ua<Kw.Yic?(ua=Kw.Yic,Ra=this.Klf(O,aa,ua)):ua>ub&&(ua=ub,Ra=this.Klf(O,aa,ua));return[ua,Ra]};this.Atk=(O,aa,ua,Ra)=>{const ub=(O-Kw.Yic*aa)/(aa-1);0>Ra?(Ra=0,ua=this.wMd(O,aa,Ra)):Ra>ub&&(Ra=ub,ua=this.wMd(O,aa,Ra));return[ua,Ra]};this.dIa=(O,aa)=>Ad.a.dIa(O,Ad.a.gNa(aa));this.qHc=(O,aa,ua,Ra,ub)=>({["unitType"]:O,["unitPlaceholder"]:F.a.x8d(aa),["minValue"]:ua,["maxValue"]:Ra,["step"]:ub});
this.umi=b.clone();this.YX=b.clone();this.Ome=h.clone();this.Blb=this.Ome.getValue(Lc.a.xo)-this.Ome.getValue(Lc.a.marginLeft)-this.Ome.getValue(Lc.a.marginRight);this.AIb=Math.floor(this.Blb/Kw.Yic);this.LUc=t;this.mIc=A;this.sg=Kw.id;b={};b.getUnitValue=3==Jb.App.Oga?Ad.a.nz:Ad.a.uTa;b.getCalculatedWidthValue=this.wMd;b.getCalculatedSpacingValue=this.Klf;b.twipsFromValueAndUnits=this.dIa;b.adjustWidthForLimits=this.Dtk;b.adjustSpacingForLimits=this.Atk;b.pageContentWidth=this.Blb;b.maxColumnCount=
this.AIb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.MIl();b.columnsWidthSpinButtonProps=this.QIl();b.columnsSpacingSpinButtonProps=this.OIl();b.columnsLineBetweenCheckboxProps=this.NIl();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.Yh(Box4Intl.Box4Strings.l_ColumnsDialogTitle,this.tUk.bind(this),b)}MIl(){var b=[this.qHc("None",0,1,this.AIb,1)];const h=this.Krf(zf.a.rE);
b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:Ad.a.uZa(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.tNb(h,b)}QIl(){var b=[this.qHc("Inch",3,.5,Ad.a.nz(this.Blb),.1),this.qHc("Centimeter",
1,1.27,Ad.a.uTa(this.Blb),1)];const h=Jb.App.Oga,t=this.Krf(zf.a.JF);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:Ad.a.uZa(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.tNb(t,b)}OIl(){var b=
[this.qHc("Inch",3,0,Ad.a.nz(this.Blb-2*Kw.Yic),.1),this.qHc("Centimeter",1,0,Ad.a.uTa(this.Blb-2*Kw.Yic),1)];const h=Jb.App.Oga,t=this.Krf(zf.a.zla);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,["unitType"]:Ad.a.uZa(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,
["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.tNb(t,b)}NIl(){const b=this.YX.getValue(zf.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,["checked"]:b}}get j7b(){return null!=this.Zwg?this.Zwg:this.Zwg=(()=>this.v$e())()}v$e(){const b={};b[zf.a.rE.id.toString()]=b[zf.a.JF.id.toString()]=b[zf.a.zla.id.toString()]=
b[zf.a.separator.id.toString()]=Kr.vUk;return b}Hzk(){const b=this.YX.getValue(zf.a.JF),h=this.YX.getValue(zf.a.rE),t=this.YX.getValue(zf.a.zla);let A=0;for(let O=0;O<h;O++)A+=b[0];if(h<=this.AIb&&(h-1)*t+A<=this.Blb)return!0;u.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",h,b[0],t);return!1}Krf(b){if(this.YX.hasProperty(b)){if(b==zf.a.rE)return this.YX.getValue(b);if(b==zf.a.JF){var h=Jb.App.Oga;b=
this.YX.getValue(zf.a.zla);const t=this.YX.getValue(zf.a.rE);return Ad.a.u7a(this.wMd(this.Blb,t,b),h)}if(b==zf.a.zla){if(1==this.YX.getValue(zf.a.rE))return 0;h=Jb.App.Oga;b=this.YX.getValue(b);return Ad.a.u7a(b,h)}}return 0}tNb(b,h){h.value=isNaN(b)?Kw.sAd:b;return h}}Kw.id="ColumnsDialog";Kw.sAd="";Kw.Yic=720;Object(m.a)(Kw,"WordReactColumnsDialog",Pf.a,[]);class xI{G1k(b){new fE(b,Sa.a.instance.resolve("Box4.IFeatureHelper"))}A5k(b,h){new nI(b,h,Sa.a.instance.resolve("Box4.IFormattingReader"),
Sa.a.instance.resolve("Box4.Styles.IWACStyleReader"),fm.PageNavigator.instance)}Jkl(b,h,t){new oI(b,h,t)}dIh(b,h,t){new Iz(b,h,t,Sa.a.instance.resolve("WordEditor.IPageCommands"),Sa.a.instance.resolve("Common.IStandaloneRootController").zca,!!Jb.App.instance&&Jb.App.instance.twa)}IIh(b,h,t){new fu(b,h,t,Sa.a.instance.resolve("WordEditor.IPageCommands"),Sa.a.instance.resolve("Common.IStandaloneRootController").zca,!!Jb.App.instance&&Jb.App.instance.twa)}UGh(b,h,t){new Kw(b,h,t,Sa.a.instance.resolve("WordEditor.UI.IDialogFactory"))}d1k(b){return new CD(b)}DFd(b,
h,t,A){new wI(b,h,t,v.AFrameworkApplication.xa,A)}Jcl(){const b=Sa.a.instance.Ma("Box4.IRoamingServiceRequestManager");null==b?Jc.b(524834398,3018,10,"Roaming service not resolved."):new eI(b)}Ncl(b,h){new fI(b,h)}zbf(b){return new gI(b)}}Object(m.a)(xI,"DialogFactory",null,[396,397]);class bF extends Pf.a{constructor(b,h){super(!1,!1,!0);this.dPh="DoNotCheckSpellingCheckbox";this.rPh="DocumentChoiceGroup";this.nfd=0;this.Yzi="LanguageList";this.documentContext="DocumentContext";this.Rq="RangeContext";
this.Aco=(t,A)=>{const O=zk.a.instance.vp(qa.a.Bfj);if(1!==t)O.properties.Z("canceled","true");else{t=A[this.Yzi].replace(bF.tqg,"");var aa=parseInt(t),ua=Boolean.parse(A[this.dPh]);A=A[this.rPh];A===this.documentContext?this.Tld.sao(aa,ua):this.Tld.Efo(aa,ua);O.properties.Z("PreviousLCID",this.nfd.toString());O.properties.Z("ChangedLCID",aa.toString());O.properties.Z("NoProof",ua.toString());this.B_g.zco(aa,this.nfd);lb.d(qa.a.Bfj,!0,void 0,void 0,void 0,void 0,[Object.assign(new sa.a,{name:"SelectedLcid",
string:t}),Object.assign(new sa.a,{name:"NoProof",string:ua.toString()}),Object.assign(new sa.a,{name:"Context",string:A})]);Jb.App.ya.updateCommandUI(!0)}O.end()};this.B_g=h;this.Tld=b}kbg(){const b=Array(2);b[0]={["key"]:this.Rq,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps=
{["id"]:this.rPh,["defaultSelectedKey"]:this.fMl(),["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.nfd=({eDn:this.dUj}=this.Tld.z4l()).returnValue;h.languageListPropsProvider=this.QTl();h.spellingCheckboxProps={["id"]:this.dPh,["checked"]:!this.dUj,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.Yh(Box4Intl.Box4Strings.l_Language,this.Aco,{["id"]:"LanguageDialog",["bodyControls"]:h})}fMl(){return this.Tld.jf()?this.documentContext:
this.Rq}QTl(){return()=>{let b,h;const t=({selectedIndex:b,goj:h}=this.B_g.PTl(this.nfd)).returnValue;for(let A=0;A<t.length&&A<h;A++)t[A].value=bF.tqg+t[A].value;return{["id"]:this.Yzi,["items"]:t,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}bF.tqg="recent-";Object(m.a)(bF,"ReactLanguageDialog",Pf.a,[395]);class yI extends $E{constructor(b,h,t,A){super(h,t);this.FWf=()=>{this.floatie.qm()};this.Fh=b;this.aI=A}$db(b,h,t){if(b=super.$db(b,h,t))b.gfc=!0,b.l9d=!0,b.preventDismissOnScroll=!0;
this.Fh.mYa(this.FWf);return b}$Qc(b,h,t=null){this.aI.Qsh(()=>this.$db(b,h,t))}d5d(){this.floatie.gfc=!0}}Object(m.a)(yI,"ExternalContentFloatieInitializer",$E,[]);class zI{sKb(){Tl.instance.Rna&&(rs.instance.i7a([1,0]),Tl.instance.tZd()&&eu.instance.i7a([1]))}}Object(m.a)(zI,"RulerUser",null,[121]);class AI{constructor(){this.whitelistedControlIds=null}}Object(m.a)(AI,"StatusBarProps",null,[]);class cF{constructor(b,h,t=!0){this.Tqd=!1;this.WMe=null;this.hea=h.CG;this.iRe=h.dpj;t?rk.a.get_instance().Vk(7,
()=>{this.$uh(b,h)}):this.$uh(b,h)}$uh(b,h){window.setTimeout(()=>{Fq.a.instance.he(()=>{oh.UISurfaces.w6l().then(t=>{const A=Object.assign(new AI,{whitelistedControlIds:h.whitelistedControlIds});t.initializeNewStatusBar(b,A,this.iRe);this.WMe=t;this.Tqd=!0;window.setTimeout(()=>{Fq.a.instance.he(()=>{const O=[];if(h.AG){const aa=h.AG;for(let ua in aa)O.push(appChrome.actions.updateControlHiddenState(ua,aa[ua]));appChrome.api.dispatch(O)}this.sKb()},"RSB:I2")},0);return null}).catch(()=>{u.ULS.sendTraceTag(51656736,
324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(h.Vpa&&b){cF.nUg||(v.AFrameworkApplication.xa.pa(ab.a.fpj,yc.a.frame,Object(z.a)(this,this.gpj,"statusBarTabAction")),v.AFrameworkApplication.xa.pa(ab.a.epj,yc.a.frame,Object(z.a)(this,this.gpj,"statusBarTabAction")),cF.nUg=!0);const t=hs.a.EUd(h.Vpa,h.Rej,b,!1);t.zH=!0;this.Ofc(t,ab.a.fpj,ab.a.epj)}},0)}sKb(){this.Tqd&&this.hea&&window.setTimeout(()=>{this.hea(this.WMe.selectors.getStatusBarControlsMap(this.iRe),7)},0)}hnb(b,
h){this.Tqd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}yU(b){this.Tqd&&this.hea&&window.setTimeout(()=>{const h=this.WMe.selectors.getStatusBarControlsMap(this.iRe);if(h[b]){const t={};t[b]=h[b];this.hea(t,7)}},0)}Ofc(b,h,t){const A=sb.KeyInputManager.mc(rc.a.iw,0),O=sb.KeyInputManager.mc(rc.a.iw,4);b.Xq(A);b.Xq(O);b.bindAction(A,h);b.bindAction(O,t)}gpj(){return 4}}cF.nUg=!1;Object(m.a)(cF,"ReactStatusBar",null,[]);class BI{constructor(){this.whitelistedControlIds=
this.AG=this.CG=null;this.QMm=!1;this.Rej=this.Vpa=this.dpj=null}}Object(m.a)(BI,"ReactStatusBarInitOptions",null,[]);var DD=c(478);class CI{constructor(b,h,t,A,O){this.cXb=this.wLa=this.Na=null;this.Jvo=()=>{const aa=Jb.App.ya.yp.getRegion(Hh.AppFrame.Vpa);aa&&aa.bLf()};this.jhm=(aa,ua,Ra,ub,Nb)=>{if(!Nb)return u.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===Ra)return 32;Nb&&2===Nb.length&&this.wLa&&this.wLa.hnb(Nb[0],Nb[0]);return 32};
this.B$c=aa=>{Jb.App.ya.CG(aa)};this.ga=A;Fq.a.instance.he(()=>{this.Na=O;this.cXb=this.wLa=null;const aa={};v.AFrameworkApplication.mmj||(aa[DD.a.B2n]=!0);aa.GiveFeedback=!v.AFrameworkApplication.hF;this.Na.$("OfficeOnlineInGallatinTextVisible")||(aa.CenterStatusLabel=!0);aa[DD.a.FTi]=!0;this.Na.$("WPMPackageIsEnabled")&&this.Na.$("WPMStatusBarLabelIsEnabled")||(aa[DD.a.rmg]=!0);this.Na.$("AddInCommandsIsEnabled")||(aa[DD.a.Xlk]=!0);this.Na.$("WordEditorShowOcsConnectionStatus")||(aa[DD.a.lPf]=!0);
aa[DD.a.BXo]=!0;this.Na.$("ReadingTimeIsEnabled")||(aa[DD.a.N0i]=!0);window.setTimeout(()=>{this.Krm(b,aa)},0)},"SBU:I")}Ub(){this.ga.gb(qa.a.bie,mc.a.application,this.jhm,96)}Krm(b,h){this.cXb=Sa.a.instance.Ma("WordEditor.WordEditorReactCommandDefinitionMapping");const t={};for(const O in h){var A=h[O];t[this.Rqf(O)]=A}this.wLa=new cF(b,Object.assign(new BI,{AG:t,CG:this.B$c,QMm:!1,dpj:"WordEditorStatusBar",Vpa:Hh.AppFrame.Vpa,Rej:this.Jvo}))}Rqf(b){let h="";if(this.cXb){const t=this.cXb.znf(b);
t&&0<t.count&&(h=t.J(0))}return h&&""!==h?h:b}sKb(){this.wLa&&this.wLa.sKb()}hnb(b,h){this.wLa&&this.wLa.hnb(this.Rqf(b),h)}yU(b){this.wLa&&this.wLa.yU(this.Rqf(b))}dispose(){}}Object(m.a)(CI,"StatusBarUser",null,[120,9]);var DI=c(1056);class HG{constructor(b){this.ga=b;this.ga.pa(ab.a.r3c,yc.a.frame,Object(z.a)(this,this.r3c,"reportFileMenuPageSwitch"));this.ga.pa(ab.a.l7i,yc.a.frame,Kf.ActionManager.Kf)}r3c(b,h,t,A,O){this.ga.processAction(this.HOl(O[DI.a.A7d]),2);return 32}}Object(m.a)(HG,"FileMenuSQMInformation",
null,[925]);class EI extends HG{constructor(b){super(b);this.jOn()}jOn(){this.ga.pa(ab.a.M3f,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.f7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.N3f,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.g7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.h7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.O3f,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.i7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.j7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.k7i,
yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.L7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.M7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.o7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.p7i,yc.a.frame,Kf.ActionManager.Kf)}HOl(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return ab.a.M3f;case "tabHome":case "FileHomePage":return ab.a.f7i;case "menuJewelInfo":case "FileInfoPage":return ab.a.N3f;case "menuJewelNew":case "FileNewPage":return ab.a.g7i;case "menuJewelOpen":case "FileOpenPage":return ab.a.h7i;
case "menuJewelPrint":case "FilePrintPage":return ab.a.O3f;case "menuJewelSaveAs":case "FileSaveAsPage":return ab.a.i7i;case "menuJewelShare":case "FileSharePage":return ab.a.j7i;case "menuJewelTransform":case "FileTransformPage":return ab.a.k7i}return ab.a.l7i}}Object(m.a)(EI,"WordEditorFileMenuSQMInformation",HG,[]);var FI=c(1054);class IG{constructor(b){this.ga=b;this.ga.pa(ab.a.s3c,yc.a.frame,Object(z.a)(this,this.s3c,"reportTabSwitch"));this.ga.pa(ab.a.G7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.I7i,
yc.a.frame,Kf.ActionManager.Kf)}s3c(b,h,t,A,O){this.ga.processAction(this.v3l(O[FI.a.meg]),2);return 32}}Object(m.a)(IG,"RibbonSQMInformation",null,[879]);class GI extends IG{constructor(b){super(b);this.zQn()}zQn(){this.ga.pa(ab.a.x7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.z7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(Vc.a.Q3f,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.A7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.B7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(Vc.a.C7i,yc.a.frame,
Kf.ActionManager.Kf);this.ga.pa(Vc.a.D7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(Vc.a.E7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(Vc.a.F7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(Vc.a.R3f,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(Vc.a.H7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(ab.a.J7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(Vc.a.K7i,yc.a.frame,Kf.ActionManager.Kf);this.ga.pa(Vc.a.y7i,yc.a.frame,Kf.ActionManager.Kf)}v3l(b){switch(b){case "tabAddins":case "Addins":return ab.a.x7i;
case "tabHome":case "Home":return ab.a.A7i;case "tabInsert":case "Insert":return ab.a.B7i;case "tabDeveloper":case "Developer":return ab.a.z7i;case "tabPageLayout":case "Layout":return Vc.a.C7i;case "tabReferences":case "References":return Vc.a.F7i;case "tabReview":case "Review":return Vc.a.R3f;case "tabView":case "View":return ab.a.J7i;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Vc.a.H7i;case "tabMailings":case "Mailings":return Vc.a.D7i;
case "tabWordDesign":case "Design":return Vc.a.K7i;case "tabHelp":case "Help":return Vc.a.Q3f;case "ctabPictureTools":case "Picture":return Vc.a.E7i;case "Copilot":return Vc.a.y7i}return ab.a.I7i}}Object(m.a)(GI,"WordEditorRibbonSQMInformation",IG,[]);class HI{constructor(b=null,h=null,t=null){this.AG=b||{};this.lvj=h||[];this.pvj=t||{}}}Object(m.a)(HI,"RibbonTrimmingProperties",null,[]);class II{constructor(b,h,t){this.gua=b;this.AG=h;this.WEf=t}}Object(m.a)(II,"ReactRibbonJewelProperties",null,
[]);class JI{constructor(){v.AFrameworkApplication.xa.pa(ab.a.cQa,yc.a.frame,Object(z.a)(this,this.rIn,"reactFileMenuOpenFromTellMe"))}rIn(b,h,t,A,O){if(1===t||!O)return 32;b=O.SourceControlId;17!==O.UILocation||"New"!==b&&"Open"!==b||(O=[],Rh.d("setFileMenuSelectedPage")&&("New"===b&&v.AFrameworkApplication.ta?2===v.AFrameworkApplication.ta.Ob.jm?O.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):O.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&v.AFrameworkApplication.ta&&
(2===v.AFrameworkApplication.ta.Ob.jm?O.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):O.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),O.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(O));return 32}OAi(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}HRa(){return!1}uWi(){}NOh(){}}Object(m.a)(JI,"ReactFileMenu",null,[197]);class KI{e9e(){const b=new JI,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));
h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(m.a)(KI,"ReactFileMenuFactory",null,[163]);class hE{constructor(b,h,t,A=!1){this.gkc=b;this.mYg=this.gkc.g2a;this.m4d=Sa.a.instance.Ma("Common.IOfficeTrialExperience");this.rIb=Sa.a.instance.Ma("Common.IMacOfficeOffer");hE.Ese=!1;this.uHm=A;this.ga=h;this.Vb=t}get rc(){return this.ga}get tg(){return this.Vb}O_e(){return this.mYg&&!!this.m4d&&!!this.rIb}NTa(b,h){this.gkc.Wo(()=>{u.ULS.sendTraceTag(5878046,
340,50,"Full app settings are ready");this.mYg=!0;this.vgf(b,h)});Sa.a.instance.Sa("Common.IOfficeTrialExperience").execute(t=>{u.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.m4d=t;this.vgf(b,h)});Sa.a.instance.Sa("Common.IMacOfficeOffer").execute(t=>{u.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.rIb=t;this.vgf(b,h)})}vgf(b,h){hE.Ese||(this.O_e()?(u.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),hE.Ese=!0):
u.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}hE.Ese=!1;Object(m.a)(hE,"RibbonDependencies",null,[804]);class JG{constructor(b,h,t){this.ysb=b;this.ga=h;this.Vb=t}}Object(m.a)(JG,"WoncaRibbonUserFactory",null,[203]);class LI{constructor(b,h){this.Rte=b;this.IZb=h}Cnb(b){this.Rte.Cnb(b);this.IZb&&this.IZb.Cnb(b)}y5c(b){this.Rte.y5c(b);this.IZb&&this.IZb.y5c(b)}E$c(b){this.Rte.E$c(b);this.IZb&&this.IZb.E$c(b)}}Object(m.a)(LI,"RibbonCommandTrimmer",null,[162]);var AM=
c(1234),BM=c(1154);class MI{constructor(b,h){this.Na=b;this.rXb=h}Cnb(b){ba.a.si&&6>ba.a.n1a&&(b.fseaInsertPicture=!0);this.Na.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Na.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Na.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);lD.a.kvi()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Na.$("InsertOnlinePictureEnabled"),t=v.AFrameworkApplication.tBf();h||(b.fseaInsertOnlinePicture=!0,b.fseaFlyInsertOnlinePictureFromSearch=
!0);t?b.fseaInsertPictureFromOneDrive=!0:(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);t&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;v.AFrameworkApplication.uBf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);v.AFrameworkApplication.Fke&&(b.btnOpenInClient=!0);v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")&&this.Okc(b)}y5c(b){b.menuJewel=
!0;v.AFrameworkApplication.hF||(b.jbtnGiveFeedback=!0)}Okc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}E$c(b){delete b.menuJewel;v.AFrameworkApplication.privacyUrl||(b.jbtnPrivacy=!0);v.AFrameworkApplication.p3c||(b.jbtnReportAbuse=!0);v.AFrameworkApplication.Cje||(b.jbtnTermsOfUse=!0);v.AFrameworkApplication.xKd||(b.jbtnFileSharing=!0);v.AFrameworkApplication.Bmb||
(b.jbtnShareRWC=!0);v.AFrameworkApplication.Ahf||v.AFrameworkApplication.hkg||(b.jbtnVersion=!0);this.rXb.m4d&&this.rXb.m4d.Vcn||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.rXb.rIb&&this.rXb.rIb.olo||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);v.AFrameworkApplication.Fke?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[Jb.App.Ds?"btnjOpenInClient":"btnjEditInClient"]=!0;v.AFrameworkApplication.cGo&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=!0,b.jbtnDownloadAsOdt=!0);
v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")?this.Okc(b):v.AFrameworkApplication.K.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;v.AFrameworkApplication.qG&&(this.Okc(b),b.faShare=!0);if(v.AFrameworkApplication.protectFile||ba.a.QPa||!v.AFrameworkApplication.eQc&&!v.AFrameworkApplication.rhf&&!v.AFrameworkApplication.fkg)b.jbtnFileEmbed=!0;AM.a.$nm()||(b.btnjClose=!0);v.AFrameworkApplication.RGb?(b.jbtnVersion=!0,u.ULS.sendTraceTag(594629315,
3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):v.AFrameworkApplication.sZd()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);v.AFrameworkApplication.Y_f||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Na.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&b.jbtnTermsOfUse&&b.jbtnPrivacy&&
b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.swi;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(v.AFrameworkApplication.qK||".ODT"===Jb.App.vKd.toUpperCase()||!v.AFrameworkApplication.K.$("WordEditorAppsForOfficeRibbonIsEnabled")||!BM.a.Vyd||v.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=
!0}}Object(m.a)(MI,"WoncaCommandTrimmer",null,[162]);var CM=c(998);c(469);var DM=c(1055),EM=c(1153);class NI{constructor(b,h){this.A1=this.SJ=null;this._clientId=b;this.C$=h}Qol(){if(!Za.c(this.A1))return this.A1;this.Gff();this.A1.style.display="block";this.C$&&this.C$.uZ(Object(z.a)(this,this.onResize,"onResize"));return this.A1}onResize(){this.Qxa()}Qxa(){this.mff()?(document.getElementById("application").style.minWidth="0px",(new EM.a(this.A1,null,v.AFrameworkApplication.isRtl)).A4n(this.A1)):
v.AFrameworkApplication.ta.Ob.ZI||DM.a.B4n(this.A1,v.AFrameworkApplication.isRtl)}mff(){return v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):!1}Gff(){if(Za.c(this.SJ)){var b;({MPc:b}=hs.a.B9c(!v.AFrameworkApplication.tX)).returnValue?(this.SJ=FF.a("div"),this.SJ.className=hs.a.irl,this.SJ.id=Fo.CuiHelper.RJd,b.appendChild(this.SJ),this.zff(),v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.n8&&!v.AFrameworkApplication.tX&&this.Aff(),this.Pol()):v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("ReactHeaderCrashLogs")&&u.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}Pol(){Za.c(this.A1)&&(this.A1=FF.a("div"),this.A1.className=hs.a.Dgg,this.A1.style.display="none",this.SJ.appendChild(this.A1))}zff(){Sys.UI.DomElement.addCssClass(this.SJ,hs.a.jrl);v.AFrameworkApplication.isRtl&&FF.b(this.SJ,"cui-rtl")}Aff(){Sys.UI.DomElement.addCssClass(this.SJ,"FlexBoxLayout")}}Object(m.a)(NI,"HeaderSkeleton",
null,[]);var iE=c(642);class KG{constructor(){this.$mc=null}YHo(){this.$mc||(this.$mc=Sa.a.instance.Ma("Common.App.AccountSwitching.IAccountSwitching"))||u.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}gDl(){this.YHo();return this.$mc?this.$mc.getCustomAuthConfig():null}static pAm(){return v.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(m.a)(KG,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class LG{constructor(){this.tHb=this.cultureName=null}}
Object(m.a)(LG,"HeaderCultureInfo",null,[]);var RF=c(1610);class OI{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(m.a)(OI,"SearchInitializationSettings",null,[]);var jE=c(295);class PI{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=
this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(m.a)(PI,"DocumentTitleAppProps",null,[]);class QI{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(m.a)(QI,"DocumentTitleCalloutAppProps",null,[]);class RI{constructor(){this.language=
this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;
this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(m.a)(RI,"HeaderAppProps",null,[]);class SI{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(m.a)(SI,"HeaderControls",null,[]);class TI{constructor(){this.command=
this.label=null}}Object(m.a)(TI,"WorkflowButtonAppProps",null,[]);var SF;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.insufficientPermission=2]="insufficientPermission";b[b.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";b[b.editorsPresent=4]="editorsPresent";b[b.notSupported=5]="notSupported"})(SF||(SF={}));Object(m.b)("RenameDisableReason",SF);class UI{constructor(b=""){this.t6f=this.documentTitleAppProps=this.pmg=null;this.Rdk=""!==b?b:ah.a.H4}s2l(b){const h=Sa.a.instance.Ma("Common.IExternalUICommandDefinitionMapping").MCb(b);
if(h&&0<h.length)return h[0].externalUxCommand;u.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}rtf(){if(!this.pmg){const b=iE.a();if(b){const h=this.s2l(b.command);h&&(this.pmg=Object.assign(new TI,{command:h,label:b.label}))}}return this.pmg}xKl(){return Object.assign(new SI,{workflowButton:this.rtf()})}bhn(){rk.a.get_instance().WK(17)}onMove(){const b={};b.MoveButtonClickedTime=new Date;v.AFrameworkApplication.xa.Rb(ab.a.KIb,
2,b)}Q2l(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}XMl(){let b=null,h=null;var t=Sa.a.instance.Ma("Common.IRenameProps");t?(t=t.bbi(),0!==t&&(b=this.Q2l(t),h=SF[t])):u.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new QI,{breadcrumbBrandName:v.AFrameworkApplication.Mt.breadcrumbBrandName,
breadcrumbBrandUrl:v.AFrameworkApplication.Mt.breadcrumbBrandUrl,breadcrumbFolderName:v.AFrameworkApplication.Mt.breadcrumbFolderName,breadcrumbFolderUrl:v.AFrameworkApplication.Mt.breadcrumbFolderUrl,hideDocumentTitleInput:v.AFrameworkApplication.ta.Ob.okm,isVersionHistoryEnabled:this.Dmo(),documentExtension:F.a.Qfa(v.AFrameworkApplication.fileName),isMoveEnabled:32===v.AFrameworkApplication.xa.processAction(ab.a.KIb,1),onMove:Object(z.a)(this,this.onMove,"onMove"),message:b,renameDisableReason:h,
openBreadcrumbsInNewTab:v.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}V3h(){if(!this.documentTitleAppProps){const b=v.AFrameworkApplication.Mt.Oy;this.documentTitleAppProps=Object.assign(new PI,{documentTitle:v.AFrameworkApplication.OHd?b:F.a.KI(b),onFirstRender:Object(z.a)(this,this.bhn,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(z.a)(this,this.XMl,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}Dmo(){return!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.pxi}nko(){return!!v.AFrameworkApplication.ta&&
v.AFrameworkApplication.ta.Ob.oxi}kmo(){const b=!iE.b()&&!v.AFrameworkApplication.hideHeader&&!v.AFrameworkApplication.qvf&&(v.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||v.AFrameworkApplication.K.$("TeamsChatIsEnabled"));u.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}MZk(b){appChrome.getHeaderApi().then(h=>{h.setNavBarData(b.result);return null});u.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}wNn(b=!1){appChrome.getHeaderApi().then(h=>
{const t=Sa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",A=>{t.onFlexPaneOpen(A)});h.setHeaderCommandHandler("OnFlexPaneClose",A=>{t.onFlexPaneClose(A)});h.setHeaderCommandHandler("SetCookie",A=>dc.a.set(A.cookieName,A.value));h.setHeaderCommandHandler("GetCookie",A=>this.zKl(A));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",
Object(z.a)(this,this.rtf,"getWorkflowButtonAppProps"));b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(z.a)(this,this.V3h,"getDocumentTitleAppProps")),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.chn();return null}));RF.a.CYd()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(z.a)(this,this.Nbi,"getSearchInitializationSettings"))})}chn(){Sa.a.instance.Sa("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.opb(!1,v.AFrameworkApplication.xa.mode)})}zKl(b){b=
dc.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}h7l(){return jE.AppChromeOverrideUtilities.isEnabled?jE.AppChromeOverrideUtilities.HPd("suiteux-shell",!1):this.Rdk+v.AFrameworkApplication.Vha+"suiteux-shell"}onFirstRender(){Sa.a.instance.Sa("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.hjo.continueWith(Object(z.a)(this,this.MZk,"continueShellServiceDataAsync"),3)});rk.a.get_instance().WK(15)}onFullyLoaded(){rk.a.get_instance().WK(16)}Uma(b=!1){a:{try{var h=
Sf.a.lg(v.AFrameworkApplication.lcid);if(h){var t=Object.assign(new LG,{cultureName:h.name,tHb:h.tHb});break a}}catch(A){u.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+v.AFrameworkApplication.lcid.toString())}t=Object.assign(new LG,{cultureName:"en-us",tHb:"en"})}h=Sa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");t=Object.assign(new RI,{appName:CommonUIStrings.l_AppNameShort,culture:t.cultureName,language:t.tHb,isConsumer:!v.AFrameworkApplication.kkg,
showAppLauncher:iE.h(),showMeControl:iE.g(),hideUserName:v.AFrameworkApplication.BTd,defaultDocumentTitleToLeft:v.AFrameworkApplication.uLh,assetsContainerOverride:this.h7l(),controls:this.xKl(),documentTitleAppProps:b?null:this.V3h(),showDocumentTitleControl:!b,showWorkflowButton:!!this.rtf(),showChatControl:this.kmo(),showGoPremiumControl:iE.i(),showDiscoverPremiumButton:iE.f(),enableSearchControl:RF.a.tJm(),onFlexPaneOpen:Object(z.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(z.a)(h,
h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.nko(),testTraffic:v.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(z.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(z.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:v.AFrameworkApplication.oko()});!v.AFrameworkApplication.Elc||v.AFrameworkApplication.Rbg?(t.userDisplayName=v.AFrameworkApplication.userName,t.emailAddress=v.AFrameworkApplication.K.kb("UserPrincipalName"),
t.userID=v.AFrameworkApplication.K.kb("Puid")||"",t.signOutLink=v.AFrameworkApplication.Rbg):v.AFrameworkApplication.signInUrl&&(t.signInLink=v.AFrameworkApplication.signInUrl);RF.a.CYd()&&(h=this.Nbi(),t.loadTellMeResources=h.loadTellMeResources,t.getTokenRequestDictionary=h.getTokenRequestDictionary,t.enableVanillaSearchBox=v.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),t.userRing=h.userRing);KG.pAm()&&(h=new KG,t.shellAuthProviderConfigPromise=Object(z.a)(h,h.gDl,"getAccountSwitchingConfig"));
this.wNn(b);return t}Nbi(){if(!this.t6f){const b=new RF.a;let h=v.AFrameworkApplication.K.kb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.t6f=Object.assign(new OI,{loadTellMeResources:b.nTm(),getTokenRequestDictionary:Object(z.a)(b,b.n9l,"getTokenRequestDict"),userRing:h})}return this.t6f}}Object(m.a)(UI,"ReactSharedHeaderPropsHelper",null,[1221]);class MG{constructor(){this.label=this.value=null}}Object(m.a)(MG,"TextInfoSectionField",null,[]);var dF=c(753),FM=c(1066);class NG{constructor(){this.commandId=
0;this.externalUxCommand=null}}Object(m.a)(NG,"CommandDefinition",null,[]);class VI{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(m.a)(VI,"CommandDefinitionMapping",null,[]);const GM=b=>Object.assign(new VI,{getCommandByExternalUxId:h=>{const t=b.getCommandByExternalUxId(h);return t?Object.assign(new NG,{commandId:parseInt(t.commandId),externalUxCommand:t.externalUxCommand}):Object.assign(new NG,{externalUxCommand:h})},
getDoNothingCommand:()=>parseInt(ab.a.Gg),addCommandToMaps:Object(z.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(z.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(z.a)(b,b.addTabToMap,"addTabToMap")});var HM=c(1380);class WI{}Object(m.a)(WI,"RibbonInitState",null,[]);var XI=c(453),IM=c(1320);class YI{constructor(){}flatten(b){const h=[];for(const t of b)h.push.apply(h,t);return h}}Object(m.a)(YI,"ReactAsyncDispatcher",null,[]);var JM=c(1652);class ZI{constructor(b,h){this.kdk=
b;this.DSj=h}}Object(m.a)(ZI,"ReactExecuteCommandContext",null,[]);class ey{}ey.Trigger="FontTrigger";ey.Name="FontName";ey.Action="FontAction";ey.Level="FontLevel";ey.IsPinned="FontIsPinned";Object(m.a)(ey,"FontPickerLogProperties",null,[]);class $I{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb=null,Yb=null){this.$Y=null;this.ech=!1;this.Qxe=[];this.jfd=-1;this.Pud=!1;this.xek=0;this.Xoc=null;this.N8g=!1;this.Uda=b;this.nbb=h;this.rOe=Object(Da.a)(883,b);this.Pl=t;this.Vb=A;O&&(this.$Y=new JM.a(O,A));this.Lak=
aa;this.XWj=ua;this.Dp=Nb;this.ga=Ra;this.Ntb={};this.Na=ub;this.qsg=Yb;ub&&(ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||ub.$("EnqueueTasksWhenTaskMgrIsYielding"))&&qi.a.instance.ezd.CWR(()=>this.ech=!0);ub&&(b=this.Na.kb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({Nu:this.Xoc}=E.d(b));this.Xoc||(this.Xoc={})}get Jde(){return!!window.appChrome&&!!appChrome.selectors}Waj(){-1!==this.jfd&&window.clearTimeout(this.jfd);this.jfd=
window.setTimeout(()=>{for(this.jfd=-1;0<this.Qxe.length;){if(sf.a.instance.zv){this.Waj();break}const b=this.Qxe.shift();b&&this.executeCommand(b.kdk,b.DSj)}},0)}executeCommand(b,h){if(sf.a.instance.zv){if(this.ech){this.Qxe.push(new ZI(b,h));this.Waj();return}u.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",b,h.modelType,ob.a.toJSON(h.payload));
if(this.Na.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const t=this.Pl.getCommandByExternalUxId(b),A=h.modelType;this.qsg&&this.qsg.yWm(b,h);t?this.Zpl(b,t,A,h):this.$pl(b,A,h);this.rOk(h);this.F3m(b,h)}}$pl(b,h,t){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.LTh(t,b);break;case "ButtonModel":this.Upl(t,b)}}dQo(b,h,t,A,O){if(t.payload)switch(t.payload.type){case "CoauthorMenuPayload":b.MenuItemId=t.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=h.menuItemId;
b.CommandValueId=t.payload.commandValueId;b.TerminalParentControlId=t.payload.terminalParentControlId;this.Na&&this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)?(h=!0,Za.c(t.payload.dismissHostingSurfaceOnExecute)||(h=t.payload.dismissHostingSurfaceOnExecute),h&&this.I2()):this.I2();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=t.payload.commandValueId;O=h.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=h.menuItemId;
b.CommandValueId=t.payload.commandValueId;O=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=A;return O}eQo(b,h,t){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=this.Pl.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.Pl.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":t.CommandId=h.payload.executedControl;t.ControlId=h.payload.executedControl;
t.ParentControlId=h.payload.parentControl;t.CloseAllMenus=!0;this.I2();break;case "TellMeSearchResultChangePayload":t.Value=h.payload.searchText;break;case "SmartLookupPayload":t.CommandValueId=h.payload.selectionContextJson}return b}Zpl(b,h,t,A){var O=this.gxn(A,t),aa=h.commandId;const ua={},Ra={};switch(t){case "SplitButtonModel":if(this.lPc(A.payload,Object(z.a)(this,this.fRo,"updateSplitButtonMenuState"),O))return;ua.MenuItemId=h.menuItemId;this.L9f(A,ua);break;case "StatefulSplitButtonModel":if(this.lPc(A.payload,
Object(z.a)(this,this.lRo,"updateStatefulSplitButtonMenuState"),O))return;t=A.payload.statefulData;O=A.payload.statefulMode;"color"===O?ua.Color=t:"icon"===O&&(t=this.Pl.getCommandByExternalUxId(t))&&(ua.MenuItemId=t.menuItemId);break;case "FileMenu":ua.MenuItemId=h.menuItemId;ua.SourceControlId=b;A.payload&&"FileMenuPageSwitchPayload"===A.payload.type&&this.Tem(aa,A.payload,b);break;case "TellMe":aa=this.eQo(aa,A,ua);ua.SourceControlId=b;ua.Location=A.payload.location;break;case "ButtonModel":A.payload&&
"TabSwitchPayload"===A.payload.type?this.Ngm(ua,A):aa=this.dQo(ua,h,A,b,aa);break;case "CompoundButtonModel":ua.MenuItemId=h.menuItemId;ua.CommandValueId=A.payload.commandValueId;ua.SourceControlId=b;this.L9f(A,ua);this.I2();break;case "ToggleButtonModel":case "InkButtonModel":ua.MenuItemId=h.menuItemId;ua.SourceControlId=b;this.L9f(A,ua);this.I2();break;case "FontPickerModel":switch(A.payload.type){case "MenuOpenPayload":aa=this.Pl.getCommandByExternalUxId("FontPickerMenuOpen").commandId;ua[Ez.a.FontPickerId]=
A.payload.launcherId;break;case "MenuClosePayload":aa=this.Pl.getCommandByExternalUxId("FontPickerMenuClose").commandId;ua[Ez.a.FontPickerId]=A.payload.launcherId;break;case "FontPickerFontSelectedPayload":t=A.payload.font;O=null;"string"===typeof t?(O=Ap.FontUtils.LQa(t),ua.CommandValueId=O,O=Ap.FontUtils.zFd(O)):(t.data?(ua.CommandValueId=t.data.fontToApply,ua.MenuItemId=t.data.themeIndex,ua[Ez.a.Formatting]=t.data):ua.CommandValueId=t.name,O=t);ua.SourceControlId=b;ua[Ez.a.RequestUpdateMru]=O;
Ra[ey.Name]=A.payload.nameToLog?A.payload.nameToLog:"string"===typeof t?Ap.FontUtils.kWd(t)?"*"+t:Ap.FontUtils.tAf(t)?"[EF]":"[MF]":"";Ra[ey.IsPinned]=A.payload.isPinned;Ra[ey.Level]=A.payload.level;this.UHf();break;case "FontPickerFontInfoRequestedPayload":ua.CommandValueId=A.payload.font.name;ua[Ez.a.Trigger]=A.payload.trigger;Ra[ey.Trigger]=A.payload.trigger;Ra[ey.Name]=A.payload.nameToLog;this.UHf();break;case "FontPickerFontPinningPayload":t=A.payload.isPinned;ua.CommandValueId=A.payload.fontKey;
ua[Ez.a.IsPinned]=t;Ra[ey.Name]=A.payload.nameToLog;Ra[ey.Action]=t?"pin":"unpin";Ra[ey.Level]=A.payload.level;this.UHf();break;default:return}break;case "ComboBoxModel":var ub=A.payload.type;switch(ub){case "MenuOpenPayload":case "MenuPopulatePayload":this.nic(A.payload.launcherId,O)&&(aa={},aa[A.payload.launcherId]=t,this.nbb.$_c(aa,Rh.g(A.payload)),this.Ntb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":t=A.payload.newValue;if(!t)return;
t.value?(ua[Hk.a.Value]=t.value,ua[Hk.a.IsFreeForm]=!0):(ua[Hk.a.Value]=t.text,ua.MenuItemId=t.key,ua.CommandValueId=t.commandValueId);"ComboBoxPreviewPayload"===ub&&(aa=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":aa=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(A.payload.type){case "ZeroTermContextMenuClosePayload":t=ob.a.gO(A.payload);for(ub of t)ua[ub]=A.payload[ub];break;default:this.lPc(A.payload,Object(z.a)(this,this.KNo,"updateFlyoutAnchorMenuState"),
O),ua.launcherId=A.payload.launcherId}break;case "InkFlyoutAnchorModel":this.lPc(A.payload,Object(z.a)(this,this.IOo,"updateInkFlyoutAnchorMenuState"),O);ua.launcherId=A.payload.launcherId;break;case "ColorPickerModel":switch(A.payload.type){case "ColorPickerPayload":ua[Nd.Color]=A.payload.selectedColorId;ua.colorRGB=A.payload.color;break;case "ColorPickerPreviewPayload":aa=h.commandPreviewId;ua[Nd.Color]=A.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":aa=h.commandRevertId;
break;default:return}break;case "SpinButtonModel":ua[Ue.a.Number]=A.payload.value;ua[Ue.a.UnitType]=Ad.a.gNa(A.payload.unitType.toLowerCase());ua[Ue.a.Text]=A.payload.reservedValue;break;case "SliderModel":ua[Im.Value]=A.payload.value;break;case "InsertTableModel":ua[bs.a.Rows]=A.payload.rows;ua[bs.a.Columns]=A.payload.columns;break;case "CheckboxModel":ua[Ng.a.On]=A.payload.checked;ua.MenuItemId=h.menuItemId;ua.TerminalParentControlId=A.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.lPc(A.payload,
Object(z.a)(this,this.pQo,"updatePreviewGalleryMenuState"),O)){ua.launcherId=A.payload.launcherId;break}this.LTh(A,b);return;case "DocumentTitleModel":switch(A.payload.type){case "DocumentTitleRenamePayload":ua.getNewDocumentTitle=A.payload.getNewDocumentTitle;break;case "MenuOpenPayload":aa={};aa[A.payload.launcherId]=t;this.nbb.$_c(aa,Rh.g(A.payload));this.Ntb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":ua.MenuItemId=A.payload.url;this.zXm(A.payload.pageId);
break;case "NewBlankDocumentModel":case "CustomTemplateModel":ua.MenuItemId=A.payload.assetId;ua.SourceControlId=b;v.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&(ua.IsPremium=A.payload.isPremium||!1);this.AXm(A.payload.pageId);break;case "CoauthorGallery":ua.RenderTime=A.triggerTime;break;case "PeopleWell":ua.RenderTime=A.triggerTime;break;case "SyncStatus":ua.SourceControlId=b;break;case "InputBoxModel":ua.Text=A.payload.newValue;break;case "PersonaButtonModel":ua.CommandValueId=
A.payload.commandValueId;this.Ufm(A.payload);break;case "MultiActionButtonModel":ua.CommandValueId=A.payload.commandValueId;ua.Href=A.payload.href;ua.Type=A.payload.type;ua.TerminalParentControlId=A.payload.terminalParentControlId;this.I2();break;default:return}aa&&!this.isShadowMenuOpen(A.payload)&&(ua.CommandValueId||(ua.CommandValueId=ua.MenuItemId),h.legacyControlId&&(ua.LegacyId=h.legacyControlId),ua.SourceControlId||(ua.SqmControlId=b),this.Na&&this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&ua.launcherId&&(h=this.Pl.getCommandByExternalUxId(ua.launcherId))&&(ua.launcherCommandId=parseInt(h.commandId)),A.payload&&!Za.c(A.payload.PRIReadinessCheck)&&(ua.PRIReadinessCheck=A.payload.PRIReadinessCheck,this.N8g=!0),A.payload&&!Za.c(A.payload.shouldTakeFocus)&&(ua[vx.a.CSa]=A.payload.shouldTakeFocus),h=this.cXe(A,ua),Za.c(A.triggerTime)||(Ra.TriggerTime=A.triggerTime),A.payload&&!Za.c(A.payload.userActionKey)&&(Ra.userActionKey=A.payload.userActionKey),this.e8f(Ra,A,b,aa),this.rOe.executeCommand(aa,
ua,this.getSelectedTabId(),h,!0,()=>{this.ZKf(ua,b)},Ra,Rh.g(A.payload)))}e8f(b,h,t,A){this.Na&&this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&t&&A&&(t=h.payload&&!Za.c(h.payload.launcherId)?h.payload.launcherId:t,b.ControlId=this.baj(this.jYl(t,A),A,!1));this.Na&&this.Na.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.baj(h.payload.terminalParentControlId,
A,!0))}baj(b,h,t){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;u.ULS.sendTraceTag(510247689,207,15,t?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}jYl(b,h){h=parseInt(h);h=Kf.ActionManager.k6e(h)||Kf.ActionManager.Q$(h)||"";return!Za.c(h)&&h in this.Xoc?this.Xoc[h]:100<b.length?"":b}UHf(){this.Dp&&this.Dp.execute(b=>{b.FHf("ModernFontPickerExperience")})}cXe(b,
h){let t=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(t=b.payload.inputMethod,h[vx.a.ux]=t);return t}ZKf(b,h){const t=Object(Da.a)(vf.AFrame,v.AFrameworkApplication.ta);if(this.Vb&&this.akj(b)){if(!this.Vb.currentScope&&t){let A="null";if(b){const O=b.Value;delete b.Value;A=ob.a.toJSON(b);Za.c(O)||(b.Value=O)}u.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",
h,A,t.l5a)}this.Vb.Sif()}(this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name!==vf.AFrame.jpa&&t&&this.Vb.currentScope.name!==t.l5a||this.akj(b))&&this.HTk(b)}akj(b){return!!b&&!Za.c(b[vx.a.CSa])&&b[vx.a.CSa]}HTk(b){vx.a.ux in b&&1===b[vx.a.ux]&&dF.ShyRibbon.Hdb(1,0)}Ngm(b,h){Rh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.I2();this.Uda.qm();if(this.Lak&&this.ga){const t={};t[FI.a.meg]=h.payload.tabId;this.ga.Rb(ab.a.s3c,
2,t,this.lX(h));Za.c(h.payload.inputMethod)||(this.ga.processAction(ab.a.G7i,2),this.Pud||this.yqo(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.Pl.csf(h);u.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.Dp&&h){const t=h+"TabSwitchActivity";this.Dp.execute(A=>{A.FHf(t)})}}lPc(b,h,t){const A=b.type;return"MenuClosePayload"===A?!0:"MenuOpenPayload"===A?(h(b,t),!0):!1}Ufm(b){b=b.type;"MenuOpenPayload"===b?v.AFrameworkApplication.d8c=!0:"MenuClosePayload"===
b&&(v.AFrameworkApplication.d8c=!1)}gxn(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const t=b.payload.launcherId,A=this.Pl.getCommandByExternalUxId(t);return A&&A.populationProps?((b=this.nbb.MWf(A,h,b.payload))&&t in this.Ntb&&delete this.Ntb[t],b):!1}KNo(b,h){const t=b.launcherId;this.nic(t,h)&&(h=appChrome.selectors.getFlyoutAnchorMenuItems(t),this.olc(h,t,Rh.g(b)))}IOo(b,h){const t=b.launcherId;this.nic(t,h)&&(h=
Rh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(t):appChrome.selectors.getFlyoutAnchorMenuItems(t),this.olc(h,t,Rh.g(b)))}pQo(b,h){const t=b.launcherId;this.nic(t,h)&&(h=appChrome.selectors.getPreviewGalleryMenuItems(t),this.olc(h,t,Rh.g(b)))}fRo(b,h){const t=b.launcherId;this.nic(t,h)&&(h=appChrome.selectors.getSplitButtonMenuItems(t),this.olc(h,t,Rh.g(b)))}lRo(b,h){const t=b.launcherId;this.nic(t,h)&&(h=appChrome.selectors.getStatefulSplitButtonMenuItems(t),this.olc(h,
t,Rh.g(b)))}getSelectedTabId(){return this.Jde?appChrome.selectors.getSelectedTabId():null}olc(b,h,t){this.nbb.$_c(b,t);this.Ntb[h]=new Date}nic(b,h){let t=!0;b in this.Ntb&&(t=this.Ntb[b].getTime()<this.Uda.eoa.getTime());return t&&!h&&this.Jde}LTh(b,h){const t={};var A=b.payload.selectedGalleryId;const O=this.Pl.getCommandByExternalUxId(A);if(O){t.SourceControlId=A;t.MenuItemId=O.menuItemId;t.SqmControlId=h;O.legacyControlId&&(t.LegacyId=O.legacyControlId);b.payload&&!Za.c(b.payload.shouldTakeFocus)&&
(t[vx.a.CSa]=b.payload.shouldTakeFocus);this.O_l(b.payload,t);(A=this.lX(b))||(A={});this.e8f(A,b,h,O.commandId);const aa=this.cXe(b,t);this.rOe.executeCommand(O.commandId,t,this.getSelectedTabId(),aa,!0,()=>{this.ZKf(t,h)},A,Rh.g(b.payload))}}Upl(b,h){const t=this.Pl.getCommandByExternalUxId(h);if(t){const A={};A.SourceControlId=h;A.MenuItemId=h;A.SqmControlId=h;b.payload&&!Za.c(b.payload.shouldTakeFocus)&&(A[vx.a.CSa]=b.payload.shouldTakeFocus);let O=this.lX(b);O||(O={});this.e8f(O,b,h,t.commandId);
const aa=this.cXe(b,A);this.rOe.executeCommand(t.commandId,A,this.getSelectedTabId(),aa,!1,()=>{this.ZKf(A,h)},O,Rh.g(b.payload))}}O_l(b,h){"CharacterGalleryPayload"===b.type&&(h.MenuItemId=b.character)}L9f(b,h){b.payload&&"toggled"in b.payload&&(h[Ng.a.On]=b.payload.toggled)}F3m(b,h){if("MenuOpen"===b){if(this.$Y&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.$Y.onMenuOpen()}else if("MenuClose"===b&&this.$Y)this.$Y.onMenuClose()}I2(){this.$Y&&this.$Y.sQf()}lX(b){let h=null;
Za.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}Tem(b,h,t){if(this.XWj&&this.ga){const A={};A[DI.a.A7d]=t;this.ga.Rb(ab.a.r3c,2,A)}this.olc(h.pageControlIdMap,b,Rh.g(h))}AXm(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(ab.a.L7i,2);break;case "FileNewPage":this.ga.processAction(ab.a.M7i,2)}}zXm(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(ab.a.o7i,2);break;case "FileOpenPage":this.ga.processAction(ab.a.p7i,2)}}isShadowMenuOpen(b){return!!b&&
"MenuOpenPayload"===b.type&&b.isShadowRendering}yqo(b){if(v.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.Dp.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",null)}),this.Pud=!0;else{if(v.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.Dp.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.xek)){this.Pud=!0;return}v.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(ab.a.ZNb,
2)&&(this.Pud=!0)}}rOk(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.N8g&&appChrome.PRIToastManager.dismissToast()}}Object(m.a)($I,"ReactExecuteCommandHandler",null,[]);class aJ{constructor(){this.fileMenu=null}get ppb(){return 0}get o3a(){return 0}get EFa(){return!1}Qxa(){}ntj(){}PZ(){return!1}Tej(){}W2(){return!1}oIa(b){return this.fileMenu&&this.fileMenu.HRa(b)?!0:!1}get via(){return!1}hnb(){}uWd(){return!1}get wEd(){return null}set wEd(b){}Gea(){}zaa(){}ctf(){return null}HNa(){}refresh(){}get controls(){return null}Qfc(){return!1}Ydb(){}qm(){}get eF(){return null}set eF(b){}f$c(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(m.a)(aJ,"ReactRibbonExternal",null,[671,634,672]);class bJ{constructor(b,h,t,A){this.Vb=b;this.ga=h;this.Chh=t;this.sXb=A}initialize(){this.ga.pa(ab.a.Z3c,yc.a.frame,Object(z.a)(this,this.O9i,"ribbonMoveForwardAction"));this.ga.pa(ab.a.Y3c,yc.a.frame,Object(z.a)(this,this.N9i,"ribbonMoveBackwardAction"));this.ga.pa(ab.a.Ice,yc.a.frame,Object(z.a)(this,this.K9i,"ribbonEscAction"));var b=hs.a.EUd(this.sXb,null,this.Chh,!1);b.zH=!0;this.Ofc(b,ab.a.Z3c,ab.a.Y3c);b.bindAction(sb.KeyInputManager.mc(rc.a.qIa,
0),ab.a.Ice);b=this.Vb.fe(vf.AFrame.jpa);b.zH=!0;this.Ofc(b,ab.a.g_a,ab.a.g_a);Ud.a.instance.mb(db.a.yx,this.Chh,Object(z.a)(this,this.umn,"onRibbonMouseDown"));b=ej.a.instance;Rh.a("enterKeytipMode")&&b.Ydo(this.sXb,()=>{appChrome.api.enterKeytipMode(!1)});Rh.a("exitKeytipMode")&&b.Udo(this.sXb,()=>{appChrome.api.exitKeytipMode();dF.ShyRibbon.Hdb(1,0)});v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.Una&&(b=Object(Da.a)(yd.FocusManager,this.Vb))&&b.Iqk(Object(z.a)(this,this.Khn,"onFocusScopeChanged"))}Khn(b,
h){if((b=Object(Da.a)(vf.AFrame,v.AFrameworkApplication.ta))&&h.oKi&&v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.Una){const t=appChrome.selectors.getShyState();t.isActive&&h.oKi.name===b.l5a&&dF.ShyRibbon.Hdb(t.state,1)}}O9i(){return 4}N9i(){return 4}K9i(){Rh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.Una&&appChrome.selectors.getShyState().isActive&&dF.ShyRibbon.Hdb(1,0),this.Vb.mg(vf.AFrame.$n));return 4}Ofc(b,h,t){const A=
sb.KeyInputManager.mc(rc.a.iw,0),O=sb.KeyInputManager.mc(rc.a.iw,4);b.Xq(A);b.Xq(O);b.bindAction(A,h);b.bindAction(O,t)}umn(b){b.Ib&&b.Ib.target&&"input"!==b.Ib.target.tagName.toLowerCase()&&b.Ib.preventDefault();return!1}dispose(){this.ga.$u(ab.a.Z3c,yc.a.frame,Object(z.a)(this,this.O9i,"ribbonMoveForwardAction"));this.ga.$u(ab.a.Y3c,yc.a.frame,Object(z.a)(this,this.N9i,"ribbonMoveBackwardAction"));this.ga.$u(ab.a.Ice,yc.a.frame,Object(z.a)(this,this.K9i,"ribbonEscAction"))}}Object(m.a)(bJ,"ReactRibbonFocusManager",
null,[9]);class YB{constructor(b,h,t,A,O,aa,ua,Ra=null,ub=!0,Nb=null,Yb=null){this.X9a=this.Tvd=this.Ote=this.Uda=null;this.Gbh=[];this.Qrd=null;this.CLa=b;this.mIe=h;this.sXb=t;this.Vb=A;this.ga=O;this.Pl=aa;this.Uda=Nb?Nb:new EF(pv.instance,this.Pl);this.Buc=ua;this.U$g=new aJ;this.DLa=Ra;this.aQe=ub;new YI;this.zRg=Yb;rk.a.get_instance().Vk(7,Object(z.a)(this,this.kfo,"setRibbonPostInteractiveReady"));rk.a.get_instance().Vk(7,Object(z.a)(this,this.n0m,"logRibbonLoadedActivity"));rk.a.get_instance().Vk(19,
Object(z.a)(this,this.cWm,"logAppLoadedActivity"));v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&rk.a.get_instance().Vk(7,Object(z.a)(this,this.MQn,"registerSubComponentReporting"));rk.a.get_instance().Vk(7,Object(z.a)(this,this.$Fn,"queueSettingsDependentActions"))}initialize(b,h,t=null){this.aQe||this.WK(5);t?t.then(()=>{this.C6i()}).catch(()=>u.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):
XI.a.H8c(XI.a.H8c(nd.Task.WAA(this.pCi(b),this.oCi(YB.VSj)),()=>this.oCi(YB.mPj)),()=>this.pCi(h)).continueWith(()=>{this.C6i()},11)}dispose(){this.cJo();this.X9a&&this.X9a.NOh();this.Qrd&&this.Qrd.dispose();for(const b of this.Gbh)rk.a.get_instance().EQk(b);v.AFrameworkApplication.xa.$u(ab.a.BYn,yc.a.frame,Kf.ActionManager.Kf)}oCi(b){return Sa.a.instance.resolve("Common.ISharedDependencyLoader").Jbc(v.AFrameworkApplication.qy(b,2))}pCi(b){return""===b?nd.Task.F7(!0):Sa.a.instance.resolve("Common.ISharedDependencyLoader").Jbc(v.AFrameworkApplication.qy(b,
3))}Nrm(){(this.DLa||this.Buc)&&appChrome.api.dispatch(this.Oei());this.hho();Rh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(v.AFrameworkApplication.I4);this.Uda.qm()}C6i(){this.Nrm();this.aQe&&(appChrome.renderAppChrome(this.CLa,Rh.e()),this.WK(10));this.Ljh();this.y2e();this.aQe&&this.WK(5);this.Jmi()}Jmi(){this.Vb&&this.ga&&this.sXb&&(this.Qrd=new bJ(this.Vb,this.ga,this.CLa,this.sXb),this.Qrd.initialize())}get W3c(){return this.U$g}setCommandDefinitionMapping(){if(Rh.a("setCommandDefinitionMapping")){const b=
GM(this.Pl);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.Una&&Rh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.Uec()})}Ljh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(Da.a)(EF,this.Uda);this.Ote=new $I(this.Uda,b.Lfc,this.Pl,this.Vb,this.mIe,Sa.a.instance.Ma("Common.IRibbonSQMInformation"),Sa.a.instance.Ma("Common.IFileMenuSQMInformation"),
v.AFrameworkApplication.xa,v.AFrameworkApplication.K,Sa.a.instance.Sa("Common.ISystemInitiatedFeedback"),null);this.jDk();this.Rdm()}jDk(){this.Tvd=appChrome.api.bindCommandHandler((b,h)=>{this.Ote.executeCommand(b,h)})}cJo(){this.Tvd&&(this.Tvd(),this.Tvd=null)}hho(){appChrome.api.initializeLogger(new Am.a)}ZDa(){return this.Uda?this.Uda.ZDa():[]}Uec(){Fq.a.instance.he(()=>{let b=null;Fq.a.instance.he(()=>{b=this.ZDa()},"RB:GA");b&&0<b.length&&(this.Uda.eoa=new Date,Fq.a.instance.he(()=>{appChrome.api.dispatch(b)},
"RB:DA"));this.X9a&&Fq.a.instance.he(()=>{this.X9a.uWi()},"RB:J")},"RB:PFSU")}q$c(){this.Uda.q$c()}pJb(){}hjk(b){b=[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}Oei(){var b=v.AFrameworkApplication.K;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Sa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>
{t.isFeatureEnabled("ConnectedServices",!0).then(A=>{A&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.J4h());b=new HM.a(this.Pl);this.DLa.AG&&(IM.a.fGo(this.DLa.AG),h.push.apply(h,b.fMd(this.DLa.AG)));if(this.DLa.lvj)for(const t of this.DLa.lvj)h.push(appChrome.actions.updateGallerySectionHiddenState(t.xZh,t.Aep,t.Dgp));h.push.apply(h,b.z_h(this.DLa.pvj));
return h}J4h(){const b=[];if(this.Buc&&this.Buc.AG){const t=this.Buc.AG;for(let A in t){var h=t[A];const O=this.Pl.znf(A);if(O)for(let aa of O)b.push(appChrome.actions.updateControlHiddenState(aa,h))}}return b}lIa(b){b&&this.Uda.Lfc.$_c(b,0)}MWf(b){this.Uda.Lfc.MWf(this.Pl.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}jhl(){const b=v.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=v.AFrameworkApplication.K.appSettings;h&&appChrome.api.dispatch(this.aRo(b,
"Shared"===(h.SharingStatus||"")))}$Fn(){v.AFrameworkApplication.K.Wo(()=>{this.jhl()})}aRo(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}WK(b){rk.a.get_instance().WK(b);this.Gbh.push(b)}kfo(){Rh.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new WI,{postRibbonInteractiveReady:!0})))}y2e(){this.Buc&&this.zRg&&(this.X9a=this.zRg.e9e(),this.U$g.fileMenu=this.X9a)}eQm(b,h){this.X9a&&this.X9a.OAi(b,h)}m5f(b,
h,t){if(1===t)return 32;this.Agj(!0);this.Uec();v.AFrameworkApplication.ta.updateCommandUI();return 32}n5f(b,h,t){if(1===t)return 32;this.Agj(!1);this.wfo();this.Uec();v.AFrameworkApplication.ta.updateCommandUI();return 32}fhg(b,h,t){if(1===t)return 32;(b=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback"))&&b.execute(A=>{A.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}wfo(){dc.a.ASa(v.AFrameworkApplication.K.kb("IsSimplifiedRibbonOnCookieName"),"true",dc.a.AQa)}Agj(b){dc.a.ASa(v.AFrameworkApplication.K.kb("ReactRibbonMLRPreferenceCookieName"),
b.toString(),dc.a.AQa)}n0m(){if(v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.rq){const b=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(b.execute(h=>{h.logActivity("SingleRibbonModeActivity",null)}),v.AFrameworkApplication.moa("d79fg304;61jba833;h856e313;f5i2f477")):"Multiline"===appChrome.selectors.getRibbonMode()&&(b.execute(h=>{h.logActivity("MultiRibbonModeActivity",null)}),v.AFrameworkApplication.moa("69a7h198;dfd7j584"));
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&Sa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFreemiumUpsellEnabled()&&v.AFrameworkApplication.moa("5fjej882;e0jjh200")})}}cWm(){this.ga.pa(ab.a.fhg,yc.a.frame,Object(z.a)(this,this.fhg,"triggerModeSwitcherTUI"));const b=dc.a.Jfa(v.AFrameworkApplication.K.kb("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const h=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");
h&&(v.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?(h.execute(t=>{t.logActivity("VNextStylesOn",null)}),h.execute(t=>{t.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):v.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&b&&h.execute(t=>{t.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}MQn(){rk.a.get_instance().Vk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const b=appChrome.api.getRibbonSubComponentMappings();
for(let t in b){var h=t;const A=b[t];if(A)for(const O of A)v.AFrameworkApplication.xa.VZ(O)?appChrome.api.reportRibbonSubComponentBehaviorMapped(h):v.AFrameworkApplication.xa.Rdo(O,this.O5k(h));else appChrome.api.reportRibbonSubComponentBehaviorMapped(h)}}O5k(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}Rdm(){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Rh.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&v.AFrameworkApplication.Iec.jWe){const b=v.AFrameworkApplication.Iec.jWe,h=v.AFrameworkApplication.Iec.jjh;h.payload||(h.payload={});const t=h.payload.launcherId?h.payload.launcherId:b;YB.Q9i.ob(t)?YB.Q9i.J(t)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():(h.payload.PRIReadinessCheck=!0,this.Ote.executeCommand(b,h))}}}YB.VSj="common";YB.mPj="appChrome";YB.Q9i=new FM.a(Pa.a.ROc());
Object(m.a)(YB,"ReactRibbonUser",null,[265,254,9]);class OG extends YB{constructor(b,h,t,A,O,aa,ua,Ra,ub=null,Nb=!0,Yb=null,bc=null){super(b,h,A,O,aa,ua,Ra,ub,Nb,Yb,bc);this.aid=null;this.ysb=t;this.ysb.execute(Dc=>{this.aid=Dc});this.ysb.execute(Dc=>{this.Uda.eF=Dc})}ZDa(){return this.aid?(this.aid.clearCache(),super.ZDa()):[]}pJb(b){if(!b)throw Error.argumentNull();this.ysb.execute(h=>{b.eF=h})}}Object(m.a)(OG,"ReactRibbonUser",YB,[]);var KM=c(992);class eF extends OG{constructor(b,h,t,A,O,aa,ua,
Ra,ub,Nb=!0,Yb=null,bc=null){super(h,b.bma,A,Hh.AppFrame.upa,O.tg,O.rc,ua,Ra,ub,Nb,Yb,bc);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.lBe=b;this.C$=aa;O.NTa(()=>{this.KQo();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?rk.a.get_instance().Vk(7,()=>{this.Ami()}):this.Ami()},null)}get Zzf(){return!!v.AFrameworkApplication.K.appSettings.BootActivityNavigationId}Ami(){this.V3k();this.e9e();this.yNn()}KQo(){this.CLa.classList.add("FlexBoxLayout");
this.lBe.Dma().classList.add("cui-exth");this.lBe.Dma().classList.add("FlexBoxLayout");this.lBe.Dma().classList.add("ScrollableRibbon")}V3k(){v.AFrameworkApplication.tX||this.V7k()}V7k(){if(!v.AFrameworkApplication.tX){var b=(new NI(eF.Jak,this.C$)).Qol(),h=hs.a.EUd(Hh.AppFrame.TOa,null,b,!0);h.zH=!0;this.Ofc(h,ab.a.Z3c,ab.a.Y3c);h.bindAction(sb.KeyInputManager.mc(rc.a.qIa,0),ab.a.Ice);mD.a(1,()=>{this.PWn(b)})}}PWn(b){const h=new UI;appChrome.renderSharedHeader(b,h.Uma()).then(this.Ncf.bind(this))}p4i(){v.AFrameworkApplication.ta.Ob.nxi?
appChrome.getHeaderApi().then(b=>{document.getElementById(v.AFrameworkApplication.Dfb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new KM.a).Ncf()}Ncf(){this.Zzf&&v.AFrameworkApplication.moa("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.Zzf&&v.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(rk.a.get_instance().Vk(12,this.p4i.bind(this),11),u.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):
this.p4i()}Ofc(b,h,t){const A=sb.KeyInputManager.mc(rc.a.iw,0),O=sb.KeyInputManager.mc(rc.a.iw,4);b.Xq(A);b.Xq(O);b.bindAction(A,h);b.bindAction(O,t)}e9e(){const b=!!this.DLa&&"FileMenu"in this.DLa.pvj;v.AFrameworkApplication.ta.Ob.KPa&&!b&&mD.a(1,this.oWn.bind(this))}oWn(){const b=[];if(v.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=[Object.assign(new MG,{label:CommonUIStrings.L_DiagnosticsSessionId,value:v.AFrameworkApplication.userSessionId}),Object.assign(new MG,
{label:CommonUIStrings.L_DiagnosticsBuild,value:v.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",h))}b.push.apply(b,this.J4h());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}yNn(){this.ga.pa(ab.a.$Sa,mc.a.view,this.$Sa.bind(this));this.ga.pa(ab.a.m5f,mc.a.view,this.m5f.bind(this));this.ga.pa(ab.a.n5f,mc.a.view,this.n5f.bind(this))}activateRibbonTab(b){this.hjk(b)}Uec(){rk.a.get_instance().isCompleted(7)&&
this.aid&&(Ok.a.mark(4893),mw.a.oQo(),super.Uec(),Ok.a.mark(4894))}$Sa(b,h,t,A,O){if(2===O[vx.a.ux]){if(t=Object(Da.a)(lw.a,h))A=Object(Da.a)(qx.a,t.view);else return u.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(h),b,ob.a.join(O," ",":")),8;if(A&&""!==A.GI)Po.a.vga(h)&&Po.a.l$b()||(this.Vb.mg(A.GI),appChrome.selectors.getShyState().isActive&&dF.ShyRibbon.Hdb(0,1));else return u.ULS.sendTraceTag(38549529,
338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(t.view),b,ob.a.join(O," ",":"),this.oTl(t.view)),8}return 32}oTl(b){return b?"is ContentEditableView: "+b.Pj+" is Editing View: "+b.Uva+" is HtmlView: "+b.j2a+" is InteractiveView: "+b.re+" is NavigationPaneView: "+b.ZFm+" is PageView: "+b.Yi+" is WordNavigationPaneHeadingsView "+b.yZd:"null view"}}eF.Jak="WACRibbon";Object(m.a)(eF,"ReactRibbonUser",
OG,[264,265,254,9]);class cJ extends eF{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc=null,jd,Cd){super(b,h,t,A,O,aa,ua,Ra,ub,!1,Nb,Pc);this.Yuk=()=>{this.Dp&&this.Dp.execute(ee=>{ee.logActivity("WordShyRibbon",null)});return 32};this.arm=()=>{bi.a.instance.Rf(yh.a.msm,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(ee=>{var Od;this.DLa&&ee.push.apply(ee,this.Oei());(this.uch||this.vch)&&this.Pbb&&ee.push.apply(ee,this.tHl());ee.push(appChrome.actions.setControlCustomTooltip(dr.a.LQm,
CommonUIStrings.l_LoopsLearnMoreTooltip));v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.Una&&this.Cio();var fe=null===(Od=v.AFrameworkApplication.K)||void 0===Od?void 0:Od.kb("ReactShyRibbonPreferenceCookieName");Od=dc.a.get(fe);v.AFrameworkApplication.K.$("IsO365ConsumerHost")&&appChrome.api.isSmallDevice()&&!appChrome.api.isVerySmallDevice()&&v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.ZI&&""===Od&&v.AFrameworkApplication.ye("66h8i182;1ha8c781");ee.push.apply(ee,this.ZDa());
ee.push(appChrome.actions.setControlBehaviorAttached(!0));const Ee=Sa.a.instance.resolve("WordEditor.IModeSwitcherControl");Od=Ee.SSl();v.AFrameworkApplication.ye("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(fe=appChrome.selectors.getModeSwitcherMode())&&fe!==Od.activeMode&&u.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${Od.activeMode}, Actual: ${fe}`);
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(fe=hs.a.EUd(ps.a.Ymj,null,document.getElementById("WACToolbarContainer"),!1),fe.zH=!0,this.hJn(fe,ab.a.Z3c,ab.a.Y3c));"Suggest"===Od.activeMode||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===Od.activeMode?appChrome.getUpdateAppModeAndTabsActions(Od,!0).then(re=>{appChrome.api.dispatch(ee.concat(re));Ee.eHi();
this.Omi()}):(ee.push(appChrome.actions.updateModeSwitcher(Od)),appChrome.api.dispatch(ee),Ee.eHi(),this.Omi())})};this.Pbb=Yb;this.uch=bc;this.vch=Dc;this.Dp=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");this.Gb=jd;this.Bze=Cd}lsm(){u.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");rk.a.get_instance().WK(5);const b=this.Zzf&&v.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?12:10;rk.a.get_instance().Vk(b,this.arm,11);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",
!1)&&this.Ymk()}Ymk(){this.Gb.Wb(new Vb.a(5,1,0,()=>{this.Bze.execute(b=>{b.ueo()})}))}tHl(){const b=[];this.uch&&(b.push(appChrome.actions.setButtonSecondaryText(dr.a.qGd,this.Pbb.Zkm)),b.push(appChrome.actions.setButtonSecondaryText(dr.a.LEd,this.Pbb.Ykm)),b.push(appChrome.actions.setButtonSecondaryText(dr.a.e8d,this.Pbb.$km)));this.vch&&b.push(appChrome.actions.setButtonSecondaryText(dr.a.b8d,this.Pbb.alm));return b}Cio(){this.Dp&&appChrome.api.isSmallDevice()?this.Dp.execute(b=>{b.logActivity("ShyRibbonSmallScreenActivity",
null)}):this.Dp.execute(b=>{b.logActivity("ShyRibbonNormalScreenActivity",null)});v.AFrameworkApplication.xa.gb(ab.a.qoh,yc.a.frame,this.Yuk,96)}hJn(b,h,t){const A=sb.KeyInputManager.mc(rc.a.iw,0),O=sb.KeyInputManager.mc(rc.a.iw,4);b.Xq(A);b.Xq(O);b.bindAction(A,h);b.bindAction(O,t)}Omi(){v.AFrameworkApplication.Iec.bJo();this.Ljh();this.y2e();this.Jmi();rk.a.get_instance().WK(7);bi.a.instance.Vka(yh.a.eDc,yh.a.R1n,(new Date).getTime())}lIa(b){if(b){const h=this.K5h();try{super.lIa(b)}finally{null===
h||void 0===h?void 0:h.dispose()}}}ZDa(){const b=this.K5h();try{return super.ZDa()}finally{null===b||void 0===b?void 0:b.dispose()}}K5h(){var b;let h=void 0;const t=null===(b=Jb.App.jk)||void 0===b?void 0:b.Kl;t&&(h=new Te.GraphTransaction(Jb.App.rsi()&&Jb.App.lBf?0:2),h.set(t));return h}}Object(m.a)(cJ,"ReactRibbonUser",eF,[]);class dJ extends JG{constructor(b,h,t,A,O,aa,ua,Ra){super(b,h,t);this.aEe=v.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&ba.a.y3;this.Pl=O;this.UMe=aa;this.Gb=
ua;this.Bze=Ra}g7k(b,h){const t=new hE(v.AFrameworkApplication.K,this.ga,this.Vb,this.aEe),A=new CM.a(t);return this.D7k(b,h,A,t)}D7k(b,h,t,A){var O=new LI(new MI(v.AFrameworkApplication.K,A),t);t=this.Jrm(O);const aa={};O.Cnb(aa);O=!ba.a.y3;const ua=ba.a.qq||ba.a.jj;var Ra=ba.a.Yk;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(Ra=ba.a.si||Ra);Ra=new YH.a(Ra);b=new cJ(b,h,WordEditorIntl.WordEditorStrings,this.ysb,A,b,this.Pl,t,new HI(aa),this.UMe,Ra,O,ua,new KI,this.Gb,this.Bze);
b.lsm();return b}Jrm(b){const h={};b.y5c(h);b.E$c(h);return new II(null,h,"jewelWordEditor")}}Object(m.a)(dJ,"WordEditorRibbonUserFactory",JG,[]);class PG{constructor(b,h){this.Ez=b;this.aod=h}NNa(b,h,t,A=null,O=null){return this.aod.Kjj(b)?this.aod.NNa(b,h,t,A,O):this.Ez.NNa(b,h,t,A,O)}gFa(b,h=null){return this.aod.Kjj(b)?this.aod.gFa(b):this.Ez.gFa(b,h)}}Object(m.a)(PG,"RootCuiUser",null,[119]);class eJ extends PG{constructor(b,h){super(b,h)}clearCache(){this.Ez.clearCache()}}Object(m.a)(eJ,"WordGeneralCuiUser",
PG,[118,119]);var LM=c(1451);class TF{static getSelectedText(){const b=(new Jl.a).urf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static bQd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=F.a.Yy(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}}Object(m.a)(TF,"SearchUtils",null,[]);class Jz extends HF{constructor(b,h,t){super(b,t);this.TH=h}Hkf(b){const h=[],t=he.a.instance.hb.lb,A=!!this.TH&&this.TH.eUc(qa.a.k4e.toString()),O=!!this.TH&&this.TH.eUc(qa.a.mLb.toString()),
aa=!A&&!t.Z1a&&Jz.z5a.uHi(),ua=!!this.TH&&this.TH.eUc(ab.a.newComment.toString())||!!kj.a.instance&&(3===kj.a.instance.mode||2===kj.a.instance.mode),Ra=t.bxi()&&v.AFrameworkApplication.ta.Ob.XTc;var ub=!1;if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1)){ub=!!t&&(t.Sx||2===t.length&&nf.SelectionEditor.Dk(t.Rc));var Nb=TF.getSelectedText();ub=ub&&0<Nb.length&&60>Nb.length}b=(Nb=3===b||ba.a.si||v.AFrameworkApplication.xjf)&&
Jz.nef.f_(t,b);Nb&&h.push(this.Pl.LDa("ClipboardGroup")[0].externalUxGroupId);aa&&(h.push(this.Pl.LDa("TextFormattingGroup")[0].externalUxGroupId),h.push(this.Pl.LDa("StylesGroup")[0].externalUxGroupId));ub&&h.push(this.Pl.LDa("DefineGroup")[0].externalUxGroupId);A&&h.push(this.Pl.LDa("PictureToolsGroup")[0].externalUxGroupId);O&&h.push(this.Pl.LDa("TableToolsGroup")[0].externalUxGroupId);Ra&&h.push(this.Pl.LDa("EquationToolsGroup")[0].externalUxGroupId);ua&&h.push(this.Pl.LDa("CommentGroup")[0].externalUxGroupId);
b&&h.push(this.Pl.LDa("ContextMenuGroup")[0].externalUxGroupId);LM.a.$qi&&h.push(this.Pl.LDa("DesignerGroup")[0].externalUxGroupId);return h}static get nef(){return null!=Jz.Cug?Jz.Cug:Jz.Cug=Sa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get z5a(){return null!=Jz.QCg?Jz.QCg:Jz.QCg=Sa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static $Qc(b,h,t,A){b.fDk(()=>Jz.$db(h,t,A))}static $db(b,h,t){return new Jz(b,h,t)}}Object(m.a)(Jz,"WordReactFloatie",HF,[]);class QG{constructor(){this.jda=
this.sAc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;this.W.resolve("WordEditor.UI.BusinessBarController").gWf();const h=Jb.App.Ov.tI,t=Jb.App.ya;Jz.$Qc(t,this.W.resolve("Common.IReactContextualUILauncher"),h,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));this.jda=this.W.Ma("Box4.IContextMenuController");const A=new XH(t,h,this.W.Sa("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),O={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,
"floatie.gbUseSmartPasteButton":!0};switch(null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:O["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:O["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:O["floatie.gbUseSmartPasteButton"]=!1}A.$Qc("PasteFloatieData",null,O);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();(new yI(t,h,this.W.Sa("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).$Qc("ExternalContentFloatieData",
[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");rk.a.get_instance().Vk(7,()=>{this.sAc=this.W.resolve("WordEditor.UI.StatusBarUser");this.sAc.Ub()})}dispose(){this.sAc&&(this.sAc.dispose(),this.sAc=null);this.jda&&(this.jda.dispose(),this.jda=null)}yc(b){this.W=b;b.ha("WordEditor.UI.BusinessBarController",()=>new bI(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),v.AFrameworkApplication.xa,v.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").singleInstance();
let h=ba.a.Yk;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=ba.a.si||h);b.ha("Box4.UI.ShortcutHintMapping",()=>new YH.a(h));const t=ba.a.qq||ba.a.jj,A=v.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(ba.a.y3||t),O=v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");b.ha("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new Ms(Sa.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Sa.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new If.a)).singleInstance();
b.ha("WordEditor.UI.EditSurfaceContextMenu",()=>new Ep(v.AFrameworkApplication.xa,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),b.resolve("Box4.Proofing.IErrorRangeEditor"),v.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,O?b.Sa("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),
b.Ma("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),b.Sa("Box4.IPresenceDataManager"),b.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Sa("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),
A,t?b.resolve("Box4.UI.ShortcutHintMapping"):null,Sa.a.instance.Sa("Common.IActionContextProvider"),Sa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Ma("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").singleInstance();b.ha("Box4.ISelectionContextMenuProvider",()=>new Gz).singleInstance();b.ha("WordEditor.UI.CuiActionBridge",()=>new jm(v.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").singleInstance();
b.ha("WordEditor.UI.DialogFactory",()=>new xI).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").singleInstance();b.ha("Common.NonCanvasCuiUser",()=>new wD(yd.FocusManager.instance())).as("Common.INonCanvasCuiUser").singleInstance();b.ha("WordEditor.UI.WordGeneralCuiUser",()=>new eJ(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).singleInstance();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.StatusBarUser",()=>new CI(Jb.App.ya.edg,b.Sa("Box4.IGeneralCuiUser"),
b.resolve("Box4.IFeatureHelper"),v.AFrameworkApplication.xa,v.AFrameworkApplication.K,Jb.App.ya)).as("WordEditor.IStatusBarUser").singleInstance();b.ha("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new aF).singleInstance();const aa=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("CommandUI.ReactRibbonRoot",()=>new EF(pv.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),aa)).singleInstance();const ua=b.Sa("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.WordEditorRibbonUserFactory",
()=>new dJ(ua,v.AFrameworkApplication.xa,yd.FocusManager.instance(),b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),v.AFrameworkApplication.oc,b.Sa("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").singleInstance();b.ha("WordEditor.UI.ReactLanguageDialog",()=>new bF(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");
b.ha("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new GI(v.AFrameworkApplication.xa)).as("Common.IRibbonSQMInformation").singleInstance();b.ha("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new EI(v.AFrameworkApplication.xa)).as("Common.IFileMenuSQMInformation").singleInstance();b.ha("WordEditor.UI.RulerUser",()=>new zI).as("WordEditor.IRulerUser");b.ha("WordEditor.UI.RulerContextMenu",()=>new MC(v.AFrameworkApplication.xa,Sa.a.instance.Sa("Common.IZoomManager"),hi.a.instance)).as("WordEditor.IRulerContextMenu").singleInstance();
b.ha("Common.IReactContextualUILauncher",()=>new TH(b.resolve("CommandUI.ReactRibbonRoot"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).singleInstance();b.ha("Box4.IContextMenuController",()=>new ZH(b.resolve("Common.IReactContextualUILauncher"))).singleInstance()}static main(){v.AFrameworkApplication.ye("5b6i5792;30d4f535");No.instance.DRh();No.instance.Xef();P.a.instance.Gc(new QG,6)}}Object(m.a)(QG,"WordEditorUIPackage",null,[1,2]);var MM=window.ExternalContentFloatieData={name:"CommandUI",
attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",
attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",
QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},gD={};gD.rmc=function(){function b(){return ua()&&(jd()||3<=(bc()?Cd("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}
function t(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function A(Jf){Jf=(new RegExp(Jf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Ki=-1;null!=Jf&&2<=Jf.length&&(Ki=parseFloat(Jf[1]),isNaN(Ki)&&(Ki=-1));return Ki}function O(){fJ||(fJ=!0,gJ=A("Windows Phone"));return 8<=gJ}function aa(){return"function"==typeof navigator.msLaunchUri&&!t()&&!Pc()&&!Ra()}function ua(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Ra(){return 0<=window.navigator.userAgent.indexOf("Edge/")}
function ub(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Nb(){return ub()?8==window.document.documentMode:!1}function Yb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function bc(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Dc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Pc(){var Jf=window.navigator.userAgent.toLowerCase();return 0<=Jf.indexOf("android")&&
0<=Jf.indexOf("chrome")}function jd(){return 3<=(Yb()?Cd("firefox/"):0)}function Cd(Jf){var Ki=window.navigator.userAgent.toLowerCase(),ak=Ki.indexOf(Jf);return 0<=ak?parseInt(Ki.substring(ak+Jf.length,Ki.length)):0}function ee(Jf,Ki,ak,el,np){if(el&&null!=Ki)Ki();else if(aa())navigator.msLaunchUri(Jf,Ki,ak);else if(!(Dc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&ua())||Ra())fe(Jf,Ki,ak);else if(Dc()&&np)a:{try{window.open(Jf,
"_self")}catch($s){null!=ak&&ak();break a}null!=Ki&&Ki()}else Od(Jf,Ki,ak)}function Od(Jf,Ki,ak){var el=document.getElementById("OICLinkTag");null==el&&(el=document.createElement("a"),el.id="OICLinkTag",el.style.visibility="hidden",el.href="",0==(gr.Options&fy.SupportsTopTargetNavigation)||gr.NoBrowserModalDialogs?el.target="_blank":el.target="_top",document.body.appendChild(el),null!=el.addEventListener&&el.addEventListener("click",function(np){null!=np.stopPropagation&&np.stopPropagation()},!1));
try{el.href=Jf,el.dispatchEvent(new MouseEvent("click"))}catch(np){null!=ak&&ak();return}null!=Ki&&Ki()}function fe(Jf,Ki,ak){var el=document.getElementById("OICFrame");null==el&&(el=document.createElement("iframe"),el.className="ObjectInDialog",el.style.visibility="hidden",el.src="about:blank",document.body.appendChild(el),el.id="OICFrame");try{el.contentWindow.location.href=Jf}catch(np){null!=ak&&ak();return}null!=Ki&&Ki()}function Ee(Jf){return 0!=(Jf.Options&fy.SkipProtocolHandler)||Nb()}function re(Jf){return Jf===
hD.ReadOnly||Jf===hD.ReadWrite}function Fg(Jf,Ki,ak,el){var np;try{var $s=new ActiveXObject("SharePoint.OpenDocuments.4");return(np=$s.ViewDocument3(window.self,Jf,Ki,el))?(kE(ZB.O14ActiveX),qq.None):qq.Failed}catch(ss){}if(fy.O14Only===(ak&fy.O14Only))return gr.DescriptiveUnattemptedEnums?qq.O14AttemptFailure:qq.Unattempted;try{return $s=new ActiveXObject("SharePoint.OpenDocuments.3"),(np=$s.ViewDocument3(window.self,Jf,Ki,el))?(kE(ZB.O12ActiveX),qq.None):qq.Failed}catch(ss){}if(fy.O12UpOnly===(ak&
fy.O12UpOnly))return gr.DescriptiveUnattemptedEnums?qq.O12UpOnlyFail:qq.Unattempted;try{return $s=new ActiveXObject("SharePoint.OpenDocuments.2"),(np=re(Ki)?$s.ViewDocument2(window.self,Jf,el):$s.EditDocument2(window.self,Jf,el))?(kE(ZB.O11ActiveX),qq.None):qq.Failed}catch(ss){}return gr.DescriptiveUnattemptedEnums?qq.ActiveXUnattempted:qq.Unattempted}function Gg(Jf,Ki,ak,el,np){Jf==$r.Visio&&ak==hD.ReadWrite&&(ak=hD.WriteOnly);el=el||t()&&!O();if(!el){el="";if(Jf==$r.PowerPoint){Jf=el;el=gr.DocumentExtension;
ak=re(ak);var $s=new Set([".pot",".potm",".potx"]),ss=new Set([".pps",".ppsm",".ppsx"]);ak=ak&&$s.has(el)?"nft|ofc|":ak&&ss.has(el)?"ofv|ofs|t|":!ak&&ss.has(el)?"ofe|ofs|t|":ak?"ofv|ofc|":"ofe|";ak=Jf+ak}else ak=re(ak)?el+"ofv|ofc|":el+"ofe|";el=ak;gr.NewTelemetryDataIsEnabled&&(ak=gr.SessionOrigin?"or|"+gr.SessionOrigin:"",ak+=gr.ClickTime?"ct|"+gr.ClickTime:"",ak+=gr.CorrelationId?"cid|"+gr.CorrelationId:"",np+=An(ak));np+=An(el+"u|")}np+=An(Ki);Ki=window.location.href;ak=Ki.toLowerCase().indexOf("&wdlor=");
-1!=ak?(ak+=7,Jf=Ki.indexOf("&",ak),Ki=-1==Jf?Ki.substr(ak):Ki.substring(ak,Jf)):Ki=void 0;if(null!=Ki&&"undefined"!=typeof Ki){ak="";try{ak=decodeURIComponent(Ki)}catch(lE){}0<ak.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(ak)&&(np=np+"|f|"+ak)}return np}function bm(Jf,Ki,ak,el,np,$s){var ss=hJ(Jf);if(null==ss)return ED(gr.DescriptiveUnattemptedEnums?qq.ProtocolHandlerIsNull:qq.Unattempted,gr.Application),!1;Jf=Gg(Jf,Ki,ak,el,ss);ee(Jf,Zr,Av,np,$s);return!0}function An(Jf){if(ua()&&
Dc()){var Ki="";try{Ki=decodeURI(Jf)}catch(ak){}if(Ki==Jf)return encodeURI(Jf)}return Jf}function Zr(){kE(ZB.ProtocolHandler)}function Av(){gr.Options|=fy.SkipProtocolHandler;iJ(gr,mE,nE)}function KA(){null!=RG&&RG(ZB.RoamingProtocolHandler)}function LA(){null!=SG&&SG(qq.ControlNeeded)}function AD(){var Jf=document.getElementById("npSharePointPlugin");if(null==Jf){Jf="application/x-sharepoint";ua()&&3<=(bc()?Cd("version/"):0)&&Sy("application/x-sharepoint-webkit",!0)&&(Jf="application/x-sharepoint-webkit");
if(!Sy(Jf,!0))if(ua()&&Sy("application/officelive",!0))Jf="application/officelive";else return null;var Ki=document.createElement("object");Ki.id="npSharePointPlugin";Ki.type=Jf;Ki.style.width="0px";Ki.style.height="0px";Ki.style.setProperty("visibility","hidden","");document.body.appendChild(Ki);Jf=document.getElementById("npSharePointPlugin")}return Jf}function Sy(Jf,Ki){var ak=window.navigator.mimeTypes;if(null==ak)return!1;Jf=ak[Jf];return!Jf||Ki&&!Jf.enabledPlugin?!1:!0}function UF(Jf){try{if(null!=
new ActiveXObject(Jf))return!0}catch(Ki){}return!1}function TG(Jf){switch(Jf){case $r.OneNote:return"OneNote.Notebook";default:return""}}function hJ(Jf){if(Jf!=$r.OneNote&&t()&&!O())return"office:";switch(Jf){case $r.Excel:return"ms-excel:";case $r.OneNote:return"onenote:";case $r.PowerPoint:return"ms-powerpoint:";case $r.Visio:return"ms-visio:";case $r.Word:return"ms-word:";case $r.Project:return"ms-project:";case $r.Publisher:return"ms-publisher:";case $r.Infopath:return"ms-infopath:";case $r.Access:return"ms-access:";
default:return""}}function NM(Jf){switch(Jf){case $r.Excel:return"root\\office15\\excel.exe";case $r.PowerPoint:return"root\\office15\\powerpnt.exe";case $r.Visio:return"root\\office15\\visio.exe";case $r.Word:return"root\\office15\\winword.exe";case $r.Project:return"root\\office15\\winproj.exe";case $r.Publisher:return"root\\office15\\mspub.exe";case $r.Infopath:return"root\\office15\\infopath.exe";case $r.Access:return"root\\office15\\msaccess.exe";default:return null}}function iJ(Jf,Ki,ak){gr=
Jf;mE=Ki;nE=ak;if(Jf.DocumentUrl){var el=ak=Ki=Jf.DocumentUrl;try{el=decodeURIComponent(Jf.DocumentUrl)}catch(oE){}try{ak=encodeURI(Jf.DocumentUrl)}catch(oE){}Ki=Ki+""+Jf.CorrelationIdForWinClient;el+=Jf.CorrelationIdForWinClient;ak+=Jf.CorrelationIdForWinClient;Jf.Mode===hD.ReadWrite&&fy.CheckoutRequired===(Jf.Options&fy.CheckoutRequired)&&(Jf.Mode=hD.ForceCheckout);fy.HostIsEditOnly===(Jf.Options&fy.HostIsEditOnly)&&(Jf.Mode=hD.WriteOnly);if(Ee(Jf)?0:ua()&&(Jf.Application==$r.OneNote||Sy("application/x-sharepoint-protocolhandler",
!1)||Sy("application/x-sharepoint-webkit-protocolhandler",!1))||aa()||Pc()||!(b()||jd()||"ActiveXObject"in window&&!t()||Dc())||15<=VF())bm(Jf.Application,Jf.EncodeUrl?ak:Ki,Jf.Mode,Jf.Application==$r.OneNote,Jf.SilentExternalHandler,Jf.NavigateUsingWindowOpen);else{var np;if(np=Nb())a:{var $s=Jf.EncodeUrl?Ki:el,ss=Jf.Mode,lE=TG(Jf.Application);try{np=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,$s,ss,lE);break a}catch(oE){}np=!1}if(np)kE(ZB.O15ActiveX);else{if(b()||
jd()){var gu=Jf.EncodeUrl?Ki:el;el=Jf.Mode;np=TG(Jf.Application);$s=AD();if(null==$s)gu=gr.DescriptiveUnattemptedEnums?qq.PluginIsNull:qq.Unattempted;else{ss=!1;try{ss=$s.ViewDocument3(window.self,gu,el,np)}catch(oE){}if(!ss)try{ss=re(el)?$s.ViewDocument2(window.self,gu,np):$s.EditDocument2(window.self,gu,np)}catch(oE){}ss?(kE(ZB.NpapiPlugin),gu=qq.None):gu=qq.Failed}}else{try{gu=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=gu&&gu.SaveSSOCreds()}catch(oE){}gu=Fg(Jf.EncodeUrl?Ki:el,Jf.Mode,Jf.Options,
TG(Jf.Application))}if(gu!=qq.None){if(el=Jf.CouldUseRoamingApps)jJ||(jJ=!0,kJ=A("Windows NT")),el=6.1<=kJ&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(ub()||jd()||Dc());if(el&&Jf.Application!=$r.OneNote){if(!gD.rmc.X0o()){ED(qq.ControlNeeded,gr.Application);return}if(Jf.RoamingAppsLauncher){"undefined"==typeof Jf.RoamingAppsLauncher||null==Jf.RoamingAppsLauncher?ED(gr.DescriptiveUnattemptedEnums?qq.RoamingLauncherIsNull:qq.Unattempted,gr.Application):"undefined"==typeof Jf.RoamingBitsUrl||
null==Jf.RoamingBitsUrl?gD.rmc.z2o(Jf.DocumentUrl,Jf.RoamingAppsLauncher,Jf.Application,Jf.ApplicationParameters,mE,nE):gD.rmc.RIj(Jf.DocumentUrl,Jf.RoamingAppsLauncher,Jf.RoamingApplicationExe,Jf.ApplicationParameters,Jf.RoamingPlatform,Jf.RoamingBitsUrl,mE,nE);return}if(!Jf.ContinueIfLauncherIsNull){ED(qq.LauncherNeeded,gr.Application);return}}fy.NoProtocolHandlerFallback==(Jf.Options&fy.NoProtocolHandlerFallback)||Ee(Jf)||ub()||ua()&&!(gr.DescriptiveUnattemptedEnums?gu>=qq.O14Unattempted&&gu<=
qq.DocumentUrlIsNull:gu==qq.Unattempted)?ED(gu,gr.Application):bm(Jf.Application,Jf.EncodeUrl?ak:Ki,Jf.Mode,Jf.Application==$r.OneNote,Jf.SilentExternalHandler,Jf.NavigateUsingWindowOpen)}}}}else ED(gr.DescriptiveUnattemptedEnums?qq.DocumentUrlIsNull:qq.Unattempted,gr.Application)}function kE(Jf){null!=mE&&mE(Jf)}function ED(Jf,Ki){"undefined"==typeof Ki&&(Ki=null);null!=nE&&nE(Jf,Ki)}function VF(){var Jf=0;if(b()||jd()||Dc()){var Ki=AD();try{null!=Ki&&(Jf=Ki.GetOfficeVersion())}catch(ak){}}else UF("SharePoint.OpenDocuments.5")?
Jf=15:UF("SharePoint.OpenDocuments.4")?Jf=14:UF("SharePoint.OpenDocuments.3")?Jf=12:UF("SharePoint.OpenDocuments.2")&&(Jf=11);return Jf}function lJ(){return ua()&&(Sy("application/x-sharepoint",!0)||Sy("application/x-sharepoint-webkit",!0))}var mJ="",nJ="",oJ="",mE,nE,RG,SG,gr,jJ,kJ,fJ,gJ,hD={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},fy={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},
qq={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},ZB={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},$r={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,
Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:hD,OpenDocumentOptions:fy,OpenDocumentFailureType:qq,OpenDocumentControl:ZB,OfficeApplication:$r,EditDocumentInClient:iJ,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=$r.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=
this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:VF,IsO14MacPluginInstalled:lJ,OfferOfficeInDialog:function(){return h()&&11>=VF()},OfferOfficeNoIntrusive:function(){return h()&&15>VF()},OfferMacOffice:function(){return ua()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&
!lJ()},InstallRoamingControl:function(){Yb()?window.InstallTrigger.install({Office:{URL:nJ}}):fe(oJ,null,null)},CanUseRoamingControl:function(){if(aa())return!0;if(Dc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Yb()){var Jf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Jf);var Ki=document.createEvent("Events");Ki.initEvent("RoamingOfficeInstalled",!0,!1);Jf.dispatchEvent(Ki);
return!!Jf.getAttribute("installed")}if(ub())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(ak){}return!1},InitUrls:function(Jf,Ki,ak){mJ=Jf;nJ=ak;oJ=Ki},LaunchRoamingApps:function(Jf,Ki,ak,el,np,$s){gD.rmc.RIj(Jf,Ki,NM(ak),el,"x86",mJ,np,$s)},LaunchRoamingApps2:function(Jf,Ki,ak,el,np,$s,ss,lE){var gu="";null!=el&&(gu+=" "+el);null!=Jf&&(gu+=' "'+Jf+'"');if(aa()||Dc())RG=ss,SG=lE,ss='office: "'+($s+'" "')+(ak+'" "ROAMING"'),ss+=' "'+Ki+'"',ss+=' "'+np+'"',ss+=
" "+gu,ee(ss,KA,LA,!1,!1);else if(Yb())Jf=document.createElement("RoamingExtensionElement"),Jf.setAttribute("cabUrl",$s),Jf.setAttribute("app",ak),Jf.setAttribute("licensingEntitlements",Ki),Jf.setAttribute("platform",np),Jf.setAttribute("args",gu),document.documentElement.appendChild(Jf),Ki=document.createEvent("Events"),Ki.initEvent("RoamingOfficeLaunch",!0,!1),Jf.dispatchEvent(Ki),null!=ss&&ss(ZB.RoamingFFExtension);else if(ub()){if(Jf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=
Jf)try{Jf.HrConfigureSingle($s,ak,Ki,np,gu),null!=ss&&ss(ZB.RoamingActiveX)}catch(oE){}}else null!=lE&&lE(qq.Failed)},ShouldShowDialog:function(){return!t()},NavigateToUrlUsingClickingOnATag:Od,OpenDocumentWithProtocolHandler:bm,OpenDocumentWithProtocolHandlerNoCallBack:function(Jf,Ki,ak,el){var np=hJ(Jf);if(null==np)return ED(gr.DescriptiveUnattemptedEnums?qq.ProtocolHandlerNoCallbackIsNull:qq.Unattempted,gr.Application),!1;Jf=Gg(Jf,Ki,ak,el,np);ee(Jf,null,null,!1,!1);return!0}}}();gD.ClientUtils=
gD.rmc;var OM=c(1470);class WF{constructor(b,h,t){this.ga=b;this.W1j=h;this.Y5=t}Ub(){this.ga.pa(ab.a.tryMacOffice,yc.a.frame,Object(z.a)(this,this.Eon,"onTryMacOffice"));this.ga.pa(ab.a.fwj,yc.a.frame,Object(z.a)(this,this.TRi,"onTryMacOfficeFromViewer"));this.ga.pa(ab.a.ewj,yc.a.frame,Object(z.a)(this,this.TRi,"onTryMacOfficeFromViewer"))}Eon(b,h,t,A,O){if(1===t)return 32;O?(b=O.SourceControlId,"btnjTryMacOfficeForWordEditor"===b?ff.a.km(ia.a.n0a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):
"PptJewel.About.TryMacOffice"===b&&ff.a.km(ia.a.n0a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.RAi();return 32}TRi(b,h,t){if(1===t)return 32;switch(b){case ab.a.fwj:ff.a.km(ia.a.n0a(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case ab.a.ewj:ff.a.km(ia.a.n0a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}RAi(){ff.a.km(WF.Z2m,"_blank",void 0,"LaunchMacTrialWindow")}get x6c(){return this.W1j&&ba.a.Yk&&!ba.a.NCf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get olo(){const b=
this.x6c;b||v.AFrameworkApplication.Om.b$n();return b}get nlo(){return this.x6c}static get Z2m(){return ia.a.M7("522401")}}Object(m.a)(WF,"MacOfficeOffer",null,[994]);class XF{constructor(b,h,t){this.ga=b;this.a2j=h;this.HJ=null;(this.kwd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Sa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(A=>{this.HJ=A});this.Y5=t}Ub(){this.ga.pa(ab.a.tryOffice,
yc.a.frame,Object(z.a)(this,this.Fon,"onTryOffice"));this.ga.pa(ab.a.Ehg,yc.a.frame,Object(z.a)(this,this.Ehg,"tryOfficeThroughTellMe"));this.ga.pa(ab.a.kwj,yc.a.frame,Object(z.a)(this,this.lwj,"tryOfficeThroughViewer"));this.ga.pa(ab.a.jwj,yc.a.frame,Object(z.a)(this,this.lwj,"tryOfficeThroughViewer"))}Fon(b,h,t,A,O){if(this.kwd&&1===t)return this.isFreemiumUpsellEnabled&&this.y6c?32:8;2===t&&(O?(b=O.SourceControlId,"btnjTryOfficeForWordEditor"===b?ff.a.km(ia.a.n0a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):
"PptJewel.About.TryOffice"===b?ff.a.km(ia.a.n0a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.jGf()):this.jGf());return 32}Ehg(b,h,t,A,O){if(this.kwd&&1===t)return this.isFreemiumUpsellEnabled&&this.y6c?32:8;2===t&&(O?(b=O.SourceControlId,ff.a.km(ia.a.M7("862405")+this.M_l(b),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):ff.a.km(ia.a.M7("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}lwj(b,h,t){if(this.kwd&&1===t)return this.isFreemiumUpsellEnabled&&
this.y6c?32:8;if(2===t)switch(b){case ab.a.kwj:ff.a.km(ia.a.n0a(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case ab.a.jwj:ff.a.km(ia.a.n0a(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get Vcn(){return this.y6c}get Ucn(){return this.y6c&&MSOJS.ClientUtils.OfferOfficeInDialog()}get y6c(){return this.a2j&&!ba.a.Yk}get isFreemiumUpsellEnabled(){let b=!1;this.HJ&&(b=this.HJ.isFreemiumUpsellEnabled());return b}jGf(b=null){let h=0;b&&(h=b);ff.a.km(XF.zUl(h),"_blank",void 0,"LaunchOfficeOffer")}M_l(b){let h=
0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=
9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;
case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=29}return 0===h?"":String.format("&pc={0:D}",h)}static zUl(b){if(ba.a.si)switch(b){case 1:return ia.a.M7("393806");case 2:return ia.a.M7("393810");case 3:return ia.a.M7("393809");case 5:return ia.a.M7("393805")}else if(ba.a.kM)switch(b){case 1:return ia.a.M7("521979");case 3:return ia.a.M7("521980");case 5:return ia.a.M7("521978");case 2:return ia.a.M7("522490")}else{if(2===b)return ia.a.M7("517778");
if(1===b)return ia.a.n0a(30)}return ia.a.M7("522402")}}Object(m.a)(XF,"OfficeTrialExperience",null,[992]);class pJ{yc(b){b.register(XF,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").singleInstance().Qd(()=>new XF(v.AFrameworkApplication.xa,v.AFrameworkApplication.pCf,v.AFrameworkApplication.lcid));b.register(WF,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").singleInstance().Qd(()=>new WF(v.AFrameworkApplication.xa,v.AFrameworkApplication.Iui,
v.AFrameworkApplication.lcid))}}Object(m.a)(pJ,"OpenInClientConfiguration",null,[2]);class NA{constructor(b,h,t,A,O,aa,ua){this.Zf=b;this.characterPropertiesEditor=h;this.zW=t;this.Xgf=A;this.lj=O;this.Kd=aa;this.c_=ua}Gtm(b,h){var t;b=h.view;h=h.Yj;if(!h||!this.Zf.ysi(h,!0)||this.Xgf&&this.Xgf.instance&&this.Xgf.instance.aU(h))return 2;var A=NA.j6a?!NA.j_.awa(h):!0;this.zW&&A&&this.zW.alc(h.node,rc.a.ks,h.cpBegin);A=h.node;(null===(t=this.c_)||void 0===t?0:t.replaceText)&&this.c_.EGb(A)?(t=A.qa.i_a(h.cpBegin),
this.c_.replaceText(A,t,t,Ex.a.ZVc)):this.characterPropertiesEditor.jga(h,O=>new Ex.a(O));if(this.Kd.Cg){t=new Te.GraphTransaction(15);try{t.Eb(h.node),this.lj.Lpa(h.node,h.cpBegin,h.cpBegin+1,1)}finally{t&&t.dispose()}}A=h.node;t=h.cpEnd+1;" "===qe.ParagraphReader.text(A).charAt(t)&&(A=pf.a.createTextRange(A,t,t+1),this.characterPropertiesEditor.replaceTextRange(A,"\u00a0"));h=pf.a.Tc(h.node,t);b.nb.setSelection(wf.SelectionFactory.Zn(h));return 32}static get j_(){return null!=NA.uxg?NA.uxg:NA.uxg=
Sa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get j6a(){null==NA.yka&&(NA.yka=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return NA.yka}}NA.yka=null;Object(m.a)(NA,"InsertLineBreakStrategy",null,[]);class cw{static get vg(){return null!=cw.gBg?cw.gBg:cw.gBg=Sa.a.instance.resolve("Box4.IOutlineElementEditor")}static get Vg(){return Ik.ContextSetEditor.instance}static get lj(){return null!=cw.CEg?cw.CEg:cw.CEg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Kd(){return null!=
cw.gFg?cw.gFg:cw.gFg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static dum(b,h,t,A,O){if(O&&O.hasProperty(Gd.a.targetObject)){var aa=h.view.Zc.Mc.Db(O.getValue(Gd.a.targetObject));aa=pf.a.create(aa)}else aa=cw.Vg.MS(h.Yj,11);if(!aa)return 8;b=v.AFrameworkApplication.xa.Nf(aa,b,t,!0,A,O);if(32===b&&2===t){if(!h.view.re)return 2;h=h.view;A=h.nb.pg;if(A=cw.Vg.MS(A,11)){t=new Xm.a;t.set(A.node);t.yd();if(O&&O.hasProperty(Gd.a.targetObject))for(O=O.Lf(Gd.a.targetObject);!t.currentNode.id.equals(O)&&
t.wc()&&(wg.OutlineElementNavigator.Zd(t),11===t.Xe););wg.OutlineElementNavigator.N_(t,!1,!1);O=nf.SelectionEditor.sDa(t,!0);O=qe.ParagraphReader.Jt(O)?wf.SelectionFactory.te(O,0):wf.SelectionFactory.mq(O);h.nb.setSelection(O)}}return b}static VUd(b,h,t,A,O){b=b===qa.a.uRc;h=h.node;if(O&&O.hasProperty(Gd.a.targetObject)&&!h.id.equals(O.Lf(Gd.a.targetObject)))return 2;if(1===t)return 32;t=new ue.GraphIterator;t.set(h);t.Ab(10);cw.vg.uC(t,b,!0);cw.Kd.Cg&&(t=wg.OutlineElementNavigator.Fe(t),cw.lj.sNb(t,
1));return 32}}Object(m.a)(cw,"InsertOutlineElementStrategy",null,[]);class YF{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb){this.Lni=(Yb,bc,Dc)=>{var Pc;const jd=!bc.cpBegin;Dc=bc.cpBegin===qe.ParagraphReader.textLength(Dc);const Cd=!(null===(Pc=Jb.App.xd)||void 0===Pc||!Pc.Yp);let ee=!0;Cd&&jd&&!Dc?(ee=!1,Pc=new ue.GraphIterator,Pc.$c(Yb),Pc.yd(),this.Hh.uC(Pc,!0,!1)):Pc=this.Hh.tna(Yb);this.Hh.p9(Yb,Pc,bc,!1,!0,ee,!1,!0);!Cd||jd||Dc||(Yb=Ik.ContextSetEditor.instance.kmf(bc),Jb.App.xd.Vq.aH(Yb));return Pc};
this.BY=h;this.mWj=b;this.yz=aa;this.d4j=O;this.Hh=t;this.eUj=A;this.Fk=ua;this.ib=Ra;this.hE=ub;this.qpc=Nb}T$m(b,h,t,A,O){if(!h.view.re)return 2;h=h.view;let aa=null;h.Yi&&(aa=h);const ua=h.nb.pg;var Ra=!0;let ub=!1,Nb=null;if(!ua)return 2;const Yb=new Te.GraphTransaction(15);Yb.Eb(h.Zc);let bc=null;2===t&&(bc=new Xm.a,bc.set(ua.node),bc.yd(),Nb=new az.a(bc),wg.OutlineElementNavigator.Zd(bc),Ra=mb.OutlineElementReader.isEmpty(bc,!1),{Zjj:Ra,eEj:ub}=this.eUj.$jj(bc,Ra,Jv.a.JDb,-1,ua));b=v.AFrameworkApplication.xa.Nf(ua,
b,t,!1,A,O);Ra&&32===b&&2===t&&(ub||wg.OutlineElementNavigator.FFa(bc,!1,!nf.SelectionEditor.jf(ua),!1),ub&&Nb&&Nb.restore(bc),this.yz.freeze(),(t=wf.SelectionFactory.Yn(bc.currentNode,!0))||u.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),h.nb.setSelection(t),this.yz.JHa(),this.mWj.Ug.QE());aa&&(Ra||aa.p4(),aa.editingView&&aa.bU&&(aa.editingView.LH=!0));Rs.GrippersManager.instance.MPb(1);Yb.dispose();return b}newLine(b,h,t){b=!1;if(Be.ImageReader.w3(h)||Be.ImageReader.N1a(h))h=
this.z_k(h),b=!0;const A=h;if((h=nf.SelectionEditor.jf(h))&&this.Fk.kh&&!this.Fk.eGm(A))return 2;if(1===t)return 32;const O=A.node,aa=new ue.GraphIterator;aa.set(O);aa.yd();wg.OutlineElementNavigator.Zd(aa);t=new Te.GraphTransaction(15);t.Fu(aa);h?(this.qpc.instance&&this.qpc.instance.aIa(A),qe.ParagraphReader.Yb(O)&&A.cpBegin===qe.ParagraphReader.textLength(O)&&zc.m(A)&&9===qe.ParagraphReader.Sma(O)&&this.yz.v0k(A),hb.ListItemReader.Kh(aa)?this.d4j.execute(aa,A,O,this.Lni):this.Lni(aa,A,O),this.BY&&
this.BY.alc(O,rc.a.ks,A.cpBegin),b&&(wg.OutlineElementNavigator.Ir(aa,!1,!1),b=aa.Tb(2),(b=this.hE.te(b,0))&&this.ib.setSelection(b))):this.Hh.uC(aa,!0,!0);t.dispose();Jb.App.ya&&Jb.App.ya.updateCommandUI();return 32}z_k(b){if(Be.ImageReader.w3(b))var h=pf.a.Tc(b.node,b.cpBegin);else{h=qe.ParagraphReader.QP(b.node);var t=h.properties.Lf(Lc.a.$p);b=b.node.properties.getValue(Lc.a.runId);t=YF.Emf(b,t,h.qa);h=pf.a.Tc(h,t)}return h}static bif(b,h){let t=0;for(;t<h.length&&!(b<h[t]);)t++;return t}static Emf(b,
h,t){let A=0;b=YF.bif(b,h);let O=0;if(b===h.length)O=t.length-1;else for(;O<t.length;){h=t.J(O);if(h.formatting&&h.formatting.ze===b)break;O++}O<t.length&&(A=t.J(O).cp);return A}}Object(m.a)(YF,"NewLineStrategy",null,[]);class FD{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd,Cd){this.Dm=null;this.Nka=b;this.Pgd=ua;this.Tnd=new YF(this,h,t,A,O,aa,Ra,Yb,bc,jd);this.wWg=new NA(Ra,ub,h,Nb,Dc,Pc,Cd)}get Ug(){return this.Dm||(this.Dm=this.Nka())}Ub(){const b=v.AFrameworkApplication.xa,h=Object(z.a)(this.Tnd,
this.Tnd.newLine,"newLine");b.gb(qa.a.enter,mc.a.view,Object(z.a)(this.Pgd.value,this.Pgd.value.bpl,"enterView"),1124);b.gb(qa.a.fjj,mc.a.view,Object(z.a)(this.Pgd.value,this.Pgd.value.ljo,"shiftEnterView"),1124);b.pa(qa.a.newLine,mc.a.view,Object(z.a)(this.Tnd,this.Tnd.T$m,"newLineView"));b.pa(qa.a.newLine,mc.a.Vc,h);b.pa(qa.a.newLine,mc.a.image,h);b.pa(qa.a.newLine,mc.a.Fd,h);b.pa(qa.a.newLine,mc.a.anchoredObject,h);b.pa(qa.a.newLine,mc.a.embeddedFile,h);b.pa(qa.a.newLine,mc.a.ink,h);b.pa(qa.a.newLine,
mc.a.paragraph,h);b.pa(qa.a.newLine,mc.a.iFrame,h);b.pa(qa.a.newLine,mc.a.unsupportedObject,h);b.Uc(qa.a.newLine,1124);b.gb(qa.a.TUd,mc.a.view,Object(z.a)(this.wWg,this.wWg.Gtm,"insertLineBreakView"),1028);b.pa(qa.a.uRc,mc.a.view,cw.dum);b.pa(qa.a.uRc,mc.a.outlineElement,cw.VUd);b.Uc(qa.a.uRc,1092)}static get instance(){return null!=FD.yyg?FD.yyg:FD.yyg=FD.Sl()}static Sl(){return new FD(()=>Sa.a.instance.resolve("Box4.IUndoManager"),Sa.a.instance.Ma("Box4.IAutoCorrectScheduler"),Sa.a.instance.resolve("Box4.IOutlineElementEditor"),
Sa.a.instance.resolve("Box4.List.ICursorMovementValidator"),Sa.a.instance.resolve("Box4.List.ListNewLineStrategy"),Sa.a.instance.resolve("Box4.IInsertionPointFormatting"),Sa.a.instance.We("Box4.Actors.IEnterViewStrategy"),rl.a.instance,Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Sa.a.instance.Sa("Box4.IExternalSelectionManager"),he.a.instance,Sa.a.instance.resolve("Box4.ISelectionFactory"),Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Sa.a.instance.Sa("Box4.IContentControlConverter"),Sa.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(m.a)(FD,"EnterActor",null,[]);var UG=c(1383),VG=c(883);class wk{static get paragraphEditor(){return null!=wk.OBg?wk.OBg:wk.OBg=Sa.a.instance.resolve("Box4.IParagraphEditor")}static get E4(){return null!=wk.lDg?wk.lDg:wk.lDg=Sa.a.instance.Ma("Box4.ISpacingCommands")}static get TSa(){return null!=wk.wDg?wk.wDg:wk.wDg=Sa.a.instance.Ma("Box4.Styles.IWACStyleReader")}static get sFa(){return null!=
wk.hAg?wk.hAg:wk.hAg=Sa.a.instance.Ma("Box4.ILineSpacingHelper")}static get lj(){return null!=wk.LEg?wk.LEg:wk.LEg=Sa.a.instance.Ma("Box4.TrackChange.ITrackChangeEditor")}static get Kd(){return null!=wk.mFg?wk.mFg:wk.mFg=Sa.a.instance.Ma("Box4.TrackChange.ITrackChangeManager")}static get Oh(){return Sa.a.instance.Ma("WordEditor.ClientPagination.IClientPaginationSettings")}static Ub(){var b,h,t;const A=v.AFrameworkApplication.xa;A.pa(qa.a.VGf,mc.a.view,hn.a.Mv);A.Uc(qa.a.VGf,1028);A.pa(qa.a.KC,mc.a.view,
hn.a.Mv);A.pa(qa.a.KC,mc.a.paragraph,wk.Czd);A.Uc(qa.a.KC,1036);A.pa(qa.a.Ghc,mc.a.paragraph,wk.lxk);A.pa(qa.a.Ghc,mc.a.view,hn.a.Mv);A.Uc(qa.a.Ghc,1036);if(null===(b=wk.Oh)||void 0===b?0:b.oFa)A.pa(qa.a.A5c,mc.a.paragraph,wk.n_e),A.pa(qa.a.A5c,mc.a.view,hn.a.Mv);if(null===(h=wk.Oh)||void 0===h?0:h.BIa)A.pa(qa.a.c6c,mc.a.paragraph,wk.I_e),A.pa(qa.a.c6c,mc.a.view,hn.a.Mv);if(null===(t=wk.Oh)||void 0===t?0:t.Fga)A.pa(qa.a.z5c,mc.a.paragraph,wk.m_e),A.pa(qa.a.z5c,mc.a.view,hn.a.Mv);A.pa(qa.a.FXe,mc.a.view,
wk.Tsk);A.Uc(qa.a.FXe,1036);A.pa(qa.a.y2f,mc.a.view,wk.VVn);A.Uc(qa.a.y2f,1036);A.pa(qa.a.EXe,mc.a.view,wk.Ssk);A.Uc(qa.a.EXe,1036);A.pa(qa.a.x2f,mc.a.view,wk.UVn);A.Uc(qa.a.x2f,1036);A.pa(qa.a.ySa,mc.a.view,hn.a.Mv);A.pa(qa.a.ySa,mc.a.paragraph,wk.Czd);A.Uc(qa.a.ySa,1036);A.pa(qa.a.xSa,mc.a.view,hn.a.Mv);A.pa(qa.a.xSa,mc.a.paragraph,wk.Czd);A.Uc(qa.a.xSa,1036);A.pa(qa.a.Jhe,mc.a.view,wk.Ihe);A.pa(qa.a.Jhe,mc.a.paragraph,wk.Ihe);A.Uc(qa.a.Jhe,1028);A.pa(qa.a.Bcg,mc.a.view,wk.Ihe);A.pa(qa.a.Bcg,mc.a.paragraph,
wk.Ihe);A.Uc(qa.a.Bcg,1028);A.pa(qa.a.Ahe,mc.a.view,hn.a.Mv);A.pa(qa.a.Ahe,mc.a.paragraph,wk.Bqh);A.Uc(qa.a.Ahe,1028);A.pa(qa.a.zhe,mc.a.view,hn.a.Mv);A.pa(qa.a.zhe,mc.a.paragraph,wk.Bqh);A.Uc(qa.a.zhe,1028)}static Bqh(b,h,t,A,O){if(1===t)return 32;b===qa.a.Ahe?b=qa.a.ySa:b===qa.a.zhe&&(b=qa.a.xSa);return wk.Czd(b,h,t,A,wk.hun(O))}static hun(b){var h=b.indexOf(",");const t=b.substring(0,h);b=b.substring(h+1,b.length);h=new UG.a;h.value=parseFloat(t);h.unit=parseInt(b);return h}static Ihe(b,h,t,A,
O){if(2===t){h=O[Ue.a.Text];t=O[Ue.a.Number];O=O.Increment;A=new UG.a;let aa=!1;""===h||O&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(A.value=0,A.unit=Jb.App.ZEa?2:4,aa=!0):t||O||(A.value=0,A.unit=1,aa=!0);aa&&(v.AFrameworkApplication.xa.Rb(b===qa.a.Jhe?qa.a.ySa:qa.a.xSa,2,A),Jb.App.ya.updateCommandUI())}return 32}static Czd(b,h,t,A,O){if(!({Qx:t}=hn.a.Q$f(t,h)).returnValue)return t;h=h.node;switch(b){case qa.a.KC:wk.paragraphEditor.KC(h,new VG.a(2,O));break;case qa.a.ySa:b=new VG.a(O.unit,O.value);
wk.paragraphEditor.fnb(h,b);break;case qa.a.xSa:b=new VG.a(O.unit,O.value),wk.paragraphEditor.enb(h,b)}A&&Ds.a.Gob&&(A.Ur|=Ds.a.xgb(h));return 32}static Tsk(b,h,t){if(1===t)return 32;u.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=wk.Uci(h);if(!b)return u.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;b=(b=b.ia(Lc.a.rj,240)/20)?b:wk.Wal;wk.E4.vca(1,b,4);return 32}static VVn(b,h,t){if(1===t)return 32;u.ULS.sendTraceTag(588394562,340,
50,"Remove Space Before Paragraph option is clicked");wk.E4.vca(1,0,4);return 32}static Ssk(b,h,t){if(1===t)return 32;u.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=wk.Uci(h);if(!b)return u.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ia(Lc.a.sa,240)/20;wk.E4.vca(0,b?b:12,4);return 32}static UVn(b,h,t){if(1===t)return 32;u.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");wk.E4.vca(0,0,4);return 32}static n_e(b,
h,t,A,O){if(2==t){if("boolean"!==typeof O)return 16;b=h.node;h=null;jp.a.instance.J(1)&&(h=b.qD());wk.paragraphEditor.n_e(b,O);h&&wk.lj.NU(b,h,wk.Kd.Cg)}return 32}static I_e(b,h,t,A,O){if(2==t){if("boolean"!==typeof O)return 16;b=h.node;h=null;jp.a.instance.J(1)&&(h=b.qD());wk.paragraphEditor.I_e(b,O);h&&wk.lj.NU(b,h,wk.Kd.Cg)}return 32}static m_e(b,h,t,A,O){if(2==t){if("boolean"!==typeof O)return 16;b=h.node;h=null;jp.a.instance.J(1)&&(h=b.qD());wk.paragraphEditor.m_e(b,O);h&&wk.lj.NU(b,h,wk.Kd.Cg)}return 32}static lxk(b,
h,t,A,O){if(2==t){if("boolean"!==typeof O)return 16;b=new Map;b.set("Value",O.toString());wa.Health.instance.recordKpiUsage(Xk.a.Bjb.kDo,0,Xk.a.dB,b);h=h.node;b=null;jp.a.instance.J(1)&&(b=h.qD());h.hasProperty(Lc.a.Sv)&&h.removeProperty(Lc.a.Sv);wk.sFa.bNd(h)!==O&&h.setValue(Lc.a.Sv,O);(O=wk.sFa.N6b(h,!0))&&O.Wk(4,!0);(O=wk.sFa.N6b(h,!1))&&O.Wk(4,!0);b&&wk.lj.NU(h,b,wk.Kd.Cg)}return 32}static Uci(b){b=b.view;return b.re&&(b=b.nb)&&b.hb.lb?wk.TSa.Uo(b.hb.lb.Qa.node):null}}wk.Wal=12;Object(m.a)(wk,
"SpacingActor",null,[]);class qJ{process(){}}Object(m.a)(qJ,"NoOpFormattingViewOperationFinishedStageProcessor",null,[43]);class rJ{constructor(b){this.ue=b}Bbo(b,h){this.ue.bia(b,h.cache.BE);this.ue.wA(b,h.cache.fontSize)}zDb(){return null}VDa(){return null}y7b(){return null}zT(){return null}}Object(m.a)(rJ,"FormattingStewardBridge",null,[46]);class sJ{yc(b){b.ha("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new qJ).singleInstance();b.ha("Box4.Actors.IFormattingStewardBridge",
()=>new rJ(b.resolve("Box4.IFormattingEditor"))).singleInstance()}}Object(m.a)(sJ,"WoncaActorsConfiguration",null,[2]);class tJ{constructor(b,h,t,A,O,aa,ua,Ra){this.ga=b;this.hRj=h;this.gRj=t;this.GJg=A;this.T8j=O;this.Ipd=aa;this.Y8j=ua;this.Z8j=Ra}get rc(){return this.ga}gFk(b){this.rc.dpa(b,this.hRj,null,null)}eFk(b){this.rc.dpa(b,this.gRj,null,null)}BZ(b,h,t){t?this.rc.dpa(b,this.GJg,h,null):this.rc.Rb(this.GJg,2,h)}Nun(b,h){this.rc.dpa(b,this.Ipd,h,null)}N8(b,h){this.rc.dpa(b,this.Y8j,h,null)}Slb(b,
h){this.rc.dpa(b,this.Z8j,h,null)}DVf(b,h=!1){const t=new ji.DictionaryPropertySet;t.setValue(Gd.a.EO,b);t.setValue(Gd.a.sVi,!0);t.setValue(Gd.a.b2a,h);this.rc.Rb(this.T8j,2,t)}}Object(m.a)(tJ,"ClipboardCommands",null,[1581]);class uJ{}Object(m.a)(uJ,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1490]);class vJ{constructor(b){this.ga=b}get rc(){return this.ga}hgj(b,h,t){let A=0;b?1===b&&(A=qa.a.v1a):A=qa.a.u1a;b=new WC.a;b.unit=t;b.value=h;this.rc.Rb(A,2,b)}rfe(b,h,t){let A=0;1===b?A=qa.a.mNb:
2===b?A=qa.a.wnb:b||(A=qa.a.nNb);b=new WC.a;b.unit=t;b.value=h;this.rc.Rb(A,2,b)}}Object(m.a)(vJ,"IndentationCommands",null,[1515]);var ZF;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.inner=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.distribute=7]="distribute";b[b.margin=8]="margin";b[b.highKashida=9]="highKashida";b[b.lowKashida=10]="lowKashida";b[b.mediumKashida=11]="mediumKashida";b[b.numTab=12]=
"numTab";b[b.thaiDistribute=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(ZF||(ZF={}));Object(m.b)("Justification",ZF);class wJ{constructor(b){this.CKa={};this.ga=b;this.mpm()}get rc(){return this.ga}LD(b){b=this.CKa[ZF[b]];void 0!==b&&null!==b&&this.rc.processAction(b,2)}mpm(){this.CKa.left=qa.a.leftJustify;this.CKa.center=qa.a.centerJustify;this.CKa.right=qa.a.rightJustify;this.CKa.both=qa.a.fullJustify;this.CKa.lowKashida=qa.a.rHb;this.CKa.mediumKashida=qa.a.rHb;this.CKa.highKashida=
qa.a.rHb;this.CKa.distribute=qa.a.GIc;this.CKa.thaiDistribute=qa.a.X5c}}Object(m.a)(wJ,"JustificationCommands",null,[1511]);class xJ{constructor(b){this.ga=b}KC(b){this.ga.Rb(qa.a.KC,2,b)}Ghc(b){this.ga.Rb(qa.a.Ghc,2,b)}A5c(b){this.ga.Rb(qa.a.A5c,2,b)}c6c(b){this.ga.Rb(qa.a.c6c,2,b)}z5c(b){this.ga.Rb(qa.a.z5c,2,b)}vca(b,h,t){this.ga.Rb(b?qa.a.ySa:qa.a.xSa,2,Object.assign(new UG.a,{value:h,unit:t}))}}Object(m.a)(xJ,"SpacingCommands",null,[1420]);class yJ{constructor(b,h,t){this.rc=b;this.hJc=h;this.mll=
t;this.Kpn=(A,O,aa)=>{if(1===aa)return this.hJc.K6?32:8;this.hJc.dTm();this.mll().zoo(this.hJc.uNl());return 32}}Ub(){this.rc.gb(qa.a.slb,mc.a.application,this.Kpn,1028)}}Object(m.a)(yJ,"EditorSettingsUIActor",null,[]);class zJ extends Pf.a{constructor(b,h){super(!1,!1,!0);this.oll=b;this.dQa=h;this.nll=t=>{1!==t?u.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.oll.zLo(),u.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}zoo(b){Object(Rl.__awaiter)(this,
void 0,void 0,function*(){var h=yield this.dQa.NHb;h={["id"]:"SettingsDialog",["uiLanguage"]:v.AFrameworkApplication.uiCulture,["selectedLanguage"]:Sf.a.lg(v.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.XUc,["editorSettings"]:b};this.Yh(Box4Intl.Box4Strings.l_EditorSettings,this.nll,h);u.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")})}}Object(m.a)(zJ,"EditorSettingsDialog",Pf.a,[]);class AJ{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd){this.jvb=
this.Dxc=this.Eoc=null;this.GQe=0;this.MCe=!1;this.ra=new If.a;this.ZWd=!1;this.FL=b;this.yz=h;this.ue=t;this.As=A;this.eb=O;this.If=ua;this.Jd=Ra;this.Fk=ub;this.jd=Nb;this.Wd=Yb;this.iq=bc;this.fW=Dc;this.ax=Pc;this.Ao=jd}get Pml(){return this.jd?this.jd.isFeatureEnabled(40):!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get Djf(){return null!=this.twg?this.twg:this.twg=Sa.a.instance.resolve("Box4.IFormatPainterStrategy")}get EQ(){return this.MCe}set EQ(b){this.MCe!==
b&&(this.MCe=this.ZWd=b,this.ra.raiseEvent("FormatPainterBrushActiveStatusChanged"))}Jpk(b){this.ra.addHandler("FormatPainterBrushActiveStatusChanged",b)}dWi(b){const h=b.Qa;u.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();var t=h.node;b=this.Xui(b);if(this.Djf.ulo(h.contextId,b))try{this.jvb=this.eb.C0a(t)}catch(A){throw u.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",A.message),A;}this.Dxc=this.ax.Uo(t);t=Wa.FormattingReader.Ar(h);
t.sn&&(this.Eoc=Object(Da.a)(Sx.a,t.sn.clone()));this.GQe=b?mc.a.paragraph:h.contextId}Xph(b){if(b){const t=this.Xui(b);for(let A=0;A<b.length;A++){const O=b.J(A);if(null===O||void 0===O?0:O.Xk)this.vyb(O,t);else if(0==(null===O||void 0===O?void 0:O.length))u.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",O);else if(O)for(let aa=0;aa<O.length;aa++){var h=O.getContext(aa);if(null===h||void 0===h?0:h.Hw){if(h)for(let ua=0;ua<h.length;ua++)O.addContext(h.getContext(ua))}else(null===
h||void 0===h?0:h.Xk)?this.vyb(h,t):u.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}}}$ph(b,h){if(h){var t=b.node,A=t.qa.last,O=this.Jd.u_a(t),aa=O.Sf(O.Kb);this.aqh(O,h,null);jp.a.instance.J(1)&&this.iq.YMb(t,A,b.cpBegin,b.cpEnd,aa,O,this.Wd.Cg)}}xxk(b,h,t){if(h||t)0<zc.g(b).length&&u.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.fW.w2(b,A=>{this.aqh(A,h,t)})}aqh(b,h,t){this.ue.ula(b);b.sn&&b.sn.removeProperty(Af.a.highlight);
this.ue.c5e(b);t&&(t=t.Ik(),t=t.clone(),t.Qg(...Qo.a.Saa()),this.Aw(b,t));this.Aw(b,h)}Aw(b,h){if(h){var t=b.paragraph.Mc;if(t){var A=b.sn;A=A?Object(Da.a)(ru.a,A.clone()):Sx.a.vCa(1179725);for(const aa of h.Fl())if(aa!==Lc.a.hx&&aa!==Lc.a.fieldInstruction&&aa!==Af.a.lB&&aa!==Af.a.z3&&aa!==Lc.a.V1a&&aa!==Af.a.IK&&aa!==Lc.a.S2a&&aa!==Lc.a.noProof){if(aa===fh.a.Qv){var O=h.ia(fh.a.Qv,W.a.nil);if(O!==W.a.nil)if(O=t.Db(O)){if(O=new bu.a(O),O=this.ax.CK(O),O===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(O=
this.ax.qC(b.paragraph).cEa(O)){A.Qta(O.Ik(),...Qo.a.Saa());continue}else u.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else u.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}A.setValue(aa,h.Lf(aa))}A.Tna?h=t.gR(A,!0):(t.Du(A),h=A);b.Dj=h.id}}}Xui(b){return!b.Sx&&b.Rc.contextId!==mc.a.endOfParagraph}reset(){this.jvb=this.Dxc=this.Eoc=null;this.GQe=mc.a.none}vyb(b,h){if(b.contextId===
mc.a.Vc||b.contextId===mc.a.Fd)var t=this.Fk.i8(b);else if(b.contextId===mc.a.paragraph)t=this.Fk.gYd(b);else if(b.contextId===mc.a.endOfParagraph)t=this.Fk.HWd(b);else{u.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}u.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(t)u.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{t=Object(Da.a)(Tb.AParagraphNode,b.node);var A=!1;t&&(A=
b.contextId===mc.a.Fd&&!!t&&!b.cpBegin&&b.cpEnd===this.eb.textLength(t));if(h=this.Djf.xjo(this.GQe,b.contextId,h,A))try{qe.ParagraphReader.Yb(t)?(this.Dxc&&this.FL.rJ(this.Dxc,t,!0),this.As.sqh(t,this.jvb)):u.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(O){throw u.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",O.message),O;}A=b;b.contextId===mc.a.paragraph?A=pf.a.createTextRange(t,0,qe.ParagraphReader.textLength(t)):
b.contextId===mc.a.Vc&&(A=this.yz.yrf(b),A=he.a.mAb(A));if(A&&A.contextId===mc.a.Fd){if(pi.a.pEd){const O=this.Ao.LPd(A);O&&(A=O)}try{this.xxk(A,this.Eoc,h?null:this.Dxc)}catch(O){throw u.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",O.message),O;}}if(b.contextId===mc.a.paragraph||b.contextId===mc.a.endOfParagraph)h=new ue.GraphIterator,h.set(t),h.yd(),h.fd(11),A=hb.ListItemReader.Kh(h),t=!qe.ParagraphReader.textLength(t),u.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",
A,t),A?(this.If.rM(h),this.If.k8(h.currentNode)&&this.$ph(b,this.Eoc)):this.Pml&&this.$ph(b,this.Eoc)}}}Object(m.a)(AJ,"FormatPainter",null,[1547]);var PM=c(121);class GD{constructor(b,h,t,A,O,aa,ua,Ra=!1,ub,Nb,Yb){this.nld=!1;this.oze=new Yt.a;this.Xem=()=>{this.cS.EQ=!1;return 32};this.Yem=(bc,Dc,Pc)=>{bc=!1;if(Dc=this.Hy.d3){switch(Dc.contextId){case mc.a.Fd:case mc.a.paragraph:case mc.a.endOfParagraph:case mc.a.Vc:bc=!0}bc&&nf.SelectionEditor.gl(Dc)&&zc.b(Dc)&&(this.nd.Zb(gg.a.Ym,{["Reason"]:uf.a.kGc}),
bc=!1);bc&&qe.ParagraphReader.ZT(Dc)&&(this.nd.Zb(gg.a.Ym,{["Reason"]:uf.a.IN}),bc=!1)}if(1===Pc||!bc)return bc?32:8;6!==this.ga.iD?(this.cS.EQ?u.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(u.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.cS.dWi(this.Hy.lb),this.nld||(this.Fh.lYa(this.Myj),(Pc=this.Fh.jb.ju)&&Pc.Yi&&Pc.fmh(this.Lyj),this.nld=!0)),this.cS.EQ=!this.cS.EQ):(u.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),
this.cS.dWi(this.Hy.lb),this.cS.EQ=!1);return 32};this.Wem=(bc,Dc,Pc,jd,Cd)=>{if(6===this.ga.iD||this.cS.EQ){u.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.iD);bc=this.Fh.xq.eg("UserAction","FormatPainterApply");if(GD.Xb&&GD.Xb.iA(115)){Cd=Cd?Cd.KeepBrushActive:!1;Pc=null;this.Hy.lb&&2===this.Hy.lb.trigger&&(Cd=Cd||this.cS.ZWd,this.cS.ZWd&&nf.SelectionEditor.hm(this.Hy.lb)&&(Pc=nf.SelectionEditor.b3(this.Hy.lb.Qa,!1)))&&(Pc.trigger=2);this.cS.ZWd=
!1;if(Cd||2!==this.Hy.lb.trigger)Dc=new Te.GraphTransaction(15),Pc&&Pc.Qa?(Dc.set(Pc.Qa.node.Wi),this.ib.setSelection(Pc)):Dc.set(this.Hy.l5b.Wi),Pc=wf.SelectionFactory.Zn(this.ib.pg),this.cS.Xph(Pc),Dc.dispose();this.cS.EQ=Cd}else Cd=new Te.GraphTransaction(15),Cd.set(this.Hy.l5b.Wi),Dc=wf.SelectionFactory.Zn(this.ib.pg),this.cS.Xph(Dc),this.cS.EQ=!1,Cd.dispose();bc.stop()}return 32};this.Myj=()=>{this.M6d(this.cS.EQ)};this.Lyj=()=>{this.M6d(this.cS.EQ)};this.Fh=b;this.Vb=h;this.ga=t;this.nd=A;this.Hy=
O;this.cS=aa;this.ib=ua;this.p1j=Ra;this.Fx=ub;this.Xw=Nb;this.lUj=Yb}get ASg(){return ba.a.Rt||ba.a.yYd?"url("+this.o5h()+"), pointer":'url("'+this.o5h()+'"), pointer'}o5h(){return this.Xw?this.Fx.dva(tl.a.Bg("FormatPainterText.cur"),tl.a.Bg("FormatPainterTextDarkMode.cur"),new PM.a(Oj.a.tK())):tl.a.Bg("FormatPainterText.cur")}Ub(){const b=this.Vb.fe(Hh.AppFrame.xE);b.bindAction(sb.KeyInputManager.mc(rc.a.qIa,0),qa.a.Cjf);b.bindAction(sb.KeyInputManager.mc(rc.a.Vpb,6),qa.a.OLd);this.p1j||b.bindAction(sb.KeyInputManager.mc(rc.a.Ypb,
6),qa.a.O_a);this.ga.gb(qa.a.OLd,mc.a.view,this.Yem,1028);this.ga.gb(qa.a.O_a,mc.a.view,this.Wem,1028);this.ga.gb(qa.a.Cjf,mc.a.view,this.Xem,1028);this.cS.Jpk(()=>{this.Pjg(this.cS.EQ)});this.Xw&&this.lUj.syd(()=>{this.M6d(this.cS.EQ)})}Pjg(b){const h=this.Fh.xq.eg("UserAction","FormatPainterUpdateCursor");this.M6d(b);this.Fh.updateCommandUI();h.stop()}Kyj(b,h){for(let t=0;t<b.length;t++)this.Jyj(b[t],h);(b=this.Fh.jb.ju)&&b.re&&this.Jyj(b.qh.editingElement,h)}Jyj(b,h){b.style.cursor=h?this.ASg:
""}M6d(b){const h=document.querySelectorAll(".OutlineElement");if(1<h.length){const t=h[h.length-2].style.cursor===this.ASg;if(this.Fh.jb.isEditingAllowed||this.Fh.jb.$x){if(b&&!t||!b&&t)this.Kyj(h,b),this.gzj(b);b||!this.nld||this.oze.count||(this.Fh.F5i(this.Myj),(b=this.Fh.jb.ju)&&b.Yi&&b.OUn(this.Lyj),this.nld=!1)}else t&&(this.Kyj(h,!1),this.gzj(!1))}}gzj(b){const h=this.Fh.jb.ju;h&&(b?this.oze.add(h.Zc.wl):this.oze.remove(h.Zc.wl))}static get Xb(){return null!=GD.ovg?GD.ovg:GD.ovg=Sa.a.instance.Ma("Box4.IFeatureHelper")}}
Object(m.a)(GD,"FormatPainterActor",null,[]);class OA{constructor(b,h,t){this.Rm=t}bpl(b,h,t,A,O){var aa;if(!({je:t,selected:aa,Qx:ub}=this.ikj(h,t,!1)).returnValue)return ub;Ok.a.mark(5013);var ua=OA.Vg.DN(aa);for(var Ra=0;Ra<ua.length;++Ra){if(!ua[Ra].isValid)continue;const Nb=ua[Ra].iterator;Nb.Yo();if(mj.OutlineReader.Kw(Nb))return this.$Sh(t,Nb)}ua=this.SNl();if(aa.Hw||nf.SelectionEditor.gl(aa)||qe.ParagraphReader.im(aa)&&!nf.SelectionEditor.d8(aa)){if(OA.Xb&&OA.Xb.isFeatureEnabled(23)&&Ik.ContextSetEditor.instance.Lbg(aa).returnValue)return 8;
var ub=this.aTh(h,t,b,A,O,ua)}else if(nf.SelectionEditor.Dk(aa))ub=this.ZSh(h,t,b,A,O,ua);else if(nf.SelectionEditor.jf(aa)){ub=new ue.GraphIterator;ub.set(aa.node);ub.Ab(10);Ra=Ge.HyperlinkReader.rD(aa,!1);if(0<Ra.length){if(!Ra[0].hyperlink)return u.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",Ra[0].cpBegin,Ra[0].cpEnd),8;Jb.App.Ufb(Ra[0].hyperlink.url);return 32}Gh.TableCellReader.t_(ub)&&(Wh.returnToContainingCell(ub),Gh.TableCellReader.uga(ub)&&(Ra=new ue.GraphIterator,
Ra.$c(ub),Wh.returnToContainingRow(Ra),mj.OutlineReader.jA(ub,aa,!1)&&vp.a.Usi(Ra)&&0>=aa.Fb&&(ua=qa.a.uRc,Wh.returnToContainingTable(ub),wg.OutlineElementNavigator.Zd(ub),O||(O=new ji.DictionaryPropertySet),O.Yg(Gd.a.targetObject,ub.currentNode.id))));ub=this.bTh(h,t,b,A,O,ua)}else nf.SelectionEditor.d8(aa)&&(ub=v.AFrameworkApplication.xa.Nf(h,qa.a.newLine,2,!1,A,O));Ok.a.mark(5014);return ub}ikj(b,h,t){let A=null,O=null;if(1===h)return{returnValue:!1,je:A,selected:O,Qx:32};if(!b.view.re)return{returnValue:!1,
je:A,selected:O,Qx:2};A=b.view;return(O=A.nb.pg)&&OA.Zf.ysi(O,t)?this.Rm&&this.Rm.instance&&this.Rm.instance.aU(O)?{returnValue:!1,je:A,selected:O,Qx:4}:{returnValue:!0,je:A,selected:O,Qx:2}:{returnValue:!1,je:A,selected:O,Qx:2}}ljo(b,h,t,A,O){let aa,ua;if(!({je:t,selected:aa,Qx:ua}=this.ikj(h,t,!0)).returnValue)return ua;const Ra=OA.Vg.DN(aa);for(let ub=0;ub<Ra.length;++ub){if(!Ra[ub].isValid)continue;const Nb=Ra[ub].iterator;Nb.Yo();if(mj.OutlineReader.Kw(Nb))return this.$Sh(t,Nb)}aa.Hw||nf.SelectionEditor.gl(aa)?
ua=this.aTh(h,t,b,A,O,qa.a.TUd):nf.SelectionEditor.Dk(aa)?ua=this.ZSh(h,t,b,A,O,qa.a.TUd):nf.SelectionEditor.jf(aa)?ua=this.bTh(h,t,b,A,O,qa.a.TUd):nf.SelectionEditor.d8(aa)&&(ua=v.AFrameworkApplication.xa.Nf(h,qa.a.newLine,2,!1,A,O));return ua}$Sh(b,h){b.nb.setSelection(wf.SelectionFactory.Yn(h.currentNode,!1));return 32}aTh(b,h,t,A,O,aa){const ua=new Te.GraphTransaction(15);ua.kk=t;ua.Eb(h.Zc);h=new ji.DictionaryPropertySet;h.setValue(Gd.a.LIc,!0);h=v.AFrameworkApplication.xa.Nf(b,qa.a.kH,2,!0,
A,h);32===h&&(h=v.AFrameworkApplication.xa.Nf(b,aa,2,!1,A,O));ua.dispose();return h}ZSh(b,h,t,A,O,aa){const ua=new Te.GraphTransaction(15);ua.kk=t;ua.Eb(h.Zc);h.nb.setSelection(nf.SelectionEditor.Bj(h.nb.hb.J(0),!1,!1));b=v.AFrameworkApplication.xa.Nf(b,aa,2,!1,A,O);ua.dispose();return b}bTh(b,h,t,A,O,aa){const ua=new Te.GraphTransaction(15,t);ua.kk=t;ua.Eb(h.Zc);b=v.AFrameworkApplication.xa.Nf(b,aa,2,!1,A,O);ua.dispose();return b}static get Vg(){return Ik.ContextSetEditor.instance}static get Zf(){return rl.a.instance}static get Xb(){return null!=
OA.kvg?OA.kvg:OA.kvg=Sa.a.instance.Ma("Box4.IFeatureHelper")}}Object(m.a)(OA,"AEnterViewStrategy",null,[1573]);class BJ extends OA{constructor(b,h,t){super(b,h,t)}SNl(){return qa.a.newLine}}Object(m.a)(BJ,"EnterViewStrategy",OA,[]);class WG{constructor(b){this.sl=this.transaction=null;this.je=b;this.vGc=this.io=0}}Object(m.a)(WG,"SelectAllArguments",null,[]);class NC{constructor(b,h,t){this.Srn=b;this.FQm=h;this.Is=t;this.Mql=(A,O,aa)=>O.view.Yi?this.yfb(O,aa,this.Joj):this.N5n(O,aa);this.F0c=(A,
O)=>O.io?1===O.io?(O.je.nb.P5c(O.sl,A),O.io=2,!0):2===O.io?(O.je.nb.hb.KZa=O.sl.KZa,this.Ug.QE(),O.transaction.ZGa(A),O.io=3,O.transaction.dispose(),Ok.a.mark(5799),!0):!1:(O.transaction=this.Is.Qc(2),O.transaction.Eb(O.je.Zc),O.io=1,!0);this.N5n=(A,O)=>{if(1===O)return 32;if(!A.view.re)return 2;A=A.view;return A.nb&&A.nb.hb&&A.nb.hb.lb?this.Joj(A).inProgress?1:32:8};this.Joj=A=>{v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");A.Yi&&u.ULS.sendTraceTag(39098306,
324,50,"Progress select all reach top");A=new Li.a(null,this.iCn,new WG(A));A.ul("SelectAllInOutline");A.run();return A};this.iCn=(A,O)=>{if(!O.io)return O.sl=wf.SelectionFactory.O5n(O.je.nb.hb.lb),O.transaction=this.Is.Qc(2),O.transaction.Eb(O.je.Zc),O.io=1,!0;if(1===O.io){if(!O.vGc)return O.je.nb.setSelection(O.sl.J(0),A),++O.vGc,!0;if(O.vGc<O.sl.length)return O.je.nb.Wnk(O.sl.J(O.vGc),A),++O.vGc,!0;O.io=2}return 2===O.io?(O.je.nb.hb.KZa=O.sl.KZa,this.Ug.QE(),O.transaction.ZGa(A),O.io=3,O.transaction.dispose(),
!0):!1}}get Ug(){return this.FQm.value}Ub(){const b=v.AFrameworkApplication.xa;b.pa(qa.a.dya,yc.a.frame,NC.ilj);b.pa(qa.a.x$f,yc.a.frame,NC.ilj);b.gb(qa.a.yfb,mc.a.view,this.Mql,2);b.gb(qa.a.GBa,mc.a.view,vf.AFrame.Gg,100);b.gb(qa.a.dLf,mc.a.view,NC.dLf,4)}yfb(b,h,t){if(1===h)return 32;if(!b.view.re)return 2;h=b.view;if(!h.nb)return 8;const A=h.nb.hb;if(!A||!A.length)return 8;Ok.a.mark(5798);Jb.App.ya.jb.isEditingAllowed||Jb.App.ya.jb.$x||h.Yi?b=nf.SelectionEditor.Rpf(A):(yd.FocusManager.instance().JC(vf.AFrame.$n),
b=wf.SelectionFactory.Dbj(h.Zc));if(!b)return 8;A.KZa||u.ULS.sendTraceTag(39098305,324,50,"Progress selection start");t&&this.Srn.yGb(nf.SelectionEditor.o3h(b))?t=t(h):(t=new WG(h),t.sl=b,t=new Li.a(null,this.F0c,t),t.ul("ExpandSelection"),t.run());return t.inProgress?1:32}static get z5a(){return null!=NC.PCg?NC.PCg:NC.PCg=Sa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static dLf(b,h,t){if(1===t)return 32;if(!h.view.re)return 8;b=h.view;h=wf.SelectionFactory.Yn(b.root.graphNode,!0);if(!h)return 8;
b.nb.setSelection(h);return 32}static ilj(){var b=Jb.App.ya.jb.ju;if(!b.re)return 2;if(b.re&&1!==Jb.App.ya.state){Ok.a.mark(4668);var h=b.nb.hb.lb;if(!h&&v.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;h=nf.SelectionEditor.R6(h);let t=h.x,A=h.y+h.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)t=b.x,A=b.y;NC.z5a.dya(new Sys.UI.Point(t,A),1);Ok.a.mark(4669)}return 32}}Object(m.a)(NC,"SelectAllHandlers",
null,[1425]);class CJ{Aee(){}}Object(m.a)(CJ,"FontNameFormattingStrategyNoop",null,[1548]);var QM=c(869);class $F{constructor(b,h,t,A,O,aa){this.sth=this.vth=null;this.Qq=b;this.rth=h;this.WDk=t;this.fEk=A;this.vth=O;this.sth=aa}}Object(m.a)($F,"BookmarkHighlightContext",null,[]);class DJ extends Zc.a{constructor(){super()}get Xaa(){return!0}get Jhb(){return 5}get m1a(){if(null!=this.L1)return this.L1;this.L1=[];this.L1.push(new vd.a(lm.a.wAd,lm.a.wAd));this.L1.push(new vd.a(lm.a.B1e,lm.a.B1e));this.L1.push(new vd.a(lm.a.WDc,
lm.a.WDc));return this.L1}ZFa(b,h){this.Xaa&&Fq.a.instance.he(()=>{const t=this.Uu.JCa;var A=this.Uu.zVc;if(t)if(5===t.type){A=t.eA;if(t.lJ&&t.lJ.Qq.includes(b))for(const O of h.uGa("*"))this.Uu.MRa(O);A&&A.Qq.includes(b)&&this.qnb(h,t.action,A,b)}else A&&5===A.type&&3===t.action&&A.eA.Qq.includes(b)&&this.qnb(h,0,A.eA,b)},"BHA:OPHC")}SPa(b){return Object(hc.a)($F,b)}D0a(b,h){if(b)for(const t of b.Qq)h.add(t)}qnb(b,h,t,A){0===h&&b.htmlElement&&Fq.a.instance.he(()=>{const O=b.uGa("*"),aa=O.length,
ua=lm.a.wAd;var Ra=A.id===t.vth,ub=A.id===t.sth;let Nb=!1;var Yb=0,bc=[];const Dc=Array(aa);for(let Cd=0;Cd<aa;Cd++){var Pc=O[Cd];const ee=Ie.a(Pc);Dc[Cd]=ee;const Od=Pc.classList;if(0!=Dc[Cd]){const fe=!Od.contains(lm.a.XF),Ee=ph.a.Db(Pc,lm.a.Qyb);Ee&&bc.push(...Ee);if(Ra){let re;if((re=ph.a.Db(Pc,lm.a.yAd))&&Ee&&1===re.length&&1===Ee.length&&re[0].equals(Ee[0]))continue;re&&(Yb+=re.length,1===ee?Od.add(lm.a.B1e):Od.add(ua));if(Ee)for(const Fg of Ee)this.YVd(t,Fg)&&(Yb--,Nb&&Od.add(lm.a.WDc));0!==
Yb&&fe&&Od.add(ua)}if(!Ra&&!ub&&t.fEk.has(A.id))if((Pc=ph.a.Db(Pc,lm.a.Qyb))&&Nb){Od.add(ua);for(const re of Pc)if(this.YVd(t,re)){Od.add(lm.a.WDc);break}}else fe&&Od.add(ua)}Nb=!Od.contains(lm.a.mfb)}if(ub&&!Ra){Ra=new Set;for(var jd of bc)this.YVd(t,jd)&&Ra.add(jd);Nb=!1;for(bc=0;0!==Ra.size&&bc<aa;bc++){Yb=O[bc];jd=Yb.classList;if(0!=Dc[bc])if(ub=!1,Yb=ph.a.Db(Yb,lm.a.Qyb)){for(const Cd of Yb)this.YVd(t,Cd)&&(Ra.delete(Cd),ub=!0);0!==Ra.size&&jd.add(ua);Nb&&ub&&jd.add(lm.a.WDc)}else jd.contains(lm.a.XF)||
jd.add(ua);Nb=!jd.contains(lm.a.mfb)}}},"BHA:SPH")}YVd(b,h){for(const t of b.WDk)if(h.equals(t))return!0;return!1}}Object(m.a)(DJ,"BookmarkHighlightActor",Zc.a,[434]);var aG=c(1847),EJ=c(1636);class bG{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb){var Yb;this.Lqi=!1;this.Of=b;this.UB=h;this.eb=O;this.kV=aa;this.Nj=ua;this.ge=Ra;this.jd=Nb;this.Na=ub;this.Lqi=null!==(Yb=null===ub||void 0===ub?void 0:ub.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckMultiRangeContextForTheme",!1))&&void 0!==Yb?Yb:
!1}b7f(b,h,t,A){const O=b.Wih(h);if(O){var aa=Object(hc.a)(EJ.a,b),ua=this.ge.eg("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",aa,t)),Ra=h.Yj.node,ub=()=>{t||this.removeImage(h.Yj,O.getId())};aa=bG.Muh();A=this.jvh(O.getId().toString(),Ra,A,t);try{b.gph(A,h)}catch(Nb){u.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Nb.message);this.Lp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);
return}this.Of.oj(aa,2,A.toString(),{},!0,0,Nb=>{u.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");b.Odc(Nb,O,()=>{this.Lp(b.fQd())},ub,Ra,h,ua)},Nb=>{const Yb=415===Nb.data.Ve;let bc="";Nb&&Nb.data&&Nb.data.vj&&"X-CorrelationId"in Nb.data.vj&&Nb.data.vj["X-CorrelationId"]&&(bc=Nb.data.vj["X-CorrelationId"]);b.Goa(`Graphics editor request failed. HttpStatus [${Nb.data.Ve}], ResponseData [${Nb.data.we}], CorrelationId [${bc}]`,
O,Ra,ub,()=>{this.Lp(Yb?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.fQd())},ua,Yb)},null)}else this.Lp(b.fQd())}w7n(b,h,t){return new Promise((A,O)=>{var aa=b.Yj,ua=null;ua=this.Lqi&&Kk.a.dCf(aa)?aa.getContext(0).node:aa.node;aa=bG.Muh();ua=this.jvh(h.toString(),ua,t,!1);ua.De(aG.a.$7e,"2");this.Of.oj(aa,2,ua.toString(),{},!0,0,Ra=>{u.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");A(Ra.data.we)},
Ra=>{u.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Ra.data.Ve}, ResponseData ${Ra.data.we}`);this.Lp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);O(null)},null)})}jvh(b,h,t,A){const O=h.Ei(),aa=new jb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");v.AFrameworkApplication.mea(aa);aa.De(aG.a.strict,this.hEm(h)?"true":"false");aa.De(ag.a.nodeId,b);aa.De(ag.a.cellId,O.Zm.toString());aa.De(ag.a.fileId,
O.Fs);aa.De(ag.a.gT,t.toString());aa.De(aG.a.zql,A?"true":"false");if(b=!!this.jd&&this.jd.isFeatureEnabled(47)){aa.De(Bh.a.hWi,b.toString());if(b=this.jd.isFeatureEnabled(88))aa.De(Bh.a.$vn,b.toString()),aa.De(Bh.a.ignoreMalformedColors,this.jd.isFeatureEnabled(54).toString());this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&aa.De(Bh.a.iwn,"true")}aa.De(Bh.a.Bsh,"true");tn.a.instance.gyb(aa);return aa}hEm(b){if(!this.UB)return!1;b=this.UB.Ms(b);return!!b&&b.Lf(Lc.a.RDf)}removeImage(b,
h){b.cpBegin===b.cpEnd-1&&this.Nj.$fc(b.node,h,this.eb,this.kV)}Lp(b){const h=new cf.StandardDialog;h.zd=0;h.Sw(nm.a.Ydf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);Jb.App.ya.updateCommandUI()}static Muh(){const b=new jb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");v.AFrameworkApplication.mea(b);return b.toString()}}Object(m.a)(bG,"GraphicsEditorRequestManager",null,[432]);class FJ extends sD{constructor(b,
h){super(b,h);this.gPa=qa.a.insertHyperlink}F1a(b){null!=b&&0<b.length&&this.rc.Rb(this.gPa,2,b[0])}fGj(b,h,t){const A=Sf.a.lg(v.AFrameworkApplication.lcid).name;b=String.format(b,v.AFrameworkApplication.lcid,A,v.AFrameworkApplication.buildVersion,h,FC.upe,t);b+="&flipgrid=1&ted=1";v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)&&(b=new jb.QueryStringBuilder(b),b.fK("stream2","1"),b=b.toString());return b}}Object(m.a)(FJ,
"InsertHubbleMediaHelper",sD,[]);class GJ{constructor(b,h,t,A,O,aa){this.ga=b;this.Na=h;this.Tjd=t;this.O1=A;this.ahd=O;this.Fk=aa}Ub(){this.ga.gb(Vc.a.ESi,mc.a.Vc,this.hqn.bind(this),1028);this.ga.gb(Vc.a.Jni,mc.a.Vc,this.Wtm.bind(this),1028)}Wtm(b,h,t,A,O){if(1!==t){if(null==O)return 16;if(!h.Xk||!nf.SelectionEditor.jf(h))return 2;b=this.GNl(O);O=O.OriginalUrl;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.ahd.sog(b,h,O)}return 32}TLj(){v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}GNl(b){const h=new CA;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;h.ProviderName=b.ProviderName;return h}hqn(b,h,t){var A,O;if(1!==t)h=F.a.FW(this.Na.kb("UserId")).toString(),h=this.O1.fGj(this.Na.appSettings.InsertVideoHubbleEndpoint,
Ya.a.create().toString(),h),this.O1.gPa=Vc.a.Jni,h=this.Tjd.qNc(h,!0),h.correlationId=Ya.a.create(),h.Zga=5,h.Kge(null,this.O1),ja.a.sendTelemetryEvent(Object.assign(new ta.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new sa.a,{name:"ActionId",int64:b})]})),this.TLj();else if(!(h&&h.node&&jD.a(h.node))||(null===(A=this.Fk)||void 0===A?0:A.JZ(h))||(null===(O=this.Fk)||void 0===O?0:O.Gna(h)))return 2;return 32}}Object(m.a)(GJ,"OnlineMediaActor",null,[]);class HJ extends pD{constructor(b,
h,t,A=null,O=!1){super(b,h,t,A,O);this.Psc=null}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}GCb(){const b={};b.insertMediaServiceEndpoint=this.Ujd;b.iFrameId="mediaiframe";return b}Kge(b,h){this.RSb=b;this.Psc=h;this.Frc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.GCb(),["componentIsVisibleCallback"]:this.VJj.bind(this)};this.Yh(this.RSb,null,b)}VJj(){this.F_=this.m6b(this.kj("mediaiframe"));this.OA=this.gqd.getInstance(this.F_.contentWindow,this.Ujd);this.OA.Sq(K.a.Ekh,
b=>{this.hMi(b,this.Psc.F1a.bind(this.Psc))});this.OA.Sq(K.a.insert,b=>{this.u5d(b,this.Psc.F1a.bind(this.Psc))});this.OA.Sq(K.a.r3h,this.dOi.bind(this));this.OA.Sq(K.a.getSessionId,this.gOi.bind(this));this.OA.Sq(K.a.c1h,this.cOi.bind(this));this.OA.Sq(K.a.tBd,this.QMi.bind(this));this.dnb(3)}dnb(b){const h=[];h.push(Object.assign(new sa.a,{name:"DialogResult",string:FA[b]}));h.push(Object.assign(new sa.a,{name:"DialogMode",string:this.upf()}));h.push(Object.assign(new sa.a,{name:"CorrelationId",
string:this.correlationId.toString()}));h.push(Object.assign(new sa.a,{name:"Provider",string:GA[this.Zga]||"Unknown"}));ja.a.sendTelemetryEvent(Object.assign(new ta.a,{name:this.telemetryEventName,dataFields:h}))}}Object(m.a)(HJ,"OnlineMediaDialog",pD,[]);class IJ{constructor(b,h){this.sCe=b;this.O1=h}qNc(b,h=!1){return new HJ(b,this.sCe,this.O1,null,h)}getInstance(){throw Error.notImplemented();}}Object(m.a)(IJ,"OnlineMediaDialogFactory",null,[433]);class JJ extends Fx{constructor(){super(1,3);
this.nL=Sa.a.instance.resolve("Common.IReactContextualUILauncher");this.Zrj=!1}Z5a(){v.AFrameworkApplication.xa.processAction(Vc.a.Cic,2)}ZId(){this.wXh&&!this.jv&&(this.jv=this.UJa())}OJd(){if(this.jv&&this.jv.isVisible){var b=Object(Da.a)(Uj.Control,this.jv.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.Ew(b.Cgb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)u.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");
else{var h=b.getBoundingClientRect();0<h.top&&h.bottom<window.innerHeight&&(h=b.getAttribute(Mf.a.Kzd)||"",Mf.a.NL===h&&b.click())}}r_(){return this.nL.r_}}Object(m.a)(JJ,"ExternalContentFloatieManager",Fx,[]);class Ls{constructor(){Ls.zrm()}get uc(){return null!=this.nGg?this.nGg:this.nGg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get zw(){return null}Vkc(b){var h=null;if(!qe.ParagraphReader.rh(b))return{returnValue:!1,Fla:h};if((b=this.uc.Uo(b.currentNode))&&
2===this.uc.vD(b)){const t=this.uc.jg(b);Ls.EP.contains(t)&&(h=this.uc.CK(b),h=Object.assign(new hy.a,{rG:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,Fla:h}}VCb(b,h){let t=null;h&&b.contentId.equals(h.contentId)||(t=b.contentObject);return t}static zrm(){Ls.EP=new sp.a;Ls.EP.add(Tf.StyleReader.styleIdHeading1);Ls.EP.add(Tf.StyleReader.styleIdHeading2);Ls.EP.add(Tf.StyleReader.styleIdHeading3);Ls.EP.add(Tf.StyleReader.r6a);Ls.EP.add(Tf.StyleReader.mOb);Ls.EP.add(Tf.StyleReader.nOb);
Ls.EP.add(Tf.StyleReader.qjc);Ls.EP.add(Tf.StyleReader.pjc);Ls.EP.add(Tf.StyleReader.wordStyleIdHeading1);Ls.EP.add(Tf.StyleReader.wordStyleIdHeading2);Ls.EP.add(Tf.StyleReader.wordStyleIdHeading3);Ls.EP.add(Tf.StyleReader.E7a);Ls.EP.add(Tf.StyleReader.F7a);Ls.EP.add(Tf.StyleReader.G7a);Ls.EP.add(Tf.StyleReader.Fpb);Ls.EP.add(Tf.StyleReader.Gpb);Ls.EP.add(Tf.StyleReader.H7a);Ls.EP.add(Tf.StyleReader.L7a);Ls.EP.add(Tf.StyleReader.fmc)}}Ls.EP=null;Object(m.a)(Ls,"ParagraphStyleDetailsProvider",null,
[58,59]);class KJ{constructor(b,h,t,A){this.ZJa=b;this.J3j=h;this.R3j=t;this.S3j=A}c1f(){this.ZJa.execute(b=>{b.Ufc(this.J3j.value);b.Ufc(new Ls);b.Ufc(this.S3j.value);b.g4(this.R3j.value)})}}Object(m.a)(KJ,"AccessibilityActor",null,[]);class LJ{constructor(b,h,t){this.$h=null;this.K6c=(A,O,aa)=>{if(1===aa)return 32;this.$h=this.uqc.value.d1k(this.Vb);if(!this.$h)return u.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.$h.FSa();return 32};this.Dih=A=>this.$h?
this.$h.Kgm(A):2;this.ga=b;this.uqc=h;this.Vb=t}Ub(){if(v.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=sb.KeyInputManager.mc(rc.a.Upb,5);this.Vb.fe(vf.AFrame.$n).Xq(b);this.Vb.fe(vf.AFrame.qp).bindAction(b,ab.a.K6c);this.ga.pa(ab.a.K6c,yc.a.frame,this.K6c);this.ga.pa(ab.a.eCc,yc.a.frame,this.Dih);this.ga.pa(ab.a.dCc,yc.a.frame,this.Dih)}}}Object(m.a)(LJ,"AccessibilityHelpDialogActor",null,[]);var RM=c(1034),SM=c(1393);class MJ{constructor(b,h){this.CZj=b.pc("WordHangForActionManagerThresholdTime",
750);this.ga=h;this.aOj=RM.a.GE(26,5,new SM.a)}fR(){this.ga.fR(this)}U3(){}T3(b){const h=+b.endTime-+b.startTime;if(h>this.CZj){let t="";switch(b.behavior){case 1:t="E";break;case 2:t="X";break;case 3:t="A"}(b=Kf.ActionManager.Q$(b.actionId))&&b.length||(b="UnknownAction");this.aOj.track(h,b+"_"+t)}}}Object(m.a)(MJ,"ActionHangDetector",null,[38]);var NJ=c(1473);class OJ extends Oh{constructor(b){super(b,void 0,v.AFrameworkApplication.XZa,new Gi(b,!1))}get C3a(){return this.vWd?CommonUIStrings.l_DownloadACopyDialog_CopyALinkText:
this.GWd?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get Bbc(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get gWc(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get uHc(){return v.AFrameworkApplication.XZa?"UIFontDialogTextLarge":null}get vWd(){return 1===v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}get GWd(){return 2===
v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}OHf(){u.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed");v.AFrameworkApplication.loa("t1shrdnl;t2shrdnl;c-shrdnl")}PHf(){u.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}zWc(){u.ULS.sendTraceTag(19462214,324,50,"Download a copy dialog button clicked");v.AFrameworkApplication.xa.processAction(ab.a.ZPh,2)}t8e(){this.A7({SourceControlId:"CopyLink"},{ControlId:"CopyLink"})}iRh(){this.A7({SourceControlId:"Share"},
{ControlId:"Share"})}A7(b,h){const t=v.AFrameworkApplication.xa;t.iD=8;t.Rb(ab.a.A7,2,b,h)}}Object(m.a)(OJ,"DownloadACopyDialog",Oh,[]);var cG;(function(b){b[b.Unknown=0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.Publisher=7]="Publisher";b[b.Infopath=8]="Infopath";b[b.Access=9]="Access"})(cG||(cG={}));Object(m.b)("OfficeApplication",cG);var fF;(function(b){b[b.ReadWrite=0]="ReadWrite";
b[b.ReadOnly=1]="ReadOnly";b[b.WriteOnly=2]="WriteOnly";b[b.ForceCheckout=3]="ForceCheckout";b[b.WriteLocalCopy=4]="WriteLocalCopy";b[b.OpenInBrowser=5]="OpenInBrowser"})(fF||(fF={}));Object(m.b)("OpenDocumentMode",fF);class PJ extends Pf.a{constructor(){super(!1,!1,!0)}V6d(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};
const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.Yh("Send feedback to Microsoft",
this.$do.bind(this),b);return new Promise(t=>{this.I6j=t})}$do(b,h){1===b&&this.pR(h.selectedReason)}dispose(){super.dispose();this.I6j()}pR(b){const h={},t={},A={},O={},aa={};h.appId=2155;h.manifestType="Fps";h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=Ya.a.create().toString();aa.reason=b;const ua={},Ra={numberOfOptions:5};Ra.selectedRating=b;ua.rating=[Ra];O.surveySpecificData=JSON.stringify(ua);A.extendedManifestData=JSON.stringify(O);h.application=
A;aa.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=aa;h.telemetry=this.Zyb();h.web=this.fEc();t["Content-Type"]="application/json";this.xGa(JSON.stringify(h),t)}T$(b,h,t,A){h&&b&&A&&t&&A in h&&(b[t]=h[A])}Zyb(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=v.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.T$(h,b,"audienceGroup","AudienceGroup");this.T$(h,b,"osBuild","OsVersion");this.T$(h,b,"platform","Platform");this.T$(h,b,"processSessionId",
"WACSessionID");return h}fEc(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};this.T$(h,b,"browser","Browser");this.T$(h,b,"browserVersion","BrowserVersion");this.T$(h,b,"dataCenter","WACDatacenter");return h}xGa(b,h,t=0){let A=0;3<t||(1===t?A=200:1<t&&(A=200+500*(t-1)),v.AFrameworkApplication.oc.Wb(new Vb.a(2,1,A,()=>{v.AFrameworkApplication.Ke.oj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{u.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},
()=>{this.xGa(b,h,t+1);u.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",t)},null)})))}}Object(m.a)(PJ,"WordOpenInClientFeedbackDialog",Pf.a,[]);var QJ=c(1745);const pE=b=>{for(let h=0;h<b.children.length;h++){const t=b.children[h];t.style.position="relative";t.style.top=(t.parentNode.offsetHeight-t.offsetHeight)/2+"px"}},dG=b=>b.Ib.keyCode===rc.a.ks||b.Ib.keyCode===rc.a.rIa?(b.zf.click(),!0):!1,gF=(b,h,t,A,O,aa,ua)=>{const Ra=document.createElement("a");
Ra.className="ProtocolLaunchingDialogButtonAnchor";Ra.className+=" OICDialog";Ra.id=b;Ra.setAttribute(Mf.a.oh,Mf.a.z2);Ra.style.padding="0";Ra.style.margin="0";A&&RJ(O,h,t,A,Ra);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=O;Ra.appendChild(b);Ra.tabIndex=0;aa&&Pd.a.instance.mb(db.a.click,Ra,aa);ua&&sb.KeyInputManager.instance.mb(db.a.sh,Ra,ua);return Ra},RJ=(b,h,t,A,O)=>{var aa=document.createElement("img");aa.alt=b;aa.className=dh.getImageClassWithCluster(t,
A);aa.src=h;aa.setAttribute(Mf.a.oh,Mf.a.Ny);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(aa);aa=document.createElement("span");aa.className="ProtocolLaunchingDialogIconContainer";aa.appendChild(b);O.appendChild(aa)};class eG{static get Wg(){return Pf.a.Xz(eG.Hm,CommonUIStrings.l_OICLaunchDialogTitle)}}eG.Hm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(eG,"OICLaunchDialogHtml",null,[]);class SJ extends Pf.a{constructor(b){super();this.zRb=this.Cqb=null;this.YR=!1;this.gq=b;this.Wg=eG.Wg;this.zd=5;this.sg="OICLaunchDialog";this.showDialog("",Object(z.a)(this,this.kdn,"oicLaunchDialogResultHandler"));this.zfj();this.s4("ProtocolLaunchingDialogTitle");4!==v.AFrameworkApplication.ta.Ob.zNa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.l0(this.Cqb);u.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}E8(){this.Cqb=gF("BtnRichClient",this.gq.IIc,this.gq.KQc,this.gq.Ewf,CommonUIStrings.l_OICLaunchRichClient,Object(z.a)(this,this.FQi,"onRichClientButtonClick"),dG);document.getElementById("OICLaunchRichClient").appendChild(this.Cqb);pE(this.Cqb);this.zRb=gF("BtnReturn",this.gq.IIc,this.gq.KQc,this.gq.sli,CommonUIStrings.l_OICReturnToOnlineClient,Object(z.a)(this,this.zQi,"onReturnButtonClick"),
dG);document.getElementById("OICReturnToApp").appendChild(this.zRb);pE(this.zRb)}zQi(){this.hide();this.gq.qgc();return!0}FQi(){u.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();v.AFrameworkApplication.xa.processAction(ab.a.lMb,2);return!0}kdn(){this.gq.qgc()}dispose(){this.YR||(this.Cqb&&(Pd.a.instance.sc(db.a.click,this.Cqb,Object(z.a)(this,this.FQi,"onRichClientButtonClick")),sb.KeyInputManager.instance.sc(db.a.sh,this.Cqb,dG)),this.zRb&&(Pd.a.instance.sc(db.a.click,
this.zRb,Object(z.a)(this,this.zQi,"onReturnButtonClick")),sb.KeyInputManager.instance.sc(db.a.sh,this.zRb,dG)),super.dispose(),this.YR=!0)}}Object(m.a)(SJ,"OICLaunchDialog",Pf.a,[]);class fG{static get Wg(){return Pf.a.Xz(fG.Hm,CommonUIStrings.l_OICDialogTitle)}}fG.Hm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(fG,"ProtocolLaunchingDialogV2Html",null,[]);class TJ extends Pf.a{constructor(b){super();this.yRb=this.hUa=null;this.YR=!1;this.E8a=null;this.gq=b;this.Wg=fG.Wg;this.zd=5;this.sg="ProtocolLaunchingDialog";this.Upc="OICRetryDialog";v.AFrameworkApplication.oc.GEb&&v.AFrameworkApplication.oc.restart();v.AFrameworkApplication.oc.Wb(new Vb.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(z.a)(this,this.dZf,"protocolLaunchingDialogResultHandler"));this.zfj();this.s4("Issues");
this.OXh();u.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}E8(){const b=document.getElementById("Issues");if(b){RJ("",this.gq.IIc,this.gq.KQc,this.gq.Ewf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.gq.rSi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);pE(b);b.style.display="none"}v.AFrameworkApplication.ta.Ob.agi?
(this.yRb=gF("GiveFeedback",this.gq.IIc,this.gq.KQc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(z.a)(this,this.g5d,"onGiveFeedbackClick"),Object(z.a)(this,this.iOi,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.yRb),pE(this.yRb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===v.AFrameworkApplication.ta.Ob.zNa||v.AFrameworkApplication.Zfl?document.getElementById("ButtonEdit").style.display="none":(this.hUa=
gF("Edit",this.gq.IIc,this.gq.KQc,"",2===v.AFrameworkApplication.ta.Ob.jm?4===v.AFrameworkApplication.ta.Ob.zNa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===v.AFrameworkApplication.ta.Ob.zNa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(z.a)(this,this.KNi,"onEditClick"),Object(z.a)(this,this.NNi,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.hUa),pE(this.hUa));0===v.AFrameworkApplication.ta.Ob.zNa&&
!v.AFrameworkApplication.pCf&&b&&(b.style.display="none")}PXh(){return this.E8a?(this.l0(this.E8a),!0):!1}OXh(){return this.hUa?(this.l0(this.hUa),!0):!1}NNi(b){return this.jQf(b,0)}iOi(b){return this.jQf(b,2)}yQi(b){return this.jQf(b,1)}jQf(b,h){let t=!1;if(b.Ib.keyCode===rc.a.ks||b.Ib.keyCode===rc.a.rIa)b.zf.click(),t=!0;else if(b.Ib.keyCode===Sys.UI.Key.down||b.Ib.keyCode===Sys.UI.Key.up)switch(h){case 1:t=this.OXh();break;case 0:t=this.PXh()}return t}KNi(){this.hide();4===v.AFrameworkApplication.ta.Ob.zNa?
(u.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.gq.qgc()):(u.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.gq.gPc());return!0}g5d(){u.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}PRf(){nM.Redirect.showHelp("OICFailure");return!0}f6d(){u.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";v.AFrameworkApplication.xa.processAction(ab.a.lMb,2);return!0}dZf(){this.gq.qgc()}switchToBackupMode(){var b=
document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!b.children.length&&(this.E8a=gF("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(z.a)(this,this.f6d,"onRetryOICClick"),Object(z.a)(this,this.yQi,"onRetryOICKeyUp")),b.appendChild(this.E8a),pE(this.E8a),this.hUa||this.PXh())}}dispose(){this.YR||(this.hUa&&
(Pd.a.instance.sc(db.a.click,this.hUa,Object(z.a)(this,this.KNi,"onEditClick")),sb.KeyInputManager.instance.sc(db.a.sh,this.hUa,Object(z.a)(this,this.NNi,"onEditKeyUp"))),this.yRb&&(Pd.a.instance.sc(db.a.click,this.yRb,Object(z.a)(this,this.g5d,"onGiveFeedbackClick")),sb.KeyInputManager.instance.sc(db.a.sh,this.yRb,Object(z.a)(this,this.iOi,"onGiveFeedbackKeyUp"))),this.E8a&&(Pd.a.instance.sc(db.a.click,this.E8a,Object(z.a)(this,this.f6d,"onRetryOICClick")),sb.KeyInputManager.instance.sc(db.a.sh,
this.E8a,Object(z.a)(this,this.yQi,"onRetryOICKeyUp"))),super.dispose(),this.YR=!0)}}Object(m.a)(TJ,"ProtocolLaunchingDialog",Pf.a,[]);class gG extends cf.StandardDialog{constructor(b){super();this.gq=b;this.sg="ProtocolLaunchingDialog";v.AFrameworkApplication.oc.GEb&&v.AFrameworkApplication.oc.restart();v.AFrameworkApplication.ta.Ob.agi&&this.wlk(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(z.a)(this,this.g5d,"onGiveFeedbackClick"));gG.Zhi?(this.zd=12,this.Ge(1,CommonUIStrings.l_CloseFile),
this.Ge(2,CommonUIStrings.l_OICDialogContinueHere),this.Ge(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.zd=4,this.Ge(1,CommonUIStrings.l_OICDialogContinueHere),this.Ge(2,CommonUIStrings.l_OICDialogLaunchAgain));this.pkb(CommonUIStrings.l_OICDialog2ndTitle,5===this.gq.rSi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(z.a)(this,this.dZf,"protocolLaunchingDialogResultHandler"),null)}g5d(b){u.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.TNi(b)}f6d(){u.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");v.AFrameworkApplication.xa.processAction(ab.a.lMb,2)}dZf(b){gG.Zhi?3===b?this.n9i():2===b||0===b?this.continueEditing():1===b&&this.closeDocument():2===b?this.n9i():(1===b||0===b)&&this.continueEditing()}closeDocument(){u.ULS.sendTraceTag(577783557,211,50,"Closing the document");v.AFrameworkApplication.xa.Rb(ab.a.close,2,rj.a)}n9i(){u.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(z.a)(this,this.f6d,
"onRetryOICClick"),0)}continueEditing(){4===v.AFrameworkApplication.ta.Ob.zNa||v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===v.AFrameworkApplication.ta.mode?(u.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.gq.qgc()):(u.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.gq.gPc())}static get Zhi(){return v.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===v.AFrameworkApplication.xa.processAction(ab.a.close,
1)}}Object(m.a)(gG,"StandardProtocolLaunchingDialog",cf.StandardDialog,[]);class UJ{}Object(m.a)(UJ,"EditDocumentInClientParams",null,[]);class XG{static yQh(b,h,t,A,O,aa,ua=!1,Ra=!1,ub="",Nb=!1,Yb=!1,bc=!1,Dc="",Pc="",jd="",Cd=!1,ee=""){const Od=new UJ;Od.DocumentUrl=b;Od.DocumentExtension=ee;Od.Mode=h;Od.Options=t;Od.Application=A;Od.SilentExternalHandler=ua;Od.EncodeUrl=Ra;Od.CorrelationIdForWinClient=ub;Od.NavigateUsingWindowOpen=Nb;Od.DescriptiveUnattemptedEnums=Yb;Od.NoBrowserModalDialogs=bc;
Od.SessionOrigin=Dc;Od.CorrelationId=Pc;Od.ClickTime=jd;Od.NewTelemetryDataIsEnabled=Cd;MSOJS.ClientUtils.EditDocumentInClient(Od,O,aa)}}Object(m.a)(XG,"ClientUtils",null,[]);var TM=c(416),VJ=c(949);class HD{constructor(b){this.DWa=this.Tqc=this.Ooc=null;this.hsc=!1;this.Mwe=this.zHe=this.W4g=null;this.Sdd=this.Ay=this.Qsd="";this.application=this.Fy=0;this.Sxo=this.$dg=!1;this.iTo=b&&v.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");v.AFrameworkApplication.xa.VZ(ab.a.lMb)||v.AFrameworkApplication.xa.pa(ab.a.lMb,
yc.a.frame,Object(z.a)(this,this.f1n,"retryOpenInClientAction"));this.Omj=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("SilentExternalHandler")}get rSi(){return this.Fy}Kgo(b,h="",t=""){this.Ay=t||Ya.a.create().toString();this.Qsd=h||TM.a.h9h();this.Sdd=b}f1n(b,h,t){return h.contextId!==yc.a.frame?2:1===t?32:this.lMb()}get options(){let b=0;v.AFrameworkApplication.iZn&&(b|=1);v.AFrameworkApplication.xSi&&(b|=4);this.Lxo()&&(b|=64);return b}Lxo(){return!(2===this.application&&v.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get IIc(){return v.AFrameworkApplication.Ks}get KQc(){return v.AFrameworkApplication.Yaa}get sli(){return""}get Ewf(){return""}get Rxo(){return v.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get yBo(){return this.W4g||
(this.W4g=Sa.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.$dg||this.Wpl()}qgc(){this.Sxo||this.WTh()}P0i(b){return this.iTo&&ba.a.si?(new SJ(this),32):this.eDh(b)}eDh(b){const h=({Yob:b}=this.MPm(b)).returnValue;u.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}begin(b,h,t,A,O,aa,ua=""){this.Ooc=b;this.Mwe=ua;this.Tqc=h;this.DWa=aa;this.application=t;this.Fy=A;return v.AFrameworkApplication.fQh?(this.LAi(),32):v.AFrameworkApplication.ioa&&
!v.AFrameworkApplication.Xji?(v.AFrameworkApplication.zbg(),8):this.Hsh(O)}get jdn(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}lMb(){this.jdn&&this.eWm();return this.eDh(this.hsc)}Ncj(){const b=new VJ.a(K.a.openInClient);b.Values["ui-language"]=v.AFrameworkApplication.lcid.toString();b.Values[DC.a.sKh]=v.AFrameworkApplication.userSessionId;return this.DWa.value.send(b)?32:8}eWm(){wa.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Hb.a,{inStaging:!0}))}l8n(b){const h=new VJ.a(K.a.cWo);h.Values["ui-language"]=v.AFrameworkApplication.lcid.toString();h.Values[DC.a.sKh]=v.AFrameworkApplication.userSessionId;h.Values[J.a.bWo]=b;this.DWa.value.send(h)}MPm(b){this.hsc=b;this.l8n(5===this.Fy?HD.Qpn:HD.Xpn);return 5===this.Fy?this.LPm():this.PPm()}LPm(){this.VAi();return{returnValue:32,Yob:"HostEditUrl,"}}PPm(){let b;var h=b="";v.AFrameworkApplication.zlh&&(h="|f|"+v.AFrameworkApplication.userSessionId);
const t=v.AFrameworkApplication.K.$("IsAssignmentMode")&&v.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||v.AFrameworkApplication.RUc||ba.a.QPa,A=v.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),O=v.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(v.AFrameworkApplication.xa.H3d){var aa=v.AFrameworkApplication.xa.lX(3588168074);aa&&this.Kgo(aa.epochClickTime,aa.sessionOrigin,aa.correlationId);this.UDi()}if(v.AFrameworkApplication.oXi){b+="NewOrder,";
aa=8;this.DWa&&this.DWa.value&&this.DWa.value.isEnabled()&&v.AFrameworkApplication.Blc&&(b+="Post,",aa=this.Ncj());if(32===aa)return{returnValue:aa,Yob:b};u.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return v.AFrameworkApplication.Mt.Joa?(u.ULS.shipAssertTag(5566816,211,!!v.AFrameworkApplication.Mt.Joa),b+="HostUrl,",{returnValue:v.AFrameworkApplication.ta.qU(!0,v.AFrameworkApplication.Mt.Joa),Yob:b}):this.Ooc?(u.ULS.sendTraceTag(18715405,211,15,
"Try to open doc in rich client, SessionId {0}",v.AFrameworkApplication.userSessionId),b+="DocUrl,",XG.yQh(this.Ooc,this.Fy,this.options,this.application,Object(z.a)(this,this.MNi,"onEditInClientSuccess"),Object(z.a)(this,this.LNi,"onEditInClientFailure"),this.Omj,v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,t,A,O,this.Qsd,this.Ay,this.Sdd,v.AFrameworkApplication.xa.H3d,this.Mwe),{returnValue:32,Yob:b}):{returnValue:8,Yob:b}}b+="OldOrder,";if(!this.Ooc&&v.AFrameworkApplication.Mt.Joa)return this.DWa&&
this.DWa.value&&this.DWa.value.isEnabled()&&v.AFrameworkApplication.Blc?(b+="Post,",h=this.Ncj()):(u.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(u.ULS.shipAssertTag(22595484,211,!!v.AFrameworkApplication.Mt.Joa),b+="HostUrl,",{returnValue:v.AFrameworkApplication.ta.qU(!0,v.AFrameworkApplication.Mt.Joa),Yob:b}):{returnValue:h,Yob:b};u.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",v.AFrameworkApplication.userSessionId);
b+="DocUrl,";XG.yQh(this.Ooc,this.Fy,this.options,this.application,Object(z.a)(this,this.MNi,"onEditInClientSuccess"),Object(z.a)(this,this.LNi,"onEditInClientFailure"),this.Omj,v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,t,A,O,this.Qsd,this.Ay,this.Sdd,v.AFrameworkApplication.xa.H3d,this.Mwe);return{returnValue:32,Yob:b}}mYn(b){v.AFrameworkApplication.Om.setDw(8981,b)}MNi(b){this.mYn(b);u.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?
(this.Rxo||this.VAi(),this.UDi()):this.$dg||this.closeApplication()}LNi(b,h=0){u.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const t=!!this.Tqc&&!this.hsc;let A=0;1===b&&(A=2);6<=b&&13>=b&&(A=1,1===h&&(this.$dg=!0));this.yBo.Ucn?(u.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",A),QJ.a.instance.N5k(this.hsc?Object(z.a)(this,this.TLi,
"oicErrorDialogHandlerCloseForced"):Object(z.a)(this,this.ULi,"oicErrorDialogHandlerNoCloseForced"),t?Object(z.a)(this,this.KOi,"onLaunchDownload"):null,this.ZNh(!1)?Object(z.a)(this,this.lmm,"iHaveOfficeButtonHandler"):null,A,h)):(u.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",A),QJ.a.instance.L5k(this.hsc?Object(z.a)(this,this.TLi,"oicErrorDialogHandlerCloseForced"):Object(z.a)(this,this.ULi,"oicErrorDialogHandlerNoCloseForced"),t?Object(z.a)(this,this.KOi,"onLaunchDownload"):
null,A))}}UDi(){try{const b=[Object.assign(new sa.a,{name:"CorrelationId",string:this.Ay}),Object.assign(new sa.a,{name:"SessionOrigin",string:this.Qsd}),Object.assign(new sa.a,{name:"ClickTime",string:this.Sdd}),Object.assign(new sa.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];lb.a("OpenInClientCompleted",!0,0,b)}catch(b){u.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}VAi(){v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.VE&&
v.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?new gG(this):new TJ(this)}TLi(){this.closeApplication()}ULi(){this.qgc()}KOi(){this.LAi()}lmm(){return this.ZNh(!0)}ZNh(b){const h=(ba.a.cTc||ba.a.Rt)&&!!v.AFrameworkApplication.rHd;h&&b&&(ff.a.km(v.AFrameworkApplication.rHd,"_blank",void 0,"OpenInClient"),this.closeApplication());return h}}HD.Xpn="OpenInDesktop";HD.Qpn="OpenInBrowser";Object(m.a)(HD,"AOpenInClientOperation",null,[]);class YG extends HD{constructor(b,h,t=!1){super(t);
this.O_j=b;this.N_j=h}get sli(){return this.N_j}get Ewf(){return this.O_j}Wpl(){v.AFrameworkApplication.xa.Rb(ab.a.close,2,rj.a)}WTh(){}Hsh(b){return this.P0i(b)}LAi(){u.ULS.shipAssertTag(5566817,211,!!this.Tqc);v.AFrameworkApplication.hba?v.AFrameworkApplication.ta.qU(!0,this.Tqc):ff.a.km(this.Tqc,void 0,void 0,"LaunchDownload")}gPc(){v.AFrameworkApplication.ta.Ob.gPc()}}Object(m.a)(YG,"OpenInClientOperation",HD,[]);class WJ extends YG{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",
!0);this.ERn=b=>{u.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");Jb.App.A0.forceOutbound(this.ISi,this.CVm,b)};this.CVm=b=>{u.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new cf.StandardDialog;h.zd=0;h.Sw(nm.a.IJo,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.AVm:this.BVm)};this.AVm=()=>{v.AFrameworkApplication.xa.Rb(ab.a.close,2,rj.c)};this.BVm=()=>{Jb.App.ya.refreshDocument(null)};this.ISi=
b=>{v.AFrameworkApplication.d8c=!0;u.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);this.P0i(b)}}WCk(b){Jb.App.jk.MQa.R8b||Jb.App.xd.zA.eo?(u.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.ISi(b)):Sv.a.jQ(4,!0,this.ERn,null,b)}Hsh(b){this.WCk(b);return 32}WTh(){Jb.App.ya.refreshDocument(null)}}Object(m.a)(WJ,"OpenInWordOperation",YG,[]);const XJ=(b,h)=>{u.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");
b[Ng.a.On]=Lk.PageReader.instance.Yu(h);Lk.PageReader.instance.Yu(h)?b[Ng.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:b[Ng.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},UM=(b,h,t,A,O)=>{if(!Jb.App.ya||!Jb.App.ya.jb||!v.AFrameworkApplication.qn.lgb)return 8;h=Jb.App.ya.jb.Wc;if(!h)return 8;if(b===qa.a.Q9d&&2===t){b=new Te.GraphTransaction(15);try{b.Eb(h),Lk.PageReader.instance.pDo(h)}finally{b&&b.dispose()}XJ(O,h)}return 32},VM=(b,h,t,A,O)=>{if(!Jb.App.ya||
!Jb.App.ya.jb)return 8;b=Jb.App.ya.jb.Wc;if(!b)return 8;O[Ng.a.Alt]=v.AFrameworkApplication.qn.lgb?"":CommonUIStrings.l_ProtectDocumentToolTip;XJ(O,b);return 32};class YJ extends NJ.a{constructor(b,h){super(b,h);this.aZg=!1;this.rPi=(t,A,O,aa,ua)=>{var Ra;if(A.contextId!==yc.a.frame)return 2;if(!(Jb.App.rFc||v.AFrameworkApplication.Mt.Joa||v.AFrameworkApplication.Blc||this.aZg))return u.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.aZg=!0,8;if(1===O)return fc.SessionStatusManager.instance.xj?
8:32;let ub=!1;void 0!==ua&&null!==ua&&(ub=ua);if(null===(Ra=v.AFrameworkApplication.K)||void 0===Ra?0:Ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",!1))(new PJ).V6d().then(()=>this.SJb(t,ub));else return this.SJb(t,ub);return 32};this.xlc=(t,A,O)=>{2==O&&(lb.a("OpenFileFromPC"),Jb.App.Ufb(v.AFrameworkApplication.breadcrumbBrandUrl));return 32};this.$hl=t=>{this.UWm();if(!v.AFrameworkApplication.RUc&&v.AFrameworkApplication.ta.Ob.I$f(ab.a.downloadACopy.toString()))this.Vxa(!0,
K.a.download,!0,{});else if(v.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let A=v.AFrameworkApplication.pBb;t&&t.FileDownloadUrl&&(A=t.FileDownloadUrl.toString());new OJ(A)}else super.downloadACopy(0,null,2,null,null)};this.fLk=t=>{super.workflow(0,null,2,null,t)};this.mI=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback")}Ub(){super.Ub();this.ga.pa(qa.a.openInClient,yc.a.frame,this.rPi);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",
!1)&&this.ga.Uc(qa.a.openInClient,12288);var b=this.ga;b.gb(qa.a.Q9d,mc.a.application,UM,4);b.gb(qa.a.e_f,mc.a.application,VM,96);this.ga.pa(ab.a.VTf,yc.a.frame,this.rPi);this.ga.pa(qa.a.xlc,mc.a.view,this.xlc)}SJb(b,h){u.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new WJ).begin(Jb.App.rFc,v.AFrameworkApplication.pBb,cG.Word,b===ab.a.VTf?fF.OpenInBrowser:fF.WriteOnly,h,new Pg.a(()=>this.vX))}jAd(b){return zj.a.instance.iCa()?!0:Jb.App.ya.gaj(1,Hh.AppFrame.$Sk,
b)}downloadACopy(b,h,t,A,O){if(2===t){if(!v.AFrameworkApplication.pBb&&!v.AFrameworkApplication.ta.Ob.I$f(ab.a.downloadACopy.toString()))return 8;Sv.a.jQ(2,!0,this.$hl,null,O);this.woe();return 32}return super.downloadACopy(b,h,t,A,O)}woe(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.mI&&(u.ULS.sendTraceTag(509145740,306,50,"DownloadCopyIntercept logged for: DownloadACopy"),this.mI.execute(b=>b.logActivity("DownloadCopyIntercept",
null)))}UWm(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.mI&&this.mI.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,t,A,O){return 2===t?(Sv.a.jQ(13,!0,this.fLk,null,O),32):super.workflow(b,h,t,A,O)}}Object(m.a)(YJ,"AppFrameCommandUIActor",NJ.a,[]);class ZJ extends cf.StandardDialog{constructor(){super();this.zd=0;this.pkb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,
CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(m.a)(ZJ,"WheresTheSaveButtonDialog",cf.StandardDialog,[]);const WM=(b,h,t)=>{if(1===t)return 32;new ZJ;return 32};var ZG=c(565),$J=c(1363);class rt extends Yi.a{constructor(b,h,t,A,O,aa,ua=null){var Ra,ub;super();this.goa=ua;this.RQj=50;this.SQj=56;this.Vxc="px";this.ire="aria-label";this.RIa="BookmarkIndicator";this.UUg="HighlightBookmarkedContent";
this.VZj="HighlightBookmark";this.mVa="wwaengidc";this.hEk="Bookmark_24";this.eb=b;this.hg=t;this.nk=h;this.FV=A;this.zz=O;this.WQj=null===(Ra=v.AFrameworkApplication.K)||void 0===Ra?void 0:Ra.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);this.NQj=null===(ub=v.AFrameworkApplication.K)||void 0===ub?void 0:ub.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkHighlightIsEnabled",!1);this.zz&&this.zz.pyd(this.rB.bind(this));this.eI=aa}Ojo(b){if(b.yj){for(const h of b.Rg.Pi)if(this.sjj(h))return!0;
return!1}return this.sjj(b.htmlElement)}Lnb(b){let h=!1;v.AFrameworkApplication.ye("bookmarks-core-ex;bookmarks-core-ex-cf");this.WQj&&Fq.a.instance.he(()=>{h=this.Ojo(b)},"BIA:SCIVE");return h}sjj(b){return rt.hQe?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}reb(b){const h=[];Fq.a.instance.he(()=>{const t=b.xdb(0,this.eI?this.SQj:this.RQj,this.zoom);h.push(this.GCa(b.b4,t,b.Vlc[0].y-b.cba[0].y))},"BIA:CIs");return h}GCa(b,h,t){const A=
b.Og.ownerDocument,O=lj.a.createElement(A,Sh.a.div);O.className=this.eI?rt.VQj:rt.Yre;rt.Yre;O.style.left=h+this.Vxc;O.style.top=t+this.Vxc;this.eI?(h=lj.a.createElement(A,Sh.a.div),Rh.a("renderIcon")&&appChrome.api.renderIcon(this.hEk,h),h.setAttribute("role","img"),h.setAttribute("alt","Bookmark")):(h=lj.a.createElement(A,Sh.a.r1a),h.src=tl.a.Bg(rt.pdd),h.alt="Bookmark");h.title="Bookmark";h.setAttribute(this.ire,"Bookmark");O.appendChild(h);b={context:new $F([],O,new Set,new Set,null,null),nPf:b,
container:O};this.eI||(this.nk.mb(db.a.SQ,h,this.onMouseEnter),this.nk.mb(db.a.LK,h,this.Eoa));this.hg.JD(db.a.click,O,this.MFa.bind(this),b);return O}BCd(){const b=Object.assign(new Jg.a,{action:1,type:5,eA:null,lJ:this.hda});this.hda=null;this.FV.gF(b)}rB(b,h){this.hda&&(h.w_a.zf.classList.contains("BookmarkHighlightSelected")||this.BCd())}onMouseEnter(b){if(null==b)return!1;b=b.zf;b.parentElement.classList.add(rt.qJg);b.src=tl.a.Bg(rt.PQj);return!0}Eoa(b){if(null==b)return!1;b=b.zf;b.parentElement.classList.remove(rt.qJg);
b.src=tl.a.Bg(rt.pdd);return!0}MFa(b){this.M4a(this.UUg,this.VZj);if(null==b){var h=new Map;h.set("Source",this.RIa);h=Object.assign(new Hb.a,{additionalValues:h});wa.Health.instance.recordKpiFailure(this.UUg,"Unable to highlight bookmarked content",!1,!0,h);return!1}v.AFrameworkApplication.ye("bookmarks-highlight-ex;bookmarks-highlight-ex-cf");if(this.NQj){h=b.Io.context;if(rt.B2a(h,this.hda))return!0;h=this.nof(b.Io.nPf,h,b.Io.container);b=Object.assign(new Jg.a,{action:0,type:5,eA:h,lJ:this.hda});
this.hda=h;this.FV.gF(b);return!0}return!1}nof(b,h,t){h={tth:new Set,ZJb:new Set,wth:null,z1e:null};const A=this.eb.Wv(b.Cb,!0,!1),O=[];if(A)for(const aa of A)O.push(aa);this.Tmk(b,h,O);h=new $F(O,t,h.tth,h.ZJb,h.wth,h.z1e);this.hda&&this.hda.Qq===O&&(t.className+=String.format(" {0}",rt.QQj),this.hda=h);return h}Tmk(b,h,t){if(b.yj){const O=new Set;for(const aa of b.Rg.Pi)aa.querySelectorAll("*").forEach(O.add,O);b=Array.from(O.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),
0);let A=[];h.ZJb.add(t[0].id);h.wth=t[0].id;h.z1e=t[0].id;b.forEach(O=>{const aa=ph.a.Db(O,lm.a.yAd);if(aa)for(const ua of aa)A.push(ua),h.tth.add(ua);if(!A.length)return!0;O=ph.a.Db(O,lm.a.Qyb);if(!O)return!0;A=$J.a.Xfc(A,O)});for(b=this.eb.ug(t[t.length-1],!1,!0);A.length&&b;)h.ZJb.add(b.id),h.z1e=b.id,t.push(b),this.goa.value.Ej(b).htmlElement.querySelectorAll("."+lm.a.y1e).forEach(O=>{(O=ph.a.Db(O,lm.a.Qyb))&&(A=$J.a.Xfc(A,O))}),b=this.eb.ug(b,!1,!0)}M4a(b,h){const t=new Map;t.set("Source",this.RIa);
t.set("Action",h);wa.Health.instance.recordKpiUsage(b,0,this.mVa,t)}static B2a(b,h){return!!h&&!!b&&b.rth===h.rth}}rt.qJg="WordBookmarkIndicatorContainerHovered";rt.QQj="WordBookmarkIndicatorContainerSelected";rt.pdd="BookmarkDefault.png";rt.PQj="BookmarkHover.png";rt.hQe=!0;rt.Yre="WordBookmarkIndicatorContainer";rt.VQj="WordBookmarkSvgIndicatorContainer";Object(m.a)(rt,"BookmarkIndicatorActor",Yi.a,[421]);class aK{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb=null,Yb=null,bc=null,Dc=null,Pc=null,jd=null,
Cd=null){this.K1="_";this.zre="Bookmark";this.nQj=/^BOOKMARK\d+$/i;this.RIa="BookmarkRibbonOptions";this.LQj="BookmarkFloatieOptions";this.ZMg="CreateBookmarkOnRange";this.$Mg="CreateBookmarkOnView";this.YMg="CreateBookmarkOnIP";this.Tue="CreateBookmark";this.mVa="wwaengidc";this.Hch="ShowHideBookmarksOnDocument";this.kOg="DeleteBookmark";this.LUj="DeleteBookmarkAction";this.Uck="ShowHideBookmarks";this.Gch="ShowBookmarksFloatie";this.Rck="ShowBookmarksFloatieAction";this.OPg="EditBookmark";this.MVj=
"EditBookmarkAction";this.D1e="BookmarksUsage";this.lEk="InsertTabSwitchActivity";this.Eum="Insert";this.SQb=b;this.ga=h;this.ib=t;this.hn=A;this.Ix=O;this.T5=aa;this.Ic=ua;this.nL=Ra;this.Dp=Yb;this.pJg=ub;this.Ie=Nb;this.C5=Pc;this.qo=bc;this.ed=Dc;this.IR=jd;this.Fk=Cd}get my(){return this.Ix.value}Ub(){this.ozf()&&(this.ga.pa(Vc.a.iNa,mc.a.view,this.iNa.bind(this)),this.ga.gb(ab.a.$Sa,mc.a.application,this.QFo.bind(this),96),this.ga.pa(Vc.a.iNa,mc.a.Fd,this.T1k.bind(this)),this.ga.pa(Vc.a.iNa,
mc.a.Vc,this.S1k.bind(this)),this.ga.pa(Vc.a.deleteBookmark,mc.a.view,this.deleteBookmark.bind(this)),this.ga.pa(Vc.a.hef,mc.a.view,this.Ikl.bind(this)),this.ga.gb(Vc.a.$kj,mc.a.view,this.dpo.bind(this),1028),this.ga.gb(Vc.a.W9d,mc.a.application,this.W9d.bind(this),96),this.ga.gb(Vc.a.vge,mc.a.Vc,this.vge.bind(this),1028),this.ga.gb(qa.a.s_d,mc.a.view,this.s_d.bind(this),1028),this.ga.gb(Vc.a.FTd,mc.a.view,this.FTd.bind(this),1028),this.ga.Uc(Vc.a.iNa,1028))}QFo(b,h,t,A,O){return O&&O.NewContextId===
this.Eum?(this.L0d(this.lEk),32):2}iNa(b,h,t,A,O){var aa,ua;b=this.ib.pg;if(!b||b.contextId===mc.a.anchoredObject)return 2;if(1===t)return Po.a.vga(h)||(null===(aa=this.Fk)||void 0===aa?0:aa.JZ(b))||(null===(ua=this.Fk)||void 0===ua?0:ua.Gna(b))?8:32;h=this.ib.hb.lb;if(!h||this.Ie.hm(h))return 2;this.HWc(O,"User is trying to create bookmark from UILocation : {0}");this.M4a(this.$Mg,this.Tue);if(h&&this.hn.AWe(this.hOa(),h))return this.L0d(this.D1e),32;O=new Map;O.set("Source",this.RIa);O=Object.assign(new Hb.a,
{additionalValues:O});wa.Health.instance.recordKpiFailure(this.$Mg,"Unable to create bookmark",!1,!0,O);return 8}T1k(b,h,t,A,O){if(1===t)return 32;if(mc.a.Fd!==h.contextId)return 8;this.HWc(O,"User is trying to create bookmark from UILocation : {0}");b=this.ib.hb.lb;if(!b)return 2;this.M4a(this.ZMg,this.Tue);if(this.hn.AWe(this.hOa(),b))return this.L0d(this.D1e),32;b=new Map;b.set("Source",this.RIa);b=Object.assign(new Hb.a,{additionalValues:b});wa.Health.instance.recordKpiFailure(this.ZMg,"Unable to create bookmark for range",
!1,!0,b);return 8}S1k(b,h,t,A,O){if(1===t)return 32;if(mc.a.Vc!==h.contextId)return 8;this.HWc(O,"User is trying to create bookmark from UILocation : {0}");b=this.ib.hb.lb;if(!b)return 2;this.Ie.hm(b)&&(h=b.Qa,this.Ie.mjb(h)?(b=this.Ie.b3(h,!1),b||(u.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.Ie.b3(h,!0))):u.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.M4a(this.YMg,this.Tue);if(this.hn.AWe(this.hOa(),
b))return this.L0d(this.D1e),32;b=new Map;b.set("Source",this.RIa);b=Object.assign(new Hb.a,{additionalValues:b});wa.Health.instance.recordKpiFailure(this.YMg,"Unable to create bookmark for IP",!1,!0,b);return 8}W9d(b,h,t,A,O){1===t&&32;O[Ng.a.On]=rt.hQe;return 32}dpo(b,h,t,A,O){if(1===t)return 32;this.M4a(this.Hch,this.Uck);(b=O[Ng.a.On])||u.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");rt.hQe=b;b=fm.PageNavigator.instance.HT(this.my);if(null!==b)return this.S1c(b),
this.SQb.CG({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.RIa);b=Object.assign(new Hb.a,{additionalValues:b});wa.Health.instance.recordKpiFailure(this.Hch,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,t,A,O){if(this.ozf()){b=this.ib.hb.lb;if(!b)return 2;b=b.Qa;b=this.hn.ANd(b.node,b.cpBegin);if(1===t)return b?32:8;this.HWc(O,"User is trying to delete bookmark from UILocation : {0}");this.nL.r_&&(u.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),
this.nL.Dw());this.M4a(this.kOg,this.LUj);b||u.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.hn.L3i(b.id))return this.pJg&&this.pJg.BCd(),32;t=new Map;t.set("Source",this.RIa);t=Object.assign(new Hb.a,{additionalValues:t});wa.Health.instance.recordKpiFailure(this.kOg,"Unable to delete bookmark",!1,!0,t);return 8}return 2}Ikl(b,h,t,A,O){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",
!1)){b=this.ib.hb.lb;if(!b)return 2;b=b.Qa;b=this.hn.ANd(b.node,b.cpBegin);if(1===t)return b?32:8;this.HWc(O,"User is trying to edit bookmark from UILocation : {0}");this.nL.r_&&(u.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.nL.Dw());this.M4a(this.OPg,this.MVj);b||u.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.C5.value.Jkl(h,b,this.hn),32;h=new Map;h.set("Source",this.RIa);h=Object.assign(new Hb.a,
{additionalValues:h});wa.Health.instance.recordKpiFailure(this.OPg,"Unable to edit bookmark",!1,!0,h);return 8}return 2}HWc(b,h){b&&b.UILocation&&u.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}vge(b,h,t,A,O){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)){1===t&&32;this.M4a(this.Gch,this.Rck);if(h.contextId===mc.a.Vc)return b=Array(1),b.push("Bookmarks"),this.nL.showFloatie(O.location,b,1),32;O=new Map;O.set("Source",
this.LQj);O=Object.assign(new Hb.a,{additionalValues:O});wa.Health.instance.recordKpiFailure(this.Gch,"Unable to show bookmark floatie",!1,!0,O);return 8}return 2}s_d(b,h,t,A,O){let aa;return 1===t?(Fq.a.instance.he(()=>{aa=this.ga.Nf(h,qa.a.insertHyperlink,t,!0,A,O);32!==aa&&(aa=this.ga.Nf(h,Vc.a.iNa,t,!0,A,O))},"BA:LFE"),aa):8}FTd(b,h,t){var A;if(1===t)return 32;if(b=this.ib.hb.lb){b=b.Qa.node;if(h=this.tUh(b))return h.click(),32;u.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");
if(b=this.hn.ANd(b,0)){b=this.IR.ndb.get(null===(A=b.id)||void 0===A?void 0:A.toString());A=fm.PageNavigator.instance.HT(this.my).Mc.Db(b);if(A=this.tUh(A))return A.click(),32;u.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else u.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}tUh(b){let h;b=this.qo.El(b).Ej(this.ed.vd.jc);b.Lib&&(b=b.htmlElement.querySelectorAll("div."+rt.Yre),0<b.length&&(h=b[0]));return h}S1c(b){const h=
ZG.b(b);if(h){var t=this.Ic.Qc(2);try{for(t.Eb(b);h.moveNext();){if(!qe.ParagraphReader.rh(h.iterator))continue;const A=h.currentNode;this.Hjl(A)&&this.T5.q9b(A,!0)}}finally{t&&t.dispose()}}}Hjl(b){for(let t=0;t<b.qa.length;t++){const A=b.qa.J(t);if(null!=A.Ah)for(let O=0;O<A.Ah.length;O++){var h=A.Ah.J(O);if(null!=h&&(h=b.Mc.Db(h.an).ia(Lc.a.$s,""),!F.a.mf(h)&&!h.startsWith(this.K1)))return!0}}}hOa(){var b=this.hn.jMd(!1);const h=[];for(let t=0;t<b.count;t++){const A=b.J(t).ia(Lc.a.$s,"");this.nQj.test(A)&&
h.push(A)}return 0<h.length?(h.sort((t,A)=>t.localeCompare(A,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.zre.length)),this.zre+(b+1)):this.zre+1}M4a(b,h){const t=new Map;t.set("Source",this.RIa);t.set("Action",h);wa.Health.instance.recordKpiUsage(b,0,this.mVa,t)}L0d(b){this.ozf()&&this.Dp&&this.Dp.execute(h=>{h.logActivity(b,null)})}ozf(){v.AFrameworkApplication.ye("bookmarks-core-ex;bookmarks-core-ex-cf");return v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",
!1)}}Object(m.a)(aK,"BookmarkActor",null,[]);class bK{constructor(b,h,t){this.rc=b;this.bfl=h;this.Vf=t;this.i6e=this.i6e.bind(this)}Ub(){this.rc.pa(Vc.a.dGf,mc.a.view,this.i6e)}i6e(b,h,t,A,O){return 1===t?32:(b=this.Vf.O7(h.Yj))?(O=3===O.ux,this.bfl.value.UGh(this.Q1l(b),this.qam(b),O),32):2}Q1l(b){const h=new ji.DictionaryPropertySet;h.setValue(zf.a.rE,this.Vf.Xg(b));h.setValue(zf.a.JF,this.Vf.Lfa(b));h.setValue(zf.a.zla,this.Vf.wgb(b));h.setValue(zf.a.separator,this.Vf.uQd(b));return h}qam(b){const h=
new ji.DictionaryPropertySet;h.setValue(Lc.a.marginLeft,this.Vf.OI(b));h.setValue(Lc.a.marginRight,this.Vf.zK(b));h.setValue(Lc.a.xo,this.Vf.Ot(b));return h}}Object(m.a)(bK,"ColumnsDialogActor",null,[]);class cK{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){this.No=b;this.zra=h;this.ue=t;this.Yq=A;this.Qm=O;this.Jd=aa;this.Ic=ua;this.ve=Ra;this.ga=ub;this.q1j=Nb;this.tTj=Yb}get uAm(){return this.q1j}Ub(){this.ga.gb(qa.a.M6c,mc.a.view,this.etm.bind(this),96);this.ga.gb(qa.a.B2c,mc.a.view,this.B2c.bind(this),
4);this.ga.gb(qa.a.vzd,mc.a.view,this.vzd.bind(this),1028)}vzd(b,h,t,A,O){if(!pi.a.F7e)return 8;b=O.FormattingActionId;O=O.FormattingActionData;if(!h.view||!h.view.re)return 2;h=h.view;if(!(b&&O&&h.nb&&h.nb.hb.lb))return 8;h=this.Qm.K2h(h.nb.hb.lb.toArray());for(const aa of h){h=aa.ia(Lc.a.jx,0);t=this.No.getById(h);if(!t)return u.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+h+"'."),8;if(!this.tTj.OMo(t,b,O))return u.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+
h+"' failed to update formatting."),8}return 32}etm(b,h,t,A,O){h=this.No.getById(O);if(!h)return 8;t=h.contentControlNode;if(!t)return 8;if(t.ia(Lc.a.d7,!1))return 2;A=this.No.XJl(h);if(!A)return 8;O=this.Ic.Qc(7);O.Eb(A.node);if(!this.uAm)return(b=h.v8d)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Jd.replaceTextRange(A,b),this.Ezd(h),t.setValue(Lc.a.d7,!0),O.dispose(),32;const aa=new ji.DictionaryPropertySet;aa.setValue(Gd.a.dgi,A);var ua=t.ia(Lc.a.E7e,"");ua=this.zra.nfi(ua);
if(!ua)return this.Yq.replaceTextRange(A,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,pi.a.fr?b:void 0),this.Ezd(h),t.setValue(Lc.a.d7,!0),O.dispose(),32;aa.setValue(Gd.a.wtf,ua);if(1<ua.length&&!h.Uf)return O.dispose(),8;this.t0k(aa);t.setValue(Lc.a.d7,!0);O.dispose();return 32}B2c(b,h,t){b=h.view.re?h.view:null;if(!b||!b.nb)return 8;const [A,O]=this.T4l(b.nb.hb);if(0===A.length)return 8;if(1===t){for(var aa of A){var ua=O.get(aa.parentId);if(this.hri(aa,ua))return 32}return 8}if(2===
t){t=this.lso(A,O);aa=this.Ic.Qc(15);aa.Eb(b.Zc);for(ua of t)t=O.get(ua.parentId),this.hri(ua,t)&&this.No.JLb(ua.id);aa.dispose();return 32}return 2}T4l(b){var h,t,A=[];for(const aa of b)A.push(...(null!==(h=this.Qm.Bma(aa.Qa,aa.Rc,1))&&void 0!==h?h:[]));if(0===A.length)return[A,new Map];h=[];for(const aa of b)h.push(...(null!==(t=this.Qm.Bma(aa.Qa,aa.Rc,3))&&void 0!==t?t:[]));b=new Map(A.map(aa=>[aa.id,aa]));if(0===h.length)return[A,b];const O=new Map(h.map(aa=>[aa.id,aa]));A=A.filter(aa=>!O.has(aa.id));
b=new Map([...b,...O]);return 0==A.length?[[h[0]],b]:[A,b]}Ezd(b){const h=this.Yq.MNc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(h){if(b=this.ve.qC(b.start.node).Ni("Placeholder Text"))this.ue.ula(h.formatting),this.ue.Fnb(h.formatting,b)}else u.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}t0k(b){this.ga.Rb(qa.a.showPlaceholderGlossary,2,b)}hri(b,h){return b.pga&&b.CIm&&(!h||h.isEditable)}lso(b,h){const t=(A,O)=>null==A||null==O||A.id===O.id?
!1:A.id===O.parentId||t(h.get(A.parentId),O);return b.slice().sort((A,O)=>t(A,O)?1:t(O,A)?-1:0)}}Object(m.a)(cK,"ContentControlActor",null,[]);class hF{constructor(b){this.ga=b;this.primaryButtonText="Count me in";this.secondaryButtonText="Cancel";this.Zsk=["We are gauging interest in a feature that would let you","customize your ribbon in Word on the web. Click below","to vote or comment on this idea, as well as follow it","status updates. Thank you."];this.GCo="Interested in this feature?"}Ub(){this.ga.pa(Vc.a.raf,
mc.a.view,this.wwm.bind(this))}wwm(b,h,t){2===t&&(Object(lb.c)(Vc.a.raf),b=new cf.StandardDialog,b.zd=4,b.Ge(1,this.primaryButtonText),b.Ge(2,this.secondaryButtonText),b.pCc(this.Zsk,null),b.Au(this.GCo,null,0,this.vaa));return 32}vaa(b){1===b&&(Object(lb.a)("CountMeIn_CustomizeRibbon",!0),F.a.eU(hF.LBj)&&ff.a.km(hF.LBj))}}hF.LBj="https://feedbackportal.microsoft.com/feedback/idea/974fe330-6613-ed11-b83e-000d3a4d92e4";Object(m.a)(hF,"CustomizeRibbonActor",null,[]);var PA=c(1068);class $G extends Pf.a{constructor(b,
h,t){super(!1,!1,!0);this.e1g=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,PA.a.lZe,PA.a.kZe,PA.a.mZe];this.CPj=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,PA.a.quk,PA.a.puk,PA.a.suk];this.JHg=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.Aic=()=>{new $G(this.ga,this.bSe,this.fqc)};this.PSl=()=>{const A=[];for(const O of this.bSe)A.push(this.N4(O));return A};this.jRo=A=>{const O=
new Set;this.ora="";for(const aa of A)if(""!==aa.position){const ua=this.m9h(aa.position);if(0>ua||22<ua){this.ora=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(O.has(ua)){this.ora=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.WCo(aa)),O.add(ua)}else{this.ora=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.ora&&(this._tabStops=[],this.bSe=A)};this.p$k=(A,O)=>{try{if(1===A){if(""!==this.ora)throw Error.create(this.ora);
O.DefaultTabStop&&(this.fqc=PA.a.A5f(O.DefaultTabStop),this.CUo(this.fqc));if(32!==this.ga.Rb(Vc.a.CPb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Ad.a.wv(this.fqc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(aa){this.aHa(aa.message,this.Aic)}};this.ga=b;this.bSe=h;this._tabStops=[];this.fqc=t;this.ora="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.GCb()};this.Yh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.p$k,b)}N4(b){return{["position"]:b.position,
["alignment"]:b.alignment,["leader"]:b.leader}}m9h(b){return Math.floor(100*parseFloat(b))/100}WCo(b){return new Tu.a(Ad.a.wv(this.m9h(b.position)),PA.a.B7l(b.alignment),PA.a.z7l(b.leader),1)}CUo(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Rb(qa.a.tGa,2,h)){var t=h.marginLeft;const A=Hc.a.Ki(h.marginRight,0);t=Hc.a.Ki(t,0);h=Hc.a.Ki(h.xo,0);if(Hc.a.T7(b,0,!1)>=h-A-t)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);
}}GCb(){return{["getInitState"]:this.PSl,["updateState"]:this.jRo,["validPositions"]:this.Gci(-Infinity,Infinity,"Position"),["validAlignments"]:this.g2h(this.JHg,this.JHg,null,"Alignment"),["validLeaders"]:this.g2h(this.e1g,this.e1g,this.CPj,"Leader"),["defaultTabStopSpinButtonProps"]:this.Gci(.01,22,"DefaultTabStops"),["defaultTabStopLength"]:this.fqc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,
["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}Gci(b,
h,t){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:t,["unitType"]:"Inch",["validUnits"]:[XB("Inch",3,b,h,.1)],["numberFormatInfo"]:FG()}}g2h(b,h,t,A){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:A,["options"]:QF(b,h,t)}}}Object(m.a)($G,"CustomTabDialog",Pf.a,[]);class dK{constructor(b,h,t){this.Fcc=(A,O,aa,ua,Ra)=>{if(2!==aa)return 8;if(!Ra)return 16;A=Ra.tabStop;Ra=Ra.value;if(!A)return 16;lb.c(Vc.a.Fcc);Ra=new Tu.a(Ra,
A.Hca,A.hoa,A.neg);O=O.node;this.Dza.U4a(O,A);this.Dza.NUd(O,Ra);return 32};this.n5c=(A,O,aa,ua,Ra)=>{if(2===aa){if(!Ra)return 16;this.Dza.NUd(O.node,Ra);return 32}return 8};this.ZKb=(A,O,aa,ua,Ra)=>{A=this.Dza.J0i(O.node);if(!("customTabs"in Ra))return Ra.customTabs=A,32;O=Ra.customTabs;if(!O||0>=O.length||!A||0>=A.length)return Ra.customTabs=null,32;aa=[];for(const ub of O)for(const Nb of A)if(Nb.AHa===ub.AHa&&Nb.neg===ub.neg&&Nb.Hca===ub.Hca){aa.push(ub);break}Ra.customTabs=aa;return 32};this.U4a=
(A,O,aa,ua,Ra)=>{if(2===aa){if(!Ra)return 16;lb.c(Vc.a.U4a);this.Dza.U4a(O.node,Ra);return 32}return 8};this.KLb=(A,O)=>{this.Dza.KLb(O.node);return 32};this.CPb=(A,O,aa,ua,Ra)=>{if(2===aa){if(!Ra)return 16;A=Ra.tabStops;aa=Ra.defaultTabStopLength;O=O.node;ua=!1;const ub=this.Dza.sXn(O,A);Ra.defaultTabStopLengthSaved||(ua=this.XJ.mao(O,aa),Ra.defaultTabStopLengthSaved=!0);ub&&lb.d(Vc.a.CPb,!0,void 0,void 0,void 0,void 0,[Object.assign(new sa.a,{name:"Custom Tab Stops Count",string:A.length.toString()})]);
if(null==ua)return u.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;ua&&(this.c3c&&this.c3c.opi(),this.Kd.Bs(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),lb.d(Vc.a.CPb,!0,void 0,void 0,void 0,void 0,[Object.assign(new sa.a,{name:"Default Tab Stop Length",string:aa.toString()})]));return 32}return 8};this.klj=(A,O,aa)=>{if(2!==aa)return 8;A={};if(32!==this.ga.Rb(Vc.a.eX,2,A))return u.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),
16;O={};if(32!==this.ga.Rb(qa.a.tGa,2,O))return u.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;A=PA.a.A5f(Ad.a.nz(A.defaultTabStop));aa={};aa.defaultTabStopLength=A;aa.sectionPropertiesData=O;if(32!==this.ga.Rb(Vc.a.Nkg,2,aa))return u.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!aa.isParagraphValid)return u.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),
this.Dza.aHa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;O={};if(32!==this.ga.Rb(Vc.a.ZKb,2,O))return u.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(O=O.customTabs)||(O=[]);O=PA.a.A7l(O);new $G(this.ga,O,A);lb.c(Vc.a.Aic,!0);return 32};this.pHm=(A,O,aa,ua,Ra)=>{if(2!==aa)return 8;if(!Ra)return 16;if(Ra.isParagraphValid)return 32;aa={};if(32!==this.ga.Nf(O,qa.a.F4a,2,!1,null,aa))return 16;A=Ra.sectionPropertiesData;O=Ra.defaultTabStopLength;var ub=aa.it;ua=ub.qna;
ub=1===ub.specialIndentType?ub.iB:ub.iB-ub.Cca;const Nb=A.marginLeft,Yb=A.marginRight;aa.isRtl?(aa=Hc.a.Ki(Math.max(Yb,Yb+ua),0),ua=Hc.a.Ki(Math.max(Nb,Nb+ub),0)):(aa=Hc.a.Ki(Math.max(Nb,Nb+ub),0),ua=Hc.a.Ki(Math.max(Yb,Yb+ua),0));A=Hc.a.Ki(A.xo,0);O=Hc.a.T7(O,0,!1);Ra.isParagraphValid=O<A-aa-ua;return 32};this.ga=b;this.Dza=h;this.XJ=t}get Kd(){return null!=this.QEg?this.QEg:this.QEg=Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get c3c(){return null!=this.zCg?this.zCg:
this.zCg=Sa.a.instance.Ma("WordEditor.Actors.RenderParagraphsContainingTabs")}Ub(){const b=t=>Cq.OutlineElementGeneralizer.xma(t.hb,!0),h=Jb.App.iTa.TGc(b,!0);this.ga.pa(Vc.a.ZKb,mc.a.view,Jb.App.iTa.TGc(b,!1));this.ga.gb(Vc.a.ZKb,mc.a.paragraph,this.ZKb,96);this.ga.pa(Vc.a.U4a,mc.a.view,h);this.ga.gb(Vc.a.U4a,mc.a.paragraph,this.U4a,96);this.ga.pa(Vc.a.KLb,mc.a.view,h);this.ga.gb(Vc.a.KLb,mc.a.paragraph,this.KLb,96);this.ga.pa(Vc.a.n5c,mc.a.view,h);this.ga.gb(Vc.a.n5c,mc.a.paragraph,this.n5c,96);
this.ga.pa(Vc.a.Fcc,mc.a.view,h);this.ga.gb(Vc.a.Fcc,mc.a.paragraph,this.Fcc,96);this.ga.pa(Vc.a.CPb,mc.a.view,h);this.ga.gb(Vc.a.CPb,mc.a.paragraph,this.CPb,96);this.ga.pa(Vc.a.Nkg,mc.a.view,h);this.ga.gb(Vc.a.Nkg,mc.a.paragraph,this.pHm,96);this.ga.pa(Vc.a.Aic,mc.a.view,this.klj);this.ga.pa(Vc.a.Yni,mc.a.view,this.klj)}}Object(m.a)(dK,"CustomTabActor",null,[]);var XM=c(129),hG=c(645);class eK{constructor(b,h,t,A,O,aa,ua,Ra,ub){this.ga=b;this.ywd=t;this.VIa=(this.aYb=O)&&A;this.lo=aa;this.bW=ua;
this.mUj=Ra;this.Xw=ub;this.nIg=h;this.nIg.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoNotSetDarkModeStateInDarkModeActor",!1)?(this.tIf(!0),this.LHf(!0)):(this.aYb&&Rh.a("isSharedUXDarkModeOn")?(this.lo.oK=appChrome.api.isSharedUXDarkModeOn(),this.tIf(!0)):this.lo.oK=!1,this.VIa?this.LHf(!0):this.lo.YSa=!1);v.AFrameworkApplication.uJ(()=>{this.LYc()});this.VIa&&Rh.a("dispatch")&&appChrome.api.dispatch(this.Iqj([]))}Ub(){this.VIa&&(this.ga.pa(Vc.a.lDo,mc.a.view,this.D$k.bind(this)),this.ga.pa(Vc.a.m6c,
mc.a.view,this.m6c.bind(this)),this.ga.gb(Vc.a.w1c,mc.a.view,this.w1c.bind(this),96));this.aYb&&(this.ga.pa(Vc.a.Pfe,mc.a.view,this.Pfe.bind(this)),this.ga.gb(Vc.a.I$d,mc.a.view,this.I$d.bind(this),96))}lwm(b){if(!this.$ko(b))return!1;const h=vo.a.instance.Qc(2);try{h.Eb(b.root);const t=ue.GraphIterator.$a(b.root.graphNode),A=Cr.a.Tp(t);for(;A.moveNext();){const O=Object(Da.a)(XM.a,A.currentNode);O&&O.sH(b.jc,20,!0)}}finally{h&&h.dispose()}return!0}$ko(b){return b&&b.root&&b.Qt?b.Yi||b.gBf||b.fti||
b.Pj:!1}lZn(){let b=!1;this.ywd.forEach(h=>{this.lwm(h)&&(b=!0)});return b}mDo(){u.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.lo.oK?"dark":"light");return this.lo.oK?hG.a.wCc(1):hG.a.X3i(1)}pgg(){const b=this.lo.eaa;u.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.lZn()||(b?!hG.a.wCc(0):!hG.a.X3i(0)))return!1;this.mUj.fHn(b);return!0}Iqj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.lo.oK));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.hdi(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.lo.YSa?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):u.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){u.ULS.sendTraceTag(527282835,3023,10,h)}return b}D$k(){return this.pgg()?
32:8}Pfe(b,h,t){if(1===t)return 32;b=this.bW.eg("UserAction","sharedUXDarkModeToggle");if(Rh.a("toggleSharedUXDarkMode"))u.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),Rh.a("isSharedUXDarkModeOn")?this.lo.oK=appChrome.api.isSharedUXDarkModeOn():this.lo.oK=!this.lo.oK,u.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.lo.oK);else return 8;appChrome.getHeaderApi().then(A=>{A.hasOwnProperty("refreshThemeOverride")&&
A.refreshThemeOverride()});this.mDo()||u.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.VIa&&!this.lo.YSa&&(this.pgg()||u.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");Jb.App.ya.CG(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.lo.oK));this.VIa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.lo.oK));b.stop();u.ULS.sendTraceTag(555885377,3023,50,"{0}",b.ri);lb.b(this.lo.oK?"DarkModeOn":"DarkModeOff");return 32}m6c(b,h,t){if(1===t)return 32;b=this.bW.eg("UserAction","sharedUXDarkModeSwitchBackground");u.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.lo.YSa=!this.lo.YSa;if(!this.pgg())return 8;h={};h.DarkModeSwitchBackground=this.Xw?"ButtonModel":"ToggleButtonModel";Jb.App.ya.CG(h);b.stop();u.ULS.sendTraceTag(555885378,3023,
50,"{0}",b.ri);u.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.lo.YSa);lb.b(this.lo.YSa?"DarkCanvasOff":"DarkCanvasOn");return 32}I$d(b,h,t,A,O){if(1===t)return 32;if(!O)return 2;Rh.a("isSharedUXDarkModeOn")&&(this.lo.oK=appChrome.api.isSharedUXDarkModeOn());O&&(O[Ng.a.On]=this.lo.oK);return 32}w1c(b,h,t,A,O){if(1===t)return 32;if(!O)return 2;!this.Xw&&O&&(O[Ng.a.On]=this.lo.YSa);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.lo.oK));
this.VIa&&this.Iqj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.hdi(!1)));appChrome.api.dispatch(b);return 32}hdi(b){const h={};this.lo.YSa?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}LYc(){this.aYb&&this.tIf(!1);this.VIa&&this.LHf(!1)}tIf(b){var h;u.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",
b,this.lo.oK?"dark":"light",this.lo.UCa);b&&this.lo.oK!=(null===(h=this.nIg)||void 0===h?void 0:h.$("DarkModeIsOn"))&&u.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.lo.oK?"dark":"light",this.lo.UCa)}LHf(b){u.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.lo.eaa?"dark":"light",this.lo.C$k)}}Object(m.a)(eK,"DarkModeActor",null,[]);var fK=c(1576);
class iG{constructor(){this.Height=this.Width=0}static construct(b,h){const t=new iG;t.Width=b;t.Height=h;return t}}Object(m.a)(iG,"ViewportInfo",null,[]);class aH extends ou.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}Cl(){return 85}static construct(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){const bc=new aH;bc.ContractVersion=b;
bc.DocumentContent=h;bc.EnhancementId=t;bc.World=A;bc.ScalingFactor=O;bc.DesktopViewportInfo=iG.construct(aa,ua);bc.MobileViewportInfo=iG.construct(Ra,ub);bc.MinParagraphCount=Nb;bc.ContentCulture=Yb;return bc}}Object(m.a)(aH,"SwayPreviewRequest",ou.a,[]);var YM=c(604);class iD{static get Wg(){return Pf.a.Xz(Jb.App.instance&&Jb.App.instance.NEf?iD.efl:iD.Hm,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,
iD.p3n,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}iD.p3n=tl.a.Bg("progress.gif");iD.Hm="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
iD.efl="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(m.a)(iD,"DigitalPrintDialogHtml",null,[]);class yx{constructor(b,h,t,A){this.fontFamily=b;this.J3c=h;this.fontWeight=t;this.fontStyle=A}}Object(m.a)(yx,"FontInfo",null,[]);class st{constructor(b,h,t,A){this.styleName=b;this.title=h;this.FCo=t;this.Tjm=A}}Object(m.a)(st,"StyleVisualInfo",null,[]);class ID extends Pf.a{constructor(b,h,t,A,O=!0){super();this.N5=this.Eq=this.Uja=this.R1=this.Vid=this.keh=this.sud=this.TRe=this.URe=this.kRe=this.wYb=this.NLa=this.g2=this.OXb=null;this.GUe=this.oNe=
!1;this.Ihd=null;this.gjl=()=>{this.Caj(0)};this.fjl=(aa,ua)=>{this.Caj(ua)};this.MRi=aa=>{this.m7h(aa)===Sys.UI.Key.enter&&(this.fTf(aa),aa.preventDefault(),aa.stopPropagation())};this.aOi=aa=>{((aa=aa.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===aa.id||aa.id===Ri.a.kcd)||ba.a.jt)&&this.NLa&&this.bNb(this.NLa)};this.bOi=aa=>{const ua=this.m7h(aa);ua!==Sys.UI.Key.tab&&ua!==Sys.UI.Key.left&&ua!==Sys.UI.Key.right&&ua!==Sys.UI.Key.up&&ua!==Sys.UI.Key.down||this.Jgm(ua)||(aa.preventDefault(),
aa.stopPropagation(),this.Uhn(ua))};this.hRf=()=>{this.GUe||(this.GUe=!0,u.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),Hf.a.removeHandler(this.g2,db.a.scroll,this.hRf))};this.PRf=()=>{u.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.fTf=aa=>{aa.preventDefault();aa.stopPropagation();v.AFrameworkApplication.xa.processAction(qa.a.XNh,2);aa.target?(aa="button"===aa.target.tagName.toLowerCase()?aa.target:aa.target.parentNode)&&aa.id!==this.OXb&&(u.ULS.sendTraceTag(25231813,
382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.OXb,aa.id),this.Fyh(aa),this.PIh()):u.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.Jfl=aa=>{const ua=(new Date).getTime()-this.GOg;bi.a.instance.Rf(yh.a.Lfl,ua);aa?this.Y7n():(u.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),v.AFrameworkApplication.xa.processAction(qa.a.WNh,2))};
this.W7n=()=>{this.oqo();try{const aa=ID.wPh.Brl(),ua=aH.construct(2,aa,this.OXb,"VerticalWorld",.3,1366,600,330,280,20,ID.wPh.mSb.name);v.AFrameworkApplication.Ke.oj(String.format("{0}/we/GetSwayPreview.ashx?{1}",Jb.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature),2,YM.b(ua),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.kAn,this.RXi,ua)}catch(aa){u.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",aa.message)}};
this.kAn=aa=>{var ua=null;({group:ua}=sl.a.H0(aa.data.we)).returnValue?(ua=ua.Responses[0],ua.Succeeded?(this.j1d(aa.data,yh.a.dyo),this.Ndb(),this.pgj(this.TRe,ua.PreviewHtml),this.pgj(this.sud,ua.PreviewHtmlMobile)):this.RXi(null)):u.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.RXi=()=>{this.pqo();this.URe.style.background="#E6E6E6";this.keh.style.background="#E6E6E6"};this.Wg=iD.Wg;this.sg="DigitalPrintDialog";u.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.i$j=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.RSb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.rek=t;this.Orc=A;this.Ge(1,this.i$j);this.Yh(this.RSb,this.Jfl,null);this.Lqm();this.Lwo();this.GOg=(new Date).getTime();O&&Sv.a.jQ(14,!1,this.gjl,this.fjl,null);this.Wrm();this.kpm();this.PSm();this.tHf();this.GSm();this.PIh()}get Rua(){return this.Ihd}Caj(b){if(!this.oNe){const h=
(new Date).getTime()-this.GOg;bi.a.instance.Rf(yh.a.Kfl,h);b?u.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",fs.a[b])):u.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.JYa.disabled=!1}}Lqm(){this.wYb=document.getElementById("digitalPrintStatusMessageDiv");this.kRe=document.getElementById("digitalPrintStatusMessageIconDiv");this.URe=document.getElementById("swayDesktopPreviewWrapperDiv");
this.TRe=document.getElementById("swayDesktopPreviewHtmlHolder");this.sud=document.getElementById("swayMobilePreviewHtmlHolder");this.keh=document.getElementById("swayMobilePreviewWrapperDiv");this.g2=document.getElementById("swayGallery");this.g2.setAttribute("tabindex","0");Hf.a.addHandler(this.g2,db.a.scroll,this.hRf);this.g2.setAttribute(Mf.a.oh,Mf.a.prh);this.R1=document.getElementById("digitalPrintLearnMoreLink");this.R1.href="https://go.microsoft.com/fwlink/?linkid=871972";Hf.a.addHandler(this.R1,
db.a.click,this.PRf);this.Uja=new Mb.a;this.Vid=document.getElementById("homeWrapper");this.s4("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.Orc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}Wrm(){this.Eq=new Mb.a;this.Eq.add(new st("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.Eq.add(new st("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.Eq.add(new st("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Eq.add(new st("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.Eq.add(new st("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.Eq.add(new st("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Eq.add(new st("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Eq.add(new st("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.Eq.add(new st("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Eq.add(new st("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Eq.add(new st("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.Eq.add(new st("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Eq.add(new st("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Eq.add(new st("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.Eq.add(new st("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.Eq.add(new st("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Eq.add(new st("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.Eq.add(new st("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Eq.add(new st("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Eq.add(new st("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.Eq.add(new st("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Eq.add(new st("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}kpm(){this.N5=
new Mb.a;this.N5.add(new yx("universc","universc","normal","normal"));this.N5.add(new yx("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.N5.add(new yx("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.N5.add(new yx("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.N5.add(new yx("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.N5.add(new yx("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.N5.add(new yx("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.N5.add(new yx("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.N5.add(new yx("ArialNova","ArialNova","normal","normal"));this.N5.add(new yx("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.N5.add(new yx("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.N5.add(new yx("RockwellNova","RockwellNova","normal","normal"));
this.N5.add(new yx("SabonNRegLT","SabonNRegLT","normal","normal"));this.N5.add(new yx("DaytonaThin","DaytonaThin","100","normal"))}PSm(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(const t of this.N5)h+=String.format(this.rek,t.fontFamily,t.J3c,t.fontWeight,t.fontStyle);b.innerText=h;this.Vid.appendChild(b)}GSm(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
tl.a.Bg("SwayPreviewFrame.svg")),t=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",tl.a.Bg("SwayPreviewFrameHC.svg"));b.innerText=h+t;ba.a.qq&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.Vid.appendChild(b)}m7h(b){return b?b.keyCode:window.event.keyCode}hide(){this.F1f();super.hide()}F1f(){if(this.g2&&!this.oNe){for(let b=0;b<this.Uja.count;b++)Hf.a.removeHandler(this.Uja.J(b),
db.a.click,this.fTf),Hf.a.removeHandler(this.Uja.J(b),db.a.fi,this.MRi);Hf.a.removeHandler(this.g2,db.a.fi,this.bOi);Hf.a.removeHandler(this.g2,db.a.focus,this.aOi);Hf.a.removeHandler(this.R1,db.a.click,this.PRf);this.GUe||Hf.a.removeHandler(this.g2,db.a.scroll,this.hRf);this.oNe=!0}}tHf(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",tl.a.UEk());this.Vid.appendChild(b);for(const h of this.Eq)this.vFd(this.g2,h);this.l0(this.g2);
this.Fyh(this.g2.firstChild);this.g2.firstChild.focus();Hf.a.addHandler(this.g2,db.a.fi,this.bOi);Hf.a.addHandler(this.g2,db.a.focus,this.aOi)}vFd(b,h){const t=document.createElement("button");t.className="swayGalleryItem swayClip136x90 swayImageBorderButton";t.setAttribute(Mf.a.$cb,Mf.a.NL);t.setAttribute("title",h.title);t.setAttribute(Mf.a.oh,Mf.a.srh);t.id=h.styleName;b.appendChild(t);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);
b.src=tl.a.Bg("swayPublish.png");b.setAttribute(Mf.a.oh,Mf.a.Ny);b.setAttribute("unselectable","on");b.setAttribute(Mf.a.Lz,Mf.a.gp);b.id=h.styleName+"img";t.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.FCo;b.setAttribute(Mf.a.Lz,Mf.a.gp);b.setAttribute("unselectable","on");b.setAttribute(Mf.a.oh,Mf.a.Ny);t.appendChild(b);const A=document.createElement("label");A.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;A.className=h.Tjm;A.setAttribute(Mf.a.Lz,
Mf.a.gp);b.setAttribute("unselectable","on");A.setAttribute(Mf.a.oh,Mf.a.Ny);t.appendChild(A);Hf.a.addHandler(t,db.a.click,this.fTf);Hf.a.addHandler(t,db.a.fi,this.MRi);this.Uja.add(t)}Uhn(b){const h=this.Rua;this.Fyl(b,h,!v.AFrameworkApplication.isRtl)||this.Hyl(b,h,!v.AFrameworkApplication.isRtl)||this.Cyl(b,h)||this.Dyl(b,h)}Jgm(b){return b===Sys.UI.Key.tab?(this.Rua&&this.Rua!==this.NLa&&(this.Rua.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.Ihd=this.NLa),!0):!1}Fyl(b,
h,t){return b===Sys.UI.Key.right&&t||b===Sys.UI.Key.left&&!t?(b=(b=h.nextSibling)||this.g2.firstChild,this.bNb(b),!0):!1}Hyl(b,h,t){return b===Sys.UI.Key.left&&t||b===Sys.UI.Key.right&&!t?(b=(b=h.previousSibling)||this.g2.lastChild,this.bNb(b),!0):!1}Cyl(b,h){return b===Sys.UI.Key.down?(b=this.Uja.indexOf(h),h=b+2,h<this.Uja.count?(b=this.Uja.J(h))&&this.bNb(b):(h=b%2+1,h=2<=h?0:h,(b=this.Uja.J(h))&&this.bNb(b)),!0):!1}Dyl(b,h){b===Sys.UI.Key.up&&(b=this.Uja.indexOf(h),h=b-2,0<=h?(b=this.Uja.J(h))&&
this.bNb(b):(h=b?20+b-1:this.Uja.count-1,(b=this.Uja.J(h))&&this.bNb(b)))}bNb(b){this.Rua&&this.Rua.id!==this.NLa.id&&(this.Rua.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.Ihd=b;this.Rua.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.Rua.focus()}Lwo(){this.JYa.className="WACDialogButtonNormal swayPrintToWebButton";this.JYa.setAttribute("tabindex","0");this.rz.className="WACDialogButtonNormal swayCancelButton";
this.rz.setAttribute("tabindex","0");this.JYa.disabled=!0}Fyh(b){this.Rua&&(this.Rua.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.NLa&&(this.NLa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.NLa.setAttribute(Mf.a.$cb,Mf.a.NL));this.OXb=b.id;this.NLa=b;this.NLa.setAttribute(Mf.a.$cb,Mf.a.gp);this.Ihd=b;this.Rua.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}PIh(){sf.a.instance.Wb(new Vb.a(2,
1,50,this.W7n))}pgj(b,h){b.innerHTML=h}Y7n(){u.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.OXb));v.AFrameworkApplication.xa.processAction(qa.a.YNh,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",Jb.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature,v.AFrameworkApplication.userSessionId,this.OXb);ff.a.openWindow(4,b)}j1d(b,h){bi.a.instance.Rf(h,+b.XS-+b.tH)}pqo(){var b=
WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.Ndb();this.wYb.innerText=b;this.wYb.style.display="block"}oqo(){this.Ndb();this.kRe.style.display="block";this.wYb.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.wYb.style.display="block"}Ndb(){this.URe.style.background="";this.sud.style.background="";vc.a.FZ(this.TRe);vc.a.FZ(this.sud);this.wYb.style.display="none";this.kRe.style.display="none"}static get wPh(){return null!=ID.vug?ID.vug:ID.vug=
Sa.a.instance.Ma("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(m.a)(ID,"DigitalPrintDialog",Pf.a,[]);class bH{constructor(b,h){this._context=this.xk=null;this.ete=0;this.Pdd=!1;this.fdh=null;this.digitalPrint=(t,A,O,aa,ua)=>{if(1===O)return v.AFrameworkApplication.qG?8:32;this.fdh=ua.SourceControlId;if(v.AFrameworkApplication.K.$("IsAnonymousUser"))return u.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),
this.Hic(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=A;if(bH.NFm())return u.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.c9e(),32;switch(this.ete){case 1:u.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.c9e();break;case 2:u.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");
this.Hic(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.Pdd=!1,this.xk=(new kk.a).create(),this.xk.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.xk.YK(CommonUIStrings.l_DefaultDialogTitle,this.wPk,null),v.AFrameworkApplication.Ke.oj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",Jb.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.yPk,this.xPk,null)}return 32};this.wPk=()=>{this.Pdd=!0;u.ULS.sendTraceTag(34373831,
382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.yPk=t=>{if(!this.Pdd){this.xk.close();var A=null;this.j1d(t.data,yh.a.cyo);({group:A}=sl.a.H0(t.data.we)).returnValue?(t=A.Responses[0],u.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",t.HasLicense,t.Succeeded),t.Succeeded?(this.ete=t.HasLicense?1:2,2===this.ete?this.Hic(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.c9e()):this.Hic(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(u.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.Hic(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.xPk=t=>{this.Pdd||(this.xk.close(),u.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.j1d(t.data,yh.a.byo),this.Hic(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};
this.ga=b;this.C5=h}Ub(){v.AFrameworkApplication.protectFile?u.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")?u.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.gb(qa.a.digitalPrintToSway,mc.a.view,this.digitalPrint,4),this.ga.gb(qa.a.XNh,mc.a.view,Kf.ActionManager.eQ,4),this.ga.gb(qa.a.YNh,
mc.a.view,Kf.ActionManager.eQ,4),this.ga.gb(qa.a.WNh,mc.a.view,Kf.ActionManager.eQ,4),this.ga.gb(ab.a.qHd,mc.a.view,Kf.ActionManager.eQ,4))}c9e(){u.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.fdh);new ID(this._context,this.ga,v.AFrameworkApplication.K.kb("SwayFontDownloadUrlTemplate"),v.AFrameworkApplication.K.kb("FileSource"))}Hic(b){const h=new cf.StandardDialog;h.zd=0;h.nia(CommonUIStrings.l_DefaultDialogTitle,
b,null)}j1d(b,h){bi.a.instance.Rf(h,+b.XS-+b.tH)}static NFm(){return"OneDriveWOPI"===v.AFrameworkApplication.K.kb("FileSource")}}Object(m.a)(bH,"DigitalPrintActor",null,[]);class gK{constructor(){this.Zfh=null}mEi(){u.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}wwj(b){if(!b)return u.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.Xyi(b.errorDetails))return!1;this.Zfh=Object(Da.a)(eq.a,b.errorDetails).typeId;return!0}cge(b){return this.Xyi(b)?
Object(Da.a)(eq.a,b).typeId===this.Zfh:!1}Xyi(b){if(!b)return u.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(Da.a)(eq.a,b);return b?b.token&&b.typeId?!0:(u.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(u.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(m.a)(gK,"DoNotCheckThisCritiqueTypeStrategy",null,[415]);class hK extends Pf.a{constructor(b,h,t){super(!1,!1,!0);this.rc=b;this.nma=t;this.AVj="DocumentChoiceGroup";this.dQg="EmbededContent";
this.yVg="HyperLink";this.YFe=t.$8a;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.GCb()};this.bRj=this.erl.bind(this);this.Ge(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Yh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.bRj,b)}GCb(){const b=Array(2);b[0]={["key"]:this.dQg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.yVg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};
const h={};h.documentChoiceGroupProps={["id"]:this.AVj,["defaultSelectedKey"]:this.YFe?this.dQg:this.yVg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return h}erl(b,h){1===b?(this.YFe!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?Vc.a.RNa:Vc.a.Cfb,this.rc.processAction(b,2),this.YFe=h.isExternalContentSelected,ja.a.sendTelemetryEvent(Object.assign(new ta.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new sa.a,{name:"ActionId",int64:b})]}))),this.nma.S3n(h.isExternalContentSelected)):0===b&&u.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}
Object(m.a)(hK,"ExternalContentDefaultSettingsDialog",Pf.a,[]);class tt{constructor(b,h,t,A,O){this.nL=Sa.a.instance.resolve("Common.IReactContextualUILauncher");this.Dqb=Ng.a.On;this.Cic=()=>{const aa=Array(1);aa.push("ExternalContent");var ua=Sa.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").uOa();ua=Object.assign(new GF.a,{x:ua.x,y:ua.y});this.nL.showFloatie(ua,aa,1);return 32};this.NEb=()=>{this.nL.r_&&this.nL.Dw();return 32};this.OZi=(aa,ua,Ra,ub,Nb)=>{if(ua="object"===
typeof Nb?Nb:null)aa===Vc.a.CZf?(aa=tt.RVa!==Vc.a.RNa&&tt.RVa!==Vc.a.Cfb,ua[this.Dqb]=tt.RVa===Vc.a.RNa||aa):aa===Vc.a.DZf&&(ua[this.Dqb]=tt.RVa===Vc.a.Cfb);return 32};this.kUh=(aa,ua,Ra)=>{1!==Ra&&(aa===Vc.a.Cfb&&tt.RVa!==Vc.a.Cfb?(u.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.Dm.undo()&&(ua=new qu.a(1,v.AFrameworkApplication.isRtl),ua.O_c="ExternalContent",tt.Bfb.O1c(ua))):aa===Vc.a.RNa&&tt.RVa!==Vc.a.RNa&&(u.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.VQg.t0i()),tt.RVa=aa);ja.a.sendTelemetryEvent(Object.assign(new ta.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new sa.a,{name:"behavior",string:Ra.toString()}),Object.assign(new sa.a,{name:"ActionId",int64:aa})]}));return 32};this.ga=b;this.Dm=h;this.VQg=A;this.O0j=O;this.aRj=this.frl.bind(this);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.VQg.r2i(()=>{this.reset()})}Ub(){this.ga.gb(Vc.a.CZf,mc.a.view,this.OZi,97);this.ga.gb(Vc.a.DZf,mc.a.view,this.OZi,97);this.ga.gb(Vc.a.jUh,mc.a.view,this.aRj,1028);this.ga.gb(Vc.a.RNa,mc.a.view,this.kUh,1028);this.ga.gb(Vc.a.Cfb,mc.a.view,this.kUh,1028);this.O0j||(this.ga.gb(Vc.a.Cic,mc.a.view,this.Cic,96),this.ga.gb(Vc.a.NEb,mc.a.view,this.NEb,96))}Joo(b){new hK(this.ga,b,tt.nma)}frl(b,h,t){1!==t&&this.Joo(tt.RVa);return 32}static get Bfb(){return null!=tt.Pug?tt.Pug:tt.Pug=Sa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get nma(){tt.Qza||
(tt.Qza=Sa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return tt.Qza}reset(){tt.RVa=null!=tt.nma?tt.nma.$8a?Vc.a.RNa:Vc.a.Cfb:Vc.a.RNa}}tt.RVa=Vc.a.RNa;tt.Qza=null;Object(m.a)(tt,"ExternalContentActor",null,[]);class JD extends bz{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc){super(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc);this.TRc=Dc;this.DJd=!1;this.MWg=null}j2c(){this.DJd||(super.j2c(),this.DJd=!0)}zle(){this.DJd&&(super.zle(),JD.DQh&&this.MWg&&JD.DQh.removeHandler(r.a.DBa,
this.MWg),this.DJd=!1)}DPb(){if(this.TRc){this.Ota.r_&&this.Ota.Dw();const b=new qu.a(0,v.AFrameworkApplication.isRtl);b.location=this.n4a.uOa();this.showFloatie(null,b)}else this.Ota.r_&&v.AFrameworkApplication.xa.processAction(Vc.a.NEb,2),v.AFrameworkApplication.xa.processAction(Vc.a.Cic,2);this.Hac=!1}Dw(b){!this.LDe&&(b&&(this.n4a.Byf(),this.uxj()),this.Ota.r_||this.xKa)&&(this.xKa=!b,this.zle(),this.TRc?this.Ota.Dw():v.AFrameworkApplication.xa.processAction(Vc.a.NEb,2))}showFloatie(b,h){h||(h=
new qu.a(0,v.AFrameworkApplication.isRtl));h.location||(h.location=this.n4a.uOa());if(!h.location)return!1;this.xKa&&(this.xKa=!1,this.j2c());this.TRc?(b=Array(1),b.push("ExternalContent"),this.Ota.showFloatie(this.n4a.uOa(),b,1)):v.AFrameworkApplication.xa.processAction(Vc.a.Cic,2);return!0}MHc(){if(!this.Hac){const b=new Vb.a(3,1,this.XKh,()=>{this.DPb()},196);sf.a.instance.Wb(b);this.Hac=!0}}Pha(){this.TRc?this.Ota.r_&&this.Ota.Dw():v.AFrameworkApplication.xa.processAction(Vc.a.NEb,2);this.MHc()}FMb(){this.TRc?
this.Ota.r_&&this.Ota.Dw():v.AFrameworkApplication.xa.processAction(Vc.a.NEb,2);this.MHc()}static get DQh(){return null!=JD.Bug?JD.Bug:JD.Bug=Sa.a.instance.resolve("Box4.IEditStateEventManager")}}Object(m.a)(JD,"ExternalContentFloatieEventManager",bz,[]);class KD extends kw{constructor(b,h,t,A,O){super(b,h,t,A,O)}xwh(){if(!this.ib||!this.ib.hb||!this.ib.hb.lb)return u.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.ib.hb.lb.Qa,
h=!b.cpBegin&&!b.cpEnd;let t=b.node;if(t&&h&&!t.XI){do t=this.hai(t);while(t&&!t.XI&&Object(hc.a)(Tb.AParagraphNode,t)&&!t.characterData.trim().length)}let A="";const O=Object(Da.a)(Tb.AParagraphNode,t);O&&(A=O.characterData.length===b.cpBegin||h?O.characterData.trimEnd():O.characterData.substring(0,b.cpBegin).trimEnd());h=O?A.length:b.cpBegin;b=Object.assign(new eB,{gxa:Object(Da.a)(222,(O?Object(Da.a)(222,O):Object(Da.a)(222,t))||b.node),Gec:h});return this.Qnf(b)}i6h(b,h){let t=null;const A=Object(Da.a)(249,
b.gxa.Ej(h.jc));if(!A)return null;if(Object(hc.a)(Tb.AParagraphNode,b.gxa)){const O=Object(Da.a)(Tb.AParagraphNode,b.gxa);if(O.UP){if(b=Object(Da.a)(QA.a,qe.ParagraphReader.vOa(O)))(b=Object(Da.a)(249,b.Ej(h.jc)))&&(t=b.getBounds()),t&&(t.height+=KD.xXh,t.width-=KD.Yxl);return t}h=Object(Da.a)(210,A);if(!h)return null;try{if(t=this.Esa.AZ(b.Gec,h,0<b.Gec,!1,!1,!1))t.height+=KD.xXh}catch(aa){u.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",
aa),t=null}}t||(t=A.getBounds());return t}}KD.xXh=65;KD.Yxl=100;Object(m.a)(KD,"ExternalContentFloatiePositionProvider",kw,[]);class iK{constructor(b,h,t,A,O,aa){this.V3f=(ua,Ra,ub)=>{if(1===ub)return v.AFrameworkApplication.protectFile||v.AFrameworkApplication.qG||v.AFrameworkApplication.Jna||fc.SessionStatusManager.instance.xj?8:32;if(ua===qa.a.print)ua=1;else if(ua===Vc.a.WIc)ua=0;else if(ua===Vc.a.bId)ua=2;else return 8;return this.C3n(ua)};this.ga=b;this.C5=h;this.GTb=t;this.gVj=A;this.UOg=O;
this.qRj=aa;this.mI=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback")}Ub(){v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.gVj||v.AFrameworkApplication.qG?(document.body.classList.add("WACStopPrinting"),""!==this.UOg&&this.qRj.jpo(this.UOg)):(this.ga.pa(qa.a.print,mc.a.application,this.V3f),this.ga.pa(Vc.a.WIc,mc.a.application,this.V3f),this.ga.pa(Vc.a.bId,mc.a.application,this.V3f))}C3n(b){const h=v.AFrameworkApplication.rootQuerySignature;if(!h||""===h||Jb.App.xd&&Jb.App.xd.zA.eo)return 8;
this.GTb.$Vd=!1;this.GTb.ODj.start();Sv.a.jQ(5,!0,Object(z.a)(this.GTb,this.GTb.RYn,"requestFileDownload"),Object(z.a)(this.GTb,this.GTb.AJb,"onForceSaveFailed"),b);this.woe();return 32}woe(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.mI&&(u.ULS.sendTraceTag(509145741,306,50,"DownloadCopyIntercept logged for: DownloadAsPDF"),this.mI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}}Object(m.a)(iK,"FileDownloadActor",
null,[]);class jK extends Yg{constructor(b,h=null){super(b,!0,h,!1)}get cwf(){return null}get C3a(){return v.AFrameworkApplication.XZa?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get Bbc(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get Hyd(){return null}}Object(m.a)(jK,"DownloadAsPdfDialog",Yg,[]);class dw{constructor(){this._url=this.ev=null;this.dXa=this.cXa=0;this.ucb=!1;this.makeRequest=
()=>{v.AFrameworkApplication.Ke.oj(this._url,1,null,null,!0,2,this.JJb,this.Goa,null)};this.JJb=b=>{dw.B3c();const h=b.data.Qha;let t=null;if(h)try{t=h.selectSingleNode("/docdata/status")}catch(A){}t&&("InProgress"===t.text&&22>this.cXa++||"ServiceBusy"===t.text&&3>this.dXa++)?this.NGa(1E3*(this.cXa+this.dXa)):this.ev(!0,t?t.text:null,b.data)};this.Goa=b=>{this.ucb?(dw.OAa||(dw.dab=new Date,dw.OAa=!0,dw.wS=1),18E4>(new Date).getTime()-dw.dab.getTime()?this.retryOnFailure(4<=dw.wS?2E4:1E3):this.S0a(b.data)):
4>dw.wS?this.retryOnFailure(2E3):this.S0a(b.data)}}send(b,h,t){this._url=b;this.ev=h;this.ucb=t;this.makeRequest(null)}NGa(b){b=new Vb.a(2,1,b,this.makeRequest);v.AFrameworkApplication.oc.Wb(b)}retryOnFailure(b){this.NGa(b);dw.wS++}S0a(b){this.ev(!1,null,b)}static yaa(b,h){(new dw).send(b,h,!1)}static B3c(){dw.OAa=!1;dw.wS=0}}dw.dab=null;dw.OAa=!1;dw.wS=0;Object(m.a)(dw,"ClientRequestWithRetry",null,[]);class kK extends Oh{constructor(b){super(b,void 0,v.AFrameworkApplication.XZa)}get C3a(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get Bbc(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get gWc(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get uHc(){return v.AFrameworkApplication.XZa?
"UIFontDialogTextLarge":null}OHf(){u.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}PHf(){u.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}zWc(){u.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get NVc(){return BG.DLi}get Qjb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get SHi(){return!v.AFrameworkApplication.XZa}}Object(m.a)(kK,"DownloadAsOdtDialog",Oh,[]);class lK{constructor(b,h){this.W9a=this.WXa=
null;this.d6a=t=>{1===Jb.App.ya.state||this.WXa||(this.WXa=(new kk.a).create(),t=t.customData,this.fWm(t),1===t?this.WXa.message=this.Frb.dQ.isEnabled?v.AFrameworkApplication.XZa?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:t?2===t&&(this.WXa.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.WXa.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.WXa.YK(CommonUIStrings.l_DefaultDialogTitle,
this.cancelButton,null))};this.cancelButton=()=>{this.$Vd=!0};this.R_=(t,A,O)=>{this.jdg("Success. Save and Conversion Complete.");O=new jb.QueryStringBuilder(O.request.get_url());v.AFrameworkApplication.mea(O);O=O.toString();const aa=this.eZn(O);this.Yla(aa);2!==aa&&this.Frb.TAn();!t||A?this.B4(aa):this.$Vd?(this.$Vd=!1,this.W9a=null):(this.W9a&&v.AFrameworkApplication.oc.Se(this.W9a),this.W9a=null,this.ohl(O,aa))};this.$Vd=!1;this.Frb=b;this.ODj=h.vQa("UserAction","WordEditorForceSaveAndPrint")}Yla(b){this.WXa&&
(this.rWm(b),this.WXa.close(),this.WXa=null)}B4(b){if(1!==Jb.App.ya.state){this.sXm(b);const h=new cf.StandardDialog;h.zd=0;h.Ge(1,CommonUIStrings.l_DialogClose);h.Sw(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}crf(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";case 2:return"odt";default:return u.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}RYn(b){var h=v.AFrameworkApplication.rootQuerySignature;
h&&""!==h?(h="WordViewer/request."+this.Rgf(b)+"?"+h+"&type="+this.crf(b)+"&rndm="+Ya.a.create(),1===b&&this.Frb.Cno()&&(h+="&useNamedAction=1"),v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&Ap.FontUtils.Tfe()&&(1===b||!b)&&(0<Ap.FontUtils.IKh&&(h+="&cfcVer="+Ap.FontUtils.IKh),Ap.FontUtils.HKh&&(h+="&cfcUrl="+Ap.FontUtils.HKh),Ap.FontUtils.JKh&&(h+="&cfcEncData="+Ap.FontUtils.JKh)),dw.yaa(h,this.R_),this.W9a||(this.W9a=new Vb.a(2,1,500,this.d6a),this.W9a.customData=
b,v.AFrameworkApplication.oc.Wb(this.W9a))):(this.jdg("failed. QuerySignature is empty."),this.B4(b))}Rgf(b){return 2===b?"odt":"pdf"}AJb(){this.jdg("Failed. force save failed.")}eZn(b){if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;u.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}jdg(b){u.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",
b);this.ODj.stop()}ohl(b,h){const t=new Mb.a;t.add("access_token");t.add("access_token_ttl");1!==Jb.App.ya.state&&(1===h?this.Frb.Spo(b,t):h?2===h&&new kK(b):new jK(b))}dispose(){}fWm(b){switch(b){case 0:u.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 2:u.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:u.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:u.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}rWm(b){switch(b){case 0:u.ULS.sendTraceTag(38114786,
203,50,"Download Cancelled: Pdf");break;case 2:u.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:u.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:u.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}sXm(b){switch(b){case 0:u.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:u.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:u.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;
default:u.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(m.a)(lK,"FileDownloadManager",null,[]);class LD{get key(){return"LIST"}get zw(){return Box4Intl.Box4Strings.l_ListContentTitle}Vkc(b){let h=null;const t=LD.Ad.Fw(b);if(!t)return{returnValue:!1,Fla:h};b=this.HUl(b,t);h=Object.assign(new hy.a,{rG:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,Fla:h}}VCb(b,h){b=b.contentObject;const t=this.vTl(b.wx),A=new Uh.a;h?(h=h.contentObject,h.level!==b.level?(A.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),A.add(t)):h.id.equals(b.id)&&h.wx.listType===b.wx.listType||A.add(t)):(A.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),A.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),A.add(t));return A.toArray().join(" ")}vTl(b){let h="";const t=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.wu);else if(1===b.listType)switch(t){case 1:h=this.ovh;break;case 2:h=this.nIk;break;case 3:h=this.oIk;break;default:h=
this.ovh}return h}static get Ad(){return null!=LD.uAg?LD.uAg:LD.uAg=Sa.a.instance.resolve("Box4.List.IListReader")}}Object(m.a)(LD,"ListDetailsProvider",null,[58,59]);class mK{constructor(){this.wx=this.listId=this.id=null;this.level=0}}Object(m.a)(mK,"ListItemInfo",null,[]);class nK extends LD{constructor(b){super();this.K5=b}get ovh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get nIk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get oIk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}HUl(b,h){const t=
this.K5.cG(b);return Object.assign(new mK,{id:b.currentNode.id,listId:new W.a(Ya.a.nil,t.listID),wx:h,level:t.level+1})}}Object(m.a)(nK,"FlatListDetailsProvider",LD,[]);class oK{constructor(b,h){this.ga=b;this.If=h}get uc(){return null!=this.jGg?this.jGg:this.jGg=Sa.a.instance.Ma("Box4.Styles.IWACStyleReader")}Ub(){}}Object(m.a)(oK,"FormattingActor",null,[]);var ZM=c(1162),qE=c(1288),$M=c(1689);class pK{constructor(b,h,t,A,O,aa,ua,Ra){this.Hb=b;this.Nbk=h;this.Ic=t;this.Osb=A;this.ym=O;this.Na=aa;
this.jd=ua;this.N1j=Ra}Odc(b,h,t,A,O,aa,ua){u.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ua.ri});this.Osb.then(()=>{this.Nbk(b.data.we);u.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ua.ri});ua.stop()})}Goa(b,h,t,A,O,aa,ua){aa.stop();O();ua?(this.Fvn(h,t),u.ULS.sendTraceTag(574377989,3001,
15,"{0}",{["message"]:b,["id"]:Be.ImageReader.r0a(h.Hb)})):u.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:Be.ImageReader.r0a(h.Hb)})}gph(b,h){b.De(aG.a.$7e,"1");if(this.jd&&this.jd.isFeatureEnabled(47)){var t=this.ym.Wm(h.Yj);t=this.ym.sk(t);b.De(Bh.a.Rs,qE.a[t]);5===t&&this.Ewk(b,h)}this.N1j&&b.De(Bh.a.jUd,"true")}Wih(){return new $M.a(this.Hb.id,this.Hb)}fQd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}Fvn(b,h){const t=this.Ic.Qc(7,qa.a.Xcm);t.Eb(h);b.Hb.setValue(Lc.a.mEh,
!0);t.dispose()}Ewk(b,h){var t=h.Yj;h=this.ym.Wm(t);var A=t.node;const O=(t=this.ym.YDa(h,A.Mc,!1))?this.ym.ODa(t):"";if(""===O)throw u.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");A=(A=this.ym.YDa(h,A.Mc,!0))?this.ym.ODa(A):"";b.De(Bh.a.iec,O);b.De(Bh.a.SDj,A);t=t.ia(fh.a.sVh,"");""!==t&&b.De(Bh.a.extension,t);b.De(Bh.a.width,this.ym.JE(h).toString());b.De(Bh.a.height,this.ym.bG(h).toString());b.De(Bh.a.W_c,
this.ym.Zgb(h).toString());t=this.Na.$("WordEditorImageCropIsEnabled");b.De(Bh.a.VJh,t.toString());t&&(b.De(Bh.a.top,this.ym.Oma(h).toString()),b.De(Bh.a.bottom,this.ym.Lma(h).toString()),b.De(Bh.a.left,this.ym.Mma(h).toString()),b.De(Bh.a.right,this.ym.Nma(h).toString()));t=this.Na.$("WordEditorImageRotateIsEnabled");b.De(Bh.a.m$i,t.toString());t&&(b.De(Bh.a.angle,this.ym.ZZ(h).toString()),b.De(Bh.a.flipH,this.ym.S4(h,Lc.a.yPc,!1)?"true":"false"),b.De(Bh.a.flipV,this.ym.S4(h,Lc.a.KPc,!1)?"true":
"false"));b.De(Bh.a.kRh,"true")}}Object(m.a)(pK,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[427]);class qK{constructor(){this.aKa=null}hDk(b){this.aKa=b}teardown(){null!=this.aKa&&(this.aKa.teardown(),this.aKa=null);this.nMe=null}getGraphicData(){return this.aKa?this.aKa.getGraphicData():null}GRn(){null!=this.nMe&&this.setGraphicData(this.nMe)}setGraphicData(b){this.nMe=b;if(this.aKa)try{this.aKa.setGraphicData(b)}catch(h){u.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",
h.toString())}else u.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.aKa?this.aKa.hasEdits():!1}}Object(m.a)(qK,"GraphicsEditorGC2HostUser",null,[429]);var aN=c(1690),bN=c(1082),cN=c(1364),dN=c(614),eN=c(1455),fN=c(1081);class rK{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(m.a)(rK,"GC2ScriptLoader",null,[]);class cH{constructor(b,
h,t){this.Fte=b;this._context=h;this.ALa=t}closeEditor(){this.Fte&&(this.Fte(),this.Fte=null)}logActivity(b,h,t,A){lb.a(b,h,t,A)}logTrace(b,h,t,A){u.ULS.sendTraceTag(575522531,3001,cH.a2m(h),A)}isEnabled(b){const h=v.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",
!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");case "ShapeLocksSchema":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShapeLocks",!1);default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${Sa.a.instance.resolve("Box4.IFontServiceParser").K_a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",
h);b=Ap.FontUtils.lkf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(t=>"premium"!==t.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return wa.Health.instance}getFonts(b){const h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),t=h?"msofp_hier":"msofp",A=`${Sa.a.instance.resolve("Box4.IFontServiceParser").K_a}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(t,A);Ap.FontUtils.Fjh();
Ap.FontUtils.gkh({});b=Ap.FontUtils.kkf(()=>!1,(O,aa)=>aa).MenuSectionList;h&&0<b.length&&(b.pop(),b.push(this.WXk()));return b}WXk(){const b=Ap.FontUtils.lkf(()=>!1,()=>"").fonts.map((h,t)=>{const A=h.name;h=h.displayName;const O=Ap.FontUtils.Xna(A);return Object.assign(new eE.a,{MenuItemId:Ap.FontUtils.zbj+t,CommandValueId:A,LabelText:h||A,Styles:{["optionText"]:{["fontFamily"]:h&&!O?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:A})});return Object.assign(new eh.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,
Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=this._context.Yj;var t=Be.ImageReader.Wm(h);if(this.NDm(t,h,b)&&(t=Be.ImageReader.S4(t,Gd.a.Loa,""),t.length))return Promise.resolve(t);t=new jb.QueryStringBuilder("/we/GetImage.ashx?");t.YZb(h.node.Ei().Fs);t.De(Bh.a.sGd,b);v.AFrameworkApplication.mea(t);t.De(ag.a.Dpb,"1");tn.a.instance.gyb(t);t.De(Bh.a.VKh,"true");const A=t.toString();return new Promise((O,aa)=>{this.ALa.oj(A,1,null,null,!1,2,ua=>{O(ua.data.we)},ua=>{aa(ua.data.Ve.toString())},
null)})}getPlaceholders(){const b={};b.PictureDownloading=tl.a.Bg("progress.gif");b.PictureInvalid=tl.a.Bg("CancelRequest.32x32x32.png");return b}getTheme(){const b=fm.PageNavigator.instance.Ms(this._context.view.Zc).properties.ia(Lc.a.Oje,"");return 0===b.length?[]:b.split(" ").map(h=>Jb.App.Gzb[h])}static a2m(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}NDm(b,h,t){const A=h.node.Mc;h=Be.ImageReader.mPd(b,A,!1);b=Be.ImageReader.mPd(b,
A,!0);return t===h||t===b}}Object(m.a)(cH,"GraphicsEditorApp",null,[446]);class sK extends Pf.a{constructor(b,h,t,A,O){super(!1,!1,!0);this.closeEditor=()=>{this.MEh();this.dispose()};this.vaa=aa=>{this.MEh(2===aa)};this.m$a=b;this.yZj=h;this.PVg=t;this._context=A;this.ALa=O}$oo(b){return new Promise((h,t)=>{this.Yh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.vaa,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(A,O)=>this.qEk(O,b),["onload"]:A=>{this.onLoad(A,h,t)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.m$a.GRn()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,t){b?(this.m$a.hDk(b),h(b)):(u.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),t(null))}qEk(b,h){const t=v.AFrameworkApplication.K,A=fN.a();A.loadScriptWithRetryHandler=b;const O=new cH(this.closeEditor,this._context,this.ALa),aa={["bootConfig"]:Object.assign(new cN.a,
{scriptBaseUrl:jE.AppChromeOverrideUtilities.isEnabled?jE.AppChromeOverrideUtilities.XOd(v.AFrameworkApplication.lcid):v.AFrameworkApplication.I4+v.AFrameworkApplication.lcid+"/",isMLRRibbonMode:v.AFrameworkApplication.ta.Ob.qic,isCombinedBundleEnabled:v.AFrameworkApplication.K.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new rK(new bN.DynamicScriptLoader(A)),["publicPath"]:v.AFrameworkApplication.I4,["appSettings"]:t.appSettings,["logger"]:new Am.a,["featureGateManager"]:Object.assign(new dN.a,
{getBooleanFeatureGate:Object(z.a)(t,t.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(z.a)(t,t.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(z.a)(t,t.getStringFeatureGate,"getStringFeatureGate")}),["app"]:O,["resolveScript"]:(ua,Ra)=>eN.a.resolveScript(ua,Ra),["initialTabId"]:h};t.$("DynamicBundlesIsEnabled")&&(h=v.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||v.AFrameworkApplication.K.$("IsCombinedBundleEnabled")?"":"exp/",aa.dynamicBundlesPath=
jE.AppChromeOverrideUtilities.isEnabled?jE.AppChromeOverrideUtilities.Xgc+h:t.kb("StaticContentUrl")+h);return new Promise((ua,Ra)=>{b("gc2",v.AFrameworkApplication.qy("gc2.js",5),"anonymous",5,!1).then(()=>{ua(aa)}).catch(()=>{u.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Ra(null)})})}MEh(b){b=this.m$a.hasEdits()&&!b;this.yZj(b?this.m$a.getGraphicData():null,!!this.PVg,this.PVg,b)}}Object(m.a)(sK,"ReactGraphicsEditorDialog",Pf.a,[]);class tK{constructor(b,
h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc,jd=!1){this.CZh=jd;this.Osb=this._context=null;this.apo=(Cd,ee,Od,fe,Ee)=>{var re,Fg,Gg;const bm=!!Ee&&Object(hc.a)(W.a,Ee);try{if(1===Od){const Zr=ee.view;return this.Nj.Mea(ee)&&Zr.features.Cie?32:8}this.g2j=4===(null===Ee||void 0===Ee?void 0:Ee.InputMethod)?!0:!1;Jb.App.instance&&Jb.App.instance.lGb&&(this.CZh||ZM.a.xfb(()=>{this.CZh=!0}));u.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${bm}`);performance.mark("LaunchStart");this._context=
ee;const An=new sK(this.m$a,this.tQf,bm?Ee:null,ee,this.Of);Cd=null;if(bm&&(null===(re=v.AFrameworkApplication.K)||void 0===re?0:re.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectDrawInDrawingCanvasForPictures",!1))){const Zr=null===(Gg=null===(Fg=ee.view.nb)||void 0===Fg?void 0:Fg.hb)||void 0===Gg?void 0:Gg.lb;if(null===Zr||void 0===Zr?0:Zr.uH)Cd="Draw"}this.Osb=An.$oo(Cd).then(()=>{u.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${bm}`)}).catch(()=>
{this.FOh()});if(!bm){const Zr=LA=>{this.Osb.then(()=>{this.ZQi(LA,!1)})};if(v.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return Zr(JSON.stringify({elements:[]})),32;let Av=null;Av=fm.PageNavigator.instance.Ms(ee.view.Zc);const KA=Av.properties.ia(Lc.a.DZh,"");if(0<KA.length)return Zr(KA),32;this.kAe.w7n(ee,W.a.create(),Ya.a.create()).then(LA=>{const AD=this.Ic.Qc(0,qa.a.bPc);AD.Eb(Av);Av.setValue(Lc.a.DZh,LA);AD.dispose();
Zr(LA);return null}).catch(LA=>{u.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",LA.toString(),bm);this.FOh()})}return 32}catch(An){return u.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",An.toString(),bm),8}};this.Dem=(Cd,ee,Od,fe,Ee)=>{if(!ee.view.features.Cie)return 32;u.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.zQh(Ee,ee);return 32};
this.Cem=(Cd,ee,Od,fe,Ee)=>{var re,Fg,Gg;const bm=ee.view;if(null===(re=v.AFrameworkApplication.K)||void 0===re?0:re.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))if(re=null===(Gg=null===(Fg=null===bm||void 0===bm?void 0:bm.nb)||void 0===Fg?void 0:Fg.hb)||void 0===Gg?void 0:Gg.lb,null===re||void 0===re||!re.Z1a)return 8;return this.bhi(Cd,ee,Od,fe,Ee)};this.bhi=(Cd,ee,Od)=>{if(1===Od)return ee.view.features.Cie?32:8;if(2===Od){Cd=Be.ImageReader.Wm(ee.Yj);if(!Cd)return 2;
u.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.zQh(Cd,ee);return 32}return 2};this.ZQi=(Cd,ee=!0)=>{this.m$a.setGraphicData(Cd);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Cd=performance.getEntriesByName("EditorLaunch");u.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${ee} Duration: ${Cd[Cd.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");
performance.clearMeasures("EditorLaunch")};this.tQf=(Cd,ee,Od,fe)=>{var Ee;this.m$a.teardown();if(ee&&this._context){var re=this._context.view.nb.pg,Fg=re.node;re.Xk&&qe.ParagraphReader.Yb(Fg)&&(re=null===(Ee=this.wP)||void 0===Ee?void 0:Ee.bA(Fg),27==(null===re||void 0===re?void 0:re.role)&&u.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",fe,fe?" Everything deleted: "+(0==(null===Cd||void 0===Cd?void 0:Cd.json.length)):""))}if(fe)if(u.ULS.sendTraceTag(541714E3,
3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(Cd)if(fe=Cd.json,Ee=Cd.width,Fg=Cd.height,fe.length||ee)if(!fe.length&&ee)if(ee=this._context.Yj){ee=ee.node;if(Be.ImageReader.a8(ee)){if(!this.Nj.ZRn(ee,new ue.GraphIterator,rl.a.instance,fK.DeleteActor.LZb)){u.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.Nj.$fc(ee,Od,this.eb,this.kV)){u.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}u.ULS.sendTraceTag(572363226,
3001,50,"Graphic removed thru dialog.")}else u.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else re=new aN.a(this._context,v.AFrameworkApplication.ta.lEa,!0,this.Nj,this.Na,fm.PageNavigator.instance),Cd=Ya.a.create(),Od=new EJ.a(re,fe,this.IJ,this.Dm,Cd,vo.a.instance,ee,Od,this.Nj,this.ym,Ee,Fg,this.Na,this.kV,this.jd,Jb.App.instance.lGb,Jb.App.instance.Hwf),this.kAe.b7f(Od,this._context,ee,Cd),this.jqa(),this.g2j&&this.NFo();else u.ULS.sendTraceTag(541714001,
3001,50,"Empty Json on new content creation when close dialog");else u.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else u.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Na=h;this.kAe=t;this.Nj=A;this.IJ=O;this.Dm=aa;this.m$a=new qK;this.Ic=Ra;this.eb=ub;this.kV=Nb;this.ym=Yb;this.jd=Dc;this.Of=bc;this.wP=Pc}Ub(){var b;let h=!0;this.Na.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(h=this.jd&&this.jd.isFeatureEnabled(47));
h&&!ba.a.jt&&(this.ga.gb(Vc.a.graphicsEditor,mc.a.view,this.apo,4),this.ga.gb(qa.a.jef,mc.a.view,this.Dem,4),this.ga.gb(Vc.a.BQh,mc.a.view,this.Cem,4),(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))&&this.ga.gb(Vc.a.e4b,mc.a.view,this.bhi,4))}FOh(){const b=new cf.StandardDialog;b.zd=0;b.Sw(nm.a.Ydf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,
null);Jb.App.ya.updateCommandUI()}zQh(b,h){var t=b.ia(Jh.a.k4,1);const A=b.ia(fh.a.l_,0);t&&1!==A?b.ia(Lc.a.mEh,!1)?(h=new cf.StandardDialog,h.zd=0,h.Sw(nm.a.Ydf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),Jb.App.ya.updateCommandUI(),u.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:Be.ImageReader.r0a(b)})):(this.ga.Rb(Vc.a.graphicsEditor,2,b.id),
this.Osb||(u.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.Osb=new Promise(O=>{O(null)})),t=Ya.a.create(),b=new pK(b,this.ZQi,vo.a.instance,this.Osb,this.ym,this.Na,this.jd,Jb.App.instance.h8(this.ym.sk(b))),this.kAe.b7f(b,h,!0,t)):u.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}jqa(){const b=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):
u.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}NFo(){const b=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):u.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(m.a)(tK,"GraphicsEditorActor",null,[]);var gN=c(544);class uK{constructor(b,h,t){this.mVa="wwaengidc";this.$ed="CreateLinkForHeading";this.UTj="CreateLinkForHeadingAction";this.cWj="\ufffc";this.$Ua=
b;this.ga=h;this.eb=t}Ub(){this.ga.pa(Vc.a.ZGc,mc.a.paragraph,this.f$e.bind(this));this.ga.pa(Vc.a.ZGc,mc.a.Fd,this.f$e.bind(this));this.ga.pa(Vc.a.ZGc,mc.a.Vc,this.f$e.bind(this));this.ga.Uc(Vc.a.ZGc,1028)}f$e(b,h,t){b=h.node;if(1===t)return this.qui(b)?32:8;this.VKn(this.$ed,this.UTj);if(!this.qui(b))return u.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;t=b.getValue(Lc.a.Lc);if(!t)return u.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),
t=new Map,t.set("Source",this.$ed),t=Object.assign(new Hb.a,{additionalValues:t}),wa.Health.instance.recordKpiFailure(this.$ed,"Unable to create sharable link as paragraph id is missing",!1,!0,t),8;this.LHh(t);return 32}LHh(b){b=String.format('{{"{0}":"{1}"}}',gN.a.heading,b);this.ga.Rb(ab.a.A7,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}qui(b){return!this.eb.Yb(b)||this.eb.OSc(b)||this.eb.q$b(b)||b.jr||""===b.characterData||b.characterData===this.cWj||!this.$Ua.eOd(b)?
!1:!0}VKn(b,h){const t=new Map;t.set("Source",this.$ed);t.set("Action",h);wa.Health.instance.recordKpiUsage(b,0,this.mVa,t)}}Object(m.a)(uK,"HeadingsActor",null,[]);class vK{bmo(b){return qe.ParagraphReader.Kta(this.G5h(b))}s5c(b,h,t){if(b=qe.ParagraphReader.vOa(this.G5h(b)))h=b.Ee(h),Object(hc.a)(422,h)&&(DA.m(b)?h.wgo(t):h.s5c())}G5h(b){return b&&b.Xk&&b?b.node:null}}Object(m.a)(vK,"IFrameFocusStrategy",null,[423]);class wK{constructor(b){this.fxb=null;this.qjd=b}mEi(){u.ULS.sendTraceTag(25007835,
375,50,"Ignore all spelling error triggered")}wwj(b){if(!b)return u.ULS.sendTraceTag(25007836,375,15,"Error range is null"),!1;if(!b.errorDetails)return u.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return u.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.fxb=F.a.Zje(b.errorDetails.token,b.errorDetails.lcid);this.qjd.add(this.fxb,b.errorDetails.lcid);return!0}cge(b){return b?
b.token?F.a.Zje(b.token,b.lcid)===this.fxb:(u.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),!1):(u.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(m.a)(wK,"IgnoreAllProofingErrorStrategy",null,[415]);var hN=c(1374),iN=c(581),xK=c(558);class yK{constructor(b,h){this.filename=b;this.blob=h}}Object(m.a)(yK,"UploadBlobParameters",null,[]);class zK extends qk{constructor(b,h,t,A,O,aa,ua,Ra=null){super(b,h,t,null,O,aa,!1);this.m3j="DragAndDrop";
this.xRg="FileName";this.ARg=0;this.Fgh=null;this.xme=this.J3b=!1;this.IPg=A;this.n8g=Ra}get yO(){return this.m3j}get fileExtension(){return this.xRg}get fileSize(){return this.ARg}get JBj(){return this.Fgh}V7c(b){const h=new yK(this.IPg.name,this.IPg);b.dqj(h);this.Fgh=b.rcb}VNa(b,h){this.n8g&&this.n8g();super.VNa(b,h)}IUo(b){const h=!!b&&this.Nya(b.name,null)&&this.Lkg(b,null);b&&(this.xRg=b.name,this.ARg=b.size);h||this.W0d();return h}}Object(m.a)(zK,"DragDropInsertImageUploader",qk,[]);class ut{constructor(b,
h,t,A,O,aa,ua){this.CQc=aa;this.oR=ua;this.h2d=this.i2d=this.E2d=this.F2d=0;this.ga=null;this.Odf=(Ra,ub,Nb)=>{if(Jb.App.uHd)return 8;Ra=ub.node;return 1===Nb?Ra?32:2:2===Nb?(Nb=Be.ImageReader.Wm(ub),ub=Be.ImageReader.NNc(Nb,ub.node.Ei().ud,v.AFrameworkApplication.K,v.AFrameworkApplication.ta.lEa),Zz(ub),32):2};this.pum=(Ra,ub,Nb)=>{var Yb;const bc=this.Nj.Mea(ub);if(2===Nb&&bc){if(qa.a.DQ===Ra||qa.a.TBd===Ra)v.AFrameworkApplication.ioa?v.AFrameworkApplication.zbg():((null===(Yb=v.AFrameworkApplication.K)||
void 0===Yb?0:Yb.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Gr.a.instance.W4a("PictureLocal"),this.v6k(ub));return 32}return 1!==Nb||qa.a.DQ!==Ra&&qa.a.TBd!==Ra?2:bc?32:2};this.AFb=(Ra,ub,Nb,Yb,bc)=>this.Nj.Mea(ub)?1===Nb?32:this.Nj.jyf(ub,bc)?32:2:2;this.Rfo=()=>{if(this.ib&&this.ib.hb&&this.ib.hb.lb){const Ra=this.ib.hb.lb.Qa;Ra&&this.ib.setSelection(wf.SelectionFactory.te(Ra.node,Ra.cpBegin))}};this.pkl=(Ra,ub,Nb,Yb,bc)=>{u.ULS.sendTraceTag(42530333,307,50,
"Drag and drop local content");if((Ra=bc.DataTransfer)&&Ra.files&&0<Ra.files.length){u.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",Ra.files.length));for(Nb=0;Nb<Ra.files.length;Nb++)Yb=Ra.files[Nb],0<=F.a.fh(Yb.type).indexOf("image")&&this.Btm(Yb,ub)&&(Yb=this.ib.hb.lb.Qa,this.ib.setSelection(wf.SelectionFactory.te(Yb.node,Yb.cpBegin+1)));this.DIa();return 32}u.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.gwn=(Ra,ub,Nb,Yb,bc)=>
{if(2===Nb)return v.AFrameworkApplication.xa.Nf(ub.Yj,Ra,Nb,!0,Yb,bc);if(!ub.view.re)return 8;Ra=ub.view;if(!Ra.nb)return 8;Ra=ut.Vg.DN(Ra.nb.pg);return 1===Ra.length&&this.BN(Ra[0])?(this.x_m(),this.UUc||ut.oWf(!0),32):8};this.udm=(Ra,ub,Nb)=>{if(!this.BN(ub))return 8;const Yb=Be.ImageReader.Wm(ub),bc=Be.ImageReader.JE(Yb),Dc=Be.ImageReader.bG(Yb);Ra=Ra===qa.a.ISd;u.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Ra});if(1===Nb)return this.lf.s3||Be.ImageReader.n2a(Yb)?2:Ra&&
bc<this.i2d&&Dc<this.h2d||!Ra&&bc>this.F2d&&Dc>this.E2d?32:2;Nb=Ra?1.1:.9;this.setSize(Yb,ub,bc*Nb,Dc*Nb,!0);return 32};this.tfc=(Ra,ub,Nb,Yb,bc)=>{if(!this.OBa(ub))return 8;Ra=Be.ImageReader.Wm(ub);ub=Be.ImageReader.TDa(Ra);Nb=Be.ImageReader.SDa(Ra);if(0>=ub||0>=Nb)return 2;Ra=Be.ImageReader.JE(Ra)/ub*100;bc.setValue(Gd.a.JQc,Ra);return 32};this.M8b=(Ra,ub,Nb,Yb,bc)=>{if(!this.OBa(ub))return 8;Ra=Be.ImageReader.Wm(ub);if(1===Nb)return this.lf.s3||Be.ImageReader.n2a(Ra)?2:32;u.ULS.sendTraceTag(20459937,
322,50,"Change image scale.");Nb=bc.ia(Gd.a.JQc,-1)/100;Yb=bc.ia(Gd.a.mli,!1);const Dc=bc.ia(Gd.a.Awf,!0);bc=bc.ia(Gd.a.Bwf,!0);if(0>=Nb)return ut.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.LFb}),2;const Pc=Be.ImageReader.TDa(Ra),jd=Be.ImageReader.SDa(Ra),Cd=Be.ImageReader.JE(Ra),ee=Be.ImageReader.bG(Ra);if(0>=Pc||0>=jd)return ut.Jc.Zb(gg.a.J0,{["Reason"]:uf.a.LFb}),2;Yb?(Yb=Dc?Nb*Cd:Cd,Nb=bc?Nb*ee:ee):(Yb=Dc?Nb*Pc:Cd,Nb=bc?Nb*jd:ee);this.setSize(Ra,ub,Yb,Nb);Jb.App.xd.Yp&&Jb.App.xd.Vq.aH(ub.node);this.DIa();
return 32};this.dLb=(Ra,ub,Nb,Yb,bc)=>{if(!this.BN(ub))return 8;Ra=Be.ImageReader.Wm(ub);Ra=Be.ImageReader.bG(Ra);if(0>=Ra)return 2;bc.setValue(Gd.a.rEa,Ra);return 32};this.rEa=(Ra,ub,Nb,Yb,bc)=>{if(!this.OBa(ub))return 8;Ra=Be.ImageReader.Wm(ub);if(1===Nb)return this.lf.s3||Be.ImageReader.n2a(Ra)?2:32;u.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Nb=bc.ia(Gd.a.rEa,0);bc=Be.ImageReader.m2a(Ra);if(0>=Nb)return ut.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.LFb}),2;Yb=Be.ImageReader.TDa(Ra);
const Dc=Be.ImageReader.SDa(Ra),Pc=Be.ImageReader.JE(Ra);var jd=Be.ImageReader.bG(Ra);jd=Pc/jd;if(0>=Yb||0>=Dc)if(ut.Jc.Zb(gg.a.J0,{["Reason"]:uf.a.LFb}),this.hkj(Ra))return 2;this.setSize(Ra,ub,bc?Nb*jd:Pc,Nb);Jb.App.xd.Yp&&Jb.App.xd.Vq.aH(ub.node);Jb.App.ya.updateCommandUI();return 32};this.eLb=(Ra,ub,Nb,Yb,bc)=>{if(!this.BN(ub))return 8;Ra=Be.ImageReader.Wm(ub);Ra=Be.ImageReader.JE(Ra);if(0>=Ra)return 2;bc.setValue(Gd.a.sEa,Ra);return 32};this.sEa=(Ra,ub,Nb,Yb,bc)=>{if(!this.OBa(ub))return 8;Ra=
Be.ImageReader.Wm(ub);if(1===Nb)return this.lf.s3||Be.ImageReader.n2a(Ra)?2:32;u.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Nb=bc.ia(Gd.a.sEa,0);bc=Be.ImageReader.m2a(Ra);if(0>=Nb)return ut.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.LFb}),2;Yb=Be.ImageReader.TDa(Ra);const Dc=Be.ImageReader.SDa(Ra);var Pc=Be.ImageReader.JE(Ra);const jd=Be.ImageReader.bG(Ra);Pc=jd/Pc;if(0>=Yb||0>=Dc)if(ut.Jc.Zb(gg.a.J0,{["Reason"]:uf.a.LFb}),this.hkj(Ra))return 2;this.setSize(Ra,ub,Nb,bc?Nb*Pc:jd);Jb.App.xd.Yp&&
Jb.App.xd.Vq.aH(ub.node);Jb.App.ya.updateCommandUI();return 32};this.gLb=(Ra,ub,Nb,Yb,bc)=>{if(!this.BN(ub))return 8;Ra=Be.ImageReader.Wm(ub);Ra=Be.ImageReader.m2a(Ra);bc.setValue(Gd.a.yX,Ra);return 32};this.yX=(Ra,ub,Nb,Yb,bc)=>{if(!this.BN(ub))return 8;Ra=Be.ImageReader.Wm(ub);if(1===Nb&&this.lf.s3)return 2;Jb.App.xd.Yp&&Jb.App.xd.Vq.aH(ub.node);bc&&(ub=bc.ia(Gd.a.yX,!0),u.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Nj.mfj(Ra,ub),Jb.App.ya.updateCommandUI());return 32};
this.E4a=(Ra,ub,Nb,Yb,bc)=>{if(!this.BN(ub))return 8;Ra=Be.ImageReader.Wm(ub);Ra=Be.ImageReader.iX(Ra);bc.setValue(Gd.a.Phb,Ra);return 32};this.Phb=(Ra,ub,Nb,Yb,bc)=>{if(!this.BN(ub))return 8;if(1===Nb)return this.lf.s3?2:32;if(Jb.App.xd.Yp&&(Ra=ub.node.ia(Jh.a.eJ,Tn.a.nt),Ra!==Tn.a.nt&&(Ra=Jb.App.xd.Vq.Pgb(Ra),xK.CoauthLockEditor.getInstance().V5a(Ra))))return ut.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.tE}),2;Ra=Be.ImageReader.Wm(ub);bc=bc.ia(Gd.a.Phb,null);this.Nj.bco(Ra,ub,bc);u.ULS.sendTraceTag(21297027,
322,50,"Change image alt text.");this.Kd.Bs(13);return 32};this.D4a=(Ra,ub,Nb,Yb,bc)=>{if(!this.BN(ub))return 8;Ra=Be.ImageReader.Wm(ub);Ra=Be.ImageReader.xOa(Ra);bc.setValue(Gd.a.xX,Ra);return 32};this.xX=(Ra,ub,Nb,Yb,bc)=>{if(!this.BN(ub))return 8;if(1===Nb)return this.lf.s3?2:32;if(Jb.App.xd.Yp&&(Ra=ub.node.ia(Jh.a.eJ,Tn.a.nt),Ra!==Tn.a.nt&&(Ra=Jb.App.xd.Vq.Pgb(Ra),xK.CoauthLockEditor.getInstance().V5a(Ra))))return ut.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.tE}),2;Ra=Be.ImageReader.Wm(ub);bc=bc.ia(Gd.a.xX,
null);this.Nj.aco(Ra,ub,bc);u.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Kd.Bs(13);return 32};this.v5a=(Ra,ub,Nb)=>{var Yb,bc;if(1===Nb)return 32;if(!ub.view.re)return u.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",Ra),8;ub=ub.view;Nb=null===(bc=null===(Yb=ub.nb)||void 0===Yb?void 0:Yb.hb)||void 0===bc?void 0:bc.J(0);if(!Nb)return u.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Ra),8;bc=Nb.Qa;Yb=this.oR.eg("UserAction",
Ra.toString());let Dc;Ra==qa.a.A6f?Dc=this.CQc.v5a(bc,2):Ra==qa.a.D6f?(Dc=this.CQc.v5a(bc,0),5==Dc&&(Dc=this.CQc.v5a(bc,2))):Ra==qa.a.E6f&&(Dc=this.CQc.v5a(bc,1),5==Dc&&(Dc=this.CQc.v5a(bc,3)));switch(Dc){case 4:bc=32;ub.p4();break;case 5:bc=2;break;default:bc=8}Yb.stop();u.ULS.sendTraceTag(512267789,322,50,"Select image: {0}. Duration: {1}. Action: {2}",Dc,Yb.ri,Ra);return bc};this.Nj=b;this.Rm=h;this.Kd=t;this.Ug=A;this.ib=O;this.Mh=Tg.a.getInstance(zm.a)}get lf(){return Lk.PageReader.instance}get Aaa(){return this.Rm.instance}get rc(){return this.ga}Vrm(){this.F2d=
Hc.a.Tl(1,0);this.E2d=Hc.a.Tl(1,1);this.i2d=Hc.a.Tl(1920,0);this.h2d=Hc.a.Tl(1280,1)}Ub(b){var h;this.ga=b;const t=this.gwn,A=this.pum,O=this.AFb,aa=this.udm;b.gb(qa.a.DQ,mc.a.view,A,1284);b.pa(qa.a.AFb,mc.a.Vc,O);if(null===(h=Jb.App.instance)||void 0===h?0:h.Oib)b.pa(qa.a.A6f,mc.a.view,this.v5a),b.pa(qa.a.D6f,mc.a.view,this.v5a),b.pa(qa.a.E6f,mc.a.view,this.v5a);b.pa(qa.a.AFb,mc.a.image,O);b.Uc(qa.a.AFb,1284);b.gb(qa.a.TBd,mc.a.view,A,1284);b.gb(qa.a.k4e,mc.a.view,t,1028);this.dr(b,qa.a.ISd,aa);
this.dr(b,qa.a.Nbg,aa);this.dr(b,qa.a.tfc,this.tfc);this.dr(b,qa.a.dLb,this.dLb);this.dr(b,qa.a.eLb,this.eLb);this.dr(b,qa.a.E4a,this.E4a);this.dr(b,qa.a.D4a,this.D4a);this.dr(b,qa.a.M8b,this.M8b);this.dr(b,qa.a.Hee,this.rEa);this.dr(b,qa.a.Iee,this.sEa);this.dr(b,qa.a.w5c,this.Phb);this.dr(b,qa.a.$Mb,this.xX);this.dr(b,qa.a.gLb,this.gLb);this.dr(b,qa.a.yX,this.yX);this.dr(b,qa.a.Odf,this.Odf);b.gb(qa.a.mQh,mc.a.view,this.pkl,4);b.Uc(qa.a.ISd,4);b.Uc(qa.a.Nbg,4);b.Uc(qa.a.tfc,69);b.Uc(qa.a.dLb,69);
b.Uc(qa.a.eLb,69);b.Uc(qa.a.gLb,69);b.Uc(qa.a.E4a,69);b.Uc(qa.a.D4a,69);b.Uc(qa.a.yX,4);b.Uc(qa.a.M8b,4);b.Uc(qa.a.Hee,4);b.Uc(qa.a.Iee,4);b.Uc(qa.a.w5c,4);b.Uc(qa.a.$Mb,4);this.Vrm();this.UUc&&he.a.instance.gx(this.YKk)}dr(b,h,t){b.pa(h,mc.a.image,t);b.pa(h,mc.a.jCb,t);b.pa(h,mc.a.Fd,t);b.pa(h,mc.a.anchoredObject,t)}v6k(b){new qk(b,sf.a.instance,v.AFrameworkApplication.K,null,this.Ug,this.ga)}RUo(b){return this.lf.s3?(ut.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(ut.Jc.Zb(gg.a.Ym,
{["Reason"]:uf.a.jsl}),!1):ut.Zf.JZ(b)?(ut.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.tE}),!1):this.Aaa&&this.Aaa.aU(b)?(ut.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.externalSelection}),!1):!0}RDm(b){const h=Be.ImageReader.Wm(b);return h&&5===Be.ImageReader.sk(h)&&this.psi(b,h)}psi(b,h){(h=!Be.ImageReader.E6b(h)&&!Be.ImageReader.yXd(h))||ut.Jc.Zb(gg.a.Ym,{["Reason"]:uf.a.tEh});return h&&this.RUo(b)}Btm(b,h){var t,A;h=new zK(h,sf.a.instance,v.AFrameworkApplication.K,b,this.Ug,this.ga,this.ib,this.Rfo);if(h.IUo(b))(null===
(A=v.AFrameworkApplication.K)||void 0===A?0:A.$("ShouldLogPicturesExtendedHealthKpis"))&&this.Mh.logKpiUsage({kpiName:zm.c.tEa,kpiType:0});else return(null===(t=v.AFrameworkApplication.K)||void 0===t?0:t.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new Hb.a,{extendedProperties:b}),this.Mh.logKpiFailure({kpiName:zm.c.tEa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:zm.c.K8b,
errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):wa.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),u.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new Ak.a(document.body,Object(z.a)(h,h.$dc,"onUploadFrameInitialized"),Object(z.a)(h,h.Fya,"uploadResponseReceived"),v.AFrameworkApplication.K,!1,void 0,Do.a(v.AFrameworkApplication.K));return!0}BN(b){return this.RDm(b)}OBa(b){const h=
Be.ImageReader.Wm(b);if(!h)return!1;const t=Sa.a.instance.Ma("Box4.IFeatureHelper"),A=Be.ImageReader.sk(h);return 5===A||10===A||48===A||11===A||t&&t.isFeatureEnabled(47)&&4===A?this.psi(b,h):!1}get UUc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdatedTabUpdateEnabled",!1)}YKk(){ut.oWf(!0)}setSize(b,h,t,A,O=!1){Jb.App.xd.Yp&&Jb.App.xd.Vq.aH(h.node);const aa=Be.ImageReader.m2a(b);let ua=1;t>this.i2d?ua=this.i2d/t:t<
this.F2d&&(ua=this.F2d/t);let Ra=1;A>this.h2d?Ra=this.h2d/A:A<this.E2d&&(Ra=this.E2d/A);if(aa||O)ua=Math.min(ua,Ra),Ra=Math.min(ua,Ra);1!==ua&&(t*=ua);1!==Ra&&(A*=Ra);this.odf(b,h,t,A)}odf(b,h,t,A){this.Nj.cgo(b,h,t,A)}x_m(){u.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}DIa(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied",
"WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}hkj(b){const h=Be.ImageReader.TDa(b);b=Be.ImageReader.SDa(b);return 0>=h||0>=b}static get Vg(){return Ik.ContextSetEditor.instance}static get Zf(){return rl.a.instance}static get Jc(){return zk.a.instance}}ut.oWf=null;Object(m.a)(ut,"ImageActor",null,[]);var dH=c(1160),eH=c(1161),jN=c(1096);class jG{constructor(b,h,t,A,O,aa){this.imagePropertySet=b;this.graphNode=h;this.context=t;this.kef=A;this.adm=O;this.BLc=aa;if(this.M1a=Jb.App.instance&&Jb.App.instance.M1a())this.Gze=
new jN.a(this.Nt(),jG.smc)}rotate(b){this.Rga("rotate");if(null===this.imagePropertySet||void 0===this.kef||void 0===this.BLc)return this.$X("rotate","Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");if(void 0===h)return!1;b-=this.imagePropertySet.XDb();if(0!==b){const t=this.BLc.sbm();t.rotation=b;try{if(!this.Mqh(t,h))return this.$X("rotate","Failed to apply and update"),!1}catch(A){return this.$X("rotate",A.stack?A.stack:A.message?A.message:A.toString()),!1}}return!0}resize(b,h){this.Rga("resize");
if(null===this.imagePropertySet||void 0===this.kef||void 0===this.BLc)return this.$X("resize","Argument(s) invalid"),!1;const t=this.getGraphicData("resize");if(void 0===t)return!1;let A=0;var O=0;({width:A,height:O}=Be.ImageReader.Kgb(this.imagePropertySet));b/=A;h/=O;O=this.BLc.tbm();O.scale=this.BLc.R5l();O.scale.width=b;O.scale.height=h;try{if(!this.Mqh(O,t))return this.$X("resize","Failed to apply and update"),!1}catch(aa){return this.$X("resize",aa.stack?aa.stack:aa.message?aa.message:aa.toString()),
!1}return!0}static get smc(){return Sa.a.instance.Ma("Box4.ICssColorProvider")}getGraphicData(b){try{if(this.M1a){const h=this.Gze.kei(Oj.a.oQ(this.context));return this.imagePropertySet.getGraphicData(h)}return this.imagePropertySet.getGraphicData()}catch(h){this.$X(b,h.stack?h.stack:h.message?h.message:h.toString())}}Mqh(b,h){this.kef.apply(b,h);b=this.imagePropertySet.JCb(h);if(void 0===b)return!1;this.QLo(b);return!0}QLo(b){const h=new Te.GraphTransaction(15);h.Eb(this.graphNode);this.imagePropertySet.setValue(zf.a.d_,
b.d_);this.adm.Y3n(b.oUh,b.rwa,this.imagePropertySet);h.dispose()}Nt(){return fm.PageNavigator.instance.Ms(this.graphNode)}Rga(b){const h=this.qog;h.edit=b;u.ULS.sendTraceTag(509657553,322,50,"{0}",h)}$X(b,h){const t=this.qog;t.message=h;t.edit=b;u.ULS.sendTraceTag(509666444,322,15,"{0}",t)}get qog(){return{["id"]:Be.ImageReader.r0a(this.imagePropertySet),["type"]:Be.ImageReader.sk(this.imagePropertySet)}}}Object(m.a)(jG,"EditWithGC2Command",null,[]);class fH{Y3n(b,h,t){this.RSm(b,h);this.a4n(t)}RSm(b,
h){this.mH=Array(4);this.mH[0]=Math.round(b.yef);this.mH[2]=Math.round(b.Aef);this.mH[1]=Math.round(b.zef);this.mH[3]=Math.round(b.xef);this.PNa=Math.round(b.PNa);this.QNa=Math.round(b.QNa);(this.rwa=h)&&this.s_k()}a4n(b){b.setValue(zf.a.tva,this.PNa.toString());b.setValue(zf.a.uva,this.QNa.toString());const h=Array(4);this.mH.forEach((t,A)=>{h[A]=t.toString()});b.setValue(zf.a.KOa,h);b.setValue(zf.a.Y1a,this.rwa)}s_k(){this.ayo();const b=this.PNa/2,h=this.QNa/2;this.PNa%2&&0===this.QNa%2?(--this.mH[0],
++this.mH[2]):this.QNa%2&&0===this.PNa%2&&(++this.mH[0],--this.mH[2]);this.mH[0]+=b-h;this.mH[1]-=b-h;this.mH[2]+=h-b;this.mH[3]-=h-b}ayo(){const b=this.PNa;this.PNa=this.QNa;this.QNa=b}}Object(m.a)(fH,"GraphicsExtents",null,[]);var kG=c(700),AK=c(546),kN=c(545),lN=c(1457);class xr extends ut{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb){super(b,h,A,aa,ua,Ra,ub);this.$1g=!1;this.jAa=this.w$=null;this.ew=(Yb,bc,Dc,Pc,jd)=>{if(!this.BN(bc))return 8;if(1===Dc)return this.lf.s3?2:32;Yb=parseInt(jd);u.ULS.sendTraceTag(593372312,
322,50,"SetPictureStyle: "+Yb);this.lsd.cGn(bc,Be.ImageReader.Wm(bc),Yb);this.vWc(bc);this.DIa();return 32};this.kce=(Yb,bc,Dc)=>{if(!this.BN(bc))return 8;u.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");Yb=Be.ImageReader.Wm(bc);if(1===Dc)return this.lf.s3?2:32;Dc=Be.ImageReader.Lgb(Yb);1===Dc?(Dc=new Te.GraphTransaction(15),Dc.Eb(bc.node),Be.ImageReader.N9b()?Yb.setValue(Lc.a.mKb,""):this.TJ.LSn(Yb),Dc.dispose(),this.Iyc.create(Yb,bc).ew(Ji.a.u8i),this.vWc(bc)):2===Dc&&this.Iyc.create(Yb,
bc).ew(Ji.a.u8i);return 32};this.cfm=(Yb,bc,Dc,Pc,jd)=>{if(!this.BN(bc))return 8;Yb=Be.ImageReader.Wm(bc);if(1===Dc)return this.lf.s3||Be.ImageReader.x$b(Yb)?2:32;jd&&(this.TJ.U8c(Yb,bc),u.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Jb.App.ya.updateCommandUI());this.DIa();return 32};this.dfm=(Yb,bc,Dc,Pc,jd)=>{if(!this.BN(bc))return 8;if(1===Dc)return this.lf.s3?2:32;Yb=Be.ImageReader.Wm(bc);if(jd){Dc=Be.ImageReader.bWd(Be.ImageReader.Wm(bc));u.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+
Dc);Pc=jd.ia(Gd.a.Uhb,0);const Cd=jd.ia(Gd.a.Rhb,0),ee=jd.ia(Gd.a.Shb,0);jd=jd.ia(Gd.a.Thb,0);const Od=Be.ImageReader.Oma(Yb),fe=Be.ImageReader.Lma(Yb),Ee=Be.ImageReader.Mma(Yb),re=Be.ImageReader.Nma(Yb);if(Pc===Od&&Cd===fe&&ee===Ee&&jd===re)return u.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;Dc?(new dH.a(Yb,new eH.a)).T$n(Pc,Cd,ee,jd,this.ygn,bc):this.lsd.TFn(bc,Be.ImageReader.Wm(bc),Pc,Cd,ee,jd);this.vWc(bc);Jb.App.ya.updateCommandUI()}return 32};
this.QSd=(Yb,bc,Dc,Pc,jd)=>{if(!this.BN(bc))return 8;Pc=Be.ImageReader.Wm(bc);if(1===Dc)return this.lf.s3||Be.ImageReader.x$b(Pc)?2:32;if(jd){u.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.TJ.Yva()||this.TJ.U8c(Pc,bc);switch(Yb){case Vc.a.zQc:Yb=jd.ia(Gd.a.Uhb,-1);Dc=0;break;case Vc.a.wQc:Yb=jd.ia(Gd.a.Rhb,-1);Dc=1;break;case Vc.a.xQc:Yb=jd.ia(Gd.a.Shb,-1);Dc=2;break;case Vc.a.yQc:Yb=jd.ia(Gd.a.Thb,-1);Dc=3;break;default:return 8}this.TJ.yOo(Yb,
Dc);this.vWc(bc);Jb.App.ya.updateCommandUI()}return 32};this.jmb=(Yb,bc,Dc,Pc,jd)=>{if(!this.BN(bc))return 8;Be.ImageReader.Wm(bc);jd&&(Yb=this.TJ.Yva(),jd.setValue(Gd.a.Yva,Yb));return 32};this.sfc=(Yb,bc,Dc,Pc,jd)=>{if(!this.BN(bc))return 8;bc=Be.ImageReader.Wm(bc);if(jd){if(this.TJ.Yva())({top:ee,bottom:Dc,left:Yb,right:bc}=this.TJ.lLl());else{Pc=Hc.a.ef(Be.ImageReader.JE(bc),0);var Cd=Hc.a.ef(Be.ImageReader.bG(bc),1);var ee=Math.max(Be.ImageReader.Oma(bc),0);Dc=Math.max(Be.ImageReader.Lma(bc),
0);Yb=Math.max(Be.ImageReader.Mma(bc),0);bc=Math.max(Be.ImageReader.Nma(bc),0);Pc=1E5*Pc/(1E5-(Yb+bc));Cd=1E5*Cd/(1E5-(ee+Dc));ee=Math.floor(ee*Cd/1E5);Dc=Math.floor(Dc*Cd/1E5);Yb=Math.floor(Yb*Pc/1E5);bc=Math.floor(bc*Pc/1E5)}jd.setValue(Gd.a.Uhb,ee);jd.setValue(Gd.a.Rhb,Dc);jd.setValue(Gd.a.Shb,Yb);jd.setValue(Gd.a.Thb,bc)}return 32};this.Z7b=(Yb,bc,Dc,Pc,jd)=>{if(!this.BN(bc))return 8;if(1===Dc){if(this.lf.s3)return 2;this.W1m();return 32}Yb=Be.ImageReader.Wm(bc);this.TJ.Yva()&&this.TJ.U8c(Yb,
bc);Yb=jd.ia(Gd.a.sHa,"");jd=jd.ia(Gd.a.M7a,0);u.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:jd,["SourceControlId"]:Yb});switch(jd){case 1:this.TJ.Tgo(bc);break;case 8:this.TJ.Dfe(bc,1,1);break;case 9:this.TJ.Dfe(bc,1,3);break;case 3:this.TJ.Dfe(bc,2,void 0,!0);break;case 4:this.TJ.Dfe(bc,2,void 0,!1)}this.DIa();Jb.App.ya.updateCommandUI();return 32};this.Gfc=(Yb,bc,Dc,Pc,jd)=>{if(!this.BN(bc))return 8;Yb=Be.ImageReader.Wm(bc);bc=Be.ImageReader.w3(bc);Dc=Be.ImageReader.b8(Yb);
Pc=Be.ImageReader.BOc(Yb);Yb=Be.ImageReader.Uv(Yb);return this.RFn(bc,Dc,Pc,Yb,jd)?32:8};this.ffm=(Yb,bc,Dc,Pc,jd)=>{var Cd;if(!this.OBa(bc))return 8;Pc=Be.ImageReader.Wm(bc);if(1===Dc)return fc.SessionStatusManager.instance.xj?8:this.lf.s3||Be.ImageReader.y$b(Pc)?2:32;this.TJ.Yva()&&this.TJ.U8c(Pc,bc);if(this.lti(Pc)&&(Dc=null===(Cd=x())||void 0===Cd?void 0:Cd.K2b(),Cd=new jG(Pc,bc.node,bc,Dc,new fH,y()),Dc=jd.ia(Gd.a.WI,0),Cd.rotate(Dc)))return 32;if(jd){Dc=jd.ia(Gd.a.GQc,0);const ee=Be.ImageReader.bWd(Pc);
u.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",Dc,ee);Cd=Be.ImageReader.ZZ(Pc);let Od=Be.ImageReader.kOd(Pc),fe=Be.ImageReader.kDb(Pc);switch(Dc){case 0:Cd=jd.ia(Gd.a.WI,0);break;case 2:Cd-=90;Cd=fk.c(Cd);break;case 1:Cd+=90;Cd=fk.c(Cd);break;case 4:Od=!Od;break;case 3:fe=!fe;break;case 5:Cd+=jd.ia(Gd.a.WI,0),Cd=fk.c(Cd)}ee?(new dH.a(Pc,new eH.a)).qfo(Cd,Od,fe,this.zmn,bc):Dc?this.Iyc.create(Pc,bc).zeo(Cd,Od,fe):(jd=Ya.a.create(),Dc=new Te.GraphTransaction(15,qa.a.imageRotate),
Dc.Eb(bc.node),this.TJ.kco(Pc,Cd),this.lsd.ZFn(bc,Be.ImageReader.Wm(bc),Cd,jd),Dc.zFa(jd,1),Dc.kk=Yb,Dc.dispose());this.DIa();this.vWc(bc);Jb.App.ya.updateCommandUI()}return 32};this.fLb=(Yb,bc,Dc,Pc,jd)=>{if(!this.BN(bc))return 8;Yb=Be.ImageReader.Wm(bc);Yb=Be.ImageReader.ZZ(Yb);if(0>Yb)return 2;jd.setValue(Gd.a.WI,Yb);return 32};this.zmn=(Yb,bc,Dc,Pc)=>{if(Yb){const jd=new Te.GraphTransaction(15,qa.a.imageRotate);jd.Eb(Pc.node);bc.setValue(Gd.a.pzb,JSON.stringify(Dc));bc.setValue(Gd.a.Pt,Yb);this.TJ.Lee(bc,
Dc.rotationAngle,Dc.w8b,Dc.Tlc);this.zCb(bc);jd.dispose()}};this.kmn=(Yb,bc,Dc,Pc)=>{if(Yb){const jd=new Te.GraphTransaction(15);jd.Eb(Pc.node);bc.setValue(Gd.a.pzb,JSON.stringify(Dc));bc.setValue(Gd.a.Pt,Yb);this.TJ.qee(bc,Dc.mle,Dc.V9c);this.zCb(bc);jd.dispose()}};this.ygn=(Yb,bc,Dc,Pc)=>{if(Yb){const jd=new Te.GraphTransaction(15);jd.Eb(Pc.node);bc.setValue(Gd.a.pzb,JSON.stringify(Dc));bc.setValue(Gd.a.Pt,Yb);this.TJ.eco(bc,Math.round(Dc.cua*kG.a.xeb),Math.round(Dc.$ta*kG.a.xeb),Math.round(Dc.aua*
kG.a.xeb),Math.round(Dc.bua*kG.a.xeb));this.zCb(bc);jd.dispose()}};this.h0c=(Yb,bc,Dc,Pc,jd)=>{if(!this.OBa(bc))return 8;if(1===Dc)return 32;Yb=bc.contextId===mc.a.view?Lk.PageReader.instance.ONc(bc):fm.PageNavigator.instance.Ms(bc.node);if(!Yb)return 8;Dc=Be.ImageReader.Wm(bc);bc=this.Co.I$h(Oj.a.oQ(bc),Dc);xr.gWi.LMb=bc;this.$Tc&&this.recentColors.Gjg(bc);bc=xr.gWi.CLc(Yb,Jb.App.Gzb);if(!bc)return 8;jd.MenuItems=bc;return 32};this.k9=(Yb,bc,Dc,Pc,jd)=>{if(!this.OBa(bc))return 8;if((Pc=Be.ImageReader.Wm(bc))&&
Be.ImageReader.Zx(Pc))return 2;if(1===Dc)return 32;if(2!==Dc)return 2;if(!jd)return u.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;Dc=new Te.GraphTransaction(15);Dc.Eb(bc.node);const Cd=xr.lkc.WMa(bc.node,jd);this.Co.k9(Pc,jd,bc,Cd);this.zCb(Pc);Dc.dispose();Yb==qa.a.G5c&&this.recentColors.Kcb(jd);this.Rbd();this.DIa();return 32};this.mha=(Yb,bc,Dc)=>{if(!this.OBa(bc))return 8;if(1===Dc)return 32;Jb.App.ya.Dw();xr.P8a=new qw.a("PictureBorder",qa.a.G5c);xr.P8a.xic(0);
return 32};this.eia=(Yb,bc,Dc,Pc,jd)=>{if(!this.OBa(bc))return 8;if(1===Dc)return 32;if((Yb=Be.ImageReader.Wm(bc))&&Be.ImageReader.Zx(Yb))return 2;if(!jd)return u.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;Dc=new Te.GraphTransaction(15);Dc.Eb(bc.node);this.Co.eia(Yb,jd,bc);this.zCb(Yb);Dc.dispose();this.Rbd();this.DIa();return 32};this.P5a=(Yb,bc,Dc,Pc,jd)=>{if(!this.OBa(bc))return 8;if(1===Dc)return 32;if((Yb=Be.ImageReader.Wm(bc))&&Be.ImageReader.Zx(Yb))return 2;
if(!jd)return u.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),8;Dc=new Te.GraphTransaction(15);Dc.Eb(bc.node);this.Co.P5a(Yb,jd,bc);this.zCb(Yb);Dc.dispose();this.Rbd();this.DIa();return 32};this.tbe=(Yb,bc,Dc)=>{if(!this.OBa(bc))return 8;if(1===Dc)return 32;Yb=Be.ImageReader.Wm(bc);Dc=new Te.GraphTransaction(15);Dc.Eb(bc.node);Be.ImageReader.i8b(Yb)&&(this.Co.tbe(Yb),this.zCb(Yb));Dc.dispose();this.Rbd();this.DIa();return 32};this.TJ=b;this.Iyc=t;this.lsd=O;xr.Fh=Nb;
ut.oWf=xr.hwn}get recentColors(){return null!=this.vCg?this.vCg:this.vCg=Sa.a.instance.Ma("Box4.UI.RecentColorsSectionHandler")}get Co(){this.w$||(this.w$=new AK.a);return this.w$}Ub(b){super.Ub(b);this.dr(b,qa.a.ew,this.ew);b.Uc(qa.a.ew,4);this.dr(b,qa.a.kce,this.kce);this.dr(b,Vc.a.Dne,this.Z7b);b.Uc(Vc.a.Dne,4);this.dr(b,Vc.a.Ene,this.Z7b);this.dr(b,Vc.a.Fne,this.Z7b);this.dr(b,Vc.a.Gne,this.Z7b);this.dr(b,Vc.a.Hne,this.Z7b);this.dr(b,Vc.a.Ine,this.Z7b);this.dr(b,Vc.a.Gfc,this.Gfc);b.Uc(Vc.a.Gfc,
101);this.dr(b,Vc.a.imageCrop,this.cfm);b.Uc(Vc.a.imageCrop,4);this.dr(b,Vc.a.jmb,this.jmb);b.Uc(Vc.a.jmb,101);this.dr(b,Vc.a.Yki,this.dfm);this.dr(b,Vc.a.zQc,this.QSd);this.dr(b,Vc.a.wQc,this.QSd);this.dr(b,Vc.a.xQc,this.QSd);this.dr(b,Vc.a.yQc,this.QSd);this.dr(b,Vc.a.d1c,this.sfc);b.Uc(Vc.a.d1c,101);this.dr(b,Vc.a.d$d,this.sfc);b.Uc(Vc.a.d$d,101);this.dr(b,Vc.a.e$d,this.sfc);b.Uc(Vc.a.e$d,101);this.dr(b,Vc.a.f$d,this.sfc);b.Uc(Vc.a.f$d,101);this.dr(b,qa.a.imageRotate,this.ffm);b.Uc(qa.a.imageRotate,
4);this.dr(b,qa.a.fLb,this.fLb);b.Uc(qa.a.fLb,101);this.dr(b,qa.a.h0c,this.h0c);b.Uc(qa.a.h0c,4);this.dr(b,qa.a.k9,this.k9);b.Uc(qa.a.k9,4);this.dr(b,qa.a.G5c,this.k9);b.Uc(qa.a.G5c,4);this.dr(b,qa.a.YTf,this.mha);b.Uc(qa.a.YTf,4);this.dr(b,qa.a.sxa,this.sxa.bind(this));b.Uc(qa.a.sxa,4);this.dr(b,qa.a.eia,this.eia);b.Uc(qa.a.eia,4);this.dr(b,qa.a.hLb,this.hLb.bind(this));b.Uc(qa.a.hLb,4);this.dr(b,qa.a.P5a,this.P5a);b.Uc(qa.a.P5a,4);this.dr(b,qa.a.sOf,this.tbe);b.Uc(qa.a.sOf,4)}odf(b,h,t,A){var O;
u.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+Be.ImageReader.bWd(b));this.TJ.Yva()&&this.TJ.U8c(b,h);if(this.lti(b)){const aa=null===(O=x())||void 0===O?void 0:O.K2b();if((new jG(b,h.node,h,aa,new fH,y())).resize(t,A))return}Be.ImageReader.Zx(b)?(b=Ya.a.create(),O=new Te.GraphTransaction(15),O.Eb(h.node),this.lsd.YFn(h,Be.ImageReader.Wm(h),t,A,b),O.zFa(b,1),O.dispose()):Be.ImageReader.uic(b)?(new dH.a(b,new eH.a)).afo(t,A,this.kmn,h):(super.odf(b,h,t,A),this.Kd.Bs(13))}BN(b){if(!b.Xk)return!1;
var h=b.node;return(h=Jb.App.instance&&Jb.App.instance.lGb?h instanceof zq.a||h instanceof lN.a?h:null:Object(Da.a)(zq.a,h))&&DA.o(h)?(ut.Jc.Zb(hN.a.Ym,{["Reason"]:iN.a.IN}),!1):super.BN(b)}static hwn(b){b&&!xr.Tub&&(xr.Fh.mYa(xr.Ukb),xr.Tub=!0)}RFn(b,h,t,A,O){return O?(O.Iti=b,O.b8=h,O.TOb=t,O.Xv=A,O.M7a=xr.zbm(O),!0):!1}lti(b){b=Be.ImageReader.sk(b);const h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditsWithGC2",!1);return Jb.App.instance&&Jb.App.instance.h8(b)?
(v.AFrameworkApplication.ye("editswithgc2;editswithgc2cf"),h):!1}vWc(b){Jb.App.xd.Yp&&Jb.App.xd.Vq.aH(b.node)}W1m(){this.$1g||(u.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.$1g=!0)}zCb(b){const h=kN.a.instance.igf(b);this.TJ.Jee(b,h[0],h[1],h[2],h[3])}sxa(b,h,t,A,O){2===t&&(b=Be.ImageReader.Wm(h),this.Co.QLj(O,b));return 32}hLb(b,h,t,A,O){2===t&&(b=Be.ImageReader.Wm(h),this.Co.PLj(O,b));return 32}Rbd(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&
window.setTimeout(()=>{const b=Sa.a.instance.Sa("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get lkc(){return null!=xr.uEg?xr.uEg:xr.uEg=xl.a.instance}static get gWi(){xr.nV||(xr.nV=new Cy.a("PictureBorder"),xr.AEa(xr.nV));return xr.nV}static zbm(b){if(b.Iti)b=1;else switch(b.TOb){case 2:b=b.b8?3:4;break;case 1:b=1===b.Xv?8:3===b.Xv?9:2;break;case 0:b=5;break;case 3:b=6;break;case 4:b=7;break;default:b=
0}return b}static AEa(b){b.tW(3,qa.a.k9);b.tW(4,qa.a.k9);b.tW(5,qa.a.G5c);b.tW(6,qa.a.k9);b.fyb(Lx.a.instance,1)}get $Tc(){null==this.jAa&&(v.AFrameworkApplication.ye("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.jAa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.jAa}}xr.Tub=!1;xr.nV=null;xr.P8a=null;xr.Ukb=()=>{xr.Fh.dgc(xr.Ukb);xr.Tub=!1;if(Rh.c()){var b=appChrome.selectors.getActiveContextualTabIds();
"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else u.ULS.sendTraceTag(509445760,322,50,"appChrome is undefined")};Object(m.a)(xr,"ImageActor",ut,[]);class qn{static get paragraphEditor(){return null!=qn.RBg?qn.RBg:qn.RBg=Sa.a.instance.resolve("Box4.IParagraphEditor")}static get sA(){return null!=qn.bCg?qn.bCg:qn.bCg=Sa.a.instance.resolve("Box4.IParagraphIndentationReader")}static get Y_(){return qn.paragraphEditor.Xp}static get Ug(){return null!=
qn.wFg?qn.wFg:qn.wFg=Sa.a.instance.resolve("Box4.IUndoManager")}static Ub(){const b=v.AFrameworkApplication.xa;b.pa(qa.a.SKb,mc.a.view,hn.a.Mv);b.pa(qa.a.SKb,mc.a.paragraph,qn.dla);b.Uc(qa.a.SKb,1036);b.pa(qa.a.ZAb,mc.a.view,hn.a.Mv);b.pa(qa.a.ZAb,mc.a.paragraph,qn.dla);b.Uc(qa.a.ZAb,1036);b.pa(qa.a.Leb,mc.a.view,hn.a.Mv);b.pa(qa.a.Leb,mc.a.paragraph,qn.dla);b.Uc(qa.a.Leb,1036);b.pa(qa.a.Zfc,mc.a.view,hn.a.Mv);b.pa(qa.a.Zfc,mc.a.paragraph,qn.dla);b.Uc(qa.a.Zfc,1036);b.pa(qa.a.G2c,mc.a.view,hn.a.Mv);
b.pa(qa.a.G2c,mc.a.paragraph,qn.dla);b.Uc(qa.a.G2c,1036);b.pa(qa.a.v1a,mc.a.view,hn.a.Mv);b.pa(qa.a.v1a,mc.a.paragraph,qn.dla);b.Uc(qa.a.v1a,1036);b.pa(qa.a.Zhb,mc.a.view,hn.a.Mv);b.pa(qa.a.Zhb,mc.a.paragraph,qn.dla);b.Uc(qa.a.Zhb,1036);b.pa(qa.a.u1a,mc.a.view,hn.a.Mv);b.pa(qa.a.u1a,mc.a.paragraph,qn.dla);b.Uc(qa.a.u1a,1036);b.pa(qa.a.Nee,mc.a.view,qn.Hhe);b.pa(qa.a.Nee,mc.a.paragraph,qn.Hhe);b.Uc(qa.a.Nee,1028);b.pa(qa.a.K8f,mc.a.view,qn.Hhe);b.pa(qa.a.K8f,mc.a.paragraph,qn.Hhe);b.Uc(qa.a.K8f,1028);
b.pa(qa.a.mNb,mc.a.view,hn.a.Mv);b.pa(qa.a.mNb,mc.a.paragraph,qn.dla);b.Uc(qa.a.mNb,1036);b.pa(qa.a.wnb,mc.a.view,hn.a.Mv);b.pa(qa.a.wnb,mc.a.paragraph,qn.dla);b.Uc(qa.a.wnb,1036);b.pa(qa.a.nNb,mc.a.view,hn.a.Mv);b.pa(qa.a.nNb,mc.a.paragraph,qn.dla);b.Uc(qa.a.nNb,1036);b.pa(qa.a.scg,mc.a.view,hn.a.Mv);b.Uc(qa.a.scg,1028);b.pa(qa.a.R5c,mc.a.view,hn.a.Mv);b.pa(qa.a.R5c,mc.a.paragraph,qn.dla);b.Uc(qa.a.R5c,1036);b.pa(qa.a.S5c,mc.a.view,hn.a.Mv);b.pa(qa.a.S5c,mc.a.paragraph,qn.dla);b.Uc(qa.a.S5c,1036)}static Hhe(b,
h,t,A,O){2===t&&""===O[Ue.a.Text]&&(b=b===qa.a.Nee?qa.a.v1a:qa.a.u1a,h=new WC.a,h.value=0,h.unit=Jb.App.ZEa?2:1,v.AFrameworkApplication.xa.Rb(b,2,h),Jb.App.ya.updateCommandUI());return 32}static dla(b,h,t,A,O){if(!({Qx:t}=hn.a.Q$f(t,h)).returnValue)return t;h=h.node;switch(b){case qa.a.SKb:qn.Y_.XYf(h,!0);break;case qa.a.ZAb:qn.Y_.XYf(h,!1);break;case qa.a.Leb:qn.Y_.Leb(h);break;case qa.a.Zfc:qn.Y_.sca(h,0);break;case qa.a.G2c:qn.Y_.lnb(h,0);break;case qa.a.Zhb:case qa.a.v1a:t=new ue.GraphIterator;
t.set(h);t.Ab(11);let aa=O.value;O=O.unit;b===qa.a.Zhb&&(aa=(new or.a(O,aa)).wt+qn.sA.aG(h).wt,O=1);qn.Y_.$xa(t,O,aa);break;case qa.a.u1a:qn.Y_.aNb(h,O.unit,O.value);break;case qa.a.mNb:O?(b=(new or.a(O.unit,O.value)).wt,qn.Y_.sca(h,b)):qn.sA.RNd(h).wt||qn.Y_.sca(h,mj.OutlineReader.eX(h));break;case qa.a.wnb:O?(b=(new or.a(O.unit,O.value)).wt,qn.Y_.lnb(h,b)):qn.sA.aG(h).wt||qn.Y_.lnb(h,mj.OutlineReader.eX(h));break;case qa.a.nNb:qn.Y_.sca(h,0);break;case qa.a.R5c:b=O;b=(new or.a(b.unit,b.value)).wt;
qn.Y_.z9f(h,1,b);break;case qa.a.S5c:b=O,b=(new or.a(b.unit,b.value)).wt,qn.Y_.z9f(h,2,b)}qn.Ug.QE();A&&Ds.a.Gob&&(A.Ur|=Ds.a.xgb(h));return 32}}Object(m.a)(qn,"IndentationActor",null,[]);var BK=c(316),mN=c(50),lG=c(456),nN=c(1201);class as{constructor(b){this.wWa=this.rBa=this.Lwc=null;this.Rhh=!1;this.p9d=h=>{if(this.rBa)if(h===ab.a.o9d)yd.FocusManager.instance().getRegion(vf.AFrame.v4a).Icc();else if(h===ab.a.n9d)yd.FocusManager.instance().getRegion(vf.AFrame.v4a).Gcc();else return 2;else return 2;
return 32};this._frame=b}$uo(){if(this.Rhh)this.UAi();else{const b=nb.a.create(v.AFrameworkApplication.K.kb("WopiBootstrapUrl"));b.tZ((h,t)=>{t.succeeded?(this.Rhh=!0,this.UAi()):u.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});bb.a.ZW(b)}}UAi(){if(this.Lwc)u.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.wqa;this.rBa=document.createElement("div");b.parentNode.insertBefore(this.rBa,b);this.wWa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,
{fileName:v.AFrameworkApplication.K.kb("FileName"),reactRoot:this.rBa});this.wWa.setWebpackPublicPath(v.AFrameworkApplication.I4);this.wWa.renderDocumentPanel()}}zTl(b){const h={};h.Container=b;h.BootstrapperUrl=v.AFrameworkApplication.K.kb("WopiBootstrapUrl");h.ApplicationUrl=this._frame.zpb;b={};b.HostName=v.AFrameworkApplication.K.kb("FileSource");b.HostSessionId=v.AFrameworkApplication.K.kb("HostSessionId");b.UserId=v.AFrameworkApplication.K.kb("UserId");b.DocumentClickTime=new Date(this._frame.qkb);
b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=v.AFrameworkApplication.K.kb("FileName");b.FileGetUrl="";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.qkb;h.Diagnostics=b;b={};b.WopiSrc=v.AFrameworkApplication.K.kb("WopiSrc");b.AccessToken=v.AFrameworkApplication.K.kb("AccessToken");
b.AccessTokenTtl=v.AFrameworkApplication.K.kb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=t=>{as.rW=t;this.wWa.setMaxPage(as.rW.GetPageCount());this.wWa.setCurrentPage(as.rW.GetCurrentPage());this.wWa.setPageControlVisible(!0);as.rW.RegisterEventHandler("PageChanged",A=>{this.wWa.setCurrentPage(A.newPage)});as.rW.RegisterEventHandler("BrowserEvent",A=>{27===A.keyCode?this.closeViewer():A.button&&1!==A.button||this.rBa.click()});t=this._frame.qkb-(new Date).getTime();u.ULS.sendTraceTag(38355488,
323,50,"previewPanel: Load finished - {0}",t);this.Ub();yd.FocusManager.instance().TK(vf.AFrame.v4a,!0);this.buildFocusRegion();this.AGa(yd.FocusManager.instance().fe(vf.AFrame.v4a));this.rBa.click()};h.FnOnInitializeFailure=(t,A)=>{u.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",t.toString(),A.toString());this.closeViewer()};return h}buildFocusRegion(){const b=yd.FocusManager.instance();var h=b.getRegion(vf.AFrame.v4a);h=[2,3];const t=b.fe(vf.AFrame.v4a),A=new $f.DOMFocusListing(()=>
this.rBa);A.Dxa=!0;for(const O of h)A.In(O);h=b.nla(()=>this.rBa,t,A);h.LRa();h.lU=!0;h.mZa=!0;A.wy(A.Dfa)}Ub(){v.AFrameworkApplication.xa.pa(ab.a.o9d,yc.a.frame,this.p9d);v.AFrameworkApplication.xa.pa(ab.a.n9d,yc.a.frame,this.p9d)}AGa(b){b.Xq(yd.FocusManager.instance().dW);b.Xq(yd.FocusManager.instance().eW);b.bindAction(yd.FocusManager.instance().dW,ab.a.o9d);b.bindAction(yd.FocusManager.instance().eW,ab.a.n9d)}loadViewer(b){b=this.zTl(b);this.Lwc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);
this.Lwc.Complete(b.WopiInfo)}closeViewer(){yd.FocusManager.instance().cR(vf.AFrame.v4a);as.rW&&(as.rW.Dispose(),as.rW=null,v.AFrameworkApplication.xa.$u(ab.a.o9d,yc.a.frame,this.p9d),v.AFrameworkApplication.xa.$u(ab.a.n9d,yc.a.frame,this.p9d));this.Lwc&&(this.rBa.parentNode.removeChild(this.rBa),this.rBa=this.Lwc=null)}printAction(){u.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");v.AFrameworkApplication.xa.processAction(qa.a.print,2)}downloadPdfAction(){u.ULS.sendTraceTag(38355490,
323,50,"previewPanel: Download to PDF Called");v.AFrameworkApplication.xa.processAction(Vc.a.WIc,2)}downloadCopyAction(){u.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");v.AFrameworkApplication.xa.processAction(ab.a.downloadACopy,2)}zoomInAction(){if(as.rW){let b=as.rW.GetZoomLevel();b+=.2;as.rW.SetZoomLevel(b)}}zoomOutAction(){if(as.rW){let b=as.rW.GetZoomLevel();b-=.2;as.rW.SetZoomLevel(b)}}setPage(b){if(as.rW){const h=as.rW.GetPageCount();1>b?(as.rW.SetCurrentPage(1),this.wWa.setCurrentPage(1)):
1<=b&&b<=h?as.rW.SetCurrentPage(b):(as.rW.SetCurrentPage(h),this.wWa.setCurrentPage(h))}}static getInstance(b){as.lMe||(as.lMe=new as(b));return as.lMe}}as.rW=null;as.lMe=null;Object(m.a)(as,"PreviewPanelActor",null,[]);class Lr{static get qDj(){return null!=Lr.TFg?Lr.TFg:Lr.TFg=v.AFrameworkApplication.K.kb("ClassicViewModePreferenceCookieName")}static Ub(b,h){b.gb(qa.a.readingMode,yc.a.frame,Lr.LEj,128);b.pa(qa.a.Nie,yc.a.frame,Lr.LEj);Lr.kN=h;b.pa(Vc.a.HVc,yc.a.frame,Lr.HVc);b.pa(Vc.a.JVc,yc.a.frame,
Lr.JVc);b.gb(Vc.a.s1c,yc.a.frame,Lr.s1c,96);b.gb(Vc.a.E1c,yc.a.frame,Lr.E1c,96)}static LEj(b,h,t){if(h.contextId!==yc.a.frame)return 2;h=vm.App.Hn;switch(b){case qa.a.readingMode:if(!h.zpb)return 8;if(1===t)return fc.SessionStatusManager.instance.xj?8:32;b=(new Date).getTime();qi.a.instance.nMn(b);h.qkb=b;v.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?Sv.a.jQ(3,!0,Lr.Lzn,null,h):Sv.a.jQ(3,!0,Lr.KJi,null,h);return 32;case qa.a.Nie:return 32;default:return 2}}static KJi(b){lG.a()?Lr.eam(b):
Lr.Kqj(b)}static eam(b){const h={};h[J.a.Nvf]=Lr.qDj;v.AFrameworkApplication.lO().execute(t=>{t.pv(K.a.Ovf);t.XJo(K.a.Ovf);t.uB(K.a.Ovf,A=>{Lr.aOk(A,b)});t.sendMessage(K.a.GRl,h)})}static aOk(b,h){b.Values[J.a.Nvf]===Lr.qDj&&("true"===b.Values[J.a.jki]?Lr.Kqj(h):(Lr.lNo(),Lr.myo()))}static lNo(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};v.AFrameworkApplication.ye("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",
!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static myo(){v.AFrameworkApplication.Yu=!0;Jb.App.ya.u9(1);Jb.App.ya.jb.ju&&Jb.App.ya.jb.ju.Yi&&Jb.App.ya.jb.ju.Axf();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Jb.App.ya.updateCommandUI();nN.PageView.Juj(v.AFrameworkApplication.K)}static Kqj(b){try{const h=new xb.a;let t,A;v.AFrameworkApplication.KDj?(t=Jb.App.hostUrl,A=
3):(t=b.zpb,A=1);b.qkb&&h.add(v.AFrameworkApplication.NKf,b.qkb.toString());v.AFrameworkApplication.Mzf&&h.add(v.AFrameworkApplication.Z7e,"1");v.AFrameworkApplication.I3e&&h.add(v.AFrameworkApplication.nYk,"1");h.add(BK.a.zkg,BK.a.userSessionData);h.add(v.AFrameworkApplication.s9d,v.AFrameworkApplication.userSessionId);const O=v.AFrameworkApplication.K.kb(v.AFrameworkApplication.Hia);O&&h.add(v.AFrameworkApplication.Uwj,O);u.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");lG.b(v.AFrameworkApplication.K)?
lG.d("view",h,lG.c):(t=ia.a.Ykh(t,h),v.AFrameworkApplication.KDj?ff.a.km(t,ff.a.zqa(A),void 0,"AuthenticationLostDuringSession"):ff.a.openWindow(A,t,!1,void 0,mN.a.m6i))}catch(h){}}static Lzn(b){u.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Sa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").HA.loadScript("previewPanel")).catch(()=>{u.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");
Lr.KJi(b)}).then(()=>{as.getInstance(b).$uo()})}static HVc(b,h,t){if(1===t)return 32;Lr.kN.tej(1);Jb.App.ya.updateCommandUI();return 32}static JVc(b,h,t){if(1===t)return 32;Lr.kN.tej(0);Jb.App.ya.updateCommandUI();return 32}static s1c(b,h,t,A,O){if(1===t)return 32;O[Ng.a.On]=1===Lr.kN.tv;return 32}static E1c(b,h,t,A,O){if(1===t)return 32;O[Ng.a.On]=!Lr.kN.tv;return 32}}Lr.kN=null;Object(m.a)(Lr,"MainViewModeActor",null,[]);class CK{constructor(b,h,t){this.$3m=(A,O,aa,ua,Ra)=>1===aa?32:(A=this.Ok.O7(O.Yj))?
(Ra=3===Ra.ux,this.C5.value.dIh(this.R1l(A),this.iEb(A),Ra),32):2;this.ga=b;this.C5=h;this.Ok=t}Ub(){this.ga.pa(Vc.a.iGf,mc.a.view,this.$3m);this.ga.gb(Vc.a.j$d,mc.a.view,im.d,96);this.ga.gb(Vc.a.g$d,mc.a.view,im.d,96);this.ga.gb(Vc.a.h$d,mc.a.view,im.d,96);this.ga.gb(Vc.a.i$d,mc.a.view,im.d,96);this.ga.pa(Vc.a.LZc,mc.a.view,im.c);this.ga.pa(Vc.a.KZc,mc.a.view,im.c);this.ga.pa(Vc.a.Y6d,mc.a.view,im.c);this.ga.pa(Vc.a.Z6d,mc.a.view,im.c)}R1l(b){const h=new ji.DictionaryPropertySet;h.setValue(Lc.a.marginTop,
this.Ok.Qma(b));h.setValue(Lc.a.marginBottom,this.Ok.kva(b));h.setValue(Lc.a.marginLeft,this.Ok.OI(b));h.setValue(Lc.a.marginRight,this.Ok.zK(b));return h}iEb(b){const h=new ji.DictionaryPropertySet;h.setValue(Lc.a.xo,this.Ok.Ot(b));h.setValue(Lc.a.Zv,this.Ok.$z(b));return h}}Object(m.a)(CK,"MarginsDialogActor",null,[]);class gH{constructor(b){this.V8c=(h,t,A)=>{if(1===A)return 32;h=v.AFrameworkApplication.ta;if(!h)return 32;h.lAd();gH.T3n(h);return 32};this.ga=b}Ub(){this.ga.pa(Vc.a.V8c,mc.a.view,
this.V8c)}static T3n(b){const h=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");var t=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");t=dc.a.Jfa(h,!t);dc.a.ASa(h,(!t).toString(),dc.a.AQa);t?u.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):u.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");lb.d(Vc.a.V8c,!0,void 0,void 0,void 0,void 0,[Object.assign(new sa.a,{name:"ModernUxExperimentPreference",
string:(!t).toString()})]);b.refreshDocument(null)}}Object(m.a)(gH,"ModernUxActor",null,[]);var oN=c(1059),vt=c(1686);class DK{constructor(b,h,t){this.uhe=Ad.a.wv(1)/6;this.Ieo=(A,O,aa,ua,Ra)=>{if(1===aa)return 32;if(aa=this.Vf.O7(O.Yj)){if(0<=Ra&&Ra<vt.a.b0.length){O=new Te.GraphTransaction(15);O.Eb(aa);O.kk=A;A=vt.a.b0[Ra].lub;ua=vt.a.b0[Ra].jub;const ub=vt.a.b0[Ra]._marginLeft;Ra=vt.a.b0[Ra].kub;this.C7d(A,ua,this.Vf.$z(aa))&&this.C7d(ub,Ra,this.Vf.Ot(aa))?(this.jE.M5a(aa,A),this.jE.K5a(aa,ua),
this.jE.dia(aa,ub),this.jE.L5a(aa,Ra),this.Wd.Bs(11)):this.aHa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);O.dispose()}else return 2;return 32}u.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",O.Yj);return 2};this.Jeo=(A,O,aa,ua,Ra)=>{if(1===aa)return 32;if(aa=this.Vf.O7(O.Yj)){if(0<=Ra&&Ra<vt.a.cpa.length)O=new Te.GraphTransaction(15),O.Eb(aa),O.kk=A,A=(ua=this.Vf.fTc(aa))?vt.a.cpa[Ra].esa:vt.a.cpa[Ra].jLa,Ra=ua?vt.a.cpa[Ra].jLa:vt.a.cpa[Ra].esa,this.C7d(this.Vf.kva(aa),
this.Vf.Qma(aa),Ra)&&this.C7d(this.Vf.OI(aa),this.Vf.zK(aa),A)?(this.jE.f9f(aa,A),this.jE.e9f(aa,Ra),this.Wd.Bs(11)):this.aHa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),O.dispose();else return 2;return 32}u.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",O.Yj);return 2};this.ceo=(A,O,aa,ua,Ra)=>{if(1===aa)return 32;if(aa=this.Vf.O7(O.Yj)){O=this.Vf.fTc(aa);ua=new Te.GraphTransaction(15);ua.Eb(aa);ua.kk=A;this.jE.Afj(aa,Ra);if(Ra&&!O||!Ra&&O){A=this.Vf.Ot(aa);
Ra=this.Vf.$z(aa);this.jE.f9f(aa,Ra);this.jE.e9f(aa,A);A=this.Vf.Qma(aa);Ra=this.Vf.kva(aa);const ub=this.Vf.OI(aa),Nb=this.Vf.zK(aa);O?(this.jE.M5a(aa,v.AFrameworkApplication.isRtl?ub:Nb),this.jE.K5a(aa,v.AFrameworkApplication.isRtl?Nb:ub),this.jE.dia(aa,v.AFrameworkApplication.isRtl?Ra:A),this.jE.L5a(aa,v.AFrameworkApplication.isRtl?A:Ra)):(this.jE.M5a(aa,v.AFrameworkApplication.isRtl?Nb:ub),this.jE.K5a(aa,v.AFrameworkApplication.isRtl?ub:Nb),this.jE.dia(aa,v.AFrameworkApplication.isRtl?Math.abs(A):
Ra),this.jE.L5a(aa,v.AFrameworkApplication.isRtl?Ra:A));this.Wd.Bs(11)}ua.dispose();return 32}u.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",O.Yj);return 2};this.hWd=(A,O,aa)=>{if(1===aa)return 1===this.oS.tv?32:8};this.gnb=(A,O,aa,ua,Ra)=>{if(1===aa)return 32;aa=this.Vf.O7(O.Yj);if(!aa)return u.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",O.Yj),2;O=new Te.GraphTransaction(15);O.Eb(aa);O.kk=A;A=Math.floor(this.Vf.Ot(aa)/
720);if(0>Ra||Ra>A)return 2;this.jE.VMb(aa,Ra);O.dispose();return 32};this.kee=(A,O,aa,ua,Ra)=>{if(1===aa)return 32;aa=this.Vf.O7(O.Yj);if(!aa)return u.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",O.Yj),2;O=new Te.GraphTransaction(15);O.Eb(aa);O.kk=A;A=Ra[0];ua=this.Vf.Ot(aa);if(720>A||A>ua)return 2;this.jE.Ehc(aa,Ra);O.dispose();return 32};this.jee=(A,O,aa,ua,Ra)=>{if(1===aa)return 32;aa=this.Vf.O7(O.Yj);if(!aa)return u.ULS.sendTraceTag(520618520,3009,50,
"wordSectionNode is null; context.nextContext = {0}",O.Yj),2;O=new Te.GraphTransaction(15);O.Eb(aa);O.kk=A;A=this.Vf.Ot(aa);ua=this.Vf.Xg(aa);if(0>Ra||Ra>(A-720*ua)/(ua-1))return 2;this.jE.A$n(aa,Ra);O.dispose();return 32};this.iee=(A,O,aa,ua,Ra)=>{if(1===aa)return 32;aa=this.Vf.O7(O.Yj);if(!aa)return u.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",O.Yj),2;O=new Te.GraphTransaction(15);O.Eb(aa);O.kk=A;if(null==Ra)return 2;this.jE.Wfo(aa,Ra);O.dispose();return 32};
this.tGa=(A,O,aa,ua,Ra)=>{if(A=this.Vf.O7(O.Yj))return Ra.marginTop=this.Vf.Qma(A),Ra.marginBottom=this.Vf.kva(A),Ra.marginLeft=this.Vf.OI(A),Ra.marginRight=this.Vf.zK(A),Ra.xo=this.Vf.Ot(A),Ra.Zv=this.Vf.$z(A),Ra.bwa=this.Vf.fTc(A),Ra.rE=this.Vf.Xg(A),Ra.zla=this.Vf.wgb(A),Ra.pUk=this.Vf.uQd(A),Ra.uIb=this.NVl(Ra),Ra.XJb=this.UZl(Ra),Ra.IFc=this.PIl(Ra),32;u.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",O.Yj);return 2};this.bfe=(A,O,aa,ua,Ra)=>{if(1===aa)return 32;
if(aa=this.Vf.O7(O.Yj)){O=new Te.GraphTransaction(15);O.Eb(aa);switch(A){case qa.a.M5a:this.jE.M5a(aa,Ra);break;case qa.a.K5a:this.jE.K5a(aa,Ra);break;case qa.a.dia:this.jE.dia(aa,Ra);break;case qa.a.L5a:this.jE.L5a(aa,Ra)}this.Wd.Bs(11);O.dispose();return 32}u.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",O.Yj);return 2};this.ggj=(A,O,aa,ua,Ra)=>{if(1===aa)return 32;if(aa=this.Vf.O7(O.Yj)){O=new Te.GraphTransaction(15);O.Eb(aa);let ub=ua=0;switch(A){case qa.a.h9f:ub=
Ra;this.jE.f9f(aa,ub);ua=this.Vf.$z(aa);break;case qa.a.g9f:ua=Ra,this.jE.e9f(aa,ua),ub=this.Vf.Ot(aa)}this.jE.Afj(aa,ua<ub);this.Wd.Bs(11);O.dispose();return 32}u.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",O.Yj);return 2};this.jE=b;this.Wd=h;this.oS=t}get Vf(){return Aq.a.instance}OVl(b){var h=Jb.App.ZBf,t=h?1:3,A=v.AFrameworkApplication.numberFormat;let O=vt.a.b0[b].lub;var aa=vt.a.b0[b].jub;var ua=vt.a.b0[b]._marginLeft;b=vt.a.b0[b].kub;O=h?Ad.a.uTa(O):
Ad.a.nz(O);aa=h?Ad.a.uTa(aa):Ad.a.nz(aa);ua=h?Ad.a.uTa(ua):Ad.a.nz(ua);b=h?Ad.a.uTa(b):Ad.a.nz(b);h=F.a.ADa(O,t,A);aa=F.a.ADa(aa,t,A);ua=F.a.ADa(ua,t,A);t=F.a.ADa(b,t,A);A={};A.top=h;A.bottom=aa;A.left=ua;A.right=t;return A}Y3m(b){const h=WordRibbonStrings.PageMarginsTop,t=WordRibbonStrings.PageMarginsBottom,A=WordRibbonStrings.PageMarginsLeft,O=WordRibbonStrings.PageMarginsRight;b=this.OVl(b);return[[h,b.top,t,b.bottom],[A,b.left,O,b.right]]}k_c(b){var h=Jb.App.ZBf,t=h?1:3;const A=v.AFrameworkApplication.numberFormat;
let O=vt.a.cpa[b].esa;b=vt.a.cpa[b].jLa;O=h?Ad.a.uTa(O):Ad.a.nz(O);b=h?Ad.a.uTa(b):Ad.a.nz(b);h=F.a.ADa(b,t,A);t=F.a.ADa(O,t,A);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,t)}Ub(){const b=v.AFrameworkApplication.xa;b.gb(qa.a.N5a,mc.a.view,this.Ieo,4);b.gb(qa.a.vSa,mc.a.view,this.Jeo,4);b.gb(qa.a.setOrientation,mc.a.view,this.ceo,4);b.gb(qa.a.tGa,mc.a.view,this.tGa,96);b.pa(qa.a.M5a,mc.a.view,this.bfe);b.pa(qa.a.K5a,mc.a.view,this.bfe);b.pa(qa.a.dia,mc.a.view,this.bfe);b.pa(qa.a.L5a,
mc.a.view,this.bfe);b.pa(qa.a.h9f,mc.a.view,this.ggj);b.pa(qa.a.g9f,mc.a.view,this.ggj);b.gb(qa.a.hWd,mc.a.view,this.hWd,4);b.pa(qa.a.gnb,mc.a.view,this.gnb);b.pa(qa.a.kee,mc.a.view,this.kee);b.pa(qa.a.jee,mc.a.view,this.jee);b.pa(qa.a.iee,mc.a.view,this.iee)}C7d(b,h,t){return t>=b+h+Jb.App.Sya}NVl(b){let h=5;for(let t=0;t<vt.a.b0.length;t++)if(vt.a.b0[t].lub===b.marginTop&&vt.a.b0[t].jub===b.marginBottom&&vt.a.b0[t]._marginLeft===b.marginLeft&&vt.a.b0[t].kub===b.marginRight){h=t;break}return h}UZl(b){let h=
5;b=new oN.a(Math.min(b.xo,b.Zv),Math.max(b.xo,b.Zv));for(let t=0;t<vt.a.cpa.length;t++)if(this.jsn(b,vt.a.cpa[t])){h=t;break}return h}PIl(b){let h=0;switch(b.rE){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}jsn(b,h){return Nf.a.qqi(b.jLa,Math.max(h.jLa-this.uhe,0),h.jLa+this.uhe)&&Nf.a.qqi(b.esa,Math.max(h.esa-this.uhe,0),h.esa+this.uhe)}aHa(b){if(!Ri.a.VL){const h=new cf.StandardDialog;h.zd=0;h.PU(CommonUIStrings.l_DefaultDialogTitle,b,null)}}}Object(m.a)(DK,"PageActor",null,[414]);class EK{constructor(b){this.ga=
b}get rc(){return this.ga}afe(b,h){let t=0;b?1===b?t=qa.a.dia:2===b?t=qa.a.L5a:3===b&&(t=qa.a.K5a):t=qa.a.M5a;this.rc.Rb(t,2,h)}vSa(b,h){let t=0;1===b?t=qa.a.g9f:b||(t=qa.a.h9f);this.rc.Rb(t,2,h)}hee(b,h){let t=0;switch(b){case 0:t=qa.a.gnb;break;case 1:t=qa.a.kee;break;case 2:t=qa.a.jee;break;case 3:t=qa.a.iee}this.rc.Rb(t,2,h)}}Object(m.a)(EK,"PageCommands",null,[413]);class FK{constructor(b,h,t){this.isn=(A,O,aa,ua,Ra)=>1===aa?32:(A=this.Ok.O7(O.Yj))?(Ra=3===Ra.ux,this.C5.value.IIh(this.S1l(A),
this.iEb(A),Ra),32):2;this.ga=b;this.C5=h;this.Ok=t}Ub(){this.ga.pa(Vc.a.kGf,mc.a.view,this.isn);this.ga.gb(Vc.a.y$d,mc.a.view,im.d,96);this.ga.gb(Vc.a.x$d,mc.a.view,im.d,96);this.ga.pa(Vc.a.b7d,mc.a.view,im.c);this.ga.pa(Vc.a.a7d,mc.a.view,im.c)}S1l(b){const h=new ji.DictionaryPropertySet;h.setValue(Lc.a.xo,this.Ok.Ot(b));h.setValue(Lc.a.Zv,this.Ok.$z(b));return h}iEb(b){const h=new ji.DictionaryPropertySet;h.setValue(Lc.a.marginTop,Math.abs(this.Ok.Qma(b)));h.setValue(Lc.a.marginBottom,Math.abs(this.Ok.kva(b)));
h.setValue(Lc.a.marginLeft,this.Ok.OI(b));h.setValue(Lc.a.marginRight,this.Ok.zK(b));return h}}Object(m.a)(FK,"PaperSizeDialogActor",null,[]);class rE{constructor(b,h,t,A){this.ga=b;this.C5=h;this.JV=t;this.GA=A}Ub(){this.ga.gb(qa.a.qbc,mc.a.view,this.Xsn.bind(this),1028);this.ga.pa(qa.a.qbc,mc.a.paragraph,this.Vsn.bind(this));this.ga.gb(qa.a.yFn,mc.a.view,im.d,96);this.ga.gb(qa.a.zFn,mc.a.view,im.d,96);this.ga.gb(qa.a.GEn,mc.a.view,im.d,96);this.ga.gb(qa.a.HEn,mc.a.view,im.d,96);this.ga.gb(qa.a.oto,
mc.a.view,im.c,96);this.ga.gb(qa.a.nto,mc.a.view,im.c,96);this.ga.gb(qa.a.oqn,mc.a.view,im.c,96);this.ga.gb(qa.a.pqn,mc.a.view,im.c,96);this.ga.gb(qa.a.bqn,mc.a.view,im.c,96);this.ga.gb(qa.a.mto,mc.a.view,im.c,96);this.ga.gb(qa.a.cqn,mc.a.view,im.c,96)}Vsn(b,h,t,A,O){if(1===t)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.Tvj(h);O=3===O.ux;this.C5.value.DFd(this.dOc(b),this.iEb(h),O,this.GA);return 32}Xsn(b,h,t,A,O){b=h.view.nb;if(!b||rE.Zf.W9b(b.pg))return 8;if(rE.Vg.Oya(qe.ParagraphReader.ZT,
b.pg))return rE.Jc.Zb(gg.a.kf,{["Reason"]:uf.a.IN}),8;if(1===t)return 3===this.ga.mode||2===this.ga.mode?32:8;t=b.hb.lb;h=this.Tvj(h);O=3===O.ux;if(1===t.length&&nf.SelectionEditor.jf(t.J(0)))return t=t.J(0).node,this.C5.value.DFd(this.dOc(t),this.iEb(h),O,this.GA),32;b=[];for(A=0;A<t.length;A++){const aa=t.J(A);(!A&&nf.SelectionEditor.Dk(aa)||qe.ParagraphReader.im(aa)||nf.SelectionEditor.gl(aa))&&b.push(aa.node)}if(!b.length)return 8;t=Array(b.length);for(A=0;A<b.length;A++)t[A]=this.dOc(b[A]);t=
kv.APropertySet.a7h(t);this.C5.value.DFd(t,this.iEb(h),O,this.GA);return 32}dOc(b){var h,t,A;const O=new ji.DictionaryPropertySet;O.setValue(Gd.a.Xv,qe.ParagraphReader.Uv(b));const aa=this.JV.VDa(b);var ua=aa.lineSpacing;O.setValue(Gd.a.a3a,ua.unit);O.setValue(Gd.a.ua,ua.value);ua=aa.beforeSpacing;O.setValue(Gd.a.uec,ua.unit);O.setValue(Gd.a.vec,ua.value);ua=aa.afterSpacing;O.setValue(Gd.a.sec,ua.unit);O.setValue(Gd.a.tec,ua.value);O.setValue(Gd.a.v_c,aa.Sv);(null===(h=this.GA)||void 0===h?0:h.oFa)&&
O.setValue(zf.a.keepWithNext,qe.ParagraphReader.keepWithNext(b));(null===(t=this.GA)||void 0===t?0:t.BIa)&&O.setValue(zf.a.widowControl,qe.ParagraphReader.bmc(b));(null===(A=this.GA)||void 0===A?0:A.Fga)&&O.setValue(zf.a.keepTogether,qe.ParagraphReader.keepTogether(b));return O}static get Zf(){return rl.a.instance}static get Vg(){return Ik.ContextSetEditor.instance}static get Jc(){return zk.a.instance}}Object(m.a)(rE,"AParagraphDialogActor",null,[]);class GK extends rE{constructor(b,h,t,A,O,aa){super(b,
h,t,aa);this.Ok=A;this.Po=O}Ub(){super.Ub();this.ga.gb(qa.a.WZi,mc.a.view,im.d,96);this.ga.gb(qa.a.XZi,mc.a.view,im.d,96);this.ga.gb(qa.a.MEn,mc.a.view,im.d,96);this.ga.gb(qa.a.rom,mc.a.view,im.c,96);this.ga.gb(qa.a.tom,mc.a.view,im.c,96);this.ga.gb(qa.a.kto,mc.a.view,im.c,96);this.ga.gb(qa.a.lto,mc.a.view,im.c,96);this.ga.gb(qa.a.jqn,mc.a.view,im.c,96);this.ga.gb(qa.a.rqn,mc.a.view,im.c,96);this.ga.gb(qa.a.qqn,mc.a.view,im.c,96);this.ga.gb(qa.a.pto,mc.a.view,im.c,96);this.ga.gb(qa.a.AFn,mc.a.view,
im.d,96);this.ga.gb(qa.a.BFn,mc.a.view,im.d,96)}Tvj(b){return this.Ok.O7(b.Yj)}dOc(b){const h=super.dOc(b);var t=this.Po.zT(b);const A=this.Po.aG(b);h.setValue(Gd.a.hGa,1);h.setValue(Gd.a.iGa,t.wt-A.wt);t=this.Po.H0a(b);h.setValue(Gd.a.Glb,t.unit);h.setValue(Gd.a.Hlb,t.value);b=this.Po.y7b(b);b.specialIndentType&&(h.setValue(Gd.a.F4,b.specialIndentType),h.setValue(Gd.a.KSa,b.unit),h.setValue(Gd.a.LSa,b.value));return h}iEb(b){const h=new ji.DictionaryPropertySet;h.setValue(Lc.a.xo,this.Ok.Ot(b));
h.setValue(Lc.a.Zv,this.Ok.$z(b));h.setValue(Lc.a.marginTop,Math.abs(this.Ok.Qma(b)));h.setValue(Lc.a.marginBottom,Math.abs(this.Ok.kva(b)));h.setValue(Lc.a.marginLeft,this.Ok.OI(b));h.setValue(Lc.a.marginRight,this.Ok.zK(b));return h}}Object(m.a)(GK,"ParagraphDialogActor",rE,[]);class HK extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.EXd=h}}Object(m.a)(HK,"AfterPasteEventArgs",Sys.EventArgs,[]);class IK{constructor(b){this.UCe=this.ZCe=null;this.ahd=b}get kLd(){return null!=this.ewg?
this.ewg:this.ewg=Sa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get JAm(){this.ZCe||(this.ZCe=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate(dn.a.TMh,!1));return this.ZCe}get tWd(){this.UCe||(this.UCe=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(dn.a.ZMh));return this.UCe}XBn(b){if(b&&mb.OutlineElementReader.Lh(b.Pua)&&mb.OutlineElementReader.Lh(b.Jjb)){this.rCn(b);var h=new Xm.a;for(h.$c(b.Pua);h&&h.currentNode;){const t=this.GPd(h),
A=qe.ParagraphReader.Yb(t);A&&qe.ParagraphReader.deb(t)&&this.VBn(t);const O=h.currentNode.id===b.Jjb.currentNode.id;A&&(this.JAm||this.tWd)&&t.Wi.Pfa(t.type).cae(new HK(t,O));if(O)break;wg.OutlineElementNavigator.Ir(h,!1,!1)}}}VBn(b){u.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.Hec;b=pf.a.Tc(b,0);du.HSc(h)?this.kLd.d8d(b,h):this.ahd.d8d(b,h)}rCn(b){if(b.Pua.currentNode&&
b.Jjb.currentNode&&b.Pua.currentNode.id===b.Jjb.currentNode.id){const h=this.GPd(b.Pua);qe.ParagraphReader.Yb(h)?this.$Bn(h,b.Pun,b.Oun):u.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}$Bn(b,h,t){u.ULS.shipAssertTag(590956771,307,0<=h);u.ULS.shipAssertTag(590958592,307,0<=t);var A=qe.ParagraphReader.text(b);if(""!==A){var O=pf.a.createTextRange(b,h,t);O=Ge.HyperlinkReader.rD(O,!1);if(1===O.length){const aa=O[0];O=A.substring(h,t).trim();A=A.substring(aa.cpBegin,
aa.cpEnd).trim();h=O===A;O=pf.a.createTextRange(b,aa.cpBegin,aa.cpEnd);if(aa.hyperlink&&h&&!Ge.HyperlinkReader.I2a(A))b=aa.hyperlink.url;else if(h)b=A;else{u.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");return}du.HSc(b)?this.kLd.ePa(O,b,!1):this.ahd.ePa(O,b,!1)}else u.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",
O.length)}}GPd(b){const h=wg.OutlineElementNavigator.Fe(b);wg.OutlineElementNavigator.Zd(b);return h}}Object(m.a)(IK,"PastedContentsProcessorPostMergeAfterPaste",null,[411]);class hH extends Xw{constructor(b,h,t,A,O,aa,ua,Ra){super(A);this.TOe=7;this.ZB=this.urc=null;this.DBe=0;this.ABe=b;this.Fk=h;this.kn=t;this.ge=O;this.eOj=ua;this.MWa=Ra;this.f2=this.ge.vQa("UserAction","WordIgnoreAll")}k$f(b){this.ABe.mEi();this.urc=this.kn.Hma(b);this.MWa.Qki(this.urc,null,!1);return this.ABe.wwj(this.urc)?
(this.f2.start(),this.ZB=new Te.GraphTransaction(15),this.ZB.Eb(b.node),!0):!1}w9d(b){this.NKb(b.node);return!0}B0c(b){this.NKb(b);return!0}x9d(b){this.NKb(b.node)}bfg(b){this.ZB.dispose();this.urc.errorDetails.Uob(b.actionId);this.f2.stop();u.ULS.sendTraceTag(19779652,324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.DBe,this.f2.ri,this.urc.errorDetails.proofingType));return!0}$ic(b,h){if(super.$ic(b,h))return!0;b=b.role;return 9===
b||10===b||13===b||7===b||8===b}yai(b){if(b&&b.type!==this.TOe){const h=ue.GraphIterator.$a(b);return h.Ab(this.TOe)?h.fd(this.TOe):b}return b}PDm(b,h){return this.ABe.cge(h.errorDetails)&&!this.Fk.i8(pf.a.createTextRange(b,h.begin,h.end))}NKb(b){if(b){var h=this.kn.j3(b,t=>this.PDm(b,t));this.eOj?this.kn.ymb(b,h,!0):0<h.length&&(b.Wk(4,!0),this.kn.ZIb(b));this.DBe+=h.length}}}Object(m.a)(hH,"IgnoreAllCallbackSteps",Xw,[]);class JK{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc){this.n1c=(Pc,jd,Cd,
ee,Od)=>{if(1===Cd)return 32;Pc=this.fI.zOa(jd.view.nb.pg);if(Pc=Sf.a.lg(Pc))Od[Ck.a.LabelText]=Pc.displayName;return 32};this.lna=(Pc,jd,Cd,ee,Od,fe)=>{const Ee=new hH(this.A_j,this.Fk,this.kn,this.Ie,this.ge,this.WV,0,this.MWa);return new Ts(Pc,jd,Cd,ee,Od,fe,Ee,this.ga,this.ib,this.Ie,"IgnoreAllOperation")};this.hBb=(Pc,jd,Cd,ee,Od,fe)=>{const Ee=new hH(this.wVj,this.Fk,this.kn,this.Ie,this.ge,this.WV,1,this.MWa);return new Ts(Pc,jd,Cd,ee,Od,fe,Ee,this.ga,this.ib,this.Ie,"DoNotCheckThisCritiqueType")};
this.ga=b;this.Fk=h;this.ib=t;this.Ie=A;this.kn=O;this.fI=aa;this.ge=ua;this.A_j=Ra;this.wVj=ub;this.TUb=Nb.STc;this.WV=Nb;this.MWa=Yb;this.BDe=bc;this.u8a=Dc}Ub(){this.BDe&&(Ms.jB()?this.ga.gb(qa.a.lna,mc.a.Vc,this.Hmm.bind(this),1028):this.ga.FS(qa.a.lna,mc.a.view,this.lna,1028));this.TUb&&this.ga.FS(qa.a.hBb,mc.a.view,this.hBb,1028);this.ga.gb(Vc.a.n1c,mc.a.view,this.n1c,96)}Hmm(b,h,t,A,O){if(1===t)return 32;u.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.u8a.Ztf(O?
O:h,null,Uo.b.IgnoreAll);return 32}}Object(m.a)(JK,"ProofingActor",null,[]);var OC=c(1187),pN=c(1688);class PC{constructor(b,h,t,A,O,aa,ua,Ra,ub){this.gq=this.ILa=this.Vtd=this.Wtd=null;this.UD=this.vs=this.kq=0;this.d$a=this.c$a=!1;this.J$=this.j9a=this.i9a=this.g9a=this.k9a=0;this.Ysd=null;this.dda=this.XV=this.Fq=this.qP=0;this.Nl=null;this.atb=0;this.OSf=Nb=>{var Yb;if(5===this.atb){const bc=Object.assign(new Hb.a,{extendedProperties:new Map});bc.extendedProperties.set("status",Nb.data.status.toString());
bc.extendedProperties.set("httpStatus",Nb.data.Ve.toString());(null===(Yb=v.AFrameworkApplication.K)||void 0===Yb?0:Yb.$("ShouldLogPicturesExtendedHealthKpis"))?(Yb={name:zm.c.dUd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:bc},bc.extendedProperties.set("ErrorLevel","warning"),this.Mh.logKpiFailure({kpiName:zm.c.I8b,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:bc},optionalVeto:Yb})):
wa.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,bc)}u.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:Nb.data.status,["HttpStatus"]:Nb.data.Ve,["Id"]:Nb.data.id,["ResponseData"]:Nb.data.we},qE.a[this.atb]);this.Bce()};this.Nj=t;this._image=b;this._context=h;this.zld=!1;(b=PC.eh.Ms(h.node))&&b.Lf(Lc.a.RDf)&&(this.zld=!0);this.stc=A.$("ImageDataURLPresentationIsEnabled");this.x9j=A.$("WordOartPostRequestIsEnabled");
this.Na=A;this.Zq=O;this.ge=aa;this.Wd=ua;this.Dm=Ra;this.IJ=ub;this.Mh=Tg.a.getInstance(zm.a);this.irm();this.e6d=this.Odc.bind(this)}irm(){this.gq="";this.kq=Be.ImageReader.JE(this._image);this.vs=Be.ImageReader.bG(this._image);this.J$=Be.ImageReader.Zgb(this._image);this.UD=Be.ImageReader.ZZ(this._image);this.c$a=Be.ImageReader.kOd(this._image);this.d$a=Be.ImageReader.kDb(this._image);this.k9a=Math.max(Be.ImageReader.Oma(this._image),0);this.g9a=Math.max(Be.ImageReader.Lma(this._image),0);this.i9a=
Math.max(Be.ImageReader.Mma(this._image),0);this.j9a=Math.max(Be.ImageReader.Nma(this._image),0);this.Nl=Ya.a.nil;this.ILa=null;this.atb=Be.ImageReader.sk(this._image)}RAd(b,h){return(new pN.a(this.Zq,this.atb,this.Na,this.kq,this.vs,this.UD,this.J$,this.k9a,this.g9a,this.i9a,this.j9a,this.c$a,this.d$a,this.zld)).build(this._context.node,this._image,b,h)}resize(b,h){this.gq="Resize";this.Whe();Ok.a.mark(this.d7b());this.kq=b;this.vs=h;this.sendMessage(!1,this.e6d)}ew(b){this.gq="Styles";this.Whe();
Ok.a.mark(this.d7b());this.J$=b;this.sendMessage(!1,this.e6d)}zeo(b,h,t){this.gq="Rotation";this.Whe();this.UD=b;this.c$a=h;this.d$a=t;this.sendMessage(!1,this.e6d)}yeo(b,h){this.gq="SwordRequestManager";this.Whe();this.ILa=b;this.UD=h.angle;this.kq=h.width;this.vs=h.height;this.J$=h.styleId;this.k9a=h.top;this.g9a=h.bottom;this.i9a=h.left;this.j9a=h.right;this.Nl=h.gT;this.sendMessage(!1,this.e6d)}sendMessage(b,h){if(this.Na.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var t=this.qeb(t);
const A=Be.ImageReader.Wma(this._image,this.Na,this.Zq);A?OC.a.unb(this._image,A,4):this._image.setValue(Jh.a.ZNa,!0);t.dispose()}this.Soj(b);Ok.a.mark(this.d7b());b=new jb.QueryStringBuilder(this.RAd(b,!0));this.stc&&b.De(Bh.a.VKh,"true");this.x9j?(t=new jb.QueryStringBuilder("WordOart.ashx"),v.AFrameworkApplication.Ke.oj(t.toString(),2,b.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.OSf,null)):v.AFrameworkApplication.Ke.oj(b.toString(),1,"",null,!0,0,
h,this.OSf,null)}qeb(b){b=this.Nl&&this.Nl!==Ya.a.nil?new Te.GraphTransaction(7,qa.a.imageRotate):new Te.GraphTransaction(15);b.Eb(this._context.node);return b}get dIj(){const b=new Te.GraphTransaction(3);b.Eb(this._context.node);return b}Bce(){this.BJc();this.KId();const b=this.dIj;var h=Be.ImageReader.Wua(this._image,this._context.node.Mc,this.Na,this.Zq);this._image.setValue(Jh.a.ZNa,!1);this._image.setValue(Gd.a.AQc,h);this._image.setValue(Gd.a.WI,-1);this._image.setValue(Jh.a.k4,1);h=Be.ImageReader.Wma(this._image,
this.Na,this.Zq);this.Na.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(Gd.a.A8d),this._image.removeProperty(Gd.a.y8d),h&&OC.a.unb(this._image,h,3));b.dispose();PC.Lp();this.ILa&&this.ILa()}Soj(b){this.ge&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.Wtd=this.ge.eg("WebServiceCall",b))}BJc(){this.Wtd&&(this.Wtd.stop(),this.Wtd=null)}Whe(){if(this.ge){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.gq,qE.a[this.atb]);
this.Vtd=this.ge.eg("WebServiceCall",b)}}KId(){this.Vtd&&(this.Vtd.stop(),this.Vtd=null)}static get eh(){return fm.PageNavigator.instance}static Lp(){const b=new cf.StandardDialog;b.zd=0;b.Sw(nm.a.ewn,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Jb.App.ya&&Jb.App.ya.updateCommandUI()}}Object(m.a)(PC,"RenderedImageEditOperation",null,[431]);var iH=c(317),iF=c(536);class KK extends PC{constructor(b,h,t,A,O,aa,ua,Ra,ub){super(b,h,t,A,O,aa,ua,Ra,ub)}sendMessage(b,
h){Object(iH.a)(()=>{let t;t=this.qeb(t);this._image.setValue(Jh.a.k4,0);t.dispose()});this.Soj(b);Ok.a.mark(this.d7b());b=new jb.QueryStringBuilder("WordOart.ashx");this.QVg=this.ehb(!0,!1);b=new iF.a(b.toString(),2,this.ehb(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,"text");v.AFrameworkApplication.Ke.send(b).zxa(h,t=>{this.OSf(t)})}Odc(b){try{const h=JSON.parse(b.data.dSa);this.xZj=
h[Bh.a.aPc];this.Rhk=h[Bh.a.width];this.OZj=h[Bh.a.height];this.SHg=h[Bh.a.XCc];this.drc=Array(4);this.drc[0]=h[Bh.a.cfb];this.drc[1]=h[Bh.a.dfb];this.drc[2]=h[Bh.a.efb];this.drc[3]=h[Bh.a.bfb];this.c_g=void 0!==h[Bh.a.rwa]?"true"===h[Bh.a.rwa].toLowerCase():null;Object(iH.a)(()=>{this.s$c();this._context.node.Ei().contentReplicator.forceOutbound(()=>{this.vwl()},null,null)})}catch(h){u.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",
h.message,this.gq,Be.ImageReader.sk(this._image)),this.Bce()}}r5d(){u.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}s$c(){let b;b=this.qeb(b);this._image.setValue(zf.a.d_,this.xZj);this.SHg&&this._image.setValue(zf.a.Yyd,this.SHg);this._image.setValue(zf.a.tva,this.Rhk);this._image.setValue(zf.a.uva,this.OZj);this._image.setValue(zf.a.KOa,this.drc);this.H_j&&this._image.setValue(Gd.a.gFb,this.H_j);OC.a.unb(this._image,this.QVg,3);this._image.setValue(Lc.a.$eb,this.QVg);
this.c_g?this._image.setValue(zf.a.Y1a,this.c_g):this._image.removeProperty(zf.a.Y1a);this.tQk();b.dispose()}tQk(){this._image.removeProperty(Gd.a.Pt);this._image.removeProperty(Gd.a.WI);this._image.removeProperty(Gd.a.A8d);this._image.removeProperty(Gd.a.y8d)}vwl(){this.IJ.$Ga(this._context);if(this.Nl&&this.Nl!==Ya.a.nil){const b=this._context.node.Ei(),h=new W.a(this.Nl,1);this.Dm.Y1b(b,h)}this.Wd.Bs(13);this.BJc();this.KId();Ok.a.mark(this.c7b());Object(iH.a)(()=>{let b;b=this.qeb(b);this._image.setValue(Jh.a.k4,
1);b.dispose()});this.ILa&&this.ILa()}ehb(b,h){b=new jb.QueryStringBuilder(this.RAd(b,h));b.De(Bh.a.jUd,"true");return b.toString()}d7b(){return 51511}c7b(){return 51512}}Object(m.a)(KK,"RenderedGraphicEditOperation",PC,[]);class LK extends PC{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb){super(b,h,t,A,O,aa,ua,Ra,ub);this.TQg=null;this.r5d=Yb=>{const bc=this.RAd(!0,!1);let Dc;Dc=this.qeb(Dc);this._image.setValue(Lc.a.Zyd,this.Ysd);var Pc=Sa.a.instance.Ma("Box4.IFeatureHelper");Pc&&Pc.isFeatureEnabled(47)&&
this._image.setValue(Lc.a.SJd,this.TQg);this.Na.$("WordEditorImageRotateIsEnabled")&&this.Na.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Nj.Lee(this._image,this.UD,this.c$a,this.d$a);const jd=Be.ImageReader.Wma(this._image,this.Na,this.Zq),Cd=()=>{jd&&OC.a.unb(this._image,jd,3);OC.a.unb(this._image,bc,3);this.Nj.Jee(this._image,Ad.a.WF(this.qP),Ad.a.WF(this.XV),Ad.a.WF(this.Fq),Ad.a.WF(this.dda));this._image.setValue(Lc.a.$eb,bc);Be.ImageReader.Zx(this._image)||this._image.setValue(Lc.a.uEa,
1);this.Nj.qee(this._image,this.kq,this.vs);this.Na.$("WordEditorImageRotateIsEnabled")&&!this.Na.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Nj.Lee(this._image,this.UD,this.c$a,this.d$a);2===Yb.data.status&&Be.ImageReader.s_(Yb.data.we)&&(this._image.setValue(Gd.a.Pt,Yb.data.we),Yb.data.request&&this._image.setValue(Gd.a.gFb,OC.a.nKc("POST"===Yb.data.request.get_httpVerb()?Yb.data.request.get_body():Yb.data.request.get_url())));this.ILa&&this.ILa();this.IJ.$Ga(this._context);if(this.Nl&&
this.Nl!==Ya.a.nil){const ee=this._context.node.Ei(),Od=new W.a(this.Nl,1);this.Dm.Y1b(ee,Od)}this.Wd.Bs(13);this.BJc();this.KId();Ok.a.mark(this.c7b())};if(this.Na.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Nl&&this.Nl!==Ya.a.nil&&(Pc=this._context.node.Ei())&&Pc.contentReplicator){Dc.dispose();Pc.contentReplicator.forceOutbound(()=>{let ee;ee=this.qeb(ee);Cd();ee.dispose()},null,null);return}Cd();Dc.dispose()};this.uNe=Nb}d7b(){return 51511}c7b(){return 51512}Odc(b){try{var h=JSON.parse(b.data.we);
const O=Sys.Net.XMLDOM("string"===typeof h[Bh.a.poh]?h[Bh.a.poh]:null);this.Ysd="string"===typeof h[Bh.a.$yd]?h[Bh.a.$yd]:null;const aa=Sa.a.instance.Ma("Box4.IFeatureHelper");aa&&aa.isFeatureEnabled(47)&&(this.TQg="string"===typeof h[Bh.a.W4b]?h[Bh.a.W4b]:null);ba.a.jt&&O.setProperty("SelectionNamespaces","xmlns:mc='"+Ji.a.Vuk+"'");const ua=O.selectSingleNode("/mc:AlternateContent");if(!ua)throw Zq.a.argument("Alternate content element could not be retrieved!");const Ra=ua.firstChild;if(!Ra)throw Zq.a.argument("Alternate content choice element could not be retrieved!");
const ub=Ra.firstChild;if(!ub)throw Zq.a.argument("Drawing element could not be retrieved!");var t=ub.firstChild;if(!t)throw Zq.a.argument("Inline element could not be retrieved!");h=b=null;const Nb=RegExp("effectExtent"),Yb=RegExp("extent");for(const Dc of t.childNodes)-1!==Dc.nodeName.search(Nb)&&(b=Dc),-1!==Dc.nodeName.search(Yb)&&(h=Dc);if(!b||!h)throw Zq.a.argument("Effect extent or extent could not be retrieved!");this.qP=parseInt(b.selectSingleNode("@l").text);this.XV=parseInt(b.selectSingleNode("@r").text);
this.Fq=parseInt(b.selectSingleNode("@t").text);this.dda=parseInt(b.selectSingleNode("@b").text);const bc=fk.c(this.UD);if(45<=bc&&135>=bc||225<=bc&&315>=bc){const Dc=parseInt(h.selectSingleNode("@cx").text);var A=parseInt(h.selectSingleNode("@cy").text);t=Dc/2;A/=2;this.qP-=t-A;this.XV+=t-A;this.Fq-=A-t;this.dda+=A-t}}catch(O){u.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",O.message,this.gq,qE.a[this.uNe]);this.Bce();return}this.sendMessage(!0,
this.r5d)}}Object(m.a)(LK,"RenderedDrawingEditOperation",PC,[]);class MK extends PC{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){super(b,h,t,A,O,aa,ua,Ra,ub);this.w$=null;this.r5d=bc=>{var Dc;const Pc=this.RAd(!0,!1);let jd;jd=this.qeb(jd);this._image.setValue(Lc.a.mKb,this.Ysd);const Cd=Be.ImageReader.Wma(this._image,this.Na,this.Zq);(null===(Dc=v.AFrameworkApplication.K)||void 0===Dc?0:Dc.$("ShouldLogPicturesExtendedHealthKpis"))&&this.Mh.logKpiSuccess({kpiName:zm.c.I8b});const ee=()=>{Cd&&OC.a.unb(this._image,
Cd,3);OC.a.unb(this._image,Pc,3);this.Nj.Jee(this._image,Ad.a.WF(this.qP),Ad.a.WF(this.XV),Ad.a.WF(this.Fq),Ad.a.WF(this.dda));this._image.setValue(Lc.a.$eb,Pc);Be.ImageReader.Zx(this._image)||this._image.setValue(Lc.a.uEa,1);this._image.setValue(Lc.a.W_c,this.J$);this._image.setValue(Gd.a.ynm,-1);this.jd.isFeatureEnabled(88)&&Be.ImageReader.i8b(this._image)&&this.Co.tbe(this._image);this._image.setValue(Jh.a.ZNa,!1);this.Nj.qee(this._image,this.kq,this.vs);this.Na.$("WordEditorImageRotateIsEnabled")&&
this.Nj.Lee(this._image,this.UD,this.c$a,this.d$a);this.Na.$("WordEditorImageCropIsEnabled")&&this.Nj.G8f(this._image,this.k9a,this.g9a,this.i9a,this.j9a);2===bc.data.status&&Be.ImageReader.s_(bc.data.we)&&(this._image.setValue(Gd.a.Pt,bc.data.we),bc.data.request&&this._image.setValue(Gd.a.gFb,OC.a.nKc("POST"===bc.data.request.get_httpVerb()?bc.data.request.get_body():bc.data.request.get_url())));this.ILa&&this.ILa();this.IJ.$Ga(this._context);if(this.Nl&&this.Nl!==Ya.a.nil){const Od=this._context.node.Ei(),
fe=new W.a(this.Nl,1);this.Dm.Y1b(Od,fe)}this.Wd.Bs(13);this.BJc();this.KId();Ok.a.mark(this.c7b())};if(this.Na.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Nl&&this.Nl!==Ya.a.nil&&(Dc=this._context.node.Ei())&&Dc.contentReplicator){jd.dispose();Dc.contentReplicator.forceOutbound(()=>{let Od;Od=this.qeb(Od);ee();Od.dispose()},null,null);return}ee();jd.dispose()};this.uNe=Nb;this.jd=Yb}d7b(){return 7988}c7b(){return 7989}get Co(){this.w$||(this.w$=new AK.a);return this.w$}Odc(b){var h;
try{const t=b.data.Qha;this.Ysd=b.data.we;ba.a.jt&&t.setProperty("SelectionNamespaces","xmlns:pic='"+Ji.a.cwn+"'");const A=t.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.qP=parseInt(A.selectSingleNode("@l").text);this.XV=parseInt(A.selectSingleNode("@r").text);this.Fq=parseInt(A.selectSingleNode("@t").text);this.dda=parseInt(A.selectSingleNode("@b").text)}catch(t){b=Object.assign(new Hb.a,{extendedProperties:new Map});b.extendedProperties.set("exception",t.message);b.extendedProperties.set("operation",
this.gq);(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:zm.c.dUd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.Mh.logKpiFailure({kpiName:zm.c.I8b,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})):wa.Health.instance.recordQosError("PictureSwordResponseInvalid",
["ImageEditFailed"],!1,!0,!1,!1,b);u.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",t.message,this.gq,qE.a[this.uNe]);this.Bce();return}this.BJc();Ok.a.mark(this.c7b());this.sendMessage(!0,this.r5d)}}Object(m.a)(MK,"RenderedPictureEditOperation",PC,[]);class NK{constructor(b,h,t,A,O,aa,ua,Ra){this.Nj=b;this.Na=h;this.Zq=t;this.ge=A;this.Wd=O;this.Dm=aa;this.IJ=ua;this.jd=Ra}create(b,h){const t=Be.ImageReader.sk(b);return vm.App.instance.h8(t)?
new KK(b,h,this.Nj,this.Na,this.Zq,this.ge,this.Wd,this.Dm,this.IJ):10===t||11===t||48===t||4===t?new LK(b,h,this.Nj,this.Na,this.Zq,this.ge,this.Wd,this.Dm,this.IJ,t):5===t?new MK(b,h,this.Nj,this.Na,this.Zq,this.ge,this.Wd,this.Dm,this.IJ,t,this.jd):null}}Object(m.a)(NK,"Factory",null,[410]);class OK{constructor(){this.MIc=b=>{const h=window.performance.now(),t=ck.a.Nt();if(t){b=ZG.a(b.customData,t);b=Qd.a.at(b,t);var A=0,O=new Te.GraphTransaction(3);try{for(O.Eb(t);b.moveNext();){if(!qe.ParagraphReader.rh(b.iterator))continue;
const aa=b.currentNode;this.MPh(aa)&&(A++,aa.Wk(4,!0));const ua=window.performance.now()-h;if(2500<A||100<ua){this.Zvb=null;this.G1c(aa);break}}}finally{O&&O.dispose()}}else Jc.b(570450380,3018,10,"PageContentNode not found")};this.Zvb=null}opi(){const b=ck.a.Nt();this.S1c(b);this.G1c(null)}G1c(b){this.Zvb&&(v.AFrameworkApplication.oc.Se(this.Zvb),this.Zvb=null);this.Zvb=new Vb.a(1,1,1,this.MIc,198);this.Zvb.customData=b;v.AFrameworkApplication.oc.Wb(this.Zvb)}S1c(b){const h=ZG.b(b);if(h){var t=new Te.GraphTransaction(3);
try{for(t.Eb(b);h.moveNext();){if(!qe.ParagraphReader.rh(h.iterator))continue;const A=h.currentNode;this.MPh(A)&&A.Wk(4,!0)}}finally{t&&t.dispose()}}}MPh(b){b=b.DG;for(const h of b)if(h.Lib)return 0<h.uOb;return!1}}Object(m.a)(OK,"RenderParagraphsContainingTabs",null,[]);class PK{constructor(b,h){this.twe=!0;this.Qpc=null;this.Hil=()=>{this.Qpc=null;this.twe=!0;this.JLa&&this.JLa.CTa(!Jb.App.xQ())};this.j7a=(t,A,O)=>{if(1===O)return 32;2===O&&(t=!1,Jb.App.xQ()?this.twe=!1:this.twe?t=!0:this.SRo(),
this.JLa&&this.JLa.CTa(t));return 32};this.ga=b;this.JLa=h}Ub(){this.ga.gb(ab.a.j7a,mc.a.application,this.j7a,1124)}SRo(){this.Qpc?v.AFrameworkApplication.oc.Se(this.Qpc):this.Qpc=new Vb.a(4,1,5E3,this.Hil);v.AFrameworkApplication.oc.Wb(this.Qpc)}}Object(m.a)(PK,"SaveStatusActor",null,[]);class QK{get $5f(){return null!=this.JCg?this.JCg:this.JCg=Sa.a.instance.Ma("Box4.ISaveStyleManager")}get uZn(){return this.tZn||(this.tZn=Sa.a.instance.Ma("Box4.IResetAndDeleteStyleManager"))}get Dn(){return null!=
this.GDg?this.GDg:this.GDg=Sa.a.instance.Ma("Box4.Styles.StyleSettings")}constructor(b,h){this.applyStyles=(t,A,O)=>{t=ck.a.WGb(A);if(1===O||t)return t?8:32;this.C5.value.G1k(A);return 32};this.O2b=(t,A,O)=>{t=ck.a.WGb(A);if(1===O||t)return t?8:32;this.C5.value.A5k(A,this.ga);return 32};this.zbf=(t,A,O)=>{t=ck.a.WGb(A)||this.Yjo();if(1===O||t)return t?8:32;this.C5.value.zbf(A);return 32};this.ga=b;this.C5=h}get uc(){return null!=this.xGg?this.xGg:this.xGg=Sa.a.instance.resolve("Box4.Styles.IWACStyleReader")}Ub(){this.ga.gb(qa.a.applyStyles,
mc.a.view,this.applyStyles,1028);this.ga.gb(qa.a.O2b,mc.a.view,this.O2b,4);this.ga.gb(qa.a.YAb,mc.a.view,this.zbf,4);this.ga.gb(qa.a.Z5f,mc.a.view,this.o4n.bind(this),4);this.ga.gb(qa.a.t4f,mc.a.view,this.u4f.bind(this),4);this.ga.gb(qa.a.ubf,mc.a.view,this.Kcl.bind(this),4)}o4n(b,h,t){b=ck.a.WGb(h)||this.cko();if(1===t||b)return b?8:32;this.$5f.n4n();return 32}u4f(b,h,t){b=ck.a.WGb(h)||this.ako();if(1===t||b)return b?8:32;this.uZn.u4f();return 32}Kcl(b,h,t){b=ck.a.WGb(h)||this.Xjo();if(1===t||b)return b?
8:32;this.C5.value.Jcl();return 32}Xjo(){return"{}"===gE.a.spb?!0:!1}ako(){if(0==gE.a.M3.size)return!0;var b=gE.a.M3;const h=this.uc.Cr();let t=0;for(const A of b.values())b=h.Ni(A),this.uc.ke(b,h)||t++;return 0==t?!0:!1}cko(){var b=gE.a.spb,h=gE.a.M3;const t=this.uc.Cr();if(0==h.size)return!0;if(!({Nu:b}=E.d(b)).returnValue)return u.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(const O of h.values()){h=
t.Ni(O);var A=b[O];if(null==A)return!1;if(A=ck.a.EQd(A)){if(h=ck.a.KMc(h,t),ck.a.rTc(h,A))return!1}else u.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}Yjo(){var b=ck.a.Nt();if(!b)return Jc.b(577368330,3018,15,"PageContentNode is null"),!0;b=(new Rv.WACStyleSet).tQ(b);const h=b.VP;for(let A=0;A<h;A++){var t=b.EOa(A);if(this.uc.isHidden(t)||!this.uc.ke(t,b))continue;const O=this.uc.vD(t);if(2===O||1===O)if(!t.hasProperty(Lc.a.linkedStyle)||
2===O)if(t=t.ia(Lc.a.PL,null),!(t&&0<t.length))return!1}return!0}}Object(m.a)(QK,"StylesActor",null,[]);class mG{constructor(b){this.Mie=(h,t,A)=>{h=v.AFrameworkApplication.ta;if(1===A)return 1!==h.mode||fc.SessionStatusManager.instance.xj?2:32;wa.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,mG.dB,null);const O={};O[J.a.Nvf]=v.AFrameworkApplication.K.kb("ClassicViewModePreferenceCookieName");O[J.a.jki]="true";v.AFrameworkApplication.lO().execute(aa=>{aa.sendMessage(K.a.jwo,O)});return v.AFrameworkApplication.xa.processAction(qa.a.readingMode,
2)};this.ga=b}Ub(){this.ga.pa(Vc.a.Mie,mc.a.view,this.Mie)}}mG.dB="wwaengidc";Object(m.a)(mG,"SwitchToClassicViewModeActor",null,[]);class RK{constructor(b,h,t,A,O,aa,ua,Ra,ub){this.angle=t;this.styleId=A;this.width=b;this.height=h;this.top=O;this.bottom=aa;this.left=ua;this.right=Ra;this.gT=ub}}Object(m.a)(RK,"SWordData",null,[]);class SK{constructor(b,h){this.wk=this.gS=this.fq=null;this.JNe=this.bWb=!1;this.qP=this.XV=this.dda=this.Fq=this.J$=this.vs=this.kq=this.UD=0;this.Nl=null;this.R_=()=>
{this.JNe=!1;this.bWb&&this.FJc()};this.ym=b;this.Iyc=h;this.Imi()}Imi(){this.XV=this.qP=this.dda=this.Fq=this.J$=this.vs=this.kq=this.UD=-1;this.Nl=Ya.a.nil}FJc(){this.JNe||(this.aVo(),this.Q6k(),this.bWb=!1)}Q6k(){this.wk=new RK(this.kq,this.vs,this.UD,this.J$,this.Fq,this.dda,this.qP,this.XV,this.Nl);this.Iyc.create(this.gS,this.fq).yeo(this.R_,this.wk);this.JNe=!0;let b;Object(hc.a)(3,this.gS)?b=qE.a[Be.ImageReader.sk(this.gS)]:(u.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),
b="generic");u.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",this.kq,this.vs,this.UD,this.J$,this.Fq,this.dda,this.qP,this.XV,b);this.Imi()}aVo(){this.kq=-1!==this.kq?this.kq:this.gS.ia(Gd.a.sEa,-1);this.vs=-1!==this.vs?this.vs:this.gS.ia(Gd.a.rEa,-1);this.kq=-1!==this.kq?this.kq:this.ym.JE(this.gS);this.vs=-1!==this.vs?this.vs:this.ym.bG(this.gS);this.UD=-1!==this.UD?
this.UD:this.ym.ZZ(this.gS);this.J$=-1!==this.J$?this.J$:this.ym.Zgb(this.gS);this.Fq=-1!==this.Fq?this.Fq:this.ym.Oma(this.gS);this.dda=-1!==this.dda?this.dda:this.ym.Lma(this.gS);this.qP=-1!==this.qP?this.qP:this.ym.Mma(this.gS);this.XV=-1!==this.XV?this.XV:this.ym.Nma(this.gS)}ZFn(b,h,t,A){this.fq=b;this.UD=t;this.bWb=!0;this.gS=h;this.Nl=A;this.FJc()}YFn(b,h,t,A,O){this.fq=b;this.bWb=!0;this.gS=h;this.Nl=O;this.gS.setValue(Gd.a.sEa,t);this.gS.setValue(Gd.a.rEa,A);this.FJc()}cGn(b,h,t){this.fq=
b;this.bWb=!0;this.gS=h;this.J$=t;this.FJc()}TFn(b,h,t,A,O,aa){this.fq=b;this.Fq=t;this.dda=A;this.qP=O;this.XV=aa;this.bWb=!0;this.gS=h;h=b=0;({width:b,height:h}=this.ym.Kgb(this.gS));this.kq=b-(O+aa)/1E5*b;this.vs=h-(t+A)/1E5*h;this.FJc()}}Object(m.a)(SK,"SWordRequestManager",null,[406]);class jF{constructor(b,h,t,A=null,O=null,aa=null,ua=null,Ra=null,ub=null,Nb=null){this.Dm=null;this.dhh=!1;this.Lyo=(Yb,bc,Dc,Pc,jd)=>{var Cd;if(1===Dc)return 32;const ee=Yb===qa.a.y$f;if(!bc.view.re)return 2;const Od=
bc.view,fe=Od.nb,Ee=fe.pg;if(!Ee||jF.Zf.JZ(Ee))return 2;if(this.Rm&&this.Rm.instance&&this.Rm.instance.aU(Ee))return 4;Yb=null;var re=Kf.ActionManager.Mwa;let Fg=!1;var Gg=nf.SelectionEditor.jf(Ee);if(Ee.Hw)fe.hb.YI&&(re=Ee.getContext(0),Yb=new ue.GraphIterator,Yb.set(re.node),Yb.Yo(),re=ee?qa.a.F6f:qa.a.yde),re=this.YRe.AAn(re),re===Kf.ActionManager.Mwa&&((Cd=jF.Vg.MS(Ee,16))?(ee&&(re=qa.a.t3d),Yb=new ue.GraphIterator,Yb.set(Cd.node),Yb.yd()):re=ee?qa.a.pG:qa.a.RN);else if(Ee.Xk)if(Yb=new ue.GraphIterator,
Yb.set(Ee.node),nf.SelectionEditor.au(Yb),mj.OutlineReader.GPa(Ee))re=ee?qa.a.F6f:qa.a.yde;else{if(this.yBe&&this.yBe.bmo(Ee))return this.yBe.s5c(Ee,Od.jc,ee),32;(null===(Cd=Jb.App.instance)||void 0===Cd?0:Cd.Oib)&&Be.ImageReader.O1a(Ee)?re=ee?qa.a.E6f:qa.a.D6f:(re=ee?this.YRe.Ocm(Yb,Ee,re,bc):this.YRe.Ncm(Yb,Ee,re,bc),mb.OutlineElementReader.Lh(Yb)&&Ee.contextId===mc.a.Vc&&(Fg=mb.OutlineElementReader.jA(Yb,Ee,!1)),Cd=hb.ListItemReader.Kh(Yb)&&Fg,re!==Kf.ActionManager.Mwa||Gh.TableCellReader.Yna(Yb)||
Cd||(this.dhh||(u.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.dhh=!0),v.AFrameworkApplication.xa.processAction(qa.a.eni,2),this.Bni(bc)))}else return 2;if(!ee&&re===Kf.ActionManager.Mwa&&Gh.TableCellReader.Yna(Yb))if(Wh.returnToCell(Yb),Gh.TableCellReader.CPa(Yb)||ni.TableReader.Gti(Yb)&&Gh.TableCellReader.IBf(Yb)){if(re=this.gjk(),!re)return 2}else re=qa.a.EJi;if(re===Kf.ActionManager.Mwa)return 2;switch(re){case qa.a.EJi:case qa.a.t3d:Pc=re===qa.a.t3d;Gg&&this.b1&&
this.BY&&(Gg=this.b1.Nhf(Ee,-1,!0,rc.a.iw))&&this.BY.Qaj(Gg);Dc=32;Wh.returnToCell(Yb);Wh.moveToNextOrPreviousCell(Yb,Pc)&&(Gg=!0,Pc=!1,mj.OutlineReader.Uuf(Yb)||(ip.OutlineNavigator.jLf(Yb,!1),wg.OutlineElementNavigator.Fe(Yb),qe.ParagraphReader.Jt(Yb.currentNode)&&(Gg=!1,qe.ParagraphReader.textLength(Yb.currentNode)||(Pc=!0)),Pc||Wh.returnToCell(Yb)),Pc?Yb=wf.SelectionFactory.te(Yb.currentNode,0):(Yb=wf.SelectionFactory.mq(Yb.currentNode),!Gg&&nf.SelectionEditor.Dk(Yb.Rc)&&(Gg=Yb.toArray(),Array.removeAt(Gg,
Gg.length-1),Yb=new Kg.Selection(Gg,Yb.Mf))),fe.setSelection(Yb));break;case qa.a.F6f:case qa.a.yde:re===qa.a.yde?ip.OutlineNavigator.dJi(Yb,!1):ip.OutlineNavigator.dJi(Yb,!0);fe.setSelection(wf.SelectionFactory.mq(Yb.currentNode));Dc=32;break;case qa.a.w7c:Dc=v.AFrameworkApplication.xa.Nf(bc,re,Dc,!0,Pc,jd);break;default:if(Dc=v.AFrameworkApplication.xa.Nf(bc,re,Dc,!0,Pc,jd),!Fg&&Gg&&(re===qa.a.pG||re===qa.a.RN)){const bm=nf.SelectionEditor.R6(fe.hb.lb).y;Jb.App.Sfc(()=>{this.t9m(fe,Od,bm)})}}32===
Dc&&bc.view.re&&this.Ug.QE();return Dc};this.Nka=b;this.YRe=h;this.Rm=t;this.b1=A;this.BY=O;this.aSe=aa;this.OIa=ua;this.jd=Ra;this.Ic=ub;this.yBe=Nb}get Ug(){return this.Dm||(this.Dm=this.Nka())}Ub(){const b=v.AFrameworkApplication.xa,h=this.Lyo;b.gb(qa.a.tab,mc.a.view,h,1124);b.gb(qa.a.y$f,mc.a.view,h,1124);b.pa(qa.a.eni,mc.a.view,Kf.ActionManager.Kf)}t9m(b,h,t){if(b&&h){var A=b.hb.lb;nf.SelectionEditor.R6(A).y<t?(h=nf.SelectionEditor.IKc(h,A,!1),h=nf.SelectionEditor.Oua(h,{uA:!1,Yr:!1,lC:!1,OD:!0})):
h=nf.SelectionEditor.JKc(h,A,!1);b.setSelection(h)}}gjk(){return qa.a.I1a}Bni(){}KXc(b,h,t){if(b&&h){var A=b.hb.lb;nf.SelectionEditor.R6(A).y<t?(h=nf.SelectionEditor.IKc(h,A,!1),h=nf.SelectionEditor.Oua(h,{uA:!1,Yr:!1,lC:!1,OD:!0})):h=nf.SelectionEditor.Oua(A,{uA:!1,Yr:!1,lC:!1,OD:!0});b.setSelection(h)}}static get Zf(){return rl.a.instance}static get Vg(){return Ik.ContextSetEditor.instance}}Object(m.a)(jF,"TabActor",null,[]);class jH{constructor(b){this.ytc=b}get Xp(){return this.ytc}AAn(b){return b}Ocm(b,
h,t,A){const O=A.view,aa=O.nb.hb.lb;if(Gh.TableCellReader.Yna(b))return this.Bti(b,A)?qa.a.pG:qa.a.t3d;wg.OutlineElementNavigator.Zd(b);if(nf.SelectionEditor.jf(h))mb.OutlineElementReader.jA(b,h,!1)&&this.kkj(b)?t=qa.a.SKb:nf.SelectionEditor.jUc(O,aa)&&this.Xp.lzb(b)?t=qa.a.pG:nf.SelectionEditor.jUc(O,aa)&&(t=qa.a.pG);else if(nf.SelectionEditor.gl(h)){if(!this.Xp.lzb(b))return t;nf.SelectionEditor.Hib(h)?t=qa.a.pG:nf.SelectionEditor.qyi(h)&&(t=this.kkj(b)?qa.a.SKb:qa.a.pG)}else this.Xp.lzb(b)&&(t=
qa.a.pG);return t}Ncm(b,h,t,A){if(Gh.TableCellReader.t_(b))return this.Bti(b,A)?qa.a.RN:t;wg.OutlineElementNavigator.Zd(b);if(nf.SelectionEditor.jf(h))mb.OutlineElementReader.jA(b,h,!1)&&(!hb.ListItemReader.Kh(b)&&mb.OutlineElementReader.isEmpty(b,!1)?t=Kf.ActionManager.Mwa:this.Wjo(b)?t=qa.a.Leb:this.ujj(b)?t=qa.a.ZAb:this.Xp.b1b(b)&&(t=qa.a.RN));else if(nf.SelectionEditor.gl(h)){if(!this.Xp.b1b(b))return t;nf.SelectionEditor.Hib(h)?t=qa.a.RN:nf.SelectionEditor.qyi(h)&&(t=this.ujj(b)?qa.a.ZAb:qa.a.RN)}else this.Xp.b1b(b)&&
(t=qa.a.RN);return t}kkj(b){return hb.ListItemReader.Kh(b)?!1:0<mb.OutlineElementReader.k3(b)?!0:!1}ujj(b){if(hb.ListItemReader.Kh(b))return!1;const h=mb.OutlineElementReader.k3(b);b=mj.OutlineReader.eX(b.currentNode);return h<b?!0:!1}Wjo(b){return hb.ListItemReader.Kh(b)?!1:0<mb.OutlineElementReader.aG(b)?!0:!1}static zr(){return new jH(Jv.a.JDb)}Bti(b,h){if(this.jIm){h=h.view;const t=h.nb.hb.lb,A=new ue.GraphIterator;A.$c(b);wg.OutlineElementNavigator.Zd(A);if(hb.ListItemReader.Kh(A)&&nf.SelectionEditor.jUc(h,
t))return!0}return!1}get jIm(){var b;v.AFrameworkApplication.ye("egdi3422;7g6fa693");return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(m.a)(jH,"TabActorPromoteDemoteStrategy",null,[416]);class MD extends jF{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc){super(b,h,t,A,O,aa,ua,Ra,ub,Nb);this.S5d=(Pc,jd)=>{Pc=jd.property;!this.c3c||Pc!==Lc.a.xo&&Pc!==Lc.a.marginLeft&&Pc!==Lc.a.marginRight||this.c3c.opi()};
this.eX=(Pc,jd,Cd,ee,Od)=>{Pc=mj.OutlineReader.eX(this.x_l(jd));Od.defaultTabStop=Pc;return 32};this.dWb=Yb;this.ga=Dc;this.bF();this.ga.pa(Vc.a.eX,mc.a.view,this.eX)}get c3c(){return null!=this.yCg?this.yCg:this.yCg=Sa.a.instance.Ma("WordEditor.Actors.RenderParagraphsContainingTabs")}bF(){this.dWb.Kl.af(10).Ro(this.S5d)}Bni(b){const h=b.view,t=h.nb;b=t.pg;if(this.OIa&&this.Ic){var A=this.Ic.Qc(15);A.Eb(b.node);b.contextId===mc.a.Fd&&v.AFrameworkApplication.xa.processAction(qa.a.kH,2);this.OIa.$Ud(t.pg);
A.dispose();var O=nf.SelectionEditor.R6(t.hb.lb).y;Jb.App.Sfc(()=>{this.KXc(t,h,O)})}}x_l(b){return b.view.nb.hb.lb.Qa.node}static get instance(){return null!=MD.jzg?MD.jzg:MD.jzg=MD.Sl()}static Sl(){return new MD(()=>Sa.a.instance.resolve("Box4.IUndoManager"),jH.zr(),Sa.a.instance.Sa("Box4.IExternalSelectionManager"),Sa.a.instance.resolve("Box4.IAutoCorrectRules"),Sa.a.instance.resolve("Box4.IAutoCorrectScheduler"),Sa.a.instance.Ma("Box4.ITabPresenterFactory"),Sa.a.instance.Ma("Box4.IBlobEditor"),
Sa.a.instance.Ma("Box4.IFeatureHelper"),Sa.a.instance.Ma("Box4.Graph.GraphTransactionFactory"),Sa.a.instance.Ma("Box4.Actors.IIFrameFocusStrategy"),Jb.App.jk,Sa.a.instance.Ma("Box4.ITabRenderer"),v.AFrameworkApplication.xa)}}Object(m.a)(MD,"TabActor",jF,[]);class zx{static get Zs(){return null!=zx.zsg?zx.zsg:zx.zsg=Sa.a.instance.resolve("Box4.IAppFrame")}static initialize(){Ht.a.lac=zx.fJm;Ht.a.hje=zx.RXo}static fJm(b){return!ni.TableReader.eEm(b)}static Ukb(){zx.Zs.dgc(zx.Ukb);zx.Tub=!1;const b=
appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static RXo(b){var h,t,A;b&&((null===(h=hi.a.instance.lb)||void 0===h?0:h.kFa)||(null===(t=hi.a.instance.lb)||void 0===t?0:t.Lw)||(null===(A=hi.a.instance.lb)||void 0===A?0:A.bHb))&&!zx.Tub&&(zx.Zs.mYa(zx.Ukb),zx.Tub=!0)}}zx.Tub=!1;Object(m.a)(zx,"TableActor",null,[]);var qN=c(919);class kH{nwl(b,h,t,A){return b?
this.Pul(h,t,A):this.owl(h,t,A)}uWh(b,h,t,A,O){return b?this.Rvl(h,t,A,O):this.Evl(h,t,A,O)}Bvl(b){let h=!1;var t=b.Mf?b.Pe.Rc:b.Pe.Qa;b=new ue.GraphIterator;b.set(t.node);b.Ab(14);t=null;Gh.TableCellReader.lba(b)?Gh.TableCellReader.pGb(b)||(h=!0,t=Wh.moveToNextRow(b)):t=Wh.moveToNextColumn(b);return{returnValue:t,L9m:h}}Mvl(b){var h=b.Mf?b.Pe.Rc:b.Pe.Qa;const t=new ue.GraphIterator;t.set(h.node);t.Ab(14);h=null;Gh.TableCellReader.uga(t)?Gh.TableCellReader.tga(t)||(h=new ue.GraphIterator,h.set(b.ZBa.node),
h.Ab(14),b=vp.a.Wr(h),vp.a.Wr(t)>b?(Wh.moveToPreviousRow(t),Wh.moveToLastColumn(t),h=t.currentNode):h=Wh.moveToPreviousRow(t)):h=Wh.moveToPreviousColumn(t);return h}IWh(b,h){var t=b.Mf?b.Pe.Rc:b.Pe.Qa;b=new ue.GraphIterator;b.set(t.node);b.Ab(14);t=null;h?Gh.TableCellReader.tga(b)||(t=Wh.moveToPreviousRow(b)):Gh.TableCellReader.pGb(b)||(t=Wh.moveToNextRow(b));return t}qHb(b,h,t){for(;Gh.TableCellReader.gg(b);)if(h){if(t&&b.Wva(1)||!t&&b.cwa(1))return null;t?Wh.moveToPreviousColumn(b):Wh.moveToNextColumn(b)}else{if(Gh.TableCellReader.F3(b.currentNode)){const A=
new ue.GraphIterator;A.$c(b);if(this.qHb(A,!0,!0)||this.qHb(A,!0,!1)){b.$c(A);break}}else{if(!t&&Wh.moveToControllingCell(b,2))break;if(t&&Wh.moveToControllingCell(b))break}if(t&&Gh.TableCellReader.tga(b)||!t&&Gh.TableCellReader.pGb(b))return null;t?Wh.moveToPreviousRow(b):Wh.moveToNextRow(b)}return b.currentNode}i5b(b,h){if(!vp.a.isTableRow(b))return null;b=ue.GraphIterator.$a(b.currentNode);b.Ab(14);let t;const A=ni.TableReader.kB(b.origin);do t=h?Wh.moveToPreviousRow(b):Wh.moveToNextRow(b);while(A&&
t&&vp.a.vPa(b));return t}wkb(b,h,t,A,O){let aa=null;wg.OutlineElementNavigator.Zd(b);const ua=mb.OutlineElementReader.isRtl(b.currentNode);if(t)if(Wh.returnToCell(b),h=Gh.TableCellReader.lba(b),t=Gh.TableCellReader.uga(b),O||!ua&&t||ua&&A&&h)Wh.returnToContainingRow(b),(A=this.i5b(b,!0))?aa=wf.SelectionFactory.Yn(A,!h):O&&(wg.OutlineElementNavigator.Zd(b),O=new Xm.a,O.$c(b),(b=wg.OutlineElementNavigator.N_(O,!1,!1))&&(aa=wf.SelectionFactory.Yn(b,!1)));else{do ua?Wh.moveToNextColumn(b):Wh.moveToPreviousColumn(b);
while(Gh.TableCellReader.gg(b)&&!Gh.TableCellReader.tga(b));Gh.TableCellReader.gg(b)||(aa=wf.SelectionFactory.Yn(b.currentNode,!ua))}else mb.OutlineElementReader.jA(b,h,ua)||nf.SelectionEditor.jf(h)||Wh.returnToCell(b),aa=wf.SelectionFactory.Yn(b.currentNode,!ua);return aa}vkb(b,h,t,A,O){let aa=null;wg.OutlineElementNavigator.Zd(b);const ua=mb.OutlineElementReader.isRtl(b.currentNode);if(t)if(Wh.returnToCell(b),t=Gh.TableCellReader.lba(b),h=Gh.TableCellReader.uga(b),O||!ua&&A&&t||ua&&!A&&h)Wh.returnToContainingRow(b),
(A=this.i5b(b,!1))?aa=wf.SelectionFactory.Yn(A,h):(wg.OutlineElementNavigator.Zd(b),A=new Xm.a,A.$c(b),(b=wg.OutlineElementNavigator.Ir(A,!1,!1))&&(aa=wf.SelectionFactory.Yn(b,!0)));else{do ua?Wh.moveToPreviousColumn(b):Wh.moveToNextColumn(b);while(Gh.TableCellReader.gg(b)&&!Gh.TableCellReader.lba(b));Gh.TableCellReader.gg(b)||(aa=wf.SelectionFactory.Yn(b.currentNode,ua))}else mb.OutlineElementReader.jA(b,h,!ua)||nf.SelectionEditor.jf(h)||Wh.returnToCell(b),aa=wf.SelectionFactory.Yn(b.currentNode,
ua);return aa}}Object(m.a)(kH,"ATableCellSelectionStrategy",null,[1597]);class TK extends kH{constructor(){super()}Evl(b,h,t,A){let O=b.lb,aa=null;if(b.Lw)if(h)if(2===O.Pe.zoa&&!O.Mf&&O.Pe.Rc.equals(O.ZBa))O=wf.SelectionFactory.aJh(O.ZBa.node,!1);else{var ua=({L9m:b}=this.Bvl(O)).returnValue;ua&&(Gh.TableCellReader.Er(ua)&&(ua=ue.GraphIterator.$a(ua),ua.Ab(14),ua=!b&&this.qHb(ua,!0,!1)?ua.currentNode:b||Wh.moveToNextRow(ua)?this.qHb(ua,!1,!1):null),ua&&(aa=wf.SelectionFactory.Zn(X.TableNodeContext.create(ua),
O.Mf)))}else O=b.Jca,b=ue.GraphIterator.$a(O.Pe.Rc.node),b.Ab(14),Gh.TableCellReader.WEa(b.currentNode)&&Wh.moveToLastGhostCell(b,2),(ua=Wh.moveToNextColumn(b))?(b=Gh.TableCellReader.F3(ua),Gh.TableCellReader.Er(ua)&&!b&&(ua=ue.GraphIterator.$a(ua),ua.Ab(14),ua=Wh.moveToControllingCell(ua)),b?O=wf.SelectionFactory.Yn(O.Pe.Rc.node,!1):aa=wf.SelectionFactory.Yn(ua,!0)):(ua=O.Pe.Rc.node,aa=wf.SelectionFactory.Yn(ua,!1));else b=h&&O.Mf||!h&&!O.qwa?O.Pe.Rc:O.Pe.Qa,vp.a.Zna(b.node)&&(b=ue.GraphIterator.$a(b.node),
(ua=this.i5b(b,!1))?aa=h?wf.SelectionFactory.Zn(X.TableNodeContext.create(ua),O.Mf):wf.SelectionFactory.Yn(ua,!0):O=nf.SelectionEditor.Bj(wf.SelectionFactory.mq(b.currentNode),!1,!0));return aa?aa:A?nf.SelectionEditor.h5b(O,!1,h,!0):nf.SelectionEditor.Oua(O,{uA:!h,Yr:h,lC:t,OD:!0})}Rvl(b,h,t,A){let O=b.lb;var aa=null;if(b.Lw)h?1===O.Pe.zoa&&O.Mf&&O.Pe.Qa.equals(O.ZBa)||(aa=this.Mvl(O),(aa=this.sWh(O,aa))||O.Mf&&(O=O.eLc())):(O=b.Jca,aa=wf.SelectionFactory.Yn(O.Pe.Qa.node,!0));else if(h){var ua=(O.Mf?
O.Pe.Rc:O.Pe.Qa).node;b=ue.GraphIterator.$a(ua);nf.SelectionEditor.au(b);vp.a.Zna(ua)&&(O.Mf&&1===O.Pe.zoa&&O.qwa?(aa=vp.a.eB(ua).toArray(),(aa=this.sWh(O,0<=aa.length-2?aa[aa.length-2]:null))||O.Mf&&(O=O.eLc())):(ua=this.i5b(b,!0))?aa=wf.SelectionFactory.Zn(X.TableNodeContext.create(ua),O.Mf):O=wf.SelectionFactory.Yn(b.currentNode,!0))}else aa=nf.SelectionEditor.Bj(O,!0,!1);return aa?aa:A?nf.SelectionEditor.h5b(O,!0,h,!0):nf.SelectionEditor.vDa(O,{uA:!h,Yr:h,lC:t,OD:!0})}sWh(b,h){if(!h)return null;
var t=h;Gh.TableCellReader.Er(h)&&(t=ue.GraphIterator.$a(h),t.Ab(14),t=this.qHb(t,!0,!0)?t.currentNode:Gh.TableCellReader.Bfa(h));return t?wf.SelectionFactory.Zn(X.TableNodeContext.create(t),b.Mf):null}owl(b,h,t){let A=h.lb,O=null;if(h.Lw){var aa=h.QW>h.CHa;if(t)if(2===h.length&&1===h.Jca.Pe.zoa&&aa)A=nf.SelectionEditor.Bj(A,!0,!1);else{if(h=this.IWh(A,!0))Gh.TableCellReader.Er(h)&&(h=ue.GraphIterator.$a(h),h.Ab(14),h=this.qHb(h,!1,!0)),h&&(O=wf.SelectionFactory.Zn(X.TableNodeContext.create(h),A.Mf));
O||A.Mf&&(A=A.eLc())}else aa&&(A=h.Jca)}else h=t&&A.Mf?A.Pe.Rc:A.Pe.Qa,vp.a.Zna(h.node)&&(h=ue.GraphIterator.$a(h.node),(aa=this.i5b(h,!0))?O=t?wf.SelectionFactory.Zn(X.TableNodeContext.create(aa),A.Mf):wf.SelectionFactory.Yn(aa,!0):t&&(A=wf.SelectionFactory.Yn(h.currentNode,!0)));return O?O:nf.SelectionEditor.seb(b,A,!1,t,t)}Pul(b,h,t){let A=h.lb,O=null;if(h.Lw){const aa=h.QW<h.CHa;if(t)if(2===h.length&&1===h.Jca.Pe.zoa&&aa)A=nf.SelectionEditor.Bj(A,!1,!1);else{if(h=this.IWh(A,!1))Gh.TableCellReader.Er(h)&&
(h=ue.GraphIterator.$a(h),h.Ab(14),h=this.qHb(h,!1,!1)),h&&(O=wf.SelectionFactory.Zn(X.TableNodeContext.create(h),A.Mf))}else aa&&(A=h.Jca)}else h=!t||A.Mf?A.Pe.Rc:A.Pe.Qa,vp.a.Zna(h.node)&&(h=ue.GraphIterator.$a(h.node),(h=this.i5b(h,!1))&&(O=t?wf.SelectionFactory.Zn(X.TableNodeContext.create(h),A.Mf):wf.SelectionFactory.Yn(h,A.qwa)));return O?O:nf.SelectionEditor.seb(b,A,!0,t,t)}}Object(m.a)(TK,"TableCellSelectionStrategy",kH,[]);class UK{constructor(b){this.YK=(h,t,A,O,aa)=>{if(1===A)return 32;
h=(new kk.a).create();t="";switch(aa.DialogType){case "DirectPrintPreparingPDF":t=CommonUIStrings.l_DirectPrintPreparingPDF;aa=CommonUIStrings.l_DefaultDialogTitle;break;default:aa=CommonUIStrings.l_DefaultDialogTitle}h.message=t;h.YK(aa,null,null);return 32};this.ga=b}Ub(){this.ga.gb(qa.a.YK,mc.a.view,this.YK,1028)}}Object(m.a)(UK,"UIAutomationActor",null,[]);class VK{constructor(b,h,t,A){this.eb=b;this.OIa=h;this.boc=t;this.O5=A}vhg(b,h,t){return this.boc.$Gm(h)?t?!0:b&&this.eb.rh(b)?(b=this.Bw(b.currentNode),
this.OIa.Mni(b),!0):!1:!1}nuf(b,h){return this.boc.vpl(b,h)}uuf(b){b&&this.eb.rh(b)&&(b=this.Bw(b.currentNode),this.OIa.$Ud(b))}Bw(b){return pf.a.Bw(b)}fHa(b,h,t){this.O5.hVi&&this.boc.jsi(t)&&(this.O5.fHa(b,h),b.setValue(Gd.a.zsi,!0))}Yee(){}XWd(b){return this.boc.XWd(b)}get hYd(){return this.boc.hYd}KC(){}vca(){}rfe(){}get Hkj(){return!1}}Object(m.a)(VK,"WordEditorPasteStewardBridge",null,[117]);class WK{constructor(b){this.ra=new If.a;this.daj="WordFileSaveAsButtonClicked";this.TXo=()=>{this.ra.raiseEvent(this.daj,
null);return 32};this.ga=b}Ub(){v.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.pa(Vc.a.JEj,yc.a.frame,this.TXo)}Jrk(b){this.ra.addHandler(this.daj,b)}}Object(m.a)(WK,"WordFileSaveAsActor",null,[]);class XK extends Bj{constructor(){super()}oDc(b,h,t,A,O,aa,ua){return Xf.a.Jec(h,t,A,O,aa,ua)}}Object(m.a)(XK,"WordIndentationActorExtension",Bj,[]);class lH{constructor(){this.gld=null}get name(){return"WordEditor.Actors"}init(){var b;pc.InteractiveViewManager.instance.editingView.B3b=
!0;v.AFrameworkApplication.xa.pa(Vc.a.VWo,yc.a.frame,WM);this.W.resolve("WordEditor.Actors.DeleteActor").Ub(v.AFrameworkApplication.xa);FD.instance.Ub();qn.Ub();Lr.Ub(v.AFrameworkApplication.xa,this.W.resolve("WordEditor.IMainViewModeManager"));wk.Ub();MD.instance.Ub();qN.a.Ub();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Ub(v.AFrameworkApplication.xa);this.W.resolve("WordEditor.Actors.ExternalContentActor").Ub();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").Ub();v.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&
this.W.resolve("Box4.Actors.FormatPainterActor").Ub();v.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Ub();v.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&v.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.WV.pYd=!0);v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Ub();
v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Ub();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Ub();this.W.resolve("Common.IOfficeTrialExperience").Ub();this.W.resolve("Common.IMacOfficeOffer").Ub();this.W.resolve("WordEditor.Actors.MarginsDialogActor").Ub();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Ub();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Ub();this.W.resolve("WordEditor.Actors.FileDownloadActor").Ub();
this.W.resolve("WordEditor.Actors.StylesActor").Ub();(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&this.W.resolve("WordEditor.Actors.CustomizeRibbonActor").Ub();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Ub();this.W.resolve("WordEditor.Actors.ProofingActor").Ub();this.W.resolve("WordEditor.Actors.PageActor").Ub();this.W.resolve("WordEditor.Actors.DarkModeActor").Ub();this.W.resolve("WordEditor.Actors.ImageActor").Ub(v.AFrameworkApplication.xa);
this.W.resolve("WordEditor.Actors.FormattingActor").Ub();this.W.resolve("WordEditor.Actors.UIAutomationActor").Ub();this.W.resolve("WordEditor.Actors.ContentControlActor").Ub();this.W.resolve("WordEditor.Actors.CustomTabActor").Ub();this.W.resolve("WordEditor.Actors.BookmarkActor").Ub();this.W.resolve("WordEditor.Actors.HeadingsActor").Ub();this.W.resolve("Box4.Indicator.IIndicatorManager").Q4a(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Ub();
this.W.resolve("WordEditor.Actors.AccessibilityActor").c1f();this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").Ub();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Ub();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.W.resolve("Box4.Actors.VisiMarkersActor").Ub();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").fR();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Ub();
v.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.iNn():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Ub();this.FV.P4a(this.MQj);b=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");v.AFrameworkApplication.ye("bookmarks-core-ex;bookmarks-core-ex-cf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.Hhm()&&Jb.App.ya.jb.fSh();Jb.App.ya.updateCommandUI();zx.initialize()}dispose(){}iNn(){this.jd.Ip.isCompleted?
this.jd&&this.jd.isFeatureEnabled(47)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Ub():this.jd.Ip.continueWith(()=>{this.jd&&this.jd.isFeatureEnabled(47)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Ub(),Jb.App.ya.updateCommandUI())})}get tHm(){if(null==this.gld)if(this.jd)if(this.jd.Ip.isCompleted)this.gld=this.jd.isFeatureEnabled(3);else return!1;else this.gld=!1;return this.gld}yc(b){var h;this.W=b;this.jd=b.Ma("Box4.IFeatureHelper");this.WV=this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");
this.WV.STc=v.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new sJ).yc(b);b.ha("Box4.IClipboardCommands",()=>new tJ(v.AFrameworkApplication.xa,qa.a.q2e,qa.a.bEc,qa.a.BZ,qa.a.CVf,qa.a.paste,qa.a.N8,qa.a.Slb)).singleInstance();b.ha("HtmlImport.IHtmlNormalizerSettings",()=>{const t=b.resolve("Common.IAppSettingsManager");return new Jx(!0,t.$("SplitHyperlinkFixWithEnterIsEnabled"))}).singleInstance();
b.ha("HtmlImport.IHtmlTranslatorSettings",()=>{const t=b.resolve("Common.IAppSettingsManager"),A=O=>!O.X9b;return new us(t.$("ExternalPasteImprovementsEnabled"),t.$("PasteComplexTablesIsEnabled"),!0,!0,!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,t.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,O=>O.X9b,()=>!1,A,A,A,A,void 0,()=>this.tHm,O=>!O.X9b)}).singleInstance();b.ha("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new VK(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),
b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").singleInstance();b.ha("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new IK(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").singleInstance();b.ha("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new uJ).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").singleInstance();
b.ha("Box4.IIndentationCommands",()=>new vJ(v.AFrameworkApplication.xa)).singleInstance();b.ha("Box4.IJustificationCommands",()=>new wJ(v.AFrameworkApplication.xa)).singleInstance();b.ha("Box4.ISpacingCommands",()=>new xJ(v.AFrameworkApplication.xa)).singleInstance();b.ha("WordEditor.IPageCommands",()=>new EK(v.AFrameworkApplication.xa)).singleInstance();b.ha("WordEditor.Actors.StylesActor",()=>new QK(v.AFrameworkApplication.xa,b.We("WordEditor.UI.IDialogFactory"))).singleInstance();(null===(h=v.AFrameworkApplication.K)||
void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&b.ha("WordEditor.Actors.CustomizeRibbonActor",()=>new hF(v.AFrameworkApplication.xa)).singleInstance();b.ha("WordEditor.Actors.DigitalPrintActor",()=>new bH(v.AFrameworkApplication.xa,b.We("WordEditor.UI.IDialogFactory"))).singleInstance();b.ha("WordEditor.Actors.FileDownloadManager",()=>new lK(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new OM.a)).singleInstance();b.ha("WordEditor.Actors.FileDownloadActor",
()=>new iK(v.AFrameworkApplication.xa,b.We("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),v.AFrameworkApplication.K.$("DisablePrint"),v.AFrameworkApplication.K.kb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).singleInstance();b.ha("WordEditor.Actors.ParagraphDialogActor",()=>new GK(v.AFrameworkApplication.xa,b.We("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),Aq.a.instance,b.resolve("Box4.IParagraphIndentationReader"),
b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"))).singleInstance();b.ha("WordEditor.Actors.MarginsDialogActor",()=>new CK(v.AFrameworkApplication.xa,b.We("WordEditor.UI.IDialogFactory"),Aq.a.instance)).singleInstance();b.ha("WordEditor.Actors.ColumnsDialogActor",()=>new bK(v.AFrameworkApplication.xa,b.We("WordEditor.UI.IDialogFactory"),Aq.a.instance)).singleInstance();b.ha("WordEditor.Actors.ModeSwitcherControlActor",()=>new Ry.a(b.Sa("Common.ISystemInitiatedFeedback"),QM.a.HMc())).as("WordEditor.IModeSwitcherControl").singleInstance();
b.ha("WordEditor.Actors.PaperSizeDialogActor",()=>new FK(v.AFrameworkApplication.xa,b.We("WordEditor.UI.IDialogFactory"),Aq.a.instance)).singleInstance();b.ha("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new wK(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).singleInstance();b.register(gK,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").singleInstance();b.ha("WordEditor.Actors.ProofingActor",()=>new JK(v.AFrameworkApplication.xa,rl.a.instance,Sa.a.instance.resolve("Box4.ISelectionManager"),
Er.a.instance,Sa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Sa.a.instance.resolve("Box4.ILanguageReader"),Sa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Sa.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Sa.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.WV,Sa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),v.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Sa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();
(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").HA.loadScript("EditorSettingsManager")).then(()=>{const t=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");t.dpm();t.init();b.ha("Box4.Proofing.EditorSettingsUIActor",()=>new yJ(v.AFrameworkApplication.xa,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new zJ(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).singleInstance();
v.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&v.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Ub()});b.ha("WordEditor.Actors.PageActor",()=>new DK(Sa.a.instance.resolve("Box4.IWordSectionEditor"),Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Sa.a.instance.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.IPageCommandStringBuilder").singleInstance();b.ha("WordEditor.Actors.DarkModeActor",
()=>new eK(v.AFrameworkApplication.xa,v.AFrameworkApplication.K,Jb.App.Oca,!!Jb.App.instance&&Jb.App.instance.VEa,!!Jb.App.instance&&Jb.App.instance.nUc,Sa.a.instance.resolve("Box4.IDarkModeState"),Sa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Sa.a.instance.resolve("Box4.DarkModeEventsManager"),!!Jb.App.instance&&Jb.App.instance.Nna)).singleInstance();b.ha("WordEditor.FlatListDetailsProvider",()=>new nK(b.resolve("WordEditor.IFlatListEditor")));b.ha("WordEditor.Actors.AccessibilityActor",
()=>new KJ(b.Sa("Box4.Accessibility.IAccessibilityContextManager"),b.We("WordEditor.FlatListDetailsProvider"),b.We("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.We("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).singleInstance();b.ha("WordEditor.Actors.AppFrameCommandUIActor",()=>new YJ(v.AFrameworkApplication.xa,b.Sa("Postmessage.IHostPostmessenger"))).singleInstance();b.ha("WordEditor.Actors.ImageActor",()=>{var t,A;return new xr(b.resolve("WordEditor.IImageEditor"),
b.Sa("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),(null===(t=Jb.App.instance)||void 0===t?0:t.Oib)?b.resolve("Box4.Images.ImageNavigator"):null,(null===(A=Jb.App.instance)||void 0===A?0:A.Oib)?b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"):null,
b.resolve("Box4.IAppFrame"),v.AFrameworkApplication.K)}).as("Box4.Actors.ImageActor").singleInstance();b.ha("WordEditor.Actors.WordFileSaveAsActor",()=>new WK(v.AFrameworkApplication.xa)).singleInstance();b.ha("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new NK(b.resolve("WordEditor.IImageEditor"),v.AFrameworkApplication.K,v.AFrameworkApplication.ta.lEa,Sa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.Actors.DeleteActor",()=>new fK.DeleteActor(Sa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Sa.a.instance.Sa("Box4.ContentControlConfigSettings"),Sa.a.instance.Sa("Box4.IContentControlEditor"),Sa.a.instance.resolve("Box4.IDynamicRangeEditor"),Sa.a.instance.Sa("WordEditor.Bookmark.IBookmarkManager"),Sa.a.instance.resolve("Box4.IHyperlinkEditor"),
Sa.a.instance.resolve("Box4.IHyperlinkStrategy"),Sa.a.instance.resolve("Box4.IParagraphReader"),Sa.a.instance.resolve("Box4.IParagraphIndentationReader"),Sa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Sa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Sa.a.instance.resolve("Box4.ContentControl.ContentControlViewElementManager"))).singleInstance();this.W.ha("WordEditor.Actors.SWordRequestManager",()=>new SK(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),
v.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").singleInstance();b.ha("WordEditor.Actors.TableCellSelectionStrategy",()=>new TK).as("Box4.ITableCellSelectionStrategy").singleInstance();v.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ha("Box4.Actors.FormatPainter",()=>new AJ(b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),
b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.ICharacterPropertiesEditor"),rl.a.instance,b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.IContentControlChpHelper"))).as("Box4.IFormatPainter").singleInstance();b.ha("Box4.Actors.FormatPainterActor",()=>
new GD(Jb.App.ya,yd.FocusManager.instance(),v.AFrameworkApplication.xa,zk.a.instance,hi.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),!!Jb.App.instance&&Jb.App.instance.Nna,b.resolve("Box4.DarkModeEventsManager"))).singleInstance();b.ha("WordEditor.Actors.FormattingActor",()=>new oK(v.AFrameworkApplication.xa,b.resolve("Box4.List.IListReader"))).singleInstance();b.ha("WordEditor.Actors.UIAutomationActor",()=>new UK(v.AFrameworkApplication.xa)).singleInstance();
b.ha("WordEditor.Actors.SaveStatusActor",()=>new PK(v.AFrameworkApplication.xa,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).singleInstance();b.ha("Box4.Actors.IEnterViewStrategy",()=>new BJ(b.Ma("Box4.IAutoCorrectScheduler"),b.We("Box4.IUndoManager"),b.Sa("Box4.IExternalSelectionManager"))).singleInstance();b.ha("Box4.ISelectAllHandlers",()=>new NC(Lk.PageReader.instance,b.We("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance();b.ha("WordEditor.Actors.ContentControlActor",
()=>new cK(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.xa,v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),
b.resolve("WordEditor.ContentControl.IContentControlFormattingManager"))).singleInstance();b.ha("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new LJ(v.AFrameworkApplication.xa,b.We("WordEditor.UI.IDialogFactory"),yd.FocusManager.instance())).singleInstance();b.ha("Box4.Actors.FontNameFormattingStrategyNoop",()=>new CJ).as("Box4.Actors.IFontNameFormattingStrategy").singleInstance();b.ha("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new bG(v.AFrameworkApplication.Ke,fm.PageNavigator.instance,
b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Sa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),v.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").singleInstance();b.ha("WordEditor.Actors.GraphicsEditorActor",()=>new tK(v.AFrameworkApplication.xa,v.AFrameworkApplication.K,
b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),v.AFrameworkApplication.Ke,this.jd,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();
b.ha("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new OK).singleInstance();b.ha("WordEditor.Actors.CustomTabActor",()=>new dK(v.AFrameworkApplication.xa,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).singleInstance();b.ha("WordEditor.Actors.HeadingsActor",()=>new uK(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),v.AFrameworkApplication.xa,b.resolve("Box4.IParagraphReader"))).singleInstance();b.ha("WordEditor.Actors.BookmarkActor",()=>
new aK(Jb.App.ya,v.AFrameworkApplication.xa,he.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new Pg.a(()=>Jb.App.ya.jb.Wc),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),Er.a.instance,this.W.Sa("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),pc.InteractiveViewManager.instance,this.W.We("WordEditor.UI.IDialogFactory"),
this.W.resolve("Box4.BookmarkParagraphMapping"),rl.a.instance)).singleInstance();b.ha("WordEditor.Actors.BookmarkIndicatorActor",()=>{var t,A;return new rt(b.resolve("Box4.IParagraphReader"),Ud.a.instance,Pd.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),null!==(A=null===(t=Jb.App.instance)||void 0===t?void 0:t.wC)&&void 0!==A?A:!1,new Pg.a(()=>Jb.App.ya.jb.xc))}).singleInstance();b.ha("Box4.Actors.IIFrameFocusStrategy",()=>new vK).singleInstance();
b.ha("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new KD(he.a.instance,b.resolve("Box4.ITextMetricsAdapter"),pc.InteractiveViewManager.instance,ff.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).singleInstance();b.ha("WordEditor.Actors.ExternalContentActor",()=>new tt(v.AFrameworkApplication.xa,b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.K,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).as("WordEditor.Actors.ExternalContentActor").singleInstance();b.ha("Box4.UI.ExternalContentFloatieManager",()=>new JJ).as("Box4.UI.IFloatieManager").singleInstance();b.ha("WordEditor.Actors.ActionHangDetector",()=>new MJ(v.AFrameworkApplication.K,v.AFrameworkApplication.xa)).as("WordEditor.Actors.ActionHangDetector").singleInstance();b.ha("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new JD(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),
pc.InteractiveViewManager.instance,Pw.a.instance(),v.AFrameworkApplication.ta,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Jb.App.jk.Kl.af(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).singleInstance();b.ha("Box4.Actors.WordIndentationActorExtension",()=>new XK).as("Box4.Actors.IIndentationActorExtension").singleInstance();v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&(v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ha("WordEditor.Actors.ModernUxActor",()=>new gH(v.AFrameworkApplication.xa)).singleInstance());
v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ha("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new mG(v.AFrameworkApplication.xa)).singleInstance();(new pJ).yc(b);b.ha("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new IJ(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").singleInstance();b.ha("WordEditor.OnlineMedia.InsertHubbleMediaHelper",
()=>new FJ(v.AFrameworkApplication.xa,b.resolve("Box4.Media.InsertMediaHelper"))).singleInstance();b.ha("WordEditor.OnlineMedia.OnlineMediaActor",()=>new GJ(v.AFrameworkApplication.xa,v.AFrameworkApplication.K,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),rl.a.instance)).singleInstance();this.MQj=new DJ;this.FV=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){P.a.instance.Gc(new lH)}}
Object(m.a)(lH,"WordEditorActorsPackage",null,[1,2]);class YK{constructor(b){this.auc=!1;this.jOi=()=>{this.auc=!0;this.Rr.W2f(this.jOi)};this.Rr=b;this.Rr.x_b(this.jOi)}}Object(m.a)(YK,"GraphFullyConnectedGetter",null,[439]);class jg{constructor(){this.c1g=Object.assign(new xq.a,{})}Qkk(b,h){let t;const A=b&1023;({value:t}=this.c1g.Ec(A,0)).returnValue||jg.ccm().contains(A)||u.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,A);t+=h;this.c1g.Z(A,t);return t}static ccm(){jg.iud||
(jg.iud=new Ca.a,jg.qc(0),jg.qc(1),jg.qc(2),jg.qc(3),jg.qc(4),jg.qc(5),jg.qc(6),jg.qc(7),jg.qc(8),jg.qc(9),jg.qc(10),jg.qc(11),jg.qc(12),jg.qc(13),jg.qc(14),jg.qc(15),jg.qc(16),jg.qc(17),jg.qc(18),jg.qc(19),jg.qc(20),jg.qc(21),jg.qc(22),jg.qc(23),jg.qc(24),jg.qc(25),jg.qc(26),jg.qc(27),jg.qc(28),jg.qc(29),jg.qc(30),jg.qc(31),jg.qc(32),jg.qc(33),jg.qc(34),jg.qc(35),jg.qc(36),jg.qc(37),jg.qc(38),jg.qc(39),jg.qc(40),jg.qc(41),jg.qc(42),jg.qc(43),jg.qc(44),jg.qc(45),jg.qc(46),jg.qc(47),jg.qc(48),jg.qc(49),
jg.qc(50),jg.qc(51),jg.qc(52),jg.qc(53),jg.qc(54),jg.qc(55),jg.qc(56),jg.qc(57),jg.qc(58),jg.qc(59),jg.qc(60),jg.qc(61),jg.qc(62),jg.qc(63),jg.qc(64),jg.qc(65),jg.qc(66),jg.qc(67),jg.qc(68),jg.qc(69),jg.qc(70),jg.qc(71),jg.qc(72),jg.qc(73),jg.qc(74),jg.qc(75),jg.qc(76),jg.qc(77),jg.qc(78),jg.qc(79),jg.qc(80),jg.qc(81),jg.qc(82),jg.qc(83),jg.qc(84),jg.qc(85),jg.qc(86),jg.qc(87),jg.qc(88),jg.qc(89),jg.qc(90),jg.qc(91),jg.qc(92),jg.qc(93),jg.qc(94),jg.qc(95),jg.qc(96),jg.qc(97),jg.qc(98),jg.qc(99),jg.qc(100),
jg.qc(101),jg.qc(102),jg.qc(103),jg.qc(104),jg.qc(105),jg.qc(106),jg.qc(107),jg.qc(108),jg.qc(109),jg.qc(110),jg.qc(111),jg.qc(112),jg.qc(113),jg.qc(114),jg.qc(115),jg.qc(116),jg.qc(117),jg.qc(118),jg.qc(119),jg.qc(120),jg.qc(121),jg.qc(122),jg.qc(124),jg.qc(126),jg.qc(127),jg.qc(128),jg.qc(129),jg.qc(130),jg.qc(131),jg.qc(132),jg.qc(133),jg.qc(134),jg.qc(135),jg.qc(136),jg.qc(140),jg.qc(145),jg.qc(146),jg.qc(147));return jg.iud}static qc(b){jg.iud.add(b&1023)}}jg.iud=null;Object(m.a)(jg,"LanguagePerParagraphModel",
null,[]);class ZK{constructor(){this.Jag=!1;this.ZBd=this.YBd=this.nQb=0;this.Pyi=!0;this.t_o=0}}Object(m.a)(ZK,"UpdateWordCountStateResult",null,[]);class $K extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(m.a)($K,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class aL{constructor(){this.Iyh=this.Hyh=this.wordCount=-1;this.uBb=this.muh=0;this.tBb=1;this.AUi=1033}}Object(m.a)(aL,"WordCountCache",null,[]);class bL extends Sys.EventArgs{constructor(b){super();this.state=
b}}Object(m.a)(bL,"WordCountChangedEventArg",Sys.EventArgs,[]);class cL{constructor(){this.amc=this.hCa=0}}Object(m.a)(cL,"CharsCountResult",null,[]);class dL{constructor(){this.cp=0;this.cmc=null;this.W6=this.X6=0}}Object(m.a)(dL,"TextChunkResult",null,[]);class eL{constructor(){this.xEj=this.X6=this.W6=this.wordCount=0}}Object(m.a)(eL,"WordCountStateForParagraph",null,[]);class mH{constructor(){this.bqa=this.BQ=this.X6=this.W6=this.X_=this.wordCount=0;this.currentNode=null;this.QW=-1;this.cp=0;
this.TVf=[];this.tBb=this.uBb=this.IYa=this.OVf=this.PVf=0;this.QH=this.hti=!1;this.Kpb=new Mb.a;this.T2a=new Mb.a}}Object(m.a)(mH,"WordCountState",null,[]);class yr{constructor(b,h,t,A,O,aa){this.zuo=1E3;this.ra=new If.a;this.Kxb=null;this.Zpe=0;this.MXj="\ue000";this.Mqc=!1;this.pve=this.eve=this.zfd=0;this.sNg=this.ANg=null;this.ave=this.$ue=this.jve=0;this.Jil=ua=>{this.Kxb=null;this.qdf(ua.customData)};this.rF=h;this.$Vj=new RegExp(Tb.AParagraphNode.jC,"g");this.Ad=b;this.taskManager=A;this.xn=
t;this.YXa=aa;this.zVa=O.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.tbk=O.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.k8i()}get lNm(){return!!this.Kxb}get xNa(){return this.Mqc}set xNa(b){this.Mqc=b}get txd(){return this.Zpe}set txd(b){this.Zpe=b}get VPa(){return!this.Zpe}get Qz(){return this.zfd}get CAb(){return this.eve}get GAb(){return this.pve}get g$k(){return this.ANg}get V$e(){return this.sNg}get BHc(){return this.jve}get yHc(){return this.$ue}get d3b(){return this.ave}x_b(b){this.ra.addHandler(yr.mne,
b)}W2f(b){this.ra.removeHandler(yr.mne,b)}AYe(b){this.ra.addHandler(yr.Mlg,b)}PVn(b){this.ra.removeHandler(yr.Mlg,b)}YGd(){this.XGd();this.k8i()}k8i(){this.jve=this.ave=this.$ue=this.pve=this.eve=this.zfd=-1}dbf(){this.$he(this.zuo)}K7c(){const b=new mH;b.hti=!0;this.XGd();this.qdf(b)}$he(b,h=null){this.VPa&&(this.lNm&&(h=null,this.XGd()),h||(h=new mH),b=new Vb.a(3,1,b,this.Jil,this.Crj),b.customData=h,this.npk(b))}XGd(){this.Kxb&&(this.taskManager.Se(this.Kxb),this.Kxb=null)}BBj(b,h,t,A,O,aa=!0,
ua=-1,Ra=-1,ub=-1,Nb=1033){const Yb=new ZK;Yb.nQb=t;Yb.YBd=O;Yb.ZBd=A;if(!b.cp&&h.Had&&aa&&!this.Xai(h))return yr.lSo(b,h.Had),Yb.Pyi=!0,Yb;A=0<=Ra&&0<=ub?{rd:Ra,endCp:ub}:void 0;t=this.PDl(h,A);A&&(Ra=A.rd,ub=A.endCp);t=0<=ub?t.substring(0,ub):t;ub=0<=Ra&&0<=ub?t.substring(Ra,ub):t;A=b.cp>=Ra?b.cp:Ra;O=b.TVf||[];aa=0<b.PVf?b.PVf:0;let bc=0<b.OVf?b.OVf:0,Dc=[];b.QH=!1;do{this.YXa.update();if(!b.hti&&(Yb.nQb+Dc.length/2>yr.AXo||this.YXa.zkb())){let Cd;O=(Cd=O).concat.apply(Cd,Dc);b.cp=A;b.TVf=O;b.OVf=
bc;b.PVf=aa;b.QW=ua;b.currentNode=h;this.$he(yr.U_o,b);Yb.Jag=!0;b.QH=!0;return Yb}if((!A||A===Ra)&&0<t.length&&A<t.length){O.push(Dq.a.instance.Asf(t,A));var Pc=this.Xai(h);if(0<=ua&&!A&&Pc){b.wordCount+=1;Yb.nQb+=1;const Cd=this.Ad.BT(Pc);Pc=this.rF.uYc(Cd,Pc);Pc=yr.XEd(Pc);b.X6+=Pc.hCa+1;b.W6+=Pc.hCa-Pc.amc}}Pc=this.vfi(t,A,yr.aQk);A=Pc.cp;let jd;Dc=(jd=Dc).concat.apply(jd,Pc.cmc);aa+=Pc.X6;bc+=Pc.W6}while(-1!==A);b=this.Tik(b,O,Dc,t,ub,Yb.nQb,Yb.YBd,Yb.ZBd,h,-1===ua,Nb);Yb.nQb=b.wordCount;Yb.YBd=
b.W6;Yb.ZBd=b.X6;Yb.t_o=b.xEj;return Yb}gPh(b,h){const t=qe.ParagraphReader.textLength(h,9);if(t){h=zc.e(h);var A=0;for(let O=0;O<h.length;O++)if(this.Qhb&&5===h[O].zh&&b.BQ++,yr.Bjo(h[O])){A++;break}h.length!==t?b.X_++:b.X_+=A}}tjj(b){this.txd=this.$jo(b.IYa,b.wordCount)?1:0;return!!this.txd}eSi(b){this.zfd=b.wordCount;this.eve=b.BQ;this.pve=b.bqa;this.ave=b.X6;this.$ue=b.W6;this.jve=b.X_;this.ANg=b.Kpb;this.sNg=b.T2a;this.n0i(b)}n0i(b){this.ra.raiseEvent(yr.mne,new bL(b))}m0i(){this.ra.raiseEvent(yr.Mlg,
new $K(!1))}$jo(b,h){if(ba.a.jt||ba.a.Rt||ba.a.wH)return!1;(h/=2)||(h=1);return(h?b/h:0)>yr.g5m?!0:!1}get Qhb(){const b=!this.zJf||1===this.zJf&&this.tbk;return this.zVa&&b}C8h(b,h){let t=1033,A=0;b=h.Tof(b);h=new jg;for(let O=0;O<b.length;O++){const aa=h.Qkk(b[O].lcid,b[O].end-b[O].begin);A<aa&&(A=aa,t=b[O].lcid)}return t}Tik(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){var bc;h=(bc=h).concat.apply(bc,t);t=Dq.a.instance.wfi(h,A);b.wordCount+=t.wordCount;O=yr.XEd(O);bc=O.hCa-O.amc;const Dc=O.hCa;b.W6+=bc;b.X6+=Dc;
aa+=t.wordCount;ua+=O.hCa-O.amc;Ra+=O.hCa;b.IYa+=t.IYa;const {Hkl:Pc,SDo:jd}=yr.Sik(h,A);b.uBb+=Pc;b.tBb+=jd;b.T2a.add(Yb);b.Kpb.add(t.wordCount);Nb&&yr.dJk(Dc,bc,ub,t,Pc,jd,Yb);b.cp=0;b.TVf=[];b=new eL;b.W6=ua;b.X6=Ra;b.wordCount=aa;b.xEj=t.wordCount;return b}PDl(b,h){let t=this.wXn(b);t=qe.ParagraphReader.Mfb(b,9,t,h);return this.NSn(t)}wXn(b){var h=qe.ParagraphReader.text(b);b=zc.e(b);if(0<b.length){h=h.split("");for(let A=0;A<b.length;++A){let O=!0;var t=!0;const aa=b[A];if(1===aa.zh)t=aa,t=22!==
t.kind&&2!==t.kind;else if(5===aa.zh)O=!1;else if(7===aa.zh||10===aa.zh)h[aa.Kb.cp]=this.MXj,O=!1;if(O){if(aa.Kb.cp>=h.length)return"";h[aa.Kb.cp]=t?" ":"C"}}h=h.join("")}return h}NSn(b){return b.replace(this.$Vj,"")}vfi(b,h,t){const A=b.length-h<=t;var O=A?b.length:h+t;const aa=new dL;if(O<h)return aa.cp=-1,aa;aa.cmc=Dq.a.instance.Alf(b,h,O);O=yr.XEd(b.substr(h,O));aa.X6=O.hCa;aa.W6=O.hCa-O.amc;if(!aa.cmc.length&&!A)return t===b.length-h?aa:this.vfi(b,h,b.length-h);aa.cp=A||!aa.cmc.length?-1:aa.cmc[aa.cmc.length-
1].cp;return aa}npk(b){this.Kxb=b;this.taskManager.Wb(this.Kxb)}Xai(b){if(b=b.aT){const h=this.Ad.BT(b);if(h&&h.Zy)return b}return null}static Bjo(b){return 11===b.zh}static lSo(b,h){b.wordCount+=h.wordCount;b.W6+=h.Hyh;b.X6+=h.Iyh;b.IYa+=h.muh;b.uBb+=h.uBb;b.tBb+=h.tBb;b.T2a.add(h.AUi);b.Kpb.add(h.wordCount)}static dJk(b,h,t,A,O,aa,ua){const Ra=new aL;Ra.wordCount=A.wordCount;Ra.Iyh=b;Ra.Hyh=h;Ra.muh=A.IYa;Ra.uBb=O;Ra.tBb=aa;Ra.AUi=ua;t.Had=Ra}static XEd(b){const h=b.length,t=new cL;for(let O=0;O<
h;O++){var A=b.charCodeAt(O);t.hCa++;if(55296<=A&&56319>=A&&(A=O+1<h?b.charCodeAt(O+1):0,56320<=A&&57343>=A)){O++;continue}F.a.sba(b.charAt(O))&&t.amc++}return t}static Sik(b,h){let t=0,A=0;for(let O=0;O<b.length;++O){const aa=b[O],ua=aa.hL;(3===ua||2===ua)&&aa.cp<h.length&&(++t,F.a.e$b(h.charCodeAt(aa.cp))&&++A)}return{Hkl:A,SDo:t}}}yr.mne="wctek";yr.Mlg="wcac";yr.U_o=1;yr.aQk=400;yr.AXo=90;yr.g5m=.1;Object(m.a)(yr,"WordCountManagerBase",null,[456]);class fL extends yr{constructor(b,h,t,A,O,aa,ua,
Ra,ub,Nb,Yb){super(b,h,t,O,ub,Nb);this.sYh=this.yud=this.tka=null;this.Foa=()=>{this.dbf()};this.ib=A;this.nd=ua;this.xeh=Ra;this.fI=Yb;this.ib.gx(this.Foa);this.nEe=ub.$("ReadingTimeIsEnabled")}get Crj(){return 66}Qrm(){if(this.tka)return!0;if(!this.ib||!this.ib.hb)return this.nd&&(Jb.App.fWd||v.AFrameworkApplication.Rk?this.nd.Zb("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.nd.Zb("SelectionWordCountSelectionNullWhenAppAlive")),
!1;const b=this.ib.hb.clone();this.tka=b.NN(!0);if(!this.tka||!this.tka.tA())return this.XGd(),!1;this.xeh&&(this.yud=this.xeh.create(h=>b.NN(h),this.xn));this.tka.moveNext();return!0}get zJf(){return 1}BZk(b){return b===mc.a.Fd||b===mc.a.paragraph?!0:this.Qhb&&(b===mc.a.jCb||b===mc.a.image||b===mc.a.anchoredObject)}qdf(b){this.YXa.reset();if(this.Qrm()){for(this.Qhb&&this.yud&&(this.yud.Eil(b,this.YXa)||this.$he(1,b));this.tka.current;){const A=-1===b.QW?0:b.QW;let O=0;var h=this.tka.current;if(!this.BZk(h.contextId)){this.tka.moveNext();
continue}if(this.Qhb&&Be.ImageReader.O1a(h)){b.BQ++;this.tka.moveNext();continue}if(!qe.ParagraphReader.Yb(h.node)){this.tka.moveNext();continue}const aa=h.node;if(this.xNa&&this.sYh&&this.sYh.t6b(aa))this.tka.moveNext();else{if(this.Qhb&&h.isValid){var t=ue.GraphIterator.$a(aa);for(t.Tb(6);!t.Dr;)Be.ImageReader.Wu(t.currentNode)&&b.BQ++,t.Ti(6)}t=this.nEe?this.C8h(aa,this.fI):1033;h=this.BBj(b,aa,0,0,0,this.bXd(h),A,h.cpBegin,h.cpEnd,t);if(h.Pyi&&(O+=1,100<O)){b.QW=A+1;this.$he(1,b);return}if(h.Jag)return;
this.gPh(b,aa);this.tka.moveNext()}}this.yud=this.tka=null;this.tjj(b)?(this.zfd=-1,this.m0i()):this.eSi(b)}}bXd(b){let h=!1;b.contextId===mc.a.paragraph?h=!0:b.contextId===mc.a.Fd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);return h}}Object(m.a)(fL,"SelectionWordCountManager",yr,[]);class nG{constructor(b,h){this.LUb=!1;this.Wwb=null;b&&h&&(this.IYb=b(!1),this.Xc=h,this.IYb.moveNext())}Eil(b,h){if(!b||!this.IYb||!this.IYb.current)return!0;do{const t=this.IYb.current;if(t.contextId===mc.a.tableRow||
t.contextId===mc.a.tableCell){for(this.Wwb||this.Zrm(t.node);this.Wwb.moveNext();)if(14===this.Wwb.currentNode.type&&b.bqa++,h.update(),h.zkb())return!1;this.W0k(t,b);this.Wwb=null}this.IYb.moveNext()}while(this.IYb.current);return!0}W0k(b,h){const t=this.Xc.Wf(b.node);t.Ab(14);b.contextId===mc.a.tableRow&&(vp.a.Usi(t)&&(this.LUb=!0),vp.a.FXd(t)&&this.LUb&&(this.LUb=!1,h.bqa++));b.contextId===mc.a.tableCell&&(Gh.TableCellReader.DSc(t)&&(this.LUb=!0),Gh.TableCellReader.CPa(t)&&this.LUb&&(this.LUb=
!1,h.bqa++))}Zrm(b){this.Wwb=Qd.a.So(b);14===b.type?this.Wwb.Sn(nG.CKc,b):this.Wwb.Sn(nG.CKc,null)}static CKc(b){return b.parentNode?!0:!1}}Object(m.a)(nG,"TableCountSelectionTraverser",null,[457]);class gL{constructor(b){this.zVa=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,h){return this.zVa?new nG(b,h):null}}Object(m.a)(gL,"TableCountSelectionTraverserFactory",null,[438]);class hL extends yr{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb,Yb){super(b,h,t,O,ub,Nb);this.CXo=bc=>{if(bc.Dr)return!0;
bc=bc.role;return 1===bc||2===bc||this.Qhb&&6===bc||3===bc||4===bc||5===bc||!this.xNa&&(7===bc||8===bc)};this.ga=A;this.u8j=aa;this.egk=ua;this.aNg=Ra;this.fI=Yb;this.ga.gb(Vc.a.vEj,mc.a.application,Kf.ActionManager.Kf,64);this.ga.gb(Vc.a.wEj,mc.a.application,Kf.ActionManager.Kf,64);this.nEe=ub.$("ReadingTimeIsEnabled")}get Crj(){return 63}get zJf(){return 0}qdf(b){this.YXa.reset();b.QH=!1;var h=this.u8j();Lk.PageReader.instance.yGb(h)||(this.YGd(),this.m0i());h=this.xn.KDa(h,7,7).currentNode;var t=
this.A4k(b.currentNode,h);h=this.egk(t,h);h.Sn(this.CXo,null);let A=t=0;for(var O=0;h.moveNext();)if(h.currentNode&&this.Ad.k8(h.currentNode)){var aa=this.Ad.BT(h.currentNode);if(aa.Zy){var ua=this.Ad.v0a(h.currentNode);if(ua&&(ua=ua.qa.last,(null===ua||void 0===ua?0:ua.Rh)&&(vm.App.nR&&ua.gi||ua.KQ)))continue;b.wordCount+=1;if(aa=this.rF.uYc(aa,h.currentNode))aa=yr.XEd(aa),b.X6+=aa.hCa+1,b.W6+=aa.hCa-aa.amc;t+=1;A+=b.X6;O+=b.W6}}else if(this.Qhb&&h.currentNode&&Be.ImageReader.Wu(h.currentNode))b.BQ++;
else if(this.Qhb&&h.currentNode&&ni.TableReader.QX(h.currentNode))b.bqa++;else if(h.currentNode&&qe.ParagraphReader.Yb(h.currentNode)){aa=h.currentNode;ua=this.nEe?this.C8h(aa,this.fI):1033;O=this.BBj(b,aa,t,A,O,!0,-1,-1,-1,ua);if(O.Jag){b.QH=!0;v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");return}this.gPh(b,aa);t=O.nQb;A=O.ZBd;O=O.YBd}this.tjj(b)?(this.YGd(),this.nYn(),this.n0i(b)):this.eSi(b)}A4k(b,h){b?(b=this.aNg(b),
b.Ab(7)):b=this.aNg(h);return b}nYn(){switch(this.txd){case 1:this.ga.processAction(Vc.a.vEj,2);break;case 2:this.ga.processAction(Vc.a.wEj,2)}}}Object(m.a)(hL,"TotalWordCountManager",yr,[]);class iL{constructor(){this.pcj=this.ocj=this.T6f=this.qcj=this.Ktj=this.Ltj=this.Itj=this.Jtj=0}get vLi(){return this.K6b(this.qcj,this.Ltj,"WC")}get fcn(){return this.K6b(this.ocj,this.Itj,"NumCharsNoSp")}get gcn(){return this.K6b(this.T6f,this.Jtj,"NumCharsWithSp")}get lcn(){return this.K6b(this.pcj,this.Ktj,
"NumParagraphs")}K6b(b,h,t){const A=this.lad(h,t).toLocaleString();return 0<this.T6f?(b=this.Okg(b,h,t),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),A)):A}Okg(b,h,t){b=this.lad(b,t);return b>h?(u.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",t),h):b}lad(b,h){0>b&&u.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,0)}}Object(m.a)(iL,"DocumentStats",null,[]);class oG{static a9e(b){return Pf.a.Xz(oG.Hm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,
b.vLi,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.fcn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.gcn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.lcn)}}oG.Hm="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(m.a)(oG,"DocumentStatsDialogHtml",null,[]);class jL extends Pf.a{constructor(b){super();this.YR=!1;this.njl=()=>{};this.vF=b}xoo(){this.sg="DocumentStatsDialog";this.Wg=oG.a9e(this.vF);this.zd=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.njl);this.s4("DocumentStatsTable")}E8(){}dispose(){this.YR||(super.dispose(),this.YR=!0)}}Object(m.a)(jL,"DocumentStatsDialog",Pf.a,[]);class kL{constructor(b,h,t,A,O,aa,ua,Ra,ub){this.Ddh=this.Jsc=this.Mqc=this.KUb=this.nFe=
!1;this.cec=()=>{this.pme()};this.Ioa=()=>{this.pme()};this.ogo=()=>{this.Ddh=!0;return 32};this.u_f=()=>this.Rr.VPa?32:8;this.F1c=(Nb,Yb,bc,Dc,Pc)=>{if(1===bc)return this.Rr.VPa?32:8;Pc[Ng.a.On]=this.PEf;return 32};this.$je=(Nb,Yb,bc)=>{if(1===bc)return this.Rr.VPa?32:8;this.PEf?this.pgl():this.Eml();Jb.App.ya.CG({ShowWordCount:"CheckboxModel"});return 32};this.Pic=(Nb,Yb,bc)=>{if(1===bc)return Po.a.vga(Yb)?8:this.Rr.VPa?32:8;if(this.Ddh)return v.AFrameworkApplication.xa.processAction(Vc.a.U6d,2),
32;Nb=this.ge.eg("UserAction","Show Word Count Dialog");Nb.start();this.Rr.K7c();this.BP.K7c();this.Rr.Qz!==this.BP.Qz?u.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):u.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Yb=this.X2k();(new jL(Yb)).xoo();Nb.stop();return 32};this.V0c=(Nb,Yb,bc,Dc,Pc)=>{Pc||u.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===bc)return 32;if(!this.Rr.VPa)return Pc[Ck.a.Visible]=
!1,32;Pc[Ck.a.Visible]=!0;this.PEf?(Nb=this.Rr.Qz,0>Nb?Nb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Nb?(Yb=this.BP?this.BP.Qz:-1,Nb=0<Yb?this.e5l(Nb,Yb):String.format(1===Nb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.ide(Nb))):Nb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.ide(Nb))):Nb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Pc[Ck.a.LabelText]=Nb;return 32};
this.Iue=ua;this.Jue=aa;this.Rr=b;this.BP=h;this.tAc=t;this.Vdk=O;this.BP.AYe(this.cec);this.Rr.AYe(this.cec);this.BP.x_b(this.Ioa);this.Rr.x_b(this.Ioa);this.ge=Ra;this.xNa=A;this.zVa=ub.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get Taf(){return!ba.a.A3}Ub(){const b=v.AFrameworkApplication.xa;b.pa(Vc.a.$je,mc.a.application,this.$je);b.pa(Vc.a.Pic,mc.a.view,this.Pic);b.gb(Vc.a.F1c,mc.a.application,this.F1c,96);b.gb(Vc.a.V0c,mc.a.application,this.V0c,96);b.gb(Vc.a.u_f,mc.a.application,
this.u_f,96);b.pa(Vc.a.BRh,mc.a.application,this.ogo)}get xNa(){return this.Mqc}set xNa(b){this.Mqc=b;this.Rr.xNa=b;this.BP.xNa=b}Eml(){this.Rr.VPa&&(this.gij(!0),this.pme(),this.Rr.K7c())}X2k(){const b=new iL;b.Ltj=this.Rr.Qz;b.Jtj=this.Rr.d3b;b.Itj=this.Rr.yHc;b.Ktj=this.Rr.BHc;b.qcj=this.BP.Qz;b.ocj=this.BP.yHc;b.T6f=this.BP.d3b;b.pcj=this.BP.BHc;return b}MNl(){return this.Iue("WACWordCountEnabled",this.Taf)}xee(b){this.Jue("WACWordCountEnabled",b?"true":"false",dc.a.AQa)}get PEf(){this.KUb||(this.nFe=
this.MNl(),this.KUb=!0);return this.nFe}gij(b){this.xee(b);this.nFe=b;this.KUb=!0}pgl(){this.Rr.YGd();this.BP.YGd();this.gij(!1);this.pme()}get tJ(){return null!=this.pDg?this.pDg:this.pDg=(()=>this.tAc())()}pme(){this.Jsc||(u.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.U8k()),this.Jsc=!0);this.tJ&&this.tJ.yU(this.Vdk)}U8k(){const b={["words"]:this.Rr.Qz,["charsWithSpaces"]:this.Rr.d3b,["charsWithNoSpaces"]:this.Rr.yHc,["paragraphs"]:this.Rr.BHc};this.zVa&&(b.images=this.Rr.CAb,
b.tables=this.Rr.GAb);return b}ide(b){try{return b.toLocaleString()}catch(h){u.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}e5l(b,h){h>b&&(u.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.ide(h),this.ide(b))}}Object(m.a)(kL,"WordCountActor",
null,[]);class lL extends Yp.a{constructor(b,h,t,A){super();this.W3=(O,aa)=>{if(aa.property===Af.a.yo||aa.property===Af.a.En)O=aa.node,aa=vm.App.Hn.jb.xc,aa.Qt&&aa.Zc&&aa.Zc.Mc&&O.Mc&&O.Mc.id===aa.Zc.Mc.id&&this.LSh(O)};this.CPi=(O,aa)=>{this.LSh(aa.node)};this.qkn=(O,aa)=>{aa.property!==Gd.a.lA&&aa.property!==Lc.a.Vt||this.eY()};this.Y4d=()=>{this.eY()};this.G1=b;this.Rr=h;this.eq=t;this.zVa=A.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}gz(){var b=this.eq.af(12);b.Ro(this.W3);b.ku(this.CPi);
b.Lv(this.CPi);b=this.eq.af(22);b.Ro(this.qkn);b.ku(this.Y4d);b.Lv(this.Y4d);this.zVa&&this.CPn();this.G1.Cpa(this,7)}CPn(){var b=[19,14];for(const h of b)b=this.eq.af(h),b.ku(this.Y4d),b.Lv(this.Y4d)}get index(){return 1}run(){this.Rr.dbf()}LSh(b){b.Had=null;this.eY()}}Object(m.a)(lL,"WordCountAppEventCoordinator",Yp.a,[]);class nH{}nH.Uik="AccurateWordCountButton";Object(m.a)(nH,"WordCountConstants",null,[]);class mL{constructor(b,h){this.Rr=b;this.BP=h}getInstance(b){switch(b){case 1:return this.BP;
case 0:return this.Rr;default:return this.Rr}}}Object(m.a)(mL,"WordCountManagerFactory",null,[112]);class oH{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}yc(b){this.W=b;const h=this.W.resolve("Common.IAppSettingsManager");this.W.ha("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new gL(h)).singleInstance();this.W.ha("WordEditor.WordCount.IWordCountManagerFactory",()=>{var t=new Io.a(10,ff.a.Ue);const A=new hL(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),
new ok.a,v.AFrameworkApplication.xa,v.AFrameworkApplication.oc,()=>vm.App.Hn.jb.xc.Zc,Qd.a.at,ue.GraphIterator.$a,h,t,Sa.a.instance.resolve("Box4.ILanguageReader"));t=new fL(Sa.a.instance.resolve("Box4.List.IListReader"),Sa.a.instance.resolve("Box4.IListMarkerUtility"),new ok.a,he.a.instance,v.AFrameworkApplication.oc,Iy.a.instance,zk.a.instance,Sa.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,t,Sa.a.instance.resolve("Box4.ILanguageReader"));return new mL(A,t)}).singleInstance();
this.W.ha("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new YK(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").singleInstance()}init(){const b=Jb.App.ya.jb;b.Sva?this.pia():b.sea(()=>{this.pia()})}pia(){if(Jb.App.jk){var b=Jb.App.jk.Kl;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),t=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
A=Sa.a.instance.resolve("Common.IAppSettingsManager");(new kL(h,t,()=>Sa.a.instance.Ma("WordEditor.IStatusBarUser"),this.QMl(),nH.Uik,dc.a.ASa,dc.a.Jfa,Sa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),A)).Ub();(new lL(Ar.GraphTransactionManager.instance,h,b,A)).gz();h.dbf()}else u.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else u.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}QMl(){var b=
vm.App.Hn.jb;if(!b)return u.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.xc;if(!b)return u.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.Zc;return b?b.ia(Lc.a.xNa,!1):(u.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){P.a.instance.Gc(new oH)}}Object(m.a)(oH,"PackageManager",null,[1,2]);var nL=c(2002);class oL{constructor(b){this.$Oe=null;b.Sa("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.$Oe=h})}Cej(b){this.$Oe&&this.$Oe.sof().handleDocumentContentAugloopAnnotation(b)}}
Object(m.a)(oL,"DocumentContentExtractionManager",null,[351]);class $h{}$h.gso="mso_smartLookup";$h.channelId="SmartLookup";$h.fso="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";$h.unj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";$h.vnj="https://uci.cdn.office.net/mirrored/smartlookup/";$h.eso="https://hedwigtestserver.blob.core.windows.net/builds/";$h.dso="http://localhost:8080/";$h.l7c="current";$h.tnj="next";$h.Esn=2;$h.qec=1;$h.rec=CommonUIStrings.L_SmartLookupPaneTitle;
$h.BB="InsightsTaskPane";$h.Weg="InsightsTaskPaneData";$h.awf="InsightsContentFrame";$h.width=400;$h.H7m="ApplicationPropertiesRequest";$h.U7m="SelectionRequest";$h.O7m="PageRendered";$h.G7m="ApplicationProperties";$h.T7m="Selection";$h.W7m="Telemetry";$h.V7m="TakeFocus";$h.N7m="LostFocus";$h.K7m="Keyboard";$h.L7m="LegalAgreed";$h.r_o="WordWac";$h.spn="OneNoteWAC";$h.qVf="yes";$h.Nrj="appCorrelationId";$h.CAo="clientCorrelationId";$h.Orj="message";$h.qBi="Microsoft::Office::Insights::LegalAgreed";
Object(m.a)($h,"InsightsConstants",null,[]);var kF=c(1599);class sE{}Object(m.a)(sE,"ActivityContractInfo",null,[]);class hu{}Object(m.a)(hu,"BrowserPaneDataField",null,[]);class tE{}Object(m.a)(tE,"BrowserPaneTelemetryEvent",null,[]);class km{static iz(b,h){const t=new tE;t.eventName="Diagnostics";t.isActivity=!1;t.activityContract=Object.assign(new sE,{success:!0});const A=[],O=new hu;O.name="Message";O.dataType=0;O.value=b;b=new hu;b.name="Level";b.dataType=0;b.value=km.getLevelString(h);Array.add(A,
O);Array.add(A,b);t.dataFields=A;km.sendTelemetryEvent(t)}static Hcj(b,h){const t=new tE;t.eventName=b;t.isActivity=!1;t.activityContract=Object.assign(new sE,{success:!0});b=[];const A=new hu;A.name="AppCorrelationId";A.dataType=0;A.value=h;Array.add(b,A);t.dataFields=b;km.sendTelemetryEvent(t)}static B7n(b,h,t,A,O,aa){const ua=new tE;ua.eventName="LaunchPaneWithError";ua.isActivity=!1;ua.activityContract=Object.assign(new sE,{success:!0});const Ra=[],ub=new hu;ub.name="IsNetworkConnected";ub.dataType=
0;ub.value=b?"true":"false";b=new hu;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new hu;h.name="EntryPoint";h.dataType=0;h.value=t;t=new hu;t.name="RuntimeVersion";t.dataType=0;t.value=A;A=new hu;A.name="IsFirstRelease";A.dataType=1;A.value=O?"true":"false";O=new hu;O.name="IsZeroTerm";O.dataType=1;O.value=aa?"true":"false";aa=new hu;aa.name="IsClientSideRendering";aa.dataType=1;aa.value="false";Array.add(Ra,ub);Array.add(Ra,h);Array.add(Ra,b);Array.add(Ra,t);Array.add(Ra,
A);Array.add(Ra,O);Array.add(Ra,aa);ua.dataFields=Ra;km.sendTelemetryEvent(ua)}static W6f(b,h,t){const A=new tE;A.eventName="CDNDownloadLatency";A.isActivity=!0;A.activityContract=Object.assign(new sE,{duration:t,success:!0});t=[];const O=new hu;O.name="CDNHostname";O.dataType=0;O.value=b;b=new hu;b.name="Filename";b.dataType=0;b.value=h;Array.add(t,O);Array.add(t,b);A.dataFields=t;km.sendTelemetryEvent(A,1)}static khc(b,h,t,A,O,aa,ua,Ra){const ub=new tE;ub.eventName="LaunchPane";ub.isActivity=!0;
ub.activityContract=Object.assign(new sE,{duration:h,success:!0});h=[];const Nb=new hu;Nb.name="AppCorrelationId";Nb.dataType=0;Nb.value=b;b=new hu;b.name="EntryPoint";b.dataType=0;b.value=t;t=new hu;t.name="IsServerSideRendering";t.dataType=1;t.value="true";const Yb=new hu;Yb.name="UxVersion";Yb.dataType=0;Yb.value=A;A=new hu;A.name="FeatureGates";A.dataType=0;A.value=O;O=new hu;O.name="IsFirstRelease";O.dataType=1;O.value=aa?"true":"false";aa=new hu;aa.name="IsZeroTerm";aa.dataType=1;aa.value=ua?
"true":"false";ua=new hu;ua.name="IsClientSideRendering";ua.dataType=1;ua.value=Ra?"true":"false";Array.add(h,Nb);Array.add(h,b);Array.add(h,t);Array.add(h,Yb);Array.add(h,A);Array.add(h,O);Array.add(h,aa);Array.add(h,ua);ub.dataFields=h;km.sendTelemetryEvent(ub)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)km.wXm(b.eventName);else{var t=-1<b.eventName.indexOf(km.Mrj)?b.eventName:km.Mrj+b.eventName,A=km.QLl(b.dataFields);b.isActivity?(b=Object.assign(new yk.a,{name:t,samplingPolicy:h,
dataFields:A,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),ja.a.sendActivityEvent(b)):(b=Object.assign(new ta.a,{name:t,samplingPolicy:h,dataFields:A}),ja.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static QLl(b){const h=[];if(b&&0<b.length)for(const t of b)(b=uh.a.Nfa(t.name,t.value,km.Y_k(t.dataType)))&&Array.add(h,b);return h}static Y_k(b){switch(b){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static wXm(b){const h=Sa.a.instance.Ma("Common.ISystemInitiatedFeedback");h?h.logActivity(b,null):u.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}km.Mrj="Office.Insights.SmartLookup.";Object(m.a)(km,"TelemetryUtils",null,[]);var uE;(function(b){b[b.other=0]="other";b[b.searchBoxSearch=1]="searchBoxSearch";b[b.searchBoxDictionary=2]="searchBoxDictionary";b[b.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";b[b.smartLookupRibbon=
4]="smartLookupRibbon";b[b.smartLookupContextMenu=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.dictionary=7]="dictionary";b[b.web=8]="web";b[b.pictures=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.help=12]="help";b[b.chartRecommendation=13]="chartRecommendation";b[b.linkSkill=14]="linkSkill";b[b.searchBoxFindInDocument=15]="searchBoxFindInDocument";b[b.searchBoxEntity=16]="searchBoxEntity";b[b.searchSkill=17]="searchSkill";b[b.controlF=18]="controlF";b[b.ribbonFindButton=
19]="ribbonFindButton";b[b.reuseSlides=20]="reuseSlides";b[b.data=21]="data";b[b.contextMenuDictionary=22]="contextMenuDictionary";b[b.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";b[b.contextMenuSynonyms=24]="contextMenuSynonyms";b[b.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";b[b.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";b[b.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";b[b.note=28]="note";b[b.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";
b[b.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";b[b.dataDisambiguate=31]="dataDisambiguate";b[b.linkFiles=32]="linkFiles";b[b.searchBoxNoteL2=33]="searchBoxNoteL2";b[b.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";b[b.actionAI=35]="actionAI";b[b.pasteAsNewSlide=36]="pasteAsNewSlide";b[b.slidesCompression=37]="slidesCompression";b[b.searchBoxGenerateDeck=38]="searchBoxGenerateDeck";b[b.powerPointCopilot=39]="powerPointCopilot";b[b.tellMeService=40]="tellMeService";
b[b.prefetch=99]="prefetch"})(uE||(uE={}));Object(m.b)("EntryPoint",uE);var iu=c(1530),Ax=c(1543);class Bv{static CX(b,h,t,A,O,aa){if(1===t)return fc.SessionStatusManager.instance.vH?32:8;if(O.value.Zmo())return km.iz("Skipping Serplet launch",10),32;h=aa;if(!h)return 8;b=Bv.ECb();if(t=h.CommandValueId)try{h=E.a(t)}catch(ua){return u.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",t),8}t=h;h.selection||(h.neighborhood?t=Object.assign(new iu.a,{selection:h}):
(h=O.value.qDb(),t.selection=Object.assign(new Ax.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));t.selection.clientDetectedLanguage=O.value.S6h();return Bv.S4b(aa,null,t,b,0,O)}static S4b(b,h,t,A,O,aa){const ua={};ua.controlId=b?b.SourceControlId:"shortcut";t&&(ua.entryPoint=uE[t.entryPoint]);u.ULS.sendTraceTag(594044172,1303,50,Bv.uT("Show insights",A,ua));h?aa.value.qpo(h,A,O):t&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",
!1)?aa.value.Mno(t,A):aa.value.rpo(t,A,O));return 32}static uT(b,h,t=null){b={["appCorrelationId"]:h,["message"]:b};if(t)for(let A in t)b[A]=t[A];return E.c(b)}static ECb(){return Ya.a.create().toString()}}Object(m.a)(Bv,"InvokingPaneUtils",null,[]);class pL{}Object(m.a)(pL,"LaunchDataInDoc",null,[]);class qL{}Object(m.a)(qL,"LaunchDataPasteAsSlide",null,[]);class rL{}Object(m.a)(rL,"LaunchDataSlidesCompression",null,[]);var Eu=c(1519);class pH{constructor(b,h,t,A,O,aa,ua,Ra,ub){this.Pqc=this.ajd=
this.mw=null;this.RB=b;this.ga=h||v.AFrameworkApplication.xa;this.Zo=t;this.Vb=A;this.xZg=Ra;this.Gwc=O;this.Na=aa;this.Gb=ua;this.Vqm();this.tVa=new Pg.a(()=>new mn.a(ub.value,Object(z.a)(this,this.BDb,"getMoreInfoEventReceived")))}Ub(){this.ga.pa(ab.a.Zum,yc.a.frame,Object(z.a)(this,this.opo,"showInsights"));this.ga.pa(ab.a.$um,yc.a.frame,Object(z.a)(this,this.ppo,"showInsightsForTellMe"));this.ga.pa(ab.a.definitions,yc.a.frame,Object(z.a)(this,this.noo,"showDefinitions"));this.ga.pa(ab.a.abf,yc.a.frame,
Object(z.a)(this,this.ooo,"showDefinitionsForTellMe"));this.ga.pa(ab.a.hbg,yc.a.frame,Object(z.a)(this,this.hbg,"showInsightsForSuggestion"));this.xZg&&(this.ga.pa(ab.a.Z7,yc.a.frame,Object(z.a)(this,this.CX,"invokeSmartLookupPane")),this.ga.pa(ab.a.RRc,yc.a.frame,Object(z.a)(this,this.RRc,"invokeInDocSerplet")),this.ga.pa(ab.a.DVd,yc.a.frame,Object(z.a)(this,this.DVd,"invokeSerpletRibbon")),this.ga.pa(ab.a.SRc,yc.a.frame,Object(z.a)(this,this.SRc,"invokeSerpletContextMenu")),this.ga.pa(ab.a.$yf,
yc.a.frame,Object(z.a)(this,this.$yf,"invokeSerpletTellMeZeroTerm")),this.ga.pa(ab.a.Zyf,yc.a.frame,Object(z.a)(this,this.Zyf,"invokeSerpletTellMeNotes")),this.ga.pa(ab.a.zVd,yc.a.frame,Object(z.a)(this,this.zVd,"invokeImageSerpletContextMenu")),this.ga.pa(ab.a.EVd,yc.a.frame,Object(z.a)(this,this.EVd,"invokeSynonymsSerpletContextMenu")),this.ga.pa(ab.a.yVd,yc.a.frame,Object(z.a)(this,this.yVd,"invokeDictionarySerpletContextMenu")),this.ga.pa(ab.a.GVd,yc.a.frame,Object(z.a)(this,this.GVd,"invokeZeroTermSerpletContextMenu")),
this.ga.pa(ab.a.xVd,yc.a.frame,Object(z.a)(this,this.xVd,"invokeDefinitionSearchFromFloatie")),this.ga.pa(ab.a.CVd,yc.a.frame,Object(z.a)(this,this.CVd,"invokeSerpletBrowseFiles")),this.ga.pa(ab.a.AVd,yc.a.frame,Object(z.a)(this,this.AVd,"invokeInDocSerpletWithLaunchData")),this.ga.pa(ab.a.S$d,yc.a.frame,Object(z.a)(this,this.S$d,"queryToggleSerplet")),this.ga.pa(ab.a.Mee,yc.a.frame,Object(z.a)(this,this.Mee,"setInDocSearchParameter")),this.ga.pa(ab.a.Yyf,yc.a.frame,Object(z.a)(this,this.Yyf,"invokeSerpletSlidesCompression")),
this.ga.pa(ab.a.Xyf,yc.a.frame,Object(z.a)(this,this.Xyf,"invokeSerpletPasteAsNewSlide")),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.pa(ab.a.Api,yc.a.frame,Object(z.a)(this,this.Kwm,"invokeSmartLookupPaneConversations")),this.ga.pa(ab.a.vVd,yc.a.frame,Object(z.a)(this,this.vVd,"invokeAutoLaunchSearchRequest"))),this.kOn().continueWith(()=>{v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.updateCommandUI(!0)}))}pkh(){this.ga.gb(ab.a.REa,
yc.a.frame,Object(z.a)(this,this.REa,"invokeFilesSerplet"),4);this.ga.gb(ab.a.Ryf,yc.a.frame,Object(z.a)(this,this.REa,"invokeFilesSerplet"),4);this.ga.gb(ab.a.vpi,yc.a.frame,Object(z.a)(this,this.Awm,"invokeLinkFilesSerplet"),4);if(this.Na.$("IsTellMeUpSellEnterpriseEnabled")&&this.Na.$("SmartLookupTokenPrefetchIsEnabled")){const b=Vb.a.l7(0,Object(z.a)(this,this.pXi,"prefetchToken"),0,177);this.Gb.Wb(b)}}NXe(){Rh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&
(this.ga.pa(ab.a.REa,yc.a.frame,Object(z.a)(this,this.Syf,"invokeFilesSerpletUnavailable")),this.ga.pa(ab.a.Ryf,yc.a.frame,Object(z.a)(this,this.Syf,"invokeFilesSerpletUnavailable")),this.ga.pa(ab.a.vpi,yc.a.frame,Object(z.a)(this,this.Syf,"invokeFilesSerpletUnavailable")))}pXi(b){u.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.Wkc().then(h=>{let t=1;if(h)u.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),
this.p7f("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.Na.pc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{u.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.p7f("SmartLookupFiles: Token prefetch failed",!1);t=parseInt(b.data||"1");if(t>this.Na.pc("SmartLookupTokenRenewalRetryThreshold",5)){u.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.p7f("SmartLookupFiles: Token prefetch max retry count reached",
!1);return}h=6E4*this.Na.pc("SmartLookupTokenRetryWaitDurationInMinutes",10);t++}h=new Vb.a(3,1,h,Object(z.a)(this,this.pXi,"prefetchToken"),177);h.data=t.toString();this.Gb.Wb(h)})}p7f(b="",h=!1){this.Gwc.execute(t=>{t&&t.bnb("PrefetchToken",h,0,"SmartLookup",b)})}Wkc(){return this.Gwc?new Promise(b=>{this.Gwc.execute(h=>{if(h){var t=Date.now();h.getToken("SmartLookup",this.Na.kb("SmartLookupShredderServiceEndpoint")).then(A=>{b(!!A&&0<A.length);h.bnb("TryGetTokenInternal",!!A&&0<A.length,Date.now()-
t,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}kOn(){const b=new xm.a;if(this.Na.$("BrowserSupportsInsightsPaneSSO"))this.pkh(),b.xg(!0);else{if(!this.Gwc)return u.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.xg(!1),this.NXe(),b.task;this.Gwc.execute(h=>{h?h.getToken("SmartLookup",this.Na.kb("SmartLookupShredderServiceEndpoint")).then(t=>{u.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!t&&0<t.length);t&&0<t.length?(this.pkh(),b.xg(!0)):this.NXe()}):(u.ULS.sendTraceTag(587534912,
1303,10,"Unable to resolve oAuthManager"),b.xg(!1),this.NXe())})}return b.task}opo(b,h,t,A,O){if(1===t)return v.AFrameworkApplication.ta&&v.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!v.AFrameworkApplication.wGc?8:this.RB.value.Tti()?32:8;b=Bv.ECb();h=this.RB.value.qDb();return this.xZg?(h=Object.assign(new Ax.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new iu.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new Eu.a,
{landingTab:"All"})}),Bv.S4b(O,null,h,b,0,this.RB)):Bv.S4b(O,h,null,b,0,this.RB)}noo(b,h,t,A,O){if(1===t)return this.RB.value.Tti()?32:8;b=Bv.ECb();h=this.RB.value.qDb();return Bv.S4b(O,h,null,b,1,this.RB)}ppo(b,h,t,A,O){return 1===t?32:this.XTh(O,0)}ooo(b,h,t,A,O){return 1===t?32:this.XTh(O,1)}XTh(b,h){const t=Bv.ECb(),A=b.CommandValueId;let O;try{O=E.a(A)}catch(aa){return u.ULS.sendTraceTag(6295941,1303,15,Bv.uT(String.format("Insights parameters [{0}] is not in proper format.",A),t)),8}return Bv.S4b(b,
O,null,t,h,this.RB)}hbg(b,h,t,A,O){if(1===t)return 32;if(!O)return 8;b=O.query?O.query:"";h=Bv.ECb();t=new kF.a;t.neighborhood=b;t.mentionStart=0;t.mentionLength=b.length;return Bv.S4b(O,t,null,h,0,this.RB)}Awm(b,h,t,A){if(1===t)return fc.SessionStatusManager.instance.vH?32:8;const O=v.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),aa=this.RB.value.s0a();return this.CX(b,h,t,A,Object.assign(new iu.a,{selection:Object.assign(new Ax.a,{neighborhood:aa.neighborhood,mentionStart:0,mentionLength:0}),
launchData:Object.assign(new Eu.a,{landingTab:"File"}),entryPoint:O?32:10}))}REa(b,h,t,A){if(1===t)return fc.SessionStatusManager.instance.vH?32:8;const O=v.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),aa=this.RB.value.s0a();return this.CX(b,h,t,A,Object.assign(new iu.a,{selection:Object.assign(new Ax.a,{neighborhood:aa.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Eu.a,{landingTab:O?"Slide":"File"}),entryPoint:O?20:10}))}Syf(){return 2}RRc(b,h,t,A,O){if(1===
t)return fc.SessionStatusManager.instance.xj?8:32;const aa=this.RB.value.s0a();O=void 0===O||null===O?18:19;return this.CX(b,h,t,A,Object.assign(new iu.a,{selection:Object.assign(new Ax.a,{neighborhood:aa.neighborhood,mentionStart:aa.mentionStart,mentionLength:aa.mentionLength}),launchData:Object.assign(new Eu.a,{landingTab:"Indoc"}),entryPoint:O}))}AVd(b,h,t,A,O){O=O.CommandValueId;if(!O||O&&this.Pqc&&O.query===this.Pqc.query&&O.matchCase===this.Pqc.matchCase&&O.matchWholeWordOnly===this.Pqc.matchWholeWordOnly)return 32;
const aa=this.RB.value.s0a();return this.CX(b,h,t,A,Object.assign(new iu.a,{selection:Object.assign(new Ax.a,{neighborhood:aa.neighborhood,mentionStart:aa.mentionStart,mentionLength:aa.mentionLength}),launchData:Object.assign(new Eu.a,{landingTab:"Indoc",data:Object.assign(new pL,{type:4,query:O.query,matchCase:O.matchCase,matchWholeWord:O.matchWholeWordOnly})}),entryPoint:18}))}S$d(b,h,t,A,O){O&&(O[Ng.a.On]=this.RB.value.zGb);return 32}Mee(b,h,t,A,O){if(b=O.CommandValueId)this.Pqc=b;return 32}Kwm(b,
h,t){if(1===t)return fc.SessionStatusManager.instance.vH?32:8;b=this.RB.value.s0a();b=Object.assign(new iu.a,{selection:Object.assign(new Ax.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Eu.a,{landingTab:"All"})});this.RB.value.a_d(b);return 32}vVd(b,h,t){if(1===t)return fc.SessionStatusManager.instance.vH?32:8;b=this.RB.value.s0a();b=Object.assign(new iu.a,{selection:Object.assign(new Ax.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,
mentionLength:0}),entryPoint:29,launchData:Object.assign(new Eu.a,{landingTab:"All",data:v.AFrameworkApplication.pBb})});h=Bv.ECb();this.RB.value.OMb(b,h);return 32}DVd(b,h,t,A){if(1===t)return fc.SessionStatusManager.instance.vH?32:8;const O=this.RB.value.U6h();return this.CX(b,h,t,A,Object.assign(new iu.a,{selection:Object.assign(new Ax.a,{neighborhood:O.neighborhood,mentionStart:O.mentionStart,mentionLength:O.mentionLength}),entryPoint:4,launchData:Object.assign(new Eu.a,{landingTab:"All"})}))}SRc(b,
h,t,A){return this.CX(b,h,t,A,Object.assign(new iu.a,{entryPoint:5,launchData:Object.assign(new Eu.a,{landingTab:"All"})}))}$yf(b,h,t,A){if(1===t)return fc.SessionStatusManager.instance.vH?32:8;const O=this.RB.value.s0a();return this.CX(b,h,t,A,Object.assign(new iu.a,{selection:Object.assign(new Ax.a,{neighborhood:O.neighborhood,mentionStart:O.mentionStart,mentionLength:0}),launchData:Object.assign(new Eu.a,{landingTab:"All"}),entryPoint:26}))}yVd(b,h,t,A){return 1===t?(b=this.RB.value.qDb())&&0<
b.mentionLength?32:8:this.CX(b,h,t,A,Object.assign(new iu.a,{entryPoint:22,launchData:Object.assign(new Eu.a,{landingTab:"All"})}))}xVd(b,h,t,A){return 1===t?(b=this.RB.value.qDb())&&0<b.mentionLength?32:8:this.CX(b,h,t,A,Object.assign(new iu.a,{entryPoint:7,launchData:Object.assign(new Eu.a,{landingTab:"All"})}))}zVd(b,h,t,A){return this.CX(b,h,t,A,Object.assign(new iu.a,{launchData:Object.assign(new Eu.a,{landingTab:"Image"}),entryPoint:9}))}EVd(b,h,t,A){return this.CX(b,h,t,A,Object.assign(new iu.a,
{launchData:Object.assign(new Eu.a,{landingTab:"All"}),entryPoint:24}))}Zyf(b,h,t,A){return this.CX(b,h,t,A,Object.assign(new iu.a,{launchData:Object.assign(new Eu.a,{landingTab:"Notes"}),entryPoint:33}))}GVd(b,h,t,A){if(1===t)return fc.SessionStatusManager.instance.vH?32:8;const O=this.RB.value.s0a();return this.CX(b,h,t,A,Object.assign(new iu.a,{selection:Object.assign(new Ax.a,{neighborhood:O.neighborhood,mentionStart:O.mentionStart,mentionLength:0}),launchData:Object.assign(new Eu.a,{landingTab:"All"}),
entryPoint:27}))}Yyf(b,h,t,A,O){if(!O)return 8;const aa=O.url;O=O.selectedSlideIDs;return this.CX(b,h,t,A,Object.assign(new iu.a,{launchData:Object.assign(new Eu.a,{landingTab:"All",data:Object.assign(new rL,{type:6,url:aa,selectedSlideIDs:O})}),entryPoint:37}))}Xyf(b,h,t,A,O){if(!O)return 8;const aa=O.Selection;O=O.CurrentDocTitle;return this.CX(b,h,t,A,Object.assign(new iu.a,{launchData:Object.assign(new Eu.a,{landingTab:"All",data:Object.assign(new qL,{type:5,selection:aa,currentDocTitle:O})}),
entryPoint:36}))}CX(b,h,t,A,O){return Bv.CX(b,h,t,A,this.RB,O)}CVd(b,h,t){if(1===t)return 32;this.mw||this.tVa.value.Vj("Browse File from Search pane",!0);if(!this.ajd||""===this.ajd)return u.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;ff.a.km(this.ajd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}BDb(b){this.mw||3!==b.state||(this.mw=b,this.ajd=this.mw.$ba)}Vqm(){const b=this.Vb.fe($h.BB);b.parent=vf.AFrame.qp;b.pea(Object(z.a)(this,this.jhc,
"sendIFrameTakeFocusMessage"));this.Zo.GS($h.BB)}jhc(){document.activeElement.blur();v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.ejb||(this.RB.value.gbo(),this.RB.value.z7n())}dispose(){this.RB.value&&this.RB.value.dispose()}}Object(m.a)(pH,"InsightsActor",null,[9]);const qH=b=>{b=b.split("-");return b[b.length-1]},sN=()=>{var b=pG();if(b)return Promise.resolve(b);b=lF().replace("SearchWeb","searchweb");b=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+$h.tnj+"/":b+$h.l7c+"/";b+="version.json";if(ba.a.Hna)return rN(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(km.iz("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(t=>t.json()).catch(()=>{km.iz("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(t=>{t=E.b(JSON.stringify(t));
return t.version?t.version:""},t=>{km.iz("InsightsUtils - Failed to deserialize version: "+t.toString(),10);u.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+t.toString());return""}).then(t=>t)}catch(h){return km.iz("InsightsUtils - Failed to download version.json: "+h.toString(),10),u.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},rN=b=>{const h=v.AFrameworkApplication.Ke;return new Promise(t=>{const A=
new iF.a(b,1,null,null,!0,2,null);h.send(A).zxa(O=>{O&&O.data?O.data.we||(km.iz("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+O.data.Ve,10),t("")):(km.iz("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),t(""));try{const aa=E.b(O.data.we);aa.version&&t(aa.version)}catch(aa){km.iz("InsightsUtils - Failed to deserialize version: "+aa.toString(),10),t("")}},O=>{O&&O.data?km.iz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+
O.data.Ve,10):km.iz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);t("")})})},qG=()=>v.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),rG=()=>{const b=lF();return qG()||v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")?b+pG()+"/":v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+$h.tnj:b+$h.l7c},pG=()=>qG()?"dev":v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")?v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion").split("/")[1]:v.AFrameworkApplication.K.kb("SmartLookupClientVersion"),rH=b=>{var h=3===v.AFrameworkApplication.ta.Ob.jm?"wordwac":2===v.AFrameworkApplication.ta.Ob.jm?"pptwac":"excelwac";var t=Sf.a.lg(v.AFrameworkApplication.lcid);const A=t?t.name:"en-us";t=lF();const O=QC();h="main_ssr_wac.html?appName="+h+"&culture="+A;return"LOCAL"===O?
t+h:t+((""!==b?b:$h.l7c)+"/")+h},tN=b=>lF()+(""!==b?b:$h.l7c)+"/scripts/microsoft.office.smartlookup.host.runtime.js",lF=()=>{switch(QC()){case "LOCAL":return $h.dso;case "PR":const b=v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion").split("/");return $h.eso+b[0]+"/";case "INT":return $h.fso;case "EDOG":return $h.unj;default:return $h.vnj}},uN=()=>{if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(QC()){case "EDOG":return $h.unj;
case "PROD":return $h.vnj;default:return""}},QC=()=>{if(v.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(v.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(v.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")&&v.AFrameworkApplication.K.kb("SmartLookupPRIntentSvc"))return"PR";if(qG())return"LOCAL";switch(Object(Da.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",
!1)){let b=v.AFrameworkApplication.K.kb("UserPrincipalName");b=F.a.fh(b);const h=v.AFrameworkApplication.K.yw("SmartLookupINTEnabledForSKITeam")?v.AFrameworkApplication.K.oC("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},sL=()=>{let b;b=v.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",
!1)?"EDOG":v.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":v.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":QC();const h=v.AFrameworkApplication.K.kb("IntentServiceEndpoint"),t=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return v.AFrameworkApplication.K.kb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(t?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(t?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},vN=()=>{const b=QC(),h=v.AFrameworkApplication.K.kb("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==h?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class tL{sendTelemetryEvent(b){km.sendTelemetryEvent(b)}}
Object(m.a)(tL,"OtelTelemetrySink",null,[389]);class uL{}Object(m.a)(uL,"ApplicationProperties",null,[]);class vL{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(m.a)(vL,"CurrentDocumentProperties",null,[]);class wL{}Object(m.a)(wL,"EnterpriseUserInfo",null,[]);class xL{}Object(m.a)(xL,"FeatureGates",null,[]);class sH{constructor(b,h){this.Zu=this.Gi=null;this.FFi=!0;this.Axb=h;this.qz=b;this.qz.execute(t=>{t.isFeatureEnabled("mso_sendASmile",!0).then(A=>{this.FFi=
A}).catch(A=>{km.iz("SearchHelper - Failed to check if Feedback feature is enabled: "+A.toString(),15)})});b=sL();h=v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.Zu={};const t=this.p5l();if(t&&0<t.length)for(let A=0;A<t.length;A++){const O=t[A],aa=this.C5l(O);switch(aa.toLowerCase()){case "true":this.Zu[O]=
!0;break;case "false":this.Zu[O]=!1;break;default:this.Zu[O]=aa}}this.Zu.EnableInDocumentSearch=h;this.Zu.EnableInDocumentSearchReplace=!0;this.Zu.EnableInDocumentParamLocalSearch=!0;this.Zu.EnableInDocumentQuerySuggest=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.Zu.EnableInDocumentQuestionGeneration=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.Zu.EnableInDocumentExperiment1=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.Zu.EnableInDocumentExperiment2=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1);this.Zu.EnableInDocumentExperiment3=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.Zu.EnableZeroTermAutoRefresh=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.Zu.EnableTap3SZeroTerm=v.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.Zu.EnableLocalSearch=!0;this.Zu.EnableInDocumentStickyFilters=!0;this.Zu.IntentServiceEndpoint=b;this.Zu.EnablePDFShredding=v.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.Zu.FilterNonPPTFilesForReuseSlides=v.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.Zu.UXBundleVersion=pG();this.Zu.SmartLookupServicePath=rG();this.Zu.EnableAcronymSearch=
!0;this.Zu.UseAltAnswerEndpoint1=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.Zu.UseAltAnswerEndpoint2=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.Zu.UseAltAnswerEndpoint3=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.Zu.UseNextUXVersion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.Zu.IgnoreNeighborhoodContext=v.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.Zu.ShowDebugInfo="INT"===QC();this.Zu.DebugCommands=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.Zu.ChangeGates=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.Zu.QnaInMixSection=!0;this.Zu.EnableNoteSearch=v.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.Zu.EnableWikiL2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.Zu.EnableFilteringOutRedundantKPE=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.Zu.EnableZeroTermEntitySuggestion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.Zu.RankingModels=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.Zu.EnableClientSideRendering=!0}else this.Gi=new xL,this.Gi.EnableInDocumentSearch=h,this.Gi.EnableInDocumentSearchReplace=
!0,this.Gi.EnableInDocumentParamLocalSearch=!0,this.Gi.EnableInDocumentQuerySuggest=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Gi.EnableInDocumentQuestionGeneration=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.Gi.EnableInDocumentExperiment1=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Gi.EnableInDocumentExperiment2=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.Gi.EnableInDocumentExperiment3=
h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Gi.EnableZeroTermAutoRefresh=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Gi.EnableTap3SZeroTerm=v.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Gi.EnableLocalSearch=!0,this.Gi.EnableInDocumentStickyFilters=!0,this.Gi.IntentServiceEndpoint=b,this.Gi.EnablePDFShredding=v.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Gi.FilterNonPPTFilesForReuseSlides=v.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Gi.UXBundleVersion=pG(),this.Gi.SmartLookupServicePath=rG(),this.Gi.EnableAcronymSearch=
!0,this.Gi.UseAltAnswerEndpoint1=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Gi.UseAltAnswerEndpoint2=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Gi.UseAltAnswerEndpoint3=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Gi.UseNextUXVersion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Gi.IgnoreNeighborhoodContext=v.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Gi.ShowDebugInfo="INT"===QC(),this.Gi.DebugCommands=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Gi.ChangeGates=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Gi.QnaInMixSection=!0,this.Gi.EnableNoteSearch=v.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Gi.EnableWikiL2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Gi.EnableFilteringOutRedundantKPE=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Gi.EnableZeroTermEntitySuggestion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Gi.RankingModels=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Gi.EnableClientSideRendering=!0,this.Gi.SharedSerpletFeatureGate1=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Gi.SharedSerpletFeatureGate2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Gi.SharedSerpletFeatureGate3=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Gi.SharedSerpletFeatureGate4=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Gi.SharedSerpletFeatureGate5=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Gi.SharedSerpletFeatureGate6=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Gi.SharedSerpletFeatureGate7=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Gi.SharedSerpletFeatureGate8=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Gi.SharedSerpletFeatureGate9=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Gi.SharedSerpletFeatureGate10=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Gi.SharedSerpletFeatureGate11=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Gi.SharedSerpletFeatureGate12=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Gi.SharedSerpletFeatureGate13=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Gi.SharedSerpletFeatureGate14=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Gi.SharedSerpletFeatureGate15=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Gi.SharedSerpletFeatureGate16=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Gi.SharedSerpletFeatureGate17=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Gi.SharedSerpletFeatureGate18=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Gi.SharedSerpletFeatureGate19=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Gi.SharedSerpletFeatureGate20=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Gi.SharedSerpletFeatureGate21=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Gi.SharedSerpletFeatureGate22=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Gi.SharedSerpletFeatureGate23=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Gi.SharedSerpletFeatureGate24=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Gi.SharedSerpletFeatureGate25=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Gi.SharedSerpletFeatureGate26=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Gi.SharedSerpletFeatureGate27=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Gi.SharedSerpletFeatureGate28=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Gi.SharedSerpletFeatureGate29=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Gi.SharedSerpletFeatureGate30=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Gi.SharedSerpletFeatureGate31=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Gi.SharedSerpletFeatureGate32=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Gi.SharedSerpletFeatureGate33=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Gi.SharedSerpletFeatureGate34=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Gi.SharedSerpletFeatureGate35=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Gi.SharedSerpletFeatureGate36=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Gi.SharedSerpletFeatureGate37=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Gi.SharedSerpletFeatureGate38=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Gi.SharedSerpletFeatureGate39=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Gi.SharedSerpletFeatureGate40=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.Hvc=Sa.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.pIb=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOAuthManager",!1);this.gkb=sH.isEnterpriseUser();this.qQa=v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.oJf=ia.a.YZ(v.AFrameworkApplication.K.kb("AppCatalogUrl")||"");this.W2m=v.AFrameworkApplication.K.kb("UserPrincipalName");(this.gkb||this.pIb)&&this.sci()}C5l(b){return v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+
b,"")}p5l(){const b=v.AFrameworkApplication.K.I_a,h=v.AFrameworkApplication.K.oC("SmartLookupFlightKeywordList"),t=[];if(b&&h&&0<h.length)for(let O in b){var A={key:O,value:b[O]};A=A&&A.key?A.key:"";for(let aa=0;aa<h.length;aa++)if(-1<A.toLowerCase().indexOf(h[aa].toLowerCase())){const ua=A.split(".");ua&&4===ua.length&&Array.add(t,ua[ua.length-1])}}return t}Hrf(b,h,t,A){return new Promise(O=>{this.kKm().then(aa=>{const ua=new uL;ua.anid="";ua.applicationName=3===v.AFrameworkApplication.ta.Ob.jm?
"WORD":"POWERPNT";ua.applicationVersion=v.AFrameworkApplication.buildVersion;ua.appCorrelationId=b?b:Bv.ECb();ua.themePlatform="web";ua.lcid=v.AFrameworkApplication.lcid;ua.launchUtcTime=(new Date).toUTCString();v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?ua.featureGates=E.c(this.Zu):ua.featureGates=E.c(this.Gi);var Ra=Sf.a.lg(v.AFrameworkApplication.lcid);Ra=Ra?Ra.name:null;ua.market=qH(Ra);ua.uiLanguage=Ra;ua.sessionId=v.AFrameworkApplication.userSessionId;ua.themeId=t;ua.parentalControl=
"yes";ua.processorOnlyMode=aa;ua.isEditingAllowed=h.isEditingAllowed();ua.isFeedbackEnabled=this.FFi;ua.isClientSideRendering=18===A||19===A||15===A;ua.disableClipboard=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&v.AFrameworkApplication.qG&&!v.AFrameworkApplication.BBb;ua.accessToken=this.gkb||this.pIb?this.sci():"";aa=new wL;aa.CountryCode=qH(Ra);aa.ServiceEndpoint=this.qQa;aa.IsGoLocal=v.AFrameworkApplication.K.$("IsGoLocalEnvironment");
aa.IsEnabled=this.gkb;aa.IsEnterpriseEnabled=this.gkb;aa.TenantRoot=this.oJf;aa.Upn=this.W2m;Ra=QC();aa.IsEUDB="PROD"===Ra&&""!==v.AFrameworkApplication.K.kb("IntentServiceEndpoint");ua.enterpriseUserInfo=aa;aa=new vL;aa.filePath=v.AFrameworkApplication.K.kb("EditDocInClientUrl");aa.docName=v.AFrameworkApplication.K.kb("FileName");aa.author=99!==A?h.author():null;aa.createdDate=99!==A?h.createdDate():null;ua.currentDocument=aa;O(ua)})})}kKm(){return new Promise(b=>{this.qz?this.qz.execute(h=>{h.isFeatureEnabled($h.gso,
!0).then(t=>{b(!t)}).catch(t=>{km.iz("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+t.toString(),10);b(!0)})}):b(!0)})}pvn(b){this.Hvc&&(this.gkb||this.pIb)&&this.Hsf(this.qQa).then(h=>{b(h)})}sci(){if("Dev Box"===v.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return window.SearchPaneShredderTokenOverride;const b=this.pIb?"Search":"SmartLookup";return this.Hvc?
this.Hvc.l9l(b,this.qQa,this.pIb):""}Hsf(b){if("Dev Box"===v.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return new Promise(t=>{t(window.SearchPaneShredderTokenOverride)});const h=this.pIb?"Search":"SmartLookup";return this.Hvc?this.Hvc.getToken(h,b,this.pIb):Promise.resolve("")}pOc(){return this.Axb?this.Axb.getVersion():""}wOl(){return v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?
E.c(this.Zu):E.c(this.Gi)}static isEnterpriseUser(){const b=v.AFrameworkApplication.K.kb("SovereignEnvironmentName"),h=v.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(m.a)(sH,"SearchHelper",null,[352]);class ND{constructor(){ND._instance=""}getVersion(){return ND._instance}who(b){ND._instance=b}}ND._instance=null;Object(m.a)(ND,"SmartLookupVersion",null,[]);class yL{}Object(m.a)(yL,"ConfigurationProvider",null,[]);class vE{constructor(b){vE._instance=
b}sof(){return vE._instance}}vE._instance=null;Object(m.a)(vE,"SearchHostRuntime",null,[]);class tH{constructor(){this.Ada=this.YQb=this.W=null}get name(){return"Common.App.Insights"}yc(b){this.W=b;const h=eg.a.xp(Sa.a.instance.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>")),t=v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||v.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(pH,"Common.App.Insights.InsightsActor").singleInstance().Qd(()=>new pH(b.We("Common.App.Insights.IInsightsManager"),
v.AFrameworkApplication.xa,ej.a.instance,yd.FocusManager.instance(),b.Sa("Common.App.SearchCommon.ISearchOAuthManager"),v.AFrameworkApplication.K,sf.a.instance,t,new Pg.a(()=>h.result)));b.register(351,"Common.App.Insights.IDocumentContentExtractionManager").singleInstance().Qd(()=>new oL(b));t&&(b.register(ND,"Common.App.Insights.SmartLookupVersion").singleInstance().Qd(()=>new ND),b.register(352,"Common.App.SearchCommon.ISearchHelper").singleInstance().Qd(()=>new sH(Sa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
b.Ma("Common.App.Insights.SmartLookupVersion"))))}init(){v.AFrameworkApplication.m_&&(this.YQb=this.W.Ma("Common.App.Insights.InsightsActor"),this.YQb.Ub())}WMn(){if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",!1)){var b=v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.W.resolve("Common.App.SearchCommon.ISearchHelper").Hsf(b).then(h=>{var t={};t.Authorization="Bearer "+h;h=vN();const A=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",
!0);t=new iF.a(h+("?isTelemetryOnly="+A),1,null,t,!0,2,null);v.AFrameworkApplication.Ke.send(t).zxa(()=>{km.iz("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+A,50)},O=>{km.iz("InsightsPackage - Failed to send refreshmemory API request. Error: "+O.toString(),10)})})}}akl(){this.uvm();this.WMn()}uvm(){sN().then(b=>{if(""!==b){const h=this.W.Ma("Common.App.Insights.SmartLookupVersion");h&&h.who(b)}this.cId();this.YQb=this.W.resolve("Common.App.Insights.InsightsActor");
b=tN(b);b=nb.a.create(b);b.tZ((h,t)=>{t.succeeded?this.tio()&&this.prefetchZeroTerm():km.iz("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+t.dF,10);this.YQb.Ub()});bb.a.ZW(b)})}tio(){const b=Object.assign(new yL,{channelId:$h.channelId,approvedOriginPattern:qG()?"^(http)?://(localhost:8080)$":v.AFrameworkApplication.K.kb("SmartLookupApprovedOriginPattern")});var h=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const t=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),
A=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),O=new Mb.a;h&&O.add(h);t&&O.add(t);A&&O.add(A);h=sL();try{const aa=new tL,ua=SmartLookupHostRuntime.setup(b,O.toArray(),!0,h,aa);this.W.register(vE,"Common.App.SearchCommon.SearchHostRuntime").singleInstance().Qd(()=>new vE(ua));return!0}catch(aa){return km.iz("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+aa,10),!1}}prefetchZeroTerm(){if(v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=Sa.a.instance.Ma("Common.App.SearchCommon.SearchHostRuntime");if(b){const h=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),t=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");h.Hrf(null,t,0,99).then(A=>{b.sof().prefetchZeroTerm(A,v.AFrameworkApplication.userSessionId,rG(),!0,"Indoc",null)})}else km.iz("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",
15)}}cId(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const h=rH(b.pOc());b=b.pOc();b=lF()+(""!==b?b:$h.l7c)+"/scripts/microsoft.office.smartlookup.ssr.js";const t=uN();ba.a.Hna?this.$jl(h,b):(this.Yjl(h,t),this.Zjl(b,t))}Yjl(b,h){const t=new Sys.Net.WebRequest;t.set_httpVerb("GET");const A={};A.method=t.get_httpVerb();t.set_url(b);const O=(new Date).getTime();try{window.fetch(t.getResolvedUrl(),A).then(()=>{""!==h&&km.W6f(h,b,(new Date).getTime()-O);this.W.Ma("Common.App.Insights.SmartLookupVersion")})}catch(aa){km.iz("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+
aa.toString(),10)}}Zjl(b,h){var t=new Sys.Net.WebRequest;t.set_httpVerb("GET");const A={};A.method=t.get_httpVerb();t.set_url(b);let O=-1;if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))t=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),sf.a.instance.Wb(new Vb.a(5,1,t,()=>{const aa=nb.a.create(b);aa.$Xe(()=>{O=Date.now()});aa.tZ((ua,Ra)=>{Ra.succeeded?""!==h&&km.W6f(h,b,Date.now()-
O):km.iz("InsightsPackage - Failed to prefetch JS file.",10)});bb.a.ZW(aa)}));else{O=Date.now();try{window.fetch(t.getResolvedUrl(),A).then(()=>{""!==h&&km.W6f(h,b,Date.now()-O)})}catch(aa){km.iz("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+aa.toString(),10)}}}$jl(b,h){if(ba.a.Hna){var t=v.AFrameworkApplication.Ke;b=new iF.a(b,1,null,null,!0,2,null);t.send(b).zxa(A=>{A&&A.data?A.data.we?this.W.Ma("Common.App.Insights.SmartLookupVersion"):km.iz("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
A.data.Ve,10):km.iz("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},A=>{A&&A.data?km.iz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+A.data.Ve,10):km.iz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});v.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(h=new iF.a(h,1,null,null,!0,2,null),t.send(h).zxa(A=>{A&&A.data?A.data.we||km.iz("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
A.data.Ve,10):km.iz("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},A=>{A&&A.data?km.iz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+A.data.Ve,10):km.iz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.YQb&&this.YQb.dispose()}}Object(m.a)(tH,"InsightsPackage",null,[1,2]);var zL=c(1580);class AL{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(m.a)(AL,"DocumentContentParams",null,[]);var sG=c(1848),uH=c(1851),vH=c(450),wE=c(746),BL=c(1436),ts;(function(b){b.YTa="SearchProvider";b.Y7a="TextSummarization";b.tQb="ExtractiveTextSummarization"})(ts||(ts={}));Object(m.b)("WorkflowType",ts);var Fu;(function(b){b.Success="Success";b.xog="Invoked";b.Error="Error"})(Fu||(Fu={}));Object(m.b)("LogType",Fu);var Lw;(function(b){b.YFj="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck=
"BlockedByQualityCheck";b.BlockedByClassifier="BlockedByClassifier";b.tog="InvalidAnnotation";b.nLj="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(Lw||(Lw={}));Object(m.b)("ErrorReason",Lw);class OD{constructor(b,h,t,A,O){this.vPh=b;this.vvl=h;this.rwl=t;this.g_i=A;this.Is=O;this.QQf=this.QQf.bind(this);this.Udc=this.Udc.bind(this);this.VQf=this.VQf.bind(this);this.k4a=[];this.sBo=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3);
this.Qrl=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.ExtractiveTextSummarizationRequestTimeout",5E3)}VQk(){if(this.k4a&&!(0>=this.k4a.length))for(const b of this.k4a)this.xAh(b.paragraphNode)}nOl(b,h,t){return Object(Rl.__awaiter)(this,void 0,void 0,function*(){try{if(!OD.Isi)return{success:!1,resultCount:0};if(this.revisionId===t&&this.k4a&&0<this.k4a.length)return this.Qkm(),{success:!0,resultCount:this.k4a.length};this.Rrl=Date.now();this.revisionId=t;this.Qq=b;this.k4a=
[];yield this.activateAnnotation();const A={content:h.join(". ")},O=new kd.a({parentPath:["Signal",BL.b.getTypeName()],items:[{id:"ExtractiveSummaries",body:new BL.b(A)}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:O});this.AUh=window.setTimeout(()=>{this.onError(ts.tQb,Fu.Error,Lw.Timeout)},this.Qrl);return new Promise(aa=>{this.X4b=aa})}catch(A){window.clearTimeout(this.AUh),this.onError(ts.tQb,Fu.Error,Lw.Other,this.vnf(A))}})}submitDocumentContentExtractionSignal(){return Object(Rl.__awaiter)(this,
void 0,void 0,function*(){try{this.x5n=Date.now();this.Wmb=Ya.a.create().toString();this.log({PH:ts.YTa,logType:Fu.xog,success:!0,correlationId:this.Wmb});var b=QC().toLowerCase();b="int"===b||"local"===b;yield this.activateAnnotation();const h=new kd.l({parentPath:["Signal",sG.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new sG.SearchProviderSignal({correlationId:this.Wmb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});
this.ubj=window.setTimeout(()=>{this.onError(ts.YTa,Fu.Error,Lw.Timeout)},1500)}catch(h){window.clearTimeout(this.ubj),this.onError(ts.YTa,Fu.Error,Lw.Other,this.vnf(h))}})}generateDocumentSummaryDetails(){return Object(Rl.__awaiter)(this,void 0,void 0,function*(){try{if(!OD.BUc)return null;this.rBo=Date.now();this.log({PH:ts.Y7a,logType:Fu.xog,success:!0});yield this.activateAnnotation();const b=new kd.l({parentPath:["Signal",wE.GenerateTextSummarySignal.getTypeName()],items:[{id:"TextSummarization",
body:new wE.GenerateTextSummarySignal}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.jsj=window.setTimeout(()=>{this.onError(ts.Y7a,Fu.Error,Lw.Timeout)},this.sBo);return new Promise(h=>{this.wjc=h})}catch(b){window.clearTimeout(this.jsj),this.onError(ts.Y7a,Fu.Error,Lw.Other,this.vnf(b))}})}generateDocumentSummary(){var b;return Object(Rl.__awaiter)(this,void 0,void 0,function*(){return null===(b=yield this.generateDocumentSummaryDetails())||void 0===b?
void 0:b.summary})}static get BUc(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get oKm(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",!1)}static get Isi(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableExtractiveTextSummarization",!1)}activateAnnotation(){return Object(Rl.__awaiter)(this,
void 0,void 0,function*(){if(!this.B9b){yield $q.a.Bl();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,h=[b(Object.assign(new vH.a,{annotationType:sG.SearchProviderAnnotation.getTypeName(),handler:this.QQf}))];OD.Isi&&h.push(b(Object.assign(new vH.a,{annotationType:uH.TextExtractiveSummaryAnnotation.getTypeName(),handler:this.VQf})));OD.BUc&&h.push(b(Object.assign(new vH.a,{annotationType:wE.TextSummaryAnnotation.getTypeName(),handler:this.Udc})));yield Promise.all(h);
this.B9b=!0}})}Udc(b){var h,t,A;if(this.wjc)if(this.uCf(b)){if(b=b.items[0],wE.TextSummaryAnnotation.typeGuard(b.body))if(window.clearTimeout(this.jsj),b=b.body,b.status!==wE.Result.Success)this.onError(ts.Y7a,Fu.Error,this.r4h(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({PH:ts.Y7a,logType:Fu.Success,success:!0});var O=null!==b.summary&&""!==b.summary,aa=OD.oKm&&(null===(h=b.tts)||void 0===h?void 0:h.requestStatus)===wE.TTSStatus.Success&&null!==(null===(t=b.tts)||void 0===
t?void 0:t.base64Audio)&&""!==(null===(A=b.tts)||void 0===A?void 0:A.base64Audio);this.wjc({succeeded:O,summary:O?b.summary:null,audioSucceeded:aa,audioBase64:aa?b.tts.base64Audio:null});this.wjc=null}}else this.log({PH:ts.Y7a,logType:Fu.Error,success:!1,rJd:Lw.tog})}QQf(b){if(this.uCf(b)&&(b=b.items[0],sG.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.ubj),(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Wmb)this.log({PH:ts.YTa,
logType:Fu.Error,rJd:Lw.YFj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});else if(this.Wmb!==b.correlationId)this.log({PH:ts.YTa,logType:Fu.Error,rJd:Lw.nLj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});else{var h=this.mHh(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);
this.log({PH:ts.YTa,logType:Fu.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.Wmb=void 0;this.vPh.Cej(h)}else this.onError(ts.YTa,Fu.Error,Lw.tog)}VQf(b){if(this.X4b&&this.uCf(b)&&(b=b.items[0],uH.TextExtractiveSummaryAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.AUh),b=b.body,b.status!==uH.Result.Success)this.onError(ts.tQb,Fu.Error,this.r4h(b),`[ExtractiveTextSummarization] workflow failed with status: ${b.status}`);else{var h=b.extractiveSummarizationArrays;
b=[];for(var t of h){h=t.extractiveSummarizations;for(const A of h)b.push(A.summary.slice(0,-1))}t=b.length;if(0<t)for(const A of this.Qq)this.xAh(A),b=b.filter(O=>(O=this.Kma(O,A))&&0<O.length?(this.cia(A,O),this.k4a.push({paragraphNode:A,clm:O}),!1):!0);this.log({PH:ts.tQb,logType:Fu.Success,success:!0});this.X4b({success:!0,resultCount:t});this.X4b=null}}r4h(b){switch(b.status){case "BlockedByPrefilter":return Lw.BlockedByPrefilter;case "BlockedByQualityCheck":case "BlockedByPostfilter":return Lw.BlockedByQualityCheck;
default:return Lw.Other}}Kma(b,h){var t=this.g_i.Nlb(this.g_i.dfc(b));b=oj.a.createQuery(b,Vk.a.matchCase);t=this.rwl.TDb(t.join("|"),b);return this.vvl.W0a(h.eva(),t)}cia(b,h){const t=this.Is.Qc(3);t.Eb(b);const A=b.Kma();if(A&&0<A.length)for(const O of A)if(O.begin<h[0].end&&O.end>h[0].begin)return;b.cia(h);t&&t.dispose()}xAh(b){const h=this.Is.Qc(3);h.Eb(b);b.Oea();h&&h.dispose()}Qkm(){for(const b of this.k4a)this.cia(b.paragraphNode,b.clm)}uCf(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.PH){case ts.YTa:var h=
this.x5n;break;case ts.Y7a:h=this.rBo;break;case ts.tQb:h=this.Rrl;break;default:h=-1}const t=Date.now(),A=h?t-h:-1;h=[Object.assign(new sa.a,{name:"WorkflowType",string:b.PH}),Object.assign(new sa.a,{name:"LogType",string:b.logType}),Object.assign(new sa.a,{name:"ErrorReason",string:b.rJd}),Object.assign(new sa.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new sa.a,{name:"Message",string:b.message}),Object.assign(new sa.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),
Object.assign(new sa.a,{name:"StartTime",int64:h}),Object.assign(new sa.a,{name:"EndTime",int64:t}),Object.assign(new sa.a,{name:"Duration",int64:A})];Object(lb.a)("AugloopSearchProviderData",b.success,A,h)}vnf(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}mHh(b="",h="",t=""){return Object.assign(new AL,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:t})}onError(b,h,t,A){h={PH:b,logType:h,success:!1,message:A,rJd:t};switch(b){case ts.YTa:if(!this.Wmb)break;h.correlationId=
this.Wmb;this.log(h);this.Wmb=void 0;this.ksl();break;case ts.Y7a:if(!this.wjc)break;this.log(h);this.wjc(null);this.wjc=null;break;case ts.tQb:if(!this.X4b)break;this.log(h);this.X4b({success:!1,resultCount:0});this.X4b=null;break;default:return null}}ksl(){this.vPh.Cej(this.mHh())}}Object(m.a)(OD,"AugloopSearchProviderManager",null,[]);class tG{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(m.a)(tG,"DocumentContentSearchResults",null,[]);class wH{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,
h,t,A,O){this.selectRange(h,t,A,O)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,t=>{h(Object.assign(new tG,{results:t,totalResultCount:t.length,hasTooManyResults:100<t.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,t=>{h(Object.assign(new tG,{results:t,totalResultCount:t.length,hasTooManyResults:t.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}highlightDocumentKeySentences(){return Promise.resolve(null)}getDocumentKeySentences(){return Promise.resolve(null)}clearDocumentKeySentencesHighlights(){}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(m.a)(wH,"BaseDocumentContentExecutor",null,[941,158]);var xH=c(2035),CL=c(1452);class uG{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(m.a)(uG,"DocumentContentSearchParams",null,[]);class yH{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(m.a)(yH,"DocumentSelection",null,[]);class DL{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(m.a)(DL,"IAuthorProperties",null,[]);var PD=c(690);class zH{constructor(){this.QKc=this.t6e=0}}Object(m.a)(zH,"CommentFindResultIndexInfo",null,[]);const AH=b=>{b.setSelection(nf.SelectionEditor.Bj(b.hb.lb,!0,!1))},EL=b=>{b=xH.a.MPd(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class FL{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(m.a)(FL,"DocumentContentSearchResult",null,[]);var wN=c(1804);class GL{constructor(){this.authorEmail=this.authorName=this.dCb=this.y6e=null}}Object(m.a)(GL,"CommentFindResults",null,[]);class HL{constructor(){this.end=this.begin=0}}Object(m.a)(HL,"FindResultOffset",null,[]);class Ty{constructor(b,h,t,A,O,aa,ua,Ra,ub,Nb){this.Gse=this.ev=this.Kye=this.JA=null;this.Bfh=0;this.CL=null;this.apc=new Mb.a;this.ULg=null;this.tF=b;this.eb=h;this.Gbb=t;this.Sda=
O;this.KTb=aa;this.ksb=ua;this.Wh=Ra;this.ga=ub;this.ib=Nb}BRl(b,h){var t;const A=[];if(12!=b.type)return A;const O=Wa.FormattingReader.J_h(b);let aa=null,ua=-1;var Ra=Fl.a.auto;for(let Nb=0;Nb<=O.length;Nb++){let Yb=-1;var ub=Fl.a.auto;Nb<O.length&&(ub=O[Nb],Yb=ub.cp,ub=null===(t=ub.formatting)||void 0===t?void 0:t.cache,ub=(null===ub||void 0===ub?0:ub.DEb)?ub.highlight:(null===ub||void 0===ub?0:ub.ROa)?ub.fw:Fl.a.auto);if(Ra!=ub){if(Ra!=Fl.a.auto){aa||(aa=this.ksb.eva(b.id));-1==Yb&&(Yb=aa.length);
Ra=this.Gbb.JFd(aa,ua,Yb,"");const bc={};bc.context=Ra.vEd;bc.startOffsetInContext=Ra.uce;bc.endOffsetInContext=Ra.sce-1;A.push({data:bc,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:ua,endOffsetInParagraph:Yb-1})}ua=Yb;Ra=ub}}return A}get kaa(){return this.ULg}initialize(){this.JA=We.FindManager.createInstance(this,this.Sda,Yr.a.instance,!1,!0)}search(b,h){this.JA.RYa();this.XCf(b)?(this.ev=h,this.CL=new Mb.a,b=this.W9e(b),this.JA.find(b)):h(null)}searchV2(b,h){v.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");
this.JA.RYa();if(this.XCf(b)){this.Hti()&&this.ga.Rb(ab.a.Mee,2,{CommandValueId:b});this.Gse=h;this.Bfh=b.totalResultLimit;this.CL=new Mb.a;b=this.W9e(b);this.ULg=new xq.a;this.JA.find(b);h=this.Sda.dfc(b.text);h=this.Sda.Nlb(h);b=this.KTb.TDb(h.join("|"),b);h=this.Wh.mQ();for(let A=0;A<h.length;A++){const O=h[A],aa=EL(O);var t=this.ksb.W0a(aa,b);const ua=this.ksb.W0a(O.author,b);if(!t&&!ua){u.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!aa,!b);continue}t=ua?ua:
t;let Ra="",ub="";ua&&(Ra=O.author,ub=O.authorId);for(const Nb of t)t=wN.a.createInstance(Nb.begin,Nb.end,W.a.Gf(O.objectId),A,32,!1),this.apc.add(t),this.kaa.ob(A)||this.kaa.add(A,Object.assign(new GL,{y6e:aa,dCb:[],authorName:Ra,authorEmail:ub}))}}else h(null)}get lWh(){null==this.Kye&&(this.Kye=We.FindManager.createInstance(this,this.Sda,Yr.a.instance));return this.Kye}Hti(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1)}nXd(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocHeaderFooterSearchOnWac",!1)}highlight(b){var h=this.XCf(b);b=h?this.W9e(b):null;var t={};this.Hti()&&this.ga.Rb(Vc.a.t_f,2,t);if(t[Ng.a.On]){if(h){h={};t={};var A={};this.ga.Rb(Vc.a.a$d,2,h);this.ga.Rb(ab.a.$9d,2,t);this.ga.Rb(ab.a.b$d,2,A);if(b.text!=h.CommandValueId||b.matchCase!=t[Ng.a.On]||b.matchWholeWord!=A[Ng.a.On])AH(this.ib),this.ga.Rb(ab.a.findInDocument,
2,{CommandValueId:b.text,MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else t=this.lWh,t.RYa(),h&&t.find(b)}selectNextPrevHighlight(b){const h=this.lWh;return 0<h.Jj.Cia?(b?h.zRd():h.ARd(),h.Jj.oWe-1):-1}W9e(b){let h=Vk.a.none;b.matchCase&&(h|=Vk.a.matchCase);b.matchWholeWordOnly&&(h|=Vk.a.wholeWordOnly);return oj.a.createQuery(b.query,h)}XCf(b){return b&&!!b.query&&0<b.query.length}Gfe(){}$de(){}reset(){}dif(){}e5b(){if(this.ev){var b=this.nHh(this.CL);this.ev(b)}if(this.Gse){b=new tG;
const h=this.CL.count+this.apc.count>this.Bfh;b.totalResultCount=this.CL.count+this.apc.count;b.hasTooManyResults=h;h||(this.CL.fA(this.CL.count,this.apc),b.results=this.nHh(this.CL));this.Gse(b);this.apc.clear()}}nHh(b){var h;const t=[];var A=Object.assign(new PD.a,{nO:!1,aba:this.nXd(),oO:!0});A=this.eb.JDa(this.tF.value,A);for(const ua of b){var O=ua.begin;let Ra=ua.end;var aa=void 0;b=-1;let ub=null,Nb=0;if(32===ua.type){ub=Ty.x6e;Nb=3;b=A.count+ua.UOa;const Yb=({begin:O,end:Ra}=zL.a.f4i(this.kaa.J(ua.UOa).y6e,
O,Ra)).returnValue;aa=this.Gbb.JFd(Yb,O,Ra,Jr.a(ua.type));this.kaa.J(ua.UOa).y6e=Yb;this.kaa.J(ua.UOa).dCb.push(Object.assign(new HL,{begin:O,end:Ra}))}else{!this.nXd()||2!==ua.type&&4!==ua.type||(Nb=2===ua.type?1:2,ub=Ty.hvf);for(aa=0;aa<A.count;aa++)if(A.J(aa).id===ua.nodeId){b=aa;break}aa=this.Gbb.KFd(ua)}O=(null===(h=this.kaa)||void 0===h?0:h.ob(ua.UOa))?this.kaa.J(ua.UOa):null;if(0<=b||(null===O||void 0===O?0:O.authorName))b=Object.assign(new FL,{snippet:aa.vEd,subdocumentId:ub,subdocumentType:Nb,
startOffsetInSnippet:aa.uce,endOffsetInSnippet:aa.sce-1,paragraphIndex:b,startOffsetInParagraph:ua.begin-aa.uce,endOffsetInParagraph:ua.end-aa.sce-1,authorName:O?O.authorName:"",authorEmail:O?O.authorEmail:""}),t.push(b)}t.sort((ua,Ra)=>ua.paragraphIndex===Ra.paragraphIndex?ua.startOffsetInParagraph-Ra.startOffsetInParagraph:ua.paragraphIndex-Ra.paragraphIndex);return t}update(){}WNa(b,h){switch(b){case 0:h&&0<h.length&&!this.CL&&(u.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),
this.CL=new Mb.a);for(const t of h)this.CL.add(t)}}vnb(){}dispose(){}}Ty.x6e="Comment";Ty.hvf="HeaderFooter";Ty.nli="Image";Object(m.a)(Ty,"WordDocumentSearchProcessor",null,[159,9,160]);class IL extends wH{get mR(){return!this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",!1)}nXd(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocHeaderFooterSearchOnWac",!1)}constructor(b,
h,t,A,O,aa,ua,Ra,ub,Nb,Yb,bc,Dc,Pc){super();this.Na=Nb;this.MLa=null;this.W3=(jd,Cd)=>{jd=Cd.node;Cd=Cd.property;this.V$f(jd)&&Cd===Af.a.yo&&this.vEb(jd,3)};this.iha=(jd,Cd)=>{jd=Cd.node;!Cd.$zf&&this.V$f(jd)&&this.vEb(jd,1)};this.hlb=(jd,Cd)=>{jd=Cd.node;this.V$f(jd)&&this.vEb(jd,2)};this.tF=b;this.eb=h;this.ed=t;this.ib=A;this.hE=O;this.ml=Ra;this.Vb=ub;this.z6=aa;this.VB=ua;this.Wh=Yb;this.r0j=bc;this.R$g=W.a.create();this.Tae(this.W3,this.iha,this.hlb);Pc&&Pc.execute(jd=>this.gka=jd);Dc.execute(jd=>
{this.ska=jd})}submitDocumentContentExtractionSignal(){this.ska&&this.ska.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.ska?this.ska.generateDocumentSummary():Promise.resolve(null)}generateDocumentSummaryDetails(){return this.ska?this.ska.generateDocumentSummaryDetails():Promise.resolve(null)}highlightDocumentKeySentences(){if(this.ska){const b=this.o$h();return this.ska.nOl(b,this.UDa(b).toArray(),this.getRevision())}return Promise.resolve({success:!1,resultCount:0})}clearDocumentKeySentencesHighlights(){this.ska&&
this.ska.VQk()}getAllParagraphsInDocument(){const b=this.UDa(this.o$h());for(const t of this.Wh.mQ()){var h=xH.a.MPd(t.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new PD.a,{nO:!1,aba:!1,oO:!0}),t=this.eb.JDa(this.tF.value,h);h=[];const A=[];for(var O=0;O<t.count;++O){var aa=t.J(O);h.push(...this.xSl(aa,O));A.push(...this.z6.BRl(aa,O))}t=[];O=this.Wh.mQ();for(aa=0;aa<O.length;aa++)t.push(this.bJl(O[aa]));O={};O.images=
h;O.comments=t;O.highlights=A;b(O)}selectRange(b,h,t,A,O){const aa=Date.now(),ua={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.wSa();if(0>b||0>h||0>t||0>A||b>t||b===t&&h>A)throw Error("Provided select range offsets incorrect");const Pc=Object.assign(new PD.a,{nO:!1,aba:!1,oO:!0}),jd=this.eb.JDa(this.tF.value,Pc);if(t>=jd.count){const Cd=Sa.a.instance.resolve("Common.Comments.ICommentModel").mQ(),ee=t-jd.count;if(ee<Cd.length){O=-1;if(this.z6.kaa.ob(ee)){const fe=
this.z6.kaa.J(ee).dCb;for(var Ra=0;Ra<fe.length;Ra++)if(fe[Ra].begin===h){O=Ra;break}}this.MLa=-1!==O?Object.assign(new zH,{t6e:ee,QKc:O}):null;const Od=Cd[ee];v.AFrameworkApplication.xa.processAction(Vc.a.iT,2);v.AFrameworkApplication.xa.Rb(Vc.a.p7,2,null);v.AFrameworkApplication.xa.Rb(Vc.a.selectComment,2,Object.assign(new CL.a,{commentId:Od.id,e9:2,mR:this.mR}))}}else{this.MLa=null;var ub=jd.J(b),Nb=jd.J(t);if(!this.pZd(ub,h)||!this.pZd(Nb,A))throw Error("Provided select range offsets incorrect");
v.AFrameworkApplication.xa.processAction(Vc.a.iT,2);this.ltj(ub);var Yb=this.hE.te(ub,h);Ra=this.hE.Vz(Yb,pf.a.Tc(Nb,A+1));if(O){const Cd=Ra.toArray();h=[];for(const ee of Cd)h.push(this.APd(ee.node));h.join(" ").includes(O)||(ua.success=!1,ua.message="The text in clicked passage does not match the selected hit")}var bc=this.ml.value.ju,Dc=this.ib.hb.lb;Dc&&Dc.equals(Ra)&&this.ed.xca(bc,null);this.ed.xca(bc,Ra);ua.duration=Date.now()-aa;this.logMessage(ua)}}catch(Pc){ua.success=!1,ua.message=Pc.stack,
ua.duration=Date.now()-aa,this.logMessage(ua)}}search(b,h){this.wSa();this.z6.search(Object.assign(new uG,{query:b}),h)}searchV2(b,h){this.wSa();this.z6.searchV2(Object.assign(new uG,{query:b}),h)}selectNextPrevHighlight(b){this.wSa();return this.z6.selectNextPrevHighlight(b)}searchWithParam(b,h){this.wSa();this.z6.search(b,h)}searchWithParamV2(b,h){this.wSa();this.z6.searchV2(b,h)}highlight(b){this.wSa();this.z6.highlight(Object.assign(new uG,{query:b}))}highlightWithParam(b){this.wSa();this.z6.highlight(b)}getRevision(){return this.R$g.toString()}getSelectedText(){const b=
this.r0j.getSelectedText();return Object.assign(new Ax.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new PD.a,{nO:!1,aba:this.nXd(),oO:!0}),h=({Qq:aa}=this.$4l(b)).returnValue;if(h)return h;var t=this.ib.hb.lb;if(!t||!t.length)return null;h=t.Qa;t=t.Rc;let A=-1,O=-1;var aa=aa||this.eb.JDa(this.tF.value,b);b=null;for(let ua=0;ua<aa.count;ua++){const Ra=aa.J(ua);-1===A&&h.node.id===Ra.id&&(A=ua,b=Ra);-1===O&&t.node.id===
Ra.id&&(O=ua)}aa=null;5===(null===b||void 0===b?void 0:b.fDa)&&(aa=Ty.hvf);return Object.assign(new yH,{subdocumentId:aa,startParagraphIndex:A,startParagraphOffset:h.zj,endParagraphIndex:O,endParagraphOffset:t.Ep})}clearDocumentSelection(){AH(this.ib)}selectRangeV2(b,h,t,A,O,aa){const ua=Date.now(),Ra={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.wSa();if(0>h||0>t||0>A||0>O||h>A||h===A&&t>O)throw Error("Provided select range offsets incorrect");
var ub=Object.assign(new PD.a,{nO:!1,aba:!0,oO:!0});const Dc=this.eb.JDa(this.tF.value,ub);if(b==Ty.x6e)this.Ibj(t,A,Dc.count);else{ub=this.MLa=null;var Nb={};Nb.subdocumentId=b;Nb.startParagraphIndex=h;Nb.startParagraphOffset=t;Nb.endParagraphIndex=A;Nb.endParagraphOffset=O;ub=b==Ty.nli?this.x6h(Dc.J(h),Object.assign({isFloatingImage:!1,imageId:""},Nb)):this.bei(Dc.J(h),Dc.J(A),Object.assign({clickedPassage:aa},Nb),Ra);var Yb=this.ml.value.ju,bc=this.ib.hb.lb;(null===bc||void 0===bc?0:bc.equals(ub))&&
this.ed.xca(Yb,null);this.ed.xca(Yb,ub)}Ra.duration=Date.now()-ua;this.logMessage(Ra)}catch(Dc){Ra.success=!1,Ra.message=Dc.stack,Ra.duration=Date.now()-ua,this.logMessage(Ra)}}selectRangeV3(b){const h=Date.now(),t={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.wSa();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&
b.startParagraphOffset>b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var A=Object.assign(new PD.a,{nO:!1,aba:!0,oO:!0});const ua=this.eb.JDa(this.tF.value,A);if(b.subdocumentId==Ty.x6e)this.Ibj(b.startParagraphOffset,b.endParagraphIndex,ua.count);else{A=this.MLa=null;A=b.subdocumentId==Ty.nli?this.x6h(ua.J(b.startParagraphIndex),b):this.bei(ua.J(b.startParagraphIndex),ua.J(b.endParagraphIndex),b,t);var O=this.ml.value.ju,aa=this.ib.hb.lb;(null===aa||void 0===aa?0:aa.equals(A))&&
this.ed.xca(O,null);this.ed.xca(O,A)}t.duration=Date.now()-h;this.logMessage(t)}catch(ua){t.success=!1,t.message=ua.stack,t.duration=Date.now()-h,this.logMessage(t)}}o$h(){const b=Date.now(),h={activityName:"GetParagraphNodes",success:!0,message:"",duration:0},t=Object.assign(new PD.a,{nO:!1,aba:!1,oO:!0});h.duration=Date.now()-b;this.logMessage(h);return this.eb.JDa(this.tF.value,t)}UDa(b){const h=Date.now(),t={activityName:"GetParagraphContent",success:!0,message:"",duration:0},A=new Mb.a;for(const O of b)A.add(this.APd(O));
t.duration=Date.now()-h;this.logMessage(t);return A}x6h(b,h){if(h.isFloatingImage)return h=W.a.Gf(h.imageId),b=b.Mc.Db(h),b=wf.SelectionFactory.mq(b);const t=this.hE.te(b,h.startParagraphOffset);return b=this.hE.Vz(t,pf.a.Tc(b,h.startParagraphOffset+1))}getAuthorImageUrlFromClient(b,h){return Object(Rl.__awaiter)(this,void 0,void 0,function*(){var t=new Ii.a(b,"O365",h,b);if(!this.gka||!this.gka.getPersonaIconPropertiesArray)return null;t=yield this.gka.getPersonaIconPropertiesArray([t]);return 0<
t.length&&t[0].authorImageURL?Object.assign(new DL,{authorImageURL:t[0].authorImageURL,authorColor:t[0].authorColor,authorID:t[0].authorID}):null})}bei(b,h,t,A){if(!this.pZd(b,t.startParagraphOffset)||!this.pZd(h,t.endParagraphOffset))throw Error("Provided select range offsets incorrect");t.subdocumentId==Ty.hvf?v.AFrameworkApplication.xa.Rb(Vc.a.Njb,2,new dA.a(b)):v.AFrameworkApplication.xa.processAction(Vc.a.iT,2);this.ltj(b);b=this.hE.te(b,t.startParagraphOffset);h=this.hE.Vz(b,pf.a.Tc(h,t.endParagraphOffset+
1));if(t.clickedPassage){b=h.toArray();const O=[];for(const aa of b)O.push(this.APd(aa.node));O.join(" ").includes(t.clickedPassage)||(A.success=!1,A.message="The text in clicked passage does not match the selected hit")}return h}Ibj(b,h,t){const A=Sa.a.instance.resolve("Common.Comments.ICommentModel").mQ();h-=t;if(h<A.length){t=-1;if(this.z6.kaa.ob(h)){const O=this.z6.kaa.J(h).dCb;for(let aa=0;aa<O.length;aa++)if(O[aa].begin===b){t=aa;break}}this.MLa=-1!==t?Object.assign(new zH,{t6e:h,QKc:t}):null;
b=A[h];v.AFrameworkApplication.xa.processAction(Vc.a.iT,2);v.AFrameworkApplication.xa.Rb(Vc.a.p7,2,null);v.AFrameworkApplication.xa.Rb(Vc.a.selectComment,2,Object.assign(new CL.a,{commentId:b.id,e9:2,mR:this.mR}))}}wSa(){this.Vb&&(this.Vb.currentScope&&this.Vb.currentScope.name===$h.BB||this.Vb.mg($h.BB))}IQo(){this.R$g=W.a.create()}APd(b){if(b.WFb)return"";b=this.eb.text(b);return Tb.AParagraphNode.CU(b," ")}pZd(b,h){b=this.APd(b);return h<b.length}vEb(b,h){switch(h){case 1:case 2:case 3:this.IQo()}}logMessage(b){const h=
[Object.assign(new sa.a,{name:"Message",string:b.message})];Object(lb.a)(b.activityName,b.success,b.duration,h)}V$f(b){return!b.WFb&&this.vTc(b)}vTc(b){const h=this.tF.value;return!!h&&!!h.ud&&!!b.Mc&&b.Mc.id.equals(h.ud.id)}ltj(b){this.eb.OSc(b)?32===v.AFrameworkApplication.xa.Rb(Vc.a.rlb,2,new dA.a(b))&&v.AFrameworkApplication.xa.processAction(Vc.a.gjf,2):v.AFrameworkApplication.xa.Rb(Vc.a.p7,2,null)}Tae(b,h,t){this.VB&&(this.VB.Ro(b),this.VB.ku(h),this.VB.Lv(t))}$4l(b){let h=null;var t=this.Vb?
this.Vb.currentScope.name:"";if(!this.Wh.Ts||t!==vf.AFrame.xr&&t!==vf.AFrame.bM)return{returnValue:null,Qq:h};t=Array.indexOf(this.Wh.mQ(),this.Wh.Ts);if(0>t)return{returnValue:null,Qq:h};h=this.eb.JDa(this.tF.value,b);var A=xH.a.MPd(this.Wh.Ts.text[0]).split("\n");b=0;A=(1===A.length?A[0]:A.join(" ")).length-1;this.MLa&&t===this.MLa.t6e&&this.z6.kaa.ob(t)&&this.z6.kaa.J(t).dCb.length>this.MLa.QKc&&(b=this.z6.kaa.J(t).dCb[this.MLa.QKc].begin,A=this.z6.kaa.J(t).dCb[this.MLa.QKc].end);return{returnValue:Object.assign(new yH,
{startParagraphIndex:h.count+t,startParagraphOffset:b,endParagraphIndex:h.count+t,endParagraphOffset:A,subdocumentId:"Comment"}),Qq:h}}xSl(b,h){const t=[];if(12!=b.type)return t;t.push(...this.XSl(b,h));t.push(...this.CPl(b,h));return t}CPl(b,h){const t=[],A=ue.GraphIterator.$a(b);if(!A.dA())return t;let O=A.Sd();for(;O;){if(!this.uPa(O)){O=A.gt();continue}const aa=O.properties;aa&&Be.ImageReader.WSc(aa)&&t.push(this.uuj(aa,h,0,b.Mc,!0,O.id.toString()));O=A.gt()}return t}uPa(b){if(19!==b.type)return!1;
b=ue.GraphIterator.$a(b);if(!b.dA())return!0;let h=b.Sd();for(;h;){if(59===h.type)return!1;h=b.gt()}return!0}XSl(b,h){const t=[],A=b.Mc;if(A){if(!b.hasProperty(Af.a.En))return t;var O=b.ia(Af.a.En,null);if(!O)return t;b=b.ia(Af.a.sm,null);for(let ua=0;ua<O.length;++ua){var aa=O[ua];if(!aa)continue;aa=A.Db(aa);if(!aa||!Be.ImageReader.WSc(aa))continue;let Ra=0;0!=ua&&b&&ua-1<b.length&&(Ra=b[ua-1]);t.push(this.uuj(aa,h,Ra,A,!1,""))}return t}}uuj(b,h,t,A,O,aa){A=(new Sys.Net.WebRequest).getResolvedUrl()+
Be.ImageReader.Wua(b,A,this.Na,v.AFrameworkApplication.ta.lEa);const ua=b.ia(Gd.a.Pt,""),Ra={};Ra.base64Encoding=ua;Ra.url=A;Ra.width=Be.ImageReader.sD(b);Ra.height=Be.ImageReader.LI(b);Ra.altText=Be.ImageReader.iX(b);Ra.description=Be.ImageReader.xOa(b);Ra.imageId=aa;Ra.isFloatingImage=O;return{data:Ra,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:t,endOffsetInParagraph:t+1}}bJl(b){return{data:{comment:EL(b),authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},
startParagraphIndex:-1,endParagraphIndex:-1,startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(m.a)(IL,"WordDocumentContentExecutor",wH,[]);class vG{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(m.a)(vG,"BaseDocumentHelper",null,[230]);class JL extends vG{constructor(b){super();this.qBl=b}get Z3b(){const b=this.qBl.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return Jb.App.ya.jb.isEditingAllowed}author(){var b;return null===(b=this.Z3b)||
void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.Z3b)||void 0===b?void 0:b.creationDate}}Object(m.a)(JL,"WordDocumentHelper",vG,[]);class KL{constructor(b){this.cFi=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.Vxf(b.htmlText)}getId(){return"InsertContentExecutor"}Vxf(b){return this.executeCommand(qa.a.MBa,b)}executeCommand(b,h){const t=new ji.DictionaryPropertySet;t.setValue(Gd.a.EO,h);t.setValue(Gd.a.Yha,!1);h=this.cFi.processAction(b,1);32===h&&(h=this.cFi.Rb(b,2,t));return h}}
Object(m.a)(KL,"WordInsertContentExecutor",null,[157,158]);var xN=c(1691),yN=c(1692);class LL{constructor(b,h,t,A){this.Rpc="undefined";this.p$f="Something went wrong with retrieving a summary. Please try again.";this.Lwm=(O,aa,ua,Ra,ub)=>Bv.CX(O,aa,ua,Ra,this.RB,ub);this.zge=(O,aa,ua,Ra,ub)=>{if(1===ua)return this.r1j?32:8;O=TF.getSelectedText();O=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,TF.bQd(O));ub[Ck.a.LabelText]=O;return 32};this.ukf=(O,aa,ua)=>
{if(1===ua)return 32;const Ra={};this.ska?this.ska.generateDocumentSummary().then(ub=>{ub||(ub=this.p$f,u.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));Ra.additionalData=this.F8e(ub);this.ga.Rb(ab.a.A7,2,Ra)}).catch(()=>{u.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");Ra.additionalData=this.F8e(this.p$f);this.ga.Rb(ab.a.A7,2,Ra)}):(u.ULS.sendTraceTag(509723397,1303,15,"Share with summary: Search provider manager is unavailable."),
Ra.additionalData=this.F8e(this.p$f),this.ga.Rb(ab.a.A7,2,Ra));return 32};this.$Eo=(O,aa,ua)=>{if(1===ua)return this.QLm()?32:2;2===ua&&(O={token:v.AFrameworkApplication.accessToken,files:E.c(this.GOl()),type:"MultiFilesDeckGeneration"},O=Object.assign(new xN.a,{selection:Object.assign(new Ax.a,{neighborhood:"",mentionStart:0,mentionLength:0}),launchData:Object.assign(new Eu.a,{landingTab:"All",data:O}),entryPoint:38}),this.ga.Rb(ab.a.Z7,2,O));return 32};this.RB=b;this.ga=h||v.AFrameworkApplication.xa;
this.Na=t;this.b1j=(this.tw=!!v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.uO)&&!!this.Na&&this.Na.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");this.r1j=!!this.Na&&this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1);A&&A.execute(O=>{this.ska=O})}Ub(){this.ga.gb(Vc.a.vsh,yc.a.frame,this.Lwm,1028);this.ga.gb(Vc.a.zge,yc.a.frame,this.zge,1028);this.ga.gb(Vc.a.PZh,yc.a.frame,this.ukf,1028);this.ga.gb(Vc.a.vuj,yc.a.frame,this.$Eo,1028);this.b1j&&
(this.Rpc=Jb.App.ya.oI.getWindowMode(),this.kSh(this.Rpc),Jb.App.ya.oI.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.Rpc&&(this.Rpc=h,this.kSh(this.Rpc))}))}QLm(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",!1)&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",!1)}kSh(b){"DP"===b&&oh.UISurfaces.uu().then(h=>{h.selectors.getTabbedTaskPaneCount()||
this.ga.Rb(Vc.a.vsh,2,{SourceControlId:"smartlookupAuto"});return null})}F8e(b){return{["documentSummary"]:b}}GOl(){const b=new yN.a("Word",v.AFrameworkApplication.K.kb("EditDocInClientUrl"),v.AFrameworkApplication.K.kb("BreadcrumbBrandUrl"),"",v.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,(new Date).toLocaleString()),h=[];Array.add(h,b);return h}}Object(m.a)(LL,"WordInsightsActor",null,[]);class xE{constructor(){this.Wed=this.pP=null}s0a(){return this.qDb()}U6h(){return this.qDb()}S6h(){return null}qpo(b,
h,t){this.pP||(this.pP=this.sFd());this.pP.NO(b,h,t)}rpo(b,h,t){this.pP||(this.pP=this.sFd());this.pP.rbg(b,h,t)}Mno(b,h){this.Wed||(this.Wed=null);this.Wed&&this.Wed.rbg(b,h)}OMb(b,h){this.pP||(this.pP=this.sFd());this.pP.OMb(b,h)}a_d(b){this.pP||(this.pP=this.sFd());this.pP.a_d(b)}z7n(){this.pP&&this.pP.jhc()}gbo(){this.pP&&this.pP.zee()}Zmo(){var b=v.AFrameworkApplication.K.pc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);b=window.performance.now()-xE.zAi<=b;b||(xE.zAi=window.performance.now());
return b}dispose(){this.pP&&(this.pP.dispose(),this.pP=null)}get zGb(){return this.pP?this.pP.isVisible:!1}}xE.zAi=0;Object(m.a)(xE,"InsightsManager",null,[963,9]);class mF{constructor(b,h,t,A,O,aa=!0,ua=null,Ra=null){this.i5=this.gE=this.uKa=null;this.zuc=!1;this.Ada=null;this.Vb=h;this.$Ub=aa;this.iPg=Ra?Ra:new vG;this.qz=ua;this.Zo=b;this.$Ub&&(Sa.a.instance.Ma("Common.App.SearchCommon.SearchHostRuntime")&&(this.Ada=Sa.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").sof()),this.Hbb=
Sa.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.Axb=this.Hbb.pOc())}clb(b){if(this.$Ub){b=b.rawEvent;try{var h=E.a(b.data)}catch(t){u.ULS.sendTraceTag(595161728,1303,15,this.uT("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=0;this.gE&&(b=this.gE.entryPoint);this.Hbb.Hrf(this.i5,this.iPg,this.M7b(),b).then(t=>{h.data=t;this.Ylb(h)});break;case 118:h.data=this.gE?this.gE:Object.assign(new iu.a,{selection:Object.assign(new Ax.a,
{neighborhood:this.uKa.neighborhood,mentionStart:this.uKa.mentionStart,mentionLength:this.uKa.mentionLength})});this.Ylb(h);break;case 103:b=E.a(Object(Da.a)(String,h.data));km.sendTelemetryEvent(b);break;case 206:this.Hbb.Hsf(h.data).then(t=>{h.data=t;this.Ylb(h)});break;case 112:h.data.shiftPressed?(ba.a.jj&&document.activeElement.blur(),this.Zo.OSd(0,null,2,null,null),u.ULS.sendTraceTag(592545156,1303,50,this.uT("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.Zo.hPc(0,null,2,null,null),
u.ULS.sendTraceTag(592545155,1303,50,this.uT("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.jna()}}}B4c(b){if(this.Ada){var h=0;this.gE&&(h=this.gE.entryPoint);this.Hbb.Hrf(this.i5,this.iPg,this.M7b(),h).then(t=>{km.Hcj("SearchFromHost",this.i5);this.gE.launchData||(this.gE.launchData=new Eu.a);const A=rG();try{this.Ada.search(this.gE,t,v.AFrameworkApplication.userSessionId,A,b),this.Hbb.pvn(O=>{km.Hcj("SearchFromHostWithToken",this.i5);this.Ada.searchAuthenticatedProviders(this.gE,
t,v.AFrameworkApplication.userSessionId,A,null,O)})}catch(O){km.iz("BaseSmartLookupPane - Fail to search from host. Error: "+O,10)}}).catch(t=>{km.iz("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+t.toString(),10)})}}khc(b){if(this.$Ub){var h=km,t=h.khc,A=this.i5;b=Math.round(window.performance.now()-b);var O=this.gE?uE[this.gE.entryPoint]:"",aa=this.Hbb.pOc(),ua=this.Hbb.wOl(),Ra=this.gE?this.gE.entryPoint:0;t.call(h,A,b,O,aa,ua,v.AFrameworkApplication.sZe,this.zuc,
18===Ra||19===Ra||15===Ra)}}}Object(m.a)(mF,"BaseSmartLookupPane",null,[218,9]);class nF{constructor(b){this.messageType=null;this.messageType=b}}Object(m.a)(nF,"InsightsMessage",null,[]);class oF extends nF{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(m.a)(oF,"InsightsMessageWithContent",nF,[]);class ML extends oF{constructor(b){super($h.G7m,b)}}Object(m.a)(ML,"InsightsMessageAppProperties",oF,[]);class NL extends oF{constructor(b){super($h.T7m,b)}}Object(m.a)(NL,
"InsightsMessageSelection",oF,[]);class OL extends nF{constructor(){super($h.V7m)}}Object(m.a)(OL,"InsightsMessageTakeFocus",nF,[]);class pF extends mF{constructor(b,h,t,A,O=null,aa=null,ua=null,Ra=!0,ub=null,Nb=null){super(h,t,O,aa,ua,Ra,ub,Nb);this.Udd=this.LA=this.hj=null;this.ppd=!1;this.Vjd=b;this.gtc=this.$Ub?rH(this.Axb):v.AFrameworkApplication.avm;this.CZ();this.m1f();this.Mp=A;this.YNg=0}get isVisible(){return!1}CZ(){this.hj=this.Vjd.pHc();v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob.ejb&&
this.hj.NPn(b=>{b===this.hj&&(this.zee(),this.jhc())});this.yxf(this.hj.PSa.dth);this.hj.qm()}yxf(b){b.style.overflow="hidden";const h=Rb.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.LA=h;b.appendChild(this.LA);this.LA.id=$h.awf}m1f(){Hf.a.addHandler(this.LA,"load",Object(z.a)(this,this.xdc,"onIFrameLoad"));Hf.a.addHandler(this.LA,"error",Object(z.a)(this,this.blb,"onIFrameError"));$addHandler(window,"message",Object(z.a)(this,
this.clb,"onIFrameMessage"))}iig(){Hf.a.removeHandler(this.LA,"load",Object(z.a)(this,this.xdc,"onIFrameLoad"));Hf.a.removeHandler(this.LA,"error",Object(z.a)(this,this.blb,"onIFrameError"));$removeHandler(window,"message",Object(z.a)(this,this.clb,"onIFrameMessage"))}dispose(){this.LA&&(this.iig(),this.LA.parentNode.removeChild(this.LA),this.LA=null);this.hj&&(this.Vjd.T3b(this.hj),this.hj=null)}NO(b,h,t){this.i5=h;this.Udd=null;this.YNg=t;this.zuc=!b.mentionLength;this.ppd=!1;u.ULS.sendTraceTag(6295947,
1303,50,this.uT("Start to show Insights"));this.uKa=b;this.gtc&&this.gtc.length?this.LA.src=this.gtc:(this.LA.src=pF.pLi,u.ULS.sendTraceTag(6295948,1303,15,this.uT("The Insights URL config setting is null or empty")));this.Mp.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.hj.RX||this.hj.s1f(Object(z.a)(this,this.bjn,"onInsightsTaskPaneHidden"));this.$Ub&&this.B4c(!1);b=window.performance.now();this.Vjd.showTaskPane(this.hj);this.hj.qm();this.khc(b)}rbg(b,h,t){this.gE=b;this.NO(Object.assign(new kF.a,
{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,t)}OMb(){}a_d(){}jhc(){this.LA.src===this.gtc&&this.ppd&&(this.Vb.mg($h.BB),this.Ylb(new OL))}zee(){this.LA&&yd.FocusManager.zJ(this.LA.contentWindow)}Kaf(){this.LA.src=pF.pLi;this.hj.rm()}jna(){this.Vjd.hideTaskPane(this.hj);this.Kaf()}bjn(b){b===this.hj&&this.jna()}xdc(){u.ULS.sendTraceTag(6295951,1303,50,this.uT("The iframe is successfully loaded in Insights task pane"))}blb(){u.ULS.sendTraceTag(6295952,
1303,15,this.uT("The iframe failed to load in Insights task pane"))}clb(b){const h=b.rawEvent;if(h.source===this.LA.contentWindow)if(this.$Ub)super.clb(b);else{let t;try{t=E.a(h.data)}catch(A){u.ULS.sendTraceTag(6295953,1303,15,this.uT("Message data [{0}] failed to deserialize.",h.data));return}if(Za.c(t.messageType))u.ULS.sendTraceTag(6295954,1303,15,this.uT("Message data [{0}] is in wrong format.",h.data));else switch(t.messageType){case $h.H7m:this.Ylb(new ML(this.fTl()));break;case $h.U7m:this.Ylb(new NL(this.uKa));
break;case $h.O7m:this.ppd=!0;this.zee();this.jhc();u.ULS.sendTraceTag(6295955,1303,50,this.uT("Insights pane rendering is completed"));break;case $h.W7m:b=t.messageContent;this.Udd=b.clientCorrelationId;this.i5!==b.appCorrelationId&&u.ULS.sendTraceTag(6403778,1303,15,this.uT("App correlation ID on client {0} does not match one on server {1}",this.i5,b.appCorrelationId));break;case $h.N7m:t.messageContent?(ba.a.jj&&document.activeElement.blur(),this.Zo.OSd(0,null,2,null,null),u.ULS.sendTraceTag(6604741,
1303,50,this.uT("Insights UX lost focus through Ctrl + Shift + F6"))):(this.Zo.hPc(0,null,2,null,null),u.ULS.sendTraceTag(6604742,1303,50,this.uT("Insights UX lost focus through Ctrl + F6")));break;case $h.K7m:t.messageContent.keyCode===rc.a.qIa&&this.jna();break;case $h.L7m:try{this.ppd=!1,localStorage.setItem($h.qBi,"true")}catch(A){u.ULS.sendTraceTag(17961859,1303,10,this.uT("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}fTl(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=
this.i5;3===v.AFrameworkApplication.ta.Ob.jm?b.applicationName=$h.r_o:4===v.AFrameworkApplication.ta.Ob.jm&&(b.applicationName=$h.spn);b.applicationVersion=v.AFrameworkApplication.buildVersion;var h=Sf.a.lg(v.AFrameworkApplication.lcid);h=h?h.name:null;b.market=qH(h);b.uiLanguage=h;b.sessionId=v.AFrameworkApplication.userSessionId;b.parentalControl=$h.qVf;b.clientType="user";b.legalAgreed=this.nUl();b.defaultDefineTab=1===this.YNg?"true":null;return b}uT(b,...h){const t={};this.i5&&(t[$h.Nrj]=this.i5);
this.Udd&&(t[$h.CAo]=this.Udd);t[$h.Orj]=String.format.apply(null,[b].concat(h));return E.c(t)}M7b(){return 5}nUl(){try{const b=localStorage.getItem($h.qBi);return!!b&&"true"===b}catch(b){return u.ULS.sendTraceTag(17961860,1303,10,this.uT("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}Ylb(b){b=E.c(b);this.LA.contentWindow.postMessage(b,ia.a.getOrigin(this.gtc))}}pF.pLi="about:blank";Object(m.a)(pF,"InsightsPane",mF,[]);class PL{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(m.a)(PL,
"SmartLookupTaskPaneProps",null,[]);class QL{}Object(m.a)(QL,"ActionDescriptor",null,[]);class RL extends mF{constructor(b,h,t,A=null,O=null,aa=null,ua=!0,Ra=null,ub=null){super(h,t,A,O,aa,ua,Ra,ub);this.qSe=!!v.AFrameworkApplication.ta&&!!v.AFrameworkApplication.ta.Ob&&v.AFrameworkApplication.ta.Ob.iEf;this.ys=this.jNe=!1;this.Z4j=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.X4j=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",
844);this.b5j=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.a5j=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);ua||km.iz("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.CAa=b;this.CVg=rH(this.Axb)}get isVisible(){return this.ys}OMb(b,h){this.gE=b;this.uKa=b=Object.assign(new kF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,
mentionLength:b.selection.mentionLength});this.zuc=!b.mentionLength;this.i5=h;this.B4c(!1)}a_d(b){this.gE=b;this.Jic(Object.assign(new kF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}NO(b,h){this.i5=h;this.Jic(b,!0)}rbg(b,h,t){this.gE=b;this.NO(Object.assign(new kF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,t)}jna(){this.tca();this.CAa.hideTaskPane()}Jic(b,
h){fc.SessionStatusManager.instance.vH&&this.Ada?(this.uKa=b,this.zuc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?v.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.CAa.updateTaskPane(null),h&&this.f8n()):(h&&this.B4c(!1),this.jNe=!this.jNe,this.CAa.updateTaskPane(this.Pz())):(h&&this.B4c(this.isVisible),this.CAa.showTaskPane(this.Pz())),this.khc(b)):(this.CAa.showTaskPane(this.Pz()),km.B7n(fc.SessionStatusManager.instance.vH,!!this.Ada,this.gE?
uE[this.gE.entryPoint]:"",this.Hbb.pOc(),v.AFrameworkApplication.sZe,this.zuc))}f8n(){if(!this.gE){const b=Object.assign(new Ax.a,{neighborhood:this.uKa.neighborhood,mentionStart:this.uKa.mentionStart,mentionLength:this.uKa.mentionLength});this.gE=Object.assign(new iu.a,{selection:b,userIntent:null,entryPoint:0,launchData:null})}this.B4c(this.isVisible)}K7n(){const b=new QL;b.transactionId=this.i5;b.actionType=15;b.channelId=$h.channelId;this.Ylb(b)}clb(b){const h=b.rawEvent;document.getElementById($h.BB)&&
h.source!==document.getElementById($h.BB).contentWindow||this.zIn(b)}zIn(b){const h=b.rawEvent;let t;try{t=E.b(h.data)}catch(A){u.ULS.sendTraceTag(545604257,1303,15,this.uT("Message data from Serplet [{0}] failed to deserialize.",h.data));return}switch(t.actionType){case 32:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(vc.a.kEb()>=this.Z4j?this.CAa.updateTaskPane(this.p$e(this.X4j)):vc.a.kEb()>=this.b5j&&this.CAa.updateTaskPane(this.p$e(this.a5j)));
break;case 33:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.CAa.updateTaskPane(this.p$e(t.data));break;case 42:this.CAa.updateTaskPane(this.g8k(t.data));break;case 43:this.CAa.updateTaskPane(this.Pz());break;default:super.clb(b)}}dispose(){}initialize(){this.CZ();this.lia()}CZ(){this.CAa.pHc()}lia(){const b=this.Vb.fe($h.BB);b.parent=vf.AFrame.qp;b.zH=!0}nbo(){this.Vb.mg($h.BB)}tca(){this.G2a()&&this.Vb.mg(this.Vb.fT)}m1f(){$addHandler(window,
"message",Object(z.a)(this,this.clb,"onIFrameMessage"))}iig(){$removeHandler(window,"message",Object(z.a)(this,this.clb,"onIFrameMessage"))}G2a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===$h.BB}Ylb(b){b=E.c(b);document.getElementById($h.BB)&&document.getElementById($h.BB).contentWindow.postMessage(b,ia.a.getOrigin(this.CVg))}uT(b,...h){const t={};this.i5&&(t[$h.Nrj]=this.i5);t[$h.Orj]=String.format.apply(null,[b].concat(h));return E.c(t)}M7b(){return Rh.a("isSharedUXDarkModeOn")&&
appChrome.api.isSharedUXDarkModeOn()?3:0}LRi(){if(this.Ada)this.Ada.onPaneThemeChanged(this.M7b());return Rh.a("getTheme")?appChrome.api.getTheme():null}jhc(){}zee(){document.getElementById($h.BB)&&yd.FocusManager.zJ(document.getElementById($h.BB).contentWindow)}blb(){km.iz("ReactSmartLookupPane - Iframe component failed to load.",10)}xdc(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||km.iz("ReactSmartLookupPane - Onload detected no network.",
50)}qNl(){return this.gE?10===this.gE.entryPoint?2===v.AFrameworkApplication.ta.Ob.jm?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.gE.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.gE.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.gE.entryPoint||38===this.gE.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}Pz(){var b=CommonUIStrings.L_SmartLookupPaneTitle;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",
!1)&&(b=this.qNl());const h=new PL;h.src=this.CVg;h.id=$h.BB;h.refreshPane=this.jNe;h.onError=Object(z.a)(this,this.blb,"onIFrameError");h.onLoad=Object(z.a)(this,this.xdc,"onIFrameLoad");h.title=b;fc.SessionStatusManager.instance.vH?this.Ada||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=0);b=Object.assign(new em.a,{title:b,hideHeader:!1,width:$h.width,location:$h.Esn,contentProps:h,
isModernPane:!0,onOpen:()=>{this.nbo();this.ys=!0;this.m1f();Rh.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(z.a)(this,this.LRi,"onThemeIdChanged"));v.AFrameworkApplication.ta.updateCommandUI();if(this.Ada)this.Ada.onPaneStateChanged(!0)},onClose:()=>{this.K7n();this.tca();this.ys=!1;this.iig();Rh.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(z.a)(this,this.LRi,"onThemeIdChanged"));v.AFrameworkApplication.ta.updateCommandUI();
if(this.Ada)this.Ada.onPaneStateChanged(!1)}});this.qSe&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}g8k(b){const h=this.Pz();h.title=b;h.contentProps.title=b;return h}p$e(b){const h=this.Pz();h.resizeWidth=b;return h}}Object(m.a)(RL,"ReactSmartLookupPane",mF,[]);class SL{pHc(){const b=new Fo.CuiHelper(tl.a.HYa,WordEditorIntl.WordEditorStrings);return Oo.a.instance.uJh($h.BB,$h.qec,$h.width,$h.Weg,b)}showTaskPane(b){Oo.a.instance.showTaskPane(b)}hideTaskPane(b){Oo.a.instance.hideTaskPane(b)}T3b(b){Oo.a.instance.T3b($h.BB,
b)}}Object(m.a)(SL,"WordInsightsPaneHandler",null,[190]);class TL{pHc(){Oo.a.instance.lNa()}showTaskPane(b){oh.UISurfaces.uu().then(h=>{h.showTaskPane($h.BB,b);return null})}updateTaskPane(b=null){oh.UISurfaces.uu().then(h=>{h.setSelectedTaskPane($h.BB);b&&h.updateTaskPane($h.BB,b);return null})}hideTaskPane(){oh.UISurfaces.uu().then(b=>{b.hideTaskPane($h.BB,2);return null})}}Object(m.a)(TL,"WordReactSmartLookupPaneHandler",null,[189]);class UL extends xE{constructor(b,h){super();this.$w=b;this.ib=
h}sFd(){const b=!!v.AFrameworkApplication.ta&&!!v.AFrameworkApplication.ta.Ob&&v.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return v.AFrameworkApplication.ta&&v.AFrameworkApplication.ta.Ob&&v.AFrameworkApplication.ta.Ob.cDf?new RL(new TL,ej.a.instance,yd.FocusManager.instance(),Sa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Sa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Sa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),
b,Sa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Sa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new pF(new SL,ej.a.instance,yd.FocusManager.instance(),Sa.a.instance.resolve("Common.Utils.IAriaNotifier"),Sa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Sa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Sa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Sa.a.instance.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
Sa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}qDb(){return this.$w.getSelectedText()}S6h(){if(!this.ib||!this.ib.hb||1>this.ib.hb.length)return null;var b=this.ib.hb.lb.Qa;b=null==b?null:Wa.FormattingReader.Ar(b);return(b=null==b?null:Sf.a.lg(Wa.FormattingReader.language(b)))?b.name:""}s0a(){return this.$w.urf()}U6h(){return this.$w.urf()}Tti(){return this.$w.nAm()}}Object(m.a)(UL,"WordInsightsManager",xE,[]);var zN=c(172);class VL{}Object(m.a)(VL,"CommandMetadataResponse",null,
[]);class QD{constructor(){this.dwf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){zN.PrivacyDialogManager.wge()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=new VL;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));
if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const t=appChrome.selectors.getControlIconSet(b.commandId),A=Array(2);A[0]=t["default"];A[1]=t.icon32;h.svgData=this.getCommandIconSvg(A)}catch(t){return null}return h}getCommandIconSvg(b){if(!this.dwf)return"";
for(let h=0;h<b.length;h++){const t=b[h];if(t in this.dwf)return this.dwf[t]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const t={};t.featureArea=QD.Csl;h.telemetryGroup=t;h.appData=b;return h}}QD.qji="FA000000012";QD.queryPrefix="AssetID=";QD.Csl="SearchPane";Object(m.a)(QD,"BaseSerpletExecutor",null,[193,158]);
class XL extends QD{constructor(b,h){super();this.ga=b;this.ib=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Rb(qa.a.EHb,2,null);break;case 1:this.ga.Rb(Vc.a.YNb,2,null);break;case 2:this.ga.Rb(qa.a.digitalPrintToSway,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Rb(ab.a.CVd,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Rb(ab.a.GMb,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Rb(ab.a.$hf,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};AH(this.ib);this.ga.Rb(ab.a.$hf,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Rb(ab.a.findInDocument,2,h)}openNavigationPane(){this.ga.Rb(Vc.a.Eic,2,null)}openSerpletTaskPane(){this.ga.Rb(ab.a.Api,2,null)}sendAutoLaunchSearchRequest(){this.ga.Rb(ab.a.vVd,2,null)}getAllIcons(){const b=
{};for(const t of Object.keys(window))if(t.startsWith("word")){var h=window[t];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(A=>b[A.id]=JSON.stringify(A)))}return b}}Object(m.a)(XL,"WordSerpletExecutor",QD,[]);class YL extends tH{constructor(){super();this.HKe=null;this.zx=()=>{v.AFrameworkApplication.m_&&(this.akl(),$q.a.Bl().then(()=>this.HKe.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){v.AFrameworkApplication.m_&&(this.HKe.Ma("WordEditor.Insights.WordInsightsActor").Ub(),
v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&v.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?v.AFrameworkApplication.K.Wo(this.zx):super.init())}yc(b){super.yc(b);this.HKe=b;b.ha("Box4.Insights.Box4InsightsSelection",()=>new Jl.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance();b.ha("WordEditor.Insights.WordInsertContentExecutor",()=>new KL(v.AFrameworkApplication.xa)).as("Common.App.SearchCommon.IInsertContentExecutor").singleInstance();
b.ha("WordEditor.Insights.WordSerpletExecutor",()=>new XL(v.AFrameworkApplication.xa,he.a.instance)).as("Common.App.SearchCommon.ISerpletExecutor").singleInstance();b.ha("WordEditor.Insights.AugloopSearchProviderManager",()=>new OD(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"),b.resolve("Box4.Search.IFindManagerHelper"),nL.a.instance,Qe.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"))).as("WordEditor.Insights.IAugloopSearchProviderManager").singleInstance();b.ha("WordEditor.Insights.WordDocumentContentExecutor",
()=>{const h=new Ty(new Pg.a(()=>Jb.App.ya?Jb.App.ya.jb.Wc:null),b.resolve("Box4.IParagraphReader"),zL.a.instance,v.AFrameworkApplication.K,Qe.a.instance,nL.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),v.AFrameworkApplication.xa,he.a.instance,b.resolve("Box4.ISelectionFactory"));h.initialize();return new IL(new Pg.a(()=>Jb.App.ya?Jb.App.ya.jb.Wc:null),b.resolve("Box4.IParagraphReader"),pc.InteractiveViewManager.instance,he.a.instance,b.resolve("Box4.ISelectionFactory"),
h,Jb.App.jk.Kl.af(12),new Pg.a(()=>Jb.App.ya.jb),yd.FocusManager.instance(),v.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Sa("WordEditor.Insights.IAugloopSearchProviderManager"),b.Sa("Common.App.People.IExternalPeopleAPI"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").singleInstance();b.ha("WordEditor.Insights.WordInsightsManager",()=>new UL(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").singleInstance();
b.ha("WordEditor.Insights.WordInsightsActor",()=>new LL(b.We("Common.App.Insights.IInsightsManager"),v.AFrameworkApplication.xa,v.AFrameworkApplication.K,b.Sa("WordEditor.Insights.IAugloopSearchProviderManager"))).singleInstance();b.ha("Common.App.SearchCommon.IDocumentHelper",()=>new JL(b.Sa("WordEditor.Extension.DocumentProperties"))).singleInstance()}}Object(m.a)(YL,"WordInsightsPackage",tH,[]);class AN{}Object(m.a)(AN,"ScalingStep",null,[]);class ZL{constructor(b,h,t){this.Ltc=!1;this.cP=null;
this.GAc=this.MUb=!1;this.uXa=[];this.hce=A=>{this.T9&&this.T9!==A&&appChrome.api.dispatch(this.Jbi(!1))};h.execute(A=>{this.cP=A});b.gx(Object(z.a)(this,this.bnn,"onProcessSetSelectionFinished"));this.Dp=t}r7b(b,h,t){const A=[];for(const O of b)A.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:O},t));return A}cai(b){const h=[];for(let t=0;4>t;t++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>t?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",
{type:"GalleryToFlyout",controlId:b},void 0));return h}Jbi(b){const h=[];if(b)switch(this.T9){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.cai("PictureStyles"));h.push(...this.r7b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.uXa.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.r7b(b,"MoveToOverflow"));break;case "Table":this.GAc||
h.push(...this.cai("TableStyles"));h.push(...this.r7b(this.uXa,"DropLabel",this.GAc?0:void 0));b=this.uXa.slice().reverse();h.push(...this.r7b(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.r7b(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.uXa.slice().reverse(),h.push(...this.r7b(b,"MoveToOverflow"))}else for(const t of this.uXa)h.push(appChrome.actions.removeControlScalingStepsFromTab(t,"Home"));return h}c$c(b){const h={};for(const t of b)try{h[t]=appChrome.selectors.getModelType(t)}catch(A){this.AH("Error",
"GetModelType failed for "+t)}Jb.App.ya.NLd(h)}qLo(b){if(0!==b.length){var h=[],t={},A=!1;for(const O of b)try{if(appChrome.selectors.isControlDefined(O))t[O]=appChrome.selectors.getModelType(O);else{A=!0;break}}catch(aa){this.AH("Error","GetModelType failed for "+O);A=!0;break}if(A)this.T9=void 0,this.Hle(!1);else{if("Image"===this.T9&&!this.MUb)h.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.MUb=!0;else if(this.MUb){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));A=
appChrome.selectors.getVisibleControlsInGroup("Font");for(const O of A)t[O]=appChrome.selectors.getModelType(O);this.MUb=!1}Jb.App.ya.NLd(t);this.uXa=b;t=[];for(const O of b)appChrome.selectors.isControlDisabled(O)&&t.push(O);0<t.length&&this.AH("Disabled",t.join(","));0<this.uXa.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",this.uXa)),h.push(...this.Jbi(!0)),this.Ltc=!0);appChrome.api.dispatch(h)}}}Hle(b){if(b||
this.Ltc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.Ltc=b;if("Image"===this.T9||this.MUb){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const t=appChrome.selectors.getVisibleControlsInGroup("Font");this.c$c(t)}this.MUb=!b}appChrome.api.dispatch(h)}}tTa(){this.Ltc&&this.Dp&&this.Dp.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}bnn(b,h){!v.AFrameworkApplication.ta.Ob.qic&&"Home"===appChrome.selectors.getSelectedTabId()&&
this.cP&&h.sl&&h.sl.lb&&0!==h.sl.length?(b=()=>{let t=[],A=!1;var O=this.cP.contentType,aa=appChrome.selectors.getActiveContextualTabIds();O.includes("Image")?(this.hce("Image"),this.T9&&"Image"===this.T9?A=!0:(t="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.T9="Image")):O.includes("Table")&&0<=aa.indexOf("Table")?(O=!(hi.a.instance.lb.kFa||hi.a.instance.lb.Lw||
hi.a.instance.lb.bHb),(aa="Table"===this.T9&&O!==this.GAc)?this.hce("TableCellEdit"):this.hce("Table"),!this.T9||"Table"!==this.T9||aa?(O?(t=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.GAc=!0):(t="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),this.GAc=!1),this.T9="Table"):A=!0):
O.includes("Hyperlink")&&(this.hce("Hyperlink"),this.T9&&"Hyperlink"===this.T9?A=!0:(t=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.T9="Hyperlink"));A?this.Ltc||(this.c$c(this.uXa),this.Hle(!0),this.tTa()):0<t.length?(this.qLo(t),this.tTa()):this.Hle(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.Hle(!1)}AH(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};h=new yk.a;h.name="Events";
h.dataFields=uh.a.hC(b);h.durationMs=window.performance.now();ja.a.XGa(h,"TellMeWAC.")}}Object(m.a)(ZL,"AdaptiveTabGroupUpdater",null,[]);class $L{constructor(){this.W=null;this.oen=()=>{v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ha("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new ZL(this.W.resolve("Box4.ISelectionManager"),this.W.Sa("Common.IActionContextProvider"),this.W.Sa("Common.ISystemInitiatedFeedback"))).singleInstance(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}yc(b){this.W=b}init(){mD.a(1,this.oen)}dispose(){}}Object(m.a)($L,"PackageManager",null,[1,2]);const BN=(b,h,t)=>1===t?32:2===t?(c.e(5).then(c.bind(null,2022)).then(A=>{A.createAndShowDevToolsMenu()}),32):2;class BH{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))v.AFrameworkApplication.xa.pa(Vc.a.Sag,yc.a.frame,BN),null!==sessionStorage.getItem("devToolsRefresh")&&c.e(5).then(c.bind(null,2022))}dispose(){}yc(){}static main(){P.a.instance.Gc(new BH)}}Object(m.a)(BH,"WordDevToolsPackage",null,[1,2]);c(587);class CH{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(m.a)(CH,"FormattingData",null,[]);class aM extends CH{constructor(){super();this.hyperlinkData=null}}Object(m.a)(aM,"RichContentCommandData",
CH,[]);class aj{constructor(){aj.$i.add(Vc.a.x6a);aj.$i.add(Vc.a.tOb);aj.$i.add(Vc.a.Bjc);aj.$i.add(Vc.a.vY);aj.$i.add(Vc.a.kOf);aj.$i.add(Vc.a.LXf);aj.$i.add(Vc.a.deleteComment);aj.$i.add(Vc.a.XHc);aj.$i.add(Vc.a.jbf);aj.$i.add(Vc.a.Rge);aj.$i.add(Vc.a.F6a);aj.$i.add(Vc.a.Sag);aj.$i.add(Vc.a.YNb);aj.$i.add(Vc.a.$ag);aj.$i.add(Vc.a.WIc);aj.$i.add(Vc.a.bId);aj.$i.add(qa.a.digitalPrintToSway);aj.$i.add(qa.a.openInClient);aj.$i.add(qa.a.print);aj.$i.add(qa.a.Q9d);aj.$i.add(qa.a.e_f);aj.$i.add(qa.a.readingMode);
aj.$i.add(qa.a.EHb);aj.$i.add(ab.a.htj);aj.$i.add(ab.a.tellMe);aj.$i.add(ab.a.x8c);aj.$i.add(ab.a.GMb);aj.$i.add(ab.a.giveFeedback);aj.$i.add(ab.a.K6c);aj.$i.add(ab.a.Lag);aj.$i.add(ab.a.Elg);aj.$i.add(ab.a.A7);aj.$i.add(ab.a.newComment);aj.$i.add(ab.a.W5e);aj.$i.add(ab.a.cQa);aj.$i.add(ab.a.N3f);aj.$i.add(ab.a.M3f);aj.$i.add(ab.a.O3f);aj.$i.add(ab.a.qHd);aj.$i.add(ab.a.$ka);aj.$i.add(ab.a.ehe);aj.$i.add(ab.a.slj);aj.$i.add(ab.a.close);aj.$i.add(ab.a.H$d);aj.$i.add(ab.a.X9d);aj.$i.add(ab.a.c7d);aj.$i.add(ab.a.$ge);
aj.$i.add(ab.a.dhe);aj.$i.add(ab.a.JKb);aj.$i.add(ab.a.renameFile);aj.$i.add(ab.a.d9b);aj.$i.add(ab.a.ybg);aj.$i.add(ab.a.Mic);aj.$i.add(ab.a.downloadACopy);aj.$i.add(ab.a.Ugc);aj.$i.add(ab.a.R8d);aj.$i.add(ab.a.oLb);aj.$i.add(ab.a.l_i);aj.$i.add(ab.a.JBh);aj.$i.add(ab.a.XCd);aj.$i.add(ab.a.V5e);aj.$i.add(ab.a.LBh);aj.$i.add(ab.a.KBh);aj.$i.add(ab.a.W5e);aj.$i.add(ab.a.YCd);aj.$i.add(Vc.a.Mne);aj.$i.add(Vc.a.Cmg);aj.$i.add(Vc.a.zoomToPageWidth);aj.$i.add(Vc.a.J6f);aj.$i.add(Vc.a.hmb);aj.$i.add(Vc.a.$$d);
aj.$i.add(Vc.a.Qia);aj.$i.add(ab.a.Yhb);aj.$i.add(ab.a.Geb);aj.$i.add(ab.a.Qic);aj.$i.add(ab.a.tFj);aj.$i.add(ab.a.s_i);aj.$i.add(qa.a.vKb);aj.$i.add(qa.a.mha)}}aj.$i=new Set;Object(m.a)(aj,"CommentRibbonCommands",null,[]);class bM{constructor(b,h,t,A,O){this.KKi=b;this.wi=h;this.jp=t;this.qf=A;this.TBo=O;this.tXb=null;this.hza=new Tc.a(0);this.zqb=new Tc.a(0);this.cse=new Tc.a(0);this.mUe=!1;this.jqm();this.yQn()}lzm(b){return this.tXb&&this.jp.Xx?!aj.$i.has(b):!1}Y7b(b,h,t){if(b===ab.a.Gg)return 32;
if(!this.hza.ob(b)&&!this.zqb.ob(b)||!this.tXb)return 2;const A=this.zqb.ob(b);var O=A?this.zqb.J(b):this.hza.J(b);const aa=A?2:this.cse.J(t);A||1!==aa||(this.ICm(Jb.App.ya.yp.currentScope.name)||Jb.App.ya.yp.mg(this.wi.yn?vf.AFrame.xr:vf.AFrame.bM),Jb.App.ya.updateCommandUI(!0));t=new aM;switch(O){case 1:t.highlight={color:this.Hai(h.Color)};break;case 6:t.fontColor={color:this.Hai(h.Color)}}O=this.tXb.executeCommand(O,aa,t);2===O&&A&&(b===qa.a.qfc?h[Ng.a.On]=!!t.bold:b===qa.a.wfc?h[Ng.a.On]=!!t.italic:
b===qa.a.Ffc?h[Ng.a.On]=!!t.underline:b===qa.a.zfc?h[Ng.a.On]=!!t.strikethrough:b===qa.a.pY?h[Ng.a.On]=!!t.highlight:b===qa.a.Ev&&(h[Ng.a.On]=!!t.fontColor));return 2===O?32:1===O?2:8}DNn(b){this.tXb=b;this.tXb.registerSelectionChangeHandler(()=>{this.mUe||(this.mUe=!0,Jb.App.ya.updateCommandUI(!0),this.mUe=!1)});this.tXb.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case rc.a.FQb:case rc.a.JQb:case rc.a.qpe:case rc.a.aUa:Jb.App.ya.updateCommandUI(!0)}h.key!==rc.a.JB&&h.key!==rc.a.P0||Jb.App.ya.updateCommandUI(!0)})}yQn(){this.KKi.f3i(vf.AFrame.xr,
this);this.KKi.f3i(vf.AFrame.bM,this)}jqm(){this.hza.Z(qa.a.bold,0);this.hza.Z(qa.a.setItalic,3);this.hza.Z(qa.a.strikethrough,4);this.hza.Z(qa.a.underline,5);this.hza.Z(qa.a.pY,1);this.hza.Z(qa.a.wta,1);this.hza.Z(qa.a.Ev,6);this.hza.Z(qa.a.Nea,6);this.hza.Z(qa.a.Hpa,6);this.zqb.Z(qa.a.qfc,0);this.zqb.Z(qa.a.wfc,3);this.zqb.Z(qa.a.zfc,4);this.zqb.Z(qa.a.Ffc,5);this.cse.Z(1,0);this.cse.Z(2,1)}ICm(b){return b===vf.AFrame.xr||b===vf.AFrame.bM}Hai(b){return b?Fl.a.wI(this.TBo.WMa(this.qf.Zc,b)):""}}
Object(m.a)(bM,"CommentRibbonCommandHandler",null,[441,442]);class DH{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").N_f?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").Iha("OnCommentRenderedOnce",()=>{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}yc(b){this.W=
b;this.W.ha("WordEditor.Comments.CommentRibbonCommandHandler",()=>new bM(this.W.Ma("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),vm.App.Hn.jb.xc,xl.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").singleInstance();this.W.ha("WordEditor.Comments.CommentRibbonCommands",()=>new aj).singleInstance()}static main(){P.a.instance.Gc(new DH)}}Object(m.a)(DH,"PackageManager",null,[1,2]);var CN=c(1921);class qF{constructor(b,
h){this.Hal=2E3;this.Zih=null;this.dVf=b.BUi;this.maxLength=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.Hal);h&&h.execute(t=>{this.Zih=t})}Nlf(b){b=this.kHl(b,this.maxLength);return{semantic:mp.ObjectSemantic.CanvasContext,type:mp.ObjectSchemaType.WordCanvasContext,value:b}}kHl(b,h){try{return this.jHl(b,h)}catch(t){return u.ULS.sendTraceTag(522725067,1303,15,"Error processing selection for Canvas Context: {0}",t),null}}f5l(b,h){const t={q_a:[],
Nwa:0,selection:{start:null,end:null},cursor:null,tiles:[]},A=b.length;for(let aa=0;aa<A;aa++){const ua=b.J(aa);var O=ua.node;if(!qe.ParagraphReader.Yb(O)||Array.contains(t.q_a,O.wl))continue;t.q_a.push(O.wl);const Ra=qe.ParagraphReader.textLength(O);if(t.Nwa+Ra>h)break;O=this.dVf.$zb(O);t.tiles.push(O);t.Nwa+=Ra;1!==A||t.cursor||(t.cursor=qF.BLl(ua,t.tiles.length-1));null===t.selection.start&&0===aa&&(t.selection.start=this.fei(ua,!0,t.tiles.length-1));null===t.selection.end&&aa===A-1&&(t.selection.end=
this.fei(ua,!1,t.tiles.length-1))}return t}gXl(b,h,t){const A={K8c:[],Isj:[],Nwa:0};var O=b.J(0).node;let aa=b.J(b.length-1).node;for(b=h;0<b&&(O||aa);){var ua=qF.QYi(O,!0,b,t);if(O=ua.node)O=this.dVf.$zb(O),A.K8c.push(O),b-=ua.Nwa,O=ua.node,t=ua.q_a;ua=qF.QYi(aa,!1,b,t);if(aa=ua.node)t=this.dVf.$zb(aa),A.Isj.push(t),b-=ua.Nwa,aa=ua.node,t=ua.q_a}A.Nwa=h-b;return A}lHl(b,h){let t=0;var A=this.f5l(b,h);const O={tiles:A.tiles,selection:A.selection,cursor:A.cursor};t+=A.Nwa;A=A.q_a;t<h&&(b=this.gXl(b,
h-t,A),O.tiles.unshift.apply(O.tiles,b.K8c),O.tiles.push.apply(O.tiles,b.Isj),O.selection.start&&(O.selection.start.index+=b.K8c.length),O.selection.end&&(O.selection.end.index+=b.K8c.length),O.cursor&&(O.cursor.index+=b.K8c.length));return O}jHl(b,h){var t;if(!b)return null;b=this.lHl(b,h);return{contentType:null===(t=this.Zih)||void 0===t?void 0:t.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}fei(b,h,t){if(b.contextId===mc.a.Fd||b.contextId===mc.a.paragraph||b.contextId===
mc.a.Vc){if(h&&-1!==b.zj)return{index:t,offset:b.zj};if(!h&&-1!==b.Ep)return{index:t,offset:b.Ep}}return null}static BLl(b,h){return b.contextId===mc.a.Vc?{index:h,offset:b.zj}:null}static QYi(b,h,t,A){A={node:null,Nwa:0,q_a:A};if(!b||0>=t||!A.q_a)return A;do A.node=qe.ParagraphReader.ug(b,h,!1,!1),A.Nwa=A.node?qe.ParagraphReader.textLength(A.node):0,b=A.node;while(A.node&&(Array.contains(A.q_a,A.node.wl)||!qe.ParagraphReader.Yb(A.node)||!A.Nwa));A.node&&(A.Nwa>t?A.node=null:A.q_a.push(A.node.wl));
return A}}Object(m.a)(qF,"Box4CanvasContextProvider",null,[110]);class EH{get name(){return"Box4.CanvasContext"}init(){}dispose(){}yc(b){b.ha("Box4.CanvasContext.Box4CanvasContextProvider",()=>new qF(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Sa("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").singleInstance()}static main(){P.a.instance.Gc(new EH)}}Object(m.a)(EH,"Box4CanvasContextPackage",null,[1,2]);class cM{constructor(b,h,t){this.YB=null;
this.Hv={};this.DZb=this.nsd=0;this.UAb=3E4;this.start=()=>{0==this.Gxb.size||this.YB||0!==this.DZb||(this.RNb?this.DZb=window.setInterval(this.U$i,this.UAb):(this.YB=new Vb.a(1,2,this.UAb,this.U$i.bind(this),216),this.Gb.Wb(this.YB)),u.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.U$i=()=>{if(0!=this.Gxb.size)if(this.ff.eo)u.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop();else{var A=50;this.Hv.ScanTime=Date.now();this.Hv.NumWatchDogs=this.Gxb.size;
this.Hv.WatchDogManagerScanNumber=++this.nsd;this.Gxb.forEach((O,aa)=>{this.Hv[aa]=O.R8m();O.ZMm()||(A=15)});u.ULS.sendTraceTag(520974674,306,A,JSON.stringify(this.Hv))}};this.Gb=b;this.ff=h;this.nVe=new Map;this.Gxb=new Map;t.execute(A=>{this.el=A;this.el.uMa((O,aa)=>{this.oX(aa)})})}oX(b){this.Fjl?2!==b.oldState||1!==b.newState&&0!==b.newState?2===b.newState&&(this.RNb?0!==this.DZb&&(u.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for hidden"),this.stop()):this.YB&&(u.ULS.sendTraceTag(509219480,
306,50,"WatchDogManager stopping for hidden"),this.stop())):(this.RNb?(this.stop(),this.start()):(this.stop(),b=new Vb.a(1,1,this.UAb,this.start,216),this.Gb.Wb(b)),this.C8i(),u.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from hidden")):3===b.oldState&&3!==b.newState&&(this.RNb?(this.stop(),this.start()):(this.stop(),b=new Vb.a(1,1,this.UAb,this.start,216),this.Gb.Wb(b)),this.C8i(),u.ULS.sendTraceTag(509219298,306,50,"WatchDogManager returning from frozen"))}stop(){this.RNb?0!==this.DZb&&
(window.clearInterval(this.DZb),this.DZb=0):this.YB&&(this.Gb.Se(this.YB),this.YB=null);u.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}lok(b,h){this.nVe.set(b,h)}X_n(){this.Tyn(this.nVe)}get zuk(){return this.nVe.size===this.Gxb.size}Tyn(b){b.forEach((h,t)=>{h.execute(A=>{A?(this.Gxb.set(t,A),this.start()):u.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",t)})})}C8i(){this.Gxb.forEach(b=>{b&&b.d5a()});u.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}get RNb(){return null!=
this.aDg?this.aDg:this.aDg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseJSScheduling",!1)}get Fjl(){return null!=this.yug?this.yug:this.yug=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoesNotRunOnHidden",!1)}}Object(m.a)(cM,"WatchDogManager",null,[109]);class FH{constructor(){this.W=this.Fxb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.yjb&&(this.Fxb=this.W.resolve(this.name),this.jsm())}dispose(){this.Fxb&&
this.Fxb.stop()}yc(b){this.yjb&&(this.W=b,b.ha(this.name,this.Q8k.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").singleInstance())}static main(){P.a.instance.Gc(new FH)}fDj(){if(!this.Fxb.zuk){const b=[];let h=0;this.isd.forEach((t,A)=>{t&&(this.W.Ma(A)||(b[h++]=A))});if(0<b.length)if(this.dlo){const t=!this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager").JQ;u.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,t)}else u.ULS.sendTraceTag(512550819,306,10,
"{0} did not resolve",b)}}Q8k(){return new cM(v.AFrameworkApplication.oc,this.W.resolve("Common.ISessionStatus")||fc.SessionStatusManager.instance,this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"))}dpk(){if(this.Wmo)window.setTimeout(this.fDj.bind(this),this.HWo);else{const b=new Vb.a(1,1,12E4,this.fDj.bind(this),216);v.AFrameworkApplication.oc.Wb(b)}}kpk(){this.isd=new Map;this.isd.set("WordEditor.RunawayDataLossMonitorWatchDog",(Jb.App.Lm||Jb.App.Ds)&&this.xYd);this.isd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",
this.GXd)}jsm(){this.kpk();this.jpk(this.isd,this.Fxb.lok.bind(this.Fxb));this.Fxb.X_n();this.dpk()}jpk(b,h){b.forEach((t,A)=>{t&&h(A,this.W.Sa(A))})}get yjb(){return null!=this.Wzg?this.Wzg:this.Wzg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WatchDogManagerIsEnabled",!1)}get GXd(){return null!=this.Hzg?this.Hzg:this.Hzg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LastSavedToHostDetailsWatchDogEnabled",!1)}get xYd(){return null!=this.Szg?
this.Szg:this.Szg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossWatchDogEnabled",!1)}get Wmo(){return null!=this.$Cg?this.$Cg:this.$Cg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchToJSSchedulingForWatchdogEnabled",!1)}get HWo(){return null!=this.SGg?this.SGg:this.SGg=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",3E5)}get dlo(){return null!=this.ZCg?this.ZCg:this.ZCg=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LogDataLossForWatchDogEnabled",!1)}}Object(m.a)(FH,"WatchDogManagerPackage",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");
Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");
Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");
Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");
Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");
Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");
Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");
Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");N.main();Type.registerNamespace("Common.App.WopiIdentity");ma.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");zb.main();Object(CN.a)(!1);Qa.main();Fb.main();$b.main();BH.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");Nc.main();Type.registerNamespace("Common.App.AltTextDialog");
Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");de.main();Type.registerNamespace("Common.App.WildFire");se.main();Type.registerNamespace("Common.App.BrowserInfoLogger");Ei.main();Type.registerNamespace("Common.App.HostNotification");Ug.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");Fk.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
Type.registerNamespace("Common.App.LivePersonaUtils");Og.main();Type.registerNamespace("CNT");Fm.main();Type.registerNamespace("Common.App.NewAndOpen.Core");P.a.instance.Gc(new rn);Type.registerNamespace("Common.App.NewAndOpen.UX");P.a.instance.Gc(new Hm);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Dn.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");Fd.main();Type.registerNamespace("Common.Search");
Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");Nk.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");Rc.main();Type.registerNamespace("CADWLTR");Xc.main();Type.registerNamespace("Common.App.DirectPrint");P.a.instance.Gc(new Kn);Type.registerNamespace("Common.App.SearchOAuthManager");yf.main();vh.main();cp.main();Co.main();Zm.main();vb.main();Mg.main();P.a.instance.Gc(new hl);Kd.main();Vi.main();
bq.main();P.a.instance.Gc(new rq);Type.registerNamespace("Common.App.SaveStatus");P.a.instance.Gc(new Qp);Type.registerNamespace("Common.App.EventsCacheManager");jj.main();Type.registerNamespace("CUIB");wn.main();Type.registerNamespace("CommandUI.TaskPane");try{P.a.instance.Gc(new bf(Jb.App.ya.jb))}catch(b){u.ULS.shipAssertTag(575930383,3016,!1,b.message)}Oi.main();Type.registerNamespace("Common.App.Insights");Fj;P.a.instance.Gc(new qm);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");
Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");El("Begin");P.a.instance.Gc(new fw);try{P.a.instance.Gc(new Sr(rk.a.get_instance(),Jb.App.ya.jb,Jb.App.ya.Ob))}catch(b){u.ULS.shipAssertTag(575930384,3016,!1,b.message)}ec.main();P.a.instance.Gc(new Ve);Ut.main();$o.main();Lo.main();gw.main();Ow.main();Mu.main();Px.main();nv.main();P.a.instance.Gc(new $z);Vr.main();au.main();kz.main();
Hy.main();EH.main();DH.main();P.a.instance.Gc(new cA);P.a.instance.Gc(new gA);oz.main();iA.main();Ru.main();P.a.instance.Gc(new zl);P.a.instance.Gc(new Vu);yB;n.main();Me.main();Pk.main();$d.main();ie;P.a.instance.Gc(new Bz);P.a.instance.Gc(new Ys);IB.main();Oy.main();WD.main();P.a.instance.Gc(new Yk);P.a.instance.Gc(new RB);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=qt;Type.registerNamespace("Common.App.AppsForOfficeCommon");
Type.registerNamespace("Common.App.AppsForOfficeCommon");$C.main();aD.main();bD.main();ui;QG.main();MM;window.MSOJS=gD;lH.main();oH.main();P.a.instance.Gc(new YL);P.a.instance.Gc(new $L);(()=>Object(Rl.__awaiter)(void 0,void 0,void 0,function*(){v.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&(yield c.e(26).then(c.bind(null,2029)).then(b=>{b.initializeOnDemandPackage()}))}))();FH.main();Zg.main()},2035:function(D,L,c){D=c(0);var l=c(8),e=c(1595);class a{static get H5m(){return 50}static MPd(x){if(""===
x)return"";let y=0,m="";try{const u=e.a.aDb(x);for(const z of u.ops)if(a.iG(z))y||(m+=a.hPl(z.attributes.atmention.fullName)),y+=1;else{const v=z.insert?z.insert:"";" "!==v&&0<v.length&&(y=0,m+=v)}}catch(u){l.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return m}static kJl(x){x=a.MPd(x);return 0<x.length&&x.split(" ").length<=a.H5m?x:null}static hPl(x){let y="";x&&(x=x.split(" "),0<x.length&&(y=x[0]));return y}static iG(x){return!!x.attributes&&
!!x.attributes.atmention}}Object(D.a)(a,"BaseCommentSmartReplyHelpers",null,[]);c.d(L,"a",function(){return k});class k extends a{constructor(){super()}static QCb(x,y,m=!1){if(!x)return null;x=x.text&&0<x.text.length?x.text[0]:"";y=!y||!y.Ff||""===y.Ff;return 0<x.length&&y&&!m?a.kJl(x):null}}Object(D.a)(k,"CommentSmartReplyHelpers",a,[])},716:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});var l=c(66);l.__exportStar(c(942),L);l.__exportStar(c(1209),L);l.__exportStar(c(943),L);l.__exportStar(c(1210),
L);l.__exportStar(c(1211),L);l.__exportStar(c(1212),L);D.exports.getChangeGateDictionary||Object.defineProperty(D.exports,"getChangeGateDictionary",{enumerable:!0,get:function(){return D.exports.v1h}});D.exports.getFeatureGateDictionary||Object.defineProperty(D.exports,"getFeatureGateDictionary",{enumerable:!0,get:function(){return D.exports.C4h}});D.exports.makeGetTypedFeatureGate||Object.defineProperty(D.exports,"makeGetTypedFeatureGate",{enumerable:!0,get:function(){return D.exports.aGi}});D.exports.makeTypedIsChangeGateEnabled||
Object.defineProperty(D.exports,"makeTypedIsChangeGateEnabled",{enumerable:!0,get:function(){return D.exports.fGi}})},862:function(D,L,c){function l(){return c(862)}function e(Sa){for(var ab=[],Hb=1;Hb<arguments.length;Hb++)ab[Hb-1]=arguments[Hb];return e.r9c.apply(e,Object(ca.__spreadArray)([Sa,void 0],ab,!1))}function a(Sa){return k(Sa)&&"WorkerError"===Sa.name&&"object"===typeof Sa.info}function k(Sa){return null==Sa?!1:Sa instanceof Error?!0:"string"===typeof Sa.name&&"string"===typeof Sa.message&&
(null==Sa.stack||"string"===typeof Sa.stack)}function x(Sa){if(k(Sa))var ab=Sa;else{ab=Error;var Hb="(non-Error object) ".concat;a:{var pb=typeof Sa;switch(pb){case "function":case "symbol":case "undefined":Sa="<".concat(pb,">");break a;case "object":Sa=JSON.stringify(Sa);break a;default:Sa="".concat(Sa)}}ab=ab(Hb.call("(non-Error object) ",Sa))}return ab}function y(Sa){var ab=Sa.name,Hb=a(Sa)?Sa.vCk:Sa.message,pb=Sa.stack;a(Sa)?(Sa=Sa.info,Sa=Object(ca.__assign)(Object(ca.__assign)({},Sa),{error:Sa.error?
y(Sa.error):void 0})):Sa=void 0;return{name:ab,message:Hb,stack:pb,info:Sa}}function m(Sa){return k(Sa)?{rga:!0,value:y(Sa)}:{rga:!1,value:Sa}}function u(Sa){if("WorkerError"===Sa.name){var ab=Sa.message;var Hb=Sa.info;Hb=Object(ca.__assign)(Object(ca.__assign)({},Hb),{error:Hb.error?u(Hb.error):void 0});ab=new pa(ab,Hb)}else(ab=Ma[Sa.name])?ab=new ab(Sa.message):(ab=Error(Sa.message),ab.name=Sa.name);null!=Sa.stack&&(ab.stack=Sa.stack);return ab}function z(Sa){return Sa.rga?u(Sa.value):Sa.value}
function v(){return"undefined"!==typeof Blob&&"undefined"!==typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!==typeof Worker}function E(Sa){if(ya)throw new TypeError("setConfig has already been called");ya=Sa}function F(){var Sa=null!==ya&&void 0!==ya?ya:{};return{createTimeout:Sa.createTimeout,createMode:Sa.createMode,importScriptUrls:Sa.importScriptUrls?Object(ca.__spreadArray)([],Sa.importScriptUrls,!0):void 0,typedWorkersUrl:Sa.typedWorkersUrl,typedWorkersName:Sa.typedWorkersName,
Fwf:Sa.Fwf}}function J(Sa){var ab,Hb;return null!==(Hb=null!==(ab=null===Sa||void 0===Sa?void 0:Sa.createTimeout)&&void 0!==ab?ab:null===ya||void 0===ya?void 0:ya.createTimeout)&&void 0!==Hb?Hb:3E5}function K(Sa){var ab,Hb;Sa=null!==(Hb=null!==(ab=null===Sa||void 0===Sa?void 0:Sa.createMode)&&void 0!==ab?ab:null===ya||void 0===ya?void 0:ya.createMode)&&void 0!==Hb?Hb:"Thread";return"ThreadOrLocal"===Sa?v()?"Thread":"Local":Sa}function H(Sa){setTimeout(function(){throw Sa;})}function P(){return"undefined"!==
typeof self&&"__typed_workers_thread"in self?self:void 0}function N(Sa){var ab=P();void 0!==ab?(Sa={kind:1,error:m(Sa)},ab.postMessage(Sa)):console.warn(Sa)}function M(Sa){var ab;try{(null!==(ab=null===ya||void 0===ya?void 0:ya.Ncp)&&void 0!==ab?ab:N)(Sa)}catch(Hb){console.warn(Sa),H(Hb)}}function I(Sa){var ab=P();void 0!==ab&&ab.postMessage({kind:2,stats:Sa})}function T(Sa){var ab;try{(null!==(ab=null===ya||void 0===ya?void 0:ya.icp)&&void 0!==ab?ab:I)(Sa)}catch(Hb){H(Hb)}}function U(Sa,ab){return Sa.then(function(Hb){ab();
return Hb},function(Hb){ab();return Promise.reject(Hb)})}function W(Sa,ab,Hb){if(1073741824<Sa)return Hb;var pb=setTimeout(ab,Math.max(0,Sa));return{resolve:function(Mb){clearTimeout(pb);Hb.resolve(Mb)},reject:function(Mb){clearTimeout(pb);Hb.reject(Mb)}}}function V(){var Sa=Object.create(null);Sa.key=void 0;delete Sa.key;return Sa}function Y(){try{return"function"===typeof Proxy&&!0===(new Proxy({},{get:function(){return!0}})).k}catch(Sa){return!1}}function da(Sa,ab){var Hb=V(),pb=fa("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?
function(Mb,Qb){var Aa;return"then"===Qb?void 0:null!==(Aa=Mb[Qb])&&void 0!==Aa?Aa:Mb[Qb]=Sa(Qb)}:function(Mb,Qb){var Aa;return null!==(Aa=Mb[Qb])&&void 0!==Aa?Aa:Mb[Qb]=Sa(Qb)};if(!ab)return new Proxy(Hb,{get:pb});ab.forEach(function(Mb){return pb(Hb,Mb)});return Hb}function ba(Sa){throw Sa;}function ja(){return{status:"Pending",start:Xa()}}function sa(Sa,ab,Hb){"Pending"===Sa.status&&(Sa.status=ab,Sa.end=Math.max(Sa.start,null!==Hb&&void 0!==Hb?Hb:Xa()))}function ta(Sa,ab){function Hb(pb){sa(Sa,
a(pb)&&"Timeout"===pb.info.DZ?"Timeout":"Error");throw pb;}try{return ab().then(function(pb){var Mb;return null!==(Mb=sa(Sa,"Success"))&&void 0!==Mb?Mb:pb},Hb)}catch(pb){Hb(pb)}}function ra(Sa,ab,Hb){var pb,Mb,Qb,Aa=null!==(pb=null===Sa||void 0===Sa?void 0:Sa.start)&&void 0!==pb?pb:Infinity;pb=Aa<ab?ab:Aa>Hb?Hb:Aa;Aa=null!==(Mb=null===Sa||void 0===Sa?void 0:Sa.end)&&void 0!==Mb?Mb:Infinity;Hb=Aa<ab?ab:Aa>Hb?Hb:Aa;return{status:null!==(Qb=null===Sa||void 0===Sa?void 0:Sa.status)&&void 0!==Qb?Qb:"Pending",
start:Math.round(1E3*(pb-ab))/1E3,end:Math.round(1E3*(Hb-ab))/1E3,duration:Math.round(1E3*(Hb-pb))/1E3}}function ma(Sa,ab,Hb){Hb="def"in Hb?Hb:e(Hb);var pb=Hb.def,Mb=Hb.args;return"function"!==typeof pb?Promise.reject(new pa("Loading an InsideScript to create a local worker is unimplemented",{DZ:"InternalError",yD:{type:"Endpoint",bOb:"Inside",id:Sa.options.id}})):Promise.resolve().then(function(){return ta(ab.syf=ja(),function(){return pb.apply(void 0,Object(ca.__spreadArray)([{config:F(),importTypedWorkers:l,
connection:Sa}],Mb,!1)).then(function(){})})})}function Ba(Sa,ab,Hb,pb,Mb){var Qb=new MessageChannel,Aa=Qb.port2,bb;return Promise.all([pb({port:Qb.port1,options:Sa,createMode:ab}),ta(Hb.BFd=ja(),function(){return jb.BFd({port:Aa,options:Sa,createMode:ab},function(nb){return Mb(bb=nb)})})]).then(function(){return bb},function(nb){bb?bb.close("Force"):Aa.close();return Promise.reject(nb)})}function Pa(Sa,ab,Hb,pb){return Ba(Sa,"Local",ab,function(Mb){return ma(Mb,ab,Hb)},pb)}function Da(Sa,ab,Hb,pb){ab.MFd=
ja();try{var Mb=new Ya(Sa,Hb)}catch(Qb){return sa(ab.MFd,"Error"),Promise.reject(Qb)}sa(ab.MFd,"Success");return Ba(Sa,"Thread",ab,function(Qb){return Mb.B9e(Qb,ab)},pb).then(function(Qb){Qb.Dhm()?Mb.terminate():Qb.B6j=Mb.terminate.bind(Mb);return Qb},function(Qb){Mb.terminate();return Promise.reject(Qb)})}function Ha(Sa,ab,Hb){void 0===Hb&&(Hb=function(){});var pb=K(Sa),Mb="local"in ab?"Local"===pb?ab.local:ab.VBo:ab,Qb="Local"===pb?Pa:Da,Aa={id:Sa.id,createMode:pb,w$e:ja()};ab=ta(Aa.w$e,function(){return Qb({id:Sa.id,
createTimeout:Sa.createTimeout,createMode:Sa.createMode,importScriptUrls:Sa.importScriptUrls,Fwf:Sa.Fwf},Aa,Mb,Hb)});return U(ab,function(){var bb=Aa.createMode;var nb=Aa.w$e,Va=Aa.syf,Ab=Aa.BFd,Zb=Aa.MFd,Kb=nb.status,dc=nb.start;nb=nb.end;bb="Pending"!==Kb&&void 0!==nb?{id:Aa.id,createMode:bb,w$e:{status:Kb,A5o:dc,duration:Math.round(1E3*(nb-dc))/1E3},MFd:"Thread"===bb?ra(Zb,dc,nb):void 0,BFd:ra(Ab,dc,nb),syf:ra(Va,dc,nb)}:void 0;bb&&T(bb)})}function oa(Sa,ab){if(0===ab)importScripts.apply(void 0,
Sa);else for(var Hb=0;Hb<Sa.length;Hb++)a:{for(var pb=void 0,Mb=Sa[Hb],Qb=ab,Aa=0;Aa<=Qb;Aa+=1)try{pb=importScripts;if(0<Aa){var bb=Mb,nb=String(Aa),Va=bb.indexOf("?");if(0>Va)var Ab="".concat(bb,"?").concat("retries","=").concat(nb);else{var Zb=bb.slice(0,Va+1),Kb=bb.slice(Va+1).split("&");for(bb=0;bb<Kb.length&&("="!==Kb[bb][7]||"retries"!==Kb[bb].slice(0,7));bb+=1);Kb[bb]="".concat("retries","=").concat(nb);Ab=Zb+Kb.join("&")}}else Ab=Mb;pb(Ab);break a}catch(dc){pb=dc}throw pb;}}function wa(){return"undefined"!==
typeof WorkerGlobalScope}function ia(){return self.name}c.r(L);var ca=c(66),pa=function(Sa){function ab(Hb,pb){var Mb=this.constructor,Qb;var Aa=Sa.call(this,"".concat(Hb,"; info = ").concat(JSON.stringify(Object(ca.__assign)(Object(ca.__assign)({},pb),{error:null===(Qb=pb.error)||void 0===Qb?void 0:Qb.message}))))||this;Aa.vCk=Hb;Aa.info=pb;Aa.name="WorkerError";Hb=Mb.prototype;Object.getPrototypeOf(Aa)!==Hb&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(Aa,Hb):Aa.__proto__=Hb);return Aa}Object(ca.__extends)(ab,
Sa);return ab}(Error),Ma={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError},ya;e.r9c=function(Sa,ab){for(var Hb=[],pb=2;pb<arguments.length;pb++)Hb[pb-2]=arguments[pb];return{def:Sa,args:Hb,transferables:null!==ab&&void 0!==ab?ab:[]}};var Oa=c(716),fa=Object(Oa.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);Object(Oa.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});var Ca,Ta=-1,eb=function(){function Sa(ab,
Hb){function pb(){var Va;return null===(Va=Aa.onClose)||void 0===Va?void 0:Va.call(Aa)}var Mb,Qb,Aa=this;this.yD=ab;this.port=Hb;this.isClosed=!1;this.exports={};this.Y9c=V();var bb=(Mb={},Mb[0]=this.v5d.bind(this),Mb[1]=this.onResult.bind(this),Mb[2]=function(Va){var Ab;Va=Va.nBl;null===(Ab=Aa.Oin)||void 0===Ab?void 0:Ab.call(Aa,da(Aa.A6k.bind(Aa),Va),da(Aa.Y1k.bind(Aa),Va))},Mb[3]=pb,Mb),nb=(Qb={},Qb[0]=this.enn.bind(this),Qb[1]=this.YQi.bind(this),Qb[2]=pb,Qb[3]=pb,Qb);this.port.onmessage=function(Va){Va=
Va.data;return bb[Va.kind](Va)};this.port.onmessageerror=function(Va){Va=Va.data;return nb[Va.kind](Va)}}Sa.prototype.Oao=function(ab){this.exports=ab;if(null!==Ca&&void 0!==Ca?Ca:Ca=Y())ab=void 0;else{for(var Hb=V();null!=ab;){for(var pb=0,Mb=Object.getOwnPropertyNames(ab);pb<Mb.length;pb++){var Qb=Mb[pb];try{"function"===typeof ab[Qb]&&(Hb[Qb]=!0)}catch(Aa){}}ab=Object.getPrototypeOf(ab)}ab=Object.getOwnPropertyNames(Hb)}this.port.postMessage({kind:2,nBl:ab})};Sa.prototype.close=function(){if(!this.isClosed){this.isClosed=
!0;this.port.postMessage({kind:3});this.port.close();for(var ab in this.Y9c){var Hb=this.Y9c[ab],pb=Hb.reject;Hb=Hb.UZ;var Mb={DZ:"Connection",yD:this.yD,UZ:Hb};Hb=new pa("Importing Endpoint closed while waiting for ".concat(Hb," result"),Mb);pb(Hb)}}};Sa.prototype.v5d=function(ab){var Hb=this,pb=ab.Lea,Mb=ab.UZ,Qb=ab.args;ab=Promise.resolve().then(function(){var Aa=Hb.exports[Mb];if(Aa)return Aa.apply(Hb.exports,Qb);Aa={DZ:"Connection",yD:Hb.yD,Lea:pb,UZ:Mb};throw new pa("Exporting Endpoint received a ".concat(0<=
pb?"call":"post"," to unknown function ").concat(Mb),Aa);});0<=pb?ab.then(function(Aa){return Hb.h7f(pb,Mb,!0,Aa)},function(Aa){return Hb.h7f(pb,Mb,!1,Aa)}):ab.catch(function(Aa){Aa=x(Aa);Aa={DZ:"UnhandledError",yD:Hb.yD,error:Aa,Lea:pb,UZ:Mb};M(new pa("Exporting Endpoint's ".concat(Mb," implementation threw or rejected"),Aa))})};Sa.prototype.h7f=function(ab,Hb,pb,Mb){Mb=m(Mb);ab={kind:1,Lea:ab,UZ:Hb,aDm:pb,Z8i:Mb};try{this.port.postMessage(ab,void 0)}catch(Qb){this.YQi(ab,x(Qb))}};Sa.prototype.YQi=
function(ab,Hb){var pb=ab.Lea,Mb=ab.UZ;ab=ab.Z8i;var Qb=Hb?"Exporting Endpoint failed to send ".concat(Mb," result"):"Importing Endpoint failed to deserialize ".concat(Mb," result");Hb=new pa(Qb,{DZ:"MessageError",yD:this.yD,error:Hb,Lea:pb,UZ:Mb});ab.rga?M(Hb):this.h7f(pb,Mb,!1,Hb)};Sa.prototype.jje=function(ab){var Hb=this.Y9c[ab];Hb&&delete this.Y9c[ab];return Hb};Sa.prototype.j$n=function(ab,Hb,pb,Mb){var Qb=this;return 1073741824<pb?Mb:W(pb,function(){var Aa=Qb.jje(ab);if(Aa){var bb={DZ:"Timeout",
yD:Qb.yD,timeout:pb,Lea:ab,UZ:Hb};Aa.reject(new pa("Importing Endpoint's call to ".concat(Hb," timed out"),bb))}},Mb)};Sa.prototype.X6n=function(ab,Hb,pb,Mb){var Qb=this;return new Promise(function(Aa,bb){var nb=Ta+=1,Va={kind:0,Lea:nb,UZ:ab,args:Hb};Qb.Y9c[nb]=Object(ca.__assign)(Object(ca.__assign)({},Qb.j$n(nb,ab,pb,{resolve:Aa,reject:bb})),{UZ:ab});try{Qb.port.postMessage(Va,Mb)}catch(Ab){if(Aa=Qb.jje(nb))bb=x(Ab),nb={DZ:"MessageError",yD:Qb.yD,error:bb,Lea:nb,UZ:ab},Aa.reject(new pa("Importing Endpoint failed to send call to ".concat(ab),
nb))}})};Sa.prototype.R7n=function(ab,Hb,pb,Mb){Hb={kind:0,Lea:-1,UZ:ab,args:Hb};try{this.port.postMessage(Hb,Mb)}catch(Qb){Mb=x(Qb),Mb={DZ:"MessageError",yD:this.yD,error:Mb,Lea:-1,UZ:ab},pb(new pa("Importing Endpoint failed to post to ".concat(ab),Mb))}};Sa.prototype.enn=function(ab){var Hb,pb=ab.Lea;ab=ab.UZ;var Mb={DZ:"MessageError",yD:this.yD,Lea:pb,UZ:ab};ab=new pa("Exporting Endpoint failed to deserialize ".concat(0<=pb?"call":"post"," to ").concat(ab),Mb);pb=0<=pb?this.jje(pb):void 0;(null!==
(Hb=null===pb||void 0===pb?void 0:pb.reject)&&void 0!==Hb?Hb:M)(ab)};Sa.prototype.onResult=function(ab){var Hb=ab.Lea,pb=ab.UZ,Mb=ab.aDm;ab=ab.Z8i;0<=Hb?(pb=this.jje(Hb))&&(Mb?pb.resolve:pb.reject)(z(ab)):(Mb={DZ:"InternalError",yD:this.yD,Lea:Hb,UZ:pb},M(new pa("Exporting Endpoint sent a result for a post to ".concat(pb),Mb)))};Sa.prototype.A6k=function(ab){function Hb(){for(var Mb=[],Qb=0;Qb<arguments.length;Qb++)Mb[Qb]=arguments[Qb];return Hb.r9c.apply(Hb,Object(ca.__spreadArray)([void 0],Mb,!1))}
var pb=this;Hb.r9c=function(Mb){for(var Qb,Aa,bb,nb=[],Va=1;Va<arguments.length;Va++)nb[Va-1]=arguments[Va];pb.isClosed||(Va=null!==(bb=null!==(Qb=Hb.YPi)&&void 0!==Qb?Qb:null===(Aa=pb.KYl)||void 0===Aa?void 0:Aa.call(pb))&&void 0!==bb?bb:ba,pb.R7n(ab,nb,Va,Mb))};return Hb};Sa.prototype.Y1k=function(ab){function Hb(){for(var Mb=[],Qb=0;Qb<arguments.length;Qb++)Mb[Qb]=arguments[Qb];return Hb.r9c.apply(Hb,Object(ca.__spreadArray)([void 0],Mb,!1))}var pb=this;Hb.r9c=function(Mb){for(var Qb,Aa,bb,nb=
[],Va=1;Va<arguments.length;Va++)nb[Va-1]=arguments[Va];if(pb.isClosed)return Qb={DZ:"Connection",yD:pb.yD,UZ:ab},Promise.reject(new pa("".concat(pb.yD.bOb," Endpoint's call.").concat(ab," called after close"),Qb));Va=null!==(bb=null!==(Qb=Hb.s3e)&&void 0!==Qb?Qb:null===(Aa=pb.hHl)||void 0===Aa?void 0:Aa.call(pb))&&void 0!==bb?bb:Infinity;return pb.X6n(ab,nb,Va,Mb)};Hb.s3e=void 0;return Hb};return Sa}(),jb=function(){function Sa(ab,Hb,pb){function Mb(Qb){return function(){var Aa="Outside"===ab.bOb?
"inside":"outside",bb={DZ:"Connection",yD:ab};throw new pa("".concat(ab.bOb," Endpoint's ").concat(Qb," referenced before the ").concat(Aa," Endpoint started"),bb);}}this.s3e=Infinity;this.YPi=ba;this.jjd=ab;this._state=Hb;this.createMode=pb;Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:Mb("post")},call:{configurable:!0,enumerable:!1,get:Mb("call")}})}Sa.XMg=function(ab,Hb,pb){var Mb=Hb.port,Qb=Hb.options;Hb=Hb.createMode;var Aa={type:"Endpoint",bOb:ab,id:null===Qb||void 0===
Qb?void 0:Qb.id};try{var bb=new eb(Aa,Mb);var nb=new Sa(Aa,bb,Hb)}catch(Va){return Promise.reject(Va)}return(new Promise(function(Va,Ab){var Zb;bb.hHl=function(){return nb.s3e};bb.KYl=function(){return nb.YPi};bb.Oin=function(zb,cc){Object.defineProperties(nb,{post:{configurable:!0,enumerable:!1,writable:!1,value:zb},call:{configurable:!0,enumerable:!1,writable:!1,value:cc}});dc.resolve()};bb.onClose=function(){return nb.close("Force")};var Kb=J(Qb),dc=W(Kb,function(){var zb="Outside"===ab?"inside":
"outside",cc={DZ:"Timeout",yD:Aa,timeout:Kb};zb=new pa("".concat(ab," Endpoint timed out waiting for the ").concat(zb," to start"),cc);dc.reject(zb)},{resolve:Va,reject:Ab});nb.$dd=function(){dc.resolve()};try{var jc=pb(nb)}catch(zb){return dc.reject(zb)}null===(Zb=nb._state)||void 0===Zb?void 0:Zb.Oao(jc)})).then(function(){nb.$dd=void 0;return nb},function(Va){nb.$dd=void 0;nb.close();return Promise.reject(Va)})};Sa.prototype.Dhm=function(){return void 0===this._state};Sa.prototype.close=function(ab){var Hb;
if(this._state){if(this.$dd)if("Force"===ab)this.$dd();else{var pb={DZ:"Connection",yD:this.jjd};throw new pa("".concat(this.jjd.bOb," Endpoint's close called during creation"),pb);}ab=this._state;this._state=void 0;try{ab.close(),null===(pb=this.B6j)||void 0===pb?void 0:pb.call(this),null===(Hb=this.onClose)||void 0===Hb?void 0:Hb.call(this)}catch(Mb){pb={DZ:"Connection",yD:this.jjd,error:x(Mb)},M(new pa("".concat(this.jjd.bOb," Endpoint's close threw an error"),pb))}}};Sa.BFd=function(ab,Hb){void 0===
Hb&&(Hb=function(){});return Sa.XMg("Outside",ab,Hb)};Sa.B9e=function(ab,Hb){return Sa.XMg("Inside",ab,Hb)};return Sa}(),ob=-1,Ya=function(){function Sa(ab,Hb){var pb;try{var Mb=void 0;var Qb="def"in Hb?Hb:e(Hb),Aa=Qb.def,bb=Qb.args,nb=Qb.transferables;if("function"!==typeof Aa)var Va=[Aa,bb,nb,void 0];else{var Ab="__generatedInsideInit".concat(ob+=1),Zb="var ".concat(Ab," = ").concat(Aa.toString(),";");Va=[{scriptUrl:void 0,insideInitName:Ab},bb,nb,Zb]}this.script=Va[0];this.args=Va[1];this.transferables=
Va[2];Mb=Va[3];this.tAd=URL.createObjectURL(new Blob(void 0===Mb?['!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__esDecorate",(function(){return f})),r.d(t,"__runInitializers",(function(){return l})),r.d(t,"__propKey",(function(){return s})),r.d(t,"__setFunctionName",(function(){return d})),r.d(t,"__metadata",(function(){return p})),r.d(t,"__awaiter",(function(){return y})),r.d(t,"__generator",(function(){return v})),r.d(t,"__createBinding",(function(){return _})),r.d(t,"__exportStar",(function(){return g})),r.d(t,"__values",(function(){return b})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return m})),r.d(t,"__spreadArrays",(function(){return w})),r.d(t,"__spreadArray",(function(){return O})),r.d(t,"__await",(function(){return j})),r.d(t,"__asyncGenerator",(function(){return G})),r.d(t,"__asyncDelegator",(function(){return P})),r.d(t,"__asyncValues",(function(){return S})),r.d(t,"__makeTemplateObject",(function(){return T})),r.d(t,"__importStar",(function(){return E})),r.d(t,"__importDefault",(function(){return F})),r.d(t,"__classPrivateFieldGet",(function(){return k})),r.d(t,"__classPrivateFieldSet",(function(){return C})),r.d(t,"__classPrivateFieldIn",(function(){return D}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var u,c=n.kind,f="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,s=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var y={};for(var v in n)y[v]="access"===v?{}:n[v];for(var v in n.access)y.access[v]=n.access[v];y.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var _=(0,r[p])("accessor"===c?{get:s.get,set:s.set}:s[f],y);if("accessor"===c){if(void 0===_)continue;if(null===_||"object"!=typeof _)throw new TypeError("Object expected");(u=a(_.get))&&(s.get=u),(u=a(_.set))&&(s.set=u),(u=a(_.init))&&o.push(u)}else(u=a(_))&&("field"===c?o.push(u):s[f]=u)}l&&Object.defineProperty(l,n.name,s),d=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function s(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function y(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function v(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}var _=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||_(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function O(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function j(e){return this instanceof j?(this.v=e,this):new j(e)}function G(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof j?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function P(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:j(e[n](t)),done:!1}:o?o(t):t}:o}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&_(t,e,r);return x(t,e),t}function F(e){return e&&e.__esModule?e:{default:e}}function k(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function C(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function P(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return P(!0)}),(function(e){return P(!1,e)}))}catch(e){P(!1,e)}}}]);']:
[Mb,"\n\n",'!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__esDecorate",(function(){return f})),r.d(t,"__runInitializers",(function(){return l})),r.d(t,"__propKey",(function(){return s})),r.d(t,"__setFunctionName",(function(){return d})),r.d(t,"__metadata",(function(){return p})),r.d(t,"__awaiter",(function(){return y})),r.d(t,"__generator",(function(){return v})),r.d(t,"__createBinding",(function(){return _})),r.d(t,"__exportStar",(function(){return g})),r.d(t,"__values",(function(){return b})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return m})),r.d(t,"__spreadArrays",(function(){return w})),r.d(t,"__spreadArray",(function(){return O})),r.d(t,"__await",(function(){return j})),r.d(t,"__asyncGenerator",(function(){return G})),r.d(t,"__asyncDelegator",(function(){return P})),r.d(t,"__asyncValues",(function(){return S})),r.d(t,"__makeTemplateObject",(function(){return T})),r.d(t,"__importStar",(function(){return E})),r.d(t,"__importDefault",(function(){return F})),r.d(t,"__classPrivateFieldGet",(function(){return k})),r.d(t,"__classPrivateFieldSet",(function(){return C})),r.d(t,"__classPrivateFieldIn",(function(){return D}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var u,c=n.kind,f="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?n.static?e:e.prototype:null,s=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),d=!1,p=r.length-1;p>=0;p--){var y={};for(var v in n)y[v]="access"===v?{}:n[v];for(var v in n.access)y.access[v]=n.access[v];y.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var _=(0,r[p])("accessor"===c?{get:s.get,set:s.set}:s[f],y);if("accessor"===c){if(void 0===_)continue;if(null===_||"object"!=typeof _)throw new TypeError("Object expected");(u=a(_.get))&&(s.get=u),(u=a(_.set))&&(s.set=u),(u=a(_.init))&&o.push(u)}else(u=a(_))&&("field"===c?o.push(u):s[f]=u)}l&&Object.defineProperty(l,n.name,s),d=!0}function l(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function s(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function y(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function v(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}var _=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||_(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function w(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function O(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function j(e){return this instanceof j?(this.v=e,this):new j(e)}function G(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof j?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function P(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:j(e[n](t)),done:!1}:o?o(t):t}:o}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&_(t,e,r);return x(t,e),t}function F(e){return e&&e.__esModule?e:{default:e}}function k(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function C(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function P(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return P(!0)}),(function(e){return P(!1,e)}))}catch(e){P(!1,e)}}}]);'],
{type:"application/javascript"}));Hb={};null!=ab.id&&(Hb.name=ab.id);this.worker=new Worker(this.tAd,Hb)}catch(Kb){throw null===(pb=this.worker)||void 0===pb?void 0:pb.terminate(),this.E9i(),Kb;}}Sa.prototype.E9i=function(){void 0!==this.tAd&&(URL.revokeObjectURL(this.tAd),this.tAd=void 0)};Sa.prototype.B9e=function(ab,Hb){var pb=this,Mb=ab.port,Qb=ab.options,Aa={type:"Thread",bOb:"Outside",id:Qb.id},bb=this.worker;ab=new Promise(function(nb,Va){pb.A2b={resolve:nb,reject:Va};nb={config:F(),port:Mb,
options:Qb,script:pb.script,args:pb.args,featureGateDictionary:Object(Oa.getFeatureGateDictionary)(),O6o:Object(Oa.getChangeGateDictionary)()};bb.postMessage(nb,Object(ca.__spreadArray)([Mb],pb.transferables,!0));bb.onerror=function(Ab){Ab.preventDefault();if(k(Ab.error))if(a(Ab.error))var Zb=Ab.error;else Zb={DZ:"UnhandledError",yD:Aa,error:Ab.error},Zb=new pa("".concat("worker.onerror"," received an unhandled error"),Zb);else null==Ab.message?(Zb={DZ:"UnhandledError",yD:Aa},Zb=new pa("".concat("worker.onerror",
" received a non-error (worker script fetch probably failed)"),Zb)):(Zb={DZ:"UnhandledError",yD:Aa},Ab="".concat(Ab.message," at ").concat(Ab.filename,":").concat(Ab.lineno,":").concat(Ab.colno),Zb=new pa("".concat("worker.onerror"," received an unhandled error: ").concat(Ab),Zb));pb.A2b?pb.A2b.reject(Zb):M(Zb)};bb.onmessage=function(Ab){var Zb,Kb;Ab=Ab.data;switch(Ab.kind){case 0:return Hb.syf=Ab.jz,void 0===Ab.error?null===(Zb=pb.A2b)||void 0===Zb?void 0:Zb.resolve():null===(Kb=pb.A2b)||void 0===
Kb?void 0:Kb.reject(z(Ab.error));case 1:return M(z(Ab.error));case 2:return T(Ab.stats)}}});return U(ab,function(){return void(pb.A2b=void 0)})};Sa.prototype.terminate=function(){var ab;if(this.worker){var Hb=this.worker;this.worker=void 0;null===(ab=this.A2b)||void 0===ab?void 0:ab.resolve();Hb.terminate();this.E9i()}};return Sa}(),Xa="undefined"!==typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};c.d(L,"WorkerError",
function(){return pa});c.d(L,"isThreadingSupported",function(){return v});c.d(L,"setConfig",function(){return E});c.d(L,"dispatchWorkerError",function(){return M});c.d(L,"paramInsideDef",function(){return e});c.d(L,"Endpoint",function(){return jb});c.d(L,"createWorker",function(){return Ha});c.d(L,"importScriptsWithRetry",function(){return oa});c.d(L,"isWorkerThread",function(){return wa});c.d(L,"workerName",function(){return ia})},942:function(D,L,c){function l(){return"undefined"===typeof __get_feature_gate_dictionary_variable?
k:__get_feature_gate_dictionary_variable()}function e(x,y){var m;return null!==(m=l()[x])&&void 0!==m?m:y}Object.defineProperty(L,"__esModule",{value:!0});L.p8f=L.getIntFeatureGate=L.l9h=L.getBooleanFeatureGate=L.getStringFeatureGate=L.C4h=void 0;var a=c(1033),k={};L.C4h=l;L.getStringFeatureGate=e;L.getBooleanFeatureGate=function(x,y){var m;x=null===(m=e(x))||void 0===m?void 0:m.trim().toLowerCase();return"true"===x?!0:"false"===x?!1:y};L.l9h=function(x,y){var m;x=null===(m=e(x))||void 0===m?void 0:
m.trim().toLowerCase();if(void 0===x)return y;if("infinity"===x||"+infinity"===x)return Infinity;if("-infinity"===x)return-Infinity;m=parseFloat(x);return isNaN(m)?y:m};L.getIntFeatureGate=function(x,y){var m;x=null===(m=e(x))||void 0===m?void 0:m.trim();if(void 0===x)return y;m=parseInt(x,10);return isNaN(m)?y:m};L.p8f=function(x){var y=a.globalThis.KNj;a.globalThis.KNj=x;return y}},943:function(D,L,c){function l(){return"undefined"===typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}
Object.defineProperty(L,"__esModule",{value:!0});L.Y7f=L.isChangeGateEnabled=L.v1h=void 0;var e=c(1033);L.v1h=l;L.isChangeGateEnabled=function(a){var k;return null!==(k=l()[a])&&void 0!==k?k:!0};L.Y7f=function(a){var k=e.globalThis.JNj;e.globalThis.JNj=a;return k}},955:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.method=this.api=0}}Object(D.a)(l,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19334779/wdjs/WordEditorDSVersionHistoryNotRemoved.box4.dll1.js.map