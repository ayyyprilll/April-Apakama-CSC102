/*
 Microsoft Corporation. All rights reserved.
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1487:function(D,L,c){c.d(L,"f",function(){return v});c.d(L,"e",function(){return E});c.d(L,"d",function(){return F});c.d(L,"g",function(){return J});c.d(L,"h",function(){return K});c.d(L,"a",function(){return H});c.d(L,"j",function(){return P});c.d(L,"i",function(){return N});c.d(L,"c",function(){return M});c.d(L,"b",function(){return I});var l=c(61),e=c(8),a=c(1494);c.n(a);D=[{role:2,roleType:a.RoleType.Title},
{role:3,roleType:a.RoleType.Subtitle},{role:4,roleType:a.RoleType.Heading1},{role:5,roleType:a.RoleType.Heading2},{role:6,roleType:a.RoleType.Heading3},{role:7,roleType:a.RoleType.Heading4},{role:8,roleType:a.RoleType.Heading5},{role:9,roleType:a.RoleType.Heading6},{role:10,roleType:a.RoleType.Heading7},{role:11,roleType:a.RoleType.Heading8},{role:12,roleType:a.RoleType.Heading9},{role:15,roleType:a.RoleType.ListItem},{role:13,roleType:a.RoleType.BodyText},{role:14,roleType:a.RoleType.Caption}];L=
[{role:1,wG:{default:"Unknown",dJ:null}},{role:2,wG:{default:"Title",dJ:Box4Intl.Box4Strings.L_StyleWordTitle}},{role:3,wG:{default:"Subtitle",dJ:Box4Intl.Box4Strings.L_StyleWordSubtitle}},{role:4,wG:{default:"Heading1",dJ:Box4Intl.Box4Strings.L_StyleWordHeading1}},{role:5,wG:{default:"Heading2",dJ:Box4Intl.Box4Strings.L_StyleWordHeading2}},{role:6,wG:{default:"Heading3",dJ:Box4Intl.Box4Strings.L_StyleWordHeading3}},{role:7,wG:{default:"Heading4",dJ:Box4Intl.Box4Strings.L_StyleWordHeading4}},{role:8,
wG:{default:"Heading5",dJ:Box4Intl.Box4Strings.L_StyleWordHeading5}},{role:9,wG:{default:"Heading6",dJ:Box4Intl.Box4Strings.L_StyleWordHeading6}},{role:10,wG:{default:"Heading7",dJ:Box4Intl.Box4Strings.L_StyleWordHeading17}},{role:11,wG:{default:"Heading8",dJ:Box4Intl.Box4Strings.L_StyleWordHeading8}},{role:12,wG:{default:"Heading9",dJ:Box4Intl.Box4Strings.L_StyleWordHeading9}},{role:13,wG:{default:"BodyText",dJ:Box4Intl.Box4Strings.L_StyleWordNormal}},{role:14,wG:{default:"Caption",dJ:Box4Intl.Box4Strings.L_StyleWordCaption}},
{role:15,wG:{default:"ListItem",dJ:null}},{role:16,wG:{default:"SubtleEmphasis",dJ:Box4Intl.Box4Strings.L_StyleWordSubtleEmphasis}},{role:17,wG:{default:"Emphasis",dJ:Box4Intl.Box4Strings.L_StyleWordEmphasis}},{role:18,wG:{default:"IntenseEmphasis",dJ:Box4Intl.Box4Strings.L_StyleWordIntenseEmphasis}},{role:19,wG:{default:"Strong",dJ:Box4Intl.Box4Strings.L_StyleWordStrong}},{role:20,wG:{default:"Quote",dJ:Box4Intl.Box4Strings.L_StyleWordQuote}},{role:21,wG:{default:"IntenseQuote",dJ:Box4Intl.Box4Strings.L_StyleWordIntenseQuote}},
{role:22,wG:{default:"SubtleReference",dJ:Box4Intl.Box4Strings.L_StyleWordSubtleReference}},{role:23,wG:{default:"IntenseReference",dJ:Box4Intl.Box4Strings.L_StyleWordIntenseReference}},{role:24,wG:{default:"BookTitle",dJ:Box4Intl.Box4Strings.L_StyleWordBookTitle}},{role:25,wG:{default:"NoSpacing",dJ:Box4Intl.Box4Strings.L_StyleWordNoSpacing}}];const k=new Map(L.map(T=>[T.wG.default,T.role])),x=new Map(L.map(T=>[T.role,T.wG.default])),y=new Map(L.map(T=>[T.role,T.wG.dJ])),m=new Map(D.map(T=>[T.roleType,
T.role])),u=new Map(D.map(T=>[T.role,T.roleType])),z=(T,U,W)=>T.has(U)?T.get(U):W,v=T=>z(k,T,1),E=T=>z(m,T,1),F=T=>z(u,T,a.RoleType.Unknown),J=T=>z(x,T,"Unknown"),K=T=>z(y,T,null),H=T=>{switch(T){case 4:return 0;case 5:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:return 8;default:return 9}},P=T=>{switch(T){case 13:return"Normal";case 1:return"Unknown";case 4:return"Heading 1";case 5:return"Heading 2";case 2:return"Title";case 15:return"List Paragraph";
case 3:return"Subtitle";case 14:return"Caption";case 6:return"Heading 3";case 7:return"Heading 4";case 8:return"Heading 5";case 9:return"Heading 6";case 10:return"Heading 7";case 11:return"Heading 8";case 12:return"Heading 9";case 16:return"Subtle Emphasis";case 17:return"Emphasis";case 18:return"Intense Emphasis";case 19:return"Strong";case 20:return"Quote";case 21:return"Intense Quote";case 22:return"Subtle Reference";case 23:return"Intense Reference";case 24:return"Book Title";case 25:return"No Spacing";
default:return"Unknown"}},N=T=>{switch(T){case 13:return l.StyleReader.wordStyleIdNormal;case 4:return l.StyleReader.wordStyleIdHeading1;case 5:return l.StyleReader.wordStyleIdHeading2;case 2:return l.StyleReader.L7a;case 15:return l.StyleReader.wordStyleIdListParagraph;case 3:return l.StyleReader.fmc;case 6:return l.StyleReader.wordStyleIdHeading3;case 7:return l.StyleReader.E7a;case 8:return l.StyleReader.F7a;case 9:return l.StyleReader.G7a;case 10:return l.StyleReader.Fpb;case 11:return l.StyleReader.Gpb;
case 12:return l.StyleReader.H7a;case 16:return l.StyleReader.K7a;case 17:return l.StyleReader.QTa;case 18:return l.StyleReader.I7a;case 19:return l.StyleReader.gmg;case 20:return l.StyleReader.mQb;case 21:return l.StyleReader.J7a;case 22:return l.StyleReader.hmg;case 23:return l.StyleReader.fmg;case 24:return l.StyleReader.emg;case 25:return l.StyleReader.lQb;case 14:return l.StyleReader.UEj;default:return e.ULS.sendTraceTag(512274639,3016,50,"Style ID not supported for role "+J(T)),"Unknown"}},
M=T=>{switch(T){case 18:case 21:case 23:return!0;default:return!1}},I=T=>4<=T&&12>=T},1488:function(D,L,c){c.d(L,"c",function(){return J});c.d(L,"b",function(){return K});c.d(L,"t",function(){return P});c.d(L,"r",function(){return I});c.d(L,"q",function(){return T});c.d(L,"g",function(){return U});c.d(L,"d",function(){return W});c.d(L,"o",function(){return V});c.d(L,"n",function(){return Y});c.d(L,"a",function(){return da});c.d(L,"e",function(){return ba});c.d(L,"i",function(){return ja});c.d(L,"m",
function(){return sa});c.d(L,"s",function(){return ta});c.d(L,"j",function(){return ra});c.d(L,"k",function(){return ma});c.d(L,"h",function(){return Ba});c.d(L,"v",function(){return Pa});c.d(L,"u",function(){return Da});c.d(L,"p",function(){return ia});c.d(L,"f",function(){return pa});c.d(L,"l",function(){return Ma});D=c(21);var l=c(60),e=c(106),a=c(143);L=c(433);var k=c(41),x=c(10),y=c(55),m=c(457),u=c(6),z=c(8),v=c(1497),E=c(1593);const F=()=>document.getElementById(a.AppFrame.MTa),J=new L.a,K=
`.ParaWrappingDiv .${k.a.eId}`,H=D.a.instance.We("Box4.CommentParagraphMapping"),P=[Box4Intl.Box4Strings.l_HK_Bold,Box4Intl.Box4Strings.l_HK_Bold_Mac,Box4Intl.Box4Strings.l_HK_Italic,Box4Intl.Box4Strings.l_HK_Italic_Mac,Box4Intl.Box4Strings.l_HK_Underline,Box4Intl.Box4Strings.l_HK_Underline_Mac];let N=void 0;const M=()=>{if(void 0===N){let ya;try{ya=CSS.supports("selector(:not(* *))")}catch(Oa){ya=!1}ya||z.ULS.sendTraceTag(526263553,324,15,"Cannot use complex CSS selector in CommentHelpers, falling back to less performant alternative");
N=ya}return N},I=ya=>!!ya&&!!ya.Ff,T=(ya,Oa,fa,Ca)=>{if(!ya||!ya.objectId)return!1;const Ta=fa.Db(l.a.Gf(ya.objectId)),eb=v.a.z7b(Ta,!0),jb=v.a.z7b(Ta,!1);if(!eb||!jb||eb===jb&&eb!==Oa||!x.ParagraphReader.ETc(Oa,eb,jb))return!1;ya=!0;var ob=!1;eb===Oa&&(ob=v.a.Iaa(Ta,fa,!0),ya=ya&&!!ob&&ob.Kb.cp<=Ca,ob=!!ob&&ob.Kb.cp===Ca);Oa===jb&&(Oa=v.a.Iaa(Ta,fa,!1),ya=ya&&!!Oa&&Oa.Kb.cp>Ca,ob=ob&&!!Oa&&Oa.Kb.cp===Ca);return ya||ob},U=ya=>{if(!ya)return null;ya=e.a.Db(ya,k.a.RFc);return null!==ya&&void 0!==ya?
ya:[]},W=ya=>ya?e.a.Db(ya,k.a.sDd):null,V=(ya,Oa)=>{if(!ya)return-1;for(let fa=0;fa<ya.length;fa++)if(ya[fa].yec.equals(Oa))return fa;return-1},Y=(ya,Oa)=>{if(!ya)return-1;for(let fa=0;fa<ya.length;fa++)if(ya[fa].Eoi.equals(Oa))return fa;return-1},da=ya=>`Comment Object Id: ${ya.objectId}`,ba=(ya=!1)=>pa(F(),ya),ja=()=>y.a.Oj?Array.from(F().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart")):
ca()?Array.from(F().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart")):[],sa=(ya,Oa=!1)=>{if(ya.yj){for(const fa of ya.Rg.Pi)if(Ma(fa,Oa))return!0;return!1}return Ma(ya.htmlElement,Oa)},ta=ya=>!!ya&&!!ya.ia(u.a.QL,null),ra=()=>{const ya=new Set,Oa=ja();for(let fa=0;fa<Oa.length;fa++)U(Oa[fa]).forEach(Ca=>{ya.add(Ca.toString())});return ya},ma=(ya,Oa)=>Oa?Ha(ya,!0,Oa):oa(ya,!0),Ba=(ya,Oa)=>Oa?Ha(ya,!1,Oa):oa(ya,!1),Pa=(ya,Oa)=>{wa(ya,
Oa,!0);m.a.isEnabled&&!ya.Cib&&z.ULS.sendTraceTag(512372928,327,50,`Adding to CommentParagraphMapping CommentId: ${ya.id} StartParaId: ${Oa}`)},Da=(ya,Oa)=>{wa(ya,Oa,!1);m.a.isEnabled&&!ya.Cib&&z.ULS.sendTraceTag(512372899,327,50,`Adding to CommentParagraphMapping CommentId: ${ya.id} EndParaId: ${Oa}`)},Ha=(ya,Oa,fa)=>{var Ca,Ta;const eb=ya.id.toString();return Oa?m.a.isEnabled?null!==(Ca=H.value.kZa.get(eb))&&void 0!==Ca?Ca:fa:ya.ia(u.a.NSa,fa):m.a.isEnabled?null!==(Ta=H.value.jZa.get(eb))&&void 0!==
Ta?Ta:fa:ya.ia(u.a.Gua,fa)},oa=(ya,Oa)=>{const fa=ya.id.toString();return Oa?m.a.isEnabled?H.value.kZa.get(fa):ya.getValue(u.a.NSa):m.a.isEnabled?H.value.jZa.get(fa):ya.getValue(u.a.Gua)},wa=(ya,Oa,fa)=>{const Ca=ya.id.toString();m.a.isEnabled?ya.Cib||(fa?H.value.kZa:H.value.jZa).set(Ca,Oa):ya.setValue(fa?u.a.NSa:u.a.Gua,Oa)},ia=ya=>m.a.isEnabled?H.value.kZa.has(ya.objectId)&&H.value.jZa.has(ya.objectId):!0,ca=()=>0===E.a.Cj||2===E.a.Cj,pa=(ya,Oa)=>{if(Oa&&(ca()||y.a.Oj)){if(M())return Array.from(ya.querySelectorAll(y.a.Oj?
".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)":".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)"));Oa=y.a.Oj?ya.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart"):
ya.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart");const fa=Oa.length;if(0<fa){ya=ya.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart");const Ca=[];let Ta=0;for(let eb=0,jb=ya.length;eb<jb;eb++){const ob=ya[eb];Ta<fa&&Oa[Ta]===ob?++Ta:Ca.push(ob)}return Ca}}return Array.from(ya.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart"))},Ma=(ya,Oa)=>{if(Oa&&(ca()||y.a.Oj)){if(M())return!!ya.querySelector(y.a.Oj?
".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)":".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)");Oa=y.a.Oj?ya.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart").length:
ya.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart").length;if(0<Oa)return Oa!==ya.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart").length}return!!ya.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart")}},1491:function(D,L,c){c.d(L,"a",function(){return k});D=c(0);var l=c(2),e=c(1790),a=c(16);class k{static d5h(){return k.Hsk+"_"+e.a.bQc+"_"+a.a.FW(l.AFrameworkApplication.userName)+
"_"}static B_h(x){return x+"_"+e.a.bQc+"_"+a.a.FW(l.AFrameworkApplication.userName)+"_"}static tai(){return k.LAn+"_"+e.a.bQc+"_"+a.a.FW(l.AFrameworkApplication.userName)+"_"}}k.Yka="ack0";k.Zka="ack1";k.Cyd="ack2";k.Hsk="ack3";k.MCc="ack4";k.pnh="ack7";k.bGf="ack8";k.clj="ack9";k.C0e="ack10";k.blj="ack13";k.QAi="ack14";k.Eyd="AddinDetailsRefreshed";k.Fsk="DdaMethod";k.Esk="ControlId";k.Fyd="OsfcontrolId";k.IYe="SecurityOrigin";k.B_b="ak0";k.Lsk="ak1";k.snh="ak2";k.NCc="ak4";k.onh="Office.AutoShowTaskpaneWithDocument";
k.qnh="value";k.Ksk="errorCode";k.Bkl="SourceControlId";k.zkl="OsfControl";k.Akl="RibbonUpdaterData";k.Pje="AddinShared";k.LAn="__OSF_PRIVATECATALOG_ADDINIDS";Object(D.a)(k,"AddinConstantsString",null,[])},1493:function(D,L,c){var l=this&&this.RD||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.xy:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=
x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1807),L);e(c(1808),L);D.exports.ErrorCode||Object.defineProperty(D.exports,"ErrorCode",{enumerable:!0,get:function(){return D.exports.ErrorCode}});D.exports.FormattingSuggestionType||Object.defineProperty(D.exports,"FormattingSuggestionType",{enumerable:!0,get:function(){return D.exports.FormattingSuggestionType}});
D.exports.FormattingSuggestionsAnnotation||Object.defineProperty(D.exports,"FormattingSuggestionsAnnotation",{enumerable:!0,get:function(){return D.exports.FormattingSuggestionsAnnotation}});D.exports.FormattingSuggestionsRange||Object.defineProperty(D.exports,"FormattingSuggestionsRange",{enumerable:!0,get:function(){return D.exports.FormattingSuggestionsRange}});D.exports.FormattingSuggestionsSummaryAnnotation||Object.defineProperty(D.exports,"FormattingSuggestionsSummaryAnnotation",{enumerable:!0,
get:function(){return D.exports.FormattingSuggestionsSummaryAnnotation}})},1494:function(D,L,c){var l=this&&this.RD||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.xy:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||
l(k,a,x)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1792),L);e(c(1793),L);D.exports.DocumentRoleDetectionAnnotation||Object.defineProperty(D.exports,"DocumentRoleDetectionAnnotation",{enumerable:!0,get:function(){return D.exports.DocumentRoleDetectionAnnotation}});D.exports.RoleDetectionAnnotation||Object.defineProperty(D.exports,"RoleDetectionAnnotation",{enumerable:!0,get:function(){return D.exports.RoleDetectionAnnotation}});D.exports.RoleDetectionCustomMetadata||Object.defineProperty(D.exports,
"RoleDetectionCustomMetadata",{enumerable:!0,get:function(){return D.exports.RoleDetectionCustomMetadata}});D.exports.RoleDetectionSettings||Object.defineProperty(D.exports,"RoleDetectionSettings",{enumerable:!0,get:function(){return D.exports.RoleDetectionSettings}});D.exports.RoleType||Object.defineProperty(D.exports,"RoleType",{enumerable:!0,get:function(){return D.exports.RoleType}})},1497:function(D,L,c){D=c(0);var l=c(21),e=c(67),a=c(60),k=c(2),x=c(731),y=c(118),m=c(200),u=c(627),z=c(11),v=
c(5),E=c(267),F=c(10),J=c(457),K=c(390),H=c(1171),P=c(92),N=c(70),M=c(1752),I=c(1795),T=c(1796),U=c(17),W=c(6),V=c(602),Y=c(8),da=c(117),ba=c(236),ja=c(80),sa=c(1655);class ta extends Sys.EventArgs{constructor(wa,ia){super();this.graphNode=wa;this.SUk=ia}}Object(D.a)(ta,"OnCopyCommentEventArgs",Sys.EventArgs,[]);class ra extends Sys.EventArgs{constructor(wa,ia){super();this.graphNode=wa;this.QSk=ia}}Object(D.a)(ra,"OnPasteCommentEventArgs",Sys.EventArgs,[]);var ma=c(1201),Ba=c(1488),Pa=c(1558);class Da extends Sys.EventArgs{constructor(wa){super();
this.commentNode=wa}}Object(D.a)(Da,"OnDeleteEventArgs",Sys.EventArgs,[]);class Ha extends Sys.EventArgs{constructor(wa){super();this.commentNode=wa}}Object(D.a)(Ha,"OnPasteEventArgs",Sys.EventArgs,[]);c.d(L,"a",function(){return oa});class oa{static get characterPropertiesEditor(){return null!=oa.ftg?oa.ftg:oa.ftg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get kd(){return null!=oa.Lug?oa.Lug:oa.Lug=new e.a}static get sCa(){return Pa.a.instance}static get Hi(){return z.App.ya.jb.Wc.ud}static get Xb(){return null!=
oa.Nvg?oa.Nvg:oa.Nvg=l.a.instance.Ma("Box4.IFeatureHelper")}static isComment(wa){return 40===wa.Xe}static jWd(wa){return 40===wa.type}static Bzf(wa){return!!wa&&39===wa.Xe}static CQf(wa,ia){ia.property===U.a.gf&&(oa.VFb=!1)}static GQf(wa,ia){ia&&!wa.Oc&&oa.mMh(wa)}static mMh(wa){const ia=wa.Kb.paragraph.Mc;wa=ia.Db(wa.Tj);oa.HJc();wa&&wa.anchor&&oa.deleteComment(wa,ia)}static C9e(wa){const ia=new v.GraphIterator;ia.set(wa.Ei());oa.sCa.G3a(ia);return ia}static deleteComment(wa,ia){wa?(oa.HJc(),oa.SGd(wa,
ia),wa.anchor&&(oa.kd.raiseEvent(oa.UYc,new Da(wa)),ia=wa.ia(W.a.wE,0),Y.ULS.sendTraceTag(592188697,327,15,`Comment deleted by canvas anchor removal. ${wa.id}`),oa.ZLg.add(ia.toString()),ia=new v.GraphIterator,ia.set(wa),ia.Ab(39),ia.Dg())):Y.ULS.sendTraceTag(512275402,327,50,"Comment Node is Undefined")}static IAm(wa){return oa.ZLg.contains(wa)}static SGd(wa,ia){oa.HJc();const ca=oa.Iaa(wa,ia,!0);ia=oa.Iaa(wa,ia,!1);oa.xmb(ca);oa.xmb(ia);ca&&ia&&ca.Kb===ia.Kb&&Y.ULS.sendTraceTag(50619292,327,10,
`comment ${wa.id} start and end range objects belonged to same chp`)}static xmb(wa){if(wa&&wa.Kb.uf){wa.Kb.uf.remove(wa);const ia=wa.Kb.paragraph;0<=wa.ze&&wa.ze<ia.Ae.length&&(wa.Kb.cp||1!==ia.Ae.length||(ia.Ae.BX(0,4),ia.Ae.$p.Z(1,E.CharacterPropertiesEditor.sM),ia.Ae.Ps.Z(1,E.CharacterPropertiesEditor.VQ)),ia.Ae.removeAt(wa.ze,4));ia.Pm()}}static Qen(wa,ia){if(ia){var ca=ia.paragraph;wa=ia.cpBegin;var pa=ia.cpEnd;if(ca&&F.ParagraphReader.Yb(ca)&&(ca=ca.qa)){ia.Go[oa.EDd]||(ia.Go[oa.EDd]=[]);ia=
ia.Go[oa.EDd];for(let ya=0;ya<ca.length;ya++){const Oa=ca.J(ya).uf;if(!Oa)continue;const fa=Oa.length;var Ma=ca.J(ya).cp;if(Ma<wa||Ma>pa)for(Ma=0;Ma<fa;Ma++)ia.push(Oa.J(Ma))}}}}static Zdn(wa,ia){if(ia&&(wa=ia.Go[oa.EDd]))for(ia=0;ia<wa.length;ia++)oa.mMh(wa[ia])}static Iaa(wa,ia,ca){if(!wa)return null;const pa=ca?Ba.k(wa,a.a.nil):Ba.h(wa,a.a.nil);ia=ia.Db(pa);return ia?oa.ava(ia,wa.id,ca):(ca||Y.ULS.sendTraceTag(4531344,327,15,`Comment anchor missing! Comment Id: ${wa.id} Anchor Id: ${pa} ${oa.HAm(pa)}`),
null)}static HAm(wa){return J.a.isEnabled?`isDeletedParagraph: ${oa.MMh.has(wa.toString())}`:""}static ava(wa,ia,ca){for(let pa=0;pa<wa.qa.length;pa++){const Ma=wa.qa.J(pa);if(Ma.uf)for(let ya=0;ya<Ma.uf.length;ya++)if(Ma.uf.J(ya).Tj.equals(ia)&&ca===Ma.uf.J(ya).Oc)return Ma.uf.J(ya)}return null}static z7b(wa,ia){if(!wa)return null;ia=ia?Ba.k(wa,a.a.nil):Ba.h(wa,a.a.nil);return wa.Mc.Db(ia)}static rMc(wa,ia,ca,pa=null){const Ma=!pa;for(let ya=0;ya<wa.qa.length;ya++){const Oa=wa.qa.J(ya);if(Oa.cp>=
ia&&Oa.uf)for(let fa=0;fa<Oa.uf.length;fa++){const Ca=Oa.uf.J(fa).Tj.toString();if(Oa.uf.J(fa).Oc===ca&&(Ma||pa.contains(Ca)))return Oa.uf.J(fa)}}return null}static $Tl(wa,ia,ca,pa){for(let Ma=0;Ma<wa.qa.length;Ma++){const ya=wa.qa.J(Ma);if(ya.cp>ia)break;if(ya.cp===ia&&ya.uf)for(let Oa=ya.uf.length-1;0<=Oa;Oa--){const fa=ya.uf.J(Oa).Tj.toString();if(ya.uf.J(Oa).Oc===ca&&pa.contains(fa))return ya.uf.J(Oa)}}return null}static UZb(wa,ia,ca,pa){let Ma=null;for(let ya=0;ya<wa.qa.length;ya++){let Oa=wa.qa.J(ya);
if(Oa.cp>=ca){Oa.cp>ca||!Oa.formatting?(Ma=oa.characterPropertiesEditor.tY(wa,ya,ca,Ma),Oa=wa.qa.J(ya)):Ma=Oa.formatting;Oa.uf||(Oa.uf=new K.a(Oa));oa.Exd(ia,Oa.uf,Ma.Dj,pa);break}Oa.formatting&&(Ma=Oa.formatting)}}static Exd(wa,ia,ca,pa){ca=ia.Kb.paragraph;const Ma=new H.a(ia.Kb,null,wa,pa);for(let ya=0;ya<ia.length;ya++)if(ia.J(ya).Tj===wa&&ia.J(ya).Oc===pa){Y.ULS.sendTraceTag(589616028,327,10,"CommentRangeObject {0} already exists with isStart value {1} in commentRangeObjects",wa,pa);break}ia.add(Ma);
ca.Pm();Ma.ze?ca.Ae.BX(Ma.ze-1,4):ca.Ae.sna(Ma.ze,4);ca.Ae.$p.Z(Ma.ze,E.CharacterPropertiesEditor.sM);ca.Ae.Ps.Z(Ma.ze,E.CharacterPropertiesEditor.VQ);return Ma}static HJc(){if(!oa.VFb){var wa=new v.GraphIterator;wa.set(z.App.ya.jb.Wc);oa.sCa.G3a(wa);if(wa.Tb(1))for(;wa.wf(1););oa.VFb=!0}}static fvl(wa){const ia=new v.GraphIterator;ia.set(z.App.ya.jb.Wc);oa.sCa.G3a(ia);if(39!==ia.Xe)return!1;let ca;if(ca=ia.Tb(1)){if(ca.id.equals(wa))return!0;for(;ca=ia.wf(1);)if(ca.id.equals(wa))return!0}return!1}static GJb(wa,
ia){oa.A2c(ia)}static WJj(wa,ia){J.a.isEnabled&&(wa=ia.node)&&(ia=F.ParagraphReader.rQ(wa),oa.sde(ia)&&oa.MMh.add(wa.id.toString()))}static sde(wa){return 0<wa?document.querySelector("div.PageContentContainer p[paraid='"+wa+"']"):null}static A2c(wa){oa.T1f(F.ParagraphReader.PCb(wa));let ia=null;var ca=new v.GraphIterator;ca.set(wa);if(ca.Yo()&&(ca=P.a.at(ca,ca.origin),ca.moveNext()))for(;ca.moveNext();)if(F.ParagraphReader.rh(ca.iterator)){ia=ca.iterator.currentNode;break}if(ia){wa=F.ParagraphReader.PCb(wa);
for(const pa of wa)pa.Oc&&(wa=pa.Kb.paragraph.Mc.Db(pa.Tj))&&(oa.xmb(pa),oa.UZb(ia,wa.id,0,!0),Ba.v(wa,ia.id))}}static T1f(wa){for(const ia of wa)if(!ia.Oc){wa=ia.Kb.paragraph.Mc;const ca=wa.Db(ia.Tj);oa.deleteComment(ca,wa)}}static yPd(wa,ia){const ca=[];if(!wa)return Y.ULS.shipAssertTag(594908762,327,!1,"Trying to highlight null node."),ca;if(!wa.isConnected)return Y.ULS.shipAssertTag(51467871,327,!1,"Trying to highlight disconnected node."),ca;const pa=oa.Iaa(wa,oa.Hi,!0),Ma=oa.Iaa(wa,oa.Hi,!1);
if(!pa||!Ma)return Y.ULS.shipAssertTag(51467872,327,!1,`Missing comment anchor ${wa.id}`),ca;wa=!1;let ya=pa.Kb.paragraph;for(;ya&&(!ia||!ia(ya,ya===pa.Kb.paragraph));){ya===pa.Kb.paragraph&&(wa=!0);wa&&ca.push(ya);if(ya===Ma.Kb.paragraph)break;ya=F.ParagraphReader.ug(ya,!1)}return ca}static DQf(wa,ia){ia.Go.Comments||(ia.Go.Comments={});oa.J4d(ia.operation,ia.LSi,ia.original,ia.clone,ia.Go.Comments,!0)}static FQf(wa,ia){ia.Go.Comments||(ia.Go.Comments={});oa.J4d(ia.operation,ia.LSi,ia.original,ia.clone,
ia.Go.Comments,!1)}static Nfn(wa,ia){ia.Go.Comments||(ia.Go.Comments={});wa=ia.Go.Comments;if((ia=Object.keys(wa))&&0<ia.length)for(let ca=0;ca<ia.length;ca++){const pa=wa[ia[ca].toString()];pa&&(pa.Tj=null,oa.xmb(pa))}}static J4d(wa,ia,ca,pa,Ma,ya){const Oa=ca.Mc;var fa=F.ParagraphReader.PCb(pa);fa.sort((Xa,Sa)=>Xa.Kb.cp<Sa.Kb.cp||Xa.Kb.cp===Sa.Kb.cp&&Xa.Oc?-1:Xa.Kb.cp===Sa.Kb.cp&&Xa.Oc===Sa.Oc?0:1);const Ca=new ja.a,Ta=new ba.a,eb=oa.Xb.isFeatureEnabled(114);for(const Xa of fa)if(Object(da.a)(ma.PageView,
N.InteractiveViewManager.instance.vd)){var jb=Oa.Db(Xa.Tj);if(jb&&jb.isConnected)if(Xa.Oc)Ma[Xa.Tj.toString()]=Xa;else{var ob=jb.ia(W.a.wE,0);fa=ya?oa.x0c(jb,pa,wa,ia):oa.C0c(jb,pa,wa,ia);if(ya)eb&&(ob=v.GraphIterator.$a(pa),ob.Ab(25)&&ob.fd(25)&&sa.a.kd.raiseEvent(sa.a.jNi,new ta(ob.currentNode,fa.getValue(W.a.wE))));else{if(eb){var Ya=fa.ia(W.a.wE,0);ob&&Ya&&(Ta.ob(ob)?Ta.J(ob)!==Ya&&Y.ULS.sendTraceTag(589616029,327,10,"Failed to add Key {0}, Value {1} to clonedDurableIdMapping, since Key {0}, Value {2} already exists. This could affect copy/paste of tasks.",
ob,Ya,Ta.J(ob)):Ta.add(ob,Ya))}fa.setValue(W.a.Aib,!0);jb.ia(W.a.v6e,null)||(ob=jb.ia(W.a.aNa,null))&&fa.setValue(W.a.v6e,ob);fa.setValue(W.a.aNa,k.AFrameworkApplication.userSessionId)}ob=Xa.Tj.toString();Ya=Ma[ob];Xa.Tj=fa.id;if(!ya){Xa.Pu=null;jb=jb.getValue(W.a.gH);const Sa=fa.getValue(W.a.gH);Ma[jb]=Sa;if(jb=fa.ia(W.a.QL,null))Ca.ob(jb)||Ca.add(jb,[]),Ca.J(jb).push(fa)}Ba.u(fa,pa.id);pa.id||Y.ULS.shipAssertTag(5564305,327,!1,"Comment node has no end anchor!");Ya?(Ya.Tj=fa.id,ya||(Ya.Pu=null),
Ba.v(fa,Ya.Kb.paragraph.id),delete Ma[ob]):(oa.UZb(pa,fa.id,Xa.Kb.cp,!0),Ba.v(fa,pa.id))}else Y.ULS.sendTraceTag(592188835,327,10,String.format("Node is null or not connected, IsNodeChildOfCommentContent:{0}, IsNull:{1}",oa.fvl(Xa.Tj),!jb)),Xa.Tj=null,oa.xmb(Xa)}else Xa.Tj=null,oa.xmb(Xa);if(!ya){for(const Xa of Ca){wa=Xa.key;ia=Xa.value;for(const Sa of ia)Sa.setValue(W.a.QL,Ma[wa])}0<Ta.count&&eb&&(ca=v.GraphIterator.$a(ca),ca.Ab(25)&&ca.fd(25)&&sa.a.kd.raiseEvent(sa.a.IPi,new ra(ca.currentNode,
Ta)))}pa.Zj()}static wff(wa,ia){if(wa.Ab(25)&&wa.fd(25)&&!wa.Xr(16)){const ca=v.GraphIterator.$a(ia);ca.Ab(39);ca.fd(39);ia=V.a(ca.currentNode,ia.Ei().Mc,!0);wa.Qf(ia,16)}}static u8e(wa,ia){var ca=ia.Ei().ud;ca=V.a(wa,ca,!0);ia=v.GraphIterator.$a(ia);oa.wff(ia,wa);ia.Tb(16);ia.q2(ca,1,wa.id);return ca}static x0c(wa,ia,ca,pa){oa.HJc();ia=oa.u8e(wa,ia);ia.Cib=!0;oa.aql(wa,ia,ca,pa);return ia}static aql(wa,ia,ca,pa){wa=new M.a(v.GraphIterator.$a(wa),v.GraphIterator.$a(ia),{});wa.BNb=!0;ca=new x.a(ca,
pa,new I.a(wa,null));ca.Hg=!0;ca.ul("ExecuteInternalCommentCopy");ca.run()}static C0c(wa,ia,ca,pa){oa.HJc();var Ma=ia.Ei().ud;ia=v.GraphIterator.$a(ia);ia.Ab(7);ia.fd(7);ia.Tb(16);Ma=V.a(wa,Ma,!0);Ma.Yg(W.a.gH,y.a.create().toString());Ma.Yg(W.a.commentId,m.a.aF());let ya=!1;oa.Vyi(Ma.Lf(W.a.wE))?ya=!0:Ma.Yg(W.a.wE,oa.knf());ia.Qf(Ma,1);oa.bql(wa,Ma,ca,pa);ia.Fi(Ma);ia.ME(1);ia.ugb(2);ia.Tb(2);Ma.setValue(W.a.gH,ia.currentNode.Lf(W.a.Lc).toString());oa.kd.raiseEvent(oa.Ukn,new Ha(Ma));ya&&this.NKh.add(Ma.id.toString());
return Ma}static bql(wa,ia,ca,pa){wa=new T.a(v.GraphIterator.$a(wa),v.GraphIterator.$a(ia),null,null);ca=new x.a(ca,pa,wa);ca.Hg=!0;ca.ul("ExecuteInternalCommentPaste");ca.run()}static knf(){const wa=m.a.Kfc(1,this.EGi);return oa.Vyi(wa)?wa:oa.knf()}static Vyi(wa){if(!wa)return!1;if(z.App.ya){const ia=new v.GraphIterator;ia.set(z.App.ya.jb.Wc);oa.sCa.G3a(ia);let ca=ia.Sd();for(;ca;){if(ca.Lf(W.a.wE)===wa)return!1;ca=ia.Wj()}}return!0}static fYe(wa){oa.kd.addHandler(oa.UYc,wa)}}oa.Ukn="OnPaste";oa.UYc=
"OnDelete";oa.EDd="CommentRangesToTrimOutsideSelection";oa.ZLg=new u.a;oa.VFb=!1;oa.EGi=2147483646;oa.NKh=new Set;oa.MMh=new Set;Object(D.a)(oa,"CommentEditor",null,[])},1502:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l extends Sys.EventArgs{constructor(e){super();this.data=e}}Object(D.a)(l,"DesignerEventArgs",Sys.EventArgs,[])},1506:function(D,L,c){c.d(L,"a",function(){return y});D=c(0);var l=c(6),e=c(310),a=c(1178),k=c(1086),x=c(8);class y{constructor(m,u,z,v){this.DQm=m;this.kvm=
u;this.jvm=z;this.YVi=v}Kec(m,u,z,v,E){m?(m=this.aHc(m,u,z),null!==m&&(v=this.K8e(v,m,E),this.jvm.setState(this.DQm.value,v))):x.ULS.shipAssertTag(543499408,3016,!1,"No ParagraphNode")}aHc(m,u,z){return 0>z?(x.ULS.sendTraceTag(539018900,389,10,"Attempted to create a ParagraphRange descriptor with negative length"),null):e.a.jHc(m.ia(l.a.Lc,-1),m.ia(l.a.sj,-1),u,z,u,z,m)}K8e(m,u,z){return Object.assign(new k.a,{annotationType:m,contentDescriptor:u,state:z})}gzf(m,u,z,v,E){if(m){var F=m.ia(l.a.Lc,-1),
J=m.ia(l.a.sj,-1);-1===F||-1===J?E(null):(m=this.aHc(m,u,z),null===m?E(0):this.kvm.rZc(m,v,K=>{E(K)}))}else x.ULS.shipAssertTag(543499409,3016,!1,"No ParagraphNode")}Kvn(m){if(m){var u=a.a.N2k(m);this.YVi.elh({Inb:u,settingType:m})||x.ULS.shipAssertTag(521416710,3016,!1,"Persist Designer suppression setting failed")}}WJm(m){return new Promise(u=>{this.YVi.F$h(m,z=>{(null===z||void 0===z?0:z.Inb)?u(z.Inb):u(null)})})}}y.gZf="WordDesignerPullQuotesAnnotation";y.nLh="WordDesignerDefaultAnnotation";y.Ldg=
"WordDesignerSuggestedImageAnnotation";y.usj="WordDesignerThemeImageAnnotation";y.zdg="WordDesignerStylizedTitleAnnotation";y.Z1b="WordDesignerComplexDecoratorAnnotationType";y.cNh="DesignerPaneSuppressionSetting";Object(D.a)(y,"PersistenceHelperImpl",null,[1087])},1507:function(D,L,c){function l(H){return 1===(null===H||void 0===H?void 0:H.wq)||3===(null===H||void 0===H?void 0:H.wq)}D=c(0);var e=c(35),a=c(48),k=c(28),x=c(8),y=c(1605),m;(function(H){H[H.initial=0]="initial";H[H.MVo=.1]="viewingOriginal";
H[H.nzk=.5]="applying";H[H.applied=1]="applied";H[H.accepted=2]="accepted";H[H.rejected=3]="rejected";H[H.dep=4]="roleChanged";H[H.fap=5]="invalidated"})(m||(m={}));Object(D.b)("ReviewIntentState",m);const u=H=>{switch(H){case m.MVo:return m.rejected;case m.nzk:return m.applied;default:return H}};var z=c(149);c.d(L,"d",function(){return E});c.d(L,"e",function(){return l});c.d(L,"b",function(){return F});c.d(L,"c",function(){return J});c.d(L,"a",function(){return K});class v{constructor(H,P,N=null,
M,I=!0){this.id=H;this.wq=P;this.MD=N;this.ie=M;this.Wzm=I;this.zti=!1;this.jAi=e.a.Ue()}Aii(){return!1}mQa(H){this.Aba(m[u(H)]);this.o1d(H)}o1d(H){1===H&&this.MD&&this.ie&&(this.Wzm?(this.ie.rxm()&&this.MD.execute(P=>{P.logActivity(z.a.NMj,null)}),2===this.wq&&this.ie.YKm()?this.MD.execute(P=>{P.logActivity(z.a.cNj,null)}):1===this.wq&&this.ie.YGm()?this.MD.execute(P=>{P.logActivity(z.a.XMj,null)}):0===this.wq&&this.ie.WCm()&&this.MD.execute(P=>{P.logActivity(z.a.RMj,null)})):4===this.wq&&this.ie.RAm()&&
this.MD.execute(P=>{P.logActivity(z.a.PMj,null)}))}FWc(){6E4>e.a.Ue()-this.jAi?this.Aba("removed"):x.ULS.sendTraceTag(539109067,3016,50,"ID: {0}, Type: {1}, State: {2}",this.id,this.wq,"removedButKept")}gYm(){this.zti||(this.Aba("hovered"),this.zti=!0)}Aba(H){this.jAi=e.a.Ue();x.ULS.sendTraceTag(540357460,3016,50,"ID: {0}; Type: {1}, State: {2};",this.id,this.wq,H);a.a(z.a.Ydl,!0,void 0,[Object.assign(new k.a,{name:"suggestionType",int64:this.wq}),Object.assign(new k.a,{name:"ID",string:this.id.toString()}),
Object.assign(new k.a,{name:"State",string:H})])}}Object(D.a)(v,"DesignerSuggestion",null,[]);class E extends v{constructor(H,P=1,N=null,M,I=!1,T=0,U=""){super(H,P,N,M,I);this.B4a=T;this.S0c=U}}Object(D.a)(E,"PullQuoteSuggestion",v,[]);class F extends v{constructor(H,P,N,M=null,I,T){super(H,2,M,I);this.CQ=P;this.baseUrl=N;this.dZd=T;this.selectedIndex=0;this.ujc=z.a.Xpm}kom(){x.ULS.shipAssertTag(527708514,3016,this.ujc===z.a.vcn,`${this.ujc}`);this.ujc=Math.min(this.CQ.length,z.a.k2d)}Aii(){return this.ujc<
Math.min(this.CQ.length,z.a.k2d)}nDb(H){return H>=this.CQ.length?(x.ULS.shipAssertTag(527708515,3016,!1),null):this.baseUrl+this.CQ[H].imageId}Csf(H){return H>=this.CQ.length?(x.ULS.shipAssertTag(527708544,3016,!1),null):this.baseUrl+this.CQ[H].thumbnailId}iX(H){return H>=this.CQ.length?(x.ULS.shipAssertTag(527708545,3016,!1),null):this.CQ[H].altText?this.CQ[H].altText:this.CQ[H].category===y.SuggestionCategory.AbstractImage?WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionAbstractImageAltText:
WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}cSl(H){var P;return H>=this.CQ.length?(x.ULS.shipAssertTag(527210446,3016,!1),0):null!==(P=this.CQ[H].score)&&void 0!==P?P:0}mQa(H){if(!this.dZd){const P=m[u(H)];x.ULS.sendTraceTag(509653453,3016,50,"ID: {0}; Type: ImageSuggestion for Heading , State: {1};",this.id,P);a.a(z.a.Idl,!0,void 0,[Object.assign(new k.a,{name:"ID",string:this.id.toString()}),Object.assign(new k.a,{name:"State",string:P})])}super.mQa(H)}}Object(D.a)(F,"ImageSuggestion",
v,[]);class J extends v{constructor(H,P=null,N,M,I=null){super(H,0,P,N,M);this.metadata=I;this.XHi=!1}mQa(H){this.XHi||(this.XHi=!0,this.metadata&&a.a(z.a.E3k,!0,0,this.metadata.concat([Object.assign(new k.a,{name:"ID",string:this.id.toString()})])));super.mQa(H)}}Object(D.a)(J,"InconsistencySuggestion",v,[]);class K extends v{constructor(H,P=null,N,M=!1,I){super(H,4,P,N,M);this.xun=I}mQa(H){this.mxo=H;super.mQa(H)}}Object(D.a)(K,"DesignerPasteSuggestion",v,[])},1509:function(D,L,c){c.d(L,"a",function(){return l});
const l={sCh:"CommentDeepLinkNavigationFailed",qDd:"CommentDataLoss",T1b:"CommentExperienceDegraded",ihf:"CommentsFeatureUsage",z6e:"CommentThreadInProgress",FDd:"CommentReplyInProgress",vCh:"CommentEditInProgress",rDd:"CommentDeepLink",qCh:"CommentCommit",U1b:"CommentLoad",KCh:"CommentInitialization"}},1510:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.aq="SpellingErrorV2";l.zcg="SpellingErrorV2Themed";l.GZk="ContextualSpellingAndGrammarErrorV2";l.U7e="ContextualSpellingAndGrammarErrorV2Themed";
l.Lyd="AdvancedProofingIssueV2Themed";l.G0i="AdvancedProofingIssueV2Themed";l.similarityReviewed="SimilarityReviewed";l.Qmj="SimilarityReviewedThemed";l.similarityUnreviewed="SimilarityUnreviewed";l.Rmj="SimilarityUnreviewedThemed";l.ajc="SpellingErrorHighlight";l.U7b="GrammarErrorHighlight";l.Qcb="CritiqueIndicatorHighlight";l.F0i="ReactiveRewriteIndicatorHighlight";l.iro="SimilarityHighlight";l.jro="SimilarityReviewedHighlight";l.bAd="IdeasSuggestionConfirmation";Object(D.a)(l,"CanvasContextualCssClasses",
null,[])},1511:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x=!1,y=!1,m=!1,u=!1,z=null){this.rl=e;this.source=a;this.XPa=k;this.wea=x;this.Vic=y;this.qgf=m;this.wNa=u;this.Fo=z}}Object(D.a)(l,"ContextualIntentInvocationParameters",null,[])},1512:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y=null,m=null,u=null,z=0,v=0){this.R3=this.bkc=this.gGa=this.YQ=null;this.lH=z;this.xae=e;this.hRa=a;this.C6a=k;x&&(this.YQ=x);null!=y&&
(this.gGa=y);null!=m&&(this.bkc=m);u&&(this.R3=u);this.shapeId=v}}Object(D.a)(l,"AnchorData",null,[])},1514:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.completion=new Promise((e,a)=>{this.resolve=e;this.reject=a})}}Object(D.a)(l,"ControlledPromise",null,[])},1517:function(D,L,c){c.d(L,"a",function(){return v});D=c(0);var l=c(16),e=c(133),a=c(11),k=c(558),x=c(47),y=c(19),m=c(24),u=c(249),z=c(10);class v{constructor(E,F,J,K,H){this.WEb=E;this.V0a=F;this.mub=J;this.Vja=
K;this.Jd=H;this.h1g=0;this.l$a=null;this.ybk=!1;this.P0g=!0;this.IWg=null;this.VXc=this.tmd=!0;this.YXg=!1;this.hxc=E?E.innerText:z.ParagraphReader.text(F)}get vC(){throw Error.notImplemented("The inherit class should have the default value.");}set vC(E){}get LHb(){return this.h1g}iij(E){this.h1g=E}get lb(){return this.l$a}set lb(E){this.l$a=E}get kG(){return this.mub}get I_(){return this.Vja}get Rsi(){return this.YXg}get Jyi(){return!1}get axa(){return this.hxc}get dno(){return!0}invoke(){this.YXg=
!0;if(this.WEb&&this.WEb.parentNode&&!this.vC){var E=this.WEb.innerText;if(this.VXc&&l.a.substring(this.hxc,this.mub,this.Vja)!==l.a.substring(E,this.mub,this.Vja))return 0;this.gBb(this.WEb);this.iij(this.WEb.innerText.length-E.length);return 1}this.tmd||e.a.instance.Zb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.P0g)return e.a.instance.Zb("AbortedAction",{["Reason"]:this.IWg}),0;var F=z.ParagraphReader.text(this.V0a);E=F.length;var J=this.hxc.length,K=l.a.substring(this.hxc,
this.mub,this.Vja).trimEnd();F=l.a.substring(F,this.mub,this.Vja).trimEnd();this.dno&&K===F&&this.Vja>J&&(this.Vja=J);if(this.VXc&&K!==F)if(J=K.replace(RegExp('"',"g"),""),J===l.a.substr(F,0,J.length))this.Vja-=2;else return 0;if(a.App.xd.Yp&&k.CoauthLockEditor.getInstance().V5a(v.Zf.d6b(this.V0a)))return 0;J=new x.GraphTransaction(15);J.Eb(this.V0a);J.kk=this.commandId;this.$la(this.V0a);this.iij(z.ParagraphReader.textLength(this.V0a)-E);this.l$a&&!this.ybk&&y.SelectionEditor.hm(this.l$a)&&(F=this.l$a.Qa,
E=F.cpBegin,K=F.cpEnd,F=F.node,F===this.V0a&&this.LHb&&(E>=this.Vja&&(E+=this.LHb),K>=this.Vja&&(K+=this.LHb),this.l$a=m.SelectionFactory.nK(F,E,K)));J.dispose();return 2}FCj(){this.tmd=this.xzh()}gBb(){}xzh(){var E=z.ParagraphReader.text(this.V0a);const F=l.a.substring(this.hxc,this.mub,this.Vja).trimEnd();E=l.a.substring(E,this.mub,this.Vja).trimEnd();return F===E}static get Zf(){return u.a.instance}}Object(D.a)(v,"AAutoCorrectAction",null,[445])},1518:function(D,L,c){c.d(L,"a",function(){return a});
D=c(0);var l=c(31),e=c(8);class a{constructor(k){this.rl=k}static create(k){if(!k)return e.ULS.shipAssertTag(575930373,3016,!1),null;k=l.a.create(k);return new a(k)}}Object(D.a)(a,"ShowReviewArgs",null,[])},1519:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.data=this.landingTab=null}}Object(D.a)(l,"LaunchData",null,[])},1523:function(D,L,c){c.d(L,"c",function(){return a});c.d(L,"a",function(){return k});c.d(L,"b",function(){return x});D=c(0);var l=c(1506);class e{constructor(y,
m,u){this.suggestion=y;this.wq=m;this.paragraphNode=u}get role(){switch(this.wq){case 1:case 3:return 27;case 2:return 28;default:return 1}}}Object(D.a)(e,"AddEnhancementActionData",null,[]);class a extends e{constructor(y,m,u,z,v,E=1){super(y,E,m);this.B4a=u;this.S0c=z;this.callback=v}}Object(D.a)(a,"AddPullQuoteActionData",e,[]);class k extends e{constructor(y,m,u=0){super(y,2,m);this.nna=u}}Object(D.a)(k,"AddCoverPhotoActionData",e,[]);class x{constructor(y,m,u,z,v){this.suggestion=y;this.Qq=m;
this.n9b=u;this.GRc=z;this.Fzd=v}get annotationType(){switch(this.suggestion.wq){case 1:case 3:return l.a.gZf;case 2:return l.a.Ldg;default:return l.a.nLh}}get uQa(){return this.Qq&&1<=this.Qq.length?this.Qq[0]:null}}Object(D.a)(x,"AddDesignerSuggestionActionData",null,[])},1528:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"OAuthResult",null,[])},1529:function(D,L,c){c.r(L);c.d(L,"FindManagerHelper",function(){return y});D=c(0);var l=c(8),e=c(117),a=c(11),k=c(169),
x=c(1038);c=c(1803);class y extends c.a{constructor(){super()}get Wc(){return a.App.ya.jb.Wc}get Hi(){return a.App.ya.jb.Wc.ud}get Lna(){return a.App.ya.jb.Lna()}get Jzf(){return a.App.ya.jb.xc.Yi}yXe(m){a.App.jk.Kl.pMa(m)}g3d(m,u,z){return x.b(m,u,z)}Bhg(m,u,z){if(1===z){if(!y.eh.Chg(m))return!1}else if(!(m.Xe===u||m.Ab(u)&&m.fd(u)))return!1;return Object(e.a)(67,m.currentNode)||this.g3d(m,u,z)?!0:!1}eva(m){return this.Hi.Db(m).eva()}mwi(m,u,z,v){if(!m||m.matchCase!==z.matchCase||m.matchWholeWord!==
z.matchWholeWord||v.length!==u.length)return!0;for(m=0;m<v.length;m++){if(v[m]!==u[m])return!0;if(z.matchCase){if(v[m]!==u[m])return!0}else if(v[m].toLocaleLowerCase()!==u[m].toLocaleLowerCase())return!0}return!1}wwi(m,u,z,v){if(!m||m.matchWholeWord&&!z.matchWholeWord||m.matchCase&&!z.matchCase||v.length!==u.length)return!1;if(m.matchWholeWord)return m.matchCase?u[0]===v[0]:v[0].toLocaleLowerCase()===u[0].toLocaleLowerCase();for(let E=0;E<v.length;E++)if(m.matchCase){if(!v[E].startsWith(u[E]))return!1}else if(!v[E].toLocaleLowerCase().startsWith(u[E].toLocaleLowerCase()))return!1;
m.matchCase===z.matchCase&&m.matchWholeWord===z.matchWholeWord&&1===u.length&&l.ULS.sendTraceTag(4069025,313,50,"{0}",{["IncrementalSearchTriggeredQueryLength"]:z.text.length});return!0}Tae(m,u,z){const v=a.App.jk.Kl.af(12);v.Ro(m);v.ku(u);v.Lv(z)}static get eh(){return k.PageNavigator.instance}static get instance(){y.ksb||(y.ksb=new y);return y.ksb}}y.ksb=null;Object(D.a)(y,"FindManagerHelper",c.a,[])},1530:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(2);class e{constructor(){this.currentDocumentPath=
l.AFrameworkApplication.K.kb("EditDocInClientUrl")}}Object(D.a)(e,"SmartLookupApplicationInterface",null,[])},1531:function(D,L,c){c.d(L,"a",function(){return N});D=c(0);var l=c(731),e=c(5),a=c(1752),k=c(1795),x=c(1796),y=c(202),m=c(10),u=c(47),z=c(142),v=c(169),E=c(564),F=c(6),J=c(602),K=c(91),H=c(167),P=c(557);class N{constructor(M,I,T,U,W){N.JWd=!1;this.nF=M;this.SKe=I;this.RKe=T;this.Xc=U;this.dYj=W}wbo(M,I){this.nF.Ena(M)&&M.properties.setValue(F.a.uma,I)}I4b(){if(!N.JWd){var M=this.Z9h();for(var I=
M.Tb(7);I;I=M.Ti(7))for(I=M.Tb(8);I;I=M.Ti(8));N.JWd=!0}}Z9h(){const M=this.Xc.Ck();M.set(this.dYj());N.eh.TQ(M);return M}Hu(){const M=this.Z9h();this.RKe.h3d(M);this.kXn(M.currentNode);N.JWd=!1}sBn(M){this.I4b();if(M.isConnected){var I=this.L7(M);if(I=this.nF.VNd(M,I)){var T=this.Xc.Ck();T.set(I);T.Ab(25);M.anchor&&(T.set(M),T.Ab(37),T.Dg())}}}Onl(M,I){if(M.Ab(25)&&M.fd(25)&&!M.Xr(7)){const T=e.GraphIterator.$a(I);T.Ab(37);T.fd(37);I=J.a(T.currentNode,I.Ei().Mc,!0);M.Qf(I,7)}}fql(M,I,T,U){M=new a.a(e.GraphIterator.$a(M),
e.GraphIterator.$a(I),{});M.BNb=!0;T=new l.a(T,U,new k.a(M,null));T.Hg=!0;T.ul("ExecuteInternalFootnoteEndnoteCopy");T.run()}u8e(M,I){I=I.Kb.paragraph;var T=I.Ei().ud;T=J.a(M,T,!0);I=e.GraphIterator.$a(I);this.Onl(I,M);I.Tb(7);I.Qf(T,8);return T}x0c(M,I,T,U){this.I4b();const W=this.L7(M);if(!this.nF.VNd(this.nF.j$h(M),W))return null;I=this.u8e(M,I);this.fql(M,I,T,U);return I}C0c(M,I,T,U){this.I4b();var W=I.Kb.paragraph;const V=W.Ei().ud;W=e.GraphIterator.$a(W);W.Ab(7);W.fd(7);this.e3d(W,I.L7());I=
J.a(M,V,!0);W.Qf(I,8);this.gql(M,I,T,U);return I}gql(M,I,T,U){M=new x.a(e.GraphIterator.$a(M),e.GraphIterator.$a(I),null,null);T=new l.a(T,U,M);T.Hg=!0;T.ul("ExecuteInternalFootnoteEndnotePaste");T.run()}e3d(M,I){M.Tb(7);this.nF.eti(M,I)||M.wf(7)}i7h(M,I){const T=this.Xc.Ck();T.set(I);T.Ab(7);T.fd(7);this.e3d(T,M);return T}N8h(M,I,T){return this.W8h(M,I,T,!1)}o1l(M,I,T){return this.W8h(M,I,T,!0)}W8h(M,I,T,U){var W=this.Xc.Ck();let V=null,Y=!1;W.set(M);W.Yo();W.fd(8);W.Sd();for(W=y.a.at(W,W.O$c(8));W.moveNext();){if(m.ParagraphReader.Yb(W.currentNode)){const ba=
W.currentNode;var da=K.i(ba,7);for(const ja of da){if(ba===M){da=ja.Kb.cp;if(U&&da>=I)return V;da>=I&&-1!==I&&(Y=!0)}if(ja.L7()===T){if(!U&&Y)return ja;V=ja}}ba===M&&(Y=!0)}if(U&&Y)return V}return null}kXn(M){const I=new u.GraphTransaction(3);I.Eb(M);M=y.a.So(N.eh.Ms(M));let T=1,U=1;for(;M.moveNext();){var W=M.currentNode;if(W&&m.ParagraphReader.Yb(W)){W=K.i(W,7);for(const V of W){W=V.l3();const Y=V.L7()?T++:U++;this.wbo(W,Y)}}}I.dispose()}L7(M){return this.nF.Ena(M)?M.properties.getValue(F.a.C7):
0}static bQl(){return new N(P.a.instance,z.PageReader.instance,v.PageNavigator.instance,new E.a,N.qDl)}static qDl(){return H.App.Hn.jb.Wc}static get eh(){return v.PageNavigator.instance}static get instance(){return null!=N.oyg?N.oyg:N.oyg=N.bQl()}}N.JWd=!1;Object(D.a)(N,"FootnoteEndnoteEditorInteractive",null,[494])},1536:function(D,L,c){D=c(0);class l{static yXl(){return l._nextEventReceiverId++}}l._nextEventReceiverId=0;Object(D.a)(l,"EventReceiverIdCounter",null,[]);c.d(L,"a",function(){return e});
class e{constructor(a,k){this.BTb=a;this._id=l.yXl();this.wak=k}get id(){return this._id}notify(a,k){this.wak(a,k)}Vj(a,k){return this.BTb.tEn(a,k?this:null)}}Object(D.a)(e,"EventReceiver",null,[412])},1539:function(D,L,c){c.d(L,"a",function(){return J});D=c(0);var l=c(8),e=c(11),a=c(558),k=c(40),x=c(60),y=c(1996),m=c(2),u=c(1497),z=c(1509),v=c(123),E=c(609),F=c(1488);class J{static j_m(){const K=document.getElementsByClassName(E.a.iUf);if(K&&K.length){var H=K[0].clientWidth;for(let P=1;P<K.length;P++){if(K[P].clientWidth!==
H||P===K.length-1){l.ULS.sendTraceTag(540160401,327,50,"{0}:NoOfContainers={1}",K[P].clientWidth-H,K.length);break}H=K[P].clientWidth}}}static Hog(K,H,P){K&&(K=e.App.xd.Vq.opf(K),a.CoauthLockEditor.getInstance().V5a(K)&&l.ULS.sendTraceTag(540160402,327,15,`Comment with ObjectId: ${H.objectId} added to a locked ${P?"start":"end"} paragraph. Lock Type ${K.Type.toString()}`))}static nVo(K,H,P){var N=H.Db(x.a.Gf(K.objectId));if(N){var M=u.a.Iaa(N,H,!0);H=u.a.Iaa(N,H,!1);null!==M&&void 0!==M&&M.Pu||(M=
F.k(N),l.ULS.sendTraceTag(540160404,327,15,`CommentRangeStart failed to save. startParaId: ${M}, CommentObjectId: ${K.objectId}`),J.XCi(P));null!==H&&void 0!==H&&H.Pu||(N=F.h(N),l.ULS.sendTraceTag(540160405,327,15,`CommentRangeEnd failed to save. endParaId: ${N}, CommentObjectId: ${K.objectId}`),J.XCi(P))}else l.ULS.sendTraceTag(540160403,327,15,`Commited Comment missing CommentNode graph object ObjectId: ${K.objectId}`)}static XCi(K){K.logKpiFailure(z.a.qCh,"CommentReferenceFailedToSave",{isIntentional:!1,
isInternal:!0},{name:z.a.qDd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1})}static pZm(K,H,P){0!==K.size&&K.forEach(N=>{H.has(N)||J.uZm(N,P)})}static uZm(K,H){H.Db(x.a.Gf(K))&&l.ULS.sendTraceTag(539800642,327,15,`comment start missing for ${K}`)}static POk(K){const H=new Set;K.forEach(P=>{P&&P.Wi&&((P=J.P9h(P))?H.add(P):l.ULS.sendTraceTag(539554689,327,15,"Outline Node is undefined"))});H.forEach(P=>{const N=P.ia(v.a.D6e,[]);0===P.ia(v.a.B6e,[]).length&&0===N.length&&l.ULS.sendTraceTag(539800644,
327,15,`Outline Element Node ${P.id.toString()} is missing comment info while paragraph has comments. This will cause some comments to fail to load.`)})}static EMm(K,H,P,N){K=P.o2h(K);if(!K)return!1;P=F.k(K,x.a.nil);N=N.Db(P);H.has(P.toString())&&l.ULS.sendTraceTag(539800643,327,15,`Para Node ${P} missing comment reference for comment ${K.id}`);return N&&N.Wi?!0:(l.ULS.sendTraceTag(539567714,327,15,`Para Node ${P} with missing comment reference for comment ${K.id} is in a invalid state ${N?"paraNode containingGraph is null":
"paraNode is null"}`),!1)}static P9h(K){let H;try{H=k.OutlineElementNavigator.El(K)}catch(P){l.ULS.sendTraceTag(539567715,327,10,`ParaNode ${K.id} OutlineNode failed to retrieve ${P}`)}return H}static kNl(K){var H;switch(null===(H=K.Ty)||void 0===H?void 0:H.sessionType){case y.a.create:return z.a.z6e;case y.a.reply:return z.a.FDd;case y.a.edit:return z.a.vCh}}static ozh(K){if(m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForDuplicateReactionUsers",!0)&&(K=K[1])&&
0!==K.length){var H=new Set;for(let P=0;P<K.length;P++)H.add(K[P].UserId);K.length>H.size&&l.ULS.sendTraceTag(521458447,327,15,`Reaction UserList has duplicates: ${K.length-H.size}`)}}}Object(D.a)(J,"CommentDiagnosticHelpers",null,[])},1540:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.open="open";l.refresh="refresh";l.S5f="saveAs";l.translate="translate";l.modeSwitch="modeSwitch";l.M9e="createNew";Object(D.a)(l,"ReasonList",null,[])},1541:function(D,L,c){c.d(L,"a",function(){return l});
D=c(0);class l{static z9c(e){if(!e)return"{NULL}";const a=e.length;if(600>=a)return e;const k=a-195;return e.substring(0,400)+"[...]"+e.substring(k,a)}}Object(D.a)(l,"LogUtils",null,[])},1542:function(D,L,c){c.d(L,"b",function(){return l});c.d(L,"a",function(){return e});c.d(L,"c",function(){return a});const l=(k,x,y,m,u,z,v,E)=>{var F=1;if(!k&&!x||!y||!m)return F;u&&z?(z=y+k,F=m+x,k=1/y,x=1/m,u=k>x?k:x,1>z?z=1:1920<z&&(z=1920),1>F?F=1:1280<F&&(F=1280),k=z-y,x=F-m,E?(y=z/y,m=F/m,F=Math.abs(y-v)<Math.abs(m-
v)?y:m):F=Math.abs(k/y)>Math.abs(x/m)?z/y:F/m,F<u&&(F=u)):u?(v=y+k,1>v?v=1:1920<v&&(v=1920),F=v/y):z&&(v=m+x,1>v?v=1:1280<v&&(v=1280),F=v/m);return F},e=(k,x)=>{k=Math.atan2(x.y-k.y,x.x-k.x);0>k&&(k+=2*Math.PI);return k},a=k=>{k%=360;0>k&&(k+=360);return k}},1543:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"SmartLookupSelection",null,[])},1545:function(D,L,c){c.d(L,"a",function(){return P});D=c(0);var l=c(21),e=c(895),a=c(564),k=c(37),x=c(169),y=c(6),m=c(43),u=c(17),
z=c(8),v=c(117),E=c(82),F=c(46),J=c(507),K=c(165),H=c(1039);class P{constructor(N,M,I,T,U,W){this.Khk=N;this.ve=M;this.Htf=I;this.WKa=T;this.bAe=U;this.aAe=W}get tk(){return null!=this.YDg?this.YDg:this.YDg=l.a.instance.resolve("WordEditor.ITableEditor")}get Kd(){return null!=this.aFg?this.aFg:this.aFg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=this.HEg?this.HEg:this.HEg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get dQb(){return this.Khk.value}get Bad(){return this.ve.value}ORk(N){const M=
this.dQb.B7b(N,e.a.Q3d);M&&(this.S5a(M,N),this.bya(1696,N))}S5a(N,M,I=!0){const T=this.dQb.dhb(M);if(T&&(N=this.Bad.jg(N),T.Ni(N))){const U=this.dQb.DT(M);let W="Unknown";this.dQb.Ika.value&&(W=this.dQb.Ika.value.ob(N)?N:"CustomStyle");z.ULS.sendTraceTag(0,311,50,"{0}",{["ApplyTableStyleId"]:W,["RowCount"]:this.bAe(M),["ColumnCount"]:this.aAe(M),["HR"]:!!(U&32),["FC"]:!!(U&128),["TR"]:!!(U&64),["LC"]:!!(U&256),["BR"]:!(U&512),["BC"]:!(U&1024),["TableId"]:M.id.toString()});I&&this.iia(M);this.Ljg(M,
T);I=T.Ni(N);M.properties.setValue(y.a.tableStyle,I.id);this.p5e(M);M.$S.X7(!0)}}U5c(N,M,I){if(N=this.dQb.B7b(I,N))this.bya(M,I),this.S5a(N,I)}bya(N,M,I=!0){I&&this.iia(M);M.properties.setValue(y.a.tableLook,N);z.ULS.sendTraceTag(0,311,50,"{0}",{["HR"]:!!(N&32),["FC"]:!!(N&128),["TR"]:!!(N&64),["LC"]:!!(N&256),["BR"]:!(N&512),["BC"]:!(N&1024),["TableId"]:M.id.toString()});M.$S.X7(!0)}Ljg(N,M){(N=this.WKa(N))&&M.Vhc(N)}p5e(N){if(N.isConnected){N.hasProperty(m.a.fw)&&N.removeProperty(m.a.fw);this.A2f(N);
this.M2c(N);N=this.Htf.Wf(N);for(var M=N.Tb(1);M;){for(M=N.Tb(1);M;)M.hasProperty(u.a.eH)&&M.removeProperty(u.a.eH),M.hasProperty(y.a.aqa)&&M.removeProperty(y.a.aqa),this.PRa(M),this.M2c(M),M=N.Ti(1);M=N.Ti(1)}}}G7b(N){let M=N.ia(m.a.jGa,null);if(M)return M;if(N=this.Bad.jg(N))if(M=({value:M}=this.dQb.Ika.value.Ec(N,M)).returnValue?M:null)return M;return N}Odj(N,M,I,T,U){N.properties.setValue(M.style,I);N.properties.setValue(M.size,T*K.a.B0b);N.properties.setValue(M.color,U)}iia(N){if(this.Kd.Cg){var M;
Object(v.a)(J.a,N)&&(M=Object(E.a)(J.a,N))&&(M=M.eR())&&this.lj.iia(N,M)}}A2f(N){N.Qg(y.a.Wa,y.a.Xa,y.a.$pa,y.a.pb,y.a.qb,y.a.Ypa,y.a.Ua,y.a.Va,y.a.Xpa,y.a.rb,y.a.tb,y.a.Zpa,y.a.ub,y.a.vb,y.a.lya,y.a.Mb,y.a.Nb,y.a.mya)}PRa(N){N.Qg.apply(N,this.tk.b4e)}M2c(N){N.Qg(y.a.Ca,y.a.za,y.a.Aa,y.a.Ba,y.a.TO,y.a.qR,y.a.DHa,y.a.BHa)}static msf(){return new P(l.a.instance.We("WordEditor.IWACTableStyleReader"),l.a.instance.We("Box4.Styles.IWACStyleReader"),new a.a,Object(F.a)(P.eh,P.eh.Ms,"navigateToPageContentNode"),
k.TableReader.ag,k.TableReader.Xg,H.a.instance)}static get eh(){return x.PageNavigator.instance}static get instance(){return null!=P.mzg?P.mzg:P.mzg=P.msf()}}Object(D.a)(P,"WACTableStyleEditor",null,[172,173])},1546:function(D,L,c){c.d(L,"a",function(){return P});D=c(0);var l=c(106),e=c(2),a=c(566),k=c(254),x=c(361),y=c(1510),m=c(780),u=c(321),z=c(555),v=c(860);c.n(v);var E=c(485),F=c(1388),J=c(1641),K=c(94),H;(function(N){N[N.Spelling=0]="Spelling";N[N.Grammar=1]="Grammar";N[N.Style=2]="Style";N[N.Lmc=
3]="Similarity";N[N.fng=4]="ContextIQ";N[N.ZFj=5]="AutoReplace"})(H||(H={}));Object(D.b)("AnnotationRenderCategory",H);class P{static $Kl(N){switch(P.dQd(N)){case H.Spelling:N=y.a.zcg;break;case H.Grammar:N=y.a.U7e;break;case H.Lmc:N=60!==N.M_.state&&70!==N.M_.state?y.a.Rmj:y.a.Qmj;break;case H.fng:if(J.a.hng()&&J.a.wxi(N))return;N=y.a.Lyd;break;case H.ZFj:N=y.a.bAd;break;default:N=y.a.Lyd}return N}static q$l(N){switch(P.dQd(N)){case H.Spelling:return u.f.SpellingSquiggle;case H.Grammar:return u.f.GrammarSquiggle;
default:return u.f.CritiqueSquiggle}}static dQd(N){let M;if(P.zUc(N))switch(N.priority){case 0:M=H.Spelling;break;case 1:M=H.Grammar;break;default:M=H.Style}else P.uac(N)?M=H.Lmc:P.ESc(N)&&(M=H.fng);return M}static zUc(N){N=k.a.getTypeNameFor(N);return N===x.a.getTypeName()||N===m.a.getTypeName()}static ESc(N){return k.a.getTypeNameFor(N)===v.FlagAnnotation.getTypeName()}static uac(N){return k.a.getTypeNameFor(N)===a.a.getTypeName()}static QYd(N){return P.zUc(N)?0===N.priority:!1}static dXd(N){return P.zUc(N)?
1===N.priority:!1}static Vwm(N){return k.a.getTypeNameFor(N)===m.a.getTypeName()}static lzf(N){return null!=N&&"Spelling"===N.categoryName&&1===N.suggestions.length&&4===(N.suggestions[0].suggestionActions&4)}static j7l(N,M){const I=[u.b.IgnoreOnce];switch(N){case 0:I.push(u.b.IgnoreAll);M&&I.push(u.b.AddToDictionary);break;case 1:I.push(u.b.Options)}return I}static l1h(N){return P.zUc(N)?N.categoryName:P.uac(N)?P.Pmj:P.ESc(N)?P.Lxl:null}static Frf(N,M){let I=z.a.dic;switch(N){case 0:I=M?z.a.Ofe:
z.a.cjj;break;case 1:I=z.a.bjj}return I}static Q5b(N,M=!1,I){I="IntentProvider_Suggestion_"+I;let T=l.a.Db(N,I);M&&!T&&l.a.jl(N,I,T=new E.a);return T}static fuf(N,M,I,T,U,W,V,Y,da=!1,ba){T&&I&&(!(I=W.u_h(I,U))||!e.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")&&e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)&&this.dQd(I)==H.Style||(V.YId(N,M,Y),P.Q5b(N,!0,ba).add(I.id),M=P.$Kl(I),N.classList.add(M),P.J$c&&P.Kjk(N,I),da&&F.a.IWc()))}static get J$c(){return null!=
P.BFg?P.BFg:P.BFg=e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}static Kjk(N,M){P.QYd(M)?N.aAk="spelling":P.dXd(M)&&(N.aAk="grammar")}static xPa(N,M,I){N=(N=P.Q5b(N,!1,I))?K.firstOrDefault(N):null;return{returnValue:!!N,type:N?I:null,data:N}}}P.Pmj="Similarity";P.Lxl="FlagAnnotation";Object(D.a)(P,"AnnotationHelper",null,[])},1558:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(169),e=c(234);class a{G3a(k){a.eh.TQ(k);
return k.Tb(16)}static zr(){return new e.a(()=>new a)}static get instance(){return a._instance.value}static get eh(){return l.PageNavigator.instance}}a._instance=a.zr();Object(D.a)(a,"CommentNavigator",null,[278])},1560:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l extends Sys.EventArgs{constructor(){super();this.WNi=this.JFa=null}}Object(D.a)(l,"OnCommentInitArgs",Sys.EventArgs,[])},1561:function(D,L,c){c.d(L,"a",function(){return y});D=c(0);var l=c(49),e=c(108),a=c(8),k=c(96),x=
c(64);class y{constructor(m,u,z){a.ULS.shipAssertTag(6305502,307,!!m);this.properties=m;this.Jc=u;this.zS=z}C$h(){return this.properties.ia(e.a.EO,"")}sXi(){return!0}Jvj(){let m=!1,u=null;const z=this.C$h();if(this.zS||""!==z)try{({uua:u,returnValue:m}=this.Zkc(z))}catch(v){a.ULS.shipAssertTag(4203138,307,!1),this.Jc.Zb(k.a.oma,{["Reason"]:x.a.o2e}),l.a.FZ(u)}else a.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Jc.Zb(k.a.J0,{["Reason"]:x.a.Kgf});return{returnValue:m,qEd:u}}}Object(D.a)(y,
"AStringInputImportStrategy",null,[620])},1562:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.H9=[]}U2h(){const e=new l;for(let a=0;a<this.H9.length;a++)e.add(this.J(a));return e}get count(){return this.H9.length}J(e){return this.H9[e]}Z(e,a){return this.H9[e]=a}add(e){this.H9.push(e)}clear(){Array.clear(this.H9)}contains(e){return Array.contains(this.H9,e)}getRange(e,a){const k=new l;for(let x=0;x<a;x++)k.add(this.J(e+x));return k}indexOf(e){return Array.indexOf(this.H9,
e)}insert(e,a){Array.insert(this.H9,e,a)}remove(e){return Array.remove(this.H9,e)}removeAt(e){Array.removeAt(this.H9,e)}removeRange(e,a){for(let k=0;k<a;k++)Array.removeAt(this.H9,e)}reverse(){this.H9.reverse()}sort(){this.H9.sort()}toArray(){return Array.clone(this.H9)}}Object(D.a)(l,"List",null,[])},1564:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e){this.id=e}}Object(D.a)(l,"DesignerPaneToggleData",null,[])},1566:function(D,L,c){c.d(L,"a",function(){return x});D=
c(0);var l=c(1838),e=c(564),a=c(6),k=c(1038);class x{constructor(y){this.POl=(m,u)=>{const z=this.xbi(m),v=this.Xc.Wf(u);return v.Ab(z)?(v.fd(z),new l.a(v.currentNode,u,m)):null};this.OOl=(m,u)=>{let z=null,v=null;const E=this.xbi(m);u=this.Xc.Wf(u);({rootNode:z,ria:v}=this.ofo(u,m,E,z,v));return z&&v?new l.a(z,v,m):null};this.TOl=m=>{m=this.Xc.Wf(m);return(this.q8(2)||this.q8(4))&&m.Ab(36)?(m.fd(36),this.Uvl(m.currentNode)):(this.q8(8)||this.q8(16))&&m.Ab(37)?(m.fd(37),this.wWh(m.currentNode)):this.q8(32)&&
m.Ab(40)?32:this.q8(1)&&m.Ab(8)?1:0};this.Xc=y;this.Vvl=this.TOl;this.Gvl=this.POl;this.Fvl=this.OOl;this.kwl=31;this.Qdg=this.XOl()}L4h(y){const m=[],u=this.Vvl(y);if(u){var z=this.Gvl(u,y);z&&(m[m.length]=z)}for(const v of this.Qdg)v!==u&&v&&(z=this.Fvl(v,y))&&(m[m.length]=z);return m}q8(y){return!!y&&!!(this.kwl&y)}ofo(y,m,u,z,v){if(y.Ab(7)){y.fd(7);if(8===u||37===u||39===u)for(var E=y.Sd();E;){if(E.type===u)if(37===u){if((8===m||16===m)&&m===this.wWh(E)){z=y.currentNode;break}}else{z=y.currentNode;
break}E=y.Wj()}z&&y.dA()&&(E=this.Xc.Wf(z),k.b(E,u,m)&&(v=y.currentNode))}return{rootNode:z,ria:v}}XOl(){const y=[];this.q8(1)&&(y[y.length]=1);this.q8(2)&&(y[y.length]=2);this.q8(4)&&(y[y.length]=4);this.q8(8)&&(y[y.length]=8);this.q8(16)&&(y[y.length]=16);this.q8(32)&&(y[y.length]=32);return y}xbi(y){let m=8;switch(y){case 1:case 2:case 4:m=8;break;case 8:case 16:m=37;break;case 32:m=39}return m}wWh(y){y=y.properties.getValue(a.a.C7);return this.q8(8)&&1===y?8:this.q8(16)&&!y?16:0}Uvl(y){y=y.getValue(a.a.l8b);
return this.q8(2)&&x.sDm(y)?2:this.q8(4)&&x.QCm(y)?4:0}static vE(){return new x(new e.a)}static get instance(){return null!=x.uyg?x.uyg:x.uyg=x.vE()}static sDm(y){return y&&1!==y&&2!==y?!1:!0}static QCm(y){return 3===y||4===y||5===y?!0:!1}}Object(D.a)(x,"WordFindContextHelper",null,[168])},1573:function(D,L,c){var l=this&&this.RD||(Object.create?function(e,a,k,x){void 0===x&&(x=k);var y=Object.getOwnPropertyDescriptor(a,k);if(!y||("get"in y?!a.xy:y.writable||y.configurable))y={enumerable:!0,get:function(){return a[k]}};
Object.defineProperty(e,x,y)}:function(e,a,k,x){void 0===x&&(x=k);e[x]=a[k]});D=this&&this.__exportStar||function(e,a){for(var k in e)"default"===k||Object.prototype.hasOwnProperty.call(a,k)||l(a,e,k)};Object.defineProperty(L,"__esModule",{value:!0});D(c(1897),L);D(c(1898),L);D(c(1899),L);D(c(1900),L);D(c(1901),L)},1581:function(D,L,c){var l=c(1512);D=c(0);class e{}Object(D.a)(e,"SerializableAnchorDataV1",null,[]);class a{}Object(D.a)(a,"SerializableCpDataV1",null,[]);var k=c(982);c.d(L,"a",function(){return x});
c.d(L,"c",function(){return y});c.d(L,"b",function(){return m});c.d(L,"d",function(){return u});const x=z=>new l.a(z.RK,z.PS,z.TS,c(1612).versionedDeserialize(z.OS),z.PE,z.TE,c(1612).versionedDeserialize(z.OE),z.DK,z.SI),y=z=>{const v=new e;v.RK=z.xae;v.PS=z.hRa;v.TS=z.C6a;v.DK=z.lH;v.SI=z.shapeId;z.YQ&&(v.OS=u(z.YQ));z.gGa&&(v.PE=z.gGa);z.bkc&&(v.TE=z.bkc);z.R3&&(v.OE=u(z.R3));return v},m=z=>{if(!z)return null;const v=new k.a(z.CP);v.Mua=null!=z.FB?z.FB:0;v.Afa=null!=z.FE?z.FE:0;v.Fta=null!=z.CB?
z.CB:0;v.Gta=null!=z.CE?z.CE:0;v.YOa=null!=z.HB?z.HB:0;v.gga=null!=z.HE?z.HE:0;v.Nxa=null!=z.R?z.R:0;v.Jua=null!=z.E?z.E:0;v.rya=null!=z.TW?z.TW:0;v.cxa=null!=z.PB?z.PB:0;v.symbols=null!=z.SYM?z.SYM:0;v.Nva=null!=z.IE?z.IE:0;v.Owa=null!=z.OO?z.OO:0;v.Wsa=null!=z.AX?z.AX:0;v.Lta=null!=z.CCI?z.CCI:0;v.dryDeletion=null!=z.DD?z.DD:0;return v},u=z=>{if(!z)return null;const v=new a;v.CP=z.cp;v.VS=1;0<z.Mua&&(v.FB=z.Mua);0<z.Afa&&(v.FE=z.Afa);0<z.Fta&&(v.CB=z.Fta);0<z.Gta&&(v.CE=z.Gta);0<z.YOa&&(v.HB=z.YOa);
0<z.gga&&(v.HE=z.gga);0<z.Nxa&&(v.R=z.Nxa);0<z.Jua&&(v.E=z.Jua);0<z.rya&&(v.TW=z.rya);0<z.cxa&&(v.PB=z.cxa);0<z.symbols&&(v.SYM=z.symbols);0<z.Nva&&(v.IE=z.Nva);0<z.Owa&&(v.OO=z.Owa);0<z.Wsa&&(v.AX=z.Wsa);0<z.Lta&&(v.CCI=z.Lta);0<z.dryDeletion&&(v.DD=z.dryDeletion);return v}},1591:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a="",k="",x=""){this.IsCurrentUser=!1;this.UserId=e;this.Provider=a;this.DisplayName=k;this.Email=x}}Object(D.a)(l,"CommentTaskPerson",null,[936])},
1592:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y=!1){this.priority=this.completion=-1;this.type=e;this.user=a;this.time=k;this.recordId=x;this.isLossy=y}}Object(D.a)(l,"HistoryRecord",null,[])},1593:function(D,L,c){c.d(L,"a",function(){return k});D=c(0);var l=c(439),e=c(433),a=c(637);class k{constructor(){this.sHg=null;this.PX=!1;this.oJb=this.Xdb=null;this.Ax=new l.a(new e.a);this.tU=new l.a(new e.a);this.N_f=this.jFb=!1}get yn(){return a.a.yn}set yn(x){a.a.yn=
x}get Fcb(){return this.sHg}set Fcb(x){this.sHg=x}}k.Cj=1;Object(D.a)(k,"CommentsState",null,[])},1594:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.yellow="FFFF00";l.jRm="00FF00";l.szk="00FFFF";l.fBl="FF00FF";l.blue="0000FF";l.red="FF0000";l.v$m="000080";l.teal="008080";l.green="008000";l.purple="800080";l.R4m="800000";l.odn="808000";l.gray="808080";l.Xro="C0C0C0";l.black="000000";Object(D.a)(l,"FontHighlightColorEnum",null,[])},1595:function(D,L,c){c.d(L,"a",function(){return l});
D=c(0);class l{constructor(){this.V9={};this.V9.ops=[]}lga(e){const a=this.V9.ops;if(a.length){var k=a.length-1;const x=a[k];if(!x.attributes){x.insert+=e;a[k]=x;this.V9.ops=a;return}}k={};k.insert=e;Array.add(a,k)}Rni(e,a){const k={};this.Bgj(k,a);Array.add(this.V9.ops,this.P2b(e,k))}Qxf(e,a,k,x=!1){var y={};y.fullName=a.fullName;y.email=a.email;y.resolveState=a.resolveState;a={};a.atmention=y;e=this.P2b(e,a);k&&(y={},y.contentId=k.contentId,a={},a.atmention=y,x&&(y.isCurrentUser=k.isCurrentUser),
e.optional=a);Array.add(this.V9.ops,e)}insertImage(e,a){e=this.P2b(e,{});const k={};k.base64=a.base64;a={};a.image=k;e.optional=a;Array.add(this.V9.ops,e)}Ani(e,a){const k={};k.link=a.link;this.Bgj(k,a);Array.add(this.V9.ops,this.P2b(e,k))}IMc(){return Sys.Serialization.JavaScriptSerializer.serialize(this.V9)}P2b(e,a){const k={};k.insert=e;k.attributes=a;return k}Bgj(e,a){this.TMb(a.weight>=l.DKf,e,"weight",a.weight);this.TMb(a.italic,e,"italic",!0);this.TMb(a.underline,e,"underline",!0);this.TMb(a.strikethrough,
e,"strikethrough",!0);this.TMb(!!a.highlight,e,"highlight",a.highlight);this.TMb(!!a.color,e,"color",a.color);this.TMb(!!a.paragraph,e,"paragraph",a.paragraph)}TMb(e,a,k,x){e&&(a[k]=x)}static aDb(e){return Sys.Serialization.JavaScriptSerializer.deserialize(e,!0)}}l.DKf=700;Object(D.a)(l,"DeltaFormatCreator",null,[891])},1596:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(529),e=c(433);class a{constructor(k=!1){this.uM=null;this.e1a=!1;k&&(this.uM=new l.a(new e.a))}}Object(D.a)(a,"OpenCommentInfo",
null,[])},1597:function(D,L,c){c.d(L,"b",function(){return u});c.d(L,"a",function(){return z});c.d(L,"c",function(){return v});c.d(L,"d",function(){return E});c.d(L,"e",function(){return F});var l=c(15),e=c(2),a=c(123),k=c(8),x=c(494),y=c(474),m=c(277);const u=()=>l.a.Rt,z=()=>void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1,v=J=>!!J&&J.isConnected,E=(J,K,H,P)=>{if(!K||!K.isConnected)return J.dispose(),!1;const N=K.Ei(),M=K.ia(a.a.eJ,m.a.nt),I={};I[x.a.nodeId]=K.id.toString();I[x.a.cellId]=
N.Zm.toString();I[x.a.fileId]=N.Fs;I[x.a.ota]=N.contentReplicator.kt.toString();I[x.a.xO]=N.contentReplicator.xO;I[x.a.gT]=H.toString();I[x.a.lcid]=e.AFrameworkApplication.lcid.toString();I[x.a.accessToken]=e.AFrameworkApplication.accessToken;I[x.a.classId]=K.Nc.toString();I[x.a.eJ]=M;P=P||{};for(const T of y.a(P))I[T]=P[T];for(const T of y.a(I))J.J2b(T,I[T]);return!0},F=(J,K,H)=>{const P={};P.IsResponseNull=!K;K&&(P.OperationResult=K.StatusCode,P.RevisionListLength=K.RevisionList?K.RevisionList.length.toString():
"null");k.ULS.sendTraceTag(36783366,322,50,"UploadResponseReceived: {0}",P);H&&H.isConnected&&(K&&!K.StatusCode?(H.pH().contentReplicator.DE(null,null,null),J.wSo()):J.MKb(null,K?K.StatusCode:14))}},1598:function(D,L,c){var l=this&&this.RD||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,
x)||l(k,a,x)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1809),L);e(c(1810),L);D.exports.DocumentPullQuoteAnnotation||Object.defineProperty(D.exports,"DocumentPullQuoteAnnotation",{enumerable:!0,get:function(){return D.exports.DocumentPullQuoteAnnotation}});D.exports.PullQuoteAnnotation||Object.defineProperty(D.exports,"PullQuoteAnnotation",{enumerable:!0,get:function(){return D.exports.PullQuoteAnnotation}});D.exports.PullQuotesSignal||Object.defineProperty(D.exports,"PullQuotesSignal",
{enumerable:!0,get:function(){return D.exports.PullQuotesSignal}})},1599:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(D.a)(l,"InsightsParameters",null,[])},1602:function(D,L,c){c.d(L,"a",function(){return M});D=c(0);var l=c(21),e=c(895),a=c(61),k=c(5),x=c(37),y=c(169),m=c(6),u=c(43),z=c(17),v=c(8),E=c(234),F=c(117),J=c(82),K=c(46),H=c(80),P=c(507),N=c(165);class M{constructor(I,T,U,W,V,Y){this.Ku=
I;this.CTg=T;this.afd=U;this.WKa=W;this.bAe=V;this.aAe=Y;this.Ika=new E.a(()=>this.QQd())}get tk(){return null!=this.ZDg?this.ZDg:this.ZDg=l.a.instance.resolve("WordEditor.ITableEditor")}get Kd(){return null!=this.cFg?this.cFg:this.cFg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=this.IEg?this.IEg:this.IEg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get e2e(){return this.Ku.value}S5a(I,T,U=!0){const W=this.e2e.dhb(T);
if(W&&(I=this.CTg(I),W.Ni(I))){const V=this.e2e.DT(T);let Y="Unknown";this.Ika.value&&(Y=this.Ika.value.ob(I)?I:"CustomStyle");v.ULS.sendTraceTag(39661653,311,50,"{0}",{["ApplyTableStyleId"]:Y,["RowCount"]:this.bAe(T),["ColumnCount"]:this.aAe(T),["HR"]:!!(V&32),["FC"]:!!(V&128),["TR"]:!!(V&64),["LC"]:!!(V&256),["BR"]:!(V&512),["BC"]:!(V&1024),["TableId"]:T.id.toString()});U&&this.iia(T);this.Ljg(T,W);U=W.Ni(I);T.properties.setValue(m.a.tableStyle,U.id);this.p5e(T);T.$S.X7(!0)}}U5c(I,T,U){if(I=this.e2e.B7b(U,
I))this.bya(T,U),this.S5a(I,U)}bya(I,T,U=!0){U&&this.iia(T);T.properties.setValue(m.a.tableLook,I);v.ULS.sendTraceTag(39661654,311,50,"{0}",{["HR"]:!!(I&32),["FC"]:!!(I&128),["TR"]:!!(I&64),["LC"]:!!(I&256),["BR"]:!(I&512),["BC"]:!(I&1024),["TableId"]:T.id.toString()});T.$S.X7(!0)}Ljg(I,T){(I=this.WKa(I))&&T.Vhc(I)}p5e(I){if(I.isConnected){I.hasProperty(u.a.fw)&&I.removeProperty(u.a.fw);this.A2f(I);this.M2c(I);I=this.afd(I);for(var T=I.Tb(1);T;){for(T=I.Tb(1);T;)T.hasProperty(z.a.eH)&&T.removeProperty(z.a.eH),
T.hasProperty(m.a.aqa)&&T.removeProperty(m.a.aqa),this.PRa(T),this.M2c(T),T=I.Ti(1);T=I.Ti(1)}}}A2f(I){I.Qg(m.a.Wa,m.a.Xa,m.a.$pa,m.a.pb,m.a.qb,m.a.Ypa,m.a.Ua,m.a.Va,m.a.Xpa,m.a.rb,m.a.tb,m.a.Zpa,m.a.ub,m.a.vb,m.a.lya,m.a.Mb,m.a.Nb,m.a.mya)}PRa(I){I.Qg.apply(I,this.tk.b4e)}M2c(I){I.Qg(m.a.Ca,m.a.za,m.a.Aa,m.a.Ba,m.a.TO,m.a.qR,m.a.DHa,m.a.BHa)}G7b(I){let T=I.ia(u.a.jGa,null);if(T)return T;if(I=this.CTg(I))if(T=({value:T}=this.Ika.value.Ec(I,T)).returnValue?T:null)return T;return I}Odj(I,T,U,W,V){I.properties.setValue(T.style,
U);I.properties.setValue(T.size,W*N.a.B0b);I.properties.setValue(T.color,V)}QQd(){const I=new H.a;I.Z(e.a.n8c,WordEditorIntl.WordEditorStrings.L_TableGrid);I.Z(e.a.B8d,WordEditorIntl.WordEditorStrings.L_PlainTable1);I.Z(e.a.C8d,WordEditorIntl.WordEditorStrings.L_PlainTable2);I.Z(e.a.D8d,WordEditorIntl.WordEditorStrings.L_PlainTable3);I.Z(e.a.E8d,WordEditorIntl.WordEditorStrings.L_PlainTable4);I.Z(e.a.F8d,WordEditorIntl.WordEditorStrings.L_PlainTable5);I.Z(e.a.GSd,WordEditorIntl.WordEditorStrings.L_TableGridLight);
I.Z(e.a.QRd,WordEditorIntl.WordEditorStrings.L_GridTable1Light);I.Z(e.a.KRd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.LRd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.MRd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.NRd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.ORd,
this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.PRd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel10));I.Z(e.a.XRd,WordEditorIntl.WordEditorStrings.L_GridTable2);I.Z(e.a.RRd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.SRd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.TRd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable2,
Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.URd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.VRd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.WRd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel10));I.Z(e.a.dSd,WordEditorIntl.WordEditorStrings.L_GridTable3);I.Z(e.a.YRd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel5));
I.Z(e.a.ZRd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.$Rd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.aSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.bSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.cSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel10));
I.Z(e.a.kSd,WordEditorIntl.WordEditorStrings.L_GridTable4);I.Z(e.a.eSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.fSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.gSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.hSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.iSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable4,
Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.jSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel10));I.Z(e.a.rSd,WordEditorIntl.WordEditorStrings.L_GridTable5Dark);I.Z(e.a.lSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.mSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.nSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel7));
I.Z(e.a.oSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.pSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.qSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel10));I.Z(e.a.ySd,WordEditorIntl.WordEditorStrings.L_GridTable6Colorful);I.Z(e.a.sSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.tSd,
this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.uSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.vSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.wSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.xSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,
Box4Intl.Box4Strings.l_ThemeLabel10));I.Z(e.a.FSd,WordEditorIntl.WordEditorStrings.L_GridTable7Colorful);I.Z(e.a.zSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.ASd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.BSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.CSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,
Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.DSd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.ESd,this.Nd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));I.Z(e.a.J_d,WordEditorIntl.WordEditorStrings.L_ListTable1Light);I.Z(e.a.D_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.E_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,
Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.F_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.G_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.H_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.I_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel10));I.Z(e.a.Q_d,WordEditorIntl.WordEditorStrings.L_ListTable2);
I.Z(e.a.K_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.L_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.M_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.N_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.O_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel9));
I.Z(e.a.P_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel10));I.Z(e.a.X_d,WordEditorIntl.WordEditorStrings.L_ListTable3);I.Z(e.a.R_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.S_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.T_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.U_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable3,
Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.V_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.W_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel10));I.Z(e.a.d0d,WordEditorIntl.WordEditorStrings.L_ListTable4);I.Z(e.a.Y_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.Z_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel6));
I.Z(e.a.$_d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.a0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.b0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.c0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel10));I.Z(e.a.k0d,WordEditorIntl.WordEditorStrings.L_ListTable5Dark);I.Z(e.a.e0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,
Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.f0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.g0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.h0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.i0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.j0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,
Box4Intl.Box4Strings.l_ThemeLabel10));I.Z(e.a.q0d,WordEditorIntl.WordEditorStrings.L_ListTable6Colorful);I.Z(e.a.Hbc,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.l0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.m0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.n0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,
Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.o0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.p0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));I.Z(e.a.x0d,WordEditorIntl.WordEditorStrings.L_ListTable7Colorful);I.Z(e.a.r0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));I.Z(e.a.s0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,
Box4Intl.Box4Strings.l_ThemeLabel6));I.Z(e.a.t0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));I.Z(e.a.u0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));I.Z(e.a.v0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));I.Z(e.a.w0d,this.Nd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));return I}Nd(I,T){return String.format(WordEditorIntl.WordEditorStrings.L_TableStyleNameWithThemeFormat,
I,T)}iia(I){if(this.Kd.Cg){let T=null;if(Object(F.a)(P.a,I)){const U=Object(J.a)(P.a,I);U&&(T=U.eR())}T&&this.lj.iia(I,T)}}static msf(){return new M(new E.a(()=>a.StyleReader.bTa),a.StyleReader.jg,k.GraphIterator.$a,Object(K.a)(M.eh,M.eh.Ms,"navigateToPageContentNode"),x.TableReader.ag,x.TableReader.Xg)}static get eh(){return y.PageNavigator.instance}static get instance(){return null!=M.nzg?M.nzg:M.nzg=M.msf()}}Object(D.a)(M,"TableStyleEditor",null,[298,299])},1603:function(D,L,c){c.d(L,"a",function(){return l});
D=c(0);var l;(function(e){e[e.Unknown=-1]="Unknown";e[e.H3o=0]="RichText";e[e.l3o=1]="PlainText";e[e.j3o=2]="Picture";e[e.c1o=3]="ComboBox";e[e.K1o=4]="DropDownList";e[e.U0o=5]="BuildingBlockGallery";e[e.Date=6]="Date";e[e.C3o=7]="RepeatSectionItem";e[e.$0o=8]="CheckBox";e[e.B3o=9]="RepeatSection";e[e.Bibliography=10]="Bibliography";e[e.$3o=11]="TableOfContents";e[e.Y2o=12]="NumberOfContentControlKinds"})(l||(l={}));Object(D.b)("ContentControlKind",l)},1604:function(D,L,c){c.d(L,"c",function(){return u});
c.d(L,"b",function(){return z});c.d(L,"a",function(){return v});var l=c(2),e=c(35),a=c(599),k=c(68),x=c(70),y=c(296);let m=void 0;const u=(E,F,J)=>{var K=E.characterData.length;if(F>J||J>K)return null;a:{for(H of E.DG)if(K=H.fc,void 0===m&&(m=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckSelectionViewInUxManager",!1)),m){if(K.re&&K===x.InteractiveViewManager.instance.vd){var H=K;break a}}else if(K.re){H=K;break a}H=null}if(!H)return null;H=E.Ej(H.jc);if(!H)return null;
K=[];E=E.qa;for(let N=E.Vfa(F);N<E.length;N++){var P=E.J(N);if(P.cp>J||P.cp===J&&F!==J)break;(P=y.a.pva(H,P.cp))&&0>Array.indexOf(K,P)&&K.push(P)}return K},z=E=>{let F=null;for(const K of E){var J=e.a.getElementBounds(K);F?(E=F,E.x>J.x&&(E.x=J.x),E.x+E.width<J.x+J.width&&(E.width=J.x+J.width-E.x),E.y>J.y&&(E.y=J.y),E.y+E.height<J.y+J.height&&(E.height=J.y+J.height-E.y)):F=J}F||(F=new Sys.UI.Bounds(0,0,0,0));return F},v=(E,F)=>{E=z(E);if(!E.width&&!E.height)return null;const J=document.createElement("div");
J.id=F;J.style.position="absolute";J.style.left=E.x+"px";J.style.top=E.y+"px";J.style.width=E.width+"px";J.style.height=E.height+"px";J.style.zIndex="-9999";k.d(J,a.a.Ayb,"true");return J}},1605:function(D,L,c){var l=this&&this.RD||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,
x)||l(k,a,x)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1832),L);e(c(1833),L);e(c(1834),L);e(c(1835),L);e(c(1836),L);D.exports.SuggestionCategory||Object.defineProperty(D.exports,"SuggestionCategory",{enumerable:!0,get:function(){return D.exports.SuggestionCategory}})},1606:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e){this.source=e}}Object(D.a)(l,"AcceptAllActionData",null,[])},1608:function(D,L,c){c.d(L,"a",function(){return N});D=c(0);var l=c(714),e=c(31),
a=c(11),k=c(19),x=c(24),y=c(10),m=c(14),u=c(754),z=c(566),v=c(254),E=c(82),F=c(76),J=c(117),K=c(1201),H=c(1511),P=c(860);c.n(P);class N{constructor(M,I,T,U,W,V,Y){this.kLa=M;this.ib=I;this.zm=T;this.kn=U;this.x9a=W;this.vZj=V;this.eTb=Y}Hma(M){return(M=this.kn.Hma(M))&&Object(E.a)(l.a,M.errorDetails)&&!M.errorDetails.l2a()?M:null}GDa(M){return this.x9a.GDa(M)}Dkf(M){if(!M)return null;if(u.a(M.annotationType)){if((M=M.content)&&M.suggestions&&!N.I_b(M))return M}else if(M.annotationType===z.a.getTypeName()){if((M=
M.content)&&M.suggestions)return M}else if(M.annotationType===P.FlagAnnotation.getTypeName()&&(M=M.content)&&M.results)return M;return null}mKd(M,I,T){let U=null,W=null,V=null;var Y=this.zm.rNc(M,0);if(!Y||!Y.count)return{returnValue:!1,annotation:U,lZi:W,DZe:V};for(const da of Y){if(I&&(da.begin!==M.cpBegin||da.end!==M.cpEnd))continue;Y=this.Dkf(da.intent);if(!Y||T&&!T(Y))continue;let ba;({stop:ba}=N.Kkj(W,Y)).returnValue&&(U=da.intent,W=Y,V=e.a.createTextRange(M.node,da.begin,da.end));if(ba)break}return{returnValue:!!W,
annotation:U,lZi:W,DZe:V}}u_h(M,I){let T=null;for(const U of M){if(U.type)continue;M=this.Dkf(U.intent);if(!M||I&&!I(M))continue;let W;({stop:W}=N.Kkj(T,M)).returnValue&&(T=M);if(W)break}return T}dei(M,I,T,U,W){const V=new F.a;if(U.rUd){var Y=this.zm.yOa(M,0,da=>{if(I>da.begin||da.begin>T)return!1;da=this.Dkf(da.intent);return!da||N.I_b(da)||U.P1c&&!U.P1c(da)?!1:!0});for(const da of Y)V.add(da)}if(U.qUd){Y=this.kn.j3(M,da=>{if(I>da.begin||da.begin>T)return!1;da=da.errorDetails;return da.l2a()||U.K0c&&
!U.K0c(da)?!1:!0});for(const da of Y)V.add(da)}if(U.pUd){M=this.x9a.cnf(M,da=>I>da.begin||da.begin>T||U.oIc&&!U.oIc(da.kD)?!1:!0);for(const da of M)V.add(da)}V.Sc(W);return V}fnf(M,I){return Math.min(Math.abs(I-M.begin),Math.abs(I-M.end))}IXl(M,I,T,U){let W,V=0;U?(U=0,W=I-1):(U=I+1,W=M.characterData.length);T=this.dei(M,U,W,T,(Y,da)=>this.fnf(Y,I)-this.fnf(da,I));if(!T.count)return{returnValue:null,offset:V};V=I<T.J(0).begin||I>T.J(0).end?this.fnf(T.J(0),I):0;return{returnValue:e.a.createTextRange(M,
T.J(0).begin,T.J(0).end),offset:V}}Ppf(M,I,T,U){let W=0;var V=({offset:W}=this.IXl(M,I,T,U)).returnValue;if(V)return{returnValue:V,offset:W};V=this.kLa.JJh(M,U);if(!V)return{returnValue:null,offset:W};for(W=U?I:M.characterData.length-I;V.Uaa();){M=V.mx;I=this.dei(M,0,M.characterData.length,T,(Y,da)=>Y.begin===da.begin?Y.end-da.end:Y.begin-da.begin);if(I.count)return T=U?I.J(I.count-1):I.J(0),W+=U?M.characterData.length-T.end:T.begin,{returnValue:e.a.createTextRange(M,T.begin,T.end),offset:W};W+=M.characterData.length}return{returnValue:null,
offset:W}}Opf(M,I,T,U){return this.Ppf(M,I,T,U).returnValue}jIc(M,I,T){let U=0,W=1;this.Opf(M,I,T,!1)&&W++;this.Opf(M,I,T,!0)&&(U++,W++);return{index:U,count:W}}xIl(M,I,T){let U;const W=({offset:U}=this.Ppf(M,I<M.characterData.length?I+1:I,T,!0)).returnValue;if(W&&!U)return W;I=({offset:M}=this.Ppf(M,1<I?I-1:0,T,!1)).returnValue;return W&&I?U<M?W:I:W?W:I}jbj(M,I){let T=null;a.App.ya&&Object(J.a)(K.PageView,a.App.ya.jb.xc)&&(T=a.App.ya.jb.xc);if(!T)return!1;this.ib.setSelection(k.SelectionEditor.Bj(x.SelectionFactory.Zn(M),
!0,!1));M=T.Cs.o4l();const U=(M-250)/2;T.Cs.p4(100<U?100-100*U/M:-1,void 0,void 0,W=>{window.setTimeout(()=>{I(W)},0)});return!0}RIb(M,I,T=4,U=!0){const W=()=>{I.vk.UE||I.OM(new H.a(M,T,!1,U,void 0,!0))};I.vk.dismiss();this.vZj.select(M.node,M.cpBegin,M.cpBegin);if(!this.eTb.PHd(M.node))return this.jbj(M,()=>{W()});W();return!0}static I_b(M){if(!M)return!0;if(!M.M_||!M.M_.state)return!1;M=M.M_.state;return 60===M||70===M}static Kkj(M,I){const T=v.a.getTypeNameFor(I)===z.a.getTypeName();return{returnValue:!M||
T||u.a(v.a.getTypeNameFor(I))&&M.priority>I.priority,stop:T}}ENf(M,I,T,U,W=4,V=!0){M=this.gKl(M);if(!M)return!1;I=this.oNh(M,I,T,U);return this.RIb(M,I,W,V)}gKl(M){var I=this.ib.hb.lb;for(const T of I)if(y.ParagraphReader.Yb(T.node)&&(I=T.contextId,I===m.a.Vc||I===m.a.Fd||I===m.a.paragraph))return this.xIl(T.node,I!==m.a.paragraph?T.cpBegin:0,M);return null}oNh(M,I,T,U){return this.Twm(M)?I:this.ZAm(M)?U:T}Twm(M){return this.mKd(M,!0,null).returnValue}ZAm(M){return!!this.GDa(M)}}Object(D.a)(N,"SuggestionNavigator",
null,[])},1609:function(D,L,c){c.d(L,"c",function(){return e});c.d(L,"a",function(){return a});c.d(L,"b",function(){return k});var l=c(27);const e=(x,y,m)=>{if(!l.c(x)&&"#text"!==x.nodeName&&(y?x.setAttribute("unselectable","on"):x.setAttribute("unselectable","off"),m))for(x=x.firstChild;x;)e(x,y,!0),x=x.nextSibling},a=x=>{x=document.createElement(x);x.setAttribute("unselectable","on");return x},k=(x,y)=>{if(!l.c(x)){var m=x.className;if(l.c(m)||-1===m.indexOf(y))y=m.trim()+" "+y,y=y.trim(),x.className=
y}}},1610:function(D,L,c){c.d(L,"a",function(){return u});D=c(0);var l=c(8),e=c(46),a=c(2),k=c(156),x=c(21),y=c(250),m=c(28);class u{constructor(){this.Xda=null;this.Fch=!0}Zke(){try{this.Xda||(this.Xda=x.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"),this.Fch=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.EnableOAuthMgrForService",!0))}catch(z){l.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+
z)}}Jsf(z,v,E){return this.Xda?this.Xda.getToken(z,v,E):new Promise(F=>{x.a.instance.Sa("Common.App.SearchCommon.ISearchOAuthManager").execute(J=>{J?(this.Xda=J,this.Xda.getToken(z,v,E).then(K=>F(K))):F(null)})})}yVl(){this.Zke();return this.Xda?this.Xda.getToken("Search",a.AFrameworkApplication.HIf,!1):null}$ci(){if("Dev Box"===a.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>
{window.setTimeout(()=>{z(window.TellMeSubstrateTokenOverride)},750)});this.Zke();return this.Xda?this.Xda.getToken("Search",a.AFrameworkApplication.Idg,!0):null}A8l(){this.Zke();return this.Xda?this.Xda.getToken("Search",this.x8l(),this.Fch):null}x8l(){return a.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")}K5l(){if("Dev Box"===a.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>
{window.setTimeout(()=>{z(window.TellMeSubstrateTokenOverride)},750)});this.Zke();return this.Xda?this.Xda.getToken("SmartLookup",this.H5l()):null}H5l(){return a.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")}zVl(){return Object(e.a)(this,this.yVl,"getLokiTokenPromise")}$6l(){return Object(e.a)(this,this.$ci,"getSubstrateTokenPromise")}FNb(){return!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Ob.FNb}n9l(){const z={};this.FNb()&&(z.Loki=this.zVl(),z.Substrate=this.$6l());
return z}GWc(z){k.a.XGa(Object.assign(new y.a,{name:"Events",dataFields:[Object.assign(new m.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new m.a,{name:"Status",bool:z})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}nTm(){return a.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.GWc(!1);return!1}).then(()=>{this.GWc(!0);return!0}):new Promise((z,v)=>{const E=x.a.instance.resolve("Common.IDynamicScriptLoaderProvider").HA;
E?E.loadScript("tellme-strings").then(()=>{this.GWc(!0);z(!0)}).catch(()=>{this.GWc(!1);v(!1)}):(this.GWc(!1),v(!1))})}static tJm(){return!!a.AFrameworkApplication.ta&&(a.AFrameworkApplication.ta.Ob.HUc||a.AFrameworkApplication.ta.Ob.tac)}static CYd(){return!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Ob.tac}}Object(D.a)(u,"ReactSharedHeaderSearchUtils",null,[])},1612:function(D,L,c){c.r(L);c.d(L,"validateCpDataV1",function(){return e});c.d(L,"isEqual",function(){return a});c.d(L,"isSupportedCpVersion",
function(){return k});c.d(L,"validateVersionedCpData",function(){return y});c.d(L,"versionedDeserialize",function(){return m});var l=c(1581);const e=u=>"number"!==typeof u.CP||null!=u.FB&&"number"!==typeof u.FB||null!=u.FE&&"number"!==typeof u.FE||null!=u.HB&&"number"!==typeof u.HB||null!=u.HE&&"number"!==typeof u.HE||null!=u.CB&&"number"!==typeof u.CB||null!=u.CE&&"number"!==typeof u.CE||null!=u.R&&"number"!==typeof u.R||null!=u.E&&"number"!==typeof u.E||null!=u.TW&&"number"!==typeof u.TW||null!=
u.PB&&"number"!==typeof u.PB||null!=u.SYM&&"number"!==typeof u.SYM||null!=u.IE&&"number"!==typeof u.IE||null!=u.OO&&"number"!==typeof u.OO||null!=u.AX&&"number"!==typeof u.AX||null!=u.CCI&&"number"!==typeof u.CCI||null!=u.DD&&"number"!==typeof u.DD?!1:!0,a=(u,z)=>u||z?u&&z&&u.CP===z.CP&&u.FB===z.FB&&u.FE===z.FE&&u.HB===z.HB&&u.HE===z.HE&&u.CB===z.CB&&u.CE===z.CE&&u.R===z.R&&u.E===z.E&&u.TW===z.TW&&u.PB===z.PB&&u.SYM===z.SYM&&u.IE===z.IE&&u.OO===z.OO&&u.AX===z.AX&&u.CCI===z.CCI&&u.DD===z.DD?!0:!1:
!0,k=u=>1===u,x=u=>{let z=u,v=0;"number"===typeof z.VS&&(v=z.VS);if("number"===typeof z.VS||"number"===typeof z.CP)return{returnValue:z,Xkg:v};z=null;for(let E=0;E<u.length;E++){const F=u[E];1===F.VS&&F.VS>v&&(v=F.VS,z=u[E])}return{returnValue:z,Xkg:v}},y=u=>{const z=({Xkg:u}=x(u)).returnValue;if(!z)return!1;switch(u){case 0:case 1:return e(z);default:return!1}},m=u=>{if(!u)return null;const z=({Xkg:u}=x(u)).returnValue;if(!z)return null;switch(u){case 0:case 1:return l.b(z);default:return null}}},
1626:function(D,L,c){c.d(L,"a",function(){return k});var l=c(66);D=c(0);var e=c(79),a=c(1514);class k{constructor(x){this.taskManager=x}LBb(x,y){const {priority:m=2,delay:u=0}=null!==y&&void 0!==y?y:{},z=new a.a,v=()=>Object(l.__awaiter)(this,void 0,void 0,function*(){return yield x()});y=new e.a(m,1,u,()=>{v().then(z.resolve).catch(z.reject)});this.taskManager.Wb(y);return z.completion}}Object(D.a)(k,"TaskDispatcher",null,[])},1627:function(D,L,c){c.d(L,"a",function(){return k});D=c(0);var l=c(118),
e=c(2),a=c(8);class k{constructor(x,y){this.NP=x;this.dTa=y}pR(x,y,m){x={["appId"]:2155,["manifestType"]:"Fps",["submitTime"]:(new Date).toISOString(),["source"]:"Client",["type"]:"Survey",["clientFeedbackId"]:l.a.create().toString(),["email"]:y,["application"]:{["appData"]:"{}",["extendedManifestData"]:JSON.stringify({["surveySpecificData"]:JSON.stringify(m)})},["survey"]:{["surveyId"]:x},["telemetry"]:this.Zyb(),["web"]:this.fEc()};this.xGa(JSON.stringify(x),{["Content-Type"]:"application/json"})}Zyb(){const x=
e.AFrameworkApplication.sessionStartInfoSettings;return{["officeBuild"]:e.AFrameworkApplication.buildVersion,["featureArea"]:"EditorAi",["audienceGroup"]:x.AudienceGroup,["osBuild"]:x.OsVersion,["platform"]:x.Platform,["processSessionId"]:x.WACSessionID,["flights"]:e.AFrameworkApplication.K.kb("FlightId"),["loggableUserId"]:e.AFrameworkApplication.K.kb("LoggableUserId"),["tenantId"]:e.AFrameworkApplication.K.kb("TenantId")}}xGa(x,y,m=0){3<m||this.dTa.LBb(()=>{this.NP.oj("https://petrol.office.microsoft.com/v1/feedback",
2,x,y,!1,2,()=>{a.ULS.sendTraceTag(509207132,3041,50,"Success sending OCV feedback for EditorAi")},()=>{this.xGa(x,y,m+1);a.ULS.sendTraceTag(509207131,3041,50,"Failure sending OCV feedback for EditorAi, attempt {0}",m)},null)},{delay:this.kMl(m)})}kMl(x=0){let y=0;1===x?y=200:1<x&&(y=200+500*(x-1));return y}fEc(){const x=e.AFrameworkApplication.sessionStartInfoSettings;return{["browser"]:x.Browser,["browserVersion"]:x.BrowserVersion,["dataCenter"]:x.WACDatacenter}}}Object(D.a)(k,"EditorAiSurveysApiClient",
null,[])},1628:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);class l{constructor(a){this.selectedRating=a}}Object(D.a)(l,"EditorAiRatingData",null,[]);class e{constructor(a,k,x){this.rating=[new l(a)];this.comment=[k,...x]}}Object(D.a)(e,"EditorAiSurveyData",null,[])},1629:function(D,L,c){D=c(0);var l=c(600),e=c(16),a=c(171),k=c(63),x=c(2),y=c(21),m=c(8),u=c(1439),z=c(14),v=c(111),E=c(31),F=c(3),J=c(1048),K=c(144),H=c(19),P=c(24),N=c(135),M=c(10);class I{static get qsh(){I.Onc||(I.Onc=[],
I.acc(l.a.lg("ar-sa")),I.acc(l.a.lg("de-de")),I.acc(l.a.lg("es-es")),I.G_(l.a.lg("en-029"),l.a.lg("en-us")),I.G_(l.a.lg("en-au"),l.a.lg("en-us")),I.G_(l.a.lg("en-bz"),l.a.lg("en-us")),I.G_(l.a.lg("en-ca"),l.a.lg("en-us")),I.G_(l.a.lg("en-gb"),l.a.lg("en-us")),I.G_(l.a.lg("en-id"),l.a.lg("en-us")),I.G_(l.a.lg("en-my"),l.a.lg("en-us")),I.G_(l.a.lg("en-ph"),l.a.lg("en-us")),I.G_(l.a.lg("zh-tw"),l.a.lg("en-us")),I.acc(l.a.lg("fr-fr")),I.G_(l.a.lg("hr-ba"),l.a.lg("hr-hr")),I.G_(l.a.lg("it-ch"),l.a.lg("it-it")),
I.G_(l.a.lg("nb-no"),l.a.lg("nn-no")),I.acc(l.a.lg("nl-nl")),I.G_(l.a.lg("ro-md"),l.a.lg("ro-ro")),I.G_(l.a.lg("ru-md"),l.a.lg("ru-ru")),I.G_(l.a.lg("sr-latn-ba"),l.a.lg("sr-latn-cs")),I.G_(l.a.lg("sr-latn-me"),l.a.lg("sr-latn-cs")),I.G_(l.a.lg("sr-latn-rs"),l.a.lg("sr-latn-cs")),I.acc(l.a.lg("sr-cyrl-cs")),I.G_(l.a.lg("sv-fi"),l.a.lg("sv-se")));return I.Onc}static acc(bb){I.Onc[bb.languageId]=bb.LCID}static G_(bb,nb){I.Onc[bb.LCID]=nb.LCID}static B4h(bb){var nb=l.a.lg(bb);if(!nb)return 0;nb=I.qsh[nb.LCID]||
I.qsh[nb.languageId]||0;return nb===bb?0:nb}}I.Onc=null;Object(D.a)(I,"AutoCorrectListFallback",null,[]);var T=c(381),U=c(75),W=c(108),V=c(123),Y=c(6),da=c(17),ba=c(5),ja=c(104),sa=c(313),ta=c(40),ra=c(65),ma=c(102),Ba=c(47),Pa=c(1517);class Da extends Pa.a{constructor(bb,nb,Va,Ab,Zb,Kb){super(bb,nb,Va,Ab,Kb);this.bY=Zb}get vC(){return!0}get commandId(){return F.a.vBk}set vC(bb){super.vC=bb}}Object(D.a)(Da,"ARegexCorrectAction",Pa.a,[]);class Ha extends Da{static get Zjb(){if(null!=Ha.iAg)var bb=
Ha.iAg;else(bb=y.a.instance.Ma("Box4.List.IListCommands"))||m.ULS.sendTraceTag(512357316,393,50,"IListCommands was tried to be resolved before it was registered."),bb=Ha.iAg=bb;return bb}static get Qn(){return null!=Ha.mAg?Ha.mAg:Ha.mAg=y.a.instance.resolve("Box4.List.IListEditor")}static get Ad(){return null!=Ha.DAg?Ha.DAg:Ha.DAg=y.a.instance.resolve("Box4.List.IListReader")}get levelText(){const [bb,nb]=this.bY;return nb?bb.replace(nb,"%1"):bb}}Object(D.a)(Ha,"AListAutoCorrectAction",Da,[]);var oa=
c(150);class wa extends Ha{get commandId(){return F.a.nBk}$la(bb){if(wa.Zjb){var nb=ba.GraphIterator.$a(bb);nb.yd();ta.OutlineElementNavigator.Zd(nb);if(wa.Qn.Ufe(nb,this.bY[0])){var Va=wa.Ad.Fw(nb),Ab=this.bY[0],Zb=e.a.charAt(Ab,0),Kb=this.RVl(Zb),dc=sa.a.dT(1,Kb.listStyle);Va&&dc.Ruf(Va)||(Va=new Ba.GraphTransaction(15),Va.Fu(nb),this.Jd.replaceTextRange(E.a.createTextRange(bb,this.kG,this.I_+1),"",!0,!1),wa.Qn.Sco(dc),bb=new T.DictionaryPropertySet,bb.setValue(W.a.rjf,!0),Zb&&(dc.IP=Zb,bb.setValue(V.a.IP,
dc.IP)),bb.setValue(Y.a.Vt,Kb.levelText),bb.setValue(da.a.font,Kb.fontName),"-"===Zb&&U.Health.instance.recordKpiUsage("DashBulletAutoCreate",0,wa.dB,null),oa.a.NX&&(bb.setValue(V.a.joa,"autocorrect"),bb.setValue(V.a.Lga,Ab)),wa.Zjb.qIk(dc.listType,dc.listStyle,bb),Va.dispose())}}}RVl(bb){const nb={listStyle:0,levelText:ja.a.zGd,fontName:ja.a.QHc};switch(bb){case "*":return Object.assign(Object.assign({},nb),{listStyle:1});case "-":return Object.assign(Object.assign({},nb),{levelText:"-",fontName:ma.a.OF});
default:return nb}}static LF(bb,nb,Va,Ab,Zb){return new wa(null,bb,nb,Va,Ab,Zb)}static eT(bb,nb,Va,Ab,Zb){return new wa(bb,ra.a(bb).Cb,nb,Va,Ab,Zb)}}wa.dB="wwaengidc";wa.T0f=["[\\*](?![\\*])","[\\-](?![\\-])"];Object(D.a)(wa,"BulletListAction",Ha,[]);var ia=c(80);class ca extends Da{constructor(bb,nb,Va,Ab,Zb,Kb){super(bb,nb,Va,Ab,Zb,Kb);this.buc=!1;this.vC=!bb;ca.ep=new ia.a}get vC(){return this.buc}set vC(bb){this.buc=bb}gBb(bb){this.J4e(bb.innerText,(nb,Va,Ab)=>{bb.innerText=e.a.substring(bb.innerText,
0,nb)+Ab+e.a.right(bb.innerText,Va)})}$la(bb){this.J4e(M.ParagraphReader.text(bb).substring(this.kG,this.I_),(nb,Va,Ab)=>{this.Jd.replaceTextRange(E.a.createTextRange(bb,this.kG+nb,this.kG+Va),Ab,!0,!1)})}J4e(bb,nb){if(!(2>this.bY.length)&&this.bY[1]){var Va=this.bY[1];ca.ep.count||this.IWi();ca.ep.ob(Va)&&(bb=bb.lastIndexOf(Va),-1!==bb&&nb(bb,bb+Va.length,ca.ep.J(Va)))}}}Object(D.a)(ca,"ADictionarySequenceReplacerAction",Da,[]);class pa extends ca{get commandId(){return F.a.x0e}IWi(){ca.ep.Z("--",
"\u2014");ca.ep.Z(" -- "," \u2013 ");ca.ep.Z(" - "," \u2013 ");ca.ep.Z("-- ","\u2014");ca.ep.Z(" --"," \u2013");ca.ep.Z(" -"," \u2013")}static LF(bb,nb,Va,Ab,Zb){return new pa(null,bb,nb,Va,Ab,Zb)}static eT(bb,nb,Va,Ab,Zb){return new pa(bb,ra.a(bb).Cb,nb,Va,Ab,Zb)}}Object(D.a)(pa,"DashAction",ca,[]);class Ma extends ca{constructor(bb,nb,Va,Ab,Zb,Kb,dc){super(bb,nb,Va,Ab,Zb,Kb);this.ga=dc}get commandId(){return F.a.oBk}IWi(){ca.ep.Z(":)","\ud83d\ude0a");ca.ep.Z(":-)","\ud83d\ude0a");ca.ep.Z(":|","\ud83d\ude10");
ca.ep.Z(":-|","\ud83d\ude10");ca.ep.Z(":(","\ud83d\ude41");ca.ep.Z(":-(","\ud83d\ude41");ca.ep.Z(";)","\ud83d\ude09");ca.ep.Z(";-)","\ud83d\ude09");ca.ep.Z(":D","\ud83d\ude00");ca.ep.Z(":-D","\ud83d\ude00");ca.ep.Z(":')","\ud83d\ude02");ca.ep.Z("=D","\ud83d\ude03");ca.ep.Z(":>","\ud83d\ude06");ca.ep.Z(":->","\ud83d\ude06");ca.ep.Z(":3","\ud83d\ude0a");ca.ep.Z(":-3","\ud83d\ude0a");ca.ep.Z("B-)","\ud83d\ude0e");ca.ep.Z("*-*","\ud83d\ude0d");ca.ep.Z(":*","\ud83d\ude19");ca.ep.Z(":-*","\ud83d\ude19");
ca.ep.Z(":X","\ud83d\ude36");ca.ep.Z(":-X","\ud83d\ude36");ca.ep.Z(":O","\ud83d\ude2e");ca.ep.Z(":-O","\ud83d\ude2e");ca.ep.Z(":#","\ud83e\udd10");ca.ep.Z(":-#","\ud83e\udd10");ca.ep.Z(":P","\ud83d\ude1b");ca.ep.Z(":-P","\ud83d\ude1b");ca.ep.Z(";P","\ud83d\ude1c");ca.ep.Z(";-P","\ud83d\ude1c");ca.ep.Z(":-/","\ud83d\ude15");ca.ep.Z("$-$","\ud83e\udd11");ca.ep.Z(":S","\ud83d\ude16");ca.ep.Z(":-S","\ud83d\ude16");ca.ep.Z(":[","\ud83d\ude1f");ca.ep.Z(":-[","\ud83d\ude1f");ca.ep.Z(":\u2019(","\ud83d\ude22");
ca.ep.Z(":'(","\ud83d\ude22");ca.ep.Z("@-@","\ud83d\ude31")}$la(bb){this.J4e(M.ParagraphReader.text(bb).substring(this.kG,this.I_),(nb,Va,Ab)=>{nb=E.a.createTextRange(bb,this.kG+nb,this.kG+Va);Va={};Va.MenuItemId=Ab;this.ga.Nf(nb,F.a.gib,2,!1,null,Va,null)})}static LF(bb,nb,Va,Ab,Zb,Kb){return new Ma(null,bb,nb,Va,Ab,Zb,Kb)}static eT(bb,nb,Va,Ab,Zb,Kb){return new Ma(bb,ra.a(bb).Cb,nb,Va,Ab,Zb,Kb)}}Object(D.a)(Ma,"EmojiAction",ca,[]);class ya{constructor(bb,nb,Va,Ab){this.VR=bb;this.Jvd=nb;this.Juc=
Ab;this.sF=Va}Cvi(){if(!this.sF)return!1;this.VR=this.VR.trimStart();return this.VR===this.sF?!0:!1}kNm(){if(!this.VR)return!1;const bb=this.VR.lastIndexOf(" ");return-1!==bb&&"."===this.VR.charAt(bb-1)&&"."===this.VR.charAt(bb-3)?!0:!1}jNm(){if(!this.VR)return!1;var bb=this.VR.lastIndexOf(" ");return-1!==bb&&(bb=this.VR.substring(0,bb-1).lastIndexOf(" "),"."===this.VR.charAt(bb+2))?!0:!1}EGm(){return this.Cvi()&&(1===this.sF.length&&"."===this.Jvd||"."===this.VR.charAt(1))?!0:!1}FGm(){return this.sF?
0<="\\/".indexOf(this.Jvd)||3===this.sF.length&&0<="\\/".indexOf(this.sF.charAt(1))?!0:!1:!1}AFm(){return this.sF?0<=this.sF.indexOf("@")?!0:!1:!1}lB(){if(!this.sF)return!1;for(const bb of ya.utf())if(e.a.startsWith(this.sF+this.Jvd,bb))return!0;return!1}hFm(){return this.sF?"i"===this.sF&&0<=ya.quotes.indexOf(this.Jvd)?!0:!1:!1}uzm(){if(!this.VR)return!1;const bb=e.a.U2a(this.VR,this.VR.length-1);if(-1!==bb&&this.VR.substring(bb+1,this.VR.length)===this.sF){const nb=this.VR.charAt(bb-1);if(0<=ya.t7f.indexOf(nb)||
0<=ya.quotes.indexOf(nb)&&0<=ya.t7f.indexOf(this.VR.charAt(bb-2)))return!0}return!1}fOk(){return!this.VR||this.kNm()||this.EGm()||this.FGm()||this.jNm()||this.AFm()||this.lB()?!1:this.Cvi()||this.hFm()||this.uzm()?!0:!1}static utf(){return ya.m1g||(ya.m1g="http: https: ftp:// mailto: \\\\ www.".split(" "))}}ya.t7f=".!?";ya.quotes="'\"";ya.m1g=null;Object(D.a)(ya,"FirstLetterUpperCaseRules",null,[]);class Oa{constructor(bb){this.sF=bb}CAl(){if(!this.sF)return null;for(let bb=0;bb<Oa.Mfi().length;bb++)if(this.sF===
Oa.Mfi()[bb])return Oa.Qbm()[bb];return null}static Mfi(){return Oa.LSg||(Oa.LSg=["1/2","1/4","3/4"])}static Qbm(){return Oa.KSg||(Oa.KSg=["\u00bd","\u00bc","\u00be"])}}Oa.LSg=null;Oa.KSg=null;Object(D.a)(Oa,"FractionsCollection",null,[]);class fa extends Pa.a{constructor(bb,nb,Va,Ab,Zb,Kb){super(bb,nb,Va,Ab,Kb);this.ZFh=Zb}get vC(){return!0}get commandId(){return F.a.pBk}gBb(bb){bb.innerText=e.a.substring(bb.innerText,0,this.kG)+this.ZFh+e.a.right(bb.innerText,this.I_)}$la(bb){this.Jd.replaceTextRange(E.a.createTextRange(bb,
this.kG,this.I_),this.ZFh,!0,!1)}set vC(bb){super.vC=bb}static LF(bb,nb,Va,Ab,Zb){return new fa(null,bb,nb,Va,Ab,Zb)}}Object(D.a)(fa,"FractionsReplaceCorrectAction",Pa.a,[]);class Ca extends Ha{get commandId(){return F.a.rBk}$la(bb){if(Ca.Zjb){var nb=ba.GraphIterator.$a(bb);nb.yd();ta.OutlineElementNavigator.Zd(nb);if(Ca.Qn.Ufe(nb,this.bY[0])){var [Va,Ab]=this.bY,Zb=Ca.pcn(Ab),Kb=e.a.Iac(Ab)?4:2,dc=E.a.createTextRange(bb,this.kG,this.I_+1);Ca.Qn.m0b(bb,nb,Kb,Zb,dc,Va,this.levelText,Ca.Zjb)}}}static LF(bb,
nb,Va,Ab,Zb){return new Ca(null,bb,nb,Va,Ab,Zb)}static eT(bb,nb,Va,Ab,Zb){return new Ca(bb,ra.a(bb).Cb,nb,Va,Ab,Zb)}static pcn(bb){if(!bb)return 0;bb=e.a.fh(bb);if(!e.a.OVd(bb.charAt(0)))return 0;const nb=bb.charCodeAt(0)-97+1;let Va;for(Va=1;Va<bb.length&&bb.charAt(Va)===bb.charAt(0);Va++);return 26*(Va-1)+nb}}Object(D.a)(Ca,"LetterListAction",Ha,[]);var Ta=c(132);class eb extends Ha{get commandId(){return F.a.m0b}$la(bb){if(eb.Zjb){var nb=ba.GraphIterator.$a(bb);nb.yd();ta.OutlineElementNavigator.Zd(nb);
if(eb.Qn.Ufe(nb,this.bY[0])){var [Va,Ab]=this.bY,Zb=parseInt(Ab);if(!(99999999<=Zb)){var Kb=E.a.createTextRange(bb,this.kG,this.I_+1);Ta.a.zZd()&&Ta.a.Mdm();eb.Qn.m0b(bb,nb,1,Zb,Kb,Va,this.levelText,eb.Zjb)}}}}static LF(bb,nb,Va,Ab,Zb){return new eb(null,bb,nb,Va,Ab,Zb)}static eT(bb,nb,Va,Ab,Zb){return new eb(bb,ra.a(bb).Cb,nb,Va,Ab,Zb)}}Object(D.a)(eb,"NumberListAction",Ha,[]);class jb extends Pa.a{get vC(){return!0}get commandId(){return F.a.tBk}gBb(){}$la(bb){const nb=E.a.createTextRange(bb,this.I_-
2,this.I_),Va=new Ba.GraphTransaction(15);Va.Eb(bb);let Ab=!1,Zb=null,Kb=0;for(;Kb<bb.qa.length;){var dc=bb.qa.J(Kb),jc=dc.p8;const zb=dc.$T;if(dc.cp>=nb.cpBegin){dc.cp>nb.cpBegin||!dc.formatting?Zb=Ab?dc.formatting:this.Jd.tY(bb,Kb,nb.cpBegin,Zb):(Zb=dc.formatting,zb&&(Ab=!1),jc&&(Ab=!0));Kb++;break}dc.formatting&&(Zb=dc.formatting);zb&&(Ab=!1);jc&&(Ab=!0);Kb++}for(;Kb<bb.qa.length;){jc=bb.qa.J(Kb);if(jc.cp>=nb.cpEnd){if(jc.cp>nb.cpEnd||!jc.formatting&&!jc.Rh)Ab||this.Jd.tY(bb,Kb,nb.cpEnd,Zb);Ab||
jb.oq.Kpa(Zb,!0);break}jc.formatting&&(Ab||jb.oq.Kpa(Zb,!0),Zb=jc.formatting);dc=jc.p8;jc=jc.$T;dc&&(Ab=!0);!dc&&jc&&(Ab=!1);Kb++}Va.dispose()}set vC(bb){super.vC=bb}static get oq(){return null!=jb.Awg?jb.Awg:jb.Awg=y.a.instance.resolve("Box4.IFormattingEditor")}static LF(bb,nb,Va,Ab){return new jb(null,bb,nb,Va,Ab)}}Object(D.a)(jb,"OrdinalsReplaceCorrectAction",Pa.a,[]);var ob;(function(bb){bb[bb.rand=0]="rand";bb[bb.randOld=1]="randOld";bb[bb.lorem=2]="lorem"})(ob||(ob={}));Object(D.b)("RandTextType",
ob);class Ya extends Da{constructor(bb,nb,Va,Ab,Zb,Kb){super(bb,nb,Va,Ab,Zb,Kb);Ya.PMe||Ya.zvo()}static pGm(){var bb;return null===(bb=x.AFrameworkApplication.K)||void 0===bb?void 0:bb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isNoRandDoubleSpaceEnabled",!0)}get commandId(){return F.a.uBk}$la(bb){if(!bb.Js){var nb=this.l$a.Qa.node===bb,Va=5,Ab=3;if(this.bY[0].startsWith("=rand.old")){var Zb=ob.randOld;Va=3}else if(this.bY[0].startsWith("=rand"))Zb=ob.rand;else if(this.bY[0].startsWith("=lorem"))Zb=
ob.lorem;else return;this.bY[1]&&(Va=parseInt(this.bY[1]));this.bY[2]&&(Ab=parseInt(this.bY[2]));if(!(20<Ab||100<Va)){bb.pH().NE.Q6(7);var Kb=ba.GraphIterator.$a(bb);Kb.yd();ta.OutlineElementNavigator.Zd(Kb);Ya.vg.uC(Kb,!1,!1);Ya.vg.UL(Kb);var dc=!1;switch(Zb){case ob.rand:Zb=Ya.PMe;break;case ob.randOld:Zb=Ya.g9g;break;case ob.lorem:Zb=Ya.e2g;dc=!0;break;default:return}var jc=0;for(let cc=0;cc<Va;++cc){const Ub=[];for(var zb=0;zb<Ab;zb++)Ub.push(Zb[jc++%Zb.length]);zb=E.a.Tc(Kb.currentNode,0);if(dc){const Wb=
v.FormattingReader.Ar(zb);Ya.oq.Wl(Wb,Y.a.noProof,!0)}this.Jd.replaceTextRange(zb,Ub.join(Ya.pGm()?"":" "),!0,!1);cc<Va-1&&(ta.OutlineElementNavigator.Zd(Kb),Ya.vg.uC(Kb,!1,!1),Ya.vg.UL(Kb))}Va=Kb.currentNode;Kb=ba.GraphIterator.$a(bb);Kb.yd();ta.OutlineElementNavigator.Zd(Kb);Kb.Dg();nb&&(this.l$a=P.SelectionFactory.te(Va,M.ParagraphReader.textLength(Va)))}}}static get vg(){return null!=Ya.jBg?Ya.jBg:Ya.jBg=y.a.instance.resolve("Box4.IOutlineElementEditor")}static get oq(){return null!=Ya.Ewg?Ya.Ewg:
Ya.Ewg=y.a.instance.resolve("Box4.IFormattingEditor")}static zvo(){Ya.PMe="Video provides a powerful way to help you prove your point. ;When you click Online Video, you can paste in the embed code for the video you want to add. ;You can also type a keyword to search online for the video that best fits your document. ;To make your document look professionally produced, Word provides header, footer, cover page, and text box designs that complement each other. ;For example, you can add a matching cover page, header, and sidebar. ;Click Insert and then choose the elements you want from the different galleries. ;Themes and styles also help keep your document coordinated. ;When you click Design and choose a new Theme, the pictures, charts, and SmartArt graphics change to match your new theme. ;When you apply styles, your headings change to match the new theme. ;Save time in Word with new buttons that show up where you need them. ;To change the way a picture fits in your document, click it and a button for layout options appears next to it. ;When you work on a table, click where you want to add a row or a column, and then click the plus sign. ;Reading is easier, too, in the new Reading view. ;You can collapse parts of the document and focus on the text you want. ;If you need to stop reading before you reach the end, Word remembers where you left off - even on another device. ".split(";");
Ya.g9g=["The quick brown fox jumps over the lazy dog. "];Ya.e2g="Lorem ipsum dolor sit amet, consectetuer adipiscing elit. ;Maecenas porttitor congue massa. ;Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna. ;Nunc viverra imperdiet enim. ;Fusce est. ;Vivamus a tellus. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin pharetra nonummy pede. ;Mauris et orci. ;Aenean nec lorem. ;In porttitor. ;Donec laoreet nonummy augue. ;Suspendisse dui purus, scelerisque at, vulputate vitae, pretium mattis, nunc. ;Mauris eget neque at sem venenatis eleifend. ;Ut nonummy. ;Fusce aliquet pede non pede. ;Suspendisse dapibus lorem pellentesque magna. ;Integer nulla. ;Donec blandit feugiat ligula. ;Donec hendrerit, felis et imperdiet euismod, purus ipsum pretium metus, in lacinia nulla nisl eget sapien. ;Donec ut est in lectus consequat consequat. ;Etiam eget dui. ;Aliquam erat volutpat. ;Sed at lorem in nunc porta tristique. ;Proin nec augue. ;Quisque aliquam tempor magna. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Nunc ac magna. ;Maecenas odio dolor, vulputate vel, auctor ac, accumsan id, felis. ;Pellentesque cursus sagittis felis. ;Pellentesque porttitor, velit lacinia egestas auctor, diam eros tempus arcu, nec vulputate augue magna vel risus. ;Cras non magna vel ante adipiscing rhoncus. ;Vivamus a mi. ;Morbi neque. ;Aliquam erat volutpat. ;Integer ultrices lobortis eros. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin semper, ante vitae sollicitudin posuere, metus quam iaculis nibh, vitae scelerisque nunc massa eget pede. ;Sed velit urna, interdum vel, ultricies vel, faucibus at, quam. ;Donec elit est, consectetuer eget, consequat quis, tempus quis, wisi. ;In in nunc. ;Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. ;Donec ullamcorper fringilla eros. ;Fusce in sapien eu purus dapibus commodo. ;Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. ;Cras faucibus condimentum odio. ;Sed ac ligula. ;Aliquam at eros. ;Etiam at ligula et tellus ullamcorper ultrices. ;In fermentum, lorem non cursus porttitor, diam urna accumsan lacus, sed interdum wisi nibh nec nisl. ;Ut tincidunt volutpat urna. ;Mauris eleifend nulla eget mauris. ;Sed cursus quam id felis. ;Curabitur posuere quam vel nibh. ;Cras dapibus dapibus nisl. ;Vestibulum quis dolor a felis congue vehicula. ;Maecenas pede purus, tristique ac, tempus eget, egestas quis, mauris. ;Curabitur non eros. ;Nullam hendrerit bibendum justo. ;Fusce iaculis, est quis lacinia pretium, pede metus molestie lacus, at gravida wisi ante at libero. ;Quisque ornare placerat risus. ;Ut molestie magna at mi. ;Integer aliquet mauris et nibh. ;Ut mattis ligula posuere velit. ;Nunc sagittis. ;Curabitur varius fringilla nisl. ;Duis pretium mi euismod erat. ;Maecenas id augue. ;Nam vulputate. ;Duis a quam non neque lobortis malesuada. ;Praesent euismod. ;Donec nulla augue, venenatis scelerisque, dapibus a, consequat at, leo. ;Pellentesque libero lectus, tristique ac, consectetuer sit amet, imperdiet ut, justo. ;Sed aliquam odio vitae tortor. ;Proin hendrerit tempus arcu. ;In hac habitasse platea dictumst. ;Suspendisse potenti. ;Vivamus vitae massa adipiscing est lacinia sodales. ;Donec metus massa, mollis vel, tempus placerat, vestibulum condimentum, ligula. ;Nunc lacus metus, posuere eget, lacinia eu, varius quis, libero. ;Aliquam nonummy adipiscing augue. ".split(";")}static LF(bb,
nb,Va,Ab,Zb){return new Ya(null,bb,nb,Va,Ab,Zb)}static eT(bb,nb,Va,Ab,Zb){return new Ya(bb,ra.a(bb).Cb,nb,Va,Ab,Zb)}}Ya.PMe=null;Ya.g9g=null;Ya.e2g=null;Object(D.a)(Ya,"RandAction",Da,[]);class Xa{constructor(bb,nb,Va,Ab){this.pattern=Ab&8?new RegExp(bb,"i"):new RegExp(bb);this.Ulm=nb;this.Ecm=Va;this.flags=Ab}}Object(D.a)(Xa,"RegexAutoCorrectEntry",null,[]);class Sa extends Ha{get commandId(){return F.a.wBk}$la(bb){if(Sa.Zjb){var nb=ba.GraphIterator.$a(bb);nb.yd();ta.OutlineElementNavigator.Zd(nb);
if(Sa.Qn.Ufe(nb,this.bY[0])){var [Va,Ab]=this.bY,Zb=Sa.qcn(Ab);if(!(0>=Zb)){var Kb=e.a.Iac(Ab.charAt(0))?5:3,dc=E.a.createTextRange(bb,this.kG,this.I_+1);Sa.Qn.m0b(bb,nb,Kb,Zb,dc,Va,this.levelText,Sa.Zjb)}}}}static LF(bb,nb,Va,Ab,Zb){return new Sa(null,bb,nb,Va,Ab,Zb)}static eT(bb,nb,Va,Ab,Zb){return new Sa(bb,ra.a(bb).Cb,nb,Va,Ab,Zb)}static xol(){Sa.FLa||(Sa.FLa={},Sa.FLa.M=1E3,Sa.FLa.D=500,Sa.FLa.C=100,Sa.FLa.L=50,Sa.FLa.X=10,Sa.FLa.V=5,Sa.FLa.I=1)}static qcn(bb){if(!bb)return 0;Sa.xol();bb=e.a.BA(bb);
let nb=0,Va=0;for(let Ab=bb.length-1;0<=Ab;Ab--){const Zb=Sa.FLa[e.a.charAt(bb,Ab).toString()];Va=Zb<nb?Va-Zb:Va+Zb;nb=Zb}return Va}}Sa.FLa=null;Sa.T0f=["M{1,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(CM|CD|DC{0,3}|C{1,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(XC|XL|LX{0,3}|X{1,3})(IX|IV|V?I{0,3})","(IX|IV|VI{0,3}|I{1,3})"].map(bb=>`\\(?(${bb})[\\.\\)\\-]`);Object(D.a)(Sa,"RomanListAction",Ha,[]);var ab=c(42);class Hb extends Pa.a{constructor(bb,nb,Va,Ab,Zb,Kb){super(bb,nb,Va,Va+1,Kb);this.mgk=
Ab;this.NMg=Zb;this.VXc=!1}get vC(){return!1}get commandId(){return F.a.xBk}gBb(bb){bb.innerText=e.a.substring(bb.innerText,0,this.kG)+this.NMg+e.a.right(bb.innerText,this.I_)}$la(bb){this.Jd.replaceTextRange(E.a.createTextRange(bb,this.kG,this.I_),this.mgk,!0,!1);this.Jd.replaceTextRange(E.a.createTextRange(bb,this.kG,this.kG+1),this.NMg,!0,!1)}set vC(bb){super.vC=bb}static LF(bb,nb,Va,Ab,Zb,Kb){if("'"!==Va&&'"'!==Va)return null;var dc=ba.GraphIterator.$a(bb);dc.yd();ta.OutlineElementNavigator.Zd(dc);
if(ab.OutlineElementReader.Mm(dc.currentNode))return null;Ab=!nb||e.a.sba(Ab)||-1!==Array.indexOf(Hb.Bpn,Ab);dc="'"===Va;return new Hb(Kb,bb,nb,Va+"",Ab?dc?"\u2018":"\u201c":dc?"\u2019":"\u201d",Zb)}}Hb.Bpn=["[","{","("];Object(D.a)(Hb,"SmartQuoteCorrectAction",Pa.a,[]);class pb extends Pa.a{constructor(bb,nb,Va,Ab,Zb,Kb){super(bb,nb,Va,Ab,Kb);this.MMg=Zb}get vC(){return pb.buc}set vC(bb){pb.buc=bb}get commandId(){return F.a.yBk}FCj(){this.tmd=this.xzh();this.tmd||(this.P0g=!1,this.IWg="MatchTextIsNotTheSame")}gBb(bb){bb.innerText=
e.a.substring(bb.innerText,0,this.kG)+this.MMg+e.a.right(bb.innerText,this.I_)}$la(bb){this.Jd.replaceTextRange(E.a.createTextRange(bb,this.kG,this.I_),this.MMg,!0,!1)}static eT(bb,nb,Va,Ab,Zb){const Kb=ra.a(bb);return new pb(bb,Kb?Kb.Cb:null,nb,Va,Ab,Zb)}static LF(bb,nb,Va,Ab,Zb){return new pb(null,bb,nb,Va,Ab,Zb)}}pb.buc=!1;Object(D.a)(pb,"StringReplaceCorrectAction",Pa.a,[]);class Mb extends Pa.a{constructor(bb,nb,Va,Ab,Zb,Kb,dc,jc){super(bb,nb,Va,Ab,Zb);this.Fk=Kb;this.U1j=dc;this.fD=jc}get vC(){return!0}get commandId(){return F.a.zBk}gBb(bb){let nb=
e.a.substring(bb.innerText,this.kG,this.I_);nb.charAt(0)!==nb.charAt(0).toUpperCase()&&(nb=nb.charAt(0).toUpperCase()+nb.substring(1,nb.length));bb.innerText=e.a.substring(bb.innerText,0,this.kG)+nb+e.a.right(bb.innerText,this.I_)}$la(bb){const nb=this.kG,Va=this.kG+1,Ab=bb.characterData.substring(nb,Va).charAt(0);if(!e.a.Iac(Ab)){const Zb=E.a.createTextRange(bb,nb,Va);this.Szm(Zb)||this.fD&&this.fD.KUc(bb,nb,Va)||this.Jd.replaceTextRange(Zb,Ab.toUpperCase().toString(),!0,!1)}}Szm(bb){return this.U1j?
!!this.Fk&&this.Fk.i8(bb):!1}set vC(bb){super.vC=bb}static eT(bb,nb,Va,Ab){const Zb=ra.a(bb);return new Mb(bb,Zb?Zb.Cb:null,nb,Va,Ab,null,!1,null)}static LF(bb,nb,Va,Ab,Zb,Kb){return new Mb(null,bb,nb,Va,Ab,Zb,!0,Kb)}}Object(D.a)(Mb,"UpperFirstLetterAutoCorrectAction",Pa.a,[]);class Qb{constructor(bb,nb){this.Juc=nb;this.sF=bb}BUo(){const bb=Number.parseInvariant(this.sF.substring(0,this.sF.length-2));switch(Number.parseInvariant(this.sF.charAt(this.sF.length-3).toString())){case 1:return 11===bb?
"th":"st";case 2:return 12===bb?"th":"nd";case 3:return 13===bb?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}SGm(){var bb=l.a.lg(this.Juc);if(!bb||!bb.name.toLowerCase().startsWith("en")||!this.sF||2>=this.sF.length)return!1;for(bb=0;bb<Qb.tRd().length;bb++)if(this.sF.toLowerCase().endsWith(Qb.tRd()[bb])){if(RegExp("^\\d+$").test(this.sF.substr(0,this.sF.length-2))){const nb=this.BUo();if(this.sF.toLowerCase().endsWith(Qb.tRd()[bb])&&nb===Qb.tRd()[bb])return!0}break}return!1}static tRd(){return Qb.r6g||
(Qb.r6g=["st","nd","rd","th"])}}Qb.r6g=null;Object(D.a)(Qb,"ValidateOrdinalsRule",null,[]);c.d(L,"a",function(){return Aa});class Aa{constructor(bb,nb,Va,Ab,Zb,Kb,dc){this.yyc=[];this.vRb=[];this.Nnc=[];this.xre=new Set;this.H$a=-1;this.BVg=this.Tda=!1;this.o_j=bb;this.Jd=nb;this.Fk=Va;this.ga=Ab;this.jV=Kb;this.fD=dc;Zb?(this.Tda=Zb.$("ReplaceQuoteWithSmartQuoteIsEnabled"),this.BVg=Zb.$("HyperlinkUrlValidationIsEnabled"),m.ULS.sendTraceTag(23418953,324,50,"{0}",{["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.Tda})):
(m.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.Tda=!1)}Dib(bb){return 0<=Aa.y0e.indexOf(bb)}qEf(bb){return 0<=Aa.z0e.indexOf(bb)}VBf(bb){return bb.toLowerCase()===bb}Iac(bb){return bb.toUpperCase()===bb}OVd(bb){return bb.toLowerCase()!==bb.toUpperCase()}pCm(bb,nb,Va,Ab){return(new ya(bb,nb,Va,Ab)).fOk()}fLl(bb){do{if(bb.getAttribute("xml:lang"))return l.a.lg(bb.getAttribute("xml:lang"))||l.a.ORc;if(bb.getAttribute("lang"))return l.a.lg(bb.getAttribute("lang"))||
l.a.ORc;bb=bb.parentNode}while(bb&&1===bb.nodeType);return l.a.ORc}Nmf(bb){return l.a.lg(v.FormattingReader.language(v.FormattingReader.Ar(bb)))||l.a.ORc}JKd(bb,nb){0>nb&&(nb=0);let Va=-1;const Ab=Aa.y0e.length;for(let Zb=0;Zb<Ab;++Zb){const Kb=bb.lastIndexOf(e.a.charAt(Aa.y0e,Zb),nb);Kb>Va&&(Va=Kb)}bb=e.a.U2a(bb,nb);bb>Va&&(Va=bb);return Va}Rul(bb){for(let nb=0;nb<bb.length;++nb)if(this.OVd(e.a.charAt(bb,nb)))return nb;return-1}gif(bb,nb){if(!bb||0>nb)return-1;let Va=nb;Va=Va?this.JKd(bb,Va-1):-1;
Va=Va>e.a.U2a(bb,nb-1)?Va:e.a.U2a(bb,nb-1);Va++;return Va}DWh(bb,nb,Va){this.GJc(nb);if(!this.vRb[nb]){nb=I.B4h(nb);if(0>=nb)return null;this.GJc(nb);if(!this.vRb[nb])return null}if(Va&&this.Nnc[nb]&&Array.contains(this.Nnc[nb],bb+Va))return null;Va=this.vRb[nb][e.a.fh(bb)];if("string"!==typeof Va||Va===bb||!Va)return null;var Ab=this.Rul(bb);if(0>Ab||this.VBf(e.a.charAt(bb,Ab)))return Va;nb=!0;for(Ab+=1;Ab<bb.length;++Ab){const Zb=e.a.charAt(bb,Ab);nb&&!this.Iac(Zb)&&(nb=!1)}return nb?null:e.a.BA(e.a.substring(Va,
0,1))+e.a.right(Va,1)}dvl(bb,nb,Va,Ab){a.a.mark(4666);const Zb=this.fLl(nb).LCID;let Kb=0,dc=bb;const jc=nb.innerText;if(this.DAf(jc.substring(jc.lastIndexOf(" ",bb)+1,bb)))return a.a.mark(4667),null;let zb=null;var cc=!1;do{dc=dc?this.JKd(jc,dc-1):-1;if(-1===dc&&!Va){cc=nb;var Ub=null;if(!this.Dib(jc.charAt(0))){do{for(;cc&&!cc.previousSibling;)cc=cc.parentNode;cc&&(cc=cc.previousSibling,Ub=cc.innerText)}while(cc&&!Ub);if(cc&&Ub&&!this.Dib(e.a.charAt(Ub,Ub.length-1)))return a.a.mark(4667),null}cc=
!0}Ub=e.a.substring(jc,dc+1,bb);++Kb;var Wb=this.DWh(Ub,Zb,Ab.toString());if(Wb)zb=pb.eT(nb,dc+1,bb,Wb,this.Jd),Aa.IHf();else for(const Qa of this.yyc)if(!(Qa.flags&1&&!(Va&&1>dc)||Qa.flags&4||Qa.flags&2&&" "!==Ab)&&(Wb=Qa.pattern.exec(Ub))){zb=Qa.Ulm(nb,dc+1,bb,Wb,this.Jd,this.ga);break}}while(!cc&&!zb&&Kb<Aa.IGi&&0<=dc);a.a.mark(4667);return zb}bvl(bb,nb,Va){const Ab=bb.node;let Zb=M.ParagraphReader.text(Ab);0>nb&&(nb=bb.cpBegin);bb=this.Nmf(bb).LCID;if(this.DAf(Zb.substring(e.a.U2a(Zb,nb)+1,nb)))return null;
var Kb=-1,dc=N.HyperlinkReader.jNc(Ab);for(var jc=0;jc<dc.length;jc++)if(nb>dc[jc].cpEnd)Kb=dc[jc].cpEnd;else{if(nb>dc[jc].cpBegin)return null;break}dc=null;jc=(jc=nb)?this.JKd(Zb,jc-1):-1;jc<Kb&&(jc=Kb-1);Kb=e.a.substring(Zb,jc+1,nb);Kb=Kb.trimStart();if(1>jc)for(const zb of this.yyc){let cc=Zb;" "!==Va&&(cc=Zb+Va);if(zb.pattern.exec(cc))return null}Zb=Zb.substring(0,nb);if(!this.pCm(Zb,Va.toString(),Kb,bb))return null;Kb.charAt(0).toUpperCase()!==Kb.charAt(0)&&(dc=Mb.LF(Ab,jc+1,nb,this.Jd,this.Fk,
this.fD));return dc}cWh(bb,nb,Va){bb=P.SelectionFactory.Yn(bb,!1);if(!bb)return null;bb=bb.Rc;return H.SelectionEditor.jf(bb)?this.bvl(bb,nb,Va):null}DAf(bb){return e.a.eU(bb)}Nhf(bb,nb,Va,Ab){a.a.mark(4666);const Zb=bb.node,Kb=this.Nmf(bb).LCID,dc=M.ParagraphReader.text(Zb);0>nb&&(nb=bb.cpBegin);if(Va&&!this.Dib(e.a.charAt(dc,nb))||this.DAf(dc.substring(e.a.U2a(dc,nb)+1,nb)))return a.a.mark(4667),null;bb=-1;Va=N.HyperlinkReader.jNc(Zb);for(var jc=0;jc<Va.length;jc++)if(nb>Va[jc].cpEnd)bb=Va[jc].cpEnd;
else{if(nb>Va[jc].cpBegin)return null;break}Va=0;jc=nb;let zb=null;do{jc=jc?this.JKd(dc,jc-1):-1;jc<bb&&(jc=bb-1);const Ub=e.a.substring(dc,jc+1,nb);++Va;var cc=null;let Wb=!1;if(J.a.VPh){const Qa=dc+String.fromCharCode(Ab);Wb=this.yyc.some(sb=>sb.pattern.exec(Qa))}Wb||(cc=this.DWh(Ub,Kb,null));if(cc)this.jV.URa&&(zb=pb.LF(Zb,jc+1,nb,cc,this.Jd),Aa.IHf());else for(const Qa of this.yyc)if(!(Qa.flags&1&&-1!==jc||Qa.flags&4&&Ab!==k.a.ks||Qa.flags&2&&Ab!==k.a.rIa)&&(cc=Qa.pattern.exec(Ub))){zb=Qa.Ecm(Zb,
jc+1,nb,cc,this.Jd,this.ga);if(zb.commandId!==F.a.x0e&&!this.jV.URa||zb.commandId===F.a.x0e&&!this.jV.h3c)zb=null;break}}while(0<=jc&&jc>=bb&&!zb&&Va<Aa.IGi);a.a.mark(4667);return zb}bWh(bb,nb,Va){bb=P.SelectionFactory.Yn(bb,!1);if(!bb)return null;bb=bb.Rc;return H.SelectionEditor.jf(bb)?this.Nhf(bb,nb,!1,Va):null}jWh(bb,nb){var Va=P.SelectionFactory.Yn(bb,!1);if(!Va)return null;let Ab=Va.Rc;Va.Sx&&Va.Rc.contextId!==z.a.endOfParagraph&&0<=nb&&(Ab=E.a.Tc(bb,nb));if(!H.SelectionEditor.jf(Ab)||N.HyperlinkReader.awa(Ab,
!1))return null;Va=M.ParagraphReader.text(Ab.node);bb=0<nb?e.a.U2a(Va,nb-1)+1:e.a.U2a(Va,Va.length-1)+1;nb=0<nb?nb:Va.length;Va=e.a.substring(Va,bb,nb);return!Va||this.BVg&&!N.HyperlinkReader.I2a(Va)||!e.a.eU(Va)&&!e.a.ySc(Va)||!Aa.hyperlinkEditor.JTn(Ab,bb,nb)?null:this.o_j.c4k(Ab.node,bb,nb)}oWh(bb,nb){var Va=P.SelectionFactory.Yn(bb,!1);if(!Va)return null;var Ab=Va.Rc;if(!H.SelectionEditor.jf(Ab))return null;0>nb&&(nb=Ab.cpBegin);var Zb=M.ParagraphReader.text(Ab.node);Va=this.gif(Zb,nb);const Kb=
Aa.z0e.length;for(let dc=0;dc<Kb;++dc){const jc=Zb.lastIndexOf(e.a.charAt(Aa.z0e,dc),nb-1);jc>Va&&(Va=jc+1)}Zb=e.a.substring(Zb,Va,nb);if(!Zb)return null;Ab=this.Nmf(Ab).LCID;return(new Qb(Zb,Ab)).SGm()?jb.LF(bb,Va,nb,this.Jd):null}ZVh(bb,nb){var Va=P.SelectionFactory.Yn(bb,!1);if(!Va)return null;Va=Va.Rc;if(!H.SelectionEditor.jf(Va))return null;0>nb&&(nb=Va.cpBegin);var Ab=M.ParagraphReader.text(Va.node);Va=this.gif(Ab,nb);Ab=e.a.substring(Ab,Va,nb);return Ab?(Ab=(new Oa(Ab)).CAl())?fa.LF(bb,Va,
nb,Ab,this.Jd):null:null}bwl(bb,nb,Va,Ab,Zb){var Kb=P.SelectionFactory.Yn(bb,!1);if(!Kb)return null;Kb=Kb.Rc;if(Va>nb||!H.SelectionEditor.jf(Kb))return null;0>nb&&(nb=Kb.cpBegin);if(0>nb)return null;Kb=M.ParagraphReader.text(Kb.node);return Hb.LF(bb,Va,Zb,nb?Kb.charAt(nb-1):"\x00",this.Jd,Ab)}byb(bb,nb,Va,Ab){this.yyc.push(new Xa(`^${bb}$`,nb,Va,Ab))}lKf(bb){if(this.vRb[this.H$a]){const nb=this.vRb[this.H$a];for(const Va in bb)nb[Va]=bb[Va]}else this.vRb[this.H$a]=bb}qKf(bb){this.Nnc[this.H$a]?this.Nnc[this.H$a].push(...(bb||
[])):this.Nnc[this.H$a]=bb}sSm(bb,nb){var Va;this.xre.has(nb)||(this.xre.add(nb),null===(Va=x.AFrameworkApplication.Ke)||void 0===Va?void 0:Va.oj(bb,1,null,null,!1,3,Ab=>{this.H$a=nb;try{Object(u.a)(Ab.data.we)}catch(Zb){m.ULS.sendTraceTag(5898336,324,50,"Failed to parse autocorrect: {0}",{["ResponseData"]:Ab.data?Ab.data.we:""})}this.H$a=-1},()=>{this.Hnl(nb)},null,void 0,void 0,void 0,void 0,"27"))}Hnl(bb){bb=I.B4h(bb);0<bb&&this.GJc(bb)}static get TBk(){return null!=Aa.Osg?Aa.Osg:Aa.Osg=(()=>Aa.wsh.map(([bb,
...nb])=>(new Xa(`^${bb}`,...nb)).pattern))()}static get wsh(){return null!=Aa.Psg?Aa.Psg:Aa.Psg=(()=>[...wa.T0f.map(bb=>[bb,wa.eT,wa.LF,3]),["\\(?(\\d+)[\\.\\)\\-]",eb.eT,eb.LF,3],["\\(?(L|l|C|c|D|d|M|m){1}[\\.\\)\\-]",Ca.eT,Ca.LF,3],...Sa.T0f.map(bb=>[bb,Sa.eT,Sa.LF,11]),["\\(?([A-Za-z]){1}[\\.\\)\\-]",Ca.eT,Ca.LF,3]])()}BSm(){this.GJc(1033);this.byb("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ya.eT,Ya.LF,5);this.byb("=rand\\.old\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ya.eT,Ya.LF,5);this.byb("=lorem\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",
Ya.eT,Ya.LF,5);Aa.wsh.forEach(bb=>this.byb(...bb));this.byb("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",pa.eT,pa.LF,0);this.byb("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",Ma.eT,Ma.LF,0);this.byb("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",Ma.eT,Ma.LF,0)}GJc(bb){this.xre.has(bb)||this.sSm(K.a.VEk(String.format("Acl/Acl{0}.js",bb)),bb)}static IHf(){y.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(bb=>{bb.logActivity("AutocorrectStringMatch",null)})}static get hyperlinkEditor(){return null!=
Aa.pxg?Aa.pxg:Aa.pxg=y.a.instance.resolve("Box4.IHyperlinkEditor")}}Aa.y0e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";Aa.z0e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Aa.t7f=".!?";Aa.IGi=5;Object(D.a)(Aa,"AutoCorrectRules",null,[418])},1634:function(D,L,c){D=c(0);var l=c(34),e=c(8),a=c(494),k=c(583),x=c(46),y=c(2),m=c(29);const u=(Y,da,ba)=>{if(Y){var ja=0;do{try{Y();break}catch(sa){if(e.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",
ja,ba,sa.message,sa.stack),ja>=da)break}ja++}while(1)}};var z=c(79),v=c(23),E=c(192),F=c(186),J=c(45),K=c(294),H=c(15),P=c(118);class N{constructor(Y,da,ba,ja,sa,ta,ra,ma,Ba=!0,Pa=null,Da=!1){this.BVh="FileUpload.ashx";this._iframe=null;this._initialized=!1;this.xl=this.Mrc=this.Eye=this.SXa=this.mhd=this.bE=this._form=null;this.Gh=!1;this.Ay=this.nhd=this.rcb=null;this._parent=Y;this.i0j=da;this.uak=ba;this.OSg=sa;this.WAa=ra;this.aHg=ma;this.zKg=Pa;this.AUe=!1;this.g1j=ja.$("CanaryRenewalForFileUploadIsEnabled");
this.fTo=!1;(this.Mab=Da)||this.q1k(ta);Ba&&this.Tmi()}get O8i(){return this.uak}get sessionId(){return this.WAa}get iFrame(){return this._iframe}get rT(){return this.bE}get QIb(){return y.AFrameworkApplication.K?y.AFrameworkApplication.K.$("NativeFileOpenDialogIsEnabled"):!1}get vVh(){return y.AFrameworkApplication.K?y.AFrameworkApplication.K.$("FileInputDescriptionAccessibilityIsEnabled"):!1}get vFm(){return this.Mab?!1:F.b(this._iframe.contentWindow.location.pathname,this.BVh,0)}get Iuk(){return!H.a.Hna&&
y.AFrameworkApplication.K.$("AllowMultipleImageInsertFromLocalDevice")}Tmi(){this.Ay=P.a.create().toString();this.Mab?this.Cff():this.xwk()}q1k(Y){this._iframe=document.createElement("iframe");this._iframe.className=Y;this._iframe.id=Y;this.OSg&&(this._iframe.style.visibility="visible",this._iframe.style.height="30px",this._iframe.setAttribute("frameborder","0"));this.SXa=Object(x.a)(this,this.FTf,"onUploadFrameLoad");m.a.addHandler(this._iframe,"load",this.SXa)}GHd(Y=null){y.AFrameworkApplication.ta.f9d();
if(!this.bE)return e.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";m.a.addHandler(this.bE,"change",()=>{this.qtl(Y)});u(Object(x.a)(this,this.uVh,"fileInputClick"),1,"DoFileOpenDialog");return this.bE.value}qtl(Y){Y&&Y(this.bE.value)}stl(){this.mhd&&(this.mhd.innerText=this.P6h())}IPn(Y){m.a.addHandler(this.bE,"change",()=>{Y(this.P6h())})}P6h(){let Y=null;if(this.bE.value){const da=this.bE.value,ba=da.lastIndexOf("\\");0<ba&&(Y=da.substring(ba+1,da.length))}return Y?Y:""}uVh(){try{e.ULS.sendTraceTag(35939520,
322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.bE.click()}catch(Y){throw e.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",Y.message),Y;}}V7c(){this.PJm()?this.eqj():(this.Rjg(),this._form.submit())}PJm(){return(this.g1j||this.Mab)&&!(void 0===window.self.FormData||null===window.self.FormData)}Qcj(Y){if(Y){const da=this.tGh();this.xl=new XMLHttpRequest;this.xl.open("POST",da);this.xl.setRequestHeader("X-CorrelationId",this.Ay);this.BXm(Y);
this.xl.onreadystatechange=Object(x.a)(this,this.Fya,"uploadResponseReceived");this.xl.send(Y)}}BXm(Y){if(!H.a.Hna&&Y.get){var da=Y.get("ImageId");Y=window.self.navigator;da={["CorrelationId"]:this.Ay,["Canary"]:y.AFrameworkApplication.canary,["ImageNodeId"]:da};Y&&(Y=Y.connection?Y.connection:Y.mozConnection?Y.mozConnection:Y.webkitConnection?Y.webkitConnection:null)&&(da.effectiveType=Y.effectiveType,da.downlink=Y.downlink,da.type=Y.type,da.rtt=Y.rtt);e.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",
da)}}eqj(){try{this.Rjg();e.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const Y=new (Type.parse("FormData"))(this._form);this.Qcj(Y)}catch(Y){e.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+Y.message),this.aec(null)}}dqj(Y){try{if(this.Rjg(),e.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.LUo(Y)){this.nhd=Y;this._form.contains(this.bE)&&
this._form.removeChild(this.bE);var da=new (Type.parse("FormData"))(this._form);da.append("applicationfileInput",Y.blob,Y.filename);this.Qcj(da)}else this.aec(null)}catch(ba){e.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+ba.message),this.aec(null)}}LUo(Y){return Y&&void 0!==Y.blob&&null!==Y.blob&&void 0!==Y.filename&&null!==Y.filename&&""!==Y.filename?void 0===window.self.FormData||null===window.self.FormData?(e.ULS.sendTraceTag(578380442,322,
10,"FormData isn't supported"),!1):!0:(Y=Y?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===Y.blob||null===Y.blob,void 0===Y.filename||null===Y.filename||""===Y.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",e.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",Y)),!1)}Fya(){if(4===this.xl.readyState)if(200===this.xl.status){e.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",
this.Ay);const Y=this.xl.getResponseHeader("X-NewKey"),da=this.Iym(this.xl);let ba=!1;if(void 0!==Y&&null!==Y&&da&&(ba=this.wUo(Y),!this.AUe&&ba)){e.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.Ay);this.AUe=!0;this.qFd();void 0!==this.nhd&&null!==this.nhd?this.dqj(this.nhd):this.eqj();return}e.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",
this.AUe,da,!(void 0===Y||null===Y),ba,this.Ay);this.aec(this.xl.responseText)}else e.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.xl.status,this.xl.responseText?!1:!0,this.Ay),this.aec(null)}Iym(Y){try{const da=l.a(Y.responseText).Responses;if(void 0!==da&&null!==da&&1===da.length){const ba=da[0];if(void 0!==ba&&null!==ba&&2===ba.length&&28===ba[1].StatusCode)return!0}}catch(da){}return!1}wUo(Y){K.a.Cig(Y);return y.AFrameworkApplication.canary!==
Y?!1:!0}Rjg(){this.rcb||(this.rcb=new Date)}dispose(){this.Gh||(this.Mab?this._parent.removeChild(this._form):(this._parent.removeChild(this._iframe),m.a.removeHandler(this._iframe,"load",this.SXa),this.SXa=null),this.Eye&&(m.a.removeHandler(this.bE,"change",this.Eye),this.Eye=null),this.vVh&&(this.Mrc&&(m.a.removeHandler(this.bE,"change",this.Mrc),this.Mrc=null),this.mhd=null),this.bE=this._form=this._parent=this._iframe=null,this.Gh=!0,this.rcb=null,e.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}J2b(Y,
da){if(this._form){var ba;(ba=this._form.querySelector("input[name="+Y+"]"))?ba.value=da:(ba=this.A9e(),ba.type="hidden",ba.id=Y,ba.name=Y,ba.value=da,this._form.appendChild(ba))}}A9e(){return this.Mab?document.createElement("input"):this._iframe.contentWindow.document.createElement("input")}FTf(){try{if(!this._iframe.contentWindow.document.body)return}catch(da){this.sPc();return}if(!(this._initialized||this.QIb&&H.a.wH))this.Cff();else if(!this.QIb||!H.a.wH||this.vFm){let da;da=H.a.jt?this._iframe.contentWindow.document.body.innerText:
this.fTo?this._iframe.contentWindow.document.body.firstChild.innerText:this._iframe.contentWindow.document.body.firstChild.innerHTML;var Y=this._iframe.contentWindow.document.body.innerText.toLowerCase();const ba=0<=Y.indexOf("responses")||0<=Y.indexOf("wopisrc");Y=0<=Y.indexOf("http error");!ba&&Y&&e.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this._iframe.contentWindow.document.body.innerText);this.aec(da)}}Cff(){if(!this._initialized){var Y=this.uD("uploadForm");
const da=this.uD("fileInput"),ba=this.tGh();this.C3k();this._form.id=Y;this._form.method="post";this._form.encoding="multipart/form-data";this._form.action=ba;this.bE.type="file";this.aHg&&(this.bE.accept=this.aHg,this.zKg&&(this.bE.capture=this.zKg));this.bE.id=da;this.bE.name=da;this.Iuk&&(this.bE.multiple=!0);!this.vVh||H.a.jt||H.a.Rt||(this.Mrc=Object(x.a)(this,this.stl,"fileInputChangedHandleAccessibility"),m.a.addHandler(this.bE,"change",this.Mrc),this.mhd=v.a.dph(this._form,this.bE,"InputFileDescription"));
this.OSg&&(this.Mab||(Y=this._iframe.contentWindow.document.body,Y.style.margin="0",Y.style.overflow="hidden"),Y=y.AFrameworkApplication.ta,this.bE.style.fontFamily=Y.zya,this.bE.style.fontSize=Y.Thg,this.bE.style.margin="0");(Y=document.getElementById("__REQUESTDIGEST"))&&this.J2b("__REQUESTDIGEST",Y.value);this.qFd();this._form.appendChild(this.bE);this._initialized=!0;this.i0j(this)}}C3k(){if(this.Mab)this._form=document.createElement("form"),this._parent.appendChild(this._form),this.bE=document.createElement("input");
else{this._form=this._iframe.contentWindow.document.createElement("form");const Y=this._iframe.contentWindow.document;Y.body.appendChild(this._form);this.bE=Y.createElement("input")}}xwk(){this._parent.appendChild(this._iframe);this.QIb&&H.a.wH&&this.Cff()}tGh(){var Y=new E.QueryStringBuilder(this.BVh);y.AFrameworkApplication.mea(Y);this.L9n(Y);Y=Y.toString();if(H.a.jj||H.a.wH||H.a.Rt)Y=J.a.ILc(Y);return Y}Nxd(){const Y=new z.a(2,1,0,Object(x.a)(this,this.delayedDispose,"delayedDispose"),4);y.AFrameworkApplication.oc.Wb(Y)}}
Object(D.a)(N,"UploadFrame",null,[9]);var M=c(16),I=c(269),T=c(11),U=c(1753);class W extends N{constructor(Y,da,ba,ja,sa,ta,ra=null,ma=!1){super(Y,da,ba,ja,sa,"WACUploadFrame",y.AFrameworkApplication.userSessionId,ta,!1,ra,ma)}uD(Y){return T.App.ya.kj(Y)}L9n(Y){I.a.instance.gyb(Y)}qFd(){y.AFrameworkApplication.canary&&this.J2b(a.a.canary,y.AFrameworkApplication.canary);T.App.ya.jb.activeSection.DI&&this.J2b(a.a.DI,T.App.ya.jb.activeSection.DI)}Brf(Y){let da=null,ba;({group:ba}=k.a.H0(Y)).returnValue?
da=ba.Responses[0]:e.ULS.sendTraceTag(41697634,322,10,"Box4UploadFrame.GetServerResponse: unable to deserialize the response");return da}sPc(){e.ULS.sendTraceTag(41697635,322,15,"Box4ImageUploadFrame.HandleUploadError: The response is invalid, falling back on a default unspecified failure response");const Y=new U.a;Y.StatusCode=14;this.O8i(Y);this.Nxd()}aec(Y){Y?(Y=M.a.Qpj(Y),Y=Y.replace(RegExp("&amp;","g"),"&"),(Y=this.Brf(Y))?(this.O8i(Y),this.Nxd()):this.sPc()):this.sPc()}}Object(D.a)(W,"Box4UploadFrame",
N,[]);c.d(L,"a",function(){return V});class V extends W{constructor(Y,da,ba,ja,sa,ta=null,ra=!1){super(Y,da,ba,ja,sa,V.ZCl(),ta,ra);this.Tmi()}static ZCl(){return V.ihh.join(",")+","+V.KUe.join(",")}qFd(){super.qFd();this.J2b(a.a.Dpb,"1");this.J2b(a.a.TPb,"1")}sPc(){super.sPc();e.ULS.sendTraceTag(41697632,322,15,"Box4ImageUploadFrame.HandleUploadError: Falling back on a default Unspecified Failure response")}Brf(Y){const da=super.Brf(Y);if(!da)try{const ba=l.a(Y);k.a.Ujf(ba)}catch(ba){e.ULS.sendTraceTag(41697633,
322,10,"Box4ImageUploadFrame.GetServerResponse: {0}",ba.toString())}return da}}V.ihh=".jpg .jpeg .png .gif .bmp .tif .tiff .jfif".split(" ");V.KUe=[".webp"];Object(D.a)(V,"Box4ImageUploadFrame",W,[])},1636:function(D,L,c){D=c(0);var l=c(118),e=c(60),a=c(381),k=c(59),x=c(3),y=c(1187),m=c(20),u=c(5),z=c(317),v=c(47),E=c(1288),F=c(824),J=c(123),K=c(43),H=c(17),P=c(6),N=c(108),M=c(44),I=c(8),T=c(1847),U=c(692),W=c(1689),V=c(138),Y=c(1542);class da{constructor(ra,ma,Ba,Pa,Da,Ha){this.q4b=this.mH=null;
this.ckf=ma;if(ra[U.a.aPc])this.d_=ra[U.a.aPc],this.XCc=ra[U.a.XCc],this.q4b=Array(4),this.q4b[0]=ra[U.a.cfb],this.q4b[1]=ra[U.a.dfb],this.q4b[2]=ra[U.a.efb],this.q4b[3]=ra[U.a.bfb],this.$Wo=ra[U.a.width],this.ckm=ra[U.a.height],this.rwa=void 0!==ra[U.a.rwa]?"true"===ra[U.a.rwa].toLowerCase():void 0,this.Rs=Ba,this.f4b=Pa;else{ma=ra[U.a.cfb];const oa=ra[U.a.dfb],wa=ra[U.a.efb],ia=ra[U.a.bfb];Ha&&Ha.$("EffectExtentPointsForGraphicsEditorIsEnabled")&&void 0!==ma&&void 0!==oa&&void 0!==wa&&void 0!==
ia?(this.cfb=ma,this.dfb=oa,this.efb=wa,this.bfb=ia):(this.cfb=ra[U.a.left],this.dfb=ra[U.a.right],this.efb=ra[U.a.top],this.bfb=ra[U.a.bottom]);this.width=ra[U.a.width];this.height=ra[U.a.height];this.rotationAngle=ra[U.a.angle];this.Awn=ra[U.a.zwn];this.Rs=Ba;this.f4b=Pa;this.Odb=Da;this.uEa=2;this.flipH=this.hX(ra,U.a.flipH);this.flipV=this.hX(ra,U.a.flipV);this.$an();this.ENo()}}ENo(){this.mH||(this.mH=Array(4),this.mH[0]=V.a.WF(this.cfb),this.mH[1]=V.a.WF(this.dfb),this.mH[2]=V.a.WF(this.efb),
this.mH[3]=V.a.WF(this.bfb))}$an(){var ra=Y.c(this.rotationAngle);if(45<=ra&&135>=ra||225<=ra&&315>=ra){ra=this.width/2;const ma=this.height/2;this.cfb-=ra-ma;this.dfb+=ra-ma;this.efb-=ma-ra;this.bfb+=ma-ra}}hX(ra,ma){if(ra.hasOwnProperty(ma))return ra[ma]}}Object(D.a)(da,"JsonToDocumentXmlResponseCommonParams",null,[]);class ba extends da{constructor(ra,ma,Ba,Pa,Da,Ha){super(ra,ma,Ba,Pa,Da,Ha);this.Wuk="string"===typeof ra[U.a.$yd]?ra[U.a.$yd]:null;this.W4b="string"===typeof ra[U.a.W4b]?ra[U.a.W4b]:
null}}Object(D.a)(ba,"JsonToDocumentXmlResponseDrawingParams",da,[]);var ja=c(545);class sa extends da{constructor(ra,ma,Ba,Pa,Da,Ha){var oa,wa,ia,ca,pa;super(ra,ma,Ba,Pa,Da,Ha);this.sSo=ra[U.a.jwn];this.yYk=ra[U.a.bwn];this.uEa=1;this.yYk||(this.uEa=0,this.mH=ja.a.instance.Fma(V.a.WF(this.width),V.a.WF(this.height),this.rotationAngle));this.cUf=this.hX(ra,U.a.iec);this.j7d=this.hX(ra,U.a.j7d);this.dUf=this.hX(ra,U.a.dUf);this.TDj=this.hX(ra,U.a.SDj);this.hne=this.hX(ra,U.a.hne);this.Clg=this.hX(ra,
U.a.Clg);this.u2c=null!==(oa=this.hX(ra,U.a.u2c))&&void 0!==oa?oa:"";this.extension=ra[U.a.extension];this.aua=null!==(wa=this.hX(ra,U.a.left))&&void 0!==wa?wa:0;this.cua=null!==(ia=this.hX(ra,U.a.top))&&void 0!==ia?ia:0;this.bua=null!==(ca=this.hX(ra,U.a.right))&&void 0!==ca?ca:0;this.$ta=null!==(pa=this.hX(ra,U.a.bottom))&&void 0!==pa?pa:0;this.lockAspectRatio=this.hX(ra,U.a.lockAspectRatio);this.Uth=this.hX(ra,U.a.xha);this.borderStyle=this.hX(ra,U.a.Xoa);this.borderColor=this.hX(ra,U.a.mGa);this.tEk=
void 0!==this.Uth||void 0!==this.borderStyle||void 0!==this.borderColor;this.altTextDescription=this.hX(ra,U.a.altTextDescription);this.alphaModFix=this.hX(ra,U.a.alphaModFix)}}Object(D.a)(sa,"JsonToDocumentXmlResponsePictureParams",da,[]);c.d(L,"a",function(){return ta});class ta{constructor(ra,ma,Ba,Pa,Da,Ha,oa,wa,ia,ca,pa,Ma,ya,Oa,fa,Ca,Ta){this.U9a=this.Owb=null;this.yid=ra;this.Eze=ma;this.IJ=Ba;this.Dm=Pa;this.Nl=Da;this.Ic=Ha;this.yWj=wa;this.QPg=oa;this.Nj=ia;this.ym=ca;this.n9j=pa;this.m9j=
Ma;this.Na=ya;this.kV=Oa;this.jd=fa;this.M1j=Ca;this.P_j=Ta}Goa(ra,ma,Ba,Pa,Da,Ha,oa){Ha.stop();oa?I.ULS.sendTraceTag(575522565,3001,10,ra):I.ULS.sendTraceTag(575522566,3001,10,ra);this.QPg?(Pa=this.Ic.Qc(7,x.a.bPc),Pa.Eb(Ba),this.Na&&this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&ma.Hb.setValue(J.a.ZNa,!1),ma.Hb.setValue(K.a.l_,0),ma.Hb.setValue(H.a.xba,ma.kJk),ma.Hb.setValue(H.a.Jga,ma.iJk),Pa.dispose()):Pa();this.U9a&&this.U9a(ra);Da()}Odc(ra,
ma,Ba,Pa,Da,Ha,oa){I.ULS.sendTraceTag(575522567,3001,50,"GraphicsEditorJsonToDocumentXmlRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:oa.ri});var wa=ra.data.we,ia=null;try{ia=JSON.parse(wa)}catch(pa){this.Goa("Failed to parse incoming JSON blob.",ma,Da,Pa,Ba,oa,!1);return}if(T.a.error in ia)this.Goa("Error code returned from WordGraphicsEditorHandler endpoint: "+ia[T.a.error],ma,Da,Pa,Ba,oa,!1);else{wa=10;var ca=1;try{wa=parseInt(ia[U.a.Rs]),ca=parseInt(ia[U.a.f4b])}catch(pa){this.Goa("Invalid data found in the JSON blob. (i.e. placeholderkind/drawingid)",
ma,Da,Pa,Ba,oa,!1);return}Ba=ra.data.request?y.a.nKc(ra.data.request.get_body()):null;ra=null;ra=ma.Hb;Pa=ma.getId();ma=ra.getValue(P.a.Rs);ma=ma!==wa&&(5===ma||5===wa||this.Ohm(ra,ia));5===wa?(ia=new sa(ia,this.Eze,wa,ca,Ba,this.Na),ra=this.pJl(Da,Ha,ia,ma,ra,Pa)):(ia=new ba(ia,this.Eze,wa,ca,Ba,this.Na),ra=this.oJl(Da,Ha,ia,ma,ra,Pa));ia=this.Ic.Qc(7,x.a.bPc);wa=Da;m.ImageReader.a8(Da)&&ma&&(wa=u.GraphIterator.$a(Da),wa.Ab(12),wa=wa.parentNode);ia.Eb(wa);ra();this.IJ.$Ga(Ha);ia.dispose();if(this.Nl&&
this.Nl!==l.a.nil){const pa=wa.Ei();null===pa||void 0===pa?void 0:pa.contentReplicator.forceOutbound(()=>{I.ULS.sendTraceTag(574358089,3001,50,"Graphical Content Properties Persisted to Box4: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:oa.ri});oa.stop();const Ma=new e.a(this.Nl,1);this.Dm.Y1b(pa,Ma);const ya=this.yid.properties;null!=ya&&Object(z.a)(()=>{const Oa=new v.GraphTransaction(3,x.a.imageRotate);Oa.Eb(Da);ya.setValue(J.a.k4,1);Oa.dispose()})},null,null)}this.Owb&&this.Owb(Da)}}gph(ra,
ma){ra.De(T.a.yWf,"false");ra.De(T.a.ckf,this.Eze);ra.De(T.a.$7e,"0");ra.fK(U.a.Odb,window.self.devicePixelRatio.toString());void 0!==ma&&null!==ma&&(ma=this.ym.Wm(ma.Yj),ma=this.ym.sk(ma),ra.De(U.a.Rs,E.a[ma]));this.M1j&&(ra.De(U.a.jUd,"true"),ra.De(U.a.Lnm,this.P_j.toString()))}Wih(ra){if(this.QPg){ra=ra.Yj;var ma=this.ym.Wm(ra);if(!ma)return null;const Ba=new W.a(this.yWj,ma),Pa=this.Ic.Qc(15,x.a.bPc);Pa.Eb(ra.node);this.UVi(ma,!1);ma.setValue(P.a.Rs,ma.ia(P.a.Rs,10));Pa.kk=x.a.bPc;Pa.zFa(this.Nl,
1);Pa.dispose();return Ba}ma=new a.DictionaryPropertySet;this.UVi(ma,!0);return(ra=this.Nj.$Oh(ra,ma,this.Nl))&&ra.blob?new W.a(ra.blob.id,ra.blob.properties):null}fQd(){return Box4Intl.Box4Strings.l_GraphicsEditorError}UVi(ra,ma){ra.setValue(H.a.xba,k.a.Tl(this.n9j,0));ra.setValue(H.a.Jga,k.a.Tl(this.m9j,1));this.Na&&this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&!ma?ra.setValue(J.a.ZNa,!0):ra.setValue(K.a.l_,1);ra.setValue(N.a.v3,!0)}oJl(ra,
ma,Ba,Pa,Da,Ha){const oa=wa=>{this.yid.cOo(Ba,wa,ra)};return this.OJi(Pa,Da,ra)?this.r2h(ma,Da,Ha,oa):()=>{oa(Da)}}pJl(ra,ma,Ba,Pa,Da,Ha){const oa=wa=>{this.yid.dOo(Ba,wa,ra)};return this.OJi(Pa,Da,ra,Ba)?this.r2h(ma,Da,Ha,oa):()=>oa(Da)}OJi(ra,ma,Ba,Pa){return ra?!0:Pa?m.ImageReader.mPd(ma,Ba.Mc,!1)!==Pa.cUf:!1}r2h(ra,ma,Ba,Pa){const Da=F.a.instance.Abd;Da.Aw(ma);Da.id=Ba;return()=>{this.yid.MXn(ra,Ba,Da,this.kV,Pa)}}sgo(ra){this.Owb=ra}Sao(ra){this.U9a=ra}Ohm(ra,ma){return this.jd.isFeatureEnabled(44)&&
(ra.hasProperty(M.a.d_)&&!ma[U.a.aPc]||!ra.hasProperty(M.a.d_)&&ma[U.a.aPc])?!0:!1}}Object(D.a)(ta,"GraphicsEditorJsonToDocumentXmlRequestHelper",null,[427])},1637:function(D,L,c){D=c(0);var l=c(76),e=c(46),a=c(274),k=c(285);class x{constructor(E,F,J,K=0,H=0,P=null,N=null){this.commandId=E;this.controlId=F;this.timeStamp=J;this.commandSurface=a.a[K];this.ux=k.a[H];this.contentType=P;this.Bje=N}}Object(D.a)(x,"CommandActionInfo",null,[]);class y{constructor(){this.$Nj=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}PMm(E){return!this.$Nj.exec(E)}}
Object(D.a)(y,"EventsCacheLoggingUtils",null,[]);var m=c(2),u=c(1806),z=c(512);c.d(L,"a",function(){return v});class v{constructor(){this.c2g=null;this.GHe=20;this.Qrc=this.ied=this.Med=null}init(){this.c2g=new y;this.Med=new l.a;this.ied=new l.a;this.Qrc=new l.a;this.GHe=m.AFrameworkApplication.K.pc("MaxCommandClickedEventQueueSize",20);u.a.Bqk(Object(e.a)(this,this.EUk,"commandClickEventRaised"));z.a.instance.nmh(Object(e.a)(this,this.sJn,"recordActionEvent"))}ihg(E){E.count>this.GHe&&E.removeAt(this.GHe)}EUk(E,
F){this.Med.insert(0,new x(F.commandId,F.controlId,F.time,F.commandSurface,F.ux,F.contentType));this.ihg(this.Med)}sJn(E,F){this.ied.insert(0,new x(F.actionName,F.controlId,F.timeStamp,F.commandSurface,F.ux,F.contentType,F.Bje));this.ihg(this.ied);this.c2g.PMm(F.actionName)&&(this.Qrc.insert(0,new x(F.actionName,F.controlId,F.timeStamp,F.commandSurface,F.ux,F.contentType,F.Bje)),this.ihg(this.Qrc))}qMc(){return this.Med}hgb(){return this.ied}static get instance(){return v._instance||(v._instance=
new v)}}v._instance=null;Object(D.a)(v,"CommandClickEventsCache",null,[])},1639:function(D,L,c){D=c(0);class l{}Object(D.a)(l,"AuthContext",null,[]);var e=c(2),a=c(601);c.d(L,"a",function(){return k});class k{static getAuthContext(){const x=e.AFrameworkApplication.K.kb("UserPrincipalName")||"";let y=x;e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(y=a.OAuthManagerSettings.Kcn||x);return Object.assign(new l,{upn:x,loginHint:y,authority:a.OAuthManagerSettings.authority,
authorityType:k.sMd(),tenantId:e.AFrameworkApplication.K.kb("TenantId")||""})}static sMd(){let x=0;const y=k.v0h();"aad"===y.toLowerCase()?x=2:"msa"===y.toLowerCase()&&(x=1);return x}static v0h(){return e.AFrameworkApplication.K.kb("HostAuthType")||""}}Object(D.a)(k,"OAuthIdentity",null,[])},1640:function(D,L,c){c.r(L);D=c(0);var l=c(1798),e=c(46),a=c(1800),k=c(482),x=c(1801),y=c(155),m=c(2),u=c(89),z=c(97),v=c(473),E=c(208),F=c(7),J=c(57),K=c(63),H=c(86),P=c(79),N=c(23),M=c(49),I=c(35),T=c(15),U=
c(12);class W{constructor(da){this.H2d=4;this.L8g=0;this.lOg=this.rKg=this.h$g=this.rPg=this.Cah=this.bBa=this.MYb=this.vw=this.Fdh=this.uSg=this.vSg=this.TAa=this.XWa=this.$we=this.aVa=this.UUa=this.W=this.v5=this.oza=null;T.a.Zva&&(this.H2d=6);this.gv=da;this.TY=H.KeyInputManager.mc(K.a.Q0,0);this.render()}get containerElement(){return this.W}dispose(){var da=m.AFrameworkApplication.ta.MC;const ba=m.AFrameworkApplication.ta.NC;da.sc(F.a.click,this.W,Object(e.a)(this,this.fNi,"onContainerClick"));
da.sc(F.a.$A,this.W,Object(e.a)(this,this.gNi,"onContainerDoubleClick"));ba.sc(F.a.sh,this.W,Object(e.a)(this,this.hNi,"onContainerKeyPress"));this.UUa&&(da.sc(F.a.click,this.UUa,Object(e.a)(this,this.MQf,"onDeleteButtonClick")),ba.fpb(this.UUa,this.lOg));this.aVa&&(da.sc(F.a.click,this.aVa,Object(e.a)(this,this.TQf,"onDoneButtonClick")),ba.fpb(this.aVa,this.rPg));this.TAa&&(da.sc(F.a.click,this.TAa,Object(e.a)(this,this.k6d,"onSaveButtonClick")),ba.fpb(this.TAa,this.Cah));this.oza&&(da.sc(F.a.click,
this.oza,Object(e.a)(this,this.lQf,"onCancelButtonClick")),ba.fpb(this.oza,this.rKg));this.XWa&&(da.sc(F.a.click,this.XWa,Object(e.a)(this,this.NSf,"onReplyButtonClick")),ba.fpb(this.XWa,this.h$g));this.vw&&(ba.sc(F.a.St,this.vw,Object(e.a)(this,this.TFa,"onKeyEvent")),ba.sc(F.a.sh,this.vw,Object(e.a)(this,this.TFa,"onKeyEvent")),T.a.si&&(da=m.AFrameworkApplication.ta.hkc,da.sc(F.a.ZFc,this.vw,Object(e.a)(this,this.NFa,"onCompositionEvent")),da.sc(F.a.a2b,this.vw,Object(e.a)(this,this.NFa,"onCompositionEvent")),
da.sc(F.a.b2b,this.vw,Object(e.a)(this,this.NFa,"onCompositionEvent"))),v.a.instance.sc(F.a.paste,this.vw,Object(e.a)(this,this.pZc,"onPaste")));this.bBa=this.MYb=this.vw=this.oza=this.TAa=this.$we=this.aVa=this.XWa=this.UUa=this.W=null}focus(){J.FocusManager.instance().JC(y.AFrame.xr);this.W.focus();this.gv.Jq.cmf().Xj.wy(this.W)}QXh(){J.FocusManager.instance().JC(a.a.PFc);this.vw.focus();this.gv.Jq.cmf().Xj.wy(this.vw);2===this.gv.er&&this.vw.value&&0<this.vw.value.length&&I.a.F4c(this.vw);const da=
this.gv.Jq.Uba.u_c,ba=I.a.G0a(da,this.W);ba.y+this.W.clientHeight>da.scrollTop+da.clientHeight&&(da.scrollTop=ba.y+this.W.clientHeight-da.clientHeight)}ywl(){Sys.UI.DomElement.removeCssClass(this.W,"NewOrEditComment");this.oza.style.display="none";this.vw.style.display="none";J.FocusManager.nhg(this.vw);J.FocusManager.nhg(this.TAa);J.FocusManager.instance().fe(a.a.PFc).Xq(this.TY);J.FocusManager.instance().X4a(a.a.PFc);H.KeyInputManager.instance.sc(F.a.St,this.vw,Object(e.a)(this,this.TFa,"onKeyEvent"));
H.KeyInputManager.instance.sc(F.a.sh,this.vw,Object(e.a)(this,this.TFa,"onKeyEvent"));if(T.a.si){const da=m.AFrameworkApplication.ta.hkc;da.sc(F.a.ZFc,this.vw,Object(e.a)(this,this.NFa,"onCompositionEvent"));da.sc(F.a.a2b,this.vw,Object(e.a)(this,this.NFa,"onCompositionEvent"));da.sc(F.a.b2b,this.vw,Object(e.a)(this,this.NFa,"onCompositionEvent"))}v.a.instance.sc(F.a.paste,this.vw,Object(e.a)(this,this.pZc,"onPaste"));this.v5.removeChild(this.vw);this.v5.removeChild(this.MYb);this.bBa=this.MYb=this.vw=
null;this.zjg();this.v$c();this.focus()}v$c(){this.G6i(this.Fdh,this.vSg,this.uSg,this.$we,this.W)}render(){var da=k.a("a",this.Vga("cc"),"CommentContainer");N.a.Uq(da,N.a.Aea,a.a.TVk);da.tabIndex=0;this.gv.Ff&&(da.className+=" Reply1");var ba=k.a("div",this.Vga("ch"),"CommentHeaderRow");const ja=k.a("span",this.Vga("ca"),"CommentAuthor UIFontBold");ja.innerText=this.gv.author;ba.appendChild(ja);const sa=k.a("span",this.Vga("ct"),"CommentDate");sa.innerText=W.P$k(this.gv.date,this.gv.Jq.O$k,this.gv.Jq.iCo);
Sys.UI.DomElement.addCssClass(sa,m.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight");ba.appendChild(sa);const ta=k.a("span",this.Vga("ci"),"CommentStatusIcon");ba.appendChild(ta);let ra=null;this.gv.UFb&&(ra=x.a.zZa(this.Vga("cl"),a.a.YUk,CommonUIStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(ra,m.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),ra.tabIndex=0,ba.appendChild(ra));this.v5=k.a("div",this.Vga("cn"),"CommentContent");let ma=null,Ba=null,
Pa=null;this.gv.UFb?(ma=k.a("textarea",this.Vga("ce"),a.a.SCh+" UIFont"),ma.rows=this.H2d,ma.cols=50,ma.tabIndex=0,N.a.Uq(ma,"title",CommonUIStrings.l_CommentContent),this.v5.appendChild(ma),Ba=k.a("div","","CommentTextMeasurementContainer"),Pa=k.a("textarea","",a.a.SCh+" UIFont"),Pa.rows=1,Pa.cols=50,Pa.style.visibility="hidden",Pa.spellcheck=!1,Ba.appendChild(Pa),this.v5.appendChild(Ba),2===this.gv.er&&(ma.value=this.gv.text.join("\n")+"\n")):this.zjg();const Da=k.a("div","","CommentFooterRow"),
Ha=k.a("span",this.Vga("cf"),""),oa=x.a.zZa(this.Vga("cr"),a.a.NVk+" CommentFooterButton",CommonUIStrings.l_CommentReplyButton,"CommentReply_16x16x32",!1);oa.tabIndex=0;oa.setAttribute(N.a.oh,N.a.z2);Ha.appendChild(oa);const wa=x.a.zZa(this.Vga("cd"),"CommentDoneButton CommentFooterButton",CommonUIStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",!1);wa.tabIndex=0;const ia=wa.childNodes[0].childNodes[0];Ha.appendChild(wa);const ca=x.a.zZa(this.Vga("cx"),a.a.ZUk+" CommentFooterButton",CommonUIStrings.l_CommentDeleteButton,
"Delete_16x16x32",!1);wa.tabIndex=0;Ha.appendChild(ca);Da.appendChild(Ha);const pa=k.a("span",this.Vga("cfa"),""),Ma=x.a.zZa(this.Vga("cs"),a.a.OVk,CommonUIStrings.l_CommentSaveCommentButton,null);x.a.UMb(Ma,!1);Ma.tabIndex=0;pa.appendChild(Ma);Da.appendChild(pa);this.G6i(ta,Ha,pa,ia,da);this.gv.Jq.UFh||(ja.setAttribute("Unselectable","on"),sa.setAttribute("Unselectable","on"));da.appendChild(ba);da.appendChild(this.v5);da.appendChild(Da);this.W=da;this.aVa=wa;this.$we=ia;this.UUa=ca;this.XWa=oa;
this.TAa=Ma;this.vw=ma;this.MYb=Ba;this.bBa=Pa;this.oza=ra;this.vSg=Ha;this.uSg=pa;this.Fdh=ta;da=m.AFrameworkApplication.ta.MC;ba=m.AFrameworkApplication.ta.NC;da.mb(F.a.click,this.W,Object(e.a)(this,this.fNi,"onContainerClick"));da.mb(F.a.$A,this.W,Object(e.a)(this,this.gNi,"onContainerDoubleClick"));ba.mb(F.a.sh,this.W,Object(e.a)(this,this.hNi,"onContainerKeyPress"));this.aVa&&(da.mb(F.a.click,this.aVa,Object(e.a)(this,this.TQf,"onDoneButtonClick")),this.rPg=ba.qmb(this.aVa,Object(e.a)(this,this.TQf,
"onDoneButtonClick"),K.a.ks));this.XWa&&(da.mb(F.a.click,this.XWa,Object(e.a)(this,this.NSf,"onReplyButtonClick")),this.h$g=ba.qmb(this.XWa,Object(e.a)(this,this.NSf,"onReplyButtonClick"),K.a.ks));this.TAa&&(da.mb(F.a.click,this.TAa,Object(e.a)(this,this.k6d,"onSaveButtonClick")),this.Cah=ba.qmb(this.TAa,Object(e.a)(this,this.k6d,"onSaveButtonClick"),K.a.ks));this.UUa&&(da.mb(F.a.click,this.UUa,Object(e.a)(this,this.MQf,"onDeleteButtonClick")),this.lOg=ba.qmb(this.UUa,Object(e.a)(this,this.MQf,"onDeleteButtonClick"),
K.a.ks));this.oza&&(da.mb(F.a.click,this.oza,Object(e.a)(this,this.lQf,"onCancelButtonClick")),this.rKg=ba.qmb(this.oza,Object(e.a)(this,this.lQf,"onCancelButtonClick"),K.a.ks));ma&&(ba.mb(F.a.St,ma,Object(e.a)(this,this.TFa,"onKeyEvent")),ba.mb(F.a.sh,ma,Object(e.a)(this,this.TFa,"onKeyEvent")),T.a.si&&(da=m.AFrameworkApplication.ta.hkc,da.mb(F.a.ZFc,ma,Object(e.a)(this,this.NFa,"onCompositionEvent"),null),da.mb(F.a.a2b,ma,Object(e.a)(this,this.NFa,"onCompositionEvent"),null),da.mb(F.a.b2b,ma,Object(e.a)(this,
this.NFa,"onCompositionEvent"),null)),v.a.instance.mb(F.a.paste,ma,Object(e.a)(this,this.pZc,"onPaste")),this.Hio())}Fgj(da){x.a.UMb(this.TAa,da)}Vga(da){return da+"_"+this.gv.id}G6i(da,ba,ja,sa,ta){switch(this.gv.kSa){case 0:case 1:this.pmj(da,0);break;case 2:case 4:da.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(ta,"SaveFailure"),Sys.UI.DomElement.addCssClass(ta,"NoReply"),this.pmj(da,1)}this.gv.done?(Sys.UI.DomElement.addCssClass(ta,"CommentIsDone"),sa.className=z.getImageClass("CheckboxChecked_16x16x32")):
(Sys.UI.DomElement.removeCssClass(ta,"CommentIsDone"),sa.className=z.getImageClass("CheckboxUnchecked_16x16x32"));this.gv.UFb?(Sys.UI.DomElement.addCssClass(ta,"NewOrEditComment"),Sys.UI.DomElement.addCssClass(ta,"SelectedComment"),da.style.display="none",ba.style.display="none",ja.style.display="inline",0===this.gv.Jq.mode&&(this.Fgj(!1),x.a.UMb(this.oza,!1))):(1===this.gv.$ha?(Sys.UI.DomElement.addCssClass(ta,"SelectedComment"),Sys.UI.DomElement.removeCssClass(ta,"SelectedParentComment"),ba.style.display=
1!==this.gv.Jq.mode||3===this.gv.kSa||this.gv.K$b?"none":"inline"):(2===this.gv.$ha?(Sys.UI.DomElement.removeCssClass(ta,"SelectedComment"),Sys.UI.DomElement.addCssClass(ta,"SelectedParentComment")):(Sys.UI.DomElement.removeCssClass(ta,"SelectedComment"),Sys.UI.DomElement.removeCssClass(ta,"SelectedParentComment")),ba.style.display="inline"),ja.style.display="none")}pmj(da,ba){M.a.eC(da);switch(ba){case 0:ba=document.createElement("img");ba.alt=CommonUIStrings.l_CommentProgressTooltip;ba.src=u.a.laa("progress16.gif");
da.appendChild(ba);break;case 1:ba=z.createClusteredImage(16,16,"Risks_16x16x32","",!0,CommonUIStrings.l_CommentFailTooltip),da.appendChild(ba)}da.style.display="inline-block"}zjg(){M.a.FZ(this.v5);var da=this.gv.text;1===da.length&&da[0]&&(da=da[0].split("\n"));for(const ba of da)da=k.a("p","","CommentContentPara"),da.innerText=ba||"\u00a0",this.gv.Jq.UFh||da.setAttribute("Unselectable","on"),this.v5.appendChild(da)}Hio(){const da=J.FocusManager.instance().fe(a.a.PFc);da.parent=y.AFrame.xr;E.a.instance.XZb(a.a.PFc,
this.vw);da.bindAction(H.KeyInputManager.mc(K.a.ope,2),U.a.Gg);da.bindAction(this.TY,U.a.q6e);da.bindAction(H.KeyInputManager.mc(K.a.a5,0),U.a.g_a);da.bindAction(H.KeyInputManager.mc(K.a.Uca,0),U.a.g_a);da.Xq(J.FocusManager.instance().dW);da.Xq(J.FocusManager.instance().eW)}fNi(da){if(this.gv.UFb&&da.Ib.target===this.vw)return!0;this.gv.bTf();return!0}gNi(){this.gv.JNi();return!0}hNi(da){let ba=!1;da.Ib.keyCode===K.a.ks&&(0===this.gv.$ha?this.gv.bTf():this.gv.JNi(),ba=!0);return ba}MQf(){if(this.UUa.disabled)return!0;
this.gv.gha();return!0}TQf(){if(this.aVa.disabled)return!0;this.gv.oon();return!0}NSf(){if(this.XWa.disabled)return!0;this.gv.hmn();return!0}k6d(){if(this.TAa.disabled)return!0;this.gv.KJb(this.vw.value);return!0}lQf(){if(this.oza.disabled)return!0;this.gv.nJb();return!0}TFa(da){if(da.Ib.ctrlKey&&da.Ib.keyCode===K.a.ks)return 0<this.vw.value.length&&this.k6d(null),!0;if(da.Ib.keyCode===K.a.Q0)return!0;this.onTextEntered(da.eventName===F.a.St&&da.Ib.charCode===K.a.ks);return!1}NFa(){this.onTextEntered(!1);
return!1}pZc(){const da=new P.a(0,1,0,()=>{this.onTextEntered(!1)},1);m.AFrameworkApplication.oc.Wb(da);return!1}onTextEntered(da){if(0!==this.gv.Jq.mode&&(this.Fgj(0<this.vw.value.length),!T.a.Zva)){this.MYb.clientWidth!==this.vw.clientWidth&&(this.MYb.style.width=this.vw.clientWidth+"px");this.bBa.value=this.vw.value+"___";this.L8g>this.vw.value.length&&(this.bBa.rows=1);for(var ba=0,ja=Number.MAX_VALUE;1<=(ba=this.bBa.scrollHeight-this.bBa.clientHeight)&&ba<ja;)ja=ba,this.bBa.rows++;this.bBa.rows<
this.H2d?this.vw.rows=this.H2d:(da&&this.bBa.rows++,this.vw.rows=this.bBa.rows);this.L8g=this.vw.value.length}}static P$k(da,ba,ja){if(!da||isNaN(da.getDate()))return"";let sa=ja;const ta=new Date;if(ta.getFullYear()!==da.getFullYear()||ta.getMonth()!==da.getMonth()||ta.getDate()!==da.getDate())sa=String.format(CommonUIStrings.l_CommentLongDateFormat,ba,ja);return da.localeFormat(sa)}}Object(D.a)(W,"CommentViewObject",null,[9,1226]);var V=c(118);c.d(L,"Comment",function(){return Y});class Y{constructor(da,
ba,ja,sa,ta,ra,ma,Ba,Pa=!1,Da=null,Ha=null,oa=null){this.THg=this.UHg=this.MPg=null;this.Csd=0;this.Cbb=2;this.uza=0;this.ixe=this.tN=null;this.gCf=!1;this.objectId=null;this.K$b=!1;this._id=da;this.VTg=ba;this.GIg=ja;this.Ifd=sa;this.urd=ta;this.AJa=ra;this.TV=ma;this.TTg=Ba;this.BEh=Pa;this.kQj=Da;this.lQj=Ha;this.usersByReactionType=oa;this.ej=l.a.instance}get id(){return this._id}set id(da){this._id=da}get author(){return this.BYd?CommonUIStrings.l_RemovedAuthorName:this.GIg}get authorId(){return this.kQj}get l0b(){return this.lQj}get date(){return this.BYd?
null:this.Ifd}set date(da){this.Ifd=da}get done(){return this.AJa}set done(da){this.AJa!==da&&(this.AJa=da,this.tN&&this.tN.v$c())}get Mgi(){return this.TTg}set Mgi(da){this.TTg=da}get Ff(){return this.urd}set Ff(da){this.urd=da}get text(){return this.TV}set text(da){this.TV=da;this.tN&&this.tN.zjg()}get LOa(){return this.VTg}set LOa(da){this.VTg=da}get l_a(){return this.MPg}set l_a(da){this.MPg=da}get aDc(){return this.UHg}set aDc(da){this.UHg=da}get $Cc(){return this.THg}set $Cc(da){this.THg=da}get $ha(){return this.Csd}set $ha(da){this.Csd!==
da&&(this.Csd=da,this.tN&&this.tN.v$c())}get kSa(){return this.Cbb}set kSa(da){this.Cbb===da||0===this.Cbb&&2===da||3===this.Cbb||(this.Cbb=da,this.tN&&this.tN.v$c())}get er(){return this.uza}set er(da){if(this.uza!==da){const ba=this.UFb&&0===da;this.uza=da;ba&&this.tN&&this.tN.ywl()}}get UFb(){return 1===this.uza||2===this.uza}get BYd(){return!!this.ej&&this.ej.removePersonalInformation}get containerElement(){return this.tN?this.tN.containerElement:null}get Jq(){return this.ej}get Ty(){return this.ixe}set Ty(da){this.ixe=
da}dispose(){this.tN&&(this.tN.dispose(),this.tN=null)}render(){this.tN=new W(this);return this.tN.containerElement}D3a(){this.tN&&this.tN.v$c()}focus(){this.bTf();this.tN.focus();this.UFb&&this.tN.QXh()}toString(){let da="[null]";this.TV&&0<this.TV.length&&(da=30<this.TV[0].length?this.TV[0].substr(0,30)+"...":this.TV[0]);return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this._id||"[null]",this.GIg||"[null]",this.Ifd?this.Ifd.toString():"[null]",this.urd||"[null]",this.AJa,da)}bTf(){2===
this.Jq.mode||3===this.Jq.mode?this.UFb&&this.tN.QXh():(J.FocusManager.instance().JC(y.AFrame.xr),1!==this.Csd&&this.Jq.selectComment(this._id))}JNi(){this.Jq.sxo&&0===this.uza&&(J.FocusManager.instance().JC(y.AFrame.xr),this.uza=2,this.Cbb=0,this.Jq.editComment(this,null))}ghn(){3===this.Jq.mode&&(J.FocusManager.instance().JC(y.AFrame.xr),this.uza=0,this.Cbb=2,this.Jq.M3e())}gha(){J.FocusManager.instance().JC(y.AFrame.xr);this.Jq.deleteComment(this)}oon(){this.Jq.szb(this,!this.AJa)}hmn(){2!==this.Jq.mode&&
(J.FocusManager.instance().JC(y.AFrame.xr),this.Jq.addReply(this.urd||this._id,null))}KJb(da){J.FocusManager.instance().JC(y.AFrame.xr);this.TV=Array(1);this.TV[0]=da;1===this.uza?this.Jq.Ita(this):this.Jq.Zdb(this)}nJb(){J.FocusManager.instance().JC(y.AFrame.xr);this.Jq.Uba.u_c&&this.Jq.Uba.u_c.focus();1===this.uza?(this.Jq.deleteComment(this),this.Jq.wde(this.Ff)):this.ghn()}static VGh(da,ba,ja,sa){const ta=V.a.create().toString();da=new Y(ta,Y.vdm,da,new Date,ba,!1,[],ja,!1,m.AFrameworkApplication.K.kb("PresenceUserId"),
m.AFrameworkApplication.K.kb("PresenceProvider"));da.uza=1;da.Cbb=0;da.ixe=sa;return da}}Y.vdm=null;Y.UTi=-1;Object(D.a)(Y,"Comment",null,[9,549])},1641:function(D,L,c){var l=c(66);D=c(0);var e=c(1205),a=c(1998),k=c(10),x=c(111),y=c(47),m=c(31),u=c(24),z=c(321),v=c(1091),E=c(940),F=c(60),J=c(2),K=c(776),H=c(15),P=c(63),N=c(398),M=c(600),I=c(16),T=c(18),U=c(8),W=c(399),V=c(858),Y=c(397),da=c(860),ba=c(555),ja=c(1027),sa=c(28);class ta{constructor(){this.eKe=void 0}onKeyPressed(oa){return this.eKe?
this.eKe(oa):!1}setKeyPressHandler(oa){this.eKe=oa}}var ra=c(1437),ma=c(1608),Ba=c(1546),Pa=c(1510);c.d(L,"a",function(){return Ha});var Da;(function(oa){oa[oa.WFj=0]="ArrowDown";oa[oa.XFj=1]="ArrowUp";oa[oa.I0o=2]="ArrowLeft";oa[oa.J0o=3]="ArrowRight";oa[oa.End=4]="End";oa[oa.LHj=5]="Enter";oa[oa.Q1o=6]="Escape";oa[oa.hIj=7]="Home";oa[oa.X3o=8]="Space";oa[oa.Tab=9]="Tab"})(Da||(Da={}));Object(D.b)("KeyIdentifier",Da);class Ha extends E.a{constructor(oa,wa,ia,ca,pa,Ma,ya,Oa,fa,Ca,Ta,eb,jb,ob,Ya,Xa){super();
this.ga=oa;this.Ze=wa;this.Jd=ia;this.qF=ca;this.ib=pa;this.dI=Ma;this.gD=ya;this.g5=Oa;this.UVb=fa;this.mI=Ta;this.dK=eb;this.DAa=jb;this.ROj=ob;this.zm=Ya;this.ed=Xa;this.bdk=0;this.UPe=!1;this.THe=1E3;this.edk=3500;this.wtd="ContextIQSignalId";this.uQe=0;this.$Xg=!0;this.Xla=()=>{this.UVb.reset();this.nWm()};this.aZc=(Sa,ab)=>{for(const Hb of ab.Gj)Sa=Hb.intent,8===Sa.type&&(0<=Hb.LHb?(Sa=Sa.Kb.paragraph,ab=this.zm.wOd(Sa,8,Hb.cpBegin,Hb.cpEnd),1<=ab.count&&ab.J(0)&&(ab=Sa.characterData.indexOf("@",
ab.J(0).begin),this.zm.cig(Sa,Hb.cpBegin,Hb.cpEnd),ab=new e.a(8,ab,ab+1,F.a.create()),this.zm.xQa(Sa,ab))):this.iub.hy(T.a.R7e,!0,void 0,void 0,void 0,void 0))};Ca&&Ca.execute(Sa=>this.gka=Sa);this.iub=new ja.a;this.w_g=new ta;this.getPersonImageUrl=this.getPersonImageUrl.bind(this);this.h_h(!0);this.KZh();this.Jd.hYe(this.aZc);this.ROj.HLb(this);this.xda=[new a.a(Pa.a.Qcb,Pa.a.Qcb)]}onSessionClose(){}onSessionConnect(){this.h_h(!1);this.KZh()}onSessionDisconnect(){}get REb(){return this.xda}static wxi(oa){return Ba.a.ESc(oa)?
oa.isStealth:!1}xPa(oa,wa){return Ba.a.xPa(oa,wa,ba.a.dFc)}HZa(oa,wa){oa=Ba.a.Q5b(oa,!1,ba.a.dFc);if(!oa||!oa.contains(wa))return null;wa=this.Ze.Sua(wa);return Ha.hng()&&Ha.wxi(null===wa||void 0===wa?void 0:wa.content)?Pa.a.Lyd:Pa.a.Qcb}tmb(oa){Ha.obd()&&!this.lv&&(this.lv=oa,this.DAa.sMa((wa,ia)=>{wa=ia.paragraphNode;const ca=ia.Kha;for(const pa of ia.contents)1!=pa.VF&&0!=pa.VF||Ba.a.fuf(pa.element,wa,pa.intents,this.dDc,this.jHa,this.dK,this.lv,ca,!1,ba.a.dFc)}))}KZh(){const oa=J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1),wa=J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQSatoriFlags",!1),ia=J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAddressFlags",!1),ca=J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQTopicFlags",!1),pa=J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQLoopFlags",!1),Ma=Ha.pbd()&&Ha.Ezf?void 0:[Object.assign(new da.CustomProp,{name:"Filter",
value:'{"And":[{"Term":{"PeopleType":"Person"}},{"Term":{"PeopleSubtype":"OrganizationUser"}}]}'})],ya=Object.assign(new V.a,{parentPath:["Signal",da.ClientConfigSignal.getTypeName()],items:[Object.assign(new W.a,{id:"ClientConfigSignal",body:Object.assign(new da.ClientConfigSignal,{timestamp:Date.now(),sessionConfig:Object.assign(new da.SessionConfig,{clientConfig:Object.assign(new da.ClientConfig,{ecc:Object.assign(new da.EccConfig,{enabled:Ha.qbd()||Ha.pbd(),entities:[Object.assign(new da.EccEntityConfig,
{entityType:da.EntityType.People,enabled:!0,queryPrefix:["@"],customProps:Ma}),Object.assign(new da.EccEntityConfig,{entityType:da.EntityType.File,enabled:!0,queryPrefix:["@"]}),Object.assign(new da.EccEntityConfig,{entityType:da.EntityType.Loop,enabled:oa,queryPrefix:["@"]})],bestMatch:Object.assign(new da.BestMatchConfig,{enabled:Ha.gng()}),scopes:Object.assign(new da.ScopeConfig,{enabled:!1})}),flag:Object.assign(new da.FlagConfig,{enabled:Ha.obd(),entities:[Object.assign(new da.EntityConfig,{entityType:da.EntityType.Loop,
enabled:oa&&pa}),Object.assign(new da.EntityConfig,{entityType:da.EntityType.Topic,enabled:ca}),Object.assign(new da.EntityConfig,{entityType:da.EntityType.Address,enabled:ia}),Object.assign(new da.EntityConfig,{entityType:da.EntityType.Satori,enabled:wa})]}),nudge:Object.assign(new da.NudgeConfig,{enabled:!1}),prediction:Object.assign(new da.PredictionConfig,{enabled:!1})})})})})]});this.gD.Bl().then(()=>{this.g5.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:ya}));U.ULS.sendTraceTag(520104021,
3034,50,"Submitted ClientConfigSignal Operation.")})}h_h(oa){const wa=Object.assign(new V.a,{parentPath:["Signal",da.StartupSignal.getTypeName()],items:[Object.assign(new W.a,{id:"SessionStartupSignal",body:Object.assign(new da.StartupSignal,{timestamp:Date.now()})})]});this.gD.Bl().then(()=>{oa&&this.bF();this.g5.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:wa}));U.ULS.sendTraceTag(521412674,3034,50,"Submitted StartupSignal Operation.")})}bF(){Ha.qbd()&&(J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQUseEccResultAnnotation",
!1)?(this.Ze.mb(this,da.EccResultAnnotation.getTypeName()),U.ULS.sendTraceTag(521412673,3034,50,"Registered for EccResultAnnotations.")):(this.Ze.mb(this,da.UserInitiatedResultAnnotation.getTypeName()),U.ULS.sendTraceTag(521412672,3034,50,"Registered for UserInitiatedResultAnnotations.")));Ha.obd()&&(this.Ze.mb(this,da.FlagResultAnnotation.getTypeName()),U.ULS.sendTraceTag(512361884,3034,50,"Registered for FlagResultAnnotations."))}$Lo(oa,wa,ia,ca,pa){const Ma=void 0===wa?!1:this.uQe>wa;this.vk.UE&&
!Ma&&(oa=this.OZh(oa),ca&&oa.suggestionGroups&&0<oa.suggestionGroups.length&&(oa.suggestionGroups[0].previewData=ca.substring(pa+1,ca.length)),this.vk.definition=oa,wa&&(this.uQe=wa));wa?(ca=Date.now(),ia=[Object.assign(new sa.a,{name:this.wtd,string:ia}),Object.assign(new sa.a,{name:"ContextIQMenuOpen",bool:this.vk.UE}),Object.assign(new sa.a,{name:"ContextIQStaleAnnotation",bool:Ma})],this.iub.wWc("ContextIQUserInitUserPerceivedLatency",ca-wa,1,!0,void 0,ia)):U.ULS.sendTraceTag(537966025,3034,15,
"SignalGenerationTime is undefined, can not determine if this annotation is stale or generate User Perceived Latency telemetry.")}OZh(oa){if(oa){var wa=[],ia=[];switch(oa.annotationType){case da.UserInitiatedResultAnnotation.getTypeName():var ca=oa.content;if(!ca)return;for(var pa of ca.results)wa=wa.concat(pa.results);ca=ba.a.$Ya;break;case da.EccResultAnnotation.getTypeName():pa=oa.content;if(!pa)return;for(const Ma of pa.entityResults)wa=wa.concat(Ma.entities);Ha.gng()&&(ia=null===(ca=pa.treatments)||
void 0===ca?void 0:ca.bestMatchEntries);ca=ba.a.$Ya;break;case da.FlagAnnotation.getTypeName():wa=wa.concat(oa.content.results);ca=ba.a.dFc;break;default:return}oa={annotationId:oa.id,results:wa,bestMatchResults:ia};if(wa=this.$Xg)this.$Xg=!1;return Object.assign(Object.assign({},z.g),{id:ca,suggestionGroups:[{type:ca,isContentPending:!1,contentData:oa,isFirstInvoke:wa}]})}}getPersonImageUrl(oa,wa){return Object(l.__awaiter)(this,void 0,void 0,function*(){var ia=new K.a(oa,"O365",wa,oa);if(this.gka&&
this.gka.getPersonaIconPropertiesArray&&(ia=yield this.gka.getPersonaIconPropertiesArray([ia]),0<ia.length&&ia[0].authorImageURL))return ia[0].authorImageURL})}static boe(){return Ha.qbd()||Ha.obd()}static qbd(){return Ha.Wne&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAtMentionEntryPointIsEnabled",!1)}static pbd(){return Ha.Wne&&J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQConsumerAtMentionEntryPointIsEnabled",!1)}static obd(){return Ha.Wne&&
J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQFlagsAreEnabled",!1)}static hng(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQStealthFlagsAreEnabled",!1)}static gng(){return J.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQBestMatchIsEnabled",!1)}static Wne(){return!H.a.oba&&!H.a.u3}static get f6a(){return Ha.ddk}Pqo(oa){if(this.gka){var wa=Object.assign(Object.assign({},z.g),
{id:ba.a.$Ya,suggestionGroups:[{type:ba.a.$Ya,isContentPending:!0,contentData:{annotationId:"",results:[]}}]}),ia=!1;this.ga.VZ(T.a.GSa)&&(ia=!0);this.vk.Ppa(oa,wa,this,!0,!1,null,this.Xla,null,!1,ca=>{ca.shouldIgnoreFocusEvent=pa=>{var Ma;return this.UPe?!0:pa===(null===(Ma=this.ed.editingView)||void 0===Ma?void 0:Ma.editingElement)};ca.getPersonImageUrl=this.getPersonImageUrl},ia,!1,this.w_g)}else U.ULS.sendTraceTag(539068165,3034,15,"PeopleAPI was not ready in time for showing a User Init Context IQ Card")}sBh(){this.vk.dismiss()}onKeyDown(oa){if(oa&&
oa.Ib){switch(oa.Ib.keyCode){case P.a.Uca:var wa=Da.WFj;break;case P.a.gL:wa=Da.End;break;case P.a.ks:wa=Da.LHj;break;case P.a.Z4:wa=Da.hIj;break;case P.a.iw:wa=Da.Tab;break;case P.a.a5:wa=Da.XFj}void 0!==wa&&(oa.Ib.stopPropagation(),oa.Ib.preventDefault(),this.w_g.onKeyPressed(wa))}}xD(oa,wa){if(oa&&oa.content&&wa===v.a.getTypeName()&&(oa.annotationType===da.UserInitiatedResultAnnotation.getTypeName()||oa.annotationType===da.EccResultAnnotation.getTypeName())){var ia=wa=void 0,ca=void 0,pa=0,Ma=
oa.parentPath.split("\\");if(Ma&&6===Ma.length)if(ia=Ma[5],Ma=Date.now(),ia in Ha.f6a){clearTimeout(Ha.f6a[ia].zCo);wa=Ha.f6a[ia].startTime;ca=Ha.f6a[ia].fro;pa=Ha.f6a[ia].Vzd;delete Ha.f6a[ia];const ya=[Object.assign(new sa.a,{name:this.wtd,string:ia})];this.iub.wWc("ContextIQUserInitALLatency",Ma-wa,1,!0,void 0,ya)}else U.ULS.sendTraceTag(537962376,3034,15,"SignalId is not in the dictionary, can not generate AL Latency telemetry.");else U.ULS.sendTraceTag(537966026,3034,15,"Annotation's parent path is not the expected length of 6. Can not generate AL Latency telemetry.");
this.$Lo(oa,wa,ia,ca,pa)}}get types(){return[ba.a.$Ya,ba.a.dFc]}Hig(oa,wa){this.vk.UE&&this.vk.Hig(oa,wa)}get dDc(){return!N.SessionStatusManager.instance.xj&&1!=J.AFrameworkApplication.ta.mode}jHa(oa){return oa&&Ba.a.ESc(oa)?!ma.a.I_b(oa):!1}OM(oa){if(Ha.boe()){var wa;if(N.SessionStatusManager.instance.xj||!this.dDc||!({annotation:ia,DZe:wa}=this.dK.mKd(oa.rl,oa.qgf,this.jHa)).returnValue)return!1;if(ia.annotationType===da.FlagAnnotation.getTypeName()){let ca=!1;this.ga.VZ(T.a.GSa)&&(ca=!0);var ia=
this.OZh(ia);return this.vk.Ppa(wa,ia,this,oa.XPa,oa.wNa,null,null,null,!1,null,ca)}return!1}}executeAction(oa,wa,ia,ca){const pa=Date.now();if(!wa)return!1;switch(oa.actionType){case z.b.Apply:this.KSd(oa.descriptorData,wa,ia,ca);this.sBh();break;case z.b.ClearSearch:this.UPe=!0;this.clearSearch(wa,ia,ca,!1);this.vk.UE&&(this.Vlj(),oa=k.ParagraphReader.text(wa).substring(0,ia+1),this.tkf(wa,oa,ia,pa));this.UPe=!1;break;case z.b.Retry:this.vk.UE&&(this.Vlj(),oa=k.ParagraphReader.text(wa).substring(0,
ca),this.tkf(wa,oa,ia,pa));break;case z.b.OpenEditorPane:if(32!==this.ga.processAction(T.a.GSa,2))return U.ULS.sendTraceTag(520898381,3034,15,"Failed to launch the editor pane from contextual card.",oa.actionType),!1;break;default:return U.ULS.sendTraceTag(539849408,3034,15,"Failed to process action of type {0} since it is not known to us.",oa.actionType),!1}return!0}tkf(oa,wa,ia,ca){var pa,Ma;const ya=ia.toString(),Oa=oa.id.toString(),fa=Oa+"-"+ya;var Ca=++this.bdk;const Ta=fa+"-"+Ca;Ca=(Ca=x.FormattingReader.QNd(oa,
ia,k.ParagraphReader.textLength(oa)))?x.FormattingReader.language(Ca):J.AFrameworkApplication.lcid;Ca=null!==(Ma=null===(pa=M.a.lg(Ca))||void 0===pa?void 0:pa.Jjf)&&void 0!==Ma?Ma:"";wa.length>this.THe&&(ia-=wa.length-this.THe,wa=wa.slice(-this.THe));const eb=Object.assign(new V.a,{parentPath:["Signal",ra.a.getTypeName(),Oa,ya,fa],items:[Object.assign(new W.a,{id:Ta,body:Object.assign(new ra.a,{languageId:Ca,startOfSentence:!0,text:wa,timestamp:Date.now(),userInitQuery:!0})})]});this.gD.Bl().then(()=>
{this.g5.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:eb}));U.ULS.sendTraceTag(521412643,3034,50,"Submitted Text Predictor Signal.");const jb=[Object.assign(new sa.a,{name:this.wtd,string:Ta})];this.iub.wWc("ContextIQUserInitSignalGenerationLatency",Date.now()-ca,1,!0,void 0,jb)});"@"===wa.slice(-1)&&ia===wa.length-1&&(pa=this.zm.wOd(oa,8,ia,ia))&&0===pa.count&&(pa=new e.a(8,ia,ia+1,F.a.create()),this.zm.xQa(oa,pa));oa=setTimeout(()=>{this.Foo(Ta)},this.edk);Ha.f6a[Ta]=
{startTime:ca,fro:wa,Vzd:ia,zCo:oa}}MOo(){if(this.vk.UE&&this.vk.definition&&this.vk.definition.suggestionGroups&&this.vk.definition.suggestionGroups[0]){const oa=this.vk.definition;oa.suggestionGroups[0].isContentPending=!0;this.vk.definition=oa}}Vlj(){const oa=Object.assign(Object.assign({},z.g),{id:ba.a.$Ya,suggestionGroups:[{type:ba.a.$Ya,isContentPending:!0,contentData:{annotationId:"",results:[]}}]});this.vk.definition=oa}Foo(oa){if(oa in Ha.f6a){var wa=Ha.f6a[oa].startTime;wa=void 0===wa?!1:
this.uQe>wa;if(!wa&&this.vk.UE){const ia=Object.assign(Object.assign({},z.g),{id:ba.a.$Ya,suggestionGroups:[{type:ba.a.$Ya,isContentPending:!1,errorMessage:"No results received from AugLoop",contentData:{annotationId:"",results:[]}}]});this.vk.definition=ia}oa=[Object.assign(new sa.a,{name:this.wtd,string:oa}),Object.assign(new sa.a,{name:"ContextIQMenuOpen",bool:this.vk.UE}),Object.assign(new sa.a,{name:"ContextIQStaleSignal",bool:wa})];this.iub.wWc("ContextIQUserInitALTimeout",1,0,!0,void 0,oa)}}KSd(oa,
wa,ia,ca){var pa=oa.type;switch(pa){case da.EntityType.File:this.insertHyperlink(wa,ia,ca,oa.fileName,oa.url+"?web=1");break;case da.EntityType.People:Ha.Ezf?this.insertHyperlink(wa,ia,ca,oa.displayName,"mailto:"+oa.primaryEmailAddress):this.tHo(oa,wa,ia,ca);break;case da.EntityType.Loop:this.Ktm(oa,wa,ia,ca);break;case da.EntityType.Address:this.Nsm(oa,wa,ia,ca);break;case da.EntityType.Satori:pa="https://www.bing.com/search?q="+oa.title.replace(" ","+");this.insertHyperlink(wa,ia,ca,oa.title,pa);
break;case da.EntityType.Topic:this.insertHyperlink(wa,ia,ca,oa.title,oa.url);break;default:U.ULS.sendTraceTag(539849409,3034,15,"Failed to process entity of type {0} since it is not known to us.",pa)}}tHo(oa,wa,ia,ca){const pa=oa.primaryEmailAddress,Ma=new K.a(pa,"O365",oa.displayName,pa);this.gka.checkUserAccess(Ma).then(ya=>{ya.UserCanWrite?(U.ULS.sendTraceTag(539100301,3034,50,"User has the correct permissions to be AtMentioned"),this.rRc(wa,ia,ca,Ma)):this.$vj(Ma,wa,ia,ca)},()=>{U.ULS.sendTraceTag(539100302,
3034,15,"Got back failed response from checking user access for AtMentioned User");this.$vj(Ma,wa,ia,ca)})}$vj(oa,wa,ia,ca){this.gka.grantUsersAccess([oa]).then(pa=>{let Ma=!1;pa.Details&&(Ma=pa.Details.Result[0].UserCanWrite);Ma?(U.ULS.sendTraceTag(539100303,3034,50,"AtMentioned User has been granted access"),this.rRc(wa,ia,ca,oa)):(U.ULS.sendTraceTag(539100304,3034,50,"AtMentioned user has been denied access"),this.clearSearch(wa,ia,ca,!0))},()=>{U.ULS.sendTraceTag(539100305,3034,15,"Failed Response from Attempt to grant access to AtMentioned user")})}rRc(oa,
wa,ia,ca){this.zm.cig(oa,wa,ia);this.iub.hy(T.a.R7e,!0,void 0,void 0,void 0,void 0);this.dI.rRc(oa,wa,ia,ca.DisplayName,ca.Email)}insertHyperlink(oa,wa,ia,ca,pa){if(oa){var Ma=new y.GraphTransaction(15),ya=ca+" ";try{Ma.Eb(oa);this.zm.cig(oa,wa,ia);this.iub.hy(T.a.R7e,!0,void 0,void 0,void 0,void 0);this.Jd.replaceTextRange(m.a.createTextRange(oa,wa,ia),ya);const Oa=I.a.B8b(pa);this.qF.jH(m.a.createTextRange(oa,wa,wa+ca.length),Oa,!1,!1,!1);this.ib.setSelection(u.SelectionFactory.te(oa,wa+ya.length))}finally{Ma&&
Ma.dispose()}}else U.ULS.sendTraceTag(509612897,3034,15,"Paragraph node is undefined/null.")}Ktm(oa,wa,ia,ca){if(wa){var pa=new y.GraphTransaction(15);try{pa.Eb(wa);this.Jd.replaceTextRange(m.a.createTextRange(wa,ia,ca),"");this.ib.setSelection(u.SelectionFactory.te(wa,ia));const Ma=oa.id;Ma===ba.a.p2m?this.ga.processAction(T.a.xRc,2):Ma===ba.a.n2m?this.ga.processAction(T.a.lRc,2):U.ULS.sendTraceTag(537458136,3034,15,"Trying to insert unsupported loop type.")}finally{pa&&pa.dispose()}}else U.ULS.sendTraceTag(537458135,
3034,15,"Paragraph node is undefined/null.")}Nsm(oa,wa,ia,ca){if(wa){var pa=new y.GraphTransaction(15);try{pa.Eb(wa);const Ma=I.a.B8b(oa.url);this.qF.jH(m.a.createTextRange(wa,ia,ca),Ma,!1,!1,!1);this.ib.setSelection(u.SelectionFactory.te(wa,ca));const ya=this.Ze.Sua(oa.annotationId);this.Ze.iIa(ya,60)}finally{pa&&pa.dispose()}}else U.ULS.sendTraceTag(509434014,3034,15,"Paragraph node is undefined/null.")}clearSearch(oa,wa,ia,ca){if(oa){var pa=new y.GraphTransaction(15);ca||(wa+=1);try{pa.Eb(oa),
this.Jd.replaceTextRange(m.a.createTextRange(oa,wa,ia),""),this.ib.setSelection(u.SelectionFactory.te(oa,wa))}finally{pa&&pa.dispose()}}else U.ULS.sendTraceTag(529413333,3034,15,"Paragraph node is undefined/null.")}nWm(){this.mI.execute(oa=>{oa.logActivity("CIQ_AtInvoke",null)})}}Ha.Ezf=!1;Ha.ddk={};Object(D.a)(Ha,"ContextIQIntentProvider",E.a,[126,169])},1651:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.handler=null}}Object(D.a)(l,"SetAnnotationResultCallbackParameters",
null,[])},1653:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{static get rec(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}l.qCb="fontInfoTaskPane";l.experienceId="modernfontpicker";Object(D.a)(l,"FontInfoPaneConstants",null,[])},1654:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.endDate=this.startDate=null}}Object(D.a)(l,"CommentTaskSchedule",null,[])},1655:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(67);class e{static get kd(){return null!=
e.Jug?e.Jug:e.Jug=new l.a}static Cqk(a){e.kd.addHandler(e.jNi,a)}static frk(a){e.kd.addHandler(e.IPi,a)}}e.jNi="OnCopyComment";e.IPi="OnPasteComment";Object(D.a)(e,"CommentEventsManager",null,[])},1656:function(D,L,c){c.d(L,"a",function(){return l});const l={ihf:"TasksFeatureUsage",bAo:"TaskExperienceDegraded",pje:"TaskCreate",qje:"TaskEngagement"}},1659:function(D,L,c){c.d(L,"c",function(){return x});c.d(L,"b",function(){return y});c.d(L,"a",function(){return m});var l=c(76),e=c(8),a=c(2),k=c(34);
const x=u=>{if(!u)return null;let z;try{z=k.b(u)}catch(v){z=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",v)}return z},y=(u,z)=>{let v=[];if(u.breadcrumbs&&0<u.breadcrumbs.length)v=u.breadcrumbs;else{const E=u.service_info;E&&E.friendly_service_name&&Array.add(v,E.friendly_service_name);u.display_path&&Array.addRange(v,u.display_path)}return v.join(z?" \u00ab ":" \u200f\u00bb ")},m=(u,z=!1)=>{if(!u)return[];if(!u.documents)return e.ULS.sendTraceTag(578352838,
202,15,"missing documents object"),[];if(!u.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];u=u.documents.items;const v=new l.a;for(let F=0;F<u.length;F++){const J=u[F];var E=J.web_url;if(!E){e.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!J.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}E=String.format("{0}?web=1",J.url)}const K={};K.DocumentUrl=E;K.MruId=J.mru_id;{E=J;let H=E.title;H?(E.extension&&(H=String.format("{0}.{1}",H,E.extension)),
E=H):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),E="")}K.FileName=E;K.IsPinned=J.is_pinned;K.Path=y(J,a.AFrameworkApplication.isRtl);z&&(K.App=J.app,K.TimeStamp=J.time_stamp);v.add(K)}return v.toArray()}},1660:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.Callback="action";Object(D.a)(l,"MenuLauncherAsyncTriggerCommandProperties",null,[])},1661:function(D,L,c){var l=this&&this.RD||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,
get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1811),L);e(c(1812),L);e(c(1813),L);e(c(1814),L);e(c(1815),L);e(c(1816),L);D.exports.TextToImageAnnotation||Object.defineProperty(D.exports,"TextToImageAnnotation",{enumerable:!0,get:function(){return D.exports.TextToImageAnnotation}});D.exports.TextToImageSignal||
Object.defineProperty(D.exports,"TextToImageSignal",{enumerable:!0,get:function(){return D.exports.TextToImageSignal}})},1662:function(D,L,c){var l=this&&this.RD||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.xy:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===
x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1817),L);e(c(1818),L);D.exports.ThemeExtractorAnnotation||Object.defineProperty(D.exports,"ThemeExtractorAnnotation",{enumerable:!0,get:function(){return D.exports.ThemeExtractorAnnotation}});D.exports.ThemeExtractorSignal||Object.defineProperty(D.exports,"ThemeExtractorSignal",{enumerable:!0,get:function(){return D.exports.ThemeExtractorSignal}})},1663:function(D,L,c){var l=this&&this.RD||
(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.xy:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(L,"__esModule",{value:!0});e(c(1819),L);e(c(1820),L);D.exports.TableType||Object.defineProperty(D.exports,
"TableType",{enumerable:!0,get:function(){return D.exports.TableType}});D.exports.TableTypeAnnotation||Object.defineProperty(D.exports,"TableTypeAnnotation",{enumerable:!0,get:function(){return D.exports.TableTypeAnnotation}})},1665:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(D.a)(l,"CalloutButtonProps",null,[])},1666:function(D,L,c){function l(){a||(e.Health.instance.addQosPillar("AsyncCollab"),a=!0)}c.d(L,
"a",function(){return l});var e=c(75);let a=!1},1667:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a=0,k=!1){this.qCj=!1;this.paragraphNode=e;this.gOf=a;this.qCj=k}}Object(D.a)(l,"ReviewActionArgs",null,[])},1671:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e=0,a=0,k=0,x=0,y="",m="",u="",z="",v="0pt",E="0pt",F="0pt",J="0pt"){this.borderTopStyle=e;this.borderRightStyle=a;this.borderBottomStyle=k;this.borderLeftStyle=x;this.borderTopColor=
y;this.borderRightColor=m;this.borderBottomColor=u;this.borderLeftColor=z;this.borderTopWidth=v;this.borderRightWidth=E;this.borderBottomWidth=F;this.borderLeftWidth=J}}Object(D.a)(l,"TableCellBorderProperties",null,[])},1672:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e="",a="",k="",x=""){this.eNk=e;this.dNk=a;this.bNk=k;this.cNk=x}}Object(D.a)(l,"TableCellMarginProperties",null,[])},1676:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(47);c(6);var e=
c(8);class a{constructor(k,x){this.L0m=()=>{e.ULS.sendTraceTag(39358976,324,50,"ForceSave request was successful in AutoSaveParamsUpdateService.")};this.ywa=(y,m)=>{e.ULS.sendTraceTag(39358977,324,10,"ForceSave request failed in AutoSaveParamsUpdateService with status code {0}.",m)};this.UTb=x}Wcj(k,x,y,m=null,u=null,z=null){if(k){var v=new l.GraphTransaction(0);v.Eb(k);k.setValue(x,y);v.dispose();try{this.UTb(15,!1,m||this.L0m,u||this.ywa,z,null,null)}catch(E){e.ULS.sendTraceTag(39358947,324,10,
"Error calling ForceSave in TableOfContentsActor.SendSaveRequest. Message: {0}",E.message)}}else e.ULS.sendTraceTag(39358946,324,10,"AutoSaveParametersNode is null in AutoSaveParamsUpdateService.")}}Object(D.a)(a,"AutoSaveParamsUpdateService",null,[297])},1677:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(8);class e{constructor(a){this.Hsj=a}he(a,k){if(a){var x=this.Hsj();a();a=this.Hsj();l.ULS.sendTraceTag(555307094,345,50,`${k}-${a-x}`)}else l.ULS.shipAssertTag(520127454,345,!1)}}
Object(D.a)(e,"PerfLogger",null,[383])},1678:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a){this.paragraphNode=e;this.state=a}}Object(D.a)(l,"ReviewCompletedArgs",null,[])},1679:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a){this.index=e;this.count=a}}Object(D.a)(l,"DesignerReviewPosition",null,[])},1680:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l;(function(a){a[a.empty=0]="empty";a[a.filled=1]="filled"})(l||(l={}));
Object(D.b)("BlueDotHighlightContextType",l);class e{constructor(a,k,x=WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionTooltipClick,y=l.empty){this.Qq=a;this.SDc=k;this.FDo=x;this.NDk=y}}Object(D.a)(e,"BlueDotHighlightContext",null,[])},1681:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.Zv=this.xo=this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0;this.bwa=!1;this.XJb=this.uIb=5;this.zla=this.rE=this.IFc=0;this.pUk=!1}}Object(D.a)(l,"SectionPropertiesData",
null,[])},1682:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(199);class l extends c.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=this.IconName=this.Label=null}get ControlType(){return 12}}Object(D.a)(l,"ErrorViewProps",c.a,[])},1683:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(199);class l extends c.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionId=this.Links=this.Description=this.SecondaryLabel=this.Label=
this.iconSet=this.ActionCommandId=this.CommandId=null}get ControlType(){return 13}}Object(D.a)(l,"MultiActionButtonProps",c.a,[])},1684:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"PersonaInfo",null,[])},1685:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"PersonaIdentifiers",null,[])},1686:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);L=c(1136);c=c(1059);class l{}l.b0=[new L.a(1440,1440,1440,1440),new L.a(720,720,720,720),
new L.a(1440,1440,1080,1080),new L.a(1440,1440,2880,2880),new L.a(1440,1440,1800,1800)];l.cpa=[new c.a(12240,15840),new c.a(12240,20160),new c.a(10440,15120),new c.a(11907,16839),new c.a(8391,11907)];Object(D.a)(l,"PredefinedPageProperties",null,[])},1688:function(D,L,c){c.d(L,"a",function(){return F});D=c(0);var l=c(192),e=c(2),a=c(21),k=c(15),x=c(20),y=c(1288),m=c(269),u=c(471),z=c(8),v=c(494),E=c(692);class F{constructor(J,K,H,P,N,M,I,T,U,W,V,Y,da,ba){this.Zq=J;this.atb=K;this.Na=H;this.kq=P;this.vs=
N;this.UD=M;this.J$=I;this.k9a=T;this.g9a=U;this.i9a=W;this.j9a=V;this.c$a=Y;this.d$a=da;this.zld=ba}build(J,K,H,P){const N=new l.QueryStringBuilder("WordOart.ashx");e.AFrameworkApplication.mea(N);N.De(v.a.nodeId,K.id.toString());K=x.ImageReader.A0l(K,J.Mc);N.De(E.a.sGd,K?K.ia(u.a.hPf,""):"");N.De(E.a.width,this.kq.toString());N.De(E.a.height,this.vs.toString());N.De(E.a.W_c,this.J$.toString());N.De(E.a.fXn,y.a[this.atb]);K=this.Na.$("WordEditorImageCropIsEnabled");N.De(E.a.VJh,K.toString());K&&(N.De(E.a.top,
this.k9a.toString()),N.De(E.a.bottom,this.g9a.toString()),N.De(E.a.left,this.i9a.toString()),N.De(E.a.right,this.j9a.toString()));K=this.Na.$("WordEditorImageRotateIsEnabled");N.De(E.a.m$i,K.toString());K&&(N.De(E.a.angle,this.UD.toString()),N.De(E.a.flipH,this.c$a?"true":"false"),N.De(E.a.flipV,this.d$a?"true":"false"));N.De(E.a.yWf,H?"true":"false");N.De(E.a.strict,this.zld?"true":"false");this.Na.$("WacWordEditorRenderHighContrastGraphicsIsEnabled")&&this.Zq&&this.Zq.Bvf&&N.De(E.a.j1a,this.Zq.Bvf);
(J=J.Ei())?(N.De(v.a.fileId,J.Fs),N.De(v.a.cellId,J.Zm.toString())):z.ULS.sendTraceTag(575522528,322,10,"parentGraphSpace is null. Cannot set FileId and CellId. url: {0}",N.toString());J=a.a.instance.Ma("Box4.IFeatureHelper");J=!!J&&J.isFeatureEnabled(47);N.De(E.a.kkl,"true");N.De(E.a.usm,J.toString());N.De(E.a.kRh,"true");J&&N.De(E.a.hWi,J.toString());N.De(E.a.xsm,"true");m.a.instance.gyb(N);H&&P&&!k.a.jt&&N.fK(E.a.Odb,window.self.devicePixelRatio.toString());N.De(E.a.Bsh,"true");return N.toString()}}
Object(D.a)(F,"WordOartEndpointUrlBuilder",null,[])},1689:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(17);class e{constructor(a,k){this._id=a;this.Hb=k;this.kJk=k.ia(l.a.xba,0);this.iJk=k.ia(l.a.Jga,0)}getId(){return this._id}}Object(D.a)(e,"GraphicsEditorImageContainer",null,[447])},1690:function(D,L,c){c.d(L,"a",function(){return I});D=c(0);var l=c(60),e=c(2),a=c(138),k=c(192),x=c(20),y=c(545),m=c(1187),u=c(6),z=c(108),v=c(43),E=c(17),F=c(44),J=c(471),K=c(123),H=c(990),P=c(8),
N=c(692),M=c(1688);class I{constructor(T,U,W,V,Y,da){this.properties=null;this.Zq=U;this.Nj=V;this.Na=Y;this.UB=da}cOo(T,U,W){T.d_||(U.setValue(u.a.Zyd,T.Wuk),U.setValue(u.a.SJd,T.W4b));this.iFj(T,U,W)}dOo(T,U,W){U.setValue(u.a.mKb,T.sSo);x.ImageReader.mPd(U,W.Mc,!1)!==T.cUf&&U.Qg(u.a.s8d,z.a.Pt,z.a.Loa,v.a.C7a);if(T.j7d)U.setValue(E.a.aca,l.a.Gf(T.j7d));else{var V=this.xHh(T.cUf,T.dUf,T.extension);W.Mc.Du(V);U.setValue(E.a.aca,V.id)}T.hne?U.setValue(v.a.C7a,l.a.Gf(T.hne)):T.TDj&&(V=this.xHh(T.TDj,
T.Clg,T.extension),W.Mc.Du(V),U.setValue(v.a.C7a,V.id));U.ia(u.a.t8d,"")!==T.u2c&&(""!==T.u2c?U.setValue(u.a.t8d,T.u2c):U.removeProperty(u.a.t8d));0===T.aua&&0===T.cua&&0===T.bua&&0===T.$ta||this.Nj.G8f(U,T.cua,T.$ta,T.aua,T.bua);void 0!==T.lockAspectRatio?U.setValue(u.a.yX,T.lockAspectRatio):U.setValue(u.a.yX,!1);T.tEk&&(this.gNb(U,u.a.xha,T.Uth),this.gNb(U,u.a.Xoa,T.borderStyle),this.gNb(U,u.a.mGa,T.borderColor));void 0!==T.altTextDescription&&U.setValue(u.a.xX,T.altTextDescription);this.gNb(U,
F.a.alphaModFix,T.alphaModFix);this.iFj(T,U,W);T=y.a.instance.igf(U);U.setValue(u.a.bca,T)}xHh(T,U,W){const V=new H.a(524345);V.setValue(J.a.hPf,T);V.setValue(J.a.iec,T);V.setValue(v.a.ntl,l.a.Gf(T).guid);V.setValue(u.a.$ki,U);V.setValue(J.a.thf,e.AFrameworkApplication.rootQuerySignature);V.setValue(v.a.sVh,W);return V}iFj(T,U,W){T.d_?(this.properties=U,U.setValue(F.a.d_,T.d_),T.XCc&&U.setValue(F.a.Yyd,T.XCc),U.setValue(F.a.tva,T.$Wo),U.setValue(F.a.uva,T.ckm),U.setValue(F.a.KOa,T.q4b),U.setValue(u.a.Rs,
T.Rs),U.setValue(u.a.sBb,T.f4b),U.setValue(v.a.l_,0),this.Na&&this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&U.setValue(K.a.ZNa,!1),U.setValue(K.a.k4,0),this.gNb(U,F.a.Y1a,T.rwa),this.hkh(U,W,!1,!0),this.hQk(U)):(U.setValue(u.a.uEa,T.uEa),U.setValue(z.a.Pt,T.uEa?T.Awn:""),T.Odb&&U.setValue(z.a.gFb,T.Odb),U.setValue(u.a.Rs,T.Rs),U.setValue(u.a.sBb,T.f4b),U.setValue(u.a.bca,T.mH),U.setValue(E.a.xba,a.a.WF(T.width)),U.setValue(E.a.Jga,a.a.WF(T.height)),
U.setValue(v.a.pWf,a.a.WF(T.width)),U.setValue(v.a.nWf,a.a.WF(T.height)),U.setValue(z.a.sEa,-1),U.setValue(z.a.rEa,-1),U.setValue(E.a.yga,!0),U.setValue(u.a.WI,T.rotationAngle),this.Na&&this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&U.setValue(K.a.ZNa,!1),U.setValue(v.a.l_,0),T.uEa&&this.hkh(U,W,!0,!1),this.iQk(U));5!=x.ImageReader.sk(U)?this.kQk(U):this.gQk(U);this.gNb(U,u.a.yPc,T.flipH);this.gNb(U,u.a.KPc,T.flipV)}MXn(T,U,W,V,Y=null){T=this.Nj.HXn(T.Yj,
U,W,V);null==T?P.ULS.sendTraceTag(561538391,3001,10,"Failed to replace picture properties"):Y&&Y(T)}hkh(T,U,W,V){let Y=!1;const da=this.UB.Ms(U);da&&da.Lf(u.a.RDf)&&(Y=!0);U=(new M.a(this.Zq,x.ImageReader.sk(T),this.Na,x.ImageReader.JE(T),x.ImageReader.bG(T),x.ImageReader.ZZ(T),x.ImageReader.Zgb(T),Math.max(x.ImageReader.Oma(T),0),Math.max(x.ImageReader.Lma(T),0),Math.max(x.ImageReader.Mma(T),0),Math.max(x.ImageReader.Nma(T),0),x.ImageReader.kOd(T),x.ImageReader.kDb(T),Y)).build(U,T,!0,!1);V&&(V=
new k.QueryStringBuilder(U),V.De(N.a.jUd,"true"),U=V.toString());T.setValue(u.a.$eb,U);W&&m.a.hNb(T,1,e.AFrameworkApplication.K,this.Zq)}gNb(T,U,W){void 0===W||null===W?T.removeProperty(U):T.setValue(U,W)}iQk(T){T.removeProperty(F.a.d_);T.removeProperty(F.a.Yyd);T.removeProperty(F.a.tva);T.removeProperty(F.a.uva);T.removeProperty(F.a.KOa);T.removeProperty(F.a.h4d);T.removeProperty(F.a.Oil);T.removeProperty(F.a.Y1a)}kQk(T){T.removeProperty(u.a.s8d);T.removeProperty(u.a.mKb);T.removeProperty(E.a.aca);
T.removeProperty(u.a.t8d)}gQk(T){T.removeProperty(u.a.SJd);T.removeProperty(u.a.Zyd);T.removeProperty(F.a.d_);T.removeProperty(F.a.Yyd)}hQk(T){T.removeProperty(u.a.Zyd);T.removeProperty(z.a.Pt);T.removeProperty(E.a.xba);T.removeProperty(E.a.Jga);T.removeProperty(u.a.bca);T.removeProperty(z.a.Loa);T.removeProperty(u.a.SJd);T.removeProperty(u.a.WI)}}Object(D.a)(I,"GraphicsEditorImageEditor",null,[428])},1691:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"SmartLookupApplicationInterface",
null,[])},1692:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y,m){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=e;this.url=a;this.spWebUrl=k;this.uniqueId=x;this.size=y;this.lastModified=m}}Object(D.a)(l,"FileInfo",null,[])},1697:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.doNotEmitAggregatedCount=this.areaName=this.vetoPillar=this.crewAlias=this.featureName=this.topLevelKpiName=
null}}Object(D.a)(l,"FeatureUsageAndHealthConfig",null,[])},1700:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);L=c(247);var l=c(125);class e extends L.a{constructor(){super();this.CellId=this.FileId=null}Cl(){return 37}static construct(a){const k=new e;k.FileId=a.Ei().Fs;k.CellId=l.a(a.Mc.id);return k}}Object(D.a)(e,"LastSavedRevisionRequest",L.a,[])},1720:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(8);c=c(273);class e extends c.a{constructor(a,k,x,y){super(e.k1e);this.Vs=
a;this.hl=k;this.view=x;this.options=y}initialize(){super.initialize();const a=this.options.AMb==this.hl.hta(this.view.Zc,{oO:this.options.oO,aba:this.options.U8b,Xhb:this.options.T8b,nO:this.options.nO});a&&!this.Sna&&l.ULS.sendTraceTag(557114691,3028,50,this.Q2(this.Vs,!0,`satisfiedIfBlank=${this.options.AMb}`));this.ii(a)}Pd(){super.Pd()}}e.k1e="BlankDocumentConditionId";Object(D.a)(e,"BlankDocumentCondition",c.a,[])},1723:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e){this.alt=
this.ariaLabel=this.src=null;this.src=e}}Object(D.a)(l,"ImageProps",null,[])},1725:function(D,L,c){c.d(L,"a",function(){return v});D=c(0);var l=c(60),e=c(10),a=c(14),k=c(8),x=c(18),y=c(1523),m=c(1507),u=c(1518),z=c(1511);class v{constructor(E,F,J,K,H,P,N){this.vNi=(M,I)=>{I&&I.data&&I.data.rl&&(M=new z.a(I.data.rl,1,!0),this.Wve.OM(M))};this.AQi=(M,I)=>{I&&I.data&&I.data.rl&&I.data.rl.node&&this.TUj.IJi(this.Wve,I.data.rl.node)};this.Cgc=(M,I,T)=>{M=I.view.re?I.view:null;if(!M||!M.nb)return 8;M=M.nb.hb.J(0).Qa;
return e.ParagraphReader.Yb(M.node)?1===T?32:2===T?(T=new z.a(M,2,!1),this.Wve.OM(T),32):2:2};this.T2b=(M,I,T)=>{var U,W;M=I.view.re?I.view:null;if(!M||!M.nb)return 8;M=null===(U=M.nb.hb.J(0))||void 0===U?void 0:U.Qa;return M&&M.node?e.ParagraphReader.Yb(M.node)?1===T?32:2===T?(T=M.node,U=e.ParagraphReader.text(M.node),I=M.cpBegin,M=M.cpEnd-I,0<M&&(U=U.substr(I,M)),M=Math.floor(Math.random()*v.Y$i),I=l.a.create(),k.ULS.sendTraceTag(541446531,3016,50,"Create Pull Quote invoked from context menu. PullQuote info: {0}; Document info: {1}",
{["suggestionId"]:I,["textLength"]:U.length,["paragraphLength"]:e.ParagraphReader.textLength(T),["paragraphRole"]:null===(W=this.wP.bA(T))||void 0===W?void 0:W.role,["styleId"]:M},this.z4j.rOd()),W=[new y.c(new m.d(I,3,null,null,!1,M,U),T,M,U,V=>{this.PSb.M1c(u.a.create(V));this.PSb.Ifc({role:27,paragraphNode:V,placeholder:!1})},3)],this.j$j.Azd(W),32):2:2:8};this.ga=E;this.Wve=F;this.TUj=J;this.PSb=K;this.j$j=H;this.wP=P;this.z4j=N}initialize(){this.ga.gb(x.a.Cgc,a.a.view,this.Cgc,1028);this.PSb.zrk(this.AQi);
this.PSb.yqk(this.vNi);this.ga.gb(x.a.T2b,a.a.view,this.T2b,4)}dispose(){this.ga.$u(x.a.T2b,a.a.view,this.T2b);this.PSb.dVn(this.vNi);this.PSb.xVn(this.AQi);this.ga.$u(x.a.Cgc,a.a.view,this.Cgc)}}v.Y$i=5;Object(D.a)(v,"DesignerActionListener",null,[1120,9])},1727:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.seen="Seen";l.kept="Kept";l.rejected="Rejected";Object(D.a)(l,"CritiqueAction",null,[])},1736:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.aKj=
"PageContentOrigin";this.HHj=500;this.bsg=["resize"];this.ZBo=e=>()=>{!this.Aid&&e&&(this.Aid=setTimeout(()=>this.vAh(),this.HHj),e())}}addHandler(e){this.LLb();this.gKa=this.ZBo(e);this.jpn(this.gKa);this.bsg.forEach(a=>{window.addEventListener(a,this.gKa)})}LLb(){var e;this.vAh();null===(e=this.uih)||void 0===e?void 0:e.disconnect();this.bsg.forEach(a=>{window.removeEventListener(a,this.gKa)});this.gKa=void 0}vAh(){this.Aid&&(clearTimeout(this.Aid),this.Aid=void 0)}jpn(e){this.uih=new MutationObserver(e);
(e=document.getElementsByClassName(this.aKj)[0])&&this.uih.observe(e,{attributes:!0,attributeFilter:["style"]})}}Object(D.a)(l,"EditorAiWindowEventManager",null,[])},1737:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(29),e=c(7);class a{constructor(k){var x,y;this.vo=k;this.kR=null;this.kR=null===(y=null===(x=this.vo)||void 0===x?void 0:x.vd)||void 0===y?void 0:y.container}addHandler(k){this.kR&&(this.LLb(),this.gKa=k,l.a.addHandler(this.kR,e.a.scroll,this.gKa),l.a.addHandler(this.kR,
e.a.resize,this.gKa))}LLb(){this.kR&&this.gKa&&(l.a.removeHandler(this.kR,e.a.scroll,this.gKa),l.a.removeHandler(this.kR,e.a.resize,this.gKa))}}Object(D.a)(a,"EditorAiPositionManager",null,[])},1739:function(D,L,c){var l=c(0),e=c(1799),a=c(394),k=c(627),x=c(60),y=c(21),m=c(1994),u=c(2),z=c(83),v=c(79),E=c(1595),F=c(160);class J{constructor(Sb,nc){this.CommentId=Sb;this.ResolveState=nc}}Object(l.a)(J,"CommentProperties",null,[]);var K=c(587),H=c(1996),P=c(1997),N=c(1640),M=c(189),I=c(1797);class T extends I.a{constructor(Sb,
nc="",Tc="",td="",je=!1){super(Sb,nc,Tc,td,je);this.DateUtc=null}}Object(l.a)(T,"CommentReactionUser",I.a,[]);var U;(function(Sb){Sb[Sb.like=1]="like"})(U||(U={}));Object(l.b)("ReactionType",U);var W;(function(Sb){Sb[Sb.first=0]="first";Sb[Sb.done=0]="done";Sb[Sb.undone=1]="undone";Sb[Sb.addComment=2]="addComment";Sb[Sb.deleteComment=3]="deleteComment";Sb[Sb.editComment=4]="editComment";Sb[Sb.addReaction=5]="addReaction";Sb[Sb.removeReaction=6]="removeReaction";Sb[Sb.last=7]="last"})(W||(W={}));Object(l.b)("CommentChangeType",
W);var V=c(200),Y=c(598),da=c(234);class ba{constructor(){this.Lbh=this.deh=!1;this.bgk=[]}get Jkc(){return this.bgk}get oOb(){return this.deh}set oOb(Sb){this.deh=Sb;for(const nc of this.Jkc)nc.oOb=Sb}get cNb(){return this.Lbh}set cNb(Sb){this.Lbh=Sb;for(const nc of this.Jkc)nc.cNb=Sb}O6a(Sb){for(const nc of this.Jkc)Sb=nc.O6a(Sb);return Sb}}Object(l.a)(ba,"AggregateCommentTaskPersonTransformer",null,[943]);var ja=c(8),sa=c(118),ta=c(1592);class ra{constructor(Sb,nc){this.x3j=new da.a(()=>nc.O6a(Sb.value))}ULl(){return new Date}yZa(Sb,
nc,Tc){if(0===Sb)throw ja.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const td=sa.a.create().toString();Tc=new ta.a(Sb,this.x3j.value,Tc,td,!1);Tc.commentId=nc;ja.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",Sb);return Tc}}Object(l.a)(ra,"HistoryRecordFactory",null,[945]);var ma=c(1654);class Ba{constructor(Sb,nc,Tc,td,je,se){this.isLossy=
Sb;this.title=nc;this.assignees=Tc;this.schedule=td;this.completion=je;this.priority=se}}Object(l.a)(Ba,"CommentTaskState",null,[]);class Pa{constructor(){this.commentId=null}}Object(l.a)(Pa,"HistoryItem",null,[]);class Da{constructor(Sb,nc,Tc,td,je,se,Ze){this.YCe=!1;if(1!==nc.type)throw Error.argument("createRecord");this.gqc=Tc;this.dqc=td;this.eqc=je;this.d4g=1;this.njd=Sb;this.x5j=se;this._state=new Ba(!1,this.gqc,Ze,new ma.a,this.eqc,this.dqc);this._history=[];this.oIh(nc)}W2b(Sb,nc){if(1!==
Sb.type)throw Error.argument("createRecordTemplate");const Tc=Da.r7l(Sb,this.d4g);this.d4g++;return Object.assign(new ta.a(nc,Sb.user,Sb.time,Tc),{commentId:Sb.commentId})}get fAi(){return this.history[this.history.length-1]}get fii(){return this.state.completion===this.eqc}get eii(){return this.state.priority===this.dqc}get gii(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get hii(){return this.state.title===
this.gqc}oIh(Sb){Sb=Object.assign(new Pa,{commentId:Sb.commentId,records:[Sb]});this.history.push(Sb)}q0h(Sb){let nc=-1;for(let Tc=0;Tc<this.state.assignees.length;Tc++)if(this.njd.equals(this.state.assignees[Tc],Sb)){nc=Tc;break}return nc}tjo(Sb){const nc=this.fAi,Tc=nc.records[nc.records.length-1];return this.njd.equals(Tc.user,Sb.user)&&nc.commentId===Sb.commentId&&Tc.time.getTime()===Sb.time.getTime()?!0:!1}kSo(Sb){switch(Sb.type){case 2:-1===this.q0h(Sb.assignee)&&this.state.assignees.push(Sb.assignee);
break;case 3:const nc=this.q0h(Sb.assignee);0<=nc&&this.state.assignees.splice(nc,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=Sb.schedule;break;case 6:this.state.completion=Sb.completion;break;case 9:this.state.title=Sb.title;break;case 10:this.state.priority=Sb.priority;break;case 0:this.state.isLossy=!0;break;case 1:ja.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.YCe=!0;break;case 8:this.YCe=!1;break;case -1:ja.ULS.sendTraceTag(51139905,
327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}Sb.isLossy&&(this.state.isLossy=!0);this.tjo(Sb)?this.fAi.records.push(Sb):this.oIh(Sb)}get isDeleted(){return this.YCe}get state(){return this._state}get history(){return this._history}DRl(Sb){if(!Sb)return this.history;const nc=Array.clone(this.history),Tc=nc[0],td=Tc.records.shift();if(!this.x5j){var je=this.W2b(td,4);Tc.records.unshift(je)}!Sb.fii&&this.fii&&(je=this.W2b(td,6),je.completion=this.eqc,Tc.records.unshift(je));
!Sb.eii&&this.eii&&(je=this.W2b(td,10),je.priority=this.dqc,Tc.records.unshift(je));!Sb.gii&&this.gii&&(je=this.W2b(td,5),je.schedule=new ma.a,Tc.records.unshift(je));!Sb.hii&&this.hii&&(je=this.W2b(td,9),je.title=this.gqc,Tc.records.unshift(je));Sb.isDeleted&&(Sb=this.W2b(td,8),Tc.records.unshift(Sb));return nc}static r7l(Sb,nc){return"Synthesized-"+Sb.recordId+"-"+nc}}Object(l.a)(Da,"CommentTaskStateBuilder",null,[]);class Ha{constructor(Sb,nc,Tc,td){this.id=Sb;this.commentId=nc;this.currentState=
Tc;this.history=td}}Object(l.a)(Ha,"CommentTaskItem",null,[]);var oa=c(1591);const wa=Sb=>{const nc=new oa.a(Sb.UserId,Sb.Provider,Sb.DisplayName,Sb.Email);nc.IsCurrentUser=Sb.IsCurrentUser;return nc};var ia=c(1794);class ca{static clone(Sb){Sb=ca.OSk(Sb.extensions);return new ia.a(Sb)}static kBh(Sb){return Sb?ca.clone(Sb):null}static isEmpty(Sb){return!Sb.extensions||!Sb.extensions.count}static mf(Sb){return!Sb||ca.isEmpty(Sb)}static OSk(Sb){if(!Sb)return null;const nc=new a.a;Sb.forEach((Tc,td)=>
{nc.add(Tc,td);return!0});return nc}}Object(l.a)(ca,"ExtensionListExtensions",null,[]);class pa{static clone(Sb){var nc=wa(Sb.user);nc=new ta.a(Sb.type,nc,Sb.time,Sb.recordId,Sb.isLossy);nc.commentId=Sb.commentId;nc.anchorExtensionList=ca.kBh(Sb.anchorExtensionList);nc.recordExtensionList=ca.kBh(Sb.recordExtensionList);Sb.assignee&&(nc.assignee=wa(Sb.assignee));if(Sb.schedule){var Tc=Sb.schedule;const td=new ma.a;td.startDate=Tc.startDate;td.endDate=Tc.endDate;nc.schedule=td}nc.completion=Sb.completion;
nc.title=Sb.title;nc.priority=Sb.priority;nc.undoId=Sb.undoId;return nc}}Object(l.a)(pa,"HistoryRecordExtensions",null,[]);class Ma{constructor(Sb,nc,Tc,td,je,se,Ze,Xe=!1){this.njd=Sb;this.Xpd=nc;this.yLa=Tc;this.BTj=td;this.gqc=je;this.dqc=se;this.eqc=Ze;this.Ykd=Xe}e8k(Sb,nc,Tc,td=null){if(!Sb)throw ja.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!nc)throw ja.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");
if(!Tc||!Tc.length)throw ja.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Tc[0].type)throw ja.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var je=[],se=null,Ze=this.FCn(Tc);for(var Xe of Tc)if(!Ze.contains(Xe.recordId))if(Tc=this.Lei(Xe.commentId,td),Tc=this.ICl(Xe,Tc),1===Tc.type){let Ei=[];this.Ykd&&se&&se.state&&(Ei=se.state.assignees);se=new Da(this.njd,
Tc,this.gqc,this.dqc,this.eqc,this.Ykd,Ei);je.push(se)}else if(se)se.kSo(Tc);else throw ja.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");Ze=null;Xe=[];if(se){se.isDeleted||(Ze=se.state);se=null;for(var ye of je)je=ye.DRl(se),Array.addRange(Xe,je),se=ye}ye=this.Lei(nc,td);Ze&&(Ze.completion=this.UWk(nc,
td,Ze.completion));return new Ha(Sb,ye,Ze,Xe)}UZh(Sb,nc,Tc,td=null){if(!nc)throw ja.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Tc&&!Sb)throw ja.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const je=[],se=this.yLa.ULl();if(Tc){var Ze=this.yLa.yZa(1,Sb,se);je.push(Ze)}Ze=null;if(nc.assigneeUpdate){if(!nc.assigneeUpdate.assigneesToAdd||!nc.assigneeUpdate.assigneesToRemove)throw ja.ULS.sendTraceTag(536999254,
327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Xe=0;Xe<nc.assigneeUpdate.assigneesToAdd.length;Xe++){var ye=this.pIh(2,nc.assigneeUpdate.assigneesToAdd[Xe],Sb,se);ye&&je.push(ye)}for(Xe=0;Xe<nc.assigneeUpdate.assigneesToRemove.length;Xe++)(ye=this.pIh(3,nc.assigneeUpdate.assigneesToRemove[Xe],Sb,se))&&je.push(ye)}else nc.assignee&&(Tc||(Ze=this.yLa.yZa(4,Sb,se),je.push(Ze)),Xe=this.yLa.yZa(2,Sb,se),Ze=this.Xpd.O6a(nc.assignee),Xe.assignee=Ze,je.push(Xe));
nc.title?(td=this.yLa.yZa(9,Sb,se),td.title=nc.title,je.push(td)):Tc&&td&&(Xe=this.yLa.yZa(9,Sb,se),Xe.title=this.BTj.d$l(td,Ze),je.push(Xe));if(nc.schedule){if(nc.schedule.startDate>nc.schedule.endDate)throw ja.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");td=this.yLa.yZa(5,Sb,se);td.schedule=nc.schedule;je.push(td)}if(void 0!==nc.completion&&null!==nc.completion){td=nc.completion;if(0>td||100<td)throw ja.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),
Error.argumentOutOfRange("completion");Tc||ja.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",td);Tc=this.yLa.yZa(6,Sb,se);Tc.completion=td;je.push(Tc)}if(void 0!==nc.priority&&null!==nc.priority){nc=nc.priority;if(0>nc||10<nc)throw ja.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");Sb=this.yLa.yZa(10,Sb,se);Sb.priority=nc;je.push(Sb)}return je}pIh(Sb,nc,Tc,td){if(2!==Sb&&3!==Sb)return ja.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),
null;Sb=this.yLa.yZa(Sb,Tc,td);Sb.assignee=this.Xpd.O6a(nc);return Sb}FCn(Sb){const nc=new k.a,Tc=new k.a;for(let td=Sb.length-1;0<=td;td--){const je=Sb[td],se=Tc.contains(je.recordId);se||-1!==je.type||(Tc.contains(je.undoId)?ja.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):Tc.add(je.undoId));if(se||-1===je.type)nc.contains(je.recordId)?ja.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):
nc.add(je.recordId)}return nc}ICl(Sb,nc){const Tc=pa.clone(Sb);Tc.commentId=nc;Tc.user=this.Xpd.O6a(Sb.user);Tc.assignee=this.Xpd.O6a(Sb.assignee);return Tc}UWk(Sb,nc,Tc){let td=Tc;Sb&&nc&&(({value:nc}=nc.Ec(Sb)).returnValue?(td=nc.ResolveState?100:100===Tc?0:Tc,td!==Tc&&ja.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",Sb)):ja.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",
Sb));return td}Lei(Sb,nc){let Tc=Sb;Sb&&nc&&(({value:nc}=nc.Ec(Sb)).returnValue?Tc=nc.CommentId:(ja.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",Sb),Tc=Sb));return Tc}}Object(l.a)(Ma,"CommentTaskTranslatorImpl",null,[944]);var ya=c(1028),Oa=c(1217);class fa{constructor(){this.gfb=CommonUIStrings.l_Ellipsis}d$l(Sb,nc){if(!Sb)throw ja.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");
try{var Tc=E.a.aDb(Sb)}catch(ye){throw ja.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var td=Sb=0,je=0;const se=RegExp("\\s+","g"),Ze=new Sys.StringBuilder;for(var Xe of Tc.ops)Xe.attributes&&Xe.attributes.atmention&&Xe.attributes.atmention.email&&nc&&(Tc=Xe.attributes.atmention.email,0<Tc.length&&(Tc===nc.UserId||Tc===nc.Email||Tc===ya.a.Ffb(nc.UserId))&&(td=Sb,je=td+Xe.insert.length)),Tc=Xe.insert.replace(se,
" "),Sb+=Tc.length,Ze.append(Tc);!je&&nc&&ja.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",nc.Provider);nc=Ze.toString().trimEnd();Sb=nc.length;255<Sb?(Xe=(255-(je-td))/2,0>td-Xe?(Sb=Oa.a.instance.V_a(nc,255-this.gfb.length),je=nc.substring(0,Sb)+this.gfb,Sb="Trimmed End"):je+Xe>Sb?(td=Oa.a.instance.m0a(nc,Sb-255+this.gfb.length),je=this.gfb+nc.substring(td,Sb),Sb="Trimmed Start"):(td=Oa.a.instance.m0a(nc,td-Xe+this.gfb.length),Sb=Oa.a.instance.V_a(nc,je+Xe-this.gfb.length),
je=this.gfb+nc.substring(td,Sb)+this.gfb,Sb="Trimmed Both")):(Sb="No Trim",je=nc);ja.ULS.sendTraceTag(592998804,327,50,Sb);return je}}Object(l.a)(fa,"ContentExtractor",null,[]);class Ca{constructor(Sb,nc){this.v_j=Sb;this.y3j=nc;this.cNb=this.oOb=!1}O6a(Sb){if(!Sb)return null;if(void 0===Sb.UserId||null===Sb.UserId)throw ja.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(Sb.IsCurrentUser||!this.v_j.equals(this.y3j.value,Sb))return Sb;Sb=wa(Sb);Sb.IsCurrentUser=
!0;return Sb}}Object(l.a)(Ca,"EnsureIsCurrentUserSetTransformer",null,[943]);class Ta{constructor(){this.cNb=this.oOb=!1}O6a(Sb){if(!Sb)return null;if(void 0===Sb.UserId||null===Sb.UserId)return Sb;if(!Sb.Email||""===Sb.Email){let nc;if(nc=ya.a.Ffb(Sb.UserId))return Sb=wa(Sb),Sb.Email=nc,Sb}return Sb}}Object(l.a)(Ta,"RestoreEmailTransformer",null,[943]);class eb{constructor(){this.cNb=this.oOb=!1}O6a(Sb){if(!Sb)return null;if(void 0!==Sb.UserId&&null!==Sb.UserId)return Sb;switch(this.oOb?this.cNb?
2:1:0){case 0:if(void 0===Sb.UserId||null===Sb.UserId)throw ja.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");Sb=wa(Sb);break;case 1:if(void 0===Sb.Id||null===Sb.Id)throw ja.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===Sb.Email||null===Sb.Email)throw ja.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var nc=eb.XUi(Sb.Id,Sb.Email,null);if(!nc||""===nc)throw ja.ULS.sendTraceTag(593368212,
327,10,"Failed to generate UserId"),Error.argument("UserId");var Tc=u.AFrameworkApplication.K.kb("HostAuthType")||"";if("aad"!==Tc.toLowerCase()||nc.startsWith("S::")){if("msa"===Tc.toLowerCase())throw ja.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");ja.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Tc)}else throw ja.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");
Sb=new oa.a(nc,"AD",Sb.DisplayName,Sb.Email);break;case 2:if(void 0===Sb.UserPrincipalName||null===Sb.UserPrincipalName)throw ja.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==Sb.SuggestionSubtype&&null!==Sb.SuggestionSubtype)if("OrganizationUser"===Sb.SuggestionSubtype)nc="AD";else throw ja.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",Sb.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");
else throw ja.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Tc=eb.XUi(Sb.Id,Sb.UserPrincipalName,Sb.AadObjectId);if(!Tc||""===Tc)throw ja.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===nc&&!Tc.startsWith("S::"))throw ja.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");Sb=new oa.a(Tc,nc,Sb.Name,Sb.UserPrincipalName);break;default:throw ja.ULS.sendTraceTag(593368203,
327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return Sb}static XUi(Sb,nc,Tc){if(!nc||""===nc)return ja.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),Sb;if(Tc&&""!==Tc)return"S::"+nc+"::"+Tc;if(!Sb||""===Sb)return ja.ULS.sendTraceTag(593368217,327,50,"Missing ID"),Sb;if(Sb.startsWith("S::"))return Sb;if(-1!==Sb.indexOf("@")){Tc=Sb.split("@");if(sa.a.isValid(Tc[0]))return"S::"+nc+"::"+Tc[0];ja.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return Sb}}
Object(l.a)(eb,"UserIdCanonicalizationTransformer",null,[943]);class jb{constructor(Sb,nc,Tc=!1,td=!1){this.kWj=Sb;this.tKg=nc;this.i4j=Tc;this.Ykd=td}m2k(){const Sb=new ya.a;var nc=new da.a(jb.xLl);const Tc=new ba;this.tKg&&(Tc.Jkc.push(new eb),Tc.Jkc.push(new Ta));this.kWj&&Tc.Jkc.push(new Ca(Sb,nc));Tc.oOb=this.tKg;Tc.cNb=this.i4j;nc=new ra(nc,Tc);const td=new fa;return new Ma(Sb,Tc,nc,td,jb.$al,jb.Ral,jb.Sal,this.Ykd)}static xLl(){const Sb=new oa.a(u.AFrameworkApplication.K.kb("PresenceUserId")||
"",u.AFrameworkApplication.K.kb("PresenceProvider")||"",u.AFrameworkApplication.userName||"");Sb.IsCurrentUser=!0;return Sb}}jb.$al="";jb.Ral=5;jb.Sal=0;Object(l.a)(jb,"CommentTaskTranslatorFactory",null,[935]);var ob=c(48),Ya=c(182),Xa=c(12),Sa=c(5),ab=c(56),Hb=c(11),pb=c(169),Mb=c(52),Qb=c(24),Aa=c(736),bb=c(41),nb=c(19),Va=c(10),Ab=c(1205),Zb=c(31),Kb=c(92),dc=c(305),jc=c(145),zb=c(213),cc=c(433),Ub=c(720),Wb=c(400),Qa=c(70),sb=c(249),Jb=c(14),pc=c(265),rc=c(6),db=c(707),lb=c(529),qa=c(318),Ga=
c(46),Fb=c(485),$b=c(117),rb=c(80),xb=c(272),gb=c(1459),Gb=c(34),ac=c(1030);class hc{create(){return new ac.a}}Object(l.a)(hc,"CommentNodeFactory",null,[378]);var Ec=c(1201),Uc=c(1053),dd=c(1497),fd=c(1558);class xc{constructor(){this.xJc=this.F7c=null;this.JId=this.The=!1;this.$Ma=this.pCa=null}}Object(l.a)(xc,"CommentAnchorParaNodesStatus",null,[]);var $c=c(1395),Bc=c(17);class Vd extends $c.a{constructor(Sb){super();this.H$j=Sb}get index(){return 2}run(){this.H$j()}rCh(Sb,nc){nc.property===Bc.a.gf&&
this.eY()}}Object(l.a)(Vd,"CommentContentPropertyTracker",$c.a,[]);var Je=c(1488);class Gf{constructor(Sb,nc){this.yec=Sb;this.Eoi=nc}}Object(l.a)(Gf,"CommentIntentIdentifier",null,[]);var Nc=c(1020),md=c(1066),Oe=c(175),fg=c(167);class If extends $c.a{constructor(Sb,nc){super();this.M8a=new lb.a(new Nc.a);this.iZb=new md.a(Je.c);this.jZb=new Oe.ScriptSharpLegacyMap;this.G6j=Sb;this.J7j=nc;this.jZb.add(rc.a.jaa,1);this.jZb.add(rc.a.gH,0);this.jZb.add(Bc.a.gf,0);this.jZb.add(rc.a.a7,2)}get index(){return 4}run(){let Sb=
"";for(const nc of this.M8a)if(this.G6j(nc),this.iZb.ob(nc.id))for(const Tc of this.iZb.J(nc.id))Sb+="_"+Tc;this.J7j(Sb);this.M8a.clear();this.iZb=new md.a(Je.c)}IVk(Sb,nc){Sb=nc.property;if(Sb===rc.a.jaa||Sb===rc.a.gH||Sb===Bc.a.gf||fg.App.vne&&Sb===rc.a.R1b||Sb===rc.a.a7)this.M8a.add(nc.node),this.jZb.ob(Sb)&&(this.iZb.ob(nc.node.id)||this.iZb.add(nc.node.id,new Fb.a),this.iZb.J(nc.node.id).add(this.jZb.J(Sb))),this.eY();dd.a.NKh.has(nc.node.id.toString())&&Sb===rc.a.wE&&ja.ULS.sendTraceTag(521484097,
327,15,"Durable ID changed of a Cut Pasted Comment")}UVk(Sb,nc){nc.property===Bc.a.yo&&(Sb=nc.node,Sb.WFb&&(this.M8a.add(Sb),this.eY()))}iAo(Sb,nc){this.M8a.add(nc.node);this.eY()}}Object(l.a)(If,"CommentNodeTransactionCompletedProcessor",$c.a,[]);var tf=c(1560),vf=c(1596);class $f{constructor(){this.mxe=new Map;this.oAe=new Map}Ckk(Sb,nc){if(this.mxe.has(Sb))throw Error("DuplicateDurableId");if(this.oAe.has(nc))throw Error("DuplicateGuardId");this.mxe.set(Sb,nc);this.oAe.set(nc,Sb)}MQl(Sb){return this.mxe.get(Sb)}Z3h(Sb){return this.oAe.get(Sb)}}
Object(l.a)($f,"CommentIdMapper",null,[]);var vg=c(18),Kf=c(1509),Ph=c(1656),ff=c(1539),yc=c(126),Rd=c(124);c.d(L,"a",function(){return de});class de extends e.a{constructor(Sb,nc,Tc,td,je,se,Ze,Xe,ye,Ei,Db,Vb,Sc,bd,Ud,sf,eg,Ug,Lh,ah,dh,Hf,Mf,Md,Sd,Pd=null,Fk){super();this.Ix=Sb;this.HGe=nc;this.CGe=Tc;this.Ic=td;this.MSj=je;this.Ttb=se;this.wVe=Ze;this.bpc=Xe;this.Na=ye;this.jd=Ei;this.zm=Db;this.NVb=Vb;this.X5=Sc;this.BVb=bd;this.a1g=Ud;this.ih=sf;this.Dm=eg;this.bUa=Ug;this.wj=Lh;this.t5=ah;this.JJ=
dh;this.EXa=Hf;this.Wyc=Mf;this.fpc=[];this.vUa=[];this.MSe=new a.a(0);this.Drd=new a.a;this.Iud=new lb.a(qa.a.Xh());this.mSe=new lb.a(qa.a.Xh());this.rgd=null;this.Nrb=new a.a;this.Pve=!1;this.ted=new k.a;this.DWg=!1;this.Yte=new Set;this.vte=0;this.PY=[];this.iTb=2;this.dBa=new a.a(!1);this.vwc=new k.a;this.Xqc=new Map;this.ned=new $f;this.oed=0;this.LSj=5;this.jJb=(Vg,Lf)=>{Vg=Lf.paragraphNode;for(const kg of Lf.contents)this.xva(kg.element,Vg,kg.intents,kg.VF)};this.iMi=(Vg,Lf)=>{if(Vg.Mc.id.equals(this.ud.id)){this.bUa.BGa(7);
var kg=Vg.getValue(rc.a.gH),Og=Vg.getValue(rc.a.wE).toString();kg=this.ih.ofb?this.Xqc.has(Og)?this.Xqc.get(Og):Og:kg;kg=this.pD(kg);if(Lf){if(kg){this.Xx&&this.Xx.Ff===kg.id&&(ja.ULS.sendTraceTag(592188698,327,50,"Draft lost by parent deletion"),this.JJ.logKpiFailure(Kf.a.FDd,"DraftCommentLostOnParentDelete",{isIntentional:!1,isInternal:!0},{name:Kf.a.qDd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}));Lf=kg.Ff?"The comment is a reply":"";Og=Je.k(Vg,x.a.nil).toString();const kh=Je.h(Vg,
x.a.nil).toString();if(this.ted.contains(kg.id)&&!dd.a.IAm(kg.l_a)){this.ted.remove(kg.id);const ai=+new Date-+kg.date;ja.ULS.sendTraceTag(577307335,327,15,"New session comment deleted by inbound change: {0}. duration: {1}. startParaId: {2}. endParaId: {3}. {4}.",Je.a(kg),ai,Og,kh,Lf)}else ja.ULS.sendTraceTag(50426379,327,50,"{0} deleted by inbound changes. startParaId: {1}. endParaId: {2}. {3}.",Je.a(kg),Og,kh,Lf);this.ej.YHc(kg);this.zMh(Vg.id)}}else if(!kg){this.JJ.ensureFeatureDenominatorLoggedAndVetoPillarRegistered();
y.a.instance.Ma("WordEditor.Comments.EditorCommentManager")||ja.ULS.sendTraceTag(525379405,327,10,"comment Manager resolve failed");if(this.ih.WAb&&!this.wj.PX){this.t5.ipa("OnCommentInit",Object.assign(new tf.a,{WNi:()=>{this.EQf(Vg);this.DLb()}}));return}this.ih.Kq||this.wj.PX||this.t5.ipa("OnCommentInit");this.UFn(Vg)||this.EQf(Vg)}this.Pve=!0}};this.DLb=(Vg=null)=>{this.ih.OOb&&this.Hmi();this.ih.OOb&&this.rnl();this.rK.FLb(void 0,Vg);this.bUa.BGa(8)};this.IRi=(Vg,Lf,kg)=>{if(Vg.Mc.id.equals(this.ud.id)){var Og=
Vg.ia(rc.a.taskId,"");if(""===Og)ja.ULS.sendTraceTag(42856717,3003,10,"Newly added or deleted task node does not have a task id.");else{if(Lf)if(this.mSe.add(Og),Og=this.BVb.value.Kdi(Vg),void 0!==Og&&null!==Og)this.Nrb.remove(Og);else{ja.ULS.sendTraceTag(591971722,3003,10,"A task without comment id was deleted even though that shouldn't be possible.");return}else if(this.Iud.add(Og),Lf=this.BVb.value,Vg=Lf.Kdi(Vg),void 0!==Vg&&null!==Vg)for(this.Nrb.J(Vg)?this.Nrb.Z(Vg,Og):this.Nrb.add(Vg,Og),Vg=
Lf.Mdi(Og),Lf=0;Lf<Vg.length;Lf++){var kh=Vg[Lf].commentId;kh&&(kh=Number.parseInvariant(kh),this.Nrb.J(kh)||this.Nrb.add(kh,Og))}else{ja.ULS.sendTraceTag(591971723,3003,10,"A task without comment id was added or modified even though that shouldn't be possible.");return}kg&&this.DLb()}}};this.xMo=Vg=>{if(dd.a.jWd(Vg)){const kg=this.WZ(Vg.id.toString());if(kg){const Og={text:kg.text,done:kg.done};var Lf=Sa.GraphIterator.$a(Vg);kg.text=this.QCb(Lf);this.hDi(kg.text);kg.done=Vg.ia(rc.a.jaa,!1);Vg.hasProperty(rc.a.a7)&&
(Lf=(Lf=Vg.getValue(rc.a.a7))?Gb.b(Lf||""):null,kg.usersByReactionType=Lf,ff.a.ozh(kg.usersByReactionType),this.ZOk(kg));this.AMo(Vg,kg);kg.Ff||this.FMo(Vg,kg);!this.ih.Hta||!this.lI||this.Xx&&this.Xx.id===kg.id||this.lI.fireEvent(10,{comment:kg,XLi:Og})}}else this.jd.isFeatureEnabled(114)&&72===Vg.type?this.IRi(Vg,!1,!1):this.zMo(Vg)};this.snl=()=>{const Vg=this.QMd();for(this.fpc.sort((Lf,kg)=>{const Og=Lf.ia(rc.a.QL,null),kh=kg.ia(rc.a.QL,null);if(!Og&&kh)return-1;if(!kh&&Og)return 1;Lf.hasProperty(rc.a.qCa)&&
kg.hasProperty(rc.a.qCa)?(Lf=Lf.getValue(rc.a.qCa),kg=kg.getValue(rc.a.qCa),kg=Lf<kg):(Lf=new Date(Lf.getValue(rc.a.OFc)),kg=new Date(kg.getValue(rc.a.OFc)),kg=Lf<kg);return kg?-1:1});this.fpc.length;){const Lf=this.fpc[0];Vg.uhb(Lf)&&(Vg.Fi(Lf),this.ej.addComment(this.jFd(Vg),null),this.ej.mode=1);Array.removeAt(this.fpc,0)}if(Vg.Tb(1))for(;Vg.wf(1););this.jd.isFeatureEnabled(114)&&this.BVb.value.Odi();this.Pve&&(this.DLb(),this.Pve=!1)};this.hfl=Vg=>{1===Vg&&(xb.WoncaApp.Gje.DGh(),this.NVb.value.inb(!0,
"CommentInboundFailed"));this.X5.nB(ab.a.D8e,this.Rzi)};this.Cna=Vg=>{if(!this.ih.Kq||Vg.done)return!1;if(Vg.er===m.a.beingCreated)return!0;if(Vg.objectId){if(this.ozm(Vg))return!1;if(!this.xFm(Vg.objectId)||Vg.Ff)return!0;for(const Lf of this.mQ())if(Lf.Ff===Vg.id)return!0}return!1};de.IJ=Pd;this.Snd=new lb.a(qa.a.Xh());!this.ih.WAb&&this.ih.Kq||ac.a.JRa(this.iMi);Sd.sMa(this.jJb);Md&&(Md.Lv((Vg,Lf)=>{Vg=Je.o(this.PY,Lf.node.id);0<this.PY.length&&(!Vg||Vg===this.PY.length-1)&&(this.iTb=1,this.PY=
[])}),Fk.execute(Vg=>{this.lI=Vg}),u.AFrameworkApplication.GQ&&(u.AFrameworkApplication.ye("AutoPopulateShareTUIComment;AutoPopulateShareTUICommentCf"),this.ih.IBk&&this.Njk()))}Njk(){z.a.instance.Wb(new v.a(5,1,0,()=>{const Sb=this.Ic.Qc(7);Sb.Eb(this.zIa);var nc=Hb.App.ya.jb.Wc;nc&&(nc=pb.PageNavigator.instance.HT(nc),nc=Sa.GraphIterator.$a(nc),nc.Sd(),nc.Sd(),nc.Sd(),nc.Sd(),Mb.a.instance.setSelection(Qb.SelectionFactory.nK(nc.currentNode,0,0)),nc=new E.a,nc.lga("Get the conversation going by adding comments and using Share (above) to send a link to this doc. It\u2019s free! No subscription or sign-in necessary. \n"),
this.nAb(Mb.a.instance.hb.lb,"Microsoft Word",nc),Sb.dispose(),ob.a("ShareTUICommentCreated"),ja.ULS.sendTraceTag(520728590,327,50,"ShareTUICommentCreated"))}))}get rK(){return this.ej}get nZe(){return this.Zg}get Rzi(){return null!=this.Zzg?this.Zzg:this.Zzg=Object.assign(new Aa.a,{F2:WoncaIntl.WoncaStrings.l_InboundingCommentFailed,Kea:1})}get Is(){return this.Ic}get my(){return this.Ix.value}get ud(){return this.my.ud}get zIa(){return this.HGe.value}get sCa(){return this.CGe.value}get nb(){return this.Ttb.value}get jY(){return this.Na.kb("PresenceUserId")}get u4a(){return this.Na.kb("PresenceProvider")}xva(Sb,
nc,Tc,td){if(Tc&&this.Xx&&(!this.Xx||!this.Xx.Ff)){var je=!1;for(const se of Tc)if(3===se.type)switch(je=!0,Tc=Je.n(this.PY,se.id),-1<Tc&&(this.PY[Tc].yec=nc.id),Sb.classList.add(bb.a.eId),td){case 1:Sb.classList.add(bb.a.Qdf);break;case 0:Sb.classList.add(bb.a.Rdf)}je||Sb.classList.remove(bb.a.eId,bb.a.Rdf,bb.a.Qdf);this.bUa.BGa(3)}}dmf(Sb=!1){return this.wVe.aBl(this.Zg,u.AFrameworkApplication.xa.mode,nc=>!this.ih.cOb||!Sb||this.Cna(nc))}Jlf(Sb){return this.wVe.dHl(this.ej.model.mQ(),u.AFrameworkApplication.xa.mode,
Sb)}yqf(Sb){if(!Sb||!Sb.Ff)return Sb;Sb=Sb.Ff;for(let nc=0;nc<this.Zg.length;nc++)if(this.Zg[nc].id===Sb)return this.Zg[nc];return null}l2k(){const Sb=[];if(this.jd.isFeatureEnabled(114)){var nc=this.BVb.value;for(const Tc of nc.Odi())(nc=this.k_h(Tc))&&Sb.push(nc)}return Sb}yom(Sb){if(!this.vUa)throw F.a.invalidOperation("UpdateContent must have been called before this.");for(let nc=0;nc<this.vUa.length;nc++)if(this.vUa[nc].id===Sb)return nc;return-1}Hmi(){const Sb=new rb.a;for(const Tc of this.Zg)if(Tc.objectId&&
Tc.LOa){var nc=x.a.Gf(Tc.objectId);if((nc=this.ud.Db(nc))&&nc.hasProperty(rc.a.wE))if(nc=nc.getValue(rc.a.wE).toString(),Sb.ob(nc)){const td=Sb.J(nc).CommentId;this.eJj(td,Tc,nc)}else Sb.add(nc,new J(Tc.id,Tc.done))}this.rgd=Sb}eJj(Sb,nc,Tc){Sb!==nc.LOa?(ja.ULS.sendTraceTag(42866777,327,10,"Multiple comments contains the same DurableId [{0}]; ObjectId [{1}], GuardId [{2}], GuardId of existing entry: {3}",Tc,nc.objectId,nc.LOa,Sb),this.JJ.logKpiFailure(Kf.a.U1b,"MultipleCommentsWithSameDurableId",
{isInternal:!0},{name:Kf.a.T1b,isInternal:!0})):ja.ULS.sendTraceTag(554297428,327,15,"Duplicate entry of same comment with DurableId [{0}], GuardId [{1}], ObjectId [{2}]",Tc,nc.LOa,nc.objectId)}k_h(Sb){const nc=this.a1g.value;var Tc=this.BVb.value;const td=Tc.I7b(Sb);if(void 0===td||null===td)return ja.ULS.sendTraceTag(592234717,3003,50,"GenerateTaskItemForTaskId was called with a taskId [{0}] that has no comment anchor id.",Sb),null;Tc=Tc.Mdi(Sb);try{return nc.e8k(Sb,td.toString(),Tc,this.rgd)}catch(je){return ja.ULS.sendTraceTag(42856716,
3003,10,"CreateTaskItemFromHistoryRecords Failed due to [{0}]",je.message),null}}p2h(Sb=!1,nc=!1){const Tc=new k.a,td=nc?Je.j():new Set;this.dBa.keys.forEach(je=>{td.has(je)||Sb&&this.dBa.J(je)||Tc.add(je);return!0});return Tc}lPd(){if(!this.Zg)return 0;let Sb=0;for(const nc of this.Zg)nc.Ff||Sb++;return Sb}xSc(Sb){var nc,Tc;return(null===(Tc=null===(nc=this.Xx)||void 0===nc?void 0:nc.Ty)||void 0===Tc?void 0:Tc.draftId)===Sb}Fkk(Sb){var nc;if(Sb.er===m.a.beingCreated){if(this.ej.mode=2,this.G$a=Sb,
this.nb.hb){var Tc=this.nb.hb.lb;if(Tc&&Tc.Qa){if(nb.SelectionEditor.hm(Tc)){var td=nb.SelectionEditor.b3(Tc.Qa,!1);td&&(this.nb.setSelection(td),Tc=td)}for(td=0;td<Tc.length;td++){var je=Tc.J(td).node;if(!Va.ParagraphReader.Yb(je)||!(-1!==Tc.J(td).cpBegin&&-1!==Tc.J(td).cpEnd||-1!==Tc.J(td).zj&&-1!==Tc.J(td).Ep))continue;var se=-1===Tc.J(td).cpBegin?Tc.J(td).zj:Tc.J(td).cpBegin;const Ze=-1===Tc.J(td).cpEnd?Tc.J(td).Ep:Tc.J(td).cpEnd,Xe=x.a.create();this.zm.xQa(je,new Ab.a(3,se,Ze,Xe));this.PY.push(new Gf(je.id,
Xe));this.klk(null===(nc=Sb.Ty)||void 0===nc?void 0:nc.draftId,je,se,Tc)}}}}else this.F0f(Sb);Tc=({index:nc}=this.Rke(Sb)).returnValue;td=null;if(!Sb.Ff){je=this.p2h();Sb.er!==m.a.beingCreated&&(td=this.X4l(Sb),je.remove(Sb.objectId));je=({index:se}=this.bXl(td,je)).returnValue;nc=-1<se?se:nc;se=0;if(je)for(;nc<this.Zg.length&&this.Zg[nc].Ff;)nc++;if(!je&&this.ih.Kq&&Sb.er===m.a.beingCreated)for(je=0;je<nc;je++)this.Zg[je].Ff||this.Zg[je].done||se++;this.swo(Sb,se)}Tc&&(Array.insert(this.Zg,nc,Sb),
this.ih.Hta&&this.lI&&Sb.er!==m.a.beingCreated&&(Sb.Ff?this.lI.fireEvent(10,{comment:Sb,changeType:"replyAdded"}):this.lI.fireEvent(11,{comment:Sb})),this.Ikk(Sb,td))}klk(Sb,nc,Tc,td){this.ih.contentNavigationApiEnabled&&Sb&&nc&&td&&this.Wyc.KXe({contentId:Sb,containerContentType:0,Q8:{rd:Tc,tM:nc.wl}},{selection:td})}Ikk(Sb,nc){if(this.ih.contentNavigationApiEnabled&&Sb&&!Sb.Ff&&Sb.er!==m.a.beingCreated){var Tc=this.ud.Db(Sb.objectId);if(Tc){var td=Je.k(Tc,x.a.nil);td=this.ud.Db(td);td=dd.a.ava(td,
Tc.id,!1);(null===td||void 0===td?0:td.Kb)&&(null===td||void 0===td?0:td.paragraph)?this.Wyc.KXe({contentId:Sb.id,containerContentType:0,Q8:{rd:td.Kb.cp,tM:td.paragraph.wl}},{selection:nc}):ja.ULS.sendTraceTag(520717896,327,10,`comment object id: ${Tc.id},
        commentStartRangeObject Valid: ${!!td},
        containingProperties Valid: ${!(null===td||void 0===td||!td.Kb)},
        paragraph valid: ${!(null===td||void 0===td||!td.paragraph)};
        Failed to add to ReviewSuggestionModel`)}}}Ita(Sb){super.Ita(Sb);this.ted.add(Sb.id)}yXn(Sb,nc){this.ih.contentNavigationApiEnabled&&this.Wyc.xXn(Sb,nc)}swo(Sb,nc){this.ih.Kq&&Sb.er===m.a.beingCreated&&Sb.Ty&&this.MSe.Z(Sb.Ty.draftId,nc)}W8l(Sb){return this.MSe.J(Sb)}b4i(Sb){this.MSe.remove(Sb)}GSl(Sb){let nc=0,Tc=0;for(let td=0;td<this.Zg.length;td++){if(this.Zg[td].id===Sb.id){Tc=td;break}this.Zg[td].Ff||this.Zg[td].done||nc++}return{returnValue:Tc,WBo:nc}}xrf(Sb){var nc=null,Tc=this.ud.Db(Sb);
Sb=dd.a.Iaa(Tc,this.ud,!0);Tc=dd.a.Iaa(Tc,this.ud,!1);Sb&&Tc&&(nc=Qb.SelectionFactory.te(Sb.Kb.paragraph,Sb.Kb.cp),nc=Qb.SelectionFactory.Vz(nc,Zb.a.Tc(Tc.Kb.paragraph,Tc.Kb.cp)));Sb&&Tc||this.JJ.logKpiFailure(Kf.a.U1b,"ParaNodeNotConnected",{isIntentional:!1,isInternal:!0});return nc}X4l(Sb){Sb=x.a.Gf(Sb.objectId);return this.xrf(Sb)}m2f(Sb,nc){var Tc=this.ud.Db(Sb);if(Tc){var td=this.ud.Db(Je.k(Tc));Tc=this.ud.Db(Je.h(Tc));if(td===Tc)for(Tc=0;Tc<td.qa.length&&!td.qa.J(Tc).XHo(Sb,nc);Tc++);}}bXl(Sb,
nc){let Tc=-1;var td=null;Sb||(Sb=this.nb.hb?this.nb.hb.lb:null);if(!Sb||!Sb.Qa)return{returnValue:null,index:Tc};const je=this.$$h(Sb.Qa);if(!je)return{returnValue:null,index:Tc};var se=dd.a.$Tl(je.iterator.currentNode,Sb.Qa.cpBegin,this.ih.Kq,nc);se&&(td=this.WZ(se.Tj.toString()),se=Array.indexOf(this.Zg,td),td=0<=se?td:null,Tc=0<=se?se+1:Tc);td||(Sb=this.n2h(je,Sb.Qa,this.ih.Kq,nc),td=0<=Sb?this.Zg[Sb]:null,Tc=0<=Sb?Sb:Tc);return{returnValue:td,index:Tc}}cJl(Sb=null){var nc=null;nc=this.nb.hb.lb;
return nc&&nc.Qa?this.dPl(nc.Qa,this.ih.Kq,Sb):null}$$h(Sb){const nc=new Sa.GraphIterator;nc.set(Sb.node);return nc.Yo()?Kb.a.at(nc,nc.origin):null}dPl(Sb,nc,Tc=null){const td=this.$$h(Sb);Sb=this.n2h(td,Sb,nc,Tc);return-1<Sb?this.Zg[Sb]:null}n2h(Sb,nc,Tc,td=null){let je=-1;if(Sb)for(nc=nc.cpBegin;-1===je&&Sb.moveNext();)Va.ParagraphReader.rh(Sb.iterator)&&((nc=dd.a.rMc(Sb.iterator.currentNode,nc,Tc,td))&&(je=Array.indexOf(this.Zg,this.WZ(nc.Tj.toString()))),nc=0);return je}Tqi(Sb){const nc=Sb.toString();
return this.dBa.ob(nc)&&this.dBa.J(nc)||this.vwc.contains(Sb)&&this.ud.Ava(Sb)&&this.ud.Db(Sb).ia(rc.a.jaa,!1)}gej(Sb,nc=!1){if(Sb=this.sMc(Sb))Sb.gCf=!nc}GCf(Sb){return this.dBa.ob(Sb.toString())||this.vwc.contains(Sb)&&this.ud.Ava(Sb)&&!this.ud.Db(Sb).ia(rc.a.QL,null)}F0f(Sb){!Sb.objectId||Sb.Ff||this.dBa.ob(Sb.objectId)||this.dBa.add(Sb.objectId,Sb.done)}deleteComment(Sb){Sb&&!Sb.Ff&&(this.ih.Kq&&Sb.er!==m.a.beingCreated?this.dBa.remove(Sb.objectId):Sb.er===m.a.beingCreated&&this.lxj());this.ted.remove(Sb.id);
return super.deleteComment(Sb)}lnf(Sb){return Sb&&Sb.hasProperty(rc.a.wE)?Sb.Lf(rc.a.wE).toString():""}sMc(Sb){if(!Sb)return null;if(this.ih.ofb)return this.pD(Sb);for(const nc of this.Zg){const Tc=this.ud.Db(x.a.Gf(nc.objectId));if(this.lnf(Tc)===Sb.toString())return Sb=Tc.Lf(rc.a.gH),this.pD(Sb)}return null}x_f(Sb,nc=!1){if(Sb&&dd.a.jWd(Sb)&&this.jd.isFeatureEnabled(114)){const Tc=this.lnf(Sb);if(""!==Tc){if(nc){let td;if(this.rgd&&({value:td}=this.rgd.Ec(Tc,td)).returnValue&&td.ResolveState===
Sb.ia(rc.a.jaa,!1))return}(Sb=this.Nrb.J(Number.parseInvariant(Tc)))&&this.Iud.add(Sb)}}}UFn(Sb){const nc=this.bmf(Sb);let Tc=!1;nc.The&&nc.JId||(this.vwc.add(Sb.id),Tc=!0,this.dNi(Sb));return Tc}dNi(Sb){K.a.s2(u.AFrameworkApplication.oc,()=>{this.EQf(Sb);this.vwc.remove(Sb.id);this.vwc.count||(this.DLb(),this.rK.INo())},"DelayLoadCommentNodeIntoModel")}EQf(Sb){if(!this.ej&&(ja.ULS.sendTraceTag(525379406,327,10,"Comment Manager Not initialized"),this.oed<this.LSj)){this.oed+=1;this.dNi(Sb);ja.ULS.sendTraceTag(525378784,
327,50,`Comment Node add Retry attempt ${this.oed}`);return}const nc=this.QMd();nc.Fi(Sb);if(nc.dA()){let Tc;try{Tc=this.jFd(nc)}catch(td){ja.ULS.JH(512553930,327,10,td,"create comment from comment node failed")}if(!Tc){ja.ULS.sendTraceTag(512553929,327,15,`CommentNode Failed to add: ${null===Sb||void 0===Sb?void 0:Sb.id}`);this.JJ.logKpiFailure(Kf.a.U1b,"CommentCreationFailed",{isInternal:!0},{name:Kf.a.T1b,isInternal:!0});return}this.ej.addComment(Tc,null);2!==this.ej.mode&&3!==this.ej.mode&&(this.ej.mode=
1);this.x_f(Sb);this.Ebn(Tc);this.gDj(Tc)}else this.fpc.push(Sb);this.t5.ipa("OnCommentNodeAdded",{commentNode:Sb})}Ebn(Sb){this.ih.Kq&&!this.wj.yn&&this.rK.vA&&Sb.Ff&&this.rK.vA.id===Sb.Ff&&this.rK.notify(String.format(Box4Intl.Box4Strings.L_CommentReplyAdded,Sb.author),!1)}bmf(Sb){const nc=new xc;nc.F7c=Je.k(Sb,x.a.nil);nc.xJc=Je.h(Sb,x.a.nil);Sb=nc.F7c.equals(x.a.nil);const Tc=nc.xJc.equals(x.a.nil);Sb||(nc.pCa=this.ud.Db(nc.F7c),nc.The=!!nc.pCa&&nc.pCa.isConnected);Tc||(nc.$Ma=this.ud.Db(nc.xJc),
nc.JId=!!nc.$Ma&&nc.$Ma.isConnected);return nc}tSh(Sb,nc){const Tc=this.yom(Sb);-1!==Tc&&Array.removeAt(this.vUa,Tc);nc||((Sb=this.k_h(Sb))?this.vUa.push(Sb):ja.ULS.sendTraceTag(42870813,3003,10,"GenerateTaskItemForTaskId returned null"))}rnl(){for(const Sb of this.Iud)this.tSh(Sb,!1);this.Iud.clear();for(const Sb of this.mSe)this.tSh(Sb,!0);this.mSe.clear()}Rke(Sb){var nc=this.Zg.length,Tc=!1;if(Sb.Ff){var td=(Tc=this.pD(Sb.Ff))&&Tc.objectId?this.ud.Db(x.a.Gf(Tc.objectId)):null;td=!!td&&td.hasProperty(rc.a.qCa);
nc=Array.indexOf(this.Zg,Tc);Tc=0>nc;for(nc+=1;nc<this.Zg.length&&this.Zg[nc].Ff===Sb.Ff&&this.Zg[nc]!==this.Xx&&!(td&&Sb.date<this.Zg[nc].date);)nc++}return{returnValue:!Tc,index:nc}}glm(){const Sb=new If(this.xMo,this.DLb),nc=Hb.App.jk.Kl;nc.af(40).Ro(Object(Ga.a)(Sb,Sb.IVk,"commentPropertyChanged"));nc.af(12).Ro(Object(Ga.a)(Sb,Sb.UVk,"commentTextChanged"));this.jd.isFeatureEnabled(114)&&nc.af(72).Ro(Object(Ga.a)(Sb,Sb.iAo,"taskPropertyChanged"));dc.GraphTransactionManager.instance.Cpa(Sb,3)}hDi(Sb){this.Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.EmptyCommentLogging",
!1)&&Sb&&0!==Sb.length&&(Sb=E.a.aDb(Sb[0]),1<Sb.ops.length||0===Sb.ops.length||("\n"===Sb.ops[0].insert&&(this.vte+=1),3<this.vte&&ja.ULS.sendTraceTag(509437908,327,15,"comments content cleared. Potentially resulting in data loss")))}ZOk(Sb){if(Sb&&this.Yte.has(Sb.id)){var nc=Sb.usersByReactionType[1];for(let Tc=0;nc&&Tc<nc.length;Tc++)if(nc[Tc].UserId===this.jY)return;ja.ULS.sendTraceTag(542765345,327,15,`Like by current user on Comment ${Sb.objectId} removed by inbound changes`)}}FMo(Sb,nc){this.aTk(nc);
const Tc=this.ih.Kq;Tc&&this.Khm(nc)?(this.ubl(nc),this.x_f(Sb),this.EQo(nc)):Tc||this.x_f(Sb,!0)}zMo(Sb){const nc=new Sa.GraphIterator;nc.set(Sb);nc.Ab(40);nc.fd(40);if(nc.currentNode){if(Sb=this.WZ(nc.currentNode.id.toString())){const Tc={done:Sb.done,text:Sb.text};Sb.text=this.QCb(nc);this.hDi(Sb.text);!this.ih.Hta||!this.lI||this.Xx&&this.Xx.id===Sb.id||this.lI.fireEvent(10,{comment:Sb,XLi:Tc})}}else ja.ULS.sendTraceTag(592738053,327,15,"UpdateComment Unexpected Node Type: "+jc.a[Sb.type])}EQo(Sb){if(!this.wj.yn){var nc=
new Fb.a;this.rjg(Sb,nc);0<nc.count&&db.b(nc)}}ubl(Sb){const nc=new v.a(0,1,0,()=>{this.yMo(Sb)},137,void 0,!0);u.AFrameworkApplication.oc.Wb(nc)}aTk(Sb){var nc;null!==(nc=this.Xx)&&void 0!==nc&&nc.Ty&&this.Xx.Ty.sessionType!==H.a.metadata&&(nc=this.Xx,Sb.Ff||!Sb.done||nc.Ff!==Sb.id&&nc.id!==Sb.id||(ja.ULS.sendTraceTag(592188699,327,15,"Draft comment lost on parent resolve, DraftType: {0}",nc.er),this.JJ.logKpiFailure(Kf.a.FDd,"DraftCommentLostOnParentResolve",{isIntentional:!1,isInternal:!0},{name:Kf.a.qDd,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1}),nc.er===m.a.beingCreated?(this.ej.clearSelection(),this.deleteComment(nc),this.selectComment(Sb)):nc.er===m.a.beingEdited&&(nc.er=m.a.normal,nc.kSa=P.a.succeeded,this.ej.M3e())))}AMo(Sb,nc){var Tc;const td=null===(Tc=nc.Ty)||void 0===Tc?void 0:Tc.draftId;if(this.ih.ofb){if(Sb=Sb.getValue(rc.a.wE).toString(),nc.id!==Sb){if(!nc.Ff)for(Tc=Array.indexOf(this.Zg,nc)+1;Tc<this.Zg.length&&this.Zg[Tc].Ff===nc.id;Tc++)this.Zg[Tc].Ff=Sb;ja.ULS.sendTraceTag(555044877,
327,50,"durable Id updated.");nc.id=Sb;this.Xqc.has(Sb)&&this.Xqc.delete(Sb)}}else if(Sb=Sb.getValue(rc.a.gH),nc.id!==Sb){if(!nc.Ff)for(Tc=Array.indexOf(this.Zg,nc)+1;Tc<this.Zg.length&&this.Zg[Tc].Ff===nc.id;Tc++)this.Zg[Tc].Ff=Sb;nc.id=Sb}td&&this.yXn(td,nc.id)}Khm(Sb){return this.dBa.ob(Sb.objectId)&&this.dBa.J(Sb.objectId)!==Sb.done}yMo(Sb){this.dBa.Z(Sb.objectId,Sb.done);if(Sb.done)if(this.rK.mlc(Sb),this.wj.yn)this.rK.eZc(Sb,!0);else{var nc=new v.a(0,1,0,()=>{this.rK.eZc(Sb,!0,!1);this.Drd.remove(Sb.id)},
139);this.Drd.add(Sb.id,nc);u.AFrameworkApplication.oc.Wb(nc);this.Gy&&Sb.id===(void 0===this.Gy.Ff||null===this.Gy.Ff?this.Gy.id:this.Gy.Ff)&&this.rK.clearSelection()}else this.rK.mlc(Sb),nc=null,({value:nc}=this.Drd.Ec(Sb.id)).returnValue?(u.AFrameworkApplication.oc.Se(nc),this.Drd.remove(Sb.id)):this.rK.eZc(Sb,!1)}ePi(){this.xqm();this.vqm();u.AFrameworkApplication.K.$("IsDocumentOwner")||y.a.instance.Sa("Common.ISystemInitiatedFeedback").execute(Sb=>{Sb.logActivity("ShowTUIForCommentAwareness",
null)})}vqm(){this.ih.OOb&&this.Hmi();this.ih.OOb&&(this.vUa=this.l2k(),Uc.a.JRa(this.IRi))}xqm(){!this.ih.WAb&&this.ih.Kq&&ac.a.JRa(this.iMi);this.glm();this.flm()}flm(){const Sb=new Vd(this.snl),nc=Hb.App.jk.Kl;nc.af(39).Ro(Object(Ga.a)(Sb,Sb.rCh,"commentContainerPropertyChanged"));this.jd.isFeatureEnabled(114)&&nc.af(71).Ro(Object(Ga.a)(Sb,Sb.rCh,"commentContainerPropertyChanged"));dc.GraphTransactionManager.instance.Cpa(Sb,3)}WZ(Sb){for(let nc=0;nc<this.Zg.length;nc++){const Tc=this.Zg[nc];if(Tc.objectId===
Sb)return Tc}return null}Mok(Sb){if(Sb)for(const nc of Sb)nc&&this.Snd.add(nc)}nRk(){this.Snd.clear()}FWe(Sb,nc){Array.insert(this.Zg,nc,Sb);this.F0f(Sb);this.AWm(Sb);nc=this.sNd(Sb);this.Snd.contains(nc)&&(Sb.gCf=!0,this.Snd.remove(nc))}gDj(Sb){Je.p(Sb)||ja.ULS.sendTraceTag(512278912,327,15,`Missing Start or End mapping info for Comment ${Sb.objectId}`)}AWm(Sb){ja.ULS.sendTraceTag(539800645,327,50,`Comment added to Model. ${Je.a(Sb)} `)}jFd(Sb){40!==Sb.Xe&&ja.ULS.sendTraceTag(594363294,327,15,"[CreateCommentForNode] Iterator is not at commentNode");
const nc=Sb.currentNode;var Tc=nc.getValue(rc.a.R1b);const td=nc.getValue(rc.a.gH),je=nc.getValue(rc.a.wE).toString(),se=nc.getValue(rc.a.OFc);let Ze=null,Xe=null;if(nc.hasProperty(rc.a.a7)){var ye=nc.getValue(rc.a.a7);Ze=ye?Gb.b(ye||""):null;ff.a.ozh(Ze)}nc.hasProperty(rc.a.qCa)&&(Xe=nc.getValue(rc.a.qCa));let Ei=null,Db=null;nc.hasProperty(rc.a.nDd)&&nc.hasProperty(rc.a.NFc)&&(Ei=nc.getValue(rc.a.nDd),Db=nc.getValue(rc.a.NFc));ye=Je.k(nc,x.a.nil).toString();const Vb=Je.h(nc,x.a.nil).toString(),
Sc=nc.ia(rc.a.jaa,!1),bd=nc.ia(rc.a.QL,null),Ud=nc.ia(rc.a.Ahb,!1),sf=this.QCb(Sb);Tc=new N.Comment(this.ih.ofb?je:td,td,Tc,Xe||new Date(se),this.ih.ofb?this.ned.Z3h(bd):bd,Sc,sf,N.Comment.UTi,Ud,Db,Ei,Ze);Tc.aDc=ye;Tc.$Cc=Vb;Tc.objectId=nc.id.toString();Tc.l_a=je;this.Yjh(je,td);Sb.fd(39);return Tc}Yjh(Sb,nc){(!Sb||Number.parseInvariant(Sb)>=dd.a.EGi)&&ja.ULS.sendTraceTag(544022547,327,10,`Durable Id is invalid ${Sb}`);nc||ja.ULS.sendTraceTag(544022548,327,10,`Guard Id is invalid ${nc}`);try{this.ned.Ckk(Sb,
nc)}catch(Tc){"DuplicateDurableId"===Tc.message?ja.ULS.sendTraceTag(544511521,327,10,`Duplicate Durable Id: ${Sb} with Guard Id: ${nc}`):"DuplicateGuardId"===Tc.message?ja.ULS.sendTraceTag(544511522,327,10,`Duplicate GuardId: ${nc} with Durable Id: ${Sb}`):ja.ULS.sendTraceTag(544022549,327,10,`Unkown Error when adding to CommentIds map: ${Tc}`)}}QCb(Sb){var nc;if(40!==Sb.Xe)return ja.ULS.sendTraceTag(594379426,327,15,"Trying to get text from node of type: {0}",Sb.Xe),this.bpc.fgg([]);let Tc=Sb.Xe+
":";const td=Sb.pq();0<td?(Sb.Sd(),Tc+=Sb.Xe+":"):(ja.ULS.sendTraceTag(509642946,327,15,`Comment has no paragraphs. ${null===(nc=Sb.currentNode)||void 0===nc?void 0:nc.id}`),nc=new yc.a,nc.inStaging=!0,this.JJ.logKpiFailure(Kf.a.U1b,"CommentContentNotFound",{isIntentional:!1,isInternal:!0},{name:Kf.a.qDd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:nc},Rd.a));nc=Array(td);for(let je=0;je<td;je++){Sb.Sd();Tc+=Sb.Xe+":";const se=Sb.currentNode;se.WFb=!0;nc[je]=se;se.qa||ja.ULS.sendTraceTag(594363293,
327,15,"[GetCommentText_Crash] "+Tc);!se.qa&&this.ih.l7n&&(u.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordSendErrorReportOnCommentInboundCrashSettings"),this.Lp());Sb.wc();Sb.Wj();Tc+=je<td-1?":"+Sb.Xe+":":":"}return this.bpc.fgg(nc)}Lp(){if(xb.WoncaApp.Gje){var Sb=new gb.a(!0,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportTitle,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportDescription,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportPrivacyStatement);Sb.zd=
1;Sb.Ge(1,WoncaIntl.WoncaStrings.l_SendErrorReport);Sb.Ge(0,WoncaIntl.WoncaStrings.l_NoThanks);Sb.MU(1);Sb.Sw(ab.a.D8e,CommonUIStrings.l_DefaultDialogTitle,WoncaIntl.WoncaStrings.l_InboundingCommentFailed,this.hfl,!1)}else this.X5.nB(ab.a.D8e,this.Rzi)}sNd(Sb){if(!Sb||!Sb.objectId)return"";Sb=x.a.Gf(Sb.objectId);Sb=this.ud.Db(Sb);return this.lnf(Sb)}W_l(Sb){return this.sNd(Sb.Ff?this.pD(Sb.Ff):Sb)}gMn(Sb,nc){if(this.jd.isFeatureEnabled(114))if(this.ih.removePersonalInformation)ja.ULS.sendTraceTag(595128897,
3003,50,"RecordTaskChanges no ops because filter PII flag on"),this.DLb();else{this.EXa.hy(Xa.a.s$f);var Tc=null===nc||void 0===nc?void 0:nc.taskId,td=!Tc;td?this.EXa.logKpiUsage(Ph.a.pje,0):this.EXa.logKpiUsage(Ph.a.qje,0);try{const ye=this.BVb.value,Ei=this.sNd(Sb);if(""===Ei)this.p1d(td,"FailedDurableIdForComment");else{var je=this.W_l(Sb);if(""===je)this.p1d(td,"FailedDurableIdForParentComment");else if(td&&Sb.Ty.sessionType!==H.a.create&&Sb.Ty.sessionType!==H.a.reply)ja.ULS.sendTraceTag(42856725,
3003,10,"Unexpected create task for drafting session type [{0}]",Sb.Ty.sessionType),this.EXa.logKpiFailure(Ph.a.pje,"FailedTaskCreateInvalidSessionType");else{var se=null;Sb.Ty.sessionType!==H.a.metadata&&(se=Ei);var Ze=this.a1g.value;var Xe=M.a.mf(Sb.text)?Ze.UZh(se,nc,td):Ze.UZh(se,nc,td,Sb.text[0]);0<Xe.length?td?(ye.veb(Number.parseInvariant(je),Xe)||this.EXa.logKpiFailure(Ph.a.pje,"TaskCreateFailed"),this.DLb()):(this.EXa.logKpiUsage(Ph.a.qje,0),ye.Mwk(Tc,Xe)||this.EXa.logKpiFailure(Ph.a.qje,
"TaskEngagementFailed")):this.p1d(td,"HistoryRecordsLengthZero")}}}catch(ye){this.p1d(td,"RecordTaskChangesFailed")}}}p1d(Sb,nc){const Tc={name:Ph.a.bAo,isInternal:!0};Sb?this.EXa.logKpiFailure(Ph.a.pje,nc,Tc):this.EXa.logKpiFailure(Ph.a.qje,nc,Tc)}Fxd(Sb,nc){if(Sb){var Tc=u.AFrameworkApplication.userName,td=nc.toString();Sb.usersByReactionType||(Sb.usersByReactionType={});var je=Sb.usersByReactionType[td];Tc=new T(this.jY,this.u4a,Tc);Tc.DateUtc=new Date;je?je.push(Tc):Sb.usersByReactionType[td]=
[Tc];ja.ULS.sendTraceTag(572014993,327,50,"Reaction type {0} added to {1} with Object Id: {2} ",nc,Sb.Ff?"reply":"parent",Sb.objectId);td=[Sb];this.JJ.hy(vg.a.JVk,{succeeded:!0,customData:{reactionType:U[nc]}});this.Y1c(td,W.addReaction);this.Yte.add(Sb.id)}}kbe(Sb,nc){if(Sb&&Sb.usersByReactionType){var Tc=Sb.usersByReactionType[nc.toString()];if(Tc&&Tc.length){for(let td=0;td<Tc.length;td++)if(Tc[td].UserId===this.jY){Array.removeAt(Tc,td);break}ja.ULS.sendTraceTag(572014994,327,50,"Reaction type {0} removed from {1} with Object Id: {2} ",
nc,Sb.Ff?"reply":"parent",Sb.objectId);Tc=[Sb];this.JJ.hy(vg.a.KVk,{succeeded:!0,customData:{reactionType:U[nc]}});this.Yte.delete(Sb.id);this.Y1c(Tc,W.removeReaction)}}}Y1c(Sb,nc){const Tc=this.Ic.Qc(15);Tc.Eb(this.zIa);this.my.NE.Q6(3);switch(nc){case W.deleteComment:for(nc=0;nc<Sb.length;nc++){var td=Sb[nc];if(td.er===m.a.beingCreated)this.ih.contentNavigationApiEnabled&&this.Wyc.remove(td.Ty.draftId),this.rK.Uig();else{var je=x.a.Gf(td.objectId);(je=this.ud.Db(je))&&dd.a.SGd(je,this.ud);ja.ULS.sendTraceTag(39364559,
327,50,`Deleting Comment: [CommentObjectId:${td.objectId}]`);this.ih.Hta&&this.lI&&(td.Ff?this.lI.fireEvent(10,{comment:td,changeType:"replyDeleted"}):this.lI.fireEvent(7,{comment:td}));this.ih.contentNavigationApiEnabled&&this.Wyc.remove(td.id)}}break;case W.addComment:this.ej.mode=1;Sb=Sb[0];Sb.date=new Date;nc=this.E5k(Sb);td=nc.getValue(rc.a.wE).toString();Sb.l_a=td;this.ih.ofb&&this.Xqc.set(td,Sb.id);td=Sb.text;je=this.QMd();if(Sb.Ff){var se=this.pD(Sb.Ff),Ze=this.ud.Db(x.a.Gf(se.objectId));
nc.setValue(rc.a.QL,Ze.getValue(rc.a.gH));this.addReply(nc,td,this.ud,je,Ze);ja.ULS.sendTraceTag(39364560,327,50,`Adding Reply: [ObjectId:${Sb.objectId}][ParentObjectId:${se.objectId}]`)}else(se=this.nb.hb.lb)&&se.Qa&&(nb.SelectionEditor.hm(se)&&(Ze=nb.SelectionEditor.b3(se.Qa,!1))&&(this.nb.setSelection(Ze),se=Ze,ja.ULS.sendTraceTag(592569872,327,50,"[RecordChanges] Selection extended")),Va.ParagraphReader.Yb(se.Qa.node)&&Va.ParagraphReader.Yb(se.Rc.node)&&(this.ayb(nc,td,je,se),ja.ULS.sendTraceTag(39364561,
327,50,`Adding Comment: [ObjectId:${Sb.objectId}]`)));td=nc.ia(rc.a.gH,null);Sb.LOa=td;Sb.kSa=P.a.sentToServer;Sb.kSa=P.a.succeeded;Sb.objectId=nc.id.toString();this.F0f(Sb);this.gDj(Sb);this.Yjh(Sb.l_a,Sb.LOa);this.ih.Hta&&this.lI&&(Sb.Ff?this.lI.fireEvent(10,{comment:Sb,changeType:"replyAdded"}):this.lI.fireEvent(11,{comment:Sb}));break;case W.editComment:this.ej.mode=1;Sb=Sb[0];nc=x.a.Gf(Sb.objectId);nc=this.ud.Db(nc);td=Sb.LOa;Sb.LOa||(td=nc.getValue(rc.a.gH),ja.ULS.sendTraceTag(554446870,327,
15,`Missing GuardID for Comment with objectId ${Sb.objectId} while editing`),td=this.ih.ofb?td:Sb.id);this.uyj(nc,Sb.text,td);ja.ULS.sendTraceTag(39364562,327,50,`Editing Comment: [CommentObjectId:${Sb.objectId}]`);Sb.kSa=P.a.sentToServer;Sb.kSa=P.a.succeeded;this.ih.Hta&&this.lI&&this.lI.fireEvent(10,{comment:Sb,changeType:Sb.Ff?"replyEdited":"edited"});break;case W.addReaction:case W.removeReaction:nc=Sb[0];Sb=x.a.Gf(nc.objectId);Sb=this.ud.Db(Sb);(nc=(nc=nc.usersByReactionType)?Gb.c(nc):"")&&Sb.setValue(rc.a.a7,
nc);break;case W.done:case W.undone:for(nc=0;nc<Sb.length;nc++)td=Sb[nc],je=x.a.Gf(td.objectId),this.ud.Db(je).setValue(rc.a.jaa,td.done),ja.ULS.sendTraceTag(594124932,327,50,`${td.done?"Resolved":"Re-opened"} Comment: [CommentObjectId:${td.objectId}]`),this.ih.Hta&&this.lI&&this.lI.fireEvent(10,{comment:td,changeType:td.done?"resolved":"reopened"})}this.Dm.QE();ja.ULS.sendTraceTag(572281361,327,50,"Disposing transaction, should raise context reload event");Tc.dispose()}QMd(){const Sb=new Sa.GraphIterator;
Sb.set(this.my);this.sCa.G3a(Sb);return Sb}K4c(){return this.Sbj(!0)}L4c(){return this.Sbj(!1)}Sbj(Sb){if(!this.Zg.length)return null;let nc=this.Gy;do{if(nc){const Tc=this.ih.Kq&&!this.wj.yn;nc=Sb?this.bPl(nc,Tc):this.cPl(nc,Tc)}else nc=Sb?this.Zg[0]:this.Zg[this.Zg.length-1];if(!nc)return null}while(nc.Ff&&""!==nc.Ff);this.selectComment(nc);return nc}WGh(Sb,nc,Tc,td,je){const se=this.MSj.create(1074135127);this.ih.removePersonalInformation&&(nc=CommonUIStrings.l_RemovedAuthorName,Tc=null);se.setValue(rc.a.commentId,
V.a.aF());se.setValue(rc.a.wE,dd.a.knf());se.setValue(rc.a.aNa,u.AFrameworkApplication.userSessionId);se.setValue(rc.a.gH,Sb);se.setValue(rc.a.R1b,nc);se.setValue(rc.a.LCh,nc);se.setValue(rc.a.OFc,Tc?Y.a.Bjf(Tc,"MM/dd/yyyy HH:mm:ss",Y.a.dataCulture):"");se.setValue(rc.a.qCa,Tc);se.setValue(rc.a.jaa,td);je&&(Sb=je?Gb.c(je):"",se.setValue(rc.a.a7,Sb));se.setValue(rc.a.NFc,this.jY);se.setValue(rc.a.nDd,this.u4a);return se}E5k(Sb){var nc;const Tc=this.WGh(Sb.id,Sb.author,Sb.date,Sb.done,null!==(nc=Sb.usersByReactionType)&&
void 0!==nc?nc:{});Sb.Ff&&(this.ih.ofb?((nc=this.ned.MQl(Sb.Ff))||ja.ULS.sendTraceTag(555008772,327,10,`Missing guardId for Comment With Durable Id ${Sb.Ff}`),Sb=nc):Sb=Sb.Ff,Tc.setValue(rc.a.QL,Sb));return Tc}addReply(Sb,nc,Tc,td,je){this.addComment(Sb,nc,td);nc=de.nlh(Sb,Tc,je,!0);Tc=de.nlh(Sb,Tc,je,!1);nc&&Je.v(Sb,nc.Kb.paragraph.id);Tc&&(Je.u(Sb,Tc.Kb.paragraph.id),Tc.Kb.paragraph.id||ja.ULS.shipAssertTag(5564303,327,!1,"Comment node has no end anchor!"))}ayb(Sb,nc,Tc,td){this.addComment(Sb,nc,
Tc);let je,se;({start:nc,end:je,startCp:Tc,endCp:se,brh:Ze}=this.pJk());Ze&&(td.Qa.node===nc&&(Tc=zb.a.Agb(td,!0)),td.Rc.node===je&&(se=zb.a.Agb(td,!1)));if(-1===Tc||-1===se){this.DWg||0!==this.iTb||(this.JJ.logKpiFailure(Kf.a.z6e,"DraftSelectionLost",{isInternal:!0},{name:Kf.a.T1b,isInternal:!0}),this.DWg=!0);nc=td.Qa.node;Tc=zb.a.Agb(td,!0);je=td.Rc.node;se=zb.a.Agb(td,!1);if(2<td.length){var Ze=[];for(let Xe=0;Xe<td.length;Xe++)Ze.push(td.J(Xe).node.id);this.Rkh(Sb,Ze)}ja.ULS.sendTraceTag(51233603,
327,50,"Intents invalid reason {0}",this.iTb)}else if(2<this.PY.length){Ze=[];for(td=0;td<this.PY.length;td++)Ze.push(this.PY[td].yec);this.Rkh(Sb,Ze)}dd.a.UZb(nc,Sb.id,Tc,!0);dd.a.UZb(je,Sb.id,se,!1);Je.v(Sb,nc.id);Je.u(Sb,je.id);this.lxj();je.id||ja.ULS.shipAssertTag(5564304,327,!1,"Comment node has no end anchor!")}Rkh(Sb,nc){if(!(2>=nc.length||!Sb||Je.s(Sb))){this.wj.tU.add(Sb.id,new lb.a(new cc.a));for(var Tc=x.a.Sp(nc[0],nc[1])?2:1,td=nc.length-2;Tc<=td;Tc++){const je=nc[Tc];this.wj.Ax.ob(je)?
this.wj.Ax.J(je).uM||(this.wj.Ax.J(je).uM=new lb.a(new cc.a)):this.wj.Ax.add(je,new vf.a(!0));this.wj.Ax.J(je).e1a=!0;this.wj.Ax.J(je).uM.add(Sb.id);this.wj.tU.J(Sb.id).add(je)}}}pJk(){let Sb=null,nc=-1,Tc=null;var td=-1;let je=!1;if(!this.PY.length||2!==this.iTb)return{start:Sb,end:Tc,startCp:nc,endCp:td,brh:je};Sb=this.ud.Db(this.PY[0].yec);Tc=1===this.PY.length?Sb:this.ud.Db(this.PY[this.PY.length-1].yec);if(Va.ParagraphReader.Yb(Sb)&&Va.ParagraphReader.Yb(Tc)){td=Ze=>3===Ze.type;let se=this.zm.yOa(Sb,
3,td);nc=0<se.count?se.J(0).begin:-1;Sb!==Tc&&(se=this.zm.yOa(Tc,3,td));td=0<se.count?se.J(0).end:-1;-1===nc&&null!=Sb&&(nc=Sb.qa.first.cp,je=!0,ja.ULS.sendTraceTag(524862562,327,50,"Draft Anchor startCp was adjusted"));-1===td&&null!=Tc&&(td=Tc.qa.last.cp,je=!0,ja.ULS.sendTraceTag(524862563,327,50,"Draft Anchor endCp was adjusted"))}this.iTb=-1===nc||-1===td?0:2;return{start:Sb,end:Tc,startCp:nc,endCp:td,brh:je}}lxj(){for(const Sb of this.PY){const nc=this.ud.Db(Sb.yec);Va.ParagraphReader.Yb(nc)&&
this.zm.Y6a(nc,3)}this.PY=[];this.iTb=2}addComment(Sb,nc,Tc){Sb.anchor||(Tc.Qf(Sb,1),Tc.Fi(Sb),this.hej(Sb,nc,Tc))}hej(Sb,nc,Tc){let td=0;var je=null;nc=this.bpc.UCo(nc,se=>{const Ze=new Ub.a;Tc.Qf(Ze,1);Tc.Fi(Ze);Tc.Qf(se,2);Tc.Fi(se);Tc.wc();Tc.wc()});for(let se=0;se<nc.length;se++)je=nc[se],td=je.getValue(rc.a.Lc),de.paragraphEditor.ETa(je),de.IJ&&de.IJ.KMa&&de.IJ.$Ga(Zb.a.create(je));Sb.setValue(rc.a.gH,td.toString());return je}zib(Sb,nc){return this.Axm(Sb,nc)}Shm(){return 0<this.PY.length}nAb(Sb,
nc,Tc){return Sb.Qa&&Va.ParagraphReader.Yb(Sb.Qa.node)&&Va.ParagraphReader.Yb(Sb.Rc.node)?(nc=this.WGh(Va.ParagraphReader.rQ(Sb.Rc.node).toString(),nc?nc:u.AFrameworkApplication.userName,new Date,!1,{}),Tc||(Tc=new E.a,Tc.lga("\n")),this.ayb(nc,[Tc.IMc()],this.QMd(),Sb),nc):null}Ds(Sb){return!this.wVe.lag(this.sMc(Sb.getValue(rc.a.wE)))}uyj(Sb,nc,Tc){const td=new Sa.GraphIterator;for(td.set(Sb);td.Sd();)td.Dg();this.hej(Sb,nc,td).Yg(rc.a.Lc,Number.parseInvariant(Tc));Sb.setValue(rc.a.gH,Tc);if(nc=
this.WZ(Sb.id.toString()))nc.BEh=!1;Sb.setValue(rc.a.Ahb,!1)}tyj(Sb,nc){this.uyj(Sb,[Sys.Serialization.JavaScriptSerializer.serialize(nc)],Sb.getValue(rc.a.gH))}jG(Sb){Sb=this.ud.Db(x.a.Gf(Sb));return!!Sb&&Sb.ia(rc.a.jG,!1)}jWi(Sb){Sb=this.ud.Db(x.a.Gf(Sb));return!!Sb&&Sb.ia(rc.a.jEh,!1)}ozm(Sb){const nc=Je.j();return Sb&&nc.has(Sb.objectId)}xFm(Sb){const nc=this.ud.Db(x.a.Gf(Sb));return nc?this.L$b(nc):(ja.ULS.sendTraceTag(562562755,341,15,"CommentNode is null, commentObjectId: "+Sb),!1)}L$b(Sb){var nc=
Sb.id,Tc=Je.k(Sb),td=Je.h(Sb);if(!x.a.Sp(Tc,td))return!1;Tc=Sb.Mc.Db(Tc);if(!Tc)return!1;td=({bFc:Sb}=this.LGc(Tc,nc,!0)).returnValue;var je=({bFc:nc}=this.LGc(Tc,nc,!1)).returnValue;if(-1===td||-1===je)return!1;Tc=Tc.qa;td=Tc.J(Sb);je=Tc.J(nc);if(!td.hyperlink||!td.hyperlink.iG||!je.Km)return!1;for(Sb+=1;Sb<nc;Sb++)if(td=Tc.J(Sb),td.hyperlink||td.Km)return!1;return!0}Nuf(){return de.bim(this.Zg,Sb=>this.jG(Sb),Sb=>this.jWi(Sb))}LGc(Sb,nc,Tc){let td;for(td=0;td<Sb.qa.length;td++){const je=Sb.qa.J(td);
if(je.uf)for(let se=0;se<je.uf.length;se++){const Ze=je.uf.J(se);if(Ze.Tj.equals(nc)&&Ze.Oc===Tc)return{returnValue:je.cp,bFc:td}}}return{returnValue:-1,bFc:td}}zMh(Sb){if(this.wj.tU.ob(Sb)){const nc=new Fb.a;for(const Tc of this.wj.tU.J(Sb))this.qSn(Tc,Sb,nc);this.wj.tU.remove(Sb);db.b(nc)}}rjg(Sb,nc){if(Sb.objectId){Sb=x.a.Gf(Sb.objectId);var Tc=this.ud.Db(Sb);if(Tc){var td=Je.k(Tc,x.a.nil);Tc=Je.h(Tc,x.a.nil);td.equals(x.a.nil)||nc.add(this.ud.Db(td));Tc.equals(x.a.nil)||nc.add(this.ud.Db(Tc));
if(this.wj.tU.ob(Sb))for(const je of this.wj.tU.J(Sb))nc.add(this.ud.Db(je))}}}qSn(Sb,nc,Tc){let td;({value:td}=this.wj.Ax.Ec(Sb,td));td&&(td.uM.remove(nc),td.uM.count||(td.e1a=!1,Tc.add(this.ud.Db(Sb))))}static get paragraphEditor(){return null!=de.VBg?de.VBg:de.VBg=y.a.instance.resolve("Box4.IParagraphEditor")}static getInstance(){return de.Sl()}static Sl(){if(de._instance)return de._instance;const Sb=new da.a(()=>(new jb(!0,!0,!0)).m2k()),nc=y.a.instance;de._instance=new de(new da.a(()=>Hb.App.ya.jb.Wc),
new da.a(()=>Hb.App.ya.jb.xc.Zc),new da.a(()=>fd.a.instance),new Wb.a,new hc,new da.a(()=>Mb.a.instance),nc.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),nc.resolve("WordEditor.Comments.ICommentFormatTranslator"),nc.resolve("Common.IAppSettingsManager"),nc.resolve("Box4.IFeatureHelper"),nc.resolve("Box4.Intent.IIntentRangeEditor"),new da.a(()=>Hb.App.A0),nc.resolve("Box4.IKickoutExecutor"),nc.We("WordEditor.Tasks.ITaskActor"),Sb,nc.resolve("WordEditor.Comments.CommentsSettings"),
nc.resolve("Box4.IUndoManager"),nc.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),nc.resolve("WordEditor.Comments.CommentsState"),nc.resolve("WordEditor.Comments.WordCommentEventsActor"),nc.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),nc.resolve("WordEditor.Comments.ITasksUsageAndHealthLogger"),nc.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentModel"),Hb.App.jk.Kl.af(12),nc.resolve("Box4.ParagraphRenderEvents"),nc.resolve("Box4.CatchUpActivity.IChangeIdEditor"),
nc.Sa("WordEditor.Extension.RichApiEventManager"));return de._instance}static nlh(Sb,nc,Tc,td){nc=dd.a.Iaa(Tc,nc,td);if(!nc)return null;nc=nc.Kb.uf;return dd.a.Exd(Sb.id,nc,nc.J(0).Pu,td)}Axm(Sb,nc){if(Hb.App.lostSession||(nc?!Hb.App.Ds:!Hb.App.Ds&&!Hb.App.Lm)||1===Sb.mode||!Object($b.a)(Ec.PageView,Qa.InteractiveViewManager.instance.vd))return!1;Sb=this.MEl();return!Sb||sb.a.instance.JZ(Sb)||sb.a.instance.Gna(Sb)||Sb.contextId===Jb.a.anchoredObject||pc.a.QAf(Sb)&&pc.a.l$b()?!1:!0}MEl(){const Sb=
Qa.InteractiveViewManager.instance.vd;var nc=Sb.nb.pg;this.qzm()&&this.Xx&&Ya.o(nc.node)&&(nc=Sa.GraphIterator.$a(nc.node),nc.Ab(12),nc=nc.jo(12),nc=Qb.SelectionFactory.Ila(nc),Sb.nb.setSelection(nc),nc=Sb.nb.pg);return nc}qzm(){var Sb;return null===(Sb=this.Na)||void 0===Sb?void 0:Sb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCommentInLoopsBugFixEnabled",!1)}static bim(Sb,nc,Tc){const td=new Fb.a,je=new Fb.a,se=new rb.a,Ze=new rb.a;for(const Ei of Sb){var Xe=Ei.id,ye=Ei.objectId;Sb=Ei.done;
const Db=!!ye&&nc(ye);Xe&&(Sb&&td.add(Xe),Db&&je.add(Xe),ye&&se.Z(Xe,ye));if(Xe=Ei.Ff)({value:ye}=Ze.Ec(Xe,0)).returnValue||(ye=0),Ze.Z(Xe,ye+1);if(!Xe&&!Sb&&!Db)return!0}for(const Ei of je){if(td.contains(Ei))continue;let Db;if(({value:Db}=se.Ec(Ei,Db)).returnValue&&Tc(Db))return!0;let Vb;if(({value:Vb}=Ze.Ec(Ei,0)).returnValue&&0<Vb)return!0}return!1}XIl(Sb){const nc=[];let Tc=this.Zg.findIndex(td=>td.id===Sb);if(-1<Tc)for(nc.push(this.Zg[Tc]);++Tc<this.Zg.length&&this.Zg[Tc].Ff===Sb;)nc.push(this.Zg[Tc]);
return nc}oNl(Sb){return this.ned.Z3h(Sb)}}de._instance=null;de.IJ=null;Object(l.a)(de,"EditorCommentModel",e.a,[538,539,540])},1742:function(D,L,c){var l=c(66);D=c(0);var e=c(398),a=c(118),k=c(48),x=c(321),y=c(3),m=c(8),u=c(18),z=c(1606),v=c(1564);class E{constructor(ja,sa,ta=!1){this.paragraphNode=ja;this.role=sa;this.mnj=ta}}Object(D.a)(E,"DesignerReviewActionData",null,[]);class F{constructor(ja,sa,ta){this.paragraphNode=ja;this.wq=sa;this.role=ta}}Object(D.a)(F,"TriageActionData",null,[]);class J extends F{constructor(ja,
sa){super(ja,0,sa)}}Object(D.a)(J,"RoleTriageActionData",F,[]);class K extends F{constructor(ja,sa,ta){super(ja,1,27);this.styleId=sa;this.gT=ta}}Object(D.a)(K,"PullQuoteTriageActionData",F,[]);class H extends F{constructor(ja,sa){super(ja,2,28);this.nna=sa}}Object(D.a)(H,"ImageTriageActionData",F,[]);class P{constructor(ja,sa){this.paragraphNode=ja;this.kHb=sa}}Object(D.a)(P,"ViewOriginalActionData",null,[]);var N=c(149),M=c(1507),I=c(1678);class T{constructor(ja,sa){this.currentNode=ja;this.nextNode=
sa}}Object(D.a)(T,"ReviewNavigationArgs",null,[]);class U{constructor(ja,sa){this.paragraphNode=ja;this.isVisible=sa}}Object(D.a)(U,"ReviewVisibilityArgs",null,[]);class W{constructor(ja){this.rbk=ja}getSelectedOption(){return this.rbk}getSeparatorIndexes(){return[1]}}Object(D.a)(W,"DesignerPreviewData",null,[]);var V=c(555),Y=c(940),da=c(1679);c.d(L,"a",function(){return ba});class ba extends Y.a{constructor(ja,sa,ta,ra,ma,Ba,Pa,Da,Ha,oa,wa,ia){super();this.rc=ja;this.ie=sa;this.gHd=ta;this.KEa=
ra;this.hl=ma;this.wB=Ba;this.Euj=Pa;this.Vl=Da;this.Cw=Ha;this.hHd=oa;this.Vr=wa;this.bkf=ia;this.kcb=null;this.Xcd=void 0;this.Aue=0;this.XG=[V.a.WMh]}get types(){return this.XG}get hcj(){return Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress}get d9d(){return 0}zmo(ja){return 3!==ja.suggestion.wq&&!this.Cw.isVisible&&(!this.Aue||!ja.wyb&&1===this.Aue)}OM(ja){var sa;if(!ja.source||e.SessionStatusManager.instance.xj)return!1;const ta=ja.rl;var ra=this.KEa.rNc(ta,1);if(!ra||!ra.count)return!1;
const ma=ra.J(0).intent;if(ja.Vic)return.5!=(null===ma||void 0===ma?void 0:ma.state)&&4!=(null===ma||void 0===ma?void 0:ma.state);const Ba=ta.node;if(0==(null===ma||void 0===ma?void 0:ma.state)&&(2==(null===ma||void 0===ma?void 0:ma.suggestion.wq)||1==(null===ma||void 0===ma?void 0:ma.suggestion.wq)))return ma.wyb(),this.KEa.Y6a(Ba,1),this.wB.P_i(new I.a(Ba,1)),!0;if(1==ja.source&&27==(null===ma||void 0===ma?void 0:ma.dib)&&(.5==(null===ma||void 0===ma?void 0:ma.state)||4==(null===ma||void 0===ma?
void 0:ma.state)))return!1;ra=this.Cw.isVisible?this.gHd.Cel(Ba):new da.a(0,1);let Pa;const Da=this.mTl(null===(sa=null===ma||void 0===ma?void 0:ma.suggestion)||void 0===sa?void 0:sa.wq);sa=this.vk.Ppa(ta,{id:"Intent-"+V.a.WMh,suggestionGroups:[{type:Da,id:Da,title:ma.description,snippet:this.xzn(this.hl.plainText(ta.node)),snippetFormatting:[],supportedActions:this.Olf(null===ma||void 0===ma?void 0:ma.suggestion,!0),suggestions:({v6n:Pa}=this.FJh(Ba)).returnValue,previewData:Pa?new W(Pa):null,isContentPending:!1}],
setSize:ra.count,positionInSet:ra.index},this,ja.XPa,!1,()=>{var Ha;this.wB.Q_i(new U(Ba,!0));this.Cw.isVisible||3===(null===(Ha=null===ma||void 0===ma?void 0:ma.suggestion)||void 0===Ha?void 0:Ha.wq)||this.Aue++},()=>{this.wB.Q_i(new U(Ba,!1))},null,!1,Ha=>{Ha.showDesignerButton=!this.Cw.isVisible;Ha.shouldSkipTwoStepReview=!0;Ha.isFormattingSuggestion=0==ma.suggestion.wq;Ha.isMultiParagraphSuggestion=1<ma.xN.length;Ha.proactivePromptHintType=this.zmo(ma)?x.e.HideFromReviewCardAndRibbon:x.e.None});
k.c(u.a.Hpn,sa,void 0,void 0,30);return sa}executeAction(ja,sa){var ta,ra,ma,Ba,Pa;if(!ja||!sa)return!1;const Da=this.Vl.bA(sa);m.ULS.sendTraceTag(541446529,3016,50,"Action: {0}; Role: {1}; Pane: {2};",ja.actionType,null===Da||void 0===Da?void 0:Da.role,this.Cw.isVisible);const Ha=this.hHd.MT(sa);try{switch(ja.actionType){case x.b.Accepted:const oa=this.rc.Rb(u.a.axd,2,new E(sa,null===Da||void 0===Da?void 0:Da.role,!0));this.hjg(fa=>{fa.supportedActions=this.Olf(null===Ha||void 0===Ha?void 0:Ha.suggestion,
!1)});return this.Cw.isVisible&&32===oa?this.DNf(sa):32===oa;case x.b.Rejected:const wa=this.rc.Rb(u.a.Xae,2,new E(sa,null===Da||void 0===Da?void 0:Da.role,!0));2===(null===Ha||void 0===Ha?void 0:Ha.suggestion.wq)||Object(M.e)(null===Ha||void 0===Ha?void 0:Ha.suggestion)||this.m$c(sa,!1);2===(null===Ha||void 0===Ha?void 0:Ha.suggestion.wq)&&this.vk.dismiss();return this.Cw.isVisible&&32===wa?this.DNf(sa):32===wa;case x.b.Next:case x.b.Previous:return!this.Cw.isVisible||this.DNf(sa,ja.actionType===
x.b.Previous);case x.b.Apply:const ia=null===(ta=ja.suggestion)||void 0===ta?void 0:ta.contentData;let ca;switch(null===ia||void 0===ia?void 0:ia.wq){case 0:ca=new J(sa,ia.role);break;case 1:case 3:const fa=ia.B4a;m.ULS.sendTraceTag(541446530,3016,50,"Changing PullQuote style: {0}",{["suggestionId"]:null===(ra=null===Ha||void 0===Ha?void 0:Ha.suggestion)||void 0===ra?void 0:ra.id,["newStyleId"]:fa});Ha.suggestion.B4a=fa;ca=new K(sa,fa,a.a.create());break;case 2:ca=new H(sa,ia.nna);break;default:return m.ULS.shipAssertTag(527459665,
3016,!1,String.format("DesignerSuggestionType: {0}",ia.wq)),!1}this.vk.focus();const pa=this.rc.Rb(u.a.changeDesignerRole,2,ca);this.m$c(sa,!1);return 32===pa;case x.b.AcceptAll:return 32===this.rc.Rb(y.a.Dcb,2,new z.a(2));case x.b.RejectAll:return 32===this.rc.processAction(u.a.t2c,2);case x.b.SnoozeAll:return 32===this.rc.processAction(u.a.designerSnoozeContextualSuggestions,2);case x.b.Undo:const Ma=this.rc.Rb(u.a.gIa,2,new E(sa,null===Da||void 0===Da?void 0:Da.role));this.m$c(sa,!0);return 32===
Ma;case x.b.OpenDesignerPane:return 32===this.rc.Rb(u.a.NHa,2,new v.a(6));case x.b.ViewOriginal:const ya={kHb:ja.descriptorData.isViewingOriginal,L8f:ja.descriptorData.setIsViewingOriginal};if(void 0==(null===ya||void 0===ya?void 0:ya.kHb)||void 0==(null===ya||void 0===ya?void 0:ya.L8f))return m.ULS.shipAssertTag(538789889,3016,!1,String.format("isViewingOriginal: {0}; setIsViewingOriginal: {1}",null===ya||void 0===ya?void 0:ya.kHb,null===ya||void 0===ya?void 0:ya.L8f)),!1;this.vk.focus();const Oa=
this.rc.Rb(u.a.Rbf,2,new P(sa,ya.kHb));ya.L8f(!ya.kHb);this.m$c(sa,!0);return 32===Oa;case x.b.GiveFeedback:switch(null===(ma=null===Ha||void 0===Ha?void 0:Ha.suggestion)||void 0===ma?void 0:ma.wq){case 0:return this.Vr.invokeUserFeedback(N.a.TMj),!0;case 1:case 3:return this.Vr.invokeUserFeedback(N.a.ZMj),!0;case 2:return this.Vr.invokeUserFeedback(N.a.VMj),!0;default:return m.ULS.shipAssertTag(537658138,3016,!1,String.format("DesignerSuggestionType: {0}",null===(Ba=null===Ha||void 0===Ha?void 0:
Ha.suggestion)||void 0===Ba?void 0:Ba.wq)),!1}case x.b.ShowMore:switch(null===(Pa=null===Ha||void 0===Ha?void 0:Ha.suggestion)||void 0===Pa?void 0:Pa.wq){case 2:m.ULS.sendTraceTag(527210449,3016,50,"User clicked show more images"),Ha.suggestion.kom(),this.m$c(sa,!0,!0)}return!0;default:return!1}}catch(oa){return m.ULS.shipAssertTag(572027277,3016,!1,String.format("{0} {1}",oa.message,oa.stack)),!1}}DNf(ja,sa=!1){const ta=this.gHd.P6b(ja,sa)||this.gHd.P6b(ja,!sa);this.wB.dHn(new T(ja,ta,!sa));return!ta||
this.gHd.IJi(this,ta)}jQl(ja){switch(ja.wq){case 0:case 1:case 3:return Object.assign(Object.assign({},x.h),{font:ja.font,cssColor:ja.color,fontSize:ja.fontSize,fontWeight:ja.bold?x.d.Bold:x.d.Normal,italic:ja.italic,underlineType:ja.underline?x.f.Single:x.f.None,backgroundImg:ja.backgroundImg});case 2:break;default:m.ULS.shipAssertTag(527569927,3016,!1,`${ja.wq}`)}}jSl(ja){if(2===ja.wq)return{src:ja.imageUrl,width:0,height:0,imageAltText:ja.altText}}FJh(ja){var sa=null;let ta=null;if(this.kcb=this.Euj.WYl(ja)){ta=
Array(this.kcb.options.length);for(ja=0;ja<this.kcb.options.length;ja++)sa=this.kcb.options[ja],ta[ja]={type:"DesignerTriageItem",id:String.format("DesignerTriageItem {0}",ja),title:sa.title,supportedActions:[x.b.Apply],contentData:sa,image:this.jSl(sa),titleFormatting:[this.jQl(sa)]};sa=(null===ta||void 0===ta?0:ta.length)?ta[this.kcb.selectedIndex]:void 0}return{returnValue:ta,v6n:sa}}hjg(ja){this.vk.definition?this.vk.definition.suggestionGroups?1===this.vk.definition.suggestionGroups.length&&
(ja(this.vk.definition.suggestionGroups[0]),this.vk.definition=this.vk.definition):m.ULS.sendTraceTag(512274571,3016,50,"UXManger.definition.suggestionGroups is null"):m.ULS.sendTraceTag(512274572,3016,50,"UXManger.definition is null")}m$c(ja,sa,ta=!1){const ra=this.hHd.MT(ja);this.hjg(ma=>{ma.supportedActions=this.Olf(null===ra||void 0===ra?void 0:ra.suggestion,sa);if(this.kcb){if(ta){var Ba=this.FJh(ja).returnValue;ma.suggestions=Ba}Ba=this.Euj.B4l(this.kcb.options,ja);ma.previewData=new W(ma.suggestions[Ba])}})}Olf(ja,
sa){const ta=[];sa?(ta.push(x.b.Accepted),ta.push(x.b.Rejected),0==(null===ja||void 0===ja?void 0:ja.wq)&&ta.push(x.b.ViewOriginal)):(ta.push(x.b.Next),ta.push(x.b.Undo));this.Cw.isVisible||(this.ie.Xzm()&&this.Ezk(ra=>{ra&&this.hjg(ma=>ma.supportedActions.push(x.b.GiveFeedback))})&&ta.push(x.b.GiveFeedback),this.ie.LAm()&&ta.push(x.b.OpenDesignerPane),ta.push(x.b.SnoozeAll));0===(null===ja||void 0===ja?void 0:ja.wq)&&ta.push(x.b.AcceptAll);ta.push(x.b.RejectAll);(null===ja||void 0===ja?0:ja.Aii())&&
ta.push(x.b.ShowMore);return ta}xzn(ja){const sa=ja.split(" ",10);return 10>sa.length?ja:sa.join(" ")+"\u2026"}static QAm(ja){return ja===V.a.XMh||ja===V.a.YMh||ja===V.a.bNh}mTl(ja){return 2===ja?V.a.YMh:1===ja||3===ja?V.a.bNh:V.a.XMh}Ezk(ja){void 0===this.Xcd&&this.bkf.execute(sa=>Object(l.__awaiter)(this,void 0,void 0,function*(){this.Xcd=yield sa.isFeatureEnabled(N.a.vJi,!1);ja(this.Xcd)}));return!!this.Xcd}}Object(D.a)(ba,"DesignerIntentProvider",Y.a,[])},1750:function(D,L,c){D=c(0);var l=c(531),
e=c(498),a=c(7),k=c(1463),x=c(1999),y=c(378),m=c(8),u=c(117),z=c(1518);class v{constructor(H,P,N){this.isVisible=H;this.elements=P;this.content=N}}Object(D.a)(v,"TooltipVisibilityArgs",null,[]);var E;(function(H){H[H.consistency=0]="consistency";H[H.Ddp=1]="pullQuote";H[H.bgp=2]="suggestedImage";H[H.Edp=3]="pullQuoteMenu";H[H.R7o=4]="designerPaste"})(E||(E={}));Object(D.b)("DesignerSuggestionType",E);var F=c(149),J=c(1680);c.d(L,"a",function(){return K});class K extends k.a{constructor(H,P,N,M,I,
T,U,W){super();this.xn=H;this.Uu=P;this.cSk=N;this.EIi=M;this.hl=I;this.wB=T;this.HH=U;this.xc=W;this.yta=this.oEa=null;this.onMouseEnter=V=>{V=V.Io;this.wB.i0i(new v(!0,[V.SDc],V.FDo));if(V.Qq&&0<V.Qq.length){const Y=this.HH.MT(V.Qq[0]);Y&&Y.suggestion.gYm()}return this.ifj(V)};this.Eoa=V=>{this.wB.i0i(new v(!1));return this.yAh(V.Io)};this.MFa=V=>{if(K.B2a(V.Io,this.yta))return!0;this.wB.eHn(z.a.create(V.Io.Qq[0]));return!0};this.QSf=(V,Y)=>{Y.data?Y.data.isVisible?this.x$n(Y.data.paragraphNode):
this.MQk():m.ULS.shipAssertTag(573850384,3016,!1)};this.wB.qYe(this.QSf)}Rbo(H){H?(H=this.oof(H))&&this.ifj(H):m.ULS.shipAssertTag(589693324,3016,!1)}cRk(){this.yAh(this.oEa)}Lnb(H){H=this.hl.Rl(H.Cb);return!!H&&this.HH.dUc(H)}reb(H){const P=H.xdb(0,F.a.MDk,this.zoom),N=[];N.push(this.GCa(H.b4,P,H.Vlc[0].y-H.cba[0].y));return N}GCa(H,P,N){var M,I=H.Og.ownerDocument;const T=l.a.createElement(I,e.a.div);T.className=F.a.HDk;T.style.left=P+"px";T.style.top=N+"px";P=l.a.createElement(I,e.a.div);P.className=
F.a.KDk;I=l.a.createElement(I,e.a.div);I.className=F.a.IDk;H=this.hl.Rl(H.Cb);N=this.HH.MT(H);if(null===(M=null===N||void 0===N?void 0:N.suggestion)||void 0===M?0:M.wq)I.className+=String.format(" {0}",E[N.suggestion.wq]);P.appendChild(I);T.appendChild(P);T.id=K.K0h(H);M=this.oof(H,T);1==M.NDk&&(I.className+=String.format(" {0}",F.a.JDk));this.yta&&this.yta.Qq.includes(H)?(T.className+=String.format(" {0}",F.a.s1e),this.yta=M):this.oEa&&this.oEa.Qq.includes(H)&&(T.className+=String.format(" {0}",
F.a.r1e),this.oEa=M);this.EIi(a.a.SQ,T,this.onMouseEnter,M);this.EIi(a.a.LK,T,this.Eoa,M);this.cSk(a.a.click,T,this.MFa,M);return T}x$n(H){if(H){var P=this.oof(H);P?(this.HH.MT(H)&&(H=Object.assign(new x.a,{action:0,type:3,eA:P,lJ:this.yta}),this.Uu.gF(H)),this.yta=P,K.B2a(this.oEa,this.yta)&&(this.oEa=null)):m.ULS.shipAssertTag(590112344,3016,!1)}else m.ULS.shipAssertTag(590112343,3016,!1)}MQk(){if(this.yta){var H=Object.assign(new x.a,{action:1,type:3,eA:null,lJ:this.yta});this.yta=null;this.Uu.gF(H)}}ifj(H){if(K.B2a(H,
this.yta)||K.B2a(H,this.oEa))return!0;const P=Object.assign(new x.a,{action:2,type:3,eA:H,lJ:this.oEa});this.oEa=H;this.Uu.gF(P);return!0}yAh(H){if(K.B2a(H,this.yta))return!0;H=Object.assign(new x.a,{action:3,type:3,eA:null,lJ:this.oEa});this.oEa=null;this.Uu.gF(H);return!0}oof(H,P){P=P?P:this.fGl(H);if(!P)return null;const N=this.HH.MT(H);return new J.a(0<(null===N||void 0===N?void 0:N.xN.length)?null===N||void 0===N?void 0:N.xN:[H],P,K.xei(N),K.gGl(N))}static xei(H){if(!H)return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion;
switch(H.suggestion.wq){case 0:return K.XVd(H.state)?WordEditorIntl.WordEditorStrings.L_ReviewUpdatedDesignerFormattingSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerFormattingSuggestion;case 1:case 3:return K.XVd(H.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerPullQuoteSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerPullQuoteSuggestion;case 2:return K.XVd(H.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerText2ImageSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerText2ImageSuggestion;
default:return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion}}static gGl(H){return H?K.XVd(H.state)?1:0:0}static XVd(H){return 0!==H&&.1!==H}fGl(H){var P=null,N=this.xn.Wf(H);N.Ab(11)&&(N.wc(),N=N.currentNode.Ej(this.xc.jc))&&(H=String.format("#{0}",K.K0h(H)),P=N.htmlElement.querySelector(H),!P&&Object(u.a)(y.a,N)&&(P=(P=N.Rhf())?P.querySelector(H):null));return P}static K0h(H){return String.format("p{0}{1}",H.id.guid,H.id.n)}static B2a(H,P){return!!P&&!!H&&H.SDc===P.SDc}}Object(D.a)(K,
"BlueDotActor",k.a,[420,421])},1752:function(D,L,c){D=c(0);var l=c(651);class e{constructor(k){this.LEa=k.pTl();this.qEb=k.gof("intCopy");this.R7d=k.r$h("intCopy");this.yzb=k.Tlf("intCopy");this.jdb=k.rlf("intCopy")}static GE(){return e.zr()}static zr(){return new e(l.a.instance)}}Object(D.a)(e,"InternalCopyUsageHelper",null,[]);c.d(L,"a",function(){return a});class a{constructor(k,x,y){this.oW=e.GE();this.nCd=null;this.BNb=this.tme=!1;this.lRg=null;this.source=k;this.target=x;this.cVf=y}get Ria(){return this.oW}get Go(){return this.lRg}set Go(k){this.lRg=
k}}Object(D.a)(a,"InternalCopyArguments",null,[])},1753:function(D,L,c){D=c(0);var l=c(1433);class e extends l.a{constructor(){super();this.LastAutoSaveErrorReported=0;this.LastAutoSaveCorrelation=null;this.MeritsErrorReport=!1;this.LocalCobaltMachineId=this.LocalCobaltSessionId=null;this.WaciiEnabledRequests=0;this.ShowMergePrompt=!1;this.PartMergeInfo=0}}Object(D.a)(e,"ALocalCobaltServerResponse",l.a,[]);c.d(L,"a",function(){return a});class a extends e{constructor(){super();this.RootCellId=null;
this.AvailableFileAccess=0;this.PageHtml=this.ClientKnowledge=this.LatestRevisionId=this.RevisionList=null;this.PinRevisionForAugLoopResponse=this.ContentBytes=0;this.RevisionIdPinnedForAugLoop=null;this.ScheduledShutdownTime=0;this.LastSavedToHostRevisionSequenceNumber=-1}}Object(D.a)(a,"GetChangesResponse",e,[])},1754:function(D,L,c){D=c(0);var l=c(67);class e extends Sys.EventArgs{constructor(){super()}}Object(D.a)(e,"UploadEventArgs",Sys.EventArgs,[]);c.d(L,"a",function(){return a});class a{constructor(){this.ra=
new l.a}Zjg(k){this.ra.raiseEvent("UploadStarted",new e(k,-1))}wlc(k,x){this.ra.raiseEvent("UploadComplete",new e(k,x))}static get instance(){return null!=a.czg?a.czg:a.czg=new a}}Object(D.a)(a,"Box4UploadNotifier",null,[645])},1757:function(D,L,c){D=c(0);var l=c(28),e=c(1045);class a extends e.a{isUserPromptField(J){return new k(J)}annotationStatusField(J){return new x(J)}annotationCharCountField(J){return new y(J)}userPromptCharCountField(J){return new m(J)}precedingTextsCharCountField(J){return new u(J)}followingTextsCharCountField(J){return new z(J)}promptTriggerSourceField(J){return new v(J)}promptIdField(J){return new E(J)}}
Object(D.a)(a,"AiInserterDataFieldsFactoryImpl",e.a,[]);class k extends l.a{constructor(J){super();this.name="isUserPrompt";this.bool=J}}Object(D.a)(k,"IsUserPromptDataField",l.a,[]);class x extends l.a{constructor(J){super();this.name="annotationStatus";this.int64=J}}Object(D.a)(x,"AnnotationStatusDataField",l.a,[]);class y extends l.a{constructor(J){super();this.name="annotationCharCount";this.int64=J}}Object(D.a)(y,"AnnotationCharCountField",l.a,[]);class m extends l.a{constructor(J){super();this.name=
"userPromptCharCount";this.int64=J}}Object(D.a)(m,"UserPromptCharCountField",l.a,[]);class u extends l.a{constructor(J){super();this.name="precedingTextsCharCount";this.int64=J}}Object(D.a)(u,"PrecedingTextsCharCountField",l.a,[]);class z extends l.a{constructor(J){super();this.name="followingTextsCharCount";this.int64=J}}Object(D.a)(z,"FollowingTextsCharCountField",l.a,[]);class v extends l.a{constructor(J){super();this.name="promptTriggerSource";this.string=J}}Object(D.a)(v,"PromptTriggerSourceField",
l.a,[]);class E extends l.a{constructor(J){super();this.name="promptId";this.string=J}}Object(D.a)(E,"PromptIdField",l.a,[]);l=c(953);c.d(L,"a",function(){return F});class F extends l.a{constructor(J){super(J,"AiInsert");this.fieldsFactory=new a}}Object(D.a)(F,"AiInserterTelemetryLoggerImpl",l.a,[])},1763:function(D,L,c){D=c(0);var l=c(299),e=c(293);class a{constructor(x,y,m,u,z,v,E){this.il=x;this.tg=y;this.zE=m;this.clickInputManager=u;this.y4c=z;this.LUi=v;this.NLh=E;this.iQ=this.jAb();this.zE.nea(this.iQ.name);
this.clickInputManager.XZb(this.iQ.name,this.il,this.iQ.GTa);x=this.f9e();this.tg.O0b(this.il,this.iQ,x)}focus(){this.tg.mg(this.iQ.name)}get isFocused(){return this.tg.currentScope===this.iQ}addIsFocusChangedHandler(x){this.iQ.E6(()=>x(!0));this.iQ.iYa(()=>x(!1))}Ukh(x){this.iQ.gYa(x)}dispose(){var x;this.tg.X4a(this.iQ.name);this.tg.currentScope||this.tg.mg(null!==(x=this.NLh)&&void 0!==x?x:e.a.$n)}jAb(){var x;const y=this.tg.fe(this.y4c);y.parent=null!==(x=this.LUi)&&void 0!==x?x:e.a.qp;y.GTa=
!0;y.Q3c=!0;y.zH=!0;return y}f9e(){const x=new l.DOMFocusListing(()=>this.il);x.In(8);return x}}Object(D.a)(a,"EditorAiFocusScopeImpl",null,[]);c.d(L,"a",function(){return k});class k{constructor(x,y,m,u){this.options=x;this.tg=y;this.zE=m;this.clickInputManager=u}registerScope(x){return new a(x,this.tg,this.zE,this.clickInputManager,this.options.y4c,this.options.LUi,this.options.NLh)}}Object(D.a)(k,"EditorAiFocusManagerImpl",null,[])},1788:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.authority=
this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static u0h(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(D.a)(l,"WopiAuthContext",null,[736])},1789:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.qpn="OneDriveWOPI";Object(D.a)(l,"HostApplicationType",
null,[])},1790:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.dFj="WAC_Word";l.bQc=null;Object(D.a)(l,"AddinHostApp",null,[])},1792:function(D,L){Object.defineProperty(L,"__esModule",{value:!0});L.RoleType=L.ErrorCode=void 0;(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(L.ErrorCode||(L.ErrorCode={}));(function(c){c[c.Unknown=0]="Unknown";c[c.Title=1]="Title";c[c.Subtitle=2]="Subtitle";c[c.Heading1=3]="Heading1";c[c.Heading2=4]="Heading2";c[c.Heading3=
5]="Heading3";c[c.Heading4=6]="Heading4";c[c.Heading5=7]="Heading5";c[c.Heading6=8]="Heading6";c[c.Heading7=9]="Heading7";c[c.Heading8=10]="Heading8";c[c.Heading9=11]="Heading9";c[c.ListItem=12]="ListItem";c[c.BodyText=13]="BodyText";c[c.ListHeader=14]="ListHeader";c[c.Caption=15]="Caption";c[c.CoverPageElement=16]="CoverPageElement"})(L.RoleType||(L.RoleType={}))},1793:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.NavigationPaneInputClassifierSignal=L.DesignerInputClassifierSignal=
L.DocumentRoleDetectionAnnotation=L.RoleDetectionAnnotation=L.RoleDetectionSettings=L.RoleDetectionCustomMetadata=L.BasePartialDocumentLevelAnnotation=L.WordNavPaneInputTargetDocumentClassificationAnnotation=L.WordDesignerInputTargetDocumentClassificationAnnotation=L.BaseInputTargetDocumentClassificationAnnotation=void 0;const l=c(222);class e{constructor(F){l.SchemaObject.assign(e,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[e.getTypeName()])}}L.BaseInputTargetDocumentClassificationAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(F){l.SchemaObject.assign(a,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_WordDesignerInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[a.getTypeName()])}}L.WordDesignerInputTargetDocumentClassificationAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(F){l.SchemaObject.assign(k,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_WordNavPaneInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[k.getTypeName()])}}L.WordNavPaneInputTargetDocumentClassificationAnnotation=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class x{constructor(F){l.SchemaObject.assign(x,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[x.getTypeName()])}}L.BasePartialDocumentLevelAnnotation=x;x.H_=
{T_:x.getTypeName(),B_:x.getBaseTypes()};class y{constructor(F){l.SchemaObject.assign(y,this,F)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionCustomMetadata"}static getBaseTypes(){return[]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[y.getTypeName()])}}L.RoleDetectionCustomMetadata=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class m{constructor(F){l.SchemaObject.assign(m,this,F)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionSettings"}static getBaseTypes(){return[]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[m.getTypeName()])}}L.RoleDetectionSettings=m;m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class u{constructor(F){l.SchemaObject.assign(u,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[u.getTypeName()])}}L.RoleDetectionAnnotation=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};
class z{constructor(F){l.SchemaObject.assign(z,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_DocumentRoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[z.getTypeName()])}}L.DocumentRoleDetectionAnnotation=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class v{constructor(F){l.SchemaObject.assign(v,
this,F)}static getTypeName(){return"AugLoop_RoleDetection_DesignerInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[v.getTypeName()])}}L.DesignerInputClassifierSignal=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class E{constructor(F){l.SchemaObject.assign(E,this,F)}static getTypeName(){return"AugLoop_RoleDetection_NavigationPaneInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[E.getTypeName()])}}L.NavigationPaneInputClassifierSignal=E;E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()}},1794:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e){this.extensions=e}}Object(D.a)(l,"ExtensionList",null,[])},1795:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1752);class l extends c.a{constructor(e,a){super(e.source,e.target,e.cVf);this.Ji=e;this.insertAfter=a}get Ria(){return this.Ji.Ria}get Go(){return this.Ji.Go}set Go(e){this.Ji.Go=e}}Object(D.a)(l,
"CoreInternalCopyArguments",c.a,[])},1796:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y=null){this.source=e;this.target=a;this.insertAfter=k;this.mUf=x;this.Go=y||{}}}Object(D.a)(l,"CoreInternalPasteArguments",null,[])},1797:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a="",k="",x="",y=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=e;this.Provider=a;this.DisplayName=k;this.Email=
x;this.IsCurrentUser=y}}Object(D.a)(l,"OfficeSharedCommentUser",null,[])},1798:function(D,L,c){c.d(L,"a",function(){return H});D=c(0);var l=c(46),e=c(1799),a=c(155),k=c(2),x=c(107),y=c(299),m=c(1371),u=c(773),z=c(477),v=c(1372),E=c(158),F=c(141),J=c(62),K=c(12);class H{constructor(P){this.a$=this.Wh=this.j1=null;this.VC=0;this.eSb=this.Bja=this.Vb=null;this.Wbh=!1;this.Ute=null;this.UFh=!0;this.ga=P;this.Ub()}get Uba(){return this.j1}get model(){return this.Wh}get v8b(){return this.a$}get O$k(){return k.AFrameworkApplication.njo}get iCo(){return k.AFrameworkApplication.ijj}get Zbl(){return CommonUIStrings.l_DeleteCommentConfirm}get sxo(){return!1}get Tz(){return!1}get gKi(){return!1}get ycj(){return!1}get sTh(){return this.Bja}set sTh(P){this.Bja=
P}get mode(){return this.VC}set mode(P){P!==this.VC&&(this.VC=P,-1!==this.VC&&(this.j1.D3a(),this.Wh.D3a(),0===this.VC&&this.cff()))}get wNb(){return this.Wbh}set wNb(P){this.Wbh=P}get removePersonalInformation(){return!1}get hlj(){return!0}dispose(){this.j1&&(this.j1.dispose(),this.j1=null);this.Wh&&(this.Wh.dispose(),this.Wh=null);this.a$&&(this.a$.dispose(),this.a$=null);this.cff()}selectComment(P,N=1){const M=this.Wh.pD(P);!M||2===this.mode&&1!==M.er||(this.Wh.selectComment(M),this.a$.highlightComment(M,
!0),this.j1.selectComment(M,N),1===N&&this.wNb&&this.Bja.selectComment(P))}K4c(){const P=this.Wh.K4c();P&&(this.a$.highlightComment(P,!0),this.j1.selectComment(P),this.wNb&&this.Bja.selectComment(P.id))}L4c(){const P=this.Wh.L4c();P&&(this.a$.highlightComment(P,!0),this.j1.selectComment(P),this.wNb&&this.Bja.selectComment(P.id))}wde(P){P?this.selectComment(P,0):this.j1.WJi&&this.cmf().Xj.wy(this.j1.WJi)}clearSelection(){this.Wh.clearSelection();this.wNb&&this.Bja.selectComment(null);this.a$.aRk()}paneClosing(){this.Tz||
(2===this.VC?(this.clearSelection(),this.deleteComment(this.Wh.Xx)):this.clearSelection())}ayb(P){if(1===this.mode){P=e.a.nAb(P);var N=({anchor:M}=this.a$.l1k()).returnValue;if(M&&0===N)this.addComment(P,M);else{switch(N){case 1:P=CommonUIStrings.l_NewCommentError;break;case 2:P=CommonUIStrings.l_NewCommentInvalidContent;break;default:P=CommonUIStrings.l_NewCommentError}var M=new F.StandardDialog;M.zd=0;M.nia(CommonUIStrings.l_DefaultDialogTitle,P,null)}}}addComment(P){0!==this.mode&&(this.Wh.Fkk(P),
0===P.er||this.gKi||this.selectComment(P.id),this.ga.processAction(K.a.NCh,2))}editComment(P,N){1===this.mode&&P&&(this.Wh.eJc(P,N),this.selectComment(P.id))}M3e(){this.Wh.oMk()}addReply(P,N){1===this.mode&&(P=this.Wh.yGh(P,N),this.selectComment(P.id,0),this.ga.processAction(K.a.RCh,2))}deleteComment(P){if(1!==this.mode)if(2===this.mode){if(1!==P.er)return;this.mode=1}else return;this.hlj&&1!==P.er?(this.eSb=P,P=new F.StandardDialog,P.zd=4,P.MU(2),P.vbg(CommonUIStrings.l_DefaultDialogTitle,this.Zbl,
Object(l.a)(this,this.gcl,"deleteDialogHandler"))):this.YHc(P)}Ub(){this.ga.gb(K.a.UUk,J.a.frame,x.ActionManager.Kf,64);this.ga.gb(K.a.VUk,J.a.frame,x.ActionManager.Kf,64);this.ga.gb(K.a.mCh,J.a.frame,x.ActionManager.Kf,64);this.ga.pa(K.a.q6e,J.a.frame,x.ActionManager.Kf);this.ga.pa(K.a.tCh,J.a.frame,x.ActionManager.Kf);this.ga.pa(K.a.uCh,J.a.frame,x.ActionManager.Kf);this.ga.gb(K.a.$Uk,J.a.frame,x.ActionManager.Kf,64);this.ga.gb(K.a.aVk,J.a.frame,x.ActionManager.Kf,64);this.ga.pa(K.a.NCh,J.a.frame,
x.ActionManager.Kf);this.ga.pa(K.a.OCh,J.a.frame,x.ActionManager.Kf);this.ga.pa(K.a.RCh,J.a.frame,x.ActionManager.Kf);this.ga.gb(K.a.PVk,J.a.frame,x.ActionManager.Kf,64);this.ga.gb(K.a.RVk,J.a.frame,x.ActionManager.Kf,64);this.ga.gb(K.a.QVk,J.a.frame,x.ActionManager.Kf,64);this.ga.pa(K.a.TCh,J.a.frame,x.ActionManager.Kf);this.ga.pa(K.a.K3a,J.a.frame,()=>{this.K3a();return 32})}gcl(P){1===P?this.YHc(this.eSb):(this.eSb&&this.selectComment(this.eSb.id),this.eSb=null)}YHc(P){const N=P.Ff;1===P.er?this.ga.processAction(K.a.q6e,
2):this.ga.processAction(K.a.tCh,2);this.eSb=null;this.wNb||this.clearSelection();P=this.Wh.deleteComment(P);for(let M=0;M<P.length;M++)P[M].dispose();this.wde(N)}szb(P,N){0!==this.mode&&(this.ga.processAction(N?K.a.uCh:K.a.TCh,2),this.Wh.szb(P,N))}Ita(P){this.Wh.Ita(P);this.mode=1;this.ga.processAction(K.a.OCh,2)}Zdb(P){this.Wh.Zdb(P);this.mode=1}eWk(P,N){this.Wh.gMn(P,N)}eRc(){}cff(){}UNb(P,N,M,I,T){return this.j1.UNb(P,N,M,I,T)}vY(P,N,M,I,T){return this.j1.vY(P,N,M,I,T)}cmf(){var P=this.Vb.getRegion(a.AFrame.xr);
if(!P){const N=this.Vb.fe(a.AFrame.xr);P=new y.DOMFocusListing(()=>this.Uba.u_c);P.Dxa=!0;P.In(3);P.In(2);P.In(4);P.In(1);P.In(6);P.In(5);this.Vb.nla(()=>this.Uba.u_c,N,P);P=this.Vb.getRegion(a.AFrame.xr);P.LRa();P.lU=!0;P.mZa=!0;N.Xq(this.Vb.dW);N.Xq(this.Vb.eW)}return P}Fxd(P,N){0!==this.mode&&this.Wh.Fxd(P,N)}kbe(P,N){0!==this.mode&&this.Wh.kbe(P,N)}K3a(){E.UISurfaces.fM().then(P=>{var N=Object.assign(new m.a,{target:this.ycj?'[data-unique-id*="ShowCommentsTopBar"]':'[data-unique-id~="ShowCommentsTopBar"]',
showCloseIcon:!0,content:CommonUIStrings.l_DeepLinkedCommentDoesNotExistNotification,calloutProps:Object.assign(new v.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});N=P.callout(N);const M=Object.assign(new z.a,{expirationOptions:Object.assign(new u.a,{displayTimeoutSeconds:10,onExpire:Object(l.a)(this,this.dismiss,"dismiss")})});this.Ute=P.addNotification(N,M)})}dismiss(){E.UISurfaces.fM().then(P=>{P.removeNotification(this.Ute);return this.Ute=null})}static get instance(){return H._instance||
(H.factory?H._instance=H.factory():null)}static set instance(P){H._instance=P}}H._instance=null;H.factory=null;Object(D.a)(H,"CommentManager",null,[544,545,9])},1799:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(2),e=c(753);class a{constructor(){this.ej=null;this.Zg=[];this._changes=[];this.G$a=this.NXb=this.Gy=null}get Ts(){return this.Gy}get Xx(){return this.G$a}initialize(k){this.ej=k}dispose(){const k=this.Zg.length;for(let x=0;x<k;x++)this.Zg[x].dispose();this.Zg=[]}D3a(){this.Gy&&
this.Gy.D3a();this.NXb&&this.NXb.D3a()}selectComment(k){this.clearSelection();k.$ha=1;this.Gy=k;if(k.Ff){var x=Array.indexOf(this.Zg,k);for(--x;0<=x;x--){const y=this.Zg[x];if(y.id===k.Ff){y.$ha=2;this.NXb=y;break}}}l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob.Una&&e.ShyRibbon.Hdb(1,0)}K4c(){if(!this.Zg.length)return null;let k;k=this.Gy?this.k2h(this.Gy,!0):this.Zg[0];this.selectComment(k);return k}L4c(){if(!this.Zg.length)return null;let k;k=this.Gy?this.YIl(this.Gy):this.Zg[this.Zg.length-
1];this.selectComment(k);return k}clearSelection(){this.Gy&&(this.Gy.$ha=0,this.Gy=null);this.NXb&&(this.NXb.$ha=0,this.NXb=null)}eJc(k,x){this.ej.mode=3;k.er=2;k.kSa=0;k.Ty=x;this.G$a=k}oMk(){this.G$a=null;this.ej.mode=1}yGh(k,x){var y=this.pD(k);this.ej.mode=2;this.G$a=k=c(1640).Comment.VGh(l.AFrameworkApplication.userName,k,y.Mgi,x);for(x=this.Zg.length-1;0<=x;x--)if(y=this.Zg[x],y.Ff===k.Ff||y.id===k.Ff){Array.insert(this.Zg,x+1,k);break}return k}Ita(k){this.UCh(k,2)}Zdb(k){this.UCh(k,4)}deleteComment(k){const x=
[],y=Array.indexOf(this.Zg,k);for(;y<this.Zg.length;){const m=this.Zg[y];if(m.id===k.id||m.Ff===k.id)Array.removeAt(this.Zg,y),Array.add(x,m);else break}this.Y1c(x,3);-1<Array.indexOf(x,this.G$a)&&(this.G$a=null,this.ej.mode=1);return x}szb(k,x){const y=[];let m=Array.indexOf(this.Zg,k);for(;m<this.Zg.length;){const u=this.Zg[m];if(u.id===k.id||u.Ff===k.id)u.done=x,Array.add(y,u),m++;else break}this.Y1c(y,x?0:1)}mQ(){return Array.clone(this.Zg)}c8b(){return!!this.Zg&&!!this.Zg.length}pD(k){for(let x=
0;x<this.Zg.length;x++){const y=this.Zg[x];if(y.id===k)return y}return null}k2h(k,x){k=Array.indexOf(this.Zg,k);return k===this.Zg.length-1?x?this.Zg[0]:null:this.Zg[k+1]}bPl(k,x=!1){let y=k=Array.indexOf(this.Zg,k);do if(y=y===this.Zg.length-1?0:y+1,!x||!this.Zg[y].done)return this.Zg[y];while(y!==k);return this.Zg[k]}YIl(k){return(k=Array.indexOf(this.Zg,k))?this.Zg[k-1]:this.Zg[this.Zg.length-1]}cPl(k,x=!1){let y=k=Array.indexOf(this.Zg,k);do if(y=y?y-1:this.Zg.length-1,!x||!this.Zg[y].done)return this.Zg[y];
while(y!==k);return this.Zg[k]}Fxd(){}kbe(){}UCh(k,x){const y=[];k.er=0;Array.add(y,k);this.Y1c(y,x);this.G$a=null}static nAb(k){return c(1640).Comment.VGh(l.AFrameworkApplication.userName,null,c(1640).Comment.UTi,k)}}Object(D.a)(a,"CommentModel",null,[9,539])},1800:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.PFc="CommentPaneTextbox";l.DDd="CommentPane";l.ZUk="CommentDeleteButton";l.OVk="CommentSaveButton";l.NVk="CommentReplyButton";l.YUk="CommentCancelButton";l.SCh="CommentTextEntry";
l.TVk="CommentTabHelp";Object(D.a)(l,"CommentManagerConstants",null,[])},1801:function(D,L,c){c.d(L,"a",function(){return k});D=c(0);var l=c(482),e=c(97),a=c(23);class k{dispose(){}static zZa(x,y,m,u=null,z=!0){var v=z?"":m;x=l.a("a",x,"StandardButton "+y);x.title=v;x.tabIndex=0;v=null;u?(v=e.createClusteredImage(16,16,u,"StandardButtonImage",!0,null),v.setAttribute(a.a.oh,a.a.Ny),x.appendChild(v)):Sys.UI.DomElement.addCssClass(x,"StandardButtonNoImage");z?(u=l.a("span",null,"StandardButtonLabel"),
u.innerText=m,x.appendChild(u)):Sys.UI.DomElement.addCssClass(v,"StandardButtonImageNoText");x.setAttribute(a.a.oh,a.a.z2);return x}static UMb(x,y){void 0!==x&&null!==x&&(x.disabled=!y,y?(y=a.a.NL,Sys.UI.DomElement.removeCssClass(x,"DisabledButton"),Sys.UI.DomElement.removeCssClass(x,"cui-disabled")):(y=a.a.gp,Sys.UI.DomElement.containsCssClass(x,"DisabledButton")||Sys.UI.DomElement.addCssClass(x,"DisabledButton"),Sys.UI.DomElement.containsCssClass(x,"cui-disabled")||Sys.UI.DomElement.addCssClass(x,
"cui-disabled")),a.a.Uq(x,a.a.W_e,y))}}Object(D.a)(k,"SimpleButtonFactory",null,[9])},1803:function(D,L,c){c.d(L,"a",function(){return z});D=c(0);var l=c(8),e=c(91),a=c(771),k=c(139),x=c(10),y=c(376),m=c(1804);class u{constructor(v,E){this.YPc=v;this.$Rc=E}a4h(){return this.$Rc?this.YPc.begin:this.YPc.end}xao(v){this.$Rc?this.YPc.begin=v:this.YPc.end=v}Fti(v,E){const F=this.a4h()+(this.$Rc?0:-1);return F>=v&&F<E}}Object(D.a)(u,"HitRangeEdge",null,[]);class z{get Wc(){return null}get Hi(){return null}get Lna(){return!1}get Jzf(){return!1}yXe(){}g3d(){return!1}Bhg(){return!1}N4h(v){return e.f(v,
()=>!1)}eva(){return null}A2d(v,E,F,J,K){E=E||[];F=F||[];const H=[];let P=0,N=0,M=0;for(;P<E.length||N<F.length;){const I=P<E.length&&N<F.length?E[P].begin<F[N].begin?E[P++]:F[N++]:P<E.length?E[P++]:F[N++];H[M]=m.a.createInstance(I.begin,I.end,v,M,J,K);++M}return H}ERl(v,E){if(!E)return null;if(!x.ParagraphReader.nEh(v))return this.W0a(v.characterData,E);const F=this.Lam(v,k.AParagraphNode.TKc);v=this.Pam(v,F);E=this.W0a(v,E);if(!E)return E;E=this.sxn(E);this.IRn(E,F);return E=this.eul(E,F)}Lam(v,
E){E=Object(y.c)(E);const F=Object(y.a)(E);return[...x.ParagraphReader.fOc(v)].map(J=>{J.isVisible=F(J);return J})}Pam(v,E){E=E.filter(F=>F.isVisible);return x.ParagraphReader.WQd(v,E)}sxn(v){const E=[];for(const F of v)E.push(new u(F,!0)),E.push(new u(F,!1));return E}IRn(v,E){if(0!==v.length){var F=0,J=0;for(const K of E){if(F>=v.length)break;if(K.isVisible)for(;F<v.length;){E=v[F];if(!E.Fti(K.chp.cp-J,K.cpEnd-J))break;E.xao(E.a4h()+J);F++}else J+=K.cpEnd-K.chp.cp}}}eul(v,E){if(0===v.length)return[];
const F=[];let J=0,K=!1;for(const H of E){if(J>=v.length)break;if(H.isVisible)for(;J<v.length;){E=v[J];if(!E.Fti(H.chp.cp,H.cpEnd))break;E.$Rc?K=!0:!E.$Rc&&K&&(F.push(E.YPc),K=!1);J++}else K=!1}return F}mwi(){return!1}wwi(){return!1}W0a(v,E){if(E&&v){let F;const J=[];try{for(;F=E.exec(v);){const K=new a.a(F.index,E.lastIndex);J.push(K)}return J}catch(K){l.ULS.sendTraceTag(522846819,313,15,K instanceof SyntaxError?"Invalid regular expression":`errorName: ${K.name}`)}}return null}Tae(){}}Object(D.a)(z,
"BaseFindManagerHelper",null,[681])},1804:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y,m,u){this.id=++l.yak;this.cJg=e;this.O9a=a;this.j4g=k;this.YUg=x;this.yk=y;this.SWg=m;this.$o=u;this.next=this.previous=null}get begin(){return this.cJg}get end(){return this.O9a}get type(){return this.yk}I9h(){return this.$o.eva(this.nodeId)}get nodeId(){return this.j4g}get UOa(){return this.YUg}get MVd(){return this.SWg}j0k(e){this.cJg=e.begin;this.O9a=e.end;this.j4g=e.nodeId;
this.YUg=e.UOa;this.yk=e.type;this.SWg=e.MVd}static createInstance(e,a,k,x,y,m){const {FindManagerHelper:u}=c(1529);return new l(e,a,k,x,y,m,u.instance)}}l.yak=0;Object(D.a)(l,"FindResult",null,[708])},1805:function(D,L,c){c.d(L,"a",function(){return k});D=c(0);var l=c(46),e=c(79),a=c(15);class k{constructor(x,y,m){this.hs=this.ETf=null;this.I$g=this.wbb=this.H$g=this.NAa=0;this.phd=null;this._context=x;this.Gb=y;this.Na=m;this.J3b=!1;this.xme=!0;this.f_n();this.QIb=this.K.$("NativeFileOpenDialogIsEnabled")}get context(){return this._context}get K(){return this.Na}get retryCount(){return this.NAa}get $0n(){return this.H$g}get h5a(){return this.wbb}get a1n(){return this.I$g}$dc(x){this.hs=
x;if(!this.J3b){if(this.xme){if(this.QIb&&a.a.wH){this.phd=x.GHd(Object(l.a)(this,this.YQf,"onFileChosen"));return}this.phd=x.GHd(null);if(!this.Nya(this.phd,x))return}this.VNa(x,null)}}YQf(x){if(this.Nya(x,this.hs)){if(a.a.wH||a.a.jj)this.phd=x;this.VNa(this.hs,null)}}GZc(){this.ETf&&this.ETf()}g1n(x){if(!x||this.retryCount>=this.$0n)return!1;this.NAa=this.retryCount+1;const y=new e.a(2,1,this.h5a,()=>{this.Xbe(x)},110);this.Gb.Wb(y);this.h5a<this.a1n&&(this.wbb=2*this.h5a);return!0}f_n(){this.NAa=
0;this.H$g=this.K.pc("Box4UploadRetryCount",20);this.wbb=this.K.pc("Box4UploadRetryDelayStart",200);this.I$g=this.K.pc("Box4UploadRetryDelayMax",3200);this.hs&&(this.hs.dispose(),this.hs=null)}}Object(D.a)(k,"FileUploader",null,[])},1806:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(2);c=c(67);class e{static Bqk(a){e.psg.addHandler(e.ZBh,a)}static AGn(a){l.AFrameworkApplication.K.$("SqmCommandEventSourceEnabled")&&e.psg.raiseEvent(e.ZBh,a)}}e.ZBh="CommandClickEvent";e.psg=new c.a;
Object(D.a)(e,"CommandClickEvents",null,[])},1807:function(D,L){Object.defineProperty(L,"__esModule",{value:!0});L.ErrorCode=L.FormattingSuggestionsRange=L.FormattingSuggestionType=void 0;(function(c){c[c.FontSize=0]="FontSize";c[c.FontFamily=1]="FontFamily";c[c.FontColor=2]="FontColor";c[c.Alignment=3]="Alignment";c[c.Indentation=4]="Indentation";c[c.Bold=5]="Bold";c[c.RightIndentation=6]="RightIndentation";c[c.Italic=7]="Italic";c[c.Underline=8]="Underline";c[c.AllCaps=9]="AllCaps";c[c.LineSpacing=
10]="LineSpacing";c[c.BeforeSpacing=11]="BeforeSpacing";c[c.AfterSpacing=12]="AfterSpacing";c[c.SpecialIndentType=13]="SpecialIndentType";c[c.SpecialIndentBy=14]="SpecialIndentBy";c[c.FontKerning=15]="FontKerning"})(L.FormattingSuggestionType||(L.FormattingSuggestionType={}));(function(c){c[c.Paragraph=0]="Paragraph";c[c.List=1]="List"})(L.FormattingSuggestionsRange||(L.FormattingSuggestionsRange={}));(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(L.ErrorCode||
(L.ErrorCode={}))},1808:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.FormattingSuggestionsSummaryAnnotation=L.FormattingSuggestionsAnnotation=void 0;const l=c(222);class e{constructor(k){l.SchemaObject.assign(e,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}L.FormattingSuggestionsAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}L.FormattingSuggestionsSummaryAnnotation=a;a.H_={T_:a.getTypeName(),
B_:a.getBaseTypes()}},1809:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1810:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.PullQuotesSignal=L.DocumentPullQuoteAnnotation=L.PullQuoteAnnotation=void 0;const l=c(222);class e{constructor(x){l.SchemaObject.assign(e,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_PullQuotes_PullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,
[e.getTypeName()])}}L.PullQuoteAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(x){l.SchemaObject.assign(a,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_PullQuotes_DocumentPullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}L.DocumentPullQuoteAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(x){l.SchemaObject.assign(k,
this,x)}static getTypeName(){return"AugLoop_PullQuotes_PullQuotesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[k.getTypeName()])}}L.PullQuotesSignal=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1811:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1812:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1813:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1814:function(D,L,
c){Object.defineProperty(L,"__esModule",{value:!0});L.TextToImageAnnotation=void 0;var l=c(222);D=function(){function e(a){l.SchemaObject.assign(e,this,a)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageAnnotation"};e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};
e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();L.TextToImageAnnotation=D},1815:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.TextToImageSignal=void 0;var l=c(222);D=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageSignal"};e.getBaseTypes=function(){return["AugLoop_TextToSuggestions_TextToSuggestionSignal","AugLoop_Signals_Signal"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();L.TextToImageSignal=D},1816:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.TextToImageTraceSignal=void 0;var l=c(222);D=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageTraceSignal"};e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_=
{T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();L.TextToImageTraceSignal=D},1817:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1818:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.ThemeExtractorSignal=L.ThemeExtractorAnnotation=void 0;const l=c(222);class e{constructor(k){l.SchemaObject.assign(e,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}L.ThemeExtractorAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}L.ThemeExtractorSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1819:function(D,L){Object.defineProperty(L,"__esModule",{value:!0});L.TableType=
void 0;D=L.TableType||(L.TableType={});D[D.Other=0]="Other";D[D.SimpleHeaded=1]="SimpleHeaded"},1820:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.TableTypeAnnotation=void 0;const l=c(222);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_TableAnalysis_TableTypeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])}}L.TableTypeAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1821:function(D,L,c){c.d(L,"a",function(){return v});D=c(0);c(1543);var l=c(1599),e=c(2),a=c(16);c(1530);c(34);var k=c(8),x=c(1398),y=c(11),m=c(19),u=c(139),z=c(10);class v{constructor(E=2E3){this.Sgk=/(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?/g;this.uab=E}nAm(){v.xT();return!0}wMm(){return!0}getSelectedText(){const E=v.xT();return this.tQd(E)}urf(){const E=
v.xT();return this.O4l(E)}tQd(E){return this.Wbi(E,!0)}O4l(E){return this.Wbi(E,!1)}Wbi(E,F){try{return this.N4l(E,F)}catch(J){k.ULS.sendTraceTag(545869845,1303,15,"Error accessing selection: {0}",J)}return Object.assign(new l.a,{neighborhood:"",mentionStart:0,mentionLength:0})}N4l(E,F){var J=null;let K=!1;F&&E&&E.Sx&&m.SelectionEditor.jf(E.Qa)&&m.SelectionEditor.mjb(E.Qa)&&(k.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),K=m.SelectionEditor.jf(E.Qa),(J=
m.SelectionEditor.b3(E.Qa,!1))&&J.Sx&&0<=J.Qa.cpBegin&&0<=J.Qa.cpEnd&&1>=J.Qa.cpEnd-J.Qa.cpBegin&&(J=null));J&&(E=J);if(!E)return Object.assign(new l.a,{neighborhood:"",mentionStart:0,mentionLength:0});const H=new Sys.StringBuilder;J=F=0;const P=[],N=E.length;let M=null;for(let W=0;W<N;W++){var I=E.J(W);if(!z.ParagraphReader.Yb(I.node)||Array.contains(P,I.node.wl))continue;P.push(I.node.wl);const V=x.a.create(I.cpBegin,I.cpEnd),Y=z.ParagraphReader.Mfb(I.node,u.AParagraphNode.TKc,null,V);e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",
!1)&&K&&(M=this.Orl(Y,V.rd));let da=Y,ba=0;var T=z.ParagraphReader.ug(I.node,!0,!0,!0);I=z.ParagraphReader.ug(I.node,!1,!0,!0);let ja=0;for(;da.length<this.uab&&(T||I);){if(!(ja%2)&&T){var U=z.ParagraphReader.text(T,u.AParagraphNode.TKc);U&&(da=U+" "+da,ba+=U.length+1);T=z.ParagraphReader.ug(T,!0,!0,!0)}1===ja%2&&I&&(da=(U=z.ParagraphReader.text(I,u.AParagraphNode.TKc))?da+" "+U:da,I=z.ParagraphReader.ug(I,!1,!0,!0));ja++}T=W===N-1;W||-1===V.rd||(F=V.rd);J+=T&&-1!==V.endCp?V.endCp:Y.length;H.append(da);
e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",!1)&&K&&M&&(F=M.start,J=M.start+M.length);F+=ba;J+=ba;T||(H.append(" "),J++)}for(E=u.AParagraphNode.CU(H.toString()," ");F<J&&a.a.yv(E.charCodeAt(F));)F++;for(;J>F&&a.a.yv(E.charCodeAt(J-1));)J--;return this.ztk(E,F,J)}Orl(E,F){for(var J;null!==(J=this.Sgk.exec(E));){const K=J.index;J=J[0].length;if(F>=K&&F<=K+J)return{start:K,length:J}}return null}ztk(E,F,J){if(E.length>this.uab){var K=J-F;if(K>
this.uab)E=E.substr(F,this.uab),J=this.uab,F=0;else{K=Math.max(F-Math.floor((this.uab-K)/2),0);let H;H=Math.min(K+this.uab,E.length);K=Math.max(H-this.uab,0);F-=K;J-=K;E=E.substring(K,H)}}return Object.assign(new l.a,{neighborhood:E,mentionStart:F,mentionLength:J-F})}static xT(){var E=y.App.ya.jb.xc;if(!E)return k.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;E=E.nb;return E&&E.hb&&E.hb.length?E.hb.lb:(k.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),
null)}}Object(D.a)(v,"Box4InsightsSelection",null,[657,658])},1822:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(446);class l extends c.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(D.a)(l,"IconGalleryButtonProps",c.a,[])},1823:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.y=this.x=0}}Object(D.a)(l,"IPoint",null,[])},1824:function(D,L,c){c.d(L,"a",function(){return a});
D=c(0);var l=c(16),e=c(8);c=c(1561);class a extends c.a{constructor(k,x,y,m,u){super(k,x,u);this.ek=y;this.Dch=u}Zkc(k){let x;if(this.zS&&!k)return e.ULS.sendTraceTag(594408835,307,10,"No htmlDomContent"),{returnValue:!1,uua:null};if(this.Dch){if(this.ek)return x=this.ek.vVf(k,!1),{returnValue:!0,uua:x};e.ULS.sendTraceTag(592269661,307,10,"_clipboardDataHelper should not be null")}x=document.createElement("div");k=k.split(RegExp("\r\n|\r|\n"));for(var y=0;y<k.length-1;y++){const m=document.createElement("p");
m.innerText=this.cWc(k[y]);x.appendChild(m)}y=document.createElement("span");y.innerText=l.a.vJc(k[k.length-1]);x.appendChild(y);return{returnValue:!0,uua:x}}cWc(k){return l.a.vJc(k.length?k:" ")}}Object(D.a)(a,"MultiLineTextImportStrategy",c.a,[])},1825:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(857);class l extends c.a{constructor(e,a,k,x,y=null,m=0,u=0,z=null,v=null,E=null,F=null){super(y?y.H8:null,y?y.gB:null,y?y.Moa:null,y?y.cultureName:null,y?y.tBa:null);this.src=e;this.alt=
a;this.width=k;this.height=x;this.maxWidth=m;this.maxHeight=u;this.href=z;this.jdl=v;this.Vgf=E;this.MCd=F}}Object(D.a)(l,"ImageSemanticArgs",c.a,[])},1826:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(125);class e{constructor(){this.Desc=this.Alt=this.Src=this.ImageId=null;this.ImageAnchorId=this.LockId=this.Height=this.Width=0;this.IsImageFromPaste=!1;this.EditContainerWidth=0;this.LocalizedPicture=null;this.IsLayoutSizeSetByUser=!1;this.ClipServiceArgs=this.WordId=this.RunId=this.ContentNodes=
null}static construct(a,k,x,y,m,u,z,v,E,F,J,K,H,P,N,M=null){const I=new e;I.ImageId=a;I.Src=k;I.Alt=x;I.Width=y;I.Height=m;I.Desc=u;I.LockId=z;I.ImageAnchorId=v;I.IsImageFromPaste=E;I.EditContainerWidth=F;I.LocalizedPicture=J;I.IsLayoutSizeSetByUser=K;if(H&&0<H.length){I.ContentNodes=Array(H.length);a=0;for(const T of H)I.ContentNodes[a]=l.a(T),a++}I.RunId=P;I.WordId=N;I.ClipServiceArgs=M;return I}}Object(D.a)(e,"PastedPicture",null,[])},1827:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);
var l=c(21);L=c(595);var e=c(1828);class a extends L.a{constructor(){super();this.DataUriPictures=!1;this.FileId=this.PastedPictures=null;this.InkExternalPartFileFormatFixIsEnabled=this.PictureEditingInIllustrationCanvasIsEnabled=this.InkEditingInCanvasSupportedIsEnabled=this.ChartsPasteFromXLOIsEnabled=this.ClipServicePictures=!1}Cl(){return 31}static construct(k,x,y=null,m=!1){const u=new a;u.DataUriPictures=x;u.PastedPictures=k;(k=l.a.instance.Ma("Box4.IFeatureHelper"))&&k.isFeatureEnabled(e.a.chartsPasteFromXLO)&&
k.isFeatureEnabled(e.a.graphicsEditor)&&(u.ClipServicePictures=m,u.ChartsPasteFromXLOIsEnabled=!0,u.InkEditingInCanvasSupportedIsEnabled=!0,u.PictureEditingInIllustrationCanvasIsEnabled=!0,u.InkExternalPartFileFormatFixIsEnabled=!0);y&&y.length&&(u.FileId=y);return u}}Object(D.a)(a,"PicturePasteRequest",L.a,[])},1828:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.addAuthorInfoOnPutChanges=0]="addAuthorInfoOnPutChanges";e[e.addUpdateHintsToGraph=1]="addUpdateHintsToGraph";
e[e.addThemeColorValues=2]="addThemeColorValues";e[e.adjustStyles=3]="adjustStyles";e[e.agaveRangeEnhancement=4]="agaveRangeEnhancement";e[e.allowIdenticalRevisionMergeWithoutBase=5]="allowIdenticalRevisionMergeWithoutBase";e[e.annotationIgnorePersistence=6]="annotationIgnorePersistence";e[e.basicRichTextInComments_deprecated=7]="basicRichTextInComments_deprecated";e[e.blobFormatting=8]="blobFormatting";e[e.bookmarksFloatie=9]="bookmarksFloatie";e[e.catchUpActivity=10]="catchUpActivity";e[e.chartsPasteFromXLO=
11]="chartsPasteFromXLO";e[e.clientSideImageTransform=12]="clientSideImageTransform";e[e.clientSideNumbering=13]="clientSideNumbering";e[e.commentBackReferenceRemoval=14]="commentBackReferenceRemoval";e[e.contentApp=15]="contentApp";e[e.contentControlAdjustUnsupportedBlockContentControl=16]="contentControlAdjustUnsupportedBlockContentControl";e[e.contentControlAroundTableFix=17]="contentControlAroundTableFix";e[e.contentControlContainerNodeMerge=18]="contentControlContainerNodeMerge";e[e.contentControlCustomizedPlaceholder=
19]="contentControlCustomizedPlaceholder";e[e.contentControlDataModelEnhancement=20]="contentControlDataModelEnhancement";e[e.contentControlEditing=21]="contentControlEditing";e[e.contentControlPlainTextAdding=22]="contentControlPlainTextAdding";e[e.contentControlRead=23]="contentControlRead";e[e.contentControlRendering=24]="contentControlRendering";e[e.contentControlTextVanish=25]="contentControlTextVanish";e[e.contentControlTrackedChangesFix=26]="contentControlTrackedChangesFix";e[e.contentControlTrackedFormattingFix=
27]="contentControlTrackedFormattingFix";e[e.contentControlTuningUnsupportedCases=28]="contentControlTuningUnsupportedCases";e[e.contentControlWrite=29]="contentControlWrite";e[e.createNewStyleUI=30]="createNewStyleUI";e[e.customFontReadModePDF=31]="customFontReadModePDF";e[e.deleteFontStyles=32]="deleteFontStyles";e[e.deleteStyleInternalAPI=33]="deleteStyleInternalAPI";e[e.docReplays=34]="docReplays";e[e.docPartObjectSdtSupport=35]="docPartObjectSdtSupport";e[e.doNotDeleteLastOG=36]="doNotDeleteLastOG";
e[e.docxMergeUsingUpdateHints=37]="docxMergeUsingUpdateHints";e[e.editorClpProtectedCoauth=38]="editorClpProtectedCoauth";e[e.embeddedFonts=39]="embeddedFonts";e[e.endOfParagraphFormatting=40]="endOfParagraphFormatting";e[e.fixContentControlAdvanceIndex_Deprecated=41]="fixContentControlAdvanceIndex_Deprecated";e[e.fontSlotsImprovement=42]="fontSlotsImprovement";e[e.forceLokiFallbackToACLPToken=43]="forceLokiFallbackToACLPToken";e[e.gc2InCanvasCore=44]="gc2InCanvasCore";e[e.gc2InCanvasPictures=45]=
"gc2InCanvasPictures";e[e.gc2InCanvasShapes=46]="gc2InCanvasShapes";e[e.graphicsEditor=47]="graphicsEditor";e[e.graphicsServiceDarkTraffic=48]="graphicsServiceDarkTraffic";e[e.graphMergeReplaysPrompt=49]="graphMergeReplaysPrompt";e[e.graphStoredFeatures=50]="graphStoredFeatures";e[e.hyperlinkColorBugFix=51]="hyperlinkColorBugFix";e[e.isProgressiveStyleEnabled=52]="isProgressiveStyleEnabled";e[e.ignoreFormattingConflictsOnParagraphMerge=53]="ignoreFormattingConflictsOnParagraphMerge";e[e.ignoreMalformedColors=
54]="ignoreMalformedColors";e[e.imageOverflow=55]="imageOverflow";e[e.imageRotate=56]="imageRotate";e[e.includeCommentsInMergeIgnoreFmtEnabled=57]="includeCommentsInMergeIgnoreFmtEnabled";e[e.increaseMaxWebFriendlyDimensionTo1600=58]="increaseMaxWebFriendlyDimensionTo1600";e[e.initializeTrackedRunState=59]="initializeTrackedRunState";e[e.intelligenceV2Schema=60]="intelligenceV2Schema";e[e.intentSuggestion_Deprecated=61]="intentSuggestion_Deprecated";e[e.keepTogether=62]="keepTogether";e[e.labelingPolicies=
63]="labelingPolicies";e[e.latentStylesSupportOnClient=64]="latentStylesSupportOnClient";e[e.lcsMergeReducedOps=65]="lcsMergeReducedOps";e[e.listDefinitionPropertyMergeFailure=66]="listDefinitionPropertyMergeFailure";e[e.listDocumentMetricsTelemetry=67]="listDocumentMetricsTelemetry";e[e.listIdAndListLevelOnParaNode=68]="listIdAndListLevelOnParaNode";e[e.listMergeTableCells=69]="listMergeTableCells";e[e.listNumberingFix=70]="listNumberingFix";e[e.lockNotFullySupportedParagraphInBlockContentControl=
71]="lockNotFullySupportedParagraphInBlockContentControl";e[e.logAddedAndDeletedReferences=72]="logAddedAndDeletedReferences";e[e.logRemovedCommentObjectIds=73]="logRemovedCommentObjectIds";e[e.mergeLogUnmatchedMarkers=74]="mergeLogUnmatchedMarkers";e[e.mergeMissingEopFix=75]="mergeMissingEopFix";e[e.mergePropertyValidationEnabled=76]="mergePropertyValidationEnabled";e[e.mergeStrategyForUpdateFieldAutoSaveParameters=77]="mergeStrategyForUpdateFieldAutoSaveParameters";e[e.mergeStyleToggleProperties=
78]="mergeStyleToggleProperties";e[e.mergeUsingUpdateHints=79]="mergeUsingUpdateHints";e[e.modifyStylesInternalApi=80]="modifyStylesInternalApi";e[e.nestedFieldsAdjustFix=81]="nestedFieldsAdjustFix";e[e.newStyleModel=82]="newStyleModel";e[e.numberedBulletFormatting=83]="numberedBulletFormatting";e[e.objectDataBlobIdMappedByHash=84]="objectDataBlobIdMappedByHash";e[e.outlineElementBasedCommentNavigation=85]="outlineElementBasedCommentNavigation";e[e.pageBackgroundColor=86]="pageBackgroundColor";e[e.persistedAnnotationCoauthFix=
87]="persistedAnnotationCoauthFix";e[e.pictureBorders=88]="pictureBorders";e[e.preserveEopFormattingReader=89]="preserveEopFormattingReader";e[e.qoESingleLevelListSupport=90]="qoESingleLevelListSupport";e[e.readListInfoFromParaNodeInsteadOfListNode=91]="readListInfoFromParaNodeInsteadOfListNode";e[e.readOnlyRecommended=92]="readOnlyRecommended";e[e.removalOfListNode=93]="removalOfListNode";e[e.removeEditedImageUrlFromIgnoredProperties=94]="removeEditedImageUrlFromIgnoredProperties";e[e.removePersonalInformation=
95]="removePersonalInformation";e[e.replaceFollowUpsWithComments=96]="replaceFollowUpsWithComments";e[e.resendCurrentRevision=97]="resendCurrentRevision";e[e.saveProofingInfo=98]="saveProofingInfo";e[e.setStyleOnParagraphNodeDesignerProof=99]="setStyleOnParagraphNodeDesignerProof";e[e.shapeEditingInlineCanvas=100]="shapeEditingInlineCanvas";e[e.stylesFlatteningOnClient=101]="stylesFlatteningOnClient";e[e.syntheticListNode=102]="syntheticListNode";e[e.tableCellMergeWithoutOENode=103]="tableCellMergeWithoutOENode";
e[e.tableMergeReliabilityImprovement=104]="tableMergeReliabilityImprovement";e[e.tableNodeNormalization=105]="tableNodeNormalization";e[e.tableOfContentCreateAndDelete_Deprecated=106]="tableOfContentCreateAndDelete_Deprecated";e[e.tableOfContentRender=107]="tableOfContentRender";e[e.tableOfContentUpdate=108]="tableOfContentUpdate";e[e.tableRowFormatTrackChanges_Deprecated=109]="tableRowFormatTrackChanges_Deprecated";e[e.tableStyle=110]="tableStyle";e[e.tableStyleMargin=111]="tableStyleMargin";e[e.tableStyleCellSpacing=
112]="tableStyleCellSpacing";e[e.tableStyleCellVerticalAlignment=113]="tableStyleCellVerticalAlignment";e[e.tasks=114]="tasks";e[e.touchImprovement=115]="touchImprovement";e[e.trackChangeSettingNotificationInCurrentLocale_Deprecated=116]="trackChangeSettingNotificationInCurrentLocale_Deprecated";e[e.undoMergeUsingUpdateHints=117]="undoMergeUsingUpdateHints";e[e.updateCpUsingUpdateHints=118]="updateCpUsingUpdateHints";e[e.updateTOCInWeb=119]="updateTOCInWeb";e[e.useImagePropertySet=120]="useImagePropertySet";
e[e.usePStylePropInLists=121]="usePStylePropInLists";e[e.useNSIDInLists=122]="useNSIDInLists";e[e.userBookmarks=123]="userBookmarks";e[e.userBookmarksHighlight=124]="userBookmarksHighlight";e[e.wordBookmarks=125]="wordBookmarks";e[e.wordTestFeature=126]="wordTestFeature"})(l||(l={}));Object(D.b)("WordEditorFeature",l)},1829:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x=!1){this.vCb=e;this.Lzi=a;this.kLk=k;this.oOm=x}}Object(D.a)(l,"ClearSpecificFormattingProperties",
null,[])},1832:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1833:function(D,L){Object.defineProperty(L,"__esModule",{value:!0});L.SuggestionCategory=void 0;D=L.SuggestionCategory||(L.SuggestionCategory={});D[D.TextRelatedImage=0]="TextRelatedImage";D[D.AbstractImage=1]="AbstractImage";D[D.Icon=2]="Icon"},1834:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1835:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1836:function(D,L,c){Object.defineProperty(L,
"__esModule",{value:!0});L.TextToSuggestionSignal=void 0;var l=c(222);D=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToSuggestions_TextToSuggestionSignal"};e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();L.TextToSuggestionSignal=D},1837:function(D,L,c){c.d(L,"a",function(){return y});D=c(0);
var l=c(79),e=c(189),a=c(8),k=c(117),x=c(55);class y{constructor(m,u,z,v,E,F,J,K,H){this.Jwd=0;this.RV=null;this.VXa="";this.DUb=this.Jye=!1;this.PJa=this.A6=null;this.y3f=!1;this.JTb=null;this.Huo=P=>{this.PJa===P&&(this.PJa=null,this.A6?this.VXa=this.Sda.dfc(this.RV.text):(this.$Pf(),this.findInternal(null)),this.toj())};this.findInternal=()=>{this.A6=null;if(!this.O3e())if(!this.Sda.Nlb(this.VXa).length)this.Adb(),this.Gnb(!0);else if(!this.B4f())switch(this._state){case 0:this.xWo();break;case 1:this.V0i()}};
this.$9a=m;this.Sda=u;this.dXj=z;this.$o=v;this.FGe=E;this.Xvb=F;this.nXj=J;this.KTb=K;this.Jj=H;this._state=2;this.oL=0}get rlg(){return this.Jwd}set rlg(m){this.Jwd=m}get Zlc(){return this.Jwd}set Zlc(m){this.Jwd=m}get taskManager(){return this.FGe.value}get VLb(){return this.Xvb.value}get R3c(){return this.nXj.value}get Dul(){return this.Jye}Gnb(m){(this.Jye=m)&&this.$9a&&this.$9a.e5b()}get Zhf(){return null}get PKc(){return this.JTb}find(m){this.RV=m;this.xRk();this.PJa=new l.a(2,1,this.rlg,this.Huo,
51);this.taskManager.Wb(this.PJa)}RYa(){}N3c(){}jjj(){return!1}zRd(){}ARd(){}Oii(){return!1}xRk(){this.A6&&(this.taskManager.Se(this.A6),this.A6=null);this.PJa&&(this.taskManager.Se(this.PJa),this.PJa=null)}xWo(){var m=(new Date).getTime();this.HMi();const u=this.yWo(m);this._state||(this.A6=new l.a(2,1,this.Zlc,this.findInternal,52),this.taskManager.Wb(this.A6));m=(new Date).getTime()-m;a.ULS.sendTraceTag(17306246,313,50,"{0}",{["Extension Walk Time"]:m,["Count"]:u})}Ptf(m,u,z=!0){this.fzh(m);if(Object(k.a)(67,
m))if(12===m.type)this.bdm(m,u,this.DUb,z);else{const v=this.$o.W0a(m.eva(),this.PKc);z&&(v&&0<v.length?this.cia(m,v):m.Oea());z=this.$o.A2d(m.id,v,null,u,this.DUb);this.eyd(m.id,z,m,u);this.IJf(m)}}bdm(m,u,z,v=!0){const E=[];var F=this.$o.N4h(m);if(!e.a.mf(F)&&(this.IJf(m),v))for(var J of F)F=this.$o.W0a(J.eva(),this.PKc),e.a.mf(F)?this.Oea(J):(this.cia(J,F),E.push(F));J=x.a.Oj?this.$o.ERl(m,this.PKc):this.$o.W0a(m.eva(),this.PKc);this.Oea(m);!e.a.mf(J)&&v&&this.cia(m,J);z=this.$o.A2d(m.id,J,E,u,
z);this.eyd(m.id,z,m,u)}yWo(m){let u=this._state=0;const z=this.Mci();this.xXi();const v=this.zhj();do this.KTf(),u++;while(this.V6e(z)&&(new Date).getTime()-m<y.aHi);v&&v.dispose();this.KPf();return u}$Pf(){}toj(){}O3e(){return!1}Adb(){}B4f(){return!1}V0i(){}HMi(){}fzh(){}cia(){}Oea(){}IJf(){}eyd(){}KPf(){}Mci(){return null}xXi(){}zhj(){return null}KTf(){}V6e(){return!1}}y.aHi=200;Object(D.a)(y,"BaseFindManager",null,[1552])},1838:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,
a,k){this.rootNode=e;this.ria=a;this.k5b=k}}Object(D.a)(l,"FindNodeContext",null,[])},1844:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a=null,k=null,x=null){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=a;this.iconSet.icon24=k;this.iconSet.icon32=x}}Object(D.a)(l,"IconSetContainer",null,[])},1847:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(494);class l extends c.a{constructor(){super()}}l.$7e="conversionRequestType";l.yWf="png";l.ckf=
"gc2json";l.strict="strict";l.zql="existingcontent";l.error="error";Object(D.a)(l,"GraphicsEditorParameters",c.a,[])},1863:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e){this.Hqb=0;this.ynd=isFinite(e)?Math.max(e,8):8;this.ap=Array(this.ynd);this.fj=this.Acb=this.QWa=0;this.SMg=this.Z2h(this.ynd)}get count(){return this.fj}get isEmpty(){return!this.count}enqueue(e){this.count===this.Hqb&&this.fom();this.ap[this.Acb]=e;this.Acb++;this.Acb===this.Hqb&&(this.Acb=0);this.fj=
this.count+1}dequeue(){if(!this.count)throw Error.create("Empty Queue");const e=this.ap[this.QWa];this.QWa++;this.QWa===this.Hqb&&(this.QWa=0);this.fj=this.count-1;this.count<=this.SMg&&this.aal();return e}tA(){if(!this.count)throw Error.create("Empty Queue");return this.ap[this.QWa]}fom(){this.Vfj(2*this.Hqb)}aal(){const e=Math.max(this.Hqb/2,this.ynd);this.count>e||this.Vfj(e)}Vfj(e){const a=Array(e);let k=0;if(this.QWa<this.Acb||!this.count)for(var x=this.QWa;x<this.Acb;x++)a[k]=this.ap[x],k++;
else{for(x=this.QWa;x<this.Hqb;x++)a[k]=this.ap[x],k++;for(x=0;x<this.Acb;x++)a[k]=this.ap[x],k++}this.ap=a;this.Hqb=e;this.QWa=0;this.Acb=k;this.SMg=this.Z2h(e)}Z2h(e){return e<=this.ynd?-1:Math.floor(.25*e)}}Object(D.a)(l,"Queue",null,[])},1897:function(D,L){Object.defineProperty(L,"__esModule",{value:!0});L.AnnotationStatus=L.DocumentCategory=void 0;(function(c){c.Article="Article";c.Letter="Letter";c.Poem="Poem";c.Story="Story";c.General="General";c.InterviewAssistant="InterviewAssistant";c.TravelPlan=
"TravelPlan";c.Recipe="Recipe";c.Resume="Resume";c.PodcastQuestions="PodcastQuestions"})(L.DocumentCategory||(L.DocumentCategory={}));(function(c){c[c.Success=0]="Success";c[c.OffensiveContentInput=1]="OffensiveContentInput";c[c.OffensiveContentOutput=2]="OffensiveContentOutput";c[c.EmptyResponse=3]="EmptyResponse";c[c.ErrorInExecution=4]="ErrorInExecution";c[c.ResourcesNotAvailable=5]="ResourcesNotAvailable";c[c.NonEnglishContentInput=6]="NonEnglishContentInput";c[c.NonEnglishContentOutput=7]="NonEnglishContentOutput";
c[c.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList";c[c.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList";c[c.InputAttackDetected=10]="InputAttackDetected";c[c.OutputAttackDetected=11]="OutputAttackDetected";c[c.ModelResultConversionFailed=12]="ModelResultConversionFailed";c[c.ResumeEntityRecognitionFailed=13]="ResumeEntityRecognitionFailed"})(L.AnnotationStatus||(L.AnnotationStatus={}))},1898:function(D,L){Object.defineProperty(L,"__esModule",{value:!0})},1899:function(D,
L){Object.defineProperty(L,"__esModule",{value:!0})},1900:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.DocumentTextContentGeneratorAnnotation=L.DocumentTextContentGeneratorSignal=void 0;const l=c(222);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_DocumentTextContentGeneratorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[e.getTypeName()])}}
L.DocumentTextContentGeneratorSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_DocumentTextContentGeneratorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}L.DocumentTextContentGeneratorAnnotation=a;a.H_={T_:a.getTypeName(),
B_:a.getBaseTypes()}},1901:function(D,L,c){Object.defineProperty(L,"__esModule",{value:!0});L.PromptAssistanceAnnotation=L.PromptAssistanceSignal=void 0;const l=c(222);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_PromptAssistanceSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[e.getTypeName()])}}L.PromptAssistanceSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};
class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_DocumentTextContentGenerator_PromptAssistanceAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}L.PromptAssistanceAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1925:function(D,L,c){c.r(L);D=c(0);var l=c(2),e=c(79),a=c(2002),k=c(8),x=c(82),y=c(46),
m=c(117),u=c(234),z=c(564),v=c(400),E=c(92),F=c(3),J=c(11),K=c(90),H=c(47),P=c(1038),N=c(5),M=c(105);class I extends K.a{constructor(){super(new M.a(33));this.aif=this.w5f=0}AUd(){return 0}LFa(){const jb=new H.GraphTransaction(3);jb.Eb(this);const ob=new N.GraphIterator;ob.set(this);if(ob.dA()){const Ya=ob.Sd();ob.set(Ya);const Xa=P.b(ob,this.w5f,this.aif),Sa=new N.GraphIterator;Sa.set(this);Sa.Sd();Sa.Dg();Xa&&ob.currentNode!==Ya&&Sa.Qf(ob.currentNode,-2)}jb.dispose()}}Object(D.a)(I,"FindTrackingNode",
K.a,[]);var T=c(19),U=c(52),W=c(10),V=c(1837),Y=c(1838);class da{constructor(jb){this.Xc=jb;jb=[];jb.push(1);this.Qdg=jb}L4h(jb){const ob=this.Xc.Ck();ob.set(jb);const Ya=[];ob.Ab(8)&&(ob.fd(8),Ya.push(new Y.a(ob.currentNode,jb,1)));return Ya}static vE(){return new da(new z.a)}static get instance(){return null!=da.gyg?da.gyg:da.gyg=da.vE()}}Object(D.a)(da,"FindContextHelper",null,[168]);var ba=c(1529),ja=c(394),sa=c(83),ta=c(17);class ra{constructor(jb,ob,Ya,Xa,Sa,ab,Hb,pb,Mb){this.ro=null;this.hUb=
this.rAe=!1;this.v9a=this.xHg=this.M8a=null;this.B$g=!1;this.W3=(Qb,Aa)=>{Qb=Aa.node;Aa.property===ta.a.yo&&this.vTc(Qb)&&this.vEb(Qb,3)};this.hlb=(Qb,Aa)=>{Qb=Aa.node;this.vTc(Qb)&&this.vEb(Qb,2)};this.iha=(Qb,Aa)=>{Qb=Aa.node;Aa=Aa.$zf;!this.JA.Dul&&Aa||!this.vTc(Qb)||this.vEb(Qb,1)};this.processDirtyNodes=()=>{const Qb=this.ge.eg("UserAction","ProcessDirtyNodesInFindResultsTime");this.ro=null;const Aa=this.Ic.Qc(3);Aa.Eb(this.$o.Wc);0<this.addedNodes.count&&(this.hUb=!0,this.hLg(this.addedNodes,
this.JA.Jj));0<this.bIc.count&&this.hLg(this.bIc,this.JA.Jj);if(0<this.Idb.count){const bb=!this.L$j(this.Idb,this.JA,this.$o,this.K$j);this.hUb=this.hUb||bb}Aa.dispose();this.JA.Jj.gpb();this.vnb(this.hUb);this.Saj();Qb.stop()};this.M4n=()=>{this.FCd();if(0<this.Idb.count||0<this.addedNodes.count||0<this.bIc.count)this.ro=new e.a(2,1,500,this.processDirtyNodes,53),this.Gb.Wb(this.ro)};this.JA=jb;this.AV=ob;this.$o=Ya;this.Gb=Xa;this.Ic=Sa;this.hLg=ab;this.L$j=Hb;this.K$j=pb;this.ge=Mb;this.reset();
this.Saj=this.M4n;this.$o.Tae(this.W3,this.iha,this.hlb)}get Idb(){return this.M8a}get addedNodes(){return this.xHg}get bIc(){return this.v9a}get $8i(){return this.B$g}get Ihm(){return 0<this.Idb.count||0<this.bIc.count}start(){this.rAe=!0;this.vnb(!1)}stop(){this.reset()}reset(){this.rAe=!1;this.vnb(!1);this.M8a=new ja.a;this.xHg=new ja.a;this.v9a=new ja.a;this.FCd()}vTc(jb){return!!jb.Mc&&!!this.$o.Hi&&jb.Mc.id.equals(this.$o.Hi.id)}vEb(jb,ob){if(this.rAe&&Object(m.a)(67,jb)&&!this.JA.VLb.i3c)if(this.JA.Jj.I6a||
this.JA.Jj.Kjb.length){switch(ob){case 1:this.Idb.ob(jb.id)||this.addedNodes.Z(jb.id,jb);break;case 2:this.Idb.ob(jb.id)&&this.Idb.remove(jb.id);this.addedNodes.ob(jb.id)?this.addedNodes.remove(jb.id):this.bIc.Z(jb.id,jb);break;case 3:this.Idb.Z(jb.id,jb)}this.Saj()}else 2!==ob&&this.vnb(this.hUb=!0)}FCd(){this.ro&&(this.Gb.Se(this.ro),this.ro=null)}vnb(jb){this.$8i!==jb&&(this.B$g=jb,this.AV.vnb(jb));jb||(this.hUb=!1)}static vE(jb,ob){return new ra(jb,ob,ba.FindManagerHelper.instance,sa.a.instance,
new v.a,ra.SQk,ra.mRn,ra.lRn,J.App.ya.xq)}static createInstance(jb,ob){return ra._instance||(ra._instance=ra.vE(jb,ob))}static mRn(jb,ob,Ya,Xa){let Sa=!1;const ab=ra.Vei(jb,ra.E5m);for(let Hb=0;Hb<ab.length;++Hb){const pb=!Xa(ab[Hb],ob,Ya);Sa=Sa||pb;jb.remove(ab[Hb].id)}return!Sa}static lRn(jb,ob,Ya){const Xa=ob.Jj;jb.Oea();const Sa=jb.id,ab=Xa.p7b(Sa);if(ab)ob=Ya.W0a(jb.eva(),ob.PKc),Ya=Ya.A2d(Sa,ob,null,ab.type,ab.MVd),jb.cia(ob),Xa.Tbe(Sa,Ya);else return!1;return!0}static SQk(jb,ob){const Ya=ra.Vei(jb,
ra.D5m);for(let Xa=0;Xa<Ya.length;++Xa){const Sa=Ya[Xa],ab=Sa.id;Sa.Oea();ob.K2c(ab);jb.remove(ab)}}static Vei(jb,ob){const Ya=[];let Xa=ob;jb.forEach((Sa,ab)=>{Ya.push(ab);--Xa;return Xa?!0:!1});return Ya}}ra.E5m=5;ra.D5m=15;ra._instance=null;Object(D.a)(ra,"FindResultAppEventCoordinator",null,[1571]);class ma{constructor(jb,ob){this.kxb=this.WQb=0;this.Mpc=this.rAc=this.Xia=null;this.$Yb=0;this.Jtb=null;this.AV=jb;this.Eja=ob;this.bXa=new ja.a;this.awb=new ja.a;this.Eab=new ja.a;this.D9a=new ja.a;
this.aXa=new ja.a(0);this.Tyc=new ja.a;for(jb=0;jb<ob.length;++jb)this.aXa.Z(ob[jb],0);this.Kjb=[]}get kE(){return this.Xia}set kE(jb){this.Xia=jb;jb=Array(1);jb[0]=this.Xia;this.AV.WNa(3,jb)}get r9(){return this.rAc}set r9(jb){this.rAc=jb}get U2(){return this.Mpc}set U2(jb){this.Mpc=jb}get wDa(){let jb=null;for(const ob of this.Eja)if(jb=this.bXa.J(ob))break;return jb}get oWe(){return this.WQb}Lfe(jb){jb!==this.WQb&&(this.WQb=jb)}get Cia(){return this.kxb}bic(jb){jb!==this.kxb&&(this.kxb=jb,this.AV&&
!this.kxb&&(this.AV.$de(0),this.AV.Gfe(0)))}get I6a(){return this.$Yb}get kbc(){return this.Jtb}wWe(jb,ob){if(jb&&!(0>=jb.length)){var Ya=jb[0].type,Xa=ob,Sa=Xa?Xa.next:this.bXa.J(Ya);Xa||this.bXa.Z(Ya,jb[0]);for(const ab of jb){const Hb=ab;this.Tyc.Z(Hb.id,Hb);Xa&&(Xa.next=Hb);Hb.previous=Xa;Xa=Hb}Xa&&(Xa.next=Sa);Sa&&(Sa.previous=Xa);ob&&jb[0].nodeId.equals(ob.nodeId)||this.Eab.Z(jb[0].nodeId,jb[0]);!Sa&&Xa&&this.awb.Z(Xa.type,Xa);this.kbc===ob&&(this.Jtb=Xa);this.aXa.Z(Ya,this.aXa.J(Ya)+jb.length);
this.bic(this.Cia+jb.length);this.$Yb=this.I6a+jb.length;this.AV&&this.AV.WNa(0,jb)}}jyd(jb){!jb||0>=jb.length||this.wWe(jb,this.awb.J(jb[0].type))}Ejh(jb){!jb||0>=jb.length||(this.kbc&&this.kbc.type!==jb[0].type&&(this.Jtb=null),this.wWe(jb,this.kbc))}K2c(jb){const ob=this.p7b(jb);if(ob){jb=ob;for(var Ya=0;jb;){++Ya;if(!jb.next||!jb.nodeId.equals(jb.next.nodeId))break;jb=jb.next}this.Z4i(ob,jb)}else k.ULS.sendTraceTag(4069027,313,15,"RemoveResultsForNode called for node not in cache: {0}",jb.toString())}Z4i(jb,
ob){let Ya=0,Xa=0;const Sa=[];let ab=jb;for(;ab!==ob.next;){const Hb=this.Hwi(ab);this.Eab.J(ab.nodeId).id===ab.id&&(ab.next&&ab.next.nodeId.equals(ab.nodeId)?(this.Eab.Z(ab.nodeId,ab.next),Hb&&this.D9a.Z(ab.nodeId,ab.next)):(this.Eab.remove(ab.nodeId),Hb&&this.D9a.remove(ab.nodeId)));this.kbc&&this.kbc.id===ab.id&&(this.Jtb=jb.previous);this.r9&&this.r9.id===ab.id&&(this.r9=this.Qpf(ab,jb));this.U2&&this.U2.id===ab.id&&(this.U2=this.Qpf(ab,jb));this.kE&&this.kE.id===ab.id&&(this.kE=this.Qpf(ab,jb));
this.Tyc.remove(ab.id);Sa.push(ab);ab=ab.next;Hb?++Xa:++Ya}jb.previous?jb.previous.next=ob.next:ob.next?this.bXa.Z(ob.type,ob.next):this.bXa.remove(ob.type);ob.next?ob.next.previous=jb.previous:jb.previous?this.awb.Z(jb.type,jb.previous):this.awb.remove(jb.type);ob.next=null;jb.previous=null;this.aXa.Z(jb.type,this.aXa.J(jb.type)-Ya);this.bic(this.Cia-Ya);this.$Yb=this.I6a-(Ya+Xa);this.AV&&this.AV.WNa(1,Sa)}Tbe(jb,ob){const Ya=this.p7b(jb);if(Ya){const Xa=[],Sa=[],ab=[];let Hb=Ya,pb,Mb=0;do Mb<ob.length?
(Hb.j0k(ob[Mb]),Xa.push(Hb)):(Sa.push(Hb),this.r9&&this.r9.id===Hb.id&&0<Xa.length&&(this.r9=Xa[Xa.length-1])),++Mb,pb=Hb,Hb=Hb.next;while(Hb&&pb.nodeId.equals(Hb.nodeId));for(;Mb<ob.length;++Mb)ab.push(ob[Mb]);0<Sa.length&&this.Z4i(Sa[0],Sa[Sa.length-1]);0<ab.length&&this.wWe(ab,0<Xa.length?Xa[Xa.length-1]:Ya);ob=Xa.length;if(0<ob){if(this.D9a.ob(jb)){this.D9a.remove(jb);this.bic(this.Cia+ob);let Qb,Aa;(Qb=this.aXa).Z(Aa=Xa[0].type,Qb.J(Aa)+ob)}this.AV&&this.AV.WNa(4,Xa)}}else k.ULS.sendTraceTag(4069056,
313,15,"ReplaceResultsForNode: NodeId not found in cache nodeId={0}",jb.toString())}JAh(){this.Eab=new ja.a;this.D9a=new ja.a;this.bXa=new ja.a;this.awb=new ja.a;this.Tyc=new ja.a;for(let jb=0;jb<this.Eja.length;++jb)this.aXa.Z(this.Eja[jb],0);this.kE=null;this.Lfe(0);this.U2=this.r9=this.Jtb=null;this.bic(0);this.$Yb=0;this.AV&&this.AV.WNa(2,null)}kGi(){this.D9a=new ja.a;this.Eab.forEach((jb,ob)=>{this.D9a.Z(jb,ob);return!0});for(let jb=0;jb<this.Eja.length;++jb)this.aXa.Z(this.Eja[jb],0);this.kE=
null;this.Lfe(0);this.Jtb=null;this.bic(0);this.AV&&this.AV.WNa(2,null)}p7b(jb){return this.Eab.ob(jb)?this.Eab.J(jb):null}Vj(jb){let ob=null;this.Tyc.ob(jb)&&(ob=this.Tyc.J(jb));return ob}X4h(jb){return this.bXa.ob(jb)?this.bXa.J(jb):null}bUl(jb){return this.awb.ob(jb)?this.awb.J(jb):null}gpb(){var jb=0;if(this.kE){jb=0;const Xa=this.kE.type;var ob=this.bXa.J(Xa);if(ob){for(var Ya=1;ob&&this.kE.id!==ob.id;)this.Hwi(ob)||++Ya,ob=ob.next;ob&&(jb=Ya)}if(ob){ob=0;for(Ya=0;Ya<this.Eja.length&&this.Eja[Ya]!==
Xa;++Ya)ob+=this.aXa.J(this.Eja[Ya]);jb=ob+jb}else k.ULS.sendTraceTag(4069057,313,10,"UpdateActiveIndexFromActiveResult, active result not found in cache, setting it to null"),this.kE=null,jb=0}this.Lfe(jb);this.AV&&(this.AV.$de(this.oWe),this.AV.Gfe(this.Cia))}z0a(jb){return this.iPd(jb,!1)}WPd(jb){return this.iPd(jb,!0)}iPd(jb,ob){let Ya=ob?jb.previous:jb.next,Xa=jb.type;for(;!Ya&&(Xa=this.HXl(Xa,ob),Ya=ob?this.bUl(Xa):this.X4h(Xa),Xa!==jb.type););return Ya||jb}s6b(jb){return this.X1h(jb,!1)}w7h(jb){return this.X1h(jb,
!0)}X1h(jb,ob){let Ya=this.iPd(jb,ob);for(;Ya.nodeId.equals(jb.nodeId)&&Ya.id!==jb.id;)Ya=this.iPd(Ya,ob);return Ya}HXl(jb,ob){let Ya=0;for(let Xa=0;Xa<this.Eja.length;++Xa)if(jb===this.Eja[Xa]){Ya=Xa;break}ob?(--Ya,0>Ya&&(Ya=this.Eja.length-1)):(++Ya,Ya===this.Eja.length&&(Ya=0));return this.Eja[Ya]}o8i(){this.Jtb=null}Qpf(jb,ob){jb=this.z0a(jb);jb.id===ob.id&&(jb=null);return jb}Hwi(jb){return this.D9a.ob(jb.nodeId)}static createInstance(jb,ob,Ya=!1){return Ya?new ma(jb,ob):ma._instance||(ma._instance=
new ma(jb,ob))}}ma._instance=null;Object(D.a)(ma,"FindResultManager",null,[1550]);class Ba{constructor(jb,ob){this.vcm=Ya=>{const Xa=this.$o.Hi.Db(Ya.nodeId);if(Xa){if(this.WB.kE){var Sa=this.$o.Hi.Db(this.WB.kE.nodeId);(Sa=Object(x.a)(67,Sa))?Sa.lAh():k.ULS.sendTraceTag(4069060,313,15,"{0}",{["GoToResultInternal"]:"ActiveHitNodeNotFound",["NodeId"]:this.WB.kE.nodeId})}Xa.wJf(Ya.UOa,Ya.type)?(this.WB.kE=Ya,k.ULS.sendTraceTag(4065305,313,50,"{0}",{["GoToResultInternal"]:"Success",["ResultId"]:Ya.id})):
c(1925).FindManager.instance.Oii()?k.ULS.sendTraceTag(4575581,313,15,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Xa.id,["HitIndexInNode"]:Ya.UOa,["ResultId"]:Ya.id}):k.ULS.sendTraceTag(4069061,313,10,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Xa.id,["HitIndexInNode"]:Ya.UOa,["ResultId"]:Ya.id});this.WB.gpb()}else k.ULS.sendTraceTag(4069059,313,10,"{0}",{["GoToResultInternal"]:"Invalid findResult.NodeId",["NodeId"]:Ya.nodeId})};this.WB=jb;this.$o=ob;this.xtf=this.vcm}ogi(){const jb=
this.WB.kE?this.WB.z0a(this.WB.kE):this.WB.wDa;this.xtf(jb)}ucm(){const jb=this.WB.kE?this.WB.WPd(this.WB.kE):this.WB.wDa;this.xtf(jb)}rgi(jb){const ob=this.WB.Vj(jb);ob?this.xtf(ob):k.ULS.sendTraceTag(4069058,313,10,"{0}",{["GoToResult"]:"Invalid FindResult",["ResultId"]:jb})}static vE(jb){return new Ba(jb,ba.FindManagerHelper.instance)}static createInstance(jb){return Ba._instance||(Ba._instance=Ba.vE(jb))}}Ba._instance=null;Object(D.a)(Ba,"FindResultNavigator",null,[1549]);var Pa=c(16),Da=c(1217);
K=c(109);class Ha{static Nlb(jb){const ob=[];var Ya=RegExp('"[^"\\r\\n]*"',"ig"),Xa=jb.match(Ya);let Sa;if(Xa&&0<Xa.length)for(Sa=0;Sa<Xa.length;Sa++){var ab=Xa[Sa].split('"').join("");ab=ab.trim();ab=ab.split(Ha.r7c).join(" ");if(""!==ab){ob.push(ab);var Hb=ab.split(Ha.punctuation).join(" ");Hb=Hb.trim();Hb=Hb.split(Ha.r7c).join(" ");""!==Hb&&Hb!==ab&&ob.push(Hb)}}jb=jb.split(Ya).join(" ");Ya=Da.a.instance.JGl(jb);if(!Ya.length)return ob.sort(Ha.Enj),ob;Xa=Ya[0];for(Sa=1;Sa<Ya.length;Sa++)if(Hb=
Ya[Sa],2!==Xa.hL||2!==Hb.hL)ab=jb.substring(Xa.cp,Hb.cp),ab=ab.trim(),Ha.rzi(ab,Xa)&&ob.push(ab),Xa=Hb;ab=jb.substring(Xa.cp,jb.length);ab=ab.trim();Ha.rzi(ab,Xa)&&ob.push(ab);ob.sort(Ha.Enj);return ob}static rzi(jb,ob){return""!==jb&&'"'!==jb&&1!==ob.hL}static OXn(jb){for(let ob=0;ob<jb.length;ob++)jb[ob]=jb[ob].split(Ha.r7c).join("\\s+");return jb}static Enj(jb,ob){return jb.length>ob.length?-1:jb.length===ob.length?0:1}}Ha.punctuation=RegExp("[\\[\\]\\\\\\^\\$\\.\\|\\+\\(\\)\\?\\*\\-_=,;:%!'<>/@#&{}]");
Ha.r7c=RegExp("\\s+");Ha.bNn=[new K.a(RegExp("\\[","g"),"\\["),new K.a(RegExp("\\]","g"),"\\]"),new K.a(RegExp("\\\\","g"),"\\\\"),new K.a(RegExp("\\^","g"),"\\^"),new K.a(RegExp("\\$","g"),"\\$"),new K.a(RegExp("\\.","g"),"\\."),new K.a(RegExp("\\|","g"),"\\|"),new K.a(RegExp("\\+","g"),"\\+"),new K.a(RegExp("\\(","g"),"\\("),new K.a(RegExp("\\)","g"),"\\)"),new K.a(RegExp("\\?","g"),"\\?"),new K.a(RegExp("\\*","g"),"\\*")];Object(D.a)(Ha,"SearchAndFindUtils",null,[]);class oa{dfc(jb){return Pa.a.rfa(jb,
Ha.bNn)}Nlb(jb){jb=Ha.Nlb(jb);return jb=Ha.OXn(jb)}BXi(){return null}qZd(){return!1}static get instance(){return null!=oa.Hyg?oa.Hyg:oa.Hyg=new oa}}Object(D.a)(oa,"QueryProcessor",null,[952]);var wa=c(731),ia=c(21),ca=c(14),pa=c(31),Ma=c(660),ya=c(771),Oa=c(213),fa=c(249);class Ca{constructor(){this.j3c=this.transaction=null;this.PHa=this.A3f=0;this.x3f=this.Ceb=null}}Object(D.a)(Ca,"ReplaceAllContext",null,[]);class Ta{constructor(jb,ob,Ya,Xa,Sa,ab,Hb,pb,Mb,Qb,Aa){this.bin=(bb,nb,Va,Ab,Zb)=>{let Kb=
null;if(bb>nb)for(Kb=Va;0<nb&&Kb.nodeId.equals(Zb.id);)Kb=this.WB.z0a(Kb),--nb;else 0<bb?Kb=this.WB.s6b(Va):Ab.nodeId!==Zb.id&&(Kb=Ab);return Kb};this.BAh=()=>{const bb=this.WB.Kjb;if(bb&&0<bb.length){const nb=this.Ic.Qc(3);nb.Eb(this.$o.Hi.Db(bb[0]));for(let Va=0;Va<bb.length;++Va){const Ab=this.$o.Hi.Db(bb[Va]);Ab?Ab.Oea(!1,!0):k.ULS.sendTraceTag(4069064,313,10,"Last replaced node not found in object Space, NodeId: {0}",bb[Va])}nb.dispose();Array.clear(this.WB.Kjb)}};this.Fnn=(bb,nb)=>{this.Kyc=
!0;this.B4i();const Va=new Ca;Va.j3c=bb?bb:"";Va.x3f=nb;Va.PHa=this.WB.Cia;bb=this.Ic.Qc(15);bb.Eb(this.$o.Wc);Va.transaction=bb;this.oql(Va,bb)};this.uhn=(bb,nb)=>{bb=new wa.a(null,this.gCn,bb);const Va=this.$o.Wc;Va&&Va.pH().NE.Q6(9);bb.ul("ReplaceAll");nb.ZGa(bb);bb.run()};this.vln=(bb,nb)=>{bb=this.ge.eg("UserAction","OnProcessReplaceAll");if(this.LIm(nb))return this.IWk(nb),!1;let Va=nb.Ceb;Va||(Va=this.WB.wDa);nb.Ceb=this.WB.s6b(Va);const Ab=this.$o.Hi.Db(Va.nodeId);if(!Ab)return k.ULS.sendTraceTag(4065307,
313,10,"ReplaceAll: Node for result with id: {0} and nodeId: {1}, Not Found!",Va.id,Va.nodeId),!0;const Zb=Ab.Kma();if(Zb&&Zb.length)if(this.RNk(Ab,Zb[0].begin,Zb[0].end))k.ULS.sendTraceTag(5007254,313,50,"ReplaceAll: Skipping node: {0} as Paragraph is locked",Ab.id);else{let Kb=0;for(let dc=0;dc<Zb.length;++dc){nb.A3f+=1;const jc=this.replaceText(this.JA.Zhf,Ab,nb.j3c,pa.a.createTextRange(Ab,Zb[dc].begin+Kb,Zb[dc].end+Kb));Kb+=nb.j3c.length-(Zb[dc].end-Zb[dc].begin)+jc;Ab.p9f(0,nb.j3c.length)}0<
nb.j3c.length&&this.WB.Kjb.push(Va.nodeId)}else k.ULS.sendTraceTag(4065308,313,15,"ReplaceAll: No hits found for result with id: {0} and nodeId: {1}!",Va.id,Va.nodeId);bb.stop();return!0};this.Yfn=bb=>{bb.transaction.dispose();this.Kyc=!1;this.JA.RYa(!1);bb.x3f&&bb.x3f(bb.A3f,bb.PHa)};this.fmn=(bb,nb,Va,Ab)=>{!bb.matchCase&&0<Va.length&&(bb=nb.eva().substr(Ab.cpBegin,Ab.cpEnd-Ab.cpBegin),Va=this.CMk(Va,bb));return this.Lyc(Ab,Va,!0,!1)};this.JA=jb;this.WB=ob;this.$o=Ya;this.Ic=Xa;this.EGe=Sa;this.n1j=
Hb;this.fHg=pb;this.Lyc=Mb;this.w3j=Qb;this.ge=Aa;this.Kyc=!1;this.cvo=this.Fnn;this.gCn=this.vln;this.IWk=this.Yfn;this.oql=this.uhn;this.B4i=this.BAh;this.replaceText=this.fmn;this.CMk=Ta.gfn;this.OXl=this.bin}get j0(){return this.EGe.value}get i3c(){return this.Kyc}replace(jb){var ob=!1;if(this.i3c)return k.ULS.sendTraceTag(4069062,313,15,"Replace: Cancelled as replace is already in progress"),ob;if(this.j0.W9k){var Ya=this.j0.d3;const ab=Ya.node;Ya.contextId===ca.a.paragraph&&(Ya=pa.a.createTextRange(ab,
0,W.ParagraphReader.textLength(ab)));var Xa=Object(x.a)(67,ab);if(Xa){var Sa=new ya.a(Ya.cpBegin,Ya.cpEnd);Sa=Xa.F6h(Sa);if(Sa!==Ma.a.invalid&&0<=Sa){if(this.Qyh(Ya))return k.ULS.sendTraceTag(5007250,313,50,"Replace: Cancelled as Paragraph is locked"),ob;this.Kyc=!0;ob=this.Ic.Qc(15);ob.Eb(ab);this.replaceText(this.JA.Zhf,Xa,jb,Ya);ob.dispose();this.B4i();Xa.p9f(Sa,jb.length);0<jb.length&&this.WB.Kjb.push(ab.id);jb=this.WB.p7b(ab.id);Ya=this.WB.z0a(jb);Xa=Xa.Kma();Xa=this.$o.A2d(ab.id,Xa,null,jb.type,
jb.MVd);this.WB.Tbe(ab.id,Xa);(Ya=this.OXl(Xa.length,Sa,jb,Ya,ab))?this.JA.R3c.rgi(Ya.id):this.WB.gpb();ob=!0;this.Kyc=!1}else k.ULS.sendTraceTag(5007251,313,50,"Replace: Cancelled as current selection not on a find hit.")}else k.ULS.sendTraceTag(4069063,313,15,"Replace: Failed as No node found corresponding to current selection")}else k.ULS.sendTraceTag(5007252,313,50,"Replace: Cancelled as current selection does not contain single context");ob?(k.ULS.sendTraceTag(4065306,313,50,"ReplaceManager Replace Success"),
this.JA.y3f=!0):(k.ULS.sendTraceTag(5007253,313,50,"ReplaceManager Replace Not Successful"),this.JA.R3c.ogi());return ob}replaceAll(jb,ob){this.i3c?k.ULS.sendTraceTag(4069065,313,15,"ReplaceAll: Called when Replace is already in Progress"):this.WB.Cia?this.cvo(jb,ob):k.ULS.sendTraceTag(4069066,313,15,"ReplaceAll: Called when total results is 0")}Qyh(jb){const ob=this.n1j(jb);!ob&&this.fHg.value&&this.w3j.value&&this.fHg.value(jb.node);return ob}RNk(jb,ob,Ya){return this.Qyh(pa.a.createTextRange(jb,
ob,Ya))}LIm(jb){return jb.Ceb===this.WB.wDa}static get characterPropertiesEditor(){return null!=Ta.etg?Ta.etg:Ta.etg=ia.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static vE(jb,ob){const Ya=new u.a(()=>J.App.xd&&J.App.xd.Vq?Object(y.a)(J.App.xd.Vq,J.App.xd.Vq.aH,"acquireAndApplyLock"):null);return new Ta(jb,ob,ba.FindManagerHelper.instance,new v.a,new u.a(()=>Oa.a.instance),new u.a(()=>U.a.instance),Object(y.a)(fa.a.instance,fa.a.instance.Vzm,"isContextSetInLockedRange"),Ya,Object(y.a)(Ta.characterPropertiesEditor,
Ta.characterPropertiesEditor.replaceTextRange,"replaceTextRange"),new u.a(()=>J.App.xd.Yp),J.App.ya.xq)}static createInstance(jb,ob){return Ta._instance||(Ta._instance=Ta.vE(jb,ob))}static gfn(jb,ob){const Ya=Pa.a.fh(ob);!Pa.a.localeCompare(Pa.a.BA(ob),ob)&&Pa.a.localeCompare(Ya,ob)?jb=Pa.a.BA(jb):Pa.a.Iac(ob.charAt(0))&&!Pa.a.VBf(ob.charAt(0))&&(ob=Pa.a.BA(jb.substr(0,1)),jb=1===jb.length?ob:ob+jb.substr(1,jb.length-1));return jb}}Ta._instance=null;Object(D.a)(Ta,"ReplaceManager",null,[1495]);c.d(L,
"FindManager",function(){return eb});class eb extends V.a{constructor(jb,ob,Ya,Xa,Sa,ab,Hb,pb,Mb,Qb,Aa,bb,nb,Va,Ab,Zb=!1){super(jb,ob,Ya,Sa,ab,nb,Va,Aa,bb);this.Dja=this.rzc=null;this.Lwd=!1;this.oBa=this.r9a=this.eab=null;this.vrc=0;this.hud=Xa;this.Ttb=Hb;this.Xc=pb;this.Ic=Mb;this.TLe=Qb;this.mXj=Ab;this.fvc=[];this._state=2;this.zwb=!Zb;this.krb=new I;this.$o.yXe(this.krb);this.sYb=new I;this.$o.yXe(this.sYb);this.$o.Wc&&(this.eab=this.$o.Hi);this.rlg=400;this.Zlc=100}get nb(){return this.Ttb.value}get Zhf(){return this.rzc}get PKd(){return this.mXj.value}RYa(jb=
!0){this.VLb&&this.VLb.i3c||(this.Adb(jb),this.$9a.reset(),this.VXa="",this.hud&&this.PKd.stop(),this.yRk(),this.Wgj(null))}yRk(){this.A6&&(this.taskManager.Se(this.A6),this.A6=null);this.PJa&&(this.taskManager.Se(this.PJa),this.PJa=null)}Adb(jb=!0){!this.eab&&0<this.Jj.I6a&&k.ULS.sendTraceTag(4235910,313,10,"{0}",{["CancelFind"]:"LastKnowSpaceNull"});if(0<this.Jj.I6a&&this.eab){let Ya=this.Jj.wDa;const Xa=Ya.nodeId;if(this.eab.Db(Xa)){const Sa=this.Ic.Qc(3);for(Sa.Eb(this.eab.Db(Xa));Ya;){const ab=
this.eab.Db(Ya.nodeId);var ob=Object(x.a)(67,ab);if(ob){if(this.zwb&&(ob.Oea(void 0,jb),W.ParagraphReader.Yb(ab)&&(ob=this.$o.N4h(ab))))for(const Hb of ob)Hb.Oea(void 0,jb);ab.Wk(16,!0)}Ya=this.Jj.s6b(Ya);if(!Ya||Ya.nodeId.equals(Xa))break}Sa.dispose()}else k.ULS.sendTraceTag(4235911,313,10,"ClearFindHits: Error - node not in last known space");this.Jj.JAh()}jb&&this.VLb&&this.VLb.BAh();this.v8i();this.fvc=[];this.JTb=this.rzc=null;this.oL=0;this.y3f=this.Lwd=!1}N3c(){const jb=this.RV;this.Adb();
jb&&""!==jb.text&&this.find(jb)}jjj(){return""===this.VXa}Oii(){return this.hud&&this.PKd.Ihm}R8i(){10>this.vrc?(this.vrc++,k.ULS.sendTraceTag(4069014,313,15,"{0}",{["ErrorRestartCount"]:this.vrc}),this.find(this.RV)):(k.ULS.sendTraceTag(4235912,313,10,"RestartFindAfterErrorCondition: max retries reached"),l.AFrameworkApplication.xa.processAction(F.a.nzb,2),this.vrc=0)}V0i(){var jb=(new Date).getTime();let ob=!1;this.Jj.I6a||(ob=!0);let Ya=0;if(!ob){this.Jj.r9||(this.Jj.r9=this.Jj.wDa);this.Jj.U2||
(this.Jj.U2=this.Jj.r9,this.Jj.kE=null);let Xa=null,Sa=!0;for(;!ob&&this.Jj.U2&&(new Date).getTime()-jb<V.a.aHi;){const ab=this.Jj.U2,Hb=this.$o.Hi.Db(ab.nodeId);Hb?(Sa&&(Xa=this.Ic.Qc(3),Xa.Eb(Hb),Sa=!1),ab.MVd&&!this.r9a&&(this.r9a=Hb),this.Jj.U2=this.Jj.s6b(this.Jj.U2),ob=!this.Jj.U2||this.Jj.U2.nodeId.equals(this.Jj.r9.nodeId),this.Ptf(Hb,ab.type,this.zwb),++Ya):this.Jj.K2c(ab.nodeId)}Xa&&Xa.dispose()}this.Jj.gpb();ob&&(this.Jj.U2=null,this.Lwd?this._state=0:(this._state=2,this.Gnb(!0)));this.A6=
new e.a(2,1,this.Zlc,Object(y.a)(this,this.findInternal,"findInternal"),52);this.taskManager.Wb(this.A6);jb=(new Date).getTime()-jb;k.ULS.sendTraceTag(4065247,313,50,"{0}",{["RecheckTime"]:jb,["Count"]:Ya,["Total"]:this.Jj.Cia,["TotalWithDirty"]:this.Jj.I6a})}gzn(){this.Adb();this.oL=0;if(this.$o.Jzf&&this.zwb){var jb=this.nb;if(jb){var ob=jb.hb.lb;if(ob){var Ya=J.App.ya.jb.xc;(Ya=Ya?Ya.Cs:null)&&Ya.w6a();ob=T.SelectionEditor.Bj(ob,!1,!1);jb.setSelection(ob);Ya&&Ya.rYa()}}}jb=this.Pel();this.Dja=
this.dXj.L4h(jb)}Xgj(){this.Wgj(this.Dja[this.oL].ria)}Wgj(jb){this.kgo(jb);this.rej(jb)}v8i(){this.r9a=null;this.DUb=!1}Npf(jb){const ob=this.Xc.Ck();ob.set(jb);if(!ob.Ab(7))return ob.reset(),null;if(this.$o.g3d(ob,7,0))return jb=ob.currentNode,ob.reset(),jb;k.ULS.sendTraceTag(4235914,313,10,"GetNextFindableNode: No findable nodes");ob.reset();return null}Pel(){if(this.$o.Jzf){var jb=this.nb;if((jb=jb?jb.hb.lb:null)&&this.zwb)return jb.Rc.Xk?(jb=jb.Rc,T.SelectionEditor.Xu(jb)?(jb=jb.node,Object(m.a)(67,
jb)?jb:this.Npf(jb)):Object(m.a)(67,jb.node)?jb.node:this.Npf(jb.node)):this.Npf(this.$o.Wc);jb=this.Xc.Ck();jb.set(this.$o.Wc);if(this.$o.Bhg(jb,8,1)){k.ULS.sendTraceTag(4069018,313,50,"No Selection: No selection, choosing title or first findable");const ob=jb.currentNode;jb.reset();return ob}k.ULS.sendTraceTag(4235915,313,10,"TryMoveToPageLeadingContent failed")}k.ULS.sendTraceTag(4235916,313,10,"Error: ContentView isn't PageView");return null}Orf(){const jb=this.Xc.Ck();jb.set(this.sYb);if(1===
jb.pq())return jb.Sd(),jb.currentNode;k.ULS.sendTraceTag(4069019,313,15,"Something went wrong in GetStartingNode...");return null}kgo(jb){const ob=this.Ic.Qc(3);ob.Eb(this.sYb);const Ya=this.Xc.Ck();Ya.set(this.sYb);Ya.dA()&&(Ya.Sd(),Ya.Dg());jb&&(Ya.Qf(jb,81),jb=this.Dja[this.oL],this.sYb.w5f=jb.rootNode.type,this.sYb.aif=jb.k5b);ob.dispose()}rLl(){if(this.krb){var jb=this.Xc.Ck();jb.set(this.krb);if(jb.pq())return jb.Sd(),jb.currentNode;jb=this.TLe(this.$o.Wc);jb.moveNext();if(jb.currentNode)return jb.currentNode}k.ULS.sendTraceTag(4069020,
313,15,"Something went wrong in GetCurrentNode...");return null}rej(jb){const ob=this.Ic.Qc(3);ob.Eb(this.krb);const Ya=this.Xc.Ck();Ya.set(this.krb);Ya.dA()&&(Ya.Sd(),Ya.Dg());jb&&(Ya.Qf(jb,81),jb=this.Dja[this.oL],this.krb.w5f=jb.rootNode.type,this.krb.aif=jb.k5b);ob.dispose()}zRd(){let jb=this.Jj.kE||this.Jj.wDa;if(jb){for(var ob=!1,Ya=!0;jb;){var Xa=this.$o.Hi.Db(jb.nodeId);if(Xa=Object(x.a)(67,Xa))if(ob=Xa.xJf(jb.type)){Ya&&(jb=this.Jj.z0a(jb));break}else jb=this.Jj.z0a(jb);else if(Ya=jb,jb=
this.Jj.s6b(jb),this.Jj.K2c(Ya.nodeId),!jb||Ya.nodeId.equals(jb.nodeId))break;Ya=!1}ob?(this.Jj.kE=jb,this.Jj.gpb(),k.ULS.sendTraceTag(4065248,313,50,"FindManager GoToNextHit Success")):k.ULS.sendTraceTag(4069022,313,15,"Failed to go to Next Hit")}}ARd(){let jb=this.Jj.kE||this.Jj.wDa;if(jb){for(var ob=!1,Ya=!0;jb;){var Xa=this.$o.Hi.Db(jb.nodeId);if(Xa=Object(x.a)(67,Xa))if(ob=Xa.cGi(jb.type)){Ya&&(jb=this.Jj.WPd(jb));break}else jb=this.Jj.WPd(jb);else if(Ya=jb,jb=this.Jj.w7h(jb),this.Jj.K2c(Ya.nodeId),
!jb||Ya.nodeId.equals(jb.nodeId))break;Ya=!1}ob?(this.Jj.kE=jb,k.ULS.sendTraceTag(4065249,313,50,"FindManager GoToPreviousHit Success")):k.ULS.sendTraceTag(4069024,313,15,"Failed to go to Previous Hit");this.Jj.gpb()}}dMk(){return 2===this._state&&(this.y3f||this.hud&&this.PKd.$8i)}$Pf(){this.$o.Lna?(this.VXa=this.Sda.dfc(this.RV.text),this.eab=this.$o.Hi,this.v8i()):this.R8i()}toj(){this.hud&&this.PKd.start()}O3e(){if(!this.$o.Lna||this.eab!==this.$o.Hi)return this.Adb(),this.R8i(),!0;this.vrc=0;
return!1}B4f(){const jb=this.Sda.Nlb(this.VXa),ob=this.dMk();let Ya=!1;if(ob||this.$o.mwi(this.rzc,this.fvc,this.RV,jb)){Ya=!0;this.Gnb(!1);this.$9a.update();this.$9a.dif();!ob&&this.$o.wwi(this.rzc,this.fvc,this.RV,jb)?(this.Jj.kGi(),this.Jj.U2=null,this._state=1):(this.gzn(),this.Xgj(),this._state=0,this.Lwd=!0);this.rzc=this.RV;this.fvc=jb;try{this.JTb=this.KTb.TDb(this.fvc.join("|"),this.RV)}catch(Xa){return k.ULS.sendTraceTag(0,313,10,"FindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",
this.RV.matchCase,this.RV.matchWholeWord),this.JTb=null,this._state=2,this.Gnb(!0),!0}this.A6=new e.a(2,1,this.Zlc,Object(y.a)(this,this.findInternal,"findInternal"),52);this.taskManager.Wb(this.A6)}return Ya}HMi(){if(!this.r9a){const jb=this.Xc.Ck();jb.set(1===this.Dja[this.oL].k5b?this.$o.Wc:this.Dja[this.oL].rootNode);this.$o.Bhg(jb,this.Dja[this.oL].rootNode.type,this.Dja[this.oL].k5b)?(this.r9a=jb.currentNode,jb.reset()):(k.ULS.sendTraceTag(17306254,313,10,"TryToMoveToPageLeadingParagraph failed."),
jb.reset(),this.A6=new e.a(2,1,this.Zlc,Object(y.a)(this,this.findInternal,"findInternal"),52),this.taskManager.Wb(this.A6))}}KPf(){this.Jj.gpb();this.rej(this.oBa.currentNode);this.oBa.currentNode===this.Orf()&&(this.oL++,this.oL===this.Dja.length?(this.oL=0,this._state=2,this.Lwd=!1,this.Gnb(!0)):this.Xgj());this.oBa=null}Mci(){return this.Orf()}xXi(){const jb=this.rLl();this.oBa=this.Xc.Ck();this.oBa.set(jb);this.oBa.I0(this.Dja[this.oL].rootNode)}zhj(){const jb=this.Ic.Qc(3);jb.Eb(this.oBa.currentNode);
return jb}KTf(){this.Ptf(this.oBa.currentNode,this.Dja[this.oL].k5b,this.zwb);this.$o.g3d(this.oBa,this.Dja[this.oL].rootNode.type,this.Dja[this.oL].k5b)}V6e(jb){return!!this.oBa.currentNode&&!this.oBa.currentNode.id.equals(jb.id)}fzh(jb){!this.DUb&&this.r9a&&jb.id===this.r9a.id&&this.Orf().id!==this.r9a.id&&0<this.Jj.I6a&&(this.DUb=!0,this.Jj.o8i())}eyd(jb,ob,Ya,Xa){const Sa=this.Jj.p7b(jb);Sa?this.Jj.Tbe(jb,ob):this.DUb?this.Jj.Ejh(ob):this.Jj.jyd(ob);this.zwb&&!this.Jj.kE&&0<ob.length&&Ya.xJf(Xa)&&
(this.Jj.kE=Sa?Sa:ob[0],this.Jj.r9||(this.Jj.r9=this.Jj.kE))}cia(jb,ob){jb.cia(ob)}Oea(jb){this.zwb&&jb.Oea()}IJf(jb){jb.Wk(16,!0)}static vE(jb,ob,Ya,Xa,Sa=!1){ob||(ob=oa.instance);Ya||(Ya=da.instance);const ab=ma.createInstance(jb,Ya.Qdg,Sa),Hb=new u.a(()=>Ta.createInstance(eb.instance,eb.instance.Jj)),pb=new u.a(()=>Ba.createInstance(eb.instance.Jj)),Mb=new u.a(()=>ra.createInstance(eb.instance,jb));return new eb(jb,ob,Ya,Xa,ba.FindManagerHelper.instance,new u.a(()=>l.AFrameworkApplication.oc),
new u.a(()=>U.a.instance),new z.a,new v.a,E.a.createInstance,a.a.instance,ab,Hb,pb,Mb,Sa)}static get instance(){return eb._instance}static createInstance(jb,ob=null,Ya=null,Xa=!1,Sa=!1){return Sa?eb.vE(jb,ob,Ya,Xa,!0):eb.instance||(eb._instance=eb.vE(jb,ob,Ya,Xa))}}eb._instance=null;Object(D.a)(eb,"FindManager",V.a,[])},1927:function(D,L,c){D=c(0);var l=c(21),e=c(2),a=c(200),k=c(6),x=c(17),y=c(43),m=c(8),u=c(82),z=c(117),v=c(76),E=c(98),F=c(201),J=c(14),K=c(5),H=c(602),P=c(111),N=c(824),M=c(1024),
I=c(40),T=c(229),U=c(215),W=c(95);class V{constructor(pb){this.yoa=pb}}Object(D.a)(V,"ValidParentData",null,[]);var Y=c(42),da=c(401),ba=c(673),ja=c(392),sa=c(672),ta=c(541);class ra{constructor(){this.D3b=0}}Object(D.a)(ra,"BelowOutlineElementData",null,[]);var ma=c(649),Ba=c(865),Pa=c(560);class Da extends ma.a{constructor(pb,Mb,Qb,Aa){super(4,Aa);this.C3b=pb;this.Sxb=Mb;this.MDc=Qb}P7b(){var pb=this.C3b;if(!pb)return m.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),
null;const Mb=[],Qb=new Ba.a(this.C3b.id,this.C3b.Lc,this.Sxb?this.Sxb.id:null);""!==pb.characterData&&pb.characterData&&(pb=new Pa.DeleteTextUpdateHint(this.C3b.id,0,pb.characterData),Mb.push(pb));Mb.push(Qb);return Mb}}Object(D.a)(Da,"DeleteParagraphOperation",ma.a,[]);var Ha=c(947),oa=c(502);class wa extends ma.a{constructor(pb,Mb,Qb,Aa,bb){super(3,bb);this.Aoa=pb;this.PQa=Mb;this.H$m=Qb;this.Iwa=Aa}P7b(){const pb=[];var Mb=new Ha.AddParagraphUpdateHint(this.Iwa.id,this.Iwa.Lc,this.Aoa?this.Aoa.id:
null);pb.push(Mb);""!==this.Iwa.characterData&&this.Iwa.characterData&&(Mb=new oa.a(this.Iwa.id,0,this.Iwa.characterData),pb.push(Mb));return pb}}Object(D.a)(wa,"InsertNewParagraphOperation",ma.a,[]);var ia=c(946);class ca extends ma.a{constructor(pb,Mb,Qb,Aa){super(2,Aa);this.Aoa=pb;this.PQa=Mb;this.y2d=Qb}P7b(){const pb=[],Mb=new ia.MergeParagraphUpdateHint(this.Aoa.id,this.Aoa.Lc,this.Aoa.characterData.length,this.PQa.id,this.PQa.Lc,this.y2d.id,this.y2d.Lc);pb.push(Mb);return pb}}Object(D.a)(ca,
"MergeParagraphOperation",ma.a,[]);var pa=c(864);class Ma extends ma.a{constructor(pb,Mb,Qb,Aa,bb){super(1,bb);this.S3=pb;this.Wnj=Mb;this.Sxb=Qb;this.MDc=Aa}P7b(){const pb=[],Mb=new pa.a(this.S3.id,this.S3.Lc,this.Wnj,this.Sxb.id,this.Sxb.Lc,this.MDc.id,this.MDc.Lc);pb.push(Mb);return pb}}Object(D.a)(Ma,"SplitParagraphOperation",ma.a,[]);var ya=c(403),Oa=c(11),fa=c(558),Ca=c(47),Ta=c(1097),eb=c(37),jb=c(139),ob=c(249),Ya=c(10),Xa=c(193),Sa=c(12),ab=c(134);c.d(L,"a",function(){return Hb});class Hb{constructor(pb,
Mb,Qb,Aa,bb,nb,Va=null,Ab=null,Zb=null,Kb=null){this.XJ=pb;this.zL=Mb;this.If=Qb;this.O5=Va;this.FL=Ab;this.ax=Zb;this.Dp=Kb}Yik(pb){var Mb;(null===(Mb=Oa.App.xd)||void 0===Mb?0:Mb.Yp)&&Oa.App.xd.Vq.aH(pb)}$xa(pb,Mb,Qb,Aa=!1){I.OutlineElementNavigator.Fe(pb);Ya.ParagraphReader.rh(pb)?Hb.paragraphEditor.Xp.$xa(pb,Mb,Qb):eb.TableReader.isTable(pb)&&14===pb.Xe&&(Mb=(new ja.a(1,Qb)).wt,Qb=Object(u.a)(da.TableNode,pb.currentNode),this.ghj(Qb,Mb,Aa));I.OutlineElementNavigator.Zd(pb)}ghj(pb,Mb,Qb=!1){pb&&
Object(z.a)(da.TableNode,pb)&&(Qb?Mb?(pb.setValue(k.a.ee,Mb),Mb=eb.TableReader.Xg(pb),Hb.tk.b9f(pb,Mb)):pb.removeProperty(k.a.ee):pb.ee=Mb)}get Xp(){return M.a.JDb}get EG(){return this.FL||(this.FL=l.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get uc(){return this.ax||(this.ax=l.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Kd(){return null!=this.TEg?this.TEg:this.TEg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get lj(){return null!=this.EEg?this.EEg:
this.EEg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Qn(){return this.zL.value}get Ad(){return this.If.value}get QK(){return this.XJ.value}get Zf(){return ob.a.instance}get jD(){return null!=this.Gtg?this.Gtg:this.Gtg=l.a.instance.Ma("Box4.IContentControlConverter")}pAb(){const pb=N.a.instance.createInstance(393229);pb.setValue(x.a.SK,T.a.first);pb.setValue(x.a.c9k,new Date);pb.n$c();return pb}$5k(){const pb=new Ta.a;pb.setValue(x.a.SK,T.a.first);return pb}cef(pb,
Mb,Qb=!1){Y.OutlineElementReader.pDf(pb)?(pb=Y.OutlineElementReader.isRtl(pb),Qb?this.kNb(Mb,pb):this.jNb(Mb,pb)):this.fUn(Mb)}Zhc(pb,Mb){const Qb=I.OutlineElementNavigator.El(pb);Y.OutlineElementReader.Mm(Qb)!==Mb&&(this.jNb(Qb,Mb),pb.anchor.YT(4))}jNb(pb,Mb){const Qb=new Ca.GraphTransaction(7);Qb.Eb(pb);this.kNb(pb,Mb);const Aa=new K.GraphIterator;Aa.set(pb);ya.a.instance.Ovm(Aa);if(Aa.Ab(10)){const bb=Aa.fd(10);Aa.Tb(1)===pb&&this.QK.jNb(bb,Mb)}Qb.dispose()}kNb(pb,Mb){let Qb=null,Aa=null;if(E.a.instance.J(1)&&
pb.isConnected){Qb=Ya.ParagraphReader.Wv(pb,!0,!0);Aa=new v.a;for(let bb=0;bb<Qb.count;bb++)12===Qb.J(bb).type&&Aa.add(Qb.J(bb).qD())}pb.properties.setValue(x.a.U_,Mb);if(E.a.instance.J(1)&&Qb&&Aa)if(Qb.count!==Aa.count)m.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",Qb.count,Aa.count);else for(pb=0;pb<Qb.count;pb++)this.lj.NU(Qb.J(pb),Aa.J(pb),this.Kd.Cg)}fUn(pb){pb.properties.removeProperty(x.a.U_)}UL(pb,Mb=null,Qb=!1){var Aa,bb=null;let nb=
null;if(!Y.OutlineElementReader.Lh(pb))return m.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;let Va=null,Ab=null,Zb=0;Mb&&(Va=Mb.formatting,Ab=Mb.xqa,Zb=Mb.languageId);Qb||({Aoa:bb,PQa:nb}=this.v_h(pb,bb,nb));Mb=F.a.instance.createInstance(393230);Mb.setValue(x.a.yo,"");pb.Qf(Mb,2);pb.Fi(Mb);Hb.paragraphEditor.NLb(Mb);Hb.paragraphEditor.k3m(Mb);Hb.paragraphEditor.ETa(Mb);this.Yik(Mb);e.AFrameworkApplication.GQ&&!e.AFrameworkApplication.j6i&&(e.AFrameworkApplication.ye("AutoRenameNewDocument-tf;AutoRenameNewDocument-cf"),
(null===(Aa=e.AFrameworkApplication.K)||void 0===Aa?0:Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocument",!1))&&this.LBk());Va&&(Mb.qa.first.formatting.Dj=Va);Zb||(Zb=e.AFrameworkApplication.lcid);pb.currentNode.Yg(x.a.$3c,pb.currentNode.ia(x.a.$3c,Zb));pb.currentNode.setValue(k.a.iRa,0);Ab&&this.EG.rJ(Ab,Mb,!0);!Qb&&bb&&(Qb=new ta.a(Mb),bb=new wa(bb,nb,bb,Qb,Mb.fDa),pb.currentNode.pH().NE.pI(bb));return Mb}LBk(){const pb=Oa.App.ya.jb.Wc.ud;var Mb=null===pb||void 0===pb?void 0:
pb.YUf;if(Mb){for(Mb=Mb.ZKc();Mb;){const Aa=pb.Db(Mb.id);if(0<Ya.ParagraphReader.textLength(Aa,9)){var Qb=jb.AParagraphNode.IOl(Aa.characterData.trim());if(0<Qb.length)break}Mb=Mb.next}Qb&&32===e.AFrameworkApplication.xa.Rb(Sa.a.renameFile,2,Qb)&&this.Dp&&this.Dp.execute(Aa=>{Aa.logActivity("AutoRenameDocumentCallout",null)})}}v_h(pb,Mb,Qb){Qb=new K.GraphIterator;Qb.$c(pb);Mb=null;Qb.KAf?Qb.currentNode.pH().NE.Q6(6):(I.OutlineElementNavigator.N_(Qb,!0,!1),Mb=this.bOd(Qb));Qb.$c(pb);Qb=this.D0h(Qb);
return{Aoa:Mb,PQa:Qb}}D0h(pb){const Mb=new K.GraphIterator;Mb.$c(pb);pb=null;Mb.dFa||(I.OutlineElementNavigator.Ir(Mb,!0,!1),pb=this.bOd(Mb));return pb}bOd(pb,Mb=!1){pb=I.OutlineElementNavigator.Fe(pb,!0);return pb?this.H5h(pb,Mb):(m.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}H5h(pb,Mb=!1){if(12===pb.type)return Mb?new ta.a(pb):new sa.a(pb);pb.pH().NE.Q6(5);return new ba.a(pb)}ySk(pb,Mb){var Qb=Mb.currentNode.clone();pb.rH(Qb,null,1);pb.Fi(Qb);Qb.haa=Mb.currentNode;
I.OutlineElementNavigator.Fe(Mb);Mb.W7&1&&Mb.currentNode.YPb(null);Qb=Mb.currentNode.clone();Qb.RSa=Mb.currentNode.RSa;Qb.$O=Mb.currentNode.$O;pb.rH(Qb,null,2);pb.Fi(Qb);pb.o_(1);Qb.haa=Mb.currentNode;Qb.setValue(k.a.Lc,a.a.aF());Mb.rt(11)}NLb(pb){pb.Tb(2)&&pb.Dg()}zXn(pb,Mb){const Qb=pb.currentNode;I.OutlineElementNavigator.Fe(pb);const Aa=pb.currentNode;I.OutlineElementNavigator.Zd(pb);Mb.ME(1);I.OutlineElementNavigator.Fe(Mb);pb.Qf(Mb.currentNode,2);Mb.Dg();var bb=new K.GraphIterator;bb.$c(Mb);
if(bb.Tb(1)){const nb=new K.GraphIterator;nb.$c(pb);const Va=new V(null);if(!this.nam(nb,bb.currentNode,Va))return;H.f(nb,null,1,1,bb,-1)}Mb.Dg();bb=null;pb.wD(1)&&(bb=pb.currentNode);for(pb.wc();U.OutlineNavigator.B8(Mb);)pb.rH(Mb.currentNode,bb,1),bb=Mb.currentNode,Mb.Dg();pb.Fi(Qb);pb.Fi(Aa);pb.Dg()}p9(pb,Mb,Qb,Aa,bb,nb,Va=!1,Ab=!1){var Zb=Y.OutlineElementReader.Lh(pb),Kb=Y.OutlineElementReader.Lh(Mb),dc=Qb.isValid&&Qb.contextId===J.a.Vc;Zb&&Kb&&dc||m.ULS.sendTraceTag(594642515,307,15,"sourceOutlineElementIsValid:{0}; destinationOutlineElementIsValid:{1}; ipContextIsValid:{2}",
Zb,Kb,dc);var jc=pb.currentNode;this.NLb(Mb);Kb=Mb.Xe;let zb,cc=null;Zb=dc=null;let Ub=!1;I.OutlineElementNavigator.Fe(pb);const Wb=pb.Xe;if(Ya.ParagraphReader.rh(pb)){zb=pb.currentNode;(dc=Object(u.a)(jb.AParagraphNode,zb))?dc.qa&&dc.qa.length||m.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",dc):m.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null");dc=new ta.a(dc);(Ub=Qb.cpBegin===Ya.ParagraphReader.textLength(zb))&&(Zb=this.D0h(Mb));const Qa=Mb.currentNode;
cc=this.UL(Mb,void 0,!0);Hb.paragraphEditor.MSa(pb,Mb,Qb,bb,nb,Va,Ab);Aa?(bb=this.uc.Uo(zb))&&this.EG.rJ(bb,cc,!0):Ub&&(bb=this.uc.Uo(zb))&&((Ab=bb.ia(y.a.Yd,null))?(bb=this.uc.qC(cc).Ni(Ab),this.EG.rJ(bb,cc,!1)):this.EG.rJ(bb,cc,!0));this.cef(jc,Qa)}I.OutlineElementNavigator.Zd(pb);I.OutlineElementNavigator.Zd(Mb);I.OutlineElementNavigator.Fe(pb);(jc=Object(u.a)(jb.AParagraphNode,pb.currentNode))?jc.qa&&jc.qa.length||m.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",
jc):m.ULS.sendTraceTag(38925761,307,15,"srcPara is null");jc=new ta.a(jc);I.OutlineElementNavigator.Zd(pb);(pb=cc)?pb.qa&&pb.qa.length||m.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",pb):(m.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),m.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:Ub,["moveText"]:nb,["overrideParagraphStyle"]:Aa,["sourceOutlineElementContentNodeType"]:Wb,["destinationOutlineElementNodeType"]:Kb,
["alwaysMoveEopToDestinationPara"]:Va}));Ub?(Qb=new ta.a(pb),Qb=new wa(dc,Zb,jc,Qb,pb.fDa),Mb.currentNode.pH().NE.pI(Qb)):(Qb=nb?new Ma(dc,Qb.cpBegin,jc,new ta.a(pb),pb.fDa):new Ma(dc,Qb.cpBegin,new ta.a(pb),jc,pb.fDa),Mb.currentNode.pH().NE.pI(Qb));return pb}Zwh(pb,Mb){I.OutlineElementNavigator.Fe(pb);let Qb=Ya.ParagraphReader.Jt(pb.currentNode)&&this.KLk(pb);const Aa=pb.currentNode;Qb=Mb?Qb&&!this.Zf.htn(Aa):Qb&&!this.Zf.Zsn(Aa);I.OutlineElementNavigator.Zd(pb);return Qb}KLk(pb){return Ya.ParagraphReader.rh(pb)&&
!Ya.ParagraphReader.deb(pb.currentNode)}merge(pb,Mb,Qb,Aa,bb=null,nb=!1,Va,Ab=!1,Zb=!1,Kb=!1){var dc;if(pb.currentNode.id===Mb.currentNode.id)return!1;let jc;const zb=new K.GraphIterator;zb.$c(Mb);Va=this.bOd(zb);zb.$c(pb);jc=this.bOd(zb,!0);if(!this.Zwh(Mb,!0)||!this.Zwh(pb,!1))return!1;if(this.Zf.kh){I.OutlineElementNavigator.Fe(pb);I.OutlineElementNavigator.Fe(Mb);var cc=Ya.ParagraphReader.rh(pb)?pb.currentNode:null,Ub=Ya.ParagraphReader.rh(Mb)?Mb.currentNode:null;I.OutlineElementNavigator.Zd(pb);
I.OutlineElementNavigator.Zd(Mb);if(cc&&Ub&&!this.Zf.$wh(cc,Ub,!1)){if(!this.jD||!this.Zf.$wh(cc,Ub,!0))return!1;this.jD&&(this.jD.Ewj(cc,!1),this.jD.Ewj(Ub,!0))}}cc=Object(u.a)(jb.AParagraphNode,pb.currentNode);cc=(Qb||!cc||!cc.characterData.length)&&!ab.ListItemReader.Kh(pb);Ab||this.Qn.merge(pb,Mb,cc,bb);I.OutlineElementNavigator.Fe(pb);bb=pb.currentNode.fDa;I.OutlineElementNavigator.Fe(Mb);if(Ya.ParagraphReader.rh(Mb)){Ab=Mb.currentNode;if(null===(dc=Oa.App.xd)||void 0===dc?0:dc.Yp)if(dc=pb.currentNode,
cc=fa.CoauthLockEditor.getInstance(),cc.V5a(this.Zf.d6b(Ab))||cc.V5a(this.Zf.d6b(dc)))return Mb.wc(),pb.wc(),!1;dc=!1;(Ab=pb.parentNode)&&Y.OutlineElementReader.Kna(Ab)&&(dc=ab.ListItemReader.Kh(Ab));(Ab=this.yjo(Ya.ParagraphReader.isEmpty(pb),dc,Qb,Aa,Zb))&&(cc=this.uc.Srf(Mb))&&this.EG.rJ(cc,pb.currentNode,!0);Qb&&(cc=Mb.currentNode,Ub=pb.currentNode,(Ab||dc)&&Xa.b(cc,Ub),Zb&&Aa||this.O5.NHi(cc,Ub,dc),e.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordPreserveEopFormattingPasteSettings"),
Kb&&(Zb=this.h0k(Ub,cc),m.ULS.sendTraceTag(588288132,307,50,"wasCopied: {0}",Zb)));Qb=Hb.paragraphEditor.merge(pb,Mb,Qb,Aa,nb);nb=zb.currentNode;Aa=pb.currentNode;pb.wc();Qb&&Y.OutlineElementReader.isEmpty(Mb,!0)&&this.d_a(Mb);pb=new ca(jc,Va,new sa.a(nb),bb);Aa.pH().NE.pI(pb);return!0}Mb.wc();pb.wc();return!1}h0k(pb,Mb){let Qb=null;Mb&&Mb.qa&&0<Mb.qa.length&&Mb.qa.first.Rh&&(Qb=Mb.qa.first.formatting);return Qb&&pb&&pb.qa&&0<pb.qa.length&&P.FormattingReader.GYk(pb.qa)?(pb.qa.last.formatting=Qb.Sf(pb.qa.last),
!0):!1}yjo(pb,Mb,Qb,Aa,bb){return Mb?!1:Qb?!(Aa&&bb):pb}cum(pb){const Mb=new K.GraphIterator;Mb.set(pb.node);Mb.yd();I.OutlineElementNavigator.Zd(Mb);const Qb=this.tna(Mb),Aa=this.tna(Mb);this.p9(Mb,Qb,pb,!1,!0,!0);Y.OutlineElementReader.isEmpty(Mb,!1)&&(this.Qn.Oha(Mb),Mb.Dg());Y.OutlineElementReader.isEmpty(Qb,!1)&&!Y.OutlineElementReader.Uib(Qb)&&(this.Qn.Oha(Qb),Qb.Dg());return Aa}uC(pb,Mb,Qb,Aa=null,bb=!1,nb=!0){if(!this.GLk(pb))return null;const Va=pb.currentNode;var Ab=!1;nb&&(Ab=ab.ListItemReader.Kh(pb),
bb=Mb||bb||!Y.OutlineElementReader.isEmpty(pb,!1),Ab=this.Qn.ano(Ab,bb));bb=Mb?pb.wD(1):pb.currentNode;pb.wc();Qb=this.QK.hib(pb,bb,Qb,Aa);if(!Qb)return null;this.cef(Va,Qb);nb&&Ab&&this.Qn.WEo(pb,Mb,Va,Qb);return Qb}GLk(pb){return Y.OutlineElementReader.Lh(pb)&&(pb=pb.parentNode,W.OutlineReader.dYd(pb)||Y.OutlineElementReader.Kna(pb)||Y.OutlineElementReader.fFa(pb))?!0:!1}GGa(pb){const Mb=new K.GraphIterator;Mb.set(pb);Mb.yd();Mb.rt(11);let Qb=null,Aa=null;({Aoa:Qb,PQa:Aa}=this.v_h(Mb,Qb,Aa));let bb=
-1;12===pb.type&&(bb=pb.fDa);Mb.currentNode?(Mb.currentNode.pH().NE.pI(new Da(this.H5h(pb,!0),Qb,Aa,bb)),this.d_a(Mb)):m.ULS.sendTraceTag(574650269,324,15,"The content to be deleted does not have a containing OE")}d_a(pb){if(pb.Xr(1)){const Mb=new ra,Qb=new K.GraphIterator;Qb.$c(pb);this.PFl(Qb,Mb)&&this.Xp.dIc(pb,-Mb.D3b)}pb.Dg();eb.TableReader.Jw(pb)&&this.cyn(pb)}hyf(pb,Mb,Qb){if(!W.OutlineReader.Kw(pb)&&!Y.OutlineElementReader.Lh(pb))return null;const Aa=this.$5k();0<Qb&&Qb<T.a.last&&Aa.setValue(x.a.SK,
Math.min(T.a.nil,Qb));pb.rH(Aa,Mb,1);return Aa}eum(pb,Mb){if(!Y.OutlineElementReader.Lh(pb)&&!Y.OutlineElementReader.HK(pb)||!W.OutlineReader.gwa(pb.parentNode)&&!Y.OutlineElementReader.Kna(pb.parentNode))return null;const Qb=pb.currentNode;let Aa;Aa=pb.currentNode;pb.wc();Mb=this.hyf(pb,Aa,Mb);pb.Fi(Qb);return Mb}cyn(pb){Y.OutlineElementReader.HK(pb)&&(pb.Xr(1)||pb.Dg());this.lXh(pb,!1);this.Rnh(pb)}lXh(pb,Mb){var Qb,Aa=null;for(Qb=pb.Tb(1);Qb;){var bb=!1;Y.OutlineElementReader.fFa(Qb)&&!pb.Xr(1)&&
(bb=!0);var nb=Qb;Qb=pb.Ti(1);if(bb)bb=new K.GraphIterator,bb.set(nb),bb.yd(),bb.Dg();else if(Y.OutlineElementReader.fFa(nb)){if(Aa){bb=new K.GraphIterator;bb.set(Aa);var Va=new K.GraphIterator;Va.set(nb);Va.yd();bb.Qf(Va.currentNode,1);Va.Dg();Va=Y.OutlineElementReader.Kfa(nb);Va===T.a.nil&&(Va=1);const Ab=Y.OutlineElementReader.Kfa(nb);(Va=Math.max(0,Ab-Va))?nb.setValue(x.a.SK,Math.min(T.a.nil,Va)):(bb.Fi(nb),pb.Tb(1),H.d(bb),bb.wc());Mb&&this.lXh(bb,!0)}}else Aa=nb}Mb=null;Aa=T.a.last+1;for(Qb=
pb.Tb(1);Qb;Qb=pb.Ti(1))if(Y.OutlineElementReader.HK(pb))nb=Y.OutlineElementReader.Kfa(Qb),Aa>nb&&(Aa=nb,Mb=Qb);else{pb.wc();return}if(Mb){for(Qb=pb.Tb(1);Qb;Qb=pb.Ti(1))Qb!==Mb&&(Qb=Y.OutlineElementReader.Kfa(Qb),pb.currentNode.setValue(x.a.SK,Math.min(T.a.nil,Qb-Aa)));Aa+=Y.OutlineElementReader.Kfa(pb.currentNode);pb.currentNode.setValue(x.a.SK,Math.min(T.a.nil,Aa));Qb=new K.GraphIterator;Qb.$c(pb);Qb.Fi(Mb);Qb.Tb(1);H.d(Qb)}}nam(pb,Mb,Qb){var Aa=Y.OutlineElementReader.Kfa(pb.currentNode);if(1===
Aa)return!0;if(Y.OutlineElementReader.HK(pb))return!1;if(!pb.ugb(1)||this.JGm(pb,Mb))return pb.currentNode.setValue(x.a.SK,Math.min(T.a.nil,1)),!0;if(Qb.yoa&&pb.Fi(Qb.yoa)){if(Y.OutlineElementReader.HK(pb)&&1===Aa+Y.OutlineElementReader.Kfa(pb.currentNode))return Qb.yoa=pb.ME(1),pb.wc(),!0;pb.wc()}if(Qb.yoa&&pb.Fi(Qb.yoa)||!Qb.yoa&&pb.Tb(1)){if(pb.currentNode!==Mb&&pb.wf(1)&&Y.OutlineElementReader.HK(pb)&&1===Aa+Y.OutlineElementReader.Kfa(pb.currentNode))return Qb.yoa=null,!0;pb.wc()}if(pb.uhb(Mb)&&
this.IGm(pb,Mb)){for(Qb=pb.Tb(1);Qb;Qb=pb.Ti(1))if(Qb!==Mb){var bb=Y.OutlineElementReader.Kfa(Qb);Qb.setValue(x.a.SK,Math.min(T.a.nil,bb+(Aa-1)))}pb.currentNode.setValue(x.a.SK,Math.min(T.a.nil,1));return!0}if(1>Aa)return Aa=this.hyf(pb,Qb.yoa,1-Aa),pb.Fi(Aa),Qb.yoa=null,!0;if(1<Aa){pb.currentNode.setValue(x.a.SK,Math.min(T.a.nil,1));Mb=null;for(bb=pb.Tb(1);bb;){if(Y.OutlineElementReader.HK(pb)){bb.setValue(x.a.SK,Math.min(T.a.nil,Aa-1+Y.OutlineElementReader.Kfa(bb)));bb=pb.Ti(1);continue}Mb||(Mb=
this.eum(pb,Aa-1));const nb=bb;bb=H.h(pb,Mb,1);bb===Mb&&(bb=pb.Ti(1));Qb.yoa===nb&&(Qb.yoa=Mb,Mb=null)}return!0}return!1}JGm(pb,Mb){return K.GraphIterator.v7(()=>{if(1===pb.ugb(1)){const Qb=pb.Tb(1);pb.wc();if(Qb===Mb)return!0}return!1})}IGm(pb,Mb){return K.GraphIterator.v7(()=>{let Qb;for(Qb=pb.Tb(1);Qb;Qb=pb.Ti(1))if(Qb!==Mb&&!Y.OutlineElementReader.HK(pb))return pb.wc(),!1;return!0})}PFl(pb,Mb){Mb.D3b=0;do{const Qb=pb.currentNode;if(pb.Tb(1))Mb.D3b-=Y.OutlineElementReader.Kfa(Qb);else{if(W.OutlineReader.Kw(pb)||
null===pb.currentNode)return!1;if(3!==pb.role||!pb.ega(1))for(;!pb.Ti(1);)if(Mb.D3b+=Y.OutlineElementReader.Kfa(pb.currentNode),W.OutlineReader.Kw(pb)||null===pb.currentNode)return!1}}while(Y.OutlineElementReader.HK(pb));return!0}tna(pb,Mb=!1){return this.VUd(pb,!1,Mb)}bum(pb){return this.VUd(pb,!0,!1)}VUd(pb,Mb,Qb=!1){const Aa=new K.GraphIterator;Aa.$c(pb);pb=new K.GraphIterator;pb.$c(Aa);this.uC(pb,Mb,!1,null,Qb);pb.currentNode.setValue(x.a.SK,Math.min(T.a.nil,Y.OutlineElementReader.Kfa(Aa.currentNode)));
Aa.Tb(1)&&H.f(pb,null,1,1,Aa,-1);return pb}Rnh(pb){if(Y.OutlineElementReader.jZn(pb)){1!==Y.OutlineElementReader.Kfa(pb.currentNode)&&pb.currentNode.setValue(x.a.SK,T.a.first);for(var Mb=pb.Tb(1);Mb;)if(Y.OutlineElementReader.HK(pb)){Mb=new K.GraphIterator;Mb.$c(pb);Mb.wc();const Qb=new K.GraphIterator;Qb.$c(pb);Qb.Tb(1);H.f(Mb,pb.currentNode,1,1,Qb,-1);Mb=pb.b_a(1)}else this.Rnh(pb),Mb=pb.Ti(1)}}static get tk(){return null!=Hb.dEg?Hb.dEg:Hb.dEg=l.a.instance.resolve("Box4.ITableEditor")}static get paragraphEditor(){return Hb.As||
(Hb.As=l.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(pb){Hb.As=pb}}Hb.As=null;Object(D.a)(Hb,"OutlineElementEditor",null,[501])},1928:function(D,L,c){D=c(0);var l=c(118),e=c(45),a=c(21),k=c(2),x=c(60),y=c(508),m=c(79),u=c(75),z=c(398),v=c(1146),E=c(16),F=c(381),J=c(59),K=c(141),H=c(48),P=c(34),N=c(12),M=c(1562),I=c(123),T=c(6),U=c(17),W=c(108),V=c(8),Y=c(494),da=c(692),ba=c(583),ja=c(126),sa=c(20),ta=c(263),ra=c(266),ma=c(31),Ba=c(36);class Pa{constructor(Ya){this.yy=null;
this.F2g=!1;this.Ap=null;this.CL=new M.a;this.RBe=new M.a;this.Fc=Ya}get Lkb(){Ba.a(4281429,307,this.CL.count===this.RBe.count);return this.CL.count}get m2d(){return this.F2g}set m2d(Ya){this.F2g=Ya}s0b(Ya){this.yy=Ya}get gT(){return null}Ynh(Ya,Xa){this.CL.add(Ya);this.RBe.add(Xa)}}Pa.kkb=2712;Object(D.a)(Pa,"APicturePasteHandler",null,[621]);var Da=c(269),Ha=c(3),oa=c(11),wa=c(1149),ia;(function(Ya){Ya[Ya.unknown=0]="unknown";Ya[Ya.other=1]="other";Ya[Ya.file=2]="file";Ya[Ya.blob=3]="blob";Ya[Ya.chromeExtension=
4]="chromeExtension";Ya[Ya.cid=5]="cid"})(ia||(ia={}));Object(D.b)("UnsupportedUrlScheme",ia);var ca=c(277),pa=c(47),Ma=c(10),ya=c(1826),Oa=c(1827),fa=c(1754);class Ca{constructor(){this.delay=this.retry=0}}Object(D.a)(Ca,"ForceInboundData",null,[]);class Ta{constructor(Ya,Xa,Sa,ab){this.cTd=!1;this.request=Ya;this.aZn=Xa;this.url=ab;this.rum=Sa}}Object(D.a)(Ta,"PicturePasteRequestInfo",null,[]);var eb=c(436);c.d(L,"a",function(){return ob});const jb=["ImageInsertFailed"];class ob extends Pa{constructor(Ya,
Xa,Sa,ab,Hb,pb=null,Mb=null,Qb=!1,Aa=null,bb=null){super(Ya);this.Nl=l.a.nil;this.RA=new M.a;this.YKa=0;this.Tuc=this.P$g=null;this.$8g=!1;this.Uxc=null;this.Ohd=new M.a;this.Mp=null;this.szn=()=>{var nb=this.KFl(),Va=131073;this.R2j&&(Va=1073872970);nb=e.a.Xn(nb,Y.a.cellId,this.Ap.Zm.toString());nb=e.a.Xn(nb,Y.a.gT,this.Nl.toString());nb=e.a.Xn(nb,Y.a.classId,Va.toString());this.Ap.DI&&(nb=e.a.Xn(nb,Y.a.DI,this.Ap.DI));nb=e.a.Xn(nb,Y.a.Dpb,"1");nb=e.a.Xn(nb,da.a.imageType,"1");nb=Da.a.instance.MXe(nb);
this.Ap.contentReplicator&&this.Ap.contentReplicator.hHb&&(nb=e.a.Xn(nb,Y.a.q1e,"1"));let Ab=0;Va=nb;var Zb=new M.a;const Kb=new M.a,dc=new M.a,jc=new M.a,zb=new M.a,cc=new M.a;var Ub="",Wb=a.a.instance.Ma("Box4.IFeatureHelper");Wb=!!Wb&&Wb.isFeatureEnabled(11)&&Wb.isFeatureEnabled(47);for(let rc=0;rc<this.Lkb;rc++){var Qa=this.RBe.J(rc);V.ULS.shipAssertTag(7869452,307,!!Qa.src);V.ULS.shipAssertTag(7869453,307,""!==Qa.src);V.ULS.shipAssertTag(7869454,307,19922944>Qa.src.length);const db=this.CL.J(rc);
var sb=db.node.ia(I.a.eJ,ca.a.nt);this.DOo(db.blob,Qa);var Jb=Qa.alt;var pc=Qa.jdl;pc||(pc=Jb,Jb="");const lb=db.blob;sb=ya.a.construct(lb?lb.id.toString():db.node.id.toString(),Qa.src,Jb,Qa.width,Qa.height,pc,sb,db.WT,!!lb&&lb.properties.ia(T.a.wga,!1),lb?lb.properties.ia(I.a.ofa,-1):-1,lb?lb.properties.ia(T.a.ckb,Box4Intl.Box4Strings.l_Picture):"",db.node.properties.ia(U.a.yga,!1),null,null,null,Qa.MCd);Qa.src.startsWith("data:")?(pc=!1,Wb&&Qa.MCd?(pc=!0,Qa=zb,Jb=cc):(Qa=dc,Jb=jc),Qa.add(sb),Jb.add(db),
pc=Oa.a.construct(Qa.toArray(),!pc,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Ap.Fs:null,pc),pc=P.c(pc),pc.length>ob.Y5m?(V.ULS.shipAssertTag(7869456,307,1<Qa.count),Qa.remove(sb),Jb.remove(db),pc=this.RA.count?(new x.a(this.Nl,Ab)).toString():this.Ap.contentReplicator.kt.toString(),Va=e.a.Xn(Va,Y.a.ota,pc),Va=e.a.Xn(Va,Y.a.Fec,Ab.toString()),sa.ImageReader.increaseMaxWebFriendlyDimensionTo1600&&(Va=e.a.Xn(Va,Y.a.TPb,"1")),this.RA.add(new Ta(Oa.a.construct(Qa.toArray(),
!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Ap.Fs:null),Ub,Jb,Va)),Ab+=dc.count,Qa=new M.a,Qa.add(sb),Jb=new M.a,Jb.add(db)):Ub=pc):(Zb.add(sb),Kb.add(db))}dc.count&&(Va=nb,pc=this.RA.count?(new x.a(this.Nl,Ab)).toString():this.Ap.contentReplicator.kt.toString(),Va=e.a.Xn(Va,Y.a.ota,pc),Va=e.a.Xn(Va,Y.a.Fec,Ab.toString()),sa.ImageReader.increaseMaxWebFriendlyDimensionTo1600&&(Va=e.a.Xn(Va,Y.a.TPb,"1")),Ub=Oa.a.construct(dc.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?
this.Ap.Fs:null),this.RA.add(new Ta(Ub,P.c(Ub),jc,Va)),Ab+=dc.count,this.Ohd.add(ob.pjf));Zb.count&&(Va=nb,pc=this.RA.count?(new x.a(this.Nl,Ab)).toString():this.Ap.contentReplicator.kt.toString(),Va=e.a.Xn(Va,Y.a.ota,pc),Va=e.a.Xn(Va,Y.a.Fec,Ab.toString()),Va=e.a.Xn(Va,Y.a.TPb,"1"),Zb=Oa.a.construct(Zb.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Ap.Fs:null),this.RA.add(new Ta(Zb,P.c(Zb),Kb,Va)),k.AFrameworkApplication.loa("WoInc325;WoInc325cf"),this.Ohd.add(this.ySg));
zb.count&&(Va=nb,pc=this.RA.count?(new x.a(this.Nl,Ab)).toString():this.Ap.contentReplicator.kt.toString(),Va=e.a.Xn(Va,Y.a.ota,pc),Va=e.a.Xn(Va,Y.a.Fec,Ab.toString()),Va=e.a.Xn(Va,Y.a.TPb,"1"),nb=Oa.a.construct(zb.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Ap.Fs:null,!0),this.RA.add(new Ta(nb,P.c(nb),cc,Va)),this.Ohd.add(this.ySg));V.ULS.sendTraceTag(595068930,307,50,"Prepared "+(this.RA?this.RA.count:-1)+" picture paste requests to send");this.cnb()};
this.picturePasteRequestSucceeded=nb=>{var Va;V.ULS.sendTraceTag(572528019,307,50,"PicturePasteRequestSucceeded received response with Http status: {0}",this.QRl(nb));if(({group:Ab}=ba.a.H0(nb.data.we)).returnValue){var Ab=Ab.Responses[0];if(Ab.StatusCode)if(46!==Ab.StatusCode||this.RA.J(this.YKa).cTd){V.ULS.sendTraceTag(51212675,322,15,"Picture paste request failed with reason "+Ab.StatusCode);nb=Object.assign(new ja.a,{extendedProperties:new Map});nb.extendedProperties.set("statuscode",Ab.StatusCode.toString());
if(null===(Va=k.AFrameworkApplication.K)||void 0===Va?0:Va.$("ShouldLogPicturesExtendedHealthKpis")){var Zb={name:eb.c.K8b,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:nb};nb.extendedProperties.set("ErrorLevel","warning");this.Mh.logKpiFailure({kpiName:eb.c.tEa,errorName:"PictureRemotePasteFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:nb},optionalVeto:Zb})}else u.Health.instance.recordQosError("PictureRemotePasteFailed",
jb,!1,!0,!1,!1,nb);this.Rem()}else this.RA.J(this.YKa).cTd=!0,this.cnb();else{Ab=Va="";nb&&nb.data&&nb.data.vj&&(da.a.CH in nb.data.vj&&nb.data.vj[da.a.CH]&&(Ab=nb.data.vj[da.a.CH]),"X-CorrelationId"in nb.data.vj&&nb.data.vj["X-CorrelationId"]&&(Va=nb.data.vj["X-CorrelationId"]));V.ULS.sendTraceTag(595068929,307,50,"PicturePasteRequestSucceeded called.[Status code: {0}][X-CorrelationID: {1}]",Ab,Va);(null===(Zb=k.AFrameworkApplication.K)||void 0===Zb?0:Zb.$("ShouldLogPicturesExtendedHealthKpis"))&&
this.Mh.logKpiSuccess({kpiName:eb.c.tEa});this.Uxc&&(this.Uxc.stop(),this.Uxc=null);this.YKa++;this.zxj&&this.cnb();this.P$g=this.Ap.contentReplicator.kt;let Kb=null;Kb=Object.assign(new Ca,{retry:0,delay:this.Ohd.J(this.YKa-1)});nb=new m.a(2,1,ob.pjf,()=>{this.Ap.contentReplicator.a9d(this.AYh,null,Kb)},124);this.Gb.Wb(nb)}}else V.ULS.sendTraceTag(7869457,307,10,"PicturePasteRequestSucceeded received null or empty server response group"),nb=new y.a(nb.data),this.Mec(nb)};this.AYh=nb=>{const Va=!x.a.Sp(this.P$g,
this.Ap.contentReplicator.kt);V.ULS.sendTraceTag(8246492,307,50,"Revision changed after ForceInbound: {0}",Va);if(Va)this.Pwh();else{const Ab=nb?nb:null;if(nb&&Ab&&Ab.retry<ob.Hzl){Ab.retry+=1;nb=new m.a(2,1,Ab.delay,()=>{this.Ap.contentReplicator.a9d(this.AYh,null,Ab)},125);this.Gb.Wb(nb);return}nb=ob.pjf;null!=Ab&&(nb=Ab.delay);nb=new m.a(2,1,nb,()=>{this.Ap.contentReplicator.a9d(null,null,null)},125);this.Gb.Wb(nb);this.Qwh()}ob.bPf--;k.AFrameworkApplication.xa.processAction(N.a.j7a,2);fa.a.instance.wlc(this.Ap,
0);this.vrg();this.lu.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)};this.Mec=nb=>{var Va,Ab="",Zb="";nb&&nb.data&&nb.data.vj&&("X-CorrelationId"in nb.data.vj&&nb.data.vj["X-CorrelationId"]&&(Ab=nb.data.vj["X-CorrelationId"]),da.a.CH in nb.data.vj&&nb.data.vj[da.a.CH]&&(Zb=nb.data.vj[da.a.CH]));Zb=""===Zb?"":String.format("[Operation Result: {0}]",Zb);Ab=""===Ab?"":String.format("[X-CorrelationID: {0}]",Ab);V.ULS.sendTraceTag(51212676,322,15,"Picture paste request failed.[HttpStatus: {2}] [Connection state: {3}]{0}{1}",
Zb,Ab,nb.data.Ve,z.SessionStatusManager.instance.vH);9===nb.data.status||this.RA.J(this.YKa).cTd?(fa.a.instance.wlc(this.Ap,127),this.zyh(),this.Uxc=null,(null===(Va=k.AFrameworkApplication.K)||void 0===Va?0:Va.$("ShouldLogPicturesExtendedHealthKpis"))?(nb=Object.assign(new ja.a,{extendedProperties:new Map([["HttpStatus",String(nb.data.Ve)],["ConnectionState",String(z.SessionStatusManager.instance.vH)],["OperationResult",Zb],["CorrelationId",Ab],["ErrorLevel","warning"]])}),this.Mh.logKpiFailure({kpiName:eb.c.tEa,
errorName:"PictureRemotePasteFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:nb},optionalVeto:{name:eb.c.K8b,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):u.Health.instance.recordQosError("PictureRemotePasteFailed",jb,!1,!0,!1,!1,null)):(this.RA.J(this.YKa).cTd=!0,this.cnb())};this.Mh=v.a.getInstance(eb.a);this.Nj=Xa;this.Gb=Sa;this.Dm=ab;this.ge=oa.App.ya.xq;this.SBe=pb;this.i6=Mb;this.p4j=Qb;this._operationId=
Aa;this.abk=bb;this.ySg=k.AFrameworkApplication.K.pc("PicturePasteHttpForceInboundDelay",3E3);this.$8g=this.K?this.K.$("ProvideUnsupportedUrlSchemeIsEnabled"):!1;oa.App.ikc.addHandler(this);this.R2j=!!Hb&&Hb.isFeatureEnabled(120)}get lu(){return this.Mp||(this.Mp=a.a.instance.resolve("Common.Utils.IAriaNotifier"))}get K(){return k.AFrameworkApplication.K}get Lec(){return oa.App.Lec}get WGi(){return this.Lkb===oa.App.QJf}get zxj(){return this.YKa!==this.RA.count}vrg(){k.AFrameworkApplication.K&&k.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&
window.setTimeout(()=>{const Ya=a.a.instance.Sa("Common.ISystemInitiatedFeedback");Ya&&Ya.execute(Xa=>{Xa.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}get gT(){return this.Nl}Swa(Ya){var Xa;Ya.alt.length>Pa.kkb&&(Ya.alt=Ya.alt.substring(0,E.a.Yy(Ya.alt,Pa.kkb)?Pa.kkb-1:Pa.kkb));this.Mh.logKpiUsage({kpiName:eb.c.tEa,kpiType:0});if(this.i6&&ob.UDm(Ya)){this.p4j&&H.c(Ha.a.bsl);var Sa="unknown";this.$8g&&(Ya=new URL(Ya.src),Sa=ia[wa.a.dLo(Ya.protocol)]);V.ULS.sendTraceTag(41969745,
322,15,"Unable to paste image with local URL. OperationId: {0}, URL scheme: {1}, rtfDataStatus: {2}",this._operationId,Sa,this.abk);Ya=Object.assign(new ja.a,{extendedProperties:new Map});Ya.extendedProperties.set("protocol",Sa);(null===(Xa=k.AFrameworkApplication.K)||void 0===Xa?0:Xa.$("ShouldLogPicturesExtendedHealthKpis"))?(Xa={name:eb.c.K8b,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:Ya},Ya.extendedProperties.set("ErrorLevel",
"warning"),this.Mh.logKpiFailure({kpiName:eb.c.tEa,errorName:"PictureRemoteWithLocalPath",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:Ya},optionalVeto:Xa})):u.Health.instance.recordQosError("PictureRemoteWithLocalPath",jb,!0,!0,!1,!1,Ya);this.mqo()}else Xa=new F.DictionaryPropertySet,Ya=this.Iaj(Ya),null!==Ya.MCd&&"chart"===Ya.MCd.type&&Xa.setValue(T.a.Rs,7),this.Nj.g9d(Xa,Ya.width,Ya.height,!0),V.ULS.shipAssertTag(7869444,307,Ma.ParagraphReader.Yb(this.Fc.currentNode)),this.Uxc=
this.ge.eg("WebServiceCall",ob.dwn),V.ULS.sendTraceTag(20505094,322,50,String.format("ImagePasteRequest img width: {0}, height {1}",Ya.width,Ya.height)),Sa=ma.a.Bw(this.Fc.currentNode),Xa=this.Nj.YUd(Sa,Xa),this.Ynh(Xa,Ya)}sSf(){0<this.Lkb&&(this.Nl=l.a.create(),this.Ap=this.CL.J(0).node.Ei(),V.ULS.sendTraceTag(38122840,307,50,"Pasted pictures: {0}",this.Lkb),this.m2d&&(V.ULS.sendTraceTag(38122841,307,15,"MaxPicturesExceeded in paste."),this.upo()),fa.a.instance.Zjg(this.Ap),this.vrg(),this.Ap.contentReplicator.forceOutbound(this.szn,
null,null))}Kee(Ya){if(0<this.Lkb){const Sa=Ya.ia(T.a.wga,!1),ab=Ya.ia(W.a.VUc,!1),Hb=Ya.ia(W.a.v3,!1);Ya=Ya.ia(I.a.ofa,-1);for(let pb=0;pb<this.CL.count;pb++){var Xa=this.CL.J(pb).blob;Xa&&(Xa=Xa.properties,Xa.setValue(T.a.wga,Sa),Xa.setValue(W.a.VUc,ab),Xa.setValue(W.a.v3,Hb),Xa.setValue(I.a.ofa,Ya),this.Nj.f6f(Xa,Ya))}}}$3a(){}Iaj(Ya){var Xa=ta.WordSectionNavigator.instance.gJ(this.Fc.Kn);if(!Xa)return Ya;var Sa=J.a.Ki(ob.Vf.$z(Xa)-ob.Vf.kva(Xa)-ob.Vf.Qma(Xa),1);Xa=J.a.Ki(ob.Vf.Ot(Xa)-ob.Vf.OI(Xa)-
ob.Vf.zK(Xa),0);V.ULS.shipAssertTag(7869449,307,0<=Sa);V.ULS.shipAssertTag(7869450,307,0<=Xa);if(Ya.height>Sa){const ab=Sa/Ya.height;Ya.height=Sa;Ya.width=Math.floor(Ya.width*ab)}Ya.width>Xa&&(Sa=Xa/Ya.width,Ya.width=Xa,Ya.height=Math.floor(Ya.height*Sa));return Ya}mqo(){const Ya=Box4Intl.Box4Strings.l_PastedImageFailedWithInvalidUrl;if(!this.Tuc||this.Tuc.message!==Ya&&!this.Tuc.Ega)this.Tuc=this.i6.Jla(Ya,!1),this.i6.Kz(this.Tuc)}KFl(){if(this.SBe&&this.SBe.jap())return this.SBe.P9o();var Ya=new Sys.Net.WebRequest;
Ya.set_url("PicturePaste.ashx");Ya=Ya.getResolvedUrl();k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")||(Ya=e.a.Xn(Ya,Y.a.fileId,this.Ap.Fs));return Ya}DOo(Ya,Xa){if(Ya&&Xa){const Sa=J.a.ef(sa.ImageReader.sD(Ya.properties),0);Ya=J.a.ef(sa.ImageReader.LI(Ya.properties),1);0<Sa&&Sa<Xa.width&&(Xa.width=Sa,Xa.height=Ya)}}cnb(){const Ya={},Xa=l.a.create().toString();Ya[ob.correlationID]=Xa;k.AFrameworkApplication.Ke.oj(this.RA.J(this.YKa).url,2,this.RA.J(this.YKa).aZn,Ya,!1,
2,this.picturePasteRequestSucceeded,this.Mec,null,void 0,void 0,void 0,void 0,"26");ob.bPf++;V.ULS.sendTraceTag(572528018,307,50,"SendPicturePasteRequest PicturePaste request added to the queue with correlation id : {0}",Xa)}QRl(Ya){return Ya&&Ya.data?Ya.data.Ve:-1}Rem(){fa.a.instance.wlc(this.Ap,127);this.zyh()}zyh(){V.ULS.shipAssertTag(7869458,307,this.zxj);const Ya=new pa.GraphTransaction(15);Ya.Eb(this.CL.J(0).node);for(let Xa=this.YKa;Xa<this.RA.count;Xa++){const Sa=this.RA.J(Xa).rum;for(let ab=
0;ab<Sa.count;ab++){const Hb=Sa.J(ab).blob.properties;this.Nj.uSa(Hb,Box4Intl.Box4Strings.l_PastedImageFailed);sa.ImageReader.nfj(Hb)}}Ya.dispose();this.Dm.I1b(this.Ap,!1);this.Owh()}upo(){const Ya=new K.StandardDialog;Ya.zd=0;Ya.Sw(0,Box4Intl.Box4Strings.l_MaxPicturesExceededTitle,String.format(Box4Intl.Box4Strings.l_MaxPicturesExceededMessage,oa.App.QJf),null,!0);k.AFrameworkApplication.xa.processAction(Ha.a.rVi,2)}$in(Ya,Xa){Ya.alt.length>Pa.kkb&&(Ya.alt=Ya.alt.substring(0,E.a.Yy(Ya.alt,Pa.kkb)?
Pa.kkb-1:Pa.kkb));const Sa=new F.DictionaryPropertySet;this.Nj.g9d(Sa,Ya.width,Ya.height);Xa=this.Nj.YUd(Xa,Sa);Ya=this.Iaj(Ya);this.Ynh(Xa,Ya)}Owh(){}Pwh(){}Qwh(){}tTd(){return!!ob.bPf}static get Vf(){return ra.a.instance}static UDm(Ya){return!!Ya&&!!Ya.src&&!wa.a.Ixi(Ya.src)}}ob.pjf=1E3;ob.Hzl=4;ob.dwn="PicturePasteRequestTime";ob.correlationID="X-CorrelationId";ob.bPf=0;ob.Y5m=20971520;Object(D.a)(ob,"Box4ImageSteward",Pa,[622])},1930:function(D,L,c){D=c(0);var l=c(46),e=c(97),a=c(7),k=c(23);class x extends Sys.UI.Control{constructor(J,
K,H,P){super(document.createElement("div"));this.JY=this.gja=this.mL=this.Gv=this.J1=this.x8a=this.Oab=null;this.Ksc=this.o$a=!1;this.content=this._title=null;this.Uia=0;this.Gsh=null;this.Fea=0;this.fRi=null;this.Deh=J;this.FWb=K;this.nk=H;this.nBh=P;this.gj=K.ownerDocument;this.sTd=this.ht=this.hS=!1}get F8(){this.Oab||(this.Oab=this.gj.createElement("div"),this.Oab.id=this.kj("WACCalloutOuter"),this.Oab.className="WACCalloutOuter",this.Oab.setAttribute(k.a.oh,k.a.krh),this.Oab.style.width=this.Uia+
"px");return this.Oab}get KDc(){if(!this.x8a){this.x8a=this.gj.createElement("div");this.x8a.id=this.kj("WACCalloutBeakContainer");this.x8a.className="WACCalloutBeakContainer";var J="CalloutBeakTopFilled_32x16x32";if(5===this.Fea||6===this.Fea||4===this.Fea)J="CalloutBeakBottomFilled_32x16x32";J=e.createClusteredImage(32,16,J,"WACCalloutBeak",!0,"");this.x8a.appendChild(J)}return this.x8a}set KDc(J){this.x8a=J}get Iw(){return this.hS}get title(){return this._title}set title(J){this._title!==J&&(this._title=
J,this.gja&&(this.gja.innerText=this._title))}get ht(){return this.o$a}set ht(J){this.o$a!==J&&(this.o$a=J,this.J1&&(this.J1.contains(this.mL)&&!this.o$a?this.J1.removeChild(this.mL):!this.J1.contains(this.mL)&&this.o$a&&this.Xjh()))}get sTd(){return this.Ksc}set sTd(J){this.Ksc!==J&&(this.Ksc=J,this.J1&&(this.J1.contains(this.gja)&&!this.Ksc?this.J1.removeChild(this.gja):!this.J1.contains(this.gja)&&this.Ksc&&this.Glh()))}show(){this.hS||(this.Z2k(),this.rI(),this.FWb.appendChild(this.F8),this.F8.style.display=
"Block",this.bgo(),this.hS=!0,this.fRi&&this.fRi())}dismiss(){this.hS&&(this.hel(),this.FWb.removeChild(this.F8),this.hS=!1,this.nBh&&this.nBh())}dispose(){this.dismiss();this.gja=this.mL=this.Gv=this.x8a=this.J1=this.Oab=null;Sys.Component.prototype.dispose.call(this)}kj(J){return this.get_element().id+J}Z2k(){this.J1=this.gj.createElement("div");this.J1.id=this.kj("WACCalloutHeader");this.J1.className="WACCalloutHeader";this.ht&&this.Xjh();this.sTd&&this.Glh();this.Gv=this.gj.createElement("div");
this.Gv.id=this.kj("WACCalloutContent");this.Gv.className="WACCalloutContent";this.Gv.style.width=190<this.Uia?this.Uia-26+"px":"164px";this.Gv.appendChild(this.content);this.F8.appendChild(this.KDc);this.F8.appendChild(this.J1);this.F8.appendChild(this.Gv)}Xjh(){this.mL=this.gj.createElement("a");this.mL.className="WACCalloutCloseAnchor";this.mL.id=this.kj("WACCalloutCloseAnchor");this.mL.href="#";this.J1.appendChild(this.mL);const J=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",
!0,CommonUIStrings.l_DialogClose);this.mL.appendChild(J)}Glh(){this.gja=this.gj.createElement("div");this.gja.className="WACCalloutTitle UIFontBold";this.gja.style.width=190<this.Uia?this.Uia-30+"px":"160px";this.gja.id=this.kj("WACCalloutTitle");this.gja.innerText=this.title;this.J1.contains(this.mL)?this.J1.insertBefore(this.gja,this.mL):this.J1.appendChild(this.gja)}bgo(){var J=this.Deh;let K;if(1===this.Fea){var H=this.Gsh.y+16;K=-16}else 2===this.Fea||3===this.Fea||0===this.Fea?(H=J.y+J.height+
15,K=-15):(H=J.y-this.F8.clientHeight-15-2,K=this.F8.clientHeight-1);this.F8.style.top=H+"px";this.KDc.style.top=K+"px";1===this.Fea?(J=this.Gsh.x-16,this.F8.style.left="50%",this.F8.style.marginLeft=-this.Uia/2+"px",H=Sys.UI.DomElement.getBounds(this.F8),this.KDc.style.left=J-H.x+"px"):(H=J.x+this.Deh.width/2,2===this.Fea||5===this.Fea?(J=20,H-=36):0===this.Fea||4===this.Fea?(J=this.Uia/2-16,H-=this.Uia/2):(J=this.Uia-20-32,H=H-this.Uia+36),this.F8.style.left=H+"px",this.KDc.style.left=J+"px")}rI(){this.ht&&
!this.JY&&(this.JY=Object(l.a)(this,this.xla,"closeHandler"),this.nk.mb(a.a.click,this.mL,this.JY,null))}hel(){this.ht&&this.JY&&(this.nk.sc(a.a.click,this.mL,this.JY),this.JY=null)}xla(){this.dismiss();return!0}}Object(D.a)(x,"Callout",Sys.UI.Control,[1050]);class y extends x{constructor(J,K,H,P,N,M=null){super(J,H,N.B0,M);this.o3g=0;this.Uia=this.tWl(P);this.ZYb=K;this.Ri=N;this.yCo=7;this.Dq=this.ZYb.ownerDocument.createElement("div");this.Dq.className="ModalCalloutControlOverlay";this.Dq.tabIndex=
0;this.ZYb.insertBefore(this.Dq,this.ZYb.firstChild)}show(){this.Iw||(this.Ri.f9d(),this.Ri.Gea(!1),this.Dq.style.zIndex=String(this.Ri.vBa),super.show(),this.gz(),this.o3g=window.setTimeout(Object(l.a)(this,this.dismiss,"dismiss"),1E3*this.yCo))}dismiss(){this.Iw&&(this.Ri.zaa(!1),this.A9(),this.ZYb&&this.ZYb.contains(this.Dq)&&this.ZYb.removeChild(this.Dq),super.dismiss(),window.clearTimeout(this.o3g))}gz(){this.Ri.uZ(Object(l.a)(this,this.dismiss,"dismiss"));this.Ri.MC.mb(a.a.click,this.Dq,Object(l.a)(this,
this.onClick,"onClick"))}A9(){this.Ri.jca(Object(l.a)(this,this.dismiss,"dismiss"));this.Ri.MC.sc(a.a.click,this.Dq,Object(l.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}tWl(J){let K=0;switch(J){case 0:K=190;break;case 1:K=250;break;case 2:K=300;break;case 3:K=360}return K}}Object(D.a)(y,"ModalCallout",x,[]);var m=c(8),u=c(477),z=c(158);class v extends y{constructor(J,K,H,P,N,M=null){super(J,K,H,P,N,M);this.pS=null}show(){if(!this.Iw){const J=Object.assign(new u.a,{onShow:()=>
{y.prototype.show.call(this)}});z.UISurfaces.fM().then(K=>{const H=K.externalNotification();this.pS=K.addNotification(H,J);return null},K=>{m.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",K);return null})}}dismiss(){this.Iw&&this.pS&&(z.UISurfaces.fM().then(J=>{J.removeNotification(this.pS);return this.pS=null},J=>{m.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",J);return null}),super.dismiss())}}Object(D.a)(v,"ReactManagedModalCallout",
y,[]);var E=c(2);c.d(L,"a",function(){return F});class F{static hIh(J,K,H,P){return E.AFrameworkApplication.ta.Ob.LPa?new v(J,K,H,P,E.AFrameworkApplication.ta,null):new y(J,K,H,P,E.AFrameworkApplication.ta,null)}}Object(D.a)(F,"ModalCalloutControlFactory",null,[])},1934:function(D,L,c){D=c(0);var l=c(59),e=c(138),a=c(16),k=c(2),x=c(72);class y{constructor(F,J){this.value=F;this.YAl=J}get $Wd(){return this.YAl}}Object(D.a)(y,"ElementValueWrapper",null,[]);class m extends y{constructor(F,J,K){super(F,
J);this.zwi=K}}Object(D.a)(m,"DimensionWrapper",y,[]);var u=c(1671),z=c(1672),v=c(8);c.d(L,"a",function(){return E});class E{static get qki(){return E.j_j}static get Xie(){return E.Cek}static get Vie(){return E.Bek}static ftf(F,J,...K){J=E.dfi(J);let H=!1;J||(J=E.tam(F,...K),H=!!J);return new y(J,H)}static dfi(F){for(const J of F)if(void 0!==J&&null!==J&&""!==J)return J.trim();return null}static tam(F,...J){for(const K of J)if(J=F.getAttribute(K),void 0!==J&&null!==J&&(J+="",void 0!==J&&null!==J&&
""!==J))return J.trim();return null}static D0l(F,J){J=parseFloat(J);if(isNaN(J))return 0;switch(F){case "px":return Math.round(J);case "pt":return Math.round(l.a.a0(J,0,!1));case "in":return Math.round(l.a.T7(J,0,!1));case "cm":return Math.round(l.a.T7(e.a.tyh(J),0,!1));case "mm":return Math.round(l.a.T7(e.a.tyh(.1*J),0,!1));default:return J}}static yce(F,J,...K){F=E.ftf(F,J,...K);K=0;J=!1;if(F.value){J=F.value.endsWith("%");let H;J?(K="%",H=a.a.substring(F.value,0,F.value.length-1)):F.$Wd?(K="px",
H=F.value):(K=F.value.substr(F.value.length-2),isNaN(parseFloat(K))?H=a.a.substring(F.value,0,F.value.length-2):(K="px",H=F.value));K=E.D0l(K,H)}return new m(K,F.$Wd,J)}static rfi(F){return E.yce(F,[F.style.width],"width","WIDTH","Width")}static V5h(F){return E.yce(F,[F.style.height],"height","HEIGHT","Height")}static OI(F){return E.yce(F,[F.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static zK(F){return E.yce(F,[F.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static xam(F){F=
E.ftf(F,[F.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return F.value&&F.value in E.Xie&&void 0!==E.Xie[F.value]&&null!==E.Xie[F.value]?E.Xie[F.value]:0}static aLm(F){F=E.dfi([F.style.borderCollapse]);return!!F&&!(void 0===F||null===F)&&("collapse"===F||"COLLAPSE"===F||"Collapse"===F)}static EFl(F){return E.ftf(F,[F.style.backgroundColor,F.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static G_k(F){const J=a.a.substring(F,0,1),K=a.a.substring(F,1,2);F=a.a.substring(F,
2,3);return J+J+K+K+F+F}static Pta(F){let J="";if(!F||""===F)return J;J=F.trim();if(J.startsWith("rgb")){J=a.a.substring(J,J.indexOf("(")+1,J.length-1);F=J.split(",");if(3!==F.length)return"";J="";for(let H=0;H<F.length;H++){var K=parseInt(F[H]);if(isNaN(K)||0>K||255<K)return"";K=K.toString(16);1===K.length&&(K="0"+K);J+=K}return a.a.BA(J)}if(E.qki[a.a.fh(J)])return E.qki[a.a.fh(J)];J.startsWith("#")&&(J=a.a.substring(J,1,J.length));if(isNaN(parseInt(J,16)))return"";3===J.length&&(J=E.G_k(J));return 6!==
J.length?"":J}static Ztn(F){var J=F.indexOf("mso-tab-count");if(-1===J)return 0;const K=RegExp("([\\d])");let H="";for(J=J+13+1;J<F.length;J++){const P=F.charAt(J).toString();if(K.test(P))H+=P;else break}F=0;""!==H&&(F=parseInt(H));return F}static NSd(F,J){const K=E.EFl(F);K&&""!==K&&J.Tu(H=>H.f9(E.Pta(K)))}static m1h(F){var J,K=F.style;if(!K)return null;let H=E.Vie[K.borderTopStyle];const P=E.Pta(K.borderTopColor);let N=K.borderTopWidth,M=E.Vie[K.borderRightStyle];const I=E.Pta(K.borderRightColor);
let T=K.borderRightWidth,U=E.Vie[K.borderBottomStyle];const W=E.Pta(K.borderBottomColor);let V=K.borderBottomWidth,Y=E.Vie[K.borderLeftStyle];const da=E.Pta(K.borderLeftColor);K=K.borderLeftWidth;k.AFrameworkApplication.ye("gdea6103;0df65435");if(null===(J=k.AFrameworkApplication.K)||void 0===J?0:J.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))F=F.getAttribute("border"),null!==F&&(H=this.yhc(F,H),U=this.yhc(F,U),Y=this.yhc(F,Y),M=this.yhc(F,M),N=this.zhc(F,N),
T=this.zhc(F,T),V=this.zhc(F,V),K=this.zhc(F,K),v.ULS.sendTraceTag(509125330,3022,50,"getCellBorders: Table Border Attribute found and fixed"));return new u.a(H,M,U,Y,P,I,W,da,N,T,V,K)}static zhc(F,J){return""===J?F+"px":J}static yhc(F,J){return 0===J?"0"===F?1:11:J}static xHl(F){var J=F.querySelectorAll("[class^=TableCellContent]");J=1===J.length?J[0]:void 0;return(F=(null===J||void 0===J?0:J.style)?J.style:F.style)?new z.a(F.paddingTop,F.paddingRight,F.paddingBottom,F.paddingLeft):null}}E.j_j=x.a.N4("aliceblue",
"F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood","DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9",
"darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B","darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia",
"FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo","4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3",
"lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00","limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise",
"48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500","orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080",
"red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD","slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5",
"yellow","FFFF00","yellowgreen","9ACD32");E.Cek=x.a.N4("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);E.Bek=x.a.N4("",0,"initial",3,"inherit",11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(D.a)(E,"DefaultHtmlTranslatorHelper",null,[])},1937:function(D,L,c){D=c(0);class l{constructor(a){this.next=null;this.data=a}}Object(D.a)(l,
"QueueNode",null,[]);c.d(L,"a",function(){return e});class e{constructor(){this.usb=this.wqb=null;this.fj=0}get count(){return this.fj}get isEmpty(){return!this.count||!this.wqb||!this.usb}enqueue(a){a=new l(a);this.isEmpty?this.usb=this.wqb=a:this.wqb=this.wqb.next=a;this.fj=this.count+1}back(){return this.isEmpty?null:this.wqb.data}dequeue(){if(this.isEmpty)return null;const a=this.usb;this.usb=a.next;this.fj=this.count-1;this.usb||(this.wqb=null);return a.data}clear(){this.usb=this.wqb=null;this.fj=
0}toArray(){const a=Array(this.count);let k=this.usb;for(let x=0;x<this.count&&k;x++)a[x]=k.data,k=k.next;return a}}Object(D.a)(e,"Queue",null,[])},1992:function(D,L,c){c.d(L,"b",function(){return l});c.d(L,"e",function(){return e});c.d(L,"d",function(){return a});c.d(L,"c",function(){return k});c.d(L,"h",function(){return x});c.d(L,"a",function(){return y});c.d(L,"f",function(){return m});c.d(L,"g",function(){return u});var l;(function(z){z[z.Unspecified=0]="Unspecified";z[z.Inline=1]="Inline";z[z.Floating=
2]="Floating"})(l||(l={}));var e;(function(z){z[z.Undefined=0]="Undefined";z[z.Bullet=1]="Bullet";z[z.Numbered=2]="Numbered";z[z.Lim=3]="Lim";z[z.Nil=4]="Nil";z[z.Any=5]="Any";z[z.NoList=6]="NoList";z[z.Invalid=7]="Invalid"})(e||(e={}));var a;(function(z){z[z.DontCare=1]="DontCare";z[z.Thin=2]="Thin";z[z.ExtraLight=3]="ExtraLight";z[z.Light=4]="Light";z[z.Normal=5]="Normal";z[z.Medium=6]="Medium";z[z.SemiBold=7]="SemiBold";z[z.Bold=8]="Bold";z[z.ExtraBold=9]="ExtraBold";z[z.Heavy=10]="Heavy"})(a||
(a={}));var k;(function(z){z[z.NoCaps=0]="NoCaps";z[z.SmallCaps=1]="SmallCaps";z[z.AllCaps=2]="AllCaps";z[z.AllPetiteCaps=3]="AllPetiteCaps";z[z.PetiteCaps=4]="PetiteCaps";z[z.Unicase=5]="Unicase";z[z.Titling=6]="Titling";z[z.Other=7]="Other"})(k||(k={}));var x;(function(z){z[z.None=0]="None";z[z.Words=1]="Words";z[z.SingleLine=2]="SingleLine";z[z.DoubleLine=3]="DoubleLine";z[z.HeavyLine=4]="HeavyLine";z[z.DottedLine=5]="DottedLine";z[z.DottedHeavyLine=6]="DottedHeavyLine";z[z.DashLine=7]="DashLine";
z[z.DashHeavyLine=8]="DashHeavyLine";z[z.DashLongLine=9]="DashLongLine";z[z.DashLongHeavyLine=10]="DashLongHeavyLine";z[z.DotDashLine=11]="DotDashLine";z[z.DotDashHeavyLine=12]="DotDashHeavyLine";z[z.DotDotDashLine=13]="DotDotDashLine";z[z.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";z[z.WavyLine=15]="WavyLine";z[z.WavyHeavyLine=16]="WavyHeavyLine";z[z.WavyDoubleLine=17]="WavyDoubleLine"})(x||(x={}));var y;(function(z){z[z.Left=0]="Left";z[z.Right=1]="Right";z[z.Center=2]="Center";z[z.Justified=
3]="Justified";z[z.Other=4]="Other";z[z.None=5]="None";z[z.JustifyLow=6]="JustifyLow";z[z.Distributed=7]="Distributed";z[z.ThaiDistributed=8]="ThaiDistributed"})(y||(y={}));var m;(function(z){z[z.Image=0]="Image";z[z.TextBox=1]="TextBox";z[z.Chart=2]="Chart";z[z.SmartArt=3]="SmartArt";z[z.Drawing=4]="Drawing";z[z.EquationObject=5]="EquationObject";z[z.Ink=6]="Ink";z[z.InkSpace=7]="InkSpace";z[z.InkEndOfLine=8]="InkEndOfLine";z[z.LineBreak=9]="LineBreak";z[z.PageBreak=10]="PageBreak";z[z.PageNumbers=
11]="PageNumbers";z[z.FootnoteEndnote=12]="FootnoteEndnote";z[z.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";z[z.Tab=14]="Tab";z[z.UnsupportedObject=15]="UnsupportedObject";z[z.Other=16]="Other"})(m||(m={}));var u;(function(z){z[z.Initial=0]="Initial";z[z.FirstLine=1]="FirstLine";z[z.Hanging=2]="Hanging"})(u||(u={}))},1994:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.normal=0]="normal";e[e.beingCreated=1]="beingCreated";e[e.beingEdited=2]="beingEdited"})(l||
(l={}));Object(D.b)("CommentType",l)},1996:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{static Iof(e){return e===l.create?0:e===l.reply?1:e===l.edit?2:e===l.metadata?3:null}}l.create="CREATE";l.reply="REPLY";l.edit="EDIT";l.metadata="METADATA";Object(D.a)(l,"CommentSessionType",null,[])},1997:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.unsaved=0]="unsaved";e[e.sentToServer=1]="sentToServer";e[e.succeeded=2]="succeeded";e[e.failed=3]="failed";e[e.saveNotNeeded=
4]="saveNotNeeded"})(l||(l={}));Object(D.b)("CommentSaveStatus",l)},1998:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a){this.className=e;this.cPc=a}}Object(D.a)(l,"HighlightCssClassPair",null,[])},1999:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.type=this.action=0;this.lJ=this.eA=null}}Object(D.a)(l,"HighlightOperation",null,[])},2E3:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);L=c(247);var l=c(125);class e extends L.a{constructor(){super();
this.LastKnownPaginationRevision=this.FileId=null}Cl(){return 36}static maa(a,k){const x=new e;x.FileId=a;x.LastKnownPaginationRevision=l.a(k);return x}}Object(D.a)(e,"PaginationRequest",L.a,[])},2002:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{TDb(e,a){let k="g";a.matchCase||a.e2d||(k+="i");if(a.matchPrefix||a.matchWholeWord)e="\\b"+e;if(a.matchSuffix||a.matchWholeWord)e+="\\b";return new RegExp(e,k)}static get instance(){return l._instance||(l._instance=new l)}}l._instance=null;
Object(D.a)(l,"FindUtils",null,[1247])},2004:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a){this._text=e;this.Rrc=a}get text(){return this._text}get matchCase(){return this.JGb(1)}get matchWholeWord(){return this.JGb(2)}get e2d(){return this.JGb(4)}get matchPrefix(){return this.JGb(8)}get matchSuffix(){return this.JGb(16)}get ignorePunct(){return this.JGb(32)}get ignoreSpace(){return this.JGb(64)}JGb(e){return(this.Rrc&e)===e}static createQuery(e,a){return new l(e,
a)}}Object(D.a)(l,"Query",null,[1245])},2005:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.none=0]="none";e[e.matchCase=1]="matchCase";e[e.wholeWordOnly=2]="wholeWordOnly";e[e.wildCards=4]="wildCards";e[e.prefix=8]="prefix";e[e.suffix=16]="suffix";e[e.ignorePunct=32]="ignorePunct";e[e.ignoreSpace=64]="ignoreSpace"})(l||(l={}));Object(D.b)("QueryFilters",l)},2006:function(D,L,c){c.d(L,"a",function(){return y});D=c(0);var l=c(152),e=c(155),a=c(2),k=c(57),x=c(157);class y extends l.a{constructor(m,
u=!1){super(m,!1,u)}get qTc(){return!1}get uK(){return x.a.nIc+"/modeless"}get Mjb(){return null}set Mjb(m){}get Ijb(){return null}set Ijb(m){}Yh(m,u=null,z=null){this.ES&&(z.isModal=!1);super.Yh(m,u,z)}hide(){if(a.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Kc)this.Hzj(),a.AFrameworkApplication.ta.Tw.nx(e.AFrame.OKf),super.hide()}tlk(){const m=a.AFrameworkApplication.ta.Tw,u=a.AFrameworkApplication.ta.yp;m.nea(this.uK);
m.GS(this.uK);u.fe(this.uK).parent=e.AFrame.qp}zBa(){k.FocusManager.DJ()&&(super.zBa(),this.tlk(),a.AFrameworkApplication.ta.Tw.nI(e.AFrame.OKf))}b2f(){if(k.FocusManager.DJ()&&!a.AFrameworkApplication.Rk){const m=k.FocusManager.instance();m.cR(this.uK);const u=m.getRegion(this.uK);u&&u.Xj.wy(null);m.X4a(this.uK)}}fca(){"DL"===this.qBa||"DP"===this.qBa?super.fca():a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WacAutoFitNonModalDialogIsEnabled")?(this.Hzj(),this.tsh()&&this.anj(this.Kc.clientHeight,
this.Kc.clientWidth)):this.$K()}$K(){this.anj(l.a.XNg,l.a.dOg)}anj(m,u){if(this.Ijb&&this.Mjb){let z,v;z=x.a.X8d+this.Mjb;v=x.a.W8d+this.Ijb;z+m>this.$z()&&(z=this.$z()-m);v+u>this.Ot()&&(v=this.Ot()-u);this.bnj(z,v)}else super.$K()}Xpf(m){if(!m)return null;m.endsWith("px")&&(m=m.substring(0,m.length-2));return x.a.S$b(m)?((m=parseInt(m))||(m=1),m):null}Hzj(){if(this.Kc&&this.Kc.style){var m=this.Xpf(this.Kc.style.top);m&&(this.Mjb=m-x.a.X8d);if(m=a.AFrameworkApplication.isRtl?this.Xpf(this.Kc.style.right):
this.Xpf(this.Kc.style.left))this.Ijb=m-x.a.W8d}}}Object(D.a)(y,"ModelessCustomDialog",l.a,[])},2007:function(D,L,c){c.d(L,"a",function(){return z});D=c(0);var l=c(8),e=c(2),a=c(294),k=c(187),x=c(508),y=c(610),m=c(611),u=c(16);class z{constructor(v,E=null,F=-1,J=null){this.v6=v;this.Ahh=J||(()=>E);this.Nfd=F}oj(v,E,F,J,K,H,P,N,M,I=null,T=!1,U=null,W=null){const V=new XMLHttpRequest;let Y="";H="";2===E?(Y="POST",F&&(H=F)):Y="GET";E={};this.v6&&(v=a.a.XWe(E,v,a.a.Gme,e.AFrameworkApplication.WPb,this.v6));
V.open(Y,v,!0);this.sHk(E,v);if(J)for(let ba in J)V.setRequestHeader(ba,u.a.AQ(J[ba]));for(let ba in E)V.setRequestHeader(ba,E[ba]);v=U||this.Nfd;0<v&&(V.timeout=v);v=[];Array.add(v,a.a.g7);J=new Sys.Net.WebRequest;const da=new y.a(1,2,J,v,K,P,N,M,T,I,W);V.onreadystatechange=()=>{this.Gln(V,da)};try{V.send(H)}catch(ba){l.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}o7b(){return 1}Gln(v,E){if(this.nPk(v,E)&&4===v.readyState)if(v.getResponseHeader(a.a.ZRh)&&
e.AFrameworkApplication.zJc)e.AFrameworkApplication.zJc();else{var F=v.getResponseHeader(a.a.uxh);a.a.Cig(F);this.BQo(v,E);v.status===k.a.oz?(E.status=2,E.aL(new m.a(E))):(E.status=v.status&&v.status!==k.a.x3c?v.status===k.a.kxa?5:3:7,E.c3(new x.a(E)))}}sHk(v,E){v["X-xhr"]=1;e.AFrameworkApplication.u2a&&(v[a.a.sDi]=1);e.AFrameworkApplication.buildVersion&&(v[a.a.idc]=u.a.AQ(e.AFrameworkApplication.buildVersion));let F=null;this.Ahh&&(F=this.Ahh());F&&(v[a.a.mlg]=F);e.AFrameworkApplication.canary&&
(v[a.a.f1b]=u.a.AQ(e.AFrameworkApplication.canary),e.AFrameworkApplication.xWc&&l.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",v[a.a.f1b]));e.AFrameworkApplication.accessToken&&(a.a.wzb(E,e.AFrameworkApplication.B6)||(v[a.a.WVe]=u.a.AQ(e.AFrameworkApplication.accessToken)),a.a.wzb(E,e.AFrameworkApplication.uBa)||(v[a.a.XVe]=e.AFrameworkApplication.kMa.toString()));e.AFrameworkApplication.userType&&(v[a.a.nCj]=u.a.AQ(e.AFrameworkApplication.userType))}BQo(v,E){E.Ve=v.status?v.status:k.a.x3c;
try{E.we=v.responseText;if(void 0!==E.cSa&&null!==E.cSa){E.vj={};for(let F=0;F<E.cSa.length;++F){const J=E.cSa[F];E.vj[J]=v.getResponseHeader(J)}}E.jge&&(E.Qha=v.responseText&&v.responseText.length?v.responseXML:null)}catch(F){l.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",E.id,E.request.get_url(),4===v.readyState)}}nPk(v,E){return v?E?!0:(l.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),
!1):(l.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(v,E,F){return new z(v,null,F,E)}}Object(D.a)(z,"SimpleClientRequestSender",null,[868])},2008:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.connected=0]="connected";e[e.disconnected=1]="disconnected";e[e.connecting=2]="connecting";e[e.timeout=3]="timeout"})(l||(l={}));Object(D.b)("AppNetworkConnectivityState",l)},2009:function(D,
L,c){c.d(L,"a",function(){return l});D=c(0);class l{WNa(){}e5b(){}Gfe(){}$de(){}reset(){}dif(){}update(){}vnb(){}dispose(){}}Object(D.a)(l,"FindStatusManagerStub",null,[159,9])},2017:function(D,L,c){c.d(L,"b",function(){return l});c.d(L,"a",function(){return e});var l;(function(a){a[a.None=0]="None";a[a.BetweenLeftAndRightMargin=1]="BetweenLeftAndRightMargin";a[a.BetweenLeftAndRightEdge=2]="BetweenLeftAndRightEdge";a[a.FitToBox=3]="FitToBox"})(l||(l={}));var e;(function(a){a.left="left";a.center=
"center";a.right="right";a.both="both"})(e||(e={}))},2034:function(D,L,c){D=c(0);var l=c(1591),e=c(1592),a=c(1654),k=c(231),x=c(34);class y{}y.eventType="Type";y.vfb="Time";y.eventId="Id";y.ash="AttributionId";y.bsh="AttributionProvider";y.$rh="AttributionName";y.Krh="AssigneeId";y.Lrh="AssigneeProvider";y.Jrh="AssigneeName";y.startDate="Start";y.endDate="End";y.title="Title";y.lCh="Anchor";y.anchorExtensionList="AnchorExtensionList";y.AVi="Percent";y.priority="Priority";y.undoId="UndoId";y.isLossy=
"IsLossy";y.recordExtensionList="RecordExtensionList";Object(D.a)(y,"Key",null,[]);var m=c(394),u=c(1794);const z=E=>{if(!E)return null;let F=null;E=m.a.H2b(E,J=>J.toString(),J=>J.toString());0<E.count&&(F=new u.a(E));return F};c.d(L,"a",function(){return v});class v{u7f(E){if(!E)return"[]";E=v.w_k(E);return x.c(E)}F3b(E){E=x.b(E||"[]");return v.f_k(E)}static Rca(E,F){throw Error.argument(E,F);}static V6b(E,F){F=F.toString();return F in E?E[F].toString():null}static bEb(E,F){F=F.toString();F in E||
v.Rca("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",F));return E[F].toString()}static Lof(E,F){F=F.toString();F in E||v.Rca("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",F));return Number.parseInvariant(E[F].toString())}static UYl(E,F,J){F=F.toString();return F in E?Boolean.parse(E[F].toString()):J}static VYl(E,F){F=F.toString();return F in E?E[F]:null}static qdg(E){E=new Date(E);isNaN(E.getUTCMilliseconds())&&v.Rca("dateTime",
"Date and time is in invalid format");return E}static Iaf(E){return E.toISOString()}static vHh(E,F){return z(v.VYl(E,F))}static x_k(E){const F={};F[y.eventType]=E.type;F[y.vfb]=v.Iaf(E.time);F[y.eventId]=E.recordId;E.isLossy!==v.Fui&&(F[y.isLossy]=E.isLossy);E.user&&(E.user.UserId&&E.user.Provider&&E.user.DisplayName||v.Rca("record","HistoryRecord has invalid attribution"),F[y.ash]=E.user.UserId,F[y.bsh]=E.user.Provider,F[y.$rh]=E.user.DisplayName);E.commentId&&(F[y.lCh]=E.commentId);if(E.anchorExtensionList&&
E.anchorExtensionList.extensions){var J=E.anchorExtensionList.extensions.vkc();F[y.anchorExtensionList]=J}E.recordExtensionList&&E.recordExtensionList.extensions&&(J=E.recordExtensionList.extensions.vkc(),F[y.recordExtensionList]=J);switch(E.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:E.assignee&&E.assignee.UserId&&E.assignee.Provider&&E.assignee.DisplayName||v.Rca("record","HistoryRecord has invalid assignee");F[y.Krh]=E.assignee.UserId;F[y.Lrh]=E.assignee.Provider;F[y.Jrh]=E.assignee.DisplayName;
break;case 5:E.schedule||v.Rca("record","Schedule history record must have a schedule object");E.schedule.startDate&&(F[y.startDate]=v.Iaf(E.schedule.startDate));E.schedule.endDate&&(F[y.endDate]=v.Iaf(E.schedule.endDate));break;case 6:(0>E.completion||100<E.completion)&&v.Rca("record","Progress history record must have a completion >= 0 and <= 100");F[y.AVi]=E.completion;break;case 10:(0>E.priority||10<E.priority)&&v.Rca("record","Priority history record must have a completion >= 0 and <= 10");F[y.priority]=
E.priority;break;case 9:E.title||v.Rca("record","SetTitle history record must have a title");F[y.title]=E.title;break;case -1:E.undoId||v.Rca("record","Undo history record must have an id to undo");F[y.undoId]=E.undoId;break;default:v.Rca("record","Unsupported history record type")}return F}static F_k(E){var F=null,J=v.V6b(E,y.ash);const K=v.V6b(E,y.bsh),H=v.V6b(E,y.$rh);if(J||K||H)J&&K&&H||v.Rca("dictionary","Record has invalid attribution user"),F=new l.a(J,K,H);F=new e.a(v.Lof(E,y.eventType),F,
v.qdg(v.bEb(E,y.vfb)),v.bEb(E,y.eventId));F.commentId=v.V6b(E,y.lCh);F.anchorExtensionList=v.vHh(E,y.anchorExtensionList);F.recordExtensionList=v.vHh(E,y.recordExtensionList);F.isLossy=v.UYl(E,y.isLossy,v.Fui);switch(F.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:F.assignee=new l.a(v.bEb(E,y.Krh),v.bEb(E,y.Lrh),v.bEb(E,y.Jrh));break;case 5:F.schedule=new a.a;if(J=v.V6b(E,y.startDate))F.schedule.startDate=v.qdg(J);if(E=v.V6b(E,y.endDate))F.schedule.endDate=v.qdg(E);break;case 10:F.priority=
v.Lof(E,y.priority);(0>F.priority||10<F.priority)&&v.Rca("dictionary","Priority record must have history >= 0 and <= 10");break;case 6:F.completion=v.Lof(E,y.AVi);(0>F.completion||100<F.completion)&&v.Rca("dictionary","Progress record must have history >= 0 and <= 100");break;case 9:F.title=v.bEb(E,y.title);break;case -1:F.undoId=v.bEb(E,y.undoId);break;default:v.Rca("dictionary","Unsupported history record type")}return F}static w_k(E){const F=Array(E.length);for(let J=0;J<E.length;++J)F[J]=v.x_k(E.J(J));
return F}static f_k(E){const F=new k.a;for(const J of E)E=v.F_k(J),F.add(E);return F}}v.Fui=!1;Object(D.a)(v,"JsonTaskHistorySerialization",null,[524])},2036:function(D,L,c){D=c(0);class l{constructor(k){this.result=null;this.m2i=k}exec(k){return(this.result=this.m2i.exec(k))?!0:!1}MI(){return this.result.index}KOd(){return this.m2i.lastIndex}}Object(D.a)(l,"RegularExpressionWrapper",null,[]);var e=c(16);c.d(L,"a",function(){return a});class a{dfc(k){return this.koj(k).join("").replace(RegExp("(\\\\.\\\\.\\\\.)",
"g"),"(\\.\\.\\.|\u2026)")}BXi(k){var x=k.text;x=k.e2d?this.Tto(x):this.koj(x);if(k.ignorePunct||k.ignoreSpace){let y="";k.ignoreSpace&&(y+="\\s");k.ignorePunct&&(y+=a.VDn);y="["+y+"]*";for(let m=1;m<x.length;m++)if(!k.e2d||"{"!==x[m].charAt(0)&&"@"!==x[m].charAt(0))x[m]=y+x[m]}return x.join("")}Nlb(k){return[k]}qZd(k){for(let x=0;x<k.length;++x){const y=k.charAt(x);let m=0;if("["===y){if(!({oD:m}=this.xKm(k.substr(x))).returnValue)return!1;x=m+x-1}else if("<"===y){if(!this.uKm(k.substr(x)))return!1}else if(">"===
y){if(!x)return!1}else if("{"===y){if(!x||!({oD:m}=this.wKm(k.substr(x))).returnValue)return!1;x=m+x-1}else if("@"===y){if(!x||!this.vKm(k.substr(x)))return!1}else if("("===y){if(!({oD:m}=this.tKm(k.substr(x))).returnValue)return!1;x=m+x-1}else if("}"===y||"]"===y||")"===y)return!1}return!0}LWh(k,x){let y,m;m=y=0;if(k.length<=x)return{returnValue:!1,oD:y,Ead:m};const u=k.length;var z=k.charAt(x);if("["===z)for(z=x+1;z<u;z++){if("]"===k.charAt(z)&&1!==z-x)return y=z,m=5,{returnValue:!0,oD:y,Ead:m}}else if("{"===
z)for(z=-1,x+=1;x<u;x++){let v=k.charAt(x);if(","===v)z=x;else if("}"===v)return m=-1===z?6:1!==x-z?7:8,y=x,{returnValue:!0,oD:y,Ead:m}}return{returnValue:!1,oD:y,Ead:m}}vIo(k,x,y){let m;if((m=x)||1!==k.length)switch(k.charAt(x+1)){case "{":let u,z;if(!({oD:u,Ead:z}=this.LWh(k,x+1)).returnValue)return{returnValue:this.cIa("*",y,!1),oD:m};k=this.cIa("*",y,!0)+this.cIa(k.substring(x+1,u+1),z);m=u;if(7===z||8===z)k+="?";return{returnValue:k,oD:m};case "@":return m=x+1,{returnValue:this.cIa("*",y,!0),
oD:m};case "*":if(!x){for(m++;"*"===k.charAt(m);)m++;if(m===k.length)return{returnValue:this.cIa("*",y,!0),oD:m}}return{returnValue:this.cIa("*",y,!1),oD:m};default:return{returnValue:this.cIa("*",y,!1),oD:m}}else return{returnValue:this.cIa(k,y,!0),oD:m}}cIa(k,x,y=!1){const m=k.length;switch(x){case 5:return"!"===k.charAt(1)&&2<m?"([^"+this.CXi(k.substr(2,m-3))+"]\u0640*)":"(["+this.CXi(k.substr(1,m-2))+"]\u0640*)";case 6:return k;case 7:return k;case 9:return"+?";case 8:return k;case 3:return"\\b";
case 4:return"\\b";case 1:return".";case 2:return y?"(.+?)":"(.*?)";case 10:return k}return null}tfi(k){switch(k){case "?":return 1;case "*":return 2;case "<":return 3;case ">":return 4;case "@":return 9}return 0}yyn(k){return"["===k||"]"===k||"\\"===k||"("===k||")"===k?String.format("\\{0}",k):"'"===k||"\u2018"===k||"\u2019"===k||'"'===k||"\u201c"===k||"\u201d"===k||e.a.sba(k)?this.iYf(k):k}CXi(k){const x=[];for(let y=0;y<k.length;++y)x[y]=this.yyn(k.charAt(y));return x.join("")}xKm(k){let x;var y;
x=-1;var m=new l(RegExp("\\[.+?\\]","g"));if(m.exec(k)){if(y=m.MI())return{returnValue:!1,oD:x};x=m.KOd()}else return{returnValue:!1,oD:x};if((new l(RegExp("(\\(\\))|(.+?!)","g"))).exec(k.substring(1,x-1)))return{returnValue:!1,oD:x};y=new l(RegExp("[^!\\[]-[^\\]]","g"));for(k.substring(0,x);y.exec(k.substring(0,x));){m=y.MI();const u=RegExp("[-]","g");m=k.substring(m,y.KOd()).split(u);if(m[0].charAt(0)>m[1].charAt(0))return{returnValue:!1,oD:x}}return{returnValue:!0,oD:x}}uKm(k){return(new l(RegExp("\\<(\\{|\\@|\\>|\\<|\\}|\\))",
"g"))).exec(k)?!1:!0}wKm(k){let x;x=-1;var y;if((new l(RegExp("(\\}\\{)|(\\}\\@)","g"))).exec(k))return{returnValue:!1,oD:x};const m=new l(RegExp("\\{\\d+(,|(,\\d+))?\\}","g"));if(m.exec(k)){if(y=m.MI())return{returnValue:!1,oD:x};x=m.KOd();y=RegExp("[{,}]","g");y=k.substring(0,x).split(y);if(4===y.length&&(k=Number.parseInvariant(y[1]),y=Number.parseInvariant(y[2]),k>=y))return{returnValue:!1,oD:x}}else return{returnValue:!1,oD:x};return{returnValue:!0,oD:x}}vKm(k){return(new l(RegExp("\\@\\{","g"))).exec(k)?
!1:!0}tKm(k){let x;x=-1;let y;const m=new l(RegExp("\\(([^\\[\\]]*?(\\[.+?\\])?)+?\\)","g"));if(m.exec(k)){y=m.MI();x=m.KOd();if(y)return{returnValue:!1,oD:x};if(this.qZd(k.substring(1,x-1)))return{returnValue:!0,oD:x}}return{returnValue:!1,oD:x}}Tto(k){const x=[],y=k.length;let m=0;for(let u=0;u<y;++u){const z=m,v=k.charAt(u);let E=0,F=0;"["===v||"\\"===v||"^"===v||"$"===v||"."===v||"|"===v||"+"===v||"("===v||")"===v||"?"===v||"*"===v||"<"===v||">"===v||"@"===v||"?"===v||"{"===v?"["!==v&&"{"!==v||
!({oD:E,Ead:F}=this.LWh(k,u)).returnValue?"?"===v||"<"===v||">"===v||"@"===v?(F=this.tfi(v),x[z]=this.cIa(v,F)):"*"===v?(F=this.tfi(v),x[z]=({oD:E}=this.vIo(k,u,F)).returnValue,u=E):"("===v||")"===v?(F=10,x[z]=this.cIa(v,F)):x[z]=String.format("\\{0}",v):(x[z]=this.cIa(k.substr(u,E+1-u),F),u=E):x[z]="'"===v||"\u2018"===v||"\u2019"===v||'"'===v||"\u201c"===v||"\u201d"===v||"-"===v||"\u2013"===v||"\u2014"===v||e.a.sba(v)?"["+this.iYf(v)+"]":"\u2026"===v?"\\.\\.\\.":v;""!==x[z]&&0===F&&(x[z]=u<k.length-
1&&("@"===k.charAt(u+1)||"{"===k.charAt(u+1))?"("+x[z]+"\u0640*)":x[z]+"\u0640*");m++}return x}koj(k){const x=[];for(let y=0;y<k.length;++y){const m=k.charAt(y);x[y]="["===m||"\\"===m||"^"===m||"$"===m||"."===m||"|"===m||"+"===m||"("===m||")"===m||"?"===m||"*"===m?String.format("\\{0}",m):"'"===m||"\u2018"===m||"\u2019"===m||'"'===m||"\u201c"===m||"\u201d"===m||"-"===m||"\u2013"===m||"\u2014"===m||e.a.sba(m)?"["+this.iYf(m)+"]":"\u2026"===m?"\\.\\.\\.":m;""!==x[y]&&(x[y]+="\u0640*")}return x}iYf(k){return"'"===
k||"\u2018"===k||"\u2019"===k?"'\u2018\u2019":'"'===k||"\u201c"===k||"\u201d"===k?'"\u201c\u201d':"-"===k||"\u2013"===k||"\u2014"===k?"-\u2013\u2014":e.a.sba(k)?a.yJo:k}static get instance(){return a._instance||(a._instance=new a)}}a._instance=null;a.yJo=" \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000";a.VDn='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d\u201c';Object(D.a)(a,"WordQueryProcessor",null,[952])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19334779/wdjs/WordEditorDSVersionHistoryNotRemoved.common.js.map