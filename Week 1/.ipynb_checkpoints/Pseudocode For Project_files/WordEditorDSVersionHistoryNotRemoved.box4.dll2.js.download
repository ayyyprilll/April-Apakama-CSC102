'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1478:function(D,L,c){D=c(0);var l=c(17),e=c(43),a=c(6),k=c(123),x=c(177),y=c(805),m=c(231),u=c(627),z=c(2),v=c(394),E=c(21),F=c(46),J=c(234),K=c(1),H=c(1547);class P{constructor(U,W){this.rWj=U;this.Rz=W}J(U){return this.rWj.Wy(U,this.Rz)}}Object(D.a)(P,"PropertyMergeStrategies",null,[]);var N=c(1616),M=c(1569);class I extends M.a{constructor(){super();this.kYc=this.x2d=this.Jn=null;this.M9d=0}get zfa(){return"Property"}eDb(){this.detail.Z("Type",
this.zfa);this.detail.Z("ComplexMerger",null!=this.Jn?this.Jn:-1);this.detail.Z("Strategy",null!=this.x2d?this.x2d:-1);this.detail.Z("ClassId",null!=this.kYc?this.kYc:-1);this.detail.Z("PropId",this.M9d);return this.detail}}Object(D.a)(I,"PropertyMergeFailureDetail",M.a,[]);c.d(L,"a",function(){return T});class T{constructor(U=null){this.X8g=this.Xb=null;this.WVb=U||this.ANc()}get Jn(){return 1}get nkb(){return this.WVb}ANc(){return[Object(F.a)(this,this.OHo,"tryPreProcessFavoredRevision"),Object(F.a)(this,
this.DSk,"cloneObjectAndRemoveNeededProperties"),Object(F.a)(this,this.FHo,"tryMergeNodeInternal")]}get Rz(){return 5}get O9d(){return this.X8g||(this.X8g=new P(this.rk(),this.Rz))}GB(U,W){const V=U.Ng.value.yf;x.a.instance.Ta(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",V.id,V.Nc);U.Zp.logger.Pg(Object.assign(new I,{Jn:this.Jn,kYc:V.Nc,M9d:W}));return!1}Ahg(U){const W=U.Ng.value;x.a.instance.Ta(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",W.yf.id,W.yf.Nc);for(let V=0;V<this.nkb.length;V++)if(!(0,this.nkb[V])(U))return x.a.instance.Ta(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",W.yf.id,W.yf.Nc,V),U.Zp.logger.a1d("GraphNodeComplexMerge.GetMergeFunctions()",V),this.qXm(U),U.Sk=null,!1;x.a.instance.Ta(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",W.yf.id,W.yf.Nc);
return!0}qXm(U){U.ulg||(U.ulg=!0,N.a(U.Ng.value.Bu,"Base",1),N.a(U.Ng.value.yf,"Favored",1),N.a(U.pn.value.yf,"Conflict",1))}OHo(U){const W=U.Ng.value,V=this.O9d;if(!W.JX)return!0;let Y=!0;W.fpa.forEach((da,ba)=>{if(!ba.JX||U.og.contains(da))return!0;ba=V.J(da);if(5===ba){const ja=W.Bu.Nc;x.a.instance.Ta(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",ja,da,ba);U.Zp.logger.Pg(Object.assign(new I,
{Jn:this.Jn,kYc:ja,M9d:da,x2d:ba}));return Y=!1}6===ba&&U.aZf.add(da);return!0});return Y}DSk(U){U.Sk=U.Ng.value.yf.fH();const W=U.aZf,V=U.Sk;W&&W.forEach(Y=>{V.removeProperty(y.a.dX(Y));return!0});return!0}FHo(U){const W=U.pn.value,V=W.Bu.Nc,Y=this.O9d;let da=!0;W.fpa.forEach((ba,ja)=>{const sa=Y.J(ba);da=this.GHo(U,ja,ba,sa);da||(U.Sk=null,x.a.instance.Ta(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",V,ba,sa),U.Zp.logger.Pg(Object.assign(new I,{Jn:this.Jn,
kYc:V,M9d:ba,x2d:sa})));return da});return da}GHo(U,W,V,Y){const da=U.Sk;if(!W.JX&&8!==Y||2===Y||7===Y||U.og.contains(V))return!0;if(5===Y)return!1;if(4===Y||3===Y){let ba;if(({value:ba}=U.Ng.value.fpa.Ec(V)).returnValue&&ba.JX)return 4!==Y;Y=0}8===Y&&(Y=0);if(0===Y){if(!W.isDeleted)return U=y.a.dX(V),(T.ZUo(W,V,U)||T.Tlo())&&da.cya(U,W.newValue),!0;Y=6}return 6===Y?(da.removeProperty(y.a.dX(V)),!0):1===Y?this.GB(U,V):!1}g7m(U,W,V,Y,da,ba){U=U||new m.a;W=W||new m.a;V=V||new m.a;var ja=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
U.length,W.length,V.length),sa=U.length<=W.length&&U.length<=V.length;this.Aui()&&sa&&x.a.instance.Ta(541181455,1,1,ja);if(!sa&&this.Jsi(ba.runtime.Xb))return null;if(this.Aui())for(ja=0;ja<U.length;ja++){sa=U.$f(ja);var ta=W.$f(ja);let ra=V.$f(ja);sa=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",sa,ta,ra,ja,U.length);x.a.instance.Ta(541181457,1,1,sa)}if(this.Jsi(ba.runtime.Xb))for(ba=
0;ba<U.length;ba++)if(ja=U.$f(ba),sa=W.$f(ba),ta=V.$f(ba),!Y(ja,sa)||!Y(ja,ta))return null;U=U.y4();Y=new u.a;ba=U.length;for(ja=ba;ja<W.length;ja++)sa=W.$f(ja),U.add(sa),Y.add(sa);for(;ba<V.length;ba++)W=V.$f(ba),Y.contains(W)?x.a.instance.Ta(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",W):(U.add(W),da(W));return U}Aui(){return!!z.AFrameworkApplication.K&&z.AFrameworkApplication.K.$("LogMPALErrors")}Jsi(U){if(!U)return!1;
U.IRd(1000008);return U.lhb(1000008)}iKm(U){if(!U)return!1;U.IRd(1000009);return U.lhb(1000009)}MHi(U,W,V,Y){return H.a(U,W,V,Y)}DFa(U,W,V){U=U||new m.a;W=W||new m.a;V=V||new m.a;const Y=U.zG(),da=W.zG(),ba=V.zG();U=T.filter(U,ja=>da.contains(ja)&&ba.contains(ja));U.zG();U.fA(U.length,T.filter(W,ja=>!Y.contains(ja)));U.fA(U.length,T.filter(V,ja=>!Y.contains(ja)&&!da.contains(ja)));return U}$6m(U,W){const V=y.a.dX(W),Y=U.Xd;var da=Y.getPropertyObjectIds(U.Ng.value.Bu,V),ba=Y.getPropertyObjectIds(U.Ng.value.yf,
V);const ja=Y.getPropertyObjectIds(U.pn.value.yf,V);da=this.DFa(da,ba,ja);ba=U.Sk;0<da.length?Y.setPropertyObjectIds(ba,V,da):ba.removeProperty(V);U.og.add(W)}meb(U,W,V){U.hasProperty(V)?W.cya(V,U.jX(V)):W.removeProperty(V)}tXn(U,W){var V=W.Fl();for(const Y of V)W.removeProperty(Y);V=U.Fl();for(const Y of V)W.cya(Y,U.jX(Y))}iFf(U,W,V,Y,da){W=U.getPropertyInt32(W,da);V=U.getPropertyInt32(V,da);V=null!=W&&null!=V?Math.max(W,V):null!=V?V:null!=W?W:null;null!=V?U.setPropertyInt32(Y,da,V):Y.removeProperty(da)}G4e(U,
W,V,Y,da,ba){W=U(W,da);V=U(V,da);U=U(Y,da);Y=W.zG();let ja=!1;ba&&(ja=ba(W,V,U));ja?(ba=!0,Y=!1):(ba=Y.iEh(V),Y=Y.iEh(U));x.a.instance.Ta(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",y.a.zb(da),W.Pq(),V.Pq(),U.Pq(),ba,Y);return{dGc:U,c2a:ba,T1a:Y}}xOk(U,W,V,Y,da){let ba;W=U(W,da);V=U(V,da);U=U(Y,da);Y=this.Bxi(W,V);ba=this.Bxi(W,U);x.a.instance.Ta(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
y.a.zb(da),W.Pq(),V.Pq(),U.Pq(),Y,ba);return{dGc:U,c2a:Y,T1a:ba}}Bxi(U,W){if(!U&&!W)return!0;if(!U||!W)return!1;if(!U.count&&!W.count)return!0;let V=!1;W.forEach((Y,da)=>V=U.ob(Y)&&da==U.J(Y));return V}rk(){let U;U=this.iKm(this.Xb)?T.F3j.value:T.E3j.value;const W=new v.a(0);for(let V=0;V<U.length;V++)W.Z(U[V],7);return W}static h7(){return new T}static get instance(){return T._instance.value}static Tlo(){return E.a.instance.Ma("Box4.IFeatureHelper").isFeatureEnabled(76)}static ZUo(U,W,V){if(void 0!==
U.newValue&&null!==U.newValue||K.a.ivi(V.type))return!0;T.GYm(U,W,V);return!1}static GYm(U,W,V){V=V.type===K.a.string;W=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",W);V||(W+=String.format(" [NewValue: {0}] [OldValue: {1}]",U.newValue,U.oldValue));x.a.instance.Ta(19145822,1,2,W)}static pKf(U,W,V){const Y=y.a.zb(V),da=U.Xd;var ba=da.getPropertyObjectIds(U.Ng.value.Bu,V);const ja=da.getPropertyObjectIds(U.Ng.value.yf,V);var sa=da.getPropertyObjectIds(U.pn.value.yf,V);sa=T.mam(sa,
U.Zp.runtime.Wic);W=W.DFa(ba,ja,sa);ba=U.Sk;0<W.length?da.setPropertyObjectIds(ba,V,W):ba.removeProperty(V);U.og.add(Y);return!0}static mam(U,W){const V=new m.a;U.forEach(Y=>{W.contains(Y,(da,ba)=>da.equals(ba))||V.add(Y);return!0});return V}static filter(U,W){const V=new m.a;U.forEach(Y=>{W(Y)&&V.add(Y);return!0});return V}static YRl(){return[y.a.zb(l.a.lff),y.a.zb(l.a.lastModifiedTime),y.a.zb(l.a.SK),y.a.zb(l.a.$3c),y.a.zb(l.a.j5f),y.a.zb(e.a.iYc),y.a.zb(a.a.SDd),y.a.zb(a.a.$eb),y.a.zb(k.a.W$i)]}static ZRl(){return[y.a.zb(l.a.lff),
y.a.zb(l.a.lastModifiedTime),y.a.zb(l.a.SK),y.a.zb(l.a.$3c),y.a.zb(l.a.j5f),y.a.zb(e.a.iYc),y.a.zb(a.a.SDd),y.a.zb(k.a.W$i)]}}T._instance=new J.a(T.h7);T.E3j=new J.a(T.YRl);T.F3j=new J.a(T.ZRl);Object(D.a)(T,"GraphNodeComplexMerge",null,[1920])},1479:function(D,L,c){c.r(L);D=c(0);var l=c(117),e=c(1498),a=c(1484),k=c(1620),x=c(1621);class y{constructor(u,z){this.U$a=!1;this.Tga=null;if(!u)throw Error.argumentNull("annotations");if(!u.Nac(z))throw Error.argument("structTypeID","Invalid struct type ID");
this.Yv=u;this.Ybc=this.Yv.k9h(z);this.fek=z}get L_b(){return this.Yv}get isReadOnly(){return this.U$a}get QSa(){return this.fek}Fgb(u){if(0>u||u>=this.Ybc)throw Error.argument("iField","Invalid field index");return this.Tga&&null!=this.Tga[u]?this.Tga[u]:this.Yv.Sci(this.QSa,u)}q8f(u,z){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>u||u>=this.Ybc)throw Error.argument("iField","Invalid field index");if(!this.Yv.H$b(this.Yv.cEb(this.QSa,
u),z))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Tga||(this.Tga=Array(this.Ybc)))[u]=z}Vca(){const {Annotations:u}=c(1479);let z="[";if(this.Tga){let v=!0;for(let E=0;E<this.Ybc;++E){if(null==this.Tga[E])continue;const F=this.Yv.cEb(this.QSa,E);if(u.wpb(F,this.Tga[E],this.Yv.Sci(this.QSa,E)))continue;v?v=!1:z+=", ";z+=this.Yv.Tci(this.QSa,E);z+="=";const J=this.Yv.Vca(F,this.Tga[E]);F===u.y9?(z+='"',z+=e.a.hgf(J),z+='"'):z+=J}}return z+"]"}isEqual(u){const {Annotations:z}=
c(1479);if(this===u)return!0;if(!u||this.Yv!==u.L_b||this.QSa!==u.QSa)return!1;for(let v=0;v<this.Ybc;++v)if(!z.wpb(this.Yv.cEb(this.QSa,v),this.Fgb(v),u.Fgb(v)))return!1;return!0}clone(){const u=new y(this.Yv,this.QSa);this.Tga&&(u.Tga=Array.clone(this.Tga));return u}NS(){return this.isReadOnly?this.clone():this}DHf(){const {Annotations:u}=c(1479);if(!this.isReadOnly&&(this.U$a=!0,this.Tga))for(let z=0;z<this.Ybc;++z){const v=this.Tga[z];null!=v&&u.bIb(v)}}toString(){return this.Vca()}}Object(D.a)(y,
"StructValue",null,[1344,1342]);c.d(L,"Annotations",function(){return m});class m{constructor(u,z){if(!u)throw Error.argumentNull("initData");if(!z)throw Error.argumentNull("objectFetcher");this.D2m=z.Rjl;let v=0;var E=z.pgb(u.J(v));++v;this.mJf=new k.a(new x.a(E));this.oWj=u.J(v);++v;this.mFi=Array(this.kJd);this.PWc=Array(this.kJd);this.fkb=Array(this.kJd);for(E=0;E<this.kJd;++E){this.mFi[E]=z.uD(u.J(v));++v;this.PWc[E]=u.J(v);++v;var F=u.J(v);++v;this.fkb[E]=Array(F);for(var J=0;J<F;++J)this.fkb[E][J]=
z.uD(u.J(v)),++v}this.eek=u.J(v);++v;this.SFi=Array(this.N7c);this.L1d=Array(this.N7c);this.M1d=Array(this.N7c);this.K1d=Array(this.N7c);for(E=0;E<this.N7c;++E)for(this.SFi[E]=z.uD(u.J(v)),++v,F=u.J(v),++v,this.L1d[E]=Array(F),this.M1d[E]=Array(F),this.K1d[E]=Array(F),J=0;J<F;++J)this.L1d[E][J]=z.uD(u.J(v)),++v,this.M1d[E][J]=u.J(v),++v,this.K1d[E][J]=({hga:v}=this.tNa(this.M1d[E][J],u,v,null,null,null)).returnValue,m.bIb(this.K1d[E][J]);this.SPj=u.J(v);++v;this.RIf=Array(this.j0b);this.SIf=Array(this.j0b);
this.QIf=Array(this.j0b);for(E=0;E<this.j0b;++E)this.RIf[E]=z.uD(u.J(v)),++v,this.SIf[E]=u.J(v),++v,this.QIf[E]=({hga:v}=this.tNa(this.SIf[E],u,v,null,null,null)).returnValue,m.bIb(this.QIf[E])}ZLc(u){for(let z=0;z<this.j0b;++z)if(this.RIf[z]===u)return z;return-1}r0h(u){if(!this.Kac(u))throw Error.argument("attrID","Invalid attribute ID");return this.RIf[u]}getAttributeType(u){if(!this.Kac(u))throw Error.argument("attrID","Invalid attribute ID");return this.SIf[u]}cEb(u,z){if(!this.Nac(u))throw Error.argument("structTypeID",
"Invalid struct type ID");u=this.M1d[m.O7c(u)];if(0>z||z>=u.length)throw Error.argument("iField","Invalid field index");return u[z]}Vca(u,z){if(!this.IEf(u))throw Error.argument("typeID","Invalid type ID");if(!this.H$b(u,z))throw Error.argument("value","Value is not of the correct type");switch(u){case m.y9:return z;case m.yya:return z?"True":"False";case m.eIa:case m.lqa:return z.toString();case m.YU:return z.Vca();default:if(!m.NH(u)&&m.T9c(u)){u=m.Zff(u);const F=this.fkb[u].length;switch(this.PWc[u]){case 0:return this.fkb[u][z];
case 1:if(z){var v="";for(var E=1;E<F;++E)z&1<<E-1&&(0<v.length&&(v+=" & "),v+=this.fkb[u][E]);return v}return this.fkb[u][0];case 2:v="";for(E=0;E<F;++E)z&1<<E&&(0<v.length&&(v+=" & "),v+=this.fkb[u][E]);return v;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.PWc[u]);}}else return z.Vca()}}IEf(u){switch(u){case m.y9:case m.yya:case m.eIa:case m.lqa:case m.YU:return!0;default:return m.NH(u)?this.IEf(m.w0a(u)):m.T9c(u)?this.tMm(u):this.Nac(u)}}tMm(u){u=m.Zff(u);return 0<=
u&&u<this.mFi.length}Nac(u){u=m.O7c(u);return 0<=u&&u<this.SFi.length}Kac(u){return 0<=u&&u<this.j0b}H$b(u,z){if(null==z)return!1;switch(u){case m.y9:return"string"===typeof z;case m.yya:return"boolean"===typeof z;case m.eIa:return"number"===typeof z;case m.lqa:return"number"===typeof z;case m.YU:return Object(l.a)(1341,z);default:if(m.NH(u))return Object(l.a)(1343,z)&&z.L3===m.w0a(u);if(m.T9c(u)){if("number"!==typeof z)return!1;u=m.Zff(u);const v=this.fkb[u].length;switch(this.PWc[u]){case 0:return 0<=
z&&z<v;case 1:return!(z&-1<<v-1);case 2:return!!z&&!(z&-1<<v);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.PWc[u]);}}else return Object(l.a)(1344,z)&&z.QSa===u}}get j0b(){return this.SPj}get kJd(){return this.oWj}get N7c(){return this.eek}uFl(u){if(!this.Kac(u))throw Error.argument("attrID","Invalid attribute ID");return this.QIf[u]}k9h(u){if(!this.Nac(u))throw Error.argument("structTypeID","Invalid struct type ID");return this.L1d[m.O7c(u)].length}Tci(u,z){if(!this.Nac(u))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.L1d[m.O7c(u)][z]}Sci(u,z){if(!this.Nac(u))throw Error.argument("structTypeID","Invalid struct type ID");u=this.K1d[m.O7c(u)];if(0>z||z>=u.length)throw Error.argument("iField","Invalid field index");return u[z]}tNa(u,z,v,E,F,J){if(!z)throw Error.argumentNull("initData");if(m.NH(u)){var K=z.J(v);++v;u=m.w0a(u);var H=new a.a(this,u);for(var P=0;P<K;++P)Array.add(H.items,({hga:v}=this.tNa(u,z,v,E,F,J)).returnValue);return{returnValue:H,hga:v}}switch(u){case m.y9:return{returnValue:(E||
this.mJf).uD(z.J(v++)),hga:v};case m.yya:return{returnValue:1===z.J(v++),hga:v};case m.eIa:return{returnValue:z.J(v++),hga:v};case m.lqa:return{returnValue:(F||this.D2m)[z.J(v++)],hga:v};case m.YU:u=z.J(v++);K=new e.a(this);for(H=0;H<u;++H)P=z.J(v),++v,J&&(P=J[P]),K.ry(P,({hga:v}=this.tNa(this.getAttributeType(P),z,v,E,F,J)).returnValue);return{returnValue:K,hga:v};default:if(m.T9c(u))return{returnValue:z.J(v++),hga:v};if(m.Owj(u)){K=z.J(v++);H=new y(this,u);for(P=0;P<K;++P){const N=z.J(v);++v;H.q8f(N,
({hga:v}=this.tNa(this.cEb(u,N),z,v,E,F,J)).returnValue)}return{returnValue:H,hga:v}}throw Error.argument("typeID","Invalid type ID");}}static T9c(u){return 16<=(u&16383)&&16384!==(u&16384)&&32768!==(u&32768)}static Owj(u){return 16<=(u&16383)&&16384===(u&16384)&&32768!==(u&32768)}static NH(u){return 32768===(u&32768)}static kVl(u){if(m.NH(u))throw Error.argument("nonListTypeID","Non-list type ID required");return u|32768}static w0a(u){if(!m.NH(u))throw Error.argument("listTypeID","List type ID required");
return u&-32769}static wpb(u,z,v){switch(u){case m.y9:case m.yya:case m.eIa:case m.lqa:return z===v;case m.YU:return z.isEqual(v);default:return m.NH(u)?z.isEqual(v):m.T9c(u)?z===v:z.isEqual(v)}}static bIb(u){Object(l.a)(1342,u)&&u.DHf()}static NS(u){return Object(l.a)(1342,u)?u.NS():u}static Zff(u){return u-16}static O7c(u){return(u&-16385)-16}}m.y9=1;m.yya=2;m.eIa=3;m.lqa=5;m.YU=9;Object(D.a)(m,"Annotations",null,[1345])},1482:function(D,L,c){D=c(0);var l=c(289);class e{constructor(){this.userId=
this.email=this.displayName=null}}Object(D.a)(e,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(D.a)(a,"InsightsParameters",null,[]);var k=c(1711),x=c(1712),y=c(1713),m=c(1714),u=c(2),z=c(1530),v=c(1543),E=c(34),F=c(15),J=c(16),K=c(27);c.d(L,"a",function(){return H});class H{static get tyf(){return"Insights_16x16x32"}static get hvl(){return"Find_16x16x32"}static get FUi(){return"-Parameterized"}static get Tbg(){return"Parameterized"}static get Yke(){return"bTryQuery"}static get Hhg(){return"TellMeSuggestion_"}static get qwj(){return"bTryQueryAlternate"}static get hfg(){return"MenuTellMe"}static get hvn(){const P=
{},N=[];Array.add(N,{Term:{PeopleType:"Person"}});P.And=N;return P}static y$e(P){return P+H.FUi}static getParameter(P){let N="",M="";if(P)for(let I=0;I<P.nVh;++I)"Type"===P.Enf(I)?N=P.getValue(I):"Value"===P.Enf(I)&&(M=P.getValue(I));return new l.a(N,M)}static uAb(P){P=Object.assign(new a,{neighborhood:P,mentionStart:0,mentionLength:P.length});return E.c(P)}static dJh(P,N,M){P=Object.assign(new e,{displayName:P,email:N,userId:M});return E.c(P)}static mNa(P,N,M=null){return E.c(H.yci(P,N,M,null))}static yci(P,
N,M=null,I=null){P=Object.assign(new v.a,{neighborhood:P,mentionStart:0,mentionLength:P?P.length:0});return Object.assign(new z.a,{selection:P,userIntent:I,entryPoint:N,launchData:M})}static B0n(P,N){return H.mNa(P,H.Y8i(N))}static Y8i(P){switch(P){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static oti(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static SGb(){const P=
u.AFrameworkApplication.K?u.AFrameworkApplication.K.kb("SovereignEnvironmentName"):null;return!!P&&0<P.length}static isEnterpriseUser(){const P=u.AFrameworkApplication.K?u.AFrameworkApplication.K.kb("HostAuthType"):null;return!!P&&"aad"===P.toLowerCase()||"external"===P&&H.dAf()}static O$f(P){return P.JAo&&!H.SGb()}static Ywi(){const P=u.AFrameworkApplication.K?u.AFrameworkApplication.K.kb("UiHostIntegrationType"):"";return!!u.AFrameworkApplication.K&&"UnifiedUiHostTeams"===P&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static N$f(P){return P.fTa&&P.jtl&&(P.y8c||P.w8c||P.tjb)&&!H.Ywi()&&H.isEnterpriseUser()&&!H.SGb()}static Dga(){return u.AFrameworkApplication.K?u.AFrameworkApplication.g6a||u.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):u.AFrameworkApplication.g6a}static FQ(P){return!P||H.xxi(P.Eg)}static xxi(P){return!P||!P.trim().length}static Ike(P){if(!P)return 0;const N=Math.pow(10,5);return Math.round(P*N)/N}static YCo(){var P=new Date;return P?new Date(P.getUTCFullYear(),P.getUTCMonth(),P.getUTCDate(),
P.getUTCHours(),P.getUTCMinutes(),P.getUTCSeconds(),P.getUTCMilliseconds()):null}static Fsf(P){P=new Date(P);return(H.YCo().getTime()-P.getTime())/1E3}static hyi(P){const {InsightsMenuItemFactory:N}=c(1710);switch(P){case k.a.lvf:case x.a.bXh:case N.hoi:case y.a.BKi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return P.startsWith(H.Yke)||
P.startsWith(H.Hhg)||P.startsWith(H.qwj)||P.startsWith("PeopleSuggestion")||P.startsWith("FileSuggestion")||P.startsWith("FindInDocumentSuggestion")||P.startsWith("NotesSuggestion")||P.startsWith("OnenoteNotesSuggestion")||P.startsWith("SmartLookupFromTellMe")||P.startsWith("GetHelpFromTellMe")||P.startsWith("GetHelpWithDescriptionFromTellMe")||P.startsWith("AddinSuggestion")||P.startsWith("OfficeScripts")?!0:!1}static Ynf(P,N){const M=[];Array.add(M,new m.a(400,P));Array.add(M,new m.a(200,N));P=
{};P.parts=M;return JSON.stringify(P)}static ogb(P){const N=P.indexOf("<b0>"),M=P.lastIndexOf("</b0>"),I=[];Array.add(I,new m.a(400,P.substring(0,N)));Array.add(I,new m.a(600,P.substring(N+4,M)));Array.add(I,new m.a(400,P.substring(M+5,P.length)));P={};P.parts=I;return JSON.stringify(P)}static pei(P){const N=H.Fsf(P);return 60>N?CommonUIStrings.l_TimeSince_SecsAgo:3600>N?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(N/60).toString()):86400>N?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(N/3600).toString()):172800>N?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(P)).localeFormat("MMMM dd, yyyy"))}static RIl(P){const N=Array(P.length);for(let M=0;M<P.length;M++)N[M]=P[M].commandId;return N}static dAf(){if("Dev Box"===u.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse"))return!0;let P=u.AFrameworkApplication.K.kb("UserPrincipalName");P=K.c(P)?"":J.a.fh(P);const N=u.AFrameworkApplication.K.yw("TellMeIntEnabledForFeatureCrew")?
u.AFrameworkApplication.K.oC("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(N,P)&&"inner"===u.AFrameworkApplication.K.kb("Microsoft365Ring")}static URl(P){switch(H.LNd(P)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static W5l(P){P=H.LNd(P);switch(P){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return P}}static LNd(P){switch(P.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static Hna(){return F.a.y3&&!F.a.qq}}H.oTa=9E5;Object(D.a)(H,"TellMeUtils",null,[])},1483:function(D,L,c){c.r(L);D=c(0);var l=c(439),e=c(318),a=c(46),k=c(117),x=c(82),y=c(1637),m=c(227);class u{constructor(lb,qa,Ga,Fb,$b,rb){this.groupType=lb;this.resultType=qa;this.Bdg=Ga;this.P7=Fb;this.Zcf=$b;this.resultIndex=
rb}}Object(D.a)(u,"ClickLoggingInfo",null,[]);const z=lb=>{const qa=[];for(;lb;)Array.add(qa,"{ContextId:"+lb.contextId+", IsGraphNodeContext:"+lb.Xk+"}"),lb=lb.Yj;qa.reverse();return"{"+qa.join(", ")+"}"};class v{constructor(){this.xna=this.sessionId=null}}Object(D.a)(v,"CorrelationRecord",null,[1264]);var E=c(1503);class F{constructor(lb,qa){this.provider=lb;this.U6a=qa}}Object(D.a)(F,"ExternalResultProvider",null,[]);class J{constructor(lb,qa){this.Id=null;this.TimeStamp=0;this.Id=lb;this.TimeStamp=
qa}}Object(D.a)(J,"MRUControl",null,[]);var K=c(1622),H=c(1618),P=c(1482),N=c(2),M=c(1368);class I{constructor(lb,qa){this.U4j=10;this.g6=[];this.rAa=[];this.OYg=this.NYg=!1;this.lwc=this.kwc="";this.TVb=qa;this.kc=lb;this.AZg=lb.rq}zMc(){!this.NYg&&this.AZg&&this.kc&&H.a.Gui()&&(this.kwc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.kc.application,this.g6=this.h1h(),this.NYg=!0);return this.g6}e2l(){!this.OYg&&this.AZg&&this.kc&&H.a.Gui()&&(this.lwc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.kc.application,
this.rAa=this.h1h(!0),this.OYg=!0);return this.rAa}uLm(lb){return lb.startsWith("TellMeUpsell")||"OpenInClientUpsell"===lb||"TryOfficeUpsell"===lb}Lzf(lb){return this.Ixm(lb)||this.uLm(lb)||P.a.hyi(lb)?!1:!0}fYa(lb){lb=lb.ControlId;this.Lzf(lb)&&(lb=this.E2f(lb),this.FTn(lb),this.w3m(),Array.insert(this.g6,0,new J(lb,Date.now())),this.kwc.length&&(lb=JSON.stringify(this.g6),M.a.instance.setItem(this.kwc,lb)))}lE(lb){this.v3m();Array.insert(this.rAa,0,new J(K.a[lb],Date.now()));this.lwc.length&&(lb=
JSON.stringify(this.rAa),M.a.instance.setItem(this.lwc,lb))}h1h(lb=!1){if(!this.g6.length){var qa=lb?M.a.instance.getItem(this.lwc):M.a.instance.getItem(this.kwc);if(!qa||""===qa)return lb?this.rAa:this.g6;let Ga=null;try{Ga=JSON.parse(qa)}catch(Fb){this.IQk(lb),Ga=null}if(!Ga||!Ga.length||10<Ga.length)return lb?this.rAa:this.g6;qa=0;for(const Fb of Ga)if(lb||this.kc.oZd(Fb.Id)&&this.Lzf(Fb.Id))if(lb?Array.insert(this.rAa,qa++,Fb):Array.insert(this.g6,qa++,Fb),qa===this.TVb)break}return lb?this.rAa:
this.g6}n7e(lb){lb=this.E2f(lb);for(const qa of this.g6)if(qa.Id===lb)return!0;return!1}IQk(lb=!1){M.a.instance.setItem(lb?this.lwc:this.kwc,"")}$zm(lb){lb=this.E2f(lb.ControlId);return this.Lzf(lb)?this.n7e(lb):!1}FTn(lb){if(0<this.g6.length){let qa=0;for(const Ga of this.g6){if(Ga.Id===lb){Array.removeAt(this.g6,qa);break}qa++}}}E2f(lb){return"Excel"===this.kc.application&&lb.startsWith("m_excelWebRenderer_ewaCtl_")?lb.substr(26,lb.length):lb}w3m(){this.g6.length===this.TVb&&Array.removeAt(this.g6,
this.g6.length-1)}v3m(){this.rAa.length===this.U4j&&Array.removeAt(this.rAa,this.rAa.length-1)}Ixm(lb){lb=lb.split("|");let qa="";if(6<=lb.length)qa=lb[0];else if(3<=lb.length){if("3"===lb[0])return!0;qa=lb[1]}return qa.startsWith("WA")}static createInstance(lb){let qa=3;N.AFrameworkApplication.K&&(qa=N.AFrameworkApplication.K.pc("TellMeMaxRecommendedResultsToReturn",3));return new I(lb,qa)}}Object(D.a)(I,"MruControlsManager",null,[1262]);class T{constructor(lb){this.kvb=lb}efa(lb,qa){let Ga;return lb.BC&&
(Ga=this.kvb[lb.value])?Ga.efa(lb,qa):(Ga=this.h2h(lb.value))?Ga.efa(Ga.X8m,qa):null}N_l(lb,qa){if(lb=this.kvb[lb])for(const Ga of qa)if(qa=P.a.getParameter(Ga),qa.key===lb.lVf)return qa.value;return null}Gbn(lb){(lb=this.h2h(lb))&&lb.Dbn()}h2h(lb){const qa=lb.indexOf(P.a.FUi);return 0<qa?this.kvb[lb.substring(0,qa)]:null}}Object(D.a)(T,"ParameterizedCommandManager",null,[1261]);var U=c(1513);class W{constructor(lb,qa){this.Eg=lb;this.imb=qa}}Object(D.a)(W,"TellMeQuery",null,[]);var V=c(1619);class Y{constructor(lb,
qa){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=lb;this.TimeElapsedSinceClick=qa}}Object(D.a)(Y,"CommandClickedEvent",null,[]);var da=c(27);class ba{constructor(lb,qa){this.m7j=lb;this.psa=qa}resultsUpdated(lb){this.m7j(da.c(lb.query)?"":lb.query.Eg,lb.ho,lb.attributes,this.psa,lb.dac)}}Object(D.a)(ba,"ResultsUpdatedCallback",null,[1260]);class ja{constructor(lb,qa,Ga,Fb,$b){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;
this.ControlId=lb;this.TimeElapsedSinceClick=Ga;this.CommandSurface=Fb;this.CommandId=qa;this.TerminalParentControlId=$b}}Object(D.a)(ja,"UserActionEvent",null,[]);var sa=c(76);class ta{constructor(lb,qa){this.menuModel=lb;this.resultCount=qa}}Object(D.a)(ta,"GeneratedMenuModel",null,[]);class ra{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(D.a)(ra,"MenuModel",null,[]);class ma{constructor(lb,qa,Ga){this.kc=lb;this.kvb=qa;
this.hea=Ga}ACl(lb,qa,Ga){const {TellMeActor:Fb}=c(1483);let $b=0;const rb=new ra,xb=[];let gb="";rb.sections=[];let Gb=new sa.a;const ac=!!this.kc&&this.kc.H2a;var hc=!!this.kc&&this.kc.Nnb||N.AFrameworkApplication.ta.Ob.Nnb;for(const Uc of lb){lb=0;ac||(Gb=new sa.a);const dd=new sa.a;let fd=Uc.displayName;for(const xc of Uc.results){if(0<=xc.value.indexOf(P.a.Tbg)){if(xc.BC){var Ec=this.kvb[xc.value];if(Ec&&xc.value.endsWith(P.a.Tbg)){if("FindParameterized"!==xc.value&&!hc){const $c=[];$c.push(appChrome.actions.setControlLabel(xc.value,
Ec.HOd(xc)));$c.push(appChrome.actions.setButtonCommandValueId(xc.value,Ec.amf(xc)));appChrome.api.dispatch($c)}Ec=xc.value.replace(P.a.Tbg,"");Gb.remove(Ec)?lb--:dd.add(Ec);Gb.add(xc.value);lb++}}}else switch(xc.type){case 5:dd.contains(xc.value)||(Gb.add(xc.value),lb++);break;case 7:Gb.add(xc.BC);lb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:Gb.add(xc.value),
lb++}13===Uc.groupType&&(fd=P.a.Dga()?0<qa.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,qa):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,qa));21===Uc.groupType&&(fd=CommonUIStrings.l_LearningUILiveText)}$b+=lb;""!==fd&&0<lb&&(gb+=" , "+lb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+fd+" , ");0<Gb.count&&!ac&&(lb=appChrome.api.menuSection(Gb.toArray(),Uc.displayName,null,U.a[Uc.groupType]),xb.push(lb))}hc=
null;0<$b&&(hc=0<qa.length?1!==$b?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,$b,qa):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,qa):1!==$b?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,$b):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,ac?(qa=appChrome.api.menuSection(Gb.toArray(),"",null,null),xb.push(qa)):hc+=gb);Ga&&(this.kc.wva?Fb.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(hc)):
appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(hc)));rb.sections=xb;return new ta(rb,$b,[])}static get Vef(){return ma.hQg||(ma.hQg=new ta(Object.assign(new ra,{sections:[]}),0,[]))}}ma.hQg=null;Object(D.a)(ma,"TellMeMenuDefintionGenerator",null,[]);var Ba;(function(lb){lb[lb.TellMeControlActivated=0]="TellMeControlActivated";lb[lb.TellMeQueryExecuted=1]="TellMeQueryExecuted";lb[lb.TellMeResultsRendered=2]="TellMeResultsRendered";lb[lb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(Ba||
(Ba={}));Object(D.b)("PerformanceMarker",Ba);var Pa;(function(lb){lb[lb.TellMeTimeToRender=0]="TellMeTimeToRender";lb[lb.TellMeSessionLength=1]="TellMeSessionLength";lb[lb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(Pa||(Pa={}));Object(D.b)("PerformanceMeasure",Pa);class Da{mark(lb){window.performance.mark(Ba[lb])}measure(lb,qa,Ga){const {TellMeActor:Fb}=c(1483);try{window.performance.measure(Pa[lb],Ba[qa],Ba[Ga])}catch($b){Fb.instance.Ne.onError("TellMePerformance:Measure","error measuring "+
Pa[lb])}}bIf(lb,qa,Ga){const {TellMeActor:Fb}=c(1483);Fb.instance.Ne.lIf(qa,Ga,lb,this.VVl(lb))}kRk(){var lb=[0,1,2,3];for(const qa of lb)window.performance.clearMarks(Ba[qa])}clearMeasures(lb){for(const qa of lb)window.performance.clearMeasures(Pa[qa])}VVl(lb){let qa=0;(lb=this.hEl(lb))&&0<lb.length&&(qa=lb[lb.length-1].duration);return qa}hEl(lb){return window.performance.getEntriesByName(Pa[lb],"measure")}}Object(D.a)(Da,"TellMePerformance",null,[]);var Ha=c(1550),oa=c(1549),wa=c(34);class ia{constructor(lb){this.efk=
lb}OJb(lb,qa,Ga){const {TellMeActor:Fb}=c(1483);Fb.instance.Ne.R_(qa,oa.a.ufc,lb.data.Ve.toString(),Math.round(window.performance.now()-Ga),oa.a.ufc,!0,Ha.a.XOa);lb=wa.b(lb.data.we);qa=-1;lb.Index&&(qa=lb.Index);Fb.instance.Ne.V_m(qa,this.efk)}zJb(lb,qa,Ga){const {TellMeActor:Fb}=c(1483);Fb.instance.Ne.R_(qa,oa.a.ufc,lb.data.Ve.toString(),Math.round(window.performance.now()-Ga),oa.a.ufc,!1,Ha.a.XOa)}k2l(lb){if(lb&&""!==lb.trim()){const Ga=window.performance.now(),Fb=N.AFrameworkApplication.Rrj;var qa=
{};qa.Text=lb;qa.IsFileHash="false";qa=wa.c(qa);N.AFrameworkApplication.Ke.oj(Fb,2,qa,{"Content-Type":"application/json",Accept:"application/json"},!1,0,$b=>{this.OJb($b,lb.length,Ga)},$b=>{this.zJb($b,lb.length,Ga)},null,null,!1,4E3,6E3)}}}Object(D.a)(ia,"TellMeQueryIndexCallback",null,[]);var ca=c(1485);class pa{constructor(lb,qa,Ga){this.xml=lb;this.resultCount=qa;this.yhl=Ga}}Object(D.a)(pa,"GeneratedMenuXml",null,[]);var Ma=c(1711),ya=c(16);class Oa{constructor(lb,qa){this.Qed=lb||{};this.xWa=
qa}get hMb(){return 5}efa(lb,qa=null){return this.xWa.efa(lb,qa)||this.SFk(lb.value)}SFk(lb){return Oa.z2e(lb,this.Qed[lb]||null)}static z2e(lb,qa=null){lb=String.format('<ClonedControl Id="{0}" ',lb);for(let $b in qa){var Ga=$b,Fb=qa[$b];Fb=Fb?ya.a.Af(Fb.toString()):"";lb+=String.format('{0}="{1}" ',Ga,Fb)}return lb+"/>"}}Object(D.a)(Oa,"CommandMenuItemFactory",null,[1242]);var fa=c(181);class Ca{constructor(){this.hXj=CommonUIStrings.l_FindInDocumentText}get hMb(){return 8}efa(lb){var qa=lb.BC;
lb=ya.a.Af(lb.value);const Ga=ya.a.Af(qa);qa=ya.a.Af(String.format(this.hXj,qa));return this.NBl(lb,Ga,qa)}NBl(lb,qa,Ga){return fa.a(lb,"1540292897",Ga,P.a.hvl,null,qa,Ga,null,null)}}Object(D.a)(Ca,"FindInDocumentMenuItemFactory",null,[1242]);var Ta=c(1712),eb=c(1710),jb=c(1713);class ob{get hMb(){return 7}efa(lb){const qa=Object(x.a)(V.a,lb);return this.JCl(ya.a.Af(lb.value),qa.id)}JCl(lb,qa){return fa.a(qa,"1404166600",lb,null,null,lb,lb,null,null)}}Object(D.a)(ob,"TryQueryMenuItemFactory",null,
[1242]);class Ya{constructor(lb){this.H5=[];this.kc=lb}pOl(lb){for(const qa of this.H5)if(qa.hMb===lb)return qa;return null}ha(lb){this.H5.push(lb)}PNn(lb){this.ha(new Oa(this.kc.SZk,lb));this.ha(new jb.a(this.kc.uan));this.ha(new Ma.a(this.kc.s5n,this.kc.r5n,this.kc.TAo,this.kc.dkm,this.kc.Vko));this.ha(new eb.InsightsMenuItemFactory);this.ha(new Ca);this.ha(new Ta.a);this.ha(new ob)}}Object(D.a)(Ya,"MenuItemFactoryRegistry",null,[]);var Xa=c(1486);class Sa{constructor(lb,qa){this.kc=lb;this.Q2g=
new Ya(this.kc);this.Q2g.PNn(qa)}BCl(lb,qa){let Ga=0;const Fb=[],$b=[];for(const xb of lb){lb=P.a.hfg;var rb=[];for(const gb of xb.results){const Gb=this.Q2g.pOl(gb.type).efa(gb,qa);lb=P.a.hfg;rb.push(Gb);if(13===gb.type||14===gb.type)lb="Menu32";17===gb.type&&(lb="MenuTellMeExtended");gb.groupType=xb.groupType;$b.push(Object(x.a)(Xa.a,gb))}Ga=Ga?Ga:rb.length;rb=fa.d("TellMeDropdownControls",rb);lb=fa.g("TellMeDropdownMenuSection",rb,lb,xb.displayName);Fb.push(lb)}qa=fa.h(Fb,"LookupDropdownMenu");
return new pa(qa,Ga,$b)}static get AId(){return Sa.iQg||(Sa.iQg=new pa(fa.h([],"LookupDropdownMenu"),0,[]))}}Sa.iQg=null;Object(D.a)(Sa,"TellMeXmlGenerator",null,[]);class ab{}ab.M9m="MRU";ab.test="Test";Object(D.a)(ab,"ActionType",null,[]);var Hb=c(1533),pb;(function(lb){lb[lb.Service=0]="Service";lb[lb.Local=1]="Local";lb[lb.MRU=2]="MRU";lb[lb.TestResult=3]="TestResult";lb[lb.Unknown=4]="Unknown"})(pb||(pb={}));Object(D.b)("SubResultType",pb);var Mb=c(72);class Qb{constructor(lb,qa,Ga,Fb,$b=null){this.CommandId=
null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=lb;this.IsEnabled=qa;this.ResultType=K.a[Ga];this.SubResultType=pb[Fb];this.OptionalData=$b?Mb.a.toJSON($b):null}}Object(D.a)(Qb,"ResultInfo",null,[]);var Aa=c(93),bb=c(156),nb=c(250);class Va{constructor(lb,qa=null){this.ckd="TellMeWAC.";this.O8j=lb;this.ggk=qa}YGa(lb,qa,Ga){qa=Aa.a.hC(qa);lb=Aa.a.t$e(lb,this.O8j,this.ggk,Ga,qa);bb.a.YGa(lb,this.ckd)}XGa(lb,qa,Ga=0){qa=Aa.a.hC(qa);bb.a.XGa(Object.assign(new nb.a,
{name:lb,dataFields:qa,durationMs:Ga}),this.ckd)}}Object(D.a)(Va,"TellMeOtelLogger",null,[1277]);var Ab=c(118);class Zb{constructor(lb,qa,Ga,Fb,$b,rb,xb){this.j6=this.F$=this.PLg=null;this.aza=lb;this.mSb=qa;this.xLa=Ga;this.T$a=Fb;this.MVa=$b;this.J2j=rb;this.j6=xb?xb:new Va(this.T$a?m.CuiHelper.Sbg:m.CuiHelper.wje)}get rq(){return this.T$a}get lpa(){return this.xLa}mfe(lb){this.PLg=lb;switch(lb){case ca.a.contextMenu:this.F$=ca.a.contextMenu;break;default:this.F$=ca.a.tellMe}}OCk(lb,qa){this.xLa.xna||
(this.xLa.xna=Ab.a.create().toString(),this.PCi(lb,!0,qa))}PRh(lb,qa=!0){this.xLa.xna&&this.cXm(lb,qa);this.T$a&&appChrome.api.updateTellMeCorrelationId("");this.xLa.xna=null}PCi(lb,qa,Ga){const {TellMeActor:Fb}=c(1483),$b=this.k7(E.a.K1a);$b[Hb.a.culture]=this.mSb;$b[Hb.a.appName]=this.aza;$b[Hb.a.context]=lb;$b[Hb.a.CYd]=this.MVa;$b[Hb.a.rLm]=this.J2j;$b[Hb.a.cKm]=Ga;$b[Hb.a.rEm]=qa;$b[Hb.a.contentType]=Fb.instance.gGd;this.j6.YGa(E.a.K1a,$b,this.PLg);this.T$a&&appChrome.api.updateTellMeCorrelationId(this.xLa.xna)}cXm(lb,
qa){const Ga=this.k7(E.a.KFb);Ga[Hb.a.ykl]=lb;Ga[Hb.a.qEm]=qa;this.j6.XGa(E.a.KFb,Ga)}U_m(lb,qa,Ga){let Fb=0;!Ga&&0<lb.length&&(Fb=lb.trim().split(" ").length);const $b=this.k7(E.a.query);$b[Hb.a.query]="!";$b[Hb.a.cLb]=qa;$b[Hb.a.c_i]=lb.length;$b[Hb.a.vzi]=Ga;$b[Hb.a.s_o]=Fb;this.j6.YGa(E.a.query,$b,this.F$)}OYm(lb,qa,Ga,Fb,$b,rb,xb,gb=null){const Gb=this.k7(E.a.latency);Gb[Hb.a.culture]=this.mSb;Gb[Hb.a.c_i]=lb;Gb[Hb.a.Swj]=qa;Gb[Hb.a.statusCode]=Ga;Gb[Hb.a.service]=$b;Gb[Hb.a.isSuccess]=rb;Gb[Hb.a.CPm]=
xb;gb&&(Gb[Hb.a.vDo]=gb);this.j6.XGa(E.a.latency,Gb,Fb)}lIf(lb,qa,Ga,Fb){const $b=this.k7(E.a.performance);$b[Hb.a.culture]=this.mSb;$b[Hb.a.SCk]=Ba[lb];$b[Hb.a.Rml]=Ba[qa];$b[Hb.a.yvn]=Pa[Ga];this.j6.XGa(E.a.performance,$b,Fb)}e0m(lb,qa){var {TellMeActor:Ga}=c(1483);const {CommandResultsUtility:Fb}=c(1522);if(lb.results.length){var $b=this.k7(E.a.L6i);$b[Hb.a.P7]=qa.toString();$b[Hb.a.groupType]=U.a[lb.groupType];16===lb.groupType&&($b[Hb.a.DJm]=Ga.instance.Z$c);qa=[];Ga=[];var rb=[];for(const xb of lb.results)$b[Hb.a.resultType]||
($b[Hb.a.resultType]=K.a[xb.type]),lb={},27===xb.type&&(lb.AssetId=xb.qI),Ga.push(Fb.jSc(xb.value)),qa.push(xb.value),rb.push(new Qb(xb.value,Fb.jSc(xb.value),xb.type,xb.aqj,lb));0<qa.length&&($b[Hb.a.D0n]="{"+qa.join(", ")+"}",$b[Hb.a.sml]="{"+Ga.join(", ")+"}",$b[Hb.a.z0n]=wa.c(rb));this.j6.YGa(E.a.L6i,$b,this.F$)}}nDl(lb,qa){if(4===lb)return ab.M9m;switch(qa){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return K.a[qa]}zWm(lb,
qa,Ga,Fb,$b){const rb=this.k7(E.a.click);rb[Hb.a.Swj]=lb;rb[Hb.a.utn]=qa;rb[Hb.a.commandId]=Ga;rb[Hb.a.I2]=Fb;rb[Hb.a.actionType]=this.nDl($b.groupType,$b.resultType);rb[Hb.a.resultType]=K.a[$b.resultType];rb[Hb.a.Bdg]=pb[$b.Bdg];rb[Hb.a.groupType]=U.a[$b.groupType];rb[Hb.a.P7]=$b.P7.toString();rb[Hb.a.Zcf]=$b.Zcf.toString();rb[Hb.a.resultIndex]=$b.resultIndex.toString();this.j6.YGa(E.a.click,rb,this.F$)}FWm(lb,qa){this.xLa.xna||(this.xLa.xna=Ab.a.create().toString(),this.PCi("",!1,qa));qa=this.k7(E.a.XEh);
qa[Hb.a.cLb]=lb;this.j6.XGa(E.a.XEh,qa)}kDi(lb,qa,Ga){if(lb){if(Ga)for(let Fb in Ga)lb[Fb]=Ga[Fb];this.j6.XGa(E.a.events,lb,qa)}}AH(lb,qa,Ga=null){const Fb=this.k7(E.a.events);Fb[Hb.a.event]=lb;this.kDi(Fb,Math.round(qa),Ga)}uFa(lb,qa,Ga=null){const Fb=this.k7(E.a.events);Fb[Hb.a.event]=E.a.error;Fb[Hb.a.module]=lb;Fb[Hb.a.errorMessage]=qa;Fb[Hb.a.message]=qa;this.kDi(Fb,Math.round(window.performance.now()),Ga)}xWm(lb){const qa=this.k7(E.a.$Bh);qa[Hb.a.value]=lb;qa[Hb.a.zae]=this.T$a;this.j6.YGa(E.a.$Bh,
qa,this.F$)}PVm(lb){const qa=this.k7(E.a.$ih);qa[Hb.a.value]=lb;qa[Hb.a.zae]=this.T$a;this.j6.YGa(E.a.$ih,qa,this.F$)}DXm(lb){const qa=this.k7(E.a.LVh);qa[Hb.a.value]=lb;qa[Hb.a.zae]=this.T$a;this.j6.YGa(E.a.LVh,qa,this.F$)}S_m(lb){const qa=this.k7(E.a.vZi);qa[Hb.a.value]=lb;qa[Hb.a.zae]=this.T$a;this.j6.YGa(E.a.vZi,qa,this.F$)}dWm(lb){const qa=this.k7(E.a.odj);qa[Hb.a.value]=lb;this.j6.YGa(E.a.odj,qa,this.F$)}W_m(lb,qa){const Ga=this.k7(E.a.YZi);Ga[Hb.a.ufc]=lb;qa&&(Ga[Hb.a.xna]=qa);this.j6.XGa(E.a.YZi,
Ga)}k7(lb){return{["SessionID"]:this.xLa.sessionId,["CorrelationID"]:this.xLa.xna,["Time"]:(new Date).getTime(),["Event"]:lb,["Scenario"]:this.F$}}}Object(D.a)(Zb,"UsageLogger",null,[1259]);var Kb=c(57),dc=c(1660),jc=c(1203),zb=c(1519),cc=c(79),Ub=c(23),Wb=c(230),Qa=c(475),sb=c(15),Jb=c(600),pc=c(62),rc=c(12);c.d(L,"TellMeActor",function(){return db});class db{constructor(){this.xWa=this.U1=this.Vb=this.Na=this.cP=this.qz=this.Gb=this.ga=this.Ne=this.aK=this.XHe=this.pih=this.pka=this.kc=null;this.jVb=
!1;this.Nte=[];this.LLg=[];this.Zgh=[];this.E3g=[];this.F3g=[];this.yZg=!1;this.dSb=this.hea=null;this.juc=this.MVa=!1;this.Fnd=!0;this.oZ=this.itc=this.UTg=this.nIe=this.q3g=null;this.zY=[];this.m9a=this.GSb=this.Cza=this.Jqd=this.Nch=null;this.AUb=!1;this.gIe=0;this.DRb=null;this.psa=-1;this.S2g=0;this.suc=!1;this.N9a=null;this.Ugh=!1;this.FRb=this.Dp=null}get gGd(){return this.cP?this.cP.contentType:db.unknown}get actions(){return this.zY}set actions(lb){this.zY=lb}VQd(){return this.Ne?this.Ne.lpa.xna:
null}bO(){return this.kc}get B8m(){return this.Fnd}get qWo(){return this.q3g}performance(){return this.aK}get Kbg(){return this.Nch}set Kbg(lb){this.Nch=lb}get Z$c(){return this.Ugh}set Z$c(lb){this.Ugh=lb}CG(lb){const qa=window.performance.now();this.hea&&!da.c(lb)&&(this.hea(lb),this.Ne.pA(E.a.CG,window.performance.now()-qa))}initialize(lb,qa=null,Ga=null,Fb=null,$b=null,rb=null,xb=null,gb=null,Gb=null,ac=null,hc=null){const {InteractionLogger:Ec}=c(1933),{GroupsPlacementInfo:Uc}=c(1929),{AggregatorResultsProvider:dd}=
c(1738);this.kc=lb;this.MVa=!!N.AFrameworkApplication.ta&&N.AFrameworkApplication.ta.Ob.tac;this.Ne=Fb;if(!Fb){Fb=new v;Fb.sessionId=N.AFrameworkApplication.userSessionId;const fd=Jb.a.lg(N.AFrameworkApplication.lcid)||Jb.a.ORc;this.Ne=new Ec(new Zb(this.kc.application,fd.name,Fb,this.kc.rq,this.MVa,lb.fTa,null),this.kc.ZZk,this.kc)}this.xWa=new T(this.kc.parameterData);this.pih=Ga||new Sa(this.kc,this.xWa);this.hea=xb;this.XHe=this.XHe||new ma(this.kc,this.kc.parameterData,xb);this.Vb=Kb.FocusManager.instance();
this.U1=I.createInstance(this.kc);this.UTg=new Uc(lb);this.ga=$b||N.AFrameworkApplication.xa;this.Gb=rb||N.AFrameworkApplication.oc;this.qz=Gb;this.pka=qa;this.Dp=hc;this.aK=new Da;this.FRb=new l.a(e.a.Xh());this.Jqd=[];Gb?Gb.execute(fd=>{fd.isFeatureEnabled(db.IAo,!0).then(xc=>{const {AggregatorResultsProvider:$c}=c(1738);this.suc=xc;this.pka=this.pka||$c.createInstance(this.U1,this.kc,this.xWa,this.suc);for(const Bc of this.Jqd)this.pka.lE(Bc.provider,Bc.U6a);this.Jqd=[];return null})}):(this.suc=
!0,this.pka=this.pka||dd.createInstance(this.U1,this.kc,this.xWa,this.suc));this.Na=gb;this.Cza=Sa.AId;this.q3g=new Promise(fd=>{this.nIe=fd});ac&&ac.execute(fd=>{this.cP=fd});this.kc.rq&&P.a.Ywi()&&(lb=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.kc.application),appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(lb,lb)))}Ub(){this.zok()}jPn(lb){this.itc=lb}zok(){this.ga.gb(rc.a.tellMe,pc.a.frame,Object(a.a)(this,this.tellMe,"tellMe"),96);this.ga.gb(rc.a.gfg,pc.a.frame,
Object(a.a)(this,this.Mvh,"cacheAsyncMenuRefreshFunction"),96);this.ga.gb(rc.a.lfg,pc.a.frame,Object(a.a)(this,this.CDi,"logItemExecuted"),96);this.ga.gb(rc.a.ofg,pc.a.frame,Object(a.a)(this,this.ZCi,"logControlDeactivation"),96);this.ga.gb(rc.a.nfg,pc.a.frame,Object(a.a)(this,this.yDi,"logInputFocus"),96);this.ga.gb(rc.a.jfg,pc.a.frame,Object(a.a)(this,this.K1a,"interactionBegin"),96);this.ga.gb(rc.a.qfg,pc.a.frame,Object(a.a)(this,this.K1a,"interactionBegin"),96);this.ga.gb(rc.a.mfg,pc.a.frame,
Object(a.a)(this,this.xDi,"logInputBlur"),96);this.ga.gb(rc.a.pfg,pc.a.frame,Object(a.a)(this,this.YCi,"logControlActivated"),96);this.ga.gb(rc.a.x8c,pc.a.frame,Object(a.a)(this,this.SXh,"focusSearchBox"),96);this.ga.gb(rc.a.ffg,pc.a.frame,Object(a.a)(this,this.UDh,"constructLiveNotificationForMenu"),96);this.ga.gb(rc.a.rfg,pc.a.frame,Object(a.a)(this,this.qyf,"insertTryQuery"),96);this.ga.gb(rc.a.IGf,pc.a.frame,Object(a.a)(this,this.qyf,"insertTryQuery"),96);this.ga.gb(rc.a.vhf,pc.a.frame,Object(a.a)(this,
this.bRa,"openOrInsertUrl"),96);this.ga.gb(rc.a.whf,pc.a.frame,Object(a.a)(this,this.bRa,"openOrInsertUrl"),96);this.ga.gb(rc.a.xhf,pc.a.frame,Object(a.a)(this,this.bRa,"openOrInsertUrl"),96);this.ga.gb(rc.a.yhf,pc.a.frame,Object(a.a)(this,this.bRa,"openOrInsertUrl"),96);this.ga.gb(rc.a.zhf,pc.a.frame,Object(a.a)(this,this.bRa,"openOrInsertUrl"),96);this.ga.gb(rc.a.NTf,pc.a.frame,Object(a.a)(this,this.bRa,"openOrInsertUrl"),96);this.ga.gb(rc.a.OTf,pc.a.frame,Object(a.a)(this,this.bRa,"openOrInsertUrl"),
96);this.ga.gb(rc.a.PTf,pc.a.frame,Object(a.a)(this,this.bRa,"openOrInsertUrl"),96);this.ga.gb(rc.a.UVf,pc.a.frame,Object(a.a)(this,this.G1a,"insertMention"),96);this.ga.gb(rc.a.VVf,pc.a.frame,Object(a.a)(this,this.G1a,"insertMention"),96);this.ga.gb(rc.a.WVf,pc.a.frame,Object(a.a)(this,this.G1a,"insertMention"),96);this.ga.gb(rc.a.ifg,pc.a.frame,Object(a.a)(this,this.vSi,"openFeedback"),96);this.ga.gb(rc.a.sfg,pc.a.frame,Object(a.a)(this,this.bRa,"openOrInsertUrl"),96);this.ga.gb(rc.a.KYe,pc.a.frame,
Object(a.a)(this,this.YZd,"launchAddin"),96);this.ga.gb(rc.a.LYe,pc.a.frame,Object(a.a)(this,this.YZd,"launchAddin"),96);this.ga.gb(rc.a.MYe,pc.a.frame,Object(a.a)(this,this.YZd,"launchAddin"),96);this.ga.gb(rc.a.ZNb,pc.a.frame,Object(a.a)(this,this.ZNb,"showTellMeCoachmark"),96);this.ga.gb(rc.a.cGf,pc.a.frame,Object(a.a)(this,this.IAi,"launchAddinStore"),96);this.ga.gb(rc.a.y_f,pc.a.frame,Object(a.a)(this,this.z_i,"quickActionOnFileHandler"),96);this.ga.gb(rc.a.rkf,pc.a.frame,Object(a.a)(this,this.g_h,
"generateSlidesFromFiles"),96)}hNn(lb){this.Fnd=!1;const qa=window.performance.now();lb.f3a.isCompleted?(this.Fnd=!0,this.nIe(!0)):lb.tZ(()=>{this.Fnd=!0;this.nIe(!0);this.Ne.pA(E.a.edl,window.performance.now()-qa)});this.UNn(lb)}UNn(lb){Qa.a.i2c(Object(a.a)(this,this.BHd,"dispatcher"));Qa.a.EJc([new Wb.a(rc.a.tellMe,pc.a.frame,96),new Wb.a(rc.a.gfg,pc.a.frame,96),new Wb.a(rc.a.lfg,pc.a.frame,96),new Wb.a(rc.a.ofg,pc.a.frame,96),new Wb.a(rc.a.nfg,pc.a.frame,96),new Wb.a(rc.a.jfg,pc.a.frame,96),new Wb.a(rc.a.qfg,
pc.a.frame,96),new Wb.a(rc.a.mfg,pc.a.frame,96),new Wb.a(rc.a.pfg,pc.a.frame,96),new Wb.a(rc.a.x8c,pc.a.frame,96),new Wb.a(rc.a.ffg,pc.a.frame,96),new Wb.a(rc.a.rfg,pc.a.frame,96),new Wb.a(rc.a.IGf,pc.a.frame,96),new Wb.a(rc.a.vhf,pc.a.frame,96),new Wb.a(rc.a.whf,pc.a.frame,96),new Wb.a(rc.a.xhf,pc.a.frame,96),new Wb.a(rc.a.yhf,pc.a.frame,96),new Wb.a(rc.a.zhf,pc.a.frame,96),new Wb.a(rc.a.NTf,pc.a.frame,96),new Wb.a(rc.a.OTf,pc.a.frame,96),new Wb.a(rc.a.PTf,pc.a.frame,96),new Wb.a(rc.a.UVf,pc.a.frame,
96),new Wb.a(rc.a.VVf,pc.a.frame,96),new Wb.a(rc.a.WVf,pc.a.frame,96),new Wb.a(rc.a.ifg,pc.a.frame,96),new Wb.a(rc.a.sfg,pc.a.frame,96),new Wb.a(rc.a.KYe,pc.a.frame,96),new Wb.a(rc.a.LYe,pc.a.frame,96),new Wb.a(rc.a.MYe,pc.a.frame,96),new Wb.a(rc.a.ZNb,pc.a.frame,96),new Wb.a(rc.a.cGf,pc.a.frame,96),new Wb.a(rc.a.y_f,pc.a.frame,96),new Wb.a(rc.a.rkf,pc.a.frame,96)],lb)}BHd(lb,qa,Ga,Fb,$b){if(qa.contextId===pc.a.frame)switch(lb){case rc.a.tellMe:return this.tellMe(lb,qa,Ga,Fb,$b);case rc.a.gfg:return this.Mvh(lb,
qa,Ga,Fb,$b);case rc.a.lfg:return this.CDi(lb,qa,Ga,Fb,$b);case rc.a.ofg:return this.ZCi(lb,qa,Ga,Fb,$b);case rc.a.nfg:return this.yDi(lb,qa,Ga,Fb,$b);case rc.a.jfg:return this.K1a(lb,qa,Ga,Fb,$b);case rc.a.qfg:return this.l0n(Ga);case rc.a.mfg:return this.xDi(lb,qa,Ga,Fb,$b);case rc.a.pfg:return this.YCi(lb,qa,Ga,Fb,$b);case rc.a.x8c:return this.SXh(lb,qa,Ga,Fb,$b);case rc.a.ffg:return this.UDh(lb,qa,Ga,Fb,$b);case rc.a.rfg:case rc.a.IGf:return this.qyf(lb,qa,Ga,Fb,$b);case rc.a.vhf:case rc.a.whf:case rc.a.xhf:case rc.a.yhf:case rc.a.zhf:case rc.a.NTf:case rc.a.OTf:case rc.a.PTf:case rc.a.sfg:return this.bRa(lb,
qa,Ga,Fb,$b);case rc.a.UVf:case rc.a.VVf:case rc.a.WVf:return this.G1a(lb,qa,Ga,Fb,$b);case rc.a.ifg:return this.vSi(lb,qa,Ga,Fb,$b);case rc.a.KYe:case rc.a.LYe:case rc.a.MYe:return this.YZd(lb,qa,Ga,Fb,$b);case rc.a.ZNb:return this.ZNb(lb,qa,Ga,Fb,$b);case rc.a.cGf:return this.IAi(lb,qa,Ga,Fb,$b);case rc.a.y_f:return this.z_i(lb,qa,Ga,Fb,$b);case rc.a.rkf:return this.g_h(lb,qa,Ga,Fb,$b)}return 2}SXh(lb,qa,Ga){if(1===Ga)return 32;this.ahj();lb=!1;(this.kc.fTa||this.MVa)&&(qa=document.getElementById("SearchButton"))&&
qa.click();if(!this.kc.fTa&&this.MVa)for(qa=document.getElementsByClassName("ms-suiteux-search-box"),Ga=0;Ga<qa.length;Ga++){const Fb=qa[Ga].querySelector("input[type=search]");Fb&&(lb=Kb.FocusManager.zJ(Fb))}else lb=Kb.FocusManager.zJ($get(this.kc.rq?m.CuiHelper.Sbg:m.CuiHelper.wje));this.juc=!0;return lb?32:8}qyf(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;if(da.c($b))return this.Ne.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.ahj();lb=$b.CommandValueId;qa=this.kc.rq?m.CuiHelper.Sbg:
m.CuiHelper.wje;this.kc.rq&&!da.c($b[jc.a.CSa])&&($b[jc.a.CSa]=!1);if(lb){if(this.kc.rq)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(lb)),this.N9a=[19],32;if($b=$get(qa))$b.value=lb}return Kb.FocusManager.zJ($get(qa))?32:8}ahj(){this.Vb.TK(this.kc.fTa||this.MVa?this.kc.JEb:this.kc.l5a,!1)}eDl(lb,qa){switch(lb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,qa);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,
qa);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,qa);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,qa)}return qa}UDh(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;if(da.c($b))return this.Ne.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;lb=this.Cza?this.Cza.resultCount:0;$b.Value=1!==lb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,lb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;
if(this.Cza)for(const rb of this.Cza.yhl)$b=Object(k.a)(V.a,rb)?rb.id:ya.a.replaceAll(rb.value,'"',""),($b=$get($b+"-"+P.a.hfg))&&Ub.a.Uq($b,Ub.a.Bea,ya.a.Af(this.eDl(rb.groupType,$b.innerText)));return 32}Mvh(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;if(da.c($b))return this.Ne.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.DRb=new cc.a(2,1,0,()=>{$b[dc.a.Callback]()},97);this.Cza&&this.Gb.Wb(this.DRb);return 32}CDi(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;if(da.c($b))return this.Ne.onError("TellMeActor:LogItemExecuted",
"actiondata comes null"),16;$b.CloseAllMenus&&(lb=void 0===$b.ParentControlId||null===$b.ParentControlId?"<NA>":$b.ParentControlId,qa=this.dSb?this.dSb[$b.ControlId]:null,!qa&&this.dSb&&"<NA>"!==lb&&(qa=this.dSb[lb]),qa||(qa=this.jVb&&this.U1.$zm($b),qa=this.Ael(qa,$b.ControlId),qa=new u(qa,32,4,-1,-1,-1),this.Ne.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+$b.ControlId+" determined group:"+U.a[qa.groupType])),this.Ne.Ifn($b.ControlId,lb,$b.CommandId,$b.CloseAllMenus,qa),this.xWa.Gbn($b.ControlId),
$b.Location!==ca.a.contextMenu&&(this.U1.fYa($b),this.U1.lE(qa.resultType),this.kc.kge&&this.pka.lmk($b.CommandId)));return 32}ZCi(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;H.a.tLm()&&(new ia(this.VQd())).k2l(this.GSb);lb=this.GSb;qa=this.psa;Ga=this.Ne.rfd;if(da.c($b))return this.Ne.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;$b=$b.UILocation;lb&&0<lb.length&&this.suc&&P.a.O$f(this.kc)&&this.kc.$Yd&&19!==$b&&qa>Ga&&!this.kc.QO&&(this.Ne.oIf(lb),this.Ne.g8f(qa));this.Ne.a_n();
this.kc.Ame&&19!==$b&&(this.aK.mark(3),this.aK.measure(1,0,3),this.aK.measure(2,2,3),this.aK.bIf(0,1,2),this.aK.bIf(2,2,3),this.aK.bIf(1,0,3),this.aK.kRk(),this.aK.clearMeasures([0,2,1]));this.Ne.pgn(window.performance.now()-this.gIe);this.kc.rq&&(this.m9a=null,this.Ne.Twa());this.juc=this.AUb=!1;this.GSb="";return 32}yDi(lb,qa,Ga){if(1===Ga)return 32;this.Ne.dlb(z(qa),this.juc);return 32}xDi(lb,qa,Ga){if(1===Ga)return 32;this.Ne.Twa();this.AUb=!1;return 32}YCi(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;
this.oZ=null;$b&&(this.oZ=$b);this.kc.Ame&&(da.c(this.oZ)||this.oZ.Location!==ca.a.contextMenu)&&this.aK.mark(0);this.Ne.mfe(da.c(this.oZ)||da.c(this.oZ.Location)?ca.a.unknown:this.oZ.Location);this.Ne.ogn(this.S2g,this.juc);this.AUb||this.X3a();return 32}uHh(lb,qa){const Ga=[],Fb=Date.now();for(let $b of lb)lb=(Fb-$b.timeStamp)/1E3,lb=P.a.Ike(lb),Array.add(Ga,new Y(qa?$b.commandId:$b.controlId,lb));return Ga}a9k(lb){const qa=[],Ga=Date.now();for(let Fb of lb)if(Fb.controlId||"keyboardShortcut"===
Fb.commandSurface)lb=(Ga-Fb.timeStamp)/1E3,lb=P.a.Ike(lb),Array.add(qa,new ja(Fb.controlId,Fb.commandId,lb,Fb.commandSurface,Fb.Bje));return qa}cIh(lb=!1){var qa=lb?this.U1.e2l():this.U1.zMc();lb=[];const Ga=Date.now();for(const Fb of qa)qa=(Ga-Fb.TimeStamp)/1E3,qa=P.a.Ike(qa),Array.add(lb,new Y(Fb.Id,qa));return lb}X3a(){if(!this.AUb){this.jVb=this.AUb=!0;""!==this.kc.u6f&&N.AFrameworkApplication.An(this.kc.u6f);if(!this.yZg){this.yZg=!0;const lb={};lb.IsMLREnabled=this.kc.SFm;lb.IsReactRibbonEnabled=
this.kc.rq;lb.IsSharedHeaderEnabled=!!N.AFrameworkApplication.ta&&N.AFrameworkApplication.ta.Ob.ZI;lb.IsSearchUxEnabled=this.MVa;lb.IsTellMeInHeaderEnabled=this.kc.fTa;lb.IsGoLocalEnv=P.a.oti();lb.IsSovereignEnvironment=P.a.SGb();lb.IsTellMeServiceResultsEnabled=P.a.O$f(this.kc);lb.IsSubstrateProviderEnabled=P.a.N$f(this.kc);lb.ShouldFetchTokens=!!N.AFrameworkApplication.ta&&N.AFrameworkApplication.ta.Ob.FNb;lb.IsSerpletEnabled=P.a.Dga();lb.FirstOnClickTimeInMS=Math.round(window.performance.now());
lb.IsHeaderHidden=N.AFrameworkApplication.hideHeader||N.AFrameworkApplication.tX;lb.IsSearchInHeaderHidden=N.AFrameworkApplication.UPc;void 0!==window.performance.timing&&null!==window.performance.timing&&(lb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));lb.IsFindWithMatchesEnabled=this.kc.HKd;lb.HelpShowsTopSearchResult=this.kc.v6c;lb.HelpShowsNumberOfMatches=this.kc.u6c;N.AFrameworkApplication.K&&(lb.UiHost=N.AFrameworkApplication.K.kb("UiHostIntegrationType"));
this.Ne.A0m(JSON.stringify(lb))}this.Nte=this.uHh(y.a.instance.qMc(),!1);this.LLg=this.uHh(y.a.instance.hgb(),!0);this.Zgh=this.a9k(y.a.instance.hgb());this.E3g=this.cIh();this.F3g=this.cIh(!0);this.Ne.X3a()}}K1a(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;if(da.c($b))return this.Ne.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(sb.a.dTc)return 32;this.gIe=window.performance.now();this.X3a();lb=new ba(Object(a.a)(this,this.Wwa,"onRequestCompleted"),0);this.psa++;this.Ne.beginQuery("",
this.psa,this.jVb);this.Tig(!0,null);this.Cza=Sa.AId;this.m9a=ma.Vef;if(this.pka)db.instance.actions=[],this.pka.xH(new W("",this.psa),lb,this.kc.rq);else this.Ne.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.DRb&&this.Gb.Wb(this.DRb);return 32}l0n(lb){if(1===lb)return 32;this.Vb.cR(this.kc.fTa||this.MVa?this.kc.JEb:this.kc.l5a,!1);return 32}tellMe(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;if(da.c($b))return this.Ne.onError("TellMeActor:TellMe","actiondata comes null"),
16;this.oZ=$b;this.Ne.mfe(da.c(this.oZ.Location)?ca.a.unknown:this.oZ.Location);lb=this.oZ.Value;this.kc.rq||lb&&""!==lb.trim()?(!this.m9a&&this.kc.rq&&(this.Ne.dlb(z(qa),this.juc),this.X3a()),this.vql(lb,this.oZ.Location),this.oZ.PopulationXML=this.Cza.xml):this.jVb?this.oZ.PopulationXML=this.Cza.xml:(this.oZ.PopulationXML=Sa.AId.xml,this.m9a=ma.Vef,this.GSb="");return 32}vql(lb,qa){this.gIe=window.performance.now();this.kc.Ame&&qa!==ca.a.contextMenu&&this.aK.mark(1);this.kc.rq&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(lb));
lb&&0<lb.trim().length&&(this.jVb=!1);this.kc.Sol();qa=da.c(qa)?ca.a.tellMe:qa;if(lb!==this.GSb||this.kc.rq){this.psa++;this.Ne.beginQuery(lb,this.psa,this.jVb);this.Tig(!0,null);const Ga=new W(lb,this.psa),Fb=new ba(Object(a.a)(this,this.Wwa,"onRequestCompleted"),this.psa);this.Cza=Sa.AId;this.m9a=ma.Vef;if(this.pka)db.instance.actions=[],this.pka.xH(Ga,Fb,this.kc.rq,qa,this.N9a),this.N9a=null;else this.Ne.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.S2g=
this.psa;this.GSb=lb}}POo(lb){if(this.kc.rq){var qa=appChrome.selectors.getActiveControlStates();if(qa=Object(x.a)(Object,qa[lb.value])){lb.label=qa.label;let Ga=null;"description"in qa&&(Ga=qa.description);Ga&&Object.getType(Ga)===String?lb.description=Ga:"secondaryText"in qa?lb.description=qa.secondaryText:"fullDescriptionLabel"in qa&&(lb.description=qa.fullDescriptionLabel)}}}exn(lb){this.dSb={};let qa=0,Ga=0;for(const Fb of lb){lb=0;for(const $b of Fb.results)this.dSb[$b.value]=new u($b.groupType,
$b.type,$b.aqj,qa,lb,Ga),lb++,Ga++,$b.label||5!==$b.type||this.POo($b);0<lb&&qa++}}eec(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;if(da.c($b))return this.Ne.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(lb=$b.CommandValueId)&&window.open(lb,"_blank");return 32}WAi(lb){const qa={};qa.token=this.Kbg;qa.files=wa.c(lb);qa.type="MultiFilesDeckGeneration";if(N.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.ga.Rb(rc.a.XPm,2,qa),
!0;lb=P.a.yci("",P.a.Y8i("GenerateDeckFromFile"),Object.assign(new zb.a,{landingTab:"All",data:qa}));lb=this.ga.Rb(rc.a.Z7,2,lb);return 32!==lb?(this.Ne.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+lb+"."),!1):!0}z_i(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;if(da.c($b))return this.Ne.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Vb.Sif();if(lb=$b.TerminalParentControlId){lb=this.FRb.J(lb);if(!lb)return 16;qa=[];Array.add(qa,
lb);if(!this.WAi(qa))return 8}return 32}g_h(){if(!this.FRb.count)return 16;const lb=[];for(let qa of this.FRb.values)Array.add(lb,qa);return this.WAi(lb)?32:8}G1a(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;if(da.c($b))return this.Ne.onError("TellMeActor:InsertMention","actiondata comes null"),16;lb=$b.UILocation;let rb;$b=$b.CommandValueId;try{rb=wa.a($b)}catch(xb){return this.Ne.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return da.c(rb)?(this.Ne.onError("TellMeActor:InsertMention",
"insertMentionParameters comes null"),16):da.c(this.itc)?(this.Ne.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==lb?(this.Ne.onError("TellMeActor:InsertMention","location "+lb+" is unexpected"),16):this.itc.G1a(rb.displayName,rb.email,rb.userId)?32:(this.Ne.onError("TellMeActor:InsertMention","mention is not inserted"),16)}bRa(lb,qa,Ga,Fb,$b){return 1===Ga?32:da.c($b)?(this.Ne.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===$b.UILocation?
this.Vum(Ga,$b):this.eec(lb,qa,Ga,Fb,$b)}vSi(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;if(da.c($b))return this.Ne.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.Dp&&window.setTimeout(()=>{this.Dp.execute(rb=>{rb.c6a("TellMeSurvey",null)})},db.Asl);return 32}Vum(lb,qa){if(1===lb)return 32;if(da.c(qa))return this.Ne.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(da.c(this.itc))return this.Ne.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;lb=qa.CommandValueId;
return da.c(lb)?(this.Ne.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.itc.insertHtmlText(lb)?32:(this.Ne.onError("TellMeActor:InsertUrl","url is not inserted"),16)}Wwa(lb,qa,Ga,Fb,$b){Ga=window.performance.now();this.exn(qa);this.Ne.Fco(qa);this.kc.rq?(this.m9a=this.XHe.ACl(qa,lb,$b),this.kc.wva?(this.zY.push(appChrome.actions.updateTellMeSearchResults(this.m9a.menuModel,lb,$b)),appChrome.api.dispatch(this.zY)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.m9a.menuModel,
lb,$b)),this.kc.Ame&&this.AUb&&(da.c(this.oZ)||this.oZ.Location!==ca.a.contextMenu)&&(this.aK.mark(2),this.aK.measure(0,1,2))):this.Cza=this.pih.BCl(qa,this.Ne.lpa);this.DRb&&this.Gb.Wb(this.DRb);$b={};$b.GroupsCount=qa.length;$b.QueryID=Fb;$b.QueryLength=lb.length;this.Ne.pA(E.a.Y6k,window.performance.now()-Ga,$b)}Ael(lb,qa){return qa.startsWith(this.kc.rq?P.a.Hhg:P.a.Yke)?5:lb?4:"bSearchHelp"===qa||qa.startsWith("GetHelpFromTellMe")?8:"bInsights"===qa||qa.startsWith("SmartLookupFromTellMe")?13:
"ActionAIFromTellMe"===qa?24:qa===this.kc.Phf?2:0}lE(lb,qa){this.pka?this.pka.lE(lb,qa):Array.add(this.Jqd,new F(lb,qa))}IAi(lb,qa,Ga,Fb,$b){if(1===Ga)return 32;if(da.c($b))return this.Ne.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){lb={};lb.SourceControlId=$b.SourceControlId;lb.Query=$b.CommandValueId;$b=this.ga.Rb(rc.a.FVc,2,lb);if(32!==$b)this.Ne.onError("TellMeActor:LaunchAddinStore",
"CommonCommands.LaunchAppforOfficeDialog failed. Response: "+$b+".");return $b}return this.ga.Rb(rc.a.FVc,2,$b)}YZd(lb,qa,Ga,Fb,$b){({AddinResultsProvider:lb}=c(1635));if(1===Ga)return 32;if(da.c($b))return this.Ne.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;Ga=$b.CommandValueId;if(da.b(Ga))return this.Ne.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!lb.qyb[Ga])return this.Ne.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Ga+" doesn't not exist in entitlements"),
16;$b=c(1635).AddinResultsProvider.qyb[Ga];lb={};lb.solutionId=$b.id;lb.version=$b.appVersion;lb.storeType=$b.storeType;lb.storeId=$b.storeId;lb.assetId=$b.assetId;lb.assetStoreId=$b.assetStoreId;lb.displayName=$b.displayName;lb.targetType=$b.targetType;lb.height=$b.height;lb.width=$b.width;$b=this.ga.Rb(rc.a.dyf,2,lb);if(32!==$b)this.Ne.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+$b+". AssetId: "+Ga);return $b}ZNb(){if(!da.c(this.Dp))for(let lb of y.a.instance.hgb()){if("ShowContextMenuWithFloatie"===
lb.commandId)return this.Dp.execute(qa=>{qa.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(lb.commandId&&-1===lb.commandId.indexOf("Tab"))break}return 8}Tig(lb,qa="",Ga=null){lb?this.FRb=new l.a(e.a.Xh()):qa&&Ga&&this.FRb.add(qa,Ga)}static get instance(){return db._instance||(db._instance=new db)}}db._instance=null;db.IAo="mso_tellMeService";db.unknown="Unknown";db.Asl=500;Object(D.a)(db,"TellMeActor",null,[])},1484:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(1498);
class e{constructor(a,k){this.U$a=!1;const {Annotations:x}=c(1479);if(!a)throw Error.argumentNull("annotations");if(!a.IEf(k))throw Error.argument("memberTypeID","Invalid type ID");if(x.NH(k))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Yv=a;this.c5j=k;this.ap=[]}get L_b(){return this.Yv}get isReadOnly(){return this.U$a}get L3(){return this.c5j}get items(){return this.ap}Vca(){const {Annotations:a}=c(1479);let k="[";for(let x=0,y=this.items.length;x<y;++x){0<x&&(k+=
", ");const m=this.Yv.Vca(this.L3,this.items[x]);this.L3===a.y9?(k+='"',k+=l.a.hgf(m),k+='"'):k+=m}return k+"]"}isEqual(a){const {Annotations:k}=c(1479);if(this===a)return!0;if(!a||a.L_b!==this.Yv||a.L3!==this.L3||a.items.length!==this.items.length)return!1;for(let x=0;x<this.items.length;++x)if(!k.wpb(this.L3,this.items[x],a.items[x]))return!1;return!0}clone(){const a=new e(this.Yv,this.L3);Array.addRange(a.items,this.items);return a}NS(){return this.isReadOnly?this.clone():this}DHf(){const {Annotations:a}=
c(1479);if(!this.isReadOnly){this.U$a=!0;for(const k of this.items)a.bIb(k)}}toString(){return this.Vca()}}Object(D.a)(e,"ListValue",null,[1343,1342])},1485:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.tellMe="TellMe";l.contextMenu="ContextMenu";l.unknown="Unknown";Object(D.a)(l,"TellMeScenario",null,[])},1486:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a,k=null,x=null,y=4,m=-99999,u=0){this.qI="";this.Pyd=-1;this.value=e;this.type=a;this.aqj=
y;this.label=this.BC=k;this.groupType=30;this.description=x;this.score=m;this.count=u}}Object(D.a)(l,"ResultBinding",null,[])},1489:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e){this.attributes=null;this.query=e;this.ho=[]}Lu(e){this.ho.push(e)}Y4i(e){const a=[];for(const k of this.ho)k.groupType!==e&&a.push(k);this.ho.length!==a.length&&(this.ho=a)}get dac(){return!1}}Object(D.a)(l,"SimpleResultsUpdatedEventArgs",null,[1229])},1490:function(D,L,c){c.d(L,"a",function(){return l});
D=c(0);class l{constructor(e=30,a=""){this.CL=[];this.groupType=e;this.displayName=a}get results(){return this.CL}ww(e){e.groupType=this.groupType;Array.add(this.results,e)}r2f(e=1){if(this.results.length>=e)for(let a=0;a<e;a++)Array.removeAt(this.results,this.results.length-1)}}Object(D.a)(l,"SimpleResultGroup",null,[1230])},1498:function(D,L,c){D=c(0);class l{constructor(a,k){this.cdb=a;this.value=k}}Object(D.a)(l,"AttrValuePair",null,[]);c.d(L,"a",function(){return e});class e{constructor(a){this.U$a=
!1;if(!a)throw Error.argumentNull("annotations");this.Yv=a;this.aY=[]}get L_b(){return this.Yv}get isReadOnly(){return this.U$a}get Auf(){return 0<this.aY.length}yq(a){if(!this.Yv.Kac(a))throw Error.argument("attributeID","Invalid attribute ID");for(const k of this.aY)if(a===k.cdb)return a=k.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}ry(a,k){var {Annotations:x}=c(1479);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Yv.Kac(a))throw Error.argument("attributeID",
"Invalid attribute ID");if(!this.Yv.H$b(this.Yv.getAttributeType(a),k))throw Error.argument("value","Value is not of the correct type for the specified attribute");x.bIb(k);for(x=0;x<this.aY.length;++x){const y=this.aY[x];if(a===y.cdb){y.value=k;return}}Array.add(this.aY,new l(a,k))}NRa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Yv.Kac(a))throw Error.argument("attributeID","Invalid attribute ID");for(let k=0;k<this.aY.length;++k)if(a===
this.aY[k].cdb){Array.removeAt(this.aY,k);break}}BLd(a){if(!a)throw Error.argumentNull("action");for(const k of this.aY)a(k.cdb,k.value)}clone(){const a=new e(this.Yv);a.vZa(this);return a}vZa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.L_b!==this.Yv)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.aY);a.BLd((k,x)=>{this.ry(k,x)})}Vca(){const {Annotations:a}=
c(1479);let k="[",x=!0;for(const y of this.aY){x?x=!1:k+=", ";k+=this.Yv.r0h(y.cdb);k+="=";const m=this.Yv.getAttributeType(y.cdb),u=this.Yv.Vca(m,y.value);m===a.y9?(k+='"',k+=e.hgf(u),k+='"'):k+=u}return k+"]"}isEqual(a){const {Annotations:k}=c(1479);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.Yv!==a.L_b||this.Auf!==a.Auf)return!1;let x=0,y=null,m=!1;a.BLd((u,z)=>{++x;if(!m){var v=-1;for(let E=0,F=this.aY.length;E<F;++E)if(this.aY[E].cdb===u){v=E;break}0>v?m=!0:(y||(y=
Array(this.aY.length)),y[v]=z)}});if(this.aY.length!==x||m)return!1;for(let u=0,z=this.aY.length;u<z;++u)if(!k.wpb(this.Yv.getAttributeType(this.aY[u].cdb),this.aY[u].value,y[u]))return!1;return!0}NS(){return this.isReadOnly?this.clone():this}DHf(){const {Annotations:a}=c(1479);if(!this.isReadOnly){this.U$a=!0;for(const k of this.aY)a.bIb(k.value)}}toString(){return this.Vca()}static hgf(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(D.a)(e,"FeatureBundle",
null,[1341,1342])},1503:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.click="Click";l.K1a="InteractionBegin";l.KFb="InteractionEnd";l.XEh="ControlActivated";l.query="Query";l.YZi="QueryIndexRecorded";l.$Bh="Clicks";l.$ih="ActionEvents";l.LVh="FilteredActionEvents";l.odj="SessionContext";l.latency="Latency";l.performance="Performance";l.L6i="RenderedResults";l.events="Events";l.Y6k="CreateResultsMenu";l.CG="UpdateRibbonControls";l.C0n="ResultsAggregation";l.xH="IssueQuery";l.JUk=
"CommandSuggestions";l.error="Error";l.rHf="LoadModelData";l.edl="DepsResolveTime";l.C8m="ModelDataWaitTime";l.timedOut="TimedOut";l.Nsk="AddinQueryCommandReady";l.GDl="GetAddinEntitlements";l.vZi="ProviderMRUEvents";l.jml="EnableAddinSearchCommands";Object(D.a)(l,"EventNames",null,[])},1505:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.jJf=null;this.Bba=this.lJf=0}Qjf(e,a,k){if(!e)throw Error.argumentNull("referenceList");if(0>a||a>e.length)throw Error.argumentOutOfRange("startIndex");
if(0>k||k>e.length)throw Error.argumentOutOfRange("length");if(a+k>e.length)throw Error.argument("Invalid start-length range");this.jJf=e;this.lJf=a;this.Bba=k}cgb(e,a,k){this.Qjf(e.jJf,e.lJf+a,k)}J(e){if(0>e||e>=this.Bba)throw Error.argumentOutOfRange("index");return this.jJf[this.lJf+e]}get count(){return this.Bba}static X9e(e){const a=new l;a.Qjf(e,0,e.length);return a}}Object(D.a)(l,"ReadOnlyList",null,[1369])},1513:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.Classifier=
0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=
16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.ActionAI=24]="ActionAI";e[e.ActionAICommand=25]="ActionAICommand";e[e.SummarizeDeck=26]="SummarizeDeck";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=29]="AddinStoreEntry";e[e.None=30]="None";e[e.MergedActions=31]="MergedActions";
e[e.MergedScopedSearches=32]="MergedScopedSearches";e[e.MergedSuggestedSearches=33]="MergedSuggestedSearches"})(l||(l={}));Object(D.b)("ResultGroupType",l)},1520:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1569);class l extends c.a{constructor(){super();this.info=this.pj=this.eventId=null}get zfa(){return"Misc"}eDb(){this.detail.Z("Type",this.zfa);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.pj);this.detail.Z("Info",this.info);return this.detail}}Object(D.a)(l,"BasicMergeFailureDetail",
c.a,[])},1521:function(D,L,c){c.d(L,"a",function(){return k});D=c(0);var l=c(627),e=c(805),a=c(1537);class k{constructor(x,y=!0){this.om=y&&x?x.fH():x;this.aZb=new l.a}aC(x){this.aZb.add(e.a.zb(x))}Ygo(x){this.aZb=x}QHi(x){this.om&&(new a.a(this.om,x)).fpa.forEach((y,m)=>{m.JX&&!this.aZb.contains(y)&&(this.aZb.add(y),m.isDeleted?(m=this.om,m.hasProperty(e.a.dX(y))&&m.removeProperty(e.a.dX(y))):this.om.cya(e.a.dX(y),m.newValue));return!0})}}Object(D.a)(k,"PartialMergeResult",null,[])},1522:function(D,
L,c){c.r(L);c.d(L,"CommandResultsUtility",function(){return z});D=c(0);var l=c(1533),e=c(1503),a=c(1534),k=c(1486),x=c(1490),y=c(1483),m=c(1482),u=c(2);class z{static c$c(v,E){if(E&&E.rq){const F={};for(const J of v)E.oZd(J)&&(F[J]=appChrome.selectors.getModelType(J));y.TellMeActor.instance.CG(F)}}static UAo(v){return v.startsWith("btnTellMeOfficeAddIn")}static jSc(v){const E=y.TellMeActor.instance.bO();return!!E&&E.rq&&!appChrome.selectors.isControlDisabled(v)}static S0d(v,E,F,J){if(y.TellMeActor.instance.Ne&&
v){const K=[];for(const H of v)K.push(String.format('{{"Id":"{0}","Score":{1}}}',H.commandId,H.score));v={};v[l.a.suggestions]="[{"+K.join(",")+"}]";v[l.a.vzi]=E;v[l.a.groupType]=F;v[l.a.provider]=J;y.TellMeActor.instance.Ne.pA(e.a.JUk,window.performance.now(),v)}}static CKl(v,E){const F=[],J=[];for(const K of E){E=K.commandId;let H=K;K.commandId in v&&(E=v[K.commandId],H=new a.a(E,K.score));Array.contains(J,E)||(F.push(H),J.push(E))}return F}static jOc(v,E,F,J,K,H,P,N){F.Bmf&&(E=z.CKl(F.Bmf,E));
var M=m.a.RIl(E);z.c$c(M,F);var I=[],T=[];M=[];const U=new x.a(P);P=16===P||18===P||7===P||4===P?u.AFrameworkApplication.K?u.AFrameworkApplication.K.pc("TellMeMaxRecommendedResultsToReturn",3):3:0===P||17===P||25===P?5:0;for(const W of E)if(!z.Yzm(W.commandId)){E=z.UAo(W.commandId);if(F.oZd(W.commandId)&&!E){if(m.a.hyi(W.commandId))continue;E=null;K&&H&&(E=K.N_l(W.commandId,H));z.jSc(W.commandId)?Array.add(I,new k.a(W.commandId,5,E,null,N,W.score)):Array.add(T,new k.a(W.commandId,5,E,null,N,W.score))}else F.yyb&&
E&&J&&Array.add(M,W.commandId.substr(21));if(I.length+M.length>=P)break}F=0;for(K=0;K<I.length&&F<P;K++,F++)U.ww(I[K]);for(I=0;I<T.length&&F<P;I++,F++)U.ww(T[I]);for(T=0;T<M.length&&F<P;T++,F++)J.ehp(v,M[T],U);return U}static Yzm(v){z.Ysh||(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.yw("TellMeControlPredictionBlockList")&&u.AFrameworkApplication.K.oC("TellMeControlPredictionBlockList").forEach(E=>{Array.add(z.Xsh,E.toLowerCase())}),z.Ysh=!0);return Array.contains(z.Xsh,v.toLowerCase())}static Azf(v){return 2<
v.length&&";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&!!u.AFrameworkApplication.K&&(u.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static j2h(v){const E=new x.a(0);var F=v.split(";");v=y.TellMeActor.instance.bO();for(const J of F)if(0<J.length){F=J.split(":");const K=2===F.length?F[0]:J;if(!v.oZd(K))break;if(1===F.length)F=new k.a(K,5,null,null,1),E.ww(F);else if(2===F.length)F=
new k.a(K,5,F[1],null,1),E.ww(F);else break}return E}static Nlk(v,E,F){if(!(E&&E.results&&v&&v.results&&v.results.length))return{returnValue:!1,UWe:v,JXe:E};const J=[];for(var K of E.results)Array.add(J,K.value);K=0;const H=0<E.results.length?E.results[0].score:0;for(const P of v.results)if(P.score>F&&!Array.contains(J,P.value)&&z.jSc(P.value)&&(0<H&&(P.score=H),Array.insert(E.results,K,P),K++),2===K)break;return 0<K?(F=E.results.length-5,0<F&&E.r2f(F),{returnValue:!0,UWe:v,JXe:E}):{returnValue:!1,
UWe:v,JXe:E}}}z.Ysh=!1;z.Xsh=[];Object(D.a)(z,"CommandResultsUtility",null,[])},1532:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{static NCo(e){return e.toString().charCodeAt(0)}static SKm(e){return 55296<=e&&57343>=e}static charAt(e,a){return e.charAt(a)}static Zqh(e,a){if(e===a)return!0;"\u00a0"===e&&(e=" ");"\u00a0"===a&&(a=" ");return e===a}static Yqh(e,a){if(e===a)return!0;if(!e||!a||e.length!==a.length)return!1;e=l.U6i(e);a=l.U6i(a);return e===a}static U6i(e){return e.replace(l.dXc,
" ")}static kob(e,a,k){return e.substring(a,a+k)}}l.dXc=RegExp("\u00a0","g");Object(D.a)(l,"CharUtils",null,[])},1533:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.appName="AppName";l.I2="CloseAllMenus";l.commandId="CommandId";l.context="Context";l.culture="Culture";l.message="Message";l.errorMessage="ErrorMessage";l.event="Event";l.xna="CorrelationID";l.utn="ParentUiElement";l.query="Input";l.cLb="QueryID";l.c_i="QueryLength";l.ufc="QueryIndex";l.D0n="ResultsList";l.suggestions=
"Suggestions";l.scenario="Scenario";l.sessionId="SessionID";l.source="Source";l.timeStamp="Time";l.Swj="UiElement";l.zae="ReactUx";l.value="Val";l.statusCode="StatusCode";l.service="Service";l.isSuccess="IsSuccess";l.vDo="TokenAcquired";l.CPm="LatencyType";l.groupName="GroupName";l.P7="GroupIndex";l.groupType="GroupType";l.z0n="ResultInfoList";l.resultType="ResultType";l.Bdg="SubResultType";l.qEm="IsInputBlur";l.rEm="IsInputFocus";l.cKm="IsShortCutUsed";l.actionType="ActionType";l.count="Count";l.ykl=
"DwellTime";l.vzi="IsZeroTerm";l.s_o="WordsCount";l.CYd="IsSearchUxEnabled";l.rLm="IsTellMeInHeaderEnabled";l.module="Module";l.resultIndex="ResultIndex";l.Zcf="DisplayIndex";l.sml="EnableList";l.provider="Provider";l.contentType="ContentType";l.DJm="IsSelectionBased";l.SCk="BeginPerformanceMarker";l.Rml="EndPerformanceMarker";l.yvn="PerformanceMeasure";Object(D.a)(l,"Columns",null,[])},1534:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a){this.commandId=e;this.score=
a}}Object(D.a)(l,"CommandSuggestion",null,[])},1537:function(D,L,c){D=c(0);var l=c(394),e=c(805),a=c(234),k=c(46);class x{constructor(m,u,z){this.c$j=m;this.v6j=u;this.O5j=z;this.aDe=new a.a(Object(k.a)(this,this.KOk,"checkIfDifferent"))}get fmb(){return this.c$j}get oldValue(){return this.v6j}get newValue(){return this.O5j}get uib(){return!(void 0===this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&
!(void 0===this.oldValue||null===this.oldValue)}get JX(){return this.uib||this.isDeleted||this.aDe.value}KOk(){return this.uib||this.isDeleted?!0:!e.a.frh(this.fmb,this.oldValue,this.newValue)}}Object(D.a)(x,"PropertyDiff",null,[]);c.d(L,"a",function(){return y});class y{constructor(m,u){this.s6j=m;this.L5j=u;this.aDe=new a.a(()=>this.tSc());this.e$j=new a.a(Object(k.a)(this,this.Epl,"evaluatePropertyDiffs"))}get Bu(){return this.s6j}get yf(){return this.L5j}get uib(){return!!this.yf&&!this.Bu}get isDeleted(){return!this.yf&&
!!this.Bu}get JX(){return this.uib||this.isDeleted||this.aDe.value}get fpa(){return this.e$j.value}tSc(m=null){let u=!1;this.fpa.forEach((z,v)=>{u=v.JX&&(!m||7!==m.J(z));return!u});return u}Epl(){const m=new l.a;var u=this.yf,z=this.Bu;if(this.uib){z=u.Fl();for(var v=0;v<z.length;v++){var E=z[v];m.Z(e.a.zb(E),new x(E,null,u.jX(E)))}}else if(this.isDeleted)for(u=z.Fl(),v=0;v<u.length;v++)E=u[v],m.Z(e.a.zb(E),new x(E,z.jX(E),null));else{v=z.Fl();for(E=0;E<v.length;E++){var F=v[E],J=e.a.zb(F),K=z.jX(F);
const H=u.hasProperty(F)?u.jX(F):null;m.Z(J,new x(F,K,H))}v=u.Fl();for(E=0;E<v.length;E++)F=v[E],z.hasProperty(F)||(J=e.a.zb(F),K=u.jX(F),m.Z(J,new x(F,null,K)))}return m}}Object(D.a)(y,"MergeableObjectDiff",null,[])},1547:function(D,L,c){c.d(L,"b",function(){return x});c.d(L,"a",function(){return m});var l=c(231),e=c(394),a=c(627),k=c(1702);const x=(z,v,E)=>{const F=y(z,v,E);let J=0,K=0,H=0,P=new k.a;const N=new l.a;for(let M=0;M<F.length;M++){const I=F.$f(M+1);P.izd(z.$f(J));P.kzd(v.$f(K));P.ozd(E.$f(H));
J++;K++;for(H++;J<z.length&&(!I||!I.equals(z.$f(J)));)P.izd(z.$f(J)),J++;for(;K<v.length&&(!I||!I.equals(v.$f(K)));)P.kzd(v.$f(K)),K++;for(;H<E.length&&(!I||!I.equals(E.$f(H)));)P.ozd(E.$f(H)),H++;N.add(P);P=new k.a}for(;J<z.length;)P.izd(z.$f(J)),J++;for(;K<v.length;)P.kzd(v.$f(K)),K++;for(;H<E.length;)P.ozd(E.$f(H)),H++;P.isEmpty||N.add(P);return N},y=(z,v,E)=>{const F=new l.a,J=v.zG(),K=E.zG();z.forEach(H=>{J.contains(H)&&K.contains(H)&&F.add(H);return!0});return F},m=(z,v,E)=>{z=z||new l.a;v=
v||new l.a;E=E||new l.a;const F=new l.a,J=new e.a(0),K=new a.a;for(var H=0;H<z.length;H++){var P=z.$f(H);J.Z(P,H)}for(z=H=0;H<v.length&&z<E.length;){P=v.$f(H);let N=E.$f(z),M=J.Wy(P,-1),I=J.Wy(N,-1);-1===M?(u(K,F,P),H++):-1===I?(u(K,F,N),z++):M===I?(u(K,F,P),H++,z++):M<I?H++:z++}for(;H<v.length;H++)P=v.$f(H),-1===J.Wy(P,-1)&&u(K,F,P);for(;z<E.length;z++)v=E.$f(z),-1===J.Wy(v,-1)&&u(K,F,v);return F},u=(z,v,E)=>{z.contains(E)||(v.add(E),z.add(E))}},1548:function(D,L,c){c.d(L,"a",function(){return e});
D=c(0);var l=c(60);class e{constructor(){this.cp=0;this.id=l.a.create()}}Object(D.a)(e,"LcsUpdateHint",null,[1532,80])},1549:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.tellMe="TellMe";l.loki="Loki";l.substrate="Substrate";l.ufc="QueryIndex";l.Srj="TellMeRanker";l.Trj="TellMeRankerLogging";Object(D.a)(l,"Services",null,[])},1550:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{}l.XOa="HttpRequest";l.provider="Provider";Object(D.a)(l,"LatencyTypes",null,[])},1553:function(D,
L,c){D=c(0);var l=c(17),e=c(6),a=c(231),k=c(177),x=c(200),y=c(60),m=c(627),u=c(46),z=c(251),v=c(1569);class E extends v.a{constructor(){super();this.iSa=null}get zfa(){return"CreateMergeBlock"}eDb(){this.detail.Z("Type",this.zfa);this.detail.Z("Revision",this.iSa);return this.detail}}Object(D.a)(E,"CreateMergeBlockFailureDetail",v.a,[]);var F=c(1614),J=c(1616),K=c(1701),H=c(1570),P=c(1521),N=c(1758);c.d(L,"a",function(){return M});class M{static xFd(I,T,U,W,V,Y,da){let ba;ba="";const ja=new a.a;for(let ta=
0;ta<U.length;ta++){var sa=void 0;let ra;sa=F.a.VKl(T,U.J(ta),W,V,Y,da,I);if(!sa)return{returnValue:null,z3a:ba};({oKf:ra,z3a:sa}=sa.t8h());if(!ra)return{returnValue:null,z3a:ba};ba+=sa;ja.fA(ja.length,ra)}return{returnValue:ja,z3a:ba}}static fIh(I,T,U,W,V,Y,da,ba){let ja,sa,ta,ra,ma,Ba;Ba=ma=ra=ta=sa=ja=null;({z3a:ra,returnValue:ja}=M.xFd(T,Pa=>I.runtime.pk.J(Pa),U,1,Y,da,ba));if(!ja)return k.a.instance.Ta(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),
I.logger.Pg(Object.assign(new E,{iSa:"Base"})),{returnValue:!1,iK:ja,rKc:sa,W9c:ta,hAd:ra,hKd:ma,ule:Ba};({z3a:ma,returnValue:sa}=M.xFd(T,Pa=>I.runtime.ru.J(Pa)||I.runtime.pk.J(Pa),W,2,Y,da,ba));if(!sa)return k.a.instance.Ta(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),I.logger.Pg(Object.assign(new E,{iSa:"Favored"})),{returnValue:!1,iK:ja,rKc:sa,W9c:ta,hAd:ra,hKd:ma,ule:Ba};({z3a:Ba,returnValue:ta}=
M.xFd(T,Pa=>I.runtime.zq.J(Pa)||I.runtime.pk.J(Pa),V,4,Y,da,ba));return ta?{returnValue:!0,iK:ja,rKc:sa,W9c:ta,hAd:ra,hKd:ma,ule:Ba}:(k.a.instance.Ta(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),I.logger.Pg(Object.assign(new E,{iSa:"Unfavored"})),{returnValue:!1,iK:ja,rKc:sa,W9c:ta,hAd:ra,hKd:ma,ule:Ba})}static YBh(I,T=!1){const U=new a.a;let W=0;for(;W<I.length;){var V=I.J(W);if(1===V.type||
4===V.type||2===V.type)U.add(V),W++;else if(3===V.type){let da="";da+=V.character;W++;let ba=V.IPa,ja=!1;for(;W<I.length;W++){var Y=I.J(W);3===Y.type?V.runId===Y.runId&&V.JI.equals(Y.JI)&&(V.Vaa===Y.Vaa||V.hEa===Y.hEa)&&V.fF.hA(Y.fF)&&(!T||V.Kt&&V.Kt.equals(Y.Kt))?(da+=Y.character,Y.IPa&&(ba=!0)):ja=!0:ja=!0;if(ja){V=new N.a(null,V.source,V.Fj,V.wg,V.runId,V.JI,da,V.Ekb,!0,ba,V.Vaa,V.hEa,V.vRa,V.fF,V.Kt);U.add(V);break}}}}k.a.instance.Ta(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
U.Pq());return U}static AUk(I,T=!1){const U=new a.a;let W=0;for(;W<I.length;){var V=I.J(W);if(1===V.type||4===V.type||2===V.type)U.add(V),W++;else if(3===V.type){let da=V.character.toString();W++;let ba=V.IPa;for(;W<I.length;W++){var Y=I.J(W);if(3===Y.type&&M.alo(V,Y,T))da+=Y.character,Y.IPa&&(ba=!0);else break}V=new N.a(null,V.source,V.Fj,V.wg,V.runId,V.JI,da,V.Ekb,!0,ba,V.Vaa,V.hEa,V.vRa,V.fF,V.Kt);U.add(V)}}k.a.instance.Ta(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
U.Pq());return U}static alo(I,T,U){return I.runId===T.runId&&I.JI.equals(T.JI)&&(I.Vaa===T.Vaa||I.hEa===T.hEa)&&I.fF.hA(T.fF)&&(!U||!!I.Kt&&I.Kt.equals(T.Kt))}static Oeo(I,T,U,W,V,Y,da,ba,ja,sa,ta,ra,ma,Ba,Pa,Da){I.setPropertyString(U.om,l.a.yo,V);I.setPropertyUint32(U.om,e.a.Lc,W);I.setPropertyUint32s(U.om,e.a.$p,Y);I.setPropertyUint32s(U.om,e.a.Ps,da);I.setPropertyObjectIds(U.om,l.a.En,ja);I.hasProperty(U.om,e.a.sj)&&I.setPropertyUint32(U.om,e.a.sj,M.eCl());T&&T(10)&&I.setPropertyObjectIds(U.om,
e.a.qv,Da);W=!1;for(V=0;V<sa.length;V++)if(sa.J(V)){W=!0;break}W&&I.setPropertyBools(U.om,e.a.jOf,sa);M.qJk(T,I,U,ta,ra,ma,Ba);M.rJk(I,U,Pa);U.aC(l.a.yo);U.aC(e.a.Lc);U.aC(e.a.$p);U.aC(e.a.Ps);U.aC(l.a.En);U.aC(e.a.jOf);U.aC(l.a.sm);U.aC(l.a.bob);U.aC(e.a.HOa);U.aC(e.a.rGa);U.aC(l.a.Kwa);U.aC(e.a.qv);I.hasProperty(U.om,e.a.sj)&&U.aC(e.a.sj);0<ba.length?I.setPropertyUint32s(U.om,l.a.sm,ba):U.om.removeProperty(l.a.sm)}static qJk(I,T,U,W,V,Y,da){if(I(98)){I=W.contains(!0,(ba,ja)=>ja);M.m9f(T,U,l.a.Kwa,
I?W:null);M.m9f(T,U,l.a.bob,M.x8i(W,V));M.m9f(T,U,e.a.HOa,M.x8i(W,Y));W=!1;for(V=0;V<da.length;V++)0!==da.J(V)&&(W=!0);W?T.setPropertyUint32s(U.om,e.a.rGa,da):U.om.removeProperty(e.a.rGa)}}static rJk(I,T,U){const W=da=>da;var V=Object(u.a)(I,I.setPropertyBools,"setPropertyBools");M.HMa(T,U.mib,W,V,e.a.GEa);M.HMa(T,U.Keb,W,V,e.a.kfa);M.HMa(T,U.w4a,W,V,e.a.qGa);V=da=>0<da.length;var Y=Object(u.a)(I,I.setPropertyStrings,"setPropertyStrings");M.HMa(T,U.lib,V,Y,e.a.HEa);M.HMa(T,U.Jeb,V,Y,e.a.XCa);M.HMa(T,
U.amb,V,Y,e.a.VHa);V=da=>!!da;Y=Object(u.a)(I,I.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");M.HMa(T,U.nib,V,Y,e.a.IEa);M.HMa(T,U.VZa,V,Y,e.a.YCa);M.HMa(T,U.cmb,V,Y,e.a.WHa);U.w4a.any(W)?M.HMa(T,U.bmb,()=>!0,Object(u.a)(I,I.setPropertyObjectIds,"setPropertyObjectIds"),e.a.xya):T.om.removeProperty(e.a.xya)}static x8i(I,T){const U=new a.a;let W=!1;for(let V=0;V<I.length;V++){const Y=T.J(V)&&!I.J(V);U.add(Y);W=Y||W}return W?U:null}static m9f(I,T,U,W){W?I.setPropertyBools(T.om,U,W):
T.om.removeProperty(U)}static eCl(){return x.a.aF()}static r9h(I,T){return I.runtime.ru.Wy(T,I.runtime.pk.J(T)||I.runtime.zq.get(T))}static BNc(I,T,U,W,V){let Y;Y=new a.a;const da=!!U&&U(10);if(I.runtime.Xb.isFeatureEnabled(75)){var ba=M.AUk(W,da);var ja=M.YBh(W,da);ba.length!==ja.length&&I.runtime.Xb.pB(75)}else ba=M.YBh(W,da);ja=0;let sa="",ta=new a.a,ra=new a.a,ma=new a.a,Ba=new a.a,Pa=new a.a,Da=new a.a,Ha=new a.a,oa=new a.a,wa=new a.a;const ia=new K.a;let ca=new a.a;var pa=ba.J(ba.length-1);
if(2!==pa.type&&4!==pa.type)return k.a.instance.Ta(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",pa.type),I.logger.Pg(Object.assign(new H.a,{pj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",pa.type)})),{returnValue:!1,Z7d:Y};var Ma=0;for(pa=0;pa<ba.length;pa++){var ya=ba.J(pa),Oa=null;if(1===ya.type||3===ya.type)Oa=ya,sa+=Oa.text;else if(4===ya.type){ya=M.r9h(I,
ya.Fj);ya=new P.a(ya);Y.add(ya);continue}Oa?(ta.add(Oa.runId),ra.add(Oa.wg),Ma+=Oa.text.length,ma.add(Ma),Ba.add(Oa.JI),Pa.add(Oa.Ekb),Da.add(Oa.IPa),Ha.add(Oa.Vaa),oa.add(Oa.hEa),wa.add(Oa.vRa),ia.mib.add(Oa.fF.nim),ia.Keb.add(Oa.fF.Phm),ia.w4a.add(Oa.fF.Tim),ia.lib.add(Oa.fF.insertion.author),ia.Jeb.add(Oa.fF.deletion.author),ia.amb.add(Oa.fF.pGa.author),ia.nib.add(Oa.fF.insertion.CXc),ia.VZa.add(Oa.fF.deletion.CXc),ia.cmb.add(Oa.fF.pGa.CXc),ia.bmb.add(Oa.fF.pGa.MXf),da&&ca.add(Oa.Kt)):ta.length||
(ta.add(0),ra.add(0),ma.add(0),Ba.add(y.a.nil),Pa.add(!1),Da.add(!1),Ha.add(!1),oa.add(!1),wa.add(0),ia.mib.add(!1),ia.Keb.add(!1),ia.w4a.add(!1),ia.lib.add(""),ia.Jeb.add(""),ia.amb.add(""),ia.nib.add(0),ia.VZa.add(0),ia.cmb.add(0),ia.bmb.add(y.a.nil));if(2===ya.type){Ma=ya;ya=Ma.Lc;ma.QF(ma.length-1);Oa=V.J(ja);if(!Oa)return k.a.instance.Ta(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",
ja,V.length,W.length,pa,ba.length),I.logger.Pg(Object.assign(new H.a,{pj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),k.a.instance.Eia(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",V.Pq()),k.a.instance.Eia(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",W.Pq()),k.a.instance.Eia(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",ba.Pq()),{returnValue:!1,Z7d:Y};if(Oa=M.r9h(I,Oa))Oa=new P.a(Oa.fH()),M.Oeo(T,U,Oa,Ma.Lc,
sa,ta,ra,ma,Ba,Pa,Da,Ha,oa,wa,ia,ca),Y.add(Oa);k.a.instance.Ta(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",Ma.Fj,ya,ta.Pq(),ra.Pq(),ma.Pq(),Da.Pq(),Ha.Pq(),oa.Pq(),Ba.Pq(),"",wa.Pq());ja++;sa="";ta=new a.a;ra=new a.a;ma=new a.a;Ba=new a.a;Pa=new a.a;Da=new a.a;Ha=new a.a;oa=new a.a;wa=new a.a;ia.reset();Ma=0;ca=
new a.a}}return{returnValue:!0,Z7d:Y}}static t_n(I,T){const U=I.runtime.Xm.J(z.a.eL),W=T.getPropertyObjectIds(U.om,e.a.L0);for(let V=0;V<W.length;V++)I.runtime.Xm.remove(W.J(V));T.setPropertyObjectIds(U.om,e.a.L0,new a.a);T.setPropertyString(U.om,e.a.yTa,y.a.nil.toString());U.aC(e.a.L0);U.aC(e.a.yTa)}static gsm(I,T){if(I.runtime.Xm.ob(z.a.eL))return null;const U=new P.a(I.runtime.pk.J(z.a.eL).fH());T.setPropertyString(U.om,e.a.yTa,I.output.qM.last().id.toString());T.setPropertyObjectIds(U.om,e.a.L0,
new a.a);U.aC(e.a.L0);U.aC(e.a.yTa);I.runtime.Xm.Z(z.a.eL,U);return U}static ypf(I){const T=new a.a;I.forEach(U=>{T.add(U.id);return!0});return T}static Pbc(I,T,U,W){let V=0;U.forEach(Y=>{J.a(Y,T+V++,1);393230===Y.Nc&&I.getPropertyObjectIds(Y,l.a.En).forEach(da=>{W.add(da);return!0});return!0})}static pXm(I,T){const U=new m.a;let W=0;T.forEach(V=>{if(U.contains(V))return!0;U.add(V);if(({index:W}=M.VHf("BaseFormatting_",W,V,Y=>I.runtime.pk.J(Y))).returnValue||({index:W}=M.VHf("FavoredFormatting_",
W,V,Y=>I.runtime.ru.J(Y))).returnValue||({index:W}=M.VHf("ConflictingFormatting_",W,V,Y=>I.runtime.zq.J(Y))).returnValue)return!0;W++;return!0})}static VHf(I,T,U,W){if(U=W(U))if(J.a(U,I+T,1),1179649===U.Nc)return T++,{returnValue:!0,index:T};return{returnValue:!1,index:T}}static Edf(I){return!!I.runtime.pk.J(z.a.eL)}static HMa(I,T,U,W,V){T.any(U)?(W(I.om,V,T),I.aC(V)):I.om.removeProperty(V)}static Egj(I,T){const U=new a.a;U.add(0);const W=I?I.length:0;for(let V=0;V<W;V++)U.insert(V+1,I.$f(V));U.insert(U.length,
T);return U}}Object(D.a)(M,"ParagraphMergeUtils",null,[])},1567:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(231);class e{constructor(a,k,x){this.vm=null;this.yk=a;this.source=k;this.Fj=x}get type(){return this.yk}get v6a(){return!1}get YCm(){return 1===(this.source&1)}get ZCm(){return 2===(this.source&2)}get $Cm(){return 4===(this.source&4)}I3(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",this.eGl(),this.W5b())}eGl(){let a="";this.YCm&&(a+="Base");this.ZCm&&
(a+="FavoredUpdate");this.$Cm&&(a+="UnfavoredUpdate");return a}W5b(){return""}hA(a){return this.type===a.type}x7c(){const a=new l.a;a.add(this);return a}get length(){return 0}}Object(D.a)(e,"AMergeBlock",null,[105,106])},1568:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1567);class l extends c.a{constructor(e,a,k){super(2,e,a);this.Lc=k}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),this.Lc,this.Fj)}W5b(){return"Eop"}clone(){return new l(this.source,
this.Fj,this.Lc)}hA(e,a,k,x=!1,y=!0){return super.hA(e,a,k,x)?y?e.Lc===this.Lc:e.Fj===this.Fj&&e.Lc===this.Lc:!1}get length(){return 1}}Object(D.a)(l,"EopMergeBlock",c.a,[])},1569:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(394);class e{constructor(){this.detail=new l.a}}Object(D.a)(e,"AMergeFailureDetail",null,[1929])},1570:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1520);class l extends c.a{constructor(){super()}get zfa(){return"ParagraphMerge"}}Object(D.a)(l,
"ParagraphMergeFailureDetail",c.a,[])},1571:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1520);class l extends c.a{constructor(){super()}get zfa(){return"RdOpLcs"}}Object(D.a)(l,"ReducedOpsLcsFailureDetail",c.a,[])},1572:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1520);class l extends c.a{constructor(){super()}get zfa(){return"TableMerge"}}Object(D.a)(l,"TableMergeFailureDetail",c.a,[])},1578:function(D,L,c){D=c(0);class l{constructor(){this.X8c=this.jRc=null;this.WJf=
this.score=this.fXc=0}rVf(F,J,K){this.score=F.J(J);++J;this.jRc=F.J(J)?K.Ima(F.J(J)):null;++J;this.X8c=F.J(J)?K.Ima(F.J(J)):null;++J;this.fXc=F.J(J);++J;this.WJf=F.J(J);++J;return J}}Object(D.a)(l,"TokenStringGeneratorInit",null,[]);class e{constructor(F,J,K,H,P){this.Rfb=F;this.count=J;this.$Kd=K;this.VN=H;this.depth=P}}Object(D.a)(e,"ErrorTolerantTrieMatch",null,[]);var a=c(1633),k=c(1719);class x{constructor(F=null,J=0,K=0,H=0){this.fgk=F||new k.a;this.Qua=J;this.VN=K;this.depth=H}get R4(){return this.fgk}getKey(){return this.R4.rx.toString()+
":"+this.Qua.toString()}}Object(D.a)(x,"TrieBookmark",null,[]);class y{constructor(F,J){this.rQa=F;this.dJf=J}j2m(F){if(null==F)throw Error.argumentNull("prefix");let J={};var K=J[""]=new x;this.STd(K,J);for(K=0;K<F.length;++K){const H=F.charCodeAt(K),P={};for(let N in J)this.Itk(H,J[N],P);J=P}return this.oFo(J)}STd(F,J){if(!(F.VN>=this.dJf)&&(F=new x(a.a.H5e(F.R4),F.Qua,F.VN+1,F.depth),F.R4.lF&a.a.X7a&&(F.Qua+=1),this.rQa.kPb(F.R4))){F.depth+=1;let K=!0;for(;K;)y.$le(F,J),this.STd(F,J),F.Qua+=this.rQa.i6b(F.R4,
!0)+(F.R4.lF&a.a.X7a?1:0),K=this.rQa.u9c(F.R4)}}Itk(F,J,K){J.VN+1<=this.dJf&&(J.VN+=1,y.$le(J,K),--J.VN);J.R4.lF&a.a.X7a&&(J.Qua+=1);if(this.rQa.kPb(J.R4)){J.depth+=1;let H=!0;for(;H;)J.R4.hQb===F?(y.$le(J,K),this.STd(J,K)):J.VN+1<=this.dJf&&(J.VN+=1,y.$le(J,K),this.STd(J,K),--J.VN),J.Qua+=this.rQa.i6b(J.R4,!0)+(J.R4.lF&a.a.X7a?1:0),H=this.rQa.u9c(J.R4)}}oFo(F){const J=[];for(var K in F){const H=F[K];if(!H.R4.rx)continue;const P=!!(H.R4.lF&a.a.X7a),N=this.rQa.i6b(H.R4,!1)+(P?1:0);Array.add(J,new e(H.Qua,
N,P,H.VN,H.depth))}J.sort((H,P)=>{let N=H.Rfb-P.Rfb;return N||(N=-(H.count-P.count))?N:N=H.depth-P.depth});if(2>J.length)return J;F=[];for(K=0;K<J.length;)K+=y.Cuj(K,J,F);return F}static $le(F,J){const K=F.getKey();K in J?(J=J[K],J.VN=Math.min(J.VN,F.VN)):J[K]=new x(a.a.H5e(F.R4),F.Qua,F.VN,F.depth)}static Cuj(F,J,K){const H=J[F];let P=H.Rfb;const N=P+H.count;let M=1,I=H.$Kd;for(;F+M<J.length&&J[F+M].Rfb<N;){const T=J[F+M];T.Rfb>P&&(Array.add(K,new e(P,T.Rfb-P,I,H.VN,H.depth)),I=!1);M+=y.Cuj(F+M,
J,K);P=T.Rfb+T.count}P<N&&Array.add(K,new e(P,N-P,I,H.VN,H.depth));return M}}Object(D.a)(y,"ErrorTolerantTrieLookupEngine",null,[1426]);class m extends l{constructor(F,J,K){super();this.Hli=this.mSi=!1;this.lTh=null;if(F){var H=0;try{H=this.rVf(F,H,J);this.mSi=1===F.J(H);++H;this.Hli=1===F.J(H);++H;const P=F.J(H);this.lTh=this.Otn(K,P)}catch(P){throw Error.argument("initData");}}}Otn(F,J){return new y(F,J)}}Object(D.a)(m,"FuzzyMatchTokenStringGeneratorInit",l,[]);class u extends l{constructor(F,J){super();
this.query=this.name=null;if(F){this.annotations=J.annotations;var K=0;try{K=this.rVf(F,K,J),this.name=J.uD(F.J(K)),++K,this.query=J.vK(F.J(K))}catch(H){throw Error.argument("initData");}}}}Object(D.a)(u,"QueryTokenStringGeneratorInit",l,[]);class z extends l{constructor(F,J){super();if(F)try{this.rVf(F,0,J)}catch(K){throw Error.argument("initData");}}}Object(D.a)(z,"SurfaceStringTokenStringGeneratorInit",l,[]);var v=c(1505);c.d(L,"a",function(){return E});class E{constructor(F){this.UIf=F}get jRc(){return this.UIf.jRc}get X8c(){return this.UIf.X8c}get fXc(){return this.UIf.fXc}static create(F,
J,K){const {SurfaceStringTokenStringGenerator:H}=c(1860),{QueryTokenStringGenerator:P}=c(1861),{FuzzyMatchTokenStringGenerator:N}=c(1862);let M=0;try{if(F.J(M)!==E.azb)throw Error.argument("initData","Input does not represent a token string generator");++M;const I=F.J(M);++M;const T=new v.a;T.cgb(F,M,F.count-M);switch(I){case H.oEc:return new H(new z(T,J));case P.oEc:return new P(new u(T,J));case N.oEc:return new N(new m(T,J,K));default:throw Error.argument("initData");}}catch(I){throw Error.argument("initData");
}}static Plh(F,J,K,H,P,N){F=F.ADo.getId(J,null);if(0>F)return++N,N;E.Qlh(F,K,H,P);return N}static Qlh(F,J,K,H){Array.add(H.pdg,F);Array.add(H.Opj,J);++H.xkc[K]}}E.azb=1099767983;Object(D.a)(E,"TokenStringGenerator",null,[1399])},1613:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(231);L=c(1567);var e=c(1532);class a extends L.a{constructor(k,x,y){super(k,x,y)}uto(k){let x;x=null;if(!this.text||!this.v6a||0>=k||k>=this.length)return{returnValue:!1,ioj:x};x=new l.a;const y=this.clone();
y.g6c(e.a.kob(this.text,0,k));const m=this.clone();m.g6c(e.a.kob(this.text,k,this.length-k));x.add(y);x.add(m);return{returnValue:!0,ioj:x}}I3(){return!0}get length(){return this.text.length}}Object(D.a)(a,"ATextMergeBlock",L.a,[])},1614:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(177);class e{UZe(a,k){return a+("[Block: "+k+"] ")}static VKl(a,k,x,y,m,u,z){const {ParagraphMergeBlockCreator:v}=c(1935),{TableMergeBlockCreator:E}=c(1938);if(393230===k.Nc)return new v(a,k,x,m,u,y(10),
z);if(393250===k.Nc)return new E(k,x);l.a.instance.Ta(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",k.Nc);return null}}Object(D.a)(e,"MergeBlockCreator",null,[])},1615:function(D,L,c){c.d(L,"a",function(){return k});D=c(0);var l=c(6),e=c(60);L=c(1613);var a=c(1537);class k extends L.a{constructor(x,y,m,u,z,v,E,F,J,K,H,P,N,M){super(y,m,u);this.wg=z;this.runId=v;this.Ekb=F;this.TXj=E;this.Gqe=x;this.IPa=J;this.Vaa=K;this.hEa=H;this.vRa=P;this.fF=N;this.Kt=M}get VCc(){return this.Gqe}get JI(){return this.TXj}get tCb(){return this.VCc(this.JI)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",
super.toString(),this.wg,this.runId,this.Ekb,this.Fj,this.JI.toString(),this.Kt?this.Kt.toString():"NULL")}hA(x,y,m,u=!1){if(!super.hA(x,y,m,u))return!1;if(u)return!0;if(!this.fF.hA(x.fF)||this.Kt&&!this.Kt.equals(x.Kt))return!1;if(this.JI.equals(x.JI)||this.JI.equals(e.a.nil)||x.JI.equals(e.a.nil))return!0;x=new a.a(this.tCb,x.tCb);y=y.IHh(this.tCb,m);return x.tSc(y.O9d)?!1:!0}get Txm(){return this.I3()&&"\ufffc"===this.text&&this.tCb?this.tCb.hasProperty(l.a.Rs)||1179725!==this.tCb.Nc?!0:!1:!1}}
Object(D.a)(k,"AUserRunMergeBlock",L.a,[])},1616:function(D,L,c){c.d(L,"a",function(){return e});var l=c(177);const e=(a,k,x=4)=>{a?l.a.instance.Eia(4273285,x,4,k,a.Q8c()):l.a.instance.Ta(4293845,x,1,k,"{0}: Node was null.",k)}},1617:function(D,L,c){c.d(L,"e",function(){return y});c.d(L,"a",function(){return m});c.d(L,"d",function(){return u});c.d(L,"b",function(){return z});c.d(L,"c",function(){return v});var l=c(6),e=c(17),a=c(60),k=c(1029),x=c(1547);const y=(J,K,H)=>{const P=new k.a;let N=a.a.nil;
K=P.getPropertyObjectId(K,l.a.tob);K.equals(a.a.nil)||(J=J.runtime.pk.J(K),H&&(J=H.Wy(K,J)),J&&(N=P.getPropertyObjectId(J,l.a.tob)));return N},m=(J,K,H,P,N)=>{const M=new k.a;let I=null;var T=M.getPropertyObjectId(H,l.a.tob);T!==a.a.nil&&(I=J.runtime.pk.J(T),K&&(I=K.Wy(T,I)));if(I){T=M.getPropertyObjectIds(I,e.a.gf);for(N=0;N<T.length&&!T.J(N).equals(H.id);N++);N===T.length&&(N=-1)}H=y(J,H,K);if(!H.equals(a.a.nil)&&(J=J.runtime.pk.J(H),K&&(J=K.Wy(H,J)),J)){K=M.getPropertyObjectIds(J,e.a.gf);for(P=
0;P<K.length&&!K.J(P).equals(I.id);P++);P===K.length&&(P=-1)}return{rowIndex:P,O1b:N}},u=(J,K,H,P,N)=>{var M=new k.a;let I=null;var T=J.runtime.pk.J(H);K&&(T=K.Wy(H,T));if(!T)return null;T=M.getPropertyObjectIds(T,e.a.gf);H=null;P<T.length&&(P=T.J(P),H=J.runtime.pk.J(P),K&&(H=K.Wy(P,H)));H&&(M=M.getPropertyObjectIds(H,e.a.gf),N<M.length&&(N=M.J(N),I=J.runtime.pk.J(N),K&&(I=K.Wy(N,I))));return I},z=(J,K,H)=>{let P,N;N=P=-1;const M=(new k.a).getPropertyObjectId(H,l.a.tob);var I=y(J,H,K);if(I.equals(a.a.nil)||
M.equals(a.a.nil))return{rowIndex:P,O1b:N};K=J.runtime.Aeg;var T=K.J(I);if(!T){T=E(J,I);if(!T)return{rowIndex:P,O1b:N};K.Z(I,T)}for(I=0;I<T.length;I++)if(T.J(I).equals(M)){P=I;break}T=K.J(M);if(!T){T=F(J,M);if(!T)return{rowIndex:P,O1b:N};K.Z(M,T)}for(J=0;J<T.length;J++)if(T.J(J).equals(H.id)){N=J;break}return{rowIndex:P,O1b:N}},v=(J,K,H,P)=>{if(0>H||0>P)return a.a.nil;new k.a;const N=J.runtime.Aeg;let M=N.J(K);if(!M){M=E(J,K);if(!M)return a.a.nil;N.Z(K,M)}if(H<M.length)K=M.J(H);else return a.a.nil;
H=N.J(K);if(!H){H=F(J,K);if(!H)return a.a.nil;N.Z(K,H)}if(P<H.length)J=H.J(P);else return a.a.nil;return J},E=(J,K)=>{var H=new k.a;const P=J.runtime.pk.J(K);if(P){var N=J.runtime.ru.Wy(K,P);J=J.runtime.zq.Wy(K,P);K=H.getPropertyObjectIds(P,e.a.gf);N=H.getPropertyObjectIds(N,e.a.gf);H=H.getPropertyObjectIds(J,e.a.gf);return K.Sp(N,(M,I)=>M.equals(I))?H:K.Sp(H,(M,I)=>M.equals(I))?N:x.a(K,N,H,(M,I)=>M.equals(I))}return(N=J.runtime.ru.J(K))?H.getPropertyObjectIds(N,e.a.gf):(N=J.runtime.zq.J(K))?H.getPropertyObjectIds(N,
e.a.gf):null},F=(J,K)=>{var H=new k.a;const P=J.runtime.pk.J(K);if(P){var N=J.runtime.ru.Wy(K,P);J=J.runtime.zq.Wy(K,P);K=H.getPropertyObjectIds(P,e.a.gf);N=H.getPropertyObjectIds(N,e.a.gf);H=H.getPropertyObjectIds(J,e.a.gf);return K.Sp(N,(M,I)=>M.equals(I))?H:K.Sp(H,(M,I)=>M.equals(I))?N:null}return(N=J.runtime.ru.J(K))?H.getPropertyObjectIds(N,e.a.gf):(N=J.runtime.zq.J(K))?H.getPropertyObjectIds(N,e.a.gf):null}},1618:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(1482);c=c(2);class e{static tLm(){return!l.a.oti()&&
!l.a.SGb()&&e.isFeatureEnabled(0)}static uxi(){return e.isFeatureEnabled(1)}static Gui(){return e.isFeatureEnabled(2)}static isFeatureEnabled(a){return!!(e.PWj&1<<a)}}e.PWj=c.AFrameworkApplication.K?c.AFrameworkApplication.K.pc("TellMeFeatureConfigValue",0):0;Object(D.a)(e,"TellMeFeatureAvailability",null,[])},1619:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1486);class l extends c.a{constructor(e,a,k,x,y=null){super(e,a,y,null,k);this.id=x}}Object(D.a)(l,"TryQueryResultBinding",c.a,
[])},1620:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e){this.Bb=e}get O3a(){return this.Bb.O3a}get Ixo(){return 4!==this.Bb.style}get Kxo(){return!0}get trie(){return this.Bb.trie}getId(e,a){if(!this.Ixo)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Bb.style){case 0:return this.WRl(e,a);default:throw Error.notImplemented();}}uD(e){if(!this.Kxo)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>e||e>=this.O3a)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Bb.style){case 0:return this.D6l(e);case 4:return this.C6l(e);default:throw Error.notImplemented();}}WRl(e,a){e=this.Bb.trie.MEi(e,0,e.length,a);if(!e.succeeded)return-1;if(0>e.Lkc||e.Lkc>=this.Bb.O3a)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Bb.v9c?this.Bb.R1c.oy(this.Bb.v9c+4*e.Lkc,4):e.Lkc}D6l(e){if(this.Bb.v9c){let a=0;for(;a<this.Bb.O3a&&this.Bb.R1c.oy(this.Bb.v9c+
4*a,4)!==e;++a);if(a>=this.Bb.O3a)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Bb.trie.Rci(a)}return this.Bb.trie.Rci(e)}C6l(e){const a=this.Bb.R1c.oy(this.Bb.Lpj+4*e,4);e=this.Bb.R1c.oy(this.Bb.Mpj+4*e,4);if(0>e||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const k=Array(a);for(let x=0;x<a;++x)k[x]=({omm:e}=this.LIn(e)).returnValue;return String.fromCharCode.apply(null,k)}LIn(e){let a=0;for(let k=0;3>k;++k){const x=
this.Bb.R1c.J(this.Bb.Gyh+e)^182;++e;a|=(x&127)<<7*k;if(!(x&128))break}return{returnValue:a,omm:e}}}Object(D.a)(l,"StringTable",null,[1377])},1621:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(1633);class e{constructor(a){this.trie=null;this.Gyh=this.Lpj=this.Mpj=this.v9c=0;if(a){this.R1c=a;var k=0;if(a.oy(k,4)!==e.azb)throw Error.argument("bytes","Input does not represent a string table");k+=4;this.O3a=a.oy(k,4);k+=4;this.style=a.oy(k,4);k+=4;switch(this.style){case 0:const x=1===
a.oy(k,4);k+=4;x||(this.v9c=k,k+=4*this.O3a);a.oy(k,4);this.trie=this.oun(a,k+4);break;case 4:this.Mpj=k;this.Lpj=k+=4*this.O3a;k+=4*this.O3a;a.oy(k,4);this.Gyh=k+4;break;default:throw Error.argument("bytes");}}}oun(a,k){return new l.a(a,k)}}e.azb=1025118440;Object(D.a)(e,"StringTableInit",null,[])},1622:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);var l;(function(e){e[e.Answer=0]="Answer";e[e.Definition=1]="Definition";e[e.Entity=2]="Entity";e[e.WolframAnswer=3]="WolframAnswer";e[e.Assistance=
4]="Assistance";e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.TryQuery=7]="TryQuery";e[e.FindInDocument=8]="FindInDocument";e[e.HelpAction=9]="HelpAction";e[e.Insights=10]="Insights";e[e.People=11]="People";e[e.Image=12]="Image";e[e.FirstRunResult=13]="FirstRunResult";e[e.NoCommandsFoundResult=14]="NoCommandsFoundResult";e[e.TestResult=15]="TestResult";e[e.AppsForOffice_Installed=16]="AppsForOffice_Installed";e[e.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";e[e.AppsForOffice_Query=
18]="AppsForOffice_Query";e[e.Notes_Onenote=19]="Notes_Onenote";e[e.Notes_Samsung=20]="Notes_Samsung";e[e.Notes_Sticky=21]="Notes_Sticky";e[e.Learning=22]="Learning";e[e.Feedback=23]="Feedback";e[e.Template=24]="Template";e[e.ActionAI=25]="ActionAI";e[e.ActionAICommand=26]="ActionAICommand";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=29]="AddinStoreEntry";e[e.GenerateSlides=30]="GenerateSlides";e[e.SummarizeDeck=31]="SummarizeDeck";e[e.Unknown=32]="Unknown"})(l||
(l={}));Object(D.b)("ResultType",l)},1630:function(D,L,c){D=c(0);var l=c(6),e=c(627),a=c(177),k=c(231),x=c(60),y=c(394),m=c(82),u;(function(Aa){Aa[Aa.none=0]="none";Aa[Aa.mergeConflict=1]="mergeConflict";Aa[Aa.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";Aa[Aa.failedToApplyHints=3]="failedToApplyHints";Aa[Aa.validateUpdateHintsAreComplete=4]="validateUpdateHintsAreComplete";Aa[Aa.other=5]="other"})(u||(u={}));Object(D.b)("ParagraphMergeUsingHintsFailureReason",u);var z=c(1029),
v=c(251),E=c(903);const F=Aa=>{const bb=new k.a;Aa.forEach(nb=>{bb.add(nb);return!0});return bb};var J=c(1568),K=c(1547),H=c(1571);const P=(Aa,bb)=>{if(Aa.length!==bb.length)return!1;for(let nb=0;nb<Aa.length;nb++)Aa.J(nb).vm=bb.J(nb),bb.J(nb).vm=Aa.J(nb);return!0},N=(Aa,bb,nb)=>{let Va,Ab,Zb;Va=0;Ab=!1;Zb=0;var Kb;if(!({idx:Kb}=W(Aa,bb)).returnValue)return a.a.instance.Ta(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",bb,Aa.Pq()),{returnValue:!1,
YOc:Va,Akb:Ab,XXc:Zb};if(!nb&&2===Aa.J(Kb).type)return{returnValue:!0,YOc:Kb,Akb:Ab,XXc:Zb};if(!Aa.J(Kb).I3())return a.a.instance.Ta(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",Kb,nb,Aa.Pq()),{returnValue:!1,YOc:Va,Akb:Ab,XXc:Zb};let dc=!1,jc=0;for(;Kb<Aa.length&&Aa.J(Kb).Fj.equals(bb);Kb++){if(nb===jc){dc=!0;break}if(nb>jc&&nb<jc+Aa.J(Kb).length){Ab=dc=!0;Zb=nb-jc;break}jc+=Aa.J(Kb).length}dc||nb!==jc||(dc=!0);dc&&(Va=
Kb);return{returnValue:dc,YOc:Va,Akb:Ab,XXc:Zb}},M=(Aa,bb,nb)=>{let Va,Ab,Zb;Zb=Ab=0;Va=!1;let Kb=0,dc=!1;for(;Ab<Aa.length;Ab++){if(bb===Kb){dc=!0;break}if(bb>Kb&&bb<Kb+Aa.J(Ab).length){Va=dc=!0;Zb=bb-Kb;break}Kb+=Aa.J(Ab).length}dc||bb!==Kb||(dc=!0);dc||(Aa=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Aa.length,Kb,bb),a.a.instance.Ta(573178201,1,2,Aa),nb.Pg(Object.assign(new H.a,{eventId:"8k6fz",info:Aa})));return{returnValue:dc,Akb:Va,Wsh:Ab,Vsh:Zb}},
I=(Aa,bb,nb)=>{let Va;if(Aa.J(bb).I3()&&({ioj:Va}=Aa.J(bb).uto(nb)).returnValue)return Aa.fA(bb+1,Va),Aa.QF(bb),!0;a.a.instance.Ta(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",bb,nb,Aa.Pq());return!1},T=(Aa,bb,nb)=>{let Va,Ab;if(!({YOc:nb,Akb:Ab,XXc:Va}=N(Aa,bb,nb)).returnValue)return{returnValue:!1,index:0};if(!Ab)return{returnValue:!0,index:nb};if(I(Aa,nb,Va))return{returnValue:!0,index:nb+1};a.a.instance.Ta(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",
bb,Va,Aa.Pq());return{returnValue:!1,index:0}},U=(Aa,bb,nb)=>{let Va;if(!({Akb:Va,Wsh:bb,Vsh:nb}=M(Aa,bb,nb)).returnValue)return{returnValue:!1,index:0};if(!Va)return{returnValue:!0,index:bb};if(I(Aa,bb,nb))return{returnValue:!0,index:bb+1};a.a.instance.Ta(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",nb,Aa.Pq());return{returnValue:!1,index:0}},W=(Aa,bb)=>{let nb;nb=0;for(let Va=0;Va<Aa.length;Va++)if(Aa.J(Va).Fj.equals(bb))return nb=Va,{returnValue:!0,
idx:nb};a.a.instance.Ta(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",bb,Aa.Pq());return{returnValue:!1,idx:nb}},V=(Aa,bb)=>{let nb;nb=-1;for(let Va=bb;Va<Aa.length;Va++)if(2===Aa.J(Va).type)return nb=Va,{returnValue:!0,wfa:nb};a.a.instance.Ta(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",bb,Aa.Pq());return{returnValue:!1,wfa:nb}},Y=(Aa,bb,nb)=>{let Va;Va=-1;for(let Ab=nb;Ab<Aa.length;Ab++)if(2===
Aa.J(Ab).type&&Aa.J(Ab).Fj.equals(bb))return Va=Ab,{returnValue:!0,wfa:Va};a.a.instance.Ta(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",bb,nb,Aa.Pq());return{returnValue:!1,wfa:Va}},da=(Aa,bb)=>{let nb;nb=0;var Va;if(!({idx:Va}=W(Aa,bb)).returnValue)return a.a.instance.Ta(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",bb,Aa),{returnValue:!1,length:nb};for(;Va<Aa.length;Va++)if(6!==Aa.J(Va).type){if(2===Aa.J(Va).type)return{returnValue:!0,
length:nb};a.a.instance.shipAssertTag(17342617,1,Aa.J(Va).I3(),"We found something other than text with type "+Aa.J(Va).type);a.a.instance.shipAssertTag(17877021,1,Aa.J(Va).Fj.equals(bb),"Unexpected GraphNodeId {0} for ParaId {1}",Aa.J(Va).Fj,bb);nb+=Aa.J(Va).length}a.a.instance.Ta(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",bb,Aa);return{returnValue:!1,length:nb}},ba=Aa=>{const bb=new k.a;for(let nb=0;nb<Aa.length;nb++)bb.add(Aa.J(nb).clone());return bb};var ja=c(1570),sa=
c(1532);class ta{constructor(Aa,bb,nb=null,Va=null){this.Fj=Aa;this.type=bb;this.text=nb;this.Lc=Va}isEqual(Aa){return Aa.Fj.equals(this.Fj)&&this.type===Aa.type&&this.Lc===Aa.Lc&&sa.a.Yqh(this.text,Aa.text)}toString(){let Aa=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Fj,this.Lc,this.type);this.text&&(Aa+=String.format(" [TextLength: {0}]",this.text.length));return Aa}}Object(D.a)(ta,"MergeBlockValidationState",null,[]);var ra=c(117),ma=c(947),Ba=c(865),Pa=c(560),
Da=c(502),Ha=c(946),oa=c(864),wa=c(1520),ia=c(1709),ca;(function(Aa){Aa[Aa.base=1]="base";Aa[Aa.favoredUpdate=2]="favoredUpdate";Aa[Aa.unfavoredUpdate=4]="unfavoredUpdate";Aa[Aa.min=1]="min";Aa[Aa.max=7]="max"})(ca||(ca={}));Object(D.b)("MergeBlockSource",ca);class pa{constructor(Aa,bb,nb,Va){this.wg=Aa;this.cp=bb;this.gAd=nb;this.G$c=Va}}Object(D.a)(pa,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var Ma=c(1567);class ya extends Ma.a{constructor(Aa,bb){super(6,Aa,bb);this.Lc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",
super.toString(),this.Fj)}W5b(){return"Selection"}clone(){return new ya(this.source,this.Fj)}hA(){return!1}get length(){return 0}}Object(D.a)(ya,"SelectionMergeBlock",Ma.a,[]);var Oa;(function(Aa){Aa[Aa.success=0]="success";Aa[Aa.selfSplit=1]="selfSplit";Aa[Aa.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";Aa[Aa.unexpected=3]="unexpected"})(Oa||(Oa={}));Object(D.b)("SplitTwinListResult",Oa);var fa=c(1613);class Ca extends fa.a{constructor(Aa,bb,nb,Va){super(5,Aa,bb);this._text=null;this.g6c(nb);
this.Jgk=Va}get text(){return this._text}g6c(Aa){this._text=Aa}get k$c(){return this.Jgk}clone(){return new Ca(this.source,this.Fj,this.text,this.k$c)}get v6a(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(D.a)(Ca,"UpdateHintTextMergeBlock",fa.a,[]);class Ta{constructor(Aa,bb,nb,Va){this.T1=!1;this.rbb=new y.a;this.Vd=Aa;this.xgh=Va;this.sKg=nb;this._base=bb;this.Tve=ba(bb);if(!P(this.base,this.Oe))throw a.a.instance.Ta(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),
Aa.logger.Pg(Object.assign(new wa.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Oe(){return this.Tve}get mergeConflict(){return this.T1}H_e(Aa,bb){switch(Aa.type){case 1:return this.Exk(Aa,bb);case 2:return this.g_e(Aa,bb);case 3:return this.Byk(Aa,bb);case 4:return this.Yxk(Aa);case 5:return this.Xwk(Aa,bb);case 6:return this.e_e(Aa);default:return!1}}G_e(Aa,bb){switch(Aa.type){case 1:return this.k_e(Aa,bb);case 2:return this.f_e(Aa,
bb);case 3:return this.Ayk(Aa,bb);case 4:return this.Xxk(Aa);case 5:return this.Wwk(Aa,bb);case 6:return this.d_e(Aa);default:return{returnValue:!1,du:null}}}Exk(Aa,bb){let nb;const Va=({iga:nb}=this.vHa(Aa.wg,bb,!1,Aa.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==Va&&1!==Va)return 3!==Va&&(a.a.instance.Ta(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",ca[bb],Oa[Va]),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",
eventId:"9l2vv"}))),!1;this.T1=!1;bb=new Ca(bb,Aa.wg,Aa.text,Aa.id);this.Rxf(Aa,nb,bb);return!0}g_e(Aa,bb){let nb,Va=({iga:nb}=this.vHa(Aa.wg,bb,!1,Aa.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(0!==Va&&1!==Va)return 3!==Va&&(a.a.instance.Ta(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",ca[bb],Oa[Va]),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;
let Ab;({iga:Ab,returnValue:Va}=this.vHa(Aa.wg,bb,!1,Aa.cp+Aa.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==Va&&1!==Va)return 3!==Va&&(a.a.instance.Ta(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",ca[bb],Oa[Va]),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.T1=!1;this.kbf(Aa,nb,Ab);return!0}Byk(Aa,bb){let nb;const Va=({iwf:nb}=this.I6h(Aa,bb,!1)).returnValue;
if(0!==Va&&1!==Va)return 3!==Va&&(a.a.instance.Ta(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",ca[bb],Oa[Va]),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.T1=!1;bb=new J.a(bb,Aa.Ht,Aa.Tsa);this.Rxf(Aa,nb,bb);return!0}Yxk(Aa){let bb;if(!({YTd:bb}=this.J6h(Aa,this.Oe,"Derived")).returnValue)return!1;this.kbf(Aa,bb,bb+1);return!0}Xwk(Aa,bb){let nb;if(!({nKf:bb,hwf:nb}=
this.s8h(Aa,!1,bb)).returnValue)return!1;this.Rxf(Aa,nb,bb);return!0}e_e(Aa){let bb;if(!({XTd:bb}=this.A6h(Aa,this.Oe,"Derived")).returnValue)return!1;this.kbf(Aa,bb,bb+1);return!0}fqh(Aa,bb,nb){const Va=({iga:bb}=this.vHa(Aa,nb,!1,bb,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(0!==Va&&1!==Va)return 3!==Va&&(a.a.instance.Ta(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",ca[nb],Oa[Va]),this.Vd.logger.Pg(Object.assign(new ia.a,
{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.T1=!1;Aa=new ya(nb,Aa);this.Oe.insert(bb,Aa);return!0}k_e(Aa,bb){var nb=null;if(Ta.xsi(Aa.text.length))return{returnValue:!1,du:nb};let Va,Ab,Zb;var Kb=({iga:Va,Jva:Ab,afa:Zb}=this.vHa(Aa.wg,bb,!0,Aa.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==Kb&&2!==Kb)return 3!==Kb&&(a.a.instance.Ta(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",ca[bb],
Oa[Kb]),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,du:nb};this.T1=!1;({wfa:Kb}=V(this.Oe,Ab));Kb=this.Oe.J(Kb).Fj;nb=new Ca(bb,Aa.wg,Aa.text,Aa.id);bb=new Ca(bb,Kb,Aa.text,Aa.id);nb.vm=bb;bb.vm=nb;this.base.insert(Va,nb);this.Oe.insert(Ab,bb);nb=new k.a;nb.add(new Da.a(Kb,Zb,Aa.text,Aa.id,Aa.vu));return{returnValue:!0,du:nb}}f_e(Aa,bb){let nb;nb=null;if(Ta.xsi(Aa.text.length))return{returnValue:!1,du:nb};let Va;var Ab,Zb=({iga:Va,
Jva:Kb,afa:Ab}=this.vHa(Aa.wg,bb,!0,Aa.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Zb){if(2!==Zb)return 3!==Zb&&(a.a.instance.Ta(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",ca[bb],Oa[Zb]),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,du:nb};var Kb=0;for({idx:Ab}=W(this.base,Aa.wg);Ab<this.base.length&&Kb<Aa.cp;Ab++)Kb+=
this.base.J(Ab).length;Kb-=this.base.J(Ab-1).length;({Jva:Kb,afa:Ab,returnValue:Zb}=this.vHa(Aa.wg,bb,!0,Kb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Zb)return 3!==Zb&&(a.a.instance.Ta(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",ca[bb],Oa[Zb]),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,du:nb};this.T1=!1}var dc,jc;({iga:dc,
Jva:jc,afa:zb,returnValue:Zb}=this.vHa(Aa.wg,bb,!0,Aa.cp+Aa.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Zb){if(2!==Zb)return 3!==Zb&&(a.a.instance.Ta(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",ca[bb],Oa[Zb]),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,du:nb};var zb=0;for({idx:jc}=W(this.base,Aa.wg);jc<this.base.length&&
zb<Aa.cp+Aa.text.length;jc++)zb+=this.base.J(jc).length;({Jva:jc,afa:zb,returnValue:Zb}=this.vHa(Aa.wg,bb,!0,zb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Zb)return 3!==Zb&&(a.a.instance.Ta(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",ca[bb],Oa[Zb]),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,du:nb};this.T1=!1}bb="";nb=new k.a;
for(--jc;jc>=Kb;jc--)if(6!==this.Oe.J(jc).type)if(this.Oe.J(jc).vm)bb=this.Oe.J(jc).text+bb,this.Oe.QF(jc);else{if(5===this.Oe.J(jc).type)Zb=zb-bb.length;else if(2===this.Oe.J(jc).type){if(Zb=0,!({length:zb}=da(this.Oe,this.Oe.J(jc).Fj)).returnValue)return a.a.instance.Ta(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,du:nb}}else return a.a.instance.Ta(589898051,
1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,du:nb};if(!({wfa:cc}=V(this.Oe,jc+1)).returnValue)return a.a.instance.Ta(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,du:nb};var cc=this.Oe.J(cc).Fj;nb.add(new Pa.DeleteTextUpdateHint(cc,
Zb,bb));bb=""}for(--dc;dc>=Va;dc--)this.base.QF(dc);if(!({wfa:cc}=V(this.Oe,Kb)).returnValue)return a.a.instance.Ta(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,du:nb};cc=this.Oe.J(cc).Fj;bb&&bb.length&&nb.add(new Pa.DeleteTextUpdateHint(cc,Ab,bb,Aa.id,Aa.vu));return{returnValue:!0,du:nb}}Ayk(Aa,bb){var nb=null;let Va,Ab,Zb;var Kb=({iwf:Va,Mki:Ab,afa:Zb}=
this.I6h(Aa,bb,!0)).returnValue;if(0!==Kb)return 3!==Kb&&(a.a.instance.Ta(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",ca[bb],Oa[Kb]),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,du:nb};var dc;if(!({wfa:dc}=V(this.Oe,Ab)).returnValue)return a.a.instance.Ta(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),
{returnValue:!1,du:nb};Kb=this.Oe.J(dc).Fj;const jc=this.Oe.J(dc).Lc;let zb,cc,Ub;({Ht:dc,P6:zb,Tsa:cc,aaa:Ub}=this.rXl(Aa,dc));this.Byh(this.Oe,dc,zb,Ub,Ab);nb=new J.a(bb,Aa.Ht,Aa.Tsa);bb=new J.a(bb,dc,cc);nb.vm=bb;bb.vm=nb;this.base.insert(Va,nb);this.Oe.insert(Ab,bb);nb=new k.a;nb.add(new oa.a(Kb,jc,Zb,dc,cc,zb,Ub,Aa.id,Aa.vu));return{returnValue:!0,du:nb}}Xxk(Aa){let bb;bb=null;let nb,Va;var Ab;if(!({YTd:nb}=this.J6h(Aa,this.base,"Base")).returnValue)return{returnValue:!1,du:bb};if(!this.base.J(nb).vm||
!({wfa:Va}=Y(this.Oe,this.base.J(nb).vm.Fj,0)).returnValue)return a.a.instance.Ta(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.T1=!0,{returnValue:!1,du:bb};if(!({wfa:Ab}=V(this.Oe,Va+1)).returnValue)return a.a.instance.Ta(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),
this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.T1=!0,{returnValue:!1,du:bb};let Zb,Kb,dc,jc,zb,cc;({A3a:Ab,B3a:dc,bOf:Zb,Z$m:jc,I$m:Kb,J$m:zb}=this.qLl(Aa,Va,Ab));if(!({length:cc}=da(this.Oe,Ab)).returnValue)return{returnValue:!1,du:bb};this.Ayh(this.Oe,Ab,dc,Va);this.Oe.QF(Va);this.base.QF(nb);bb=new k.a;bb.add(new Ha.MergeParagraphUpdateHint(Zb,jc,cc,Kb,zb,Ab,dc,Aa.id,Aa.vu));return{returnValue:!0,du:bb}}Wwk(Aa,bb){var nb=null;let Va,Ab,Zb;
if(!({nKf:Zb,hwf:Va}=this.s8h(Aa,!0,bb)).returnValue)return{returnValue:!1,du:nb};if(!({Ohb:Ab}=this.oNc(this.base,this.Oe,Va,!0)).returnValue)return a.a.instance.Ta(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,du:nb};if(0<Ab&&2!==this.Oe.J(Ab-1).type)return a.a.instance.Ta(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.Vd.logger.Pg(Object.assign(new ia.a,
{pj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.T1=!0,{returnValue:!1,du:nb};let Kb;if(!({Ht:Kb}=this.w_h(Ab)).returnValue)return{returnValue:!1,du:nb};bb=new J.a(bb,Aa.wg,Aa.Lc);nb=Zb;nb.vm=bb;bb.vm=nb;this.base.insert(Va,Zb);this.Oe.insert(Ab,bb);nb=new k.a;nb.add(new ma.AddParagraphUpdateHint(Aa.wg,Aa.Lc,Kb,Aa.id,Aa.vu));return{returnValue:!0,du:nb}}d_e(Aa){let bb;bb=null;let nb;var Va;if(!({XTd:Va}=this.A6h(Aa,this.base,"Base")).returnValue)return{returnValue:!1,du:bb};if(!this.base.J(Va).vm||
!this.base.J(Va).vm.Fj.equals(Aa.wg))return a.a.instance.Ta(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.T1=!0,{returnValue:!1,du:bb};if(!({Ohb:nb}=this.oNc(this.base,this.Oe,Va,!0)).returnValue)return a.a.instance.Ta(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),
{returnValue:!1,du:bb};if(0<nb&&2!==this.Oe.J(nb).type)return a.a.instance.Ta(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.T1=!0,{returnValue:!1,du:bb};const Ab=this.Oe.J(nb).Fj,Zb=this.Oe.J(nb).Lc;this.Oe.QF(nb);this.base.QF(Va);({Ht:Va}=this.w_h(nb));0<nb&&6===this.Oe.J(nb-1).type&&this.Yxn(nb-1,Va);bb=new k.a;bb.add(new Ba.a(Ab,Zb,Va,Aa.id,
Aa.vu));return{returnValue:!0,du:bb}}eqh(Aa,bb,nb){let Va;var Ab=({iga:bb,Jva:Va}=this.vHa(Aa,nb,!0,bb,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==Ab)return 3!==Ab&&(a.a.instance.Ta(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",ca[nb],Oa[Ab]),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({wfa:Ab}=V(this.Oe,Va));Ab=this.Oe.J(Ab).Fj;
Aa=new ya(nb,Aa);nb=new ya(nb,Ab);Aa.vm=nb;nb.vm=Aa;this.base.insert(bb,Aa);this.Oe.insert(Va,nb);return!0}qLl(Aa,bb,nb){let Va,Ab,Zb;Va=Aa.A3a.equals(Aa.wg)?this.Oe.J(bb).Fj:this.Oe.J(nb).Fj;Aa=Aa.B3a===Aa.Lc?this.Oe.J(bb).Lc:this.Oe.J(nb).Lc;Ab=this.Oe.J(bb).Fj;bb=this.Oe.J(bb).Lc;Zb=this.Oe.J(nb).Fj;nb=this.Oe.J(nb).Lc;return{A3a:Va,B3a:Aa,bOf:Ab,Z$m:bb,I$m:Zb,J$m:nb}}rXl(Aa,bb){let nb;var Va=Aa.wg.equals(Aa.Ht)?Aa.P6:Aa.Ht;const Ab=Aa.Lc===Aa.Tsa?Aa.aaa:Aa.Tsa;Aa.wg.equals(Aa.Ht)?nb=this.Oe.J(bb).Fj:
(nb=Va,Va=this.Oe.J(bb).Fj);Aa.Lc===Aa.Tsa?(Aa=this.Oe.J(bb).Lc,bb=Ab):(Aa=Ab,bb=this.Oe.J(bb).Lc);return{Ht:nb,P6:Va,Tsa:Aa,aaa:bb}}Cyh(Aa,bb,nb,Va){for(;Va<Aa.length;Va++){if(!Aa.J(Va).I3()&&6!==Aa.J(Va).type&&2!==Aa.J(Va).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Aa.J(Va).type);break}Aa.J(Va).Fj=bb;if(2===Aa.J(Va).type){Aa.J(Va).Lc=nb;break}}}Byh(Aa,bb,nb,Va,Ab){this.Cyh(Aa,nb,Va,Ab);Ta.Dyh(Aa,bb,Ab)}Ayh(Aa,bb,nb,Va){this.Cyh(Aa,bb,nb,Va+1);Ta.Dyh(Aa,bb,Va)}J6h(Aa,
bb,nb){let Va,Ab=-1;if(!({wfa:Va}=Y(bb,Aa.wg,0)).returnValue)return a.a.instance.Ta(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+nb+"for GraphNodeId "+Aa.wg),{returnValue:!1,YTd:Va};if(!({wfa:Ab}=V(bb,Va+1)).returnValue||!bb.J(Ab).Fj.equals(Aa.P6))return a.a.instance.Ta(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+Va+1+" in "+nb+" of length "+bb.length),{returnValue:!1,YTd:Va};this.Ayh(bb,Aa.A3a,Aa.B3a,Va);return{returnValue:!0,YTd:Va}}I6h(Aa,bb,nb){let Va;
const Ab=nb?this.base:this.Oe,Zb=nb?"Base":"Derived",Kb=({iga:bb,Jva:nb,afa:Va}=this.vHa(Aa.wg,bb,nb,Aa.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===Kb||2===Kb)return a.a.instance.Ta(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Zb),{returnValue:Kb,iwf:bb,Mki:nb,afa:Va};this.Byh(Ab,Aa.Ht,Aa.P6,Aa.aaa,bb);return{returnValue:Kb,iwf:bb,Mki:nb,afa:Va}}A6h(Aa,bb,nb){return({idx:Aa}=W(bb,Aa.wg)).returnValue?2!==bb.J(Aa).type?(a.a.instance.Ta(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+
nb),{returnValue:!1,XTd:-1}):{returnValue:!0,XTd:Aa}:(a.a.instance.Ta(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+nb),{returnValue:!1,XTd:-1})}Yxn(Aa,bb){var nb=this.Oe.J(Aa);if(bb){let Va;({wfa:Va}=Y(this.Oe,bb,0));nb=nb.clone();nb.Fj=bb;this.Oe.QF(Aa);this.Oe.insert(Va,nb)}else this.Oe.length>Aa&&(this.Oe.J(Aa+1).I3()||2===this.Oe.J(Aa+1).type)&&(nb.Fj=this.Oe.J(Aa+1).Fj)}s8h(Aa,bb,nb){var Va=bb?this.base:this.Oe;bb=bb?"Base":"Derived";nb=new J.a(nb,Aa.wg,Aa.Lc);if(Aa.Ht){if(!({wfa:Va}=
Y(Va,Aa.Ht,0)).returnValue)return a.a.instance.Ta(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Aa.Ht,bb),{returnValue:!1,nKf:nb,hwf:Va};Va+=1}else Va=0;return{returnValue:!0,nKf:nb,hwf:Va}}w_h(Aa){let bb;bb=null;let nb=Aa-1;if(-1===nb)return{returnValue:!0,Ht:bb};6===this.Oe.J(nb).type&&nb--;if(2===this.Oe.J(nb).type||4===this.Oe.J(nb).type)return bb=this.Oe.J(nb).Fj,{returnValue:!0,Ht:bb};a.a.instance.Ta(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",
this.Oe.J(Aa-1).type);return{returnValue:!1,Ht:bb}}oNc(Aa,bb,nb,Va){let Ab,Zb=!0;Ab=-1;if(nb>Aa.length)return a.a.instance.Ta(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,Ohb:Ab};if(nb<Aa.length){if(-1<nb&&nb<Aa.length&&!Aa.J(nb).vm){Zb=!1;for(var Kb=nb+1;Kb<Aa.length;Kb++)if(Aa.J(Kb).vm){nb=Kb;Zb=!0;break}}if(!Zb)return{returnValue:!1,Ohb:Ab};Zb=!1;for(Kb=0;Aa.J(nb)&&Kb<bb.length;Kb++)if(bb.J(Kb).vm===Aa.J(nb)){Ab=Kb;Zb=!0;break}if(!Zb)return{returnValue:!1,
Ohb:Ab}}else Ab=bb.length;if(0<Ab&&Va&&!bb.J(Ab-1).vm){for(Aa=Ab-1;0<=Aa&&!bb.J(Aa).vm;Aa--);Ab=Aa+1;6===bb.J(Ab).type&&5!==this.Vd.input.source&&Ab++}return{returnValue:!0,Ohb:Ab}}vHa(Aa,bb,nb,Va,Ab,Zb){let Kb;var dc;let jc;var zb=this.base;let cc=this.Oe,Ub=!1;nb||(zb=this.Oe,cc=this.base);jc=dc=Kb=0;let Wb,Qa,sb=0;if(!({YOc:Va,Akb:Wb,XXc:Qa}=N(zb,Aa,Va)).returnValue)return a.a.instance.Ta(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),
{returnValue:3,iga:Kb,Jva:dc,afa:jc};0<=Va&&Va<zb.length&&!zb.J(Va).vm&&Wb&&!Ab&&(a.a.instance.Ta(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",Zb),this.T1=!0,sb=bb===zb.J(Va).source?1:2,Ub=!0);Ab&&!zb.J(Va)&&Va--;Ab&&Wb&&!zb.J(Va).vm&&(Wb=!1,Qa=0);if(!nb&&!({idx:Aa}=W(cc,Aa)).returnValue&&!Wb)return{returnValue:0,iga:Va,Jva:dc,afa:jc};if(!({Ohb:Aa}=this.oNc(zb,cc,Va,nb&&!Wb)).returnValue&&!Ub&&(bb=
!1,1===this.xgh&&0<Va&&!Qa&&(Va--,{Ohb:Aa,returnValue:bb}=this.oNc(zb,cc,Va,nb&&!Wb),bb&&(Va++,Aa<cc.length-1?Aa++:bb=!1)),!bb))return a.a.instance.Ta(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),this.Vd.logger.Pg(Object.assign(new ia.a,{pj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.T1=!0,{returnValue:3,iga:Kb,Jva:dc,afa:jc};if(Wb&&(!I(zb,Va,Qa)||!Ub&&!I(cc,Aa,Qa)))return a.a.instance.shipAssertTag(17044297,
1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,iga:Kb,Jva:dc,afa:jc};Kb=Va;dc=Aa;Wb&&(Kb=Va+1,Ub||(dc=zb.J(Va),nb=cc.J(Aa),dc.vm=nb,nb.vm=dc,zb=zb.J(Va+1),dc=cc.J(Aa+1),zb.vm=dc,dc.vm=zb,dc=Aa+1));if(dc>=cc.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+dc+" secondaryList length was "+cc.length),{returnValue:3,iga:Kb,Jva:dc,afa:jc};
for(zb=0;zb<dc;zb++)cc.J(zb).Fj.equals(cc.J(dc).Fj)&&(jc+=cc.J(zb).length);return{returnValue:sb,iga:Kb,Jva:dc,afa:jc}}kbf(Aa,bb,nb){this.sKg.contains(Aa.id)&&this.rbb.Z(Aa.id,new k.a);for(--nb;nb>=bb;nb--)this.sKg.contains(Aa.id)?this.rbb.J(Aa.id).insert(this.rbb.J(Aa.id).length,this.Oe.J(nb)):this.Oe.J(nb).vm&&(this.Oe.J(nb).vm.vm=null),this.Oe.QF(nb)}Rxf(Aa,bb,nb){if(this.rbb.ob(Aa.vu)){const Va=this.rbb.J(Aa.vu);for(let Ab=0;Ab<Va.length;Ab++)Va.J(Ab).Fj=nb.Fj,Object(ra.a)(J.a,nb)&&Object(ra.a)(J.a,
Va.J(Ab))&&(Va.J(Ab).Lc=nb.Lc);this.Oe.fA(bb,this.rbb.J(Aa.vu));this.rbb.remove(Aa.vu)}else this.Oe.insert(bb,nb)}j$l(Aa){let bb,nb;nb=bb=-1;if(!Aa.vm)return{returnValue:!1,E3b:bb,Hbf:nb};var Va;let Ab=0,Zb=!1;if(!({idx:Va}=W(this.Oe,Aa.vm.Fj)).returnValue)return{returnValue:!1,E3b:bb,Hbf:nb};for(;Va<this.Oe.length;Va++){if(Aa.vm===this.Oe.J(Va)){bb=Va;nb=Ab;Zb=!0;break}Ab+=this.Oe.J(Va).length}return{returnValue:Zb,E3b:bb,Hbf:nb}}Thf(Aa){let bb;bb=new k.a;let nb=0,Va=0;for(;nb<Aa.length;){if(Va>=
this.base.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,elc:bb};if(Aa.J(nb).length>this.base.J(Va).length){if(!I(Aa,nb,this.base.J(Va).length))return a.a.instance.Ta(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",nb,this.base.J(Va).length),{returnValue:!1,elc:bb}}else if(Aa.J(nb).length<this.base.J(Va).length){var Ab=
!!this.base.J(Va).vm,Zb=0;if(Ab&&!({Ohb:Zb}=this.oNc(this.base,this.Oe,Va,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",Va),{returnValue:!1,elc:bb};if(!I(this.base,Va,Aa.J(nb).length)||Ab&&!I(this.Oe,Zb,Aa.J(nb).length))return a.a.instance.Ta(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,elc:bb};if(Ab){Ab=this.base.J(Va);var Kb=this.Oe.J(Zb);Ab.vm=Kb;Kb.vm=Ab;Ab=this.base.J(Va+1);Zb=this.Oe.J(Zb+1);Ab.vm=Zb;Zb.vm=Ab}}if(this.base.J(Va).vm&&5!==this.base.J(Va).type&&this.base.J(Va).I3()&&(Zb=this.base.J(Va),Ab=Aa.J(nb),!Zb.JI.equals(Ab.JI)||!Zb.fF.hA(Ab.fF))){let dc;if(!({E3b:Kb,Hbf:dc}=this.j$l(this.base.J(Va))).returnValue)return{returnValue:!1,elc:bb};bb.add(new pa(this.Oe.J(Kb).Fj,dc,Zb,Ab))}nb++;Va++}return{returnValue:!0,elc:bb}}static Dyh(Aa,bb,nb){for(--nb;0<=
nb;nb--){if(!Aa.J(nb).I3()&&6!==Aa.J(nb).type){a.a.instance.shipAssertTag(17311187,1,2===Aa.J(nb).type||4===Aa.J(nb).type,"Found merge block of type "+Aa.J(nb).type);break}Aa.J(nb).Fj=bb}}static xsi(Aa){return Aa?!1:(a.a.instance.Ta(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(D.a)(Ta,"ParagraphMergeUsingHintsTwinList",null,[1933]);var eb=c(1707),jb=c(1708),ob=c(1704),Ya=c(1706),Xa=c(1705);class Sa{constructor(Aa,bb,
nb,Va){this.cp=Aa;this.length=bb;this.gAd=nb;this.G$c=Va}}Object(D.a)(Sa,"UpdateFormattingIdsPosInfo",null,[]);class ab{constructor(Aa,bb,nb){this.T1=!1;this.rbb=new y.a;this.X2g=!1;this.Vd=Aa;this.xgh=nb;this._base=bb;this.Tve=ba(bb);if(!P(this.base,this.Oe))throw a.a.instance.Ta(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Aa.logger.Pg(Object.assign(new H.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");this.Vd.runtime.Xb.lhb(1000010)&&(this.X2g=!0)}get base(){return this._base}get Oe(){return this.Tve}get mergeConflict(){return this.T1}H_e(Aa,
bb){switch(Aa.type){case 11:return this.Cxk(Aa,bb);case 8:return this.g_e(Aa,bb);case 10:return this.e_e(Aa);default:return!1}}G_e(Aa,bb){switch(Aa.type){case 11:return this.Bxk(Aa,bb);case 8:return this.f_e(Aa,bb);case 10:return this.d_e(Aa);default:return{returnValue:!1,du:null}}}fqh(){a.a.instance.Ta(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}eqh(){a.a.instance.Ta(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}Thf(Aa){let bb;bb=new k.a;let nb=0,Va=0,Ab=0;for(;nb<Aa.length;){if(Va>=this.base.length)return a.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,F$c:bb};if(Aa.J(nb).length>this.base.J(Va).length){if(!I(Aa,nb,this.base.J(Va).length))return a.a.instance.Ta(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,F$c:bb}}else if(Aa.J(nb).length<this.base.J(Va).length&&!this.k6a(Ab+Aa.J(nb).length,!0).returnValue)return a.a.instance.Ta(574433299,1,2,
"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,F$c:bb};if(this.base.J(Va).vm&&5!==this.base.J(Va).type&&this.base.J(Va).I3()){const Zb=this.base.J(Va),Kb=Aa.J(nb);if(!Zb.JI.equals(Kb.JI)||!Zb.fF.hA(Kb.fF)){let dc,jc;if(({E3b:dc,RMh:jc}=this.k$l(this.base.J(Va))).returnValue)bb.add(new Sa(jc,this.Oe.J(dc).length,Zb,Kb));else return a.a.instance.Ta(571757956,
1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,F$c:bb}}}Ab+=this.base.J(Va).length;nb++;Va++}return{returnValue:!0,F$c:bb}}Cxk(Aa,bb){let nb;if(!({ZCa:nb}=this.k6a(Aa.cp,!0)).returnValue)return a.a.instance.Ta(574433300,1,2,"ApplyInsertTextHintToDerived"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ApplyInsertTextHintToDerived",
eventId:"8ps6u"})),!1;for(let Ab=0;Ab<Aa.h_.length;Ab++)switch(Aa.h_.J(Ab).type){case 7:var Va=Aa.h_.J(Ab);this.Oe.insert(nb,new Ca(bb,null,Va.text,Va.id));break;case 9:Va=Aa.h_.J(Ab);this.Oe.insert(nb,new J.a(bb,Va.wg,Va.Lc));break;default:return a.a.instance.Ta(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}g_e(Aa,bb){let nb,Va;if(!({ZCa:nb}=this.k6a(Aa.cp,!0)).returnValue||!({ZCa:Va}=this.k6a(Aa.cp+
Aa.text.length,!1)).returnValue)return a.a.instance.Ta(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Aa=Va;Aa>=nb;Aa--)this.Oe.J(Aa).source!==bb&&this.QGd(this.Oe,Aa);return!0}e_e(Aa){let bb;if(!({ZCa:bb}=this.k6a(Aa.cp,!0)).returnValue)return a.a.instance.Ta(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),
!1;this.obf(this.Oe,Aa,bb);return!0}Bxk(Aa,bb){let nb;nb=null;let Va,Ab;if(!({Iyb:Va,ZCa:Ab}=this.k6a(Aa.cp,!0)).returnValue)return a.a.instance.Ta(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,du:nb};var Zb=this.Dmf(this.Oe,Ab-1);Zb=new Xa.a(Zb);for(let Kb=0;Kb<Aa.h_.length;Kb++)switch(Aa.h_.J(Kb).type){case 7:Zb.h_.add(this.k_e(Aa.h_.J(Kb),bb,Va,Ab));break;
case 9:Zb.h_.add(this.Dxk(Aa.h_.J(Kb),bb,Va,Ab));break;default:return a.a.instance.Ta(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,du:nb}}nb=new k.a;nb.add(Zb);return{returnValue:!0,du:nb}}k_e(Aa,bb,nb,Va){const Ab=new Ca(bb,Aa.wg,Aa.text,Aa.id);bb=new Ca(bb,Aa.wg,Aa.text,Aa.id);Ab.vm=bb;bb.vm=Ab;this.base.insert(nb,Ab);this.Oe.insert(Va,bb);nb=new Ya.a(Aa.wg,Aa.text);nb.id=Aa.id;return nb}Dxk(Aa,
bb,nb,Va){const Ab=new J.a(bb,Aa.wg,Aa.Lc);bb=new J.a(bb,Aa.wg,Aa.Lc);Ab.vm=bb;bb.vm=Ab;this.base.insert(nb,Ab);this.Oe.insert(Va,bb);return new ob.a(Aa.wg,Aa.Lc)}f_e(Aa){let bb;bb=new k.a;let nb;var Va;let Ab;if(!({Iyb:nb,ZCa:Va}=this.k6a(Aa.cp,!0)).returnValue||!({Iyb:Ab,ZCa:Zb}=this.k6a(Aa.cp+Aa.text.length,!1)).returnValue)return a.a.instance.Ta(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),
{returnValue:!1,du:bb};this.Vd.runtime.Xb.IRd(1000010);for(Aa=Zb;Aa>=Va;Aa--)if(this.Oe.J(Aa).vm){var Zb=Aa;const Kb=({XNf:Aa}=this.Nul(Aa,Va)).returnValue;Kb&&(bb.add(Kb),this.QGd(this.Oe,Aa,Zb))}for(Va=Ab;Va>=nb;Va--)this.QGd(this.base,Va);return{returnValue:!0,du:bb}}d_e(Aa){let bb;bb=null;let nb,Va;if(!({Iyb:nb,ZCa:Va}=this.k6a(Aa.cp,!0)).returnValue)return a.a.instance.Ta(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ApplyDeleteParaHintToBaseAndDerived",
eventId:"8ps6z"})),{returnValue:!1,du:bb};if(!this.obf(this.base,Aa,nb))return a.a.instance.Ta(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,du:bb};this.obf(this.Oe,Aa,Va)&&(bb=new k.a,bb.add(new eb.a(this.Dmf(this.Oe,Va-1),Aa.wg,Aa.Lc)));return{returnValue:!0,du:bb}}k6a(Aa,bb){var nb;var Va=nb=-1;let Ab,Zb;if(!({Akb:Zb,Wsh:Aa,Vsh:Ab}=M(this.base,Aa,this.Vd.logger)).returnValue)return{returnValue:!1,
Iyb:nb,ZCa:Va};const Kb=Aa>=this.base.length;Kb&&Aa--;if(this.base.J(Aa).vm){const dc=this.jwl(this.Oe,this.base.J(Aa));if(Zb){if(0>dc||!I(this.base,Aa,Ab)||!I(this.Oe,dc,Ab))return a.a.instance.Ta(575706444,1,2,"SplitTwinListAndFindIdx"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,Iyb:nb,ZCa:Va};nb=this.base.J(Aa);Va=this.Oe.J(dc);nb.vm=Va;Va.vm=nb;nb=this.base.J(Aa+1);Va=this.Oe.J(dc+1);nb.vm=Va;Va.vm=nb;nb=bb?Aa+1:Aa;Va=bb?dc+1:dc}else bb?
(nb=Kb?Aa+1:Aa,Va=Kb?dc+1:dc):(nb=Kb?Aa:Aa-1,Va=Kb?dc:dc-1)}else if(Zb){if(I(this.base,Aa,Ab))nb=bb?Aa+1:Aa;else return a.a.instance.Ta(575706445,1,2,"SplitTwinListAndFindIdx"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,Iyb:nb,ZCa:Va};bb?(Va=({$Eb:Va}=this.f5b(this.base,this.Oe,Aa,!1)).returnValue?Va+1:0,Va=Va>=this.Oe.length?this.Oe.length-1:Va):(Va=({$Eb:Va}=this.f5b(this.base,this.Oe,Aa,!0)).returnValue?Va-1:this.Oe.length-1,Va=0>Va?
0:Va)}else bb?(({$Eb:Va}=this.f5b(this.base,this.Oe,Aa,!0)).returnValue||(({$Eb:Va}=this.f5b(this.base,this.Oe,Aa,!1)).returnValue?Va+=1:(Va=Kb?this.Oe.length-1:0,Va=0>Va?0:Va)),nb=Kb?Aa+1:Aa):(({$Eb:Va}=this.f5b(this.base,this.Oe,Aa,!1)).returnValue||(({$Eb:Va}=this.f5b(this.base,this.Oe,Aa,!0)).returnValue?--Va:(Va=Aa?this.Oe.length-1:0,Va=0>Va?0:Va)),nb=Kb?Aa:Aa-1);return{returnValue:!0,Iyb:nb,ZCa:Va}}f5b(Aa,bb,nb,Va){let Ab=null;if(Va)for(;nb<Aa.length;nb++){if(Aa.J(nb).vm){Ab=Aa.J(nb).vm;break}}else for(;0<=
nb;nb--)if(Aa.J(nb).vm){Ab=Aa.J(nb).vm;break}if(Ab)for(Aa=0;Aa<bb.length;Aa++)if(bb.J(Aa)===Ab)return bb=Aa,{returnValue:!0,$Eb:bb};return{returnValue:!1,$Eb:-1}}jwl(Aa,bb){for(let nb=0;nb<Aa.length;nb++)if(Aa.J(nb).vm===bb)return nb;return-1}QGd(Aa,bb,nb=-1){for(nb=0>nb?bb:nb;nb>=bb;nb--)Aa.J(nb).vm&&(Aa.J(nb).vm.vm=null),Aa.QF(nb)}Dmf(Aa,bb){let nb=0;for(;0<=bb;bb--)nb+=Aa.J(bb).length;return nb}D8l(Aa){Aa=Object(m.a)(fa.a,Aa);Aa||(a.a.instance.Ta(575706448,1,2,"GetTextBlock"),this.Vd.logger.Pg(Object.assign(new H.a,
{pj:"GetTextBlock",eventId:"8ujvq"})));return Aa}Nul(Aa,bb){let nb="",Va=Aa;for(;Va>=bb&&this.Oe.J(Va).vm&&2!==this.Oe.J(Va).type;)nb=this.D8l(this.Oe.J(Va)).text+nb,Va--;bb=0>Va?0:this.Dmf(this.Oe,Va);return!this.X2g||Va<Aa?(Aa=Va+1,{returnValue:new jb.a(bb,nb),XNf:Aa}):{returnValue:null,XNf:Va}}k$l(Aa){let bb,nb,Va=!1;nb=bb=0;if(!Aa.vm)return{returnValue:!1,E3b:bb,RMh:nb};for(bb=0;bb<this.Oe.length;bb++){if(this.Oe.J(bb).vm===Aa){Va=!0;break}nb+=this.Oe.J(bb).length}return{returnValue:Va,E3b:bb,
RMh:nb}}obf(Aa,bb,nb){nb=nb===Aa.length?--nb:nb;nb>Aa.length-1&&(a.a.instance.Ta(571757957,1,2,"DeleteEopInList: Idx out of range"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"DeleteEopInList",eventId:"8ffwf"})));if(2===Aa.J(nb).type){const Va=Aa.J(nb);if(Va.Fj!==bb.wg||Va.Lc!==bb.Lc)return!1;this.QGd(Aa,nb);return!0}return!1}}Object(D.a)(ab,"ParagraphMergeUsingHintsTwinListLcs",null,[1933]);var Hb=c(1553),pb=c(1521),Mb=c(1703);c.d(L,"a",function(){return Qb});class Qb{constructor(Aa,bb,nb,Va,Ab,
Zb,Kb=null,dc=null,jc=null){this.tP=this.Msa=this.NJa=this.Pqa=null;this._initialized=!1;this.Vd=Aa;this.mF=bb;this.iBa=Va;this.Rza=nb;this.rra=Ab;this.Nre=new e.a;for(Aa=0;Aa<this.mF.length;Aa++)this.Nre.add(this.mF.J(Aa).id);this.jRg=new e.a;for(Aa=0;Aa<this.Rza.length;Aa++)this.jRg.add(this.Rza.J(Aa).id);this.kgh=new e.a;for(Aa=0;Aa<this.iBa.length;Aa++)this.kgh.add(this.iBa.J(Aa).id);this.Lg=Zb;this.rUe=Kb||E.a.instance;this.$H=dc;this.lW=jc;this.Dtb=1===(this.$H&&this.lW&&1===this.$H.nIa&&1===
this.lW.nIa?1:0);this.qra=0}get U4f(){return 1!==this.qra}fsm(){var Aa=!0;if(this.$H&&this.lW)return Aa;if(this.$H||this.lW)return a.a.instance.Ta(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),!1;this.Vd.runtime.ru.ob(v.a.eL)&&(Aa=this.Vd.runtime.ru.J(v.a.eL),Aa=this.Pkg(Aa,this.Vd.runtime.tCa.id,"favored")&&({updateHints:this.$H}=this.Smi(Aa,
this.Nre,this.jRg,this.Vd.runtime.ru,"favored")).returnValue);Aa&&this.Vd.runtime.zq.ob(v.a.eL)&&(Aa=this.Vd.runtime.zq.J(v.a.eL),Aa=this.Pkg(Aa,this.Vd.runtime.tCa.id,"unfavored")&&({updateHints:this.lW}=this.Smi(Aa,this.Nre,this.kgh,this.Vd.runtime.zq,"unfavored")).returnValue);this.$H=this.$H?this.$H:new Mb.a(new k.a,0);this.lW=this.lW?this.lW:new Mb.a(new k.a,0);Aa&&this.Vd.input.bFb&&(Aa=this.Vd.input.x9.last().x0a(v.a.eL),Aa=this.Pkg(Aa,this.Vd.input.x9.last().AW.id,"alreadyMerged"));return Aa}nqm(){const Aa=
new e.a;if(this.Dtb)return Aa;const bb=this.$H?this.$H.updateHints.y4():new k.a;let nb=0;for(;nb<bb.length-1;){const Va=bb.J(nb);let Ab,Zb=!1;for(Ab=nb+1;Ab<bb.length;Ab++){const Kb=bb.J(Ab);if(Va.Yti(Kb)){Aa.add(Va.id);bb.QF(Ab);bb.QF(nb);Zb=!0;break}}Zb||nb++}return Aa}Pkg(Aa,bb,nb){Aa=this.Lg.getPropertyString(Aa,l.a.yTa);Aa=x.a.Gf(Aa);return bb.equals(Aa)?!0:(this.C5c(2),a.a.instance.Ta(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",
this.Vd.runtime.tCa.id,Aa,nb),!1)}Smi(Aa,bb,nb,Va,Ab){let Zb;Zb=new Mb.a(new k.a,0);Aa=this.Lg.getPropertyObjectIds(Aa,l.a.L0).y4();for(let dc=0;dc<Aa.length;dc++){if(!Va.ob(Aa.J(dc)))return a.a.instance.Ta(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",Aa.J(dc),Ab),{returnValue:!1,updateHints:Zb};const jc=Va.J(Aa.J(dc));var Kb=x.a.Gf(this.Lg.getPropertyString(jc,l.a.Mia));if(bb.contains(Kb)||nb.contains(Kb)){Kb=
this.rUe.JOc(jc);if(!Kb)return a.a.instance.Ta(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",jc.id,Ab),{returnValue:!1,updateHints:Zb};Zb.updateHints.add(Kb)}}0<Aa.length&&a.a.instance.Ta(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",Ab,Aa.Pq(),Zb.updateHints.Pq());return{returnValue:!0,
updateHints:Zb}}qrm(){return({iK:this.Pqa,rKc:this.NJa,W9c:this.Msa}=Hb.a.fIh(this.Vd,this.Lg,this.mF,this.Rza,this.iBa,this.rra,!0,!0)).returnValue?!0:!1}dsm(Aa){const bb=Hb.a.xFd(this.Lg,nb=>this.Vd.runtime.pk.J(nb),this.mF,1,this.rra,!0,!0).returnValue;if(!bb)return a.a.instance.Ta(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.tP=this.Dtb?new ab(this.Vd,bb,1):new Ta(this.Vd,bb,Aa,this.$H?this.$H.nIa:0);return!0}initialize(){if(this._initialized)return!1;
this._initialized=!0;if(!this.fsm()||!this.qrm())return!1;const Aa=this.nqm();return this.dsm(Aa)?!0:!1}u8h(Aa){const bb=new k.a;let nb="";for(let Va=0;Va<Aa.length;Va++){const Ab=Aa.J(Va);Ab.I3()?nb+=Aa.J(Va).text:2===Ab.type?(bb.add(new ta(Ab.Fj,Ab.type,nb,Ab.Lc)),nb=""):4===Ab.type&&(bb.add(new ta(Ab.Fj,Ab.type)),nb="")}return bb}validateUpdateHintsAreComplete(Aa,bb,nb){bb=this.u8h(bb);Aa=this.u8h(Aa);let Va=bb.length===Aa.length;if(Va)for(let Ab=0;Ab<bb.length;Ab++)if(!bb.J(Ab).isEqual(Aa.J(Ab))){Va=
!1;break}Va||(this.C5c(4),a.a.instance.Ta(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",nb,Aa.Pq(),bb.Pq()));return Va}Nqh(Aa,bb,nb){(bb=({f7a:Aa}=this.jzk(Aa,bb,nb)).returnValue)||this.C5c(this.tP.mergeConflict?1:3);return{returnValue:bb,f7a:Aa}}jzk(Aa,bb,nb){let Va;Va=new k.a;let Ab=!0;var Zb=0;let Kb=null,dc=this.$H?this.$H.updateHints.length:0;for(var jc=0;jc<dc&&Ab;jc++)Kb=
this.$H.updateHints.J(jc),Zb<this.lW.updateHints.length&&Kb.id.equals(this.lW.updateHints.J(Zb).id)&&5!==this.Vd.input.source?({returnValue:Ab}=this.tP.G_e(Kb,2),Zb++):Ab=this.tP.H_e(Kb,2);if(!Ab)return a.a.instance.Ta(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",Kb.toString()),{returnValue:!1,f7a:Va};if(!this.validateUpdateHintsAreComplete(this.tP.Oe,this.NJa,"Favored"))return{returnValue:!1,f7a:Va};if(Aa&&1===this.Vd.input.$ga&&!this.tP.fqh(bb,nb,2))return a.a.instance.Ta(17409920,
1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",bb,nb),{returnValue:!1,f7a:Va};Ab=!0;jc=new k.a;for(dc=this.lW?this.lW.updateHints.length:0;Zb<dc&&Ab;Zb++){Kb=this.lW.updateHints.J(Zb);let zb;({du:zb,returnValue:Ab}=this.tP.G_e(Kb,4));Ab&&zb&&jc.fA(jc.length,zb)}return Ab?this.validateUpdateHintsAreComplete(this.tP.base,this.Msa,"Unfavored")?Aa&&2===this.Vd.input.$ga&&!this.tP.eqh(bb,nb,4)?(a.a.instance.Ta(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
bb,nb),{returnValue:!1,f7a:Va}):{returnValue:!0,f7a:jc}:{returnValue:!1,f7a:Va}:(a.a.instance.Ta(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",Kb.id,Kb.type),{returnValue:!1,f7a:Va})}ZVl(){let Aa,bb=0;let nb=0,Va=x.a.nil;for(Aa=new y.a;nb<this.tP.base.length;){const Kb=this.tP.base.J(nb);Va.equals(Kb.Fj)||(bb=0,Va=Kb.Fj);if(5===Kb.type){var Ab=bb+Kb.length;var Zb=void 0;let dc;const jc=ba(this.Msa);if(!({index:Zb}=T(jc,Kb.Fj,bb)).returnValue||!({index:dc}=
T(jc,Kb.Fj,Ab)).returnValue)return a.a.instance.Ta(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",Kb.k$c),{returnValue:!1,EHi:Aa};for(Ab=new k.a;Zb<dc;Zb++)Ab.add(jc.J(Zb));Aa.Z(Kb.k$c,Ab)}bb+=Kb.length;nb++}return{returnValue:!0,EHi:Aa}}$Vl(){let Aa;Aa=new y.a;let bb=0;for(let Va=0;Va<this.tP.base.length;Va++){const Ab=this.tP.base.J(Va);if(5===Ab.type){var nb=void 0;let Zb;const Kb=ba(this.Msa);
if(!({index:nb}=U(Kb,bb,this.Vd.logger)).returnValue||!({index:Zb}=U(Kb,bb+Ab.length,this.Vd.logger)).returnValue)return a.a.instance.Ta(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,FHi:Aa};const dc=new k.a;for(;nb<Zb;nb++)dc.add(Kb.J(nb));Aa.Z(Ab.k$c,dc)}bb+=Ab.length}return{returnValue:!0,FHi:Aa}}Zxk(Aa){let bb;bb=new k.a;let nb;if(this.Dtb){if(!({FHi:nb}=this.$Vl()).returnValue)return{returnValue:!1,AXc:bb}}else if(!({EHi:nb}=this.ZVl()).returnValue)return{returnValue:!1,
AXc:bb};let Va;Va=this.Dtb?new ab(this.Vd,ba(this.NJa),1):new Ta(this.Vd,ba(this.NJa),new e.a,this.$H?this.$H.nIa:0);for(var Ab=0;Ab<Aa.length;Ab++)if(!Va.H_e(Aa.J(Ab),4))return{returnValue:!1,AXc:bb};for(Aa=Va.Oe.length-1;0<=Aa;Aa--)5===Va.Oe.J(Aa).type&&(Ab=Va.Oe.J(Aa).k$c,Va.Oe.QF(Aa),Va.Oe.fA(Aa,nb.J(Ab)));this.Dtb&&(this.fLh(Va.Oe),this.fLh(this.tP.Oe));if(!this.validateUpdateHintsAreComplete(this.tP.Oe,Va.Oe,"Merged"))return{returnValue:!1,AXc:bb};bb=Va.Oe;return{returnValue:!0,AXc:bb}}fLh(Aa){const bb=
new y.a;for(let nb=Aa.length-1;0<=nb;nb--){const Va=Object(m.a)(J.a,Aa.J(nb));Va&&(bb.ob(Va.Lc)?bb.J(Va.Lc).source!==Va.source&&Aa.QF(nb):bb.add(Va.Lc,Va))}}izk(Aa){let bb;if(!({F$c:bb}=this.tP.Thf(ba(this.Msa))).returnValue)return!1;for(let Va=0;Va<bb.length;Va++){const Ab=bb.J(Va);let Zb,Kb;if(!({index:Zb}=U(Aa,Ab.cp,this.Vd.logger)).returnValue||!({index:Kb}=U(Aa,Ab.cp+Ab.length,this.Vd.logger)).returnValue)return a.a.instance.Ta(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),
this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var nb=!1;for(let dc=Zb;dc<Kb&&!nb;dc++)nb=!Ab.gAd.JI.equals(Aa.J(dc).JI);if(!nb){for(nb=Zb;nb<Kb;nb++)Aa.QF(Zb);Aa.insert(Zb,Ab.G$c)}}return!0}hzk(Aa){let bb;if(!({elc:bb}=this.tP.Thf(ba(this.Msa))).returnValue)return!1;for(let Ab=0;Ab<bb.length;Ab++){var nb=bb.J(Ab);let Zb,Kb;if(({index:Zb}=T(Aa,nb.wg,nb.cp)).returnValue&&({index:Kb}=T(Aa,nb.wg,nb.cp+nb.G$c.length)).returnValue){var Va=!1;for(let dc=
Zb;dc<Kb&&!Va;dc++)Va=!nb.gAd.JI.equals(Aa.J(dc).JI)||!nb.gAd.fF.hA(Aa.J(dc).fF);if(Va){if(this.$H&&1===this.$H.nIa||this.lW&&1===this.lW.nIa)return!1}else{for(Va=Zb;Va<Kb;Va++)Aa.QF(Zb);Aa.insert(Zb,nb.G$c)}}else if(nb=nb.G$c.Txm,a.a.instance.Ta(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",nb),nb||this.$H&&1===this.$H.nIa||this.lW&&1===this.lW.nIa)return!1}return!0}c0l(Aa){let bb,nb;nb=new k.a;
bb=this.Vd.runtime.Xm.J(v.a.eL);let Va;({vKf:Va}=Qb.U_h(this.Vd,this.Lg));const Ab=new k.a;for(let Kb=0;Kb<Aa.length;Kb++){if(Va.contains(Aa.J(Kb).id,(jc,zb)=>jc.equals(zb)))continue;if(this.Vd.runtime.Xm.ob(Aa.J(Kb).id))return a.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Aa.J(Kb).id),{returnValue:!1,a8d:bb,$7d:nb};Ab.add(Aa.J(Kb).id);var Zb=Aa.J(Kb).B0a();const dc=new pb.a(Zb);Zb=Zb.Fl();for(const jc of Zb)dc.aC(jc);nb.add(dc)}Aa=this.Lg.getPropertyObjectIds(bb.om,
l.a.L0);Aa.fA(Aa.length,Ab);this.Lg.setPropertyObjectIds(bb.om,l.a.L0,Aa);return{returnValue:!0,a8d:bb,$7d:nb}}ENd(Aa){return String.format("Name: {0}, Message: {1}, Stack: {2}",Aa.name,Aa.message,Aa.stack)}C5c(Aa){0===this.qra&&(this.qra=Aa)}Rkc(){let Aa;Aa=null;let bb,nb;var Va;try{if({Xm:Aa,a8d:bb,$7d:nb,returnValue:Va}=this.EGo(),Va){if(bb&&nb){this.Vd.runtime.Xm.Z(bb.om.id,bb);for(Va=0;Va<nb.length;Va++){const dc=nb.J(Va);this.Vd.runtime.Xm.Z(dc.om.id,dc)}const Ab=bb.om,Zb=this.Lg.getPropertyObjectIds(Ab,
l.a.L0),Kb=this.Lg.getPropertyString(Ab,l.a.yTa);a.a.instance.Ta(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Zb.Pq(),Kb)}else a.a.instance.Ta(593826831,1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,Xm:Aa}}}catch(Ab){a.a.instance.Ta(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.ENd(Ab))}this.C5c(5);a.a.instance.Ta(17409922,
1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.qra,this.U4f);this.j3a();this.$H&&1===this.$H.nIa&&this.Vd.logger.Pg(Object.assign(new ja.a,{eventId:"bc04c",pj:"ParagraphMergeUsingHints.TryDoMerge",info:u[this.qra]+"/LCS"}));return{returnValue:!1,Xm:Aa}}EGo(){let Aa,bb,nb;nb=bb=Aa=null;let Va;Va=this.initialize();this.Vd.logger.kU("PMUH Initialize");let Ab=null;Va=Va&&({f7a:Ab}=this.Nqh(!1,x.a.nil,0)).returnValue;this.Vd.logger.kU("PMUH ApplyUpdateHints");
let Zb=new k.a;Va=Va&&({AXc:Zb}=this.Zxk(Ab)).returnValue;this.Vd.logger.kU("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");Va=this.Dtb?Va&&this.izk(Zb):Va&&this.hzk(Zb);this.Vd.logger.kU("PMUH ApplyUnfavoredFormattingChanges");this.Dtb&&!this.q1n(Zb)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.Vd.logger.Pg(Object.assign(new H.a,{pj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),Va=!1);const Kb=this.vPd(Zb);Va=Va&&({Z7d:Aa}=Hb.a.BNc(this.Vd,this.Lg,
this.rra,Zb,Kb)).returnValue;this.Vd.logger.kU("PMUH GetMergeableObjectsFromMergeBlocks");this.$H&&1===this.$H.nIa&&this.lW&&1===this.lW.nIa||(Va=Va&&({a8d:bb,$7d:nb}=this.c0l(F(Ab))).returnValue,this.Vd.logger.kU("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:Va,mergeConflict:!!this.tP&&this.tP.mergeConflict,Xm:Aa,a8d:bb,$7d:nb}}vPd(Aa){const bb=new k.a;for(let nb=0;nb<Aa.length;nb++)2===Aa.J(nb).type&&bb.add(Aa.J(nb).Fj);return bb}unf(Aa){const bb=new k.a;for(let nb=0;nb<Aa.length;nb++)2===
Aa.J(nb).type&&bb.add(Aa.J(nb));return bb}q1n(Aa){var bb=this.unf(this.Pqa),nb=this.unf(this.NJa),Va=this.unf(this.Msa),Ab=this.vPd(bb),Zb=this.vPd(nb),Kb=this.vPd(Va);Zb=K.b(Ab,Zb,Kb);Ab=new k.a;for(Kb=0;Kb<Zb.length;Kb++)Ab.fA(Ab.length,Zb.J(Kb).lwl());Zb=this.qwl(Aa);bb=this.mwl(Zb,Ab,bb,nb,Va);nb=0;Va=new e.a;for(Ab=0;Ab<Aa.length;Ab++)if(Zb=Aa.J(Ab),2===Zb.type)if(Va.contains(Zb.Fj))if(nb<bb.length)Aa.QF(Ab),Aa.insert(Ab,bb.J(nb)),nb++;else return!1;else Va.add(Zb.Fj);0<Aa.length&&2!==Aa.J(Aa.length-
1).type&&nb<bb.length&&Aa.insert(Aa.length,bb.J(nb));return!0}qwl(Aa){const bb=new e.a;for(let nb=0;nb<Aa.length;nb++)2===Aa.J(nb).type&&bb.add(Aa.J(nb).Fj);return bb}mwl(Aa,bb,nb,Va,Ab){const Zb=new k.a;for(let Kb=0;Kb<bb.length;Kb++){const dc=bb.J(Kb);if(!Aa.contains(dc)){let jc;(({block:jc}=this.Khf(Va,dc)).returnValue||({block:jc}=this.Khf(Ab,dc)).returnValue||({block:jc}=this.Khf(nb,dc)).returnValue)&&jc&&Zb.add(jc)}}return Zb}Khf(Aa,bb){for(let nb=0;nb<Aa.length;nb++)if(2===Aa.J(nb).type&&Aa.J(nb).Fj===
bb)return Aa=Aa.J(nb),{returnValue:!0,block:Aa};return{returnValue:!1,block:null}}j3a(){const Aa=new k.a;Hb.a.Pbc(this.Lg,"BaseObjects_",this.mF,Aa);Hb.a.Pbc(this.Lg,"FavoredObjects_",this.Rza,Aa);Hb.a.Pbc(this.Lg,"ConflictObjects_",this.iBa,Aa)}rKk(){let Aa,bb;Aa=x.a.nil;bb=-1;let nb=0;for(let Va=0;Va<this.tP.Oe.length;Va++){const Ab=this.tP.Oe.J(Va);if(Ab.I3())nb+=Ab.length;else if(6!==Ab.type)nb=0;else return Aa=Ab.Fj,bb=nb,{returnValue:!0,objectId:Aa,cp:bb}}a.a.instance.Ta(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");
return{returnValue:!1,objectId:Aa,cp:bb}}g$c(Aa,bb){let nb,Va;Va=bb;nb=Aa;try{let Ab=this.initialize();if(Ab=(Ab=Ab&&this.Nqh(!0,Aa,bb).returnValue)&&({objectId:nb,cp:Va}=this.rKk()).returnValue)return a.a.instance.Ta(17409924,1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",nb,Va),{returnValue:!0,g5a:nb,spa:Va}}catch(Ab){a.a.instance.Ta(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.ENd(Ab))}this.C5c(5);
a.a.instance.Ta(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.qra,this.U4f);this.j3a();return{returnValue:!1,g5a:nb,spa:Va}}static U_h(Aa,bb){let nb;nb=new k.a;if(!Aa.input.bFb)return{returnValue:!0,vKf:nb};Aa=Aa.input.x9.last().x0a(v.a.eL);nb=bb.getPropertyObjectIds(Aa,l.a.L0);return{returnValue:!0,vKf:nb}}static Ayn(Aa){if(!Hb.a.Edf(Aa))return!0;const bb=new z.a;Aa.runtime.Xm.Z(v.a.eL,Hb.a.gsm(Aa,
bb));return!0}static jyn(Aa){if(!Aa.runtime.Xm.ob(v.a.eL)||!Aa.runtime.zq.ob(v.a.eL))return!0;const bb=new z.a,nb=Aa.runtime.Xm.J(v.a.eL);var Va=bb.getPropertyString(nb.om,l.a.yTa);if(x.a.Gf(Va).equals(x.a.nil))return!0;Va=bb.getPropertyObjectIds(nb.om,l.a.L0);const Ab=bb.getPropertyObjectIds(Aa.runtime.zq.J(v.a.eL),l.a.L0);let Zb;({vKf:Zb}=Qb.U_h(Aa,bb));for(let Kb=0;Kb<Ab.length;Kb++)Va.contains(Ab.J(Kb),(dc,jc)=>dc.equals(jc))||Zb.contains(Ab.J(Kb),(dc,jc)=>dc.equals(jc))||(Va.add(Ab.J(Kb)),Aa.runtime.Xm.Z(Ab.J(Kb),
new pb.a(Aa.runtime.zq.J(Ab.J(Kb)).fH())));bb.setPropertyObjectIds(nb.om,l.a.L0,Va);return!0}}Object(D.a)(Qb,"ParagraphMergeUsingHints",null,[1869])},1633:function(D,L,c){D=c(0);class l{constructor(m){this.pKi=m;this.succeeded=!1;this.Lkc=m?m.Lkc:0;this.mLm=!1;this.length=this.Uzo=0}}Object(D.a)(l,"TrieResult",null,[]);class e{constructor(m,u,z){this.hkb=new l(null);this.L2m=m;this.RWc=u;this.lFi=u+z-1}get result(){return this.hkb}M8h(){let m;return this.RWc<=this.lFi?(m=this.L2m.charAt(this.RWc),
++this.RWc,{returnValue:!0,ch:m}):{returnValue:!1,ch:"\x00"}}y1f(m,u,z){m&&(this.hkb.mLm=!0,this.hkb.Uzo=u);this.hkb.length=this.RWc;this.hkb.succeeded=!0;this.hkb.Lkc=z;this.RWc!==this.lFi+1&&(this.hkb=new l(this.hkb))}}Object(D.a)(e,"LookUpStringVisitor",null,[1397]);var a=c(1719);class k{constructor(){this.hyh=this.Hvh=this.Jvh=this.Gvh=this.Ivh=this.W2e=this.U2e=this.Y2e=this.T2e=0}}Object(D.a)(k,"TRIESTATS",null,[]);class x{constructor(){this.symbol=this.tYc=0}}Object(D.a)(x,"TrieSymbol",null,
[]);c.d(L,"a",function(){return y});class y{constructor(m,u){this.J3=null;this.F1d=this.AFi=this.yFi=this.CFi=this.uFi=this.BFi=this.zFi=this.DFi=this.vFi=0;this.fJ=m;if(m.oy(u,4)!==y.azb)throw Error.argument("Input does not represent a trie");u+=4;this.nFi=1===m.oy(u,4);u+=4;this.I2m=1===m.oy(u,4);u+=4;this.E2m=m.oy(u,4);u+=4;if(m.oy(u,4)){m=u+4;this.J3=this.UIn(m);this.vFi=u=m+y.NIk;this.DFi=u+=y.$Ad*(this.J3.T2e+(this.J3.T2e%2?1:0));this.zFi=u+=y.$Ad*(this.J3.Y2e+(this.J3.Y2e%2?1:0));this.BFi=
u+=y.$Ad*(this.J3.U2e+(this.J3.U2e%2?1:0));this.uFi=u+=y.$Ad*(this.J3.W2e+(this.J3.W2e%2?1:0));this.CFi=u+=y.$2e*this.J3.Gvh;this.yFi=u+=y.a3e*this.J3.Jvh;this.AFi=u+=y.a3e*this.J3.Hvh;u+=y.a3e*this.J3.Ivh;if(u!==m+this.J3.hyh)throw Error.argument("Corrupted trie binary");this.F1d=u}else this.J3=null}MEi(m,u,z,v){m=new e(m,u,z);this.yDj(m,v);return m.result}Rci(m){if(this.nFi)if(m)--m;else return"";if(!this.J3)throw Error.argument("Invalid trieID");const u=new a.a;u.lF=0;this.kPb(u);const z=[];for(;;){if(u.lF&
y.X7a)if(m)--m;else return Array.add(z,u.hQb),String.fromCharCode.apply(null,z);const v=!!(u.lF&y.bpe),E=this.i6b(u,!0);if(v||m<E){if(Array.add(z,u.hQb),!this.kPb(u))throw Error.argument("Invalid trieID");}else if(m-=E,!this.u9c(u))throw Error.argument("Invalid trieID");}}yDj(m,u){let z=0;this.nFi&&(m.y1f(this.I2m,this.E2m,0),++z);if(this.J3){var v=new a.a;v.lF=0;if(this.kPb(v))for(;;){var E=void 0;if(!({ch:E}=m.M8h()).returnValue)break;u&&(E=u(E));E=E.toString().charCodeAt(0);let F=!1;for(;!F;){const J=
!!(v.lF&y.X7a);if(v.hQb===E){if(F=!0,J&&m.y1f(!!(v.lF&y.krg),v.ije,z),!this.kPb(v))return}else if(z+=this.i6b(v,!0),!this.u9c(v))return;J&&++z}}}}kPb(m){if(!m.lF)return this.chg(m),!0;if(!(m.lF&y.ape))return!1;m.$Oa=0;m.rx=m.Nhb;this.chg(m);return!0}u9c(m){if(m.lF&y.bpe)return!1;this.chg(m);return!0}i6b(m,u){return m.lF&y.jrg?m.ZAd:m.lF&y.ape?!u&&m.lF&y.bpe?this.HKl(m):1:0}HKl(m){m=y.H5e(m);if(!this.kPb(m))return 0;let u=0;do m.lF&y.X7a&&++u,u+=this.i6b(m,!1);while(this.u9c(m));return u}chg(m){m.lF||
(m.$Oa=0,m.rx=this.F1d);var u=this.xGd(this.vFi,m.rx),z=u.symbol;m.rx+=u.tYc;u=this.fJ.oy(this.uFi+y.$2e*z,y.$2e);m.hQb=u&65535;m.lF=u>>16;m.lF&y.jrg&&(m.ZAd=this.V$k(m));m.lF&y.krg&&(u=this.xGd(this.DFi,m.rx),z=u.symbol,m.rx+=u.tYc,m.ije=this.fJ.oy(this.CFi+4*z,4));m.lF&y.FLj?(m.Nhb=this.F1d+((this.fJ.J(m.rx)<<8|this.fJ.J(m.rx+1))<<8|this.fJ.J(m.rx+2)),m.rx+=3):m.lF&y.GLj?(m.Nhb=m.rx,m.$Oa=m.Nhb):m.lF&y.HLj?(u=this.xGd(this.zFi,m.rx),z=u.symbol,m.rx+=u.tYc,m.Nhb=this.F1d+this.fJ.oy(this.yFi+4*z,
4)):m.lF&y.ape&&(u=this.xGd(this.BFi,m.rx),z=u.symbol,m.rx+=u.tYc,m.$Oa||(m.$Oa=m.rx),m.$Oa+=this.fJ.oy(this.AFi+4*z,4),m.Nhb=m.$Oa)}xGd(m,u){const z=new x;let v=0;for(;;){v+=this.fJ.J(u);++u;++z.tYc;const E=this.fJ.oy(m,2);if(v<E)break;z.symbol+=E;v-=E;m+=2;v<<=8}z.symbol+=v;return z}V$k(m){let u=this.fJ.J(m.rx);192<=u?(u=(u&63)<<15|(this.fJ.J(m.rx+1)&127)<<8,u|=this.fJ.J(m.rx+2),m.rx+=3):128<=u?(u=(u&127)<<8|this.fJ.J(m.rx+1),m.rx+=2):m.rx+=1;return u}UIn(m){const u=new k;u.T2e=this.fJ.oy(m+12,
2);u.Y2e=this.fJ.oy(m+14,2);u.U2e=this.fJ.oy(m+16,2);u.W2e=this.fJ.oy(m+18,2);u.Ivh=this.fJ.oy(m+24,4);u.Gvh=this.fJ.oy(m+28,4);u.Jvh=this.fJ.oy(m+32,4);u.Hvh=this.fJ.oy(m+36,4);u.hyh=this.fJ.oy(m+40,4);return u}static H5e(m){const u=new a.a;u.hQb=m.hQb;u.lF=m.lF;u.ZAd=m.ZAd;u.rx=m.rx;u.Nhb=m.Nhb;u.$Oa=m.$Oa;u.ije=m.ije;return u}}y.azb=1654263084;y.NIk=48;y.$Ad=2;y.a3e=4;y.$2e=4;y.X7a=1;y.bpe=2;y.jrg=4;y.krg=8;y.ape=16;y.GLj=64;y.HLj=128;y.FLj=256;Object(D.a)(y,"Trie",null,[1398])},1635:function(D,
L,c){c.r(L);D=c(0);c(1485);var l=c(1503);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(D.a)(e,"AppsForOfficeStoreType",null,[]);var a=c(1483),k=c(2),x=c(79),y=c(12);class m{constructor(){this.eRe=0}BZf(H,P){this.eRe=window.performance.now();this.NTa(()=>{const N=window.performance.now(),M={},I=k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",!0);P.Osk&&(M.callback=T=>{H(T,e.marketPlace,N)},I&&(M.storeType=e.marketPlace),
k.AFrameworkApplication.xa.Rb(y.a.aLb,2,M));P.Psk&&(M.callback=T=>{H(T,e.privateCatalog,N)},I?M.storeType=e.privateCatalog:k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?M.storeType=10:M.storeType=e.privateCatalog,k.AFrameworkApplication.xa.Rb(y.a.aLb,2,M))},0,()=>{if(a.TellMeActor.instance.Ne)a.TellMeActor.instance.Ne.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.eRe)+
" ms")})}NTa(H,P=0,N=null){2!==k.AFrameworkApplication.xa.processAction(y.a.aLb,1)?(a.TellMeActor.instance.Ne&&a.TellMeActor.instance.Ne.pA(l.a.Nsk,window.performance.now()-this.eRe),H()):P<m.T5m?k.AFrameworkApplication.oc.Wb(new x.a(2,1,m.tWo,()=>{this.NTa(H,P+1,N)})):N&&N()}static get instance(){m._instance||(m._instance=new m);return m._instance}}m._instance=null;m.T5m=20;m.tWo=500;Object(D.a)(m,"AddinEntitlementsQuery",null,[]);class u{constructor(){this.description=this.id=this.displayName=null;
this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.qFf=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(D.a)(u,"AddinInfo",null,[]);var z=c(1486),v=c(1490),E=c(1489),F=c(1482),J=c(112);c.d(L,"AddinResultsProvider",function(){return K});class K{constructor(H){this.nNe=[];this.kc=H;this.ain=(P,N,M)=>{if(P){const I=P.errorCode;if(a.TellMeActor.instance.Ne){const T={};T.StoreType=N;T.ErrorCode=I;T.AddinCount=P.value?P.value.length:
0;a.TellMeActor.instance.Ne.pA(l.a.GDl,window.performance.now()-M,T)}if(0===I&&P.value){K.qyb=K.qyb||{};P=P.value;for(const T of P)P=new u,P.displayName=T[0],P.id=T[1],P.description=T[2],P.targetType=T[3],P.appVersion=4<T.length?T[4]:"",P.assetId=5<T.length?T[5]:"",P.assetStoreId=6<T.length?T[6]:"",P.width=7<T.length?T[7]:0,P.height=8<T.length?T[8]:0,P.iconUrl=9<T.length?T[9]:"",P.providerName=10<T.length?T[10]:"",P.storeId=11<T.length?T[11]:"",P.storeType=12<T.length?T[12]:"",P.qFf=this.HTl(P),K.qyb[P.id]=
P,0<P.iconUrl.length&&(N="AddinIcon_"+P.id,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.P2i(N,P.iconUrl):appChrome.addInApi.registerAddinIcon(N,P.iconUrl))}}};m.instance.BZf(this.ain,this.kc)}BK(){return"Add-ins"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:2}xH(H,P,N,M,I=null){N=new E.a(H);I&&!Array.contains(I,27)||F.a.FQ(H)||(I=new v.a(27),I.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.hTl(H.Eg,I),N.Lu(I));
P.resultsUpdated(N)}hTl(H,P){if((H=this.q5n(H))&&0<H.length){let N=0;H.forEach(M=>{if(!(3<++N)){var I="AddinSuggestion"+N,T={};if(k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var U="AddinIcon_"+M.id;0>Array.indexOf(this.nNe,U)&&0<M.iconUrl.length&&this.P2i(U,M.iconUrl);T["default"]=0<=Array.indexOf(this.nNe,U)?U:"AppForOfficeLogo_20"}else T["default"]=0<M.iconUrl.length?"AddinIcon_"+M.id:"AppForOfficeLogo_20";U=[];U.push(appChrome.actions.setControlLabel(I,
M.displayName));U.push(appChrome.actions.setControlIconSet(I,T));U.push(appChrome.actions.setCompoundButtonCommandValueId(I,M.id));U.push(appChrome.actions.updateCompoundButtonDescription(I,M.description));k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(T=window.performance.now(),U.push(appChrome.actions.updateControlEnabledDisabledState(I,!1)),a.TellMeActor.instance.Ne&&a.TellMeActor.instance.Ne.pA(l.a.jml,window.performance.now()-
T));appChrome.api.dispatch(U);I=new z.a(I,27,void 0,void 0,1);I.qI=Telemetry.PrivacyRules.GetPrivacyCompliantId(M.id,M.storeType,M.assetId,null,null,M.storeId);P.ww(I)}})}}P2i(H,P){J.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(H,P),Array.add(this.nNe,H))}q5n(H){if(!K.qyb)return null;const P=[],N=K.qyb;for(let I in N){var M=N[I];M&&K.V4m(H,M)&&Array.add(P,M)}return P}HTl(H){return K.Wto(H.displayName)}static V4m(H,P){if(!P.qFf)return!1;for(const N of H.split(" ")){H=
!1;for(const M of P.qFf)if(M.toLowerCase().startsWith(N.toLowerCase())){H=!0;break}if(!H)return!1}return!0}static Wto(H){const P=[];for(const N of H.split(" ")){H=0;for(let M=0;M<N.length;M++){const I=N.charAt(M);I.toString().toUpperCase()===I.toString()&&M>H&&(Array.add(P,N.substring(H,M)),H=M)}Array.add(P,N.substring(H,N.length));H&&Array.add(P,N.substring(0,N.length))}return P}}K.qyb=null;Object(D.a)(K,"AddinResultsProvider",null,[1258])},1701:function(D,L,c){c.d(L,"a",function(){return e});D=
c(0);var l=c(231);class e{constructor(){this.bmb=this.cmb=this.VZa=this.nib=this.amb=this.Jeb=this.lib=this.w4a=this.Keb=this.mib=null;this.reset()}reset(){this.mib=new l.a;this.Keb=new l.a;this.w4a=new l.a;this.lib=new l.a;this.Jeb=new l.a;this.amb=new l.a;this.nib=new l.a;this.VZa=new l.a;this.VZa=new l.a;this.cmb=new l.a;this.bmb=new l.a}$Uo(a){return this.POa(this.mib,a)&&this.POa(this.Keb,a)&&this.POa(this.w4a,a)&&this.POa(this.lib,a)&&this.POa(this.Jeb,a)&&this.POa(this.amb,a)&&this.POa(this.nib,
a)&&this.POa(this.VZa,a)&&this.POa(this.cmb,a)&&this.POa(this.bmb,a)}POa(a,k){return!a||!a.length||a.length===k}}Object(D.a)(e,"MergeableTrackedChangesProperties",null,[])},1702:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(231),e=c(627);class a{constructor(){this.NIa=new l.a;this.MJa=new l.a;this.eMa=new l.a}get Gyb(){return this.NIa}get hhf(){return this.MJa}get epb(){return this.eMa}get isEmpty(){return!this.NIa.length&&!this.MJa.length&&!this.eMa.length}get lkb(){return Math.max(Math.max(this.NIa.length,
this.MJa.length),this.eMa.length)}get p8m(){return Math.min(Math.min(this.NIa.length,this.MJa.length),this.eMa.length)}izd(k){this.NIa.add(k)}kzd(k){this.MJa.add(k)}ozd(k){this.eMa.add(k)}lwl(){const k=new e.a,x=new l.a;let y=0;for(;y<this.NIa.length||y<this.MJa.length||y<this.eMa.length;)y<this.NIa.length&&!k.contains(this.NIa.J(y))&&(x.add(this.NIa.J(y)),k.add(this.NIa.J(y))),y<this.MJa.length&&!k.contains(this.MJa.J(y))&&(x.add(this.MJa.J(y)),k.add(this.MJa.J(y))),y<this.eMa.length&&!k.contains(this.eMa.J(y))&&
(x.add(this.eMa.J(y)),k.add(this.eMa.J(y))),y++;return x}}Object(D.a)(a,"ObjectCollection",null,[])},1703:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a){this.nIa=a;this.updateHints=e}}Object(D.a)(l,"UpdateHintCollection",null,[])},1704:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1548);class l extends c.a{constructor(e,a){super();this.wg=e;this.Lc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,
this.type,this.wg,this.Lc)}}Object(D.a)(l,"LcsInsertParaUpdateHint",c.a,[])},1705:function(D,L,c){c.d(L,"a",function(){return e});D=c(0);var l=c(231);c=c(1548);class e extends c.a{constructor(a){super();this.h_=new l.a;this.cp=a}get type(){return 11}toString(){let a="";for(let k=0;k<this.h_.length;k++)a+=String.format("({0}), ",this.h_.J(k).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(D.a)(e,"LcsInsertUpdateHint",c.a,[])},1706:function(D,L,c){c.d(L,"a",function(){return l});
D=c(0);c=c(1548);class l extends c.a{constructor(e,a){super();this.text=a;this.wg=e}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.wg,this.text)}}Object(D.a)(l,"LcsInsertTextUpdateHint",c.a,[])},1707:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1548);class l extends c.a{constructor(e,a,k){super();this.cp=e;this.wg=a;this.Lc=k}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.wg,this.Lc)}}Object(D.a)(l,"LcsDeleteParaUpdateHint",c.a,[])},1708:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1548);class l extends c.a{constructor(e,a){super();this.cp=e;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(D.a)(l,"LcsDeleteTextUpdateHint",c.a,[])},1709:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);c=c(1520);class l extends c.a{constructor(){super()}get zfa(){return"Conflict"}}
Object(D.a)(l,"ConflictMergeFailureDetail",c.a,[])},1710:function(D,L,c){c.r(L);c.d(L,"InsightsMenuItemFactory",function(){return k});D=c(0);var l=c(1482),e=c(181),a=c(16);class k{constructor(x=null){this.p0j=x||CommonUIStrings.l_InsightsButtonText}get hMb(){return 10}efa(x){var y=x.BC;x=l.a.Dga()?l.a.mNa(y,1):l.a.uAb(y);y=String.format(this.p0j,y);return this.XBl(x,y)}XBl(x,y){return e.a(k.hoi,l.a.Dga()?"1914896509":"3317204163",a.a.Af(y),l.a.tyf,null,a.a.Af(x),a.a.Af(y),null,null)}}k.hoi="bInsights";
Object(D.a)(k,"InsightsMenuItemFactory",null,[1242])},1711:function(D,L,c){c.d(L,"a",function(){return a});D=c(0);var l=c(181),e=c(16);class a{constructor(k,x,y,m,u){this.ZOe=k;this.YOe=x;this.ifk=y;this.QZj=m;this.HVg=u}get hMb(){return 4}efa(k,x=null){x=x.sessionId+"|"+x.xna+"|"+k.BC;if(this.HVg||this.QZj){let y=this.HVg||e.a.BA(CommonUIStrings.l_HelpTooltip)===e.a.BA(k.BC.trim());if(this.ifk&&2<k.BC.length){const m=k.BC;";"===m.charAt(0)&&";"===m.charAt(m.length-1)&&m.substring(1,m.length-1)===
a.lvf&&(y=!0)}k=y?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,k.BC);return this.f_h(x,e.a.Af(k),y)}return this.f_h(x,e.a.Af(String.format(CommonUIStrings.l_TextWithQuotation,k.BC)),!1)}f_h(k,x,y){return l.a(a.lvf,y?this.YOe:this.ZOe,x,"OfficeAssistant_16x16x32","A0",e.a.Af(k),x,null,null)}}a.lvf="bSearchHelp";Object(D.a)(a,"AssistanceMenuItemFactory",null,[1242])},1712:function(D,L,c){c.d(L,"a",function(){return x});D=c(0);var l=c(2),e=c(181),a=
c(97),k=c(16);class x{get hMb(){return 13}efa(){return x.kGk()}static kGk(){return e.b(x.bXh,"798637440",k.a.Af(CommonUIStrings.l_LookupFirstRunExperienceTitle),l.AFrameworkApplication.Ks,a.getImageClass("Info_32x32x32"),null,null,k.a.Af(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,k.a.Af(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}x.bXh="bTellMeFirstRun";Object(D.a)(x,"FirstRunMenuItemFactory",null,[1242])},1713:function(D,L,c){c.d(L,"a",function(){return k});
D=c(0);var l=c(2),e=c(181),a=c(16);class k{constructor(x=null,y=null){this.h4g=x;this.X5j=y||CommonUIStrings.l_LookupNoResultsDescription}get hMb(){return 14}efa(x){x=String.format(this.X5j,x.BC);return this.ZGk(x)}ZGk(x){return e.b(k.BKi,"798637440",a.a.Af(CommonUIStrings.l_LookupNoResultsTitle),this.h4g?l.AFrameworkApplication.Ks:null,this.h4g,null,null,a.a.Af(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.Af(x),null,null)}}k.BKi="lookupNoResults";Object(D.a)(k,"NoCommandsFoundMenuItemFactory",
null,[1242])},1714:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(e,a){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=a}}Object(D.a)(l,"LabelFormatted",null,[])},1715:function(D,L,c){c.d(L,"a",function(){return y});D=c(0);c(1485);var l=c(1486),e=c(1490),a=c(1489),k=c(1482),x=c(16);class y{constructor(m){this.kc=m}BK(){return"Assistance"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:this.kc.JZc?3:2}xH(m,u,z=!1,v,E=null){v=new a.a(m);if((!E||Array.contains(E,
8))&&!k.a.FQ(m)){E=new e.a(8);if(z){z=x.a.BA(CommonUIStrings.l_HelpTooltip)===x.a.BA(m.Eg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.Eg);const F=[];this.kc.H2a&&(this.kc.rge||F.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),z=this.d9h(m.Eg));const J="||"+m.Eg;F.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",z));F.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",J));
appChrome.api.dispatch(F);m=new l.a("GetHelpFromTellMe",4,m.Eg,null,1)}else m=new l.a("bSearchHelp",4,m.Eg,null,1);E.ww(m);E.displayName=CommonUIStrings.l_HelpButtonTitle;v.Lu(E)}u.resultsUpdated(v)}shb(m,u=null){const z=new e.a(8),v=x.a.BA(CommonUIStrings.l_HelpTooltip)===x.a.BA(m.Eg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.Eg);for(let F=0;F<u.length&&2>F;F++){var E=void 0;E=[];let J="GetHelpWithDescriptionFromTellMe"+(F+1).toString(),
K=4;if(this.kc.u6c)E.push(appChrome.actions.setControlLabel(J,v)),E.push(appChrome.actions.setCompoundButtonCommandValueId(J,m.Eg)),E.push(appChrome.actions.updateCompoundButtonDescription(J,this.Nsf(u.length)));else if(this.kc.v6c){let H=this.zei(u[F]);J="GetHelpFromTellMe"+(F+1).toString();this.kc.H2a&&(H=this.d9h(H));K=9;E.push(appChrome.actions.setControlLabel(J,H));E.push(appChrome.actions.setButtonCommandValueId(J,this.A9l(u[F])))}appChrome.api.dispatch(E);E=new l.a(J,K,null,null,0);E.label=
this.zei(u[F]);E.description=this.z9l(u[F]);z.ww(E);if(this.kc.v6c)break}z.displayName=CommonUIStrings.l_HelpButtonTitle;return z}Nsf(m){return 1===m?String.format(CommonUIStrings.l_SearchResultText,m):String.format(CommonUIStrings.l_SearchResultsText,m)}d9h(m){return this.kc.SDf?k.a.Ynf(m,CommonUIStrings.l_HelpScopedButtonText):m+CommonUIStrings.l_HelpScopedButtonText}zei(m){return m.name?m.name:""}z9l(m){return m.description?m.description:""}A9l(m){return m.id?"AssetID="+m.id:""}}Object(D.a)(y,
"AssistanceResultsProvider",null,[1258])},1716:function(D,L,c){c.d(L,"a",function(){return m});D=c(0);c(1485);var l=c(1486),e=c(1490),a=c(1489),k=c(1483),x=c(1482),y=c(1519);class m{constructor(u){this.kc=u}BK(){return"Image"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:3===this.kc.Ru?3:2}xH(u,z,v,E,F=null){v=new a.a(u);(!F||Array.contains(F,19))&&x.a.FQ(u)&&this.kc.QO&&this.shb(u,v,1);z.resultsUpdated(v)}shb(u,z,v,E=null){var F=[];let J;k.TellMeActor.instance.bO()&&k.TellMeActor.instance.bO().H2a?
(J=this.kc.SDf?x.a.Ynf(u.Eg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):u.Eg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.kc.rge||F.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):J=this.kc.QO?x.a.FQ(u)?this.kc.Zcb?x.a.ogb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.kc.Zcb?x.a.ogb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
u.Eg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,u.Eg):this.kc.mic?CommonUIStrings.l_TellMeImageSuggestionButtonText:u.Eg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.kc.wva?(k.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",J)),F=x.a.mNa(u.Eg,9,Object.assign(new y.a,{landingTab:"Image"})),k.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",F))):(F.push(appChrome.actions.setControlLabel("ImageForSearch",
J)),u=x.a.mNa(u.Eg,9,Object.assign(new y.a,{landingTab:"Image"})),F.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",u)),appChrome.api.dispatch(F));v=new l.a("ImageForSearch",12,null,null,v);E&&(v.score=E.ConfidenceScore);E=new e.a(19,this.kc.mic?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);E.ww(v);z.Lu(E)}}Object(D.a)(m,"ImageResultsProvider",null,[1258])},1717:function(D,L,c){c.d(L,"a",function(){return y});D=c(0);c(1485);var l=c(1486),e=c(1490),a=c(1489),
k=c(1482),x=c(2);class y{constructor(m){this.kc=m}BK(){return"Template"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:3}xH(m,u){m=new a.a(m);u.resultsUpdated(m)}shb(m,u,z){var v=[];let E;E=this.kc.QO?this.kc.Zcb?k.a.ogb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,m.Eg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,m.Eg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,m.Eg);v.push(appChrome.actions.setControlLabel("TemplateForSearch",E));v.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(x.AFrameworkApplication.K.kb("TellMeTemplateProviderURL"),x.AFrameworkApplication.uiCulture,m.Eg)));appChrome.api.dispatch(v);m=new e.a(23);m.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;v=new l.a("TemplateForSearch",24,null,null,0);v.label=z[0].Title?z[0].Title:"";v.description=z[0].Description?z[0].Description:"";m.ww(v);u.Lu(m)}}Object(D.a)(y,"TemplateResultsProvider",null,[1258])},1718:function(D,L,c){c.d(L,"a",function(){return z});D=c(0);c(1485);var l=c(1522),e=c(1486),
a=c(1490),k=c(1489),x=c(1619),y=c(1483),m=c(1482),u=c(16);class z{constructor(v,E,F,J){this.U1=v;this.mcb=E;this.Vfh=J;this.rXj=F;this.kc=y.TellMeActor.instance.bO()}BK(){return"EmptyQuery"}KT(){return 1===this.kc.Ru?1:0}xH(v,E,F=!1,J,K=null){J=new k.a(v);if((!K||Array.contains(K,5)||Array.contains(K,6)||Array.contains(K,4))&&m.a.FQ(v)){this.U1.zMc().length||!this.rXj||this.Vfh||(v=new a.a(6),K=new e.a(null,13,void 0,void 0,1),v.ww(K),J.Lu(v));v=new a.a(4);if(0<this.U1.zMc().length){v.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;K=this.U1.zMc();var H=[];for(var P of K)H.push(P.Id);l.CommandResultsUtility.c$c(H,this.kc);for(var N of K)l.CommandResultsUtility.jSc(N.Id)&&v.ww(new e.a(N.Id,5,null,null,2));J.Lu(v)}if(this.Vfh&&0<this.mcb.length&&this.U1.zMc().length<z.maxResults){P=new a.a(5);P.displayName=CommonUIStrings.l_TellMeTryQueryTitle;N=z.maxResults-v.results.length;v=[];for(K=0;K<this.mcb.length&&K<N;++K){if(F){H=m.a.Hhg+(K+1);const M=this.mcb[K].key,I=u.a.replaceAll(M,'"',"");
v.push(appChrome.actions.setControlLabel(H,M));v.push(appChrome.actions.setButtonCommandValueId(H,I));H=new x.a(M,7,0,I,H)}else H=new x.a(this.mcb[K].key,7,0,this.mcb[K].value);P.ww(H)}0<v.length&&appChrome.api.dispatch(v);J.Lu(P)}}E.resultsUpdated(J)}}z.maxResults=5;Object(D.a)(z,"EmptyQueryResultsProvider",null,[1258])},1719:function(D,L,c){c.d(L,"a",function(){return l});D=c(0);class l{constructor(){this.ije=this.$Oa=this.Nhb=this.rx=this.ZAd=this.lF=this.hQb=0}}Object(D.a)(l,"TRIESCAN",null,[])},
1738:function(D,L,c){c.r(L);var l=c(0),e=c(1485),a=c(1533),k=c(1503),x=c(1486),y=c(1490),m=c(1489),u=c(1483),z=c(1482),v=c(1519);class E{constructor(ib){this.kc=ib}BK(){return"ActionAI"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:2}xH(ib,Ib,fc=!1,Cc,Jc=null){Cc=new m.a(ib);if(!Jc||Array.contains(Jc,24))if(this.gmo()||!z.a.FQ(ib)){Jc=new y.a(24);var pd=z.a.FQ(ib);fc&&(fc=null,z.a.Dga()&&(fc=z.a.mNa(pd?"":ib.Eg,1,Object.assign(new v.a,{landingTab:"ActionAI"}))),this.kc.wva?fc&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
fc)):(ib=[],fc&&ib.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",fc)),appChrome.api.dispatch(ib)));Jc.ww(new x.a("ActionAIFromTellMe",25,null,null,1));Cc.Lu(Jc)}Ib.resultsUpdated(Cc)}gmo(){return z.a.Dga()&&this.kc.HVd}}Object(l.a)(E,"ActionAIResultsProvider",null,[1258]);var F=c(1635);class J{constructor(ib,Ib){this.Yya=ib;this.Mk=Ib}resultsUpdated(ib){this.Yya.gfo(this.Mk,ib)}}Object(l.a)(J,"AggregatorResultsProviderCallback",null,[1260]);class K{constructor(ib){this.Iqa=null;
this.kc=ib;this.kc.yyb&&(this.Iqa=null)}BK(){return"AppsForOffice"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:2}xH(ib,Ib,fc,Cc,Jc=null){fc=new m.a(ib);if(!Jc||Array.contains(Jc,1))Jc=new y.a(1),this.Iqa.O5o(Jc,ib.Eg),fc.Lu(Jc);Ib.resultsUpdated(fc)}}Object(l.a)(K,"AppsForOfficeRecommendationResultsProvider",null,[1258]);var H=c(1715),P=c(1479),N=c(1498),M=c(117);class I{constructor(ib,Ib){this.Bb=ib;this.H2m=Ib}isMatch(ib,Ib){if(!Object(M.a)(1341,ib))throw Error.argument("objToTest","Expected feature bundle");
let fc;return({value:fc}=ib.yq(this.Bb.lta)).returnValue?this.Bb.Rkg.isMatch(fc,Ib):this.H2m}}Object(l.a)(I,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1378]);class T{constructor(ib,Ib){this.Bb=ib;this.$If=Ib}isMatch(ib){if(!Object(M.a)(1341,ib))throw Error.argument("objToTest","Expected feature bundle");return!!(this.$If^ib.yq(this.Bb.lta).returnValue)}}Object(l.a)(T,"AnnotatedWithAnnotationFilter",null,[1378]);class U{constructor(ib){this.Bb=ib}isMatch(ib,Ib){if(!Object(M.a)(1344,ib))throw Error.argument("objToTest",
"Expected struct value");return this.Bb.Rkg.isMatch(ib.Fgb(this.Bb.UNa),Ib)}}Object(l.a)(U,"FieldValueMatchesStructFilter",null,[1378]);class W{constructor(ib,Ib){ib&&(this.UNa=ib.J(0),this.Rkg=Ib.Ima(ib.J(1)))}}Object(l.a)(W,"FieldValueMatchesStructFilterInit",null,[]);class V{constructor(ib){this.$If=ib}isMatch(ib){if(!Object(M.a)(1341,ib))throw Error.argument("objToTest","Expected feature bundle");return!!(this.$If^ib.Auf)}}Object(l.a)(V,"HasAnnotationsAnnotationFilter",null,[1378]);class Y{constructor(ib,
Ib){this.Bb=ib;this.A8=Ib}isMatch(ib,Ib){if(!Object(M.a)(1343,ib))throw Error.argument("objToTest","Expected list value");switch(this.A8){case 0:for(const fc of ib.items)if(this.Bb.filter.isMatch(fc,Ib))return!0;return!1;case 1:for(const fc of ib.items)if(!this.Bb.filter.isMatch(fc,Ib))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(Y,"ItemTestListFilter",null,[1378]);class da{constructor(ib){this.Bb=ib}isMatch(ib,Ib){if(!Object(M.a)(1343,ib))throw Error.argument("objToTest",
"Expected list value");return this.Bb.filter.isMatch(ib.items.length,Ib)}}Object(l.a)(da,"LengthMatchesListFilter",null,[1378]);class ba{constructor(ib,Ib){this.Bb=ib;this.A8=Ib}isMatch(ib,Ib,fc=null){let Cc=0===this.A8;for(const Jc of this.Bb.Nzh)if((Cc=Jc.isMatch(ib,Ib,fc))?1===this.A8:0===this.A8)return Cc;2===this.A8&&(Cc=!Cc);return Cc}}Object(l.a)(ba,"NonterminalFilter",null,[1378]);class ja{constructor(ib,Ib){if(ib){var fc=ib.J(0);this.Nzh=Array(fc);for(let Cc=0;Cc<fc;++Cc)this.Nzh[Cc]=Ib.Ima(ib.J(1+
Cc))}}}Object(l.a)(ja,"NonterminalFilterInit",null,[]);class sa{constructor(ib,Ib){this.Bb=ib;this.A8=Ib}isMatch(ib,Ib){if("number"!==typeof ib)throw Error.argument("objToTest","Expected number value");let fc=this.Bb.number;if(this.Bb.query){Ib=this.Bb.query.mt(null,Ib);if("number"!==typeof Ib)throw Error.invalidOperation("Query did not return number");fc+=Ib}switch(this.A8){case 0:return ib===fc;case 1:return ib<fc;case 2:return ib<=fc;case 3:return ib>fc;case 4:return ib>=fc;default:throw Error.notImplemented();
}}}Object(l.a)(sa,"NumberFilter",null,[1378]);class ta{constructor(ib,Ib){ib&&(this.number=ib.J(0),this.query=ib.J(1)?Ib.vK(ib.J(1)):null)}}Object(l.a)(ta,"NumberFilterInit",null,[]);class ra{constructor(ib,Ib,fc){this.INd=this.vOl;this.N2m=ib;this.rFi=Ib;this.qFi=fc}m4e(ib){this.rFi=ib}vOl(ib){if(!ib)throw Error.argument("name","Invalid named feature bundle reference");const Ib=ib.substr(1);return 1===ib.charCodeAt(0)&&Ib===this.N2m?this.rFi:this.qFi?this.qFi.INd(ib):null}}Object(l.a)(ra,"SimpleNamedFeatureBundleResolver",
null,[1404]);class ma{constructor(ib){this.Bb=ib}isMatch(ib,Ib){if(!Object(M.a)(1341,ib))throw Error.argument("objToTest","Expected feature bundle");ib=this.Bb.query.mt(null,new ra(this.Bb.Pme,ib,Ib));if("boolean"!==typeof ib)throw Error.invalidOperation("Query did not return bool");return ib}}Object(l.a)(ma,"PredicateAnnotationFilter",null,[1378]);class Ba{constructor(ib,Ib){ib&&(this.Pme=Ib.uD(ib.J(0)),this.query=Ib.vK(ib.J(1)))}}Object(l.a)(Ba,"PredicateAnnotationFilterInit",null,[]);class Pa{constructor(ib){this.Bb=
ib}isMatch(ib,Ib){if("boolean"!==typeof ib)throw Error.argument("objToTest","Expected bool value");Ib=this.Bb.query.mt(null,Ib);if("boolean"!==typeof Ib)throw Error.invalidOperation("Query did not return bool");return ib===Ib}}Object(l.a)(Pa,"QueryBooleanFilter",null,[1378]);class Da{constructor(ib,Ib){this.Bb=ib;this.A8=Ib}isMatch(ib,Ib){if("number"!==typeof ib)throw Error.argument("objToTest","Expected integer");Ib=this.Bb.query.mt(null,Ib);if("number"!==typeof Ib)throw Error.invalidOperation("Query did not return an enum value");
switch(this.A8){case 0:return ib===Ib;case 1:return 0!==(ib&Ib);case 2:return ib===(ib&Ib);case 3:return Ib===(ib&Ib);default:throw Error.notImplemented();}}}Object(l.a)(Da,"QueryEnumFilter",null,[1378]);class Ha{constructor(ib,Ib){ib&&(this.UXd=1===ib.J(0),this.query=Ib.vK(ib.J(1)))}}Object(l.a)(Ha,"QueryEnumFilterInit",null,[]);class oa{constructor(ib,Ib){this.Bb=ib;this.A8=Ib}isMatch(ib,Ib){if(!Object(M.a)(1343,ib))throw Error.argument("objToTest","Expected list value");Ib=this.Bb.query.mt(null,
Ib);if(!Object(M.a)(1343,Ib))throw Error.invalidOperation("Query did not return list value");if(ib.L3!==Ib.L3)return!1;switch(this.A8){case 0:return P.Annotations.wpb(P.Annotations.kVl(ib.L3),ib,Ib);case 1:for(const fc of ib.items)for(const Cc of Ib.items)if(P.Annotations.wpb(ib.L3,fc,Cc))return!0;return!1;case 2:for(const fc of ib.items)for(const Cc of Ib.items)if(!P.Annotations.wpb(ib.L3,fc,Cc))return!1;return!0;case 3:for(const fc of Ib.items)for(const Cc of ib.items)if(!P.Annotations.wpb(ib.L3,
fc,Cc))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(oa,"QueryListFilter",null,[1378]);class wa{constructor(ib,Ib){this.Bb=ib;this.A8=Ib}isMatch(ib,Ib){if("string"!==typeof ib)throw Error.argument("objToTest","Expected string");Ib=this.Bb.query.mt(null,Ib);if("string"!==typeof Ib)throw Error.invalidOperation("Query did not return string");this.Bb.tzf&&(ib=ib.toUpperCase(),Ib=Ib.toUpperCase());switch(this.A8){case 0:return ib===Ib;case 1:return 0<=ib.indexOf(Ib);case 2:return ib.startsWith(Ib);
case 3:return ib.endsWith(Ib);case 4:return 0<=Ib.indexOf(ib);case 5:return Ib.startsWith(ib);case 6:return Ib.endsWith(ib);default:throw Error.notImplemented();}}}Object(l.a)(wa,"QueryStringFilter",null,[1378]);class ia{constructor(ib,Ib){ib&&(this.query=Ib.vK(ib.J(0)),this.tzf=1===ib.J(1))}}Object(l.a)(ia,"QueryStringFilterInit",null,[]);class ca{constructor(ib){this.Bb=ib}isMatch(ib,Ib){if(!Object(M.a)(1344,ib))throw Error.argument("objToTest","Expected struct value");Ib=this.Bb.query.mt(null,
Ib);if(!Object(M.a)(1344,Ib))throw Error.invalidOperation("Query did not return struct value");return ib.isEqual(ib)}}Object(l.a)(ca,"QueryStructFilter",null,[1378]);class pa{constructor(ib){this.Bb=ib}isMatch(ib,Ib){ib=this.Bb.query.mt(null,Ib);if("boolean"!==typeof ib)throw Error.invalidOperation("Query did not return bool");return ib}}Object(l.a)(pa,"QueryWhereConstraintFilter",null,[1378]);class Ma{constructor(ib){this.Bb=ib}isMatch(ib){if("string"!==typeof ib)throw Error.argument("objToTest",
"Expected string");return this.Bb.S0f.test(ib)}}Object(l.a)(Ma,"RegexStringFilter",null,[1378]);class ya{constructor(ib,Ib){ib&&(this.S0f=Ib.TDb(ib.J(0)))}}Object(l.a)(ya,"RegexStringFilterInit",null,[]);class Oa{constructor(ib,Ib){ib&&(this.filter=Ib.Ima(ib.J(0)))}}Object(l.a)(Oa,"SingleFilterFilterInit",null,[]);class fa{constructor(ib,Ib){ib&&(this.query=Ib.vK(ib.J(0)))}}Object(l.a)(fa,"SingleQueryFilterInit",null,[]);class Ca{constructor(ib){this.Bb=ib}isMatch(ib){if("boolean"!==typeof ib)throw Error.argument("objToTest",
"Expected bool value");return ib===this.Bb.value}}Object(l.a)(Ca,"StoredValueBooleanFilter",null,[1378]);class Ta{constructor(ib){ib&&(this.value=1===ib.J(0))}}Object(l.a)(Ta,"StoredValueBooleanFilterInit",null,[]);class eb{constructor(ib,Ib){this.Bb=ib;this.A8=Ib}isMatch(ib){if("number"!==typeof ib)throw Error.argument("objToTest","Expected integer");switch(this.A8){case 0:return this.Bb.UXd?this.Bb.value?!!(ib&this.Bb.value):!ib:ib===this.Bb.value;case 1:return this.Bb.UXd?(ib&this.Bb.value)===
this.Bb.value:32>ib&&(1<<ib&this.Bb.value)===this.Bb.value;case 2:return this.Bb.UXd?!!(ib&this.Bb.value):32>ib&&!!(1<<ib&this.Bb.value);default:throw Error.notImplemented();}}}Object(l.a)(eb,"StoredValueEnumFilter",null,[1378]);class jb{constructor(ib){ib&&(this.UXd=1===ib.J(0),this.value=ib.J(1))}}Object(l.a)(jb,"StoredValueEnumFilterInit",null,[]);class ob{constructor(){this.ttn=null;this.Z2e=this.ZEb=0}}Object(l.a)(ob,"WHEREConstraintData",null,[]);class Ya{constructor(ib){this.Bb=ib}isMatch(ib,
Ib){if(!Object(M.a)(ob,ib))throw Error.argument("objToTest","Expected WHERE constraint data");let fc=-1,Cc=-1;const Jc=ib.ttn;switch(this.Bb.V3e){case 4:fc=Jc.aLc;Cc=Jc.hcg;break;case 5:fc=ib.ZEb;Cc=Jc.aLc-ib.ZEb;break;case 6:fc=Jc.aLc+Jc.hcg;Cc=ib.ZEb+ib.Z2e-fc;break;case 1:case 2:case 3:let pd=!1;for(let ge=Jc.H6o;ge;ge=ge.next)if(this.Bb.HTo===ge.name){pd=!0;1===this.Bb.V3e?(fc=ge.aLc,Cc=ge.hcg):2===this.Bb.V3e?(fc=ib.ZEb,Cc=ge.aLc-ib.ZEb):(fc=ge.aLc+ge.hcg,Cc=ib.ZEb+ib.Z2e-fc);break}if(!pd)return!1;
break;case 7:fc=ib.ZEb;Cc=ib.Z2e;break;default:throw Error.notImplemented();}return null!==this.Bb.Yto.U9o(Jc.Tfp,fc,Cc,fc,!0,2,Ib)}}Object(l.a)(Ya,"SubSreWhereConstraintFilter",null,[1378]);class Xa{constructor(ib,Ib){if(ib){var fc=Ib.uD(ib.J(0));this.V3e=fc.charCodeAt(0);this.HTo=fc.substr(1);this.Yto=Ib.d4l(ib.J(1))}}}Object(l.a)(Xa,"SubSreWhereConstraintFilterInit",null,[]);class Sa{constructor(ib){this.Bb=ib}isMatch(ib,Ib,fc=null){if(!Object(M.a)(1341,ib))throw Error.argument("objToTest","Expected feature bundle");
if(null==fc)throw Error.argumentNull("parentTextForSpan");if(this.Bb.Aoh&&!this.Bb.Aoh.isMatch(ib,Ib))return!1;if(this.Bb.Afg){let Cc;if(({value:Cc}=ib.yq(this.Bb.Qso)).returnValue){if(!this.Bb.Afg.isMatch(Cc,Ib))return!1}else{let Jc,pd;if(!({value:Jc}=ib.yq(this.Bb.Knj)).returnValue||!({value:pd}=ib.yq(this.Bb.Jnj)).returnValue||0>Jc||0>pd||Jc+pd>fc.length||!this.Bb.Afg.isMatch(fc.substr(Jc,pd),Ib))return!1}}if(this.Bb.Doj){let Cc;if(!({value:Cc}=ib.yq(this.Bb.Knj)).returnValue||!this.Bb.Doj.isMatch(Cc,
Ib))return!1}if(this.Bb.rBi){let Cc;if(!({value:Cc}=ib.yq(this.Bb.Jnj)).returnValue||!this.Bb.rBi.isMatch(Cc,Ib))return!1}return!0}}Object(l.a)(Sa,"TextSpanFilter",null,[1378]);class ab{constructor(ib,Ib){ib&&(this.annotations=Ib.annotations,this.Knj=ib.J(0),this.Jnj=ib.J(1),this.Qso=ib.J(2),this.Afg=ib.J(3)?Ib.Ima(ib.J(3)):null,this.Aoh=ib.J(4)?Ib.Ima(ib.J(4)):null,this.Doj=ib.J(5)?Ib.Ima(ib.J(5)):null,this.rBi=ib.J(6)?Ib.Ima(ib.J(6)):null)}}Object(l.a)(ab,"TextSpanFilterInit",null,[]);class Hb{constructor(ib,
Ib){ib&&(this.annotations=Ib.annotations,this.lta=ib.J(0),this.Rkg=ib.J(1)?Ib.Ima(ib.J(1)):null)}}Object(l.a)(Hb,"ValueFilterAnnotationFilterInit",null,[]);var pb=c(1505);class Mb{Ima(ib,Ib){const fc=ib.J(0),Cc=new pb.a;Cc.cgb(ib,1,ib.count-1);switch(fc){case 1:return new ba(new ja(Cc,Ib),0);case 2:return new ba(new ja(Cc,Ib),1);case 3:return new ba(new ja(Cc,Ib),2);case 101:return new Ma(new ya(Cc,Ib));case 103:return new wa(new ia(Cc,Ib),0);case 104:return new wa(new ia(Cc,Ib),1);case 105:return new wa(new ia(Cc,
Ib),2);case 106:return new wa(new ia(Cc,Ib),3);case 107:return new wa(new ia(Cc,Ib),4);case 108:return new wa(new ia(Cc,Ib),5);case 109:return new wa(new ia(Cc,Ib),6);case 201:return new Ca(new Ta(Cc));case 202:return new Pa(new fa(Cc,Ib));case 301:return new sa(new ta(Cc,Ib),0);case 302:return new sa(new ta(Cc,Ib),1);case 303:return new sa(new ta(Cc,Ib),2);case 304:return new sa(new ta(Cc,Ib),3);case 305:return new sa(new ta(Cc,Ib),4);case 401:return new eb(new jb(Cc),0);case 402:return new eb(new jb(Cc),
1);case 403:return new eb(new jb(Cc),2);case 404:return new Da(new Ha(Cc,Ib),0);case 405:return new Da(new Ha(Cc,Ib),1);case 406:return new Da(new Ha(Cc,Ib),2);case 407:return new Da(new Ha(Cc,Ib),3);case 501:return new U(new W(Cc,Ib));case 502:return new ca(new fa(Cc,Ib));case 601:return new Y(new Oa(Cc,Ib),0);case 602:return new Y(new Oa(Cc,Ib),1);case 603:return new da(new Oa(Cc,Ib));case 604:return new oa(new fa(Cc,Ib),0);case 605:return new oa(new fa(Cc,Ib),1);case 606:return new oa(new fa(Cc,
Ib),2);case 607:return new oa(new fa(Cc,Ib),3);case 701:return new V(!1);case 702:return new V(!0);case 703:return new T(new Hb(Cc,Ib),!1);case 704:return new T(new Hb(Cc,Ib),!0);case 705:return new I(new Hb(Cc,Ib),!1);case 706:return new I(new Hb(Cc,Ib),!0);case 707:return new ma(new Ba(Cc,Ib));case 901:return new Sa(new ab(Cc,Ib));case 1002:return new pa(new fa(Cc,Ib));case 1001:return new Ya(new Xa(Cc,Ib));default:throw Error.argument("initData");}}}Object(l.a)(Mb,"FilterFactory",null,[1340]);
var Qb=c(1484);class Aa{constructor(ib){this.Bb=ib}get zD(){return this.Bb.zD}get m4(){return this.Bb.m4}get Gie(){return this.Bb.Gie}get sWd(){return this.Bb.sWd}load(ib,Ib){return this.mt(ib,ib?new ra("root",ib,Ib):Ib)}store(ib,Ib,fc){this.kjc(ib,Ib,ib?new ra("root",ib,fc):fc,null)}mt(ib,Ib){if(!this.sWd&&!this.Bb.annotations.H$b(this.zD,ib))throw Error.argument("input","Input value not of expected type");let fc=this.Bb.hXh;for(;fc;)ib=fc.load(ib,Ib),fc=fc.next;return ib}kjc(ib,Ib,fc,Cc){if(!this.Gie)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.sWd&&!this.Bb.annotations.H$b(this.zD,ib))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Bb.annotations.H$b(this.m4,Ib))throw Error.argument("rvalue","Rvalue not of expected type");return this.Bb.hXh.store(ib,Ib,fc,Cc)}static NBh(ib,Ib,fc,Cc){if(fc===Cc)return Ib;if(P.Annotations.NH(fc)&&P.Annotations.NH(Cc)){fc=P.Annotations.w0a(fc);Cc=P.Annotations.w0a(Cc);const Jc=new Qb.a(ib,Cc);for(const pd of Ib.items)Array.add(Jc.items,Aa.NBh(ib,pd,fc,Cc));return Jc}if(fc===
P.Annotations.eIa){if(Cc===P.Annotations.lqa)return Ib;if(Cc===P.Annotations.y9)return Ib.toString()}else if(fc===P.Annotations.lqa){if(Cc===P.Annotations.eIa)return Math.floor(Ib);if(Cc===P.Annotations.y9)return Ib.toString()}else if(fc===P.Annotations.y9){if(Cc===P.Annotations.eIa)return parseInt(Ib);if(Cc===P.Annotations.lqa)return parseFloat(Ib)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(l.a)(Aa,"AnnotationQuery",null,[1387]);class bb{constructor(){this.m4=
this.zD=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}A0a(ib){if(this.next)return{returnValue:this.next,yHa:ib};if(ib){const Ib=ib.VEh;ib=ib.SXi;return{returnValue:Ib,yHa:ib}}return{returnValue:null,yHa:ib}}}Object(l.a)(bb,"AnnotationQueryStep",null,[1416]);class nb extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){Ib=this.Bb.query.mt(ib,Ib);if(P.Annotations.NH(this.zD)){var fc=P.Annotations.w0a(this.zD);let Jc=new Qb.a(this.Bb.annotations,fc);if(P.Annotations.NH(this.Bb.query.m4)){if(ib.items.length!==
Ib.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let pd=0,ge=ib.items.length;pd<ge;++pd)Array.add(Jc.items,this.fBd(ib.items[pd],Ib.items[pd],fc===P.Annotations.lqa))}else for(var Cc of ib.items)Array.add(Jc.items,this.fBd(Cc,Ib,fc===P.Annotations.lqa));return Jc}if(P.Annotations.NH(this.Bb.query.m4)){Cc=new Qb.a(this.Bb.annotations,this.zD);for(fc of Ib.items)Array.add(Cc.items,this.fBd(ib,fc,this.zD===P.Annotations.lqa));return Cc}return this.fBd(ib,
Ib,this.zD===P.Annotations.lqa)}fBd(ib,Ib,fc){ib=this.Z0b(ib,Ib);return fc?ib:Math.floor(ib)}}Object(l.a)(nb,"NumericAnnotationQueryStep",bb,[]);class Va extends nb{constructor(ib){super(ib)}Z0b(ib,Ib){return ib+Ib}}Object(l.a)(Va,"AddAnnotationQueryStep",nb,[]);class Ab extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){if(this.zD===P.Annotations.yya&&this.Bb.query.m4===P.Annotations.yya){let Jc;if(({result:Jc}=this.pxh(ib)).returnValue)return Jc}if(P.Annotations.NH(this.zD)){var fc=new Qb.a(this.Bb.annotations,
P.Annotations.yya);Ib=this.Bb.query.mt(ib,Ib);if(P.Annotations.NH(this.Bb.query.m4)){if(ib.items.length!==Ib.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Jc=0,pd=ib.items.length;Jc<pd;++Jc)Array.add(fc.items,this.aGc(Ib.items[Jc],ib.items[Jc]))}else for(var Cc of ib.items)Array.add(fc.items,this.aGc(Ib,Cc));return fc}Cc=this.Bb.query.mt(ib,Ib);if(P.Annotations.NH(this.Bb.query.m4)){Ib=new Qb.a(this.Bb.annotations,P.Annotations.yya);for(fc of Cc.items)Array.add(Ib.items,
this.aGc(fc,ib));return Ib}return this.aGc(Cc,ib)}}Object(l.a)(Ab,"BinaryBooleanAnnotationQueryStep",bb,[]);class Zb extends Ab{constructor(ib){super(ib)}pxh(ib){return{returnValue:!ib,result:!1}}aGc(ib,Ib){return ib&&Ib}}Object(l.a)(Zb,"AndAnnotationQueryStep",Ab,[]);class Kb{constructor(ib){ib&&(this.annotations=ib)}}Object(l.a)(Kb,"AnnotationsOnlyQueryStepInit",null,[]);class dc extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){Ib=this.Bb.query.mt(ib,Ib);ib=ib.clone();P.Annotations.NH(this.Bb.query.m4)?
Array.addRange(ib.items,Ib.items):Array.add(ib.items,Ib);return ib}}Object(l.a)(dc,"AppendAnnotationQueryStep",bb,[]);class jc extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){if(this.zD===P.Annotations.YU)return this.cKc(ib,Ib);const fc=new Qb.a(this.Bb.annotations,P.Annotations.YU);for(const Cc of ib.items)Array.add(fc.items,this.cKc(Cc,Ib));return fc}cKc(ib,Ib){const fc=new N.a(this.Bb.annotations);fc.vZa(ib);ib=new N.a(this.Bb.annotations);this.Bb.script.LNa(null,new ra("Input",fc,new ra("Output",
ib,Ib)));return ib}}Object(l.a)(jc,"ApplyAnnotationQueryStep",bb,[]);class zb extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){if(this.zD===P.Annotations.YU)return Ib=this.cKc(ib,Ib),Ib.yq(this.Bb.yoh).returnValue||new Qb.a(this.Bb.annotations,P.Annotations.YU),Ib;const fc=new Qb.a(this.Bb.annotations,P.Annotations.YU);for(const Cc of ib.items)if(ib=this.cKc(Cc,Ib),({value:ib}=ib.yq(this.Bb.yoh)).returnValue)for(const Jc of ib.items)Array.add(fc.items,Jc);return fc}cKc(ib,Ib){const fc=new N.a(this.Bb.annotations);
fc.vZa(ib);ib=new N.a(this.Bb.annotations);this.Bb.script.LNa(null,new ra("Input",fc,new ra("Output",ib,Ib)));return ib}}Object(l.a)(zb,"ApplyExpandAnnotationQueryStep",bb,[]);class cc{constructor(ib,Ib){ib&&(this.annotations=Ib.annotations,this.script=Ib.DCb(ib.J(0)),this.yoh=ib.J(1))}}Object(l.a)(cc,"ApplyExpandQueryStepInit",null,[]);class Ub{constructor(ib,Ib){ib&&(this.annotations=Ib.annotations,this.script=Ib.DCb(ib.J(0)))}}Object(l.a)(Ub,"ApplyQueryStepInit",null,[]);class Wb extends bb{constructor(ib){super();
this.Bb=ib}load(ib){if(this.zD===P.Annotations.YU)return this.E0d(ib);const Ib=new Qb.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.lta));for(const fc of ib.items)Array.add(Ib.items,this.E0d(fc));return Ib}store(ib,Ib,fc,Cc){if(this.zD===P.Annotations.YU){var Jc=Ib,pd=({yHa:Cc}=this.A0a(Cc)).returnValue;pd&&(Jc=pd.store(P.Annotations.NS(this.E0d(ib)),Ib,fc,Cc));ib.ry(this.Bb.lta,Jc)}else{var ge=Ib;if(Jc=({yHa:Cc}=this.A0a(Cc)).returnValue){ge=new Qb.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.lta));
for(pd of ib.items)Array.add(ge.items,this.E0d(pd));ge=Jc.store(ge,Ib,fc,Cc)}Ib=ge;if(Ib.items.length!==ib.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let pe=0,ke=ib.items.length;pe<ke;++pe)fc=ib.items[pe],fc.isReadOnly&&(fc=fc.clone(),ib.items[pe]=fc),fc.ry(this.Bb.lta,Ib.items[pe])}return ib}E0d(ib){({value:ib}=ib.yq(this.Bb.lta)).returnValue||(ib=this.Bb.annotations.uFl(this.Bb.lta));return ib}}Object(l.a)(Wb,"AttrAnnotationQueryStep",bb,
[]);class Qa{constructor(ib,Ib){ib&&(this.annotations=Ib,this.lta=ib.J(0))}}Object(l.a)(Qa,"AttrQueryStepInit",null,[]);class sb extends bb{constructor(ib){super();this.Bb=ib}load(ib){const Ib=new N.a(this.Bb.annotations);Ib.vZa(ib);return this.Bb.module.execute(Ib)}}Object(l.a)(sb,"CallModuleAnnotationQueryStep",bb,[]);class Jb{constructor(ib,Ib){ib&&(this.annotations=Ib.annotations,this.module=Ib.Dpf(ib.J(0)))}}Object(l.a)(Jb,"CallModuleQueryStepInit",null,[]);class pc extends bb{constructor(ib){super();
this.Bb=ib}load(ib,Ib){if(P.Annotations.NH(this.zD)){var fc=this.Bb.query.mt(ib,Ib);Ib=new Qb.a(this.Bb.annotations,P.Annotations.y9);let pd="string"===typeof fc;for(var Cc of ib.items)if(pd)Array.add(Ib.items,Cc+fc);else for(var Jc of fc.items)Array.add(Ib.items,Cc+Jc);return Ib}Cc=this.Bb.query.mt(ib,Ib);if("string"===typeof Cc)return ib+Cc;Jc=new Qb.a(this.Bb.annotations,P.Annotations.y9);for(fc of Cc.items)Array.add(Jc.items,ib+fc);return Jc}}Object(l.a)(pc,"ConcatAnnotationQueryStep",bb,[]);
class rc extends bb{constructor(ib){super();this.Bb=ib}load(ib){return Aa.NBh(this.Bb.annotations,ib,this.zD,this.m4)}}Object(l.a)(rc,"ConvertAnnotationQueryStep",bb,[]);class db extends bb{constructor(){super()}load(ib){return ib.items.length}}Object(l.a)(db,"CountAnnotationQueryStep",bb,[]);class lb extends nb{constructor(ib){super(ib)}Z0b(ib,Ib){return ib/Ib}}Object(l.a)(lb,"DivideAnnotationQueryStep",nb,[]);class qa extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){Ib=new ra(this.Bb.Pme,
null,Ib);for(const fc of ib.items)if(Ib.m4e(fc),this.Bb.query.mt(fc,Ib))return!0;return!1}}Object(l.a)(qa,"ExistsAnnotationQueryStep",bb,[]);class Ga extends nb{constructor(ib){super(ib)}Z0b(ib,Ib){return Math.pow(ib,Ib)}}Object(l.a)(Ga,"ExpAnnotationQueryStep",nb,[]);class Fb{constructor(ib,Ib){ib&&(this.TNa=Ib.uD(ib.J(0)))}}Object(l.a)(Fb,"FeatureBundleNameQueryStepInit",null,[]);class $b extends bb{constructor(ib){super();this.Bb=ib}load(ib){if(P.Annotations.NH(this.zD)){const Ib=new Qb.a(this.Bb.annotations,
this.Bb.annotations.cEb(P.Annotations.w0a(this.zD),this.Bb.UNa));for(const fc of ib.items)Array.add(Ib.items,fc.Fgb(this.Bb.UNa));return Ib}return ib.Fgb(this.Bb.UNa)}store(ib,Ib,fc,Cc){if(P.Annotations.NH(this.zD)){var Jc=Ib,pd=({yHa:Cc}=this.A0a(Cc)).returnValue;if(pd){Jc=new Qb.a(this.Bb.annotations,this.Bb.annotations.cEb(P.Annotations.w0a(this.zD),this.Bb.UNa));for(var ge of ib.items)Array.add(Jc.items,ge.Fgb(this.Bb.UNa));Jc=pd.store(Jc,Ib,fc,Cc)}Ib=Jc;if(Ib.items.length!==ib.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let pe=0,ke=ib.items.length;pe<ke;++pe)fc=ib.items[pe],fc.isReadOnly&&(fc=fc.clone(),ib.items[pe]=fc),fc.q8f(this.Bb.UNa,Ib.items[pe])}else pd=Ib,(ge=({yHa:Cc}=this.A0a(Cc)).returnValue)&&(pd=ge.store(P.Annotations.NS(ib.Fgb(this.Bb.UNa)),Ib,fc,Cc)),ib.q8f(this.Bb.UNa,pd);return ib}}Object(l.a)($b,"FieldAnnotationQueryStep",bb,[]);class rb{constructor(ib,Ib){ib&&(this.annotations=Ib,this.UNa=ib.J(0))}}Object(l.a)(rb,"FieldQueryStepInit",null,[]);class xb extends bb{constructor(ib){super();this.Bb=
ib}load(ib,Ib){for(const fc of ib.items)if(this.Bb.filter.isMatch(fc,Ib))return fc;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(ib,Ib,fc,Cc){let Jc=Ib,pd=-1;for(let pe=0,ke=ib.items.length;pe<ke;pe++)if(this.Bb.filter.isMatch(ib.items[pe],fc)){pd=pe;break}if(0>pd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const ge=({yHa:Cc}=this.A0a(Cc)).returnValue;ge&&(Jc=ge.store(P.Annotations.NS(ib.items[pd]),Ib,fc,Cc));
ib.items[pd]=Jc;return ib}}Object(l.a)(xb,"FirstItemMatchingAnnotationQueryStep",bb,[]);class gb extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){Ib=new ra(this.Bb.Pme,null,Ib);for(const fc of ib.items)if(Ib.m4e(fc),!this.Bb.query.mt(fc,Ib))return!1;return!0}}Object(l.a)(gb,"ForAllAnnotationQueryStep",bb,[]);class Gb extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){ib=Ib?Ib.INd(this.Bb.TNa):null;if(!ib)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.TNa+
'"');return ib}store(ib,Ib,fc,Cc){ib=fc?fc.INd(this.Bb.TNa):null;if(!ib)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.TNa+'"');let Jc=Ib;const pd=({yHa:Cc}=this.A0a(Cc)).returnValue;pd&&(Jc=pd.store(ib,Ib,fc,Cc));ib!==Jc&&ib.vZa(Jc);return ib}}Object(l.a)(Gb,"GetAnnotationQueryStep",bb,[]);class ac{constructor(ib,Ib){this.NTj=ib;this.J9j=Ib}get VEh(){return this.NTj}get SXi(){return this.J9j}}Object(l.a)(ac,"AnnotationQueryStoreContinuation",null,[1418]);class hc extends bb{constructor(ib){super();
this.Bb=ib}load(ib,Ib){return this.Bb.Dje.mt(ib,Ib)?this.Bb.rvj.mt(ib,Ib):this.Bb.dKd?this.Bb.dKd.mt(ib,Ib):ib}store(ib,Ib,fc,Cc){var Jc=this.Bb.Dje.mt(ib,fc);this.next&&(Cc=new ac(this.next,Cc));if(Jc)return this.Bb.rvj.kjc(ib,Ib,fc,Cc);if(this.Bb.dKd)return this.Bb.dKd.kjc(ib,Ib,fc,Cc);Jc=Ib;let pd=null;Cc&&(pd=Cc.VEh,Cc=Cc.SXi);pd&&(Jc=pd.store(P.Annotations.NS(ib),Ib,fc,Cc));return Jc}}Object(l.a)(hc,"IfAnnotationQueryStep",bb,[]);class Ec{constructor(ib,Ib){ib&&(this.Dje=Ib.vK(ib.J(0)),this.rvj=
Ib.vK(ib.J(1)),this.dKd=ib.J(2)?Ib.vK(ib.J(2)):null)}}Object(l.a)(Ec,"IfQueryStepInit",null,[]);class Uc{constructor(ib,Ib){ib&&(this.Dom=Ib.vK(ib.J(0)),this.yzi=Ib.vK(ib.J(1)))}}Object(l.a)(Uc,"IndexAndItemQueryStepInit",null,[]);class dd extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){const fc=this.Bb.Dom.mt(ib,Ib);Ib=this.Bb.yzi.mt(ib,Ib);ib=ib.clone();if(0>fc||fc>ib.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(P.Annotations.NH(this.Bb.yzi.m4))for(let Cc=
0;Cc<Ib.items.length;++Cc)Array.insert(ib.items,fc+Cc,Ib.items[Cc]);else Array.insert(ib.items,fc,Ib);return ib}}Object(l.a)(dd,"InsertAtAnnotationQueryStep",bb,[]);class fd extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){return!(!Ib||!Ib.INd(this.Bb.TNa))}}Object(l.a)(fd,"IsDefinedAnnotationQueryStep",bb,[]);class xc extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){Ib=this.MI(ib,Ib);return ib.items[Ib]}store(ib,Ib,fc,Cc){const Jc=this.MI(ib,fc);let pd=Ib;const ge=({yHa:Cc}=this.A0a(Cc)).returnValue;
ge&&(pd=ge.store(P.Annotations.NS(ib.items[Jc]),Ib,fc,Cc));ib.items[Jc]=pd;return ib}MI(ib,Ib){Ib=this.Bb.query.mt(ib,Ib);if(0>Ib||Ib>=ib.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Ib}}Object(l.a)(xc,"ItemAnnotationQueryStep",bb,[]);class $c extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){const fc=new Qb.a(this.Bb.annotations,P.Annotations.w0a(this.zD));for(const Cc of ib.items)this.Bb.filter.isMatch(Cc,Ib)&&Array.add(fc.items,Cc);return fc}}
Object(l.a)($c,"ItemsMatchingAnnotationQueryStep",bb,[]);class Bc extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){Ib=this.MI(ib,Ib);return ib.items[ib.items.length-Ib-1]}store(ib,Ib,fc,Cc){const Jc=this.MI(ib,fc);let pd=Ib;const ge=({yHa:Cc}=this.A0a(Cc)).returnValue;ge&&(pd=ge.store(P.Annotations.NS(ib.items[ib.items.length-Jc-1]),Ib,fc,Cc));ib.items[ib.items.length-Jc-1]=pd;return ib}MI(ib,Ib){Ib=this.Bb.query?this.Bb.query.mt(ib,Ib):0;if(0>Ib||Ib>=ib.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Ib}}Object(l.a)(Bc,"LastItemAnnotationQueryStep",bb,[]);class Vd extends bb{constructor(ib){super();this.Bb=ib}load(ib){if(P.Annotations.NH(this.zD)){const Ib=new Qb.a(this.Bb.annotations,P.Annotations.eIa);for(const fc of ib.items)Array.add(Ib.items,fc.length);return Ib}return ib.length}}Object(l.a)(Vd,"LengthAnnotationQueryStep",bb,[]);class Je extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){if(P.Annotations.NH(this.zD)){const fc=new Qb.a(this.Bb.annotations,P.Annotations.yya);
for(const Cc of ib.items)Array.add(fc.items,this.Bb.filter.isMatch(Cc,Ib));return fc}return this.Bb.filter.isMatch(ib,Ib)}}Object(l.a)(Je,"MatchesAnnotationQueryStep",bb,[]);class Gf extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){return this.Bb.filter.isMatch(ib,Ib)}}Object(l.a)(Gf,"MatchesAsListAnnotationQueryStep",bb,[]);class Nc extends nb{constructor(ib){super(ib)}Z0b(ib,Ib){return ib%Ib}}Object(l.a)(Nc,"ModuloAnnotationQueryStep",nb,[]);class md extends nb{constructor(ib){super(ib)}Z0b(ib,
Ib){return ib*Ib}}Object(l.a)(md,"MultiplyAnnotationQueryStep",nb,[]);class Oe extends bb{constructor(ib){super();this.Bb=ib}load(ib){if(P.Annotations.NH(this.zD)){const Ib=new Qb.a(this.Bb.annotations,P.Annotations.yya);for(const fc of ib.items)Array.add(Ib.items,!fc);return Ib}return!ib}}Object(l.a)(Oe,"NotAnnotationQueryStep",bb,[]);class fg extends Ab{constructor(ib){super(ib)}pxh(ib){return{returnValue:ib,result:!0}}aGc(ib,Ib){return ib||Ib}}Object(l.a)(fg,"OrAnnotationQueryStep",Ab,[]);class If extends bb{constructor(ib){super();
this.Bb=ib}load(ib,Ib){const fc=this.Bb.Ycg.mt(ib,Ib);ib=this.Bb.KGc.mt(ib,Ib);Ib=new Qb.a(this.Bb.annotations,P.Annotations.eIa);for(let Cc=0;Cc<ib;++Cc)Array.add(Ib.items,fc+Cc);return Ib}}Object(l.a)(If,"RangeAnnotationQueryStep",bb,[]);class tf{constructor(ib,Ib){ib&&(this.annotations=Ib.annotations,this.filter=Ib.Ima(ib.J(0)))}}Object(l.a)(tf,"SingleFilterQueryStepInit",null,[]);class vf{constructor(ib,Ib){ib&&(this.annotations=Ib.annotations,this.query=ib.J(0)?Ib.vK(ib.J(0)):null)}}Object(l.a)(vf,
"SingleOptionalQueryQueryStepInit",null,[]);class $f{constructor(ib,Ib){ib&&(this.annotations=Ib.annotations,this.query=Ib.vK(ib.J(0)))}}Object(l.a)($f,"SingleQueryQueryStepInit",null,[]);class vg{constructor(ib,Ib){ib&&(this.annotations=Ib.annotations,this.Ycg=Ib.vK(ib.J(0)),this.KGc=ib.J(1)?Ib.vK(ib.J(1)):null)}}Object(l.a)(vg,"StartAndCountOrLengthQueryStepInit",null,[]);class Kf extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){let fc;({startIndex:Ib,length:fc}=this.zQd(ib,Ib));const Cc=
new Qb.a(this.Bb.annotations,ib.L3);for(let Jc=0;Jc<fc;++Jc)Array.add(Cc.items,ib.items[Ib+Jc]);return Cc}store(ib,Ib,fc,Cc){let Jc,pd;({startIndex:Jc,length:pd}=this.zQd(ib,fc));var ge=Ib;const pe=({yHa:Cc}=this.A0a(Cc)).returnValue;if(pe){ge=new Qb.a(this.Bb.annotations,ib.L3);for(let ke=0;ke<pd;++ke)Array.add(ge.items,ib.items[Jc+ke]);ge=pe.store(ge,Ib,fc,Cc)}Ib=ge;for(fc=0;fc<pd;++fc)Array.removeAt(ib.items,Jc);for(let ke=0,Qf=Ib.items.length;ke<Qf;++ke)Array.insert(ib.items,Jc+ke,Ib.items[ke]);
return ib}zQd(ib,Ib){let fc;fc=this.Bb.Ycg.mt(ib,Ib);if(0>fc)throw Error.invalidOperation("Invalid start index in Sublist() query step");Ib=this.Bb.KGc?this.Bb.KGc.mt(ib,Ib):ib.items.length-fc;if(0>Ib||fc+Ib>ib.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:fc,length:Ib}}}Object(l.a)(Kf,"SublistAnnotationQueryStep",bb,[]);class Ph extends bb{constructor(ib){super();this.Bb=ib}load(ib,Ib){if(P.Annotations.NH(this.zD)){const fc=
new Qb.a(this.Bb.annotations,P.Annotations.y9);for(let Cc=0,Jc=ib.items.length;Cc<Jc;++Cc)Array.add(fc.items,this.bdi(ib.items[Cc],Ib));return fc}return this.bdi(ib,Ib)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}bdi(ib,Ib){let fc;({startIndex:Ib,length:fc}=this.zQd(ib,Ib));return ib.substr(Ib,fc)}zQd(ib,Ib){let fc;fc=this.Bb.Ycg.mt(ib,Ib);if(0>fc)throw Error.invalidOperation("Invalid start index in Substring() query step");Ib=this.Bb.KGc?this.Bb.KGc.mt(ib,
Ib):ib.length-fc;if(0>Ib||fc+Ib>ib.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:fc,length:Ib}}}Object(l.a)(Ph,"SubstringAnnotationQueryStep",bb,[]);class ff extends nb{constructor(ib){super(ib)}Z0b(ib,Ib){return ib-Ib}}Object(l.a)(ff,"SubtractAnnotationQueryStep",nb,[]);class yc extends bb{constructor(ib){super();this.Bb=ib}load(ib){const Ib=new Qb.a(this.Bb.annotations,P.Annotations.y9);for(let fc=0;fc<ib.length;++fc)Array.add(Ib.items,
ib.charAt(fc).toString());return Ib}}Object(l.a)(yc,"ToCharListAnnotationQueryStep",bb,[]);class Rd extends bb{constructor(ib){super();this.Bb=ib}load(ib){const Ib=new Qb.a(this.Bb.annotations,this.zD);Array.add(Ib.items,ib);return Ib}}Object(l.a)(Rd,"ToListAnnotationQueryStep",bb,[]);class de extends bb{constructor(ib){super();this.Bb=ib}load(){return this.Bb.value}}Object(l.a)(de,"ValueAnnotationQueryStep",bb,[]);class Sb{constructor(ib,Ib){if(ib){var fc=ib.J(0),Cc=1;this.value=({hga:Cc}=Ib.tNa(fc,
ib,Cc,null,null,null)).returnValue;P.Annotations.bIb(this.value)}}}Object(l.a)(Sb,"ValueQueryStepInit",null,[]);class nc{constructor(ib,Ib){ib&&(this.Pme=Ib.uD(ib.J(0)),this.query=Ib.vK(ib.J(1)))}}Object(l.a)(nc,"VarNameAndQueryQueryStepInit",null,[]);class Tc{constructor(ib,Ib){this.$Rg=null;if(ib){this.annotations=Ib.annotations;var fc=0;this.zD=ib.J(fc);++fc;this.m4=ib.J(fc);++fc;this.Gie=1===ib.J(fc);++fc;this.sWd=1===ib.J(fc);++fc;var Cc=ib.J(fc);++fc;if(Cc){var Jc=fc,pd=fc+Cc,ge=fc+2*Cc;fc+=
3*Cc;var pe=ib.count-fc,ke=null;for(let Hg=0;Hg<Cc;++Hg){var Qf=fc+ib.J(ge+Hg);const gc=(Hg===Cc-1?pe:ib.J(ge+Hg+1))-ib.J(ge+Hg),nh=new pb.a;nh.cgb(ib,Qf,gc);Qf=Tc.tXl(ib.J(pd+Hg),nh,Ib);Qf.zD=ib.J(Jc+Hg);Qf.m4=Hg===Cc-1?this.m4:ib.J(Jc+Hg+1);ke?ke.next=Qf:this.$Rg=Qf;ke=Qf}}}}get hXh(){return this.$Rg}static tXl(ib,Ib,fc){switch(ib){case 1:return new Gb(new Fb(Ib,fc));case 2:return new fd(new Fb(Ib,fc));case 3:return new Wb(new Qa(Ib,fc.annotations));case 4:return new $b(new rb(Ib,fc.annotations));
case 5:return new hc(new Ec(Ib,fc));case 6:return new Je(new tf(Ib,fc));case 43:return new Gf(new tf(Ib,fc));case 45:return new jc(new Ub(Ib,fc));case 49:return new zb(new cc(Ib,fc));case 46:return new de(new Sb(Ib,fc.annotations));case 51:return new sb(new Jb(Ib,fc));case 52:return new If(new vg(Ib,fc));case 53:return new rc(new Kb(fc.annotations));case 13:return new xc(new $f(Ib,fc));case 14:return new Bc(new vf(Ib,fc));case 15:return new db;case 18:return new xb(new tf(Ib,fc));case 16:return new gb(new nc(Ib,
fc));case 17:return new qa(new nc(Ib,fc));case 22:return new dd(new Uc(Ib,fc));case 24:return new dc(new $f(Ib,fc));case 26:return new Kf(new vg(Ib,fc));case 27:return new $c(new tf(Ib,fc));case 30:return new Rd(new Kb(fc.annotations));case 31:return new Ph(new vg(Ib,fc));case 32:return new pc(new $f(Ib,fc));case 47:return new Vd(new Kb(fc.annotations));case 48:return new yc(new Kb(fc.annotations));case 34:return new Va(new $f(Ib,fc));case 35:return new ff(new $f(Ib,fc));case 36:return new md(new $f(Ib,
fc));case 37:return new lb(new $f(Ib,fc));case 38:return new Nc(new $f(Ib,fc));case 39:return new Ga(new $f(Ib,fc));case 40:return new Zb(new $f(Ib,fc));case 41:return new fg(new $f(Ib,fc));case 42:return new Oe(new Kb(fc.annotations));default:throw Error.argument("currStepInitData");}}}Object(l.a)(Tc,"AnnotationQueryInit",null,[]);class td{constructor(ib){this.Bb=ib}execute(ib,Ib){this.LNa(ib,ib?new ra("root",ib,Ib):Ib)}LNa(ib,Ib){for(const fc of this.Bb.commands)Ib=fc.execute(ib,Ib)}}Object(l.a)(td,
"AnnotationScript",null,[1386]);class je{constructor(ib){this.Bb=ib}execute(ib,Ib){const fc=this.Bb.Jsm.mt(ib,Ib),Cc=this.Bb.mrn.mt(ib,Ib);this.Bb.script.LNa(ib,new ra("Input",fc,new ra("Output",Cc,Ib)));return Ib}}Object(l.a)(je,"ApplyAnnotationScriptCommand",null,[1412]);class se{constructor(ib,Ib){ib&&(this.Jsm=Ib.vK(ib.J(0)),this.mrn=Ib.vK(ib.J(1)),this.script=Ib.DCb(ib.J(2)))}}Object(l.a)(se,"ApplyScriptCommandInit",null,[]);class Ze{constructor(ib){this.Bb=ib}execute(ib,Ib){const fc=this.Bb.L5f.mt(ib,
Ib);this.Bb.w1d.kjc(ib,fc,Ib,null);return Ib}}Object(l.a)(Ze,"AssignAnnotationScriptCommand",null,[1412]);class Xe{constructor(ib){this.Bb=ib}execute(ib,Ib){const fc=this.Bb.w1d.mt(ib,Ib);ib=this.Bb.L5f.mt(ib,Ib);fc!==ib&&fc.vZa(ib);return Ib}}Object(l.a)(Xe,"CopyAnnotationScriptCommand",null,[1412]);class ye{constructor(ib){this.Bb=ib}execute(ib,Ib){let fc=this.Bb.gHf.mt(ib,Ib);if(this.Bb.gHf.Gie){fc=P.Annotations.NS(fc);var Cc=new ra(this.Bb.TNa,null,Ib);for(let pd=0,ge=fc.items.length;pd<ge;++pd){var Jc=
this.ITh(ib,fc.items[pd],Cc);if(0>this.Bb.rce)fc.items[pd]=Jc;else if(({value:Jc}=Jc.yq(this.Bb.rce)).returnValue)fc.items[pd]=Jc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Bb.gHf.kjc(ib,fc,Ib,null)}else{Cc=new ra(this.Bb.TNa,null,Ib);for(let pd=0,ge=fc.items.length;pd<ge;++pd)this.ITh(ib,fc.items[pd],Cc)}return Ib}ITh(ib,Ib,fc){let Cc;0>this.Bb.rce?Cc=P.Annotations.NS(Ib):(Cc=new N.a(this.Bb.annotations),Cc.ry(this.Bb.rce,Ib));fc.m4e(Cc);
this.Bb.RDk.LNa(ib,fc);return Cc}}Object(l.a)(ye,"EnumerateAnnotationScriptCommand",null,[1412]);class Ei{constructor(ib,Ib){ib&&(this.annotations=Ib.annotations,this.TNa=Ib.uD(ib.J(0)),this.gHf=Ib.vK(ib.J(1)),this.RDk=Ib.DCb(ib.J(2)),this.rce=ib.J(3))}}Object(l.a)(Ei,"EnumerateScriptCommandInit",null,[]);class Db{constructor(ib){this.Bb=ib}execute(ib,Ib){this.Bb.Dje.mt(ib,Ib)?this.Bb.lGo.LNa(ib,Ib):this.Bb.MUh&&this.Bb.MUh.LNa(ib,Ib);return Ib}}Object(l.a)(Db,"IfAnnotationScriptCommand",null,[1412]);
class Vb{constructor(ib,Ib){ib&&(this.Dje=Ib.vK(ib.J(0)),this.lGo=Ib.DCb(ib.J(1)),this.MUh=ib.J(2)?Ib.DCb(ib.J(2)):null)}}Object(l.a)(Vb,"IfScriptCommandInit",null,[]);class Sc{constructor(ib,Ib){ib&&(this.annotations=Ib.annotations,this.w1d=Ib.vK(ib.J(0)),this.L5f=Ib.vK(ib.J(1)))}}Object(l.a)(Sc,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class bd{constructor(ib){this.Bb=ib}execute(ib,Ib){const fc=this.Bb.L5f.mt(this.Bb.w1d.mt(ib,Ib),Ib);this.Bb.w1d.kjc(ib,fc,Ib,null);return Ib}}Object(l.a)(bd,
"ModifyAnnotationScriptCommand",null,[1412]);class Ud{constructor(ib){this.Bb=ib}execute(ib,Ib){const fc=new N.a(this.Bb.annotations);this.Bb.query&&fc.vZa(this.Bb.query.mt(ib,Ib));return Ib=new ra(this.Bb.TNa,fc,Ib)}}Object(l.a)(Ud,"NewAnnotationScriptCommand",null,[1412]);class sf{constructor(ib,Ib){ib&&(this.annotations=Ib.annotations,this.TNa=Ib.uD(ib.J(0)),this.query=ib.J(1)?Ib.vK(ib.J(1)):null)}}Object(l.a)(sf,"NewScriptCommandInit",null,[]);class eg{constructor(ib){this.Bb=ib}execute(ib,Ib){ib=
this.Bb.query.mt(ib,Ib);if(this.Bb.query.m4===P.Annotations.YU)ib.NRa(this.Bb.lta);else for(const fc of ib.items)fc.NRa(this.Bb.lta);return Ib}}Object(l.a)(eg,"RemoveAnnotationScriptCommand",null,[1412]);class Ug{constructor(ib,Ib){ib&&(this.annotations=Ib.annotations,this.query=Ib.vK(ib.J(0)),this.lta=ib.J(1))}}Object(l.a)(Ug,"RemoveScriptCommandInit",null,[]);class Lh{constructor(ib,Ib){if(ib){var fc=0,Cc=ib.J(fc);++fc;if(Cc){var Jc=fc,pd=fc+Cc;fc+=2*Cc;var ge=ib.count-fc;this.commands=Array(Cc);
for(let pe=0;pe<Cc;++pe){const ke=fc+ib.J(pd+pe),Qf=(pe===Cc-1?ge:ib.J(pd+pe+1))-ib.J(pd+pe),Hg=new pb.a;Hg.cgb(ib,ke,Qf);this.commands[pe]=Lh.jXl(ib.J(Jc+pe),Hg,Ib)}}}}static jXl(ib,Ib,fc){switch(ib){case 1:return new Ze(new Sc(Ib,fc));case 2:return new bd(new Sc(Ib,fc));case 3:return new eg(new Ug(Ib,fc));case 6:return new Ud(new sf(Ib,fc));case 7:return new ye(new Ei(Ib,fc));case 8:return new Db(new Vb(Ib,fc));case 9:return new Xe(new Sc(Ib,fc));case 10:return new je(new se(Ib,fc));default:throw Error.argument("initData");
}}}Object(l.a)(Lh,"AnnotationScriptInit",null,[]);var ah=c(1633);class dh{constructor(ib){this.a1=ib;this.Gx=0}W8(){const ib=this.a1.oy(this.Gx,4);this.Gx+=4;return ib}get Dea(){return this.a1}get offset(){return this.Gx}set offset(ib){this.Gx=ib}}Object(l.a)(dh,"ByteArrayReader",null,[]);class Hf{constructor(){this.fJ=null;this.wFi=this.Bba=0}J(ib){if(0>ib||ib>=this.Bba)throw Error.argumentOutOfRange("index");return this.fJ.oy(this.wFi+4*ib,4)}get count(){return this.Bba}static G3k(ib,Ib,fc){const Cc=
new Hf;Cc.fJ=ib;Cc.wFi=Ib;Cc.Bba=fc;return Cc}}Object(l.a)(Hf,"ReadOnlyListOverByteArray",null,[1369]);class Mf{constructor(ib,Ib){this.pFi=this.oFi=!1;this.Yv=this.rQa=this.PIf=this.sFi=null;try{this.Yv=Ib.annotations;const fc=Ib.pgb(ib.J(0)),Cc=new dh(fc);if(-914743053!==Cc.W8())throw Error.argument("Input does not represent a flat lexicon");this.oFi=1===Cc.W8();this.pFi=1===Cc.W8();const Jc=Cc.W8();Cc.offset+=Jc;const pd=Cc.W8();this.PIf=Mf.ytn(Cc,pd,this.Yv);const ge=Cc.W8();this.sFi=Mf.Qtn(Cc,
ge);const pe=Cc.W8();this.rQa=new ah.a(Cc.Dea,Cc.offset);Cc.offset+=pe}catch(fc){throw Error.argument("initData");}}get trie(){return this.rQa}oHl(ib){return"i"===ib&&this.pFi?"\u0130":ib.toUpperCase()}tzf(){return this.oFi}IEl(ib){let Ib;Ib=new Qb.a(this.Yv,P.Annotations.YU);if(1!==ib)if(0===ib)ib=new N.a(this.Yv),Array.add(Ib.items,ib);else if(ib&1073741824){ib=this.sFi[ib&-1073741825];for(let Cc=0;Cc<ib.length;++Cc){var fc=ib[Cc];fc=0===fc?new N.a(this.Yv):this.PIf[fc-2];Array.add(Ib.items,fc)}}else Array.add(Ib.items,
this.PIf[ib-2]);return{returnValue:!0,gRm:Ib}}static ytn(ib,Ib,fc){if(Ib%4)throw Error.argument("reader");const Cc=Hf.G3k(ib.Dea,ib.offset,Ib/4);ib.offset+=Ib;ib=[];for(Ib=0;Ib<Cc.count;){const Jc=({hga:Ib}=fc.tNa(P.Annotations.YU,Cc,Ib,null,null,null)).returnValue;Array.add(ib,Jc)}return ib}static Qtn(ib,Ib){Ib=ib.offset+Ib;const fc=[];for(;ib.offset<Ib;){const Cc=ib.W8(),Jc=Array(Cc);for(let pd=0;pd<Cc;++pd){const ge=ib.W8();Jc[pd]=ge}Array.add(fc,Jc)}return fc}}Object(l.a)(Mf,"RawFlatLexicon",
null,[1385]);var Md=c(1620),Sd=c(1621);class Pd{constructor(ib){if(null==ib)throw Error.argumentNull("base64String");const Ib=ib.length;if(Ib%4)throw Error.argument("base64String's length must be a multiple of 4");this.Bba=.75*Ib;this.mIb=Array(Math.ceil(this.Bba/4));ib.endsWith("==")?this.Bba-=2:ib.endsWith("=")&&--this.Bba;let fc=0;for(let Cc=0;Cc<Ib;Cc+=4){const Jc=Pd.hde[ib.charCodeAt(Cc)-43]<<18|Pd.hde[ib.charCodeAt(Cc+1)-43]<<12|Pd.hde[ib.charCodeAt(Cc+2)-43]<<6|Pd.hde[ib.charCodeAt(Cc+3)-43];
let pd=Jc>>16&255;this.mIb[Math.floor(fc/4)]|=pd<<fc%4*8;++fc;pd=Jc>>8&255;this.mIb[Math.floor(fc/4)]|=pd<<fc%4*8;++fc;pd=Jc&255;this.mIb[Math.floor(fc/4)]|=pd<<fc%4*8;++fc}}get length(){return this.Bba}J(ib){if(0>ib||ib>=this.Bba)throw Error.argumentOutOfRange("i");return this.b1h(ib)}oy(ib,Ib){if(0>ib||0>Ib||ib+Ib>this.Bba)throw Error.argument("Bad range");let fc=0;for(let Cc=0;Cc<Ib;++Cc)fc|=this.b1h(ib+Cc)<<8*Cc;return fc}WIn(ib,Ib){let fc=0,Cc=0,Jc=Math.floor(ib/8);for(ib%=8;Cc<Ib;){const pd=
8-ib>Ib-Cc?Ib-Cc:8-ib,ge=this.J(Jc);fc|=(ge>>ib&~(255<<pd))<<Cc;Cc+=pd;++Jc;ib=0}return fc}b1h(ib){return this.mIb[Math.floor(ib/4)]>>ib%4*8&255}}Pd.hde=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(l.a)(Pd,"ByteArray",null,[]);class Fk{constructor(ib,Ib,fc){this.AD=ib;this.J2m=Ib;this.M2m=fc;this.EFi=Array(ib.b?ib.b.length:
0);this.mJf=new Md.a(new Sd.a(this.pgb(this.AD.s)));this.y8=Array(ib.t.length);this.RC=new P.Annotations(this.ngb(0),this)}get annotations(){return this.RC}get Rjl(){return this.AD.d}FWl(){if(!(""in this.AD.m))throw Error.argument("name","Unrecognized module");return this.Dpf(this.AD.m[""])}pgb(ib){if(0>ib||!this.AD.b||ib>=this.AD.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.EFi[ib]||(this.EFi[ib]=new Pd(this.AD.b[ib]))}uD(ib){if(1>ib||ib>=this.AD.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.AD.t[ib])throw Error.argument("blobID","Requested blob is not a string");if(null==this.y8[ib]){const Ib=this.ngb(ib).J(0);this.y8[ib]=this.mJf.uD(Ib)}return this.y8[ib]}TDb(ib){if(1>ib||ib>=this.AD.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.AD.t[ib])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.y8[ib]){var Ib=this.ngb(ib);const fc=this.uD(Ib.J(0));Ib=1===Ib.J(1);this.y8[ib]=new RegExp(fc,Ib?"i":"")}return this.y8[ib]}d4l(ib){if(1>ib||ib>=this.AD.t.length)throw Error.argumentOutOfRange("blobID");
if(3!==this.AD.t[ib])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}Dpf(ib){if(1>ib||ib>=this.AD.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.AD.t[ib])throw Error.argument("blobID","Requested blob is not an NL module");return this.y8[ib]||(this.y8[ib]=this.M2m.ZWl(this.ngb(ib),this))}vK(ib){if(1>ib||ib>=this.AD.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.AD.t[ib])throw Error.argument("blobID","Requested blob is not an annotation query");
return this.y8[ib]||(this.y8[ib]=new Aa(new Tc(this.ngb(ib),this)))}DCb(ib){if(1>ib||ib>=this.AD.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.AD.t[ib])throw Error.argument("blobID","Requested blob is not an annotation script");return this.y8[ib]||(this.y8[ib]=new td(new Lh(this.ngb(ib),this)))}Ima(ib){if(1>ib||ib>=this.AD.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.AD.t[ib])throw Error.argument("blobID","Requested blob is not a filter");return this.y8[ib]||(this.y8[ib]=
this.J2m.Ima(this.ngb(ib),this))}q2l(ib){if(1>ib||ib>=this.AD.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.AD.t[ib])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.y8[ib]||(this.y8[ib]=new Mf(this.ngb(ib),this))}ngb(ib){const Ib=this.AD.n[ib];ib=(ib<this.AD.t.length-1?this.AD.n[ib+1]:this.AD.n.length)-Ib;if(0>Ib||0>ib||Ib+ib>this.AD.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Ib+","+ib+")");const fc=new pb.a;
fc.Qjf(this.AD.n,Ib,ib);return fc}}Object(l.a)(Fk,"ObjectFetcher",null,[1339]);class Vg{constructor(ib,Ib,fc){if(!ib)throw Error.argumentNull("prediction");if(!Ib)throw Error.argumentNull("fieldNames");if(!fc)throw Error.argumentNull("values");if(Ib.length!==fc.length)throw Error.argument("values","fieldNames and values do not have same length");this.y9j=ib;this.nIb=Ib;this.VWc=fc}get prediction(){return this.y9j}get nVh(){return this.nIb.length}Enf(ib){return 0<=ib&&ib<this.nIb.length?this.nIb[ib]:
null}getValue(ib){return 0<=ib&&ib<this.VWc.length?this.VWc[ib]:null}}Object(l.a)(Vg,"PredictionData",null,[]);class Lf{constructor(ib,Ib){if(!ib)throw Error.argumentNull("predictions");if(!Ib)throw Error.argumentNull("tokenAttributes");this.P2m=ib;this.T2m=Ib}Iqf(){return this.P2m}S_h(){return this.T2m}}Object(l.a)(Lf,"PredictionDataWithTokenAttributes",null,[]);class kg{constructor(ib,Ib){this.prediction=null;this.score=0;this.prediction=ib;this.score=Ib}}Object(l.a)(kg,"PredictionWithScore",null,
[]);class Og{constructor(ib,Ib){if(!ib)throw Error.argumentNull("predictions");if(!Ib)throw Error.argumentNull("attributes");this.z9j=ib;this.UPj=Ib}Iqf(){return this.z9j}S_h(){return this.UPj}}Object(l.a)(Og,"PredictionsWithTokenAttributes",null,[]);class kh{constructor(ib,Ib,fc){if(!ib)throw Error.argumentNull("attributeName");if(!Ib)throw Error.argumentNull("fieldNames");if(!fc)throw Error.argumentNull("values");if(Ib.length!==fc.length)throw Error.argument("values","fieldNames and values do not have same length");
this.TPj=ib;this.nIb=Ib;this.VWc=fc}get attributeName(){return this.TPj}get nVh(){return this.nIb.length}Enf(ib){return 0<=ib&&ib<this.nIb.length?this.nIb[ib]:null}getValue(ib){return 0<=ib&&ib<this.VWc.length?this.VWc[ib]:null}}Object(l.a)(kh,"TokenAttributes",null,[]);var ai=c(46),Bn=c(101);class yh{constructor(ib,Ib,fc,Cc,Jc){this.abd=0;this.Fmg=null;this.bbd=this.mmc=0;this.Nne=this.oQb=this.Dqa=this.nmc=null;this.Gmg=0;this.QIe=this.MB=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=
this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.FR=ib;this.wFj=this.AFj=Ib;this.vFj=this.yFj=fc;this.Zad=this.xFj=Cc;this.$ad=this.zFj=Jc}BFj(){this.bbd=0;return this.Dmg}Dmg(){if(!(this.bbd<this.Zad))return this.Emg;this.nmc=this.wFj.items[this.bbd+this.vFj];this.Dqa=new N.a(this.FR.Bb.annotations);1!==this.Zad&&this.FR.Bb.fSc||this.Dqa.vZa(this.nmc);if(0<=this.FR.Bb.l3d){({value:this.oQb}=this.Dqa.yq(this.FR.Bb.l3d)).returnValue?this.oQb=this.oQb.NS():this.oQb=new Qb.a(this.FR.Bb.annotations,
P.Annotations.YU);this.Nne=this.$ad.items;this.Gmg=this.Nne.length;for(this.abd=0;this.abd<this.Gmg;++this.abd)this.Fmg=this.Nne[this.abd],Array.add(this.oQb.items,this.Fmg);this.Dqa.ry(this.FR.Bb.l3d,this.oQb)}else 0<=this.FR.Bb.Ubg?this.Dqa.ry(this.FR.Bb.Ubg,this.$ad.items[0]):0<=this.FR.Bb.E1e?this.Dqa.ry(this.FR.Bb.E1e,!0):this.FR.Bb.vvi?this.$ad.items[0].BLd((ib,Ib)=>this.Dqa.ry(ib,Ib)):(this.Dqa.vZa(this.$ad.items[0]),1!==this.Zad&&this.FR.Bb.fSc||(({value:this.mmc}=this.nmc.yq(this.FR.Bb.B2)).returnValue&&
this.Dqa.ry(this.FR.Bb.B2,this.mmc),({value:this.mmc}=this.nmc.yq(this.FR.Bb.M6)).returnValue&&this.Dqa.ry(this.FR.Bb.M6,this.mmc),this.nmc.yq(this.FR.Bb.ddb).returnValue&&this.Dqa.ry(this.FR.Bb.ddb,this.mmc)));this.MB=this.Dqa;this._state=2;return this.DFj}Emg(){this._state=3}CFj(){this.bbd++;return this.Dmg}DFj(){return 1<this.Zad&&this.FR.Bb.fSc?this.Emg:this.CFj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new yh(this.FR,this.AFj,this.yFj,this.xFj,this.zFj)).getEnumerator()}[Symbol.iterator](){return Object(Bn.a)(this.getEnumerator())}moveNext(){if(3===
this._state)return!1;this._state?this._state=1:(this._state=1,this.QIe=this.BFj());for(;1===this._state;)this.QIe=this.QIe();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.MB}}Object(l.a)(yh,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[9,76,116]);class bi{constructor(ib,Ib,fc){this.SWc=this.xFi=0;this.Zbc=null;this.nJf=this.VIf=this.Xbc=this.D1d=this.YIf=
0;this.E1d=!1;this.hJf=ib;this.pJf=Ib;this.O2m=fc}M8h(){null===this.Zbc&&({isj:this.Zbc,Eki:this.YIf,length:this.D1d,Trl:ib}=this.hJf.wei(this.pJf.items[this.SWc],this.O2m),this.E1d=ib||this.E1d);if(this.Xbc<this.D1d){var ib=this.Zbc.charAt(this.YIf+this.Xbc);++this.Xbc;return{returnValue:!0,ch:ib}}if(this.SWc===this.pJf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.SWc;this.Xbc=0;this.Zbc=null;return{returnValue:!0,ch:" "}}y1f(ib,Ib){this.Xbc===this.D1d&&this.Zbc&&(this.nJf=Ib,this.VIf=
this.SWc-this.xFi+1)}n_n(ib){if(0>ib||ib>=this.pJf.items.length)throw Error.argumentOutOfRange("iToken");this.SWc=this.xFi=ib;this.Zbc=null;this.VIf=this.Xbc=this.D1d=this.YIf=0;this.nJf=-1;this.E1d=!1}CVl(){return{LIk:this.VIf,zOm:this.nJf,Srl:this.E1d}}}Object(l.a)(bi,"TriePrefixVisitor",null,[1397]);class qi{constructor(ib){this.Bb=ib}execute(ib){if(!({value:fc}=ib.yq(this.Bb.CMa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Ib;({value:Ib}=ib.yq(this.Bb.BYa)).returnValue||
(Ib=null);var fc=this.QDl(fc,Ib);ib=P.Annotations.NS(ib);ib.ry(this.Bb.CMa,fc);return ib}QDl(ib,Ib){let fc=null;const Cc=this.Bb.flatLexicon.trie,Jc=new bi(this,ib,Ib);let pd=null;this.Bb.flatLexicon.tzf()&&(pd=Object(ai.a)(this.Bb.flatLexicon,this.Bb.flatLexicon.oHl,"getCaseInsensitiveForm"));let ge=0,pe;var ke;let Qf;for(;ge<ib.items.length;){const Hg=ib.items[ge];Jc.n_n(ge);Cc.yDj(Jc,pd);({LIk:pe,zOm:ke,Srl:Qf}=Jc.CVl());if(0<pe){({gRm:ke}=this.Bb.flatLexicon.IEl(ke));for(let gc of this.C5k(ib,
ge,pe,ke)){1<pe&&this.Bb.fSc&&this.t6k(ib,Ib,ge,Hg,pe,Qf,gc);if(!fc)for(fc=new Qb.a(this.Bb.annotations,P.Annotations.YU),ke=0;ke<ge;++ke)Array.add(fc.items,ib.items[ke]);Array.add(fc.items,gc)}ge+=pe}else fc&&Array.add(fc.items,Hg),++ge}return fc||ib}t6k(ib,Ib,fc,Cc,Jc,pd,ge){if(pd)pd=!0;else if(this.Bb.gvi){pd=!1;var pe=-1;for(var ke=0;ke<Jc;ke++){var Qf=ib.items[fc+ke];let Yd;var Hg=void 0;if(!({value:Yd}=Qf.yq(this.Bb.B2)).returnValue||!({value:Hg}=Qf.yq(this.Bb.M6)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<ke){if(Yd>pe+1){pd=!0;break}if(0>pe||null===Ib||pe>=Ib.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Ib.charAt(pe)){pd=!0;break}}pe=Yd+Hg}}else pd=!1;if(pd){Hg=new Sys.StringBuilder;for(pd=0;pd<Jc;++pd)({isj:pe,Eki:ke,length:Qf}=this.wei(ib.items[fc+pd],Ib)),0<pd&&Hg.append(" "),Hg.append(pe.substr(ke,Qf));ge.ry(this.Bb.ddb,Hg.toString())}ib=ib.items[fc+Jc-1];let gc,nh;({value:Cc}=Cc.yq(this.Bb.B2)).returnValue&&
({value:gc}=ib.yq(this.Bb.B2)).returnValue&&({value:nh}=ib.yq(this.Bb.M6)).returnValue?(ge.ry(this.Bb.B2,Cc),ge.ry(this.Bb.M6,gc+nh-Cc)):(ge.NRa(this.Bb.B2),ge.NRa(this.Bb.M6))}C5k(ib,Ib,fc,Cc){return new yh(this,ib,Ib,fc,Cc)}wei(ib,Ib){let fc,Cc;if(({value:fc}=ib.yq(this.Bb.ddb)).returnValue)Cc=!0,Ib=0,ib=fc.length;else{Cc=!1;if(null===Ib)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");fc=Ib;if(!({value:Ib}=ib.yq(this.Bb.B2)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:ib}=ib.yq(this.Bb.M6)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Ib||0>ib||Ib+ib>fc.length)throw Error.argument("Token start/length values out of range","token");}return{isj:fc,Eki:Ib,length:ib,Trl:Cc}}}Object(l.a)(qi,"FlatLexiconNLModule",null,[1370]);class ql{constructor(ib,Ib){this.E1e=this.l3d=this.Ubg=this.ddb=this.M6=this.B2=this.BYa=this.CMa=0;this.vvi=this.gvi=this.fSc=!1;this.flatLexicon=null;this.annotations=Ib.annotations;
let fc=0;try{this.CMa=ib.J(fc),++fc,this.BYa=ib.J(fc),++fc,this.B2=ib.J(fc),++fc,this.M6=ib.J(fc),++fc,this.ddb=ib.J(fc),++fc,this.Ubg=ib.J(fc),++fc,this.l3d=ib.J(fc),++fc,this.E1e=ib.J(fc),++fc,this.fSc=1===ib.J(fc),++fc,this.gvi=1===ib.J(fc),++fc,this.vvi=1===ib.J(fc),++fc,this.flatLexicon=Ib.q2l(ib.J(fc))}catch(Cc){throw Error.argument("initData");}}}Object(l.a)(ql,"FlatLexiconNLModuleInit",null,[]);class ci{constructor(){this.oQc=0;this.Ghf=null;this.z4c=0}}Object(l.a)(ci,"FeatureGenStackRec",
null,[]);class Zk{constructor(ib){this.vgg=Array(ib);this.xkc=Array(ib);this.pdg=[];this.Opj=[]}}Object(l.a)(Zk,"TokenStringLattice",null,[]);const Wg=(ib,Ib,fc)=>{for(let Cc=0;Cc<ib.length;Cc++)fc=Ib(fc,ib[Cc]);return fc},Qh=(ib,Ib)=>{const fc=Array(ib.length);for(let Cc=0;Cc<ib.length;Cc++)fc[Cc]=Ib(ib[Cc]);return fc},Fm=(ib,Ib)=>{Ib=Array(Math.min(Ib,ib.length));for(let fc=0;fc<Ib.length;fc++)Ib[fc]=ib[fc];return Ib},Pg=(ib,Ib)=>{const fc=[];for(const Cc of ib)Ib(Cc)&&Array.add(fc,Cc);return fc};
class Xh{constructor(ib,Ib){this.key=ib;this.value=Ib}}Object(l.a)(Xh,"KeyValuePair",null,[]);const fi=(ib,Ib)=>({returnValue:Ib in ib,value:ib[Ib]}),kl=ib=>{const Ib=[];for(let fc in ib){const Cc=new Xh(fc,ib[fc]);Array.add(Ib,Cc)}return Ib};class $k{constructor(ib){this.vei=this.p9l;this.Bb=ib;this.H1d=this.eJf=this.fJf=0;for(const Ib of this.Bb.kKd)this.fJf=Math.max(this.fJf,Ib.jXf),this.eJf=Math.max(this.eJf,Ib.eXf),this.H1d=Math.max(this.H1d,Ib.Ynb.length)}get kul(){return this.Bb.kke.trie}execute(ib){if(!ib)throw Error.argumentNull("input");
let Ib,fc;({tokens:Ib,FPm:fc}=this.q9l(ib));let Cc=null,Jc=null,pd={};if(this.Bb.KSc){Ib=P.Annotations.NS(Ib);for(var ge=0;ge<Ib.items.length;++ge)Ib.items[ge]=P.Annotations.NS(Ib.items[ge])}else({UUh:Jc,returnValue:Cc}=this.H9h(ib,pd));ge=Array(this.H1d);const pe=Array(this.H1d);for(var ke=0;ke<pe.length;++ke)pe[ke]=new ci;for(ke=-this.fJf;ke<Ib.items.length+this.eJf;++ke){let Qf=null;this.Bb.KSc&&(Qf=Ib.items[ke],pd={},{UUh:Jc,returnValue:Cc}=this.H9h(Qf,pd));for(const Hg of this.Bb.kKd){if(0>ke&&
-ke>Hg.jXf||ke>=Ib.items.length&&ke-Ib.items.length+1>Hg.eXf)continue;let gc=!0;for(let nh=0;nh<Hg.Ynb.length;++nh){const Yd=ke+Hg.Ynb[nh];ge[nh]=Yd;if(0>Yd?0>this.Bb.kXf:Yd>=Ib.items.length?0>this.Bb.fXf:!fc.xkc[Yd]){gc=!1;break}}gc&&({I9k:Cc,J9k:Jc}=this.gvm(Hg,fc,Cc,Jc,pd,pe,ge))}this.Bb.KSc&&(Qf.ry(this.Bb.h2a?this.Bb.i0b:this.Bb.g0b,Cc),this.Bb.h2a&&Qf.ry(this.Bb.h0b,Jc))}ib=P.Annotations.NS(ib);this.Bb.KSc?ib.ry(this.Bb.CMa,Ib):(ib.ry(this.Bb.h2a?this.Bb.i0b:this.Bb.g0b,Cc),this.Bb.h2a&&ib.ry(this.Bb.h0b,
Jc));return ib}q9l(ib){let Ib,fc;if(!ib||!({value:Ib}=ib.yq(this.Bb.CMa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Cc;({value:Cc}=ib.yq(this.Bb.BYa)).returnValue||(Cc="");fc=new Zk(Ib.items.length);const Jc=Pg(this.Bb.ygg,pd=>!pd.jRc||pd.jRc.isMatch(ib,null));for(let pd=0;pd<Ib.items.length;++pd){const ge=Ib.items[pd];let pe=null;fc.vgg[pd]=fc.pdg.length;let ke=fc.xkc[pd]=0;for(const Qf of Jc)0<Qf.fXc&&fc.xkc[pd]+ke>=Qf.fXc||Qf.X8c&&!Qf.X8c.isMatch(ge,
null)||({Y8c:pe,nEc:ke}=Qf.apply(this,ge,pd,fc,Cc,pe,ke))}return{tokens:Ib,FPm:fc}}gvm(ib,Ib,fc,Cc,Jc,pd,ge){let pe=0;pd[0].oQc=-1;for(pd[0].Ghf=ib.f$i;;){var ke=ge[pe],Qf=0>ke||ke>=Ib.xkc.length?1:Ib.xkc[ke];let nh=!1;for(;pd[pe].oQc<Qf-1;){++pd[pe].oQc;var Hg=void 0,gc=void 0;0>ke?(Hg=this.Bb.kXf,gc=1):ke>=Ib.vgg.length?(Hg=this.Bb.fXf,gc=1):(gc=Ib.vgg[ke]+pd[pe].oQc,Hg=Ib.pdg[gc],gc=Ib.Opj[gc]);pd[pe].z4c=gc*(pe?pd[pe-1].z4c:ib.score);if(({value:Hg}=fi(pd[pe].Ghf,Hg.toString())).returnValue){pe===
ib.Ynb.length-1?(ke=Hg,pd[pe].z4c&&(({value:Qf}=fi(Jc,ke.toString())).returnValue||(Qf=-1),0>Qf&&(fc=P.Annotations.NS(fc),Array.add(fc.items,ke)),this.Bb.h2a&&(Cc=P.Annotations.NS(Cc),0>Qf?Array.add(Cc.items,pd[pe].z4c):Cc.items[Qf]+=pd[pe].z4c),0>Qf&&(this.Bb.Myi||this.Bb.h2a)&&(Jc[ke.toString()]=fc.items.length-1))):(++pe,pd[pe].oQc=-1,pd[pe].Ghf=Hg);nh=!0;break}}if(!nh&&(--pe,0>pe))break}return{I9k:fc,J9k:Cc}}H9h(ib,Ib){let fc;if(({value:fc}=ib.yq(this.Bb.h2a?this.Bb.i0b:this.Bb.g0b)).returnValue)for(let Cc=
0;Cc<fc.items.length;++Cc)Ib[fc.items[Cc].toString()]=Cc;else fc=new Qb.a(this.Bb.annotations,P.Annotations.eIa);if(this.Bb.h2a){if(({value:Ib}=ib.yq(this.Bb.h0b)).returnValue||(Ib=new Qb.a(this.Bb.annotations,P.Annotations.lqa)),Ib.items.length!==fc.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Bb.annotations.Vca(P.Annotations.YU,ib));}else Ib=null;return{returnValue:fc,UUh:Ib}}get ADo(){return this.Bb.kke}p9l(ib,
Ib){var fc;if(({value:fc}=Ib.yq(this.Bb.ddb)).returnValue)ib=fc;else{if(!({value:fc}=Ib.yq(this.Bb.B2)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Ib}=Ib.yq(this.Bb.M6)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>fc||0>Ib||fc+Ib>ib.length)throw Error.argument("Token indices are out of range");ib=ib.substr(fc,Ib)}return ib}}Object(l.a)($k,"NGramNLModule",null,[1370,1376]);class dj{constructor(ib){this.Ynb=null;this.score=this.eXf=this.jXf=
0;this.f$i=null;if(ib){var Ib=0;try{if(ib.J(Ib)!==dj.azb)throw Error.argument("initData","Input does not represent a feature template");++Ib;const fc=ib.J(Ib);++Ib;this.Ynb=Array(fc);for(let Cc=0;Cc<fc;++Cc)this.Ynb[Cc]=ib.J(Ib),++Ib;this.jXf=ib.J(Ib);++Ib;this.eXf=ib.J(Ib);++Ib;this.score=ib.J(Ib);++Ib;this.f$i=({yki:Ib}=dj.L0i(ib,Ib)).returnValue}catch(fc){throw Error.argument("initData");}}}static L0i(ib,Ib){const fc=ib.J(Ib);++Ib;const Cc={};for(let Jc=0;Jc<fc;++Jc){const pd=ib.J(Ib);++Ib;ib.J(Ib)?
Cc[pd.toString()]=({yki:Ib}=dj.L0i(ib,Ib)).returnValue:(++Ib,Cc[pd.toString()]=ib.J(Ib),++Ib)}return{returnValue:Cc,yki:Ib}}}dj.azb=240803228;Object(l.a)(dj,"FeatureTemplate",null,[1400]);var Mm=c(1578);class Qi{constructor(ib,Ib){this.h2a=this.Myi=this.KSc=!1;this.ddb=this.M6=this.B2=this.CMa=this.BYa=this.h0b=this.i0b=this.g0b=0;this.kke=null;this.fXf=this.kXf=0;this.kKd=this.ygg=null;if(ib){this.annotations=Ib.annotations;var fc=0;try{this.KSc=1===ib.J(fc);++fc;this.Myi=1===ib.J(fc);++fc;this.h2a=
1===ib.J(fc);++fc;this.g0b=ib.J(fc);++fc;this.i0b=ib.J(fc);++fc;this.h0b=ib.J(fc);++fc;this.BYa=ib.J(fc);++fc;this.CMa=ib.J(fc);++fc;this.B2=ib.J(fc);++fc;this.M6=ib.J(fc);++fc;this.ddb=ib.J(fc);++fc;this.kke=this.jun(Ib.pgb(ib.J(fc)));++fc;this.kXf=ib.J(fc);++fc;this.fXf=ib.J(fc);++fc;const Cc=ib.J(fc);++fc;this.ygg=Array(Cc);for(let pd=0;pd<Cc;++pd){const ge=ib.J(fc);++fc;const pe=this.kke.trie,ke=new pb.a;ke.cgb(ib,fc,ge);this.ygg[pd]=this.nun(ke,Ib,pe);fc+=ge}const Jc=ib.J(fc);++fc;this.kKd=Array(Jc);
for(Ib=0;Ib<Jc;++Ib){const pd=ib.J(fc);++fc;const ge=new pb.a;ge.cgb(ib,fc,pd);this.kKd[Ib]=this.Rtn(ge);fc+=pd}}catch(Cc){throw Error.argument("initData");}}}jun(ib){return new Md.a(new Sd.a(ib))}nun(ib,Ib,fc){return Mm.a.create(ib,Ib,fc)}Rtn(ib){return new dj(ib)}}Object(l.a)(Qi,"NGramNLModuleInit",null,[]);class Rg{constructor(ib){this.Bb=ib}execute(ib){if(!ib)throw Error.argumentNull("input");ib=ib.clone();this.Bb.script.execute(ib,null);return ib}}Object(l.a)(Rg,"ScriptNLModule",null,[1370]);
class Cj{constructor(ib,Ib){ib&&(this.script=Ib.DCb(ib.J(0)))}}Object(l.a)(Cj,"ScriptNLModuleInit",null,[]);const fl=ib=>{ib=Qh(ib,Ib=>Ib*Ib);return Math.sqrt(Wg(ib,(Ib,fc)=>Ib+fc,0))},qj=ib=>Wg(ib,(Ib,fc)=>Ib>fc?Ib:fc,ib[0]);class kn{constructor(ib){this.Bb=ib}execute(ib){if(!ib)throw Error.argumentNull("input");var Ib=[],fc=[];this.XTk(ib,Ib,fc);this.ctk(Ib,fc);const Cc={};for(let pd=0;pd<Ib.length;++pd){var Jc=Ib[pd];const ge=this.Bb.Joi.J(Jc);Jc=this.Bb.Koi.J(Jc);for(let pe=0;pe<Jc;++pe){const ke=
this.Bb.Z6.J(this.Bb.Wzh.J(ge+pe)),Qf=this.Bb.Xzh.J(ge+pe);let Hg;({value:Hg}=fi(Cc,ke)).returnValue||(Hg=0);Cc[ke]=Hg+fc[pd]*Qf}}fc=kl(Cc);fc.sort((pd,ge)=>{var pe=pd.value,ke=ge.value;(pe=-(pe>ke?1:pe<ke?-1:0))||(pe=pd.key.localeCompare(ge.key));return pe});Ib=new Qb.a(this.Bb.annotations,P.Annotations.YU);for(const pd of Fm(fc,this.Bb.h5m))fc=new N.a(this.Bb.annotations),fc.ry(this.Bb.WAk,pd.key),fc.ry(this.Bb.YAk,pd.value),Array.add(Ib.items,fc);ib.ry(this.Bb.XAk,Ib);return ib}XTk(ib,Ib,fc){if(({value:ib}=
ib.yq(this.Bb.VAk)).returnValue){let Cc;if(({value:Cc}=ib.yq(this.Bb.i0b)).returnValue){let Jc;if(!({value:Jc}=ib.yq(this.Bb.h0b)).returnValue||Cc.items.length!==Jc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.fDd(Cc,Jc,Ib,fc)}if(({value:Cc}=ib.yq(this.Bb.$Ak)).returnValue){let Jc;if(!({value:Jc}=ib.yq(this.Bb.aBk)).returnValue||Cc.items.length!==Jc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.fDd(Cc,Jc,Ib,fc)}({value:Cc}=ib.yq(this.Bb.g0b)).returnValue&&this.fDd(Cc,null,Ib,fc);({value:Cc}=ib.yq(this.Bb.ZAk)).returnValue&&this.fDd(Cc,null,Ib,fc)}}fDd(ib,Ib,fc,Cc){for(let pd=0;pd<ib.items.length;++pd){var Jc=void 0;ib.L3===P.Annotations.y9?({value:Jc}=fi(this.Bb.wQh,ib.items[pd])).returnValue||(Jc=-1):(Jc=ib.items[pd],Jc=Jc>=this.Bb.LKf&&Jc<=this.Bb.N5m?this.Bb.yOf?this.Bb.yOf.J(Jc-this.Bb.LKf)-1:Jc-this.Bb.LKf:-1);if(0<=Jc){let ge;ge=Ib?Ib.items[pd]:1;0<ge&&(Array.add(fc,Jc),Array.add(Cc,
ge))}}}ctk(ib,Ib){if(ib.length){switch(this.Bb.nEn){case 0:break;case 1:for(var fc=0;fc<Ib.length;++fc)Ib[fc]=1+Math.log(Ib[fc]);break;case 2:fc=qj(Ib);for(let Cc=0;Cc<Ib.length;++Cc)Ib[Cc]=.5+Ib[Cc]/fc*.5;break;case 3:for(fc=0;fc<Ib.length;++fc)Ib[fc]=1;break;default:throw Error.notImplemented();}if(this.Bb.nVd)for(fc=0;fc<Ib.length;++fc)Ib[fc]*=this.Bb.nVd.J(ib[fc]);ib=fl(Ib);for(fc=0;fc<Ib.length;++fc)Ib[fc]/=ib}}}Object(l.a)(kn,"TfIdfRankerNLModule",null,[1370]);class Gk{constructor(ib,Ib=0){if(!ib)throw Error.argumentNull("byteArray");
this.I1d=Ib;if(604662927!==ib.oy(this.I1d+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.fj=ib.oy(this.I1d+4,4);this.gFi=ib.oy(this.I1d+8,4);this.C2m=ib}J(ib){if(0>ib||ib>=this.count)throw Error.argumentOutOfRange("index");return this.C2m.WIn(8*this.I1d+96+ib*this.gFi,this.gFi)}get count(){return this.fj}}Object(l.a)(Gk,"CompactIntArray",null,[1369]);const xk=(ib,Ib)=>{Ib=Array(Ib);for(let pd=0;pd<Ib.length;pd++){var fc=pd,Cc=ib.W8(),Jc=1===(Cc>>31&1)?-1:
1;const ge=Cc&8388607;Cc=Cc>>23&255;256===Cc+1?Jc=ge?Number.NaN:1===Jc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Cc?(Cc-=127,Jc=Jc*Rh(ge,1)*Math.pow(2,Cc)):Jc=Jc*Rh(ge,0)*Math.pow(2,-126);Ib[fc]=Jc}return Ib},Rh=(ib,Ib)=>{let fc=0;for(let Cc=0;23>Cc;Cc++)fc+=(ib>>22-Cc&1)/Math.pow(2,Cc+1);return Ib+fc};class ln{constructor(ib,Ib){this.yOf=null;this.tLi=0;this.Koi=this.Joi=this.nVd=null;this.sLi=0;this.Xzh=this.Wzh=null;this.annotations=Ib.annotations;let fc=0;this.ZAk=ib.J(fc);++fc;this.g0b=
ib.J(fc);++fc;this.$Ak=ib.J(fc);++fc;this.aBk=ib.J(fc);++fc;this.i0b=ib.J(fc);++fc;this.h0b=ib.J(fc);++fc;this.VAk=ib.J(fc);++fc;this.XAk=ib.J(fc);++fc;this.WAk=ib.J(fc);++fc;this.YAk=ib.J(fc);++fc;var Cc=ib.J(fc);++fc;var Jc=Array(Cc);for(var pd=0;pd<Cc;++pd)Jc[pd]=Ib.uD(ib.J(fc)),++fc;this.Z6=pb.a.X9e(Jc);this.h5m=ib.J(fc);++fc;this.nEn=ib.J(fc);++fc;Cc=ib.J(fc);++fc;this.wQh={};for(Jc=0;Jc<Cc;++Jc){pd=Ib.uD(ib.J(fc));++fc;const ge=ib.J(fc);++fc;this.wQh[pd]=ge}this.LKf=ib.J(fc);++fc;this.N5m=ib.J(fc);
++fc;Cc=ib.J(fc);++fc;0<Cc&&(Cc=Ib.pgb(ib.J(fc)),++fc,this.yOf=this.T7d(new dh(Cc)));++fc;ib=Ib.pgb(ib.J(fc));this.Ytn(ib)}T7d(ib){return new Gk(ib.Dea,ib.offset)}Ytn(ib){try{const Ib=new dh(ib);this.tLi=Ib.W8();1===Ib.W8()?this.nVd=pb.a.X9e(xk(Ib,this.tLi)):this.nVd=null;const fc=Ib.W8();this.Joi=this.T7d(Ib);Ib.offset+=fc;const Cc=Ib.W8();this.Koi=this.T7d(Ib);Ib.offset+=Cc;this.sLi=Ib.W8();const Jc=Ib.W8();this.Wzh=this.T7d(Ib);Ib.offset+=Jc;this.Xzh=pb.a.X9e(xk(Ib,this.sLi))}catch(Ib){throw Error.argument("byteReader");
}}}Object(l.a)(ln,"TfIdfRankerNLModuleInit",null,[]);class Sf{constructor(ib,Ib,fc,Cc){this.pVf=ib;this.TWh=fc;this.tokens=Cc;this.Pla=Ib;this.qhc=-1;this.Tde=0}}Object(l.a)(Sf,"TokenizerData",null,[]);class Jd{constructor(ib){this.Bb=ib}execute(ib){if(!ib)throw Error.argumentNull("input");if(!({value:Cc}=ib.yq(this.Bb.BYa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Ib;({value:Ib}=ib.yq(this.Bb.B2)).returnValue||(Ib=0);let fc;({value:fc}=
ib.yq(this.Bb.M6)).returnValue||(fc=Cc.length-Ib);if(0>Ib||Ib>Cc.length)throw Error.argument("input","Start index out of range");if(0>fc||fc>Cc.length)throw Error.argument("input","Length out of range");if(Ib+fc>Cc.length)throw Error.argument("input","Bad start-length range");var Cc=new Sf(Cc,Ib,Ib+fc,new Qb.a(this.Bb.annotations,P.Annotations.YU));this.BDo(Cc);ib=ib.isReadOnly?ib.clone():ib;ib.ry(this.Bb.CMa,Cc.tokens);return ib}BDo(ib){for(;ib.Pla<ib.TWh;){if(this.Bb.Otf){var Ib=this.Bb.Otf.MEi(ib.pVf,
ib.Pla,ib.TWh-ib.Pla,null);!Ib.succeeded&&Ib.pKi&&(Ib=Ib.pKi);if(Ib.succeeded){this.lPi(ib,Ib.length,this.Bb.Ggi);ib.Pla+=Ib.length;continue}}Ib=ib.pVf.substr(ib.Pla);let fc=-1,Cc=-1,Jc=-1;for(let pd=0;pd<this.Bb.Xce.length;++pd){const ge=this.Bb.Xce[pd].exec(Ib);ge&&0<ge[1].length&&(0>fc||ge[0].length>Cc)&&(fc=pd,Cc=ge[0].length,Jc=ge[1].length)}0<=fc?(this.lPi(ib,Jc,this.Bb.G5f[fc]),ib.Pla+=Jc):ib.Pla+=1}}lPi(ib,Ib,fc){if(this.Bb.fxi)fc!==Jd.UIk&&(0>ib.qhc&&(ib.qhc=ib.Pla),ib.Tde=ib.Pla+Ib-ib.qhc,
fc===Jd.TIk&&(0<=ib.qhc&&0<ib.Tde&&(Ib=new N.a(this.Bb.annotations),Ib.ry(this.Bb.B2,ib.qhc),Ib.ry(this.Bb.M6,ib.Tde),Ib.ry(this.Bb.s0e,Jd.VIk),Ib.ry(this.Bb.BYa,ib.pVf),Array.add(ib.tokens.items,Ib)),ib.qhc=-1,ib.Tde=0));else{let Cc=new N.a(this.Bb.annotations);Cc.ry(this.Bb.B2,ib.Pla);Cc.ry(this.Bb.M6,Ib);Cc.ry(this.Bb.s0e,fc);Array.add(ib.tokens.items,Cc)}}}Jd.UIk="GAP";Jd.TIk="EOS_CHUNK";Jd.VIk="SENTENCE";Object(l.a)(Jd,"TokenizerNLModule",null,[1370]);class rn{constructor(ib,Ib){this.M6=this.B2=
this.s0e=this.CMa=this.BYa=0;this.fxi=!1;this.G5f=this.Xce=this.Ggi=this.Otf=null;if(ib){this.annotations=Ib.annotations;var fc=0;try{this.BYa=ib.J(fc);++fc;this.CMa=ib.J(fc);++fc;this.s0e=ib.J(fc);++fc;this.B2=ib.J(fc);++fc;this.M6=ib.J(fc);++fc;this.fxi=1===ib.J(fc);++fc;var Cc=ib.J(fc);++fc;0<Cc&&(this.Otf=Ib.Dpf(Cc).kul);this.Ggi=ib.J(fc)?Ib.uD(ib.J(fc)):"";++fc;const Jc=ib.J(fc);++fc;this.Xce=Array(Jc);this.G5f=Array(Jc);for(Cc=0;Cc<Jc;++Cc)this.Xce[Cc]=new RegExp(Ib.uD(ib.J(fc))),++fc,this.G5f[Cc]=
Ib.uD(ib.J(fc)),++fc}catch(Jc){throw Error.argument("initData");}}}}Object(l.a)(rn,"TokenizerNLModuleInit",null,[]);class mn{constructor(ib){this.Bb=ib}execute(ib){if(!ib)throw Error.argumentNull("input");let Ib;if(!({value:Ib}=ib.yq(this.Bb.Yrh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const fc of this.Bb.Lcg)Ib=fc.apply(Ib);ib=P.Annotations.NS(ib);ib.ry(this.Bb.Zrh,Ib);return ib}static F_e(ib,Ib){const fc=new Sys.StringBuilder;for(let Cc=
0;Cc<ib.length;++Cc)fc.append(Ib(ib.substr(Cc,1)));return fc.toString()}}Object(l.a)(mn,"TransliteratorNLModule",null,[1370]);class Al{constructor(ib){ib&&(this.style=ib.J(0))}apply(ib){return mn.F_e(ib,Ib=>Al.nNk(Ib,this.style))}static nNk(ib,Ib){switch(Ib){case 0:return ib.toLowerCase();case 1:return"I"===ib?"\u0131":ib.toLowerCase();case 2:return ib.toUpperCase();case 3:return"i"===ib?"\u0130":ib.toUpperCase();default:throw Error.invalidOperation();}}}Al.bzb=0;Object(l.a)(Al,"ChangeCaseTransliterationStage",
null,[1389]);class dg{apply(ib){return mn.F_e(ib,dg.YEo)}static YEo(ib){const Ib=ib.charCodeAt(0);return 65281<=Ib&&65374>=Ib?String.fromCharCode(Ib-65248):ib}}dg.bzb=4;Object(l.a)(dg,"LatinFullWidthToHalfWidthTransliterationStage",null,[1389]);class Gm{constructor(ib,Ib){ib&&(this.S0f=Ib.TDb(ib.J(0)),this.XXn=Ib.uD(ib.J(1)))}apply(ib){return ib.replace(this.S0f,this.XXn)}}Gm.bzb=1;Object(l.a)(Gm,"RegexReplaceTransliterationStage",null,[1389]);class gl{constructor(ib,Ib){if(ib){var fc=ib.J(0),Cc=
Ib.uD(ib.J(1)),Jc=new Gk(Ib.pgb(ib.J(2)));ib=0>ib.J(3)?null:new Gk(Ib.pgb(ib.J(3)));this.Hdg={};for(Ib=0;Ib<fc;++Ib)this.Hdg[Cc.charAt(Ib).toString()]=Cc.substr(Jc.J(Ib),ib?ib.J(Ib):1)}}apply(ib){return mn.F_e(ib,Ib=>Ib in this.Hdg?this.Hdg[Ib]:Ib)}}gl.bzb=2;Object(l.a)(gl,"SingleCharSubstitutionsTransliterationStage",null,[1389]);class Cn{constructor(ib,Ib){this.Zrh=this.Yrh=0;this.Lcg=null;if(ib){this.annotations=Ib.annotations;var fc=0;try{this.Yrh=ib.J(fc);++fc;this.Zrh=ib.J(fc);++fc;const Cc=
ib.J(fc);++fc;this.Lcg=Array(Cc);for(let Jc=0;Jc<Cc;++Jc){const pd=ib.J(fc);++fc;const ge=ib.J(fc);++fc;const pe=new pb.a;pe.cgb(ib,fc,ge);fc+=ge;this.Lcg[Jc]=this.iun(pd,pe,Ib)}}catch(Cc){throw Error.argument("initData");}}}iun(ib,Ib,fc){switch(ib){case Al.bzb:return new Al(Ib);case Gm.bzb:return new Gm(Ib,fc);case gl.bzb:return new gl(Ib,fc);case dg.bzb:return new dg;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(l.a)(Cn,"TransliteratorNLModuleInit",
null,[]);class bh{ZWl(ib,Ib){const fc=ib.J(0),Cc=new pb.a;Cc.cgb(ib,1,ib.count-1);switch(fc){case 0:return new Rg(new Cj(Cc,Ib));case 2:return new Jd(new rn(Cc,Ib));case 3:return new $k(new Qi(Cc,Ib));case 5:return new qi(new ql(Cc,Ib));case 9:return new mn(new Cn(Cc,Ib));case 10:return new kn(new ln(Cc,Ib));default:throw Error.notImplemented();}}}Object(l.a)(bh,"NLModuleFactory",null,[1346]);class Ij{constructor(ib){this.RIk=";";if(!ib)throw Error.argumentNull("resource");this.Uga=new Fk(ib,new Mb,
new bh);this.hJf=this.Uga.FWl();this.fFi=this.Uga.annotations.ZLc("Text.Text");this.dFi=this.Uga.annotations.ZLc("Classification.Predictions");this.TIf=this.Uga.annotations.ZLc("Classification.PredictionString");this.eFi=this.Uga.annotations.ZLc("Classification.Probability");this.B2m=this.Uga.annotations.ZLc("NLMod.Tokens");if(0>this.fFi||0>this.dFi||0>this.TIf||0>this.eFi)throw Error.argument("resourceObj","Resource does not represent a ranker");}QFl(){const ib=[];this.ugf(void 0,this.E0h(ib),null);
return ib}SFl(ib,Ib){const fc=[],Cc=[];this.ugf(ib,this.E0h(fc),(Jc,pd)=>{const ge=this.Uga.annotations.r0h(Jc),pe=[],ke=[];Ib&&Ib.length&&-1===Array.indexOf(Ib,ge)||(Jc=this.Uga.annotations.getAttributeType(Jc),this.LWi(Jc,pd,pe,ke),pd=new kh(ge,pe,ke),Array.add(Cc,pd))});return new Og(fc,Cc)}RFl(ib){const Ib=[];this.ugf(ib,fc=>{let Cc;if(({value:Cc}=fc.yq(this.TIf)).returnValue){let Jc;({value:Jc}=fc.yq(this.eFi)).returnValue&&Array.add(Ib,new kg(Cc,Jc))}},null);return Ib}ugf(ib,Ib,fc){var Cc=new N.a(this.Uga.annotations);
Cc.ry(this.fFi,ib);ib=this.hJf.execute(Cc);if(({value:Cc}=ib.yq(this.dFi)).returnValue)for(const Jc of Cc.items)Ib(Jc);if(fc&&({value:Ib}=ib.yq(this.B2m)).returnValue)for(const Jc of Ib.items)Jc.BLd(fc)}LWi(ib,Ib,fc,Cc){if(P.Annotations.NH(ib))for(var Jc of Ib.items)this.LWi(Ib.L3,Jc,fc,Cc);else if(P.Annotations.Owj(ib)){Jc=this.Uga.annotations.k9h(ib);for(let pd=0;pd<Jc;pd++)Array.add(fc,this.Uga.annotations.Tci(ib,pd)),Array.add(Cc,this.Uga.annotations.Vca(this.Uga.annotations.cEb(ib,pd),Ib.Fgb(pd)))}else Array.add(fc,
"VALUE"),Array.add(Cc,this.Uga.annotations.Vca(ib,Ib))}E0h(ib){return Ib=>{let fc;({value:fc}=Ib.yq(this.TIf)).returnValue&&Array.add(ib,this.T0l(fc))}}T0l(ib){const Ib=ib.indexOf(this.RIk);return 0>Ib?ib:ib.substring(0,Ib)}}Object(l.a)(Ij,"Ranker",null,[]);var Bd=c(1522),Fe=c(1534),nn=c(2);class no{constructor(ib,Ib){this.p0g="";this.QMe=null;this.RMe=!1;this.Iqa=null;this.WPj=["TellMe.TellMeParamCollection"];this.kc=ib;this.xWa=Ib;this.kc.yyb&&(this.Iqa=null)}get C$d(){if(!this.QMe&&!this.RMe){let ib=
null;try{ib=window.TellMeModel}catch(Ib){if(u.TellMeActor.instance.Ne)u.TellMeActor.instance.Ne.onError("QueryRanker","TellMeModel not found. Exception: "+Ib)}if(ib){try{this.QMe=new Ij(ib)}catch(Ib){if(u.TellMeActor.instance.Ne)u.TellMeActor.instance.Ne.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Ib)}this.RMe=!0}else if(u.TellMeActor.instance.Ne)u.TellMeActor.instance.Ne.onError("QueryRanker","Classifier model not found")}return this.QMe}BK(){return"Command"}KT(){return 0===
this.kc.Ru?0:1===this.kc.Ru?1:2}xH(ib,Ib,fc=!1,Cc=e.a.tellMe,Jc=null){const pd=new m.a(ib);if((!Jc||Array.contains(Jc,0))&&!z.a.FQ(ib)){if(!this.C$d&&this.RMe){if(u.TellMeActor.instance.Ne)u.TellMeActor.instance.Ne.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.kc.yyb&&this.Iqa&&this.Iqa.initialize();if(Bd.CommandResultsUtility.Azf(ib.Eg)&&(Jc=Bd.CommandResultsUtility.j2h(ib.Eg),0<Jc.results.length)){Jc.displayName=
"Classifier Debug";pd.Lu(Jc);Ib.resultsUpdated(pd);return}Jc=ib?this.p0g=ib.Eg:this.p0g;if(nn.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Jc=this.V0l(Jc);var ge=this.OMd(Jc.Iqf());Jc=Jc.S_h()}else Jc=this.U0l(Jc),ge=this.UIl(Jc),Jc=[];Bd.CommandResultsUtility.S0d(ge,!1,"Classifier","TFIDF");ge=Bd.CommandResultsUtility.jOc(ib,ge,this.kc,this.Iqa,this.xWa,Jc,0,1);0<ge.results.length&&Cc!==e.a.contextMenu&&(ge.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);fc||ge.results.length||
this.kc.m_||this.kc.g6a||(ib=new x.a("lookupNoResults",14,ib.Eg,null,1),ge.ww(ib));0<ge.results.length&&pd.Lu(ge);pd.attributes=Jc}Ib.resultsUpdated(pd)}Iqf(){let ib=[];try{ib=this.C$d.QFl()}catch(Ib){if(u.TellMeActor.instance.Ne)u.TellMeActor.instance.Ne.onError("GetPredictions","Exception: "+Ib)}return ib}U0l(ib){let Ib=[];try{Ib=this.C$d.RFl(ib)}catch(fc){if(u.TellMeActor.instance.Ne)u.TellMeActor.instance.Ne.onError("GetPredictionsWithScore","Exception: "+fc)}return Ib}V0l(ib){try{return this.C$d.SFl(ib,
this.WPj)}catch(Ib){if(u.TellMeActor.instance.Ne)u.TellMeActor.instance.Ne.onError("GetPredictionsWithTokenAttributes","Exception: "+Ib)}return new Og([],[])}OMd(ib){const Ib=[];if(ib)for(const fc of ib)Ib.push(new Fe.a(fc,-99999));return Ib}UIl(ib){const Ib=[];if(ib)for(const fc of ib)Ib.push(new Fe.a(fc.prediction,fc.score));return Ib}}Object(l.a)(no,"CommandResultsProvider",null,[1258]);var Zd=c(1718);class nd{constructor(ib){this.kc=ib}BK(){return"Feedback"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?
1:2}xH(ib,Ib,fc,Cc,Jc=null){ib=new m.a(ib);if(!Jc||Array.contains(Jc,21))Jc=[],Jc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Jc),Jc=new y.a(22),Jc.displayName="",Jc.ww(new x.a("TellMeFeedback",23,null,null,1)),ib.Lu(Jc);Ib.resultsUpdated(ib)}}Object(l.a)(nd,"FeedbackResultsProvider",null,[1258]);class Hm{constructor(ib,Ib,fc,Cc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=ib;this.CommandId=
Ib;this.CommandValueId=fc;this.InputText=Cc}}Object(l.a)(Hm,"FindInDocumentProp",null,[]);var cf=c(16);class Of{constructor(ib){this.JHe=2;this.wub=[];this.Bab=[];this.kc=ib;Of.tDa=ib.Phf;Of.kWh="FindInDocumentSuggestion";Of.ZVi="FindInDocumentSuggestion3";this.zGe=Object.assign(new v.a,{landingTab:"Indoc",data:null});this.$bk=this.kc.Nnb||!!nn.AFrameworkApplication.ta&&nn.AFrameworkApplication.ta.Ob.Nnb}BK(){return"FindInDocument"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:3===this.kc.Ru?this.kc.hnj?
2:3:2}xH(ib,Ib,fc=!1,Cc,Jc=null){const pd=new m.a(ib);if(Jc&&!Array.contains(Jc,2))Ib.resultsUpdated(pd);else if(Array.clear(this.wub),z.a.FQ(ib)){if(fc&&this.ykj()){fc=new y.a(2);fc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Jc=1;Cc="";if(0<this.Bab.length&&!this.kc.mic)for(var ge of this.Bab)if(""!==ge.Label.toLowerCase()){if(Jc>=this.JHe)break;this.GAj(fc,ge.Label,ge.CommandValueId,Of.kWh+Jc,ge.InputText);Jc++}ge="";this.kc.QO?(pd.Lu(fc),fc=new y.a(3),ge=this.kc.Zcb?z.a.ogb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):ge=CommonUIStrings.l_TellMeOpenFindPaneText;Cc=this.i2h("");this.GAj(fc,ge,Cc,Of.ZVi,"");pd.Lu(fc)}Ib.resultsUpdated(pd)}else ge="",fc&&(fc=this.i2h(ib.Eg),Cc=[],this.kc.H2a?(this.kc.rge&&Cc.push(appChrome.actions.setControlIconSet(Of.tDa,{"default":"FindInDocument_20"})),ge=this.kc.SDf?z.a.Ynf(ib.Eg,CommonUIStrings.l_FindInDocumentScopedButtonText):ib.Eg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.kc.QO?(ge=this.kc.Zcb?z.a.ogb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
ib.Eg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,ib.Eg),Cc.push(appChrome.actions.setControlIconSet(Of.tDa,{"default":"FindInDocument_20"}))):ge=this.kc.mic?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,ib.Eg),this.kc.wva?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Of.tDa,ge)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Of.tDa,fc))):(Cc.push(appChrome.actions.setControlLabel(Of.tDa,
ge)),Cc.push(appChrome.actions.setButtonCommandValueId(Of.tDa,fc)),appChrome.api.dispatch(Cc)),this.Qfj(ge,Of.tDa,fc,ib.Eg)),this.kc.hnj?(ge=new x.a(Of.tDa,8,ib.Eg),fc=new y.a(2),fc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,fc.ww(ge),pd.Lu(fc),Ib.resultsUpdated(pd)):this.kc.MNd(ib.Eg).then(pe=>{const ke=new x.a(Of.tDa,8,ib.Eg,null,1);ke.count=pe;pe=new y.a(2);pe.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;pe.ww(ke);pd.Lu(pe);Ib.resultsUpdated(pd)},pe=>{u.TellMeActor.instance.Ne.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+pe);pe=new x.a(Of.tDa,8,ib.Eg,null,1);const ke=new y.a(2);ke.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;ke.ww(pe);pd.Lu(ke);Ib.resultsUpdated(pd)})}ykj(){return!!this.kc&&this.kc.kge}GAj(ib,Ib,fc,Cc,Jc=null){const pd=[];Ib&&pd.push(appChrome.actions.setControlLabel(Cc,Ib));this.kc.QO&&pd.push(appChrome.actions.setControlIconSet(Cc,{"default":"FindInDocument_20"}));pd.push(appChrome.actions.setButtonCommandValueId(Cc,fc));appChrome.api.dispatch(pd);
this.Qfj(Ib,Cc,fc,"");ib.ww(new x.a(Cc,8,Jc,null,1,-99999))}i2h(ib){return this.$bk?z.a.mNa(ib,15,this.zGe):cf.a.Af(ib)}Qfj(ib,Ib,fc,Cc){this.ykj()&&this.wub.length<this.JHe&&(ib=new Hm(ib,Ib,fc,Cc),Array.add(this.wub,ib))}qdo(ib){for(let Ib=0;Ib<this.wub.length;Ib++)if(this.wub[Ib].CommandId===ib){const fc=this.wub[Ib].Label;let Cc=!1;if(0<this.Bab.length){let Jc=0;for(const pd of this.Bab){if(pd.Label===fc){Array.removeAt(this.Bab,Jc);Cc=!0;break}Jc++}}!Cc&&this.Bab.length>=this.JHe-1&&Array.removeAt(this.Bab,
1);Array.insert(this.Bab,0,this.wub[Ib])}}}Of.tDa=null;Of.kWh=null;Of.ZVi=null;Object(l.a)(Of,"FindInDocumentResultsProvider",null,[1258]);var xm=c(1716);class ze{constructor(ib){this.kc=ib}BK(){return"Insights"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:2}xH(ib,Ib,fc=!1,Cc,Jc=null){Cc=new m.a(ib);if(!Jc||Array.contains(Jc,13))if(this.vmo()||!z.a.FQ(ib)){Jc=new y.a(13);var pd=""===ib.Eg.trim(),ge=pd?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",pe=new x.a(ge,10,ib.Eg,null,1);fc&&(fc=
null,z.a.Dga()?pd?pd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(pd=this.kc.mic?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,ib.Eg),fc=z.a.mNa(ib.Eg,1)):(pd=String.format(CommonUIStrings.l_InsightsButtonText,ib.Eg),fc=z.a.uAb(ib.Eg)),this.kc.wva?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ge,pd)),fc&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
fc))):(ib=[],ib.push(appChrome.actions.setControlLabel(ge,pd)),fc&&ib.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",fc)),appChrome.api.dispatch(ib)),pe.label=pd);Jc.ww(pe);Cc.Lu(Jc)}Ib.resultsUpdated(Cc)}vmo(){return z.a.Dga()&&this.kc.HAo&&!this.kc.qfa}}Object(l.a)(ze,"InsightsResultsProvider",null,[1258]);var Bf=c(1714);class ch{constructor(ib){this.kc=ib}BK(){return"Learning"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:2}xH(ib,Ib,fc,Cc,Jc=null){fc=new m.a(ib);Jc&&!Array.contains(Jc,
21)||!z.a.FQ(ib)||(Jc=[],Cc=this.kc.PQm,Jc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Cc)),Cc=ch.iQl(Cc),Jc.push(appChrome.actions.setControlLabel("LearningForSearch",Cc)),appChrome.api.dispatch(Jc),ib=new x.a("LearningForSearch",22,ib.Eg,null,1),Jc=new y.a(21),Jc.ww(ib),fc.Lu(Jc));Ib.resultsUpdated(fc)}static iQl(ib){const Ib=[];Array.add(Ib,new Bf.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Ib,new Bf.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Ib,new Bf.a(600,ib));Array.add(Ib,new Bf.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));ib={};ib.parts=Ib;return JSON.stringify(ib)}}Object(l.a)(ch,"LearningProvider",null,[1258]);var bj=c(485);class Ag{constructor(ib,Ib){this.mVb=this.mZb=this.dbb=this.Dnd=null;this.Yw=!1;this.YVb=ib;this.kUj=Ib;ib&&this.uUh(ib)}Uke(){this.YVb.Uke()&&this.uUh(this.YVb)}getSuggestions(ib){let Ib=[];var fc=[];ib=Ag.abn(ib);var Cc="";Array.clear(fc);for(let Jc=0;Jc<ib.length;Jc++){const pd=ib.charAt(Jc);
-1!==" ".indexOf(pd)?(Cc.length&&Array.add(fc,Cc),Cc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(pd)?(Cc.length&&Array.add(fc,Cc),Cc=pd,Array.add(fc,Cc),Cc=""):Cc+=pd}Cc.length&&Array.add(fc,Cc);for(ib=0;ib<fc.length;ib++)Cc=this.TIl(fc[ib]),Cc=this.I_k(Cc),Ib=Ag.M6m(Ib,Cc);return Ib=this.knk(Ib)}aCf(){this.Yw||this.Uke();return this.Yw}wGd(ib){return this.Dnd[ib.toString()]}knk(ib){for(let Ib=0;Ib<ib.length;Ib++){const fc=this.dbb[Ib];if(ib[Ib].commandId!==this.wGd(fc[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Cc;(Cc=ib[Ib]).score=Cc.score+fc[1]}return ib}I_k(ib){const Ib=[];for(var fc=0;fc<this.dbb.length;fc++)Ib.push(new Fe.a(this.wGd(this.dbb[fc][0]),-5));fc=new bj.a;for(var Cc=0;Cc<ib.length;Cc++)fc.add(this.wGd(ib[Cc][0]));for(Cc=0;Cc<Ib.length;Cc++){const pd=Ib[Cc];for(let ge=0;ge<ib.length;ge++){var Jc=ib[ge];const pe=this.wGd(Jc[0]);Jc=Jc[1];if(pe===pd.commandId){pd.score=Jc;fc.remove(pe);break}}if(!fc.count)break}return Ib}TIl(ib){const Ib=1>ib.length;for(let ge=0;2>=ge;ge++){const pe=this.mVb;
for(let ke in pe){var fc=pe[ke],Cc=ib,Jc=ke;const Qf=Jc.length+1,Hg=Array((Cc.length+1)*Qf);for(var pd=0;pd<=Cc.length;pd++)Hg[pd*Qf]=pd;for(pd=0;pd<=Jc.length;pd++)Hg[pd]=pd;for(pd=0;pd<Jc.length;pd++)for(let gc=0;gc<Cc.length;gc++)Hg[(gc+1)*Qf+(pd+1)]=Cc.charAt(gc)===Jc.charAt(pd)?Hg[gc*Qf+pd]:Math.min(Math.min(Hg[gc*Qf+(pd+1)]+1,Hg[(gc+1)*Qf+pd]+1),Hg[gc*Qf+pd]+1);Cc=Hg[Cc.length*Qf+Jc.length];if((!Cc||!Ib)&&Cc<=ge)return fc}}return this.mZb}uUh(ib){this.Dnd=ib.Cpf();this.dbb=ib.D1l();this.mZb=
ib.v$l();this.mVb=ib.JTl();if(this.Yw=!!this.Dnd&&!!this.dbb&&!!this.mVb&&!!this.mZb)this.Yw=0<this.dbb.length&&Ag.hzf(this.dbb);this.Yw&&(this.Yw=0<this.mZb.length&&Ag.hzf(this.mZb));this.Yw&&(this.mVb=Ag.lam(this.mVb));this.Yw||(this.mVb=this.mZb=this.dbb=this.Dnd=null)}B9l(ib){ib=this.getSuggestions(ib);return this.Utl(ib,this.kUj)}Utl(ib,Ib){let fc=[];for(let Cc=0;Cc<ib.length;Cc++)ib[Cc].score>=Ib&&fc.push(ib[Cc]);fc.sort((Cc,Jc)=>Cc.score<Jc.score?1:Cc.score>Jc.score?-1:0);0<fc.length-10&&(fc=
fc.slice(0,10));return fc}static M6m(ib,Ib){if(!ib.length)return Ib;if(ib.length!==Ib.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let fc=0;fc<ib.length;fc++){if(ib[fc].commandId!==Ib[fc].commandId)throw Error.create("Incorrect CommandId");let Cc;(Cc=ib[fc]).score=Cc.score+Ib[fc].score}return ib}static abn(ib){return cf.a.fh(ib)}static hzf(ib){for(let Ib=0;Ib<ib.length;Ib++)if(2!==ib[Ib].length)return!1;return!0}static lam(ib){const Ib=
{};for(let Jc in ib){var fc=Jc,Cc=ib[Jc];const pd=Cc;pd.length&&Ag.hzf(pd)&&(Ib[fc]=Cc)}return Ib}}Object(l.a)(Ag,"NaiveBayesClassifierModel",null,[]);class Uf{constructor(ib,Ib){this.Iqa=null;this.kc=ib;this.fwc=new Ag(Ib,ib.$Wl);this.kc.yyb&&(this.Iqa=null)}BK(){return"NBCommand"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:2}xH(ib,Ib,fc=!1,Cc=e.a.tellMe,Jc=null){const pd=new m.a(ib);if((!Jc||Array.contains(Jc,0))&&!z.a.FQ(ib)){if(Bd.CommandResultsUtility.Azf(ib.Eg)&&(Jc=Bd.CommandResultsUtility.j2h(ib.Eg),
0<Jc.results.length)){Jc.displayName="Classifier Debug";pd.Lu(Jc);Ib.resultsUpdated(pd);return}if(!this.fwc.aCf()){if(u.TellMeActor.instance.Ne)u.TellMeActor.instance.Ne.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.kc.yyb&&this.Iqa&&this.Iqa.initialize();Jc=this.fwc.B9l(ib.Eg);Bd.CommandResultsUtility.S0d(Jc,!1,"Classifier","NaiveBayesian");Jc=Bd.CommandResultsUtility.jOc(ib,Jc,this.kc,this.Iqa,
null,null,0,1);0<Jc.results.length&&Cc!==e.a.contextMenu&&(Jc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);fc||Jc.results.length||this.kc.m_||this.kc.g6a||(ib=new x.a("lookupNoResults",14,ib.Eg,null,1),Jc.ww(ib));0<Jc.results.length&&pd.Lu(Jc)}Ib.resultsUpdated(pd)}}Object(l.a)(Uf,"NaiveBayesCommandProvider",null,[1258]);class Hl{constructor(){this.tub=null;this.Yw=!1;this.Uke()}Uke(){this.Yw||(this.tub=window.NBCRM)&&4===this.tub.length&&(this.Yw=!0);return this.Yw}D1l(){return this.Yw?
this.tub[1]:null}v$l(){return this.Yw?this.tub[2]:null}JTl(){return this.Yw?this.tub[3][0]:null}Cpf(){return this.Yw?this.tub[0][0]:null}}Object(l.a)(Hl,"NaiveBayesModelAdapter",null,[1279]);var th=c(186);class Ym{constructor(ib){this.kc=ib}BK(){return"OfficeScript"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:2}xH(ib,Ib){const fc=new m.a(ib);if(!z.a.FQ(ib)){ib=th.d(ib.Eg);var Cc=new y.a(28);Cc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Cc=this.rlh(ib,Ym.vJo,"OfficeScriptsUnhideAllRowsCols",
"samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Cc);Cc=this.rlh(ib,Ym.XAl,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Cc);fc.Lu(Cc)}Ib.resultsUpdated(fc)}rlh(ib,Ib,fc,Cc,Jc,pd){const ge=[];for(const pe of Ib)if(th.a(ib,pe)){this.kc.wva?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(fc,Jc)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(fc,Cc))):(ge.push(appChrome.actions.setControlLabel(fc,
Jc)),ge.push(appChrome.actions.setButtonCommandValueId(fc,Cc)),appChrome.api.dispatch(ge));pd.ww(new x.a(fc,28,null,null,1));break}return pd}}Ym.vJo="unhide row rows col cols column columns".split(" ");Ym.XAl=["freeze","selection","pane","panes"];Object(l.a)(Ym,"OfficeScriptsSamplesProvider",null,[1258]);var Nm=c(76),Dn=c(289),Sn=c(1550),Kl=c(1513),Tm=c(1549),rg=c(34),ri=c(118),Cf=c(27);class ne{constructor(ib){this.uP=null;this.n1=-1;this.XJf=14;this.ZJf=12;this.attributes=this.dUe=this.query=null;
this.dac=!1;this.mXb=[];this.Of=nn.AFrameworkApplication.Ke;nn.AFrameworkApplication.K&&(this.XJf=nn.AFrameworkApplication.K.pc("TellMeMaxTermedResults",this.XJf),this.ZJf=nn.AFrameworkApplication.K.pc("TellMeMaxZeroTermResults",this.ZJf));this.mU=ib}get ho(){return this.mXb}get yle(){return this.dUe}Lu(ib){let Ib=!1;for(let fc=0;fc<this.ho.length;fc++)if(30!==this.ho[fc].groupType&&this.ho[fc].groupType===ib.groupType){this.wXe(this.ho[fc],ib);Ib=!0;break}Ib||this.ho.push(ib)}wXe(ib,Ib){for(let fc=
0;fc<Ib.results.length;fc++)ib.ww(Ib.results[fc])}Y4i(ib){const Ib=[];for(const fc of this.ho)fc.groupType!==ib&&Ib.push(fc);this.ho.length!==Ib.length&&(this.mXb=Ib)}vTn(ib){let Ib=null,fc=null,Cc=null;for(let Jc=0;Jc<ib.length;Jc++){const pd=ib[Jc];if(pd&&pd.ho&&pd.ho.length)for(const ge of pd.ho)if(17===ge.groupType||18===ge.groupType)Ib=ge;else if(0===ge.groupType||16===ge.groupType)fc=ge,Cc=pd}Ib&&fc&&0<fc.results.length&&(17===Ib.groupType&&({UWe:fc,JXe:Ib}=Bd.CommandResultsUtility.Nlk(fc,Ib,
this.mU.bO()?this.mU.bO().oIl:-.6)),Cc.Y4i(fc.groupType))}rso(){new Nm.a;this.p7c(this.mU.LFi)}wUc(ib,Ib){return this.query.Eg.length>this.mU.bO().l2l&&this.THm(ib,Ib)||this.query.Eg.length>this.mU.bO().m2l&&this.DKm(ib,Ib)?!0:!1}DKm(ib,Ib){return ib&&ib.length&&Ib&&Ib.length?-1===Ib.toLowerCase().indexOf(ib.toLowerCase())?!1:!0:!1}THm(ib,Ib){return ib&&ib.length&&Ib&&Ib.length?Ib.toLowerCase().startsWith(ib.toLowerCase()):!1}hul(ib){const Ib=[];for(const fc of this.mU.bO().QO?this.yle:this.ho)ib.contains(fc.groupType)||
Ib.push(fc);this.mU.bO().QO?this.dUe=Ib:this.mXb=Ib}FQo(ib,Ib){const fc=[];for(const Cc of this.ho){const Jc=Cc;if(13!==Jc.groupType||24!==Jc.groupType){const pd=ib[Kl.a[Jc.groupType].toLowerCase()];let ge="False";pd<Ib&&(ge="True");Jc.displayName=Jc.displayName+" ("+ge+": "+pd+")"}fc.push(Jc)}this.mXb=fc}p7c(ib,Ib=!1,fc=null){if(this.mU.bO().QO){if(!Ib)for(this.dUe=Array(this.ho.length),Ib=0;Ib<this.ho.length;Ib++)this.yle[Ib]=this.ho[Ib];this.mU.QFi.p7c(this.ho,this.yle,this.query,ib,fc)}else{for(fc=
new Nm.a;this.ho.length;){Ib=this.ho.pop();const Cc=Kl.a[Ib.groupType].toLowerCase(),Jc=ib[Cc];if(Cf.c(Jc))throw Error.create("GroupId "+Cc+" missed from group SortingOrder");fc.add(new Dn.a(Jc,Ib))}fc.Sc((Cc,Jc)=>Cc.key<Jc.key?-1:1);for(ib=0;ib<fc.count;ib++)Ib=fc.J(ib).value,this.ho.push(Ib)}}sso(){var ib=!1;let Ib=!1,fc=!1;for(let Jc=0;Jc<this.ho.length;Jc++){var Cc=this.ho[Jc];const pd=Cc.groupType;if(8===pd||15===pd||14===pd){Cc=Cc.results;for(let ge=0;ge<Cc.length;ge++){if(8===pd&&this.wUc(this.query.Eg,
Cc[ge].label)){ib=!0;break}if(15===pd&&this.wUc(this.query.Eg,Cc[ge].label)){Ib=!0;break}if(14===pd){if(this.wUc(this.query.Eg,Cc[ge].label)||this.wUc(this.query.Eg,Cc[ge].description)){fc=!0;break}const pe=Cc[ge].label.split(" ");for(const ke of pe)if(this.wUc(this.query.Eg,ke)){fc=!0;break}}}}}ib=this.mU.Z3l(ib,Ib,fc);this.p7c(ib)}NJb(ib,Ib,fc,Cc,Jc,pd){if(Jc===this.uP){var ge=ib.data.we;Jc=null;try{Jc=rg.b(ge)}catch(Jj){u.TellMeActor.instance.Ne.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+
Jj);return}if("RankerResults"in Jc&&Jc.RankerResults){this.lCa();var pe=Jc.RankerResults,ke=new Nm.a,Qf=new Nm.a;ge=0;for(var Hg of pe){pe=Hg.ProviderId;var gc=Hg.Score;ge+=gc;ke.add(new Dn.a(pe,gc))}ke.Sc((gj,eh)=>gj.value>eh.value?-1:1);gc=pd?pd.gci:1E-6;Hg={};pe={};let Jj=0;for(var nh=0;nh<ke.count;nh++){let gj=parseInt(ke.J(nh).key),eh=ke.J(nh).value/ge;1===gj&&(pe.answer=Jj++,pe.entity=Jj++,pe.definition=Jj++,pe.wolframanswer=Jj++,eh<gc&&(Qf.add(9),Qf.add(11),Qf.add(10),Qf.add(12)),Hg.answer=
eh,Hg.entity=eh,Hg.definition=eh,Hg.wolframanswer=eh);2===gj&&(pe.assistance=Jj++,eh<gc&&Qf.add(8),Hg.assistance=eh);3===gj&&(pe.classifier=Jj++,pe.serviceclassifier=Jj++,eh<gc&&(Qf.add(0),Qf.add(17)),Hg.classifier=eh,Hg.serviceclassifier=eh);4===gj&&(pe.people=Jj++,eh<gc&&Qf.add(14),Hg.people=eh);5===gj&&(pe.document=Jj++,eh<gc&&Qf.add(15),Hg.document=eh);6===gj&&(pe.findindocument=Jj++,eh<gc&&Qf.add(2),Hg.findindocument=eh);7===gj&&(pe.notes=Jj++,eh<gc&&Qf.add(20),Hg.notes=eh);8===gj&&(pe.image=
Jj++,eh<gc&&Qf.add(19),Hg.image=eh)}ke=new Nm.a;ke.add("classifier");ke.add("serviceclassifier");ke.add("appsforoffice");ke.add("addin");ke.add("findindocument");ke.add("assistance");ke.add("document");ke.add("people");ke.add("answer");ke.add("wolframanswer");ke.add("definition");ke.add("entity");ke.add("image");ke.add("template");ke.add("officescript");for(nh=0;nh<ke.count;nh++)ke.J(nh)in pe||(pe[ke.J(nh)]=Jj++);pe.learning=Jj++;pe.insights=Jj++;pe.actionai=Jj++;pe.actionaicommand=Jj++;pe.feedback=
Jj++;pd&&pd.Qui&&this.FQo(Hg,gc);pd&&pd.Rui&&this.hul(Qf);Qf={};for(var Yd in Hg)Qf[Yd]=Hg[Yd]*ge;this.p7c(pe,!0,Qf)}if(pd.JYd&&"Intents"in Jc&&Jc.Intents){Yd=Jc.Intents;for(var Nk of Yd)if(this.DEf(Nk)&&"Serplet"===Nk.GroupType&&Nk.ConfidenceScore>Nk.ConfidenceThreshold){Yd=!1;Jc=0;if(pd.KYd){ge=new x.a("",32);for(Qf=0;Qf<this.ho.length;Qf++)if((ke=this.ho[Qf].results)&&0<ke.length){Jc=Qf;ge=ke[0];break}2===ge.groupType&&(Yd=!0)}ge=new y.a(13);Yd&&pd.KYd&&(ge=new y.a(13,CommonUIStrings.l_TellMeWebTitle));
Qf=new x.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Eg,null,0);ke=[];Hg=null;Hg=z.a.Dga()?z.a.mNa(this.query.Eg,1):z.a.uAb(this.query.Eg);ke.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Hg));Hg=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Eg);ke.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Hg));appChrome.api.dispatch(ke);ge.ww(Qf);Qf=[];if(Yd&&pd.KYd)for(Qf.push(this.ho[Jc]),Qf.push(ge),
Yd=Jc+1;Yd<this.ho.length;Yd++)(Jc=this.ho[Yd].results)&&0<Jc.length&&Qf.push(this.ho[Yd]);else for(Qf.push(ge),Yd=0;Yd<this.ho.length;Yd++)(Jc=this.ho[Yd].results)&&0<Jc.length&&Qf.push(this.ho[Yd]);this.mXb=Qf}}if(pd.IUc&&!pd.QO){Nk=Yd=-1;for(Jc=0;Jc<this.ho.length;Jc++)switch(this.ho[Jc].groupType){case 23:Yd=Jc;break;case 0:case 17:case 2:-1===Nk&&(Nk=Jc)}if(-1!==Yd){Nk=-1===Nk?0:Yd>Nk?Nk+1:Nk;Yd=this.ho[Yd];Jc=Array(this.ho.length);ge=0;for(Qf=0;Qf<Jc.length;Qf++)Qf===Nk?Jc[Qf]=Yd:(23===this.ho[ge].groupType&&
ge++,Jc[Qf]=this.ho[ge],ge++);this.mXb=Jc}}Cc.resultsUpdated(this);Cc=u.TellMeActor.instance.Ne;Cc.R_(Ib.length,"RankerInference",ib.data.Ve.toString(),Math.round(window.performance.now()-fc),Tm.a.Srj,!0,Sn.a.XOa);this.dac&&Cc&&(ib=this.query.imb,Ib=Cc.rfd,pd.$Yd&&ib>Ib&&!pd.QO&&(Cc.oIf(this.query.Eg),Cc.g8f(ib)))}}DEf(ib){if("GroupType"in ib&&ib.GroupType&&"ConfidenceScore"in ib&&"ConfidenceThreshold"in ib)return!0;u.TellMeActor.instance.Ne.onError("IsValidIntentGroup","Invalid intents found");return!1}yJb(ib,
Ib,fc,Cc,Jc){Cc===this.uP&&(this.lCa(),u.TellMeActor.instance.Ne.R_(Ib.length,"RankerInference",ib.data.Ve.toString(),Math.round(window.performance.now()-fc),Tm.a.Srj,!1,Sn.a.XOa));Jc.resultsUpdated(this)}lCa(){-1!==this.n1&&(window.clearTimeout(this.n1),this.n1=-1)}tso(ib){let Ib;Ib=this.mU.bO().QO?u.TellMeActor.instance.Ne.Yrf(this.yle,this.query.Eg):u.TellMeActor.instance.Ne.Yrf(this.ho,this.query.Eg);var fc=this.mU.bO().fci;""!==fc&&(fc="_"+fc);let Cc="";this.mU.bO().RXd&&(Cc="RankerInference"+
fc+",");this.mU.bO().JYd&&(Cc+="SerpletClassifier");","===Cc.charAt(Cc.length-1)&&(Cc=Cc.substring(0,Cc.length-1));fc=u.TellMeActor.instance.Ne.Sdi(Cc);const Jc=this.uP=ri.a.create().toString();fc["Client-Request-Id"]=Jc;const pd=window.performance.now(),ge=this.mU.bO()?this.mU.bO().hci:600;this.lCa();this.n1=window.setTimeout(()=>{if(Jc===this.uP){this.uP="";this.n1=-1;ib.resultsUpdated(this);const pe={};pe[a.a.provider]="Ranker";pe[a.a.cLb]=this.query.imb;u.TellMeActor.instance.Ne.pA(k.a.timedOut,
ge,pe)}},ge);this.Of.oj(u.TellMeActor.instance.Ne.Tdi(),2,Ib,fc,!1,0,pe=>{this.NJb(pe,this.query.Eg,pd,ib,Jc,this.mU.bO())},pe=>{this.yJb(pe,this.query.Eg,pd,Jc,ib)},null,null,!1,4E3,6E3)}ZFo(){var ib=0,Ib=new Nm.a,fc=this.mU.JFi,Cc=this.mU.KFi;for(var Jc=0;Jc<this.ho.length;Jc++){var pd=this.ho[Jc],ge=Kl.a[pd.groupType].toLowerCase(),pe=fc[ge];ib+=pd.results.length;pd.results.length>pe&&(ge=Cc[ge],Cf.c(ge)||Ib.add(new Dn.a(ge,pd)))}Cc=!this.query||""===this.query.Eg.trim();Jc=ib-(Cc?this.ZJf:this.XJf);
if(!(0>=Jc)){Cc=window.performance.now();ib=ib.toString()+" total,"+Jc.toString()+" to remove.";if(0<Ib.count)for(Ib.Sc((ke,Qf)=>ke.key>Qf.key?-1:1),pd=0;pd<Ib.count&&0<Jc;pd++){ge=Ib.J(pd).value;pe=Kl.a[ge.groupType].toLowerCase();let ke=ge.results.length-fc[pe];ke>Jc&&(ke=Jc);0<ke&&(ge.r2f(ke),ib+=pe+": "+ke.toString()+" results removed.",Jc-=ke)}if(0<Jc){ib+=Jc.toString()+" results left after trimming.";Ib=new Nm.a;fc=this.mU.OFi;for(pd=0;pd<this.ho.length;pd++)ge=this.ho[pd],pe=fc[Kl.a[ge.groupType].toLowerCase()],
Cf.c(pe)||Ib.add(new Dn.a(pe,ge));Ib.Sc((ke,Qf)=>ke.key<Qf.key?-1:1);for(fc=0;0<Jc;)pd=Ib.J(fc++).value,Jc>=pd.results.length?(Array.remove(this.ho,pd),ib+=Kl.a[pd.groupType]+": "+pd.results.length.toString()+" results force removed.",Jc-=pd.results.length):(pd.r2f(Jc),ib+=Kl.a[pd.groupType]+": "+Jc.toString()+" results force removed.",Jc=0)}u.TellMeActor.instance.Ne&&(Ib={},Ib[a.a.message]=ib,u.TellMeActor.instance.Ne.pA("ShowOptimal",window.performance.now()-Cc,Ib))}}}Object(l.a)(ne,"CombineResultsUpdatedEventArgs",
null,[1229]);var Fd=c(1618);class zj{constructor(ib,Ib,fc,Cc=!1,Jc=""){this.sLe=this.VNe=!1;this.ev=ib;this.bwb=[];this.a9g=Ib.length;this.kc=u.TellMeActor.instance.bO();this.Cld=Cc;this.gea=Jc;this.FYb={};for(ib=0;ib<Ib.length;++ib)this.FYb[ib.toString()]=fc?0:Ib[ib].KT()}gfo(ib,Ib){Ib&&Ib.query&&Ib.query.imb<u.TellMeActor.instance.psa||(this.bwb[ib]=Ib,this.sLe?this.VNe=!0:(!this.kc||3!==this.kc.Ru||3!==this.FYb[ib.toString()]||this.SNh())&&this.wVd())}Wun(){this.sLe=!0}QJo(){this.sLe=!1;this.VNe&&
(this.VNe=!1,this.wVd())}SNh(){if(this.bwb.length<this.a9g)return!1;for(let ib=0;ib<this.a9g;++ib)if(!this.bwb[ib])return!1;return!0}wVd(){var ib=this.SNh();const Ib=window.performance.now(),fc=new ne(u.TellMeActor.instance.UTg);fc.vTn(this.bwb);for(var Cc=0;Cc<this.bwb.length;++Cc){var Jc=this.bwb[Cc];if(Jc&&Jc.ho&&Jc.ho.length&&(fc.query=Jc.query,Jc.attributes&&0<Jc.attributes.length&&(fc.attributes=Jc.attributes),Jc&&Jc.ho&&(ib||this.APk(Cc,this.bwb))))for(const pd of Jc.ho)fc.Lu(pd)}fc.ho&&fc.ho.length&&
(fc.dac=ib,this.kc&&this.kc.Cke&&fc.ZFo(),Fd.a.uxi()&&(this.kc&&this.kc.hJm&&fc.query.Eg&&0<fc.query.Eg.length?fc.sso():fc.rso()),Fd.a.uxi()&&this.kc&&(this.kc.RXd||this.kc.JYd)&&this.Cld&&fc.query.Eg&&0<fc.query.Eg.length&&fc.dac&&this.gea!==e.a.contextMenu?(3===this.kc.Ru&&ib||this.ev.resultsUpdated(fc),fc.tso(this.ev)):this.ev.resultsUpdated(fc),ib=u.TellMeActor.instance.Ne,fc.dac&&ib&&(Cc=fc.query.imb,Jc=ib.rfd,fc.query.Eg&&0<fc.query.Eg.length&&this.Cld&&this.kc.$Yd&&this.gea!==e.a.contextMenu&&
Cc>Jc&&!this.kc.RXd&&!this.kc.QO&&(ib.oIf(fc.query.Eg),ib.g8f(Cc)),ib.pA(k.a.C0n,window.performance.now()-Ib)))}APk(ib,Ib){if(!(this.FYb&&ib.toString()in this.FYb)||Ib.length<=ib||!Ib[ib])return!1;if(!Ib[ib].ho.length)return!0;const fc=this.FYb[ib.toString()];if(0===fc)return!0;const Cc=this.FYb;for(let pd in Cc){var Jc=Cc[pd];const ge=Number.parseInvariant(pd);if(ge!==ib&&Jc===fc&&!(Ib.length>ge&&Ib[ge]))return!1}return!0}}Object(l.a)(zj,"ResultsAggregator",null,[]);var Xd=c(1748);class Th{constructor(){this.rkc=
this.skc=this.qkc=this.logCount=this.logRank=this.invertedRank=0}vlk(ib,Ib){switch(ib){case 1:this.invertedRank=Ib;break;case 3:this.logRank=Ib;break;case 2:this.logCount=Ib;break;case 5:this.qkc=Ib;break;case 4:this.skc=Ib;break;case 6:this.rkc=Ib}}}Object(l.a)(Th,"CommandFeatures",null,[]);class Pf{constructor(ib){this.oRg=0;this.pAa=ib;this.ASj={}}get modelId(){return this.pAa}get featureIntercept(){return this.oRg}get AFc(){return this.ASj}tkk(ib,Ib,fc){0===Ib?this.oRg=fc:(this.AFc[ib]||(this.AFc[ib]=
new Th),this.AFc[ib].vlk(Ib,fc))}}Object(l.a)(Pf,"CoefficientsModel",null,[]);const rj=(ib,Ib)=>Math.pow(10,-Ib/(60*Math.LN10/Math.LN2*ib));class En{constructor(ib,Ib){this.fj=1;this.hhd=new Th;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=ib?1/ib:0;this.features.logRank=2/Math.pow(2,ib);this.features.qkc=rj(10,Ib);this.features.skc=rj(2,Ib);this.features.rkc=rj(1,Ib)}get count(){return this.fj}get features(){return this.hhd}Lli(){this.fj=this.count+1;this.features.logCount=
1+Math.log(this.count)/Math.LN2}tQo(ib){const Ib=2/Math.pow(2,ib);this.features.invertedRank=Math.max(this.features.invertedRank,ib?1/ib:0);this.features.logRank=Math.max(this.features.logRank,Ib)}QRo(ib){const Ib=rj(10,ib),fc=rj(2,ib);ib=rj(1,ib);this.features.qkc=Math.max(this.features.qkc,Ib);this.features.skc=Math.max(this.features.skc,fc);this.features.rkc=Math.max(this.features.rkc,ib)}}Object(l.a)(En,"CommandModel",null,[]);class lg{constructor(ib){this.Soc=null;if(!ib&&u.TellMeActor.instance.Ne)u.TellMeActor.instance.Ne.onError("PredictionEngine",
"IModelAdapter can't be null");this.YVb=ib;this.Cnd=this.rHf()}rHf(){const ib=this.YVb.xWl(),Ib=this.YVb.Cpf();if(void 0===ib||null===ib||void 0===Ib||null===Ib)return!1;try{window.performance.now();this.Soc={};for(let fc=0;fc<ib.length;fc++){const Cc=ib[fc],Jc=Ib[Cc[0].toString()].trim(),pd=Cc[1],ge=0!==pd?Ib[Cc[2].toString()].trim():"",pe=Cc[3];Jc in this.Soc||(this.Soc[Jc]=new Pf(Jc));this.Soc[Jc].tkk(ge,pd,pe)}}catch(fc){if(u.TellMeActor.instance.Ne)u.TellMeActor.instance.Ne.onError("LoadModelData",
"Error Loading Suggestions Model: "+fc);return!1}return!0}WBl(){const ib=this.YVb.$Sl(),Ib={};if(!ib)return Ib;let fc=1;for(let Cc=0;Cc<ib.length;Cc++){const Jc=ib[Cc];Jc.Id in Ib?(Ib[Jc.Id].Lli(),Ib[Jc.Id].tQo(fc),Ib[Jc.Id].QRo(Jc.TimeElapsedSinceClick)):Ib[Jc.Id]=new En(fc,Jc.TimeElapsedSinceClick);fc++}return Ib}aCf(){this.Cnd||(this.Cnd=this.rHf());return this.Cnd}S0l(){let ib=[];if(!this.Cnd){if(u.TellMeActor.instance.Ne)u.TellMeActor.instance.Ne.onError("GetPredictedCommands","IModelAdapter returned no data");
return ib}const Ib=this.WBl(),fc=this.Soc;for(let Jc in fc){const pd=fc[Jc],ge=pd.modelId;let pe=0;for(let ke in Ib){var Cc=ke;const Qf=Ib[ke].features;(Cc=Cc in pd.AFc?pd.AFc[Cc]:null)&&(pe+=Qf.invertedRank*Cc.invertedRank+Qf.logRank*Cc.logRank+Qf.logCount*Cc.logCount+Qf.qkc*Cc.qkc+Qf.skc*Cc.skc+Qf.rkc*Cc.rkc)}pe+=pd.featureIntercept;ib.push(new Fe.a(ge,pe))}ib.sort((Jc,pd)=>Jc.score<pd.score?1:Jc.score>pd.score?-1:0);0<ib.length-10&&(ib=ib.slice(0,10));return ib}}Object(l.a)(lg,"PredictionEngine",
null,[]);class al{constructor(){this.fbh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}OMd(ib,
Ib){return Ib&&"word"===Ib.application.toLowerCase()&&ib in this.fbh?this.fbh[ib]:[]}}Object(l.a)(al,"SuggestionResultsUtility",null,[]);class Dh{constructor(ib,Ib,fc){this.kc=Ib;this.fwc=new lg(ib);this.U1=fc;this.Zdh=new al}BK(){return"Suggestion"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:2}xH(ib,Ib,fc,Cc=e.a.tellMe,Jc=null){fc=new m.a(ib);u.TellMeActor.instance.Z$c=!1;if((!Jc||Array.contains(Jc,16))&&z.a.FQ(ib)){if(!this.fwc.aCf()){if(u.TellMeActor.instance.Ne)u.TellMeActor.instance.Ne.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.DYd()&&0<this.Zdh.OMd(u.TellMeActor.instance.gGd,this.kc).length){const ge=this.Zdh.OMd(u.TellMeActor.instance.gGd,this.kc);Jc=[];for(var pd of ge)this.kc.kge&&"Find"===pd||Jc.push(new Fe.a(pd,0));u.TellMeActor.instance.Z$c=!0}else Jc=this.fwc.S0l();Bd.CommandResultsUtility.S0d(Jc,!0,"Recommended","LRE");pd=[];for(const ge of Jc)this.U1&&this.U1.n7e(ge.commandId)||
pd.push(ge);ib=Bd.CommandResultsUtility.jOc(ib,pd,this.kc,null,null,null,16,1);0<ib.results.length&&Cc!==e.a.contextMenu&&(ib.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<ib.results.length&&fc.Lu(ib)}Ib.resultsUpdated(fc)}DYd(){return!!this.kc&&(this.kc.DYd||this.kc.uNm)}}Object(l.a)(Dh,"SuggestionResultsProvider",null,[1258]);class Fi{$Sl(){return u.TellMeActor.instance.Nte}xWl(){return window.TellMeSuggestionModel}Cpf(){return window.CoefficientModelIdMap}}Object(l.a)(Fi,"SuggestionsModelAdapter",
null,[1278]);var Ri=c(1761),Ll=c(1717);c.d(L,"AggregatorResultsProvider",function(){return Pe});class Pe{constructor(ib=!1){this.aXb={};this.aXb[e.a.tellMe]=[];this.aXb[e.a.contextMenu]=[];this.Cld=ib}xzi(ib,Ib,fc,Cc,Jc=null){let pd;var ge=!1;switch(Cc){case e.a.contextMenu:pd=this.aXb[e.a.contextMenu];ge=!0;break;default:pd=this.aXb[e.a.tellMe]}Ib=new zj(Ib,pd,ge,this.Cld,Cc);Ib.Wun();for(let pe=0;pe<pd.length;++pe){const ke=window.performance.now(),Qf=new J(Ib,pe);(ge=u.TellMeActor.instance.bO())&&
ge.ZEk?window.setTimeout(()=>{pd[pe].xH(ib,Qf,fc,Cc,Jc);if(u.TellMeActor.instance.Ne){const Hg={};Hg[a.a.provider]=pd[pe].BK();Hg[a.a.cLb]=ib.imb;u.TellMeActor.instance.Ne.pA(k.a.xH,window.performance.now()-ke,Hg)}},0):(pd[pe].xH(ib,Qf,fc,Cc,Jc),u.TellMeActor.instance.Ne&&(ge={},ge[a.a.provider]=pd[pe].BK(),ge[a.a.cLb]=ib.imb,u.TellMeActor.instance.Ne.pA(k.a.xH,window.performance.now()-ke,ge)))}Ib.QJo()}BK(){return"Aggregator"}KT(){return 0}xH(ib,Ib,fc=!1,Cc=e.a.tellMe,Jc=null){if(u.TellMeActor.instance.B8m)this.xzi(ib,
Ib,fc,Cc,Jc);else{const pd=window.performance.now();u.TellMeActor.instance.qWo.then(()=>{u.TellMeActor.instance.Ne&&u.TellMeActor.instance.Ne.pA(k.a.C8m,window.performance.now()-pd);this.xzi(ib,Ib,fc,Cc,Jc);return!0})}}lE(ib,Ib){this.aXb[Ib].push(ib)}lmk(ib){switch(ib){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Ib=this.aXb[e.a.tellMe];for(const fc of Ib)if("FindInDocument"===fc.BK()){fc.qdo(ib);break}}}static createInstance(ib,Ib,fc,Cc){const Jc=
Ib.qfa;var pd=Cc&&z.a.O$f(Ib),ge=pd&&Ib.QTf&&!Jc;const pe=Ib.kEf&&!z.a.SGb()&&!Jc,ke=Ib.oCf&&!Jc,Qf=new Pe(pd);if(Ib.wmo&&!Jc){var Hg=new ch(Ib);Qf.lE(Hg,e.a.tellMe)}Hg=Ib.rq?nn.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):nn.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const gc=!Hg&&nn.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");Qf.lE(new Zd.a(ib,Ib.SHo,gc,!1),e.a.tellMe);Hg&&!Jc&&Qf.lE(new Dh(new Fi,Ib,ib),e.a.tellMe);ib=nn.AFrameworkApplication.ta.Ob.iyi?
new Uf(Ib,new Hl):new no(Ib,fc);Qf.lE(ib,e.a.contextMenu);(pd&&Ib.RTf||ge)&&Qf.lE(Ri.a.wJh(Ib,!0),e.a.tellMe);Qf.lE(ib,e.a.tellMe);!Ib.gWh||Jc||"Word"===Ib.application&&Ib.HKd||Qf.lE(new Of(Ib),e.a.tellMe);Ib.yyb&&!Jc&&(ge=new K(Ib),Qf.lE(ge,e.a.tellMe),Qf.lE(ge,e.a.contextMenu));!Ib.Cyb||Ib.v6c||Ib.u6c||Jc||Qf.lE(new H.a(Ib),e.a.tellMe);Cc&&(Ib.m_||z.a.Dga())&&(ge=new ze(Ib),Qf.lE(ge,e.a.tellMe),Qf.lE(ge,e.a.contextMenu));pd&&Qf.lE(Ri.a.wJh(Ib,!1),e.a.tellMe);Cc&&!Ib.Jdg&&z.a.N$f(Ib)&&!Jc&&(Qf.lE(new Xd.a(Ib),
e.a.tellMe),Ib.jqj&&Qf.lE(new Xd.a(Ib),e.a.contextMenu));pe&&Qf.lE(new nd(Ib),e.a.tellMe);!Ib.sic&&!Ib.QO||Jc||Qf.lE(new xm.a(Ib),e.a.tellMe);Ib.IUc&&!Jc&&Qf.lE(new Ll.a(Ib),e.a.tellMe);Ib.HVd&&(pd=new E(Ib),Qf.lE(pd,e.a.tellMe),Qf.lE(pd,e.a.contextMenu));Cc&&Ib.LVd&&!Jc&&Qf.lE(new F.AddinResultsProvider(Ib),e.a.tellMe);ke&&"Excel"===Ib.application&&!Jc&&Qf.lE(new Ym(Ib),e.a.tellMe);return Qf}}Object(l.a)(Pe,"AggregatorResultsProvider",null,[1258])},1741:function(D,L,c){D=c(0);var l=c(17),e=c(6),
a=c(177),k=c(231),x=c(394),y=c(60),m=c(82),u=c(947),z=c(865),v=c(560);c(502);var E=c(1707),F=c(1708),J=c(1704),K=c(1706),H=c(1705),P=c(946),N=c(864);class M{constructor(ma,Ba,Pa){this.oBl=ma;this.sCk=Ba;this.FNk=Pa}}Object(D.a)(M,"BacktraceAndMakeUpdateHintsInput",null,[]);var I=c(1532),T;(function(ma){ma[ma.EOP=0]="EOP";ma[ma.character=1]="character";ma[ma.embeddedMarker=2]="embeddedMarker"})(T||(T={}));Object(D.b)("LCSBlockType",T);class U{toString(){return String.format("[Type: {0}]",T[this.type])}}
Object(D.a)(U,"ALCSBlock",null,[]);class W extends U{constructor(ma,Ba){super();this.Xse=Ba;this.cLe=ma}get type(){return 1}get character(){return this.Xse}get Dv(){return this.cLe}hA(ma){return 1===ma.type&&I.a.Zqh(ma.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(D.a)(W,"CharacterLCSBlock",U,[]);class V extends U{constructor(ma,Ba,Pa){super();this.cLe=ma;this.yVe=Ba;this.jvc=Pa}get type(){return 0}get Lc(){return this.yVe}get length(){return this.jvc}get Dv(){return this.cLe}hA(ma){return 0!==
ma.type?!1:ma.Dv===this.Dv&&ma.Lc===this.Lc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.Dv.toString(),this.Lc,this.length)}}Object(D.a)(V,"EOPLCSBlock",U,[]);class Y extends W{constructor(ma,Ba,Pa){super(ma,"\ufffc");this.G4j=Ba;this.Uhd=Pa}get type(){return 2}get uj(){return this.G4j}get Dj(){return this.Uhd}hA(ma){return 2!==ma.type?!1:ma.uj===this.uj&&this.Dj.equals(ma.Dj)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),
this.uj,this.Dj)}}Object(D.a)(Y,"EmbeddedMarkerLCSBlock",W,[]);class da{constructor(ma,Ba){this.x=ma;this.y=Ba}equals(ma){return ma.x===this.x&&ma.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(D.a)(da,"IntPair",null,[918]);var ba=c(1570),ja=c(1553),sa=c(1571),ta=c(1703);c.d(L,"a",function(){return ra});class ra{constructor(ma,Ba){this.Lg=ma;this.Vd=Ba}HJh(ma,Ba,Pa,Da,Ha,oa,wa){return this.B8k(ma,Ba,Pa,Da,Ha,oa,wa)}B8k(ma,Ba,Pa,Da,Ha,oa,wa){let ia;ia=null;({returnValue:ma}=this.GOd(ma,
Ba));if(!ma)return a.a.instance.Ta(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.Vd.logger.kU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ia};({returnValue:Pa}=this.GOd(Pa,Da));if(!Pa)return a.a.instance.Ta(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.Vd.logger.kU("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ia};this.Vd.logger.kU("GetLCSBlocksFromObject");ia=this.A8k(ma,Pa,Ha,oa,wa);return ia?{returnValue:!0,updateHints:ia}:(a.a.instance.Ta(575706451,
1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:ia})}WVh(ma,Ba,Pa,Da){({returnValue:ma}=this.GOd(ma,Ba));if(!ma)return-1;({returnValue:Pa}=this.GOd(Pa,Da));if(!Pa)return-1;({waf:Pa}=this.$Vh(ma,Pa));return Pa}GOd(ma,Ba){let Pa;const Da=new k.a;Pa=new k.a;if(!ma.length)return a.a.instance.Ta(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.Vd.logger.Pg(Object.assign(new ba.a,{pj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,$ff:Pa};for(let wa=0;wa<
ma.length;wa++)if(this.Vd.runtime.xG("GetLCSBlocksFromObject: paraObjs#"+wa),393230===ma.J(wa).Nc){const ia=this.Lg.getPropertyString(ma.J(wa),l.a.yo),ca=this.Lg.getPropertyUint32(ma.J(wa),e.a.Lc);if(null==ca)return a.a.instance.Ta(594124835,1,2,"Abandoning LCS due to missing WordId"),this.Vd.logger.Pg(Object.assign(new ba.a,{pj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,$ff:Pa};let pa=this.Lg.getPropertyUint32s(ma.J(wa),l.a.sm);pa=ja.a.Egj(pa,ia.length);const Ma=this.Lg.getPropertyObjectIds(ma.J(wa),
l.a.En);let ya;for(ya=0;ya<pa.length-1;ya++){var Ha=Ba(Ma.$f(ya)),oa=void 0;oa=Ha?(oa=this.Lg.getPropertyBool(Ha,l.a.w9))?oa:!1:!1;if(oa)Da.add(this.d3k(ma.J(wa).id,Ha));else for(Ha=pa.$f(ya);Ha<pa.$f(ya+1);Ha++)Da.add(new W(ma.J(wa).id,I.a.charAt(ia,Ha)))}Da.add(new V(ma.J(wa).id,ca,pa.J(ya)));Pa.add(Da.length-1)}else return a.a.instance.Ta(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",ma.J(wa).Nc),this.Vd.logger.Pg(Object.assign(new ba.a,{pj:"GetLCSBlocksFromObject",
eventId:"900ba"})),{returnValue:null,$ff:Pa};this.Vd.runtime.xG("LCS: GetLCSBlocks for base");return{returnValue:Da,$ff:Pa}}d3k(ma,Ba){const Pa=null==this.Lg.getPropertyInt32(Ba,e.a.Rs)?0:this.Lg.getPropertyInt32(Ba,e.a.Rs);return new Y(ma,Pa,Ba.id)}A8k(ma,Ba,Pa,Da,Ha){Da=({waf:Pa}=this.$Vh(ma,Ba,Pa,Da,Ha)).returnValue;this.Vd.logger.kU("FindFurthestPaths");ma=new M(Da,ma,Ba);ma=new ta.a(this.hCk(ma,Pa),1);this.Vd.logger.kU("BacktraceAndMakeUpdateHints");return ma}$Vh(ma,Ba,Pa=-1,Da=-1,Ha=-1){let oa;
if(-1===Pa||-1===Da||-1===Ha)Ha=Da=Pa=-1;oa=-1;const wa=new x.a;wa.Z(new da(-1,1),new da(0,-1));if(-1!==Pa){wa.Z(new da(0,0),new da(Pa,Pa));var ia=1}else ia=0,Da=ma.length,Ha=Ba.length;for(Pa=0;ia<=ma.length+Ba.length;ia++){let ca=!1;for(let pa=-ia;pa<=ia;pa+=2){let Ma,ya;pa===-ia?(Ma=wa.J(new da(ia-1,pa+1)).x,ya=wa.J(new da(ia-1,pa+1)).y+1):pa===ia?(Ma=wa.J(new da(ia-1,pa-1)).x+1,ya=wa.J(new da(ia-1,pa-1)).y):wa.J(new da(ia-1,pa-1)).x>=wa.J(new da(ia-1,pa+1)).x?(Ma=wa.J(new da(ia-1,pa-1)).x+1,ya=
wa.J(new da(ia-1,pa-1)).y):(Ma=wa.J(new da(ia-1,pa+1)).x,ya=wa.J(new da(ia-1,pa+1)).y+1);for(;Ma<Da&&ya<Ha&&ma.J(Ma).hA(Ba.J(ya));)Ma++,ya++;wa.Z(new da(ia,pa),new da(Ma,ya));if(Ma===Da&&ya===Ha){ca=!0;oa=ia;Pa=pa;break}}if(ca)break;this.Vd.runtime.xG("LCS FindFurthestPaths")}if(Pa!==Da-Ha)return{returnValue:null,waf:oa};wa.Z(new da(oa,Pa),new da(Da+1,Ha+1));a.a.instance.Ta(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",ma.length,Ba.length,
oa);return{returnValue:wa,waf:oa}}hCk(ma,Ba){const Pa=ma.oBl,Da=ma.sCk;ma=ma.FNk;const Ha=new k.a;let oa=Da.length,wa=ma.length;for(;0<oa||0<wa;){var ia=oa-1,ca=wa-1;if(this.Vun(Pa,Ba,oa,wa)){ia=ma.J(ca);if(1===ia.type||2===ia.type)this.Qum(Ha,oa,ia);else if(0===ia.type)this.oum(Ha,oa,ia);else return a.a.instance.Ta(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",ia.type),this.Vd.logger.Pg(Object.assign(new sa.a,{pj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;wa--;
Ba--}else if(this.Uun(Pa,Ba,oa,wa)){ca=Da.J(ia);if(1===ca.type||2===ca.type)this.Vcl(Ha,ia,ca);else if(0===ca.type)this.Ccl(Ha,ia,ca);else return a.a.instance.Ta(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",ca.type),this.Vd.logger.Pg(Object.assign(new sa.a,{pj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;oa--;Ba--}else if(oa&&wa&&Da.J(ia).hA(ma.J(ca)))oa--,wa--;else return a.a.instance.Ta(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.Vd.logger.Pg(Object.assign(new sa.a,
{pj:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.Vd.runtime.xG("LCS: CreateUpdateHintsFromLCSBlocks");return Ha}Uun(ma,Ba,Pa,Da){Ba=new da(Ba-1,Pa-Da-1);return ma.ob(Ba)&&ma.J(Ba).x===Pa-1&&ma.J(Ba).y===Da}Vun(ma,Ba,Pa,Da){Ba=new da(Ba-1,Pa-Da+1);return ma.ob(Ba)&&ma.J(Ba).x===Pa&&ma.J(Ba).y===Da-1}addPara(ma,Ba,Pa,Da,Ha,oa){var wa=null;Pa.block?wa=Pa.block.Dv:0<=Ha&&0===ma.J(Ha).type&&(wa=ma.J(Ha).Dv);Pa=ma=oa.Dv;if(Da.E_b.contains(ma))for(Ha=0,ma=y.a.Gf("{00000000-0000-0000-0000-000000000000}{"+
Ha+"}");Da.E_b.contains(ma);)Ha++,ma=y.a.Gf("{00000000-0000-0000-0000-000000000000}{"+Ha+"}");wa=new u.AddParagraphUpdateHint(ma,oa.Lc,wa);wa.Fqn=Pa;Ba.updateHints.add(wa);Da.Dv=ma;Da.Lc=oa.Lc;Da.E_b.add(ma);Da.gRa=0}oum(ma,Ba,Pa){Pa=new J.a(Pa.Dv,Pa.Lc);let Da=!1;if(0<ma.length&&11===ma.$f(ma.length-1).type){const Ha=ma.$f(ma.length-1);Ha.cp===Ba&&(Da=!0,Ha.h_.add(Pa))}Da||(Ba=new H.a(Ba),Ba.h_.add(Pa),ma.add(Ba))}splitPara(ma,Ba,Pa,Da,Ha,oa,wa,ia){ma=this.zvl(oa.Dv,ma,Ba,Da);if(!ma)return!1;Ba=
new N.a(oa.Dv,oa.Lc,oa.gRa,ma.Dv,ma.Lc,wa.Dv,wa.Lc);Pa.updateHints.add(Ba);oa.Lc=ma.Lc;ma!==ia?(Ha.block=ma,Ha.n7o=oa.gRa,Ha=new u.AddParagraphUpdateHint(ia.Dv,ia.Lc,ma.Dv),Pa.updateHints.add(Ha),oa.Dv=ia.Dv,oa.Lc=ia.Lc,oa.E_b.add(ia.Dv),oa.gRa=0):oa.E_b.add(wa.Dv);return!0}Qum(ma,Ba,Pa){var Da=!1;if(0<ma.length&&11===ma.$f(ma.length-1).type){const Ha=ma.$f(ma.length-1);Ha.cp===Ba&&((Da=Object(m.a)(K.a,Ha.h_.J(Ha.h_.length-1)))?Da.text=Pa.character.toString()+Da.text:Ha.h_.add(new K.a(Pa.Dv,Pa.character.toString())),
Da=!0)}Da||(Ba=new H.a(Ba),Ba.h_.add(new K.a(Pa.Dv,Pa.character.toString())),ma.add(Ba))}deletePara(ma,Ba,Pa,Da,Ha,oa){let wa=-1;for(let ia=0;ia<Ha.length;ia++)if(Ha.J(ia)===oa){0<ia&&(wa=ia-1);break}oa=null;0<=wa&&(oa=Da.J(Ha.J(wa)));Da=new z.a(Pa.Dv,Pa.Lc,oa?oa.Dv:null);ma.updateHints.add(Da);oa&&Ba.Dv.equals(Pa.Dv)&&(Ba.gRa=oa.length,Ba.Dv=oa.Dv,Ba.Lc=oa.Lc);Ba.E_b.remove(Pa.Dv)}Ccl(ma,Ba,Pa){Ba=new E.a(Ba,Pa.Dv,Pa.Lc);ma.add(Ba)}mergePara(ma,Ba,Pa){ma.updateHints.add(new P.MergeParagraphUpdateHint(Pa.Dv,
Pa.Lc,Pa.length,Ba.Dv,Ba.Lc,Pa.Dv,Ba.Lc));Ba.gRa=Pa.length;Ba.E_b.remove(Ba.Dv);Ba.Dv=Pa.Dv}deleteText(ma,Ba,Pa){let Da=!1;if(0<ma.updateHints.length&&2===ma.updateHints.$f(ma.updateHints.length-1).type){const Ha=ma.updateHints.$f(ma.updateHints.length-1);Ha.wg.equals(Ba.Dv)&&Ha.cp===Ba.gRa&&(Ha.cp=Ba.gRa-1,Ha.text=Pa.character.toString()+Ha.text,Da=!0)}Da||ma.updateHints.add(new v.DeleteTextUpdateHint(Ba.Dv,Ba.gRa-1,Pa.character.toString()));--Ba.gRa}Vcl(ma,Ba,Pa){let Da=!1;if(0<ma.length&&8===ma.$f(ma.length-
1).type){const Ha=ma.$f(ma.length-1);Ha.cp===Ba+1&&(Ha.text=Pa.character.toString()+Ha.text,--Ha.cp,Da=!0)}Da||ma.add(new F.a(Ba,Pa.character.toString()))}zvl(ma,Ba,Pa,Da){for(;0<=Da;){var Ha=Ba.J(Pa.J(Da));if(0!==Ha.type)break;if(Ha.Dv.equals(ma))return Ha;Da--}return null}}Object(D.a)(ra,"LCSUpdateHintGenerator",null,[])},1747:function(D,L,c){c.r(L);D=c(0);var l=c(17),e=c(6),a=c(177),k=c(394),x=c(627),y=c(231),m=c(60),u=c(46),z=c(1520);class v extends z.a{constructor(){super()}get zfa(){return"ChildNodeListMerge"}}
Object(D.a)(v,"ChildNodeListMergeFailureDetail",z.a,[]);class E{bpb(da,ba,ja){return ba.Wy(da,ja.J(da))}Nvj(da,ba,ja,sa){let ta;return({value:ta}=ba.Ec(da)).returnValue||({value:ta}=ja.Ec(da)).returnValue?ta:sa.J(da)}}Object(D.a)(E,"ChildNodeListMergeUtils",null,[1928]);var F=c(1547),J=c(1760),K=c(1616);class H{constructor(da,ba){this.classId=da;this.sIo=ba}}Object(D.a)(H,"NodeChildrenTransformation",null,[]);var P=c(805),N=c(1537);class M{constructor(da,ba,ja){this.oE=da;this.oqa=ja;this.x7=ba}N9d(da){let ba,
ja;return({qZi:ba}=this.Svj(this.oqa,da)).returnValue&&ba.JX||({qZi:ja}=this.Svj(this.x7,da)).returnValue&&ja.JX}Svj(da,ba){let ja;return{returnValue:({value:ja}=(new N.a(this.oE,da)).fpa.Ec(P.a.zb(ba))).returnValue,qZi:ja}}}Object(D.a)(M,"NodeTriplet",null,[]);var I=c(1702);class T{constructor(da,ba,ja){this.Vd=da;this.Lg=ba;this.w6=ja;this.Udh=!0}get Zp(){return this.Vd}get Xd(){return this.Lg}get Kya(){return this.w6}get success(){return this.Udh}b0l(){a.a.instance.Ta(4220310,1,5,"Evaluating ParentObjects");
const da=new k.a;this.F2e(da,ba=>this.Zp.runtime.pk.J(ba));this.F2e(da,ba=>this.Kya.bpb(ba,this.Zp.runtime.ru,this.Zp.runtime.pk));this.F2e(da,ba=>this.Kya.bpb(ba,this.Zp.runtime.zq,this.Zp.runtime.pk));return da}F2e(da,ba){const ja=ba(c(1747).ChildNodeListMerge.w7d);this.Xd.getPropertyObjectIds(ja,l.a.gf).forEach(sa=>{this.Xd.getPropertyObjectIds(ba(sa),l.a.gf).forEach(ta=>{da.ob(ta)&&!sa.equals(da.J(ta))&&(this.Udh=!1,a.a.instance.Ta(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",
ta,sa,da.J(ta)));da.Z(ta,sa);return!0});return!0})}}Object(D.a)(T,"OutlineGroupParentFinder",null,[]);var U=c(1521),W=c(1572),V=c(1617);c.d(L,"ChildNodeListMerge",function(){return Y});class Y{constructor(da,ba=null,ja=null,sa=null,ta=null){this.Lg=da;this.etn=ba||J.a.mwj;this.M3d=ja||this.aYl();this.Kya=sa||new E;this.IHi=ta||this.aWl()}get Xd(){return this.Lg}aYl(){return[new H(393227,Object(u.a)(this,this.Rrn,"pageContentNodeThreewayChildMerge")),new H(1073872968,Object(u.a)(this,this.m_o,"wordSectionNodeThreewayChildMerge")),
new H(393241,Object(u.a)(this,this.n7d,"outlineElementContainerThreewayChildMerge")),new H(393252,Object(u.a)(this,this.Wyo,"tableCellThreewayChildMergev2")),new H(1074135125,Object(u.a)(this,this.n7d,"outlineElementContainerThreewayChildMerge")),new H(1074135123,Object(u.a)(this,this.n7d,"outlineElementContainerThreewayChildMerge")),new H(1074135127,Object(u.a)(this,this.n7d,"outlineElementContainerThreewayChildMerge"))]}aWl(){return[Object(u.a)(this,this.nzn,"prepareObjectGroupings"),Object(u.a)(this,
this.lfm,"handleInterOutlineGroupMerge"),Object(u.a)(this,this.xvn,"performThreewayChildMerge")]}L6m(da){let ba=0;for(;ba<this.IHi.length;ba++)if(!(0,this.IHi[ba])(da))return a.a.instance.Ta(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",ba),da.logger.a1d("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",ba),!1;return!0}nzn(da){const ba=new k.a,ja=new k.a,sa=new x.a;da.runtime.ru.forEach((ta,ra)=>Y.$Ui(ra,ba));da.runtime.zq.forEach((ta,ra)=>Y.$Ui(ra,ja));for(let ta=0;ta<this.M3d.length;ta++){const ra=
this.M3d[ta].classId;da.runtime.Hkb.Z(ra,new k.a);ba.ob(ra)&&ba.J(ra).forEach(ma=>{var Ba=da.runtime.pk.J(ma.id);Ba&&(Ba=new M(Ba,ma,da.runtime.zq.Wy(ma.id,Ba)),da.runtime.Hkb.J(ra).add(ma.id,Ba),sa.add(ma.id));return!0});ja.ob(ra)&&ja.J(ra).forEach(ma=>{if(sa.contains(ma.id))return!0;const Ba=da.runtime.pk.J(ma.id);Ba&&da.runtime.Hkb.J(ra).add(ma.id,new M(Ba,Ba,ma));return!0})}da.runtime.xG("PrepareObjectGroupings");da.logger.Qga("PrepareObjectGroupings");return!0}xvn(da){let ba=!0;for(let ja=0;ba&&
ja<this.M3d.length;ja++){const sa=this.M3d[ja];da.runtime.xG("Before function#"+ja);const ta=sa.classId;da.runtime.Hkb.J(ta).forEach((ra,ma)=>{da.runtime.PMa.contains(ma.oE.id)||(ba=sa.sIo(da,ma)&&ba);ba||(a.a.instance.Ta(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",ta,ma.oE.id),da.logger.Pg(Object.assign(new v,{pj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return ba});da.runtime.xG("PerformThreewayChildMerge"+ja)}da.logger.Qga("PerformThreewayChildMerge");
return ba}Rrn(da,ba){if(ba.N9d(l.a.gf)){var ja=this.Xd.getPropertyObjectIds(ba.oE,l.a.gf);const sa=this.Xd.getPropertyObjectIds(ba.x7,l.a.gf);ba=this.Xd.getPropertyObjectIds(ba.oqa,l.a.gf);ja=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",ja.length,sa.length,ba.length,da.input.source);a.a.instance.Ta(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",ja);da.logger.Pg(Object.assign(new v,{pj:"PageContentNodeThreewayChildMerge",
eventId:"apybx",info:ja}));return!1}return!0}m_o(da,ba){if(ba.N9d(l.a.gf)){const Pa=new x.a,Da=new x.a,Ha=new x.a,oa=new x.a;var ja=this.Xd.getPropertyObjectIds(ba.oE,l.a.gf),sa=ja.zG(),ta,ra=({hGh:ta}=this.hDj(ba.x7,sa,Pa,"Favored")).returnValue,ma=({hGh:Ba}=this.hDj(ba.oqa,sa,Da,"Unfavored")).returnValue;if(!ra||!ma)return ja=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",
sa.count,Pa.count,Da.count,ta,Ba),da.logger.Pg(Object.assign(new v,{pj:"WordSectionNodeThreewayChildMerge",info:ja})),!1;ja.forEach(wa=>{Pa.contains(wa)||Ha.add(wa);Da.contains(wa)||oa.add(wa);return!0});ba=ba.oE.fH();sa=new y.a;for(ta=0;ta<ja.length;ta++){var Ba=ja.$f(ta);if(Ha.contains(Ba)||oa.contains(Ba)){if(da.runtime.PMa.add(Ba),sa.length&&(ra=sa.$f(sa.length-1),ra=da.runtime.Hkb.J(393241).J(ra),ma=da.runtime.Hkb.J(393241).J(Ba),ra&&ma))Ha.contains(Ba)?oa.contains(Ba)||(ra.oE=ra.oE.fH(),ra.oqa=
ra.oqa.fH(),this.jzd(ra.oE,ma.oE),this.jzd(ra.oqa,ma.oqa)):(ra.oE=ra.oE.fH(),ra.x7=ra.x7.fH(),this.jzd(ra.oE,ma.oE),this.jzd(ra.x7,ma.x7))}else sa.add(Ba)}this.Xd.setPropertyObjectIds(ba,l.a.gf,sa);ja=new U.a(ba);ja.aC(l.a.gf);da.runtime.Xm.Z(ba.id,ja)}return!0}jzd(da,ba){const ja=this.Xd.getPropertyObjectIds(da,l.a.gf);ba=this.Xd.getPropertyObjectIds(ba,l.a.gf);const sa=ja.y4();ba.forEach(ta=>{sa.add(ta);return!0});this.Xd.setPropertyObjectIds(da,l.a.gf,sa)}hDj(da,ba,ja,sa){let ta=0,ra=!0;this.Xd.getPropertyObjectIds(da,
l.a.gf).forEach(ma=>{ba.contains(ma)?ja.add(ma):(ra=!1,a.a.instance.Ta(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",sa,ma),ta++);return!0});return{returnValue:ra,hGh:ta}}lfm(da){let ba=!0;da.runtime.Hkb.J(393241).forEach((ja,sa)=>{if(this.CEm(sa)){a.a.instance.Ta(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",sa.oE.id);let ta;const ra=new T(da,this.Xd,this.Kya);if(({hTi:ja,TEj:ta}=this.PGo(da,ra.b0l(),sa)).returnValue)return a.a.instance.Ta(4220303,1,
4,"Merging WordSection {0} as a unit.",ta),ba=ra.success&&this.B7m(da,ta,ja)&&ba,ba||(a.a.instance.Ta(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",sa.oE.id,ra.success),da.logger.Pg(Object.assign(new v,{pj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",ra.success)}))),ba}return!0});return ba}CEm(da){if(!da.N9d(l.a.gf))return!1;const ba=this.Xd.getPropertyObjectIds(da.oE,l.a.gf).J(0),
ja=this.Xd.getPropertyObjectIds(da.x7,l.a.gf);da=this.Xd.getPropertyObjectIds(da.oqa,l.a.gf);return!ja.contains(ba,(sa,ta)=>sa.equals(ta))||!da.contains(ba,(sa,ta)=>sa.equals(ta))}PGo(da,ba,ja){ba=ba.J(ja.oE.id);a.a.instance.Ta(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",ja.oE.id,ba);if(da.runtime.PMa.contains(ba))return a.a.instance.Ta(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",
ba),{returnValue:!1,hTi:null,TEj:ba};const sa=new I.a;ja=da.runtime.pk.J(ba);this.Xd.getPropertyObjectIds(ja,l.a.gf).forEach(ta=>{sa.izd(ta);return!0});ja=this.Kya.bpb(ba,da.runtime.ru,da.runtime.pk);this.Xd.getPropertyObjectIds(ja,l.a.gf).forEach(ta=>{sa.kzd(ta);return!0});da=this.Kya.bpb(ba,da.runtime.zq,da.runtime.pk);this.Xd.getPropertyObjectIds(da,l.a.gf).forEach(ta=>{sa.ozd(ta);return!0});return{returnValue:!0,hTi:sa,TEj:ba}}BXf(da,ba,ja,sa,ta){let ra=!0;da.forEach(ma=>{const Ba=ba(ma);this.Xd.getPropertyObjectIds(Ba,
l.a.gf).forEach(Pa=>{ja.add(Pa);if(sa.ob(Pa))return(ra=sa.J(Pa).equals(ma)&&ra)||a.a.instance.Ta(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",ta,Pa,ma,sa.J(Pa)),ra;sa.Z(Pa,ma);return!0});return!0});return ra}pZl(da,ba){let ja,sa,ta,ra;ja=new y.a;sa=new y.a;ta=new y.a;ra=new k.a;const ma=da.runtime.pk;return this.BXf(ba.Gyb,Ba=>ma.J(Ba),ja,ra,"Base")&&this.BXf(ba.hhf,Ba=>this.Kya.bpb(Ba,da.runtime.ru,ma),sa,ra,"Favored")&&
this.BXf(ba.epb,Ba=>this.Kya.bpb(Ba,da.runtime.zq,ma),ta,ra,"Unfavored")?{returnValue:!0,Csh:ja,OUh:sa,gxj:ta,HLi:ra}:{returnValue:!1,Csh:ja,OUh:sa,gxj:ta,HLi:ra}}wwl(da,ba,ja,sa){let ta=!0;const ra=da.runtime.pk,ma=da.runtime.ru,Ba=da.runtime.zq,Pa=da.runtime.Xm,Da=new y.a,Ha=new k.a;ja.forEach(oa=>{const wa=sa.J(oa);if(!wa)return a.a.instance.Ta(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",oa),da.logger.Pg(Object.assign(new v,{pj:"FinishInterOutlineGroupMerge",
eventId:"aqgws"})),ta=!1;wa.equals(Da.last())||(Da.add(wa),Ha.add(wa,new y.a));Ha.J(wa).add(oa);da.runtime.PMa.add(oa);return!0});if(!ta)return!1;Ha.forEach((oa,wa)=>{const ia=this.Kya.Nvj(oa,ma,Ba,ra).fH();this.Xd.setPropertyObjectIds(ia,l.a.gf,wa);Pa.Z(oa,new U.a(ia));Pa.J(oa).aC(l.a.gf);da.runtime.PMa.add(oa);return ta});ja=this.Kya.Nvj(ba,ma,Ba,ra).fH();this.Xd.setPropertyObjectIds(ja,l.a.gf,Da);Pa.Z(ba,new U.a(ja));Pa.J(ba).aC(l.a.gf);da.runtime.PMa.add(ba);return ta}B7m(da,ba,ja){let sa,ta;
if(!({Csh:ra,OUh:sa,gxj:ta,HLi:ja}=this.pZl(da,ja)).returnValue)return!1;var ra=F.b(ra,sa,ta);ra=this.jUf(da,ra);return!!ra&&this.wwl(da,ba,ra,ja)}n7d(da,ba){return this.dTi(da,ba)}dTi(da,ba){if(ba.N9d(l.a.gf)){var ja=this.lZl(ba);ja=this.jUf(da,ja);if(!ja)return a.a.instance.Ta(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ba.oE.id),da.logger.Pg(Object.assign(new v,
{pj:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),K.a(ba.oE,"OutlineElementContainerThreewayChildMerge_Base",1),K.a(ba.x7,"OutlineElementContainerThreewayChildMerge_Favored",1),K.a(ba.oqa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var sa=this.Xd.getPropertyObjectIds(ba.oE,l.a.gf);const ta=ja.zG();sa.forEach(ra=>{ta.contains(ra)||(ra=this.Xd.getPropertyObjectIds(ba.oE,l.a.mK),0<ra.length&&da.runtime.SUf.add(ra.J(0)));return!0});sa=ba.x7.fH();this.Xd.setPropertyObjectIds(sa,
l.a.gf,ja);da.runtime.Xm.Z(sa.id,new U.a(sa));da.runtime.Xm.J(sa.id).aC(l.a.gf)}return!0}aHb(da){if(!da)return a.a.instance.Ta(573957964,1,2,"Feature helper is null"),!1;da.pB(104);return da.isFeatureEnabled(104)}Wyo(da,ba){if(!this.aHb(da.runtime.Xb))return this.xeg(da,ba);var ja=ba.oE.id,sa=V.e(da,ba.oE,null);if(sa.equals(m.a.nil))return a.a.instance.Ta(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",ja),da.logger.Pg(Object.assign(new W.a,{info:"Table node ID could not be found for table cell"})),
!1;var ta=da.runtime.Nzb.J(sa);if(ta&&(ta=ta.J(ja)))if(ta.gg)ba=ba.x7.fH(),ba.removeProperty(l.a.gf),this.Xd.setPropertyBool(ba,e.a.ghostCell,!0),null!=ta.colSpan?this.Xd.setPropertyUint32(ba,e.a.colSpan,ta.colSpan):ba.removeProperty(e.a.colSpan),da.runtime.Xm.Z(ba.id,new U.a(ba)),da.runtime.Xm.J(ba.id).aC(l.a.gf),da.runtime.Xm.J(ba.id).aC(e.a.ghostCell),da.runtime.Xm.J(ba.id).aC(e.a.colSpan);else{let ra,ma;({eAd:sa,fKd:ra,sle:ma}=this.aVl(da,ba,ta,sa));if(!ra.length&&!ma.length)return a.a.instance.Ta(573957966,
1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",ja),da.logger.Pg(Object.assign(new W.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;ra.length?ma.length?(ja=F.b(sa,ra,ma),ja=this.jUf(da,ja)):ja=ra:ja=ma;if(!ja)return a.a.instance.Ta(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ba.oE.id),da.logger.Pg(Object.assign(new v,
{pj:"TableCellThreewayChildMergev2",eventId:"8n426"})),K.a(ba.oE,"TableCellThreewayChildMergev2_Base",1),K.a(ba.x7,"TableCellThreewayChildMergev2_Favored",1),K.a(ba.oqa,"TableCellThreewayChildMergev2_Unfavored",1),!1;ba=ba.x7.fH();this.Xd.setPropertyObjectIds(ba,l.a.gf,ja);ba.removeProperty(e.a.ghostCell);ja=ta.rowSpan;ta=ta.colSpan;null!=ja&&null!=ta&&(1<ja||1<ta)?(this.Xd.setPropertyUint32(ba,e.a.rowSpan,ja),this.Xd.setPropertyUint32(ba,e.a.colSpan,ta)):(ba.removeProperty(e.a.rowSpan),ba.removeProperty(e.a.colSpan));
da.runtime.Xm.Z(ba.id,new U.a(ba));da.runtime.Xm.J(ba.id).aC(l.a.gf);da.runtime.Xm.J(ba.id).aC(e.a.ghostCell);da.runtime.Xm.J(ba.id).aC(e.a.rowSpan);da.runtime.Xm.J(ba.id).aC(e.a.colSpan)}else return this.xeg(da,ba);da.logger.Qga("TableCellThreewayChildMergev2");return!0}aVl(da,ba,ja,sa){let ta,ra;({eAd:ba,fKd:ta,sle:ra}=this.f4h(ba));ba||(ba=new y.a);ta||(ta=new y.a);ra||(ra=new y.a);var ma=ba.zG(),Ba=ta.zG(),Pa=ra.zG(),Da=ja.l4d;if(Da)for(var Ha=0;Ha<Da.length;Ha++){var oa=Da.J(Ha),wa=da.runtime.pk.J(oa);
!ma.contains(oa)&&wa&&(ma.add(oa),ba.add(oa));!Ba.contains(oa)&&da.runtime.ru.Wy(oa,wa)&&(Ba.add(oa),ta.add(oa));!Pa.contains(oa)&&da.runtime.zq.Wy(oa,wa)&&(Pa.add(oa),ra.add(oa))}da.logger.Qga("OENodesAddedToChildrenList");if(Da=ja.vtf)for(Ha=0;Ha<Da.length;Ha++)if(oa=Da.J(Ha),wa=da.runtime.pk.J(oa)){var ia=this.Xd.getPropertyObjectIds(wa,l.a.gf);if(ia)for(var ca=0;ca<ia.length;ca++){var pa=ia.J(ca);ma.contains(pa)||(ma.add(pa),ba.add(pa))}ia=da.runtime.ru.Wy(oa,wa);if(ia=this.Xd.getPropertyObjectIds(ia,
l.a.gf))for(ca=0;ca<ia.length;ca++)pa=ia.J(ca),Ba.contains(pa)||(Ba.add(pa),ta.add(pa));oa=da.runtime.zq.Wy(oa,wa);if(oa=this.Xd.getPropertyObjectIds(oa,l.a.gf))for(wa=0;wa<oa.length;wa++)ia=oa.J(wa),Pa.contains(ia)||(Pa.add(ia),ra.add(ia))}da.logger.Qga("GhostCellOENodesAddedToChildrenList");if(ja=ja.zOf)for(ma=0;ma<ja.length;ma++)if(Ba=ja.J(ma),Ba=da.runtime.Nzb.J(sa).J(Ba))if(Ba=Ba.l4d){Ba=Ba.zG();Pa=new y.a;for(Da=0;Da<ba.length;Da++)Ba.contains(ba.J(Da))||Pa.add(ba.J(Da));ba=Pa;Pa=new y.a;for(Da=
0;Da<ta.length;Da++)Ba.contains(ta.J(Da))||Pa.add(ta.J(Da));ta=Pa;Pa=new y.a;for(Da=0;Da<ra.length;Da++)Ba.contains(ra.J(Da))||Pa.add(ra.J(Da));ra=Pa}da.logger.Qga("NonGhostCellsOENodesRemovedFromChildrenList");return{eAd:ba,fKd:ta,sle:ra}}xeg(da,ba){let ja=ba.x7.hasProperty(l.a.gf),sa=ba.oqa.hasProperty(l.a.gf);ja&&(ja=!!this.Xd.getPropertyObjectIds(ba.x7,l.a.gf).length);sa&&(sa=!!this.Xd.getPropertyObjectIds(ba.oqa,l.a.gf).length);if(ja!==sa)if(this.bLm(da.runtime.Xb))da.logger.NCi(Object.assign(new W.a,
{info:"TableCell OE missing children, ghost cell likely touched"}));else return da.logger.Pg(Object.assign(new W.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.dTi(da,ba)}lZl(da){let ba,ja;({eAd:da,fKd:ba,sle:ja}=this.f4h(da));return F.b(da,ba,ja)}jUf(da,ba){a.a.instance.Ta(4220309,1,5,"Considering {0} OutlineElement collections for merge.",ba.length);const ja=new y.a;let sa=!0;ba.forEach(ta=>{if(!ta)return a.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),
da.logger.Pg(Object.assign(new v,{pj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),sa=!1;if(1===ta.p8m&&1===ta.lkb){const ia=ta.Gyb.J(0),ca=ta.hhf.J(0),pa=ta.epb.J(0);if(ia&&ia.equals(ca)&&ia.equals(pa))return ja.add(ia),!0;if(1!==ba.length)return a.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",ia,ca,pa,ba.length),
da.logger.Pg(Object.assign(new v,{pj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),sa=!1}const ra=new k.a,ma=new y.a,Ba=new y.a,Pa=new y.a,Da=new y.a,Ha=new y.a,oa=new y.a,wa=da.runtime.pk;ta.Gyb.forEach(ia=>sa=this.wYf(da,ia,ca=>wa.J(ca),ma,Da,ra,"Base"));if(!sa)return a.a.instance.Ta(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),da.logger.Pg(Object.assign(new v,{pj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),
!1;ta.hhf.forEach(ia=>sa=this.wYf(da,ia,ca=>this.Kya.bpb(ca,da.runtime.ru,wa),Ba,Ha,ra,"Favored"));if(!sa)return a.a.instance.Ta(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),da.logger.Pg(Object.assign(new v,{pj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;ta.epb.forEach(ia=>sa=this.wYf(da,ia,ca=>this.Kya.bpb(ca,da.runtime.zq,wa),Pa,oa,ra,"Unfavored"));if(!sa)return a.a.instance.Ta(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),
da.logger.Pg(Object.assign(new v,{pj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;da.runtime.Xb&&da.runtime.Xb.lhb(1000005)&&(Ha.length&&this.qsl(Ha,da.runtime.ru)?(this.Olh(Ha,da,ja,ra),this.lyd(da,ra,oa)):this.Olh(oa,da,ja,ra));if(ma.length){ta=null;if(!({Xm:ta}=this.etn(da,ma,Ba,Pa,ta)).returnValue||!ta)return sa=!1;ta.forEach(ia=>{0<ia.aZb.count&&da.runtime.Xm.Z(ia.om.id,ia);ja.add(ra.J(ia.om.id));return!0})}return!0});return sa?ja:null}qsl(da,ba){for(let ja=0;ja<da.length;ja++)if(ba.get(da.$f(ja).id))return!0;
return!1}lyd(da,ba,ja){ja.length&&(ja.forEach(sa=>{da.runtime.Wic.add(sa.id);da.runtime.Wic.add(ba.J(sa.id));return!0}),J.a.lyd(da,this.Xd,ja.J(0)))}Olh(da,ba,ja,sa){da.forEach(ta=>{const ra=new U.a(ta.fH());ba.runtime.Xm.Z(ta.id,ra);ja.add(sa.J(ta.id));return!0})}wYf(da,ba,ja,sa,ta,ra,ma){var Ba=ja(ba);if(!Ba)return a.a.instance.Ta(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",ma,ba),da.logger.Pg(Object.assign(new v,{pj:"ProcessOutlineElement",eventId:"aqwkb",
info:String.format("[Revision: {0}] Failed to find OutlineElement",ma)})),!1;const Pa=this.Xd.getPropertyObjectIds(Ba,l.a.mK);if(!Pa||!Pa.length)return a.a.instance.Ta(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",ma,ba),da.logger.Pg(Object.assign(new v,{pj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",ma)})),K.a(Ba,"ProcessOutlineElement_"+ma,1),!1;Ba=Pa.$f(0);ja=ja(Ba);if(!ja)return a.a.instance.Ta(4285059,
1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",ma,Ba,ba),da.logger.Pg(Object.assign(new v,{pj:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",ma)})),!1;if((ma=this.Xd.getPropertyString(ja,e.a.NM))&&""!==ma&&da.runtime.Xb&&(da.runtime.Xb.IRd(1000005),da.runtime.Xb.lhb(1000005)))return ta.add(ja),ra.add(Ba,ba),da.runtime.PMa.add(Ba),!0;sa.add(ja);
ra.add(Ba,ba);da.runtime.PMa.add(Ba);return!0}f4h(da){let ba,ja;ba=this.Xd.getPropertyObjectIds(da.oE,l.a.gf);ja=this.Xd.getPropertyObjectIds(da.x7,l.a.gf);da=this.Xd.getPropertyObjectIds(da.oqa,l.a.gf);return{eAd:ba,fKd:ja,sle:da}}bLm(da){if(!da)return a.a.instance.Ta(51422868,1,2,"Feature Helper is null"),!1;da.pB(103);return da.isFeatureEnabled(103)}static $Ui(da,ba){ba.ob(da.Nc)||ba.Z(da.Nc,new y.a);ba.J(da.Nc).add(da);return!0}}Y.w7d=m.a.Gf("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(D.a)(Y,
"ChildNodeListMerge",null,[1870])},1748:function(D,L,c){D=c(0);var l=c(1485),e=c(1610),a=c(1533),k=c(1503),x=c(1692),y=c(1550);class m{constructor(ba,ja){this.DimensionValue=this.DimensionName=null;this.DimensionName=ba;this.DimensionValue=ja}}Object(D.a)(m,"Dimension",null,[]);class u{constructor(ba,ja,sa,ta,ra){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=ba;this.Query=ja;this.From=sa;this.Size=ta;ra&&(this.Filter=ra)}}Object(D.a)(u,"EntityRequest",null,
[]);class z{constructor(ba){this.QueryString=null;this.QueryString=ba}}Object(D.a)(z,"Query",null,[]);var v=c(1486);class E{constructor(ba,ja){this.Dimensions=this.Name=null;this.Name=ba;this.Dimensions=ja}}Object(D.a)(E,"Scenario",null,[]);var F=c(1490),J=c(1489);class K{constructor(ba,ja,sa,ta){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=ba;this.TimeZone=ja;this.Cvid=sa;this.Scenario=ta}}Object(D.a)(K,"SubstrateBody",null,[]);var H=c(1549),P=c(1483),N=c(1482),
M=c(2),I=c(1685),T=c(1684),U=c(1519),W=c(34),V=c(16),Y=c(118);c.d(L,"a",function(){return da});class da{constructor(ba){this.cxc=this.Bbb=this.eod=this.Prc=this.Pxc=0;this.n4g=this.S7g=this.uP=null;this.qGe=0;this.n1=-1;this.AAc="";this.Hze=!1;this.Of=M.AFrameworkApplication.Ke;this.kc=ba;this.dud=this.Zrf();this.kwb=new e.a;this.E2g=this.kc.Cke?3:2;this.xSe=this.kc.Cke&&this.kc.Zlj?5:3;this.NVe=this.kc.kge?2:3;this.qih=1;this.cnd=this.kc.o9h;this.bdh=this.kc.lKm;this.Oyc=ba.wci;M.AFrameworkApplication.K&&
(this.S7g=M.AFrameworkApplication.K.kb("AppCatalogUrl")+M.AFrameworkApplication.K.kb("SearchPersonaPhotoBaseUrl"),this.Hze=this.kc.qfa||this.kc.DId);this.kc.qfa&&(this.NVe=this.xSe=5)}BK(){return"Substrate"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:3}xH(ba,ja,sa,ta=l.a.tellMe,ra=null){const ma=new J.a(ba);if(!ra||Array.contains(ra,14)||Array.contains(ra,15)||Array.contains(ra,20))if(!this.qGe||window.performance.now()-this.qGe>=N.a.oTa)if(sa=this.kwb.$ci())this.qGe=window.performance.now(),sa.then(Ba=>
{Ba&&""!==Ba?(this.AAc=Ba,""!==this.uP&&this.Zci(ba,ta,this.AAc,ja,ra)):(P.TellMeActor.instance.Ne.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ja.resultsUpdated(ma))},Ba=>{P.TellMeActor.instance.Ne.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+Ba);ja.resultsUpdated(ma)});else{if(P.TellMeActor.instance.Ne)P.TellMeActor.instance.Ne.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");ja.resultsUpdated(ma)}else this.AAc&&
""!==this.AAc?this.Zci(ba,ta,this.AAc,ja,ra):(ja.resultsUpdated(ma),P.TellMeActor.instance.Ne.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ja.resultsUpdated(ma)}d5a(){this.Bbb=this.cxc=this.eod=this.Prc=this.Pxc=0}Zci(ba,ja,sa,ta,ra){this.d5a();const ma=new J.a(ba),Ba=this.uP=Y.a.create().toString();this.lCa();this.n1=window.setTimeout(()=>{if(Ba===this.uP){this.uP="";this.n1=-1;ta.resultsUpdated(ma);const Ha={};Ha[a.a.provider]=this.BK();Ha[a.a.cLb]=ba.imb;P.TellMeActor.instance.Ne.pA(k.a.timedOut,
this.Oyc,Ha)}},this.Oyc);const Pa={"Content-Type":"application/json",Accept:"application/json"};Pa.Authorization="Bearer "+sa;Pa["X-Office-Version"]=M.AFrameworkApplication.buildVersion;Pa["X-Office-Application"]=M.AFrameworkApplication.K.kb("Application");Pa["X-Office-Platform"]="WAC";Pa["X-TellMe-SessionId"]=P.TellMeActor.instance.VQd();Pa["X-TellMe-Culture"]=M.AFrameworkApplication.uiCulture;Pa["X-TellMe-ProcessSessionId"]=M.AFrameworkApplication.userSessionId;Pa["Client-Request-Id"]=Ba;const Da=
window.performance.now();this.Of.oj(this.Y6l(),2,this.Z6l(ba.Eg,this.kc.application,P.TellMeActor.instance.VQd(),N.a.FQ(ba)),Pa,!1,0,Ha=>{this.NJb(Ha,ba,ta,Ba,Da,ja,ra)},Ha=>{this.yJb(Ha,ba,ta,Ba,Da)},null,null,!1,4E3,6E3)}lCa(){-1!==this.n1&&(window.clearTimeout(this.n1),this.n1=-1)}NJb(ba,ja,sa,ta,ra,ma,Ba){P.TellMeActor.instance.Ne.R_(ja.Eg.length,this.dud.join(","),ba.data.Ve.toString(),Math.round(window.performance.now()-ra),H.a.substrate,!0,y.a.XOa);const Pa=N.a.FQ(ja),Da=new J.a(ja);if(ta===
this.uP){this.lCa();ba=W.b(ba.data.we);if(ba.Groups){ba=ba.Groups;for(const Ha of ba)"People"===Ha.Type&&this.kc.y8c&&(Ba?Array.contains(Ba,14):1)?(ba=this.D$h(Ha.Suggestions,Pa,ma),0<ba.results.length&&Da.Lu(ba)):"File"===Ha.Type&&this.kc.w8c&&(Ba?Array.contains(Ba,15):1)?(ba=this.Inf(Ha.Suggestions,Pa,ma),0<ba.results.length&&(this.cXd()&&(ta=new v.a("GenerateSlidesFromTellMe",30,"",null,1),ba.ww(ta)),Da.Lu(ba))):"Notes"===Ha.Type&&this.kc.tjb&&ma!==l.a.contextMenu&&(Ba?Array.contains(Ba,20):1)&&
(ba=this.j9h(Ha.Suggestions,Pa,ja),0<ba.results.length&&Da.Lu(ba))}sa.resultsUpdated(Da);P.TellMeActor.instance.Ne.R_(ja.Eg.length,this.dud.join(","),"",Math.round(window.performance.now()-ra),"",!0,y.a.provider)}else sa.resultsUpdated(Da)}j9h(ba,ja,sa){const ta=new F.a(20);ta.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ra of ba)this.FMm(ra)&&(ba=ra.NotesType,ba=V.a.fh(ba),ba=this.oYl(ba,ra.LastModifiedTime,ra.BodyPreview,ra.Subject,ja,sa,ra))&&(ba.groupType=20,ta.ww(ba));return ta}D$h(ba,
ja,sa){const ta=new F.a(14);ta.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const ma of ba)if(this.GMm(ma)){var ra=ma.Id.split("@")[0];ba=ma.EmailAddresses[0];let Ba=ma.Type;if(void 0===Ba||null===Ba)Ba="User";if(ra=this.o0l(Ba,ma.DisplayName,ma.JobTitle,ba,ra,sa,ja))ra.description=ba,ba=ma.JobTitle,"Department"in ma&&"CompanyName"in ma&&(ba+="@"+ma.Department+"@"+ma.CompanyName),ra.qI=ba,ta.ww(ra)}return ta}Inf(ba,ja,sa){const ta=new F.a(15);ta.displayName=CommonUIStrings.l_TellMeFileProviderTitle;
for(const Ha of ba)if(this.vMm(Ha)){var ra=Ha.FileName;ba=Ha.FileExtension;var ma=ra;ra.length>ba.length&&ma.endsWith(ba)&&(ma=ra.substr(0,ra.length-ba.length-1));var Ba=void 0,Pa=0;"DateCreated"in Ha&&Ha.DateCreated?(Pa=N.a.Fsf(Ha.DateCreated),Ba=N.a.pei(Ha.DateCreated),Ba=String.format(CommonUIStrings.l_CreatedTimeFormatString,Ha.Author,Ba)):Ba=Ha.Author;var Da=Ha.AccessUrl+"?web=1";const oa=V.a.B8b(Da);ra=String.format('<a href="{0}">{1}</a>',oa,V.a.i_(ra));if(sa!==l.a.contextMenu||V.a.eU(Da))if(ma=
this.JOl(ma,sa===l.a.contextMenu?ra:Da,Ba,Ha.FileExtension,Ha.Text,ja))ma.description=Ha.Author,ma.Pyd=Pa,ta.ww(ma),this.Hze&&(Pa=Ha.AccessUrl,ra=N.a.LNd(ba),Ba=Ha.DateModified?Ha.DateModified:Ha.DateCreated,Da=Ha.Size?Ha.Size:Ha.FileSize,this.slo()&&(Pa=Pa.replace(RegExp("%20","g")," "),ra=N.a.W5l(ba)),ba=new x.a(ra,Pa,Ha.SPWebUrl,Ha.Id,Da,Ba),P.TellMeActor.instance.Tig(!1,ma.value,ba))}return ta}yJb(ba,ja,sa,ta,ra){ta===this.uP&&(this.lCa(),P.TellMeActor.instance.Ne.R_(ja.Eg.length,this.dud.join(","),
ba.data.Ve.toString(),Math.round(window.performance.now()-ra),H.a.substrate,!1,y.a.XOa));ba=new J.a(ja);sa.resultsUpdated(ba)}o0l(ba,ja,sa,ta,ra,ma,Ba){Ba=Ba?this.qih:this.E2g;if(!window.LPC&&!N.a.dAf()||this.Pxc===Ba)return null;this.Pxc+=1;Ba="PeopleSuggestion"+this.Pxc.toString();var Pa=this.S7g+"?size=1&accountName="+ta;ba=Object.assign(new I.a,{PersonaType:ba,Smtp:ta,ProfilePictureUrl:Pa,AadObjectId:ra});const Da=Object.assign(new T.a,{identifiers:ba,displayName:ja});ba=ma===l.a.contextMenu;
this.kc.wva?(P.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Ba,Da,ja,sa)),ma===l.a.contextMenu&&(sa=N.a.dJh(ja,ta,ra),P.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ba,sa))),P.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ba,ba))):(Pa=[],Pa.push(appChrome.actions.setPersonaButtonCoauthor(Ba,Da,ja,sa)),ma===l.a.contextMenu&&(sa=N.a.dJh(ja,ta,ra),Pa.push(appChrome.actions.setButtonCommandValueId(Ba,
sa))),Pa.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ba,ba)),appChrome.api.dispatch(Pa));return new v.a(Ba,11,ja,ta,0)}oYl(ba,ja,sa,ta,ra,ma,Ba){if(ra&&!this.kc.myi||this.eod===this.cnd||this.cxc===this.cnd||this.Bbb===this.cnd)return null;var Pa=null;this.eod+=1;ra="";const Da=[],Ha={};Ba.type="Notes";this.n4g=Object.assign(new U.a,{landingTab:"Notes",data:Ba});ma=N.a.mNa(ma.Eg,33,this.n4g);if("onenotepagepreviews"===ba){if(!("ClickthroughUrl"in Ba&&Ba.ClickthroughUrl)||""===
Ba.ClickthroughUrl)return null;this.cxc+=1;ra="OnenoteNotesSuggestion"+this.cxc.toString();Ha["default"]="SaveAsonetoc2_20";Pa=Ba.ClickthroughUrl;Da.push(appChrome.actions.setControlIconSet(ra,Ha));Da.push(appChrome.actions.setCompoundButtonCommandValueId(ra,Pa));Pa=new v.a(ra,19,null,null,0)}else if("stickynote"===ba){if(!this.bdh)return null;this.Bbb+=1;ra="NotesSuggestion"+this.Bbb.toString();Ha["default"]="ShowAllNotes_20";Da.push(appChrome.actions.setControlIconSet(ra,Ha));Da.push(appChrome.actions.setCompoundButtonCommandValueId(ra,
ma));Pa=new v.a(ra,21,null,null,0)}else if("samsung"===ba){if(!this.bdh)return null;this.Bbb+=1;ra="NotesSuggestion"+this.Bbb.toString();Ha["default"]="CategoryCollapsed_20";Da.push(appChrome.actions.setControlIconSet(ra,Ha));Da.push(appChrome.actions.setCompoundButtonCommandValueId(ra,ma));Pa=new v.a(ra,20,null,null,0)}""!==ra&&(ba=N.a.pei(ja),ba=String.format(CommonUIStrings.l_LastModifiedString,ba),Pa.label=ta,Pa.Pyd=N.a.Fsf(ja),Da.push(appChrome.actions.setControlLabel(ra,ta)),Da.push(appChrome.actions.updateCompoundButtonDescription(ra,
ba)),Da.push(appChrome.actions.setControlCustomTooltip(ra,sa)),appChrome.api.dispatch(Da));return Pa}JOl(ba,ja,sa,ta,ra,ma){if(this.Prc===(ma?this.NVe:this.xSe)||this.Hze&&"Word"!==N.a.LNd(ta))return null;this.Prc+=1;ma="FileSuggestion"+this.Prc.toString();const Ba=[],Pa={};Pa["default"]=N.a.URl(ta);this.kc.wva?(P.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ma,ba)),P.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(ma,Pa)),P.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ma,
sa)),P.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ma,ja)),P.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(ma,ra))):(Ba.push(appChrome.actions.setControlLabel(ma,ba)),Ba.push(appChrome.actions.setControlIconSet(ma,Pa)),Ba.push(appChrome.actions.updateCompoundButtonDescription(ma,sa)),Ba.push(appChrome.actions.setCompoundButtonCommandValueId(ma,ja)),Ba.push(appChrome.actions.setControlCustomTooltip(ma,ra)),appChrome.api.dispatch(Ba));
return new v.a(ma,6,ba,sa,0)}Zrf(){const ba=[];this.kc.y8c&&Array.add(ba,"People");this.kc.w8c&&Array.add(ba,"File");this.kc.tjb&&Array.add(ba,"Notes");return ba}Z6l(ba,ja,sa,ta){var ra=new z(ba);ba=new u("File",ra,0,ta?this.NVe:this.xSe,null);ta=new u("People",ra,0,ta?this.qih:this.E2g,N.a.hvn);ra=new u("Notes",ra,0,this.cnd,null);this.kc.DId&&"powerpoint"===ja.toLowerCase()&&(ja="word");ja=new m("app",ja.toLowerCase());var ma=[];Array.add(ma,ja);ja=new E("tellmesearch",ma);ma=[];this.kc.w8c&&Array.add(ma,
ba);this.kc.y8c&&Array.add(ma,ta);this.kc.tjb&&Array.add(ma,ra);sa=new K(ma,"UTC",sa,ja);return W.c(sa)}Y6l(){let ba=this.kc.dxo;this.kc.tjb&&(ba+="?&setflight=NotesFrom3S");""!==this.kc.adi&&(ba=ba+"&"+this.kc.adi);return ba}GMm(ba){return"DisplayName"in ba&&"Id"in ba&&"EmailAddresses"in ba&&!!ba.Id&&!!ba.EmailAddresses}vMm(ba){return"FileExtension"in ba&&!!ba.FileExtension&&"FileName"in ba&&!!ba.FileName&&""!==ba.FileName&&"AccessUrl"in ba&&!!ba.AccessUrl&&""!==ba.AccessUrl}FMm(ba){return"Id"in
ba&&!!ba.Id&&"NotesType"in ba&&!!ba.NotesType&&"Subject"in ba&&!!ba.Subject&&""!==ba.Subject}cXd(){return!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}slo(){return!!M.AFrameworkApplication.K&&M.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(D.a)(da,"SubstrateResultsProvider",null,[1258])},1749:function(D,L,c){D=c(0);var l=c(44),
e=c(6),a=c(17),k=c(177),x=c(75),y=c(160),m=c(231),u=c(627),z=c(60),v=c(394),E=c(2),F=c(1442),J=c(765);class K{constructor(ma,Ba=0){this.n9e=null;this.BVf=0;this.qM=ma;this.h7m=Ba}}Object(D.a)(K,"GraphMergerResponse",null,[]);var H=c(46),P=c(1),N=c(126),M=c(878),I=c(1520),T=c(1569);class U extends T.a{constructor(){super();this.roj=null;this.dEj=!1}get zfa(){return"Crash"}eDb(){this.detail.Z("Type",this.zfa);this.detail.Z("Trace",this.mGo(this.roj));this.detail.Z("Continue",this.dEj);return this.detail}mGo(ma){ma=
ma.split("\n");const Ba=4<ma.length?4:ma.length,Pa=new Sys.StringBuilder;for(let Da=0;Da<Ba;Da++)Da===Ba-1?Pa.append(String.format("{0}...",ma[Da])):Pa.append(String.format("{0}\n",ma[Da]));return Pa.toString()}}Object(D.a)(U,"CrashMergeFailureDetail",T.a,[]);var W=c(1931),V=c(1537),Y=c(1630),da=c(1521);class ba{constructor(){this.eEk=new v.a;this.GVk=new v.a;this.XYk=new v.a}}Object(D.a)(ba,"RangeMarkers",null,[]);class ja{constructor(){this.colSpan=this.rowSpan=null;this.gg=!1;this.cAe=new m.a;
this.XIe=new m.a;this.qJe=new m.a}get vtf(){return this.cAe.y4()}set vtf(ma){ma||(this.cAe=new m.a);this.cAe=ma.y4()}get zOf(){return this.XIe.y4()}set zOf(ma){ma||(this.XIe=new m.a);this.XIe=ma.y4()}get l4d(){return this.qJe.y4()}set l4d(ma){ma||(this.qJe=new m.a);this.qJe=ma.y4()}}Object(D.a)(ja,"TableCellStructureInfo",null,[]);var sa=c(1572),ta=c(1617);c.d(L,"a",function(){return ra});class ra{constructor(){this.HRd=0;this.NTg=this.j$a=this.WVb=this.Lg=this.Q$g=this.oXb=null;this.C2g=0;this.k_g=
50;this.nRg=this.aLg=null}get Ece(){return this.oXb}get B1n(){return this.Q$g}get Xd(){return this.Lg}get nkb(){return this.WVb}get Agi(){return this.j$a}get Mcm(){return this.NTg}get lcc(){return this.C2g}get Ozh(){return this.aLg}get sKc(){return this.nRg}tcc(ma,Ba,Pa,Da,Ha,oa,wa){Pa=this.j5k(ma,Ba,Da,Ha,oa,wa,this.sKc);Da=0;const ia=Pa.runtime.oge;let ca=null;try{this.nZm(ia,Pa,wa,ma,Ba,Ha,oa);for(ma=1;Da<this.nkb.length;Da++)if(!(0,this.nkb[Da])(Pa)){ma=2;Pa.logger.a1d("GraphMerger.GetMergeFunctions()",
Da);break}return ca=new K(Pa.output.qM,ma)}catch(pa){const Ma=!Pa.output.timeout;Pa.output.crash=Ma;const ya=this.ENd(pa),Oa=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",Ma?"Crashed":"Timed Out",Pa.input.CIb,!!Pa.output.qM,ya);Ma?(k.a.instance.Ta(4051608,1,1,"MergeChanges Crash. [Error: {0}]",Oa),Pa.logger.Pg(Object.assign(new U,{roj:ya,dEj:!!Pa.output.qM}))):k.a.instance.Ta(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",Oa);if(Pa.output.qM)return ca=new K(Pa.output.qM,
2);throw pa;}finally{Pa.output.succeeded?this.kZm(ia,Pa,Da):Pa.output.timeout?this.mZm(Pa,Da):Pa.output.crash?Pa.output.qM?this.lZm(Pa,Da):this.jZm(Pa,Da):this.iZm(Pa,Da);Pa.logger.hZm();k.a.instance.Eia(42350232,1,Pa.output.succeeded?4:2,"MergeLogger",Pa.logger.dWl());Pa.logger.cXc.sii()&&k.a.instance.Eia(559015903,1,2,"MarkerInfo",Pa.logger.cXc.toString());if(Pa.runtime.Xb&&Pa.runtime.Xb.isFeatureEnabled(72))try{this.TVm(Pa)}catch(pa){k.a.instance.Ta(571619421,1,4,"Error logging references: {0}",
pa.toString())}this.T_m(Pa);ca.BVf|=(Pa.output.succeeded?2:1)<<2*(wa-1);if(ca)try{ca.n9e=this.Uyn(Pa)}catch(pa){k.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",pa)}}}T_m(ma){if(!ma.output.succeeded){ma=ma.output.timeout?"Timeout":ma.logger.AZi?ma.logger.AZi.zfa:"Unknown";const Ba=new N.a;x.Health.instance.recordQosError(ma,["MergeFailure"],!0,!0,!1,!1,Ba)}}TVm(ma){const Ba=Ha=>{const oa=this.FDa()-ma.input.OSa>this.lcc;if(0<this.lcc&&oa)throw k.a.instance.Ta(571619422,
1,2,"Timed out while calculating added and deleted nodes: {0}",Ha),y.a.invalidOperation(Ha);};let Pa=ma.runtime.ru.keys,Da=Ha=>ma.runtime.ru.J(Ha);this.HHf(ma,Ba,Pa,Da,"Favored");Pa=ma.runtime.zq.keys;Da=Ha=>ma.runtime.zq.J(Ha);this.HHf(ma,Ba,Pa,Da,"Unfavored");Pa=ma.runtime.Xm.keys;Da=Ha=>{const oa=ma.runtime.Xm.J(Ha);return oa?oa.om:ma.runtime.ru.J(Ha)};this.HHf(ma,Ba,Pa,Da,"Merged")}HHf(ma,Ba,Pa,Da,Ha){var oa=new m.a;const wa=new m.a;for(let ia=0;ia<Pa.length;ia++){Ba("LogAddedAndDeletedNodes");
const ca=Da(Pa.J(ia));if(4325465===ca.Nc)continue;const pa=ma.runtime.pk.J(ca.id);pa&&this.UVm(oa,wa,ca,pa)}this.LDi(wa,ia=>ma.runtime.pk.J(ia),Ba);this.LDi(oa,Da,Ba);Ba=new Sys.StringBuilder;for(Pa=0;Pa<oa.length;Pa++)Ba.append(oa.J(Pa).toString()+",");oa=new Sys.StringBuilder;for(Pa=0;Pa<wa.length;Pa++)oa.append(wa.J(Pa).toString()+",");k.a.instance.Eia(571619423,1,4,Ha+" revision: Added references",Ba.toString());k.a.instance.Eia(571619424,1,4,Ha+" revision: Deleted references",oa.toString())}UVm(ma,
Ba,Pa,Da){const Ha=Pa.Fl();for(let wa=0;wa<Ha.length;wa++){const ia=Ha[wa];if(this.$pi(ia)){var oa=this.Xd.getPropertyObjectIds(Pa,ia);this.cYm(ma,Ba,Da,ia,oa)}else this.mvi(ia)&&(oa=this.Xd.getPropertyObjectId(Pa,ia),this.bYm(ma,Ba,Da,ia,oa))}}LDi(ma,Ba,Pa){Pa("LogNestedReferences");Pa=new m.a;const Da=new u.a;for(let Ha=0;Ha<ma.length;Ha++){const oa=ma.J(Ha);this.jIf(oa,Pa,Da,Ba)}for(Ba=0;Ba<Pa.length;Ba++)ma.add(Pa.J(Ba))}jIf(ma,Ba,Pa,Da){const Ha=Da(ma);if(Ha){const wa=Ha.Fl();for(let ia=0;ia<
wa.length;ia++){var oa=wa[ia];if(this.$pi(oa)){oa=this.Xd.getPropertyObjectIds(Ha,oa);for(let ca=0;ca<oa.length;ca++)Pa.contains(oa.J(ca))||(Ba.add(oa.J(ca)),Pa.add(oa.J(ca)),this.jIf(oa.J(ca),Ba,Pa,Da))}else this.mvi(oa)&&(oa=this.Xd.getPropertyObjectId(Ha,oa),Pa.contains(oa)||(Ba.add(oa),Pa.add(oa),this.jIf(ma,Ba,Pa,Da)))}}}cYm(ma,Ba,Pa,Da,Ha){if(this.Xd.hasProperty(Pa,Da)){Pa=this.Xd.getPropertyObjectIds(Pa,Da);const oa=Pa.zG();Da=Ha.zG();for(let wa=0;wa<Ha.length;wa++)oa.contains(Ha.J(wa))||ma.add(Ha.J(wa));
for(ma=0;ma<Pa.length;ma++)Da.contains(Pa.J(ma))||Ba.add(Pa.J(ma))}else for(Ba=0;Ba<Ha.length;Ba++)ma.add(Ha.J(Ba))}bYm(ma,Ba,Pa,Da,Ha){Ha&&(this.Xd.hasProperty(Pa,Da)?(Pa=this.Xd.getPropertyObjectId(Pa,Da),Ha.equals(Pa)||(ma.add(Ha),Ba.add(Pa))):ma.add(Ha))}gZm(ma){k.a.instance.Ta(4535064,1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",ma.input.CIb,ma.output.crash,ma.output.timeout)}nZm(ma,Ba,Pa,Da,Ha,oa,wa){if(ma){ma=Da.length?Da.$f(Da.length-1):null;var ia=Ha.length?Ha.$f(Ha.length-
1):null;Pa=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",Ba.input.CIb,Da.length,ma?ma.id:z.a.nil,ma?ma.AW?ma.AW.id:z.a.nil:z.a.nil,Ha.length,ia?ia.id:z.a.nil,ia?ia.AW?ia.AW.id:z.a.nil:z.a.nil,oa,wa,this.lcc,Pa);switch(Ba.input.source){case 5:k.a.instance.Ta(51663493,1,4,Pa);break;default:k.a.instance.Ta(4051606,
1,4,Pa)}}}kZm(ma,Ba,Pa){if(ma)switch(ma=this.OMc(Ba,Pa,"Succeeded"),Ba.input.source){case 5:k.a.instance.Ta(51663494,1,4,ma);break;default:k.a.instance.Ta(4059162,1,4,ma)}}mZm(ma,Ba){Ba=this.OMc(ma,Ba,"Timeout");switch(ma.input.source){case 5:k.a.instance.Ta(51663495,1,4,Ba);break;default:k.a.instance.Ta(4059163,1,2,Ba)}}iZm(ma,Ba){Ba=this.OMc(ma,Ba,"Rejection");switch(ma.input.source){case 5:k.a.instance.Ta(51663496,1,4,Ba);break;default:k.a.instance.Ta(4059164,1,2,Ba)}}lZm(ma,Ba){Ba=this.OMc(ma,
Ba,"Crash - Rejection");switch(ma.input.source){case 5:k.a.instance.Ta(51663497,1,4,Ba);break;default:k.a.instance.Ta(4059165,1,2,Ba)}}jZm(ma,Ba){Ba=this.OMc(ma,Ba,"Crash - Failed");switch(ma.input.source){case 5:k.a.instance.Ta(51663498,1,4,Ba);break;default:k.a.instance.Ta(4059166,1,2,Ba)}}OMc(ma,Ba,Pa){const Da=ma.output.qM,Ha=Da&&Da.length?Da.$f(Da.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",
ma.input.CIb,Pa,this.FDa()-ma.input.OSa,Ba,Da?Da.length:0,Ha?Ha.id:z.a.nil,Ha?Ha.AW?Ha.AW.id:z.a.nil:z.a.nil,ma.input.source)}j5k(ma,Ba,Pa,Da,Ha,oa,wa){const ia=new W.a,ca=ia.input;ca.x9=ma;ca.TTa=Ba;ca.Zm=Pa;ca.$ga=Da;ca.bFb=Ha;ca.source=oa;ca.sKc=wa;ca.OSa=this.FDa();ia.logger.jgo(ca.OSa);ma=ia.runtime;ma.D6c=k.a.instance.o9(1,5);ma.oge=k.a.instance.o9(1,4);let pa="";ma.xG=Ma=>{if(this.lcc){var ya=this.FDa()-ca.OSa,Oa=ya>this.lcc;pa+=String.format(" ({0}: {1})",Ma,ya);Oa&&(ia.output.timeout=!0,
Ma=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",ca.CIb,this.lcc,Ma,ya,pa),k.a.instance.Ta(528061012,1,2,Ma),this.$Bo(Ma))}};return ia}ANc(){return[Object(H.a)(this,this.Kqn,"otherAuthorsHaveChangesToMerge"),Object(H.a)(this,this.sEm,"isInputValid"),Object(H.a)(this,this.wrm,"initializeOutputMergeState"),Object(H.a)(this,this.HUd,"initializeRuntimeMergeState"),Y.a.Ayn,Object(H.a)(this,this.zyn,"preProcessTableStructure"),
Object(H.a)(this.Ozh,this.Ozh.L6m,"mergeChildNodeLists"),Object(H.a)(this,this.KHo,"tryObjectMerge"),Y.a.jyn,Object(H.a)(this,this.pul,"finalizeObjectMerge"),Object(H.a)(this,this.PUo,"validateMarkers"),Object(H.a)(this,this.omk,"addMergeResultsToOutput")]}Kqn(ma){const Ba=ma.input.x9;ma=ma.output;return Ba?Ba.length?!0:(k.a.instance.Ta(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),ma.qM=Ba,ma.succeeded=!0,!1):(k.a.instance.Ta(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),
ma.qM=Ba,ma.succeeded=!0,!1)}sEm(ma){var Ba=ma.input;const Pa=Ba.x9,Da=Ba.TTa,Ha=Ba.Zm,oa=Ba.$ga;Ba=Ba.bFb;ma=ma.output;if(!Da||!Da.length)return k.a.instance.Ta(42350233,1,5,"IsInputValid: No local changes to merge."),ma.qM=Pa,ma.succeeded=!0,!1;let wa=!0;if(2!==oa&&1!==oa)return ma.qM=Pa,!1;Ha&&Ha!==z.a.nil||(wa=!1);Pa.length<(Ba?2:1)&&(k.a.instance.Ta(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",
Ba),wa=!1);wa||(ma.qM=2===oa?Pa:Da);return wa}HUd(ma){var Ba=ma.input,Pa=Ba.x9,Da=Ba.TTa,Ha=Ba.$ga,oa;let wa;({Pfg:oa,Bmg:wa,tCa:Ba}=this.Wof(ma,Pa,Da,Ba.bFb));if(!Ba)return k.a.instance.Ta(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",oa.id,wa.id),ma.logger.Pg(Object.assign(new I.a,{pj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.iEi(oa,Pa.length,"TheirChanges"),this.iEi(wa,Da.length,
"YourChanges"),ma.output.qM=2===Ha?Pa:Da,!1;ma.runtime.tCa=Ba;({qJo:Pa,rsl:Da}=this.Sel(Ha,oa,wa));({rJo:Ba,ssl:Ha,wCk:oa}=this.BWl(ma,Pa,Da,Ba));ma.runtime.pk=oa;ma.runtime.zq=Ba;ma.runtime.ru=Ha;ma.runtime.Xm=new v.a;ma.runtime.gKd=Da.id;ma.runtime.tle=Pa.id;ma.runtime.Hkb=new v.a;ma.runtime.PMa=new u.a;ma.runtime.fbf=new v.a;ma.runtime.Nzb=new v.a;ma.runtime.Aeg=new v.a;ma.runtime.yae=new ba;ma.runtime.z2d=new m.a;ma.runtime.SUf=new u.a;ma.runtime.Wic=new m.a;ma.runtime.Xb=ma.input.sKc(ma);ma.runtime.Xb.DCc(1000001,
"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",l.a.VAo);ma.runtime.Xb.DCc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",l.a.bDo);ma.runtime.Xb.DCc(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",l.a.$rl);ma.runtime.Xb.DCc(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",l.a.KSn);ma.runtime.Xb.DCc(1000010,"Microsoft.Office.WordOnline.MergeLcsInfLoopFix",
"79ee6190;i588c310",l.a.Z6m);ma.runtime.Vmi=!0;E.AFrameworkApplication.K&&(this.k_g=E.AFrameworkApplication.K.pc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}iEi(ma,Ba,Pa){const Da=new m.a;for(;ma;)Da.add(ma),ma=ma.AW;const Ha=new Sys.StringBuilder;Ha.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",Pa,Ba,Da.length));let oa=Da.length,wa=0;Da.forEach(ia=>({Dki:oa,IEi:wa}=this.dok(Ha,ia,Da,oa,wa)).returnValue);k.a.instance.Ta(4273302,1,4,Ha.toString())}dok(ma,
Ba,Pa,Da,Ha){ma.append(String.format(" [{0} {1} {2}]",Da,Ba.kwa?"S":"B",Ba.id));Da--;Ha++;return 50<Ha&&Pa.length!==Ha?(ma.append(" ...Truncated."),{returnValue:!1,Dki:Da,IEi:Ha}):{returnValue:!0,Dki:Da,IEi:Ha}}Wof(ma,Ba,Pa,Da){Ba=Ba.$f(Ba.length-1-(Da?1:0));Pa=Pa.$f(Pa.length-1);Da=Ba.$_a(Pa);ma.runtime.xG("GetCommonBase");ma.logger.Qga("GetCommonBase");return{Pfg:Ba,Bmg:Pa,tCa:Da}}BWl(ma,Ba,Pa,Da){let Ha,oa;({result:Ha}=Ba.ucc(Da));ma.runtime.xG("GetUnfavoredChanges");ma.logger.Qga("GetUnfavoredChanges");
({result:oa}=Pa.ucc(Da));5===ma.input.source&&(ma.runtime.vsl=M.a.abi(Pa),ma.runtime.tJo=M.a.abi(Ba));ma.runtime.xG("GetFavoredChanges");ma.logger.Qga("GetFavoredChanges");Ba=new F.a(Object(H.a)(Da,Da.x0a,"getMergeableObject"));ma.runtime.xG("GetModifiedObjects");ma.logger.Qga("GetModifiedObjects");return{rJo:Ha,ssl:oa,wCk:Ba}}Sel(ma,Ba,Pa){2===ma?(ma=Ba,Ba=Pa):ma=Pa;return{qJo:Ba,rsl:ma}}wrm(ma){const Ba=ma.input,Pa=Ba.x9,Da=Ba.TTa;ma.output.qM=(2===Ba.$ga?Pa:Da).y4();ma.runtime.xG("InitializeOutputMergeState");
ma.logger.Qga("InitializeOutputMergeState");return!0}omk(ma){var Ba=ma.input.Zm;const Pa=ma.runtime.Xm,Da=ma.output.qM;Ba=this.k5k(ma,Da.$f(Da.length-1),Ba,z.a.create());this.Jtl(ma,Ba,Pa);Da.add(Ba);return ma.output.succeeded=!0}k5k(ma,Ba,Pa,Da){ma.runtime.oge&&k.a.instance.Ta(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",Pa,Da);ma=this.B1n(Da);ma.UCk(Ba,Pa);return ma}Jtl(ma,Ba,Pa){ma.runtime.oge&&k.a.instance.Ta(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",
Pa.count);Pa.forEach((Da,Ha)=>{Ba.Hnk(Ha.om);return!0})}aHb(ma){if(!ma)return k.a.instance.Ta(573957952,1,2,"Feature helper is null"),!1;ma.pB(104);return ma.isFeatureEnabled(104)}zyn(ma){if(!this.aHb(ma.runtime.Xb))return!0;const Ba=ma.runtime.ru,Pa=ma.runtime.zq,Da=ma.runtime.pk;let Ha=!0;Ba.forEach((oa,wa)=>{393252===wa.Nc&&(Ha=this.hXi(ma,oa,wa,Da,Ba));return Ha});if(!Ha)return!1;Pa.forEach((oa,wa)=>{393252===wa.Nc&&(Ha=this.hXi(ma,oa,wa,Da,Pa));return Ha});ma.logger.Qga("PreProcessTableStructure");
return Ha}hXi(ma,Ba,Pa,Da,Ha){const oa=null==this.Xd.getPropertyBool(Pa,e.a.ghostCell)?!1:this.Xd.getPropertyBool(Pa,e.a.ghostCell),wa=null==this.Xd.getPropertyUint32(Pa,e.a.rowSpan)?1:this.Xd.getPropertyUint32(Pa,e.a.rowSpan),ia=null==this.Xd.getPropertyUint32(Pa,e.a.colSpan)?1:this.Xd.getPropertyUint32(Pa,e.a.colSpan);if(oa)return!0;var ca=Da.J(Ba);if(ca){Da=null==this.Xd.getPropertyBool(ca,e.a.ghostCell)?!1:this.Xd.getPropertyBool(ca,e.a.ghostCell);var pa=null==this.Xd.getPropertyUint32(ca,e.a.rowSpan)?
1:this.Xd.getPropertyUint32(ca,e.a.rowSpan);var Ma=null==this.Xd.getPropertyUint32(ca,e.a.colSpan)?1:this.Xd.getPropertyUint32(ca,e.a.colSpan);Da=Da!==oa;pa=pa!==wa;Ma=Ma!==ia}else Ma=pa=Da=!0;const ya=ta.e(ma,Pa,Ha);if(ya.equals(z.a.nil))return k.a.instance.Ta(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",Ba),ma.logger.Pg(Object.assign(new sa.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let Oa=ma.runtime.Nzb.J(ya);Oa||(ma.runtime.Nzb.Z(ya,
new v.a),Oa=ma.runtime.Nzb.J(ya));let fa=Oa.J(Ba),Ca=new m.a;const Ta=new m.a,eb=new m.a;Da&&(fa||(Ca=this.Xd.getPropertyObjectIds(Pa,a.a.gf)));if(pa||Ma)if(fa){if(fa.gg)return k.a.instance.Ta(573957961,1,4,"Table cell has conflicting ghostcell properties we are not handling"),ma.logger.Pg(Object.assign(new sa.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),!1;if(null!=fa.rowSpan&&wa!==fa.rowSpan||null!=fa.colSpan&&ia!==fa.colSpan)return k.a.instance.Ta(573957962,1,
4,"Same table cell has different rowSpan/colSpan in conflicting revisions"),ma.logger.Pg(Object.assign(new sa.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),!1}else{var jb;({rowIndex:Pa,O1b:jb}=ta.b(ma,Ha,Pa));if(-1===Pa||-1===jb)return k.a.instance.Ta(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",Ba),ma.logger.Pg(Object.assign(new sa.a,{info:"Table cell location could not be found"})),!1;for(var ob=Pa;ob<Pa+wa;ob++)for(var Ya=jb;Ya<
jb+ia;Ya++){var Xa=ta.c(ma,ya,ob,Ya);if(Xa.equals(z.a.nil))return k.a.instance.Ta(573957955,1,4,"Other revision deleted the table cells this revision is trying to merge"),ma.logger.Pg(Object.assign(new sa.a,{info:"Ghost cell not found in the table bounds"})),!1;var Sa=Ha.Wy(Xa,ma.runtime.pk.J(Xa));if(!Sa)return k.a.instance.Ta(573957956,1,4,"Other revision has inserted cells in between the cells this revision is trying to merge"),ma.logger.Pg(Object.assign(new sa.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),
!1;if(!Xa.equals(Ba)){if(null==this.Xd.getPropertyBool(Sa,e.a.ghostCell)||!this.Xd.getPropertyBool(Sa,e.a.ghostCell))return k.a.instance.Ta(573957957,1,4,"Other revision deleted some of the cells this revision is trying to merge"),ma.logger.Pg(Object.assign(new sa.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var ab=Oa.J(Xa);if(ab)return k.a.instance.Ta(573957958,1,4,"The ghost cell is already merged with some other cells in the other revision"),ma.logger.Pg(Object.assign(new sa.a,
{info:"Ghost cell is already merged with some other cell"})),!1;Ta.add(Xa);ab=new ja;ab.gg=!0;Sa=this.Xd.getPropertyUint32(Sa,e.a.colSpan);null!=Sa&&(ab.colSpan=Sa);Oa.Z(Xa,ab)}}if(ca&&(null==this.Xd.getPropertyBool(ca,e.a.ghostCell)||!this.Xd.getPropertyBool(ca,e.a.ghostCell))&&(Ha=null==this.Xd.getPropertyUint32(ca,e.a.rowSpan)?1:this.Xd.getPropertyUint32(ca,e.a.rowSpan),Pa=null==this.Xd.getPropertyUint32(ca,e.a.colSpan)?1:this.Xd.getPropertyUint32(ca,e.a.colSpan),Ha>wa||Pa>ia)){ob=jb=-1;({rowIndex:jb,
O1b:ob}=ta.a(ma,null,ca,jb,ob));if(-1===jb||-1===ob)return k.a.instance.Ta(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",Ba),ma.logger.Pg(Object.assign(new sa.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;ca=Ta.zG();for(Ya=jb;Ya<jb+Ha;Ya++)for(Xa=ob;Xa<ob+Pa;Xa++){ab=ta.d(ma,null,ya,Ya,Xa);if(!ab)return k.a.instance.Ta(573957960,1,2,"Table cell could not be found within table bounds"),ma.logger.Pg(Object.assign(new sa.a,
{info:"Ghost cell not found in the table bounds"})),!1;ab.id.equals(Ba)||ca.contains(ab.id)||eb.add(ab.id)}}}!fa&&(Da||pa||Ma)&&(k.a.instance.Ta(573957963,1,4,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",Ba),fa=new ja,fa.rowSpan=wa,fa.colSpan=ia,fa.gg=oa,fa.l4d=Ca,fa.vtf=Ta,fa.zOf=eb,Oa.add(Ba,fa));return!0}KHo(ma){return this.iwj(ma,!1)}pul(ma){return this.iwj(ma,!0)}iwj(ma,Ba){const Pa=ma.runtime,Da=Pa.pk,Ha=Pa.ru,oa=Ba?Pa.fbf:Pa.zq,wa=Pa.Xm;let ia=
!0;const ca=ma.runtime.D6c;let pa=0,Ma=0,ya=0;oa.forEach((Oa,fa)=>{ca&&k.a.instance.Ta(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",Oa,fa.Nc,Ba);Ma++;this.k_g===Ma&&(pa++,ma.runtime.xG(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",pa,ya,Ba)),Ma=0);if(ma.runtime.Xb&&ma.runtime.Xb.lhb(1000005)&&ma.runtime.Wic.contains(fa.id,(eb,jb)=>eb.equals(jb))||this.Ero(fa.Nc))return!0;if(!Ba&&this.xbl(fa.Nc,ma.runtime.Xb))return Pa.fbf.Z(Oa,fa),!0;var Ca=
Ha.get(Oa);if(!Ca)return wa.ob(Oa)?wa.J(Oa).QHi(fa):wa.Z(Oa,new da.a(fa,!1)),!0;if(!Da.J(Oa)&&!this.A7m(Ca.Nc)){var Ta=!!ma.input.x9&&!!ma.input.x9.last()&&ma.input.x9.last().C3(Oa);const eb=!!ma.input.TTa&&!!ma.input.TTa.last()&&ma.input.TTa.last().C3(Oa),jb=new V.a(Ca,fa);if(!jb.JX)return wa.Z(Oa,new da.a(Ca,!1)),!0;k.a.instance.Ta(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",
Oa,fa.Nc,Ba,Ta,eb,!jb.JX,ma.input.source);ma.logger.Pg(Object.assign(new I.a,{pj:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));return ia=!1}Ta=wa.Wy(Oa,new da.a(Da.J(Oa)));({Sk:Ca,returnValue:ia}=this.Mcm.merge(ma,this.Agi,this.Xd,Ta,Ca,fa));ya++;ia&&(ma.runtime.xG(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",Oa,fa.Nc,ya,pa,Ba)),Ca&&(wa.ob(Ca.om.id)?wa.J(Ca.om.id).QHi(Ca.om):wa.Z(Ca.om.id,Ca)));return ia});ma.logger.Qga("ObjectMerge");ca&&
k.a.instance.Ta(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",oa.count,ya,Ba);return ia}PUo(ma){try{for(let Ba=0;Ba<ma.runtime.z2d.length;Ba++){const Pa=ma.runtime.z2d.J(Ba);if(ma.runtime.Xm.J(Pa)){if(!this.CFm(ma,Pa))return!1}else k.a.instance.Ta(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");ma.runtime.xG("Validate markers taking too long")}}catch(Ba){k.a.instance.Ta(559535579,1,2,"ValidateMerge threw an exception: {0}",Ba)}return ma.logger.cXc.sii()?
!1:!0}Lmo(ma){return 38===ma||39===ma||40===ma||41===ma||44===ma||45===ma||33===ma||34===ma?!1:!0}PVl(ma){switch(ma){case 38:case 39:case 40:case 41:return e.a.le;case 44:case 45:return e.a.xAd;case 33:case 34:return e.a.Tj}return J.CommonProperties.nil}OUo(ma,Ba){const Pa=this.Xd.getPropertyUint32(ma,e.a.Rs);if(!Pa||this.Lmo(Pa))return!0;ma=this.Xd.getPropertyObjectId(ma,this.PVl(Pa));return ra.x6b(Ba,ma)?!0:(Ba.logger.cXc.pVd=Pa,!1)}CFm(ma,Ba){if(ma.runtime.SUf.contains(Ba))return!1;if(Ba=ra.x6b(ma,
Ba)){Ba=this.Xd.getPropertyObjectIds(Ba,a.a.En);for(let Pa=0;Pa<Ba.length;Pa++){const Da=ra.x6b(ma,Ba.$f(Pa));if(Da&&!this.OUo(Da,ma))return!1}}return!0}Ero(ma){switch(ma){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}xbl(ma,Ba){let Pa=!1;if(1074135145===ma)return!0;Ba&&Ba.pB(123);Ba&&Ba.isFeatureEnabled(123)&&1074135153===ma&&(Pa=!0);return Pa}A7m(ma){switch(ma){case 1074135162:return!0}return!1}w7k(ma,Ba){const Pa=new m.a,Da=new m.a,Ha=
new m.a;var oa=ma.runtime.tCa;const wa=oa?oa.id:z.a.nil;this.hHf(oa).forEach(ia=>{Pa.add(Ba(ia));return!0});oa=ma.input.x9.$f(ma.input.x9.length-1);this.hHf(oa,wa).forEach(ia=>{Da.add(Ba(ia));return!0});ma=ma.input.TTa.$f(ma.input.TTa.length-1);this.hHf(ma,wa).forEach(ia=>{Ha.add(Ba(ia));return!0});return{uCk:Pa,BBo:Da,V_o:Ha}}hHf(ma,Ba=null){const Pa=new m.a;Ba||(Ba=z.a.nil);for(;ma&&!Ba.equals(ma.id);)Pa.add(ma),ma=ma.AW;Pa.reverse();return Pa}Jxo(ma){const Ba=3===this.HRd;let Pa=!1;!ma.output.succeeded&&
(2===this.HRd||ma.output.crash&&1===this.HRd)&&(Pa=!0);let Da=!1;ma.input.x9&&0<ma.input.x9.length&&(Ba||Pa)&&ma.runtime.ru&&ma.runtime.pk&&ma.runtime.Xb&&(Da=ma.runtime.Xb.isFeatureEnabled(49));return Da}$pi(ma){return 9===P.a.aEb(P.a.Tjf(ma))}mvi(ma){return 8===P.a.aEb(P.a.Tjf(ma))}static zQl(ma){return ma.output.crash?2:ma.output.succeeded?3:1}static x6b(ma,Ba){if(!Ba||Ba===z.a.nil)return null;const Pa=ma.runtime.Xm.J(Ba);return Pa?Pa.om:ma.runtime.pk.J(Ba)}}ra.GRd=z.a.Gf("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");
Object(D.a)(ra,"GraphMergerBase",null,[1588])},1758:function(D,L,c){D=c(0);var l=c(231),e=c(1615),a=c(160),k=c(1532);class x extends e.a{constructor(m,u,z,v,E,F,J,K,H,P,N,M,I,T){super(m,3,u,z,v,E,F,K,H,P,N,M,I,T);this.Xse=J}get character(){return this.Xse}get text(){return this.character.toString()}g6c(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}W5b(){return"CharRun"}clone(){return new x(this.VCc,this.source,this.Fj,this.wg,this.runId,this.JI,this.character,
this.Ekb,this.IPa,this.Vaa,this.hEa,this.vRa,this.fF,this.Kt)}hA(m,u,z,v=!1){return super.hA(m,u,z,v)?m.character===this.character?!0:k.a.Zqh(m.character,this.character):!1}}Object(D.a)(x,"CharRunMergeBlock",e.a,[]);c.d(L,"a",function(){return y});class y extends e.a{constructor(m,u,z,v,E,F,J,K,H,P,N,M,I,T,U){super(m,1,u,z,v,E,F,K,P,N,M,I,T,U);this._text=J;this.ORe=H}get text(){return this._text}g6c(m){this._text=m}get v6a(){return this.ORe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",
super.toString(),this.ORe)}W5b(){return"TextRun"}clone(){return new y(this.VCc,this.source,this.Fj,this.wg,this.runId,this.JI,this._text,this.Ekb,this.ORe,this.IPa,this.Vaa,this.hEa,this.vRa,this.fF,this.Kt)}hA(m,u,z,v=!1){return super.hA(m,u,z,v)?k.a.Yqh(this._text,m._text):!1}x7c(){const m=new l.a;for(let z=0;z<this.text.length;z++){var u=k.a.charAt(this._text,z);if(k.a.SKm(k.a.NCo(u))){let v="";v+=u;u=k.a.charAt(this._text,++z);v+=u;u=new y(this.VCc,this.source,this.Fj,this.wg,this.runId,this.JI,
v,this.Ekb,!1,this.IPa,this.Vaa,this.hEa,this.vRa,this.fF,this.Kt);m.add(u)}else u=new x(this.VCc,this.source,this.Fj,this.wg,this.runId,this.JI,u,this.Ekb,this.IPa,this.Vaa,this.hEa,this.vRa,this.fF,this.Kt),m.add(u)}return m}}Object(D.a)(y,"TextRunMergeBlock",e.a,[])},1759:function(D,L,c){D=c(0);var l=c(1007),e=c(17),a=c(394),k=c(231);c(60);c(805);var x=c(627),y=c(177),m=c(160),u=c(1029),z;(function(K){K[K.none=0]="none";K[K.browser=1]="browser";K[K.serverPutChanges=2]="serverPutChanges";K[K.syncDiff=
3]="syncDiff";K[K.docxMerge=4]="docxMerge";K[K.undo=5]="undo"})(z||(z={}));Object(D.b)("GraphMergeSource",z);var v=c(1747),E=c(1547),F=c(1741);c.d(L,"a",function(){return J});class J{constructor(K){this.MA=new u.a;this.MV=new a.a;this.qfh=new a.a(0);this.Bcd=new k.a;this.XUg=new k.a;this.M3g=new k.a;this.d1g=new k.a;this.W2g="";this.lVa=null;this.Mr=this.aGe=0;this.ypd=new a.a(0);this.xye=this.k7g=this.fmd=0;const {MarkerValidation:H}=c(1858);this._state=K;this.H4j=new H}get cXc(){return this.H4j}get AZi(){return this.lVa}jgo(K){this.aGe=
K}a1d(K,H){this.W2g=String.format("{0}-{1}",K,H)}cfe(K){this.WQk();this.xye=K}Y8f(){this.xye=0}WQk(){this.lVa&&this.Bcd.add(this.lVa);this.lVa=null}Pg(K){this.lVa||(this.lVa=K);switch(this.xye){case 1:this.XUg.add(K);break;case 2:this.M3g.add(K);break;case 3:this.d1g.add(K);break;default:this.lVa&&this.Bcd.add(K)}}NCi(K){this.Bcd.add(K)}hZm(){this.Mr=this.FDa();this.Qga("MergeEnd")}Qga(K){const H=this.FDa();this.qfh.Z(K,H-this.aGe);this.aGe=H}keo(){this.fmd=this.FDa();this.k7g++}kU(K){const H=this.FDa();
let P;({value:P}=this.ypd.Ec(K)).returnValue?(P+=H-this.fmd,this.ypd.Z(K,P)):this.ypd.Z(K,H-this.fmd);this.fmd=H}dWl(){this.MV.Z("Id",this._state.input.CIb.toString());this.MV.Z("Source",z[this._state.input.source]);this.MV.Z("RevSummary",J.RTa(this.r3l()));this.MV.Z("NodesRolledBackIfFailed",J.RTa(this.gYl()));if(!this._state.output.succeeded){let K,H,P,N,M;({xCk:K,tsl:H,sJo:P,CCk:N,uJo:M}=this.uul(this._state.runtime));this.MV.Z("CharactersLost",this.VHl(K,H,P));this.MV.Z("CharactersLostInComments",
this.ZIl());this.MV.Z("CharactersLostInTables",this.AEl(M,N))}this.MV.Z("FuncStep",this.W2g);this.MV.Z("FailureDetail",J.RTa(this.eDb()));this.MV.Z("FailDetailHints",this.GNd(this.XUg));this.MV.Z("FailDetailNaiveMerge",this.GNd(this.M3g));this.MV.Z("FailDetailLcs",this.GNd(this.d1g));this.MV.Z("ExtraDetails",this.GNd(this.Bcd));this.MV.Z("Timeline",J.RTa(this.qfh));this.MV.Z("ParagraphMergesCount",this.k7g);this.MV.Z("ParagraphMergeDurations",J.RTa(this.ypd));this.MV.Z("MarkerInfo",J.RTa(this.cXc.I3h()));
this.MV.Z("Result",J.RTa(this.fWl()));return JSON.stringify(J.RTa(this.MV))}FDa(){return(new Date).getTime()}r3l(){const K=new a.a;let H,P,N;({Pfg:H,Bmg:P,tCa:N}=this.Wof(this._state,this._state.input.x9,this._state.input.TTa,this._state.input.bFb));K.Z("hasBase",N?"true":"false");if(N){let M=0,I=0;for(;H&&!H.id.equals(N.id);)M++,H=H.AW;for(;P&&!P.id.equals(N.id);)I++,P=P.AW;K.Z("lenToBaseTheirs",H?M:-1);K.Z("lenToBaseYours",P?I:-1)}return K}Wof(K,H,P,N){K=H.$f(H.length-1-(N?1:0));H=(P=P.$f(P.length-
1))&&K?K.$_a(P):null;return{Pfg:K,Bmg:P,tCa:H}}gYl(){if(!this._state.runtime.Vmi)return null;const K=this._state.runtime.zq,H=new a.a(0);K.forEach((P,N)=>{({value:P}=H.Ec(N.Nc.toString()));H.Z(N.Nc.toString(),P+1);return!0});return H}VHl(K,H,P){let N=null,M=null,I=null;const T=this._state.runtime.zq;let U=0;try{I=new F.a(this.MA,this._state);N=E.b(K,H,P);M=new x.a;for(K=0;K<N.length;K++)if(!N.J(K).Gyb.Sp(N.J(K).epb,(W,V)=>W.equals(V))){const W=this.VNh(N.J(K),I);U+=W;M.add(N.J(K))}N&&T.forEach((W,
V)=>{if(393230===V.Nc){V=null;for(let Y=0;Y<N.length;Y++)if(!M.contains(N.J(Y))&&N.J(Y).epb.contains(W,(da,ba)=>da===ba)){V=N.J(Y);break}V&&(W=this.VNh(V,I),M.add(V),U+=W)}return!0});return U}catch(W){return y.a.instance.Ta(579190992,1,2,"Exception in GetCharactersLost: "+W.toString()),-1}}uul(K){let H,P,N,M,I;K.xG=U=>{if(750<this.FDa()-this._state.input.OSa)throw y.a.instance.Ta(579190991,1,2,"Timed out while calculating characters lost: {0}",U),m.a.invalidOperation(U);};H=new k.a;P=new k.a;N=new k.a;
M=new k.a;const T=new k.a;I=new k.a;try{if(K.pk){const U=K.pk.J(v.ChildNodeListMerge.w7d);let W,V;W=K.ru.J(v.ChildNodeListMerge.w7d)||U;V=K.zq.J(v.ChildNodeListMerge.w7d)||U;this.Ihf(U,Y=>K.pk.J(Y),H,M);this.Ihf(W,Y=>K.ru.J(Y)||K.pk.J(Y),P,T);this.Ihf(V,Y=>K.zq.J(Y)||K.pk.J(Y),N,I)}}catch(U){y.a.instance.Ta(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+U.toString())}return{xCk:H,tsl:P,sJo:N,CCk:M,uJo:I}}AEl(K,H){try{let N=0;const M=this._state.runtime;var P=U=>M.zq.J(U)||M.pk.J(U);const I=
new x.a,T=this.fwl(K,M,P,I);for(K=0;K<T.count;K++){let U=T.keys.J(K);const W=T.J(U);if(!I.contains(U)){let V=this.mdi(M,P,I,U,W);if(-1!==V)N+=V;else return y.a.instance.Ta(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(P=0;P<H.length;P++){let U=H.J(0);if(!I.contains(U)){let W=this.YQd(M.pk.J(U));if(-1===W)return y.a.instance.Ta(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;N+=W}}return N}catch(N){return y.a.instance.Ta(573089735,
1,2,"Exception in GetAllTablesCharactersLost: "+N.toString()),-1}}mdi(K,H,P,N,M){K.xG("GetTableCharactersLost");let I=0;M=this.MA.getPropertyObjectIds(M,e.a.gf);for(let Y=0;Y<M.length;Y++){var T=H(M.J(Y));T=this.MA.getPropertyObjectIds(T,e.a.gf);for(let da=0;da<T.length;da++){var U=H(T.J(da));if(K.pk.J(M.J(Y))&&K.pk.J(T.J(da))){var W=K.pk.J(T.J(da));if(!W)return y.a.instance.Ta(573089737,1,2,"Base cell unexpectedly null"),-1;U=this.MA.getPropertyObjectIds(W,e.a.gf);var V=K.ru.J(T.J(da))||K.pk.J(T.J(da));
V=this.MA.getPropertyObjectIds(V,e.a.gf);W=this.MA.getPropertyObjectIds(W,e.a.gf);U=E.b(U,V,W);for(W=0;W<U.length;W++){V=U.J(W);const ba=this.Y7l(K,H,P,V);if(-1===ba)return y.a.instance.Ta(573089738,1,2,"Error getting characters lost for parition {0}",V.toString()),-1;I+=ba}}else{W=this.H8l(H,U,P);if(-1===W)return y.a.instance.Ta(573089736,1,2,"Error getting text length of cell {0}",U.id.toString()),-1;I+=W}}}P.add(N);return I}Y7l(K,H,P,N){let M=0;var I=new k.a,T=new k.a;const U=new a.a;new a.a;for(var W=
0;W<N.Gyb.length;W++){var V=K.pk.J(N.Gyb.J(W));V=this.MA.getPropertyObjectIds(V,e.a.mK);if(1!==V.length)return y.a.instance.Ta(573089739,1,2,"Unexpected number of ContentNodes: {0}",V.length),-1;var Y=K.pk.J(V.J(0));393230===Y.Nc?I.add(Y):393250===Y.Nc&&U.add(V.J(0),Y)}for(W=0;W<N.epb.length;W++){V=H(N.epb.J(W));V=this.MA.getPropertyObjectIds(V,e.a.mK);if(1!==V.length)return y.a.instance.Ta(573089740,1,2,"Unexpected number of ContentNodes: {0}",V.length),-1;Y=H(V.J(0));if(393230===Y.Nc)T.add(Y);else if(393250===
Y.Nc){Y=this.mdi(K,H,P,V.J(0),Y);if(-1===Y)return y.a.instance.Ta(573089741,1,2,"Error diffing table {0}",V.J(0).toString()),-1;M+=Y}}W=new F.a(this.MA,this._state);if(0<I.length&&0<T.length){I=W.WVh(I,da=>K.pk.J(da),T,da=>H(da));if(-1===I)return y.a.instance.Ta(573089742,1,2,"Problem diffing parition {0} with LCS",N.toString()),-1;M+=I}else if(0<I.length)for(N=0;N<I.length;N++)M+=this.MA.getPropertyString(I.J(N),e.a.yo).length+1;else if(0<T.length)for(N=0;N<T.length;N++)M+=this.MA.getPropertyString(T.J(N),
e.a.yo).length+1;for(N=0;N<U.count;N++)if(I=U.keys.J(N),!P.contains(I)){T=this.YQd(U.J(I));if(-1===T)return y.a.instance.Ta(573089743,1,2,"Error getting length of table {0}",I.toString()),-1;M+=T}return M}H8l(K,H,P){let N=0;H=this.MA.getPropertyObjectIds(H,e.a.gf);for(let T=0;T<H.length;T++){var M=K(H.J(T));M=this.MA.getPropertyObjectIds(M,e.a.mK);if(1!==M.length)return y.a.instance.Ta(573089744,1,2,"Unexpected number of ContentNodes: {0}",M.length),-1;var I=K(M.J(0));if(393230===I.Nc)N+=this.MA.getPropertyString(I,
e.a.yo).length+1;else if(393250===I.Nc){I=this.YQd(I);if(-1===I)return y.a.instance.Ta(573089745,1,2,"Problem finding text length of table {0}",M.J(0).toString()),-1;N+=I;P.add(M.J(0))}}return N}YQd(K){this._state.runtime.xG("GetTextLengthOfTable");let H=0;const P=U=>this._state.runtime.zq.J(U)||this._state.runtime.pk.J(U);K=this.MA.getPropertyObjectIds(K,e.a.gf);for(let U=0;U<K.length;U++){var N=P(K.J(U));N=this.MA.getPropertyObjectIds(N,e.a.gf);for(let W=0;W<N.length;W++){var M=P(N.J(W));M=this.MA.getPropertyObjectIds(M,
e.a.gf);for(let V=0;V<M.length;V++){var I=P(M.J(V));I=this.MA.getPropertyObjectIds(I,e.a.mK);if(1!==I.length)return y.a.instance.Ta(573089746,1,2,"Unexpected number of ContentNodes: {0}",I.length),-1;var T=P(I.J(0));if(393230===T.Nc)H+=this.MA.getPropertyString(T,e.a.yo).length+1;else if(393250===T.Nc){T=this.YQd(T);if(-1===T)return y.a.instance.Ta(573089747,1,2,"Error finding the text length of table {0}",I.J(0)),-1;H+=T}}}}return H}fwl(K,H,P,N){const M=new a.a;for(let I=0;I<K.length;I++){let T=
!1;H.zq.J(K.J(I))&&(T=!0);const U=P(K.J(I)),W=this.MA.getPropertyObjectIds(U,e.a.gf);if(!T)for(let V=0;V<W.length;V++)if(H.zq.J(W.J(V))){T=!0;break}T?M.add(K.J(I),U):N.add(K.J(I))}return M}VNh(K,H){return this.UNh(K.Gyb,K.epb,H)}UNh(K,H,P){const N=new k.a;for(var M=0;M<K.length;M++)N.add(this._state.runtime.pk.J(K.J(M)));K=new k.a;for(M=0;M<H.length;M++)K.add(this._state.runtime.zq.J(H.J(M))||this._state.runtime.pk.J(H.J(M)));return P.WVh(N,I=>this._state.runtime.pk.J(I),K,I=>this._state.runtime.zq.J(I)||
this._state.runtime.pk.J(I))}Ihf(K,H,P,N){if(393227===K.Nc){K=this.MA.getPropertyObjectIds(K,e.a.gf);for(let M=0;M<K.length;M++){const I=this.MA.getPropertyObjectIds(H(K.J(M)),e.a.gf);for(let T=0;T<I.length;T++){const U=this.MA.getPropertyObjectIds(H(I.J(T)),e.a.gf);for(let W=0;W<U.length;W++){const V=this.MA.getPropertyObjectIds(H(U.J(W)),e.a.mK);if(1!==V.length)return;const Y=H(V.J(0));393230===Y.Nc?P.add(V.J(0)):393250===Y.Nc?N.add(V.J(0)):y.a.instance.Ta(573089748,1,2,"Unsupported class id in GetCharactersLost: "+
l.a[Y.Nc])}}}}}Jhf(K,H){K=this.MA.getPropertyObjectIds(K,e.a.gf);const P=new k.a;for(let N=0;N<K.length;N++){const M=this.MA.getPropertyObjectIds(H(K.J(N)),e.a.mK);if(1!==M.length)return null;P.add(M.J(0))}return P}ZIl(){let K=0;const H=this._state.runtime,P=H.zq,N=I=>H.zq.J(I)||H.pk.J(I);let M=null;H.xG=I=>{if(750<this.FDa()-this._state.input.OSa)throw y.a.instance.Ta(573089749,1,2,"Timed out while calculating comment characters lost: {0}",I),m.a.invalidOperation(I);};try{P.forEach((I,T)=>{if(1074135127===
T.Nc){I=this.Jhf(T,N);var U=H.pk.J(T.id);if(U)U=this.Jhf(U,V=>H.pk.J(V)),M||(M=new F.a(this.MA,this._state)),K+=this.UNh(U,I,M);else for(U=0;U<I.length;U++)K+=this.MA.getPropertyString(H.zq.J(I.J(U)),e.a.yo).length+1}if(1074135126===T.Nc&&(I=this.MA.getPropertyObjectIds(T,e.a.gf).zG(),T=H.pk.J(T.id)))for(T=this.MA.getPropertyObjectIds(T,e.a.gf),U=0;U<T.length;U++)if(!I.contains(T.J(U))){var W=H.pk.J(T.J(U));W=this.Jhf(W,V=>H.pk.J(V));for(let V=0;V<W.length;V++)K+=this.MA.getPropertyString(H.pk.J(W.J(V)),
e.a.yo).length+1}return!0})}catch(I){return y.a.instance.Ta(573089750,1,2,"Exception in GetCommentCharactersLost: "+I.toString()),-1}return K}eDb(){return this.lVa?this.lVa.eDb():null}GNd(K){const H=new k.a;K.forEach(P=>{H.add(J.RTa(P.eDb()));return!0});return H.toArray()}fWl(){const K=new a.a;K.Z("Succeeded",this._state.output.succeeded);K.Z("Timeout",this._state.output.timeout);K.Z("Crash",this._state.output.crash);K.Z("MergedRevisions",this._state.output.qM?this._state.output.qM.length:-1);K.Z("Duration",
this.Mr-this._state.input.OSa);return K}static RTa(K){if(!K)return null;const H={};K.forEach((P,N)=>{H[P.toString()]=N;return!0});return H}}Object(D.a)(J,"MergeLogger",null,[])},1760:function(D,L,c){D=c(0);var l=c(234),e=c(17),a=c(6),k=c(123),x=c(805),y=c(177),m=c(231),u=c(394),z=c(1478);class v{constructor(J,K,H){this.position=J;this.leader=K;this.val=H}equals(J){return this.position===J.position&&this.leader===J.leader&&this.val===J.val}toString(){return this.position.toString()}}Object(D.a)(v,
"TabStop",null,[]);var E=c(1859);c.d(L,"a",function(){return F});class F extends z.a{constructor(){super()}get Jn(){return 20}get Rz(){return 0}rk(){const J=super.rk();J.Z(x.a.zb(e.a.yo),1);J.Z(x.a.zb(e.a.En),1);J.Z(x.a.zb(e.a.sm),1);J.Z(x.a.zb(a.a.Ps),1);J.Z(x.a.zb(a.a.$p),1);J.Z(x.a.zb(a.a.Lc),1);J.Z(x.a.zb(e.a.bob),1);J.Z(x.a.zb(a.a.HOa),1);J.Z(x.a.zb(a.a.rGa),1);J.Z(x.a.zb(e.a.Kwa),1);J.Z(x.a.zb(a.a.GEa),1);J.Z(x.a.zb(a.a.kfa),1);J.Z(x.a.zb(a.a.HEa),1);J.Z(x.a.zb(a.a.XCa),1);J.Z(x.a.zb(a.a.IEa),
1);J.Z(x.a.zb(a.a.YCa),1);J.Z(x.a.zb(a.a.qGa),1);J.Z(x.a.zb(a.a.VHa),1);J.Z(x.a.zb(a.a.WHa),1);J.Z(x.a.zb(a.a.xya),1);J.Z(x.a.zb(a.a.qv),1);J.Z(x.a.zb(a.a.ez),1);J.Z(x.a.zb(a.a.fz),1);J.Z(x.a.zb(a.a.$v),1);J.Z(x.a.zb(k.a.eJ),6);J.Z(x.a.zb(k.a.OTa),6);J.Z(x.a.zb(a.a.Bzb),7);J.Z(x.a.zb(k.a.eJ),6);J.Z(x.a.zb(a.a.nnj),2);J.Z(x.a.zb(k.a.BYk),2);J.Z(x.a.zb(k.a.Qsn),2);J.Z(x.a.zb(a.a.Ikc),2);J.Z(x.a.zb(a.a.o9c),2);J.Z(x.a.zb(a.a.jPb),2);J.Z(x.a.zb(a.a.L6a),2);J.Z(x.a.zb(a.a.p9c),2);J.Z(x.a.zb(a.a.q9c),2);
J.Z(x.a.zb(a.a.lockNotFullySupportedParagraphInBlockContentControl),2);J.Z(x.a.zb(a.a.listID),3);J.Z(x.a.zb(a.a.listLevel),3);return J}GB(J,K){if(K===x.a.zb(e.a.yo)||K===x.a.zb(e.a.En)||K===x.a.zb(e.a.sm)||K===x.a.zb(a.a.Ps)||K===x.a.zb(a.a.$p)||K===x.a.zb(a.a.Lc)||K===x.a.zb(e.a.bob)||K===x.a.zb(a.a.HOa)||K===x.a.zb(a.a.rGa)||K===x.a.zb(e.a.Kwa)||K===x.a.zb(a.a.GEa)||K===x.a.zb(a.a.kfa)||K===x.a.zb(a.a.HEa)||K===x.a.zb(a.a.XCa)||K===x.a.zb(a.a.IEa)||K===x.a.zb(a.a.YCa)||K===x.a.zb(a.a.qGa)||K===
x.a.zb(a.a.VHa)||K===x.a.zb(a.a.WHa)||K===x.a.zb(a.a.xya)||K===x.a.zb(a.a.qv)||K===x.a.zb(a.a.NM)){var H=J.pn.value.Bu,P=J.pn.value.yf;K=J.Ng.value.yf;if(J.Zp.runtime.PMa.contains(H.id))return y.a.instance.Ta(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",H.id),!0;if(J.Zp.runtime.Xb.lhb(1000005)&&this.Lro(J,K,P))return J.Sk=K.fH(),F.Jkh(J),F.lyd(J.Zp,J.Xd,P),!0;const N=new m.a;N.add(H);H=new m.a;H.add(P);P=new m.a;
P.add(K);if(!({Xm:K}=F.mwj(J.Zp,N,P,H)).returnValue)return J.ulg=!0,J.Sk=null,!1;F.Jkh(J);J.Sk=K.$f(0).om;return!0}return K===x.a.zb(a.a.ez)||K===x.a.zb(a.a.fz)||K===x.a.zb(a.a.$v)?(this.zGo(J),J.og.add(x.a.zb(a.a.ez)),J.og.add(x.a.zb(a.a.fz)),J.og.add(x.a.zb(a.a.$v)),!0):!1}Lro(J,K,H){K=J.Xd.getPropertyString(K,a.a.NM);J=J.Xd.getPropertyString(H,a.a.NM);return K||J?!0:!1}zGo(J){const K=J.Xd,H=J.Sk;var P=J.pn.value.yf,N=J.Ng.value.yf;J=this.Smf(J.pn.value.Bu,K);N=this.Smf(N,K);P=this.Smf(P,K);({D7m:P,
E7m:J,F7m:N}=this.hWl(J,N,P));P.length?(K.setPropertyUint32s(H,a.a.$v,P),K.setPropertyUint32s(H,a.a.ez,J),K.setPropertyUint32s(H,a.a.fz,N)):this.wSn(H)}Smf(J,K){const H=K.getPropertyUint32s(J,a.a.$v),P=K.getPropertyUint32s(J,a.a.ez);J=K.getPropertyUint32s(J,a.a.fz);K=new m.a;if(!H)return K;for(let N=0;N<H.length;++N)K.add(new v(H.J(N),P.J(N),J.J(N)));return K}hWl(J,K,H){({YSi:K,ZSi:I,$Si:M}=this.s3h(J,K));let P,N;({YSi:H,ZSi:P,$Si:N}=this.s3h(J,H));J=this.nem(J,I,M,P,N);var M=this.mem(J,K,H);J=new m.a;
K=new m.a;var I=new m.a;for(H=0;H<M.length;++H)J.add(M.J(H).position),K.add(M.J(H).leader),I.add(M.J(H).val);return{D7m:J,E7m:K,F7m:I}}s3h(J,K){let H,P,N;H=new m.a;P=new u.a;N=new u.a;let M,I;for(M=I=0;M<J.length&&I<K.length;)J.J(M).position===K.J(I).position?(J.J(M).equals(K.J(I))||N.Z(J.J(M).position,K.J(I)),++M,++I):J.J(M).position<K.J(I).position?(P.Z(J.J(M).position,J.J(M)),++M):(H.add(K.J(I)),++I);for(;M<J.length;)P.Z(J.J(M).position,J.J(M)),++M;for(;I<K.length;)H.add(K.J(I)),++I;return{YSi:H,
ZSi:P,$Si:N}}nem(J,K,H,P,N){const M=new m.a;for(let I=0;I<J.length;++I){const T=J.J(I).position;K.ob(T)||(H.ob(T)?M.add(H.J(T)):P.ob(T)||(N.ob(T)?M.add(N.J(T)):M.add(J.J(I))))}return M}mem(J,K,H){K=this.OHi(K,H);return this.OHi(J,K)}OHi(J,K){const H=new m.a;let P,N;for(P=N=0;P<J.length&&N<K.length;)J.J(P).position<=K.J(N).position?(H.add(J.J(P)),J.J(P).position===K.J(N).position&&++N,++P):H.add(K.J(N++));for(;P<J.length;)H.add(J.J(P++));for(;N<K.length;)H.add(K.J(N++));return H}wSn(J){J.removeProperty(a.a.$v);
J.removeProperty(a.a.ez);J.removeProperty(a.a.fz)}static jh(){return new F}static get instance(){return F.Kg.value}static Jkh(J){J.og.add(x.a.zb(e.a.yo));J.og.add(x.a.zb(e.a.En));J.og.add(x.a.zb(e.a.sm));J.og.add(x.a.zb(a.a.Ps));J.og.add(x.a.zb(a.a.$p));J.og.add(x.a.zb(a.a.Lc));J.og.add(x.a.zb(e.a.bob));J.og.add(x.a.zb(a.a.HOa));J.og.add(x.a.zb(a.a.rGa));J.og.add(x.a.zb(e.a.Kwa));J.og.add(x.a.zb(a.a.GEa));J.og.add(x.a.zb(a.a.kfa));J.og.add(x.a.zb(a.a.HEa));J.og.add(x.a.zb(a.a.XCa));J.og.add(x.a.zb(a.a.IEa));
J.og.add(x.a.zb(a.a.YCa));J.og.add(x.a.zb(a.a.qGa));J.og.add(x.a.zb(a.a.VHa));J.og.add(x.a.zb(a.a.WHa));J.og.add(x.a.zb(a.a.xya));J.og.add(x.a.zb(a.a.qv));J.og.add(x.a.zb(a.a.NM))}static mwj(J,K,H,P){return(new E.a(J,K,H,P)).Rkc()}static lyd(J,K,H){H=K.getPropertyObjectIds(H,e.a.En);for(let N=0;N<H.length;N++){var P=J.runtime.zq.J(H.$f(N));if(P&&(P=K.getPropertyObjectId(P,a.a.le))){J.runtime.Wic.add(P);break}}}}F.Kg=new l.a(F.jh);Object(D.a)(F,"ParagraphNodeComplexMerge",z.a,[])},1761:function(D,
L,c){D=c(0);var l=c(76),e=c(1485),a=c(1610),k=c(1533),x=c(1503),y=c(1550),m=c(1486),u=c(1490),z=c(1489),v=c(1483),E=c(1482);class F{constructor(Y){this.kc=Y;this.dud=this.Zrf()}BK(){return"Add-ins"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:3}xH(Y,da){Y=new z.a(Y);da.resultsUpdated(Y)}shb(Y,da,ba){let ja;ja=this.kc.QO?new u.a(29):new u.a(27);ja.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;ba&&this.qqo(Y.Eg,da,ja)}qqo(Y,da,ba){const ja=[];let sa;sa=this.kc.kxm?this.kc.QO&&this.kc.Zcb?
E.a.ogb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,Y):this.kc.lxm?this.kc.QO&&this.kc.Zcb?E.a.ogb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,Y):this.kc.QO&&this.kc.Zcb?E.a.ogb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,
Y);this.kc.wva?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",sa)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Y))):(ja.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",sa)),ja.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Y)),appChrome.api.dispatch(ja));ba.ww(new m.a("LaunchAddinDialogFromTellMe",29));da.Lu(ba)}Zrf(){const Y=[];this.kc.LVd&&
Array.add(Y,"Addin");return Y}}Object(D.a)(F,"AddinStoreResultsProvider",null,[1258]);var J=c(1715),K=c(1522),H=c(1534),P=c(1716),N=c(1748),M=c(1717),I=c(1549),T=c(2),U=c(34),W=c(118);c.d(L,"a",function(){return V});class V{constructor(Y,da,ba){this.Rbb=this.Wzc=this.Xzc=this.mtd=!1;this.uP=null;this.n1=-1;this.vXa=this.OAc=this.gea=this.Nwb=null;this.B0g=this.L0g=0;this.kc=Y;const ja=E.a.Dga();this.N9a=da||[];this.Of=T.AFrameworkApplication.Ke;this.wch=Y.RTf;this.Yzc=Y.QTf;this.ktd=ja&&this.LNb();
this.ltd=ja&&this.MNb();this.ych=ja&&this.NNb();this.otd=this.PNb();this.eQe=this.sic();if((da=Y.Jdg&&E.a.N$f(Y))||Y.qfa)this.Nwb=new N.a(Y),this.mtd=Y.w8c;da&&(this.Xzc=Y.y8c,this.Wzc=Y.tjb,this.Rbb=this.mtd&&this.vx("File")||this.Xzc&&this.vx("People")||this.Wzc&&this.vx("Notes"));this.jtd=this.imo();this.$zc=Y.JZc;this.ntd=this.Cmo();this.dQe=this.hmo();this.itd=this.qag();this.I9=this.z8l();this.xIg=new J.a(Y);this.J_j=new P.a(Y);this.gfk=new M.a(Y);this.DOj=new F(Y);this.Oyc=ba;this.kwb=new a.a;
this.$zc&&(this.xIg=new J.a(Y));Y.qfa&&(this.dQe=this.ntd=this.$zc=this.Rbb=this.Wzc=this.Xzc=this.eQe=this.otd=this.ych=this.ltd=this.ktd=this.Yzc=!1,T.AFrameworkApplication.K&&this.vx("File")&&this.Pkj()&&(Y=this.kwb.Jsf("Search",T.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch"),!0),this.uKc(Y,"TellMeService",!0),Y=this.kwb.Jsf("SmartLookup",T.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint"),!1),this.uKc(Y,"Shredder",!1)));T.AFrameworkApplication.K&&this.Rbb&&this.vx("File")&&
this.Pkj()&&(Y=this.kwb.Jsf("Search",T.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch"),!0),this.uKc(Y,"TellMeService",!0))}vx(Y){return Array.contains(this.N9a,Y)?!0:!1}BK(){return"TellMeService"}KT(){return 0===this.kc.Ru?0:1===this.kc.Ru?1:this.vx("Command")||this.vx("Recommended")?2:3}w8l(Y){let da="";if(!Y&&this.vx("Command")&&this.kc.cCf){da+="CommandSearch_DLIS,";var ba=this.kc.Wrj;0<ba.length&&(da+=ba+",")}Y&&this.vx("Recommended")&&this.Yzc&&(ba=this.Cbm(),0<ba.length&&(da+=
ba+","));!Y&&this.vx("Help")&&(Y=this.kc.Vrj,0<Y.length&&(da+=Y+","));this.kc.qfa&&this.vXa&&0<this.vXa.length&&(da+="IsRecallEnabled_true,");(this.kc.DId||this.kc.qfa)&&this.Rbb&&(da+="IsGenerateSlidesEnabled_true,");0<da.length&&(da=da.substr(0,da.length-1));return da}uKc(Y,da,ba){const ja=ba?this.L0g:this.B0g;if(!ja||window.performance.now()-ja>=E.a.oTa)if(Y)ba?this.L0g=window.performance.now():this.B0g=window.performance.now(),Y.then(sa=>{ba?this.OAc=sa:(this.vXa=sa,v.TellMeActor.instance.Kbg=
sa)},sa=>{v.TellMeActor.instance.Ne.onError("TellMeServiceProvider:FetchTokenForService_"+da,"tellMeServiceToken promise rejected: "+sa)});else if(v.TellMeActor.instance.Ne)v.TellMeActor.instance.Ne.onError("TellMeServiceProvider:FetchTokenForService_"+da,"undefined token promise")}xH(Y,da,ba,ja=e.a.tellMe,sa=null){const ta=new z.a(Y);ba=E.a.FQ(Y);this.vx("File")&&(this.Rbb||this.kc.qfa)&&this.uKc(this.kwb.A8l(),"TellMeService",!0);this.vx("File")&&this.kc.qfa&&this.uKc(this.kwb.K5l(),"Shredder",
!1);var ra=this.Rbb&&!!this.OAc;const ma=this.kc.qfa&&!!this.vXa;var Ba=ra||ma||ba&&this.vx("Recommended")&&this.Yzc;ra=ra||ma||!ba&&(this.wch&&this.vx("Command")||this.ktd&&this.vx("Answer")||this.ltd&&this.vx("Definition")||this.eQe&&this.vx("Image")||this.$zc&&this.vx("Help")||this.otd&&this.vx("WolframAnswer")||this.ntd&&this.vx("Template")||this.dQe&&this.vx("Addin"));if(Ba||ra)if(this.gea=ja,ja={"Content-Type":"application/json",Accept:"application/json"},ja["X-Office-Version"]=T.AFrameworkApplication.buildVersion,
ja["X-Office-Application"]=T.AFrameworkApplication.K.kb("Application"),ja["X-Office-Platform"]="WAC",ja["X-TellMe-SqmUserId"]=T.AFrameworkApplication.K.kb("LoggableUserId")||"",ja["X-TellMe-SessionId"]=v.TellMeActor.instance.VQd(),this.OAc&&(ja.Authorization="Bearer "+this.OAc),this.vXa&&0<this.vXa.length&&(ja["X-TellMe-ShredderToken"]="Bearer "+this.vXa),Ba=this.w8l(ba),0<Ba.length&&(ja["X-TellMe-Flights"]=Ba),Ba=[],!ba&&this.vx("Answer")&&this.ktd&&(sa?Array.contains(sa,9):1)&&Array.add(Ba,"Answer"),
!ba&&this.vx("Command")&&this.wch&&!K.CommandResultsUtility.Azf(Y.Eg)&&(sa?Array.contains(sa,17):1)&&Array.add(Ba,"Command"),!ba&&this.vx("Definition")&&this.ltd&&(sa?Array.contains(sa,10):1)&&Array.add(Ba,"Definition"),!ba&&this.vx("Help")&&this.$zc&&(sa?Array.contains(sa,8):1)&&Array.add(Ba,"Help"),!ba&&this.vx("WolframAnswer")&&this.otd&&(sa?Array.contains(sa,12):1)&&Array.add(Ba,"WolframAnswer"),ba&&this.vx("Recommended")&&this.Yzc&&!v.TellMeActor.instance.Z$c&&(sa?Array.contains(sa,18):1)&&Array.add(Ba,
"Recommended"),!ba&&this.vx("Image")&&this.eQe&&(sa?Array.contains(sa,19):1)&&Array.add(Ba,"Image"),this.OAc&&this.Rbb&&(sa?Array.contains(sa,14)||Array.contains(sa,15)||Array.contains(sa,20):1)&&(this.Nwb.d5a(),this.mtd&&this.vx("File")&&Array.add(Ba,"File"),this.Xzc&&this.vx("People")&&Array.add(Ba,"People"),this.Wzc&&this.vx("Notes")&&Array.add(Ba,"Notes")),this.vXa&&0<this.vXa.length&&this.kc.qfa&&(sa?Array.contains(sa,15):1)&&(this.Nwb.d5a(),this.vx("File")&&Array.add(Ba,"File")),!ba&&this.vx("Template")&&
this.ntd&&(sa?Array.contains(sa,23):1)&&Array.add(Ba,"Template"),!ba&&this.vx("Addin")&&this.dQe&&(sa?Array.contains(sa,27):1)&&Array.add(Ba,"Addin"),!ba&&this.vx("ActionAI")&&this.itd&&(sa?Array.contains(sa,25):1)&&Array.add(Ba,"ActionAI"),Ba.length){ja["X-TellMe-SuggestionTypes"]=Ba.join(",");ja["X-TellMe-Culture"]=T.AFrameworkApplication.uiCulture;ja["X-TellMe-ProcessSessionId"]=T.AFrameworkApplication.userSessionId;var Pa=this.uP=W.a.create().toString();ja["Client-Request-Id"]=Pa;var Da=window.performance.now();
this.lCa();this.n1=window.setTimeout(()=>{if(Pa===this.uP){this.uP="";this.n1=-1;da.resultsUpdated(ta);const Ha={};Ha[k.a.provider]=this.BK();Ha[k.a.cLb]=Y.imb;v.TellMeActor.instance.Ne.pA(x.a.timedOut,this.Oyc,Ha)}},this.Oyc);this.Of.oj(this.I9,2,this.y8l(Y.Eg),ja,!1,0,Ha=>{this.NJb(Ha,Y,da,Pa,Da,sa)},Ha=>{this.yJb(Ha,Y,da,Pa,Da)},null,null,!1,4E3,this.itd?3E4:6E3)}else v.TellMeActor.instance.Ne.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),da.resultsUpdated(ta);
else da.resultsUpdated(ta)}lCa(){-1!==this.n1&&(window.clearTimeout(this.n1),this.n1=-1)}NJb(Y,da,ba,ja,sa,ta){const ra=new z.a(da);if(ja===this.uP){this.lCa();v.TellMeActor.instance.Ne.R_(da.Eg.length,this.N9a.join(","),Y.data.Ve.toString(),Math.round(window.performance.now()-sa),I.a.tellMe,!0,y.a.XOa);ja=Y.data.we;Y=null;try{Y=U.b(ja)}catch(oa){v.TellMeActor.instance.Ne.onError("OnSuccessCallBack","Exception occured while deserializing response:"+oa);return}ja=E.a.FQ(da);if("Groups"in Y&&Y.Groups){var ma=
Y.Groups;for(var Ba of ma)if("GroupType"in Ba&&"Suggestions"in Ba&&Ba.Suggestions)if("Commands"===Ba.GroupType&&(ta?Array.contains(ta,17):1)||"Recommended"===Ba.GroupType&&(ta?Array.contains(ta,18):1)){var Pa=(ma="Recommended"===Ba.GroupType)?"DLIS":"NaiveBayes";"Source"in Ba&&Ba.Source&&(Pa=Ba.Source);var Da=Ba.Suggestions;new l.a;var Ha=[];for(const oa of Da)this.oMm(oa)&&(Da=oa.Type,("Command"===Da||ma&&"Recommended"===Da)&&Ha.push(new H.a(oa.CommandId,oa.Score)));K.CommandResultsUtility.S0d(Ha,
!da.Eg.trim().length,Ba.GroupType,Pa);Pa=v.TellMeActor.instance.U1;Da=[];for(const oa of Ha)ma&&Pa&&Pa.n7e(oa.commandId)||Da.push(oa);Ha=K.CommandResultsUtility.jOc(da,Da,this.kc,null,null,null,ma?18:17,0);0<Ha.results.length&&(this.gea!==e.a.contextMenu&&(Ha.displayName=ma?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ra.Lu(Ha))}else if("Answer"===Ba.GroupType){Da=Ba.Suggestions;ma=null;Ha=2147483647;Pa="";for(const oa of Da)if(this.nMm(oa))if(Pa=oa.Type,Da=
this.YPd(Pa),"Answer"===Pa&&this.ktd){ma=this.UIh(Pa,oa,da.Eg);break}else Da&&Da<Ha&&(Ha=Da,ma=this.UIh(Pa,oa,da.Eg));Ha=E.a.B0n(da.Eg,Pa);ma&&(ta?Array.contains(ta,ma.type):1)&&(Pa=[],this.jtd?this.kc.wva?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ma.value,ma.BC)),v.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ma.value,ma.description)),v.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ma.value,
Ha))):(Pa.push(appChrome.actions.setControlLabel(ma.value,ma.BC)),Pa.push(appChrome.actions.updateCompoundButtonDescription(ma.value,ma.description)),Pa.push(appChrome.actions.setCompoundButtonCommandValueId(ma.value,Ha)),appChrome.api.dispatch(Pa)):this.kc.wva?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ma.value,ma.BC+" - "+ma.description)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ma.value,Ha))):(Pa.push(appChrome.actions.setControlLabel(ma.value,
ma.BC+" - "+ma.description)),Pa.push(appChrome.actions.setButtonCommandValueId(ma.value,Ha)),appChrome.api.dispatch(Pa)),Ha=this.C7k(ma.type),Ha.ww(ma),ra.Lu(Ha))}else"Help"===Ba.GroupType&&Ba.Suggestions.length&&(ta?Array.contains(ta,8):1)?this.$zc&&(ma=this.xIg.shb(da,Ba.Suggestions))&&0<ma.results.length&&ra.Lu(ma):"Template"===Ba.GroupType&&(ta?Array.contains(ta,23):1)?(ma=Ba.Suggestions)&&0<ma.length&&this.gfk.shb(da,ra,ma):"Addin"===Ba.GroupType&&(ta?Array.contains(ta,27):1)?(ma=Ba.Suggestions)&&
0<ma.length&&this.DOj.shb(da,ra,ma):"ActionAI"===Ba.GroupType&&(ta?Array.contains(ta,25):1)?(Ha=Ba.Suggestions,ma=[],new u.a(25),Ha&&1===Ha.length&&(Pa=Ha[0])&&Pa.CommandId&&(Ha=Pa.CommandId,ma.push(new H.a(Ha,"Score"in Pa?Pa.Score:0)),ma=K.CommandResultsUtility.jOc(da,ma,this.kc,null,null,null,25,0),ma.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,ra.Lu(ma))):"Substrate"===Ba.GroupType&&this.Rbb&&"Type"in Ba?"File"===Ba.Type&&this.mtd&&(ta?Array.contains(ta,15):1)?(ma=this.Nwb.Inf(Ba.Suggestions,
ja,this.gea))&&0<ma.results.length&&(this.cXd()&&(Ha=new m.a("GenerateSlidesFromTellMe",30,"",null,1),ma.ww(Ha)),ra.Lu(ma)):"People"===Ba.Type&&this.Xzc&&(ta?Array.contains(ta,14):1)?(ma=this.Nwb.D$h(Ba.Suggestions,ja,this.gea))&&0<ma.results.length&&ra.Lu(ma):"Notes"===Ba.Type&&this.Wzc&&(ta?Array.contains(ta,14):1)&&(ma=this.Nwb.j9h(Ba.Suggestions,ja,da))&&0<ma.results.length&&ra.Lu(ma):"Recall"===Ba.GroupType&&this.kc.qfa&&"Type"in Ba&&"IntentService"===Ba.Type&&(ta?Array.contains(ta,15):1)&&(ma=
this.Nwb.Inf(Ba.Suggestions,ja,this.gea))&&0<ma.results.length&&(this.cXd()&&(Ha=new m.a("GenerateSlidesFromTellMe",30,"",null,1),ma.ww(Ha)),ra.Lu(ma));else v.TellMeActor.instance.Ne.onError("OnSuccessCallBack","GroupType"in Ba?"Invalid group suggestions found for "+Ba.GroupType:"Invalid group found")}if(Y.Intents){Ba=Y.Intents;for(const oa of Ba)this.DEf(oa)&&("Image"===oa.GroupType&&oa.ConfidenceScore>oa.ConfidenceThreshold&&(ta?Array.contains(ta,19):1)?this.J_j.shb(da,ra,0,oa):"Commands"===oa.GroupType&&
oa.ConfidenceScore<oa.ConfidenceThreshold&&(ta?Array.contains(ta,17):1)&&(Ba=new u.a(17),ra.Lu(Ba)))}ba.resultsUpdated(ra);v.TellMeActor.instance.Ne.R_(da.Eg.length,this.N9a.join(","),"",Math.round(window.performance.now()-sa),"",!0,y.a.provider)}}yJb(Y,da,ba,ja,sa){const ta=new z.a(da);ja===this.uP&&(this.lCa(),v.TellMeActor.instance.Ne.R_(da.Eg.length,this.N9a.join(","),Y.data.Ve.toString(),Math.round(window.performance.now()-sa),I.a.tellMe,!1,y.a.XOa));ba.resultsUpdated(ta)}YPd(Y){switch(Y){case "Entity":return this.ych?
3:0;case "Definition":return this.ltd?5:0;case "WolframAnswer":return this.otd?2:0;default:return 0}}UIh(Y,da,ba){switch(Y){case "Answer":return new m.a(this.jtd?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===da.Title?ba:da.Title,da.Description,0);case "Entity":return new m.a(this.jtd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===da.Title?ba:da.Title,da.Description,0);case "Definition":return new m.a(this.jtd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===da.Title?ba:da.Title,da.Description,
0);case "WolframAnswer":return new m.a("WolframForSearch",3,""===da.Title?ba:da.Title,da.Description,0);default:return null}}C7k(Y){switch(Y){case 0:return new u.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new u.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new u.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new u.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new u.a(19,this.kc.mic?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);
default:return null}}nMm(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"Description"in Y&&!!Y.Description&&""!==Y.Description}oMm(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"CommandId"in Y&&!!Y.CommandId&&""!==Y.CommandId&&"Score"in Y&&!!Y.Score}DEf(Y){if("GroupType"in Y&&Y.GroupType&&"ConfidenceScore"in Y&&"ConfidenceThreshold"in Y)return!0;v.TellMeActor.instance.Ne.onError("IsValidIntentGroup","Invalid intents found");return!1}y8l(Y){const da=E.a.xxi(Y),ba={};ba.Query=Y;da&&this.Yzc&&(this.iGm()?
ba.UserActionEvents=v.TellMeActor.instance.Zgh:(ba.CommandClickedEvents=v.TellMeActor.instance.Nte,ba.CommandActionEvents=v.TellMeActor.instance.LLg),ba.TellMeCommandClickMruEvents=v.TellMeActor.instance.E3g,ba.ContentType=v.TellMeActor.instance.gGd);this.ntd&&(Y={},Y.Application=this.kc.application,ba.TemplateInfo=Y);return U.c(ba)}LNb(){return!!this.kc&&this.kc.LNb||!!T.AFrameworkApplication.ta&&T.AFrameworkApplication.ta.Ob.LNb}MNb(){return!!this.kc&&this.kc.MNb||!!T.AFrameworkApplication.ta&&
T.AFrameworkApplication.ta.Ob.MNb}NNb(){return!!this.kc&&this.kc.NNb||!!T.AFrameworkApplication.ta&&T.AFrameworkApplication.ta.Ob.NNb}PNb(){return!!this.kc&&this.kc.PNb||!!T.AFrameworkApplication.ta&&T.AFrameworkApplication.ta.Ob.PNb}sic(){return!!this.kc&&(this.kc.sic||this.kc.QO)}imo(){return!!this.kc&&!this.kc.H2a}Cmo(){return!!this.kc&&this.kc.IUc}hmo(){return!!this.kc&&this.kc.mxm&&this.kc.jxm}qag(){return!!this.kc&&this.kc.qag}jyi(){return!!T.AFrameworkApplication.K&&T.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",
!1)}kyi(){return!!T.AFrameworkApplication.K&&T.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}iGm(){return!!T.AFrameworkApplication.K&&T.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}cXd(){return!!T.AFrameworkApplication.K&&T.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Pkj(){return!!T.AFrameworkApplication.K&&
T.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}Cbm(){return T.AFrameworkApplication.K?T.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}z8l(){if(!T.AFrameworkApplication.K)return"";if(this.kyi())return T.AFrameworkApplication.K.kb("TellMeServiceProdEndpointForSearch");if(this.jyi())return T.AFrameworkApplication.K.kb("TellMeServiceEdogEndpointForSearch");if(E.a.dAf())return T.AFrameworkApplication.K.kb("TellMeServiceIntEndpointForSearch");
let Y=T.AFrameworkApplication.K.kb("TellMeServiceSearchEndpoint");Y&&""!==Y||(Y=T.AFrameworkApplication.Urj);return Y}static wJh(Y,da){if(da)return new V(Y,["Command","Recommended"],Y.sOl);da=E.a.Dga()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new V(Y,da,Y.wci)}}Object(D.a)(V,"TellMeServiceProvider",null,[1258])},1858:function(D,L,c){c.r(L);c.d(L,"MarkerValidation",
function(){return a});D=c(0);var l=c(394),e=c(1759);class a{constructor(){this.pVd=this.Woi=this.Voi=this.Uoi=0}I3h(){const k=new l.a(0);k.Z("InvalidBookmarks",this.Uoi);k.Z("InvalidComments",this.Voi);k.Z("InvalidContentControls",this.Woi);0!==this.pVd&&k.Z("InvalidMarkerType",this.pVd);return k}sii(){return 0<this.Uoi||0<this.Voi||0<this.Woi||0!==this.pVd?!0:!1}toString(){return JSON.stringify(e.a.RTa(this.I3h()))}}Object(D.a)(a,"MarkerValidation",null,[])},1859:function(D,L,c){c.d(L,"a",function(){return y});
D=c(0);var l=c(177),e=c(1029),a=c(251),k=c(1630),x=c(1553);class y{constructor(m,u,z,v,E=null,F=null,J=null,K=null){this.Vd=m;this.mF=u;this.Rza=z;this.iBa=v;this.g5j=E;this.OWj=F;this.ygk=J;this.rra=K||this.X8e()}X8e(){return m=>!!this.Vd.runtime.Xb&&this.Vd.runtime.Xb.isFeatureEnabled(m)}r3k(){return()=>this.Vd.runtime.Xb}Edf(){return!!this.Vd.runtime.pk.J(a.a.eL)}Fnj(){let m;if(1===this.Vd.input.source||2===this.Vd.input.source)m=79;else if(4===this.Vd.input.source||3===this.Vd.input.source)m=
37;else if(5===this.Vd.input.source)m=117;else return!1;return this.Edf()&&this.rra(m)}Kpj(m,...u){return String.format.apply(null,[m].concat(u))}xPd(m){const {ParagraphMerge:u}=c(1932);let z=this.Vd,v=this.Rza,E=this.iBa;m||(z=this.g5j||this.Vd,v=this.OWj||v,E=this.ygk||E);var F=x.a.ypf(this.mF);const J=x.a.ypf(v),K=x.a.ypf(E);F=this.Kpj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
z.input.source,z.runtime.tCa.id,z.runtime.gKd,z.runtime.tle,F.Pq(),J.Pq(),K.Pq());return m?{returnValue:new k.a(z,this.mF,v,E,this.X8e(),new e.a),Pq:F}:{returnValue:new u(z,this.mF,v,E,this.X8e(),this.r3k(),new e.a),Pq:F}}Rkc(){this.Vd.logger.keo();var m=this.Fnj();var u=({Pq:v}=this.xPd(m)).returnValue;l.a.instance.Ta(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",m,v);this.Vd.logger.kU("ParagraphMergeSelector initialization");m?this.Vd.logger.cfe(1):this.Vd.logger.cfe(2);
let z=({Xm:u}=u.Rkc()).returnValue;this.Vd.logger.Y8f();var v=!z;m=!!this.Vd.runtime.pk.J(a.a.eL)&&(m&&!z||!m);v&&({Pq:v,returnValue:u}=this.xPd(!1),{Xm:u,returnValue:z}=u.Rkc(),l.a.instance.Ta(18994390,1,z?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",z,v));m&&(v=new e.a,x.a.t_n(this.Vd,v));this.Vd.logger.kU("ParagraphMergeSelector finalization");return{returnValue:z,Xm:u}}g$c(m,u){let z,v,E;const F=this.Fnj()&&this.rra(118);let J=({Pq:E}=this.xPd(F)).returnValue,K=({g5a:z,
spa:v}=J.g$c(m,u)).returnValue;l.a.instance.Ta(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",F,E);F&&!K&&J.U4f&&({Pq:E,returnValue:J}=this.xPd(!1),{g5a:z,spa:v,returnValue:K}=J.g$c(m,u),l.a.instance.Ta(18994392,1,K?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",K,E));return{returnValue:K,g5a:z,spa:v}}}Object(D.a)(y,"ParagraphMergeSelector",null,[1869])},1860:function(D,L,c){c.r(L);c.d(L,"SurfaceStringTokenStringGenerator",
function(){return e});D=c(0);var l=c(1578);class e extends l.a{constructor(a){super(a);this.Bb=a}apply(a,k,x,y,m,u,z){null==u&&(u=a.vei(m,k));z=l.a.Plh(a,u,this.Bb.score,x,y,z);return{Y8c:u,nEc:z}}}e.oEc=0;Object(D.a)(e,"SurfaceStringTokenStringGenerator",l.a,[])},1861:function(D,L,c){c.r(L);c.d(L,"QueryTokenStringGenerator",function(){return a});D=c(0);var l=c(1578),e=c(1479);class a extends l.a{constructor(k){super(k);this.Bb=k}apply(k,x,y,m,u,z,v){x=this.Bb.query.load(x,null);u=0;let E=null;this.Bb.query.m4===
e.Annotations.yya?x&&(E=this.Bb.name):((E=this.Bb.name)&&(E+="_"),E+=this.Bb.annotations.Vca(this.Bb.query.m4,x));null!=E&&(u=l.a.Plh(k,E,this.Bb.score,y,m,u));return{Y8c:z,nEc:v+u}}}a.oEc=1;Object(D.a)(a,"QueryTokenStringGenerator",l.a,[])},1862:function(D,L,c){c.r(L);c.d(L,"FuzzyMatchTokenStringGenerator",function(){return e});D=c(0);var l=c(1578);class e extends l.a{constructor(a){super(a);this.Bb=a}apply(a,k,x,y,m,u,z){null==u&&(u=a.vei(m,k));a=this.Bb.lTh.j2m(u);if(this.Bb.mSi)for(var v of a)if(!v.VN&&
v.$Kd)return{Y8c:u,nEc:z};v=0;for(const E of a)if(E.VN&&!({X2e:v}=this.Pqh(E,!0,x,y,v)).returnValue)return{Y8c:u,nEc:z};if(this.Bb.Hli)for(const E of a)if(!({X2e:v}=this.Pqh(E,!1,x,y,v)).returnValue)break;return{Y8c:u,nEc:z}}Pqh(a,k,x,y,m){let u;k?(k=0,u=a.$Kd?1:0):(k=a.$Kd?1:0,u=a.count-k);for(let z=0;z<u;++z)if(l.a.Qlh(a.Rfb+k+z,this.Bb.score,x,y),++m,0<this.Bb.WJf&&m>=this.Bb.WJf)return{returnValue:!1,X2e:m};return{returnValue:!0,X2e:m}}}e.oEc=2;Object(D.a)(e,"FuzzyMatchTokenStringGenerator",l.a,
[])},1922:function(D,L,c){D=c(0);var l=c(6),e=c(43),a=c(234),k=c(1478);class x extends k.a{constructor(){super()}get Jn(){return 2}get Rz(){return 7}static jh(){return new x}static get instance(){return x.Kg.value}}x.Kg=new a.a(x.jh);Object(D.a)(x,"AppBindingNodeComplexMerge",k.a,[]);var y=c(17),m=c(805),u=c(177),z=c(1521);class v extends k.a{constructor(){super()}get Jn(){return 3}get Rz(){return 7}rk(){const Ga=super.rk();Ga.Z(m.a.zb(y.a.iU),1);return Ga}GB(Ga,Fb){if(Fb===m.a.zb(y.a.iU)){const rb=
Ga.Sk;var $b=Ga.Xd;u.a.instance.Ta(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",rb.id,rb.Nc,Fb);Fb=$b.getPropertyMilliseconds(Ga.Ng.value.yf,y.a.iU);$b=$b.getPropertyMilliseconds(Ga.pn.value.yf,y.a.iU);Fb<$b&&this.AJl(Ga);Ga.og.add(m.a.zb(y.a.iU));return!0}u.a.instance.Ta(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ga.Ng.value.yf.id,Fb);return!1}AJl(Ga){this.tXn(Ga.pn.value.yf,
Ga.Sk);this.imf(Ga,l.a.OZe);this.imf(Ga,l.a.Roh);this.imf(Ga,l.a.Goh)}imf(Ga,Fb){var $b=Ga.Xd,rb=Ga.Sk;if($b.hasProperty(rb,Fb)&&(Fb=$b.getPropertyObjectIds(rb,Fb))&&Fb.length)for($b=Ga.Zp.runtime.zq,Ga=Ga.Zp.runtime.Xm,rb=0;rb<Fb.length;rb++){const xb=Fb.J(rb);if(!$b.ob(xb))continue;const gb=$b.J(xb).fH();Ga.add(xb,new z.a(gb,!1))}}static jh(){return new v}static get instance(){return v.Kg.value}}v.Kg=new a.a(v.jh);Object(D.a)(v,"AppNodeComplexMerge",k.a,[]);class E extends k.a{constructor(){super()}get Jn(){return 4}get Rz(){return 7}static jh(){return new E}static get instance(){return E.Kg.value}}
E.Kg=new a.a(E.jh);Object(D.a)(E,"AppPropNodeComplexMerge",k.a,[]);class F extends k.a{constructor(){super()}get Jn(){return 5}get Rz(){return 7}static jh(){return new F}static get instance(){return F.Kg.value}}F.Kg=new a.a(F.jh);Object(D.a)(F,"AppRefNodeComplexMerge",k.a,[]);var J=c(394),K=c(627),H=c(231),P=c(16);class N{constructor(Ga,Fb){this.id=Ga;this.muo=Fb}}Object(D.a)(N,"IdAndTime",null,[]);class M extends k.a{constructor(){super()}get Jn(){return 6}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.vYa),
1);return Ga}GB(Ga,Fb){if(Fb===m.a.zb(l.a.vYa)){const $b=Ga.Sk,rb=Ga.Xd;u.a.instance.Ta(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",$b.id,$b.Nc,Fb);Fb=rb.getPropertyObjectIds(Ga.Ng.value.Bu,l.a.vYa);const xb=rb.getPropertyObjectIds(Ga.Ng.value.yf,l.a.vYa),gb=rb.getPropertyObjectIds(Ga.pn.value.yf,l.a.vYa);Fb=this.A6m(Ga,Fb,xb,gb);0<Fb.length?rb.setPropertyObjectIds($b,l.a.vYa,Fb):$b.removeProperty(l.a.vYa);Ga.og.add(m.a.zb(l.a.vYa));
return!0}u.a.instance.Ta(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ga.Ng.value.yf.id,Fb);return!1}A6m(Ga,Fb,$b,rb){const xb=this.DFa(Fb,$b,rb),gb=Fb.zG(),Gb=$b.zG(),ac=rb.zG();Fb=k.a.filter(xb,Uc=>!gb.contains(Uc)&&Gb.contains(Uc));$b=k.a.filter(xb,Uc=>!gb.contains(Uc)&&ac.contains(Uc));if(!Fb.length||!$b.length)return xb;const hc=new J.a;Fb.forEach(Uc=>{const dd=new N(Uc,this.o0h(Ga,Uc,!1));this.k0h(Ga,Uc,!1).forEach(fd=>
{hc.add(fd,dd);return!0});return!0});const Ec=new K.a;$b.forEach(Uc=>{const dd=this.o0h(Ga,Uc,!0);this.k0h(Ga,Uc,!0).forEach(fd=>hc.ob(fd)?(Ec.add(hc.J(fd).muo>=dd?Uc:hc.J(fd).id),!1):!0);return!0});return k.a.filter(xb,Uc=>!Ec.contains(Uc))}o0h(Ga,Fb,$b){return(Fb=this.Uma(Ga,Fb,$b))?Ga.Xd.getPropertyMilliseconds(Fb,y.a.iU):0}Uma(Ga,Fb,$b){Ga=$b?Ga.Zp.runtime.zq:Ga.Zp.runtime.ru;return Ga.ob(Fb)?Ga.J(Fb):null}k0h(Ga,Fb,$b){const rb=new H.a,xb=new K.a,gb=Ga.Xd;Fb=this.Uma(Ga,Fb,$b);var Gb=this.Sai(gb,
Fb);if(Gb)for(rb.add(Gb),xb.add(Gb),Fb=gb.getPropertyObjectIds(Fb,l.a.OZe),Gb=0;Fb&&Gb<Fb.length;Gb++){const ac=this.Sai(gb,this.Uma(Ga,Fb.J(Gb),$b));if(!ac)break;xb.contains(ac)||(rb.add(ac),xb.add(ac))}return rb}Sai(Ga,Fb){if(!Ga.hasProperty(Fb,l.a.Ucb)||!Ga.hasProperty(Fb,l.a.P_b)||!Ga.hasProperty(Fb,l.a.Q_b))return null;const $b=Ga.getPropertyString(Fb,l.a.Ucb),rb=Ga.getPropertyString(Fb,l.a.P_b);Ga=Ga.getPropertyString(Fb,l.a.Q_b);return P.a.BA($b+";"+rb+";"+Ga)}static jh(){return new M}static get instance(){return M.Kg.value}}
M.Kg=new a.a(M.jh);Object(D.a)(M,"AppsNodeComplexMerge",k.a,[]);class I extends k.a{constructor(){super()}get Jn(){return 36}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.Sig),1);Ga.Z(m.a.zb(l.a.j9f),1);return Ga}GB(Ga,Fb){u.a.instance.Ta(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",Fb);if(Fb===m.a.zb(l.a.Sig)||Fb===m.a.zb(l.a.j9f)){const gb=m.a.dX(Fb);var $b=Ga.Ng.value.yf,rb=Ga.pn.value.yf;const Gb=Ga.Sk;var xb=Ga.Xd.getPropertyStrings(Ga.Ng.value.Bu,gb);$b=Ga.Xd.getPropertyStrings($b,
gb);rb=Ga.Xd.getPropertyStrings(rb,gb);xb=this.DFa(xb,$b,rb);Ga.Xd.setPropertyStrings(Gb,gb,xb);Ga.og.add(Fb);return!0}return!1}static jh(){return new I}static get instance(){return I.Kg.value}}I.Kg=new a.a(I.jh);Object(D.a)(I,"AutoSaveParametersNodeComplexMerge",k.a,[]);class T extends k.a{constructor(){super()}get Jn(){return 44}rk(){const Ga=super.rk();Ga.Z(m.a.zb(y.a.gf),1);return Ga}GB(Ga,Fb){const $b=Ga.Zp.runtime.Xb;if(Fb===m.a.zb(y.a.gf))return u.a.instance.Ta(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Ga.Sk.id,Ga.Sk.Nc,Fb),$b.pB(123),$b.isFeatureEnabled(123)?this.D6m(Ga,Fb):this.$6m(Ga,Fb),!0;u.a.instance.Ta(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Ga.Ng.value.yf.id,Fb);return!1}D6m(Ga,Fb){const $b=m.a.dX(Fb),rb=Ga.Xd;var xb=rb.getPropertyObjectIds(Ga.Ng.value.Bu,$b),gb=rb.getPropertyObjectIds(Ga.Ng.value.yf,$b),Gb=rb.getPropertyObjectIds(Ga.pn.value.yf,$b);Gb=T.t$l(Ga,gb,Gb);xb=this.DFa(xb,gb,
Gb);gb=Ga.Sk;0<xb.length?rb.setPropertyObjectIds(gb,$b,xb):gb.removeProperty($b);Ga.og.add(Fb)}static jh(){return new T}static get instance(){return T.Kg.value}static t$l(Ga,Fb,$b){const rb=new H.a,xb=new J.a;Fb.forEach(gb=>{const Gb=Ga.Zp.runtime.ru.J(gb);Gb&&xb.add(Gb.jX(l.a.$s).toString(),gb);return!0});$b.forEach(gb=>{var Gb=Ga.Zp.runtime.zq.J(gb);Gb?(Gb=Gb.jX(l.a.$s).toString(),xb.ob(Gb)&&xb.get(Gb)!==gb?u.a.instance.Ta(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
rb.add(gb)):rb.add(gb);return!0});return rb}}T.Kg=new a.a(T.jh);Object(D.a)(T,"BookmarkContainerNodeComplexMerge",k.a,[]);class U extends k.a{constructor(){super()}get Jn(){return 41}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.Syb),1);Ga.Z(m.a.zb(l.a.$s),1);return Ga}GB(Ga,Fb){return Fb===m.a.zb(l.a.Syb)?(Ga.og.add(m.a.zb(l.a.Syb)),!0):Fb===m.a.zb(l.a.$s)?(Ga.og.add(m.a.zb(l.a.$s)),!0):!1}mf(Ga){return Ga&&Ga.length?!1:!0}static jh(){return new U}static get instance(){return U.Kg.value}}U.Kg=new a.a(U.jh);
Object(D.a)(U,"BookmarkNodeComplexMerge",k.a,[]);class W extends k.a{constructor(){super();this.iWd=!1}get Jn(){return 7}rk(){const Ga=super.rk();Ga.Z(m.a.zb(y.a.gf),1);return Ga}GB(Ga,Fb){if(Fb===m.a.zb(y.a.gf)){const xb=Ga.Sk,gb=Ga.Xd;var $b=Ga.Zp.runtime.Xb;$b&&(this.iWd=$b.isFeatureEnabled(73));u.a.instance.Ta(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",xb.id,xb.Nc,Fb);Fb=gb.getPropertyObjectIds(Ga.Ng.value.Bu,y.a.gf);
$b=gb.getPropertyObjectIds(Ga.Ng.value.yf,y.a.gf);var rb=gb.getPropertyObjectIds(Ga.pn.value.yf,y.a.gf);Fb=this.N6m(Fb,$b,rb);if(this.iWd&&0<Fb.length){$b=new Sys.StringBuilder;for(rb=0;rb<Fb.length;rb++)$b.append(Fb.J(rb).toString()+",");u.a.instance.Ta(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",xb.id,$b.toString())}0<Fb.length?gb.setPropertyObjectIds(xb,y.a.gf,Fb):xb.removeProperty(y.a.gf);Ga.og.add(m.a.zb(y.a.gf));return!0}u.a.instance.Ta(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Ga.Ng.value.yf.id,Fb);return!1}N6m(Ga,Fb,$b){const rb=new H.a,xb=new J.a(0);this.Htl(Ga,$b,rb,xb);return this.Hel(Fb,xb,rb)}Htl(Ga,Fb,$b,rb){Ga=Ga||new H.a;Fb=Fb||new H.a;Ga.forEach(xb=>{rb.Z(xb,1);return!0});Fb.forEach(xb=>{rb.Ec(xb).returnValue?rb.Z(xb,2):(rb.Z(xb,0),$b.add(xb));return!0})}Hel(Ga,Fb,$b){Ga=Ga||new H.a;const rb=new H.a,xb=new H.a,gb=new H.a;Ga.forEach(Gb=>{let ac=!0,hc;({value:hc}=Fb.Ec(Gb)).returnValue&&(0===hc?Fb.Z(Gb,2):1===hc&&(ac=!1));ac?rb.add(Gb):this.iWd&&xb.add(Gb);return!0});
$b.forEach(Gb=>{let ac=!1,hc;({value:hc}=Fb.Ec(Gb)).returnValue?0===hc&&(ac=!0,Fb.Z(Gb,2)):u.a.instance.Ta(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",Gb);ac?rb.add(Gb):this.iWd&&gb.add(Gb);return!0});this.fEi(xb,"Favored");this.fEi(gb,"Unfavored");return rb}fEi(Ga,Fb){if(Ga.length){var $b=new Sys.StringBuilder;for(let rb=0;rb<Ga.length;rb++)$b.append(Ga.J(rb).toString()+",");u.a.instance.Ta(561637572,
1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",Fb,$b.toString())}}static jh(){return new W}static get instance(){return W.Kg.value}}W.Kg=new a.a(W.jh);Object(D.a)(W,"CommentContentNodeComplexMerge",k.a,[]);var V=c(1828);class Y extends k.a{constructor(){super()}get Jn(){return 8}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.jaa),3);Ga.Z(m.a.zb(l.a.wE),3);Ga.Z(m.a.zb(l.a.OFc),2);Ga.Z(m.a.zb(l.a.commentId),2);Ga.Z(m.a.zb(l.a.LCh),2);Ga.Z(m.a.zb(l.a.qCa),2);Ga.Z(m.a.zb(l.a.aNa),1);Ga.Z(m.a.zb(l.a.Ahb),
1);Ga.Z(m.a.zb(l.a.Aib),1);Ga.Z(m.a.zb(l.a.a7),1);Ga.Z(m.a.zb(l.a.jG),1);Ga.Z(m.a.zb(l.a.NFc),2);Ga.Z(m.a.zb(l.a.nDd),2);Ga.Z(m.a.zb(l.a.R1b),2);Ga.Z(m.a.zb(l.a.v6e),2);Ga.Z(m.a.zb(l.a.QL),1);Ga.Z(m.a.zb(y.a.gf),0);Ga.Z(m.a.zb(l.a.gH),0);return Ga}GB(Ga,Fb){if(Fb===m.a.zb(l.a.QL)){var $b=Ga.Xd.getPropertyString(Ga.pn.value.yf,l.a.QL);this.mf($b)?Ga.Sk.removeProperty(l.a.QL):Ga.Sk.cya(l.a.QL,$b);return!0}if(Fb!==m.a.zb(l.a.aNa)&&Fb!==m.a.zb(l.a.Ahb)&&Fb!==m.a.zb(l.a.Aib)&&Fb!==m.a.zb(l.a.jG)&&Fb!==
m.a.zb(l.a.a7))return!1;var rb=Ga.Ng.value.yf,xb=Ga.pn.value.yf;$b=Ga.Sk;if(Fb===m.a.zb(l.a.aNa)){rb=Ga.Xd.getPropertyString(rb,l.a.aNa);xb=Ga.Xd.getPropertyString(xb,l.a.aNa);xb=this.mf(rb)?xb:this.mf(xb)?rb:null;if(this.mf(xb))return!0;Ga.Xd.setPropertyString($b,l.a.aNa,xb);Ga.og.add(m.a.zb(l.a.aNa));return!0}if(Fb===m.a.zb(l.a.Aib))return rb=Ga.Xd.getPropertyBool(rb,l.a.Aib),xb=Ga.Xd.getPropertyBool(xb,l.a.Aib),rb=null!=rb?rb:!1,rb=(null!=xb?xb:!1)||rb,Ga.Xd.setPropertyBool($b,l.a.Aib,rb),Ga.og.add(m.a.zb(l.a.Aib)),
!0;if(Fb===m.a.zb(l.a.Ahb)){rb=Ga.Xd.getPropertyBool(rb,l.a.Ahb);xb=Ga.Xd.getPropertyBool(xb,l.a.Ahb);if(rb===xb)return!0;rb=null!=rb?rb:!1;rb=(null!=xb?xb:!1)||rb;Ga.Xd.setPropertyBool($b,l.a.Ahb,rb);return!0}if(Fb===m.a.zb(l.a.jG)){rb=Ga.Xd.getPropertyBool(rb,l.a.jG);xb=Ga.Xd.getPropertyBool(xb,l.a.jG);if(rb===xb)return!0;rb=null!=rb?rb:!1;rb=(null!=xb?xb:!1)||rb;Ga.Xd.setPropertyBool($b,l.a.jG,rb);Ga.og.add(m.a.zb(l.a.jG));return!0}if(Fb===m.a.zb(l.a.a7)){Fb=Ga.Zp.runtime.Xb;Fb.pB(V.a.MVk);if(!Fb.isFeatureEnabled(V.a.MVk))return!1;
rb=Ga.Xd.getPropertyString(rb,l.a.a7);xb=Ga.Xd.getPropertyString(xb,l.a.a7);if(rb===xb)return!0;Ga.Xd.setPropertyString($b,l.a.a7,xb||rb);Ga.og.add(m.a.zb(l.a.a7));return!0}return!1}mf(Ga){return Ga&&Ga.length?!1:!0}static jh(){return new Y}static get instance(){return Y.Kg.value}}Y.Kg=new a.a(Y.jh);Object(D.a)(Y,"CommentNodeComplexMerge",k.a,[]);class da extends k.a{constructor(){super()}get Jn(){return 46}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.contentControlNode),1);Ga.Z(m.a.zb(y.a.lastModifiedTime),
0);Ga.Z(m.a.zb(l.a.oGc),2);return Ga}GB(Ga,Fb){if(Fb===m.a.zb(l.a.contentControlNode))return u.a.instance.Ta(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ga.Sk.id,Ga.Sk.Nc,Fb),k.a.pKf(Ga,this,l.a.contentControlNode);u.a.instance.Ta(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Ga.Ng.value.yf.id,Fb);return!1}static jh(){return new da}static get instance(){return da.Kg.value}}
da.Kg=new a.a(da.jh);Object(D.a)(da,"ContentControlContainerNodeComplexMerge",k.a,[]);var ba=c(60),ja=c(1749);class sa extends k.a{constructor(){super()}get Jn(){return 37}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.d7),1);Ga.Z(m.a.zb(l.a.Rob),1);Ga.Z(m.a.zb(l.a.mEd),2);Ga.Z(m.a.zb(l.a.k2b),2);Ga.Z(m.a.zb(l.a.contentControlNode),1);Ga.Z(m.a.zb(l.a.c8),1);Ga.Z(m.a.zb(l.a.Xea),1);Ga.Z(m.a.zb(l.a.n2b),1);Ga.Z(m.a.zb(l.a.heb),1);Ga.Z(m.a.zb(l.a.feb),1);Ga.Z(m.a.zb(l.a.eeb),1);Ga.Z(m.a.zb(l.a.E7e),2);Ga.Z(m.a.zb(l.a.Vzb),
1);Ga.Z(m.a.zb(l.a.nEd),1);Ga.Z(m.a.zb(l.a.c7),1);this.Xb.isFeatureEnabled(26)&&(Ga.Z(m.a.zb(l.a.IX),2),Ga.Z(m.a.zb(l.a.kua),2),Ga.Z(m.a.zb(l.a.Vla),2),Ga.Z(m.a.zb(l.a.x3),1),Ga.Z(m.a.zb(l.a.vna),1),Ga.Z(m.a.zb(l.a.wna),1));return Ga}GB(Ga,Fb){var $b=Ga.Ng.value.yf,rb=Ga.pn.value.yf;const xb=Ga.Sk;if(Fb===m.a.zb(l.a.contentControlNode))return k.a.pKf(Ga,this,l.a.contentControlNode);if(Fb===m.a.zb(l.a.c8)){Fb=Ga.Xd.getPropertyBool($b,l.a.c8);rb=Ga.Xd.getPropertyBool(rb,l.a.c8);if(null!=Fb&&Fb||null!=
rb&&rb)Ga.Xd.setPropertyBool(xb,l.a.c8,!0),Ga.og.add(m.a.zb(l.a.c8));return!0}if(Fb===m.a.zb(l.a.Xea))return Fb=Ga.Xd.getPropertyBool($b,l.a.Xea),rb=Ga.Xd.getPropertyBool(rb,l.a.Xea),Ga.Xd.setPropertyBool(xb,l.a.Xea,null!=Fb&&!!Fb&&null!=rb&&!!rb),Ga.og.add(m.a.zb(l.a.Xea)),!0;if(Fb===m.a.zb(l.a.n2b))return Fb=Ga.Xd.getPropertyUint32(rb,l.a.n2b),null!=Fb&&(Ga.Xd.setPropertyUint32(xb,l.a.n2b,Fb),Ga.og.add(m.a.zb(l.a.n2b))),!0;if(Fb===m.a.zb(l.a.heb)||Fb===m.a.zb(l.a.feb)||Fb===m.a.zb(l.a.eeb))return(rb=
Ga.Xd.getPropertyString(rb,m.a.dX(Fb)))&&0<rb.length&&(Ga.Xd.setPropertyString(xb,m.a.dX(Fb),rb),Ga.og.add(Fb)),!0;if(Fb===m.a.zb(l.a.Vzb)||Fb===m.a.zb(l.a.nEd)){$b=Ga.Xd.getPropertyObjectId($b,m.a.dX(Fb));if(ja.a.x6b(Ga.Zp,$b))return!0;if((rb=Ga.Xd.getPropertyObjectId(rb,m.a.dX(Fb)))&&rb!==ba.a.nil)return Ga.Xd.setPropertyObjectId(xb,m.a.dX(Fb),rb),Ga.og.add(Fb),!0;xb.removeProperty(m.a.dX(Fb));Ga.og.add(Fb);return!0}if(Fb===m.a.zb(l.a.c7)){$b=Ga.Xd.getPropertyObjectId($b,l.a.c7);if(($b=ja.a.x6b(Ga.Zp,
$b))&&Ga.Xd.getPropertyObjectIds($b,l.a.contentControlNode).zG().contains(Ga.Sk.id))return!0;rb=Ga.Xd.getPropertyObjectId(rb,l.a.c7);return($b=ja.a.x6b(Ga.Zp,rb))&&Ga.Xd.getPropertyObjectIds($b,l.a.contentControlNode).zG().contains(Ga.Sk.id)?(Ga.Xd.setPropertyObjectId(xb,l.a.c7,rb),Ga.og.add(Fb),!0):!1}if(Fb===m.a.zb(l.a.d7))return Fb=Ga.Xd.getPropertyBool(rb,l.a.d7),null==Fb||Fb||(Ga.Xd.setPropertyBool(xb,l.a.d7,!1),Ga.og.add(m.a.zb(l.a.d7))),!0;if(Fb===m.a.zb(l.a.Rob)){Fb=Ga.Xd.getPropertyObjectId($b,
l.a.Rob);rb=Ga.Xd.getPropertyObjectId(rb,l.a.Rob);if(Fb&&!Fb.equals(rb))return!1;if(Fb=Fb||rb)Ga.Xd.setPropertyObjectId(xb,l.a.Rob,Fb),Ga.og.add(m.a.zb(l.a.Rob));return!0}!this.Xb.isFeatureEnabled(26)||Fb!==m.a.zb(l.a.x3)&&Fb!==m.a.zb(l.a.vna)&&Fb!==m.a.zb(l.a.wna)||u.a.instance.Ta(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",Fb);return!1}static jh(){return new sa}static get instance(){return sa.Kg.value}}sa.Kg=new a.a(sa.jh);
Object(D.a)(sa,"ContentControlNodeComplexMerge",k.a,[]);class ta extends k.a{constructor(){super()}get Jn(){return 10}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.customXmlPartNode),1);return Ga}GB(Ga,Fb){if(Fb===m.a.zb(l.a.customXmlPartNode)){Fb=Ga.Sk;const rb=Ga.Xd;var $b=rb.getPropertyObjectIds(Ga.Ng.value.Bu,l.a.customXmlPartNode);const xb=rb.getPropertyObjectIds(Ga.Ng.value.yf,l.a.customXmlPartNode),gb=rb.getPropertyObjectIds(Ga.pn.value.yf,l.a.customXmlPartNode);$b=this.S6m($b,xb,gb);0<$b.length?
rb.setPropertyObjectIds(Fb,l.a.customXmlPartNode,$b):Fb.removeProperty(l.a.customXmlPartNode);Ga.og.add(m.a.zb(l.a.customXmlPartNode));return!0}return!1}S6m(Ga,Fb,$b){return this.DFa(Ga,Fb,$b)}static jh(){return new ta}static get instance(){return ta.Kg.value}}ta.Kg=new a.a(ta.jh);Object(D.a)(ta,"CustomXmlPartContainerNodeComplexMerge",k.a,[]);class ra extends k.a{constructor(){super()}get Jn(){return 9}get Rz(){return 0}static jh(){return new ra}static get instance(){return ra.Kg.value}}ra.Kg=new a.a(ra.jh);
Object(D.a)(ra,"CustomXmlPartNodeComplexMerge",k.a,[]);class ma extends k.a{constructor(){super()}get Jn(){return 29}get Rz(){return 3}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.embeddedFontNode),1);return Ga}GB(Ga,Fb){if(Fb===m.a.zb(l.a.embeddedFontNode)){Fb=Ga.Xd;var $b=Fb.getPropertyObjectIds(Ga.Ng.value.Bu,l.a.embeddedFontNode),rb=Fb.getPropertyObjectIds(Ga.Ng.value.yf,l.a.embeddedFontNode);const xb=Fb.getPropertyObjectIds(Ga.pn.value.yf,l.a.embeddedFontNode);$b=this.DFa($b,rb,xb);rb=Ga.Sk;0<$b.length?
Fb.setPropertyObjectIds(rb,l.a.embeddedFontNode,$b):rb.removeProperty(l.a.embeddedFontNode);Ga.og.add(m.a.zb(l.a.embeddedFontNode));return!0}return!1}static jh(){return new ma}static get instance(){return ma.Kg.value}}ma.Kg=new a.a(ma.jh);Object(D.a)(ma,"EmbeddedFontContainerNodeComplexMerge",k.a,[]);class Ba extends k.a{constructor(){super()}get Jn(){return 30}get Rz(){return 3}static jh(){return new Ba}static get instance(){return Ba.Kg.value}}Ba.Kg=new a.a(Ba.jh);Object(D.a)(Ba,"EmbeddedFontNodeComplexMerge",
k.a,[]);class Pa extends k.a{constructor(){super()}get Jn(){return 11}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.C7),4);Ga.Z(m.a.zb(l.a.M_a),1);return Ga}GB(Ga,Fb){if(Fb===m.a.zb(l.a.M_a)){const $b=Ga.Sk,rb=Ga.Xd;u.a.instance.Ta(4063307,1,4,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",$b.id,$b.Nc,Fb);Fb=rb.getPropertyObjectIds(Ga.Ng.value.Bu,l.a.M_a);const xb=rb.getPropertyObjectIds(Ga.Ng.value.yf,l.a.M_a),gb=rb.getPropertyObjectIds(Ga.pn.value.yf,
l.a.M_a);Fb=this.MHi(Fb,xb,gb,(Gb,ac)=>Gb.equals(ac));0<Fb.length?rb.setPropertyObjectIds($b,l.a.M_a,Fb):$b.removeProperty(l.a.M_a);Ga.og.add(m.a.zb(l.a.M_a));return!0}u.a.instance.Ta(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ga.Ng.value.yf.id,Fb);return!1}static jh(){return new Pa}static get instance(){return Pa.Kg.value}}Pa.Kg=new a.a(Pa.jh);Object(D.a)(Pa,"FootnoteEndnoteContainerNodeComplexMerge",
k.a,[]);class Da extends k.a{constructor(){super()}get Jn(){return 12}get Rz(){return 3}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.uma),1);return Ga}GB(Ga,Fb){const $b=Ga.Sk,rb=Ga.Xd;if(Fb===m.a.zb(l.a.uma)){let xb=-1;u.a.instance.Ta(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",$b.id,$b.Nc,Fb);const gb=rb.getPropertyInt32(Ga.Ng.value.yf,l.a.uma),Gb=rb.getPropertyInt32(Ga.pn.value.yf,l.a.uma);null!=gb&&-1!==gb?xb=gb:null!=Gb&&
(xb=Gb);rb.setPropertyInt32($b,l.a.uma,xb);Ga.og.add(Fb);return!0}u.a.instance.Ta(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ga.Ng.value.Bu.id,Fb);return!1}static jh(){return new Da}static get instance(){u.a.instance.Ta(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");return Da.Kg.value}}Da.Kg=new a.a(Da.jh);Object(D.a)(Da,"FootnoteEndnoteNodeComplexMerge",k.a,[]);class Ha extends k.a{constructor(){super()}get Jn(){return 47}rk(){const Ga=
super.rk();Ga.Z(m.a.zb(l.a.glossaryPageContentNode),1);return Ga}GB(Ga,Fb){return Fb===m.a.zb(l.a.glossaryPageContentNode)?(u.a.instance.Ta(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ga.Sk.id,Ga.Sk.Nc,Fb),k.a.pKf(Ga,this,l.a.glossaryPageContentNode)):!1}static jh(){return new Ha}static get instance(){return Ha.Kg.value}}Ha.Kg=new a.a(Ha.jh);Object(D.a)(Ha,"GlossaryPageManifestNodeComplexMerge",k.a,[]);class oa extends k.a{constructor(){super()}get Jn(){return 13}get Rz(){return 3}rk(){const Ga=
super.rk();Ga.Z(m.a.zb(l.a.Xha),4);return Ga}static jh(){return new oa}static get instance(){return oa.Kg.value}}oa.Kg=new a.a(oa.jh);Object(D.a)(oa,"HeaderFooterContainerNodeComplexMerge",k.a,[]);class wa extends k.a{constructor(){super()}get Jn(){return 14}get Rz(){return 3}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.runId),3);Ga.Z(m.a.zb(l.a.Lc),3);Ga.Z(m.a.zb(l.a.Ppi),3);Ga.Z(m.a.zb(l.a.WT),1);Ga.Z(m.a.zb(e.a.l_),1);Ga.Z(m.a.zb(y.a.imageAltText),1);Ga.Z(m.a.zb(l.a.xX),1);Ga.Z(m.a.zb(y.a.aca),1);
Ga.Z(m.a.zb(e.a.C7a),1);Ga.Z(m.a.zb(l.a.sYa),1);return Ga}GB(Ga,Fb){if(Fb===m.a.zb(y.a.imageAltText)||Fb===m.a.zb(l.a.xX)||Fb===m.a.zb(l.a.WT)||Fb===m.a.zb(l.a.yX)||Fb===m.a.zb(y.a.Mhb)||Fb===m.a.zb(y.a.aca)||Fb===m.a.zb(e.a.l_)||Fb===m.a.zb(e.a.C7a)||Fb===m.a.zb(l.a.sYa)){const rb=Ga.Sk;var $b=Ga.Xd;u.a.instance.Ta(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",rb.id,rb.Nc,Fb);const xb=$b.getPropertyInt32(Ga.Ng.value.yf,e.a.l_);$b=$b.getPropertyInt32(Ga.pn.value.yf,
e.a.l_);if(null!=xb&&(0===xb||2===xb))return!0;if(null!=$b&&(0===$b||2===$b))return Fb=Ga.pn.value.yf,this.meb(Fb,rb,y.a.imageAltText),this.meb(Fb,rb,l.a.xX),this.meb(Fb,rb,l.a.yX),Fb.hasProperty(l.a.WT)&&this.meb(Fb,rb,l.a.WT),this.meb(Fb,rb,y.a.Mhb),this.meb(Fb,rb,y.a.aca),this.meb(Fb,rb,e.a.l_),this.meb(Fb,rb,e.a.C7a),Ga.og.add(m.a.zb(y.a.imageAltText)),Ga.og.add(m.a.zb(l.a.xX)),Ga.og.add(m.a.zb(l.a.yX)),Ga.og.add(m.a.zb(l.a.WT)),Ga.og.add(m.a.zb(y.a.Mhb)),Ga.og.add(m.a.zb(y.a.aca)),Ga.og.add(m.a.zb(e.a.l_)),
Ga.og.add(m.a.zb(e.a.C7a)),Ga.og.add(m.a.zb(l.a.sYa)),!0}u.a.instance.Ta(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ga.Ng.value.Bu.id,Fb);return!1}static jh(){return new wa}static get instance(){return wa.Kg.value}}wa.Kg=new a.a(wa.jh);Object(D.a)(wa,"ImageNodeComplexMerge",k.a,[]);class ia extends k.a{constructor(){super()}get Jn(){return 40}get Rz(){return 0}static jh(){return new ia}static get instance(){return ia.Kg.value}}
ia.Kg=new a.a(ia.jh);Object(D.a)(ia,"IntelligenceAnnotationNodeComplexMerge",k.a,[]);class ca extends k.a{constructor(){super()}get Jn(){return 32}get Rz(){return 0}static jh(){return new ca}static get instance(){return ca.Kg.value}}ca.Kg=new a.a(ca.jh);Object(D.a)(ca,"IntelligenceContentLocatorNodeComplexMerge",k.a,[]);class pa extends k.a{constructor(){super()}get Jn(){return 34}get Rz(){return 0}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.pib),1);return Ga}GB(Ga,Fb){const $b=Ga.Sk,rb=Ga.Xd;if(Fb===
m.a.zb(l.a.pib)){Fb=rb.getPropertyObjectIds(Ga.Ng.value.Bu,l.a.pib);const xb=rb.getPropertyObjectIds(Ga.Ng.value.yf,l.a.pib),gb=rb.getPropertyObjectIds(Ga.pn.value.yf,l.a.pib);Fb=this.DFa(Fb,xb,gb);rb.setPropertyObjectIds($b,l.a.pib,Fb);Ga.og.add(m.a.zb(l.a.pib));return!0}return!1}static jh(){return new pa}static get instance(){return pa.Kg.value}}pa.Kg=new a.a(pa.jh);Object(D.a)(pa,"IntelligenceRegionNodeComplexMerge",k.a,[]);class Ma extends k.a{constructor(){super()}get Jn(){return 35}get Rz(){return 0}static jh(){return new Ma}static get instance(){return Ma.Kg.value}}
Ma.Kg=new a.a(Ma.jh);Object(D.a)(Ma,"IntelligenceRejectionNodeComplexMerge",k.a,[]);class ya extends k.a{constructor(){super()}get Jn(){return 39}get Rz(){return 0}static jh(){return new ya}static get instance(){return ya.Kg.value}}ya.Kg=new a.a(ya.jh);Object(D.a)(ya,"IntelligenceReviewedNodeComplexMerge",k.a,[]);class Oa extends k.a{constructor(){super()}get Jn(){return 33}get Rz(){return 0}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.FRc),1);Ga.Z(m.a.zb(l.a.fVd),1);Ga.Z(m.a.zb(l.a.wyf),1);Ga.Z(m.a.zb(l.a.yyf),
1);return Ga}GB(Ga,Fb){const $b=Ga.Sk,rb=Ga.Xd;if(Fb===m.a.zb(l.a.FRc)||Fb===m.a.zb(l.a.fVd)||Fb===m.a.zb(l.a.wyf)||Fb===m.a.zb(l.a.yyf)){Fb=Fb===m.a.zb(l.a.FRc)?l.a.FRc:l.a.fVd;var xb=rb.getPropertyObjectIds(Ga.Ng.value.Bu,Fb);const gb=rb.getPropertyObjectIds(Ga.Ng.value.yf,Fb),Gb=rb.getPropertyObjectIds(Ga.pn.value.yf,Fb);xb=this.DFa(xb,gb,Gb);rb.setPropertyObjectIds($b,Fb,xb);Ga.og.add(m.a.zb(Fb));return!0}return!1}static jh(){return new Oa}static get instance(){return Oa.Kg.value}}Oa.Kg=new a.a(Oa.jh);
Object(D.a)(Oa,"IntelligenceRootNodeComplexMerge",k.a,[]);class fa extends k.a{constructor(){super()}get Jn(){return 42}get Rz(){return 0}static jh(){return new fa}static get instance(){return fa.Kg.value}}fa.Kg=new a.a(fa.jh);Object(D.a)(fa,"IntelligenceSettingNodeComplexMerge",k.a,[]);class Ca extends k.a{constructor(){super()}get Jn(){return 45}get Rz(){return 0}static jh(){return new Ca}static get instance(){return Ca.Kg.value}}Ca.Kg=new a.a(Ca.jh);Object(D.a)(Ca,"IntelligenceWorkflowNodeComplexMerge",
k.a,[]);class Ta extends k.a{constructor(){super()}get Jn(){return 15}get Rz(){return 3}static jh(){return new Ta}static get instance(){return Ta.Kg.value}}Ta.Kg=new a.a(Ta.jh);Object(D.a)(Ta,"NumberListNodeComplexMerge",k.a,[]);var eb=c(123);class jb extends k.a{constructor(){super()}get Jn(){return 16}get Rz(){return 0}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.xyb),1);Ga.Z(m.a.zb(eb.a.D6e),7);Ga.Z(m.a.zb(eb.a.B6e),7);return Ga}GB(Ga,Fb){const $b=Ga.Sk,rb=Ga.Xd;if(Fb===m.a.zb(l.a.xyb))return this.iFf(rb,
Ga.Ng.value.yf,Ga.pn.value.yf,$b,l.a.xyb),Ga.og.add(Fb),!0;u.a.instance.Ta(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ga.Ng.value.Bu.id,Fb);return!1}static jh(){return new jb}static get instance(){return jb.Kg.value}}jb.Kg=new a.a(jb.jh);Object(D.a)(jb,"OutlineElementNodeComplexMerge",k.a,[]);class ob extends k.a{constructor(){super()}get Jn(){return 17}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.xyb),1);
Ga.Z(m.a.zb(l.a.ama),1);Ga.Z(m.a.zb(eb.a.HI),1);Ga.Z(m.a.zb(eb.a.nbc),1);Ga.Z(m.a.zb(eb.a.oha),8);return Ga}GB(Ga,Fb){const $b=Ga.Sk,rb=Ga.Xd;if(Fb===m.a.zb(l.a.xyb))return this.iFf(rb,Ga.Ng.value.yf,Ga.pn.value.yf,$b,l.a.xyb),Ga.og.add(Fb),!0;if(Fb===m.a.zb(l.a.ama)){var xb=rb.getPropertyBool(Ga.Ng.value.yf,l.a.ama),gb=rb.getPropertyBool(Ga.pn.value.yf,l.a.ama);rb.setPropertyBool($b,l.a.ama,null==xb?!1:xb&&null==gb?!1:gb);Ga.og.add(Fb);return!0}if(Fb===m.a.zb(eb.a.nbc))return this.iFf(rb,Ga.Ng.value.yf,
Ga.pn.value.yf,$b,eb.a.nbc),Ga.og.add(Fb),!0;if(Fb===m.a.zb(eb.a.HI))return xb=rb.getPropertyBool(Ga.Ng.value.yf,eb.a.HI),gb=rb.getPropertyBool(Ga.pn.value.yf,eb.a.HI),rb.setPropertyBool($b,eb.a.HI,null==xb?!0:xb||null==gb?!0:gb),Ga.og.add(Fb),!0;u.a.instance.Ta(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ga.Ng.value.Bu.id,Fb);return!1}static jh(){return new ob}static get instance(){return ob.Kg.value}}ob.Kg=
new a.a(ob.jh);Object(D.a)(ob,"OutlineGroupNodeComplexMerge",k.a,[]);var Ya=c(44),Xa=c(46);class Sa extends k.a{constructor(){super()}get Jn(){return 18}get Rz(){return 2}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.gTd),3);Ga.Z(m.a.zb(y.a.Tba),this.Rz);Ga.Z(m.a.zb(l.a.Ut),1);Ga.Z(m.a.zb(l.a.G8),1);Ga.Z(m.a.zb(l.a.uq),1);Ga.Z(m.a.zb(Ya.a.aJ),1);Ga.Z(m.a.zb(Ya.a.N3a),1);return Ga}GB(Ga,Fb){const $b=Ga.Xd;if(Ga.Zp.runtime.Xb.isFeatureEnabled(70)){if(Fb===m.a.zb(l.a.Ut)||Fb===m.a.zb(l.a.G8)||Fb===m.a.zb(Ya.a.N3a)||
Fb===m.a.zb(l.a.uq)||Fb===m.a.zb(Ya.a.aJ))return this.lIo($b,Ga)}else if(Fb===m.a.zb(l.a.Ut)||Fb===m.a.zb(l.a.uq)){let rb,xb;({dGc:Fb,c2a:rb,T1a:xb}=this.G4e(Object(Xa.a)($b,$b.getPropertyUint32s,"getPropertyUint32s"),Ga.Ng.value.Bu,Ga.Ng.value.yf,Ga.pn.value.yf,l.a.Ut,null));if(!xb&&!rb)return u.a.instance.Ta(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Ga.Ng.value.yf.id,m.a.zb(l.a.Ut)),!0;let gb,Gb,ac;({dGc:gb,
c2a:Gb,T1a:ac}=this.G4e(Object(Xa.a)($b,$b.getPropertyObjectIds,"getPropertyObjectIds"),Ga.Ng.value.Bu,Ga.Ng.value.yf,Ga.pn.value.yf,l.a.uq,null));if(!Gb&&!ac)return u.a.instance.Ta(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Ga.Ng.value.yf.id,m.a.zb(l.a.uq)),!0;const hc=Gb&&!ac;if((rb&&!xb)!==hc)return u.a.instance.Ta(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Ga.Ng.value.yf.id,m.a.zb(l.a.Ut),m.a.zb(l.a.uq)),!1;hc&&($b.setPropertyObjectIds(Ga.Sk,l.a.uq,gb),$b.setPropertyUint32s(Ga.Sk,l.a.Ut,Fb));u.a.instance.Ta(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",Ga.Ng.value.yf.id,m.a.zb(l.a.Ut),rb,xb,m.a.zb(l.a.uq),Gb,ac);Ga.og.add(m.a.zb(l.a.uq));Ga.og.add(m.a.zb(l.a.Ut));
return!0}u.a.instance.Ta(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ga.Ng.value.yf.id,Fb);return!1}Wii(Ga,Fb,$b,rb){let xb;({dGc:Fb,c2a:rb,T1a:xb}=this.G4e(Fb,$b.Ng.value.Bu,$b.Ng.value.yf,$b.pn.value.yf,Ga,rb));return xb||rb?{returnValue:!0,Z6e:Fb,c2a:rb,T1a:xb}:(u.a.instance.Ta(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
$b.Ng.value.yf.id.toString(),m.a.zb(Ga)),{returnValue:!1,Z6e:Fb,c2a:rb,T1a:xb})}Yhi(Ga,Fb,$b,rb,xb){let gb;let Gb,ac,hc,Ec;({Z6e:gb,c2a:Uc,T1a:Gb,returnValue:hc}=this.Wii(Ga,Object(Xa.a)($b,$b.getPropertyUint32s,"getPropertyUint32s"),rb,null));({Z6e:$b,c2a:xb,T1a:ac,returnValue:Ec}=this.Wii(Fb,Object(Xa.a)($b,$b.getPropertyObjectIds,"getPropertyObjectIds"),rb,xb));var Uc=Uc&&!Gb;return hc&&Ec?Uc!==(xb&&!ac)?(u.a.instance.Ta(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
rb.Ng.value.yf.id.toString(),m.a.zb(Ga),m.a.zb(Fb)),{returnValue:2,UDd:gb,TDd:$b,kje:Uc}):{returnValue:0,UDd:gb,TDd:$b,kje:Uc}:{returnValue:1,UDd:gb,TDd:$b,kje:Uc}}wAf(Ga){let Fb=!0;Ga.forEach($b=>$b!==ba.a.nil?Fb=!1:!0);return Fb}jOl(Ga,Fb,$b){return this.wAf(Ga)&&this.wAf(Fb)&&this.wAf($b)?!0:!1}lIo(Ga,Fb){let $b,rb,xb,gb,Gb,ac;var hc=({UDd:gb,TDd:Gb,kje:rb}=this.Yhi(Ya.a.N3a,l.a.uq,Ga,Fb,null)).returnValue;if(2===hc||1===hc)return!0;({UDd:xb,TDd:ac,kje:$b,returnValue:hc}=this.Yhi(l.a.Ut,l.a.G8,
Ga,Fb,Object(Xa.a)(this,this.jOl,"getExtendedGuidEquivalence")));if(2===hc||1===hc)return!0;let Ec;({dGc:hc,c2a:Uc,T1a:Ec}=this.xOk(Object(Xa.a)(Ga,Ga.getPropertyDictionary,"getPropertyDictionary"),Fb.Ng.value.Bu,Fb.Ng.value.yf,Fb.pn.value.yf,Ya.a.aJ));if(!Ec&&!Uc)return u.a.instance.Ta(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Fb.Ng.value.yf.id.toString(),m.a.zb(Ya.a.aJ)),!0;var Uc=Uc&&!Ec;if($b!==rb||$b!==
Uc)return u.a.instance.Ta(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",Fb.Ng.value.yf.id.toString(),m.a.zb(l.a.Ut),m.a.zb(Ya.a.N3a),m.a.zb(Ya.a.aJ),rb,$b,Uc),!0;$b&&(Ga.setPropertyObjectIds(Fb.Sk,l.a.uq,Gb),Ga.setPropertyUint32s(Fb.Sk,Ya.a.N3a,gb),Ga.setPropertyObjectIds(Fb.Sk,
l.a.G8,ac),Ga.setPropertyUint32s(Fb.Sk,l.a.Ut,xb),Ga.setPropertyDictionary(Fb.Sk,Ya.a.aJ,hc));u.a.instance.Ta(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",Fb.Ng.value.yf.id.toString(),rb,$b,Uc);Fb.og.add(m.a.zb(Ya.a.N3a));Fb.og.add(m.a.zb(l.a.uq));Fb.og.add(m.a.zb(l.a.Ut));Fb.og.add(m.a.zb(l.a.G8));Fb.og.add(m.a.zb(Ya.a.aJ));return!0}static jh(){return new Sa}static get instance(){return Sa.Kg.value}}
Sa.Kg=new a.a(Sa.jh);Object(D.a)(Sa,"PageContentNodeComplexMerge",k.a,[]);class ab extends k.a{constructor(){super()}get Jn(){return 19}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.iHa),1);Ga.Z(m.a.zb(l.a.appsNode),2);Ga.Z(m.a.zb(l.a.customXmlPartContainerNode),2);Ga.Z(m.a.zb(l.a.intelligenceRootNode),1);return Ga}GB(Ga,Fb){const $b=Ga.Xd;if(Fb===m.a.zb(l.a.iHa)){var rb=$b.getPropertyObjectIds(Ga.Ng.value.Bu,l.a.iHa),xb=$b.getPropertyObjectIds(Ga.Ng.value.yf,l.a.iHa),gb=$b.getPropertyObjectIds(Ga.pn.value.yf,
l.a.iHa);if((rb=this.g7m(rb,xb,gb,(Gb,ac)=>Gb.equals(ac),Gb=>{let ac;({value:ac}=Ga.Zp.runtime.zq.Ec(Gb)).returnValue?Ga.Zp.runtime.Xm.Z(Gb,new z.a(ac,!1)):u.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},Ga.Zp))&&0<rb.length)return $b.setPropertyObjectIds(Ga.Sk,l.a.iHa,rb),Ga.og.add(m.a.zb(l.a.iHa)),!0}if(Fb===m.a.zb(l.a.intelligenceRootNode))return rb=$b.getPropertyObjectIds(Ga.Ng.value.Bu,l.a.intelligenceRootNode),
xb=$b.getPropertyObjectIds(Ga.Ng.value.yf,l.a.intelligenceRootNode),gb=$b.getPropertyObjectIds(Ga.pn.value.yf,l.a.intelligenceRootNode),rb=this.DFa(rb,xb,gb),$b.setPropertyObjectIds(Ga.Sk,l.a.intelligenceRootNode,rb),Ga.og.add(Fb),!0;u.a.instance.Ta(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ga.Ng.value.yf.id,Fb);return!1}static jh(){return new ab}static get instance(){return ab.Kg.value}}ab.Kg=new a.a(ab.jh);
Object(D.a)(ab,"PageManifestNodeComplexMerge",k.a,[]);class Hb extends k.a{constructor(){super()}get Jn(){return 43}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.bla),0);Ga.Z(m.a.zb(l.a.rKb),0);Ga.Z(m.a.zb(l.a.TGb),0);Ga.Z(m.a.zb(l.a.dna),1);Ga.Z(m.a.zb(l.a.sessionId),3);Ga.Z(m.a.zb(l.a.buildVersion),3);Ga.Z(m.a.zb(l.a.UX),1);Ga.Z(m.a.zb(l.a.iti),1);Ga.Z(m.a.zb(l.a.Yu),1);return Ga}GB(Ga,Fb){if(Fb===m.a.zb(l.a.UX)||Fb===m.a.zb(l.a.iti)||Fb===m.a.zb(l.a.Yu)){var $b=Ga.pn.value.yf,rb=Ga.Ng.value.yf,xb=m.a.dX(Fb);
rb=Ga.Xd.getPropertyBool(rb,xb);$b=Ga.Xd.getPropertyBool($b,xb);Ga.Xd.setPropertyBool(Ga.Sk,xb,null==rb?!1:rb&&null==$b?!1:$b);Ga.og.add(Fb);return!0}if(Fb===m.a.zb(l.a.dna)){Fb=Ga.Xd;$b=Ga.Ng.value.Bu;rb=Ga.pn.value.yf;xb=Ga.Ng.value.yf;$b=$b?Fb.getPropertyObjectId($b,l.a.dna):null;rb=rb?Fb.getPropertyObjectId(rb,l.a.dna):null;xb=xb?Fb.getPropertyObjectId(xb,l.a.dna):null;u.a.instance.Ta(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",$b?$b.toString():
"NULL",rb?rb.toString():"NULL",xb?xb.toString():"NULL");if(rb){if(xb&&rb.equals(xb))return Ga.og.add(m.a.zb(l.a.dna)),Fb.setPropertyObjectId(Ga.Sk,l.a.dna,rb),!0;if(ja.a.GRd.equals(rb))return Ga.og.add(m.a.zb(l.a.dna)),Fb.setPropertyObjectId(Ga.Sk,l.a.dna,ja.a.GRd),!0}if(xb&&ja.a.GRd.equals(xb))return Ga.og.add(m.a.zb(l.a.dna)),Fb.setPropertyObjectId(Ga.Sk,l.a.dna,ja.a.GRd),!0;u.a.instance.Ta(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",$b?$b.toString():
"NULL",rb?rb.toString():"NULL",xb?xb.toString():"NULL")}return!1}static jh(){return new Hb}static get instance(){return Hb.Kg.value}}Hb.Kg=new a.a(Hb.jh);Object(D.a)(Hb,"PageMetadataNodeComplexMerge",k.a,[]);var pb=c(1760),Mb=c(108);class Qb extends k.a{constructor(){super()}get Jn(){return 31}rk(){const Ga=super.rk();Ga.Z(m.a.zb(Mb.a.lA),1);Ga.Z(m.a.zb(l.a.listID),3);Ga.Z(m.a.zb(l.a.listLevel),1);Ga.Z(m.a.zb(l.a.He),3);Ga.Z(m.a.zb(l.a.u0b),3);Ga.Z(m.a.zb(l.a.runId),3);Ga.Z(m.a.zb(l.a.nJd),3);Ga.Z(m.a.zb(y.a.fontColor),
3);Ga.Z(m.a.zb(l.a.GDh),3);Ga.Z(m.a.zb(l.a.Lc),1);Ga.Z(m.a.zb(Mb.a.dWd),3);Ga.Z(m.a.zb(Mb.a.XEf),3);Ga.Z(m.a.zb(Mb.a.gTc),3);Ga.Z(m.a.zb(l.a.izl),3);Ga.Z(m.a.zb(eb.a.Jxj),3);for(let Fb=0;Fb<Qb.b3a.length;Fb++)Ga.Z(Qb.b3a[Fb],1);return Ga}GB(Ga,Fb){var $b=Ga.Xd;const rb=Ga.Sk;m.a.dX(Fb);if(Fb===m.a.zb(l.a.Lc)){$b=Ga.Xd.getPropertyInt32(Ga.pn.value.yf,l.a.Lc);if(null==$b||!$b)return!0;Ga.Xd.setPropertyInt32(rb,l.a.Lc,$b);Ga.og.add(Fb);return!0}if(Fb===m.a.zb(Mb.a.lA)){const xb=$b.getPropertyUint32(Ga.Ng.value.yf,
Mb.a.lA),gb=$b.getPropertyUint32(Ga.pn.value.yf,Mb.a.lA);if(null!=xb&&null!=gb&&xb===gb)return $b.setPropertyUint32(rb,Mb.a.lA,xb),Ga.og.add(Fb),!0;if(null==xb&&null==gb)return rb.removeProperty(Mb.a.lA),Ga.og.add(m.a.zb(Mb.a.lA)),!0;if(null!=xb&&null==gb)return $b.setPropertyUint32(rb,Mb.a.lA,xb),Ga.og.add(Fb),!0;if(null==xb&&null!=gb)return $b.setPropertyUint32(rb,Mb.a.lA,gb),Ga.og.add(Fb),!0}else{if(Fb===m.a.zb(l.a.listLevel))return this.EHo($b,Ga);if(Array.contains(Qb.b3a,Fb))return this.DHo(Ga)}return!1}DHo(Ga){let Fb=
!0,$b=!0,rb,xb;({bCm:Fb,xzm:$b,usl:rb,AXk:xb}=this.yOk(Ga));u.a.instance.Ta(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",Ga.Ng.value.yf.id.toString(),Fb,$b);return Fb&&!$b?(this.AIi(xb,Ga),!0):Fb?!1:(this.AIi(rb,Ga),!0)}yOk(Ga){let Fb,$b,rb,xb;const gb=Ga.pn.value;let Gb;const ac=Ga.Ng.value;let hc;$b=Fb=!0;rb=new J.a;xb=new J.a;for(let Ec=0;Ec<Qb.b3a.length;Ec++){const Uc=Qb.b3a[Ec],dd=({value:Gb}=
gb.fpa.Ec(Uc)).returnValue;({value:hc}=ac.fpa.Ec(Uc)).returnValue&&(Fb=this.Rvj(Ga.Ng,rb,hc,Uc)&&Fb);dd&&($b=this.Rvj(Ga.pn,xb,Gb,Uc)&&$b)}return{bCm:Fb,xzm:$b,usl:rb,AXk:xb}}Rvj(Ga,Fb,$b,rb){const xb=m.a.dX(rb);Ga=Ga.value.yf;Fb.Z(rb,Ga.hasProperty(xb)?Ga.jX(xb):null);return!$b.JX}AIi(Ga,Fb){const $b=Fb.Sk;for(let xb=0;xb<Qb.b3a.length;xb++){var rb=Qb.b3a[xb];const gb=m.a.dX(rb);(rb=Ga.J(rb))?$b.cya(gb,rb):$b.removeProperty(gb)}for(Ga=0;Ga<Qb.b3a.length;Ga++)Fb.og.add(Qb.b3a[Ga]);u.a.instance.Ta(578932994,
1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",Fb.Ng.value.yf.id.toString())}EHo(Ga,Fb){const $b=Fb.Sk,rb=Ga.getPropertyInt32(Fb.Ng.value.yf,l.a.listLevel),xb=Ga.getPropertyInt32(Fb.pn.value.yf,l.a.listLevel);return null!=rb&&null!=xb&&rb===xb?(Ga.setPropertyInt32($b,l.a.listLevel,rb),Fb.og.add(m.a.zb(l.a.listLevel)),!0):null==rb&&null==xb?($b.removeProperty(l.a.listLevel),Fb.og.add(m.a.zb(l.a.listLevel)),!0):null!=rb&&null==xb?(Ga.setPropertyInt32($b,l.a.listLevel,
rb),Fb.og.add(m.a.zb(l.a.listLevel)),!0):null==rb&&null!=xb?(Ga.setPropertyInt32($b,l.a.listLevel,xb),Fb.og.add(m.a.zb(l.a.listLevel)),!0):!1}static jh(){return new Qb}static get instance(){return Qb.Kg.value}}Qb.Kg=new a.a(Qb.jh);Qb.b3a=[m.a.zb(l.a.ee),m.a.zb(l.a.qt),m.a.zb(y.a.Q3),m.a.zb(l.a.yba),m.a.zb(l.a.Vt),m.a.zb(l.a.Gr),m.a.zb(y.a.C_),m.a.zb(l.a.S0e),m.a.zb(y.a.font),m.a.zb(eb.a.akb),m.a.zb(e.a.paragraphStyle)];Object(D.a)(Qb,"PersistablePropertySetComplexMerge",k.a,[]);class Aa extends k.a{constructor(){super()}get Jn(){return 21}get Rz(){return 0}static jh(){return new Aa}static get instance(){return Aa.Kg.value}}
Aa.Kg=new a.a(Aa.jh);Object(D.a)(Aa,"RevisionMetadataNodeComplexMerge",k.a,[]);class bb extends k.a{constructor(){super()}get Jn(){return 48}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.ZXi),3);return Ga}static jh(){return new bb}static get instance(){return bb.Kg.value}}bb.Kg=new a.a(bb.jh);Object(D.a)(bb,"ShadowNumberListNodeComplexMerge",k.a,[]);class nb extends k.a{constructor(){super()}get Jn(){return 22}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.S2a),7);Ga.Z(m.a.zb(l.a.MTc),2);return Ga}static jh(){return new nb}static get instance(){return nb.Kg.value}}
nb.Kg=new a.a(nb.jh);Object(D.a)(nb,"SharedPersistablePropertySetComplexMerge",k.a,[]);class Va extends k.a{constructor(){super()}get Jn(){return 38}get Rz(){return 3}static jh(){return new Va}static get instance(){return Va.Kg.value}}Va.Kg=new a.a(Va.jh);Object(D.a)(Va,"StylePropertySetComplexMerge",k.a,[]);var Ab=c(1572),Zb=c(1617);class Kb extends k.a{constructor(){super()}get Jn(){return 23}get Rz(){return 0}rk(){const Ga=super.rk();Ga.Z(m.a.zb(y.a.gf),4);Ga.Z(m.a.zb(l.a.rowSpan),1);Ga.Z(m.a.zb(l.a.colSpan),
1);Ga.Z(m.a.zb(l.a.ghostCell),1);Ga.Z(m.a.zb(Ya.a.vMerge),1);Ga.Z(m.a.zb(Ya.a.gridSpan),1);Ga.Z(m.a.zb(l.a.M6a),2);Ga.Z(m.a.zb(l.a.Xob),2);Ga.Z(m.a.zb(l.a.EHa),2);Ga.Z(m.a.zb(l.a.tob),5);return Ga}aHb(Ga){if(!Ga)return u.a.instance.Ta(573957923,1,2,"Feature helper is null"),!1;Ga.pB(104);return Ga.isFeatureEnabled(104)}pwa(Ga){if(!Ga)return u.a.instance.Ta(540120285,1,2,"Feature helper is null"),!1;Ga.pB(105);return Ga.isFeatureEnabled(105)}GB(Ga,Fb){Ga.Zp.runtime.xG("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+
Fb);var $b=Fb===m.a.zb(l.a.rowSpan)||Fb===m.a.zb(l.a.colSpan)||Fb===m.a.zb(l.a.ghostCell);this.pwa(Ga.Zp.runtime.Xb)&&($b=$b||Fb===m.a.zb(Ya.a.vMerge)||Fb===m.a.zb(Ya.a.gridSpan));if(!this.aHb(Ga.Zp.runtime.Xb))return!$b;var rb=Ga.pn.value.Bu,xb=Zb.e(Ga.Zp,rb,null);if(xb.equals(ba.a.nil))return u.a.instance.Ta(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",rb.id),Ga.Zp.logger.Pg(Object.assign(new Ab.a,{info:"Table node ID could not be found for table cell"})),
!1;var gb=Ga.Zp.runtime.Nzb.J(xb).J(rb.id);if(!gb)return!$b;rb=Ga.Sk;xb=Ga.Xd;if(Fb===m.a.zb(l.a.ghostCell))return xb.setPropertyBool(rb,l.a.ghostCell,gb.gg),Ga.og.add(m.a.zb(l.a.ghostCell)),!0;if(Fb===m.a.zb(l.a.rowSpan))return Fb=gb.rowSpan,gb=gb.colSpan,null!=Fb&&null!=gb&&(1<Fb||1<gb)?xb.setPropertyUint32(rb,l.a.rowSpan,Fb):rb.removeProperty(l.a.rowSpan),Ga.og.add(m.a.zb(l.a.rowSpan)),!0;if(Fb===m.a.zb(l.a.colSpan))return Fb=gb.rowSpan,$b=gb.colSpan,gb=gb.gg,null!=Fb&&null!=$b&&(1<Fb||1<$b)?xb.setPropertyUint32(rb,
l.a.colSpan,$b):gb&&null!=$b?xb.setPropertyUint32(rb,l.a.colSpan,$b):rb.removeProperty(l.a.colSpan),Ga.og.add(m.a.zb(l.a.colSpan)),!0;u.a.instance.Ta(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",Fb);Ga.Zp.logger.Pg(Object.assign(new Ab.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!$b}static jh(){return new Kb}static get instance(){return Kb.Kg.value}}
Kb.Kg=new a.a(Kb.jh);Object(D.a)(Kb,"TableCellNodeComplexMerge",k.a,[]);class dc extends k.a{constructor(){super()}get Jn(){return 24}aHb(Ga){if(!Ga)return u.a.instance.Ta(573845782,1,2,"Feature helper is null"),!1;Ga.pB(104);return Ga.isFeatureEnabled(104)}get Rz(){return 0}rk(){const Ga=super.rk();Ga.Z(m.a.zb(y.a.gf),1);Ga.Z(m.a.zb(y.a.u0),1);Ga.Z(m.a.zb(y.a.oya),1);Ga.Z(m.a.zb(l.a.Ejc),1);Ga.Z(m.a.zb(l.a.v9),1);Ga.Z(m.a.zb(l.a.M6a),2);Ga.Z(m.a.zb(l.a.Xob),2);Ga.Z(m.a.zb(l.a.EHa),2);return Ga}GB(Ga,
Fb){Ga.Zp.runtime.xG("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+Fb);if(Fb===m.a.zb(y.a.gf)||Fb===m.a.zb(y.a.u0)||Fb===m.a.zb(l.a.Ejc)||Fb===m.a.zb(l.a.v9)||Fb===m.a.zb(y.a.oya)){const xb=Ga.Sk;var $b=Ga.Xd;u.a.instance.Ta(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",xb.id,xb.Nc,Fb);if(this.Xhl(Ga))return!1;var rb=$b.getPropertyObjectIds(Ga.Ng.value.Bu,y.a.gf);const gb=$b.getPropertyObjectIds(Ga.Ng.value.yf,y.a.gf),
Gb=$b.getPropertyObjectIds(Ga.pn.value.yf,y.a.gf);rb=this.MHi(rb,gb,Gb,(ac,hc)=>ac.equals(hc));if(0<rb.length)return $b.setPropertyObjectIds(xb,y.a.gf,rb),$b.setPropertyInt32(xb,y.a.oya,rb.length),this.aHb(Ga.Zp.runtime.Xb)&&({value:Fb}=Ga.pn.value.fpa.Ec(m.a.zb(y.a.u0)),{value:$b}=Ga.Ng.value.fpa.Ec(m.a.zb(y.a.u0)),Fb.JX?xb.cya(y.a.u0,Fb.newValue):xb.cya(y.a.u0,$b.newValue)),Ga.og.add(m.a.zb(y.a.gf)),Ga.og.add(m.a.zb(y.a.u0)),Ga.og.add(m.a.zb(y.a.oya)),Ga.og.add(m.a.zb(l.a.Ejc)),Ga.og.add(m.a.zb(l.a.v9)),
!0}u.a.instance.Ta(4018189,1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ga.Ng.value.yf.id,Fb);return!1}Xhl(Ga){const Fb=Ga.pn.value,$b=Ga.Ng.value;let rb,xb;({value:rb}=Fb.fpa.Ec(m.a.zb(y.a.u0)));({value:xb}=$b.fpa.Ec(m.a.zb(y.a.u0)));return rb.JX||xb.JX?rb.JX&&xb.JX?(u.a.instance.Ta(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",
rb.oldValue,xb.newValue,rb.newValue),Ga.Zp.logger.Pg(Object.assign(new Ab.a,{pj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):dc.UOh(Ga.Zp,rb,$b,"BaseConflict")||dc.UOh(Ga.Zp,xb,Fb,"BaseFavored")?!0:!1:!1}static jh(){return new dc}static get instance(){return dc.Kg.value}static UOh(Ga,Fb,$b,rb){return Fb.JX&&({value:Fb}=$b.fpa.Ec(m.a.zb(y.a.gf)),Fb.JX)?(u.a.instance.Ta(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",
rb),Ga.logger.Pg(Object.assign(new Ab.a,{pj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}dc.Kg=new a.a(dc.jh);Object(D.a)(dc,"TableNodeComplexMerge",k.a,[]);class jc extends k.a{constructor(){super()}get Jn(){return 25}get Rz(){return 0}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.Lc),3);Ga.Z(m.a.zb(y.a.gf),4);Ga.Z(m.a.zb(l.a.M6a),2);Ga.Z(m.a.zb(l.a.Xob),2);Ga.Z(m.a.zb(l.a.EHa),2);Ga.Z(m.a.zb(Ya.a.Heg),2);Ga.Z(m.a.zb(Ya.a.Geg),2);Ga.Z(m.a.zb(l.a.tob),5);return Ga}static jh(){return new jc}static get instance(){return jc.Kg.value}}
jc.Kg=new a.a(jc.jh);Object(D.a)(jc,"TableRowNodeComplexMerge",k.a,[]);class zb extends k.a{constructor(){super()}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.lAo),2);Ga.Z(m.a.zb(y.a.gf),1);return Ga}GB(Ga,Fb){if(Fb===m.a.zb(y.a.gf)){const rb=Ga.Sk,xb=Ga.Xd;u.a.instance.Ta(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",rb.id,rb.Nc,Fb);var $b=xb.getPropertyObjectIds(Ga.Ng.value.Bu,y.a.gf);const gb=xb.getPropertyObjectIds(Ga.Ng.value.yf,
y.a.gf),Gb=xb.getPropertyObjectIds(Ga.pn.value.yf,y.a.gf);if($b=this.r7m($b,gb,Gb))return 0<$b.length?xb.setPropertyObjectIds(rb,y.a.gf,$b):rb.removeProperty(y.a.gf),Ga.og.add(m.a.zb(y.a.gf)),!0}u.a.instance.Ta(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ga.Ng.value.yf.id,Fb);return!1}r7m(Ga,Fb,$b){const rb=new J.a(0);Ga.forEach(gb=>{rb.Z(gb,0);return!0});Fb.forEach(gb=>{rb.ob(gb)?rb.Z(gb,1):rb.Z(gb,3);return!0});
$b.forEach(gb=>{let Gb;({value:Gb}=rb.Ec(gb)).returnValue?1===Gb?rb.Z(gb,5):3===Gb?(u.a.instance.Ta(42754253,1,2,"TaskNode was found added by both sides of merge"),rb.Z(gb,3)):rb.Z(gb,2):rb.Z(gb,4);return!0});const xb=new H.a;rb.forEach((gb,Gb)=>{0!==Gb&&2!==Gb&&1!==Gb&&xb.add(gb);return!0});return xb}static jh(){return new zb}static get instance(){return zb.Kg.value}}zb.Kg=new a.a(zb.jh);Object(D.a)(zb,"TaskContentNodeComplexMerge",k.a,[]);class cc{equals(Ga,Fb){return Ga&&Fb?Ga.UserId===Fb.UserId&&
Ga.Provider===Fb.Provider&&Ga.DisplayName===Fb.DisplayName&&Ga.Email===Fb.Email:!Ga&&!Fb}dM(){return 0}}Object(D.a)(cc,"CommentTaskPersonComparer",null,[317]);class Ub{equals(Ga,Fb){return Ga&&Fb?Ga.startDate?Ga.endDate?Ga.startDate.getTime()===Fb.startDate.getTime()&&Ga.endDate.getTime()===Fb.endDate.getTime():!Fb.endDate:!Fb.startDate:!Ga&&!Fb}dM(){return 0}}Object(D.a)(Ub,"CommentTaskScheduleEqualityComparer",null,[317]);class Wb{equals(Ga,Fb){if(!Ga||!Fb)return!Ga&&!Fb;if(!Ga.extensions&&!Fb.extensions)return!0;
if(!Ga.extensions||!Fb.extensions||Ga.extensions.count!==Fb.extensions.count)return!1;let $b=!0;Ga.extensions.forEach((rb,xb)=>{let gb;return({value:gb}=Fb.extensions.Ec(rb)).returnValue&&xb===gb?!0:$b=!1});return $b}dM(){return 0}}Object(D.a)(Wb,"ExtensionListEqualityComparer",null,[317]);class Qa{ipl(Ga,Fb){return Ga&&Fb?Ga.recordId===Fb.recordId&&Qa.XLg.equals(Ga.user,Fb.user)&&Qa.XLg.equals(Ga.assignee,Fb.assignee)&&Ga.type===Fb.type&&Ga.title===Fb.title&&Ga.priority===Fb.priority&&Ga.isLossy===
Fb.isLossy&&Ga.completion===Fb.completion&&Ga.commentId===Fb.commentId&&Ga.time===Fb.time&&Qa.PSj.equals(Ga.schedule,Fb.schedule):!Ga&&!Fb}equals(Ga,Fb){return this.ipl(Ga,Fb)}dM(){return 0}}Qa.XLg=new cc;Qa.PSj=new Ub;new Wb;Object(D.a)(Qa,"HistoryRecordEqualityComparer",null,[317]);var sb=c(2034),Jb=c(1537);class pc extends k.a{constructor(Ga){super();this.XLa=Ga}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.LOb),5);Ga.Z(m.a.zb(l.a.taskId),2);Ga.Z(m.a.zb(l.a.Zzo),2);Ga.Z(m.a.zb(l.a.cAo),2);Ga.Z(m.a.zb(l.a.qya),
1);return Ga}Ahg(Ga){if(!Ga.pn.value.Bu&&!Ga.Ng.value.Bu){const Fb=Ga.Ng.value.yf.fH();Fb.removeProperty(l.a.qya);const $b=Ga.Ng.value.yf,rb=Ga.pn.value.yf;Ga.Ng=new a.a(()=>new Jb.a(Fb,$b));Ga.pn=new a.a(()=>new Jb.a(Fb,rb))}return super.Ahg(Ga)}GB(Ga,Fb){if(Fb!==m.a.zb(l.a.qya))return u.a.instance.Ta(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Ga.Ng.value.yf.id,Fb),!1;const $b=Ga.Sk,rb=Ga.Xd;u.a.instance.Ta(42754255,
1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",$b.id,$b.Nc,Fb);Fb=rb.getPropertyString(Ga.Ng.value.Bu,l.a.qya);const xb=rb.getPropertyString(Ga.Ng.value.yf,l.a.qya),gb=rb.getPropertyString(Ga.pn.value.yf,l.a.qya);Fb=this.q7m(Fb,xb,gb);if(!Fb)return!1;0<Fb.length?rb.setPropertyString($b,l.a.qya,Fb):$b.removeProperty(l.a.qya);Ga.og.add(m.a.zb(l.a.qya));return!0}q7m(Ga,Fb,$b){Ga=this.XLa.F3b(Ga);Fb=this.XLa.F3b(Fb);$b=this.XLa.F3b($b);if(!pc.Yvi(Ga,
Fb))return u.a.instance.Ta(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!pc.Yvi(Ga,$b))return u.a.instance.Ta(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;$b=pc.BUk(Ga.length,Fb,$b);return this.XLa.u7f($b)}static jh(){const Ga=new sb.a;return new pc(Ga)}static get instance(){return pc.Kg.value}static BUk(Ga,Fb,$b){const rb=new H.a;for(let xb=0;xb<Fb.length;xb++)rb.add(Fb.J(xb));for(;Ga<$b.length;Ga++)rb.add($b.J(Ga));
return rb}static Yvi(Ga,Fb){const $b=Ga.length;if($b>Fb.length)return!1;for(let rb=0;rb<$b;rb++)if(!pc.WZj.equals(Fb.J(rb),Ga.J(rb)))return Fb.J(rb).recordId===Ga.J(rb).recordId&&u.a.instance.Ta(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}pc.Kg=new a.a(pc.jh);pc.WZj=new Qa;Object(D.a)(pc,"TaskSingleNodeComplexMerge",k.a,[]);class rc extends k.a{constructor(){super()}get Jn(){return 26}rk(){const Ga=super.rk();Ga.Z(m.a.zb(y.a.gf),
1);return Ga}GB(Ga,Fb){const $b=y.a.gf;if(Fb===m.a.zb($b)){Fb=Ga.Sk;const xb=Ga.Xd;var rb=xb.getPropertyObjectIds(Ga.Ng.value.Bu,$b);const gb=xb.getPropertyObjectIds(Ga.Ng.value.yf,$b),Gb=xb.getPropertyObjectIds(Ga.pn.value.yf,$b);rb=this.x7m(rb,gb,Gb);xb.setPropertyObjectIds(Fb,$b,rb);Ga.og.add(m.a.zb($b));return!0}return!1}x7m(Ga,Fb,$b){return this.DFa(Ga,Fb,$b)}static jh(){return new rc}static get instance(){return rc.Kg.value}}rc.Kg=new a.a(rc.jh);Object(D.a)(rc,"VectorClockContainerNodeComplexMerge",
k.a,[]);class db extends k.a{constructor(){super()}get Jn(){return 27}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.bV),1);return Ga}GB(Ga,Fb){const $b=l.a.bV;if(Fb===m.a.zb($b)){Fb=Ga.Sk;const rb=Ga.Xd,xb=rb.getPropertyUint32(Ga.Ng.value.yf,$b)||0,gb=rb.getPropertyUint32(Ga.pn.value.yf,$b)||0;rb.setPropertyUint32(Fb,$b,this.UVl(xb,gb));Ga.og.add(m.a.zb($b));return!0}return!1}UVl(Ga,Fb){return Ga>Fb?Ga:Fb}static jh(){return new db}static get instance(){return db.Kg.value}}db.Kg=new a.a(db.jh);Object(D.a)(db,
"VectorClockNodeComplexMerge",k.a,[]);class lb extends k.a{constructor(){super()}get Jn(){return 28}get Rz(){return 0}rk(){const Ga=super.rk();Ga.Z(m.a.zb(l.a.oPh),3);Ga.Z(m.a.zb(l.a.Lc),3);Ga.Z(m.a.zb(l.a.Lil),5);Ga.Z(m.a.zb(l.a.WHi),5);Ga.Z(m.a.zb(l.a.Xha),5);return Ga}static jh(){return new lb}static get instance(){return lb.Kg.value}}lb.Kg=new a.a(lb.jh);Object(D.a)(lb,"WordSectionNodeComplexMerge",k.a,[]);c.d(L,"a",function(){return qa});class qa{IHh(Ga,Fb){switch(Ga.Nc){case 131073:return Ga.hasProperty(l.a.imageType)||
Ga.hasProperty(e.a.l_)?this.Xo(wa.instance,Fb):this.Xo(Qb.instance,Fb);case 1074135140:return this.Xo(x.instance,Fb);case 1074135137:return this.Xo(v.instance,Fb);case 1074135139:return this.Xo(E.instance,Fb);case 1074135138:return this.Xo(F.instance,Fb);case 1074135136:return this.Xo(M.instance,Fb);case 1074135157:return this.Xo(I.instance,Fb);case 1074135152:return this.Xo(T.instance,Fb);case 1074135153:return this.Xo(U.instance,Fb);case 1074135126:return this.Xo(W.instance,Fb);case 1074135127:return this.Xo(Y.instance,
Fb);case 1074135145:return this.Xo(sa.instance,Fb);case 1074135144:return this.Xo(da.instance,Fb);case 1074135142:return this.Xo(ta.instance,Fb);case 1074135143:return this.Xo(ra.instance,Fb);case 1074135163:return this.Xo(ma.instance,Fb);case 1074135164:return this.Xo(Ba.instance,Fb);case 1074135124:return this.Xo(Pa.instance,Fb);case 1074135125:return this.Xo(Da.instance,Fb);case 1074135122:return this.Xo(oa.instance,Fb);case 393233:return this.Xo(wa.instance,Fb);case 1073872970:return this.Xo(wa.instance,
Fb);case 1074135170:return this.Xo(ia.instance,Fb);case 1074135168:return this.Xo(ca.instance,Fb);case 1074135166:return this.Xo(pa.instance,Fb);case 1074135167:return this.Xo(Ma.instance,Fb);case 1074135169:return this.Xo(ya.instance,Fb);case 1074135165:return this.Xo(Oa.instance,Fb);case 393234:return this.Xo(Ta.instance,Fb);case 393229:return this.Xo(jb.instance,Fb);case 393241:return this.Xo(ob.instance,Fb);case 393227:return this.Xo(Sa.instance,Fb);case 131120:return this.Xo(Hb.instance,Fb);
case 393271:return this.Xo(ab.instance,Fb);case 393230:return this.Xo(pb.a.instance,Fb);case 131140:return this.Xo(Aa.instance,Fb);case 1179649:return this.Xo(nb.instance,Fb);case 1073872969:return this.Xo(Va.instance,Fb);case 393252:return this.Xo(Kb.instance,Fb);case 393250:return this.Xo(dc.instance,Fb);case 393251:return this.Xo(jc.instance,Fb);case 1074135154:return this.Xo(rc.instance,Fb);case 1074135161:return this.Xo(zb.instance,Fb);case 1074135162:return this.Xo(pc.instance,Fb);case 1074135155:return this.Xo(db.instance,
Fb);case 1073872968:return this.Xo(lb.instance,Fb);case 1074135172:return this.Xo(Ca.instance,Fb);case 1074135171:return this.Xo(fa.instance,Fb);case 1074135149:return this.Xo(Ha.instance,Fb);case 1074135151:return this.Xo(bb.instance,Fb)}return this.Xo(k.a.instance,Fb)}Xo(Ga,Fb){Ga.Xb=Fb?Fb():null;return Ga}}Object(D.a)(qa,"GraphNodeComplexMergeFactory",null,[1871])},1929:function(D,L,c){c.r(L);D=c(0);var l=c(1513),e=c(76),a=c(289),k=c(82),x=c(1490);class y{constructor(H,P,N,M=0){this.Ogi=H;this.groupType=
P;this.Rtf=M;this.S3c=N}}Object(D.a)(y,"SortingGroup",null,[]);class m{constructor(H,P,N,M){this.order=H;this.P7=P;this.idm=N;this.groupType=M}}Object(D.a)(m,"SortingProp",null,[]);var u=c(1483),z=c(1485),v=c(1482),E=c(27);class F{constructor(H,P){this.NFi={};this.MFi={};this.IFi=this.TFi=1;this.fvh(H,P)}uso(H,P,N){var M=v.a.FQ(N)?this.NFi:this.MFi;N=new e.a;for(var I of P)P=Object(k.a)(m,M[l.a[I.groupType].toLowerCase()]),E.c(P)||N.add(new a.a(P,I));N.Sc((U,W)=>U.key.order<W.key.order?-1:1);Array.clear(H);
I=u.TellMeActor.instance.oZ;for(P=0;P<N.count;){M=N.J(P).key.P7;var T=N.J(P).value;const U=new x.a(N.J(P).key.groupType);E.c(I)||I.Location===z.a.contextMenu||(U.displayName=N.J(P).key.idm);for(const W of T.results)U.ww(W);for(T=++P;T<N.count&&N.J(T).key.P7===M;)this.wXe(U,N.J(T).value),T=++P;H.push(U)}}dRo(H,P){this.IFi=this.TFi=1;this.fvh(H,P)}fvh(H,P){this.Bnj(H);for(var N=0;N<H.length;N++){let M=H[N];for(const I of M.S3c)this.Llk(I,N,M.Ogi,M.groupType)}this.Bnj(P);for(H=0;H<P.length;H++){N=P[H];
for(const M of N.S3c)this.Klk(M,H,N.Ogi,N.groupType)}}Bnj(H){H.sort((P,N)=>Object(k.a)(y,P).Rtf>Object(k.a)(y,N).Rtf?-1:1)}Llk(H,P,N,M){this.NFi[l.a[H].toLowerCase()]=new m(this.TFi++,P,N,M)}Klk(H,P,N,M){this.MFi[l.a[H].toLowerCase()]=new m(this.IFi++,P,N,M)}wXe(H,P){for(let N=0;N<P.results.length;N++)H.ww(P.results[N])}}Object(D.a)(F,"BaseGroupingSorter",null,[]);class J{constructor(){this.O1d=[new y("",26,[26]),new y("",24,[24]),new y(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new y(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new y("",13,[13]),new y("",22,[22])];this.J1d=[new y("",25,[25]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new y(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new y(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new y("",13,[13,24]),new y("",22,[22])];this.tFi=new F(this.O1d,this.J1d)}p7c(H,P,N,M=null,I=null){let T=!1;if(M){for(const U of v.a.FQ(N)?
this.O1d:this.J1d)this.$Hn(U,M);T=!0}if(I){for(const U of v.a.FQ(N)?this.O1d:this.J1d)this.eRo(P,U,I);T=!0}T&&this.tFi.dRo(this.O1d,this.J1d);this.tFi.uso(H,P,N)}$Hn(H,P){const N=new e.a;for(var M of H.S3c){const I=P[l.a[M].toLowerCase()];N.add(new a.a(E.c(I)?Number.MAX_VALUE:I,M))}if(N.count){N.Sc((I,T)=>I.key<T.key?-1:1);P=Array(N.count);for(M=0;M<N.count;M++)P[M]=N.J(M).value;H.S3c=P}}eRo(H,P,N){let M=0;for(const I of P.S3c)if(l.a[I].toLowerCase()in N&&N[l.a[I].toLowerCase()])for(const T of H)if(T.groupType===
I){M+=N[l.a[I].toLowerCase()];break}P.Rtf=M}}Object(D.a)(J,"SimplifiedGroupingSorter",null,[]);c.d(L,"GroupsPlacementInfo",function(){return K});class K{constructor(H){this.LFi={};this.JFi={};this.KFi={};this.OFi={};this.kJf={};this.PFi=this.V2m=this.Q2m=this.S2m=1;this.QFi=null;this.Mw=H;this.LHk();this.Exn();this.xHk();this.zGk();H.QO&&(this.QFi=new J)}yF(H){this.LFi[l.a[H].toLowerCase()]=this.S2m++}bH(H,P){this.JFi[l.a[H].toLowerCase()]=P}mMa(H){this.KFi[l.a[H].toLowerCase()]=this.Q2m++}r2(H){this.OFi[l.a[H].toLowerCase()]=
this.V2m++}$B(H){this.kJf[l.a[H].toLowerCase()]=this.PFi++}LHk(){const H=!!this.Mw&&this.Mw.H2a,P=!!this.Mw&&this.Mw.JZc,N=!!this.Mw&&this.Mw.tjb,M=!!this.Mw&&this.Mw.kEf&&!v.a.SGb(),I=!!this.Mw&&this.Mw.IUc,T=!!this.Mw&&this.Mw.LVd,U=!!this.Mw&&this.Mw.oCf,W=!!this.Mw&&this.Mw.HVd;this.Mw&&(this.Mw.qfa||this.Mw.DId)&&this.yF(26);W&&this.yF(24);this.yF(4);this.yF(18);this.yF(16);this.yF(7);this.yF(17);this.yF(0);this.yF(1);U&&this.yF(28);I&&this.yF(23);H||this.yF(2);H&&!P||this.yF(8);this.yF(15);
N&&this.yF(20);this.yF(14);this.yF(9);this.yF(12);this.yF(10);this.yF(11);H&&this.yF(2);H&&!P&&this.yF(8);this.yF(19);T&&this.yF(27);this.yF(21);this.yF(13);M&&this.yF(22)}Exn(){this.bH(21,1);this.bH(4,3);this.bH(18,3);this.bH(16,3);this.bH(7,3);this.bH(17,5);this.bH(0,5);this.bH(1,1);this.bH(28,2);this.bH(2,1);this.bH(8,2);this.bH(15,3);this.bH(14,2);this.bH(27,3);this.bH(9,1);this.bH(12,1);this.bH(10,1);this.bH(11,1);this.bH(19,1);this.bH(23,1);this.bH(13,1);this.bH(24,1);this.bH(25,1);this.bH(20,
2);this.bH(22,1);this.bH(26,1)}xHk(){this.mMa(4);this.mMa(0);this.mMa(17);this.mMa(7);this.mMa(16);this.mMa(18);this.mMa(15);this.mMa(20);this.mMa(8);this.mMa(14)}zGk(){this.r2(14);this.r2(10);this.r2(12);this.r2(9);this.r2(11);this.r2(20);this.r2(15);this.r2(8);this.r2(2);this.r2(1);this.r2(27);this.r2(7);this.r2(18);this.r2(16);this.r2(17);this.r2(0);this.r2(4)}k_n(){this.kJf={};this.PFi=1}Z3l(H,P,N){this.k_n();const M=!!this.Mw&&this.Mw.H2a,I=!!this.Mw&&this.Mw.JZc,T=!!this.Mw&&this.Mw.tjb,U=!!this.Mw&&
this.Mw.kEf&&!v.a.SGb(),W=!!this.Mw&&this.Mw.IUc,V=!!this.Mw&&this.Mw.LVd,Y=!!this.Mw&&this.Mw.oCf,da=!!this.Mw&&this.Mw.HVd;H=H&&I;da&&this.$B(25);this.$B(4);this.$B(18);this.$B(16);this.$B(7);this.$B(17);this.$B(0);this.$B(1);Y&&this.$B(28);W&&this.$B(23);M&&!I||!H||this.$B(8);P&&this.$B(15);M||this.$B(2);V&&this.$B(27);N&&this.$B(14);M&&!I||H||this.$B(8);P||this.$B(15);T&&this.$B(20);N||this.$B(14);this.$B(9);this.$B(12);this.$B(10);this.$B(11);M&&this.$B(2);M&&!I&&this.$B(8);this.$B(19);this.$B(21);
da&&this.$B(24);this.$B(13);U&&this.$B(22);return this.kJf}bO(){return this.Mw}}Object(D.a)(K,"GroupsPlacementInfo",null,[])},1931:function(D,L,c){D=c(0);var l=c(1759),e=c(60);class a{constructor(){this.source=0;this.Zm=this.TTa=this.x9=null;this.$ga=0;this.bFb=!1;this.mode=this.OSa=0;this.sKc=null;this.CIb=e.a.create()}}Object(D.a)(a,"InputState",null,[]);class k{constructor(){this.timeout=this.succeeded=this.crash=!1;this.qM=null}}Object(D.a)(k,"OutputState",null,[]);class x{constructor(){this.Vmi=
this.oge=this.D6c=!1;this.Xb=this.z2d=this.SUf=this.yae=this.Aeg=this.Nzb=this.PMa=this.xG=this.Hkb=this.Wic=this.tJo=this.vsl=this.Xm=this.fbf=this.zq=this.ru=this.pk=this.tle=this.gKd=this.tCa=null}}Object(D.a)(x,"RuntimeState",null,[]);c.d(L,"a",function(){return y});class y{constructor(){this.input=new a;this.runtime=new x;this.output=new k;this.logger=new l.a(this)}}Object(D.a)(y,"MergeState",null,[])},1932:function(D,L,c){c.r(L);D=c(0);var l=c(627),e=c(231),a=c(177),k=c(117),x=c(1615),y=c(1709),
m=c(1741),u=c(6),z=c(1922);class v{constructor(N,M){this.start=N;this.end=M}}Object(D.a)(v,"MergeDiffIdx",null,[]);class E{constructor(N,M,I,T=!1,U=null,W=null,V=!0){this.$fd=this.Zfd=this.SOg=this.awc=0;this.oZb=this.Mre=null;this.j$a=U||new z.a;this.Lg=I;this.Pqa=N.y4();this.Pgk=M.y4();this.fP=new v(0,0);this.CS=new v(0,0);this.EBe=T;this.ntc=V;this.sra=W;this.IJk();this.vdo()}get iK(){return this.Pqa}get CJ(){return this.Pgk}get az(){return this.awc}get Sz(){return this.SOg}get nua(){return this.Zfd}get Wla(){return this.$fd}get Gfl(){const N=
new e.a;for(let M=this.Mre.start;M<this.Mre.end;M++)N.add(this.iK.$f(M));return N}get wcf(){const N=new e.a;for(let M=this.oZb.start;M<this.oZb.end;M++)N.add(this.CJ.$f(M));return N}Ddf(N){if(this.Sz<N.Sz){if(this.Sz+this.nua>N.Sz)return!0}else if(this.Sz>N.Sz){if(N.Sz+N.nua>this.Sz)return!0}else if(2===this.az&&3===N.az||3===this.az&&2===N.az||2===this.az&&2===N.az||3===this.az&&3===N.az)return!0;return!1}S6i(N,M,I,T){N.QF(M);N.fA(M,I);return T+=I.length-1}Xnj(N,M,I,T,U){let W=this.iK.$f(N),V=this.CJ.$f(M);
if(!W||!V||!W.v6a&&!V.v6a)return{returnValue:!1,RBa:T,mIa:U};let Y=new e.a,da=new e.a;W.v6a&&(Y=W.x7c(),W=Y.$f(I?0:Y.length-1));V.v6a&&(da=V.x7c(),V=da.$f(I?0:da.length-1));if(!W.hA(V,this.j$a,this.sra,this.EBe,this.ntc))return{returnValue:!1,RBa:T,mIa:U};Y.length&&(T=this.S6i(this.iK,N,Y,T));da.length&&(U=this.S6i(this.CJ,M,da,U));return{returnValue:!0,RBa:T,mIa:U}}$ul(N,M,I,T,U,W){for(;U<=I&&W<=T;){const V=N.$f(U),Y=M.$f(W);if(!V.hA(Y,this.j$a,this.sra,this.EBe,this.ntc))break;this.fP.start+=V.length;
this.CS.start+=Y.length;U++;W++}return{R0e:U,Kig:W}}Yul(N,M,I,T,U,W){for(;U>=I&&W>=T;){const V=N.$f(U),Y=M.$f(W);if(!V.hA(Y,this.j$a,this.sra,this.EBe,this.ntc))return{returnValue:!0,RBa:U,mIa:W};U--;W--}return{returnValue:!1,RBa:U,mIa:W}}Zul(N,M,I,T){let U=!1;do({R0e:N,Kig:M}=this.$ul(this.iK,this.CJ,I,T,N,M)),{RBa:I,mIa:T,returnValue:U}=this.Xnj(N,M,!0,I,T);while(U);return{R0e:N,Kig:M,RBa:I,mIa:T}}Xul(N,M,I,T){let U=!1;do{if(!({RBa:I,mIa:T}=this.Yul(this.iK,this.CJ,N,M,I,T)).returnValue)break;({RBa:I,
mIa:T,returnValue:U}=this.Xnj(I,T,!1,I,T))}while(U);return{RBa:I,mIa:T}}IJk(){var N=0,M=0,I=this.iK.length-1,T=this.CJ.length-1;0<=I&&this.iK.$f(I);0<=T&&this.CJ.$f(T);({R0e:N,Kig:M,RBa:I,mIa:T}=this.Zul(N,M,I,T));if(N<I||M<T)({RBa:I,mIa:T}=this.Xul(N,M,I,T));I++;T++;this.Mre=new v(N,I);this.oZb=new v(M,T);this.fP.end=this.fP.start;this.CS.end=this.CS.start;for(var U=N;U<I;U++){var W=this.iK.$f(U);this.fP.end+=W.length}for(U=M;U<T;U++)W=this.CJ.$f(U),this.CS.end+=W.length;a.a.instance.Ta(3993809,
1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",N,I,M,T);a.a.instance.Ta(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.fP.start,this.fP.end,this.CS.start,this.CS.end);this.fP.start<=this.fP.end&&this.CS.start<=this.CS.end&&(N=this.iK.$f(N),M=this.CJ.$f(M),U=this.iK.$f(I),W=this.CJ.$f(T),I=this.iK.$f(I-1),T=this.CJ.$f(T-1),a.a.instance.Ta(3993811,
1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",N,U,M,W,I,T))}vdo(){this.SOg=this.fP.start;this.Zfd=this.$fd=0;this.fP.start===this.fP.end&&this.CS.start===this.CS.end?this.awc=0:this.fP.start===this.fP.end&&this.CS.start<this.CS.end?(this.awc=1,this.$fd=this.CS.end-this.CS.start):this.CS.start===this.CS.end&&this.fP.start<this.fP.end?(this.awc=2,this.Zfd=this.fP.end-this.fP.start):(this.awc=
3,this.Zfd=this.fP.end-this.fP.start,this.$fd=this.CS.end-this.CS.start);a.a.instance.Ta(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.az,this.Sz,this.nua,this.Wla)}IFm(N,M){return N.I3()&&M.I3()?N.runId===M.runId&&N.wg===M.wg:!1}KKm(N){if(!N.I3()||"\ufffc"!==N.text)return!1;N=N.tCb;return N?N.hasProperty(u.a.Tj)||N.hasProperty(u.a.xAd)||N.hasProperty(u.a.gef)||N.hasProperty(u.a.C7)||N.hasProperty(u.a.imageType)||N.hasProperty(u.a.PPa)||
N.hasProperty(u.a.XGb)||N.hasProperty(u.a.Rs)&&(N=this.Lg.getPropertyInt32(N,u.a.Rs))&&(36===N||35===N||24===N||23===N||33===N||34===N||44===N||45===N||42===N||43===N)?!0:!1:!1}nTc(N){return N.I3()&&!this.KKm(N)}oLk(){if(2===this.az)return!1;var N=this.oZb.start;if(!N)return!1;let M=null;for(var I=this.oZb.start;I<this.oZb.end;I++){const T=this.CJ.$f(I);if(this.nTc(T)){M=T;break}}if(!M)return!1;--N;for(I=this.CJ.$f(N);I&&!this.nTc(I);)N--,I=this.CJ.$f(N);return I&&this.IFm(I,M)?!0:!1}A5h(N){const M=
new e.a;for(let I=0;I<N.length;I++)N.J(I).v6a?M.fA(M.length,N.J(I).x7c()):M.insert(M.length,N.J(I));return M}KFm(){if(3!==this.az||this.nua!==this.Wla)return!1;const N=this.A5h(this.Gfl),M=this.A5h(this.wcf);if(N.length!==M.length)return!1;for(let I=0;I<N.length;I++)if(!N.J(I).hA(M.J(I),this.j$a,this.sra,!0,this.ntc))return!1;return!0}JFm(){if(0!==this.az&&3!==this.az||this.iK.length!==this.CJ.length)return!1;let N=!1;for(let M=0;M<this.iK.length;M++){if(!this.iK.J(M).hA(this.CJ.J(M),this.j$a,this.sra,
!0,this.ntc))return!1;if(3===this.iK.J(M).type||1===this.iK.J(M).type){const I=this.iK.J(M),T=this.CJ.J(M);N=I.runId!==T.runId||I.wg!==T.wg||N}}return N}}Object(D.a)(E,"MergeBlockDiff",null,[]);var F=c(1570);class J{constructor(N,M){this.id=N;this.index=M}}Object(D.a)(J,"ParagraphStartIndex",null,[]);var K=c(1630),H=c(1553);c.d(L,"ParagraphMerge",function(){return P});class P{constructor(N,M,I,T,U,W,V){this.nXb=this.gvb=this.Lo=this.Vw=null;this.xh=!1;this.lgh=this.kRg=this.ZIg=this.Msa=this.NJa=
this.Pqa=null;this.Vd=N;this.mF=M;this.iBa=T;this.Rza=I;this.rra=U;this.sra=W;this.Lg=V}$ai(N){const M=new l.a;N.iK.forEach(I=>{2===I.type&&M.add(I.Fj);return!0});N.CJ.forEach(I=>{2===I.type&&M.remove(I.Fj);return!0});return M}v8h(N){const M=new e.a;N.CJ.forEach(I=>{2===I.type&&M.add(I.Fj);return!0});return M}tDh(N){const M=new e.a;let I=0,T=0;N.CJ.forEach(U=>{2===U.type&&(M.add(new J(U.Fj,I<N.Sz?I:I<N.Sz+N.Wla?N.Sz:I-N.Wla+N.nua)),I=T);T+=U.length;return!0});return M}aXk(N,M){var I=this.tDh(N);const T=
this.tDh(M);N=this.$ai(N);const U=this.$ai(M);M=new e.a;const W=new l.a;let V=0;for(let Y=0;Y<I.length;Y++){const da=I.J(Y);if(V<T.length){let ba=T.J(V);for(;V<T.length&&ba.index<=da.index;){if(ba.id.equals(da.id)){V++;break}N.contains(ba.id)||W.contains(ba.id)||(M.add(ba.id),W.add(ba.id));V++;ba=T.J(V)}}U.contains(da.id)||(M.add(da.id),W.add(da.id))}for(;V<T.length;)I=T.J(V),N.contains(I.id)||W.contains(I.id)||(M.add(I.id),W.add(I.id)),V++;return M}initialize(){if(this.xh){const N=!!this.Vw&&!!this.Lo;
this.Vd.logger.Pg(Object.assign(new F.a,{pj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return N}this.xh=!0;if(!({iK:this.Pqa,rKc:this.NJa,W9c:this.Msa,hAd:this.ZIg,hKd:this.kRg,ule:this.lgh}=H.a.fIh(this.Vd,this.Lg,this.mF,this.Rza,this.iBa,this.rra,!1,!1)).returnValue)return!1;this.Vw=new E(this.Pqa,this.NJa,this.Lg,void 0,void 0,this.sra);this.Lo=new E(this.Pqa,this.Msa,this.Lg,void 0,void 0,this.sra);a.a.instance.Ta(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",
this.Vw.nua,this.Vw.Wla,this.Lo.nua,this.Lo.Wla));return!0}ZHa(){a.a.instance.Ta(593826836,1,4,"Attempting to merge with LCS");let N=!1;const M=new m.a(this.Lg,this.Vd);let I=null,T=null;var U=null;const W=Y=>this.Vd.runtime.pk.J(Y),V=Y=>this.Vd.runtime.zq.J(Y)||this.Vd.runtime.pk.J(Y);this.Vw=new E(this.Pqa,this.NJa,this.Lg,void 0,void 0,this.sra,!1);this.Lo=new E(this.Pqa,this.Msa,this.Lg,void 0,void 0,this.sra,!1);({updateHints:I}=M.HJh(this.mF,W,this.Rza,Y=>this.Vd.runtime.ru.J(Y)||this.Vd.runtime.pk.J(Y),
this.Vw.Sz,this.Vw.Sz+this.Vw.nua,this.Vw.Sz+this.Vw.Wla)).returnValue&&({updateHints:T}=M.HJh(this.mF,W,this.iBa,V,this.Lo.Sz,this.Lo.Sz+this.Lo.nua,this.Lo.Sz+this.Lo.Wla)).returnValue&&(N=!0);N||(a.a.instance.Ta(593826835,1,2,"Failed to create update hints with LCS"),N=!1);N&&(U=new K.a(this.Vd,this.mF,this.Rza,this.iBa,Y=>this.Vd.runtime.Xb?this.Vd.runtime.Xb.isFeatureEnabled(Y):!1,this.Lg,null,I,T),({Xm:U}=U.Rkc()).returnValue||(a.a.instance.Ta(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),
this.Vd.logger.Pg(Object.assign(new F.a,{pj:"TryLCSMerge",eventId:"9zrqs"})),N=!1));a.a.instance.Ta(593826833,1,N?4:2,"TryLCSMerge: [Success: {0}]",N);return{returnValue:N,Xm:U}}Rkc(){let N;N=null;if(!this.initialize())return this.Vd.logger.kU("ParagraphMerge Initialize"),this.j3a(),{returnValue:!1,Xm:N};this.Vd.logger.kU("ParagraphMerge Initialize");let M;this.Vd.logger.cfe(2);let I=({ZHa:M}=this.kil()).returnValue;I=I&&({Xm:N,ZHa:M}=this.BNc(this.Vd,this.Lg,this.rra,this.nXb,this.gvb)).returnValue;
this.Vd.logger.Y8f();if(!I){this.Vd.logger.kU("ParagraphMerge DoMergeInteral");if(M){this.Vd.logger.cfe(3);({Xm:N,returnValue:I}=this.ZHa());this.Vd.logger.Y8f();if(I)return{returnValue:!0,Xm:N};this.j3a();return{returnValue:!1,Xm:N}}this.j3a();return{returnValue:!1,Xm:N}}if(!({Xm:N,ZHa:M}=this.BNc(this.Vd,this.Lg,this.rra,this.nXb,this.gvb)).returnValue)return this.Vd.logger.kU("ParagraphMerge DoMergeInteral"),this.j3a(),{returnValue:!1,Xm:N};this.Vd.logger.kU("ParagraphMerge DoMergeInteral");return{returnValue:!0,
Xm:N}}BNc(){let N;if(!({Z7d:N}=H.a.BNc(this.Vd,this.Lg,this.rra,this.nXb,this.gvb)).returnValue)return this.Vd.logger.kU("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.j3a(),{returnValue:!1,Xm:N,ZHa:!0};this.Vd.logger.kU("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,Xm:N,ZHa:!1}}j3a(N=!1){a.a.instance.Eia(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+N+"] BaseRevisionMergeBlocksList: {0}",this.ZIg);a.a.instance.Eia(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",
this.kRg);a.a.instance.Eia(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.lgh);N=new e.a;H.a.Pbc(this.Lg,"BaseObjects_",this.mF,N);H.a.Pbc(this.Lg,"FavoredObjects_",this.Rza,N);H.a.Pbc(this.Lg,"ConflictObjects_",this.iBa,N);H.a.pXm(this.Vd,N)}ywh(N){let M,I;I=M=0;if(0===this.Vw.az)M=this.Lo.Sz;else if(1===this.Vw.az)M=this.Lo.Sz<this.Vw.Sz?this.Lo.Sz:this.Lo.Sz===this.Vw.Sz?N||1!==this.Lo.az?this.Lo.Sz+this.Vw.Wla:this.Lo.Sz:this.Lo.Sz+this.Vw.Wla;else if(2===this.Vw.az||3===this.Vw.az)M=
this.Lo.Sz<=this.Vw.Sz?this.Lo.Sz:this.Lo.Sz+(this.Vw.Wla-this.Vw.nua);if(2===this.Lo.az||3===this.Lo.az)I=M+this.Lo.nua;return{ygi:M,Bcm:I}}nWh(N,M){let I;I=0;if(!M)return{returnValue:!0,oYc:I};let T=0,U=0;for(;T<N.length;){let W;for(let V=T;V<N.length;V++){T=V;W=N.J(V);const Y=W.length;U+=Y;if(!(U<M)){if(U>M)if(W.v6a)N.QF(T),N.fA(T,W.x7c()),U-=Y;else return a.a.instance.Ta(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",
M),this.Vd.logger.Pg(Object.assign(new F.a,{pj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,oYc:I};break}}if(U===M)return T++,I=T,{returnValue:!0,oYc:I}}a.a.instance.Ta(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",M);this.Vd.logger.Pg(Object.assign(new F.a,{pj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,oYc:I}}Jyk(N,M,I){let T=0;var U=0,W=!1;const V=this.Lo.wcf.y4();
if(this.Lo.oLk())for(--M;0<=M;M--){let Y=N.J(M);if(this.Lo.nTc(Y)){U=N.J(M);T=U.runId;U=U.wg;W=!0;break}}W||((U=N.J(I))&&this.Lo.nTc(U)?(T=U.runId,U=U.wg):U=T=0);for(N=0;N<V.length;N++)I=V.J(N),I.I3()&&(W=I,this.Lo.nTc(I)?(W.runId=T,W.wg=U):(W.runId=0,W.wg=0));return V}pvi(N){if(2===N.length){const M=1===N.J(0).type?N.J(0):null;N=2===N.J(1).type;if(M&&N&&""===M.text)return!0}return!1}kil(){const N=this.Vw.JFm();if(!N&&0===this.Vw.az)return this.nXb=this.Lo.CJ.y4(),this.gvb=this.v8h(this.Lo),{returnValue:!0,
ZHa:!1};if(0===this.Lo.az)return this.nXb=this.Vw.CJ.y4(),this.gvb=this.v8h(this.Vw),{returnValue:!0,ZHa:!1};(this.pvi(this.Vw.CJ)||this.pvi(this.Lo.CJ))&&this.Vd.logger.NCi(Object.assign(new F.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!N){var M=this.Vw.Ddf(this.Lo);M&&this.rra(53)&&(a.a.instance.Ta(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.Vw=new E(this.Pqa,this.NJa,this.Lg,!0,void 0,this.sra),this.Lo=
new E(this.Pqa,this.Msa,this.Lg,!0,void 0,this.sra),M=this.Vw.Ddf(this.Lo));if(M)return a.a.instance.Ta(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.Vd.logger.Pg(Object.assign(new y.a,{pj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,ZHa:!0}}var I;M=0;this.gvb=this.aXk(this.Vw,this.Lo);({ygi:I,Bcm:U}=this.ywh(!1));const T=this.Vw.CJ.y4();if(!({oYc:I}=this.nWh(T,I)).returnValue||(2===this.Lo.az||3===this.Lo.az)&&!({oYc:M}=
this.nWh(T,U)).returnValue)return{returnValue:!1,ZHa:!1};if(2===this.Lo.az||3===this.Lo.az){this.whc(T,M);this.whc(T,I-1);var U=null;for(var W=M-1;W>=I;W--)2===T.J(W).type&&(U=T.J(W)),T.QF(W);0<T.length&&(W=T.J(T.length-1),2!==W.type&&4!==W.type&&U&&(this.Vd.runtime.Xb.pB(75),this.Vd.runtime.Xb.isFeatureEnabled(75)&&(T.add(U),this.gvb.add(U.Fj))));a.a.instance.Ta(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",M-I-1,I)}if(1===this.Lo.az||3===this.Lo.az)U=this.Lo.wcf,
N&&(U=this.Jyk(T,I,M)),this.whc(T,I-1),this.whc(T,I),this.whc(U,0),this.whc(U,U.length-1),T.fA(I,U),a.a.instance.Ta(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",I,N,U.Pq());this.nXb=T;return{returnValue:!0,ZHa:!1}}whc(N,M){0>M||M>=N.length||(N=N.J(M),Object(k.a)(x.a,N)&&(N.IPa=!0))}g$c(N,M){let I;I=M;if(!this.initialize())return{returnValue:!1,g5a:N,spa:I};if(this.Lo.Ddf(this.Vw))return this.j3a(!0),this.Vd.logger.Pg(Object.assign(new y.a,
{pj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,g5a:N,spa:I};if(0===this.Lo.az||3===this.Lo.az&&this.Lo.KFm())return{returnValue:!0,g5a:N,spa:M};let T;({ygi:T}=this.ywh(!0));M<T||M===T&&(1!==this.Lo.az||1===this.Lo.az&&1===this.Vw.az&&M===this.Vw.Sz+this.Vw.Wla)?I=M:(I=M+this.Lo.Wla-this.Lo.nua,I<T&&(I=T));return{returnValue:!0,g5a:N,spa:I}}}Object(D.a)(P,"ParagraphMerge",null,[1869])},1933:function(D,L,c){c.r(L);D=c(0);var l=c(1637),e=c(1550),a=c(1513),k=c(1761),x=c(1549);class y{constructor(K=
"",H="",P="",N=-99999,M=-1,I=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=K?K:"";this.Description=H?H:"";this.Type=P?P:"";this.Score=N;this.Age=M;this.Count=I}}Object(D.a)(y,"Suggestion",null,[]);class m{constructor(K,H){this.GroupType=this.Suggestions=null;this.Suggestions=K;this.GroupType=H}}Object(D.a)(m,"SuggestionGroup",null,[]);class u{}u.help="help";u.answer="answer";u.commands="commands";u.c9n="servicecommands";u.template="template";Object(D.a)(u,
"SuggestionGroupType",null,[]);var z=c(1483),v=c(1482),E=c(2),F=c(34);c.d(L,"InteractionLogger",function(){return J});class J{constructor(K,H,P){this.oxe=0;this.uSe=this.evc=null;this.xe=K;this.zQe=this.Cue=this.cCe=!1;this.RTj=H;this.Of=E.AFrameworkApplication.Ke;this.kc=P;this.rfd=this.iLe=0}get lpa(){return this.xe.lpa}mfe(K){this.xe.mfe(K)}gEi(){if(this.evc){var K=0;for(const H of this.evc)this.xe.e0m(H,K++);this.evc=null}}beginQuery(K,H,P){this.xe.U_m(K,H,P)}dlb(K,H){this.xe.OCk(K,H);this.cCe=
!0;this.zQe=!1}Twa(){this.cCe=!1;this.Cue||(this.gEi(),this.xe.PRh(this.oxe))}V_m(K,H){this.xe.W_m(K,H)}Ifn(K,H,P,N,M){for(const I of this.RTj)if(K.startsWith(I)){this.zQe=!0;break}this.xe.zWm(K,H,P,N,M)}pgn(K){this.Cue=!1;this.oxe=K;this.cCe||this.zQe||(this.gEi(),this.xe.PRh(this.oxe,!1))}ogn(K,H){this.xe.FWm(K,H);this.Cue=!0}ikf(K,H){if(!K.count)return"";let P="";const N=Date.now();for(let M of K)K=(N-M.timeStamp)/1E3,K=v.a.Ike(K),0<P.length&&(P+=";"),P+=H?M.commandId:M.controlId,P+=":",P+=K.toString();
return P}X3a(){var K=this.ikf(l.a.instance.qMc(),!1);0<K.length&&this.xe.xWm(K);K=this.ikf(l.a.instance.hgb(),!0);0<K.length&&this.xe.PVm(K);K=this.ikf(l.a.instance.Qrc,!0);0<K.length&&this.xe.DXm(K);K=z.TellMeActor.instance.F3g;0<K.length&&this.xe.S_m(F.c(K))}A0m(K){this.xe.dWm(K)}R_(K,H,P,N,M,I,T,U=null){this.xe.OYm(K,H,P,N,M,I,T,U)}lIf(K,H,P,N){this.xe.lIf(K,H,P,N)}pA(K,H,P=null){this.xe.AH(K,H,P)}onError(K,H,P=null){this.xe.uFa(K,H,P)}Fco(K){this.evc=K}c7l(K){const H=[];if(!K)return H;for(let P=
0;P<K.length;P++){const N=a.a[K[P].groupType].toLowerCase(),M=[],I=K[P].results;if(I){for(let T=0;T<I.length;T++)"findindocument"===N?Array.add(M,new y("","",N,I[T].score,I[T].Pyd,I[T].count)):Array.add(M,new y(I[T].label,I[T].description,N,I[T].score,I[T].Pyd,I[T].count));"answer"===N||"definition"===N||"wolframanswer"===N||"entity"===N?Array.add(H,new m(M,u.answer)):"classifier"===N||"appsforoffice"===N?Array.add(H,new m(M,u.commands)):"serviceclassifier"===N?Array.add(H,new m(M,u.c9n)):"assistance"===
N?Array.add(H,new m(M,u.help)):("document"===N||"people"===N||"findindocument"===N||"notes"===N||"image"===N||"template"===N)&&Array.add(H,new m(M,N))}}return H}Yrf(K,H){const P={};P.Query=H;P.SuggestionGroups=F.c(this.c7l(K));return F.c(P)}Sdi(K){const H={"Content-Type":"application/json",Accept:"application/json"};H["X-Office-Version"]=E.AFrameworkApplication.buildVersion;H["X-Office-Application"]=E.AFrameworkApplication.K.kb("Application");H["X-Office-Platform"]="WAC";H["X-TellMe-SqmUserId"]=E.AFrameworkApplication.K.kb("LoggableUserId")||
"";H["X-TellMe-SessionId"]=this.xe.lpa.xna;H["X-TellMe-SuggestionTypes"]="Ranker";H["X-TellMe-Culture"]=E.AFrameworkApplication.uiCulture;H["X-TellMe-ProcessSessionId"]=E.AFrameworkApplication.userSessionId;H["X-TellMe-Flights"]=K;H["X-TellMe-PartialQueryIndex"]=this.iLe;return H}NJb(K,H,P){this.R_(H.length,"RankerLogging",K.data.Ve.toString(),Math.round(window.performance.now()-P),x.a.Trj,!0,e.a.XOa)}yJb(K,H,P){this.R_(H.length,"RankerLogging",K.data.Ve.toString(),Math.round(window.performance.now()-
P),x.a.Trj,!1,e.a.XOa)}Tdi(){this.uSe||(this.uSe=new k.a(this.kc,null,6E3));return this.uSe.I9}oIf(K){const H=this.Yrf(this.evc,K),P=this.Sdi("RankerLogging"),N=window.performance.now();this.Of.oj(this.Tdi(),2,H,P,!1,0,M=>{this.NJb(M,K,N)},M=>{this.yJb(M,K,N)},null,null,!1,4E3,6E3);this.iLe++}a_n(){this.iLe=0}g8f(K){this.rfd=K}}Object(D.a)(J,"InteractionLogger",null,[])},1935:function(D,L,c){c.r(L);D=c(0);var l=c(17),e=c(6),a=c(177),k=c(231),x=c(60),y=c(1701),m=c(1614),u=c(1568),z=c(1553);class v{constructor(K,
H,P=null){this.author=K;this.CXc=H;this.MXf=P||x.a.nil}hA(K){return K?this.author===K.author&&this.CXc===K.CXc&&this.MXf===K.MXf:!1}}Object(D.a)(v,"RunMergeBlockTrackedChangeAttribute",null,[]);class E{constructor(K,H,P){this.insertion=K||E.Sef;this.deletion=H||E.Sef;this.pGa=P||E.Sef}get nim(){return 0<this.insertion.author.length}get Phm(){return 0<this.deletion.author.length}get Tim(){return 0<this.pGa.author.length}hA(K){return K?this.insertion.hA(K.insertion)&&this.deletion.hA(K.deletion)&&this.pGa.hA(K.pGa):
!1}}E.Sef=new v("",0);Object(D.a)(E,"RunMergeBlockTrackedChangeInfo",null,[]);var F=c(1758);c.d(L,"ParagraphMergeBlockCreator",function(){return J});class J extends m.a{constructor(K,H,P,N,M,I,T){super();this.maxValue=Number.MAX_VALUE;this.NA=new y.a;this.NRb=null;this.oN=0;this.XXg=!1;this.$vc="";this.Gqe=K;this.zs=H;this.gu=P;this.qdk=N;this.Phd=M;this.fXg=I;this.Lg=T;if(this.Lg.hasProperty(this.zs,l.a.yo))if(this.Lg.hasProperty(this.zs,e.a.Lc))if(this.Lg.hasProperty(this.zs,e.a.$p))if(this.Lg.hasProperty(this.zs,
e.a.Ps))if(this.Lg.hasProperty(this.zs,l.a.En))if(this.V1=this.Lg.getPropertyString(this.zs,l.a.yo),this.yVe=this.Lg.getPropertyUint32(this.zs,e.a.Lc),this.Qr=this.Lg.getPropertyUint32s(this.zs,e.a.$p),this.rpd=this.Lg.getPropertyUint32s(this.zs,e.a.Ps),this.qze=this.Lg.getPropertyObjectIds(this.zs,l.a.En),this.V1||""===this.V1)if(this.V1.length||1!==this.qze.length||(this.Qr.length||(this.Qr.add(0),a.a.instance.Ta(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),
this.rpd.length||(this.rpd.add(0),a.a.instance.Ta(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.P5j=this.tMd(this.zs,e.a.jOf,this.Qr.length),this.Lxc=this.tMd(this.zs,l.a.Kwa,this.Qr.length),this.xka=this.tMd(this.zs,l.a.bob,this.Qr.length),this.Mja=this.tMd(this.zs,e.a.HOa,this.Qr.length),this.ika=this.o$l(this.zs,e.a.rGa,this.Qr.length),this.Ppm(),K=this.Lg.hasProperty(this.zs,l.a.sm)?this.Lg.getPropertyUint32s(this.zs,l.a.sm):new k.a,this.gsd=
z.a.Egj(K,this.V1.length),this.Qr.length!==this.rpd.length)a.a.instance.Ta(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",H.id);else if(this.Qr.length!==this.qze.length)a.a.instance.Ta(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",H.id);else{this.fXg&&(this.Lg.hasProperty(this.zs,e.a.qv)?this.NRb=this.Lg.getPropertyObjectIds(this.zs,e.a.qv):(a.a.instance.Ta(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",
H.id),this.NRb=this.LZ(this.Qr.length,x.a.nil)),this.Qr.length!==this.NRb.length&&(a.a.instance.Ta(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",H.id,this.Qr.length,this.NRb.length),this.NRb=this.LZ(this.Qr.length,x.a.nil)));if(this.Qr.length!==this.Lxc.length||this.Qr.length!==this.xka.length||this.Qr.length!==this.Mja.length||this.Qr.length!==this.ika.length)this.Qr.length===this.Lxc.length||this.Phd||a.a.instance.Ta(8266445,
1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",H.id,this.Qr.length,this.Lxc.length),this.Qr.length===this.xka.length||this.Phd||a.a.instance.Ta(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",H.id,this.Qr.length,this.xka.length),this.Qr.length===this.Mja.length||this.Phd||a.a.instance.Ta(20742792,
1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",H.id,this.Qr.length,this.Mja.length),this.Qr.length===this.ika.length||this.Phd||a.a.instance.Ta(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",H.id,this.Qr.length,this.ika.length),K=this.Lg.getPropertyBool(this.zs,l.a.t7e),a.a.instance.Ta(17877020,
1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",H.id,M,null==K?!1:K),this.Lxc=this.LZ(this.Qr.length,!0),this.xka=this.LZ(this.Qr.length,!1),this.Mja=this.LZ(this.Qr.length,!1),this.ika=this.LZ(this.Qr.length,0),this.Lg.setPropertyBool(this.zs,l.a.t7e,!1);this.NA.$Uo(this.Qr.length)?(this.gsd.length!==this.Qr.length+1&&a.a.instance.Ta(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",
H.id,this.Qr.length,this.gsd.length),this.U2j=!0):a.a.instance.Ta(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",H.id)}else a.a.instance.Ta(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",H.id);else a.a.instance.Ta(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",H.id);else a.a.instance.Ta(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",H.id);else a.a.instance.Ta(3993796,
1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",H.id);else a.a.instance.Ta(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",H.id);else a.a.instance.Ta(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",H.id)}Ppm(){this.Lg.hasProperty(this.zs,e.a.GEa)?this.NA.mib=this.Lg.getPropertyBools(this.zs,e.a.GEa):this.NA.mib=this.LZ(this.Qr.length,!1);this.Lg.hasProperty(this.zs,e.a.kfa)?this.NA.Keb=this.Lg.getPropertyBools(this.zs,e.a.kfa):
this.NA.Keb=this.LZ(this.Qr.length,!1);this.Lg.hasProperty(this.zs,e.a.HEa)?this.NA.lib=this.Lg.getPropertyStrings(this.zs,e.a.HEa):this.NA.lib=this.LZ(this.Qr.length,"");this.Lg.hasProperty(this.zs,e.a.XCa)?this.NA.Jeb=this.Lg.getPropertyStrings(this.zs,e.a.XCa):this.NA.Jeb=this.LZ(this.Qr.length,"");this.Lg.hasProperty(this.zs,e.a.IEa)?this.NA.nib=this.Lg.getPropertyListOfMilliseconds(this.zs,e.a.IEa):this.NA.nib=this.LZ(this.Qr.length,0);this.Lg.hasProperty(this.zs,e.a.YCa)?this.NA.VZa=this.Lg.getPropertyListOfMilliseconds(this.zs,
e.a.YCa):this.NA.VZa=this.LZ(this.Qr.length,0);this.Lg.hasProperty(this.zs,e.a.qGa)?this.NA.w4a=this.Lg.getPropertyBools(this.zs,e.a.qGa):this.NA.w4a=this.LZ(this.Qr.length,!1);this.Lg.hasProperty(this.zs,e.a.VHa)?this.NA.amb=this.Lg.getPropertyStrings(this.zs,e.a.VHa):this.NA.amb=this.LZ(this.Qr.length,"");this.Lg.hasProperty(this.zs,e.a.WHa)?this.NA.cmb=this.Lg.getPropertyListOfMilliseconds(this.zs,e.a.WHa):this.NA.cmb=this.LZ(this.Qr.length,0);this.Lg.hasProperty(this.zs,e.a.xya)?this.NA.bmb=this.Lg.getPropertyObjectIds(this.zs,
e.a.xya):this.NA.bmb=this.LZ(this.Qr.length,x.a.nil)}tMd(K,H,P){return this.Lg.hasProperty(K,H)?this.Lg.getPropertyBools(K,H):this.LZ(P,!1)}o$l(K,H,P){return this.Lg.hasProperty(K,H)?this.Lg.getPropertyUint32s(K,H):this.LZ(P,0)}LZ(K,H){const P=new k.a;for(let N=0;N<K;N++)P.add(H);return P}G8l(K){const H=this.gsd.$f(K);K=this.gsd.$f(K+1);return this.V1.substring(H,K)}K8h(){if(this.XXg)return null;var K=this.oN<this.Qr.length?this.Qr.$f(this.oN):this.maxValue;if(K===this.maxValue||this.qdk&&!this.V1.length)return this.XXg=
!0,K=new u.a(this.gu,this.zs.id,this.yVe),this.$vc=this.UZe(this.$vc,K.toString()),K;const H=this.rpd.$f(this.oN),P=this.qze.$f(this.oN),N=this.P5j.$f(this.oN),M=this.Lxc.$f(this.oN),I=this.xka.$f(this.oN),T=this.Mja.$f(this.oN),U=this.ika.$f(this.oN),W=this.fXg?this.NRb.$f(this.oN):null;var V=null;this.NA.mib.$f(this.oN)&&(V=new v(this.NA.lib.$f(this.oN)||"",this.NA.nib.$f(this.oN)));var Y=null;this.NA.Keb.$f(this.oN)&&(Y=new v(this.NA.Jeb.$f(this.oN)||"",this.NA.VZa.$f(this.oN)));var da=null;this.NA.w4a.$f(this.oN)&&
(da=new v(this.NA.amb.$f(this.oN)||"",this.NA.cmb.$f(this.oN),this.NA.bmb.$f(this.oN)));V=new E(V,Y,da);Y=this.G8l(this.oN);this.oN++;da=Y.startsWith("\ufddfHYPERLINK ");K=new F.a(this.Gqe,this.gu,this.zs.id,H,K,P,Y,N,!da,M,I,T,U,V,W);this.$vc=this.UZe(this.$vc,K.toString());return K}t8h(){let K;K=null;var H="";if(!this.U2j)return{oKf:K,z3a:H};if(H=this.K8h())K=new k.a,K.add(H);for(;H=this.K8h();)K.add(H);H=this.$vc;return{oKf:K,z3a:H}}}Object(D.a)(J,"ParagraphMergeBlockCreator",m.a,[])},1938:function(D,
L,c){c.r(L);D=c(0);var l=c(231),e=c(1614),a=c(1567);class k extends a.a{constructor(y,m){super(4,y,m)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Fj)}W5b(){return"Table"}clone(){return new k(this.source,this.Fj)}hA(y,m,u,z=!1){return super.hA(y,m,u,z)?this.Fj.equals(y.Fj):!1}get length(){return 1}}Object(D.a)(k,"TableMergeBlock",a.a,[]);c.d(L,"TableMergeBlockCreator",function(){return x});class x extends e.a{constructor(y,m){super();this.iJg=new k(m,y.id)}t8h(){let y;
y=new l.a;y.add(this.iJg);return{oKf:y,z3a:this.UZe("",this.iJg.toString())}}}Object(D.a)(x,"TableMergeBlockCreator",e.a,[])},2020:function(D,L,c){c.r(L);var l=c(2),e=c(0),a=c(46),k=c(152);class x extends k.a{constructor(Q){super(!1,!1,!0);this.icd=Q}start(){const Q={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.icd.Wvf}};this.Yh("",Object(a.a)(this,this.J4f,"resultHandler"),Q)}J4f(Q,za){1===Q&&(this.icd.Wvf=za.tooltipPersistenceEnabled)}}Object(e.a)(x,
"AccessibilitySettingsDialog",k.a,[]);var y=c(62),m=c(12);class u{constructor(Q,za){this.ga=Q;this.icd=za}Ub(){this.ga.pa(m.a.Jno,y.a.frame,Object(a.a)(this,this.Kno,"showAccessibilitySettingsDialogHandler"))}Kno(){(new x(this.icd)).start();return 32}}Object(e.a)(u,"AccessibilitySettingsDialogActor",null,[1903]);var z=c(438);const v=Q=>{const za=new z.a;l.AFrameworkApplication.Ke.oj(E(Q),1,null,null,!0,2,hb=>{200===hb.data.Ve?za.xg("true"===hb.data.we.toLowerCase()):za.xg(!1)},()=>{za.xg(!1)},null,
void 0,void 0,void 0,void 0,"7");return za.task},E=Q=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",l.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",Q,l.AFrameworkApplication.fm);var F=c(112);class J{constructor(){this.mUb=null}get Wvf(){return!!this.mUb}set Wvf(Q){Q!==this.mUb&&(this.mUb=Q,F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Q),this.Kwi()&&l.AFrameworkApplication.Ke.oj(E("saveHoverableRibbonTooltipIsEnabled"),
2,Q.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}SSm(){const Q=new z.a;if(this.mUb)Q.xg(this.mUb);else if(this.Kwi()){const za=v("getHoverableRibbonTooltipIsEnabled");za.continueWith(()=>{this.mUb=za.result;F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(za.result);Q.xg(za.result)},8)}else Q.xg(!1)}Kwi(){const Q=l.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),za=l.AFrameworkApplication.K.$("IsAnonymousUser");return Q&&
!za}}Object(e.a)(J,"AccessibilitySettingsInfo",null,[1902]);var K=c(180),H=c(36);class P{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}yc(Q){this.W=Q;this.W.register(J,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Qd(()=>new J).singleInstance();this.W.register(u,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Qd(()=>
new u(l.AFrameworkApplication.xa,this.W.Ma("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).singleInstance()}init(){const Q=this.W.Ma("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),za=this.W.Ma("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");Q&&za?(za.Ub(),Q.SSm()):H.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){K.a.instance.Gc(new P)}}
Object(e.a)(P,"AccessibilitySettingsPackage",null,[1,2]);var N=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},M=c(67);class I extends Sys.EventArgs{constructor(Q,za){super();this.Qje=Q;this.actualValue=za}}Object(e.a)(I,"CpuMeterMonitorThresholdExceededEventArgs",
Sys.EventArgs,[]);class T{constructor(){this.lSb=[];this.VMg=this.Rue=0;this.pi=null;this.ra=new M.a}init(Q,za,hb){this.pi=Q;this.Rue=za;this.VMg=hb;this.pi.eYe(Object(a.a)(this,this.L4d,"onCpuMeterFrameAvailable"));this.Eqk(Object(a.a)(this,this.$0k,"cpuPercentThresholdExceeded"))}L4d(Q,za){za.$Ji&&(Array.enqueue(this.lSb,za.$Ji.CP),this.lSb.length>this.VMg&&(Array.dequeue(this.lSb),this.eOk()))}eOk(){var Q=this.lSb.length;let za=0;for(let hb=0;hb<Q;hb++){const Tb=Array.dequeue(this.lSb);za+=Tb;
Array.enqueue(this.lSb,Tb)}Q=za/Q;Q>this.Rue&&this.ra.raiseEvent("CPTTE",new I(this.Rue,Q))}$0k(Q,za){H.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.lFd(za.Qje,za.actualValue))}Eqk(Q){this.ra.addHandler("CPTTE",Q)}lFd(Q,za){const hb={};hb.ThresholdValue=Q;hb.ActualValue=za;return hb}}Object(e.a)(T,"CpuMeterMonitor",null,[1899]);class U{constructor(){this.S=this.T=this.M=this.C=0}}Object(e.a)(U,"ProfileInformation",null,[]);var W=c(7),V=c(29),Y=c(200),da=c(72);class ba{constructor(Q=
0,za=0){this.btb=!1;this.vsb={};this.Rmd=Q;this.knd=za;this.aUe=0;V.a.addHandler(window.self,W.a.Wnh,()=>{this.btb=!0});V.a.addHandler(window.self,W.a.Xnh,()=>{this.btb=!1})}Znh(Q,za,hb){const Tb=ba.generateKey(za,hb);Tb in this.vsb?za=this.vsb[Tb]:(za=new U,za.S=hb?1:0,this.vsb[Tb]=za,this.aUe++);za.C++;za.M=Q>za.M?Q:za.M;za.T+=Q}EBa(Q,za){this.Znh(Q,za,!1);this.btb&&this.Znh(Q,za,!0)}getData(){if(0<this.knd&&this.aUe>this.knd)return this.eLl();const Q=0<this.Rmd,za={},hb=this.vsb;for(let zc in hb){var Tb=
zc;const kd=hb[zc];this.o$i(kd);Q&&kd.T>=this.Rmd&&(za[Tb]=kd)}return Q?da.a.mf(za)?null:za:this.vsb}eLl(){var Q=0<this.Rmd,za=[];const hb=this.vsb;for(let Tb in hb){const zc={key:Tb,value:hb[Tb]};let kd=zc.value;(!Q||kd.T>=this.Rmd)&&Array.add(za,zc)}if(za.length>this.knd)za.sort((Tb,zc)=>zc.value.T-Tb.value.T),za=za.slice(0,this.knd);else if(!za.length)return null;Q={};for(const Tb of za)za=Tb.value,this.o$i(za),Q[Tb.key]=za;return Q}o$i(Q){Q.M=Y.a.GU(Q.M,0);Q.T=Y.a.GU(Q.T,0)}reset(){this.vsb={};
this.aUe=0}static generateKey(Q,za){return za?Q+" [it]":Q}}Object(e.a)(ba,"FunctionCallAggregator",null,[878]);var ja=c(1084);class sa{}Object(e.a)(sa,"CpuMeterFrame",null,[]);class ta extends Sys.EventArgs{constructor(Q){super();this.$Ji=Q}}Object(e.a)(ta,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class ra{}Object(e.a)(ra,"MiniTaskItemInfo",null,[]);class ma{}Object(e.a)(ma,"TaskItemInfo",null,[]);var Ba=c(1034),Pa=c(1393),Da=c(189);class Ha{constructor(Q,za,hb,Tb,zc){this.Jwb=0;this.dZ=
null;this.jsd=this.xdh=0;this.zah=!1;this.CTb=0;this.fuc=!1;this.bsa=null;this.bkd=0;this.FJe=new M.a;this.Hud=[];this.vz=Q;this.yHe=za;this.wze=hb;this.k2g=Tb;l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.bbc();this.zWj=zc;this.xze=new ba(100);this.B4j=Ba.a.GE(1,5,new Pa.a)}eYe(Q){this.FJe.addHandler("OnCpuMeterFrameAvailable",Q)}L5i(Q){this.FJe.removeHandler("OnCpuMeterFrameAvailable",Q)}dmb(Q,za,hb,Tb=null){hb=Tb?Tb.priority:7;const zc=this.vz();
this.start(za,hb);try{Q()}finally{this.stop(za,Tb),Q=this.vz()-zc,this.k2g.track(Q,za)}}he(Q,za){const hb=this.vz();try{Q()}finally{Q=this.vz()-hb,this.wze.EBa(Q,za),0<this.Jwb&&this.xze.EBa(Q,za),this.k2g.track(Q,za)}}iTf(Q){const za=new ma;za.TN=Q.FIf;za.TP=Q.priority;this.g0i(1,za)}dcc(Q){this.bkd|=Q}start(Q,za){if(!this.Jwb){this.xze.reset();const hb=this.Uyi(Q);hb&&this.Z1d(1);this.dZ=new ma;this.dZ.TN=Q;this.dZ.TP=za;this.dZ.ST=(new Date).toISOString();this.dZ.STS=Y.a.GU(this.vz(),2);hb?this.dZ.UI=
1:this.PFm(Q)?this.dZ.UI=2:this.dZ.UI=0}this.Jwb++}Z1d(Q){this.CTb|=Q}xCd(Q=!0,za=0){this.CTb=Q?0:this.CTb&~za}stop(Q,za=null){let hb;this.Jwb--;0>=this.Jwb&&this.dZ&&(hb=this.vz()-this.dZ.STS,this.jsd+=hb,this.yHe.EBa(hb,Q),this.Uyi(Q)&&this.xCd(!1,1),this.dZ.TRT=Y.a.GU(hb,2),za&&(this.dZ.TQT=Y.a.GU(za.eGn,2),this.dZ.TDT=Y.a.GU(za.eAi,2)),this.zWj&&(this.g0i(0,this.dZ),this.AYn()),this.Jwb=0);0<=Q.indexOf(ja.a.BIo)&&this.dcc(2);0<=Q.indexOf(ja.a.Y6i)&&this.dcc(4);1===(this.CTb&1)&&this.dcc(1);2===
(this.CTb&2)&&this.dcc(8)}AYn(){var Q=this.dZ.TRT;if(750<Q){let hb=this.xze.getData();if(hb){const Tb={};for(let zc in hb){var za=hb[zc];const kd=zc;kd.startsWith("SiOp_")||kd.endsWith("[it]")||(Tb[kd]=Math.round(100*za.T/Q))}hb=Tb}Q=Object.assign(new ra,{B:this.dZ.STS,T:Q,S:hb});this.B4j.track(Q,this.dZ.TN)}}hso(){var Q=this.vz()-this.xdh,za=Y.a.GU(this.jsd/Q*100,2);Q=new sa;Q.CP=za;Q.II=this.bkd;za=this.yHe.getData();da.a.count(za)&&(Q.LRT=za);za=this.wze.getData();da.a.count(za)&&(Q.FP=za);this.FJe.raiseEvent("OnCpuMeterFrameAvailable",
new ta(Q));this.Coj()}Coj(){this.yHe.reset();this.wze.reset();this.jsd=this.Jwb=0;this.xdh=this.vz();this.bkd=0;this.dZ=null}run(){this.zah?this.hso():(this.Coj(),this.zah=!0);this.bsa?this.bsa(Object(a.a)(this,this.run,"run"),1E3):window.setTimeout(Object(a.a)(this,this.run,"run"),1E3)}Jxd(Q,za,hb){const Tb=Array(2);Tb[0]=za;Tb[1]=hb;this.Hud[Q]||(this.Hud[Q]=[]);this.Hud[Q].push(Tb)}g0i(Q,za){Q=this.Hud[Q];if(!Da.a.mf(Q))for(let Tb=0;Tb<Q.length;Tb++){var hb=Q[Tb];const zc=hb[0];hb=hb[1];zc&&!zc(za)||
hb(za)}}bbc(){if(!this.fuc){const Q=window.setTimeout;this.bsa=(za,hb)=>Q(za,hb);this.fuc=!0}}Uyi(Q){return Q.startsWith("key")||Q.startsWith("input")}PFm(Q){return Q.startsWith("click")||Q.startsWith("mouse")||Q.startsWith("pointer")}}Object(e.a)(Ha,"CpuMeter",null,[208]);class oa{constructor(Q){this.ypc=null;this.Qp=new z.a;this.vz=Q}initialize(Q,za,hb,Tb=!1){this.ypc||(this.ypc=new Ha(this.vz,Q,za,hb,Tb),this.Qp.xg(this.ypc));return this.ypc}}Object(e.a)(oa,"CpuMeterProvider",null,[1897]);var wa=
c(161);class ia{constructor(Q=1){this.hD=[];this.Tfd=[];this.fj=Q}jvl(){let Q=0;for(let za=0;za<this.hD.length;za++)this.hD[za]<this.hD[Q]&&(Q=za);return Q}EBa(Q,za){Q=Y.a.GU(Q,2);if(this.hD.length<this.fj)Array.add(this.hD,Q),Array.add(this.Tfd,za);else{var hb=this.jvl();Q>this.hD[hb]&&(this.hD[hb]=Q,this.Tfd[hb]=za)}}getData(){return this.hD.length?{["Vals"]:this.hD,["Desc"]:this.Tfd}:null}reset(){this.hD=[];this.Tfd=[]}}Object(e.a)(ia,"MaxDataAggregator",null,[878]);var ca=c(35),pa=c(21);class Ma{get name(){return"Common.App.CpuMeter"}yc(Q){Q.register(oa,
"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").singleInstance().Qd(()=>new oa(ca.a.Ue));Q.register(T,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").singleInstance().Qd(()=>new T)}init(){const Q=l.AFrameworkApplication.K;if(Q.$("CpuMeterIsEnabled")){const za=pa.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");wa.a.instance.ezd.continueWith(()=>{Ma.Aqm(Q,za)})}}dispose(){}static Aqm(Q,za){const hb=Ba.a.GE(10,5,new ba(Q.pc("TaskManagerLoggingThreshold",
0),Q.pc("CpuMeterMaximumEntriesToLog",0)));za=za.initialize(new ia(5),new ba,hb,Q.$("CPUMeterExposeTaskDetailsIsEnabled"));Q.$("WordEditorInteractivePerfDisableCpuMeterFrames")||(za.run(),Q.$("CpuMeterMonitorIsEnabled")&&pa.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(za,Q.yT("CpuMeterAverageCpuPercentThreshold",80),Q.pc("CpuMeterRollingAverageFramesCount",15)));H.b(16827671,306,50,"Initializing CpuMeter")}static main(){K.a.instance.Gc(new Ma)}}Object(e.a)(Ma,"CpuMeterPackage",
null,[1,2]);var ya=c(8),Oa=c(75),fa=c(1062),Ca=c(1040),Ta=c(15),eb=c(1394);class jb{constructor(){this.gsa=this.unc=null;this.CZb=!0;this.ruc=!1}yc(Q){l.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&Q.register(1852,"Common.IEventTimingMeter").singleInstance().Qd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var Q=new Ca.a(l.AFrameworkApplication.K.pc("EventTimingMeterEventSamplingPercent",0)/100);Q=new fa.a(Object(a.a)(Q,Q.zNb,"shouldBeInSample"));
const za=Ba.a.GE(16,1,Q);this.gsa=new eb.a("TypingDuration-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.yT("AshaVetoForTypingThresholdInMS",150),l.AFrameworkApplication.K.yT("AshaVetoForTypingThresholdPercentile",95),this.CZb);(this.ruc=!Ta.a.A2a)&&l.AFrameworkApplication.uJ(()=>{this.L4e()});this.unc=hb=>{hb=hb.rawEvent.detail;for(const Tb of hb)za.track(Tb,"EventTimingData"),"false"!==Tb.metadata.altPressed.toString()||"false"!==Tb.metadata.ctrlPressed.toString()||"false"!==Tb.metadata.repeat.toString()||
"CharacterKey"!==Tb.metadata.key.toString()&&"Space"!==Tb.metadata.key.toString()||!this.ruc||this.gsa.uxa(Tb.timeToRequestAnimationFrameMs)};V.a.addHandler(window.self,W.a.Vnh,this.unc)}dispose(){this.unc&&(V.a.removeHandler(window.self,W.a.Vnh,this.unc),this.unc=null)}L4e(){this.gsa.ERa();this.gsa.mTi&&(ya.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),Oa.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){K.a.instance.Gc(new jb)}}
Object(e.a)(jb,"EventTimingMeterPackage",null,[1,2]);var ob=c(76),Ya=c(82),Xa=c(34);class Sa{constructor(Q,za,hb,Tb=null,zc=null){this.xL=Q;this.Gsb=za;this.tsc=hb;this.g8g=Tb;this.$xc=zc}JJd(Q){const za=new Sys.StringBuilder(this.xL.d4c);za.append("RoamingServiceHandler.ashx?action=");za.append("getFirstRunExperienceSettings");za.append("&");za.append(this.Pqf(Q));za.append("&");za.append(l.AFrameworkApplication.fm);l.AFrameworkApplication.Ke.oj(za.toString(),1,null,null,!0,2,Object(a.a)(this,this.aEa,
"getRequestSuccessCallback"),Object(a.a)(this,this.Oaa,"getRequestFailureCallback"),null)}R4b(Q){var za=new Sys.StringBuilder(this.xL.d4c);za.append("RoamingServiceHandler.ashx?action=");za.append("saveFirstRunExperienceSettings");za.append("&");za.append(l.AFrameworkApplication.fm);za=za.toString();Q=Xa.c(Q);l.AFrameworkApplication.Ke.oj(za,2,Q,null,!0,4,Object(a.a)(this,this.myn,"postRequestSuccessCallback"),Object(a.a)(this,this.cca,"postRequestFailureCallback"),null)}aEa(Q){let za=!1,hb=null;
try{if(0<Q.data.we.length){const Tb=Object(Ya.a)(Object,Xa.a(Q.data.we)),zc=Tb?Tb[this.xL.LZe]:null;zc&&(hb=Object(Ya.a)(Object,Xa.a(zc.toString())))}za=!0}catch(Tb){this.Oaa(null)}za&&this.Gsb&&this.Gsb(Q.data,hb)}Oaa(Q){this.tsc&&this.tsc(Q?Q.data:null)}myn(Q){this.g8g&&this.g8g(Q?Q.data:null)}cca(Q){this.$xc&&this.$xc(Q?Q.data:null)}Pqf(Q){const za=new Sys.StringBuilder("requestedsettings=");for(let hb=0;hb<Q.count;hb++)za.append(Q.J(hb)),hb<Q.count-1&&za.append(";");return za.toString()}}Object(e.a)(Sa,
"FirstRunExperienceRequestHandler",null,[]);var ab=c(204);class Hb{constructor(){this.$rc=this.Bhd=this.xL=null}Poo(Q){Q?(this.xL=Q,this.MFm()&&(ya.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Q=new ob.a,Q.add(this.xL.LZe),this.Bhd=new Sa(this.xL,Object(a.a)(this,this.aEa,"getRequestSuccessCallback"),Object(a.a)(this,this.Oaa,"getRequestFailureCallback"),null,Object(a.a)(this,this.cca,"postRequestFailureCallback")),this.Bhd.JJd(Q)),
(this.xL.oyi||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.abg()):ya.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}MFm(){try{if(this.xL.oyi)return!0;if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||l.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;if(this.xL.CAm||this.xL.Gac||l.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const Q=
l.AFrameworkApplication.K.kb("FlightId");return-1!==(Q?Q.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Q){ya.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Q?Q.toString():null)}return!1}laj(Q){const za={},hb={};hb.FREDisplayedDate=(new Date).toUTCString();hb.VersionDisplayed=Q;hb.RemindMeLater=!1;za[this.xL.LZe]=Xa.c(hb);ya.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.Bhd&&this.Bhd.R4b(za)}aEa(Q,
za){Q=Q?+Q.XS-+Q.tH:-1;Q>this.xL.Z9i?ya.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Q,this.xL.Z9i):za?this.Gno(za)?(ya.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.xL.kIi),this.abg()):(this.Vcf(!1),ya.ULS.sendTraceTag(51675537,
306,100,"Current user has already seen this version of the FRE. No further action required.")):(ya.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.abg())}Oaa(Q){this.Vcf(!1);ya.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Q?Q.Ve:-1)}cca(Q){ya.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Q?Q.Ve:
-1)}abg(){this.Vcf(!0);var Q=pa.a.instance.Ma("Common.ISystemInitiatedFeedback");Q?this.ulj(Q):(ya.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Q=pa.a.instance.Sa("Common.ISystemInitiatedFeedback"))?Q.execute(za=>{this.ulj(za)}):ya.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}ulj(Q){if(Q){var za=this.xL.Sxl;
za&&(l.AFrameworkApplication.An(za),l.AFrameworkApplication.loa(za));ya.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",za);Q.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.$rc=Object(a.a)(this,this.Dhn,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.$rc,!0),window.addEventListener("FRELaunchedEvent",this.$rc,!0)):(ya.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.laj(this.xL.currentVersion))}else ya.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}Dhn(Q){if(Q){var za=Q.detail;Q=Q.type;var hb=this.xL&&this.xL.Ywh?this.xL.Ywh.split("-")[0]:null;if("FRELaunchedEvent"===Q||hb&&za&&za.id&&-1!==za.id.indexOf(hb))za.success&&(ya.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.laj(this.xL.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.$rc,
!0),window.removeEventListener("FRELaunchedEvent",this.$rc,!0))}}Gno(Q){if("RemindMeLater"in Q&&"FREDisplayedDate"in Q){if("true"===Q.RemindMeLater.toString()&&(+new Date-+new Date(Q.FREDisplayedDate.toString()))/36E5>this.xL.kIi)return!0}else if(l.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in Q&&Q.VersionDisplayed<this.xL.currentVersion)return ya.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}Vcf(Q){l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
ab.a.dispatch("FREDecisionEvent",{["show"]:Q})}}Object(e.a)(Hb,"FirstRunExperienceLauncher",null,[1846]);class pb{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}yc(Q){this.W=Q;this.W.register(1846,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").singleInstance().Qd(()=>new Hb)}init(){}dispose(){}static main(){K.a.instance.Gc(new pb)}}Object(e.a)(pb,"FirstRunExperienceLauncherPackage",null,[1,2]);class Mb{constructor(){this.y=this.x=0}}Object(e.a)(Mb,
"HammerPoint",null,[]);class Qb{constructor(Q,za,hb,Tb,zc){this.q0g=this.CVa=this.Pjd=1;this.Wvd=this.qBc=this.QXa=0;this.SIe=this.fJa=null;this.jqb=this.Iye=this.Eqd=!1;this.mj=Q;this.KLa=za;this.jwb=hb;this.ga=Tb;zc&&(this.Eqd=zc.$("PromoteLayerPinchToZoomIsEnabled"),this.Iye=zc.$("FinalizeWithInitialPinchScaleIsEnabled"),this.jqb=zc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get VK(){return this.KLa}eDm(){return!!this.mj.instance}$hn(Q){this.ga&&this.ga.processAction(m.a.Noj,2);const za=this.mj.instance;
this.Eqd&&za.W_i();this.CVa=za.ij;this.Pjd=Q.HLc.scale;this.q0g=1;this.SIe=this.Cwh();this.fJa=this.KLa.getBounds();if(!this.fJa)return ya.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;Q=this.O$h(Q);this.jqb?this.agj(this.KLa.scrollWidth,this.fJa.width,Q,this.CVa,za):this.QXa=this.KLa.scrollWidth>this.fJa.width?this.tEc(this.jwb.scrollLeft,Q.x,this.CVa):null;this.Wvd=this.KLa.scrollHeight>this.fJa.height?this.tEc(this.jwb.scrollTop,Q.y,this.CVa):null;return!0}n4f(){this.QXa=null;this.qBc=
0}agj(Q,za,hb,Tb,zc){Q>za?this.QXa?(Q=zc.MGf,Q!==this.qBc&&(this.QXa-=this.qBc-Q,this.qBc=Q)):(this.QXa=this.tEc(this.jwb.scrollLeft,hb.x,Tb),this.qBc=zc.MGf):this.n4f()}Zhn(Q){const za=this.O$h(Q);if(!za)return ya.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;Q=this.Xao(Q.HLc.scale/this.Pjd)*this.CVa;this.SQo(za,Q);this.TQo(za,Q);return!0}SQo(Q,za){const hb=this.KLa.scrollWidth,Tb=this.fJa.width;this.jqb?this.agj(hb,Tb,Q,za,this.mj.instance):!this.QXa&&hb>Tb&&(this.QXa=this.tEc(this.jwb.scrollLeft,
Q.x,za));if(Q=this.Kwh(Q.x,this.QXa,hb,Tb,za))this.jwb.scrollLeft=Q}TQo(Q,za){const hb=this.KLa.scrollHeight,Tb=this.fJa.height;!this.Wvd&&hb>Tb&&(this.Wvd=this.tEc(this.jwb.scrollTop,Q.y,za));if(Q=this.Kwh(Q.y,this.Wvd,hb,Tb,za))this.jwb.scrollTop=Q}Kwh(Q,za,hb,Tb,zc){return hb<=Tb||!za||!Tb?null:Math.max(0,Math.min(za*zc-Q,hb-Tb))}tEc(Q,za,hb){return(Q+za)/hb}Yhn(Q){Q=Q.HLc.scale;this.Iye&&(Q/=this.Pjd);this.MVh(Q);this.Eqd&&this.mj.instance.K_f();this.ga&&this.ga.processAction(m.a.iff,2);this.jqb&&
this.n4f()}Xhn(Q){Q=Q.HLc.scale;this.Iye&&(Q/=this.Pjd);this.MVh(Q,!0);this.Eqd&&this.mj.instance.K_f();this.ga&&this.ga.processAction(m.a.iff,2);this.jqb&&this.n4f()}Xao(Q){const za=this.mj.instance,hb=new Date>=this.SIe;hb&&(this.SIe=this.Cwh());Math.abs(Q-this.q0g)>=.01*Q&&za.Lho(Q*this.CVa,hb);return za.ij/this.CVa}MVh(Q,za=!1){Q*=this.CVa;this.mj.instance.a$f(Q,!1);const hb={};hb.initialScale=this.CVa;hb.finalScale=Q;hb.cancelled=za;ya.ULS.sendTraceTag(42821150,353,50,"Pinch zoom ended: {0}",
hb)}O$h(Q){return(Q=Q.HLc.center)&&this.fJa?Object.assign(new Mb,{x:Q.x-this.fJa.x,y:Q.y-this.fJa.y}):null}Cwh(){const Q=(new Date).getTime();return new Date(Q+1E3)}}Object(e.a)(Qb,"PinchZoomAdapter",null,[1919]);class Aa{constructor(Q){this._element=Q}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(e.a)(Aa,"ScrollContainerElement",null,[1917]);var bb=c(113);class nb{constructor(Q,
za,hb,Tb,zc,kd){this.rRe=this.g$a=null;this.W=Q;this.ge=za;this.Zkd=hb;this.fZg=Tb;this.h2j=zc;this.fUb=kd;this.Ced=new ob.a}register(Q,za){this.Zkd&&(4===l.AFrameworkApplication.ta.Ob.jm&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?bb.a.get_instance().Vk(8,()=>{this.H8i(Q,za)}):this.H8i(Q,za))}H8i(Q,za){this.W.Sa("Common.IGestureInputManager").execute(hb=>{this.bvo();this.g$a=hb;this.Ced.add(Q);if(this.fZg){if(this.h2j&&0!==hb.vQl()){this.tpj();
return}var Tb=this.W.Sa("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const zc=new Aa(Q);Tb=new Qb(Tb,zc,za,l.AFrameworkApplication.xa,l.AFrameworkApplication.K);hb.MOn(Q,Tb)}this.tpj()})}unregister(){if(this.g$a&&this.Ced){if(this.fZg){for(let Q of this.Ced)this.g$a.gKo(Q);this.Ced.clear()}this.g$a=null}}bvo(){this.fUb&&(this.ge?this.rRe=this.ge.eg("Task","Register"):ya.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}tpj(){this.fUb&&(this.rRe?this.rRe.stop():
ya.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(e.a)(nb,"GestureInputRegistrar",null,[1854]);class Va{constructor(){this.W=null;this.xh=!1}get name(){return"Common.App.GestureInput"}init(){this.xh||(this.W.resolve("Common.IGestureInputRegistrar"),this.xh=!0)}dispose(){}yc(Q){this.W=Q;Q.register(1854,"Common.IGestureInputRegistrar").singleInstance().Qd(()=>new nb(Q,l.AFrameworkApplication.ta.xq,l.AFrameworkApplication.sTc(),l.AFrameworkApplication.Uvi(),!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){K.a.instance.Gc(new Va)}}Object(e.a)(Va,"GestureInputPackage",null,[1,2]);var Ab=c(325),Zb=c(80);class Kb{constructor(){this.mmb=this.t_h=null}}Object(e.a)(Kb,"GestureAdapterInfo",null,[]);var dc=c(475),jc=c(264);class zb{constructor(){this.xrb=null}lHf(){if(!this.xrb){var Q="hammer.min.js";l.AFrameworkApplication.K.yw("IsServerFlavorDebug")&&
(Q=l.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");Q=l.AFrameworkApplication.qy(String.format("{0}",Q),5);Q=jc.a.create(Q,null,null);dc.a.ZW(Q);this.xrb=Q.f3a}return this.xrb}static get instance(){zb._instance||(zb._instance=new zb);return zb._instance}}zb._instance=null;Object(e.a)(zb,"HammerJsDependencyLoader",null,[1921]);const cc=(Q,za,hb=null)=>{if(void 0===za||null===za)throw ya.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let Tb=null;switch(Q){case W.a.pinch:Tb=new Hammer.Pinch(hb);break;case W.a.pan:Tb=new Hammer.Pan(hb)}Tb&&(Tb.manager=za);return Tb};var Ub;(function(Q){Q[Q.none=-1]="none";Q[Q.pinch=0]="pinch";Q[Q.pan=1]="pan";Q[Q.swipe=2]="swipe"})(Ub||(Ub={}));Object(e.b)("GestureEvent",Ub);var Wb=c(54);class Qa extends Wb.a{constructor(Q,za,hb,Tb,zc,kd,ce,df){super(Q,hb,Tb,kd);this.Noc=za;this.tXa=ce;this.ara=df;this.cYj=zc}get shiftKey(){return this.tXa}get ctrlKey(){return this.ara}get clientPoint(){return this.Noc}get HLc(){return this.cYj}static create(Q,
za,hb,Tb,zc,kd){if(hb.rawEvent)if(kd){var ce=hb.rawEvent;ce=new Sys.UI.Point(ce.clientX,ce.clientY)}else ce=Wb.a.DMd(hb);else ce=new Sys.UI.Point(hb.clientX,hb.clientY);return new Qa(Q,ce,za,hb,Tb,zc,hb.shiftKey,hb.ctrlKey,kd)}}Object(e.a)(Qa,"GestureEventArgs",Wb.a,[]);class sb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(e.a)(sb,"GestureManagerData",null,[]);class Jb{}Jb.VKj=2;Jb.WKj=4;Jb.XKj=8;Jb.YKj=8;Object(e.a)(Jb,"HammerConstants",null,[]);var pc=c(73),rc=c(106),db=c(16),lb=c(94);class qa extends V.a{constructor(Q,za){super();this.sKa=Ab.a.SCl;this.MLe=!!window.PointerEvent;this.Dfh=window.hasOwnProperty("ontouchstart");this.zsb=this.Swc=null;this.fKa=
!1;this.hka=new Zb.a;this.Xxc=new Zb.a;this.fTg=new ob.a;this.o9a=null;this.ERb=this.fUb=this.QKg=this.ate=this.lHe=this.s$g=this.gLg=this.zBc=!1;this.Tvc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.sRe=null;this.kg=pc.EventHandlerManager.instance;this.MLe?(ya.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Swc=Object(a.a)(this,this.Z5d,"onPointerEvent"),this.zsb=W.a.UCl):this.Dfh?(ya.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Swc=Object(a.a)(this,
this.plb,"onTouchEvent"),this.zsb=W.a.touchEvents):(ya.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Swc=Object(a.a)(this,this.L5d,"onMouseEvent"),this.zsb=W.a.TCl);this.ge=za;this.v1=Q;l.AFrameworkApplication.K&&(this.zBc=l.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.gLg=l.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.s$g=l.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.lHe=l.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),
this.ate=l.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.QKg=l.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.fUb=l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.ERb=this.zBc&&l.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&l.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}vQl(){return this.MLe?0:this.Dfh?1:2}Vu(Q){super.Vu(Q);this.kg.zEa(this.zsb,Q,0,this.Swc)}Mu(Q){super.Mu(Q);
this.kg.TZa(Q,this.zsb)}MOn(Q,za){l.AFrameworkApplication.sTc()?zb.instance.lHf().continueWith(hb=>{this.avo();if(hb.Ai||hb.wo)ya.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",hb.status);else{ya.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",hb.status);if(this.QKg){hb=window.Hammer;if("undefined"===typeof hb){ya.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.fie();return}if("undefined"===typeof hb.inputHandler){ya.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.fie();return}}if(!Q)throw this.fie(),Error.argumentNull("source element can not be null");hb=rc.a.Db(Q,this.sKa);if(void 0===hb||null===hb)hb=new Zb.a,rc.a.jl(Q,this.sKa,hb),this.NOn(Q);if(!hb.ob(Ub[0])){var Tb=Object.assign(new Kb,{mmb:cc(Ub[0],this,null),t_h:za});hb.add(Ub[0],Tb)}}this.fie()}):ya.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}avo(){this.fUb&&(this.ge?this.sRe=this.ge.eg("Task",
"RegisterGestureAdapterAfterLoad"):ya.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}fie(){this.fUb&&(this.sRe?this.sRe.stop():ya.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}gKo(Q){ya.ULS.sendTraceTag(42256223,310,Q?100:10,"source element {0} ",Q.id);const za=rc.a.Db(Q,this.sKa);void 0!==za&&null!==za&&(za.remove(Ub[0]),za.count||(rc.a.BU(Q,this.sKa),this.curRecognizer=null,this.hKo(Q)))}NOn(Q){this.fTg.add(Q);this.kg.zEa(this.zsb,Q,
0,this.Swc)}hKo(Q){this.fTg.remove(Q);this.kg.TZa(Q,this.zsb)}recognize(Q){var za=Array(Q.pointers.length);for(var hb=0;hb<Q.pointers.length;hb++)za[hb]=Q.pointers[hb].target;hb=null;for(this.o9a=this.EVl(za);void 0!==this.o9a&&null!==this.o9a&&(hb=rc.a.Db(this.o9a,this.sKa),void 0===hb||null===hb);this.o9a=this.o9a.parentNode);if(void 0!==hb&&null!==hb){this.curRecognizer&&this.curRecognizer.state===Jb.YKj&&(this.curRecognizer=null);za=hb.keys;for(let Tb of za){za=hb.J(Tb);void 0!==za&&null!==za&&
void 0!==za.mmb&&null!==za.mmb&&(void 0===this.curRecognizer||null===this.curRecognizer||za.mmb===this.curRecognizer||za.mmb.canRecognizeWith(this.curRecognizer))&&za.mmb.recognize(Q);const zc=za.mmb.state;this.curRecognizer||Jb.VKj!==zc&&Jb.WKj!==zc&&Jb.XKj!==zc||(this.curRecognizer=za.mmb)}}}emit(Q,za){if("hammer.input"!==Q){this.fKa=!1;za=Qa.create(Q,this.o9a,za.srcEvent,za,3,this.MLe);var hb=rc.a.Db(this.o9a,this.sKa);if(this.GHm(Q))var Tb=0;else if(this.fHm(Q))Tb=1;else if(this.VKm(Q))Tb=2;else{ya.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:hb}=hb.Ec(Ub[Tb]));void 0!==hb&&null!==hb&&((hb=hb.t_h,hb.eDm())?Q.endsWith("start")?this.fKa=hb.$hn(za):Q.endsWith("end")?(hb.Yhn(za),this.fKa=!0):Q.endsWith("cancel")?(hb.Xhn(za),this.fKa=!0):Q.endsWith("move")&&(this.fKa=hb.Zhn(za)):ya.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",Q))}}get(Q){return Object(Ya.a)(Hammer.Recognizer,Q)}EVl(Q){if(1>Q.length)return null;if(1===Q.length)return Q[0];
var za=Q[0],hb=!0;for(let Tb=1;Tb<Q.length;Tb++){if(!Q[Tb])return null;if(za!==Q[Tb]){hb=!1;break}}if(hb)return za;za=this.W_h(Q[0]);hb=0;for(const Tb of Q){Q=this.W_h(Tb);if(za.J(za.count-1)!==Q.J(Q.count-1))return null;for(let zc=za.count-2,kd=Q.count-2;zc>=hb&&0<=kd;zc--,kd--)if(za.J(zc)!==Q.J(kd)){hb=zc+1;break}}return za.J(hb)}W_h(Q){const za=new ob.a;for(;void 0!==Q&&null!==Q;Q=Q.parentNode)za.add(Q);return za}Q6h(Q){switch(Q){case W.a.YO:case W.a.Wyb:return 1;case W.a.XO:case W.a.t2e:return 2;
case W.a.yJ:case W.a.Xyb:return 4;case W.a.pke:case W.a.s2e:return 8}return 0}plb(Q,za,hb){Q=this.Q6h(Q);za=this.ZSl(hb);Hammer.inputHandler(this,Q,za);this.fKa&&hb.preventDefault();return this.fKa}Thi(){return 1<this.hka.count}wBd(){ya.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.zBc)for(let Q of this.hka)this.U4i(Q.key);else this.hka=new Zb.a;this.session=null}Nmk(Q,za,hb){ya.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",Q);if(!this.Xxc.ob(Q)){try{za.setPointerCapture(Q)}catch(Tb){ya.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",Tb)}this.Xxc.add(Q,za)}this.hka.Z(Q,hb);this.ERb&&1<this.hka.count&&this.v1&&!this.v1.EEc&&(this.v1.EEc=!0)}U4i(Q){ya.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",Q);if(this.Xxc.ob(Q)){try{this.Xxc.J(Q).releasePointerCapture(Q)}catch(za){ya.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",za)}this.Xxc.remove(Q)}else ya.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",Q);this.hka.remove(Q);this.ERb&&
1>=this.hka.count&&this.v1&&this.v1.EEc&&(this.v1.EEc=!1)}Z5d(Q,za,hb){var Tb=hb.rawEvent.pointerType.toString();const zc=hb.rawEvent.pointerId.toString();if("touch"!==Tb)return!1;Q=this.Q6h(Q);if(1!==Q&&!this.hka.ob(zc))return!1;this.gLg&&1===Q&&hb.rawEvent.isPrimary&&this.hka.count&&(ya.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.wBd());this.zBc?this.Nmk(zc,za,hb):this.hka.Z(zc,hb);this.lHe&&2===Q&&(!this.ate||this.ate&&"function"===typeof hb.rawEvent.getCoalescedEvents)&&
(za=hb.rawEvent.getCoalescedEvents())&&this.Thi()&&(this.Tvc=Math.max(this.Tvc,za.length));this.s$g&&(this.fKa=!1);Tb=this.YSl(this.hka,hb,Tb);Hammer.inputHandler(this,Q,Tb);if(4===Q||8===Q)this.zBc?this.U4i(zc):this.hka.remove(zc),this.hka.count||(this.session=null,this.lHe&&-1!==this.Tvc&&(ya.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Tvc),this.Tvc=-1));this.fKa&&hb.preventDefault();return this.fKa}L5d(){return!1}ZSl(Q){const za=new sb;var hb=Q.rawEvent;const Tb=
hb.touches;hb=hb.changedTouches;za.pointers=Array.clone(Tb);za.pointers=Array.clone(0<Tb.length?Tb:hb);za.changedPointers=Array.clone(hb);za.srcEvent=Q;za.pointerType="touch";return za}YSl(Q,za,hb){const Tb=new sb;Tb.pointers=lb.toArray(Q.values);Tb.changedPointers=[za];Tb.pointerType=hb;Tb.srcEvent=za;return Tb}GHm(Q){return db.a.startsWith(Q,W.a.pinch)}fHm(Q){return db.a.startsWith(Q,W.a.pan)}VKm(Q){return db.a.startsWith(Q,W.a.swipe)}}Object(e.a)(qa,"GestureInputManager",V.a,[1900,1901]);var Ga=
c(243);class Fb{constructor(){this.W=null;this.xh=!1}get name(){return"Common.App.GestureInputManager"}yc(Q){Q.register(qa,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").singleInstance().Qd(()=>new qa(Ga.a.instance,l.AFrameworkApplication.ta.xq));this.W=Q}init(){this.xh||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.xh=!0)}dispose(){}static main(){K.a.instance.Gc(new Fb)}}Object(e.a)(Fb,"GestureInputManagerPackage",null,[1,2]);var $b=c(234),
rb=c(45),xb=c(1541);class gb{constructor(Q,za,hb){this.OPe=this.NPe=null;this.bYb=new z.a;this.Of=Q;this.Kwc=hb;this.Pka=za.appSettings[gb.LWo]||""}get hjo(){return this.bYb.task}get NP(){return this.Of.value}bZn(){const Q={};Q[gb.shm]=l.AFrameworkApplication.fm;Q["Content-Type"]="application/json; charset=utf-8";ya.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const za=rb.a.fp(this.Pka+gb.ijo,gb.Xcn,l.AFrameworkApplication.ta.Ob.jm.toString());
this.NP.oj(za,1,"",Q,!0,2,Object(a.a)(this,this.OJb,"onSuccessCallback"),Object(a.a)(this,this.zJb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}yZm(Q){try{const za={};za.FlightName=Q.FlightName;za.SessionID=Q.SessionID;ya.ULS.sendTraceTag(594883776,215,50,Xa.c(za))}catch(za){ya.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}OJb(Q){if((Q=Q.data.we)&&Q.length)try{const za=Xa.a(Q);this.NPe=za.NavBarDataJson;ya.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.NPe?({Nu:this.OPe}=Xa.d(za.NavBarDataJson)).returnValue?(this.yZm(this.OPe),this.bYb.xg(this.OPe)):(ya.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:xb.a.z9c(this.NPe)}),this.bYb.qca()):(ya.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.bYb.qca())}catch(za){ya.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.bYb.qca()}else ya.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}zJb(){this.bYb.qca();
ya.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return gb._instance||(gb._instance=gb.CCb())}static CCb(){return new gb(new $b.a(()=>l.AFrameworkApplication.Ke),l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Ob.jm)}}gb.shm="X-qs";gb.Xcn="at";gb.ijo="O365ShellServiceProxy.ashx";gb._instance=null;gb.LWo="ShellWebServiceBase";Object(e.a)(gb,"O365ShellActor",null,[1898]);class Gb{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}yc(Q){this.W=
Q;this.W.register(gb,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").singleInstance().Qd(()=>new gb(new $b.a(()=>l.AFrameworkApplication.Ke),l.AFrameworkApplication.K,l.AFrameworkApplication.ta.Ob.jm))}init(){l.AFrameworkApplication.K.Wo(Object(a.a)(this,this.zx,"onFullAppSettingsReady"))}zx(){l.AFrameworkApplication.kkg&&l.AFrameworkApplication.ta.Ob.ZI&&this.W.resolve("Common.App.O365Shell.O365ShellActor").bZn()}dispose(){}static main(){K.a.instance.Gc(new Gb)}}
Object(e.a)(Gb,"PackageManager",null,[1,2]);class ac{hQa(){}init(){}dispose(){}}Object(e.a)(ac,"NoOpOfflineLogger",null,[1926,9]);var hc=c(613);class Ec{}Ec.dzd=0;Object(e.a)(Ec,"OfflineLoggerConstants",null,[]);var Uc=c(79),dd=c(236),fd=c(322);class xc{constructor(Q,za,hb,Tb,zc,kd,ce){this.oHe=this.Jvc=null;this.LVa=!1;this.b6=null;this.Lpc=this.rVb=this.lrb=0;this.VJ=this.nab=this.Qdd=this.Hpd=this.tS=null;this.Xl=!1;this.uAa=hb;this.gBa=Tb;this.WAa=zc;this.Of=za;this.Gb=Q;this.PUa=kd;ce?(this.Qdd=
new xc(Q,za,hb,Tb,zc,kd,!1),this.Qdd.Hpd=this,this.Jvc="OfflineLoggerManifest|"+this.PUa,this.oHe="OfflineLog|"+this.PUa+"|"):(this.Jvc="OfflineLoggerManifest",this.oHe="OfflineLog|")}init(){this.m$f();this.XSm();this.LVa=!1;this.Of.d_b(this);this.tS=new Uc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Gb.Wb(this.tS);this.Qdd&&this.Qdd.init()}hEc(Q){return this.oHe+Q}XSm(){const Q=this.uAa.getItem(this.Jvc);void 0!==Q&&null!==Q&&0<Q.length&&(this.b6=xc.H9c(Q));this.b6||
(this.b6={});if(void 0===this.b6.end||null===this.b6.end)this.b6.end=0;if(void 0===this.b6.offset||null===this.b6.offset)this.b6.offset=0;this.lrb=this.b6.offset;isFinite(this.lrb)||(this.lrb=0);this.rVb=this.b6.end;isFinite(this.rVb)||(this.rVb=0);this.Lpc=this.rVb}m$f(){this.nab=new fd.a;this.VJ=new dd.a;this.Hpd||(this.gBa.zmh(Object(a.a)(this,this.xTf,"onUlsReadyToBeSent")),this.gBa.dnh(Object(a.a)(this,this.zTf,"onUlsSentSuccessfully")),this.gBa.cnh(Object(a.a)(this,this.yTf,"onUlsSentFailed")));
this.gBa.pmh(Object(a.a)(this,this.GPf,"onAfterUlsHostDisposed"))}xTf(Q,za){if(void 0!==za&&null!==za&&void 0!==za.args&&null!==za.args){Q=!1;if(!this.nab.ob(za.args.tag)){if(!this.nab.ob(Ec.dzd))return;Q=!0}this.nab.remove(Q?Ec.dzd:za.args.tag);this.VJ.ob(za.uploadId)||this.VJ.Z(za.uploadId,new ob.a);this.VJ.J(za.uploadId).add(za.args)}}zTf(Q,za){this.VJ.remove(za.uploadId)}yTf(Q,za){if(void 0!==za&&null!==za&&this.VJ.ob(za.uploadId)){Q=this.VJ.J(za.uploadId);for(let hb=0,Tb=Q.count;hb<Tb;++hb)za=
xc.serialize(Q.J(hb),this.WAa),this.I9c(this.hEc(this.Lpc++),za)}}GPf(){this.dispose()}I9c(Q,za){try{return this.uAa.setItem(Q,za),!0}catch(hb){return ya.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",hb.message),!1}}sendOfflineLogs(){if(!this.LVa){for(var Q=this.lrb,za=new ob.a,hb=null;Q<this.rVb&&5>=za.count;++Q){var Tb=this.hEc(Q);const zc=this.uAa.getItem(Tb);this.uAa.removeItem(Tb);if(void 0===zc||null===zc)continue;const kd=({sessionId:Tb}=xc.deserialize(zc)).returnValue;
if(kd){if(!hb)hb=Tb;else if(Tb!==hb)break;za.add(kd)}else ya.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",zc)}0<za.count&&this.gBa.g8i(this,lb.toArray(za),hb);this.lrb=Q;Q>=this.rVb&&(this.Gb.Se(this.tS),this.tS=null)}}hQa(Q,za,hb){!this.Xl&&ya.ULS.o9(za,hb)&&(this.Hpd?this.Hpd.hQa(Q,za,hb):this.nab.Z(Q,!0))}dispose(){if(!this.Xl){this.tS&&this.Gb.Se(this.tS);var Q=lb.toArray(this.VJ.keys);Q.sort();for(const za of Q){Q=this.VJ.J(za);for(let hb=0,Tb=Q.count;hb<Tb;++hb){const zc=
xc.serialize(Q.J(hb),this.WAa);this.I9c(this.hEc(this.Lpc++),zc)}}this.lrb<this.Lpc?(this.b6.end=this.Lpc,this.b6.offset=this.lrb,this.I9c(this.Jvc,JSON.stringify(this.b6))):this.uAa.removeItem(this.Jvc)}this.Xl=!0}HQa(){this.LVa=!0}Bkb(){this.LVa=!1}static serialize(Q,za){const hb={};hb.t=Q.tag;hb.c=Q.category;hb.l=Q.level;hb.m=Q.message;hb.lt=Q.logType;hb.s=za;hb.ts=Q.timestamp;hb.o=Q.isMinified;hb.a=Q.args;return JSON.stringify(hb)}static deserialize(Q){return(Q=xc.H9c(Q))?{returnValue:new hc.a(Q.ts,
Q.c,Q.t,Q.l,Q.m,Q.lt,Q.o,Q.a),sessionId:Q.s}:{returnValue:null,sessionId:null}}static H9c(Q){try{return JSON.parse(Q)}catch(za){ya.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",za.message)}return null}}Object(e.a)(xc,"OfflineLoggerImpl",null,[1926,9,183]);class $c{constructor(Q,za,hb,Tb){this.sessionId=Q;this.version=za;this.Xzd=hb;this.fUf=Tb;this.Awa=new ob.a}}Object(e.a)($c,"CachedLogUpload",null,[]);class Bc{constructor(Q){Q.name&&(this.n=Q.name);Q.stack&&
(this.s=Q.stack);Q.message&&(this.m=Q.message);Q.file&&(this.f=Q.file);null!=Q.line&&(this.l=Q.line);null!=Q.column&&(this.c=Q.column)}}Object(e.a)(Bc,"LoggingExceptionArgsLocalStorage",null,[]);class Vd{constructor(Q){this.t=Q.tag;this.c=Q.category;this.l=Q.level;this.m=Q.message;this.lt=Q.logType;this.ts=Q.timestamp;this.o=Q.isMinified;this.a=Q.args;Q.exceptionArgs&&(this.e=new Bc(Q.exceptionArgs))}}Object(e.a)(Vd,"LoggingArgsLocalStorage",null,[]);var Je=c(366);class Gf{constructor(Q,za,hb,Tb,
zc,kd,ce){this.t=Q;this.m=za;this.s=hb;this.v=Tb;this.i=zc;this.a=kd;this.d=ce;this.op="Log"}}Object(e.a)(Gf,"LoggingKeyLocalStorage",null,[]);var Nc=c(118);const md=(Q,za,hb,Tb,zc)=>!(void 0===Q||null===Q)&&!(void 0===Q.i||null===Q.i)&&!(void 0===Q.t||null===Q.t)&&!(void 0===Q.s||null===Q.s)&&"Log"===Q.op&&Q.t===za&&isFinite(Q.t)&&Nc.a.isValid(Q.s)&&(void 0===Q.m||null===Q.m||Q.m===hb)&&(!zc||void 0===Q.d||null===Q.d||Q.d===Tb);class Oe{constructor(Q,za,hb,Tb,zc,kd,ce,df,bf,Vf,rh,ij,vi){this.LVa=
this.Y1g=this.M1g=this.N1g=!1;this.VJ=this.nab=this.b6=this.tS=null;this.Xl=!1;this.Gtb=[];this.lVb=[];this.uAa=hb;this.gBa=Tb;this.WAa=zc;this.Of=za;this.Gb=Q;this.Kwc=kd;this.rJe=ce;this.C$g=df;this.cWa=bf;this.h4j=Vf;this.JEe=rh;this.PUa=ij;this.AXg=vi}get manifest(){return this.b6}get oWc(){return this.nab}get jQa(){return this.VJ}init(){this.m$f();this.LVa=!1;this.Of.d_b(this);this.tS=new Uc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Gb.Wb(this.tS)}determineLogsToSendAtBoot(){this.pNh(!0)}determineLogsToSendOnReconnect(){this.pNh(!1)}pNh(Q){this.hJd();
this.Gtb=[];Q&&(this.lVb=[]);for(var za=0;za<this.uAa.length;za++){const hb=this.uAa.key(za),Tb=Oe.nwj(hb,!1);md(Tb,this.Kwc,this.rJe,this.PUa,this.AXg)&&(Tb.s===this.WAa?Array.add(this.Gtb,hb):Q&&Array.add(this.lVb,hb))}if(this.Gtb.length||Q&&this.lVb.length)if(za=this.JEe?Object(a.a)(this,this.mso,"sortDescendKeysToUpload"):Object(a.a)(this,this.pso,"sortKeysToUpload"),this.Gtb.sort(za),Q&&this.lVb.sort(za),0<this.Gtb.length||0<this.lVb.length)this.tS=new Uc.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,
"sendOfflineLogs"),105),this.Gb.Wb(this.tS)}pso(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}mso(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}hEc(Q,za,hb,Tb){Q=new Gf(this.Kwc,this.rJe,za,hb,Q,Tb,this.PUa);return JSON.stringify(Q)}m$f(){this.nab=new fd.a;this.VJ=new dd.a;this.gBa.zmh(Object(a.a)(this,this.xTf,"onUlsReadyToBeSent"));this.gBa.dnh(Object(a.a)(this,this.zTf,"onUlsSentSuccessfully"));this.gBa.cnh(Object(a.a)(this,this.yTf,"onUlsSentFailed"));this.gBa.pmh(Object(a.a)(this,this.GPf,
"onAfterUlsHostDisposed"))}xTf(Q,za){if(void 0!==za&&null!==za&&void 0!==za.args&&null!==za.args){if(this.oWc.ob(za.args.tag))this.oWc.remove(za.args.tag);else if(this.oWc.ob(Ec.dzd))this.oWc.remove(Ec.dzd);else if(!(this.h4j&&50>za.args.level))return;({value:Q}=this.jQa.Ec(za.uploadId)).returnValue||(Q=new $c(za.sessionId,za.version,za.Xzd,za.fUf),this.jQa.Z(za.uploadId,Q));this.jQa.J(za.uploadId).Awa.add(za.args)}}zTf(Q,za){this.jQa.remove(za.uploadId)}yTf(Q,za){void 0!==za&&null!==za&&this.jQa.ob(za.uploadId)&&
this.HIi(za.uploadId)&&!this.Y1g&&(this.Y1g=!0,ya.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}HIi(Q){let za=!1;if(({value:Tb}=this.jQa.Ec(Q)).returnValue&&Tb&&0<Tb.Awa.count){if(Tb.Xzd>=this.cWa)return!1;var hb=Tb.Awa;const zc=Array(hb.count);for(let kd=0,ce=hb.count;kd<ce;++kd)zc[kd]=new Vd(hb.J(kd));hb=Oe.serialize(zc);var Tb=this.hEc(Tb.fUf,Tb.sessionId,Tb.version,Tb.Xzd);this.I9c(Tb,hb)&&(this.jQa.remove(Q),za=!0)}return za}GPf(){this.dispose()}I9c(Q,za){try{return this.uAa.setItem(Q,
za),!0}catch(hb){return ya.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",hb.message),!1}}sendOfflineLogs(){if(!this.LVa){var Q=0<this.Gtb.length?this.Gtb:this.lVb,za=Q.length;if(za)for(;0<za;){l.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");za--;var hb=this.JEe?Q.pop():Q[0];this.JEe||Array.removeAt(Q,0);const kd=Oe.nwj(hb,!0);if(md(kd,this.Kwc,this.rJe,this.PUa,this.AXg)){var Tb=this.uAa.getItem(hb);
this.uAa.removeItem(hb);if(void 0!==Tb&&null!==Tb)if(kd.a>this.cWa)ya.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",kd.a,this.cWa);else if(hb=Oe.H9c(Tb,!0),void 0!==hb&&null!==hb&&isFinite(hb.length))if(hb.length){Tb=hb[hb.length-1];var zc=(new Date).getTime()-Tb.ts;if(zc<-Oe.Lsj)ya.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Tb.ts);else if(zc>this.C$g*Oe.Lsj)ya.ULS.sendTraceTag(37290079,
222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.C$g,Tb.ts);else{kd.s===this.WAa?this.N1g||(this.N1g=!0,ya.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.M1g||(this.M1g=!0,ya.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",kd.s));za=Array(hb.length);for(Tb=0;Tb<hb.length;Tb++){Q=Tb;a:{zc=hb[Tb];if(void 0===zc||null===zc){zc=null;break a}let ce=null;zc.e&&(ce=new Je.a(null),ce.name=
zc.e.n,ce.stack=zc.e.s,ce.message=zc.e.m,ce.file=zc.e.f,ce.line=zc.e.l,ce.column=zc.e.c);zc=new hc.a(zc.ts,zc.c,zc.t,zc.l,zc.m,zc.lt,zc.o,zc.a,ce)}za[Q]=zc}this.gBa.g8i(this,za,kd.s,kd.v,kd.a+1,kd.i);break}}else ya.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Tb);else ya.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",Tb)}}else this.hJd()}}hQa(Q,za,hb){!this.Xl&&ya.ULS.o9(za,hb)&&this.oWc.Z(Q,!0)}dispose(){if(!this.Xl){this.tS&&
this.Gb.Se(this.tS);var Q=lb.toArray(this.jQa.keys);for(const za of Q)this.HIi(za)}this.Xl=!0}HQa(){this.LVa=!0;this.hJd()}Bkb(){this.LVa=!1;this.hJd();this.tS&&this.Gb.Se(this.tS);this.tS=new Uc.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.Gb.Wb(this.tS)}hJd(){this.tS&&(this.Gb.Se(this.tS),this.tS=null)}static serialize(Q){return JSON.stringify(Q)}static nwj(Q,za){(Q=Oe.H9c(Q,za))&&void 0===Q.d&&(Q=new Gf(Q.t,Q.m,Q.s,Q.v,Q.i,Q.a,0));
return Q}static H9c(Q,za){try{return JSON.parse(Q)}catch(hb){za&&ya.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",hb.message)}return null}}Oe.Lsj=864E5;Object(e.a)(Oe,"OfflineLoggerImplV2",null,[1926,9,183]);class fg{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(Q){return this.handleError("Length",Q),-1}}key(Q){try{return localStorage.key(Q)}catch(za){return this.handleError("Key",
za),null}}getItem(Q){try{return localStorage.getItem(Q)}catch(za){return this.handleError("GetItem",za),null}}setItem(Q,za){try{return localStorage.setItem(Q,za)}catch(hb){return this.handleError("SetItem",hb),null}}removeItem(Q){try{localStorage.removeItem(Q)}catch(za){this.handleError("RemoveItem",za)}}clear(){try{localStorage.clear()}catch(Q){this.handleError("Clear",Q)}}handleError(Q,za){ya.ULS.sendTraceTag(19170128,222,10,"Invoking localStorage function[{0}] failed, message: {1}",Q,za.message)}}
Object(e.a)(fg,"OfflineStorage",null,[1925]);class If{create(Q){var za=null;try{void 0!==localStorage&&null!==localStorage&&(za=new fg)}catch(Tb){ya.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",Tb.message)}Object.getType(ya.ULS.host).implementsInterface(1219)&&za||(ya.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",za?"supported":"not supported",Object.getType(ya.ULS.host).implementsInterface(1219)?"supported":
"not supported"),Q=0);const hb=l.AFrameworkApplication.K;1===Q?za=new xc(l.AFrameworkApplication.oc,l.AFrameworkApplication.Ke,za,ya.ULS.host,l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.SKh,hb.$("OfflineLoggerDataBoundarySupportIsEnabled")):2===Q?(Q=l.AFrameworkApplication.ta.Ob,za=new Oe(l.AFrameworkApplication.oc,l.AFrameworkApplication.Ke,za,ya.ULS.host,l.AFrameworkApplication.userSessionId,Q.jm,Q.bha,hb.pc("OfflineLoggerRetentionInDays",30),hb.pc("OfflineLoggerMaxAttempts",5),
hb.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),hb.$("SendOfflineLogsV2ImprovementIsEnabled"),l.AFrameworkApplication.SKh,hb.$("OfflineLoggerDataBoundarySupportIsEnabled"))):za=new ac;za.init();return za}}Object(e.a)(If,"OfflineLoggerFactory",null,[]);class tf{yc(){}get name(){return"Common.App.OfflineLogger"}init(){const Q=l.AFrameworkApplication.K;let za=0;Q.$("OneNoteOfflineLoggerIsEnabled")?za=1:Q.$("OfflineLoggerV2IsEnabled")&&(za=2);0!==za&&(l.AFrameworkApplication.Ofg=(new If).create(za))}dispose(){}}
Object(e.a)(tf,"OfflineLoggerPackage",null,[1,2]);var vf=c(48),$f=c(1368);class vg{constructor(Q){this.GFi=null;ya.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.UWc=l.AFrameworkApplication.K.kb("PhoneLinkServiceEndpoint");(this.z8=Q)||ya.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.UWc&&this.UWc.length||ya.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}Ysl(Q){Q&&(this.UWc="https://dcg-df.microsoft.com/",
ya.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.Xsl()}Xsl(){ya.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.GFi)ya.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.GFi=new Date;var Q=new Date;this.z8.T4("BayBridge",this.UWc).then(za=>{const hb=+new Date-+Q;za.IsSuccess?(ya.ULS.sendTraceTag(527574723,306,
50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",hb),this.Osl(za.Token,this.cFl())):ya.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",hb,za.ErrorCode,za.ErrorMessage)}).catch(za=>{ya.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",za,+new Date-+Q)})}}Osl(Q,za){const hb={};hb.Authorization=
"Bearer "+Q;hb["Authorization-Type"]="AAD";hb.Accept="application/json";hb["DCG-SessionId"]=l.AFrameworkApplication.userSessionId;l.AFrameworkApplication.Ke.oj(za,1,null,hb,!1,2,Object(a.a)(this,this.z6l,"getStatusSucceeded"),Object(a.a)(this,this.x6l,"getStatusFailed"),null,void 0,void 0,void 0,void 0,"39");vf.a("FetchAccountLinkedStatus")}cHl(){const Q=$f.a.instance.getItem("AccountLinkedStatusCache");return Q&&Q.length?"true"===Q.toLowerCase()?!0:!1:!1}cFl(){return this.UWc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}x6l(){ya.ULS.sendTraceTag(527214156,
306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}z6l(Q){ya.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");Q=Xa.a(Q.data.we).state+"";$f.a.instance.setItem("AccountLinkedStatusCache",Q)}}Object(e.a)(vg,"PhoneLinkManager",null,[1851]);class Kf{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}yc(Q){this.W=Q;this.W.register(1851,"Common.App.PhoneLink.IPhoneLinkManager").singleInstance().Qd(()=>new vg(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){l.AFrameworkApplication.K.Wo(()=>
{this.x1a()})}x1a(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){K.a.instance.Gc(new Kf)}}Object(e.a)(Kf,"PhoneLinkPackage",null,[1,2]);const Ph=Q=>{try{return Xa.a(Q)}catch(za){}return null};class ff{constructor(Q,za,hb,Tb,zc,kd){this.UY=!1;this.yl=null;this.ALe=!1;this.ga=Q;this.Of=za;this.Lk=hb;this.Z0g=Tb;this.Na=zc;this.N3j=kd}init(Q,za){za&&Q.Sa("Common.Interface.IRtcBasicProvider").execute(Object(a.a)(this,this.G0e,"awaitRtc"))}G0e(Q){const za=Q.pNc();za.continueWith(()=>
{this.yl=za.result;this.ALe&&(this.yl.LO(2,null,!0),this.ALe=!1);this.yl.t2((hb,Tb)=>{2===Tb.type&&this.rc.processAction(m.a.fileNameUpdate,2)});this.yl.$sa((hb,Tb)=>{2===Tb.newState&&this.rc.processAction(m.a.fileNameUpdate,2)});2===this.yl.connectionState&&this.rc.processAction(m.a.fileNameUpdate,2)})}MNa(Q){this.UTh(Q,!0)}UTh(Q,za){const hb=this.pHk(Q.enj),Tb={};Tb[ff.NEh]=ff.OEh;this.V7i.oj(hb,2,"",Tb,!1,2,Object(a.a)(this,this.Jdc,"onRefreshFilenameSuccess"),za?Object(a.a)(this,this.Oln,"onRefreshFilenameFailureRetry"):
Object(a.a)(this,this.mQi,"onRefreshFilenameFailureNoRetry"),Q)}Jdc(Q){this.UY=!1;const za=Ph(Q.data.we);Q.data.state.onSuccess(za,this.Z0g.value)}Oln(Q){5!==Q.data.status||this.UY?this.mQi(Q):(this.UY=!0,this.UTh(Q.data.state,!1))}mQi(Q){Q.data.state.onFailure(-1)}OBb(Q){this.VTh(Q,!0)}VTh(Q,za){const hb=this.qHk(),Tb={};Tb[ff.NEh]=ff.OEh;Tb[ff.qhm]=db.a.Mj(Q.b8i);Tb[ff.ohm]=this.N3j.value.tTk;this.V7i.oj(hb,2,"",Tb,!1,2,Object(a.a)(this,this.yZc,"onRenameFileSuccess"),za?Object(a.a)(this,this.Uln,
"onRenameFileFailureRetry"):Object(a.a)(this,this.oQi,"onRenameFileFailureNoRetry"),Q)}qHk(){return this.evh()}pHk(Q){let za=this.evh();return za=rb.a.fp(za,ff.uhm,Q?"2":"1")}evh(){let Q=(this.Na.value.appSettings.RenameWebServiceBase||"")+ff.phm;Q=rb.a.fp(Q,ff.rhm,db.a.Mj(l.AFrameworkApplication.fm));this.qn&&this.qn.JAf&&(Q=rb.a.fp(Q,ff.thm,"1"));return Q}yZc(Q){this.UY=!1;const za=Ph(Q.data.we);Q.data.state.onSuccess(za,this.Z0g.value);this.dLi()}dLi(){this.yl?this.yl.LO(2,null,!0):this.ALe=!0}Uln(Q){5!==
Q.data.status||this.UY?this.oQi(Q):(this.UY=!0,this.VTh(Q.data.state,!1))}oQi(Q){Q.data.state.onFailure(-1)}get rc(){return this.ga.value}get V7i(){return this.Of.value}get qn(){return this.Lk.value}static get instance(){return ff._instance||(ff._instance=ff.CCb())}static CCb(){return new ff(new $b.a(()=>l.AFrameworkApplication.xa),new $b.a(()=>l.AFrameworkApplication.Ke),new $b.a(()=>l.AFrameworkApplication.qn),new $b.a(()=>pa.a.instance.resolve("Postmessage.IHostPostmessenger")),new $b.a(()=>l.AFrameworkApplication.K),
new $b.a(()=>pa.a.instance.resolve("Common.IRenameProps")))}}ff.NEh="Content-Type";ff.OEh="application/json; charset=utf-8";ff.phm="renamehandler.ashx";ff.rhm="qs";ff.qhm="n";ff.thm="sl";ff.ohm="X-CoauthLockId";ff.uhm="u";ff._instance=null;Object(e.a)(ff,"ExecuteRenameFileHandler",null,[]);class yc{constructor(){this.onFailure=this.onSuccess=null;this.enj=!1}}Object(e.a)(yc,"ExecuteRefreshFilenameData",null,[]);class Rd{constructor(){this.onFailure=this.onSuccess=this.b8i=null}}Object(e.a)(Rd,"ExecuteRenameFileData",
null,[]);class de{constructor(){this.W=null;this.kye=ff.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}yc(Q){this.W=Q}init(){l.AFrameworkApplication.K.Wo(Object(a.a)(this,this.zx,"onFullAppSettingsReady"))}zx(){l.AFrameworkApplication.bUc()&&(ff.instance.init(this.W,l.AFrameworkApplication.$2c),l.AFrameworkApplication.OBb=Object(a.a)(this,this.OBb,"executeRenameFile"),l.AFrameworkApplication.MNa=Object(a.a)(this,this.MNa,"executeRefreshFilename"),l.AFrameworkApplication.U4c=Object(a.a)(this,
this.U4c,"sendFileNameAndLocationUpdateNotification"))}OBb(Q,za,hb){const Tb=new Rd;Tb.b8i=Q;Tb.onSuccess=za;Tb.onFailure=hb;this.kye.OBb(Tb)}MNa(Q,za,hb){const Tb=new yc;Tb.onSuccess=Q;Tb.onFailure=za;Tb.enj=hb;this.kye.MNa(Tb)}U4c(){this.kye.dLi()}dispose(){}}Object(e.a)(de,"PackageManager",null,[1,2]);var Sb=c(141);class nc{constructor(Q,za,hb){this.mbg=this.nbg=this.obg=!1;this.Dbg=!Q&&!za;this.Ebg=!Q&&!hb;this.Dbg||this.Ebg||(this.obg=!Q,this.nbg=!za,this.mbg=!hb)}}Object(e.a)(nc,"RenameDisabledDialogInfo",
null,[]);class Tc extends Sb.StandardDialog{constructor(Q,za,hb,Tb,zc){super();this.wfg=[];this.Cda=new nc(Q,za,hb);this.wcb=Tb;this.V$a=zc;this.sg="RenameDisabledDialog";this.zd=0;this.Ge(1,CommonUIStrings.l_DialogClose);this.Mgo();this.JWn()}Mgo(){this.Cda.Dbg?this.X6c(this.wcb?this.V$a?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.Cda.Ebg?this.X6c(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):
this.kmk();this.pCc(this.wfg)}X6c(Q){Array.add(this.wfg,Q)}kmk(){const Q=[];this.Cda.obg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.Cda.nbg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.Cda.mbg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Q.length&&Array.add(this.wfg,Q)}}Object(e.a)(Tc,"ReactRenameDisabledDialogBase",Sb.StandardDialog,[]);class td extends Tc{constructor(Q,za,hb,Tb,zc){super(Q,za,hb,Tb,zc)}JWn(){this.pkb(CommonUIStrings.l_RenameFileRenameDisabledTitle,
null,null,null,null,null)}}Object(e.a)(td,"ReactRenameDisabledDialog",Tc,[]);class je{static get Wg(){return k.a.Xz(je.Hm,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}je.Hm="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(e.a)(je,"RenameDisabledDialogHtml",null,[]);class se extends k.a{constructor(Q,za,hb,Tb,zc){super();this.Cda=new nc(Q,za,hb);this.wcb=Tb;this.V$a=zc;this.sg="RenameDisabledDialog";this.zd=0;this.Ge(1,CommonUIStrings.l_DialogClose);this.Wg=je.Wg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.s4("RenameRow")}E8(){if(this.Cda.Dbg){let Q;Q=this.wcb?this.V$a?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;se.X6c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Q)}else this.Cda.Ebg?se.X6c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Hkm()}Hkm(){this.Cda.obg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.Cda.nbg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.Cda.mbg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static X6c(Q,za,hb){Q.style.display="none";za.innerText=hb}}Object(e.a)(se,"RenameDisabledDialog",k.a,[]);class Ze{constructor(Q,za){this.oub=0;this.ga=Q;this.yJa=za}initialize(Q){if(!this.ga||!this.yJa)return!1;this.oub=Q;this.Ub();return!0}Ub(){this.ga.pa(m.a.E6e,y.a.frame,Object(a.a)(this,this.E6e,"commitNewDocumentTitle"))}E6e(Q,za,hb,Tb,zc){if(1===hb)return this.ga.processAction(m.a.renameFile,
1);Q=db.a.KI(this.yJa.Oy);zc=(0,zc.getNewDocumentTitle)();zc.length>this.oub&&(zc=zc.substr(0,this.oub));if(32!==this.ga.Rb(m.a.renameFile,2,zc))return this.ulc(Q),8;this.ulc(zc);return 32}ulc(Q){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Q))}static Sl(){return new Ze(l.AFrameworkApplication.xa,l.AFrameworkApplication.Mt)}}Object(e.a)(Ze,"ReactRenameUIHandler",null,[1927]);var Xe=c(227),ye=c(1055),Ei=c(473),Db=c(86),Vb=c(148),Sc=c(23);class bd{constructor(Q,za,hb,Tb,zc,kd,ce,df,
bf,Vf,rh,ij){this._initialized=!1;this._element=null;this.oub=0;this.nPe=this.GBe=!1;this.ga=Q;this.dja=za;this.$d=hb;this.Nr=Tb;this.yJa=zc;this.Fah=kd;this.zsd=ce;this.ute=df;this.p$a=bf;this.YYg=Vf;this.ui=rh;this.kDe=ij}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Q,za,hb){if(!(this.ga&&this.yJa&&this.Fah&&this.zsd&&this.ute&&za)||0>=Q)return!1;this._element=za;this._element.title=hb;this._element.setAttribute(Sc.a.oh,Sc.a.z2);this._element.setAttribute("Unselectable",
"on");this.oub=Q;this.bF();return this._initialized=!0}bF(){this.dja&&(this.dja.mb(W.a.blur,this._element,Object(a.a)(this,this.onBlur,"onBlur")),this.dja.mb(W.a.paste,this._element,Object(a.a)(this,this.pZc,"onPaste")));this.$d.mb(W.a.fi,this._element,Object(a.a)(this,this.onKeyDown,"onKeyDown"));this.Nr.mb(W.a.pointerDown,this._element,Object(a.a)(this,this.zC,"onPointerDown"));this.Nr.mb(W.a.AM,this._element,Object(a.a)(this,this.Uwa,"onPointerUp"))}onBlur(){this.isActive&&!this.GBe&&(this.YYg||
this.ute(this._element),this.VCh(),this.Jaf(!1));return this.GBe=!1}pZc(){ya.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Q){return this.isActive?this.mjn(Q):this.njn(Q)}mjn(Q){let za=!1;switch(Q.Ib.keyCode){case Sys.UI.Key.enter:this.VCh();this.Jaf(this.ui||this.kDe);za=!0;break;case Sys.UI.Key.tab:this.YYg&&this.ute(this._element);break;case Sys.UI.Key.esc:this.E4f(),this.Jaf(this.ui||this.kDe),za=!0}return za}njn(Q){let za=!1;switch(Q.Ib.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.svj(this.kDe),
this.isActive&&this.zsd(this._element),za=!0}return za}zC(){this.isActive||(this.svj(!1),this.isActive&&(this._element.focus(),this.zsd(this._element),this.nPe=!0));return!1}Uwa(){return this.nPe?(this.zsd(this._element),this.nPe=!1,!0):!1}iac(){return 32===this.ga.processAction(m.a.renameFile,1)}VCh(){const Q=db.a.KI(this.yJa.Oy);let za=this._element.innerText.trim();za.length>this.oub&&(za=za.substr(0,this.oub));za!==Q&&""!==za?32!==this.ga.Rb(m.a.renameFile,2,za)?this.E4f():this.ulc(za):this.E4f()}E4f(){this.ulc(db.a.KI(this.yJa.Oy))}ulc(Q){this._initialized&&
(this._element.innerText=Q,this.Fah())}svj(Q){this.iac()?this.isActive||(Q&&(this.GBe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Sc.a.oh,Sc.a.zrh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Xe.CuiHelper.EQh),this.p$a&&this.p$a.execute(za=>{za.Z_i(!0)}),Q&&this._element.focus(),ya.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(m.a.Lic,
2)}Jaf(Q){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Sc.a.oh,Sc.a.z2);Sys.UI.DomElement.removeCssClass(this._element,Xe.CuiHelper.EQh);this.p$a&&this.p$a.execute(za=>{za.Z_i(!1)});Q&&(this._element.blur(),this._element.focus())}static Qxa(){ye.a.Qxa(l.AFrameworkApplication.isRtl)}static Sl(){return new bd(l.AFrameworkApplication.xa,Ei.a.instance,Db.KeyInputManager.instance,Vb.a.instance,l.AFrameworkApplication.Mt,bd.Qxa,
ca.a.Q5n,ca.a.NAh,pa.a.instance.Sa("Common.App.Header.HeaderEventSource"),Ta.a.B3,Ta.a.si,Ta.a.jj)}}Object(e.a)(bd,"RenameUIHandler",null,[1927]);class Ud{static get instance(){return l.AFrameworkApplication.ta.Ob.ZI?Ud._instance||(Ud._instance=Ze.Sl()):Ud._instance||(Ud._instance=bd.Sl())}}Ud._instance=null;Object(e.a)(Ud,"RenameUIHandlerFactory",null,[]);var sf=c(114);class eg{constructor(){this.TNf=this.N$m=this.L9k=null}}Object(e.a)(eg,"RenameMruEntryProperties",null,[]);var Ug=c(159),Lh=c(87),
ah=c(1540),dh;(function(Q){Q[Q.unknown=-1]="unknown";Q[Q.success=0]="success";Q[Q.renameInvalidFileName=1]="renameInvalidFileName";Q[Q.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Q[Q.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Q[Q.permissionDenied=4]="permissionDenied";Q[Q.serverCommunicationFailure=5]="serverCommunicationFailure";Q[Q.fileNameTooLong=6]="fileNameTooLong"})(dh||(dh={}));Object(e.b)("CommonOperationResult",dh);class Hf{constructor(Q,za,hb,Tb,zc,kd,
ce,df,bf,Vf,rh,ij){this.qZg=Q;this.ga=za;this.Lk=hb;this.qL=Tb;this.Vtb=zc;this.chk=kd;this.wcb=ce;this.Dgh=df;this.S$j=bf;this.V$a=Vf;this.Na=rh;this.R$j=ij}Ub(){l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob.ZI||this.rc.pa(m.a.d9b,y.a.frame,Object(a.a)(this,this.d9b,"initializeRenameUIHandler"));this.rc.pa(m.a.Lic,y.a.frame,Object(a.a)(this,this.Lic,"showRenameDisabledDialog"));this.rc.pa(m.a.renameFile,y.a.frame,Object(a.a)(this,this.renameFile,"renameFile"));this.rc.gb(m.a.fileNameUpdate,
y.a.frame,Object(a.a)(this,this.SMn,"refreshFilename"),64);this.rc.gb(m.a.d3d,y.a.frame,Object(a.a)(this,this.d3d,"moveToFolderCompleteByHost"),64);this.rc.pa(m.a.KIb,y.a.frame,Object(a.a)(this,this.KIb,"moveToFolder"));(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||l.AFrameworkApplication.ta&&(l.AFrameworkApplication.K.$("PostMessageEmbedded")||l.AFrameworkApplication.K.$("IsJsApi"))&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&l.AFrameworkApplication.lO().execute(Q=>{Q.pv(Lh.a.cJi);Q.uB(Lh.a.cJi,Hf.kJn);Q.pv(Lh.a.shf);Q.uB(Lh.a.shf,Hf.iJn)})}iac(){return 0===this.R$j.bbi()?32:8}FTo(){return this.qn?this.wcb?this.qn.JPh:this.qn.lgb:!0}d9b(){return Ud.instance.initialize(l.AFrameworkApplication.wKd,l.AFrameworkApplication.BPh,l.AFrameworkApplication.k6i||CommonUIStrings.l_RenameFileTooltip)?32:8}Lic(){const Q=this.FTo(),za=this.chk();ya.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.Vtb,za,Q,this.wcb);l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob.VE&&l.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new td(this.Vtb,!za,!Q,this.wcb,this.V$a()):new se(this.Vtb,!za,!Q,this.wcb,this.V$a());return 32}renameFile(Q,za,hb,Tb,zc){if(1===hb)return this.iac();if(!l.AFrameworkApplication.OBb)return 8;if(8===this.iac())return this.rc.processAction(m.a.Lic,2),8;ya.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");l.AFrameworkApplication.OBb(zc,Object(a.a)(this,
this.yZc,"onRenameFileSuccess"),Object(a.a)(this,this.Tln,"onRenameFileFailure"));l.AFrameworkApplication.j6i=!0;return 32}yZc(Q,za){Q?0!==Q.OperationResult?this.ghi(Q.OperationResult):(this.G7n(za,Q.NewName),this.DLo(Q,Object(a.a)(l.AFrameworkApplication.ta.Ob,l.AFrameworkApplication.ta.Ob.Zzj,"updateOpenInClientDocumentUrl")),l.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&l.AFrameworkApplication.ta.updateCommandUI(),this.S$j.Oxj()):this.ghi(5)}G7n(Q,za){const hb={};hb[Ug.a.ztl]=
za;Q.sendMessage(Lh.a.shf,hb)}DLo(Q,za){this.RLo(Q);l.AFrameworkApplication.rHd=Q.DirectInvokeDavUrl;za=za(Q.EditDocInClientUrl);const hb=new eg;hb.TNf=this.qL.Oy;hb.L9k=za;hb.N$m=Q.EditDocInClientUrl;this.rc.Rb(m.a.l6i,2,hb)}ghi(Q){switch(Q){case 1:Q=new Sb.StandardDialog,Q.zd=0,Q.PU(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.T8i()}}RLo(Q){this.qL.Oy=Hf.qwk(this.qL.Oy,Q.NewName);Q.BreadcrumbFolderName&&(this.qL.breadcrumbFolderName=Q.BreadcrumbFolderName);
Q.BreadcrumbFolderUrl&&(this.qL.breadcrumbFolderUrl=Q.BreadcrumbFolderUrl);this.Dgh(Q.NewName)}Tln(Q){const za=new Sb.StandardDialog;za.zd=0;switch(Q){case 1:ya.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");za.nia(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:ya.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");za.nia(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:ya.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:Q}),za.nia(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}l.AFrameworkApplication.lO().execute(hb=>{hb.sendMessage(Lh.a.ytl,{["FailureMessage"]:dh[Q]})});this.T8i()}SMn(Q,za,hb){if(1===hb)return this.iac();if(!l.AFrameworkApplication.MNa)return 8;l.AFrameworkApplication.MNa(Object(a.a)(this,this.Jdc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.b6d,"onRefreshFilenameFailure"),
!1);return 32}KIb(Q,za,hb,Tb,zc){if(1===hb)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===hb){const kd={};Q=l.AFrameworkApplication.eHb;za=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");Q=(!Q||Q&&za)&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);kd[Ug.a.rxo]=Q;zc&&zc.MoveButtonClickedTime&&(kd[Ug.a.d9m]=zc.MoveButtonClickedTime.getTime());l.AFrameworkApplication.lO().execute(ce=>{ce.sendMessage(Lh.a.KIb,
kd)});if(zc&&zc.MoveButtonClickedTime){if(Q=sf.a.KF())zc=(new Date).getTime()-zc.MoveButtonClickedTime.getTime(),Q.set("MovePostDuration",zc.toString());Oa.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Q)}return 32}return 8}d3d(Q,za,hb,Tb,zc){if(1===hb)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.iac():8;if(2===hb){if(!l.AFrameworkApplication.U4c)return Oa.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!zc)return Oa.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(zc[Ug.a.jAm])if(zc[Ug.a.GBj])if(Q=zc[Ug.a.GBj].toLowerCase(),za=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),hb=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),za&&l.AFrameworkApplication.eHb&&hb){const kd={};kd[Ug.a.Pfc]="1";kd[Ug.a.documentUrl]=Q;kd[Ug.a.reason]=ah.a.S5f;Oa.Health.instance.recordKpiSuccess("MoveToFolder",null);
l.AFrameworkApplication.lO().execute(ce=>{ce.sendMessage(Lh.a.kBb,kd)})}else if(!l.AFrameworkApplication.eHb&&hb)Oa.Health.instance.recordKpiSuccess("MoveToFolder",null),ca.a.km(Q,ca.a.zqa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Oa.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Oa.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else l.AFrameworkApplication.MNa(Object(a.a)(this,this.Jdc,"onRefreshFilenameSuccess"),
Object(a.a)(this,this.b6d,"onRefreshFilenameFailure"),!1),l.AFrameworkApplication.U4c(),Oa.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}ino(Q,za){return Q&&za?Q!==this.qL.breadcrumbFolderName||za!==this.qL.breadcrumbFolderUrl:!1}Jdc(Q,za){Q&&(Q.NewName!==db.a.KI(this.qL.Oy)||this.ino(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl))&&this.yZc(Q,za)}b6d(){}T8i(){this.Dgh(db.a.KI(this.qL.Oy))}get rc(){return this.ga.value}get qn(){return this.Lk.value}static get instance(){return Hf._instance||
(Hf._instance=Hf.CCb())}static CCb(){return new Hf(l.AFrameworkApplication.bUc,new $b.a(()=>l.AFrameworkApplication.xa),new $b.a(()=>l.AFrameworkApplication.qn),l.AFrameworkApplication.Mt,l.AFrameworkApplication.ioa,()=>l.AFrameworkApplication.ukg,l.AFrameworkApplication.$2c,Object(a.a)(Ud.instance,Ud.instance.ulc,"updateTitle"),pa.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>l.AFrameworkApplication.Yu,l.AFrameworkApplication.K,pa.a.instance.resolve("Common.IRenameProps"))}static qwk(Q,
za){Q=db.a.Qfa(Q);return za+Q}static kJn(Q){const za=Q.Values[Ug.a.RFm];ya.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",za);za?l.AFrameworkApplication.xa.Rb(m.a.d3d,2,Q.Values):Oa.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static iJn(Q){l.AFrameworkApplication.xa.Rb(m.a.renameFile,2,Q.Values.NewName)}}Hf._instance=null;Object(e.a)(Hf,"RenameActor",null,[]);var Mf=c(133),Md=c(1374),Sd=c(581),Pd=c(398);class Fk{constructor(Q,
za){this.ga=Q;this.uqc=za}Ub(){this.ga.pa(m.a.ybg,y.a.frame,Object(a.a)(this,this.$po,"showRenameDialogAction"))}$po(Q,za,hb){Q=32;if(1===hb)return Pd.SessionStatusManager.instance.xj||l.AFrameworkApplication.Jna?8:32;2===hb&&(32!==this.ga.processAction(m.a.renameFile,1)?(this.ga.processAction(m.a.Lic,2),Mf.a.instance.Zb(Md.a.oma,{["Reason"]:Sd.a.WVn}),Q=8):32===this.ga.processAction(m.a.Mic,1)?this.ga.processAction(m.a.Mic,2):this.uqc.value.create().FSa());return Q}}Object(e.a)(Fk,"RenameDialogActor",
null,[1922]);class Vg{constructor(Q,za,hb){this.dialog=null;this.ga=Q;this.qL=za;this.Y9a=hb}P2l(){const Q={};Q.nameInputProps={["type"]:"AppInputProps",["id"]:Vg.Y3b,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:db.a.KI(this.qL.Oy),["maxLength"]:this.Y9a};return Q}FSa(){const Q={["id"]:"RenameDialog",["bodyControls"]:this.P2l()};this.dialog=new k.a(!1,!1,!0);this.dialog.zd=1;this.dialog.sg="RenameDialog";this.dialog.Yh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.Y2f,"renameDialogHandler"),
Q)}Y2f(Q,za){if(za&&1===Q){if(za[Vg.Y3b]&&(Q=db.a.KI(this.qL.Oy),za=(za[Vg.Y3b]||"").trim(),za!==Q&&""!==za)){this.ga.Rb(m.a.renameFile,2,za);return}Mf.a.instance.Zb(Md.a.V3b,{["Reason"]:Sd.a.yVh})}}}Vg.Y3b="txtDocumentName";Object(e.a)(Vg,"ReactRenameDialog",null,[1932]);class Lf{static get Wg(){return k.a.Xz(Lf.Hm,CommonUIStrings.l_RenameDialogLabel)}}Lf.Hm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(e.a)(Lf,"RenameDialogHtml",null,[]);class kg extends k.a{constructor(Q,za,hb){super();this.ga=Q;this.qL=za;this.Y9a=hb;this.sg="RenameDialog";this.Wg=Lf.Wg}FSa(){var Q={["txtDocumentName"]:db.a.KI(this.qL.Oy)};this.Yh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.Y2f,"renameDialogHandler"),Q);Q=document.getElementById(kg.Y3b);0<this.Y9a&&(Q.maxLength=this.Y9a);Q.focus()}Y2f(Q,za){if(1===Q&&(Q=db.a.KI(this.qL.Oy),za=(za[kg.Y3b]||"").trim(),za!==Q&&""!==za)){this.ga.Rb(m.a.renameFile,
2,za);return}Mf.a.instance.Zb(Md.a.V3b,{["Reason"]:Sd.a.yVh})}}kg.Y3b="txtDocumentName";Object(e.a)(kg,"RenameDialog",k.a,[1932]);class Og{constructor(Q){this.yJa=null;this.Y9a=0;this.ga=Q;this._initialized=!1}initialize(Q,za){this.yJa=Q;this.Y9a=za;this._initialized=!0}create(){return this._initialized?l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob.VE&&l.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new Vg(this.ga,this.yJa,this.Y9a):new kg(this.ga,this.yJa,this.Y9a):null}}Object(e.a)(Og,
"RenameDialogFactory",null,[1923]);var kh=c(155),ai=c(83);class Bn{constructor(Q,za){this.ga=Q;this.Vb=za}Ub(){this.ga.pa(m.a.Mic,y.a.frame,Object(a.a)(this,this.aqo,"showRenameFlyoutAction"))}OLk(){return F.d("setDocumentTitleFlyoutOpened")&&l.AFrameworkApplication.ta.Ob.ZI}aqo(Q,za,hb){if(1===hb)return this.OLk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}bok(){Bn.dKm&&l.AFrameworkApplication.GQ&&ai.a.instance.Wb(new Uc.a(5,1,5E3,()=>{32===this.ga.processAction(m.a.Mic,
1)&&this.Vb&&this.Vb.currentScope.name===kh.AFrame.$n&&(vf.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.processAction(m.a.Mic,2))}))}static get dKm(){Bn.vld&&null!=Bn.vld||(l.AFrameworkApplication.ye("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Bn.vld=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Bn.vld}}Bn.vld=null;Object(e.a)(Bn,"RenameFlyoutActor",
null,[1913]);class yh{constructor(Q,za,hb,Tb,zc){this.tTk=null;this.Lk=zc;this.rZg=hb;this.qZg=Tb;this.ehk=Q;this.V$a=za}get qn(){return this.Lk.value}bbi(){if(!this.qZg())return 5;if(this.V$a())return 1;if(this.qn){if(this.rZg&&!this.qn.JPh)return 3;if(!this.rZg&&!this.qn.lgb)return 4}return this.ehk()?0:2}}Object(e.a)(yh,"RenameProps",null,[1911]);class bi{constructor(Q,za,hb,Tb,zc,kd){this.xs=!1;this.hGe=new Zb.a;this.bTb=za;this.vz=hb;this.$Rb=Tb;this.Na=zc;this.Bka=kd}enable(){this.xs||(this.Oxj(),
this.Zcg(),this.xs=!0)}generateKey(Q,za,hb){return String.format("{0}/{1}/{2}",hb,Q,za)}FTl(){const Q=db.a.KI(this.bTb().Oy);return this.generateKey(this.bTb().breadcrumbFolderName,this.bTb().breadcrumbFolderUrl,Q)}GTl(Q,za,hb){return Q&&za?this.generateKey(Q,za,hb):hb}Ffl(Q,za,hb){return Q&&Q!==this.bTb().breadcrumbFolderName||za&&za!==this.bTb().breadcrumbFolderUrl?!0:hb!==db.a.KI(this.bTb().Oy)}Oxj(){const Q=this.FTl();this.hGe.Z(Q,new Date)}hWf(Q){this.tlo(Q)&&this.Vih(Q)}tlo(Q){const za=this.$Rb();
return za?this.Bka&&this.Bka.eo||!za.JAf||!l.AFrameworkApplication.MNa?(this.wpj(Q),this.xs=!1):!0:!1}nRi(Q,za,hb,Tb){const zc=this.Ffl(Q,za,hb);Q=this.GTl(Q,za,hb);za=this.hGe.Ec(Q).returnValue;zc&&!za&&(this.ihi(Tb),ya.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.hIf));zc||this.hGe.Z(Q,this.vz())}}Object(e.a)(bi,"ARenamedFileChecker",null,[1885]);class qi extends bi{constructor(Q,za,hb,Tb,zc,kd,ce,df){super(Q,za,hb,Tb,zc,kd);this.bK=zc;this.Q$j=ce;this.iBe=df}get hIf(){return"RenamedFileCheckerUsingSettingsRefresh"}Zcg(){this.bK.JCc(Object(a.a)(this,
this.Ehi,"handleSettingsRefresh"))}Ehi(Q,za){za&&za.TIb&&za.bMi&&(za.NPa("BreadcrumbDocName")||za.NPa("BreadcrumbFolderName")||za.NPa("BreadcrumbFolderUrl")||za.NPa("DirectInvokeDAVUrl")||za.NPa("EditDocInClientUrl"))&&(ya.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.hIf),this.hWf(za))}wpj(){this.bK.P2f(Object(a.a)(this,this.Ehi,"handleSettingsRefresh"))}Vih(Q){if(Q&&Q.TIb){const za=Q.TIb;this.nRi(za.kb("BreadcrumbFolderName"),za.kb("BreadcrumbFolderUrl"),za.kb("BreadcrumbDocName"),
Q)}}ihi(Q){const za={OperationResult:0,classId:1};Q=Q.TIb;za.BreadcrumbFolderName=Q.kb("BreadcrumbFolderName");za.BreadcrumbFolderUrl=Q.kb("BreadcrumbFolderUrl");za.DirectInvokeDavUrl=Q.kb("DirectInvokeDAVUrl");za.EditDocInClientUrl=Q.kb("EditDocInClientUrl");Q=Q.kb("BreadcrumbDocName");za.NewName=l.AFrameworkApplication.OHd?Q:db.a.KI(Q);this.iBe.execute(hb=>{this.Hwm(za,hb)})}Hwm(Q,za){this.Q$j().yZc(Q,za)}}Object(e.a)(qi,"RenamedFileCheckerUsingSettingsRefresh",bi,[]);class ql extends bi{constructor(Q,
za,hb,Tb,zc,kd,ce,df,bf,Vf){super(Q,hb,Tb,zc,kd,bf);this.Fyc=this.el=null;this.i9j=za;this.ga=ce;this.Gb=df;Vf&&Vf.execute(rh=>{this.hRn(rh)})}get hIf(){return"RenamedFileCheckerUsingTask"}hRn(Q){this.el=Q;this.el.uMa(Object(a.a)(this,this.oX,"handleVisibilityChange"))}oX(Q,za){!this.xs||0!==za.newState&&1!==za.newState||this.Fyc||(this.Zcg(),this.hWf(this.Fyc))}Zcg(){this.Fyc=new Uc.a(3,2,this.i9j(),Object(a.a)(this,this.hWf,"performRenameFileCheckTick"),89);this.Gb.Wb(this.Fyc)}wpj(Q){this.Gb.Se(Q)}Vih(Q){this.el&&
2===this.el.VA?this.WSn(Q):l.AFrameworkApplication.MNa(Object(a.a)(this,this.Jdc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.b6d,"onRefreshFilenameFailure"),!0)}WSn(Q){this.Gb.Se(Q);this.Fyc=null}Jdc(Q){Q&&this.nRi(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl,Q.NewName,null)}ihi(){this.ga.processAction(m.a.fileNameUpdate,2)}b6d(){}}Object(e.a)(ql,"RenamedFileCheckerUsingTask",bi,[]);var ci=c(57);class Zk{constructor(){this.Na=this.W=null}get name(){return"Common.App.RenameFile"}yc(Q){this.W=
Q;this.Na=l.AFrameworkApplication.K;this.W.register(Fk,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Qd(()=>new Fk(l.AFrameworkApplication.xa,this.W.We("Common.App.Rename.IRenameDialogFactory"))).singleInstance();this.W.register(Og,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Qd(()=>new Og(l.AFrameworkApplication.xa)).singleInstance();this.W.register(1885,"Common.App.Rename.IRenamedFileChecker").Qd(()=>this.P6k()).singleInstance();
this.W.register(Bn,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Qd(()=>new Bn(l.AFrameworkApplication.xa,ci.FocusManager.instance())).singleInstance()}P6k(){if(this.Na.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Q=this.W.Ma("Common.IRefreshableAppSettings");if(Q&&Q.ywi)return new qi(()=>Q.pc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>l.AFrameworkApplication.Mt,()=>new Date,()=>l.AFrameworkApplication.qn,Q,this.W.Ma("Common.ISessionStatus"),()=>
Hf.instance,this.W.Sa("Postmessage.IHostPostmessenger"))}return new ql(()=>this.Na.pc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Na.pc("RenamedFileCheckerPingIntervalInMs",12E4),()=>l.AFrameworkApplication.Mt,()=>new Date,()=>l.AFrameworkApplication.qn,l.AFrameworkApplication.K,l.AFrameworkApplication.xa,l.AFrameworkApplication.oc,this.W.Ma("Common.ISessionStatus"),this.W.Sa("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Na.Wo(Object(a.a)(this,this.zx,"onFullAppSettingsReady"))}zx(){const Q=
l.AFrameworkApplication.ta.Ob.ZI;l.AFrameworkApplication.bUc()&&Ud.instance.initialize(l.AFrameworkApplication.wKd,Q?null:l.AFrameworkApplication.BPh,Q?null:l.AFrameworkApplication.k6i||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(yh,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Qd(()=>new yh(()=>l.AFrameworkApplication.ukg,()=>l.AFrameworkApplication.Yu,l.AFrameworkApplication.$2c,l.AFrameworkApplication.bUc,new $b.a(()=>l.AFrameworkApplication.qn))).singleInstance(),Hf.instance.Ub(),
this.Na.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(l.AFrameworkApplication.Mt,l.AFrameworkApplication.wKd),this.W.resolve("Common.App.Rename.IRenameDialogActor").Ub()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Ub(),l.AFrameworkApplication.$2c&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").bok())}dispose(){}}Object(e.a)(Zk,"PackageManager",null,[1,2]);class Wg{static get Wg(){return k.a.Xz(Wg.Hm,
CommonUIStrings.l_SaveACopyFileName)}}Wg.Hm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(e.a)(Wg,"FileNameDialogHtml",null,[]);class Qh extends k.a{constructor(Q,za,hb,Tb){super();this.Jhd=this.VJa=null;
this.ga=Q;this.Jqa=za;this.wBc=hb;this.Ge(1,CommonUIStrings.l_SaveButtonLabel);this.Wg=Wg.Wg;this.sg="FileNameDialog-SaveACopy";this.Sm=Tb}dDa(Q,za,hb){this.Jhd=Q;this.VJa=hb;Q={["txtFileName"]:db.a.KI(l.AFrameworkApplication.Mt.Oy),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,za)};this.Yh(CommonUIStrings.l_SaveToOneDrive,Object(a.a)(this,this.uKd,"fileNameDialogHandler"),Q);ya.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}uKd(Q,
za){1!==Q?ya.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(Q=za.txtFileName.trim(),ya.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),za=db.a.Qfa(l.AFrameworkApplication.fileName),Q&&""!==Q&&""!==za&&(Q+=za),this.wBc.wHa(this.Jhd,this.VJa,Q,this.Sm))}}Object(e.a)(Qh,"FileNameDialog",k.a,[1916]);class Fm{constructor(Q,za,hb){this.ga=Q;this.Jqa=za;this.wBc=hb}create(Q){return new Qh(this.ga,this.Jqa,this.wBc,Q)}}Object(e.a)(Fm,
"FileNameDialogFactory",null,[1896]);class Pg extends Sb.StandardDialog{constructor(Q){super();this.zd=1;this.Ge(1,CommonUIStrings.l_RetryButtonLabel);this.Ge(0,CommonUIStrings.l_DialogClose);this.ga=Q}kT(Q){ya.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",Q);this.Sw(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(a.a)(this,this.S4f,"retryDialogHandler"))}S4f(Q){1===Q?(ya.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.processAction(m.a.Sgc,
2)):ya.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(e.a)(Pg,"RetryDialog",Sb.StandardDialog,[1895]);var Xh=c(230);class fi{constructor(Q,za,hb,Tb){this.Jrd=null;this.gbk=Q;this.Na=hb;this.e6g=za;this.r1g=new z.a;this.ge=Tb}Gac(){return this.Na.$("SaveToCloudStorageUIIsEnabled")}igb(){return m.a.a6f}gBd(){dc.a.i2c(Object(a.a)(this,this.xaj,"saveToCloudActionDispatcher"));dc.a.EJc([new Xh.a(m.a.a6f,y.a.frame,0)],this.e6g.U6b())}Ub(){const Q=this.e6g.U6b();Q?(Q.tZ(()=>{this.r1g.xg(!0)}),
this.gBd()):ya.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}s1i(){ya.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}xaj(Q,za,hb,Tb,zc){return za.contextId!==y.a.frame||Q!==this.igb()?2:this.Gac()?1===hb?Pd.SessionStatusManager.instance.xj||l.AFrameworkApplication.Jna?8:32:2===hb?(this.s1i(),zc&&zc.FileDownloadUrl&&ya.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.ge&&
(this.Jrd=this.ge.eg("DialogShown","SaveToOneDriveReponseTime")),this.r1g.task.continueWith(()=>{this.Jrd&&(this.Jrd.stop(),this.Jrd=null);this.gbk.start(zc)}),32):8:8}}Object(e.a)(fi,"SaveToCloudStorageActor",null,[1891]);class kl extends fi{constructor(Q,za,hb,Tb){super(Q,za,hb,Tb);this.K7j=za}Gac(){return this.Na.$("SaveACopyBrsIsEnabled")}igb(){return m.a.Sgc}gBd(){dc.a.i2c(Object(a.a)(this,this.xaj,"saveToCloudActionDispatcher"));dc.a.EJc([new Xh.a(m.a.Sgc,y.a.frame,0)],this.K7j.U6b())}s1i(){l.AFrameworkApplication.ye("CreateCopy_cf;CreateCopy_tf");
ya.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(e.a)(kl,"SaveACopyActor",fi,[]);class $k{}$k.default=0;Object(e.a)($k,"SaveToCloudErrorCodes",null,[]);class dj{constructor(Q,za,hb,Tb,zc,kd){this.Sm=null;this.$ck=Q;this.vsa=za;this.wBc=hb;this.Na=Tb;this.lRb=zc;this.LG=kd}start(Q){this.Sm=Q;if("SharePointOnlineConsumer"===this.Na.kb("FileSource")){const za=pa.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(za){za.start(null,
Q);return}}this.vsa.WRc?(ya.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.LKk()):(ya.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.kqo())}kqo(){this.$ck.create().dDa()}Lp(){this.LG().kT($k.default)}LKk(){try{ya.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let Q={["client_id"]:this.Na.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.lRb||2===this.lRb)Q={["client_id"]:this.Na.appSettings.UploadToSkyDriveClientId};
WL.init(Q);ya.ULS.sendTraceTag(6590562,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob&&1===l.AFrameworkApplication.ta.Ob.jm?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"))}catch(Q){ya.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Q,Q.stack),this.Lp()}}onSuccess(Q){ya.ULS.sendTraceTag(6590592,
216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");Q&&Q.data&&Q.data.folders&&this.wBc.wHa(Q.data.folders[0].id,Q.data.folders[0].urls.viewInBrowser,null,this.Sm)}onFailure(Q){if(Q&&Q.error){if("user_canceled"===Q.error.code){ya.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}ya.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",Q.error.code,Q.error.message)}else ya.ULS.sendTraceTag(6590595,
216,50,"File Dialog returned with no response");this.Lp()}}Object(e.a)(dj,"SaveToCloudManager",null,[1893]);class Mm extends dj{constructor(Q,za,hb,Tb,zc,kd,ce){super(za,hb,Tb,zc,kd,ce);this.YWj=Q}onSuccess(Q){Q&&Q.data&&Q.data.folders?(ya.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.YWj.create(this.Sm).dDa(Q.data.folders[0].id,Q.data.folders[0].name,Q.data.folders[0].urls.viewInBrowser)):(ya.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),
this.Lp())}onFailure(Q){Q&&Q.error&&"user_canceled"===Q.error.code&&ya.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(Q)}Lp(){ya.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.Lp()}}Object(e.a)(Mm,"SaveACopyManager",dj,[]);var Qi=c(187);class Rg{constructor(Q,za,hb,Tb,zc){this.VJa=this.xk=this.uoc=null;this.UY=!1;this.Sm=this.TXa=null;this.yUe=Q;this.KWa=za;this.LG=hb;this.Ri=Tb;this.ge=zc}d6a(){this.Ri&&1===
this.Ri.state||(this.xk=this.KWa(),this.xk.message=CommonUIStrings.l_CommentProgressTooltip,this.xk.zd=5,this.xk.ht=!1,this.xk.YK(CommonUIStrings.l_DefaultDialogTitle,null,null))}Yla(){this.xk&&(this.xk.close(),this.xk=null)}B4(){1!==l.AFrameworkApplication.ta.state&&this.LG().kT($k.default)}BLb(){ya.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");ca.a.km(this.VJa,ca.a.zqa(3),void 0,"UploadToCloudManager.RedirectToFolder")}ALb(Q){let za=!1,hb=!1;l.AFrameworkApplication.K&&(za=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),
hb=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ya.ULS.sendTraceTag(6654163,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob&&1===l.AFrameworkApplication.ta.Ob.jm?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,za);if(za&&hb){ya.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Tb={};Tb[Ug.a.Pfc]="1";Tb[Ug.a.documentUrl]=Q;l.AFrameworkApplication.lO().execute(zc=>{zc.sendMessage(Lh.a.kBb,
Tb)})}else ca.a.km(Q,ca.a.zqa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}wHa(Q,za,hb=null,Tb=null){ya.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.ge&&(this.TXa=this.ge.eg("DialogShown","SaveToOneDriveUploadTime"));this.d6a();this.VJa=za;this.uoc=this.yUe.create(Q,hb,Tb);this.Sm=Tb;this.yfa()}yfa(){ya.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.uoc.execute(Object(a.a)(this,this.Imn,"onSaveToCloudUploadFinished"),Object(a.a)(this,this.Hmn,"onSaveToCloudUploadFailed"))}Imn(Q){this.Yla();
this.UY=!1;if(Q&&Q.data&&Q.data.we){var za;if(({Nu:za}=Xa.d(Q.data.we)).returnValue)if(Q=za,Q.StatusCode!==Qi.a.oz&&Q.StatusCode!==Qi.a.tHc)ya.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.B4();else{ya.ULS.sendTraceTag(6590603,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob&&1===l.AFrameworkApplication.ta.Ob.jm?15:50,"UploadToCloudManager upload success.");try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.ALb(Q.NewDocumentUrl):
this.BLb()}catch(hb){ya.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",hb.toString())}this.S_c()}else ya.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:xb.a.z9c(Q.data.we)}),this.B4()}else ya.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.B4()}Hmn(Q){5!==Q.data.status&&12!==Q.data.status||this.UY?(ya.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",Q.data.status),
this.Yla(),this.B4(),this.S_c()):(ya.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.UY=!0,this.yfa())}S_c(){this.TXa&&(this.TXa.stop(),this.TXa=null)}}Object(e.a)(Rg,"UploadToCloudManager",null,[1892]);class Cj extends Rg{constructor(Q,za,hb,Tb,zc,kd){super(za,hb,Tb,zc,kd);this.ga=Q}uDf(){return!!this.Sm&&!!this.Sm.SaveEntryPoint&&"VersionHistory"===this.Sm.SaveEntryPoint.toString()}B4(){ya.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.uDf()&&
this.ga.Rb(m.a.ace,2,{["FailureReason"]:"Unknown"});super.B4()}BLb(){ya.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.uDf()&&this.ga.processAction(m.a.u3c,2);super.BLb()}ALb(Q){ya.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",Q);this.uDf()&&this.ga.processAction(m.a.u3c,2);super.ALb(Q)}yfa(){this.Sm&&"true"===this.Sm.SkipSaveToHost?super.yfa():32!==this.ga.processAction(m.a.BMb,1)?(ya.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),
super.yfa()):this.ga.Rb(m.a.BMb,2,[()=>{ya.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Rg.prototype.yfa.call(this)},()=>{ya.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.B4()}])}}Object(e.a)(Cj,"SaveACopyUploadToCloudManager",Rg,[]);var fl=c(755),qj=c(1200);class kn{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){l.AFrameworkApplication.K.Wo(Object(a.a)(this,this.zx,
"onFullAppSettingsReady"))}zx(){l.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Ub()}dispose(){}yc(Q){this.W=Q;this.W.register(Cj,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Qd(()=>new Cj(l.AFrameworkApplication.xa,Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new qj.a).create(),()=>new Pg(l.AFrameworkApplication.xa),l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.xq)).singleInstance();this.W.register(Fm,
"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Qd(()=>new Fm(l.AFrameworkApplication.xa,l.AFrameworkApplication.ta.Ob,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).singleInstance();this.W.register(kl,"Common.App.SaveACopy.SaveACopyActor").Qd(()=>new kl(Q.resolve("Common.App.SaveACopy.SaveACopyManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.ta.xq)).singleInstance();
this.W.register(Mm,"Common.App.SaveACopy.SaveACopyManager").Qd(()=>new Mm(Q.resolve("Common.App.SaveACopy.FileNameDialogFactory"),Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),fl.a.instance,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.vfa,()=>new Pg(l.AFrameworkApplication.xa))).singleInstance()}static main(){K.a.instance.Gc(new kn)}}Object(e.a)(kn,"PackageManager",null,[1,2]);var Gk=c(39);class xk extends Sb.StandardDialog{constructor(Q,
za){super();this.sWb=!1;this.dN=null;this.ga=Q;this.Erc=za;this.nHa=!1}kT(Q,za,hb){this.dN=za;this.sWb=hb;ya.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Q,hb);Q=this.D4e(Q);0===Q?(this.zd=6,this.Ge(0,CommonUIStrings.l_DialogClose)):(this.zd=0,this.Ge(1,CommonUIStrings.l_DialogClose));0===Q&&ya.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Sw(Gk.a.G3n,this.zMl(Q),this.yMl(Q,za),Object(a.a)(this,this.S4f,"retryDialogHandler"),!0)}S4f(Q){1===
Q?(ya.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.dN?this.ga.Rb(m.a.u4c,2,[this.dN,this.sWb]):this.ga.processAction(m.a.u4c,2)):ya.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}D4e(Q){return 0>Q||6<Q?(ya.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",Q),0):Q}yMl(Q,za){Q=this.D4e(Q);return this.Erc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,za),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][Q]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,za),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][Q]}zMl(Q){Q=this.D4e(Q);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,
CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][Q]}}Object(e.a)(xk,"ErrorRetryDialog",Sb.StandardDialog,[2009]);class Rh{constructor(Q,za){this.Na=Q;this.ga=za;this.Erc=this.Na.$("SaveToHostWithExtraCharsInFileName")}create(){return new xk(this.ga,this.Erc)}}Object(e.a)(Rh,"ErrorRetryDialogFactory",null,[1983]);class ln extends k.a{constructor(Q,za,hb,Tb,zc,kd,ce=null){super();
this.I5=null;this.ga=za;this.Jqa=Tb;this.UXa=kd;this.Na=Q;this.LG=zc;this.Ri=hb;this.Erc=this.Na.$("SaveToHostWithExtraCharsInFileName");this.Sm=ce;this.Ge(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.Ri}kOh(Q,za){this.Dpa(1,!!Q&&Q!==za);this.I5=document.getElementById(ln.xVh);V.a.addHandler(this.I5,"change",Object(a.a)(this,this.c5d,"onFileNameChange"));V.a.addHandler(this.I5,"input",Object(a.a)(this,this.c5d,"onFileNameChange"));this.I5.focus()}wVh(Q){return this.Erc?(new RegExp("["+
this.mTh('\\/:*?"<>|')+"]")).test(Q):(new RegExp("["+this.mTh('\\/:*?"<>|#{}%~&')+"]")).test(Q)}mTh(Q){return Q.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}cuf(){const Q=db.a.KI(l.AFrameworkApplication.Mt.Oy);this.Dpa(1,!!this.I5&&""!==this.I5.value&&this.I5.value!==Q)}c5d(){this.I5&&window.setTimeout(()=>{this.cuf()},0)}uKd(Q,za){if(1!==Q)ya.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{Q=za[ln.xVh];za=ln.tTi in za?za[ln.tTi]:!1;ya.ULS.sendTraceTag(23881883,
216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",db.a.S1i(Q),za);const hb=db.a.Qfa(l.AFrameworkApplication.fileName);(Q=Q?Q.trim():null)&&""!==Q&&""!==hb||1===this.ta.state?this.wVh(Q)?this.LG.create().kT(1,Q,za):this.UXa.wHa(Q+hb,za,this.Sm):this.LG.create().kT(2,Q,za)}}dispose(){this.I5&&(V.a.removeHandler(this.I5,"change",Object(a.a)(this,this.c5d,"onFileNameChange")),V.a.removeHandler(this.I5,"input",Object(a.a)(this,this.c5d,"onFileNameChange")),this.I5=
null);super.dispose()}}ln.xVh="txtFileName";ln.tTi="chkOverwrite";Object(e.a)(ln,"FileNameDialogBase",k.a,[]);class Sf{static get Wg(){return k.a.Xz(Sf.Hm,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}Sf.Hm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(e.a)(Sf,"FileNameDialogHtml",null,[]);class Jd extends ln{constructor(Q,za,hb,Tb,zc,kd){super(Q,za,hb,Tb,zc,kd);this.Wg=Sf.Wg;this.sg="FileNameDialog-SaveAsToHost"}dDa(Q,za){const hb=db.a.KI(l.AFrameworkApplication.Mt.Oy);za={["txtFileName"]:Q||hb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:za};this.Yh(CommonUIStrings.L_SaveAs,Object(a.a)(this,this.uKd,"fileNameDialogHandler"),za);this.kOh(Q,hb)}}Object(e.a)(Jd,"FileNameDialog",ln,[2008]);class rn{constructor(Q,za,
hb,Tb,zc,kd){this.ga=za;this.Na=Q;this.Jqa=Tb;this.UXa=kd;this.LG=zc;this.Ri=hb}create(){return new Jd(this.Na,this.ga,this.Ri,this.Jqa,this.LG,this.UXa)}}Object(e.a)(rn,"FileNameDialogFactory",null,[1982]);class mn{constructor(Q,za,hb){this.UXa=hb;this.Gye=za;this.Na=Q}Ub(){2===l.AFrameworkApplication.ta.Ob.jm?l.AFrameworkApplication.xa.gb(m.a.u4c,y.a.frame,Object(a.a)(this,this.eaj,"saveAsToHostActionDispatcher"),4):l.AFrameworkApplication.xa.pa(m.a.u4c,y.a.frame,Object(a.a)(this,this.eaj,"saveAsToHostActionDispatcher"))}eaj(Q,
za,hb,Tb,zc){return za.contextId!==y.a.frame||Q!==m.a.u4c?2:this.Na.$("SaveAsToHostBrsIsEnabled")?1===hb?Pd.SessionStatusManager.instance.xj||l.AFrameworkApplication.Jna?8:32:2===hb?(ya.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),Q=this.Gye.create(),zc&&Object.getType(zc)===Array&&2===zc.length?Q.dDa(zc[0],!!zc[1]):Q.dDa(null,!1),32):8:8}}Object(e.a)(mn,"SaveAsToHostActor",null,[]);class Al{constructor(Q,za,hb,Tb,zc,kd,ce,df){this.xk=null;this.sWb=this.UY=
!1;this.TXa=this.Sm=this.dN=null;this.Na=za;this.Pka=this.Na.appSettings.SaveAsToHostWebServiceBase;this.ZWg=Tb;this.KWa=zc;this.Of=hb;this.LG=kd;this.ge=df;this.Ri=ce;this.ga=Q;this.vVa=za.kb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}d6a(){1!==this.Ri.state&&(this.xk=this.KWa(),this.xk.message=CommonUIStrings.l_CommentProgressTooltip,this.xk.zd=5,this.xk.ht=!1,this.xk.YK(CommonUIStrings.l_DefaultDialogTitle,null,null))}B4(Q=0){1!==this.Ri.state&&this.LG.create().kT(Q,db.a.KI(this.dN),
this.sWb)}BLb(){const Q=this.Na.appSettings.BreadcrumbFolderUrl;ya.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");ca.a.km(Q,ca.a.zqa(3),void 0,"UploadToHostManager.RedirectToFolder")}ALb(Q){let za=!1,hb=!1;this.Na&&(za=this.Na.$("SaveACopyIsEnabledForUiHost"),hb=this.Na.$("UiHostSupportsDocRebootFeatures"));ya.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",Q,za,hb);if(za&&hb){ya.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Tb={};Tb[Ug.a.Pfc]="1";Tb[Ug.a.documentUrl]=Q;Tb[Ug.a.reason]=ah.a.S5f;l.AFrameworkApplication.lO().execute(zc=>{zc.sendMessage(Lh.a.kBb,Tb)})}else za&&!hb&&l.AFrameworkApplication.fU?ca.a.km(Q,ca.a.zqa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):ca.a.km(Q,ca.a.zqa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}wHa(Q,za,hb=null){ya.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.ZWg&&
!this.ZWg()&&this.Of&&(this.ge&&(this.TXa=this.ge.eg("DialogShown","SaveAsToHostUploadTime")),this.d6a(),this.sWb=za,this.dN=Q,(this.Sm=hb)&&"true"===this.Sm.SkipSaveToHost?this.EJd():this.yfa())}yfa(){32!==this.ga.processAction(m.a.BMb,1)?(ya.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.EJd()):this.ga.Rb(m.a.BMb,2,[()=>{ya.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.EJd()},(Q,za)=>
{ya.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.B4(za)}])}Pon(Q){this.Yla();this.UY=!1;if(Q&&Q.data&&Q.data.we)if(({Nu:za}=Xa.d(Q.data.we)).returnValue)if(Q=za,Q.StatusCode!==Qi.a.oz&&Q.StatusCode!==Qi.a.tHc){ya.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var za={};za.FailureReason=Q.StatusCode.toString();za.ExtraInfo=Q.ExtraInfo;this.WRa(za);this.B4(parseInt(Q.ExtraInfo))}else{ya.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.S3f();try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.ALb(Q.NewDocumentUrl):this.BLb()}catch(hb){ya.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",hb.toString())}this.S_c()}else ya.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:xb.a.z9c(Q.data.we)}),this.WRa({["FailureReason"]:"Failed to deserialize response"}),this.B4();else ya.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.WRa({["FailureReason"]:"null response"}),this.B4()}Oon(Q){5!==Q.data.status&&12!==Q.data.status||this.UY?(ya.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:Q.data.status,["HttpStatus"]:Q.data.Ve}),this.WRa({["FailureReason"]:Q.data.Ve.toString()}),this.Yla(),this.B4(),this.S_c()):(ya.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.UY=!0,this.Sm&&"true"===this.Sm.SkipSaveToHost?this.EJd():this.yfa())}Yla(){this.xk&&
(this.xk.close(),this.xk=null)}S_c(){this.TXa&&(this.TXa.stop(),this.TXa=null)}S3f(){this.Sm&&"VersionHistory"===this.Sm.SaveEntryPoint&&this.ga.processAction(m.a.u3c,2)}WRa(Q){this.Sm&&"VersionHistory"===this.Sm.SaveEntryPoint&&this.ga.Rb(m.a.ace,2,Q)}EJd(){let Q=this.Pka+this.vVa;Q=rb.a.fp(Q,"qs",db.a.Mj(l.AFrameworkApplication.fm));Q=rb.a.fp(Q,"n",db.a.Mj((new Date).getTime().toString()));Q=rb.a.fp(Q,"ov",db.a.Mj(this.sWb.toString()));Q=rb.a.fp(Q,"fn",db.a.Mj(this.dN));this.Sm&&this.Sm.FileDownloadUrl&&
(Q=rb.a.fp(Q,"furl",db.a.Mj(this.Sm.FileDownloadUrl)));this.Of.oj(Q,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(a.a)(this,this.Pon,"onUploadFinished"),Object(a.a)(this,this.Oon,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(e.a)(Al,"UploadToHostManager",null,[1980]);class dg{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){l.AFrameworkApplication.K.Wo(Object(a.a)(this,this.zx,"onFullAppSettingsReady"))}zx(){l.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Ub()}yc(Q){this.W=Q;this.W.register(Rh,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Qd(()=>new Rh(l.AFrameworkApplication.K,l.AFrameworkApplication.xa)).singleInstance();this.W.register(Al,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Qd(()=>new Al(l.AFrameworkApplication.xa,l.AFrameworkApplication.K,l.AFrameworkApplication.Ke,
()=>l.AFrameworkApplication.Rk,()=>(new qj.a).create(),Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.xq)).singleInstance();this.W.register(rn,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Qd(()=>new rn(l.AFrameworkApplication.K,l.AFrameworkApplication.xa,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Ob,Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance();
this.W.register(mn,"Common.App.SaveAsToHost.SaveAsToHostActor").Qd(()=>new mn(l.AFrameworkApplication.K,Q.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance()}dispose(){}static main(){K.a.instance.Gc(new dg)}}Object(e.a)(dg,"SaveAsToHostPackage",null,[1,2]);class Gm extends Sb.StandardDialog{constructor(){super();this.zd=0;this.Ge(1,CommonUIStrings.l_DialogClose)}kT(Q){this.Sw(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(e.a)(Gm,"ErrorDialog",Sb.StandardDialog,[1895]);var gl=c(192);class Cn extends Sb.StandardDialog{constructor(Q,za,hb){super();this.ga=Q;this.vsa=za;this.Jqa=hb;this.Z9=!1;this.zd=1;this.MU(1);this.Ge(1,CommonUIStrings.l_SignIn);this.Ge(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}dDa(){this.vsa.amh(Object(a.a)(this,this.kRi,"onSignIn"));this.Au(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(a.a)(this,this.Fsm,"inputHandler"))}Fsm(Q){0===
Q?(ya.ULS.sendTraceTag(6590598,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob&&1===l.AFrameworkApplication.ta.Ob.jm?15:50,"User dismissed SignIn Dialog."),this.hide()):this.p8d()}XNk(){let Q="2";if(this.Jqa)switch(this.Jqa.jm){case 3:Q="0";break;case 2:Q="3";break;case 1:Q="1"}return Q}hide(){this.vsa.IUn(Object(a.a)(this,this.kRi,"onSignIn"));super.hide()}p8d(){var Q=l.AFrameworkApplication.K.$("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";Q=new gl.QueryStringBuilder(Q);
Q.De("prompt","1");Q.De("cbcxt",this.XNk());l.AFrameworkApplication.mea(Q);ca.a.km(Q.toString(),"LoginWindow",void 0,"SignInDialog")}kRi(){this.Ega&&this.hide();ya.ULS.sendTraceTag(7143885,216,l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob&&1===l.AFrameworkApplication.ta.Ob.jm?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(m.a.a6f,2)}}Object(e.a)(Cn,"SignInDialog",Sb.StandardDialog,[1914]);class bh{constructor(Q,za,hb){this.ga=Q;this.vsa=
za;this.Jqa=hb}create(){return new Cn(this.ga,this.vsa,this.Jqa)}}Object(e.a)(bh,"SignInDialogFactory",null,[1890]);class Ij{constructor(Q,za,hb,Tb,zc,kd,ce){this.Pka=Q;this.dN=za;this.HTb=hb;this.Jhd=Tb;this.JMe=zc;this.vVa=kd;this.Sm=ce}execute(Q,za){if(!l.AFrameworkApplication.Rk&&l.AFrameworkApplication.Ke){var hb=this.Pka+this.vVa;hb=rb.a.fp(hb,"fo",db.a.Mj(this.Jhd));hb=rb.a.fp(hb,"fn",db.a.Mj(this.dN));hb=rb.a.fp(hb,"qs",db.a.Mj(this.JMe));hb=rb.a.fp(hb,"n",db.a.Mj((new Date).getTime().toString()));
this.Sm&&this.Sm.FileDownloadUrl&&(hb=rb.a.fp(hb,"furl",db.a.Mj(this.Sm.FileDownloadUrl)));this.HTb&&(hb=rb.a.fp(hb,"fnn",db.a.Mj(this.HTb)));l.AFrameworkApplication.Ke.oj(hb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,za,null)}}}Object(e.a)(Ij,"SkyDriveUploadCaller",null,[1915]);class Bd{constructor(Q){this.Na=Q;this.Hxb=Q.appSettings.SkyDriveUploadWebServiceBase;this.dN=Q.appSettings.FileName;this.vVa=Q.kb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(Q,za,hb){return new Ij(this.Hxb,
this.dN,za,Q,l.AFrameworkApplication.fm,this.vVa,hb)}}Object(e.a)(Bd,"SkydriveUploadCallerFactory",null,[1894]);class Fe{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){l.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ub()}dispose(){}yc(Q){this.W=Q;this.W.register(bh,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Qd(()=>
new bh(l.AFrameworkApplication.xa,fl.a.instance,l.AFrameworkApplication.ta.Ob)).singleInstance();this.W.register(Bd,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Qd(()=>new Bd(l.AFrameworkApplication.K)).singleInstance();this.W.register(fi,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Qd(()=>new fi(Q.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
l.AFrameworkApplication.K,l.AFrameworkApplication.ta.xq)).singleInstance();this.W.register(Rg,"Common.App.SaveToCloudStorage.UploadToCloudManager").Qd(()=>new Rg(Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new qj.a).create(),()=>new Gm,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.xq)).singleInstance();this.W.register(dj,"Common.App.SaveToCloudStorage.SaveToCloudManager").Qd(()=>new dj(Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),fl.a.instance,
Q.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.vfa,()=>new Gm)).singleInstance()}static main(){K.a.instance.Gc(new Fe)}}Object(e.a)(Fe,"PackageManager",null,[1,2]);class nn extends Sb.StandardDialog{constructor(){super();this.zd=0;this.Ge(1,CommonUIStrings.l_DialogClose)}kT(Q,za){this.GOh(Q,za,Gk.a.I3n)}GOh(Q,za,hb){ya.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",hb);this.Sw(hb,Q,za,null)}cdf(Q,
za){ya.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Sw(Gk.a.K3n,Q,za,null,!0)}}Object(e.a)(nn,"ErrorDialog",Sb.StandardDialog,[959]);class no{static get Wg(){return k.a.Xz(no.Hm,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}no.Hm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(e.a)(no,"FileNameDialogHtml",null,[]);var Zd=c(63);class nd extends ln{constructor(Q,za,hb,Tb,zc,kd,ce,df){super(Q,za,hb,Tb,zc,kd,df);this.C$a=this.ROe=this.xP=null;this.FIk=CommonUIStrings.l_SaveToAnotherFolder;this.Wg=no.Wg;this.sg="FileNameDialog-SaveToSharePoint";this.pzc=ce;this.X7j=df}dDa(Q){const za=db.a.KI(l.AFrameworkApplication.Mt.Oy),hb=l.AFrameworkApplication.breadcrumbFolderName,Tb=l.AFrameworkApplication.breadcrumbBrandName,zc={["txtFileName"]:Q||za};let kd=CommonUIStrings.L_SaveAs;
2===l.AFrameworkApplication.ta.Ob.jm&&(kd=CommonUIStrings.L_SaveACopy);this.Yh(kd,Object(a.a)(this,this.uKd,"fileNameDialogHandler"),zc);this.kOh(Q,za);this.Wbf.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.xP=document.getElementById("anotherFolder"),Q=document.getElementById("folderLocation"),this.ROe=Sc.a.dph(Q,this.xP,"anotherFolderDescribedBy"),this.xP.className=
"WACButton WACDialogButtonNormal",Q=!1,hb&&hb.length?(this.Sjh(this.xP,this.ROe,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Tb,hb)),Q=this.akk(Tb,hb)):this.Sjh(this.xP,this.ROe,CommonUIStrings.l_CurrentOnlineFolder),this.Slk(this.xP),this.ckk(this.xP),Q?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.xP,"SaveToAnotherLocationTwo"),ya.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.xP,
"SaveToAnotherLocationOne"),V.a.addHandler(this.xP,W.a.click,Object(a.a)(this,this.WSf,"onSaveToAnotherLocationClick")),V.a.addHandler(this.xP,W.a.fi,Object(a.a)(this,this.PQi,"onSaveToAnotherLocationKeyDown")))}akk(Q,za){let hb;hb=!1;const Tb=document.getElementById("currentLocation");Tb.innerText="";const zc=this.F8h(Tb,Q),kd=this.F8h(Tb,za);let ce=255,df=255;255<zc+kd&&(ce=Math.max(238,408-zc),df=Math.max(170,408-kd),hb=!0);this.eok(Tb,Q,df,za,ce);return hb}F8h(Q,za){const hb=document.createElement("div");
hb.innerText=za;hb.style.visibility="hidden";Q.appendChild(hb);za=hb.clientWidth;Q.removeChild(hb);return za}eok(Q,za,hb,Tb,zc){za&&(this.Rjh(Q,za,hb),this.Ynk(Q));Tb&&this.Rjh(Q,Tb,zc)}Rjh(Q,za,hb){const Tb=document.createElement("div");Tb.innerText=za;Tb.title=za;Tb.className="SaveToAnotherFolderBreadcrumb";Tb.style.maxWidth=hb.toString()+"px";Q.appendChild(Tb)}Ynk(Q){const za=document.createElement("span");za.id="FolderSeparator";const hb=document.createElementNS("http://www.w3.org/2000/svg","svg");
hb.setAttribute("class","SeparatorCaret");const Tb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Tb.setAttribute("points","1 4 1 11 5 7.5");hb.appendChild(Tb);za.appendChild(hb);Q.appendChild(za)}Sjh(Q,za,hb){hb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,hb);za&&(za.innerText=hb);Q.tabIndex=0;Q.setAttribute(Sc.a.oh,Sc.a.z2)}ckk(Q){const za=document.createElement("span");za.id="anotherFolderText";za.innerText=this.FIk;za.className="AnotherFolderTextSpan";
Q.appendChild(za)}Slk(Q){const za=document.createElement("span");za.className="cui-img-cont-float cui-img-16by16 ";this.C$a=document.createElementNS("http://www.w3.org/2000/svg","svg");this.C$a.setAttribute("class","FolderIconSVG");const hb=document.createElementNS("http://www.w3.org/2000/svg","path");hb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.C$a.appendChild(hb);za.appendChild(this.C$a);Q.appendChild(za)}PQi(Q){!Q||
Q.keyCode!==Zd.a.ks&&Q.keyCode!==Zd.a.Kme||this.WSf(Q)}WSf(){if(this.I5){const Q=db.a.Qfa(l.AFrameworkApplication.fileName);let za=this.I5.value;this.hide();za&&""!==za&&""!==Q||1===this.ta.state?(""!==Q&&(za+=Q),this.wVh(za)?this.LG.create().kT(1,za,!1):this.pzc.start(za,this.X7j)):this.LG.create().kT(2,za,!1)}}CNk(Q){this.xP&&this.C$a&&(Q?(this.xP.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.xP,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.C$a,"DisabledFolderIconSVG")):(this.xP.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.xP,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.C$a,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.xP,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.C$a,"DisabledFolderIconSVG"))))}cuf(){super.cuf();this.CNk(!!this.I5&&""!==this.I5.value)}dispose(){this.xP&&(V.a.removeHandler(this.xP,W.a.click,Object(a.a)(this,this.WSf,"onSaveToAnotherLocationClick")),V.a.removeHandler(this.xP,W.a.fi,Object(a.a)(this,this.PQi,
"onSaveToAnotherLocationKeyDown")),this.xP=null);super.dispose()}}Object(e.a)(nd,"FileNameDialog",ln,[1238]);var Hm=c(439),cf=c(318),Of=c(1536),xm=c(1659);class ze{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(e.a)(ze,"SaveAsDialogInput",null,[]);class Bf{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(e.a)(Bf,"SaveLocation",null,[]);var ch=c(126);class bj{constructor(Q,za,hb,Tb,zc,kd,ce,df,bf){this.DGe=
null;this.dN="";this.pzc=Q;this.LG=za;this.Sm=bf;this.UXa=hb;this.Ri=zc;this.qL=Tb;this.txb=ce;this.$Xb=df;kd&&(this.DGe=new $b.a(()=>new Of.a(kd.value,null)))}pLl(){const Q=new Hm.a(cf.a.Xh());Q.Z("type","currentHost");return Object.assign(new Bf,{folderName:this.qL.breadcrumbFolderName,friendlyPath:this.qL.breadcrumbBrandName,properties:Q})}aKm(Q){return!!Q&&"ClassicMru"===Q.type&&!!Q.service_info&&!!Q.service_info.service_id&&-1!==Q.service_info.service_id.indexOf("SHAREPOINT")}D5l(){if(!this.DGe||
!this.txb)return null;var Q=this.DGe.value.Vj("SaveAsToSharePointDialog",!1);if(!Q||3!==Q.state||!Q.kJi)return null;Q=Q.kJi;const za=new ob.a;let hb=0,Tb=0;for(var zc=0;zc<Q.length;zc++){var kd=Q[zc];if(!this.aKm(kd))continue;hb++;if(!kd.sharepoint_info)continue;const ce=kd.url,df=kd.sharepoint_info.site_url,bf=kd.title;kd=xm.b(kd,l.AFrameworkApplication.isRtl);if(!(ce&&df&&bf&&kd))continue;Tb++;const Vf=new Hm.a(cf.a.Xh());Vf.Z("type","SharePoint");Vf.Z("siteUrl",df);Vf.Z("folderUrl",ce);Tb++;za.add(Object.assign(new Bf,
{folderName:bf,friendlyPath:kd,properties:Vf}))}zc=new Map;zc.set("NumPlaces",Q.length.toString());zc.set("NumSharepointPlaces",hb.toString());zc.set("placesWithMetadata",Tb.toString());Oa.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",zc);0<hb&&(Tb?.5>1*Tb/hb&&Oa.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Oa.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return za}xMl(){const Q=
new ob.a;Q.add(this.pLl());const za=this.D5l();za&&Q.addRange(za);return Object.assign(new ze,{enableMoreLocations:!l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.dN,extension:db.a.Qfa(this.qL.Oy),saveLocations:Q.toArray(),scenario:"SaveToSharePoint"})}bnf(){const Q=Object(a.a)(this,this.xMl,"getDialogInput"),za={};za.inputPropsCallback=Q;return za}dDa(Q){this.dN=Q;this.dN||(this.dN=String.format(CommonUIStrings.l_SaveACopy_Filename,db.a.KI(this.qL.Oy)));Q={["id"]:"SaveAsDialog",
["bodyControls"]:this.bnf()};let za=CommonUIStrings.L_SaveAs;2===this.Ri.Ob.jm&&(za=CommonUIStrings.L_SaveACopy);const hb=new k.a(!1,!1,!0);hb.zd=1;hb.sg="SaveAsDialog";hb.Ge(1,CommonUIStrings.l_SaveButtonLabel);hb.Yh(za,Object(a.a)(this,this.E3n,"saveAsDialogHandler"),Q)}ypo(Q,za){Q&&""!==Q&&""!==za||1===this.Ri.state?this.$Jm()?this.iTm(Q,za):(""!==za&&(Q+=za),this.pzc.start(Q,this.Sm)):(ya.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.LG.create().kT(2,
Q,!1))}iTm(Q,za){Oa.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const hb=this.$Xb.m9e(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.$Xb.KNd(hb).then(Tb=>{if(Tb&&0<Tb.length){const zc=Tb[0][Ug.a.Tvn];Tb=Tb[0][Ug.a.Uvn];if(""!==zc&&""!==Tb)this.txb.wHa(Tb,Q+za,zc,this.Sm),Oa.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.LG.create().kT(0,Q,!1);const kd=sf.a.KF();kd&&(kd.set("SiteUrlAvailable",
""===zc?"false":"true"),kd.set("FolderUrlAvailable",""===Tb?"false":"true"));Oa.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new ch.a,{extendedProperties:kd}))}}else this.LG.create().kT(0,Q,!1),Oa.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Tb=>{"Canceled"===Tb?((Tb=sf.a.KF())&&Tb.set("IsCanceled","true"),Oa.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new ch.a,{extendedProperties:Tb}))):
Oa.Health.instance.recordKpiFailure("SaveACopySFP",Tb,!1,!1,null)})}$Jm(){return this.$Xb?this.$Xb.EDf():(ya.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}E3n(Q,za){if(za&&1===Q){Q=za.fileName;var hb=db.a.Qfa(this.qL.Oy);za.moreLocationsSelected&&this.ypo(Q,hb);if(za.locationCallback){var Tb=za.locationCallback();Tb?Tb.properties&&"currentHost"===Tb.properties.J("type")?this.UXa.wHa(Q+hb,!1,this.Sm):Tb.properties&&"SharePoint"===Tb.properties.J("type")?(za=Tb.properties.J("siteUrl"),
Tb=Tb.properties.J("folderUrl"),this.txb.wHa(Tb,Q+hb,za,this.Sm)):ya.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):ya.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else ya.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(e.a)(bj,"ReactSaveAsDialog",null,[1238]);class Ag{constructor(Q,za,hb,Tb,zc,kd,ce,df=null,bf=null,Vf=null){this.ga=za;this.Na=Q;this.Jqa=Tb;this.UXa=kd;this.LG=zc;this.Ri=hb;this.Dah=ce;this.G3j=df;this.txb=bf;this.$Xb=
Vf}create(Q){return this.Ri&&this.Ri.Ob.VE?new bj(this.Dah,this.LG,this.UXa,l.AFrameworkApplication.Mt,this.Ri,this.G3j,this.txb,this.$Xb,Q):new nd(this.Na,this.ga,this.Ri,this.Jqa,this.LG,this.UXa,this.Dah,Q)}}Object(e.a)(Ag,"FileNameDialogFactory",null,[1223]);class Uf{constructor(Q,za,hb,Tb){this.mw=this.axc=null;this.jsb=Q;this.Ri=hb;this.h9j=Tb;this.tVa=new $b.a(()=>new Of.a(za.value,Object(a.a)(this,this.BDb,"getMoreInfoEventReceived")))}get iSi(){this.axc||(this.tVa.value.Vj("Save As",!0),
this.mw&&this.mw.$ba&&this.mw.$ba.length&&(this.axc=this.LYl(this.mw.$ba)));return this.axc}start(Q){if(!this.iSi)if(l.AFrameworkApplication.breadcrumbFolderUrl&&l.AFrameworkApplication.breadcrumbFolderUrl.length)this.axc=l.AFrameworkApplication.breadcrumbFolderUrl;else return ya.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.mw),!1;const za=this.h9j();za.Kpo();const hb=
za.v0l();if(!hb)return ya.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.jsb.start((Tb,zc)=>{za.hide();Q(Tb,zc)},()=>{this.nJb(za)},hb,this.axc);return!0}nJb(Q){Q.hide();ya.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}LYl(Q){Q=Q.toLowerCase();Q.endsWith("/")||(Q+="/");const za=Q.indexOf("/documents/");return-1!==za?Q.substring(0,za+1)+"_layouts/15/onedrive.aspx":""}BDb(Q){this.mw||3!==Q.state||(this.mw=Q)}}Object(e.a)(Uf,"OneDriveFilePickerHelper",
null,[1224]);class Hl extends k.a{constructor(){super()}Kpo(){this.Upc="FilePickerDialog";this.Wg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.sg="PickerDialog-MsoSp";this.showDialog("",null)}v0l(){return document.getElementById("FilePickerDiv")}$K(){}fca(){}}Object(e.a)(Hl,"PickerDialog",k.a,[958]);class th{constructor(Q,za,hb,Tb,zc,kd,ce){this.Na=Q;this.Gye=hb;this.ga=za;this.pzc=Tb;this.jsb=zc;this.$wc=kd;this.JRj=ce}Ub(){const Q=this.jsb.U6b();Q?Ta.a.Hna||this.Na.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.gb(m.a.Ugc,y.a.frame,Object(a.a)(this,this.Aaj,"saveToSharePointActionDispatcher"),64):(Q.f3a.continueWith(za=>{za.Ai&&this.jsb.KRf(za)}),this.gBd()):ya.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}gBd(){dc.a.i2c(Object(a.a)(this,this.Aaj,"saveToSharePointActionDispatcher"));dc.a.EJc([new Xh.a(m.a.Ugc,y.a.frame,0)],this.jsb.U6b())}get Gac(){return this.Na.$("SaveToAnotherFolderBrsIsEnabled")}get txh(){return this.Na.$("UserCanWriteRelative")}Aaj(Q,
za,hb,Tb,zc){return za.contextId!==y.a.frame||Q!==m.a.Ugc?2:this.Gac&&(this.$wc.iSi||this.txh)?1===hb?Pd.SessionStatusManager.instance.xj||l.AFrameworkApplication.Jna?8:this.JRj()?32:8:2===hb?(ya.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(zc&&zc.SaveEntryPoint&&"VersionHistory"===zc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.txh?(ya.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.Gye.create(zc).dDa(null)):(ya.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.pzc.start(null,zc)),32):8:8}}Object(e.a)(th,"SaveToSharePointActor",null,[]);class Ym{constructor(Q,za,hb,Tb){this.Sm=this.W3g=null;this.txb=Q;this.LG=za;this.$wc=hb;this.Ri=Tb}start(Q,za){ya.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.W3g=Q;this.Sm=za;this.$wc.start((hb,Tb)=>{this.processResponse(hb,Tb)})||this.tbg()}processResponse(Q,za){if(Q)this.onSuccess(za);else this.onFailure(za)}tbg(){1!==
this.Ri.state&&this.LG().cdf(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(Q){ya.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(Q&&Q.data&&Q.data.value&&Q.data.value.length&&Q.data.value[0].sharePoint){const za=Q.data.value[0].sharePoint.url;Q=Q.data.value[0].sharePoint.listUrl;let hb=null;if(za&&(hb=Q?this.Q5l(Q):this.P5l(za))){this.txb.wHa(za,this.W3g,hb,this.Sm);return}ya.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!za,!hb)}ya.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.tbg()}P5l(Q){Q.endsWith("/")||(Q+="/");let za=0;for(let hb=0;hb<Q.length;hb++)if("/"===Q.charAt(hb)&&5===++za)return Q.substr(0,hb);return null}Q5l(Q){Q.endsWith("/")&&(Q=Q.substring(0,Q.length-1));const za=Q.lastIndexOf("/");return-1!==za?Q.substring(0,za):null}onFailure(Q){ya.ULS.sendTraceTag(23881888,216,
10,"Picker failure Callback called.");Q&&Q.error?ya.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",Q.error.errorCode,Q.error.message):ya.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.tbg()}}Object(e.a)(Ym,"SaveToSharePointManager",null,[1973]);class Nm{constructor(Q,za,hb,Tb,zc,kd,ce,df){this.Pka=Q;this.dN=za;this.HTb=Tb;this.JMe=kd;this.VJa=hb;this.ndk=zc;this.vVa=ce;this.Sm=df}execute(Q,za){if(!l.AFrameworkApplication.Rk&&
l.AFrameworkApplication.Ke){var hb=this.Pka+this.vVa;hb=rb.a.fp(hb,"fu",db.a.Mj(this.VJa));hb=rb.a.fp(hb,"su",db.a.Mj(this.ndk));hb=rb.a.fp(hb,"fn",db.a.Mj(this.dN));hb=rb.a.fp(hb,"n",db.a.Mj((new Date).getTime().toString()));this.Sm&&this.Sm.FileDownloadUrl&&(hb=rb.a.fp(hb,"furl",db.a.Mj(this.Sm.FileDownloadUrl)));hb=hb+"&"+this.JMe;this.HTb&&this.HTb.length?hb=rb.a.fp(hb,"fnn",db.a.Mj(this.HTb)):ya.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");ya.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");l.AFrameworkApplication.Ke.oj(hb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,za,null,void 0,void 0,void 0,void 0,"9")}}}Object(e.a)(Nm,"SharePointSaveAsCaller",null,[2E3]);class Dn{constructor(Q){this.Hxb=Q.appSettings.SaveAsToHostWebServiceBase;this.dN=Q.appSettings.FileName;this.vVa=Q.kb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(Q,za,hb,Tb){return new Nm(this.Hxb,this.dN,Q,za,hb,l.AFrameworkApplication.fm,
this.vVa,Tb)}}Object(e.a)(Dn,"SharePointUploadCallerFactory",null,[1971]);var Sn=c(1370);class Kl{constructor(Q,za,hb,Tb,zc){this.xk=this.uoc=null;this.Lqe=!1;this.LOe=this.VJa=null;this.yUe=za;this.KWa=hb;this.LG=Tb;this.Ri=zc;this.ga=Q}wHa(Q,za,hb,Tb){this.Lqe=!1;ya.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.d6a();this.VJa=Q;Tb&&Tb.SaveEntryPoint&&(this.LOe=Tb.SaveEntryPoint);this.uoc=this.yUe.create(Q,za,hb,Tb);Tb&&"true"===Tb.SkipSaveToHost?
this.yfa():this.Nzl()}Nzl(){const Q=()=>{ya.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.yfa()};32!==this.ga.Rb(m.a.BMb,2,[()=>{ya.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.yfa()},Q])&&Q()}yfa(){ya.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.uoc.execute(Object(a.a)(this,this.Kmn,"onSaveToSharePointUploadFinished"),Object(a.a)(this,this.Jmn,
"onSaveToSharePointUploadFailed"))}Kmn(Q){if(Q&&Q.data&&Q.data.we){var za;if(({Nu:za}=Xa.d(Q.data.we)).returnValue)if(za.StatusCode!==Qi.a.oz&&za.StatusCode!==Qi.a.tHc)ya.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Q.data.status,za.StatusCode),za.StatusCode!==Qi.a.X3f&&this.lPh(Q.data.status)||(this.WRa(za.StatusCode.toString()),this.Hoo(za.StatusCode));else{ya.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.S3f();try{za.NewDocumentUrl?this.ALb(za.NewDocumentUrl):this.BLb()}catch(hb){ya.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",hb.toString())}}else ya.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:xb.a.z9c(Q.data.we)}),this.JHd()||(this.WRa("Failed to deserialize response"),this.d7c())}else ya.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.JHd()||(this.WRa("Unknown"),this.d7c())}Jmn(Q){Q&&Q.data?this.lPh(Q.data.status)||
(ya.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.WRa(Sn.a[Q.data.status]),this.d7c()):(ya.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.JHd()||(this.WRa("Unknown"),this.d7c()))}JHd(){if(!this.Lqe)return ya.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.Lqe=!0,this.yfa(),!0;ya.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}lPh(Q){ya.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
Q);return this.JHd()}BLb(){ya.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");ca.a.km(this.VJa,ca.a.zqa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}ALb(Q){let za=!1,hb=!1;l.AFrameworkApplication.K&&(za=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),hb=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ya.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,za);if(za&&hb){ya.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const Tb={};Tb[Ug.a.Pfc]="1";Tb[Ug.a.documentUrl]=Q;Tb[Ug.a.reason]=ah.a.S5f;l.AFrameworkApplication.lO().execute(zc=>{zc.sendMessage(Lh.a.kBb,Tb)})}else ca.a.km(Q,ca.a.zqa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}d6a(){this.Ri&&1===this.Ri.state||(this.xk=this.KWa(),this.xk.message=CommonUIStrings.l_CommentProgressTooltip,this.xk.zd=5,this.xk.ht=!1,this.xk.YK(CommonUIStrings.l_DefaultDialogTitle,null,null))}Yla(){this.xk&&(this.xk.close(),this.xk=null)}d7c(){this.Lp(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}zpo(){this.Lp(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Noo(){const Q=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.Lp(CommonUIStrings.l_SaveAsFileTooLargeTitle,Q,Gk.a.F3n)}Lp(Q,za,hb=Gk.a.J3n){ya.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",Q,za);this.Yla();1!==this.Ri.state&&this.LG().GOh(Q,za,hb)}Hoo(Q){ya.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
Q);switch(Q){case Qi.a.lle:this.zpo();break;case Qi.a.X3f:this.Noo();break;default:this.d7c()}}S3f(){"VersionHistory"===this.LOe&&this.ga.processAction(m.a.u3c,2)}WRa(Q){"VersionHistory"===this.LOe&&this.ga.Rb(m.a.ace,2,{["FailureReason"]:Q})}}Object(e.a)(Kl,"UploadToSharePointManager",null,[1972]);var Tm=c(648),rg=c(122);class ri{constructor(){this.Obb=this.zIe=this.qIe=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}yc(Q){this.W=Q;this.qIe=Tm.a.xp(Q.Sa("Common.IEventEmitter<Common.IGetMoreInfoResult>"));
this.zIe=Tm.a.xp(Q.Sa("Common.IEventEmitter<Common.IMruResult>"));this.Obb=Tm.a.xp(Q.Sa("Common.App.SharedFilePicker.ISharedFilePicker"));rg.Task.WAA.call(null,this.qIe,this.zIe,this.Obb).continueWith(()=>{this.mNn()})}mNn(){this.W.register(Dn,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Qd(()=>new Dn(l.AFrameworkApplication.K)).singleInstance();this.W.register(Kl,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Qd(()=>
new Kl(l.AFrameworkApplication.xa,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new qj.a).create(),()=>new nn,l.AFrameworkApplication.ta)).singleInstance();this.W.register(Ym,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Qd(()=>new Ym(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new nn,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),l.AFrameworkApplication.ta)).singleInstance();
this.W.register(Uf,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Qd(()=>new Uf(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new $b.a(()=>this.qIe.result),l.AFrameworkApplication.ta,()=>new Hl)).singleInstance();this.W.register(Ag,"Common.App.SaveToSharePoint.FileNameDialogFactory").Qd(()=>new Ag(l.AFrameworkApplication.K,l.AFrameworkApplication.xa,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.Ob,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new $b.a(()=>this.zIe.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Obb?this.Obb.result:null)).singleInstance();this.W.register(th,"Common.App.SaveToSharePoint.SaveToSharePointActor").Qd(()=>new th(l.AFrameworkApplication.K,l.AFrameworkApplication.xa,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>l.AFrameworkApplication.ta.ZLk)).singleInstance();l.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Ub()}static main(){K.a.instance.Gc(new ri)}}Object(e.a)(ri,"PackageManager",null,[1,2]);class Cf{}
Object(e.a)(Cf,"StringDifference",null,[1889]);class ne{constructor(Q,za){this.charCode=Q;this.description=za}}Object(e.a)(ne,"UBTableEntry",null,[]);class Fd{}new ne(8,"C0 Controls 1");new ne(9,"Horizontal tab (HT)");new ne(10,"Line feed (LF)");new ne(12,"C0 Controls 2");new ne(13,"Carriage return (CR)");new ne(31,"C0 Controls 3");new ne(32,"Space");new ne(47,"ASCII Punctuation and Symbols 1");new ne(57,"ASCII Digits");new ne(64,"ASCII Punctuation and Symbols 2");new ne(90,"Uppercase Latin Alphabet");
new ne(96,"ASCII Punctuation and Symbols 3");new ne(122,"Lowercase Latin Alphabet");new ne(127,"U+0000..U+007F Basic Latin");new ne(159,"C1 Controls");new ne(160,"NB Space");new ne(191,"Latin-1 Punctuation and Symbols");new ne(255,"U+0080..U+00FF Latin-1 Supplement");new ne(383,"U+0100..U+017F Latin Extended-A");new ne(591,"U+0180..U+024F Latin Extended-B");new ne(687,"U+0250..U+02AF IPA Extensions");new ne(767,"U+02B0..U+02FF Spacing Modifier Letters");new ne(879,"U+0300..U+036F Combining Diacritical Marks");
new ne(1023,"U+0370..U+03FF Greek and Coptic");new ne(1279,"U+0400..U+04FF Cyrillic");new ne(1327,"U+0500..U+052F Cyrillic Supplement");new ne(1423,"U+0530..U+058F Armenian");new ne(1535,"U+0590..U+05FF Hebrew");new ne(1791,"U+0600..U+06FF Arabic");new ne(1871,"U+0700..U+074F Syriac");new ne(1919,"U+0750..U+077F Arabic Supplement");new ne(1983,"U+0780..U+07BF Thaana");new ne(2047,"U+07C0..U+07FF NKo");new ne(2111,"U+0800..U+083F Samaritan");new ne(2143,"U+0840..U+085F Mandaic");new ne(2303,"U+08A0..U+08FF Arabic Extended-A");
new ne(2431,"U+0900..U+097F Devanagari");new ne(2559,"U+0980..U+09FF Bengali");new ne(2687,"U+0A00..U+0A7F Gurmukhi");new ne(2815,"U+0A80..U+0AFF Gujarati");new ne(2943,"U+0B00..U+0B7F Oriya");new ne(3071,"U+0B80..U+0BFF Tamil");new ne(3199,"U+0C00..U+0C7F Telugu");new ne(3327,"U+0C80..U+0CFF Kannada");new ne(3455,"U+0D00..U+0D7F Malayalam");new ne(3583,"U+0D80..U+0DFF Sinhala");new ne(3711,"U+0E00..U+0E7F Thai");new ne(3839,"U+0E80..U+0EFF Lao");new ne(4095,"U+0F00..U+0FFF Tibetan");new ne(4255,
"U+1000..U+109F Myanmar");new ne(4351,"U+10A0..U+10FF Georgian");new ne(4607,"U+1100..U+11FF Hangul Jamo");new ne(4991,"U+1200..U+137F Ethiopic");new ne(5023,"U+1380..U+139F Ethiopic Supplement");new ne(5119,"U+13A0..U+13FF Cherokee");new ne(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new ne(5791,"U+1680..U+169F Ogham");new ne(5887,"U+16A0..U+16FF Runic");new ne(5919,"U+1700..U+171F Tagalog");new ne(5951,"U+1720..U+173F Hanunoo");new ne(5983,"U+1740..U+175F Buhid");new ne(6015,"U+1760..U+177F Tagbanwa");
new ne(6143,"U+1780..U+17FF Khmer");new ne(6319,"U+1800..U+18AF Mongolian");new ne(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new ne(6479,"U+1900..U+194F Limbu");new ne(6527,"U+1950..U+197F Tai Le");new ne(6623,"U+1980..U+19DF New Tai Lue");new ne(6655,"U+19E0..U+19FF Khmer Symbols");new ne(6687,"U+1A00..U+1A1F Buginese");new ne(6831,"U+1A20..U+1AAF Tai Tham");new ne(7039,"U+1B00..U+1B7F Balinese");new ne(7103,"U+1B80..U+1BBF Sundanese");new ne(7167,"U+1BC0..U+1BFF Batak");
new ne(7247,"U+1C00..U+1C4F Lepcha");new ne(7295,"U+1C50..U+1C7F Ol Chiki");new ne(7375,"U+1CC0..U+1CCF Sundanese Supplement");new ne(7423,"U+1CD0..U+1CFF Vedic Extensions");new ne(7551,"U+1D00..U+1D7F Phonetic Extensions");new ne(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new ne(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new ne(7935,"U+1E00..U+1EFF Latin Extended Additional");new ne(8191,"U+1F00..U+1FFF Greek Extended");new ne(8303,"U+2000..U+206F General Punctuation");
new ne(8351,"U+2070..U+209F Superscripts and Subscripts");new ne(8399,"U+20A0..U+20CF Currency Symbols");new ne(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new ne(8527,"U+2100..U+214F Letterlike Symbols");new ne(8591,"U+2150..U+218F Number Forms");new ne(8703,"U+2190..U+21FF Arrows");new ne(8959,"U+2200..U+22FF Mathematical Operators");new ne(9215,"U+2300..U+23FF Miscellaneous Technical");new ne(9279,"U+2400..U+243F Control Pictures");new ne(9311,"U+2440..U+245F Optical Character Recognition");
new ne(9471,"U+2460..U+24FF Enclosed Alphanumerics");new ne(9599,"U+2500..U+257F Box Drawing");new ne(9631,"U+2580..U+259F Block Elements");new ne(9727,"U+25A0..U+25FF Geometric Shapes");new ne(9983,"U+2600..U+26FF Miscellaneous Symbols");new ne(10175,"U+2700..U+27BF Dingbats");new ne(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new ne(10239,"U+27F0..U+27FF Supplemental Arrows-A");new ne(10495,"U+2800..U+28FF Braille Patterns");new ne(10623,"U+2900..U+297F Supplemental Arrows-B");
new ne(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new ne(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new ne(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new ne(11359,"U+2C00..U+2C5F Glagolitic");new ne(11391,"U+2C60..U+2C7F Latin Extended-C");new ne(11519,"U+2C80..U+2CFF Coptic");new ne(11567,"U+2D00..U+2D2F Georgian Supplement");new ne(11647,"U+2D30..U+2D7F Tifinagh");new ne(11743,"U+2D80..U+2DDF Ethiopic Extended");new ne(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new ne(11903,"U+2E00..U+2E7F Supplemental Punctuation");new ne(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new ne(12255,"U+2F00..U+2FDF Kangxi Radicals");new ne(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new ne(12351,"U+3000..U+303F CJK Symbols and Punctuation");new ne(12447,"U+3040..U+309F Hiragana");new ne(12543,"U+30A0..U+30FF Katakana");new ne(12591,"U+3100..U+312F Bopomofo");new ne(12687,"U+3130..U+318F Hangul Compatibility Jamo");new ne(12703,"U+3190..U+319F Kanbun");new ne(12735,
"U+31A0..U+31BF Bopomofo Extended");new ne(12783,"U+31C0..U+31EF CJK Strokes");new ne(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new ne(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new ne(13311,"U+3300..U+33FF CJK Compatibility");new ne(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new ne(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new ne(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new ne(42127,"U+A000..U+A48F Yi Syllables");new ne(42191,"U+A490..U+A4CF Yi Radicals");
new ne(42239,"U+A4D0..U+A4FF Lisu");new ne(42559,"U+A500..U+A63F Vai");new ne(42655,"U+A640..U+A69F Cyrillic Extended-B");new ne(42751,"U+A6A0..U+A6FF Bamum");new ne(42783,"U+A700..U+A71F Modifier Tone Letters");new ne(43007,"U+A720..U+A7FF Latin Extended-D");new ne(43055,"U+A800..U+A82F Syloti Nagri");new ne(43071,"U+A830..U+A83F Common Indic Number Forms");new ne(43135,"U+A840..U+A87F Phags-pa");new ne(43231,"U+A880..U+A8DF Saurashtra");new ne(43263,"U+A8E0..U+A8FF Devanagari Extended");new ne(43311,
"U+A900..U+A92F Kayah Li");new ne(43359,"U+A930..U+A95F Rejang");new ne(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new ne(43487,"U+A980..U+A9DF Javanese");new ne(43615,"U+AA00..U+AA5F Cham");new ne(43647,"U+AA60..U+AA7F Myanmar Extended-A");new ne(43743,"U+AA80..U+AADF Tai Viet");new ne(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new ne(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new ne(44031,"U+ABC0..U+ABFF Meetei Mayek");new ne(55215,"U+AC00..U+D7AF Hangul Syllables");new ne(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new ne(56191,"U+D800..U+DB7F High Surrogates");new ne(56319,"U+DB80..U+DBFF High Private Use Surrogates");new ne(57343,"U+DC00..U+DFFF Low Surrogates");new ne(63743,"U+E000..U+F8FF Private Use Area");new ne(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new ne(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new ne(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new ne(65039,"U+FE00..U+FE0F Variation Selectors");new ne(65055,"U+FE10..U+FE1F Vertical Forms");new ne(65071,"U+FE20..U+FE2F Combining Half Marks");
new ne(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new ne(65135,"U+FE50..U+FE6F Small Form Variants");new ne(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new ne(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new ne(65535,"U+FFF0..U+FFFF Specials");new ne(65663,"U+10000..U+1007F Linear B Syllabary");new ne(65791,"U+10080..U+100FF Linear B Ideograms");new ne(65855,"U+10100..U+1013F Aegean Numbers");new ne(65935,"U+10140..U+1018F Ancient Greek Numbers");new ne(65999,"U+10190..U+101CF Ancient Symbols");
new ne(66047,"U+101D0..U+101FF Phaistos Disc");new ne(66207,"U+10280..U+1029F Lycian");new ne(66271,"U+102A0..U+102DF Carian");new ne(66351,"U+10300..U+1032F Old Italic");new ne(66383,"U+10330..U+1034F Gothic");new ne(66463,"U+10380..U+1039F Ugaritic");new ne(66527,"U+103A0..U+103DF Old Persian");new ne(66639,"U+10400..U+1044F Deseret");new ne(66687,"U+10450..U+1047F Shavian");new ne(66735,"U+10480..U+104AF Osmanya");new ne(67647,"U+10800..U+1083F Cypriot Syllabary");new ne(67679,"U+10840..U+1085F Imperial Aramaic");
new ne(67871,"U+10900..U+1091F Phoenician");new ne(67903,"U+10920..U+1093F Lydian");new ne(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new ne(68095,"U+109A0..U+109FF Meoritic Cursive");new ne(68191,"U+10A00..U+10A5F Kharoshthi");new ne(68223,"U+10A60..U+10A7F Old South Arabian");new ne(68415,"U+10B00..U+10B3F Avestan");new ne(68447,"U+10B40..U+10B5F Inscriptional Parthian");new ne(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new ne(68687,"U+10C00..U+10C4F Old Turkic");new ne(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new ne(69759,"U+11000..U+1107F Brahmi");new ne(69839,"U+11080..U+110CF Kaithi");new ne(69887,"U+110D0..U+110FF Sora Sompeng");new ne(69967,"U+11100..U+1114F Chakma");new ne(70111,"U+11180..U+111DF Sharada");new ne(71375,"U+11680..U+116CF Takri");new ne(74751,"U+12000..U+123FF Cuneiform");new ne(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new ne(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new ne(92735,"U+16800..U+16A3F Bamum Supplement");new ne(94111,"U+16F00..U+16F9F Miao");new ne(110847,
"U+1B000..U+1B0FF Kana Supplement");new ne(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new ne(119295,"U+1D100..U+1D1FF Musical Symbols");new ne(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new ne(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new ne(119679,"U+1D360..U+1D37F Counting Rod Numerals");new ne(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new ne(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new ne(127023,"U+1F000..U+1F02F Mahjong Tiles");
new ne(127135,"U+1F030..U+1F09F Domino Tiles");new ne(127231,"U+1F0A0..U+1F0FF Playing Cards");new ne(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new ne(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new ne(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new ne(128591,"U+1F600..U+1F64F Emoticons");new ne(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new ne(128895,"U+1F700..U+1F77F Alchemical Symbols");new ne(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new ne(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new ne(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new ne(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new ne(917631,"U+E0000..U+E007F Tags");new ne(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new ne(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new ne(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(e.a)(Fd,"UnicodeBlocks",null,[1887]);class zj{constructor(){this.W=
null}yc(Q){this.W=Q;this.W.register(Cf,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").singleInstance();this.W.register(Fd,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").singleInstance()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){K.a.instance.Gc(new zj)}}
Object(e.a)(zj,"SensitiveLoggingPackage",null,[1,2]);var Xd;(function(Q){Q[Q.myFiles=0]="myFiles";Q[Q.recent=1]="recent";Q[Q.currentFolder=2]="currentFolder";Q[Q.yourPhone=3]="yourPhone"})(Xd||(Xd={}));Object(e.b)("SharedFilePickerLandingLocation",Xd);class Th{constructor(Q){this.UEb=this.mfc=null;this._initialized=!1;this.Rvf=Q}Iff(Q){this._initialized||(Q.pv(Lh.a.S0i),Q.uB(Lh.a.S0i,Object(a.a)(this,this.Jln,"onReceivedPickerResponse")),this._initialized=!0)}KNd(Q){return this.UEb=new Promise((za,
hb)=>{const Tb={};Tb[Ug.a.Svn]=Q;this.mfc=(zc,kd)=>{""===kd?(ya.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),za(zc)):("Canceled"===kd?ya.ULS.sendTraceTag(572548164,306,50,kd):ya.ULS.sendTraceTag(556901065,306,10,kd),hb(kd))};this.Rvf.execute(zc=>{this.Iff(zc);zc.sendMessage(Lh.a.mqn,Tb)})})}Jln(Q){this.mfc(Q.Values[Ug.a.r6n],void 0===Q.Values[Ug.a.lWf]||null===Q.Values[Ug.a.lWf]?"":Q.Values[Ug.a.lWf])}EDf(){return l.AFrameworkApplication.K.$("UiHostCommonFilePicker")}m9e(Q,
za,hb,Tb,zc,kd,ce,df,bf=null){const Vf={};Vf[Ug.a.S5n]=Q;Vf[Ug.a.titleText]=za;Vf[Ug.a.Euk]=hb;Vf[Ug.a.Fuk]=Tb;Vf[Ug.a.Huk]=zc;Vf[Ug.a.phl]=!0;Vf[Ug.a.Dtl]=kd;Vf[Ug.a.Wvn]=ce;Vf[Ug.a.Vvn]=Xd[df];F.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Vf[Ug.a.Xvn]="Dark");bf&&(null!=bf.F_b&&(Vf[Ug.a.F_b]=bf.F_b),null!=bf.S8b&&(Vf[Ug.a.S8b]=bf.S8b));return Vf}}Object(e.a)(Th,"SharedFilePickerManager",null,[1888]);class Pf{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}yc(Q){this.W=
Q;Q.register(Th,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").singleInstance().Qd(()=>new Th(Q.Sa("Postmessage.IHostPostmessenger")))}init(){l.AFrameworkApplication.K.Wo(()=>{this.x1a()})}x1a(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){K.a.instance.Gc(new Pf)}}Object(e.a)(Pf,"SharedFilePickerPackage",null,[1,2]);class rj extends Sys.EventArgs{constructor(){super()}}Object(e.a)(rj,"TypingSpeedMeterChangedEventArgs",
Sys.EventArgs,[]);class En{}Object(e.a)(En,"TypingSpeedMeterWindow",null,[]);class lg{constructor(Q,za){new M.a;this.vz=Q;this.pi=za;this.pi.eYe(Object(a.a)(this,this.L4d,"onCpuMeterFrameAvailable"))}L4d(){}dispose(){this.pi.L5i(Object(a.a)(this,this.L4d,"onCpuMeterFrameAvailable"))}}Object(e.a)(lg,"TypingSpeedMeter",null,[1912]);class al{constructor(Q){this.Nvd=null;this.Qp=new z.a;this.vz=Q}initialize(Q,za,hb,Tb){this.Nvd||(this.Nvd=new lg(this.vz,Q,za,hb,Tb),this.Qp.xg(this.Nvd));return this.Nvd}}
Object(e.a)(al,"TypingSpeedMeterProvider",null,[1886]);class Dh{constructor(){this.UTe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(l.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const Q=pa.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),za=Tm.a.xp(pa.a.instance.Sa("Common.ICpuMeterProvider"));za.continueWith(()=>{const hb=za.result.Qp.task;var Tb=new Ca.a(l.AFrameworkApplication.K.pc("TypingSpeedMeterWindowSamplingPercent",0)/100);Tb=new fa.a(Object(a.a)(Tb,
Tb.zNb,"shouldBeInSample"));const zc=Ba.a.GE(12,1,Tb),kd=l.AFrameworkApplication.K.pc("TypingSpeedMeterWindowTimeoutMs",5E3),ce=l.AFrameworkApplication.K.pc("TypingSpeedMeterMaxKeystrokesPerWindow",5);hb.CWR(()=>this.UTe=Q.initialize(hb.result,zc,kd,ce))})}}dispose(){this.UTe&&this.UTe.dispose()}yc(Q){Q.register(al,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").singleInstance().Qd(()=>new al(ca.a.Ue))}static main(){K.a.instance.Gc(new Dh)}}Object(e.a)(Dh,
"TypingSpeedMeterPackage",null,[1,2]);class Fi{constructor(){this.events=[];this.U3f=!1}static pFf(Q){return Q.ctrlKey&&"Control"!==Q.key||Q.altKey&&"Alt"!==Q.key||!!Fi.vOm[Q.key]}static QGk(Q,za){let hb;hb=Fi.pFf(Q)?Q.key:" "===Q.key?"Space":"CharacterKey";return null!=za?(za.altPressed=(!!Q.altKey).toString(),za.ctrlPressed=(!!Q.ctrlKey).toString(),za.key=hb,za.repeat=(!!Q.repeat).toString(),za.shiftPressed=(!!Q.shiftKey).toString(),za):{["altPressed"]:(!!Q.altKey).toString(),["ctrlPressed"]:(!!Q.ctrlKey).toString(),
["key"]:hb,["repeat"]:(!!Q.repeat).toString(),["shiftPressed"]:(!!Q.shiftKey).toString()}}static Rvi(Q){return window.performance&&window.performance.now&&Q.timeStamp<performance.now()}static yTh(Q){return!!Q&&Fi.Rvi(Q)&&Fi.pFf(Q)}static zTh(Q){return!!Q&&Fi.Rvi(Q)&&!Fi.pFf(Q)}keyPressedEventHandlerStart(Q,za){Fi.zTh(Q)&&this.Uoj(Q,za)}keyPressedEventHandlerEnd(Q){Fi.zTh(Q)&&this.Apj(Q)}keyDownEventHandlerStart(Q,za){Fi.yTh(Q)&&this.Uoj(Q,za)}keyDownEventHandlerEnd(Q){Fi.yTh(Q)&&this.Apj(Q)}Uoj(Q,
za){Q={["metadata"]:Fi.QGk(Q,za),["timeStamp"]:this.Qkc(Q.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.Qkc(performance.now()-Q.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(Q);this.sQn()}Apj(Q){if(0!==this.events.length){var za=this.Qkc(Q.timeStamp);for(let hb=this.events.length-1;0<=hb;--hb){const Tb=this.events[hb];if(Tb.timeStamp===za){Tb.timeToHandlerFinishMs=this.Qkc(performance.now()-Q.timeStamp);Tb.eventDurationMs=this.Qkc(Tb.timeToHandlerFinishMs-
Tb.timeToHandlerStartMs);break}}}}Qkc(Q){return Number(Q.toFixed(2))}sQn(){if(!this.U3f){const Q=document.createEvent("CustomEvent");Q.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(Q);requestAnimationFrame(()=>{this.U3f=!1;const za=performance.now();this.events.forEach(Tb=>{Tb.timeToRequestAnimationFrameMs=this.Qkc(za-Tb.timeStamp)});var hb=document.createEvent("CustomEvent");hb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(hb);this.events=
[];hb=document.createEvent("CustomEvent");hb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(hb)});this.U3f=!0}}}Fi.vOm={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class Ri{constructor(){this.bce=this.y3a=this.aQa=this.kcc=null;this.zac=!1;this.igc=null;this.wLc=[];this.p$c=()=>{Ri.eHm()&&null==this.y3a?(this.aQa=null,this.y3a=requestAnimationFrame(this.lXc)):
null!=this.y3a&&(cancelAnimationFrame(this.y3a),this.y3a=null)};this.lXc=Q=>{if(null!=this.aQa){const za=Q-this.aQa;if(null==this.kcc||this.kcc<za)this.kcc=za;for(let hb=0;hb<Ri.ranges.length;++hb)if(za<Ri.ranges[hb]){++this.wLc[hb];break}}this.aQa=Q;this.y3a=requestAnimationFrame(this.lXc)};this.q7i=()=>{if(null!=this.kcc){var Q={};for(var za=0;za<Ri.ranges.length;++za)Q[Ri.ranges[za]]=this.wLc[za],this.wLc[za]=0;za=performance.now();Q={["intervalStart"]:this.igc,["intervalEnd"]:za,["maxFrameLengthMs"]:this.kcc,
["frameData"]:Q};var hb=document.createEvent("CustomEvent");hb.initCustomEvent("reportframetiming",!1,!1,Q);dispatchEvent(hb);this.kcc=null;this.igc=za}}}static ICf(){return!!window.performance&&!!window.performance.now}start(Q){!this.zac&&Ri.ICf()&&(this.gio(),this.bce=setInterval(this.q7i,1E3*Q),this.igc=performance.now(),this.p$c(),document.addEventListener("visibilitychange",this.p$c),this.zac=!0)}stop(){this.zac&&(document.removeEventListener("visibilitychange",this.p$c),null!=this.bce&&(clearInterval(this.bce),
this.bce=null),null!=this.y3a&&(cancelAnimationFrame(this.y3a),this.y3a=null),this.q7i(),this.zac=!1)}get gUc(){return this.zac}gio(){this.wLc=[];for(let Q=0;Q<Ri.ranges.length;++Q)this.wLc.push(0)}}Ri.eHm=()=>"visible"===document.visibilityState;Ri.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class Ll{create(Q){return new Ca.a(Q)}}Object(e.a)(Ll,"RandomSamplerFactory",null,[888]);var Pe=c(11),ib=c(1401);class Ib{constructor(Q,za,hb,Tb,zc){Q.Smh(()=>{Tb.n3c()});Q.anh((kd,
ce)=>{Tb.l3c(ce.revisionId,ce.U3a)});Q.vyd((kd,ce)=>{Tb.Wnm(ce.C9i,ce.U3a,ce.Qsj)});Q.brk(()=>{Tb.J3f()});za.Ark((kd,ce)=>{Tb.oCo(ce.d7i,ce.Qje,ce.actualValue)});za.oqk((kd,ce)=>{Tb.nCo(ce.d7i,ce.Qje,ce.actualValue)});zc.HCc(()=>{Tb.U9c()});hb.t2((kd,ce)=>{6===ce.type&&Tb.Mgc(ce.dL)})}}Object(e.a)(Ib,"EventForwarder",null,[]);class fc{constructor(Q,za,hb){this.j6j=Q;this.YM=hb;this.RYb=za}create(Q,za){return new Ib(this.j6j,this.RYb,Q,za,this.YM)}}Object(e.a)(fc,"EventForwarderFactory",null,[]);var Cc=
c(474);class Jc{}Jc.DIo="TypingToOutboundReplicationStart";Jc.Tqn="OutboundReplicationStartToOutboundReplicationEnd";Jc.z$i="RtcNotificationToInboundReplicationEnd";Jc.Rwj="TypingToInboundReplicationEnd";Object(e.a)(Jc,"PerfTrackerPhases",null,[]);class pd{constructor(Q,za,hb,Tb,zc,kd,ce,df,bf=null){this.L1g=!1;this.lJe=5;this.h3g=50;this.MHe=20;this.lGe=this.xHe=this.Yya=null;this.Hpc=this.xpc=0;this.dRe=this.nSe=!1;this.Gud=Array(7);this.Wmc=null;this.jUg=!1;this.cte=null;this.wha={};this.Ijd=Q;
this.MUa=za;this.M4j=hb;this.ZVg=Tb.create(Jc.z$i,zc,kd,20,!1);this.Ovd=Tb.create(Jc.Rwj,ce,df,20,!0);if(this.Na=l.AFrameworkApplication.K)this.L1g=this.Na.$("LogSteppedInboundFrameIsEnabled"),this.MHe=this.Na.pc("InboundFrameMaxNumberOfLongRunningTasks",20),this.h3g=this.Na.pc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.lJe=this.Na.pc("InboundFrameNumberOfLastShortTasks",5);this.Tqb=bf}get $Ok(){null==this.cte&&(this.cte=!!this.Na&&this.Na.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));
return this.cte}initialize(Q){this.Yya=Q}dYn(Q,za,hb=null){this.dAh();ya.ULS.shipAssertTag(8229761,324,0<Q.length);let Tb=!1;for(const kd of Q){const ce=kd.toString();if(ce in this.wha){var zc=this.wha[ce];if(!zc.thc){zc.mdj(Q,za,hb);if(Tb)this.nEi(kd.toString(),zc,null,null,this.Gud,null);else{const df=this.Mrl(),bf=this.LCl(this.Wmc);Tb=!0;this.nEi(kd.toString(),zc,df,this.lGe,this.Gud,bf)}delete this.wha[ce]}}else zc=this.Ijd.create(this.ZVg,this.Ovd),zc.mdj(Q,za),this.wha[ce]=zc}this.dRe=!1}Mgc(Q){ya.ULS.shipAssertTag(8257930,
304,Q.dzi,"Expected data not sent on the wire");if(Q.dzi){if(Q.Fce in this.wha){var za=this.wha[Q.Fce];za.Uce||(za.Mgc(Q.revisionId,Q.aTi,Q.skj,Q.U3a),delete this.wha[Q.Fce])}else za=this.Ijd.create(this.ZVg,this.Ovd),za.Mgc(Q.revisionId,Q.aTi,Q.skj,Q.U3a),this.wha[Q.Fce]=za;this.dAh()}}Lpm(){this.nSe||(this.xHe=Array(this.MHe),this.lGe=Array(this.lJe),this.Hpc=this.xpc=0,this.Gud=[0,0,0,0,0,0,0,0],this.Wmc=Array(3),this.Wmc[1]=[0,0],this.Wmc[2]=[0,0],this.nSe=!0)}Ylo(Q){return!Q.TP&&Q.TN===ja.a.Y6i&&
(Q=Cc.a(this.wha))&&Q[0]?!0:!1}vgn(Q){this.nSe=!1;const za=Cc.a(this.wha);za&&za[0]&&(Q.TRT>=this.h3g&&this.xpc<this.MHe?this.xHe[this.xpc++]=Q:(this.lGe[this.Hpc]=Q,this.Hpc=this.Hpc<this.lJe-1?this.Hpc+1:0),this.O0m(Q),this.h1m(Q))}ugn(){this.Lpm();this.dRe=!0}O0m(Q){this.Gud[Q.TP]++}h1m(Q){if(Q&&Q.UI){const za=this.Wmc[Q.UI];za[0]+=1;za[1]+=Q.TRT}}LCl(Q){const za={};Q&&(Q[1]&&(za.Typing=Q[1]),Q[2]&&(za.Clicking=Q[2]));return za}Mrl(){return this.xpc?this.xHe.slice(0,this.xpc-1):null}dAh(){var Q=
Cc.a(this.wha);if(Q&&(this.jUg||this.U1m(Q),Q.length>this.M4j))for(const za of Q){Q=this.wha[za];const hb=Q.createdTime,Tb=this.MUa();6E4<Tb-hb&&(H.b(8438528,304,50,"{0}",{["Not Received"]:Q.thc?"RtcNotification":"ServerRevision",["Duration"]:Tb-hb}),Q.thc||H.b(42075798,304,15,"{0}",{["RevisionId"]:za,["Duration"]:Tb-hb}),delete this.wha[za])}}U1m(Q){if(this.$Ok&&this.Tqb)for(const za of Q)if(Q=this.wha[za],Q.Uce&&!Q.thc&&(Q=Q.createdTime,2E3<this.MUa()-Q)){let hb=null;Pe.App.ya&&Pe.App.ya.jb&&Pe.App.ya.jb.Wc&&
(hb=Pe.App.ya.jb.Wc.contentReplicator);this.Tqb.execute(Tb=>{Tb.flush(hb,1)});this.jUg=!0}}nEi(Q,za,hb,Tb,zc,kd){this.L1g&&(za=za.tCl())&&(za.RevisionId=Q,za.LRTWR=hb,za.LSTWR=Tb,za.TSD=zc,za.UIWR=kd,this.Yya&&this.Yya.track(za))}}Object(e.a)(pd,"InboundMonitor",null,[1977]);class ge{constructor(Q,za,hb,Tb){this.$C=za;this.Ijd=hb;this.Hfk=Tb}create(Q,za,hb,Tb,zc=null){return new pd(this.Ijd,this.$C,50,this.Hfk,Q,za,hb,Tb,zc)}}Object(e.a)(ge,"InboundMonitorFactory",null,[1940]);var pe=c(323);class ke{}
ke.Eme="UserCount";ke.z1n="RevisionChainLength";Object(e.a)(ke,"PerfTrackerPivotNames",null,[]);class Qf{}Object(e.a)(Qf,"PerfTrackingContext",null,[]);const Hg=Q=>5>=Q?"5AndFewer":10>=Q?"6To10":15>=Q?"11To15":20>=Q?"15To20":25>=Q?"21To25":30>=Q?"26To30":"31AndAbove";class gc{}Object(e.a)(gc,"SteppedInboundFrame",null,[]);class nh{constructor(Q,za,hb,Tb,zc){this.Xab=this.Kjd=null;this.UVg=500;this.Jjd=this.Kra=this.ctb=this.tUb=this.bcd=-1;this.rsg=null;this.wbh=this.oah=!1;this.S$g=null;this.J6g=
this.ZKa=0;this.JWb=Q;this.createdTime=za();this.gtd=!1;this.yKe=0;this.Iub=hb;this.V_j=Tb;this.Ovd=zc;l.AFrameworkApplication.K&&(this.UVg=l.AFrameworkApplication.K.pc("InboundFrameSamplingMinimalTotalTimeMs",500))}get Uce(){return this.oah}get thc(){return this.wbh}get D9i(){return this.S$g}get U3a(){return this.ZKa}get Sqn(){return this.J6g}get vBb(){return this.Iub()}Mgc(Q,za,hb,Tb){this.Uce||(this.gtd=hb,this.yKe=za,this.bcd=Y.a.GU(ca.a.Ue(),2),this.rsg=(new Date).toISOString(),this.Xab=Q,this.J6g=
Tb,this.oah=!0,this.thc?this.aSh():(this.Woj(),wa.a.instance.My(Q.toString()+"Start"),pe.a.instance.Z1d(2)))}mdj(Q,za,hb=null){this.thc||(this.ZKa=za,this.wbh=!0,this.S$g=Q,this.Jjd=Y.a.GU(ca.a.Ue(),2),this.Uce&&(wa.a.instance.My(this.Xab.toString()+"End"),hb&&(this.tUb=hb.kZn,this.ctb=hb.b5a,this.Kra=hb.eYn),pe.a.instance.xCd(),this.aSh()))}tCl(){if(!(0<this.bcd&&0<this.tUb&&0<this.ctb&&0<this.Kra&&0<this.Jjd))return null;const Q=new gc;Q.TT=Y.a.GU(this.Jjd-this.bcd,2);if(Q.TT<this.UVg)return null;
Q.ST=this.rsg;Q.UC=this.vBb;Q.RS=Y.a.GU(this.tUb-this.bcd,2);Q.SR=Y.a.GU(this.ctb-this.tUb,2);Q.RRS=Y.a.GU(this.Kra-this.ctb,2);Q.RP=Y.a.GU(this.Jjd-this.Kra,2);Q.ResponseLanded=Y.a.GU(this.ctb,2);0<Q.RS?(wa.a.instance.cY("RTCToRequestSent",this.Xab.toString()+"Start","RequestInvoked"+this.tUb),wa.a.instance.cY("RequestSentToResponseReceived","RequestInvoked"+this.tUb,"RequestCompleted"+this.ctb),wa.a.instance.cY("ResponseReceivedToReplicationStart","RequestCompleted"+this.ctb,"ReplicationStart"+
this.Kra)):wa.a.instance.cY("RTCToReplicationStart",this.Xab.toString()+"Start","ReplicationStart"+this.Kra);wa.a.instance.cY("Replication","ReplicationStart"+this.Kra,this.Xab.toString()+"End");return Q}Woj(){this.Kjd=this.JWb.create();this.Kjd.start(Jc.z$i,Jc.Rwj)}aSh(){this.Kjd||this.Woj();const Q=this.Kjd.end(this.gtd,this.q6k());this.V_j.$be(Q);this.Ovd.$be(Q+this.yKe)}q6k(){const Q={};Q[ke.Eme]=Hg(this.vBb);var za=this.D9i.length;Q[ke.z1n]=9>=za?za.toString():"10AndAbove";return Object.assign(new Qf,
{P:Q,FC:this.U3a,CFC:this.Sqn+this.U3a,ID:this.Xab.toString(),CD:this.yKe,UC:this.vBb,RCL:this.D9i.length})}}Object(e.a)(nh,"InboundOperation",null,[1978]);class Yd{constructor(Q,za,hb){this.LJa=Q;this.MUa=za;this.Iub=hb}create(Q,za){return new nh(this.LJa,this.MUa,this.Iub,Q,za)}}Object(e.a)(Yd,"InboundOperationFactory",null,[1941]);class Nk{constructor(Q,za,hb,Tb,zc,kd,ce,df,bf){this.htd=!0;this.I7g=this.Spd=null;this.LO=Vf=>{this.nj.LO(6,Vf)};this.xKe=Q;this.iWj=za;this.g9j=hb;this.nj=Tb;this.VTe=
zc.create("TypingToOutboundReplicationStart",kd,ce,20,!1);this.zNe=zc.create("OutboundReplicationStartToOutboundReplicationEnd",df,bf,20,!1)}get SVf(){return this.Spd}get h8d(){return this.I7g}U9c(){!this.SVf&&this.htd&&(this.htd=this.iWj())&&(this.Spd=this.xKe.create(this.LO,this.g9j(),this.VTe,this.zNe),this.SVf.U9c())}n3c(){this.htd=!0;this.I7g=this.SVf;this.h8d&&(this.Spd=null,this.h8d.n3c())}J3f(){this.Spd=null}l3c(Q,za){this.h8d&&this.h8d.l3c(Q,za)}}Object(e.a)(Nk,"OutboundMonitor",null,[]);
class Jj{constructor(Q,za){this.xKe=Q;this.a8j=za}create(Q,za,hb,Tb,zc,kd,ce){return new Nk(this.xKe,Q,za,hb,this.a8j,Tb,zc,kd,ce)}}Object(e.a)(Jj,"OutboundMonitorFactory",null,[]);var gj=c(60);class eh{constructor(Q){this.kbb=Q}get eIn(){return this.kbb}ob(Q){return!!this.kbb&&Q in this.kbb}get dzi(){return this.ob(eh.lId)&&this.ob(eh.nMb)&&this.ob(eh.oag)}get revisionId(){if(this.ob(eh.nMb))return gj.a.Gf(this.kbb[eh.nMb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");
}get Fce(){if(this.ob(eh.nMb))return this.kbb[eh.nMb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get aTi(){if(this.ob(eh.lId))return Number.parseInvariant(this.kbb[eh.lId]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get skj(){if(this.ob(eh.nMb))return Boolean.parse(this.kbb[eh.oag]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get U3a(){if(this.ob(eh.VOf))return Number.parseInvariant(this.kbb[eh.VOf]);
throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static I3k(Q){return new eh(Q)}static N3k(Q,za,hb,Tb){const zc={};zc[eh.lId]=Q.toString();zc[eh.nMb]=za.toString();zc[eh.oag]=hb.toString();zc[eh.VOf]=Tb.toString();return new eh(zc)}}eh.nMb="RevisionID";eh.lId="Duration";eh.oag="ShouldSample";eh.VOf="NumSequentialFailures";Object(e.a)(eh,"ReplicationNotificationMessage",null,[1974]);class Eh{constructor(Q,za,hb,Tb,zc,kd,ce){this.Mr=this.Bi=0;this.Xub=this.nBc=
null;this.jqe=[];this.K8g=null;this.Zgd={};this.ZKa=0;this.JWb=Q;this.Bbk=za;this.MUa=hb;this.Iub=Tb;this.tch=zc;this.Xab=null;this.Zgd.TypingStartStage=null;this.Zgd.ReplicationStartStage="TypingStartStage";this.Zgd.ReplicationEndStage="ReplicationStartStage";this.Sgh=1<this.vBb;this.VTe=kd;this.zNe=ce}get vBb(){return this.Iub()}U9c(){this.B4e("TypingStartStage")&&(this.G0f("TypingStartStage"),ya.ULS.shipAssertTag(8257931,324,!this.Xub&&!this.Mr,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),
this.Bi=this.MUa(),this.nBc=this.JWb.create(),this.Moj(this.nBc,Jc.DIo))}n3c(){if(this.B4e("ReplicationStartStage")){this.G0f("ReplicationStartStage");ya.ULS.shipAssertTag(8257932,324,!!this.nBc,"TypingStart not called");if(this.nBc){const Q=this.WRh(this.nBc,this.Xab);this.VTe.$be(Q)}this.Xub=this.JWb.create();this.Moj(this.Xub,Jc.Tqn)}}l3c(Q,za){this.B4e("ReplicationEndStage")&&(this.G0f("ReplicationEndStage"),this.Mr=this.MUa(),this.ZKa=za,ya.ULS.shipAssertTag(8257933,324,!!this.Xub,"ReplicationStart not called"),
this.Xub&&(ya.ULS.shipAssertTag(8193425,324,!!this.Xub,"ReplicationStart not called"),za=this.WRh(this.Xub,Q),this.zNe.$be(za)),ya.ULS.shipAssertTag(8257934,324,!!this.Bi,"StartTime not set. No message sent to other editors."),this.Bi&&(Q=eh.N3k(this.Mr-this.Bi,Q,this.tch,this.ZKa),this.Bbk(Q.eIn)))}B4e(Q){if(this.Zgd[Q]===this.K8g)return!0;ya.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.ujk()});return!1}ujk(){const Q=new Sys.StringBuilder;Q.append("Actual Phase:");for(let za=
0;za<this.jqe.length;za++)Q.append(" "+this.jqe[za]);return Q.toString()}G0f(Q){this.jqe.push(Q);this.K8g=Q}Moj(Q,za){this.Sgh&&Q.start(za)}WRh(Q,za){if(!this.Sgh)return-1;const hb={};hb[ke.Eme]=Hg(this.vBb);za=Object.assign(new Qf,{P:hb,FC:this.ZKa,CFC:0,ID:za?za.toString():"",CD:0,UC:this.vBb,RCL:0});return Q.end(this.tch,za)}}Object(e.a)(Eh,"OutboundOperation",null,[1976]);class sg{constructor(Q,za,hb){this.JWb=Q;this.MUa=za;this.Iub=hb}create(Q,za,hb,Tb){return new Eh(this.JWb,Q,this.MUa,this.Iub,
za,hb,Tb)}}Object(e.a)(sg,"OutboundOperationFactory",null,[1939]);class Ea{constructor(Q,za){this.gMg=this._name=this.f2=null;this.ge=Q;this.Yya=za}start(Q,za=null){this.f2=this.ge.eg("UserAction",Q);this._name=Q;this.gMg=za}end(Q,za){let hb=-1;Q&&(hb=this.f2.ri,za.D=hb,za.CN=this.gMg,za.CD+=hb,this.Yya.track(za,this._name));return hb}}Object(e.a)(Ea,"PerfTracker",null,[1975]);class yb{constructor(Q,za){this.ge=Q;this.Yya=za}create(){return new Ea(this.ge,this.Yya)}}Object(e.a)(yb,"PerfTrackerFactory",
null,[1938]);class kc{constructor(Q,za,hb){this.jxc=null;this.$7j=Q;this.YVg=za;this.h9g=hb}init(Q,za,hb,Tb,zc,kd,ce){za=this.h9g.create(za/100);hb=this.h9g.create(hb/100);this.jxc=this.$7j.create(Object(a.a)(za,za.zNb,"shouldBeInSample"),Object(a.a)(hb,hb.zNb,"shouldBeInSample"),Q,Tb,zc,kd,ce)}U9c(){this.jxc.U9c()}n3c(){this.jxc.n3c()}J3f(){this.jxc.J3f()}l3c(Q,za){this.jxc.l3c(Q,za)}Wnm(Q,za,hb=null){this.YVg.dYn(Q,za,hb)}Mgc(Q){Q=eh.I3k(Q);this.YVg.Mgc(Q);wa.a.instance.My(Q.revisionId+"Start")}oCo(Q,
za,hb){H.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.lFd(Q,za,hb))}nCo(Q,za,hb){H.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.lFd(Q,za,hb))}lFd(Q,za,hb){const Tb={};Tb.PhaseName=Q;Tb.ThresholdValue=za;Tb.ActualValue=hb;return Tb}}Object(e.a)(kc,"ReplicationTelemetryManager",null,[]);var Rc=c(948);class Xc extends Rc.a{constructor(Q,za){super(Q,za);this.fj=this.eud=0}uxa(Q){this.eud+=Q;this.fj++}getValue(){return this.fj?this.eud/
this.fj:0}$Ra(){this.fj=this.eud=0}}Object(e.a)(Xc,"AverageMetric",Rc.a,[]);class yd extends Rc.a{constructor(Q,za){super(Q,za);this.e6=0}uxa(Q){Q>this.e6&&(this.e6=Q)}getValue(){return this.e6}$Ra(){this.e6=0}}Object(e.a)(yd,"MaxMetric",Rc.a,[]);var gf=c(1863);class vc extends Rc.a{constructor(Q,za,hb=100){super(Q,za);this.fnd=this.fWb=this.DYb=0;this.Vrd=hb;this.qOe=new gf.a(this.Vrd)}uxa(Q){if(this.fWb===this.Vrd){const za=this.qOe.dequeue();this.DYb-=za;this.fWb--}this.qOe.enqueue(Q);this.DYb+=
Q;this.fWb++;Q=this.DYb/this.fWb;Q>this.fnd&&this.fWb===this.Vrd&&(this.fnd=Q)}getValue(){return this.fnd}$Ra(){this.fnd=0;this.qOe=new gf.a(this.Vrd);this.fWb=this.DYb=0}}Object(e.a)(vc,"MaxRollingAverageMetric",Rc.a,[]);class Le extends Rc.a{constructor(Q,za){super(Q,za);this.fj=0}uxa(){this.fj++}getValue(){return this.fj}$Ra(){this.fj=0}}Object(e.a)(Le,"CounterMetric",Rc.a,[]);class id{constructor(Q,za){this.CZb=za;this.Cre=new Xc(Q+"-AverageValue","Milliseconds");this.KHe=new yd(Q+"-MaxValue",
"Milliseconds");this.RHe=new vc(Q+"-MaxRollingAverageValue","Milliseconds");this.Pue=new Le(Q+"-NumberOfEvents","Count");this.gsa=new eb.a(Q+"-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.yT("CoAuthLatencySlowTargetValue",3E3),l.AFrameworkApplication.K.yT("CoAuthLatencySlowThresholdPercentile",95),this.CZb);this.ELe=new eb.a(Q+"-BrokenSlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.yT("CoAuthLatencyBrokenSlowTargetValue",5E3),l.AFrameworkApplication.K.yT("CoAuthLatencyBrokenSlowThresholdPercentile",
95),this.CZb)}d0(Q){this.Cre.uxa(Q);this.KHe.uxa(Q);this.RHe.uxa(Q);this.Pue.uxa(Q);this.gsa.uxa(Q);this.ELe.uxa(Q)}Dae(){this.Cre.ERa();this.KHe.ERa();this.RHe.ERa();this.Pue.ERa();this.gsa.ERa();this.ELe.ERa();this.Cre.$Ra();this.KHe.$Ra();this.RHe.$Ra();this.Pue.$Ra();this.gsa.$Ra();this.ELe.$Ra()}}Object(e.a)(id,"ReplicationLatencyMetrics",null,[]);class Gi{constructor(){this.yGe=new Zb.a}G1i(Q,za,hb){if(!(0>za)){if(!({value:Tb}=this.yGe.Ec(Q,Tb)).returnValue){var Tb=new id(Q,hb);this.yGe.Z(Q,
Tb)}Tb.d0(za)}}Dae(){for(const Q of this.yGe.values)Q.Dae()}}Object(e.a)(Gi,"ReplicationTelemetryMetricsManager",null,[1907]);class Oh{G1i(){}Dae(){}}Object(e.a)(Oh,"ReplicationTelemetryMetricsManagerStub",null,[1907]);class Yg{constructor(Q,za,hb,Tb,zc,kd,ce){this.IXa=this.xvd=0;this.l5j=Q;this.HLe=hb;this.afh=Tb;this.VIg=zc;this.RYb=za;this.m5j=kd;this.CZb=ce}$be(Q){this.l5j.G1i(this.HLe,Q,this.CZb);Q>this.afh&&this.RYb.XBo(this.HLe,this.afh,Q);this.xvd+=Q;this.IXa++;this.xvd/this.IXa>this.VIg&&
this.IXa>this.m5j&&this.RYb.XBk(this.HLe,this.VIg,this.xvd/this.IXa)}}Object(e.a)(Yg,"TimeSpanVerifier",null,[1918]);class xi{constructor(Q,za){this.hak=Q;this.RYb=za}create(Q,za,hb,Tb,zc){return new Yg(this.hak,this.RYb,Q,za,hb,Tb,zc)}}Object(e.a)(xi,"TimeSpanVerifierFactory",null,[1906]);class Dj extends Sys.EventArgs{constructor(Q,za,hb){super();this.d7i=Q;this.Qje=za;this.actualValue=hb}}Object(e.a)(Dj,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class Ml{constructor(){this.ra=new M.a}XBo(Q,
za,hb){this.ra.raiseEvent("TSVTE",new Dj(Q,za,hb))}XBk(Q,za,hb){this.ra.raiseEvent("TSVATE",new Dj(Q,za,hb))}Ark(Q){this.ra.addHandler("TSVTE",Q)}oqk(Q){this.ra.addHandler("TSVATE",Q)}}Object(e.a)(Ml,"TimeSpanVerifierNotifier",null,[1883]);class Kn{constructor(){this.W=this.Na=null}get name(){return"Box4.ReplicationTelemetry"}yc(Q){this.Na=Q.resolve("Common.IAppSettingsManager");this.W=Q;if(this.Na.$("Box4ReplicationTelemetryIsEnabled")){Q.ha("ReplicationTelemetry.IPerfTrackerFactory",()=>new yb(Pe.App.ya.xq,
Ba.a.GE(20,1,new Pa.a))).singleInstance();Q.ha("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new Ml).singleInstance();this.Na.$("Box4ReplicationTelemetryMetricsIsEnabled")?Q.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new Gi).singleInstance():Q.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new Oh).singleInstance();Q.ha("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new xi(Q.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).singleInstance();
Q.ha("ReplicationTelemetry.OutboundOperationFactory",()=>new sg(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Kn.c4h)).singleInstance();Q.ha("ReplicationTelemetry.OutboundMonitorFactory",()=>new Jj(Q.resolve("ReplicationTelemetry.OutboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).singleInstance();Q.ha("ReplicationTelemetry.InboundOperationFactory",()=>new Yd(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),
Kn.c4h)).singleInstance();var za=new ge(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Q.resolve("ReplicationTelemetry.InboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),hb=this.Na.$("ComponentStateLoggingPackageIsEnabled")?this.W.Sa("Common.IComponentStateLogManager"):null;Q.ha("ReplicationTelemetry.IInboundMonitor",()=>za.create(this.Na.pc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Na.pc("Box4ReplicationTelemetryInboundOperationAverageThreshold",
0),this.Na.pc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Na.pc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),hb)).singleInstance();Q.ha("Common.IRandomSamplerFactory",()=>new Ll).singleInstance();Q.ha("ReplicationTelemetry.ReplicationTelemetryManager",()=>new kc(Q.resolve("ReplicationTelemetry.OutboundMonitorFactory"),Q.resolve("ReplicationTelemetry.IInboundMonitor"),Q.resolve("Common.IRandomSamplerFactory"))).singleInstance();Q.ha("ReplicationTelemetry.EventForwarderFactory",
()=>new fc(ib.a.instance,Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),Q.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Na.$("Box4ReplicationTelemetryIsEnabled")){var Q=this.Na.pc("Box4ReplicationTelemetrySamplePercent",0),za=this.Na.pc("Box4ReplicationTelemetryPhaseSamplePercent",0),hb=this.Na.pc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Tb=this.Na.pc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),zc=this.Na.pc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",
0),kd=this.Na.pc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),ce=this;this.W.Sa("Box4.Presence.IRtcProxyProvider").execute(bf=>{bf.tD().continueWith(()=>{const Vf=bf.tD().result,rh=ce.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");rh.init(Vf,Q,za,hb,Tb,zc,kd);ce.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(Vf,rh);if(ce.Na.$("LogSteppedInboundFrameIsEnabled")){const ij=Tm.a.xp(ce.W.Sa("Common.ICpuMeterProvider"));ij.continueWith(()=>
{const vi=ce.W.resolve("ReplicationTelemetry.IInboundMonitor");var ti=new fa.a(()=>!0);ti=Ba.a.GE(19,1,ti);vi.initialize(ti);const nk=ij.result.Qp.task;nk.continueWith(()=>{nk.result.Jxd(0,()=>vi.dRe,Wj=>{vi.vgn(Wj)});nk.result.Jxd(1,Wj=>vi.Ylo(Wj),()=>{vi.ugn()})})})}ya.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var df=this;l.AFrameworkApplication.uJ(()=>{df.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").Dae()})}}dispose(){}static c4h(){const Q=Pe.App.xd;
return Q?Q.NQh:0}}Object(e.a)(Kn,"ReplicationTelemetryPackage",null,[1,2]);var Kj=c(952),Rj=c(14),Ul=c(145),uh=c(3),yk=c(96),Bi=c(64),yf=c(235),Uh=c(19),ue=c(24),Be=c(10),nf=c(2006);class qe{static get Wg(){return k.a.Xz(qe.Hm,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}qe.Hm="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(e.a)(qe,"InsertSymbolsDialogHtml",null,[]);class Sj extends nf.a{constructor(Q,za,hb,Tb){super();this.IV=Tb;this.pVb=this.WLa=this.bcb=null;this.vCe=0;this.Dum=zc=>{1===zc?(this.zRf("symbol_d_"+Sj.Yuc),this.Vb.TK(this.uK,!0),this.Vb.Hs().Xj.wy(this.GG),this.GG.focus()):this.hide()};this.Nqj=zc=>{if(zc.target!==this.pVb){const kd=this.Vb.Hs();kd&&kd.Xj&&(kd.Xj.wy(zc.target),this.pVb=zc.target)}this.ann(zc.target.id)};this.oyo=zc=>{const kd=zc.zf;if("a"!==kd.tagName.toLowerCase())return!1;zc.eventName===
W.a.$A&&this.zRf(kd.id);this.Vb.TK(this.uK,!0);this.Vb.Hs().Xj.wy(kd);kd.focus();return!0};this.qyo=zc=>{var kd=zc.zf;if("a"!==kd.tagName.toLowerCase())return!1;const ce=parseInt(kd.id.substr(kd.id.lastIndexOf("_")+1));if(zc.Ib.ctrlKey||zc.Ib.altKey||zc.Ib.keyCode>=Zd.a.HQb&&zc.Ib.keyCode<=Zd.a.IQb)return!1;if(zc.eventName===W.a.fi){zc=zc.Ib.keyCode;let df=-1;zc===Sys.UI.Key.enter?(this.zRf(kd.id),this.Vb.TK(this.uK,!0),this.Vb.Hs().Xj.wy(kd),kd.focus()):zc===Sys.UI.Key.up?df=ce-15:zc===Sys.UI.Key.down?
df=ce+15:zc===Sys.UI.Key.left?df=l.AFrameworkApplication.isRtl?ce+1:ce-1:zc===Sys.UI.Key.right&&(df=l.AFrameworkApplication.isRtl?ce-1:ce+1);0<=df&&(kd=this.bsf("symbol_d_"+df))&&kd.focus()}return!0};this.ga=Q;this.Vb=za;this.ccb=hb;this.Ge(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ge(0,CommonUIStrings.l_DialogClose);this.Z9=!1;this.Wg=qe.Wg;this.sg="InsertSymbolsDialog"}dispose(){0<Sj.sTe&&ya.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.vCe,Sj.sTe);Sj.zOg++;ya.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Sj.zOg);this.ga=this.ccb=null;super.dispose()}FSa(){this.Yh(Box4Intl.Box4Strings.L_SymbolSingle,this.Dum,null);this.vCe=0;Sj.FOg++;ya.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Sj.FOg);const Q=this.bsf("symbol_d_"+Sj.Yuc);Q&&Q.focus()}hide(){var Q=document.getElementById("symbolsContainer");if(Q&&(Q=Q.getElementsByTagName("a")))for(let za=0;za<Q.length;za++)V.a.removeHandler(Q[za],
W.a.focus,this.Nqj);super.hide()}get Mjb(){return Sj.dvc}set Mjb(Q){Sj.dvc=Q}get Ijb(){return Sj.Ruc}set Ijb(Q){Sj.Ruc=Q}E8(){super.E8();var Q=document.getElementById("symbolsContainer");if(Q&&(Q.innerHTML=this.ccb.vGk(),Q=Q.getElementsByTagName("a")))for(let za=0;za<Q.length;za++)V.a.addHandler(Q[za],W.a.focus,this.Nqj)}hla(){const Q=document.getElementById("symbolsContainer");Q&&(this.bcb||(this.bcb=this.oyo,this.Bq.mb(W.a.click,Q,this.bcb),this.Bq.mb(W.a.$A,Q,this.bcb)),this.WLa||(this.WLa=this.qyo,
this.$d.mb(W.a.fi,Q,this.WLa),this.$d.mb(W.a.St,Q,this.WLa),this.$d.mb(W.a.sh,Q,this.WLa)));super.hla()}Oeb(){const Q=document.getElementById("symbolsContainer");Q&&(this.bcb&&(this.Bq.sc(W.a.click,Q,this.bcb),this.Bq.sc(W.a.$A,Q,this.bcb),this.bcb=null),this.WLa&&(this.$d.sc(W.a.fi,Q,this.WLa),this.$d.sc(W.a.St,Q,this.WLa),this.$d.sc(W.a.sh,Q,this.WLa),this.WLa=null));super.Oeb()}get Xuf(){return this.IV?!0:!1}ann(Q){this.bhj("symbol_d_"+Sj.Yuc,!1);Sj.Yuc=parseInt(Q.substr(Q.lastIndexOf("_")+1));
this.bhj(Q,!0);if(Q=document.getElementById("SymbolNameValueLabel")){const za=this.JQd(Sj.Yuc);Q.innerText=za.altText}}JQd(Q){const za=this.ccb.Qie.ieg.value,hb=Cc.a(za);return za[hb[Q]]}zRf(Q){this.vCe++;Sj.sTe++;Q=parseInt(Q.substr(Q.lastIndexOf("_")+1));const za=this.JQd(Q),hb={};hb.SourceControlId="symbol_"+Q+"_"+za.Oie;this.ga.Rb(uh.a.kib,2,hb);ya.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Q)}bsf(Q){const za=document.getElementById("symbolsContainer");return za?
za.querySelector("#"+Q):null}bhj(Q,za){if(Q=this.bsf(Q))za?(Q.setAttribute("selected","true"),this.IV&&(Q.setAttribute("aria-selected","true"),Q.tabIndex=0)):(Q.removeAttribute("selected"),this.IV&&(Q.setAttribute("aria-selected","false"),Q.tabIndex=-1))}}Sj.Yuc=0;Sj.dvc=null;Sj.Ruc=null;Sj.FOg=0;Sj.zOg=0;Sj.sTe=0;Object(e.a)(Sj,"InsertSymbolsDialog",nf.a,[]);class on{constructor(Q,za,hb,Tb,zc,kd,ce){this.p7l=()=>this.ccb.mHk();this.i_i=(df,bf,Vf,rh,ij)=>{if(1===Vf)return 32;df=this.ccb.VUi(ij);df=
String.format(this.ccb.pyo,df.character);ij[Kj.a.InnerHTML]=df;ij[Kj.a.On]=!1;return 32};this.iPa=(df,bf,Vf,rh,ij)=>{if(({je:df,selected:Vf,iPa:nk}=this.PHc(bf,Vf)).returnValue)return nk;var vi=Uh.SelectionEditor.jf(Vf);let ti=!0;Vf=8;var nk=this.Ic.Qc(15);nk.Eb(df.Zc);vi||(Vf=this.ga.Nf(bf,uh.a.Ula,2,!0,rh,null),bf=32===Vf,ya.ULS.shipAssertTag(6407387,348,bf,"DeleteForReplace did not succeed. Response is {0}",Vf),ti=bf);ti&&(bf=df.nb.pg,vi=Uh.SelectionEditor.jf(bf),ya.ULS.shipAssertTag(6407388,348,
vi,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",bf.contextId),Vf=8,vi&&(Vf=this.ga.Nf(bf,uh.a.kib,2,!1,rh,ij),ya.ULS.shipAssertTag(6407389,348,32===Vf,"Insertion at IP context did not succeed. Response is {0}",Vf),32===Vf&&ci.FocusManager.instance().mg(df.GI)));nk.dispose();return Vf};this.Cum=(df,bf,Vf,rh,ij)=>{if(1===Vf)return 32;if(Uh.SelectionEditor.R1a(bf))return 2;df=this.ccb.VUi(ij);rh.Ur=df.index;rh=this.Xc.Wf(bf.node);Vf=rh.Ab(11);ya.ULS.shipAssertTag(6379466,
324,Vf,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",Ul.a[bf.node.type]);Vf=this.Ic.Qc(15);Vf.Fu(rh);on.characterPropertiesEditor.replaceTextRange(bf,df.character,!0,!1);bf=ue.SelectionFactory.te(rh.currentNode,bf.cpBegin+1);this.ib.setSelection(bf);Vf.dispose();return 32};this.AKb=(df,bf,Vf,rh,ij)=>{if(1===Vf)return 32;ij.MenuItems=this.sek.value;return 32};this.Oqj=(df,bf,Vf)=>{({iPa:df}=this.PHc(bf,Vf));return df};this.Mlj=(df,bf,Vf)=>{2===Vf&&(new Sj(this.ga,ci.FocusManager.instance(),
pa.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"),!!Pe.App.instance&&Pe.App.instance.twa)).FSa();return 32};this.PZf=()=>32;this.ga=Q;this.Xc=za;this.sek=new $b.a(this.p7l);this.Ic=hb;this.ccb=Tb;this.Fk=zc;this.ib=kd;this.Rm=ce}Ub(){this.ga.gb(uh.a.PZf,Rj.a.application,this.PZf,96);this.ga.pa(uh.a.AKb,Rj.a.view,this.AKb);this.ga.pa(uh.a.Pie,Rj.a.view,this.Oqj);this.ga.pa(uh.a.M$d,Rj.a.view,this.i_i);this.ga.pa(uh.a.kib,Rj.a.view,this.iPa);this.ga.pa(uh.a.AKb,Rj.a.Vc,this.AKb);this.ga.pa(uh.a.Pie,
Rj.a.Vc,this.Oqj);this.ga.pa(uh.a.M$d,Rj.a.Vc,this.i_i);this.ga.pa(uh.a.kib,Rj.a.Vc,this.Cum);this.ga.Uc(uh.a.AKb,1124);this.ga.Uc(uh.a.Pie,1036);this.ga.Uc(uh.a.M$d,1124);this.ga.Uc(uh.a.kib,1036);l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ga.pa(uh.a.tRc,Rj.a.view,this.Mlj),this.ga.pa(uh.a.tRc,Rj.a.Vc,this.Mlj),this.ga.Uc(uh.a.tRc,1124))}PHc(Q,za){let hb,Tb=null;Q.view.re&&(Tb=Q.view);hb=null;if(!Tb||!Tb.nb)return H.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",
Q.toString()),{returnValue:!0,je:Tb,selected:hb,iPa:8};hb=Tb.nb.pg;if(!hb)return{returnValue:!0,je:Tb,selected:hb,iPa:2};if(this.Fk.JZ(hb)||this.Fk.Gna(hb))return{returnValue:!0,je:Tb,selected:hb,iPa:8};if(Tb.nb.hb.YI||this.Rm&&this.Rm.instance&&this.Rm.instance.aU(hb)||Uh.SelectionEditor.R1a(Q.Yj))return{returnValue:!0,je:Tb,selected:hb,iPa:2};if(on.Vg.Oya(Be.ParagraphReader.ZT,hb))return Q=8,on.Jc.Zb(yk.a.kf,{["Reason"]:Bi.a.IN}),{returnValue:!0,je:Tb,selected:hb,iPa:Q};Q=32;return 1===za?{returnValue:!0,
je:Tb,selected:hb,iPa:Q}:{returnValue:!1,je:Tb,selected:hb,iPa:Q}}static get characterPropertiesEditor(){return on.Jd||(on.Jd=pa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Q){on.Jd=Q}static get Vg(){return yf.ContextSetEditor.instance}static get Jc(){return Mf.a.instance}}on.Jd=null;Object(e.a)(on,"SymbolsActor",null,[1857]);class he{constructor(Q,za){this.Oie=Q;this.altText=za}}Object(e.a)(he,"Symbol",null,[]);class vh{constructor(){this.WRe=null;
this.neh=new $b.a(vh.m$e)}get ieg(){return this.neh}n7h(Q){this.WRe||(this.WRe=Cc.a(this.neh.value));return Array.indexOf(this.WRe,Q)}static m$e(){const Q={};Q["\u2022"]=new he("\u2022",Box4Intl.Box4Strings.L_Bullet);Q["\u20ac"]=new he("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Q["\u00a3"]=new he("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Q["\u00a5"]=new he("\u00a5",Box4Intl.Box4Strings.L_YenSign);Q["\u00a9"]=new he("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);Q["\u00ae"]=new he("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);
Q["\u2122"]=new he("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Q["\u00b1"]=new he("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Q["\u2260"]=new he("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Q["\u2264"]=new he("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Q["\u2265"]=new he("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Q["\u00f7"]=new he("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Q["\u00d7"]=new he("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);Q["\u221e"]=new he("\u221e",
Box4Intl.Box4Strings.L_Infinity);Q["\u00b5"]=new he("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Q["\u03b1"]=new he("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Q["\u03b2"]=new he("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);Q["\u03c0"]=new he("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Q["\u03a9"]=new he("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Q["\u03a3"]=new he("\u03a3",Box4Intl.Box4Strings.L_NArySummation);Q["\u00b0"]=new he("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);
Q["\u0394"]=new he("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Q["\u263a"]=new he("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Q["\u2665"]=new he("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Q["\u20b9"]=new he("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);Q["\u00bf"]=new he("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Q["\u00a1"]=new he("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Q["\u2014"]=new he("\u2014",Box4Intl.Box4Strings.L_EmDash);Q["\u2026"]=new he("\u2026",
Box4Intl.Box4Strings.L_HorizontalEllipsis);Q["\u00c0"]=new he("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Q["\u00c1"]=new he("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Q["\u00c2"]=new he("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);Q["\u00c3"]=new he("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Q["\u00c4"]=new he("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);Q["\u00c5"]=new he("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);
Q["\u00c6"]=new he("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Q["\u00c7"]=new he("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Q["\u00c8"]=new he("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Q["\u00c9"]=new he("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Q["\u00ca"]=new he("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Q["\u00cb"]=new he("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Q["\u00cc"]=
new he("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Q["\u00cd"]=new he("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Q["\u00ce"]=new he("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Q["\u00cf"]=new he("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);Q["\u00d1"]=new he("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Q["\u00d2"]=new he("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Q["\u00d3"]=new he("\u00d3",
Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Q["\u00d4"]=new he("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Q["\u00d5"]=new he("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Q["\u00d6"]=new he("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Q["\u00d9"]=new he("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Q["\u00da"]=new he("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Q["\u00db"]=new he("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);
Q["\u00dc"]=new he("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Q["\u00df"]=new he("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Q["\u00e0"]=new he("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Q["\u00e1"]=new he("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Q["\u00e2"]=new he("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Q["\u00e3"]=new he("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Q["\u00e4"]=new he("\u00e4",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Q["\u00e5"]=new he("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Q["\u00e6"]=new he("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Q["\u00e7"]=new he("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);Q["\u00e8"]=new he("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);Q["\u00e9"]=new he("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Q["\u00ea"]=new he("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);
Q["\u00eb"]=new he("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Q["\u00ec"]=new he("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Q["\u00ed"]=new he("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Q["\u00ee"]=new he("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Q["\u00ef"]=new he("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Q["\u00f1"]=new he("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Q["\u00f2"]=new he("\u00f2",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Q["\u00f3"]=new he("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Q["\u00f4"]=new he("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Q["\u00f5"]=new he("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);Q["\u00f6"]=new he("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Q["\u00f9"]=new he("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Q["\u00fa"]=new he("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);
Q["\u00fb"]=new he("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Q["\u00fc"]=new he("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Q["\u00ff"]=new he("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Q["\u011e"]=new he("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);Q["\u011f"]=new he("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Q["\u0130"]=new he("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Q["\u0131"]=
new he("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Q["\u0152"]=new he("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Q["\u0153"]=new he("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Q["\u015e"]=new he("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);Q["\u015f"]=new he("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Q["\u0178"]=new he("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Q}}Object(e.a)(vh,"SymbolsLoader",
null,[1855]);var zk=c(442),bp=c(362),ll=c(216),Ej=c(659),Ok=c(1461),sj=c(181),Te=c(97);class wf{constructor(Q,za){this.IV=za;this.Qie=Q}get pyo(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}VUi(Q){Q=Q.SourceControlId.split("_");const za={};2===Q.length?(za.character=Q[1],za.index=this.Qie.n7h(za.character)):(za.character=Q[2],za.index=parseInt(Q[1]));return za}mHk(){return this.idi()}build(){return this.q7l()}vGk(){const Q=new Sys.StringBuilder;Q.append('<table class="moreSymbolsTable">');
const za=this.Qie.ieg.value,hb=Cc.a(za);let Tb=0;for(;Tb<hb.length;){Tb%15||Q.append('<tr role="presentation">');const zc=za[hb[Tb]];Q.append(String.format(this.IV?'<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>':'<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Tb,db.a.i_(zc.Oie),db.a.i_(zc.altText)));Tb++;Tb%15&&Tb!==hb.length||Q.append("</tr>")}Q.append("</table>");return Q.toString()}q7l(){const Q=this.idi();return sj.o(Q)}idi(){const Q=Object.assign(new zk.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Q.MenuSectionList.push(this.rok());l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&Q.MenuSectionList.push(this.wmk());return Q}wmk(){const Q=Object.assign(new bp.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),za=Object.assign(new ll.a,{Id:"btnMoreSymbols",Command:uh.a.tRc.toString(),LabelText:db.a.Af(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:db.a.Af(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:l.AFrameworkApplication.Ks,Image16by16Class:Te.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Q.ControlList.push(za);return Q}rok(){const Q=Object.assign(new bp.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
za=Object.assign(new Ej.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),hb=this.Qie.ieg.value,Tb=Cc.a(hb),zc=Math.min(25,Tb.length);for(let ce=0;ce<zc;ce++){var kd=hb[Tb[ce]];kd=Object.assign(new Ok.a,{Id:String.format("{0}{1}_{2}","symbol_",ce,kd.Oie),Character:kd.Oie,Command:uh.a.kib.toString(),QueryCommand:uh.a.M$d.toString(),Alt:db.a.Af(kd.altText)});za.GalleryItems.push(kd)}Q.ControlList.push(za);
return Q}}Object(e.a)(wf,"SymbolsUiBuilder",null,[1856]);var Ge=c(52),pf=c(249),mm=c(564),Bo=c(400);class rl{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){l.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.W.resolve("Box4.Symbols.ISymbolsActor").Ub()}dispose(){}yc(Q){this.W=Q;this.W.register(vh,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").singleInstance();this.W.ha("Box4.Symbols.SymbolsUiBuilder",()=>new wf(this.W.resolve("Box4.Symbols.ISymbolsLoader"),
!!Pe.App.instance&&Pe.App.instance.twa)).as("Box4.Symbols.ISymbolsUIBuilder").singleInstance();this.W.ha("Box4.Symbols.SymbolsActor",()=>new on(l.AFrameworkApplication.xa,new mm.a,new Bo.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),pf.a.instance,Ge.a.instance,this.W.Sa("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").singleInstance()}static main(){K.a.instance.Gc(new rl)}}Object(e.a)(rl,"Box4SymbolsPackage",null,[1,2]);var cp=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},
children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},Co=c(1613),Zm=c(1567),Jq=c(1553),dp=c(1922),vb=c(208),Fc=c(443);class rd{constructor(){this.EIa=null}yc(Q){this.container=Q}init(){this.EIa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.EIa&&this.EIa.dispose()}}Object(e.a)(rd,
"ALiveBooksAccessibilityCheckPackageManager",null,[1,2]);class De{get mZk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get nZk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get oZk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get Pqn(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get rec(){return CommonUIStrings.l_AccCheckerPaneTitle}get uun(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(e.a)(De,
"AccessibilityCheckStringsProvider",null,[63]);class kf{constructor(){this.F$i=this.contentId=null}}Object(e.a)(kf,"ResultIds",null,[]);class Ef{constructor(Q,za){this._element=null;this.hg=za;this.$d=Q}get element(){this._element||(this._element=this.Y2k(),this.gz());return this._element}c$f(Q){this._element=Q}dispose(){this.element&&(this.A9(),this.c$f(null))}gz(){this.hg&&this.$d?(this.hg.mb(W.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.$d.mb(W.a.fi,this.element,Object(a.a)(this,
this.lG,"onKeyPress"))):ya.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}A9(){this.hg&&this.$d&&(this.hg.sc(W.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.$d.sc(W.a.fi,this.element,Object(a.a)(this,this.lG,"onKeyPress")))}onClick(){this.v5d();return!0}lG(Q){return this.TEm(Q.Ib.keyCode)?(this.v5d(),!0):!1}TEm(Q){return Q===Zd.a.Kme||Q===Zd.a.ks}}Object(e.a)(Ef,
"AInteractivePaneElement",null,[148,9]);var Se=c(482),ad=c(49);class Xg extends Ef{constructor(Q,za,hb){super(Q,za);this.HJe=hb}hide(){this.element.removeAttribute(Sc.a.oh);Sc.a.Uq(this.element,Sc.a.Lz,Sc.a.gp);this.element.style.display="none"}show(){Sc.a.Uq(this.element,Sc.a.Lz,Sc.a.NL);Sc.a.Uq(this.element,Sc.a.oh,Sc.a.T_e);this.element.style.display="block"}Y2k(){const Q=Se.b("div",this.WKi,"AccCheckerNotification");Sc.a.Uq(Q,Sc.a.irh,Sc.a.gp);Sc.a.Uq(Q,Sc.a.Cea,this.FOf);Q.tabIndex=0;const za=
Se.b("span",this.VKi,"AccCheckerNotificationIcon");var hb=Te.createClusteredImage(16,16,"Info_16x16x32","",!0,"");za.appendChild(hb);hb=Se.b("span",this.FOf,"AccCheckerNotificationText");ad.a.uy(hb,this.XKi);Q.appendChild(za);Q.appendChild(hb);return Q}v5d(){this.HJe()}}Object(e.a)(Xg,"APopupNotification",Ef,[147,148,9]);class Zg extends Xg{constructor(Q,za,hb,Tb){super(Q,za,hb);this.zsa=Tb}get WKi(){return"AccCheckerOutOfSyncNotificationId"}get VKi(){return"AccCheckerOutOfSyncNotificationIconId"}get FOf(){return"AccCheckerOutOfSyncNotificationTextId"}get XKi(){return this.zsa.Pqn}}
Object(e.a)(Zg,"OutOfSyncNotification",Xg,[]);class Mg extends Xg{constructor(Q,za,hb,Tb){super(Q,za,hb);this.zsa=Tb}get WKi(){return"AccCheckerPartialResultNotificationId"}get VKi(){return"AccCheckerPartialResultNotificationIconId"}get FOf(){return"AccCheckerPartialResultNotificationTextId"}get XKi(){return this.zsa.uun}}Object(e.a)(Mg,"PartialResultNotification",Xg,[]);var Si=c(156),ii=c(28),Hh=c(168);class Ui{constructor(Q,za,hb,Tb=null,zc=null,kd=null,ce=null){this.z$g=this.EL=this.$d=this.EIa=
null;this.w_=Tb;this.hg=Q;this.Vb=za;this.Zo=hb;this.zsa=ce||new De;this.vKe=zc||new Zg(this.w_,this.hg,Object(a.a)(this,this.Rfl,"dimissOutOfSyncNotification"),this.zsa);this.kLe=kd||new Mg(this.w_,this.hg,Object(a.a)(this,this.Sfl,"dimissPartialResultNotification"),this.zsa)}show(){}hide(){}get w_(){return this.$d||(this.$d=l.AFrameworkApplication.ta.NC)}set w_(Q){this.$d=Q}aHh(){}jna(){}dispose(){}Z6a(){}Cwm(Q){var za=this.z$g[Q];Q=za.contentId;if((za=za.F$i+"")&&za.length){const hb=[];Array.add(hb,
Object.assign(new ii.a,{name:"RuleID",string:za}));Si.a.sendTelemetryEvent(Object.assign(new Hh.a,{name:String.format("{0}.{1}",Ui.efg,"ViolationSelected"),dataFields:hb}))}this.o$m(Q)}o$m(Q){Q&&this.EIa.cbo(Q)||(this.Vb.TK(kh.AFrame.Aih,!1),this.ioo())}Rfl(){this.P6c(!1)}Sfl(){this.Elj(!1)}ioo(){const Q=Object.assign(new Sb.StandardDialog(!0),{ht:l.AFrameworkApplication.hba,zd:1,nHa:!1});Q.MU(1);Q.Ge(1,this.zsa.mZk);Q.Ge(0,CommonUIStrings.l_DialogCancel);Q.PU(this.zsa.oZk,this.zsa.nZk,za=>{1===za&&
this.Vyf()})}tHk(Q){let za=null;if(Q.Results&&0<Q.Results.length){za={};let hb=0;for(const Tb of Q.Results)Tb.ResultId=Ui.xik+ ++hb,Q=new kf,Q.contentId=Tb.ContentId,Q.F$i=Tb.RuleId,za[Tb.ResultId]=Q}return za}E0m(){Si.a.addNamespaceMapping(Ui.efg,Ui.EAo);Si.a.sendTelemetryEvent(Object.assign(new Hh.a,{name:String.format("{0}.{1}",Ui.efg,"ShowTaskpane")}))}}Ui.xik="AccCheckResult";Ui.efg="Office.UX.AccChecker";Ui.EAo="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(e.a)(Ui,
"BaseAccessibilityCheckPane",null,[66,9]);class mc{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(e.a)(mc,"AccCheckerTaskPaneProps",null,[]);var ml=c(1384),hl=c(1397),Kd=c(1044),Vi=c(158);class ph extends Ui{constructor(Q,za,hb,Tb,zc=null,kd=null,ce,df=null,bf=null){super(za,
hb,Tb,kd,void 0,void 0,df);this.bHg=null;this.m9g=this.jLe=this.apd=this.osd=this.Krd=!1;this.sUe=null;this.qSe=!!l.AFrameworkApplication.ta&&!!l.AFrameworkApplication.ta.Ob&&l.AFrameworkApplication.ta.Ob.iEf;this.Zrc=this.d5=null;this.Osc=0;this.Rid=null;this.AY=zc;bf&&(this.d5=bf.oxd,this.Zrc=bf.l9o,this.Osc=bf.v$o);this.QA=new hl.a}get isVisible(){return this.m9g}BSa(Q){this.m9g=Q}adf(Q){Q&&(this.bHg=Q,Q.IsSuccess&&(this.z$g=this.tHk(Q),Q.IsPartialResult&&this.Elj(!0)),this.Krd=!0,this.osd=!1,
this.wm())}P6c(Q){this.isVisible&&Q!==this.apd&&(this.apd=Q,this.wm())}Elj(Q){this.jLe=Q;this.wm()}NO(){this.osd||Vi.UISurfaces.uu().then(Q=>{wa.a.instance.My(ph.$pb+":PaneOpen:Start");Q.showTaskPane(ph.$pb,this.Pz());this.Vyf();return null});this.isVisible?Vi.UISurfaces.uu().then(Q=>{Q.setSelectedTaskPane(ph.$pb);return null}):this.E0m()}wm(){Vi.UISurfaces.uu().then(Q=>{Q.updateTaskPane(ph.$pb,this.Pz());return null})}Pz(){var Q=new mc;this.QA.snb(Q);Q=Object.assign(new Kd.a,{title:this.zsa.rec,
hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:()=>{this.g9();this.BSa(!0);l.AFrameworkApplication.ta.updateCommandUI()},onClose:()=>{this.tca();this.BSa(!1);this.osd=this.Krd=!1;this.wm();l.AFrameworkApplication.ta.updateCommandUI()},isModernPane:!0});this.qSe&&(Q.enableResize=!0,Q.minResizeWidth=268,Q.maxResizeWidth=920);return Q}initialize(Q){const za=this.Vb.fe(ph.$pb);za.parent=kh.AFrame.qp;za.zH=!0;this.EIa=Q;this.yjk()}dispose(){this.Z6a();this.vKe&&(this.vKe.dispose(),this.vKe=null);
this.kLe&&(this.kLe.dispose(),this.kLe=null);super.dispose()}yjk(){this.QA.UK(this.onRecheckExecute());this.QA.UK(this.cDl());this.QA.UK(this.g3l());this.QA.UK(this.onInvokeNavigateExecute());this.QA.UK(this.vRl());this.QA.UK(this.jZl());this.QA.UK(this.d0l());this.QA.UK(this.updateLastScanTime());this.QA.UK(this.showHelpPane())}onRecheckExecute(){return Q=>{Q.onRecheckExecute=()=>{this.Vyf()}}}cDl(){return Q=>{Q.accessibilityCheckResultCollection=this.bHg}}g3l(){return Q=>{Q.resultsReady=this.Krd}}onInvokeNavigateExecute(){return Q=>
{Q.onInvokeNavigateExecute=za=>{this.Cwm(za)}}}vRl(){return Q=>{Q.helpLink=this.mrl}}jZl(){return Q=>{Q.outOfSync=this.apd}}d0l(){return Q=>{Q.partialResult=this.jLe}}updateLastScanTime(){return Q=>{Q.updateLastScanTime=za=>{this.sUe=za}}}showHelpPane(){return Q=>{Q.showHelpPane=()=>{l.AFrameworkApplication.K&&l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?l.AFrameworkApplication.qK||this.Tqh()?this.Rid?this.Rid():this.d5.value&&this.Zrc&&
this.Osc&&this.d5.value.Rb(this.Osc,2,this.Zrc):this.Cmj():this.Tqh()?this.Rid?this.Rid():this.d5.value&&this.Zrc&&this.Osc&&this.d5.value.Rb(this.Osc,2,this.Zrc):this.Cmj()}}}Tqh(){return!this.AY||!this.AY.value}Cmj(){const Q=this.AY.value;if(Q){var za={};za.query=ph.o$j+ph.PZj;za=Object.assign(new ml.a,{XQ:za});Q.C4(ph.SAe,za)}}Vyf(){this.jLe=this.apd=this.Krd=!1;this.sUe&&this.sUe();this.wm();this.osd=!0;this.EIa.ufn()}g9(){this.Vb.mg(ph.$pb)}tca(){this.G2a()&&this.Vb.mg(this.Vb.fT)}G2a(){return!!this.Vb.currentScope&&
this.Vb.currentScope.name===ph.$pb}}ph.$pb="AccessibilityCheckerPane";ph.PZj="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";ph.SAe="FA000000012";ph.o$j="AssetID=";Object(e.a)(ph,"ReactAccessibilityCheckPane",Ui,[]);class ji extends ph{constructor(Q,za,hb,Tb,zc,kd,ce,df,bf=null){super(Q,za,hb,Tb,zc,kd,void 0,bf);this.CWj=df;this.k2=ce}get mrl(){return this.CWj}NO(){this.k2.lNa();super.NO()}}Object(e.a)(ji,"ReactLiveBooksAccessibilityCheckPane",ph,[]);var Gd=c(1144),sn=c(142),fk=c(169),me=c(70),Ad=c(167),Wi=
c(532),cm;(function(Q){Q[Q.error=0]="error";Q[Q.warning=1]="warning";Q[Q.tip=2]="tip";Q[Q.intelligentService=3]="intelligentService"})(cm||(cm={}));Object(e.b)("AccessibilityRuleCategory",cm);class bq{constructor(Q,za,hb=null){this.Lpe=null;this.CYg=this.mXg=!1;this.lMa=Q;this.hcd=za;this.ga=hb;this.rc.pa(m.a.SSk,y.a.frame,Object(a.a)(this,this.N5e,"closePane"))}get rc(){return this.ga||(this.ga=l.AFrameworkApplication.xa)}set rc(Q){this.ga=Q}unl(){this.mXg||(this.lMa.initialize(this),this.hcd.initialize(this),
this.mXg=!0)}ufn(){H.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.hcd.K2n()}NO(Q,za,hb){if(1===hb)return Pd.SessionStatusManager.instance.xj?8:32;this.lMa.isVisible||this.unl();this.Jpo();return 32}N5e(Q,za,hb){1!==hb&&this.lMa.jna();return 32}lmn(){this.lMa.P6c(!0)}adf(Q){if(Q){if(Q.AccessibilityRules&&Object.keys(Q.AccessibilityRules).length){const hb=Q.AccessibilityRules;for(let Tb in hb){var za=Tb;const zc=hb[Tb].RuleId+"";za!==zc&&H.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
za,zc)}this.Lpe=hb}else!this.Lpe&&Q.Results&&0<Q.Results.length?(H.b(18993251,200,15,"No accessibility rule definitions available"),Q.IsSuccess=!1):Q.AccessibilityRules=this.Lpe;Q.IsSuccess||H.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.pTn(Q);this.p0m(Q);this.lMa.adf(Q)}}pTn(Q){const za=Q.AccessibilityRules;if(Q=Q.Results)for(let hb=Q.length-1;0<=hb;hb--){const Tb=Q[hb];let zc="";const kd=Tb.RuleId;Tb.ContentName||(zc+="Result does not have content name. ");kd in za||(zc+=String.format("No accessibility check rule exists for ID {0}.",
kd));0<zc.length&&(H.b(36214999,200,15,"Omitting invalid accessibility check result: "+zc),Array.removeAt(Q,hb))}}n4l(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):pa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").HA.loadScript("accessibility-checker-pane-strings")}Jpo(){this.CYg?this.lMa.NO():this.n4l().then(()=>{this.CYg=!0;this.lMa.NO()}).catch(Q=>ya.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
Q))}p0m(Q){var za={};const hb={};var Tb=Q.Results,zc=[];Array.add(zc,Object.assign(new ii.a,{name:"FinalViolationCount",int64:0}));Array.add(zc,Object.assign(new ii.a,{name:"FinalErrorCount",string:"0"}));Array.add(zc,Object.assign(new ii.a,{name:"FinalWarningCount",string:"0"}));Array.add(zc,Object.assign(new ii.a,{name:"FinalTipCount",string:"0"}));Array.add(zc,Object.assign(new ii.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Tb){for(const df of Tb)if(Q.AccessibilityRules){var kd=Q.AccessibilityRules[df.RuleId];
if(kd){if(za[cm[kd.Category]]){let bf=za[cm[kd.Category]];za[cm[kd.Category]]=++bf}else za[cm[kd.Category]]=1;hb[df.RuleId]?(kd=hb[df.RuleId],hb[df.RuleId]=++kd):hb[df.RuleId]=1}}zc[0].int64=Tb.length;for(var ce in za)switch(Q=za[ce],Tb=ce,Tb="Final"+Tb.charAt(0).toUpperCase()+Tb.substring(1,Tb.length)+"Count",Tb){case "FinalErrorCount":zc[1].string=Q.toString();break;case "FinalWarningCount":zc[2].string=Q.toString();break;case "FinalTipCount":zc[3].string=Q.toString();break;case "FinalIntelligentServiceCount":zc[4].string=
Q.toString()}}Si.a.sendTelemetryEvent(Object.assign(new Hh.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:zc}));for(let df in hb)za=df,zc=hb[df],ce=[],Array.add(ce,Object.assign(new ii.a,{name:"RuleID",string:za})),Array.add(ce,Object.assign(new ii.a,{name:"FinalViolationCount",string:zc.toString()})),Si.a.sendTelemetryEvent(Object.assign(new Hh.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:ce}))}dispose(){this.lMa&&
this.lMa.dispose();this.hcd&&this.hcd.dispose()}}Object(e.a)(bq,"AAccessibilityCheckManager",null,[62,9]);var Fn=c(337);const Jh=[12,14,22,19,30,43,44];class Lc extends bq{constructor(Q,za,hb,Tb,zc,kd){super(za,hb,Q);this.rc.pa(m.a.Lag,y.a.frame,this.NO.bind(this));this.rc.gb(m.a.NFn,y.a.frame,this.k_i.bind(this),96);this.graph=zc;this.B5j=Tb;this.Z1j=kd;this.Qdc=()=>{this.lmn()};this.QPn()}k_i(Q,za,hb,Tb,zc){if(1===hb)return 32;zc[Fn.a.On]=this.lMa.isVisible;return 32}cbo(Q){if(this.Z1j)return ya.ULS.sendTraceTag(20713608,
334,15,"ODT file. Disable content navigation."),!0;ya.ULS.shipAssertTag(20272215,334,!!Q);return this.B5j.i$m(Q)}QPn(){for(const Q of Jh){const za=this.graph.af(Q);za.Ro(this.Qdc);za.ku(this.Qdc);za.Lv(this.Qdc)}}rKo(){for(const Q of Jh){const za=this.graph.af(Q);za.EU(this.Qdc);za.DU(this.Qdc);za.ica(this.Qdc)}}dispose(){super.dispose();this.rKo()}}Object(e.a)(Lc,"WordAccessibilityCheckManager",bq,[]);var Bh=c(92),ag=c(31),sl=c(135),tn=c(20),Tn=c(185),Un=c(6),Vh=c(18),kk=c(505);class lf{constructor(Q,
za,hb,Tb,zc,kd,ce){this.Qo=null;this.EAb=0;this.Xc=za;this.UB=hb;this.ib=Tb;this.ga=zc;this.ed=kd;this.Gt=Q;this.od=ce}get vR(){if(!this.Qo){const Q=this.Xc.Wf(this.Gt.Wc);this.UB.Chg(Q);if(Q.Ab(7)||Q.fd(7))this.Qo=Bh.a.at(Q,Q.origin)}return this.Qo}i$m(Q){if(!Q||!Q.wg||0>=Q.wg.length)return ya.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var za=Array(Q.wg.length);let hb=7,Tb=null;for(let kd=0;kd<Q.wg.length;kd++)if(Tb=this.wvl(Q.wg[kd])){if(7===hb)hb=this.EAb;else if(hb!==
this.EAb)return ya.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var zc=this.od.jRa(Tb.characterData,Tb.qa);const ce=Q.cpBegin?this.od.gAb(zc,Q.cpBegin):-1;zc=Q.cpEnd?this.od.gAb(zc,Q.cpEnd):-1;if(-1>ce||-1>zc)return ya.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;za[kd]=ag.a.ZP(ce,zc,!1,Tb);switch(Q.contentType){case 5:if(!sl.HyperlinkReader.qii(za[kd],!1))return!1;break;case 6:if(!tn.ImageReader.w3(za[kd]))return!1;
break;case 7:za[kd]=ag.a.ZP(-1,-1,!1,Tb)}}else return!1;za=new Tn.Selection(za,!1);return this.Ufo(Tb,za,Q.contentType)}wvl(Q){if(this.vR)for(this.vR.reset(),this.EAb=7;this.vR.moveNext();){var za=this.vR.currentNode.type;if(38===za||36===za||23===za)this.EAb=za;else if(12===za){za=this.vR.currentNode;const hb=za.ia(Un.a.Lc,0);if(Q===hb)return za}}return null}feg(Q){this.ga.processAction(Vh.a.iT,2);this.ga.processAction(Vh.a.p7,2);let za=2;switch(this.EAb){case 23:za=32;break;case 38:za=this.ga.Rb(Vh.a.rlb,
2,new kk.a(Q));break;case 36:za=this.ga.Rb(Vh.a.Njb,2,new kk.a(Q));break;default:ya.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.EAb)}if(32===za)return!0;ya.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.EAb);return!1}Ufo(Q,za,hb){if(this.feg(Q)){Q=this.Gt.ju;const Tb=this.ib.hb.lb;Tb&&Tb.equals(za)&&this.ed.xca(Q,null);this.ed.xca(Q,za);switch(hb){case 0:case 1:this.ga.processAction(uh.a.KMb,2);break;case 2:this.ga.processAction(uh.a.H4c,
2);break;case 3:this.ga.processAction(uh.a.Uxa,2)}return!0}return!1}}Object(e.a)(lf,"WordAccessibilityCheckNavigateManager",null,[1905]);class Tg{constructor(Q){this.EIa=null;this.lTg=Q}get fileId(){return this.lTg?this.lTg():null}initialize(Q){this.EIa=Q}TMi(Q){this.EIa.adf(Q)}}Object(e.a)(Tg,"AAccessibilityCheckService",null,[65,9]);class dm{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(Q){Q=Sys.Serialization.JavaScriptSerializer.deserialize(Q);
const za=Q.AccessibilityRules,hb={};if(za)for(let Tb=0;Tb<za.length;++Tb){const zc=za[Tb];hb[zc.Key]=zc.Value}Q.AccessibilityRules=hb;return Q}}Object(e.a)(dm,"AccessibilityCheckResultCollection",null,[]);class Hc extends Tg{constructor(Q){super(Q);this.onFailure=(za,hb)=>{ya.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",hb);za=Object.assign(new dm,{IsSuccess:!1});this.TMi(za)};this.onSuccess=za=>{za=Hc.e3l(za);let hb=null;if(za)try{hb=this.ndl(za)}catch(Tb){ya.ULS.shipAssertTag(20730843,
334,!1,"AccChecker response data is invalid. [{0}]",Tb.message),hb=Object.assign(new dm,{IsSuccess:!1})}else ya.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),hb=Object.assign(new dm,{IsSuccess:!1});this.TMi(hb)}}dispose(){}static e3l(Q){let za=null;Q&&Q.Ij&&(za=Q.Ij[0]);return za?za.Body:null}}Object(e.a)(Hc,"ALiveBooksAccessibilityCheckService",Tg,[]);var Af=c(989),fh=c(247);class Kq extends fh.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}Cl(){return 56}static construct(Q,
za){const hb=new Kq;hb.FileId=Q;hb.IsCoauthorable=za;return hb}}Object(e.a)(Kq,"WordAccessibilityCheckRequest",fh.a,[]);class nm{}Object(e.a)(nm,"AccessibilityCheckRule",null,[]);var ym=c(160);class Do{static parse(Q){switch(db.a.fh(Q)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw Q=String.format("Invalid Accessibility result category: {0}",Q),ym.a.argument(Q);}}}Object(e.a)(Do,"AccessibilityRuleCategoryParser",null,[]);class Ak{constructor(){this.Category=
this.Text=this.Id=null}static KCo(Q){const za=new nm;za.RuleId=Q.Id;za.RuleName=Q.Text;za.Category=Do.parse(Q.Category);return za}}Object(e.a)(Ak,"WordAccessibilityCheckRule",null,[]);class Yf{}Object(e.a)(Yf,"AccessibilityCheckResult",null,[]);class tc{constructor(){this.cpEnd=this.cpBegin=this.wg=null;this.contentType=0}}Object(e.a)(tc,"WordAccessibilityCheckContentId",null,[]);const Qk=Q=>{switch(db.a.fh(Q)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;
case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var cq=c(1581);class Eo{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static ICo(Q){const za=new Yf;za.RuleId=Q.RuleId;za.ContentName=Q.Label;const hb=new tc;hb.wg=Q.ParaId;hb.cpBegin=cq.b(Q.OS);hb.cpEnd=cq.b(Q.OE);hb.contentType=Qk(Q.ContentType);za.ContentId=hb;return za}}Object(e.a)(Eo,"WordAccessibilityViolation",null,
[]);class zm{constructor(){this.Violations=this.Rules=null}static JCo(Q){const za=new dm;try{var hb={};if(Q.Rules){for(let Tb=0;Tb<Q.Rules.length;++Tb){const zc=Ak.KCo(Q.Rules[Tb]);hb[zc.RuleId]=zc}za.AccessibilityRules=hb}if(Q.Violations){const Tb=Array(Q.Violations.length);for(hb=0;hb<Q.Violations.length;++hb)Tb[hb]=Eo.ICo(Q.Violations[hb]);za.Results=Tb}za.IsPartialResult=!1;za.IsSuccess=!0}catch(Tb){ya.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",
Tb.message),za.IsSuccess=!1}return za}}Object(e.a)(zm,"WordAccessibilityCheckResult",null,[]);class Vn extends Hc{constructor(Q,za,hb){super(Q);this.UTb=za;this.ptb=hb}K2n(){const Q=Object.assign(new Af.a,{Jr:Kq.construct(this.fileId,this.ptb),status:1,FH:"AccessibilityCheck"});this.UTb(12,!1,this.onSuccess,this.onFailure,Q,null,Q)}ndl(Q){Q=Xa.b(Q);return zm.JCo(Q)}}Object(e.a)(Vn,"WordAccessibilityCheckService",Hc,[]);class qk extends rd{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}yc(Q){super.yc(Q);
Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new ji(l.AFrameworkApplication.xa,vb.a.instance,ci.FocusManager.instance(),Fc.a.instance,Q.We("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Db.KeyInputManager.instance,Gd.a.instance,l.AFrameworkApplication.K.kb("AccessibilityCheckerHelpUrl"))).singleInstance();Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new Vn(()=>l.AFrameworkApplication.rootQuerySignature,Wi.a.jQ,sn.PageReader.instance.zOd(Pe.App.ya.jb.Wc))).singleInstance();
Q.ha("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new lf(Pe.App.ya.jb,Q.resolve("Box4.Graph.IGraphIteratorFactory"),fk.PageNavigator.instance,Q.resolve("Box4.ISelectionManager"),l.AFrameworkApplication.xa,me.InteractiveViewManager.instance,Q.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).singleInstance();Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new Lc(l.AFrameworkApplication.xa,Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),
Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),Q.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),Pe.App.jk.Kl,Ad.App.xTc)).singleInstance()}init(){this.container.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>{rd.prototype.init.call(this)})}}Object(e.a)(qk,"WordAccCheckerPackageManager",rd,[]);class Pp{constructor(Q,za){this.ieh=!1;this.VFo=()=>{this.UFo()};this.Lk=Q;this.mI=za}alb(Q){Q.zX.osk(this.VFo)}UFo(){!this.ieh&&this.Lk&&(this.Lk.nFa?
this.mI?this.mI.execute(Q=>{Q.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):ya.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.ieh=!0)}}Object(e.a)(Pp,"CoauthSurveyManager",null,[1849]);class tl{constructor(){this.Gt=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){Pe.App.ya&&(this.Gt=Pe.App.ya.jb)&&(this.Gt.Sva?this.pia():this.Gt.sea(()=>{this.pia()}))}pia(){var Q=this.Gt.Wc;Q&&(Q=Q.contentReplicator)&&
this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").alb(Q)}dispose(){}yc(Q){this.W=Q;Q.ha("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new Pp(Q.resolve("WordEditor.IWordEditorCoauthManager"),Q.Sa("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").singleInstance()}static main(){l.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&K.a.instance.Gc(new tl)}}Object(e.a)(tl,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var un;(function(Q){Q[Q.graphSpaceReplicatorNotSendingContent=
0]="graphSpaceReplicatorNotSendingContent";Q[Q.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";Q[Q.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(un||(un={}));Object(e.b)("ComponentLoggingScenario",un);var fo=c(1443);class oo{flush(Q,za){const hb=this.vMl(Q);hb.LoggingScenario=un[za];Cc.a(hb).length?ya.ULS.sendTraceTag(594571986,3013,15,"{0}",hb):ya.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",
fo.a[Q.lZa])}vMl(Q){const za={};if(!Q)return za;const hb=new gf.a;for(hb.enqueue(Q);!hb.isEmpty;){Q=hb.dequeue();const Tb=fo.a[Q.lZa];try{za[Tb]=Q.fB()}catch(zc){ya.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Tb.toString(),{["Kind"]:"Exception",["Stack"]:zc.stack,["Message"]:zc.message,["FileName"]:zc.fileName,["LineNumber"]:zc.lineNumber})}if((Q=Q.NDd)&&Q.length)for(const zc of Q)!zc||fo.a[zc.lZa]in za||hb.enqueue(zc)}return za}}
Object(e.a)(oo,"ComponentStateLogManager",null,[1848]);class sd{flush(){}}Object(e.a)(sd,"NoOpComponentStateLogManager",null,[1848]);class Bk{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}yc(Q){this.W=Q;l.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?Q.ha("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new oo).as("Common.IComponentStateLogManager").singleInstance():
Q.ha("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new sd).as("Common.IComponentStateLogManager").singleInstance()}static main(){K.a.instance.Gc(new Bk)}}Object(e.a)(Bk,"WordEditorComponentStateLoggingPackage",null,[1,2]);var rq=c(2007);class Tj{constructor(Q,za,hb){this.Of=Q;this.ztd=za;this.k9g=hb}oj(Q,za,hb,Tb,zc,kd,ce,df,bf,Vf=null,rh=!1,ij=null,vi=null,ti=null,nk=null,Wj=!1){return this.k9g?this.ztd.oj(Q,za,hb,Tb,zc,kd,ce,df,bf,Vf,rh,vi,ti):this.Of.oj(Q,za,hb,Tb,zc,kd,ce,
df,bf,Vf,rh,ij,vi,ti,nk,Wj)}o7b(Q){return this.k9g?this.ztd.o7b():this.Of.o7b(Q)}}Object(e.a)(Tj,"ClientRequestAdapter",null,[939]);var Hp=c(188),Fo=c(269),om=c(272),Om=c(1392),Ln=c(294),Qp=c(1403),Wn=c(2008),jj=c(56),rk=c(736),Yh=c(604),Uj=c(125),Ck=c(583),Ng=c(485),Pm;(function(Q){Q[Q.none=0]="none";Q[Q.getCells=1]="getCells";Q[Q.hotStoreStatus=2]="hotStoreStatus";Q[Q.saveMonitor=3]="saveMonitor";Q[Q.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";Q[Q.kickoutExecutor=5]="kickoutExecutor"})(Pm||
(Pm={}));Object(e.b)("MostRecentRevisionIdOrigin",Pm);class ka extends Sys.EventArgs{constructor(Q,za,hb,Tb){super();this.wVc=Q;this.httpStatusCode=hb;this.CH=Tb}}Object(e.a)(ka,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class Za{constructor(){this.o6=0}get isEmpty(){return!this.o6}CCc(Q){this.o6|=Q}cUc(Q){return!!(this.o6&Q)}clear(){this.o6=0}DEc(){return!1}}Object(e.a)(Za,"DocxSaveMonitorRetryAttemptOnce",null,[]);class Cb{constructor(Q,za=3){this.o6=0;this.Nrd=new Map;this.S4j=Q;this.Cak=
za}get isEmpty(){return!this.o6}CCc(Q){this.o6|=Q;let za=this.Nrd.get(Q)||0;this.Nrd.set(Q,++za)}cUc(Q){return!!(this.o6&Q)}clear(){this.o6=0;this.Nrd.clear()}DEc(Q){return this.Cak&Q?(this.Nrd.get(Q)||0)<this.S4j:!1}}Object(e.a)(Cb,"DocxSaveMonitorRetryAttemptMany",null,[]);class Rb{static create(Q=!1,za=3,hb=0){return Q?new Cb(za,hb):new Za}}Object(e.a)(Rb,"DocxSaveMonitorRetryAttemptFactory",null,[]);var sc=c(1700),Wc;(function(Q){Q[Q.Ubp=-1]="noResultYet";Q[Q.dhp=0]="upToDate";Q[Q.Lep=1]="sessionLost";
Q[Q.jhp=2]="userSignedOut";Q[Q.xdp=3]="previousRequestPending";Q[Q.cce=4]="requestFailed";Q[Q.efp=5]="shuttingDown";Q[Q.Zbp=6]="nullResponseData";Q[Q.dap=7]="invalidResponseData";Q[Q.f9o=8]="failedRevisionLookup";Q[Q.qep=9]="savedWithinThreshold";Q[Q.Wbp=10]="notSavedWarning";Q[Q.wap=11]="kickoutThreshold";Q[Q.Ogp=12]="unknownRevision";Q[Q.i7o=13]="contentNotYetLoaded";Q[Q.sessionExpired=14]="sessionExpired";Q[Q.canaryError=15]="canaryError";Q[Q.timeout=16]="timeout";Q[Q.xap=17]="kickoutThreshold_Offline";
Q[Q.k8o=18]="dssSessionDeleted";Q[Q.l8o=19]="dssSessionExpired";Q[Q.php=20]="waitingForSessionTokenRefresh";Q[Q.m8o=21]="dssSessionNotFound"})(Wc||(Wc={}));Object(e.b)("SaveMonitorResult",Wc);class xd{constructor(Q,za,hb,Tb,zc,kd,ce,df,bf,Vf,rh,ij,vi,ti,nk,Wj,Dm,ek,co,Sr,xo,Zl,Vm,xa,Ua,Ja=null,va){this.gwc=0;this.XUb=!1;this.Nyc=null;this.Quc=this.mN=-1;this.gMe=null;this.mqd=0;this.nqd=!1;this.Mub=null;this.Pwc=0;this.SOe=this.mfh=null;this.TR=this.y0g=this.Rqc=0;this.uGe=null;this.FYg=!1;this.el=
null;this.Atd=0;this.cvd=void 0;this.lch=!1;this.K$g=0;this.och=this.qch=!1;this.Ewl=()=>{var Wa;ya.ULS.sendTraceTag(524871194,xd.Nm,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.JQ,["AppVisibilityState"]:Om.a[null===(Wa=this.el)||void 0===Wa?void 0:Wa.VA]});try{if(this.lch&&this.rsc){var mb=this.rsc();ya.ULS.sendTraceTag(509367249,xd.Nm,50,"Additional Details: {0}",mb)}}catch(Lb){Wa=Xa.c({["Kind"]:"Exception",["Stack"]:Lb.stack,["Message"]:Lb.message,["FileName"]:Lb.fileName,["LineNumber"]:Lb.lineNumber}),
ya.ULS.sendTraceTag(509367062,xd.Nm,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Wa)}Wa=this.Qtb;this.Qtb=this.vz();if(this.h$())this.Cz.event(5),this.stop("session has shut down");else if(this.L$a===xd.o9i&&this.Cya(this.gsb),mb=this.zsc())if(this.KEe()&&l.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),this.JQ)this.Cz.event(0);else if(this.aVb())this.Cz.event(1),this.stop("session is lost"),
l.AFrameworkApplication.ye("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.FYg&&!this.UEm()&&(ya.ULS.sendTraceTag(554726995,xd.Nm,10,"DocxSaveMonitor: Session lost but not kicked out"),this.nB(jj.a.GPh));else if(this.KEe())20!==this.Cz.currentState?(this.Cz.event(20),this.mfh=this.vz(),ya.ULS.sendTraceTag(593510691,xd.Nm,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.nfh)):this.vz().getTime()-this.mfh.getTime()>this.nfh&&
(this.Cz.event(14),this.MZd(20,jj.a.XHd,"TokenExpired"));else if(this.S2j())if(this.Qtb=Wa,this.XUb)this.Cz.event(3),this.vz().getTime()-this.Nyc.getTime()>this.FFe&&(Wa=this.zte.o7b(this.mN),ya.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.mN,Sn.a[Wa]),this.zrd&&this.zrd.log(),this.stop("stuck on previousRequestPending"),this.nB());else if(Wa=Yh.b(sc.a.construct(mb)),this.XUb=!0,this.Nyc=this.mak(),this.mN=this.zte.oj(xd.serviceUrl,
2,Wa,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.qPk,this.pPk,null,void 0,void 0,this.MMe,this.Lsd,void 0,void 0,!0),0>=this.mN)this.XUb=!1,ya.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.mN.toString());else{Wa=this.zte.o7b(this.mN);mb=100;if(Wa&&1!==Wa||this.dWg)mb=50;ya.ULS.sendTraceTag(19161612,xd.Nm,mb,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.mN,["Status"]:Sn.a[Wa]});this.zrd&&this.zrd.start(this.mN)}else this.Cz.event(2);
else this.Cz.event(13)};this.pPk=Wa=>{this.TR=this.WDd+1;let mb=this.XUb=!1,Lb=!1;Wa=Wa.data;Ta.a.Yk&&l.AFrameworkApplication.loa("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");Wa?(ya.ULS.sendTraceTag(22552773,xd.Nm,15,"Request failed {0}",{["Status"]:Wa.status,["HttpStatus"]:Wa.Ve,["Correlation"]:Wa.vj?Wa.vj[Ln.a.g7]:"",["Id"]:Wa.id,["ConsecutiveErrors"]:this.WDd,["Request.InvokedTime"]:Wa.tH,["Request.EnqueueTime"]:Wa.GNa,["Request.CompletedTime"]:Wa.XS}),Lb=7===Wa.status||
13===Wa.status,this.DEc(2)&&Lb?(this.GUa.CCc(2),mb=!0,this.Quc=Wa.Ve,this.Cz.event(16)):this.DEc(1)&&5===Wa.status?(this.GUa.CCc(1),mb=!0,this.Quc=Wa.Ve,this.Cz.event(15)):(this.Cz.event(4),this.Quc=Wa.Ve)):(this.Cz.event(4),ya.ULS.sendTraceTag(23425240,xd.Nm,15,"RequestFailed and event data is null"));if(!mb&&(this.GUa.clear(),Lb?this.MZd(17,jj.a.xjl,"while offline"):this.MZd(11,jj.a.Cdf,"while online")))return;this.Cya(mb?this.DFl(Lb):this.gsb)};this.qPk=Wa=>{this.TR=this.WDd+1;this.XUb=!1;var mb=
{};this.GUa.clear();if(Wa=Wa.data){var Lb=Wa.vj?Wa.vj[Ln.a.g7]:"";mb.HttpStatus=Wa.Ve;mb.Correlation=Lb;mb.Id=Wa.id;ya.ULS.sendTraceTag(23425242,xd.Nm,this.dWg?50:100,"Request succeeded at the HTTP level {0}",mb);this.Quc=Wa.Ve}else ya.ULS.sendTraceTag(23425241,xd.Nm,15,"Request succeeded with null response data");if(this.h$()||!this.YHd)this.Cz.event(5),this.stop("session has shut down");else if(!this.TJm())if(Wa&&Wa.we)if(Wa=this.lua(Wa.we))if(this.S1.ATa(Wa),Wa.StatusCode)this.OOm(Wa,mb)||this.Cz.event(8,
mb);else{this.TR=0;this.Qtb=this.vz();this.YNe.clear();mb={["LastSavedRevisionId"]:Wa.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:Wa.RevisionSequenceNumber};Wa=Uj.b(Wa.LastSavedRevisionId);this.Ohc(Wa,3);var ec=this.ymf().store.getRevision(Wa);if(ec){Wa=null;Lb=this.Bgb();ec=(ec=ec.$_a(Lb))?ec.id:gj.a.nil;let Gc=Lb;for(;Gc&&!Gc.id.equals(ec);)Wa=Gc,Gc=Gc.gm;this.cgm(Wa,mb,Lb)||this.Cz.event(9)}else this.Mem()||this.Cz.event(12,mb);this.Cya(this.CYb)&&ya.ULS.sendTraceTag(22552774,xd.Nm,
50,"Received response from server -- going back to normal interval")}else this.Cz.event(7),this.uFf("invalid response",mb);else this.Cz.event(6),this.uFf("null response",mb)};this.A0n=(Wa,mb)=>{Wa={};Wa.DocxSaveMonitorState=Wc[mb.newState];Wa.PreviousState=Wc[mb.NXf];Wa.PreviousStateHits=mb.OXf;Wa.PreviousStateTransitionTime=mb.PXf.toISOString();Wa.LastHttpStatus=this.Quc;Wa.LastSuccessTime=this.Qtb.toISOString();this.Nyc&&(Wa.LastRequestStartTime=this.Nyc.toISOString());Wa.LastSavedRevisionID=this.O2d.toString();
Wa.LastSavedRevisionIdOrigin=this.gwc;Wa.LastSavedRevisionIdSetTime=this.SOe?this.SOe.toISOString():null;Wa.IsViable=this.ff.swa;Wa.IsNetworkConnected=this.ff.vH;Wa.IsExpired=this.ff.kba;Wa.HasEmergencyViewModeBeenDeployed=this.ff.xj;Wa["Navigator.Online"]=window.navigator.onLine;const Lb=mb.rvo;Lb&&xd.KHi(Wa,Lb);mb=mb.newState;switch(mb){case 13:ya.ULS.sendTraceTag(5830086,xd.Nm,50,"{0}",Wa);break;case 1:ya.ULS.sendTraceTag(5884125,xd.Nm,50,"{0}",Wa);break;case 0:ya.ULS.sendTraceTag(5830087,xd.Nm,
50,"{0}",Wa);break;case 2:ya.ULS.sendTraceTag(5830088,xd.Nm,50,"{0}",Wa);break;case 3:ya.ULS.sendTraceTag(5830089,xd.Nm,50,"{0}",Wa);break;case 4:ya.ULS.sendTraceTag(5884126,xd.Nm,50,"{0}",Wa);break;case 5:ya.ULS.sendTraceTag(5884127,xd.Nm,50,"{0}",Wa);break;case 6:ya.ULS.shipAssertTag(5830090,xd.Nm,!1,"{0}",Wa);break;case 7:ya.ULS.shipAssertTag(5830091,xd.Nm,!1,"{0}",Wa);break;case 8:ya.ULS.sendTraceTag(5830092,xd.Nm,15,"{0}",Wa);break;case 10:ya.ULS.sendTraceTag(5830094,xd.Nm,15,"{0}",Wa);break;
case 9:ya.ULS.sendTraceTag(5884128,xd.Nm,50,"{0}",Wa);break;case 11:ya.ULS.sendTraceTag(5830096,xd.Nm,15,"{0}",Wa);break;case 17:ya.ULS.sendTraceTag(37835678,xd.Nm,15,"{0}",Wa);break;case 12:ya.ULS.sendTraceTag(5830095,xd.Nm,15,"{0}",Wa);break;case 18:ya.ULS.sendTraceTag(38122832,xd.Nm,15,"{0}",Wa);break;case 19:ya.ULS.sendTraceTag(38122833,xd.Nm,15,"{0}",Wa);break;case 21:ya.ULS.sendTraceTag(0,xd.Nm,15,"{0}",Wa);break;case 14:ya.ULS.sendTraceTag(6575508,xd.Nm,15,"{0}",Wa);break;case 15:ya.ULS.sendTraceTag(36739287,
xd.Nm,50,"{0}",Wa);break;case 16:ya.ULS.sendTraceTag(36767649,xd.Nm,15,"{0}",Wa);break;case 20:ya.ULS.sendTraceTag(593510690,xd.Nm,15,"{0}",Wa);break;default:ya.ULS.shipAssertTag(5884129,xd.Nm,!1,"Bad state:{0} logInfo:{1}",mb,Wa)}};this.CYb=Q;this.gsb=za;this.L$a=Q;this.Hhh=hb;this.yck=Tb;this.MMe=kd;this.Lsd=ce;this.iWb=df;this.nPg=bf;this.zte=Vf;this.X5=rh;this.S1=ij;this.zsc=vi;this.S2j=ti;this.aVb=nk;this.KEe=Wj;this.h$=Dm;this.vz=ek;this.mak=co;this.FYg=Ua;this.GUa=Rb.create(va.isEnabled,va.maxRetries,
Zl.o6);this.YNe=new Ng.a;this.rsc=Vm;this.Cz=new Qp.a(-1);this.ff=Ja;this.Cz.zYe(this.A0n);this.zrd=Sr;this.Qtb=ek();this.dWg=xo;this.UOj=va.isEnabled?null:Zl;this.Tqb=xa;this.nfh=this.Hhh;this.sIe=gj.a.nil;this.ra=new M.a;pa.a.instance.Sa("Common.App.VisibilityManagement.IVisibilityManager").execute(Wa=>{this.el=Wa;this.el.uMa((mb,Lb)=>{this.oX(mb,Lb)});this.rMe=Wa.VA});this.ff&&this.ff.dYe((Wa,mb)=>{this.kJb(Wa,mb)});this.FFe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",
zc):zc;this.K$g=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",this.gsb):this.gsb;this.lch=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldLogAdditionalInfoEachTick",!0):!0;this.qch=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldOnlyKickoutWhenVisible",!1):!1;this.och=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotKickoutFromDocxSaveMonitor",!1):!1;this.Dak=va}kJb(Q,za){ya.ULS.sendTraceTag(528577692,xd.Nm,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Wn.a[za.sPf],Wn.a[za.dYc]);1!==za.dYc&&3!==za.dYc&&(ya.ULS.sendTraceTag(528566343,xd.Nm,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.GUa.cUc(1),this.GUa.cUc(2)),this.GUa.clear())}get YHd(){return this.Rqc}get O2d(){return this.sIe}get JQ(){const Q=
!this.Bgb()||this.O2d.equals(this.Bgb().id);Q||ya.ULS.sendTraceTag(521413851,xd.Nm,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.Bgb().id.toString(),this.O2d.toString());return Q}get iui(){return this.vz().getTime()-this.Qtb.getTime()>this.FFe}get WDd(){return this.TR}get lZa(){return 3}get NDd(){let Q=null;Pe.App.ya&&Pe.App.ya.jb&&Pe.App.ya.jb.Wc&&(Q=Pe.App.ya.jb.Wc.contentReplicator);return[Q,Ad.App.z0]}oX(Q,za){var hb,Tb,zc;Q={["VisibilityState"]:Om.a[this.el.VA],
["IsVisible"]:this.el.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.XUb,["KickoutIntervalElapsed"]:this.iui,["LastSuccessfulIterationTime"]:null!==(hb=this.Qtb)&&void 0!==hb?hb:"null",["RequestStartTime"]:null!==(Tb=this.Nyc)&&void 0!==Tb?Tb:"null",["SkippedKickouts"]:this.Atd,["LastSkippedKickoutAt"]:null!==(zc=this.E0g)&&void 0!==zc?zc:"null"},["IsViable"]:this.ff.swa,["IsNetworkConnected"]:this.ff.vH,["IsExpired"]:this.ff.kba,["HasEmergencyViewModeBeenDeployed"]:this.ff.xj,["Navigator.Online"]:window.navigator.onLine};
ya.ULS.sendTraceTag(539874775,xd.Nm,50,Xa.c(Q));this.rMe!=this.el.VA&&(0==za.oldState||1==za.oldState||0!==za.newState&&1!==za.newState||this.Cya(this.K$g),0===this.el.VA?(vf.c(Vh.a.kFk,void 0,void 0,void 0,void 0,void 0,Q),this.cvd&&vf.b("AvgTimeSpentOutsideOfWord",Date.now()-this.cvd,1),this.cvd=void 0):0===this.rMe&&(vf.c(Vh.a.lFk,void 0,void 0,void 0,void 0,void 0,Q),this.cvd=Date.now()),this.rMe=this.el.VA)}start(){this.Rqc=this.nPg.veb(this.Ewl,this.L$a)}Cya(Q){if(!this.YHd||this.L$a===Q)return!1;
const za=this.L$a;this.L$a=Q;this.stop("changing save monitor interval from "+za+"ms to "+Q+"ms");this.start();return!0}Ohc(Q,za){if(za>=this.gwc&&Q&&!gj.a.nil.equals(Q)){var hb=!this.sIe.equals(Q);this.gwc=za;this.sIe=Q;const Tb=this.vz();this.SOe=Tb;const zc=this.JQ;hb&&(za={["Id"]:Q.toString(),["IsUpToDate"]:zc,["Origin"]:Pm[za]},this.uGe&&(za.LastUpToDateTime=this.uGe.toISOString()),(hb=this.ymf())&&hb.store&&(Q=hb.store.getRevision(Q))&&(za.LastSavedCreationTime=Q.creationTime.toISOString()),
ya.ULS.sendTraceTag(557320151,xd.Nm,50,"Updating Last Saved Revision: {0}",za));zc&&(this.uGe=Tb)}else za<this.gwc?ya.ULS.sendTraceTag(572051800,xd.Nm,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.gwc,za):ya.ULS.sendTraceTag(572051801,xd.Nm,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',za)}stop(Q){this.Se(Q)}Se(Q){this.YHd&&(ya.ULS.sendTraceTag(5830084,xd.Nm,50,"Stopping DocxSaveMonitor because {0}!",Q),this.nPg.Se(this.YHd),this.Rqc=0)}Mem(){if(0>=this.iWb)return!1;
var Q=this.CYl();if(!Q)return this.gMe=null,this.mqd=0,this.nqd=!1;this.Mub=Q.XKd;this.Mub===this.gMe?this.mqd++:(this.gMe=this.Mub,this.mqd=1,this.nqd=!1);if(this.mqd<xd.k8m)return!1;this.Pwc=+this.vz()-+this.Mub;if(this.Pwc<=this.iWb)return!1;if(!this.nqd)return this.nqd=!0,this.$_i(),!1;if(this.Tqb)this.Tqb.execute(za=>{za.flush(this,0)});else{Q="";try{this.rsc&&(Q=this.rsc())}catch(za){Q=Xa.c({["Kind"]:"Exception",["Stack"]:za.stack,["Message"]:za.message,["FileName"]:za.fileName,["LineNumber"]:za.lineNumber}),
ya.ULS.sendTraceTag(50426817,xd.Nm,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Q)}ya.ULS.sendTraceTag(50426818,xd.Nm,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.Mub.toISOString(),this.Pwc,this.iWb,Q)}this.iWb=-1;this.stop("Exceeded oldest allowed local revision");this.nB(jj.a.yjl);return!0}CYl(){let Q=null,za=this.Bgb();for(;za&&!za.kwa;)Q=za,za=za.gm;return Q}TJm(){return this.aVb()?
(this.Cz.event(1),this.stop("session is lost"),!0):this.KEe()?(this.Cz.event(14),ya.ULS.sendTraceTag(20029718,xd.Nm,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.nB(jj.a.XHd),!0):!1}ymf(){const Q=this.zsc();return Q?Q.Mc:null}Bgb(){const Q=this.ymf();return Q?Q.Gm:null}DEc(Q){return this.Dak.isEnabled?this.GUa.DEc(Q):this.UOj.cUc(Q)&&!this.GUa.cUc(Q)}DFl(Q){return Q?xd.BCo:xd.o9i}MZd(Q,za,hb){if(this.iui)if(this.el&&!this.el.isVisible)ya.ULS.sendTraceTag(540669727,xd.Nm,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),
this.Atd+=1,this.E0g=this.vz();else return this.Cz.event(Q,{}),this.stop("request failed after kickout interval "+hb),this.Tqb&&this.Tqb.execute(Tb=>{Tb.flush(this,2)}),this.nB(za),!0;return!1}OOm(Q,za){const hb=Q.StatusCode;return 88===hb||89===hb||236===hb?(za.KickoutDiagnostics=this.rsc(),88===hb?(za.Result="deleted DSS session",this.Cz.event(18,za),this.stop("deleted DSS session"),this.nB(jj.a.localCobaltDeletedSessionFault)):89===hb?(za.Result="expired DSS session",this.Cz.event(19,za),this.stop("expired DSS session"),
this.nB(jj.a.localCobaltExpiredSessionFault)):(l.AFrameworkApplication.An("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(Q=Uj.b(Q.LastSavedRevisionId),this.Ohc(Q,4)),za.Result="DSS session not found",this.Cz.event(21,za),this.stop("DSS session not found"),this.nB(jj.a.localCobaltSessionNotFound)),!0):14===hb?(this.stop("DSS returned an unspecified failure"),
this.nB(jj.a.tVm),!0):104===hb?(this.stop("this operation is disabled on the server"),!0):this.uFf("unrecognized OperationResult: "+hb,za)}uFf(Q,za){if(!this.YNe.contains(Q))this.YNe.add(Q);else if(this.MZd(11,jj.a.Cdf,Q))return za.ConsecutiveErrors=this.WDd,za.Reason=Q,ya.ULS.sendTraceTag(41997899,xd.Nm,15,"DocxSaveMonitor kickout. {0}",za),!0;this.Cya(this.gsb);return!1}cgm(Q,za,hb){let Tb=!1;if(Q){const zc=this.vz().getTime()-Q.creationTime.getTime();zc>=this.Hhh&&(Tb=!0,xd.KHi(za,this.p3l(Q,zc,
hb)),zc>=this.FFe&&10===this.Cz.currentState?(this.Cz.event(11,za),this.stop("didn't save in time"),this.nB()):(this.Cz.event(10,za),this.$_i(),this.tjf()))}return Tb}hrk(Q){this.ra.addHandler(xd.eXi,Q)}Jqk(Q){this.ra.addHandler(xd.Ajf,Q)}R5i(Q){this.ra.removeHandler(xd.Ajf,Q)}$_i(){this.ra.raiseEvent(xd.eXi)}lua(Q){let za;return({group:za}=Ck.a.H0(Q)).returnValue?za.Responses[0]:null}p3l(Q,za,hb){const Tb={};Tb.FirstUnsavedRevisionId=Q.id.toString();Tb.FirstUnsavedRevisionLengthToRoot=Q.OQ;Tb.UnsavedTimeInMs=
za;Tb.CurrentRevisionId=hb.id.toString();Tb.CurrentRevisionLengthToRoot=hb.OQ;return Tb}tjf(){Wi.a.ujf(8)}nB(Q=jj.a.Cdf){this.yck?this.och?(ya.ULS.sendTraceTag(509146274,xd.Nm,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",Q,this.K3h()),0==this.Rqc&&this.start()):this.qch&&this.el&&!this.el.isVisible?(ya.ULS.sendTraceTag(509146273,xd.Nm,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",Q,this.K3h()),0==this.Rqc&&
this.start()):(this.stop(xd.POm),Q===jj.a.XHd?this.X5.value.nB(Q,Object.assign(new rk.a,{Kea:4,EW:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,F2:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.X5.value.nB(Q,new rk.a)):ya.ULS.sendTraceTag(19247383,xd.Nm,50,"Kickout disabled")}K3h(){const Q={};var za=pa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager");Q.HasDataloss=!za.JQ;Q.UnSavedRevisionsCount=za.V6a;Q.OldestUnsavedRevisionCreationTime=za.JQ?
"":za.YCb().toString();Q.RevisionsWithOutServerRevisionSequenceNumbers=za.w2b();Q.RevisionsWithServerRevisionSequenceNumbers=za.WEd();Q.RSNManager_Diagnostics=za.fB();if(za=pa.a.instance?pa.a.instance.Ma("WordEditor.RunawayDataLossMonitor"):null)Q.RunawayDataLossMonitor_Diagnostics=za.V$i;Q.DocxSaveMonitor_Diagnostics=this.fB();(za=pa.a.instance?pa.a.instance.Ma("WordEditor.ILastSavedToHostDetailsManager"):null)&&(Q.LastSavedToHostDetailsManager_Diagnostics=za.fB());this.el&&(Q.VisibilityState=Om.a[this.el.VA]);
return Q}fB(){const Q={};this.Mub&&(Q.ORT=this.Mub.toISOString());0<this.Pwc&&(Q.AA=this.Pwc);0<this.iWb&&(Q.MAA=this.iWb);0<this.Atd&&(Q.LSKO=this.E0g.toISOString());this.Cz&&0<=this.Cz.currentState&&(Q.SMS=Wc[this.Cz.currentState]);const za={};l.AFrameworkApplication.Vna&&(za.S=1);Pe.App.lostSession&&(za.LS=1);this.ff&&(this.ff.eo&&(za.KO=1),this.ff.kba&&(za.TE=1));this.el&&(za.VS=Om.a[this.el.VA]);window.navigator&&(za.NW=!window.navigator.onLine);Q.AMD=za;return Q}dRl(){const Q={"Content-Type":"application/json; charset=utf-8",
"X-Requested-With":"Fetch"};l.AFrameworkApplication.buildVersion&&(Q["X-OfficeVersion"]=db.a.AQ(l.AFrameworkApplication.buildVersion));l.AFrameworkApplication.accessToken&&(Q["X-AccessToken"]=db.a.AQ(l.AFrameworkApplication.accessToken),Q["X-AccessTokenTtl"]=l.AFrameworkApplication.kMa.toString());l.AFrameworkApplication.canary&&(Q["X-Key"]=db.a.AQ(l.AFrameworkApplication.canary));l.AFrameworkApplication.userType&&(Q["X-UserType"]=db.a.AQ(l.AFrameworkApplication.userType));const za=l.AFrameworkApplication.Ke.c5;
za&&(Q["X-WacCluster"]=db.a.AQ(za));l.AFrameworkApplication.userSessionId&&(Q["X-UserSessionId"]=db.a.AQ(l.AFrameworkApplication.userSessionId));return Q}Vzl(){var Q=this.ff?this.ff.networkState:null;if(1===Q||3===Q)ya.ULS.sendTraceTag(558158790,xd.Nm,15,"Not sending request because we dont have network.");else if(Q=this.zsc()){var za=new Sys.Net.WebRequest;za.set_httpVerb("POST");za.set_url(xd.serviceUrl);var hb={};hb.body=Yh.b(sc.a.construct(Q));hb.headers=this.dRl();hb.method=za.get_httpVerb();
try{"function"===typeof window.fetch?window.fetch(za.getResolvedUrl(),hb).then(Tb=>{ya.ULS.sendTraceTag(561551382,xd.Nm,50,"Request succeeded at the HTTP level {0}",Tb.statusText);this.y0g=Tb.status;return Tb.json()},Tb=>{ya.ULS.sendTraceTag(561551383,xd.Nm,15,"Request failed at the HTTP level {0}",Tb);return null}).then(Tb=>{Tb=JSON.stringify(Tb);this.gPk(Tb,this.y0g);return Tb},()=>{ya.ULS.sendTraceTag(561551385,xd.Nm,15,"Request succeeded with null response data");return""}):ya.ULS.sendTraceTag(561002076,
xd.Nm,15,"Browser does not support Fetch.")}catch(Tb){ya.ULS.sendTraceTag(561551386,xd.Nm,15,String.format("Exception when attempting to get last revision save id : {0}",Tb))}}else ya.ULS.sendTraceTag(540079457,xd.Nm,15,"Target node is null, not sending last saved revision request.")}gPk(Q,za){let hb=gj.a.nil,Tb=!1,zc=-1;za===Qi.a.oz&&((Q=this.lua(Q))?(hb=Uj.b(Q.LastSavedRevisionId),Q.StatusCode||(Tb=!0,zc=Q.StatusCode)):ya.ULS.sendTraceTag(561002077,xd.Nm,50,"Response is null when attempting to get last revision save id"));
this.ra.raiseEvent(xd.Ajf,new ka(hb,Tb,za,zc))}static KHi(Q,za){for(const hb in za)Q[hb]=za[hb]}UEm(){return Pd.SessionStatusManager.instance.eo}}xd.o9i=0;xd.serviceUrl=Pe.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";xd.POm="kickout";xd.eXi="PS";xd.Ajf="FLSR";xd.Nm=343;xd.k8m=5;xd.BCo=5E4;Object(e.a)(xd,"DocxSaveMonitor",null,[1860,186]);class oe{veb(Q,za){return window.setInterval(Q,za)}Se(Q){window.clearInterval(Q)}}oe.instance=new oe;Object(e.a)(oe,"DocxSaveMonitorTaskManager",
null,[1847]);class Nd{constructor(Q){this.mN=0;this.ysa=Q}start(Q){this.ysa&&(this.mN=Q,this.ysa.reset())}log(){if(this.ysa){var Q={};Q.RequstId=this.mN;Q.InvokeCount=this.ysa.PRc;Q.InvokeFailedCount=this.ysa.QRc;Q.NoOpenConnectionCount=this.ysa.hYc;Q.SynchronousNotificationCount=this.ysa.j8c;Q.ResponseNotAvailable=this.ysa.L3c;ya.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",Q)}}}Object(e.a)(Nd,"RequestLifeCycleTelemetryManager",null,[1845]);class $e{constructor(){this.W=
this.OOe=null;this.n7k=()=>{var Q=l.AFrameworkApplication.K;if(!Q.$("DocxSaveMonitorEnabled"))return null;var za=Q.$("DocxSaveMonitorKickoutEnabled");const hb=Q.pc("DocxSaveMonitorIntervalMs",6E4),Tb=Q.pc("DocxSaveMonitorFailureIntervalMs",5E3),zc=Q.pc("DocxSaveMonitorWarningTimeMs",12E4),kd=Q.pc("DocxSaveMonitorKickoutTimeMs",36E4),ce=Q.pc("DocxSaveMonitorQueueTimeoutMs",6E4),df=Q.pc("DocxSaveMonitorSentTimeoutMs",12E4),bf=Q.pc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var Vf=Q.$("DocxSaveMonitorTelemetryInfoEnabled");
const rh=Q.$("DocxSaveMonitorInfoRequestLoggingEnabled");var ij=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),vi=Q.$("DocxSaveMonitorRawWebRequestsEnabled")||ij;ij=Q.$("ComponentStateLoggingPackageIsEnabled");Q=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var ti=l.AFrameworkApplication.Ke,nk=vi?new rq.a(l.AFrameworkApplication.userSessionId,ti.c5,ti.OLh):
null;nk=new Tj(ti,nk,vi);Vf=Vf&&ti&&!vi?new Nd(ti.Mca):null;vi=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;ti=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const Wj=Rb.create(vi,ti);Wj.CCc(1);Wj.CCc(2);ij=ij?this.W.Sa("Common.IComponentStateLogManager"):null;za=new xd(hb,Tb,zc,za,kd,ce,df,
bf,oe.instance,nk,pa.a.instance.We("Box4.IKickoutExecutor"),Fo.a.instance,this.H7b,()=>!l.AFrameworkApplication.x3d||fl.a.instance.WRc,()=>Pe.App.lostSession,Object(a.a)(Hp.a.instance,Hp.a.instance.iCa,"checkAndTriggerSessionHasExpired"),()=>l.AFrameworkApplication.Rk,()=>new Date,()=>new Date,Vf,rh,Wj,this.KDl,ij,Q,pa.a.instance.Ma("Common.ISessionStatus")||Pd.SessionStatusManager.instance,{isEnabled:vi,maxRetries:ti});za.start();ya.ULS.sendTraceTag(5884131,xd.Nm,50,"SaveMonitor initialized");return za};
this.H7b=()=>{const Q=Pe.App.ya.jb.xc;return Q?Q.Zc:null};this.KDl=()=>{const Q={};l.AFrameworkApplication.oc&&(Q.TM=l.AFrameworkApplication.oc.fB());om.WoncaApp.jF&&(Q.RS=om.WoncaApp.jF.fB());Ad.App.z0&&(Q.CRS=Ad.App.z0.fB());Pe.App.ya&&Pe.App.ya.jb&&Pe.App.ya.jb.Wc&&Pe.App.ya.jb.Wc.contentReplicator&&(Q.GSR=Pe.App.ya.jb.Wc.contentReplicator.fB());l.AFrameworkApplication.Vna&&(Q.S=1);Pe.App.lostSession&&(Q.LS=1);Pe.App.xd&&Pe.App.xd.zA.eo&&(Q.KO=1);Q.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(Q)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(Pe.App.Ds||
Pe.App.Lm)this.OOe=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.OOe&&this.OOe.stop("WordEditorDocxSaveMonitorPackage is being disposed")}yc(Q){this.W=Q;(Pe.App.Ds||Pe.App.Lm)&&Q.ha("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.n7k).as("Wonca.IDocxSaveMonitor").singleInstance()}static main(){K.a.instance.Gc(new $e)}}Object(e.a)($e,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var hf=c(941),bg=c(66),Dg={get interop(){var Q=aiInserterUx.interop;if(!Q)throw Error("aiInserterUx chunk is accessed before loading");
return Q}},Zh=c(856);class zh{constructor(Q,za){this.u7d=Q;this.A4c=za;this.FZc=(hb,Tb)=>Object(bg.__awaiter)(this,void 0,void 0,function*(){if(Tb.z4){Object(vf.a)("AiInserterInitializationTriggered");this.u7d.ppa(this.FZc);this.u7d.Pd();var [,zc]=yield Promise.all([this.tTm(),Promise.all([c.e(3),c.e(7),c.e(18)]).then(c.bind(null,2028))]);zc.main(Dg.interop)}})}initialize(){this.u7d.V$(this.FZc);this.u7d.initialize()}tTm(){return Object(bg.__awaiter)(this,void 0,void 0,function*(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("aiInserterUx"):(yield Object(Zh.c)(this.A4c)).HA.loadScript("aiInserterUx")})}}Object(e.a)(zh,"AiInserterInitializer",null,[]);var zi=c(939);class Ti extends zi.a{constructor(Q){var za;super("BooleanFeatureGateConditionId");this.Vs=Q.Vs;this.XBb=Q.XBb;this.defaultValue=null!==(za=Q.defaultValue)&&void 0!==za?za:!1}initialize(){super.initialize();const Q=l.AFrameworkApplication.K;Q.Wo(()=>{const za=Q.getBooleanFeatureGate(this.XBb,this.defaultValue);this.ii(za)})}ii(Q){super.ii(Q);
ya.ULS.sendTraceTag(512369937,3028,50,this.Q2(this.Vs,Q,`featureGate=${this.XBb}`))}}Object(e.a)(Ti,"BooleanFeatureGateCondition",zi.a,[]);var Il=c(709);class mi extends zi.a{constructor(Q,za){super("AiInserterConsentGroupConditionId");this.yea=Q;this.defaultValue=za}initialize(){super.initialize();this.yea.execute(Q=>{Q.isFeatureEnabled("AiInserter",!!this.defaultValue).then(za=>{this.ii(za);return null})})}ii(Q){super.ii(Q)}}Object(e.a)(mi,"AiInserterConsentGroupCondition",zi.a,[]);const pm="CH DE FR EU UK NO SE NL PIE".split(" ");
class po extends zi.a{constructor(){super("AiInserterDatacenterConditionId")}initialize(){super.initialize();l.AFrameworkApplication.K.Wo(()=>{var Q,za,hb,Tb;const zc=null!==(za=null===(Q=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===Q?void 0:Q.WACDatacenter)&&void 0!==za?za:"unknown";Q=null!==(Tb=null===(hb=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===hb?void 0:hb.Ring)&&void 0!==Tb?Tb:"unknown";hb=this.fzf(zc,Q);this.ii(hb)})}fzf(Q,za){if("1"===za||"unknown"===Q)return!0;
const hb=Q.toUpperCase();return!pm.some(Tb=>hb.includes(Tb))}}Object(e.a)(po,"AiInserterDatacenterCondition",zi.a,[]);class $m extends Il.a{constructor(Q){const za=new Ti({Vs:17,XBb:"Microsoft.Office.WordOnline.IsAiInserterEnabled"});Q=new mi(Q);const hb=new po;super(17,new ob.a([za,Q,hb]),null,3028,"AiInserterAppTriggered")}}Object(e.a)($m,"AiInserterTriggerModel",Il.a,[]);class pn extends hf.a{get name(){return"WordEditor.AiInserter.Entry"}oua(Q){this.container=Q}qua(){(new zh(new $m(this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),
this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}pua(){}static main(){K.a.instance.Gc(new pn)}}Object(e.a)(pn,"AiInserterEntryPackage",hf.a,[]);var pp={get tjl(){var Q=null===aiMakerDocumentWizardUx||void 0===aiMakerDocumentWizardUx?void 0:aiMakerDocumentWizardUx.interop;if(!Q)throw Error("aiMakerDocumentWizardUx chunk is accessed before loading");return Q}},Vo=c(556);class Xn{constructor(Q,za,hb,Tb,zc){this.WHd=Q;this.hli=za;this.A4c=hb;this.onm=Tb;this.rc=zc;this.Uwe=!1;this.won=
(kd,ce)=>Object(bg.__awaiter)(this,void 0,void 0,function*(){ce.z4&&this.onm.execute(df=>{df.findImageAndRegisterHandler()})});this.SRi=(kd,ce)=>Object(bg.__awaiter)(this,void 0,void 0,function*(){ce.z4&&(Object(vf.a)("AiMakerInitializationTriggered"),Object(Vo.g)("AiMakerInitializationTriggered"),this.WHd.ppa(this.SRi),this.WHd.Pd(),this.Uwe||this.eCi())});this.B0d=kd=>{Object(Vo.g)("loadDocumentWizardUxChunkOnDemand_"+kd);if(this.Uwe)return 0;this.eCi().catch(()=>{ya.ULS.sendTraceTag(509207108,
3041,10,"Failed to load AiMakerDocumentWizard Ux and wac chunks")});Object(Vo.e)()&&this.rc.$u(Vh.a.bAb,Rj.a.application,this.B0d);Object(Vo.d)()&&this.rc.$u(Vh.a.jHf,Rj.a.application,this.B0d);return 32}}initialize(){this.WHd.V$(this.SRi);this.WHd.initialize();this.hli.V$(this.won);this.hli.initialize();Object(Vo.e)()&&(this.rc.pa(Vh.a.bAb,Rj.a.application,this.B0d),this.rc.Uc(Vh.a.bAb,1028));Object(Vo.d)()&&this.rc.pa(Vh.a.jHf,Rj.a.application,this.B0d)}eCi(){return Object(bg.__awaiter)(this,void 0,
void 0,function*(){const [,Q]=yield Promise.all([this.FSm(),Promise.all([c.e(3),c.e(7),c.e(12)]).then(c.bind(null,2025))]);this.Uwe=!0;Q.main(pp.tjl);Object(Vo.d)()&&(yield Promise.all([c.e(3),c.e(7),c.e(27)]).then(c.bind(null,2033))).main()})}FSm(){return Object(bg.__awaiter)(this,void 0,void 0,function*(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiMakerDocumentWizardUx"):(yield Object(Zh.c)(this.A4c)).HA.loadScript("aiMakerDocumentWizardUx")})}}
Object(e.a)(Xn,"AiMakerInitializer",null,[]);var Lj=c(1720);class Mn extends zi.a{constructor(Q){super(Q.yDh);this.d4f=Q}initialize(){super.initialize();l.AFrameworkApplication.K.Wo(()=>{var Q,za,hb,Tb,zc;const kd=null!==(za=null===(Q=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===Q?void 0:Q.WACDatacenter)&&void 0!==za?za:"unknown";Q=null!==(Tb=null===(hb=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===hb?void 0:hb.Ring)&&void 0!==Tb?Tb:"unknown";hb=null===(zc=l.AFrameworkApplication.sessionStartInfoSettings)||
void 0===zc?void 0:zc.Host;zc=this.fzf(kd,Q,hb);this.ii(zc);ya.ULS.sendTraceTag(509747520,3028,50,this.Q2(this.d4f.Vs,zc,`datacenter=${kd}`))})}fzf(Q,za,hb){if("1"===za||"unknown"===Q||this.d4f.ETh.includes(hb))return!0;const Tb=Q.toUpperCase();return!this.d4f.oOh.some(zc=>Tb.includes(zc))}}Object(e.a)(Mn,"EditorAiDatacenterCondition",zi.a,[]);class qp extends zi.a{constructor(Q,za,hb){super("AiMakerConsentGroupConditionId");this.Vs=Q;this.yea=za;this.defaultValue=hb}initialize(){super.initialize();
this.yea.execute(Q=>{var za;Q.isFeatureEnabled("AiMaker",null!==(za=this.defaultValue)&&void 0!==za?za:!1).then(hb=>{this.ii(hb);return null})})}ii(Q){super.ii(Q);ya.ULS.sendTraceTag(509752010,3028,50,this.Q2(this.Vs,Q))}}Object(e.a)(qp,"AiMakerConsentGroupCondition",zi.a,[]);const Hk="CH DE FR EU UK NO SE NL PIE".split(" ");class Yn extends Il.a{constructor(Q,za,hb){const Tb=new Ti({Vs:16,XBb:"Microsoft.Office.WordOnline.IsAiMakerEnabled"});Q=new Lj.a(16,Q,za,{AMb:!0,oO:!1,U8b:!1,T8b:!1,nO:!1});
za=new Mn({yDh:"AiMakerDocumentWizardDatacenterConditionId",Vs:16,oOh:Hk,ETh:["Exchange Online Consumer","OneDriveWOPI"]});hb=new qp(16,hb);super(16,new ob.a([Tb,Q,za,hb]),null,3028,"BlankDocumentTriggered")}}Object(e.a)(Yn,"AiMakerDocumentWizardTriggerModel",Il.a,[]);class hk extends zi.a{constructor(Q){super("AiImageInsertedConditionId");this.i1b=Q;this.isInitialized=!1;this.rMi=()=>{this.ii(!0)}}initialize(){this.isInitialized||(super.initialize(),this.isInitialized=!0,this.i1b.execute(Q=>{var za;
null===(za=Q.add_onImageWasInsertedHandler)||void 0===za?void 0:za.call(Q,this.rMi)}))}Pd(){this.isInitialized&&(this.i1b.execute(Q=>{var za;null===(za=Q.remove_onImageWasInsertedHandler)||void 0===za?void 0:za.call(Q,this.rMi)}),this.isInitialized=!1,super.Pd())}}Object(e.a)(hk,"AiImageInsertedCondition",zi.a,[]);class vn extends Il.a{constructor(Q){const za=new Ti({Vs:19,XBb:"Microsoft.Office.WordOnline.IsAiImageRemakeEnabled"}),hb=new hk(Q);super(19,new ob.a([za,hb]),null,3028,"OnTriggerAiImageRemakeEventKey");
this.i1b=Q;this.wmi=!1;this.cmk()}Y0a(Q){super.Y0a(Q);super.Tyd()&&super.qhb("AiImageInsertedConditionId");"AiImageInsertedConditionId"!==Q||this.wmi||(this.lTn(),this.wmi=!0)}cmk(){l.AFrameworkApplication.xa.gb(Vh.a.HEd,Rj.a.view,()=>8,1028)}lTn(){l.AFrameworkApplication.xa.$u(Vh.a.HEd,Rj.a.view,()=>8)}}Object(e.a)(vn,"AiImageRemakeTriggerModel",Il.a,[]);class go extends hf.a{get name(){return"WordEditor.AiMaker.Entry"}oua(Q){this.container=Q}qua(){(new Xn(new Yn(this.container.resolve("Box4.IParagraphReader"),
Pe.App.ya.jb.xc,this.container.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),new vn(this.container.Sa("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService")),this.container.Sa("Common.IDynamicScriptLoaderProvider"),this.container.Sa("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService"),l.AFrameworkApplication.xa)).initialize()}pua(){}static main(){K.a.instance.Gc(new go)}}Object(e.a)(go,"AiMakerEntryPackage",hf.a,[]);const fp="CH DE FR EU UK NO SE NL PIE".split(" ");
class Go extends Il.a{constructor(){const Q=new Ti({Vs:18,XBb:"Microsoft.Office.WordOnline.IsAiRewriteEnabled"}),za=new Mn({yDh:"AiRewriteDatacenterConditionId",Vs:18,oOh:fp,ETh:["Exchange Online Consumer","OneDriveWOPI"]});super(18,new ob.a([Q,za]),null,3028,"AiRewriteTriggered")}}Object(e.a)(Go,"AiRewriteTriggerModel",Il.a,[]);var Cl={get interop(){var Q=null===aiRewriteUx||void 0===aiRewriteUx?void 0:aiRewriteUx.interop;if(!Q)throw Error("aiRewriteUx chunk is accessed before loading");return Q}};
class ws{constructor(Q,za){this.Ryd=Q;this.A4c=za;this.FZc=(hb,Tb)=>Object(bg.__awaiter)(this,void 0,void 0,function*(){if(Tb.z4){Object(vf.a)("AiRewriteInitializationTriggered");this.Ryd.ppa(this.FZc);this.Ryd.Pd();var [,zc]=yield Promise.all([this.pSm(),Promise.all([c.e(3),c.e(7),c.e(13)]).then(c.bind(null,2030))]);zc.main(Cl.interop)}})}initialize(){this.Ryd.V$(this.FZc);this.Ryd.initialize()}pSm(){return Object(bg.__awaiter)(this,void 0,void 0,function*(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("aiRewriteUx"):(yield Object(Zh.c)(this.A4c)).HA.loadScript("aiRewriteUx")})}}Object(e.a)(ws,"AiRewriteInitializer",null,[]);class bl extends hf.a{get name(){return"WordEditor.AiRewrite.Entry"}oua(Q){this.container=Q}qua(){(new ws(new Go,this.container.Sa("Common.IDynamicScriptLoaderProvider"))).initialize()}pua(){}static main(){K.a.instance.Gc(new bl)}}Object(e.a)(bl,"AiRewriteEntryPackage",hf.a,[]);var bs;(function(Q){Q[Q.version0=0]="version0";Q[Q.version1=1]="version1"})(bs||
(bs={}));Object(e.b)("FirstRunExperienceVersion",bs);class Lq{get LZe(){return"Word"}get Ywh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return bs.version0}get currentVersion(){return bs.version1}get CAm(){return Lq.isEnabled()&&l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get Gac(){return Lq.isEnabled()&&l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get oyi(){return l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get Sxl(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get kIi(){return 24}get Z9i(){return 4E3}get d4c(){return""}static isEnabled(){const Q=
l.AFrameworkApplication.sessionStartInfoSettings?l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==Q&&"Automation"!==Q}}Object(e.a)(Lq,"FirstRunExperienceLauncherSettings",null,[1904]);class ul{constructor(Q){this.YRg=Q}Ooo(Q){this.YRg&&this.YRg.Poo(Q)}}Object(e.a)(ul,"FirstRunExperienceManager",null,[1884]);class Rf{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}yc(Q){this.W=Q;this.W.ha("WordEditor.FirstRunExperience.IFirstRunExperienceManager",
()=>new ul(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).singleInstance()}init(){const Q=this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");Q&&Q.Ooo(new Lq)}dispose(){}}Object(e.a)(Rf,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class Vj{constructor(Q,za){this.mHa=(hb,Tb,zc,kd,ce)=>{var df,bf;if(1===zc)return ce=null===(bf=null===(df=Tb.view.nb)||void 0===df?void 0:df.hb)||void 0===bf?void 0:bf.lb,(null===ce||void 0===ce?
0:ce.uH)||hb===Vh.a.O6c&&(null===ce||void 0===ce?0:ce.Z1a)?32:8;if(2===zc){df=this.A$a.hj.isVisible;this.A$a.AB(!0,1===ce);bf=0;switch(hb){case Vh.a.zlj:ce=1;break;case Vh.a.Alj:ce=2;break;case Vh.a.Gge:ce=2;bf=1;break;case Vh.a.Hge:ce=1;bf=2;break;case Vh.a.O6c:ce=1;bf=3;break;case Vh.a.bke:ce=this.A$a.m3b;break;default:bf=ce=0}df&&hb===Vh.a.mHa||this.A$a.xbo(ce,bf);return 32}return 8};this.zTd=(hb,Tb,zc,kd,ce)=>{this.toggleButton(ce,!1);return this.cTk(zc)};this.bke=(hb,Tb,zc,kd,ce)=>this.A$a.hj.isVisible?
this.zTd(hb,Tb,zc,kd,ce):this.mHa(hb,Tb,zc,kd,ce);this.ga=Q;this.A$a=za}dispose(){this.A$a&&this.A$a.dispose()}Ub(){this.ga.pa(Vh.a.bke,Rj.a.view,this.bke);this.ga.gb(Vh.a.mHa,Rj.a.view,this.mHa,4);this.ga.pa(Vh.a.zTd,Rj.a.view,this.zTd);this.ga.gb(Vh.a.Gge,Rj.a.view,this.mHa,4);this.ga.pa(Vh.a.Hge,Rj.a.view,this.mHa);this.ga.pa(Vh.a.O6c,Rj.a.view,this.mHa)}cTk(Q){if(1===Q)return 32;this.A$a.AB(!1);return 32}toggleButton(Q,za){Q&&(Q[Fn.a.On]=za)}}Object(e.a)(Vj,"FormatPictureActor",null,[9]);class Wo{constructor(Q){this.Zwb=
!1;this.hj=Q}get m3b(){return this.hj.O9k}xbo(Q,za){switch(Q){case 0:case 1:this.hj.Lpo(za);break;case 2:this.hj.Xpo(za)}}AB(Q,za=!1){this.Zwb||this.Exf();Q?this.hj.NO(za):this.hj.jna()}dispose(){this.hj.dispose()}Exf(){this.Zwb||(this.hj.initialize(),this.Zwb=!0)}}Object(e.a)(Wo,"FormatPictureManager",null,[1859,9]);var tj=c(381),Mi=c(108),rp=c(293);class an{}an.UO=rp.a.PLd;an.qec=1;an.rec=WordEditorIntl.WordEditorStrings.L_FormatPicture;an.gua="FormatPictureTaskPaneData";Object(e.a)(an,"FormatPicturePaneConstants",
null,[]);class Im{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(e.a)(Im,"FormatPictureTaskPaneProps",null,[]);class Dl{constructor(Q,za,hb,Tb){this.bPe=0;this.qqc=this.Lka=null;this.$rd=this.Rrd=this.Amd=this.sdd=
this.vvd=0;this.ys=this.WSb=!1;this.dve=0;this.jnn=()=>{this.Sej()};this.qm=()=>{let zc=!1;zc=this.FEn()||zc;zc=this.E4a()||zc;zc=this.D4a()||zc;zc=this.sfc()||zc;(zc=this.BEn()||zc)&&this.wm()};this.k2=Q;this.B3j=za;this.BGe=hb;this.hg=Tb}initialize(){this.CZ();this.lia()}get isVisible(){return this.ys}NO(Q){this.W6c(Q)}jna(){this.tca();this.zkm()}Lpo(Q){this.chj(Q,1)}Xpo(Q){this.chj(Q,2)}chj(Q,za){this.dve=za;this.bPe=Q}get O9k(){return this.dve}dispose(){}CZ(){this.k2.lNa();this.bPe=this.dve=0}get tg(){return this.B3j.value}get rc(){return this.BGe.value}G2a(){return!!this.tg.currentScope&&
this.tg.currentScope.name===an.UO}Sej(){this.tg.mg(an.UO)}lia(){const Q=this.tg.fe(an.UO);Q.parent=kh.AFrame.qp;Q.pea(this.jnn)}tca(){this.G2a()&&this.tg.mg(this.tg.fT)}W6c(Q){Vi.UISurfaces.uu().then(za=>{za.showTaskPane(an.UO,this.Pz(Q));this.isVisible&&Q&&this.tg.mg(an.UO);return null})}wm(){Vi.UISurfaces.uu().then(Q=>{Q.updateTaskPane(an.UO,this.Pz(!1));return null})}zkm(){Vi.UISurfaces.uu().then(Q=>{Q.hideTaskPane(an.UO,2);return null})}Pz(){const Q=new Im;this.zio(Q);return Object.assign(new Kd.a,
{title:an.rec,hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:za=>{this.ys=!0;Pe.App.ya.mYa(this.qm);Pe.App.ya.updateCommandUI();this.Sej();this.hg.XZb(an.UO,za)},onClose:()=>{this.tca();this.ys=!1;Pe.App.ya.dgc(this.qm);Pe.App.ya.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}zio(Q){const za=F.e().numberFormatInfo;Q.section=this.bPe;Q.numberFormatInfo="object"===typeof za?za:null;Q.title=this.Lka;Q.description=this.qqc;Q.topCrop=this.vvd;Q.bottomCrop=
this.sdd;Q.leftCrop=this.Amd;Q.rightCrop=this.Rrd;Q.rotationAngle=this.$rd;Q.onTitleChange=this.onTitleChange();Q.onDescriptionChange=this.onDescriptionChange();Q.onCropSpinButtonChange=this.onCropSpinButtonChange();Q.onRotationSpinButtonChange=this.onRotationSpinButtonChange();Q.disabled=this.WSb}onTitleChange(){return Q=>{if(Q!==this.Lka){this.Lka=Q;var za=new tj.DictionaryPropertySet;za.setValue(Mi.a.Phb,Q);this.rc.Rb(uh.a.w5c,2,za);this.wm()}}}onDescriptionChange(){return Q=>{if(Q!==this.qqc){var za=
new tj.DictionaryPropertySet;za.setValue(Mi.a.xX,Q);this.qqc=Q;this.rc.Rb(uh.a.$Mb,2,za);this.wm()}}}onCropSpinButtonChange(){return(Q,za)=>{const hb=new tj.DictionaryPropertySet;switch(za){case 0:this.vvd=Q;hb.setValue(Mi.a.Uhb,Q);this.rc.Rb(Vh.a.zQc,2,hb);break;case 1:this.sdd=Q;hb.setValue(Mi.a.Rhb,Q);this.rc.Rb(Vh.a.wQc,2,hb);break;case 2:this.Amd=Q;hb.setValue(Mi.a.Shb,Q);this.rc.Rb(Vh.a.xQc,2,hb);break;case 3:this.Rrd=Q,hb.setValue(Mi.a.Thb,Q),this.rc.Rb(Vh.a.yQc,2,hb)}this.wm()}}onRotationSpinButtonChange(){return Q=>
{this.$rd=Q;const za=new tj.DictionaryPropertySet;za.setValue(Mi.a.GQc,0);za.setValue(Mi.a.WI,Q);this.rc.Rb(uh.a.imageRotate,2,za);this.wm()}}FEn(){const Q=2===this.rc.Rb(uh.a.w5c,1,null),za=Q!==this.WSb;this.WSb=Q;return za}E4a(){var Q=new tj.DictionaryPropertySet;this.rc.Rb(uh.a.E4a,2,Q);Q=Q.ia(Mi.a.Phb,"");const za=Q!==this.Lka;this.Lka=Q;return za}D4a(){var Q=new tj.DictionaryPropertySet;this.rc.Rb(uh.a.D4a,2,Q);Q=Q.ia(Mi.a.xX,"");const za=Q!==this.qqc;this.qqc=Q;return za}sfc(){var Q=new tj.DictionaryPropertySet;
this.rc.Rb(Vh.a.d1c,2,Q);const za=Q.ia(Mi.a.Uhb,0),hb=Q.ia(Mi.a.Rhb,0),Tb=Q.ia(Mi.a.Shb,0);Q=Q.ia(Mi.a.Thb,0);const zc=za!==this.vvd||hb!==this.sdd||Tb!==this.Amd||Q!==this.Rrd;this.vvd=za;this.sdd=hb;this.Amd=Tb;this.Rrd=Q;return zc}BEn(){var Q=new tj.DictionaryPropertySet;this.rc.Rb(uh.a.fLb,2,Q);Q=Q.ia(Mi.a.WI,0);const za=Q!==this.$rd;this.$rd=Q;return za}}Object(e.a)(Dl,"ReactFormatPicturePane",null,[1850,9]);class Ue{constructor(){this.Rhd=this.W=null}get name(){return"WordEditor.FormatPicture"}yc(Q){this.W=
Q;this.W.ha("WordEditor.FormatPicture.IFormatPictureManager",()=>new Wo(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"))).singleInstance();this.W.ha("WordEditor.FormatPicture.IFormatPicturePane",()=>new Dl(Gd.a.instance,new $b.a(()=>ci.FocusManager.instance()),new $b.a(()=>l.AFrameworkApplication.xa),vb.a.instance)).singleInstance();this.W.ha("WordEditor.FormatPicture.FormatPictureActor",()=>new Vj(l.AFrameworkApplication.xa,this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"))).singleInstance()}init(){if(Ad.App.Rlg||
Ad.App.GEj)this.Rhd=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.Rhd.Ub(),Pe.App.ya.updateCommandUI()}dispose(){this.Rhd&&this.Rhd.dispose()}static main(){K.a.instance.Gc(new Ue)}}Object(e.a)(Ue,"WordEditorFormatPicturePackage",null,[1,2]);var bn=c(1467),Gn=c(542);class Rk extends fh.a{constructor(){super();this.Prompt=0;this.FileId=null}Cl(){return 100}static construct(Q,za){const hb=new Rk;hb.FileId=Q;hb.Prompt=za;return hb}}Object(e.a)(Rk,"GraphMergeConsentChangedRequest",
fh.a,[]);var Xo=c(595);class Ho extends Xo.a{constructor(){super();this.Location=this.FileId=null}Cl(){return 34}static construct(Q,za){const hb=new Ho;hb.FileId=Q;hb.Location=za;return hb}}Object(e.a)(Ho,"PlayGraphMergeReplayRequest",Xo.a,[]);class Mj{constructor(Q,za,hb,Tb,zc,kd=null,ce=null){this.Xl=!1;this.hN=null;this.obh=this.iFe=!1;this.e7e=()=>{if(this.gza.mTd)this.iFe=!0;else if(this.iFe=!1,!this.I8n){this.obh=!0;var df=this.dJa.oxa;ya.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",
400===df);if(100===df||400===df)df=Rk.construct(this.dS(),df),this.Rw(df)}};this.vhi=(df,bf)=>{bf&&bf.sKf&&bf.sKf.n9e&&!this.gza.syi&&(this.gza.Nxj(),this.gza.mTd=!0,this.Rw(bf.sKf.n9e))};this.thi=(df,bf)=>{bf&&bf.Dad&&this.gza.Nxj()};this.uhi=(df,bf)=>{bf&&(bf.ShowMergePrompt&&this.dJa.R7i(this.e7e),l.AFrameworkApplication.Sg&&(l.AFrameworkApplication.Sg.SessionMergeInfo|=bf.PartMergeInfo))};this.dS=Q;this.Swd=hb;this.gza=Tb;this.dJa=zc;this.Swd&&this.Swd.Oqk(this.vhi);this.S1=kd||Fo.a.instance;
if(!ce){const df=new Gn.a;ce=bf=>df.Ifa(0,bf)}this.zQj=ce}get YMm(){return this.iFe}get I8n(){return this.obh}Rw(Q){const za=new Af.a;za.Jr=Q;za.status=1;za.FH="GraphMerge";const hb=this.zQj(()=>{this.K3c(za,33===Q.Cl())});hb.pI(za);hb.jT()}K3c(Q,za){this.Xl||(za&&(this.gza.mTd=!1),2===Q.statusCode&&!Da.a.uGb(Q.Ij)&&1===Q.Ij.length&&Q.Ij[0]?(Q=Q.Ij[0],Q.StatusCode?this.gza.i9f():za&&this.dJa.R7i(this.e7e),this.S1.ATa(Q),this.YMm&&this.e7e()):this.gza.i9f())}alb(Q){this.hN=Q;this.hN.r_b(this.thi);
this.hN.s_b(this.uhi)}dispose(){this.Xl||(this.Swd&&this.Swd.iVn(this.vhi),this.hN&&(this.hN.QLb(this.thi),this.hN.U2c(this.uhi)),this.Xl=!0)}}Object(e.a)(Mj,"GraphMergeBackupManager",null,[1949,9]);class qo{constructor(Q,za=null,hb=null,Tb=null){this.Ire=0;this.dEe=!1;this.H_g=new Date(0);this.mTd=!1;this.dJa=Q;this.vz=za||(()=>new Date);hb||(hb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.pc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.n5j=hb;Tb||(Tb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.pc("WordEditorGraphMergeMaxBackups",
1):1);this.v2g=Tb}get ELm(){return+this.vz()-+this.H_g<this.n5j}get syi(){return 500===this.dJa.oxa?!1:100===this.dJa.oxa?!0:this.dEe||this.mTd||this.ELm}Nxj(){this.H_g=this.vz();this.Ire++;this.Ire>=this.v2g&&this.i9f()}i9f(){this.dEe||(this.dEe=!0,ya.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.Ire,this.v2g))}}Object(e.a)(qo,"GraphMergeBackupThrottler",null,[1948]);class Nr{constructor(Q,za,hb=null){this.eUg=!1;
this.lV=Q;this.SWj=za;null==hb&&(hb=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.xMe=hb?500:300}get oxa(){return this.xMe}R7i(Q){if(!this.eUg&&300===this.oxa){var za=this.SWj.value;za&&za.isFeatureEnabled(49)&&(this.eUg=!0,this.lV.execute(hb=>{hb.Zoo(()=>{this.NXk(Q)},()=>{this.consentDenied(Q)})}))}}consentDenied(Q){300===this.oxa&&(ya.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.xMe=100,Q());
this.n4i()}NXk(Q){300===this.oxa&&(ya.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.xMe=400,Q());this.n4i()}n4i(){this.lV.execute(Q=>{Q.skm()})}}Object(e.a)(Nr,"GraphMergeCollectionConsentManager",null,[1947]);class No extends Sys.EventArgs{constructor(Q){super();this.sKf=Q}}Object(e.a)(No,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var sq=c(829),Rp=c(878),tq=c(1029),qh=c(638),Nn=c(1749),be=c(1747),Nl=c(231),ir=c(177);class Vl{constructor(Q,za,hb,
Tb,zc,kd){this.aZf=this.og=null;this.yUc=this.ulg=!1;this.Sk=null;this.D6c=Q.runtime.D6c;this.Zp=Q;this.Xd=za;this.Ng=hb;this.pn=Tb;this.yXk=zc;this.graphNodeComplexMerge=kd}}Object(e.a)(Vl,"GraphNodeComplexMergeState",null,[]);var cs=c(1537),Rt=c(1521);class bt{constructor(Q,za=null){this.Lg=Q;this.WVb=za||this.ANc()}get nkb(){return this.WVb}get Xd(){return this.Lg}ANc(){return[Object(a.a)(this,this.tro,"simpleMerge"),Object(a.a)(this,this.LWk,"complexMerge")]}Eio(Q,za,hb,Tb,zc,kd){za=new Vl(Q,
hb,new $b.a(()=>new cs.a(Tb?Tb.om:null,zc)),new $b.a(()=>new cs.a(Tb?Tb.om:null,kd)),new $b.a(()=>new cs.a(kd,zc)),za.IHh(zc,()=>Q.runtime.Xb));za.og=Tb.aZb;za.aZf=new Nl.a;return za}merge(Q,za,hb,Tb,zc,kd){za=this.Eio(Q,za,hb,Tb,zc,kd);hb=!0;for(Tb=0;Tb<this.nkb.length&&hb;Tb++)(hb=(0,this.nkb[Tb])(za))||Q.logger.a1d("GraphNodeMerge.GetMergeFunctions()",Tb);if(Q=za.yUc&&za.Sk?new Rt.a(za.Sk,!1):null)switch(Q.Ygo(za.og),(Q?Q.om:zc).Nc){case 1074135145:za.Zp.runtime.yae.XYk.Z(Q.om.id,Q.om);break;case 1074135153:za.Zp.runtime.yae.eEk.Z(Q.om.id,
Q.om);break;case 1074135127:za.Zp.runtime.yae.GVk.Z(Q.om.id,Q.om);break;case 393230:za.Zp.runtime.z2d.add(Q.om.id)}return{returnValue:za.yUc,Sk:Q}}tro(Q){if(Q.Zp.runtime.Xb&&Q.Zp.runtime.Xb.lhb(1000005)&&0<Q.og.count)return!0;var za=Q.graphNodeComplexMerge.O9d;return Q.pn.value.tSc(za)&&Q.yXk.value.tSc(za)?Q.Ng.value.tSc(za)?!0:(za=Q.pn.value.yf,Q.yUc=!0,Q.Sk=za.fH(),!1):(Q.yUc=!0,!1)}LWk(Q){const za=Q.pn.value.yf;Q.D6c&&ir.a.instance.Ta(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",
za.id,za.Nc);const hb=Q.graphNodeComplexMerge.Ahg(Q);Q.yUc=hb;ir.a.instance.Ta(4018184,1,hb?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",hb?"Succeeded":"Failed",za.id,za.Nc,!!Q.Sk);return hb}}Object(e.a)(bt,"GraphNodeMerge",null,[1872]);class wn extends fh.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=
null;this.Prompt=this.Reason=this.Source=0}Cl(){return 33}static construct(Q,za,hb,Tb,zc,kd,ce,df,bf,Vf,rh){const ij=new wn;ij.FileId=Q;ij.BaseRevisions=za;ij.TheirRevisions=hb;ij.YourRevisions=Tb;ij.IgnoreConflictsInLastServerRevision=zc;ij.MergeHint=kd;ij.ObjectSpaceId=ce?Uj.a(ce):null;ij.RequestId=df?Uj.a(df):null;ij.Source=bf;ij.Reason=Vf;ij.Prompt=rh;return ij}}Object(e.a)(wn,"CreateGraphMergeReplayRequest",fh.a,[]);var ds=c(815),Oo=c(251),Sk=c(17),Ip=c(1859),eq=c(1931);class uq{constructor(Q,
za=null,hb=null){this.vil=(Tb,zc)=>{let kd=Tb;var ce=zc,df=this.zab.get(Tb);if(!df)return{MGa:kd,iMb:ce};ce=new Nl.a;ce.add(df);var bf=this.uub.get(Tb)||this.mF.J(Tb);df=new Nl.a;df.add(bf);bf=new Nl.a;bf.add(this.mF.J(Tb));ya.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.SG.Jtf,this.SG.$ga,this.f8h(df),this.f8h(ce));var Vf=this.w8h(this.SG.$ga);this.mxl(Vf,Tb,ce);df=new Ip.a(Vf,bf,1===Vf.input.$ga?
df:ce,1===Vf.input.$ga?ce:df,this.w8h(1),df,ce);ce=new Nl.a;for(bf=0;bf<zc.length;bf++){this.SG.xG("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const rh=({g5a:kd,spa:Vf}=df.g$c(Tb,zc.J(bf))).returnValue;ce.add(Vf);rh?ya.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",Tb,zc.J(bf),kd,Vf):ya.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",
Tb)}return{MGa:kd,iMb:ce}};this.SG=Q;this.mF=Q.pk;this.zab=Q.CBo;this.uub=Q.W_o;this.k4j=Q.sVm;this.Lg=za||new tq.a;this.L8j=hb||this.vil}KIc(Q){const za=new Nl.a;for(let hb=0;hb<Q.length;hb++){const Tb=this.lil(Q.J(hb));za.add(Tb)}return za}JIc(Q,za,hb){const Tb=Q.Zt===Q.Vy&&Q.startCp===Q.endCp;za&&({MGa:Q.Zt,spa:Q.startCp}=this.DTa(Q.Zt,Q.startCp,Q.Zt),Tb&&(Q.Vy=Q.Zt,Q.endCp=Q.startCp));hb&&!Tb&&({MGa:Q.Vy,spa:Q.endCp}=this.DTa(Q.Vy,Q.endCp,Q.Vy));return Q}lil(Q){if(Q.Zt===Q.Vy){var za=new Nl.a;
za.add(Q.startCp);za.add(Q.endCp);({MGa:Q,iMb:za}=this.Ijg(Q.Zt,za));return new ds.a(Q,za.J(0),Q,za.J(1))}za=new Nl.a;var hb=new Nl.a;let Tb;za.add(Q.startCp);({MGa:za,iMb:Tb}=this.Ijg(Q.Zt,za));hb.add(Q.endCp);({MGa:Q,iMb:hb}=this.Ijg(Q.Vy,hb));return new ds.a(za,Tb.J(0),Q,hb.J(0))}Ijg(Q,za){let hb=Q,Tb=za;if(!this.mF.J(Q))return ya.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",Q),{MGa:hb,
iMb:Tb};if(this.zab.get(Q))({MGa:hb,iMb:Tb}=this.L8j(Q,za,hb,Tb));else if(this.SG.Vwf&&!this.SG.Vwf.J(this.SG.Vwf.length-1).C3(Q)){Tb=new Nl.a;for(let zc=0;zc<za.length;zc++){let kd;({MGa:hb,spa:kd}=this.DTa(Q,za.J(zc),hb));Tb.add(kd)}}return{MGa:hb,iMb:Tb}}f8h(Q){let za="";Q.forEach(hb=>{za+=hb.Q8c();za+=" ";return!0});return za}w8h(Q){const za=pa.a.instance.Ma("Box4.IFeatureHelper"),hb=new eq.a;hb.input.source=this.SG.Jtf;hb.input.$ga=this.SG.$ga;hb.input.sKc=()=>za;hb.runtime.pk=this.mF;hb.runtime.tCa=
this.SG.iWk;1===Q?(hb.runtime.ru=this.uub,hb.runtime.zq=this.zab,hb.runtime.gKd=this.SG.iAi,hb.runtime.tle=this.SG.AAi):2===Q&&(hb.runtime.ru=this.zab,hb.runtime.zq=this.uub,hb.runtime.gKd=this.SG.AAi,hb.runtime.tle=this.SG.iAi);hb.runtime.Xb=za;return hb}mxl(Q,za,hb){if(Q.runtime.ru.ob(Oo.a.eL)){var Tb=Q.runtime.ru.J(Oo.a.eL);Tb=this.Lg.getPropertyObjectIds(Tb,Un.a.L0);if(1===Tb.length&&(Tb=Tb.J(0),Q.runtime.ru.ob(Tb)&&(Tb=Q.runtime.ru.J(Tb),3===this.Lg.getPropertyInt32(Tb,Un.a.lpb)))){const zc=
this.Lg.getPropertyString(Tb,Un.a.Mia),kd=this.Lg.getPropertyString(Tb,Un.a.EPb);za.toString()===zc&&zc===kd&&(za=this.Lg.getPropertyObjectId(Tb,Un.a.j$c),Q.runtime.ru.ob(za)&&hb.add(Q.runtime.ru.J(za)))}}}r_l(Q,za){let hb=0;for(let Tb=0;Tb<Q.length;Tb++)if(za.equals(Q.J(Tb)))return hb=Tb,{returnValue:!0,idx:hb};return{returnValue:!1,idx:hb}}DTa(Q,za){const hb=this.k4j&&!!this.uub.J(Q)&&!this.mF.J(Q);let Tb=Q,zc=za,kd=!1,ce=!1;(hb?this.uub:this.zab).forEach((df,bf)=>{this.SG.xG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
if(this.vCf(bf.Nc)&&this.mF.J(df)){bf=null;if(hb){bf=this.UNc(rh=>this.uub.J(rh)||this.mF.J(rh),df);var Vf=this.WXd(bf,Q)}else Vf=this.UNc(rh=>this.mF.J(rh),df),Vf=this.WXd(Vf,Q);if(Vf&&(ce=!0,bf||(bf=this.UNc(rh=>this.uub.J(rh)||this.mF.J(rh),df)),df=this.UNc(rh=>this.zab.J(rh)||this.mF.J(rh),df),Vf=0,({idx:Vf}=this.r_l(bf,Q)).returnValue)){for(let rh=Vf+1;rh<bf.length;rh++)if(this.WXd(df,bf.J(rh)))return zc=0,Tb=bf.J(rh),kd=!0,!1;for(--Vf;0<=Vf;Vf--)if(this.WXd(df,bf.J(Vf)))return zc=Number.MAX_VALUE,
Tb=bf.J(Vf),kd=!0,!1}}return!0});kd||(ya.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",Q,za,hb,ce),5===this.SG.Jtf&&(ya.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Tb),({XWh:za}=this.pPl()).returnValue?(Tb=za,zc=0,ya.ULS.sendTraceTag(17340241,
318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Tb)):ya.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Tb)));return{MGa:Tb,spa:zc}}pPl(){let Q=gj.a.nil,za=new Nl.a;this.zab.forEach((hb,Tb)=>{this.SG.xG("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
return this.vCf(Tb.Nc)?(za=this.UNc(zc=>this.zab.J(zc)||this.mF.J(zc),hb),!1):!0});return 0<za.length?(Q=za.J(0),{returnValue:!0,XWh:Q}):{returnValue:!1,XWh:Q}}vCf(Q){return 393241===Q||393250===Q||393251===Q||393252===Q}UNc(Q,za){var hb=Q(za);za=new Nl.a;if(!this.vCf(hb.Nc))return za;hb=this.Lg.getPropertyObjectIds(hb,Sk.a.gf);for(let Tb=0;Tb<hb.length;Tb++){const zc=new Nl.a;this.rqf(Q,hb.J(Tb),zc);za.fA(za.length,zc)}return za}rqf(Q,za,hb){var Tb=Q(za);if(Tb)if(393230===Tb.Nc)hb.add(za);else if(393229===
Tb.Nc)za=this.Lg.getPropertyObjectIds(Tb,Sk.a.mK).$f(0),this.rqf(Q,za,hb);else if(393250===Tb.Nc||393251===Tb.Nc||393252===Tb.Nc)for(za=this.Lg.getPropertyObjectIds(Tb,Sk.a.gf),Tb=0;Tb<za.length;Tb++)this.rqf(Q,za.J(Tb),hb)}WXd(Q,za){for(let hb=0;hb<Q.length;hb++)if(za.equals(Q.J(hb)))return!0;return!1}}Object(e.a)(uq,"GraphMergeSelectionRecordUpdater",null,[]);class Zn extends Nn.a{constructor(Q=null,za=null,hb=null,Tb=null,zc=null,kd=null,ce=null,df=null,bf=-1,Vf=null,rh=null,ij=null){super();this.eJh=
vi=>{const ti=vi.AW,nk=Pe.App.ya.jb.Wc;return new sq.a(vi,ti,nk.ud,nk.fileId,nk.umb,nk.contextId,ti?ti.id:gj.a.nil,this.Ece,!1,!0)};this.dS=Q||(()=>l.AFrameworkApplication.rootQuerySignature);za||(za=vi=>new Rp.a(vi));this.Q$g=za;this.Lg=hb||new tq.a;this.aLg=ce||new be.ChildNodeListMerge(this.Xd);this.oXb=df;this.Ece||(this.oXb=(vi,ti,nk)=>new qh.a(vi,ti,nk));this.WVb=Tb||this.ANc();this.j$a=zc||new dp.a;this.NTg=kd||new bt(this.Xd);this.C2g=void 0===bf||null===bf||-1===bf?Ad.App.EEj:bf;this.gza=
Vf;this.dJa=rh;this.HRd=this.zel(ij);this.nRg=()=>pa.a.instance.Ma("Box4.IFeatureHelper")}zel(Q){Q||(Q=l.AFrameworkApplication.K?l.AFrameworkApplication.K.pc("WordEditorGraphMergeBackupCasesBrowser",0):0);return Q}FDa(){return(new Date).getTime()}Kpj(Q,...za){return String.format.apply(null,[Q].concat(za))}$Bo(Q){throw ym.a.invalidOperation(Q);}ENd(Q){return String.format("Name: {0}, Message: {1}, Stack: {2}",Q.name,Q.message,Q.stack)}Uyn(Q){if(this.gza&&this.gza.syi||!this.Jxo(Q))return null;this.gZm(Q);
let za;({uCk:Tb,BBo:zc,V_o:za}=this.w7k(Q,this.eJh));const hb=Nn.a.zQl(Q);var Tb=wn.construct(this.dS(),Tb.uya(),zc.uya(),za.uya(),Q.input.bFb,Q.input.$ga,Q.input.Zm,Q.input.CIb,Q.input.source,hb,this.dJa.oxa);var zc=Q.output.qM;3===hb&&0<zc.length&&(Tb.MergedRevision=this.eJh(Q.output.qM.last()));return Tb}KIc(Q,za){return(new uq(Q)).KIc(za)}JIc(Q,za,hb,Tb){return(new uq(Q)).JIc(za,hb,Tb)}}Object(e.a)(Zn,"GraphMerger",Nn.a,[]);class Yo extends Zn{constructor(Q,za=null,hb=null){super(Q,void 0,void 0,
void 0,void 0,void 0,void 0,void 0,void 0,za,hb);this.ra=new M.a}get oxa(){return this.dJa?this.dJa.oxa:0}get delayedMergeOperation(){return null}set delayedMergeOperation(Q){}Oqk(Q){this.ra.addHandler(Yo.Itf,Q)}iVn(Q){this.ra.removeHandler(Yo.Itf,Q)}cag(){return!1}tcc(Q,za,hb,Tb,zc,kd,ce){(Q=super.tcc(Q,za,hb,Tb,zc,kd,ce))&&this.ra.raiseEvent(Yo.Itf,new No(Q));return Q}}Yo.Itf="GMC";Object(e.a)(Yo,"WordEditorGraphMerger",Zn,[1880,1587,1588]);class Ni{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}yc(Q){this.W=
Q;this.W.ha("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new Nr(this.W.Sa("WordEditor.IBusinessBarController"),new $b.a(()=>Q.Ma("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new qo(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").singleInstance();this.W.ha("WordEditor.GraphMerge.WordEditorGraphMerger",()=>
new Yo(()=>l.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Mj(()=>l.AFrameworkApplication.rootQuerySignature,l.AFrameworkApplication.xa,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),
this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").singleInstance()}init(){Pe.App.tR||(Pe.App.tR=bn.a.h7());const Q=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");Pe.App.tR.mDk(Q);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let Q=this.W.Ma("Box4.IGraphMergeBackupManager");Q&&Q.dispose()}}Object(e.a)(Ni,"GraphMergePackage",null,[1,2]);var ro=c(307);class Mq{constructor(Q){this.Pte="FontPicker";this.HDe=null;this.n8a=Q;this.fhd=
this.n8a.Axa(ro.a.MHb,Object(a.a)(this,this.YBb,"featureStateChangeCallback"));this.n8a.isFeatureEnabled(ro.a.MHb,!1).then(za=>{this.HDe=za})}get isLicensed(){return this.HDe}YBb(Q){this.HDe=Q.isEnabled;Q=appChrome.actions.updateFontPickerLicenseState(this.Pte,Q.isEnabled);appChrome.api.dispatch(Q)}dispose(){this.n8a.Yfc(ro.a.MHb,this.fhd)}}Object(e.a)(Mq,"ModernFontPickerFeatureHelper",null,[1222,9]);var Sp=c(511),Zo=c(662),ni=c(1653);class ho{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=
null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(e.a)(ho,"FontInfoTaskPaneProps",null,[]);class vq{constructor(Q,za,hb,Tb=null){this.MTe=this.BV=this.fhd=null;this._state=this.qVb=0;this.BGe=Q;this.n8a=za;this.xQj=hb;this.Vb=Tb}get rc(){return this.BGe.value}initialize(){this.rc.pa(m.a.Y3f,y.a.frame,Object(a.a)(this,this.Y3f,"requestFontInfo"));this.fhd=this.n8a.Axa(ro.a.MHb,Object(a.a)(this,this.YBb,"featureStateChangeCallback"));this.lia()}NO(Q=!1){const za=
Vi.UISurfaces.uu(),hb=this.n8a.isFeatureEnabled(ro.a.MHb,!1),Tb=[];Tb.push(za);Tb.push(hb);Promise.all(Tb).then(zc=>{zc[0].showTaskPane(ni.a.qCb,this.Pz(zc[1]));Q&&this.zJ()})}XPo(Q){Vi.UISurfaces.uu().then(za=>{za.updateTaskPane(ni.a.qCb,this.Pz(Q));return null})}YBb(Q){this.XPo(Q.isEnabled)}Y3f(Q,za,hb,Tb,zc){this.BV=zc.CommandValueId;this.MTe=zc.Trigger;this.qVb=zc.InputMethod;this.NO(2===this._state&&1===this.qVb);return 32}Pz(Q){const za=new ho;za.onUpsellButtonClicked=Object(a.a)(this,this.onUpsellButtonClicked,
"onUpsellButtonClicked");za.fontName=this.BV;za.isLicensed=Q;za.trigger=this.MTe;za.helpArticleUrl=this.$Xk();za.paneId=ni.a.qCb;Q=this.Mpm();Q.contentProps=za;return Q}Mpm(){return Object.assign(new Kd.a,{title:ni.a.rec,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(a.a)(this,this.onOpen,"onOpen"),onClose:Object(a.a)(this,this.onClose,"onClose"),onShow:Object(a.a)(this,this.onShow,"onShow"),onHide:Object(a.a)(this,this.onHide,
"onHide")})}lia(){if(this.Vb){var Q=this.Vb.fe(ni.a.qCb);Q.parent=kh.AFrame.qp;Q.zH=!0}}onOpen(){this._state=2;this.zJ()}onShow(Q){0!==this._state&&(this._state=2,1===Q&&(this.qVb=Q),this.zJ())}onClose(){this.qVb=this._state=0;this.blur()}onHide(){this._state=1;this.qVb=0}zJ(){this.Vb&&1===this.qVb&&this.Vb.mg(ni.a.qCb)}blur(){this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name===ni.a.qCb&&this.Vb.mg(this.Vb.fT)}onUpsellButtonClicked(){this.n8a.launchUpsellExperience(ni.a.experienceId)}dispose(){this.n8a.Yfc(ro.a.MHb,
this.fhd)}$Xk(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.xQj,this.uRl(),"WDWAENDUSER",l.AFrameworkApplication.lcid)}uRl(){switch(this.MTe){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return vq.HFk(this.BV)}static HFk(Q){let za="hlpFontInfo";for(let hb=0;hb<Q.length;++hb){const Tb=db.a.charAt(Q,
hb);if(255<Q.charCodeAt(hb)||db.a.PVd(Tb))za+=Tb}return za}}Object(e.a)(vq,"FontInfoPane",null,[962,9]);class wq extends vq{constructor(Q,za,hb,Tb,zc){super(Q,za,Tb.kb("FontInfoHelpBaseUrl"),zc);this.k2=hb}NO(Q){this.CZ();super.NO(Q)}YBb(Q){super.YBb(Q);Pe.App.ya.updateCommandUI()}CZ(){this.k2.lNa()}}Object(e.a)(wq,"WordEditorFontInfoPane",vq,[]);class Xq{constructor(){this.RTb=this.vnd=this.dsc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}yc(Q){this.W=Q;Q.ha("Common.ModernFontPicker.IModernFontPickerFeatureHelper",
()=>new Mq(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).singleInstance();Q.ha("Common.ModernFontPicker.IFontInfoPane",()=>new wq(new $b.a(()=>l.AFrameworkApplication.xa),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Gd.a.instance,l.AFrameworkApplication.K,ci.FocusManager.instance())).singleInstance()}init(){this.vnd=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.dsc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");
this.dsc.initialize();l.AFrameworkApplication.K.$("IsAnonymousUser")||((this.RTb=this.W.Ma(Zo.a))?this.RTb.initialize():ya.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));Pe.App.ya.updateCommandUI()}dispose(){this.dsc&&(this.dsc.dispose(),this.dsc=null);this.vnd&&(this.vnd.dispose(),this.vnd=null);this.RTb&&(this.RTb.jCa(),this.RTb=null)}static main(){Object(Sp.a)()&&K.a.instance.Gc(new Xq)}}Object(e.a)(Xq,"ModernFontPickerPackage",null,[1,2]);var Tp=c(143),Hi=c(5),
Ol=c(265),Ns=c(40),fq=c(1104);class mk{constructor(Q,za,hb,Tb,zc,kd,ce,df,bf,Vf,rh,ij=null){this.BY=hb;this.Xc=Q;this.Ic=za;this.Hh=zc;this.OIa=kd;this.mV=ce;this.GKg=df;this.FKg=bf;this.Dx=Vf;this.VTj=ij||mk.Bw}get kh(){return this.Dx?this.Dx.kh:!1}pni(Q){return this.EEa(Q,0)}Ssm(Q){return this.EEa(Q,1)}EEa(Q,za){let hb=null;if(this.kh&&this.mV&&(this.FKg.instance&&this.FKg.instance.aIa(Q),za?1===za&&(hb=this.mV.i8h(Q.node)):hb=this.mV.umf(Q.node,Q.cpBegin,Q.Fb),hb&&!hb.ia(Un.a.c8,!1)))return ya.ULS.shipAssertTag(24749379,
368,!1,"Try to insert page break to inconvertible inline content control"),2;const Tb=Hi.GraphIterator.cX(this.Xc.Ck());Tb.set(Q.node);Tb.Ab(10);const zc=this.Ic.Qc(15);zc.Fu(Tb);za?Ns.OutlineElementNavigator.Zd(Tb):(this.splitParagraph(Tb,Q),this.BY.alc(Q.node,Zd.a.ks));Q=Be.ParagraphReader.Rl(Tb.currentNode);this.fum(Tb);this.kh&&hb&&this.GKg&&(za=new ob.a,za.add(Tb.currentNode),this.GKg.Njh(za,hb.id));this.tco(Q);zc.dispose();return 32}tco(Q){Q=ue.SelectionFactory.te(Q,0);Ge.a.instance.setSelection(Q)}fum(Q){this.Hh.uC(Q,
!0,!0,null,!1,!1);Q=Ns.OutlineElementNavigator.Fe(Q);this.Tsm(Q)}splitParagraph(Q,za){const hb=Ns.OutlineElementNavigator.Zd(Q);if(za.cpBegin||this.kh&&(!this.kh||-1!==za.Fb)){Pe.App.xd.Yp&&za.cpBegin!==Be.ParagraphReader.textLength(za.node)&&Pe.App.xd.Vq.aH(za.node);this.Hh.uC(Q,!1,!0,null,!1,!0);var Tb=Hi.GraphIterator.cX(this.Xc.Ck());Tb.set(hb);this.Hh.p9(Tb,Q,za,!0,!0,!0)}}Tsm(Q){Q=this.VTj(Q);this.OIa.Mni(Q)}static vE(){return new mk(new mm.a,new Bo.a,pa.a.instance.resolve("Box4.IAutoCorrectScheduler"),
fq.a.instance,pa.a.instance.resolve("Box4.IOutlineElementEditor"),pa.a.instance.resolve("Box4.IBlobEditor"),pa.a.instance.Ma("Box4.IContentControlReader"),pa.a.instance.Ma("Box4.IContentControlEditor"),pa.a.instance.Sa("Box4.IContentControlConverter"),pa.a.instance.Ma("Box4.ContentControlConfigSettings"),pa.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=mk.Uyg?mk.Uyg:mk.Uyg=mk.vE()}static Bw(Q){return ag.a.Bw(Q)}}Object(e.a)(mk,"PageBreakInserter",null,[1910]);class ck{constructor(Q,
za,hb,Tb,zc,kd,ce,df){this.ium=(bf,Vf,rh,ij)=>{var vi=Vf.view,ti=vi.nb.pg;if(!ti)return 2;if(!this.z4e(Vf))return 8;if(1===rh)return 32;let nk=!0;rh=8;const Wj=this.HEe(ti);ti=this.Ic.Qc(15);ti.Eb(vi.Zc);ti.kk=bf;Wj||(rh=this.ga.Nf(Vf,uh.a.Ula,2,!0,ij,null),bf=32===rh,ya.ULS.shipAssertTag(4208012,314,bf),nk=bf);nk&&(vi=vi.nb.pg,bf=this.HEe(vi),ya.ULS.shipAssertTag(4208013,314,bf,"{0}",{["ContextId"]:Vf.contextId}),rh=8,bf&&(rh=this.wCe.pni(vi),ya.ULS.shipAssertTag(4208014,314,32===rh)));ti.dispose();
32===rh&&this.Wd.Bs(10);return rh};this.hum=(bf,Vf,rh)=>{if(!Vf||Vf.contextId!==Rj.a.Vc)return 8;if(1===rh)return Vf.contextId===Rj.a.Vc?32:8;if(2===rh){if(!this.z4e(Vf))return 8;bf=this.wCe.pni(Vf);32===bf&&this.Wd.Bs(10);return bf}return 32};this.gum=(bf,Vf,rh)=>{if(!Vf||Vf.contextId!==Rj.a.table)return 8;if(1===rh)return 32;if(2===rh){if(!this.z4e(Vf))return 8;bf=this.wCe.Ssm(Vf);32===bf&&this.Wd.Bs(10);return bf}return 32};this.ga=Q;this.wCe=za;this.Ic=hb;this.Rm=Tb;this.HEe=zc;this.Fk=kd;this.Q1j=
ce;this.Wd=df}Ub(){this.ga.pa(Vh.a.EEa,Rj.a.view,this.ium);this.ga.pa(Vh.a.EEa,Rj.a.Vc,this.hum);this.ga.pa(Vh.a.EEa,Rj.a.table,this.gum);this.ga.Uc(Vh.a.EEa,4)}h4(){const Q=ci.FocusManager.instance().fe(Tp.AppFrame.xE);kh.AFrame.zi(Q,Db.KeyInputManager.mc(Zd.a.ks,Db.KeyInputManager.Ph),Vh.a.EEa)}OEm(Q){return this.Jw(Q.iterator)}qIm(Q){Q=Q.J(0);const za=Uh.SelectionEditor.Bj(Q,!0,!1);if(this.Jw(za.Qa.iterator))return!0;Q=Uh.SelectionEditor.Bj(Q,!1,!1);return this.Jw(Q.Qa.iterator)}Jw(Q){return Q.Ab(14)}z4e(Q){let za=
null,hb=Q;if(hb.contextId===Rj.a.view){za=hb.view;if(!za.features.Xdg)return!1;hb=za.nb.pg;if(!hb)return!1}else{const Tb=Hi.GraphIterator.$a(hb.node);if(Tb.Ab(36)||Tb.Ab(38)||Tb.Ab(40)||Tb.Ab(14))return!1}return Ol.a.vga(Q)?!1:hb.contextId===Rj.a.table?this.Fk.yEm(hb.node):!this.Fk.wEm(hb)||this.Rm&&this.Rm.instance&&this.Rm.instance.aU(hb)?!1:((Q=this.HEe(hb))?this.OEm(hb):this.qIm(za.nb.hb))||Q&&this.Q1j(hb,!0)?!1:!0}static vE(){return new ck(l.AFrameworkApplication.xa,mk.instance,new Bo.a,pa.a.instance.Sa("Box4.IExternalSelectionManager"),
Uh.SelectionEditor.jf,pf.a.instance,sl.HyperlinkReader.awa,pa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=ck.Nxg?ck.Nxg:ck.Nxg=ck.vE()}}Object(e.a)(ck,"PageBreakActor",null,[1879]);class Tf{constructor(){this.JKe=this.W=null}get name(){return"WordEditor.PageBreak"}yc(Q){this.W=Q}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>{this.$m()})}$m(){this.JKe=ck.instance;this.JKe.Ub();this.JKe.h4();Pe.App.ya.updateCommandUI()}dispose(){}}
Object(e.a)(Tf,"PackageManager",null,[1,2]);var Nq=c(1469),gp=c(1470),sp=c(238),xq=c(153),so=c(263),to=c(296),Or=c(478);class uo{constructor(Q,za,hb,Tb,zc,kd,ce){this.pvb=null;this.ra=new M.a;this.ive=1;this.emd=-1;this.vWa=null;this.Foa=()=>{this.f3e()};this.ib=za;this.Gb=hb;this.igd=Tb;this.hI=zc;this.zy=kd;this.aea=ce;this.enable()}get AHc(){return this.ive}Whj(Q){this.ive!==Q&&(this.ive=Q,this.ra.raiseEvent("X"),this.BCf&&this.qjg())}get BCf(){const Q=pa.a.instance.Ma("WordEditor.Pagination.IPageEndMarkers");
return Q?Q.BCf:!0}get qf(){return this.hI.value}get Gk(){return pe.a.instance}Ppk(Q){this.ra.addHandler("X",Q)}qjg(){this.Gk.he(()=>{this.aea.yU(Or.a.ETi)},"CPC:UPN")}enable(){this.ib.gx(this.Foa);this.f3e()}f3e(){if(!this.vWa||1>=this.vWa.count)this.Whj(1);else{var Q=this.ib.hb.lb;if(Q){var za=Q.Mf?Q.Rc:Q.Qa;!za||0>za.cpBegin||(Q=za.node)&&Be.ParagraphReader.Yb(Q)&&this.fEm(Q)&&(this.pvb&&(this.Gb.Se(this.pvb),this.pvb=null),this.pvb=new Uc.a(2,1,400,hb=>{this.findCurrentPageFromIp(hb,za)},62),this.Gb.Wb(this.pvb))}}}fEm(Q){Q=
Hi.GraphIterator.$a(Q);return Q.Ab(35)||Q.Ab(37)||Q.Ab(39)?!1:!0}jAj(Q){this.vWa=Q;this.Iyj()}Iyj(){if(-1!==this.emd){var Q=this.Iul(this.emd);-1!==Q&&this.Whj(Q)}}findCurrentPageFromIp(Q,za){this.pvb===Q&&(this.pvb=null,this.emd=this.XCl(za),-1!==this.emd&&this.Iyj())}Iul(Q){if(!this.vWa)return-1;for(let za=0;za<this.vWa.count;za++){const hb=this.vWa.J(za);if(Q>hb.zih&&Q<hb.zih+hb.height)return hb.Zh}return-1}XCl(Q){var za=this.I_l(Q);if(!za||!za.htmlElement)return-1;const hb=za.getBounds();Q=this.IKl(Q,
za);if(!Q)return-1;za=ca.a.G0a(this.igd.h4a,za.htmlElement).y;return Q.y+Math.floor(Q.height/2)-hb.y+za}I_l(Q){return Q.node.Ee(this.qf.jc)}IKl(Q,za){Q=this.zy?this.zy.paa(Q,!0):Q.cpBegin;return to.a.Gq(za,Q)}disable(){this.ib.lY(this.Foa)}}Object(e.a)(uo,"CurrentPageCalculator",null,[1970,1965]);class Ik{constructor(Q){Ik.NY=Q}get aaf(){return Ik.NY}get AHc(){return this.aaf.AHc}pml(){this.aaf.enable()}Yfl(){this.aaf.disable()}}Ik.NY=null;Object(e.a)(Ik,"CurrentPageManager",null,[1969]);var Ah=c(123);
class oh extends Sys.EventArgs{constructor(Q,za){super();this.XJi=za}}Object(e.a)(oh,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class Wl extends Sys.EventArgs{constructor(Q,za,hb){super();this.delta=Q;this.XJi=hb}}Object(e.a)(Wl,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class zr{constructor(Q,za,hb){this.C8g=this.wqd=-1;this.nxc=null;this.ra=new M.a;this.MIe=!1;this.osn=(Tb,zc)=>{this.MIe=this.zOk();zc.xlb||this.Irc.value.measure(this.uOk)};this.uOk=()=>{const Tb=this.h4a.clientHeight;
this.tOk(Tb);this.COk(Tb)};this.lUf=(Tb,zc)=>{zc.property===Ah.a.HI&&(Tb=zc.node)&&Tb.ia(Ah.a.HI,!1)&&(Tb=Tb.Ee(this.qf.jc))&&(Tb=Tb.htmlElement)&&this.sWa.add(Tb)};this.hI=Q;this.Irc=za;this.sWa=new ob.a;this.qf.rmh(this.osn);this.Gvf();this.Hba=this.Hba.bind(this);hb.kyb(this.Hba)}get qf(){return this.hI.value}Hba(){this.nxc=null}get h4a(){this.nxc||(this.nxc=this.qf.Zc.Ee(this.qf.jc).h4a,ya.ULS.shipAssertTag(34136386,336,!!this.nxc));return this.nxc}crk(Q){this.ra.addHandler("OnPageContentSizeChangeKey",
Q)}tOk(Q){Q!==this.C8g&&(this.ra.raiseEvent("OnDocumentBottomChangeKey",new oh(Q,this.MIe)),this.C8g=Q)}COk(Q){Q!==this.wqd&&(-1!==this.wqd&&this.ra.raiseEvent("OnPageContentSizeChangeKey",new Wl(Q-this.wqd,Q,this.MIe)),this.wqd=this.h4a.clientHeight)}zOk(){let Q=!1;for(let za=this.sWa.count-1;0<=za;za--)this.sWa.J(za).hasChildNodes()&&(this.sWa.removeAt(za),Q=!0);return Q}Gvf(){Pe.App.jk.Kl.af(23).Ro(this.lUf)}}Object(e.a)(zr,"DocumentSizeManager",null,[]);var jr=c(59),$n=c(266);class Jp{constructor(Q){this.hI=
Q}get qf(){const Q=this.hI.value;ya.ULS.shipAssertTag(37820298,336,Q.Yi,"OutlineManager.PageView is not a PageView.");return Q}gfe(Q,za){const hb=jr.a.Ki(Jp.Vf.$z(Q),1);za+=hb;Q.Ee(this.qf.jc).htmlElement.firstChild.style.minHeight=za+"px"}b5h(){const Q=Hi.GraphIterator.$a(this.qf.Zc);Q.Yo();Q.Sd();ya.ULS.shipAssertTag(37820299,336,10===Q.Kn.type);return Q.Kn}B7h(){const Q=Hi.GraphIterator.$a(this.qf.Zc);Q.Yo();Q.Taa();ya.ULS.shipAssertTag(37820300,336,10===Q.Kn.type);return Q.Kn}z1l(Q){const za=
Hi.GraphIterator.$a(this.qf.Zc);za.Yo();za.Sd();let hb=za.Kn,Tb=null;for(;Q!==hb&&za.Wj();)Tb=hb,hb=za.Kn;ya.ULS.shipAssertTag(37820301,336,10===za.Kn.type);return Tb}static get Vf(){return $n.a.instance}}Object(e.a)(Jp,"OutlineManager",null,[1968]);class On{constructor(Q){this.mAa=0;this.c1=null;this.Nag=za=>{for(const hb of za.customData)this.showAdornmentText(hb)};this.Gb=Q}R6d(){this.c1||(this.c1=this.fHc())}SCd(){this.c1&&0<On.aMc(this.c1).length&&this.Gb.Wb(this.c1);this.c1=null}fHc(){return Object.assign(new Uc.a(3,
1,250,this.Nag,166),{customData:[]})}X8f(Q){this.mAa=Q}L6c(Q){if(Q){Q.style.width=this.mAa+"px";if(this.c1)var za=this.c1;else za=this.fHc(),this.Gb.Wb(za);On.aMc(za).push(Q)}}SPc(Q){Q&&(Q.style.width="0px",this.ovf(Q))}a$c(Q,za){za?this.L6c(Q):this.SPc(Q)}showAdornmentText(Q){Q.style.width===this.mAa+"px"&&(this.mMc(Q).style.visibility="visible")}ovf(Q){Q&&(this.mMc(Q).style.visibility="hidden")}mMc(Q){Q=Q.childNodes;ya.ULS.shipAssertTag(24958351,336,1===Q.length,"Expected 1 child div in the page adornment, found "+
Q.length);return Q[0]}static aMc(Q){return Q.customData}}Object(e.a)(On,"PageAdornmentAnimationManager",null,[1967]);class Wk{constructor(Q){this.Yl=Q;this.p$=new dd.a;this.q$=new dd.a}uCa(Q){Q=Hi.GraphIterator.$a(Q);if(Q.Yo()&&Q.pq()){Q.Sd();do 10===Q.Xe&&this.QWf(Q.currentNode),Q.gt();while(8!==Q.Xe)}}ENb(Q){const za=Q.Zh;var hb=this.ZDb(Q.bPb);if(!this.p$.ob(hb))return ya.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+hb),!1;Q=
this.p$.J(hb);ya.ULS.shipAssertTag(24958353,336,this.q$.ob(hb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");hb=this.q$.J(hb);return this.ivf(Q,za,hb)}DNb(Q){const za=Q.Zh;var hb=this.ZDb(Q.bPb);if(!this.p$.ob(hb))return ya.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+hb),!1;Q=this.p$.J(hb);ya.ULS.shipAssertTag(24958355,336,this.q$.ob(hb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");
hb=this.q$.J(hb);return this.djf(Q,za,hb)}qsf(Q){if(!Q)return ya.ULS.sendTraceTag(24979136,336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var za=Q.EAd;if(!za)return ya.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",Q.Zh)),0;za=this.Yl.iDb(za);if(!za)return ya.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;za=this.Yl.bga(za);const hb=1===Q.Zh;Q=!(Q.Zh%2);return 1===za?1:
2===za?hb?2:1:3===za?Q?3:4:hb?2:Q?3:4}QWf(Q){if(10===Q.type){var za=new dd.a,hb=this.Yl.iDb(Q);ya.ULS.shipAssertTag(24958356,336,!!hb,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Tb=this.Yl.bga(hb);Q=this.ZDb(Q);this.Fjg(Q,Tb);this.Ejg(Q,za);hb=Hi.GraphIterator.$a(hb);if(hb.pq()){hb.Sd();do Q=hb.currentNode,Tb=this.Yl.hNc(Q),Q=this.Yl.jji(Q),za.add(Tb,Q),hb.gt();while(36===hb.Xe)}}}Fjg(Q,za){this.q$.ob(Q)?this.q$.Z(Q,
za):this.q$.add(Q,za)}Ejg(Q,za){this.p$.ob(Q)?this.p$.Z(Q,za):this.p$.add(Q,za)}ZDb(Q){ya.ULS.shipAssertTag(24958358,336,10===Q.type,"Expected node of type Outline but received node of type "+Q.type);return Q.ia(Un.a.Xha,0)}ivf(Q,za,hb){const Tb=1===za;za=!(za%2);switch(hb){case 2:if(Tb){if(Q.ob(2))return Q.J(2)}else if(Q.ob(0))return Q.J(0);break;case 3:if(za){if(Q.ob(1))return Q.J(1)}else if(Q.ob(0))return Q.J(0);break;case 4:if(Tb){if(Q.ob(2))return Q.J(2)}else if(za){if(Q.ob(1))return Q.J(1)}else if(Q.ob(0))return Q.J(0);
break;case 1:if(Q.ob(0))return Q.J(0)}return!1}djf(Q,za,hb){const Tb=1===za;za=!(za%2);switch(hb){case 2:if(Tb){if(Q.ob(5))return Q.J(5)}else if(Q.ob(3))return Q.J(3);break;case 3:if(za){if(Q.ob(4))return Q.J(4)}else if(Q.ob(3))return Q.J(3);break;case 4:if(Tb){if(Q.ob(5))return Q.J(5)}else if(za){if(Q.ob(4))return Q.J(4)}else if(Q.ob(3))return Q.J(3);break;case 1:if(Q.ob(3))return Q.J(3)}return!1}}Object(e.a)(Wk,"PageAdornmentContentManager",null,[1966]);var Xl=c(1159);class cn{constructor(Q,za,
hb,Tb,zc,kd,ce,df,bf){this.Jkg(Q,za,hb,kd,ce,df,bf);this.Zh=Q;this.Fq=za;this.vs=hb;this.bPb=Tb;this.EAd=zc;this.ceb=kd;this.n8b=ce;this.u5b=df;this.TTi=bf}get top(){return this.Fq}get height(){return this.vs}Y5c(Q){this.Fq!==Q&&(this.ceb.style.top=Q+"px",this.Fq=Q)}z8f(Q){this.height!==Q&&(this.ceb.style.height=Q+"px",this.vs=Q)}Jkg(Q,za,hb,Tb,zc,kd,ce){ya.ULS.shipAssertTag(37244961,336,0<Q,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",Q);ya.ULS.shipAssertTag(37244962,
336,0<=za,"PageAdornmentContainer: top parameter value {0} is unexpected value.",za);ya.ULS.shipAssertTag(37244963,336,0<=hb,"PageAdornmentContainer: height parameter value {0} is unexpected value.",hb,za);ya.ULS.shipAssertTag(37244992,336,!!Tb,"PageAdornmentContainer: containerDomElement parameter is null.");ya.ULS.shipAssertTag(37244993,336,!!zc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");ya.ULS.shipAssertTag(37244994,336,!!kd,"PageAdornmentContainer: footerLabelDomElement parameter is null.");
ya.ULS.shipAssertTag(37244995,336,!!ce,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}Object(e.a)(cn,"PageAdornmentContainer",null,[1998]);class Dk{constructor(Q,za,hb,Tb,zc,kd,ce,df,bf,Vf,rh,ij,vi){this.DUg="headerFooterTab";this.Mud=null;this.ys=!0;this.MAe=0;this.TFe=null;this.f1a=!1;this.CJb=ti=>{this.Cdn(ti.xw);return!0};this.rB=()=>!0;this.KEb=()=>{this.y8e()&&(this.f1a=!1,this.uLo(),this.TFe=new Date)};this.EJb=ti=>{this.f1a||this.hV.L6c(ti.xw);return!0};this.DJb=
ti=>{this.f1a||(ti=ti.xw,this.uag(ti)||this.hV.SPc(ti));return!0};this.eOn=()=>{let ti=Array.dequeue(this.kNe);for(;ti;)this.zU(ti),ti=Array.dequeue(this.kNe);this.Mud=null};this.hI=Q;this.hg=za;this.ZD=hb;this.dja=Tb;this.ga=zc;this.nk=kd;this.hV=ce;this.yza=df;this.jKa=bf;this.Gb=Vf;this.Na=rh;this.kNe=[];this.$0=new Map;this.eI=ij;this.Xw=vi;this.jKa.tyd(this.KEb);this.tw=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob.uO;if(this.ykd=(this.ICe=!!this.Na&&this.Na.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&
!!this.Na&&this.Na.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===Pe.App.ya.oI.getLayoutBreakpoint()&&(this.ys=!1),Pe.App.ya.oI.registerLayoutBreakpointChanged(this.DUg,ti=>{switch(ti){case "Small":this.Gji();break;default:this.cmj()}})}get qf(){return this.hI.value}cmj(){try{this.Epo()}catch(Q){ya.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}Gji(){try{this.vkm()}catch(Q){ya.ULS.shipAssertTag(37244998,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}KTn(){for(const Q of this.$0.keys())this.dbe(Q)}uCa(){try{this.WWk()}catch(Q){ya.ULS.shipAssertTag(37244999,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}jAj(Q){try{this.RPo(Q)}catch(za){ya.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",za.message)}}dispose(){try{this.UJo(),this.AKo(),this.jKa&&this.jKa.O5i(this.KEb)}catch(Q){ya.ULS.shipAssertTag(37245001,
336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",Q.message,Q.stack)}}Cdn(Q){const za=this.PSc(Q),hb=this.v2h(Q);hb?(vf.b("OpenHeaderFooterFromWebViewAdornment"),Q=this.yza.qsf(hb),this.ga.Rb(za?Vh.a.Vme:Vh.a.tad,2,Q),this.f1a=!0):(ya.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+Q.id),this.ga.processAction(Vh.a.QUd,2))}UJo(){this.$0.forEach(Q=>{this.wTa(Q)})}AKo(){this.tw&&(this.ykd&&(Pe.App.ya.oI.unregisterLayoutBreakpointChanged(this.DUg),
this.ykd=!1),this.tw=!1)}wTa(Q){if(Q){var za=Q.n8b;Q=Q.u5b;ad.a.mFa(za)&&ad.a.mFa(Q)?(this.nk.sc(W.a.SQ,za,this.EJb),this.nk.sc(W.a.SQ,Q,this.EJb),this.nk.sc(W.a.LK,za,this.DJb),this.nk.sc(W.a.LK,Q,this.DJb),this.hg.sc(W.a.click,za,this.CJb),this.hg.sc(W.a.click,Q,this.CJb),this.ZD.sc(za,Dk.sJb),this.ZD.sc(Q,Dk.sJb),this.dja.sc(W.a.yx,za,this.rB),this.dja.sc(W.a.yx,Q,this.rB)):ya.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}VFn(Q){this.kNe.push(Q);
this.Mud||(this.Mud=new Uc.a(2,1,50,this.eOn),this.Gb.Wb(this.Mud))}zU(Q){if(Q){var za=Q.n8b;Q=Q.u5b;ad.a.mFa(za)&&ad.a.mFa(Q)?(this.nk.mb(W.a.SQ,za,this.EJb),this.nk.mb(W.a.SQ,Q,this.EJb),this.nk.mb(W.a.LK,za,this.DJb),this.nk.mb(W.a.LK,Q,this.DJb),this.hg.mb(W.a.click,za,this.CJb),this.hg.mb(W.a.click,Q,this.CJb),this.ZD.mb(za,Dk.sJb),this.ZD.mb(Q,Dk.sJb),this.dja.mb(W.a.yx,za,this.rB),this.dja.mb(W.a.yx,Q,this.rB)):ya.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}Epo(){if(!this.ys){for(const Q of this.$0.values())Q.ceb.style.display=
"block";this.ys=!0}}vkm(){this.ys&&(this.$0.forEach(Q=>{Q.ceb.style.display="none"}),this.ys=!1)}WWk(){this.yza.uCa(this.qf.Zc)}RPo(Q){this.hV.R6d();var za=0;const hb=new ob.a;this.uCa();const Tb=this.TTl();for(var zc of Q)Q=zc.Zh,this.Nrn(zc)||this.dbe(zc.Zh),this.$0.has(Q)?this.IMo(zc):this.t2k(zc),za=Q,hb.add(Q);for(zc=1;zc<=za;zc++)hb.contains(zc)||this.dbe(zc);for(za+=1;za<=Tb;za++)this.dbe(za);this.hV.SCd()}Nrn(Q){return this.$0.has(Q.Zh)?this.$0.get(Q.Zh).bPb.id===Q.bPb.id:!1}TTl(){let Q=0;
this.$0.forEach((za,hb)=>{hb>Q&&(Q=hb)});return Q}t2k(Q){const za=Q.bPb.Ee(this.qf.jc);if(za){var hb=Q.Zh;Q=this.SGc(hb,Q.top,Q.height,za.waa,Q.bPb,Q.EAd);this.VFn(Q);this.xig(Q);this.Ujg(Q);this.ykd&&!this.ys&&(Q.ceb.style.display="none");this.$0.set(hb,Q)}}SGc(Q,za,hb,Tb,zc,kd){const ce=Se.b("div","","PageAdornmentContainer");ce.style.top=za+"px";ce.style.height=hb+"px";Tb.appendChild(ce);this.g3e(ce,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Tb=this.R9e(Q);
ce.appendChild(Tb);const df=this.q9e(Q);ce.appendChild(df);const bf=this.g9e(Q);ce.appendChild(bf);l.AFrameworkApplication.isRtl&&(ce.classList.add("Rtl"),df.classList.add("Rtl"),bf.classList.add("Rtl"));return new cn(Q,za,hb,zc,kd,ce,df,bf,Tb)}q9e(Q){Q=Se.b("div","h"+Q,this.Xw?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.eI&&(this.Xw?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=Xl.a.kne);const za=Se.b("span","","");za.innerText=WordEditorIntl.WordEditorStrings.l_Header;
za.style.whiteSpace="nowrap";Q.appendChild(za);return Q}g9e(Q){Q=Se.b("div","f"+Q,this.Xw?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.eI&&(this.Xw?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=Xl.a.kne);const za=Se.b("span","","");za.innerText=WordEditorIntl.WordEditorStrings.l_Footer;za.style.whiteSpace="nowrap";Q.appendChild(za);return Q}R9e(Q){const za=Se.b("div","","PageAdornmentNumberLabel");za.innerText=Q.toString();return za}g3e(Q,za,hb){if(!this.MAe){const Tb=
Se.b("p","","");Tb.innerText=za;Tb.style.whiteSpace="nowrap";Tb.style.visibility="hidden";Q.appendChild(Tb);za=Se.b("p","","");za.innerText=hb;za.style.whiteSpace="nowrap";za.style.visibility="hidden";Q.appendChild(za);this.MAe=Q.clientWidth;this.hV.X8f(this.MAe);Q.removeChild(Tb);Q.removeChild(za)}}dbe(Q){if(this.$0.has(Q)){var za=this.$0.get(Q);this.wTa(za);ad.a.Pw(za.ceb);this.$0.delete(Q)}}IMo(Q){if(this.$0.has(Q.Zh)){var za=this.$0.get(Q.Zh);za.Y5c(Q.top);za.z8f(Q.height);this.xig(za);this.Ujg(za)}else ya.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}uLo(){this.hV.R6d();this.uCa();this.$0.forEach(Q=>{this.xig(Q);this.Ujg(Q)});this.hV.SCd()}xig(Q){const za=Q.n8b,hb=Q.u5b,Tb=this.yza.ENb(Q),zc=this.yza.DNb(Q);this.YRo(Q,Tb,zc);this.hV.a$c(za,Tb);this.hV.a$c(hb,zc)}YRo(Q,za=!0,hb=!0){const Tb=Q.n8b;Q=Q.u5b;3!==l.AFrameworkApplication.xa.mode?(Tb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,Q.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Tb.title=
za?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,Q.title=hb?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}uag(Q){const za=this.v2h(Q);return za?this.PSc(Q)?this.yza.ENb(za):this.yza.DNb(za):(ya.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}v2h(Q){Q=Q.id;Q=Q.substring(1,Q.length);Q=Number.parseInvariant(Q);return this.$0.has(Q)?this.$0.get(Q):(ya.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+Q),null)}PSc(Q){return Q.id.length?"h"===Q.id.substring(0,1):(ya.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}Ujg(Q){const za=Q.height;za<Dk.t8m?(Q.n8b.classList.add(Dk.Ehb),Q.u5b.classList.add(Dk.Ehb)):(Q.n8b.classList.remove(Dk.Ehb),Q.u5b.classList.remove(Dk.Ehb));za<Dk.u8m?(Q.TTi.classList.add(Dk.Ehb),Q.ceb.classList.add(Dk.Ehb)):(Q.TTi.classList.remove(Dk.Ehb),Q.ceb.classList.remove(Dk.Ehb))}y8e(){return!this.TFe||
Y.a.bvf(this.TFe,500)}static sJb(){return!0}}Dk.Ehb="Hidden";Dk.t8m=120;Dk.u8m=50;Object(e.a)(Dk,"PageAdornmentManager",null,[1964,9,1965]);class vl{constructor(Q,za){this.y7d=new ob.a;this.y7d.add(Q);this.y7d.add(za)}}Object(e.a)(vl,"PageElementManagerList",null,[]);var Up=c(65);class em{constructor(Q,za,hb){this.Um=Q;this.uWb=[];this.YJ=za;this.eI=hb}G3i(){for(let Q=0,za=this.uWb.length;Q<za;Q++)ad.a.Pw(this.uWb[Q]);Array.clear(this.uWb)}X3h(Q,za,hb,Tb,zc,kd){let ce=Math.min(Tb.x-kd.x,zc.x-kd.x);
Tb=Math.min(kd.x+kd.width-(Tb.x+Tb.width),kd.x+kd.width-(zc.x+zc.width));za+=zc.y-kd.y;({qha:za,leftMargin:ce,rightMargin:Tb}=this.utk(za,ce,Tb));Q=this.LZl(Q,ce,Tb,ce,Tb,hb);Q.style.top=za+"px";Q.style.zIndex="0";this.uWb.push(Q);Up.d(Q,!0);return Q}rPd(Q){return Q?Q.querySelector(".PageBreakBorderSpan"):null}LZl(Q,za,hb,Tb,zc,kd){return Q?this.X7l(za,hb,Tb,zc,kd):this.d_l(Tb,zc,kd)}utk(Q,za,hb){za/=this.Um.instance.ij;hb/=this.Um.instance.ij;Q/=this.Um.instance.ij;return{qha:Q,leftMargin:za,rightMargin:hb}}qDm(Q){return this.Yyi(Q)&&
this.KTi(Q)?(Q=this.NDb(Q))&&Q.offsetParent?!1:!0:!1}pDm(Q){return!this.Yyi(Q)||this.KTi(Q)?!1:!0}QQ(){}NDb(Q){if(!Q.oVf)return null;let za=null;Q.Kib&&!Q.qba?(Q=this.rPd(Q.oVf))&&(za=Q):za=Q.oVf;return za}Yyi(Q){return Q.Kib&&!Q.qba&&Q.paragraphNode?!0:!1}KTi(Q){Q=Q.paragraphNode;return!!Q&&!!Q.anchor}Iwh(Q,za){Q=ca.a.BDa(Q);za=ca.a.BDa(za);return(Q-za)/this.Um.instance.ij}l3e(Q,za){Q=ca.a.BDa(Q);za=ca.a.BDa(za);return(Q-za)/this.Um.instance.ij}S1d(){this.lAj(!1)}R1d(){this.lAj(!0)}lAj(Q){for(let za=
0,hb=this.uWb.length;za<hb;za++){const Tb=this.uWb[za];"PageEndMarker.Para"===Tb.id?em.pAj(Tb,Q):"PageEndMarker.Table"===Tb.id&&em.iBj(Tb,Q)}}d_l(Q,za,hb){if(!em.sZb){em.sZb=Se.b("div","PageEndMarker.Para","PageEndMarker");var Tb=Se.b("div","","Current FullWidth");this.eI&&(Tb.style.borderTopColor=this.YJ.lva());em.sZb.appendChild(Tb);Tb=Se.b("div","","Stale LeftWing");const zc=Se.b("div","","Stale RightWing");this.eI&&(Tb.style.borderTopColor=this.YJ.lva(),zc.style.borderTopColor=this.YJ.lva());
em.sZb.appendChild(Tb);em.sZb.appendChild(zc)}Tb=em.sZb.cloneNode(!0);Tb.childNodes[1].style.width=Q-10+"px";Tb.childNodes[2].style.width=za-10+"px";em.pAj(Tb,hb);return Tb}X7l(Q,za,hb,Tb,zc){if(!em.sxb){em.sxb=Se.b("div","PageEndMarker.Table","PageEndMarker");var kd=Se.b("div","","Current LeftWing"),ce=Se.b("div","","Current RightWing");this.eI&&(kd.style.borderTopColor=this.YJ.lva(),ce.style.borderTopColor=this.YJ.lva());em.sxb.appendChild(kd);em.sxb.appendChild(ce);kd=Se.b("div","","Stale LeftWing");
ce=Se.b("div","","Stale RightWing");this.eI&&(kd.style.borderTopColor=this.YJ.lva(),ce.style.borderTopColor=this.YJ.lva());em.sxb.appendChild(kd);em.sxb.appendChild(ce)}kd=em.sxb.cloneNode(!0);kd.childNodes[0].style.width=Q+"px";kd.childNodes[1].style.width=za+"px";kd.childNodes[2].style.width=hb-10+"px";kd.childNodes[3].style.width=Tb-10+"px";em.iBj(kd,zc);return kd}static pAj(Q,za){za?em.t3m(Q):em.u3m(Q)}static u3m(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display=
"block"}static t3m(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="none"}static iBj(Q,za){za?em.z3m(Q):em.A3m(Q)}static A3m(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="block";Q.childNodes[3].style.display="block"}static z3m(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="none";Q.childNodes[3].style.display="none"}}
em.sZb=null;em.sxb=null;Object(e.a)(em,"PageEndDOMHelper",null,[]);class tp{constructor(Q,za){this.zvb=this.J8g=null;this.Um=Q;this.pi=za}mdg(Q,za){try{this.pwo(Q,za)}catch(hb){ya.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",hb.message)}}uWk(Q,za,hb,Tb,zc,kd){this.pi.he(()=>{try{this.vWk(Q,za,hb,Tb,zc,kd)}catch(ce){ya.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",
ce.message)}},"PEMPC:CP")}pwo(Q,za){this.J8g=Q;this.zvb=za}vWk(Q,za,hb,Tb,zc,kd){var ce=this.J8g;if(ce&&Q){var df=ce.count,bf=Q.count;if(df&&bf){var Vf=this.ivl(ce,Q);if(Vf.count){var rh=this.Um.ij,ij=this.c2b(Vf)/rh,vi=this.uDh(Vf)/rh;Q=this.SKd(ce,Q);if(Q.count){ce=this.c2b(Q)/rh;rh=this.uDh(Q)/rh;var ti=!0;for(var nk=0;nk<Vf.count;nk++)if(Vf.J(nk)){ti=!1;break}var Wj=nk=0;this.zvb&&za&&(nk=this.uJk(this.zvb,za),Wj=za.count-this.zvb.count);ya.ULS.sendTraceTag(35005343,336,50,"{0}",{["HardPageBreakExists"]:Tb,
["EstimatedPageCount"]:df,["CalculatedPageCount"]:bf,["InOrderAverageDelta"]:ij,["InOrderStandardDeviation"]:vi,["ShortestAverageDelta"]:ce,["ShortestStandardDeviation"]:rh,["PositionsShouldBeUpdated"]:hb,["DocumentHeightChanged"]:zc,["DeltasAllZero"]:ti,["HeaderFooterOpenSinceLastResponse"]:kd,["DeltaInViewport"]:nk,["ChangeInViewportMarkerCount"]:Wj});zc||kd||ti||(ya.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),
za=Vf.toArray().toString(),hb=Q.toArray().toString(),ya.ULS.sendTraceTag(35726603,336,50,"{0} {1}",za,hb))}}}}else ya.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}uJk(Q,za){const hb=new ob.a;for(const Tb of Q)hb.add(Tb.top);if(!hb.count)return-1;Q=new ob.a;for(const Tb of za)Q.add(Tb.top);if(!Q.count)return-1;za=this.SKd(hb,Q);return this.c2b(za)/this.Um.ij}c2b(Q){if(!Q.count)return 0;let za=0;for(let hb=
0;hb<Q.count;hb++)za+=Q.J(hb);return za/Q.count}uDh(Q){if(!Q.count)return 0;const za=this.c2b(Q);let hb=0;for(let Tb=0;Tb<Q.count;Tb++){const zc=Q.J(Tb)-za;hb+=zc*zc}return Math.sqrt(hb/Q.count)}ivl(Q,za){const hb=new ob.a;if(!Q.count||!za.count)return hb;Q.Sc((zc,kd)=>zc-kd);za.Sc((zc,kd)=>zc-kd);const Tb=Math.min(Q.count,za.count);for(let zc=0;zc<Tb;zc++){const kd=Math.abs(Q.J(zc)-za.J(zc));hb.add(kd)}return hb}SKd(Q,za){const hb=new ob.a;if(!Q.count||!za.count)return hb;var Tb=Q.count<=za.count;
const zc=Tb?Q:za;Q=Tb?za:Q;for(za=0;za<zc.count;za++){Tb=zc.J(za);let ce=Math.abs(Tb-Q.J(0)),df=0;for(let bf=1;bf<Q.count;bf++){var kd=Q.J(bf);kd=Math.abs(Tb-kd);kd<ce&&(ce=kd,df=bf)}hb.add(ce);Q.removeAt(df)}return hb}}Object(e.a)(tp,"PageEndMarkerPositionComparer",null,[1961]);var Oq=c(433),Yl=c(529);class Qm{constructor(Q,za,hb,Tb,zc,kd,ce,df,bf,Vf){this.Fq=Q;this._pageNumber=za;this.Kib=hb;this.qba=Tb;this.oVf=zc;this.outlineNode=kd;this.outlineGroupNode=ce;this.N6g=df;this.paragraphNode=bf;this.wU=
Vf}get top(){return this.Fq}get Zh(){return this._pageNumber}get frn(){return this.N6g}Y5c(Q){this.Fq=Q}ife(Q){this._pageNumber=Q}cgj(Q){this.N6g=Q}}Object(e.a)(Qm,"PageEndMarker",null,[]);class vo{constructor(){this.tf=null;this.eKi=0}}Object(e.a)(vo,"PageEndMarkerToRestore",null,[]);class Oi{constructor(Q,za,hb,Tb,zc,kd,ce){this.lUf=(df,bf)=>{bf.property===Ah.a.HI&&(df=bf.node)&&df.ia(Ah.a.HI,!1)&&this.Ewd.contains(df.id)&&(bf=df.Ee(this.qf.jc))&&(bf=bf.htmlElement)&&(this.Ewd.remove(df.id),this.sWa.add(bf))};
this.hI=Q;this.Um=za;this.hLa=hb;this.Kx=Tb;this.NKe=zc;this.bZ=kd;this.Oo=ce;this.Ft=new ob.a;this.vWb=new ob.a;this.rxb=new dd.a;this.Ewd=new Yl.a(new Oq.a);this.sWa=new ob.a;this.yWb=!!zc;this.Gvf()}get qf(){const Q=this.hI.value;ya.ULS.shipAssertTag(37052750,336,Q.Yi,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return Q}o$c(Q){try{this.tPo(Q)}catch(za){this.Kx.QQ(za.message+" "+za.stack),ya.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",
za.message)}}vnk(Q){try{this.wnk(Q)}catch(za){this.Kx.QQ(za.message+" "+za.stack),ya.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",za.message)}}sKk(Q){try{return this.tKk(Q)}catch(za){this.Kx.QQ(za.message+" "+za.stack),ya.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",za.message)}return!1}u0n(){try{this.v0n()}catch(Q){this.Kx.QQ(Q.message+" "+Q.stack),ya.ULS.sendTraceTag(37052753,
336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",Q.message)}}hOc(){try{return this.S2l()}catch(Q){return this.Kx.QQ(Q.message+" "+Q.stack),ya.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",Q.message),null}}Djg(){try{this.UQo()}catch(Q){this.Kx.QQ(Q.message+" "+Q.stack),ya.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",
Q.message)}}P4e(){try{return this.UPk()}catch(Q){return this.Kx.QQ(Q.message+" "+Q.stack),ya.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",Q.message),!1}}Ytm(Q){try{this.Ztm(Q)}catch(za){this.Kx.QQ(za.message+" "+za.stack),ya.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",za.message)}}tPo(Q){if(Q){this.ARk();for(let za=0;za<Q.length;za++){const hb=
za+1,Tb=this.jYk(Q[za],hb);this.Ft.add(Tb);this.rxb.add(hb,Tb)}}}Ztm(Q){let za=!1;for(const hb of Q)if(hb)if(0<hb.rA)for(const Tb of hb.ryf)za=this.ayd(Tb,hb.outlineGroupNode)||za;else if(0>hb.rA){za=!0;for(const Tb of hb.bHd)this.Bcl(Tb.Zh)}za&&this.t3f()}wnk(Q){const za=this.z2h(Q.paragraphNode);this.ayd(Q,za)&&this.t3f()}Bcl(Q){const za=Q-1;0>za||this.Ft.count<=za||(this.Ft.removeAt(za),this.rxb.ob(Q)&&this.rxb.remove(Q))}S2l(){const Q=new ob.a;for(const za of this.Ft)this.X$b(za)&&Q.add(za);return Q}ayd(Q,
za){if(!Q)return ya.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;za=this.gYk(Q,za);Q=Q.Xym?-1:Q.Zh;let hb=!1,Tb;this.rxb.ob(Q)?(Tb=this.rxb.J(Q).Zh,za.ife(Tb),this.Ft.Z(Tb-1,za),this.rxb.remove(Q)):(Tb=za.Zh,this.Ft.insert(Tb-1,za),hb=!0);return hb}jYk(Q,za){return new Qm(0,za,Q.HardBreak,!1,null,null,null,0,null,null)}gYk(Q,za){const hb=Q.Clb,Tb=Q.Zh,zc=Q.wU,kd=!!zc&&zc.HardBreak,ce=Q.qba,df=Q.paragraphNode,bf=this.N9h(za),
Vf=Q.outlineNode;var rh=this.kqf(Vf);if(!rh)return ya.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let ij=null;kd&&(ij=this.Kx.rPd(Q.Clb));Q=this.Kx.Iwh(ij||hb,bf);rh=this.Kx.l3e(ij||hb,rh);return new Qm(rh,Tb,kd,ce,hb,Vf,za,Q,df,zc)}tKk(Q){this.vWb=new ob.a;this.yWb&&this.NKe.reset();this.DSn();this.qso();this.vtk();this.hKk(Q);return 0<this.vWb.count}DSn(){for(let Q=0;Q<this.Ft.count;Q++){const za=this.Ft.J(Q);this.Kx.qDm(za)?
this.K1m(za):(this.Kx.pDm(za)||this.X$b(za)&&!this.kqf(za.outlineNode))&&this.P4i(za)}}vtk(){let Q=0,za=null;var hb=0;let Tb=0;for(let zc=0;zc<this.Ft.count;zc++){const kd=this.Ft.J(zc);this.X$b(kd)&&(kd.Kib&&(Tb+=this.Fwh(kd,hb,Tb)),za&&za.id===kd.outlineNode.id||(za=kd.outlineNode,Tb=Q=0),kd.Kib&&!kd.qba&&(Q=this.fKk(kd)),hb=kd.top+Q+Tb,kd.Y5c(hb))}this.Fwh(null,hb,Tb);this.vSn()}Fwh(Q,za,hb){let Tb=null;this.yWb&&(Tb=this.NKe.iKk(Q,za,hb));return Tb?Tb.delta:0}v0n(){if(this.vWb){for(let Q=0;Q<
this.vWb.count;Q++){const za=this.vWb.J(Q);ad.a.Bao(za.tf,za.eKi)}this.yWb&&this.NKe.r0n()}}UQo(){if(!this.yWb){var Q=this.hLa.B7h();if(this.Ft.count){var za=this.hLa.b5h();for(let zc=0;zc<this.Ft.count;zc++){var hb=this.Ft.J(zc);if(this.X$b(hb)&&hb.qba){hb=this.hLa.z1l(hb.outlineNode);var Tb=0<zc?this.Ft.J(zc-1).outlineNode:za;Tb=zc&&hb.id===Tb.id?this.Ft.J(zc-1).top:0;this.hLa.gfe(hb,Tb)}}za=this.Ft.J(this.Ft.count-1);za.qba?this.hLa.gfe(Q,0):this.hLa.gfe(Q,za.top)}else this.hLa.gfe(Q,0)}}qso(){this.Ft.Sc((Q,
za)=>Q.Zh-za.Zh)}t3f(){for(let Q=0;Q<this.Ft.count;Q++)this.Ft.J(Q).ife(Q+1)}fKk(Q){return Q?this.Hwh(Q)-Q.top:(ya.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}qKk(Q){if(!Q)return 0;const za=this.N9h(Q.outlineGroupNode);return za?this.Kx.Iwh(this.Kx.NDb(Q),za):0}Hwh(Q){if(!Q)return 0;const za=this.Kx.NDb(Q);Q=this.kqf(Q.outlineNode);return Q?this.Kx.l3e(za,Q):(ya.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),
0)}vSn(){let Q=0,za=!1,hb=null,Tb=!1;for(let zc=this.Ft.count-1;0<=zc;zc--){const kd=this.Ft.J(zc);this.X$b(kd)&&(hb&&hb.id===kd.outlineNode.id||(za=!hb,hb=kd.outlineNode,Q=this.sZl(hb)),kd.Kib?(za=!1,Q=kd.top):this.yWb&&za||!(kd.top>Q)||(this.P4i(kd),ad.a.Pw(this.Kx.NDb(kd)),Tb=!0))}Tb&&this.t3f()}P4i(Q){this.Ft.contains(Q)&&(this.yWb&&this.bZ.LTn(Q),this.Ft.remove(Q))}X$b(Q){return Q?(Q=this.Kx.NDb(Q))&&Q.offsetParent?!0:!1:(ya.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),
!1)}UPk(){let Q=!1;for(let za=this.sWa.count-1;0<=za;za--)this.sWa.J(za).hasChildNodes()&&(this.sWa.removeAt(za),Q=!0);return Q}K1m(Q){(Q=this.z2h(Q.paragraphNode))&&(this.Ewd.contains(Q.id)||this.Ewd.add(Q.id))}Gvf(){this.Oo&&this.Oo.af(23).Ro(this.lUf)}hKk(Q){for(let za=this.Ft.count-1;0<=za;za--){const hb=this.Ft.J(za);this.X$b(hb)&&this.gKk(hb,Q)}}gKk(Q,za){const hb=this.Hwh(Q),Tb=this.qKk(Q);Q.Kib?(Q.Y5c(hb),Q.cgj(Tb)):(za=za?hb-Q.top:Tb-Q.frn,Q.Y5c(hb-za),Q.cgj(Tb-za),1<Math.abs(za)&&this.ffo(this.Kx.NDb(Q),
za))}kqf(Q){if(!Q)return null;Q=Q.Ee(this.qf.jc);return Q?Q.htmlElement:(ya.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}N9h(Q){return Q?(Q=Q.Ee(this.qf.jc))?Q.htmlElement:null:null}z2h(Q){Q=Hi.GraphIterator.$a(Q);return Q.Ab(23)?Q.fd(23):null}rZl(Q){if(!Q)return null;Q=Q.Ee(this.qf.jc);return Q?ca.a.getElementBounds(Q.htmlElement):(ya.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}sZl(Q){return(Q=
this.rZl(Q))?Q.height/this.Um.ij:0}ffo(Q,za){za=(ad.a.CNl(Q)-za)*this.Um.ij;this.vWb.add(Object.assign(new vo,{tf:Q,eKi:za}))}ARk(){this.Ft=new ob.a;this.rxb=new dd.a}}Object(e.a)(Oi,"PageEndMarkerPositionUpdater",null,[1955]);var Fj=c(394),Jl=c(37),qm=c(378),El=c(22);class ej{constructor(Q,za,hb,Tb,zc,kd,ce=!1,df=!1,bf=!1,Vf=!1,rh=!1){this.Jkg(za,hb,Tb,zc,kd,bf,rh);this.position=Q;this.Zh=za;this.paragraphNode=hb;this.wU=Tb;this.Clb=zc;this.outlineNode=kd;this.r2a=ce;this.xyi=df;this.Xym=bf;this.qba=
Vf;this.iYd=rh}ife(Q){this.Zh=Q}Jkg(Q,za,hb,Tb,zc,kd,ce){ce||(ya.ULS.shipAssertTag(38326881,336,!!zc,"PageEndDetails: outlineNode parameter value is null."),ya.ULS.shipAssertTag(24126528,336,0<=Q,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",Q),ya.ULS.shipAssertTag(24126529,336,!!za||kd,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),ya.ULS.shipAssertTag(24126530,336,!!hb||kd,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
ya.ULS.shipAssertTag(24126531,336,!!Tb||kd,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static s4k(Q,za){return ej.P8e(0,Q,null,za,!0,!1)}static t4k(Q){return ej.P8e(0,0,null,Q,!1,!0)}static P8e(Q,za,hb,Tb,zc,kd){return new ej(Q,za,null,null,hb,Tb,zc,kd,!0)}static Q2b(Q,za){return new ej(0,Q,null,za,null,null,void 0,void 0,void 0,void 0,!0)}}Object(e.a)(ej,"PageEndDetails",null,[]);class Am{constructor(Q,za,hb,Tb,zc,kd,ce,df,bf,Vf,rh,ij,vi,ti,nk,Wj,Dm,
ek,co,Sr){this.dsa=!0;this.Mue=0;this.opd=this.NAe=this.OAe=this.Nwe=this.LKe=this.yAe=!1;this.ord=this.Wvb=null;this.ZDe=!0;this.rJb=()=>{this.S1d()};this.mRf=()=>{this.OAe=!1};this.nRf=()=>{this.NAe=this.OAe=!0};this.Bkn=(xo,Zl)=>{1>=Math.abs(Zl.delta)||(this.Nwe=!0,this.kAj(!Zl.XJi))};this.xMn=xo=>{xo===this.Wvb&&(this.Wvb=null);if(this.dsa){var Zl=xo.customData;if(xo=this.tWa.get(Zl.id))for(this.tWa.Z(Zl.id,new ob.a),ya.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",
xo.count,Zl.id),this.r$&&this.r$.uCa(),Zl=0;Zl<xo.count;Zl++){const Vm=xo.J(Zl),xa=Vm.wU;xa.HardBreak||(ad.a.Pw(Vm.Clb),this.f3f(xa))}}};this.wMn=()=>{this.ord=null;this.dsa&&this.rha&&0<this.rha.count&&(ya.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.o$c(this.rha.toArray(),this.dsa))};this.hI=Q;this.Nh=za;this.r$=hb;this.lN=Tb;this.V6g=zc;this.Rab=kd;Am.Kx=df;this.wTg=bf;this.kI=Vf;this.Gb=rh;this.BYj=ij;this.ge=ti;this.bZ=Wj;this.PKe=Dm;this.BWb=ek;
this.NY=co;this.cWb=new Fj.a;this.wWb=new ob.a;this.rha=new ob.a;this.tWa=new Fj.a;this.YM=vi;this.oS=Sr;this.E7d=this.E7d.bind(this);this.G7d=this.G7d.bind(this);this.Mae=this.Mae.bind(this);this.Hba=this.Hba.bind(this);this.YM.HCc(this.rJb);this.MKe=!1;nk&&(nk.Wmh(this.nRf),nk.tyd(this.mRf));ce&&ce.crk(this.Bkn);this.oS.kyb(this.Hba)}get BCf(){return this.ZDe}get qf(){return this.hI.value}get Hi(){return this.Nh.value}o$c(Q,za){const hb=this.ge.eg("Task","UpdateMarkers");this.nwo();this.dsa=za;
Am.Kx.G3i();this.cWb=new Fj.a;this.wWb.clear();this.rha.clear();this.tWa=new Fj.a;this.ZDe=this.yAe=!1;this.lN&&this.lN.o$c(Q);this.nol();this.Mue=Q.length;this.bZ&&this.bZ.reset(Q);this.r$&&this.r$.uCa();for(const Tb of Q)this.rha.add(Tb),this.f3f(Tb);za&&this.lN&&this.PKe&&this.PKe.isEnabled&&(Q=this.lN.hOc(),this.PKe.$Ba(Q));this.tWk();this.Nwe=this.LKe=!1;this.NAe=this.OAe;om.WoncaApp.instance.Vhb&&Am.xwf&&this.lN.Djg();this.Rab.QPo(this.lN.hOc(),this.rha.count);this.ZDe=!0;this.NY.qjg();hb.stop();
ya.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:hb.ri,["RenderedLineCount"]:this.Mue,["AvgDurationPerPageInMs"]:hb.ri/this.V9h()})}X9h(){const Q=this.lN.hOc();if(!Q)return null;const za=ad.a.mX(),hb=new ob.a;for(const Tb of Q)this.cHm(Tb,za)&&hb.add(Tb);return hb}cHm(Q,za){if(!Q)return!1;Q=Am.Kx.NDb(Q);if(!Q)return!1;Q=ca.a.BDa(Q);return 0<=Q&&Q<=za}x_h(){const Q=new ob.a;if(!this.tWa)return ya.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),
Q;const za=this.tWa.keys;for(let zc=0;zc<za.length;zc++){var hb=za.J(zc);if(hb=this.tWa.J(hb))for(let kd=0;kd<hb.count;kd++){var Tb=hb.J(kd);Tb.wU.HardBreak||Tb.Clb.classList.contains("Hidden")||(Tb=ca.a.BDa(Tb.Clb),Q.add(Tb))}}return Q}nwo(){const Q=this.x_h(),za=this.X9h();this.V6g.mdg(Q,za);this.BWb&&this.BWb.isEnabled&&this.BWb.mdg(za)}tWk(){if(!(25<this.V9h())){var Q=this.x_h(),za=this.X9h();this.V6g.uWk(Q,za,this.LKe,this.yAe,this.Nwe,this.NAe);this.BWb&&this.BWb.isEnabled&&this.BWb.$Ba(za)}}Hba(){this.r$.KTn();
this.kNh()}kNh(){this.opd&&(this.qf.SUn(this.E7d),this.qf.DVn(this.G7d),this.qf.jVn(this.Mae),this.opd=!1)}nol(){this.opd||(this.qf.rmh(this.E7d),this.qf.Irk(this.G7d),this.qf.Qmh(this.Mae),this.opd=!0)}f3f(Q){if(this.MKe)return!0;Q=this.EWn(Q);if(!Q)return!1;this.bZ&&this.bZ.Mfm(Q);this.lN&&(this.lN.vnk(Q),this.Rab.gAj(this.lN.hOc()),om.WoncaApp.instance.Vhb&&Am.xwf&&this.lN.Djg());return!0}EWn(Q){let za=this.kO(Q.ParaId);if(!za)return null;if(!za.anchor||!za.Wi)return this.Nlh(Q,za),null;let hb,
Tb;if(Q.HardBreak){var zc=Be.ParagraphReader.ug(za,!0,!0,!0);this.Rsn(zc)&&(za=zc);if(!({qha:zc,outlineGroupNode:hb,Alb:Tb}=this.bHo(Q,za)).returnValue)return null;this.yAe=!0}else if(!({z7d:zc,outlineGroupNode:hb,Alb:Tb}=this.FWn(Q,za)).returnValue)return null;return this.ayd(za,Q,zc,hb,Tb)}Rsn(Q){return Q?(Q=Q.Ee(this.qf.jc))?!!Am.Kx.rPd(Q.htmlElement):!1:!1}FWn(Q,za){var hb=Q.PageEndType;let Tb,zc=0,kd=null;if(!hb){if(!({qha:Q,XUf:Tb}=this.Y9h(Q,za)).returnValue)return{returnValue:!1,z7d:zc,outlineGroupNode:kd,
Alb:null}}else if(!({qha:Q,dje:Tb}=this.MZl(Q,za)).returnValue)return{returnValue:!1,z7d:zc,outlineGroupNode:kd,Alb:null};var ce=Hi.GraphIterator.$a(za);ce.yd();kd=ce.fd(23);za=kd.Ee(this.qf.jc).getBounds();ce=ce.gSa().Ee(this.qf.jc);if(!ce)return ya.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.qf.jc),{returnValue:!1,z7d:zc,outlineGroupNode:kd,Alb:null};const df=ce.getBounds();zc=Q-za.y;hb=Am.Kx.X3h(hb,zc,this.dsa,Tb,za,df);ce.waa.appendChild(hb);return{returnValue:!0,
z7d:zc,outlineGroupNode:kd,Alb:hb}}bHo(Q,za){let hb=null;const Tb=za.Ee(this.qf.jc);var zc=0;let kd=null;if(this.xZd(Q,Tb,za))return{returnValue:!1,qha:zc,outlineGroupNode:hb,Alb:kd};hb=Am.GJi(za);const ce=hb.Ee(this.qf.jc);if(!ce)return ya.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.qf.jc),{returnValue:!1,qha:zc,outlineGroupNode:hb,Alb:kd};zc=ce.getBounds();zc=to.a.Gq(Tb,Q.CP).y-zc.y;kd=this.VQl(za);return{returnValue:!0,qha:zc,outlineGroupNode:hb,Alb:kd}}VQl(Q){return Q.Ee(this.qf.jc).htmlElement}kO(Q){const za=
this.kI.Ugb(Q);if(za!==gj.a.nil){const hb=this.Hi.Db(za);if(hb)return hb}ya.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",Q,za);return null}Y9h(Q,za){const hb=Q.CP;let Tb=0,zc=null;const kd=za.Ee(this.qf.jc);if(this.xZd(Q,kd,za))return{returnValue:!1,qha:Tb,XUf:zc};zc=kd.getBounds();Tb=hb?this.wTg(Object(Ya.a)(210,kd),hb):zc.y-this.BYj(kd);return{returnValue:!0,qha:Tb,XUf:zc}}MZl(Q,za){let hb=null,Tb=0;var zc=Q.PageEndType;let kd=Hi.GraphIterator.$a(za);
kd.yd();if(!Jl.TableReader.Jw(kd))return ya.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",Q.ParaId),{returnValue:({qha:Tb,XUf:hb}=this.Y9h(Q,za)).returnValue,qha:Tb,dje:hb};if(1===zc){El.returnToContainingRow(kd);zc=kd.currentNode.Ee(this.qf.jc);if(this.xZd(Q,zc,za))return{returnValue:!1,qha:Tb,dje:hb};Tb=zc.getBounds().y}else{zc=za.Ee(this.qf.jc);if(this.xZd(Q,zc,za))return{returnValue:!1,qha:Tb,dje:hb};Tb=this.wTg(Object(Ya.a)(210,
zc),Q.CP)}--Tb;za=null;do Q=za,za=kd.fd(14);while(za);kd=Hi.GraphIterator.$a(Q);kd.yd();El.moveToFirstRow(kd);hb=kd.currentNode.Ee(this.qf.jc).getBounds();return{returnValue:!0,qha:Tb,dje:hb}}xZd(Q,za,hb){if(!za||za.Fwa(16))return this.Nlh(Q,hb),!0;za=za.getBounds();return za.width||za.height?!1:(this.$kh(Q),!0)}$kh(Q){this.wWb.contains(Q)||this.wWb.add(Q)}Nlh(Q,za){za=za.id;let hb;({value:hb}=this.cWb.Ec(za)).returnValue||(hb=new ob.a,this.cWb.Z(za,hb));hb.add(Q)}E7d(){const Q=new ob.a;for(let za=
this.wWb.count-1;0<=za;za--){const hb=this.wWb.J(za);this.f3f(hb)||Q.add(hb)}this.wWb=Q;this.P4e()}P4e(){this.lN&&this.lN.P4e()&&this.kAj(!1)}kAj(Q){this.lN&&(this.lN.sKk(Q)&&(this.LKe=!0),this.lN.u0n(),this.Rab.gAj(this.lN.hOc()),om.WoncaApp.instance.Vhb&&Am.xwf&&this.lN.Djg())}G7d(Q,za){try{const hb=za.id;if(this.cWb.ob(hb)){const Tb=this.cWb.J(hb);for(Q=0;Q<Tb.count;Q++)this.$kh(Tb.J(Q));this.cWb.remove(hb)}}catch(hb){}}S1d(){this.dsa&&(this.dsa=!1,Am.Kx.S1d())}R1d(){this.dsa||(this.dsa=!0,Am.Kx.R1d())}Fpo(){this.MKe=
!1;this.rha&&this.o$c(this.rha.toArray(),this.dsa);this.r$&&this.r$.cmj()}wkm(){this.MKe=!0;Am.Kx.G3i();this.r$&&this.r$.Gji();this.bZ&&this.bZ.xkm()}ayd(Q,za,hb,Tb,zc){const kd=this.rha.indexOf(za)+1;if(0>kd)return null;const ce=so.WordSectionNavigator.instance.gJ(Q),df=this.qba(za,Q);Q=new ej(hb,kd,Q,za,zc,ce,!Q||!za||!zc,!1,!1,df);this.tWa.ob(Tb.id)||this.tWa.Z(Tb.id,new ob.a);this.tWa.J(Tb.id).add(Q);return Q}qba(Q,za){if(!Q||!Q.HardBreak)return!1;Q=Hi.GraphIterator.$a(za);Q.Ab(7);if(Q.QI())return!1;
Q.fd(23);return Q.QI()?!1:!0}X1i(Q){this.dsa&&(Q.anchor&&Q.Wi?!(Q=Am.GJi(Q))||this.Wvb&&this.Wvb.customData&&this.Wvb.customData.id===Q.id||(this.Wvb=Object.assign(new Uc.a(3,1,500,this.xMn),{customData:Q}),this.Gb.Wb(this.Wvb)):ya.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}Mae(){this.dsa&&!this.ord&&this.rha&&0<this.rha.count&&(this.ord=new Uc.a(3,1,500,this.wMn),this.Gb.Wb(this.ord))}dispose(){this.qf&&this.kNh();this.oS.M2f(this.Hba);
this.YM.Cbe(this.rJb)}static get xwf(){null==Am.OBe&&(Am.OBe=l.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return Am.OBe}static RQl(Q){let za=0;try{const hb=Q.htmlElement,Tb=ad.a.zM(hb.firstChild.style.marginTop);Q=0;const zc=Am.Nqf(hb.parentNode);if(zc){const kd=zc.firstChild;kd&&kd.classList.contains("ParaWrappingDiv")&&(Q=ad.a.zM(kd.firstChild.style.marginBottom))}za=Math.max(Tb,Q)/2}catch(hb){}return za}static Nqf(Q){let za=Q.previousSibling;if(!za){var hb=Q.parentNode;ad.a.PBf(hb)&&
(hb=hb.parentNode)&&(za=hb.previousSibling)}if(!za&&(Q=Q.parentNode,Q.classList.contains("OutlineGroup")||ya.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",Q.tagName,Q.className),(Q=Q.previousSibling)&&Q.hasChildNodes())){za=Q.lastChild;do{if(za.classList.contains("OutlineElement")||ad.a.PBf(za)&&za.classList.contains(qm.a.Ebc))break;za=za.previousSibling}while(za)}if(za){if(za.classList.contains(qm.a.Ebc))return za.lastChild.lastChild;if(ad.a.PBf(za))return za.lastChild}return za}static GJi(Q){Q=
Hi.GraphIterator.$a(Q);return Q.Ab(23)?Q.fd(23):null}V9h(){return this.Mue+1}}Am.Kx=null;Am.OBe=null;Object(e.a)(Am,"PageEndMarkers",null,[1953,1954,9]);var Io=c(119);class Pq{constructor(Q,za,hb){this.crn=".Outline";this.hI=Q;this.Um=za;this.Kx=hb}get qf(){const Q=this.hI.value;ya.ULS.shipAssertTag(38416594,336,Q.Yi,"Invalid PageView.");return Q}f6b(Q){return(Q=Q.outlineNode)?this.L9h(Q):(ya.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}L9h(Q){let za,hb;return(za=Q.Ee(this.qf.jc))&&
(hb=za.htmlElement)?hb.querySelector(this.crn):(ya.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}y2h(Q){Q=Ns.OutlineElementNavigator.El(Q.paragraphNode);let za;return Q&&(za=Q.Ee(this.qf.jc))?za.htmlElement:(ya.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}wwh(Q,za){const hb=this.abm(Q);return this.mKk(Q,za)-hb}R3h(Q){return this.R9h(Q.outlineNode,Q.Zh)}R9h(Q,za){if(!Q)return-1;var hb=Q.ia(Un.a.Zv,-1);hb=jr.a.Ki(hb,1);var Tb=Q.ia(Un.a.marginTop,
-1);Tb=jr.a.Ki(Tb,1);Q=Q.ia(Un.a.marginBottom,-1);Q=jr.a.Ki(Q,1);return 1===za?hb-Q:hb-(Tb+Q)}zcl(Q){Q&&ad.a.Pw(Q.Clb)}Hqf(Q){if(Q.xyi||Q.qba)return 0;if(Q.r2a)return Q=this.f6b(Q),ca.a.getElementBounds(Q).height/this.Um.ij;const za=this.f6b(Q);return this.Kx.l3e(this.W9h(Q),za)}e2k(Q,za,hb){hb=hb.Ee(this.qf.jc).getBounds();Q=Q.Ee(this.qf.jc);const Tb=Q.getBounds();hb.y=Tb.y;za=this.Kx.X3h(0,za*this.Um.ij,!1,hb,hb,Tb);Q.waa.appendChild(za);return za}doi(Q,za){if(Q&&!Q.iYd)if(Q.r2a){if(Q=this.f6b(Q))Q.style.paddingBottom=
za+"px"}else if(Q.wU&&Q.wU.HardBreak)if(Q.qba){if(Q=this.mai(Q))Q.style.paddingBottom=za+"px"}else{if(Q=this.y2h(Q))Q.style.paddingTop=za+"px"}else ya.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}Nnh(Q,za){za=this.f6b(za);Q=this.f6b(Q);return ca.a.BDa(za)-ca.a.BDa(Q)}nai(Q){Q=Hi.GraphIterator.$a(Q.outlineNode);Q.Ab(7);return Q.QI()}xvi(Q){if(!Q||Q.iYd)return!1;if(Q.r2a||Q.xyi)return!0;Q=this.W9h(Q);return!!Q&&ad.a.r7(Q)}QQ(Q){this.Kx.QQ(Q)}mai(Q){return(Q=
this.nai(Q))?(Q=Q.Ej(this.qf.jc).htmlElement,Q?Q:(ya.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}W9h(Q){return Q.wU&&Q.wU.HardBreak&&!Q.qba?this.Kx.rPd(Q.Clb):Q.Clb}abm(Q){if(Q.r2a){Q=this.f6b(Q);if(!Q)return ya.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;Q=Io.a.mC(Q);return ad.a.$fa(Q.paddingBottom)}if(Q.wU&&Q.wU.HardBreak){if(Q.qba)return(Q=this.mai(Q))?ad.a.$fa(Q.style.paddingBottom):-1;Q=this.y2h(Q);return Q?ad.a.$fa(Q.style.paddingTop):(ya.ULS.shipAssertTag(38336529,
336,!0,"Containing outline element Dom is null."),-1)}return 0}mKk(Q,za){return this.Hqf(Q)-za}}Object(e.a)(Pq,"PageFullHeightDOMHelper",null,[]);class wo{constructor(){this.delta=this.ZDj=this.rA=0;this.pha=null;this.ONa=this.MXi=0;this.outlineGroupNode=null;this.yCa=0;this.ryf=new ob.a;this.bHd=new ob.a;this.W$m=new ob.a}}Object(e.a)(wo,"PageFullHeightInfo",null,[]);class io{constructor(Q,za){this.AAa=Q;this.Lx=za}Gwh(Q,za){try{return this.jKk(Q,za)}catch(hb){return this.Lx.QQ(hb.message+" "+hb.stack),
ya.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",hb.message),null}}jKk(Q,za){ya.ULS.shipAssertTag(38416596,336,Q.r2a||Q.wU.HardBreak);const hb=this.Lx.Hqf(Q),Tb=this.Lx.wwh(Q,za),zc=this.AAa.twh(Q,Tb);Q=Object.assign(new wo,{yCa:Tb,ONa:zc,pha:Q});this.GOo(Q);Q.ZDj=Q.ONa-Q.yCa;Q.delta=za+zc+Q.delta-hb;return Q}GOo(Q){Q.yCa>Q.ONa?this.HOo(Q):0>Q.yCa&&this.fjg(Q)}fjg(Q){let za=Q.pha.Zh;for(;0>Q.yCa;)Q.rA--,Q.delta-=this.AAa.RMc(za),Q.yCa+=this.AAa.RMc(za-
1),za--;Q.ONa=this.AAa.RMc(za)}HOo(Q){const za=this.Lx.R3h(Q.pha);Q.rA=Math.floor((Q.yCa-Q.ONa)/za)+1;Q.delta=Q.rA*za;Q.yCa-=Q.ONa+(Q.rA-1)*za;Q.ONa=za}}Object(e.a)(io,"PageFullHeightInfoCalculator",null,[]);class xn{constructor(Q,za,hb,Tb){this.JXa=0;this.gMa=null;this.AAa=Q;this.cvb=za;this.qW=hb;this.Lx=Tb;this.V9g=new ob.a}get mY(){return this.V9g}Mfm(Q){try{this.luf(Q)}catch(za){this.Lx.QQ(za.message+" "+za.stack),ya.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",
za.message)}}reset(Q){try{this.OZn(Q)}catch(za){this.Lx.QQ(za.message+" "+za.stack),ya.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",za.message)}}xkm(){try{this.ykm()}catch(Q){this.Lx.QQ(Q.message+" "+Q.stack),ya.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",Q.message)}}$tm(Q){try{this.aum(Q)}catch(za){this.Lx.QQ(za.message+" "+za.stack),ya.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",
za.message)}}LTn(Q){try{this.MTn(Q)}catch(za){this.Lx.QQ("Pagination: "+za.message+" "+za.stack),ya.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",za.message)}}Pqm(){var Q=this.qW.Nnf(),za=this.qW.t7h();Q=ej.t4k(Q);za=ej.s4k(this.JXa,za);this.mY.Z(0,Q);this.luf(za)}SZn(){var Q=so.WordSectionNavigator.instance.t7h();(Q=this.Lx.L9h(Q).parentNode)&&""!==Q.style.minHeight&&(Q.style.minHeight="")}Mrm(Q){this.V9g=new ob.a;this.mY.add(null);
for(let za=0;za<Q.length;za++){const hb=ej.Q2b(za+1,Q[za]);this.mY.add(hb)}this.mY.add(ej.Q2b(Q.length+1,null))}xrm(Q){this.AAa.ZZn(Q)}v_n(){if(this.mY)for(const Q of this.mY)Q&&this.uti(Q)&&this.Lx.doi(Q,0)}luf(Q){const za=this.t1l(Q);if(this.Lx.xvi(za)){let hb=this.Lx.Hqf(za);Q.outlineNode!==za.outlineNode&&(hb+=this.Lx.Nnh(Q,za));this.sJk(Q,hb);this.uti(Q)&&this.g3f(Q,hb)}else this.gMa.add(Q),20<this.gMa.count&&ya.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.gMa.count);
this.mY.Z(Q.Zh,Q);this.Dfm(Q)}ykm(){this.v_n()}OZn(Q){this.JXa=Q.length+1;this.gMa=new ob.a;this.Mrm(Q);this.xrm(this.JXa);this.Pqm();this.SZn()}aum(Q){this.AAa.TPo(Q);for(const za of Q){if(!za){ya.ULS.sendTraceTag(38916955,336,10,"info is null.");return}if(0<za.rA){Q=za.pha.Zh;for(const hb of za.ryf)this.mY.insert(Q,hb),Q++}else if(0>za.rA)for(const hb of za.bHd)this.mY.remove(hb),this.gMa.contains(hb)&&this.gMa.remove(hb)}this.O6i()}MTn(Q){Q=Q.Zh;this.AAa.NTn(Q);this.mY.removeAt(Q);for(const za of this.gMa)za.Zh===
Q&&this.gMa.remove(za);this.O6i()}sJk(Q,za){za=this.Lx.wwh(Q,za);this.AAa.twh(Q,za)}g3f(Q,za){Q.wU&&Q.wU.HardBreak||this.cvb.g3f(Q,za)}Dfm(Q){Q=Q.Zh+1;for(const za of this.gMa)if(za&&za.Zh===Q){this.luf(za);this.gMa.remove(za);break}}O6i(){for(let Q=0;Q<this.mY.count;Q++){const za=this.mY.J(Q);za&&za.ife(Q)}}uti(Q){Q=this.EZl(Q);return 2===Q||1===Q}t1l(Q){return this.mY.J(Q.Zh-1)}EZl(Q){return Q.r2a?2:Q.wU&&Q.wU.HardBreak?1:0}}Object(e.a)(xn,"PageFullHeightManager",null,[1986]);class vm{constructor(Q,
za,hb,Tb){this.cvb=Q;this.AAa=za;this.qW=hb;this.Lx=Tb}create(){return new xn(this.AAa,this.cvb,this.qW,this.Lx)}}Object(e.a)(vm,"PageFullHeightManagerFactory",null,[]);var Vc=c(1097),Pr=c(606);class xs{constructor(Q,za,hb,Tb,zc){this.xWb=null;this.bZ=Q;this.lN=za;this.pxc=hb;this.cvb=Tb;this.Lx=zc}reset(){this.xWb=new ob.a}iKk(Q,za,hb){try{return this.kKk(Q,za,hb)}catch(Tb){return ya.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",
Tb.message),null}}r0n(){try{this.s0n()}catch(Q){ya.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",Q.message)}}kKk(Q,za,hb){if(!this.bZ.mY.count)return null;const Tb=this.KZl(Q,!Q);if(!Tb||Tb.iYd)return ya.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Tb.wU&&Tb.wU.HardBreak)return null;var zc=this.bZ.mY.J(Tb.Zh-1);return this.Lx.xvi(zc)&&(za-=hb,Tb.outlineNode!==zc.outlineNode&&
(za+=this.Lx.Nnh(Tb,zc)),(zc=this.pxc.Gwh(Tb,za))&&1<Math.abs(zc.delta))?(zc.MXi=za,zc.outlineGroupNode=this.qZl(Q,Tb),this.xWb.add(zc),this.fjg(zc),zc):null}qZl(Q,za){return za&&za.r2a?(Q=Object(Ya.a)(Pr.a,Be.ParagraphReader.KE(za.outlineNode)),Q=Hi.GraphIterator.$a(Q),Q.Yo(),Object(Ya.a)(Vc.a,Q.fd(23))):Q&&Q.Kib?Q.outlineGroupNode:null}s0n(){this.xWb.Sc((Q,za)=>za.pha.Zh-Q.pha.Zh);for(const Q of this.xWb)this.cvb.A6i(Q);this.WPo()}WPo(){this.lN.value.Ytm(this.xWb);this.bZ.$tm(this.xWb)}KZl(Q,za){return za?
this.bZ.mY.J(this.bZ.mY.count-1):this.bZ.mY.J(Q.Zh)}fjg(Q){let za=Q.pha.Zh;const hb=-Q.rA;for(let Tb=0;Tb<hb;Tb++)za--,Q.bHd.add(this.bZ.mY.J(za))}}Object(e.a)(xs,"PageFullHeightPositionUpdater",null,[1985]);class Qr{constructor(Q,za,hb,Tb,zc){this.bZ=Q;this.lN=za;this.pxc=hb;this.cvb=Tb;this.Lx=zc}create(){return new xs(this.bZ,this.lN,this.pxc,this.cvb,this.Lx)}}Object(e.a)(Qr,"PageFullHeightPositionUpdaterFactory",null,[]);class Pn{constructor(Q,za){this.Lx=Q;this.pxc=za}g3f(Q,za){try{this.IWn(Q,
za)}catch(hb){this.Lx.QQ(hb.message+" "+hb.stack),ya.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",hb.message)}}A6i(Q){try{this.HWn(Q)}catch(za){this.Lx.QQ(za.message+" "+za.stack),ya.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",za.message)}}IWn(Q,za){ya.ULS.shipAssertTag(38285913,336,Q.r2a||Q.wU.HardBreak);Q=this.pxc.Gwh(Q,za);this.A6i(Q)}HWn(Q){this.GWn(Q);this.zWn(Q)}zWn(Q){0<Q.rA?this.jum(Q):0>Q.rA&&
this.Acl(Q)}GWn(Q){this.Lx.doi(Q.pha,Q.ZDj)}jum(Q){let za=Q.MXi+Q.ONa;for(let Tb=0;Tb<Q.rA;Tb++){var hb=Q.pha.Zh+Tb;const zc=Q.pha.qba?this.Lx.nai(Q.pha):Q.pha.outlineNode;hb=this.d2k(zc,Q.outlineGroupNode,za,hb);Q.ryf.add(hb);Q.W$m.add(za);za+=Q.ONa}}Acl(Q){for(const za of Q.bHd)this.Lx.zcl(za)}d2k(Q,za,hb,Tb){za=this.Lx.e2k(Q,hb,za);return ej.P8e(hb,Tb,za,Q,!1,!1)}}Object(e.a)(Pn,"PageFullHeightRenderer",null,[]);class Z{constructor(Q){this.P_f=Q}}Object(e.a)(Z,"PageHeightDeltaResult",null,[1981]);
class na{constructor(Q,za,hb){this.hq=null;this.Lx=Q;this.pi=za;hb.execute(Tb=>{Tb.register(this)})}get BXc(){return"PageHeightDelta"}get result(){return this.hq}get AOf(){return 1}get m6f(){return 500}get isEnabled(){return!0}IOf(){this.hq=null}$Ba(Q){this.pi.he(()=>{try{this.uEc(Q)}catch(za){ya.ULS.sendTraceTag(39188045,324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",za.message)}},"PHDM:C")}uEc(Q){this.hq=null;Q=this.vEc(Q);-1!==Q&&(this.hq=new Z(Q))}vEc(Q){if(!Q.count)return-1;
let za=0,hb=0;for(const Tb of Q)Q=this.lKk(Tb),-1!==Q&&(za+=Q,hb++);return hb?za/hb:-1}lKk(Q){if(!Q.WBm)return-1;const za=this.Lx.R9h(Q.EAd,Q.Zh);return-1===za?-1:Math.abs(Q.height-za)}}Object(e.a)(na,"PageHeightDeltaMetric",null,[1950]);class qb{constructor(Q){this.kVa=null;this.Lx=Q}RMc(Q){return this.kVa.J(Q-1)}ZZn(Q){this.kVa=new ob.a;for(let za=0;za<Q;za++)this.kVa.add(-1)}twh(Q,za){if(this.dHm(Q))return this.kVa.J(Q.Zh-1);za=this.LJk(Q,za);this.owo(Q,za);return za}TPo(Q){for(const za of Q)this.SPo(za)}owo(Q,
za){this.kVa.Z(Q.Zh-1,za)}NTn(Q){this.kVa.removeAt(Q-1)}SPo(Q){if(Q)if(0<Q.rA){var za=Q.pha.Zh;for(var hb=0;hb<Q.rA;hb++)this.kVa.insert(za,Q.ONa)}else if(0>Q.rA)for(za=-Q.rA,Q=Q.pha.Zh-za,hb=0;hb<za;hb++)this.kVa.removeAt(Q)}dHm(Q){return-1!==this.kVa.J(Q.Zh-1)}LJk(Q,za){if(Q.r2a||Q.wU.HardBreak)Q=this.Lx.R3h(Q),za=za<Q?Q:za;return za}}Object(e.a)(qb,"PageHeightStorage",null,[]);var Xb=c(117);class wc{constructor(Q){this.P_f=Q}}Object(e.a)(wc,"PageLevelDeltaResult",null,[1981]);class Zc{constructor(Q,
za,hb,Tb){this.hq=null;this.hI=Q;this.Esa=za;this.pi=hb;Tb.execute(zc=>{zc.register(this)})}get qf(){const Q=this.hI.value;ya.ULS.shipAssertTag(39081438,336,Q.Yi,"PageLevelDeltaMetric.PageView is not a PageView.");return Q}get BXc(){return"PageLevelDelta"}get result(){return this.hq}get AOf(){return 0}get m6f(){return 60}get isEnabled(){return!0}IOf(){this.hq=null}$Ba(Q){this.pi.he(()=>{try{this.uEc(Q)}catch(za){ya.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",
za.message)}},"PLDM:C")}uEc(Q){this.hq=null;Q=this.vEc(Q);-1!==Q&&(this.hq=new wc(Q))}vEc(Q){if(!Q.count)return-1;let za=0,hb=0;for(const Tb of Q)Q=this.nKk(Tb),-1!==Q&&(za+=Q,hb++);return hb?za/hb:-1}nKk(Q){if(Q.Kib)return-1;var za=Q.wU.CP;Q=Q.paragraphNode;ya.ULS.shipAssertTag(39081441,336,!!Q);Q=Q.Ee(this.qf.jc);ya.ULS.shipAssertTag(39081442,324,Object(Xb.a)(210,Q));let hb;({jGh:za,mBi:Q,S9i:hb}=this.aKk(Q,ad.a.Zz(Q.htmlElement).length,za));return Q&&hb?Math.min(za.x-Q.x,hb.x-za.x):(ya.ULS.sendTraceTag(39081443,
336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}aKk(Q,za,hb){let Tb,zc,kd,ce=zc=hb,df=kd=Tb=null;if(hb>za)return ya.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{jGh:df,QQm:ce,mBi:kd,Z1n:zc,S9i:Tb};df=this.Esa.Gq(Q,hb);for(var bf=0,Vf=hb;bf<=Vf;){const rh=Math.floor((bf+Vf)/2),ij=this.Esa.Gq(Q,rh);if(bf===Vf){ce=rh;kd=ij;break}ij.y+ij.height<=df.y?bf=rh+1:Vf=rh}for(;hb<=
za;){bf=Math.ceil((hb+za)/2);Vf=this.Esa.Gq(Q,bf);if(hb===za){zc=bf;Tb=Vf;break}Vf.y>=df.y+df.height?za=bf-1:hb=bf}return{jGh:df,QQm:ce,mBi:kd,Z1n:zc,S9i:Tb}}}Object(e.a)(Zc,"PageLevelDeltaMetric",null,[1950]);class vd{constructor(Q,za,hb,Tb,zc,kd,ce){this.Zh=Q;this.top=za;this.zih=hb;this.height=Tb;this.bPb=zc;this.EAd=kd;this.WBm=ce}}Object(e.a)(vd,"Page",null,[]);class ud{constructor(Q,za,hb,Tb,zc){this.rWb=null;this.meh=0;this.hI=Q;this.igd=za;this.U6g=hb;this.hLa=Tb;this.W6g=zc;this.vWa=new ob.a}get qf(){const Q=
this.hI.value;ya.ULS.shipAssertTag(37007393,336,Q.Yi,"PageManager.PageView is not a PageView.");return Q}get Kk(){return this.vWa}gAj(Q){Q=this.X0i(Q);this.iAj(Q)}QPo(Q,za){this.meh=za;Q=this.X0i(Q);this.iAj(Q);this.W6g.isEnabled&&this.W6g.$Ba(Q)}X0i(Q){this.vWa=new ob.a;this.rWb=new Fj.a(0);const za=new ob.a;if(!Q)return this.Kk;var hb=0,Tb=null;for(let zc=0;zc<Q.count;zc++){const kd=Q.J(zc);hb=kd.Zh;Tb=this.CFd(hb,Tb,kd);this.Kk.add(Tb);!ud.LIe&&0>Tb.height&&za.add(Tb);Tb=kd}Q=this.CFd(hb+1,Tb,
null);this.Kk.add(Q);!ud.LIe&&0>Q.height&&za.add(Q);for(const zc of za)ud.LIe=!0,ya.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+zc.Zh);return this.Kk}CFd(Q,za,hb){const Tb=za?za.outlineNode:this.hLa.b5h(),zc=hb?hb.outlineNode:this.hLa.B7h();var kd=this.S9h(Tb);const ce=this.S9h(zc),df=za?this.Dwh(za):0;kd=df+kd;const bf=hb?this.Dwh(hb):this.igd.h4a.clientHeight-ce;return new vd(Q,df,kd,Tb.id===zc.id?bf-df:bf+ce-kd,Tb,zc,(hb?hb.Zh:this.meh+1)===(za?za.Zh:
0)+1)}Dwh(Q){return Q.qba?0:Q.top}iAj(Q){if(this.U6g.y7d)for(const za of this.U6g.y7d)za&&za.jAj(Q)}S9h(Q){this.rWb||(this.rWb=new Fj.a(0));if(this.rWb.ob(Q.id))return this.rWb.J(Q.id);var za=Q.Ee(this.qf.jc);if(!za)return ya.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;za=ca.a.G0a(this.igd.h4a,za.htmlElement).y;this.rWb.Z(Q.id,za);return za}}ud.LIe=!1;Object(e.a)(ud,"PageManager",null,[1951]);var Ie=c(643);class ig{constructor(Q,za,hb,Tb,zc,kd,ce){this.ykg=
this.i4a=!1;this.ga=Q;this.aea=za;this.xSb=hb;this.Ft=Tb;this.Ri=zc;this.Y6g=kd;this.kN=ce;this.i4a=0===this.kN.tv?!0:!1;this.JPf=this.JPf.bind(this);this.kN.tmh(this.JPf)}Ub(){this.ga.gb(Vh.a.C1c,Rj.a.application,this.C1c.bind(this),96);this.ga.gb(Vh.a.T$d,Rj.a.application,this.T$d.bind(this),96);this.ga.gb(Vh.a.gke,Rj.a.application,this.gke.bind(this),96);this.ga.gb(Vh.a.dke,Rj.a.application,this.dke.bind(this),8)}gke(Q,za,hb){return 1===hb?32:this.ga.processAction(Vh.a.F6a,2)}dke(Q,za,hb,Tb){if(1===
hb)return 0===this.kN.tv?32:8;this.i4a?(this.gOh(),this.ykg=!0):(this.FRh(),this.ykg=!1);this.Ri.updateCommandUI();Tb.Ur=this.i4a?1:0;return 32}C1c(Q,za,hb,Tb,zc){if(1===hb)return 32;Q=this.Y6g.GOc();-1===Q?Q="":this.i4a||1===this.kN.tv?(za=this.Y6g.tLl(),za>Q&&(Q=za),Q=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,za,Q)):Q=1===Q?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,Q):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,Q);zc[Ie.a.Visible]=
!0;zc[Ie.a.LabelText]=Q;return 32}T$d(Q,za,hb,Tb,zc){if(1===hb)return 32;zc[Fn.a.On]=this.i4a;return 32}JPf(Q,za){0!==za.Ucc||this.ykg?this.gOh():this.FRh()}FRh(){this.i4a||(this.xSb.pml(),this.Ft.Fpo(),this.i4a=!0)}gOh(){this.i4a&&(this.xSb.Yfl(),this.Ft.wkm(),this.i4a=!1)}}Object(e.a)(ig,"PaginationActor",null,[]);class cg{constructor(Q){this.P_f=Q}}Object(e.a)(cg,"PaginationDeltaResult",null,[1981]);class Jg{constructor(Q,za){this.zvb=this.jhd=null;this.pi=Q;za.execute(hb=>{hb.register(this)})}get BXc(){return"PaginationDelta"}get result(){return this.jhd}get AOf(){return 1}get m6f(){return 200}get isEnabled(){return!0}IOf(){this.jhd=
null}$Ba(Q){this.pi.he(()=>{try{this.uEc(Q)}catch(za){ya.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",za.message)}},"PDM:C")}mdg(Q){this.zvb=Q}uEc(Q){this.jhd=null;Q=this.vEc(this.zvb,Q);-1!==Q&&(this.jhd=new cg(Q))}vEc(Q,za){if(!(Q&&za&&Q.count&&za.count))return-1;const hb=new ob.a;for(const Tb of Q)hb.add(Tb.top);Q=new ob.a;for(const Tb of za)Q.add(Tb.top);za=this.SKd(hb,Q);return this.c2b(za)}c2b(Q){if(!Q.count)return 0;let za=0;for(let hb=
0;hb<Q.count;hb++)za+=Q.J(hb);return za/Q.count}SKd(Q,za){const hb=new ob.a;if(!Q.count||!za.count)return hb;var Tb=Q.count<=za.count;const zc=Tb?Q:za;Q=Tb?za:Q;for(za=0;za<zc.count;za++){Tb=zc.J(za);let ce=Math.abs(Tb-Q.J(0)),df=0;for(let bf=1;bf<Q.count;bf++){var kd=Q.J(bf);kd=Math.abs(Tb-kd);kd<ce&&(ce=kd,df=bf)}hb.add(ce);Q.removeAt(df)}return hb}}Object(e.a)(Jg,"PaginationDeltaMetric",null,[1950]);var Kg=c(413),oi=c(1391),lj=c(2E3);class Sh extends Kg.a{constructor(Q,za,hb,Tb,zc,kd,ce,df=null){super();
this.hN=null;this.Lue=0;this.JXa=-1;this.Lsb=!1;this.gY=()=>{ya.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.iOh()};this.jRf=()=>{if(0==this.oS.tv){var bf=this.hN.kt;gj.a.Sp(bf,this.yVb)||(this.yVb=bf,this.sjn(this.HKa,this.yVb))}};this.oS=Q;this.Hba=this.Hba.bind(this);this.oS.kyb(this.Hba);this.ga=za;this.Ft=hb;this.NY=Tb;this.nka=zc;this.IGe=df||Fo.a.instance;this.yVb=this.HKa=gj.a.nil;this.z3j=ce;kd.CWR(()=>kd.result.zA.tMa(this.gY));this.L3b();
this.$j=new oi.a(1E3);this.$j.RZa();this.nka.register(this)}get woa(){return"Pagination"}get wdf(){return this.z3j.value}get EPm(){return this.HKa}get QHa(){return this.JXa}$ho(Q){this.JXa!==Q&&(this.JXa=Q,this.NY.qjg())}Hba(){this.HKa=this.yVb=gj.a.nil;this.L3b()}alb(Q){this.hN=Q;this.hN.r_b(this.jRf);this.a_b(this.hN.node)}sjn(Q,za){gj.a.Sp(Q,za)?(this.Ft.R1d(),this.L3b()):(this.Ft.S1d(),this.dvo())}yml(){this.enabled=2}L3b(){this.enabled=0}dvo(){this.Lue=0;this.yml();this.DE(null,null,null)}fna(){return Pe.App.lostSession||
Pe.App.xd.zA.eo?!1:!!(this.enabled&2)&&this.$j.qX()}DE(){this.$j.Zfb();this.nka.HU()}forceOutbound(){}m3(){return 0===this.enabled?!1:this.ae&&2===this.ae.status?!0:this.fna()}VRa(){if(1===this._state)this.ae.Jr=lj.a.maa(l.AFrameworkApplication.rootQuerySignature,this.HKa),this.ae.FH="Pagination",this.ae.status=1,this._state=3;else if(3===this._state&&this.ae&&2===this.ae.status)if(l.AFrameworkApplication.Rk)this._state=4;else if(this.$j.N0(),this.$j.V7(),this._state=1,this.Lue++,2!==this.ae.statusCode)this.M3b();
else if(1!==(this.ae.Ij?this.ae.Ij.length:0))this.M3b();else{var Q=this.ae.Ij[0];this.IGe.ATa(Q);104===Q.StatusCode?this.iOh():101===Q.StatusCode?this.M3b():3===Q.StatusCode?this.M3b():Q.StatusCode?this.M3b():Q.PageEnds?(this.$ho(Q.PageEnds.length+1),this.HKa=Uj.b(Q.LastKnownPaginationRevision),ya.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.JXa,this.HKa),this.Ft.o$c(Q.PageEnds,
gj.a.Sp(this.HKa,this.yVb)),this.wdf.rha=Q.PageEnds,this.NY.f3e(),ya.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.JXa,this.HKa),this.ggl()):this.M3b()}}iOh(){this.hN&&this.hN.QLb(this.jRf);this.L3b()}M3b(){60<this.Lue&&this.L3b()}ggl(){gj.a.Sp(this.HKa,this.yVb)&&this.L3b()}dispose(){this.hN&&(this.hN.QLb(this.jRf),this.hN.node&&this.F2c(this.hN.node),this.hN=null);this.oS.M2f(this.Hba)}a_b(Q){Q&&
(Q.addListener(this),this.Lsb=!0)}F2c(Q){this.Lsb&&Q&&(Q.removeListener(this),this.Lsb=!1)}BJb(Q){this.F2c(Q)}onBeforeLoadContent(){}onAfterLoadContent(Q){(Q=Q.ud.Gm)&&this.kgn(this.HKa,Q.id)}onAfterFirstSaveContent(){}kgn(Q,za){gj.a.Sp(Q,za)&&this.Ft.R1d()}}Object(e.a)(Sh,"PaginationReplicator",Kg.a,[1881,9,202]);class Yi{constructor(){this.r$=this.Ft=this.NY=this.xSb=this.mv=null;this.Tra=!1;this.Xvk=()=>{this.Moh()}}get name(){return"WordEditor.Pagination"}yc(Q){this.W=Q;this.jd=this.W.resolve("Box4.IFeatureHelper");
this.W.ha("WordEditor.Pagination.PageElementManagerList",()=>new vl(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.OutlineManager",()=>new Jp(new $b.a(()=>Pe.App.ya.jb.xc))).as("WordEditor.Pagination.IOutlineManager").singleInstance();this.W.ha("WordEditor.Pagination.PageManager",()=>new ud(new $b.a(()=>Pe.App.ya.jb.xc),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),
this.W.resolve("WordEditor.Pagination.PageElementManagerList"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").singleInstance();this.W.ha("WordEditor.IPaginationReplicator",()=>new Sh(this.W.resolve("WordEditor.IMainViewModeManager"),l.AFrameworkApplication.xa,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),Ad.App.z0,
Pe.App.cna(),new $b.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).singleInstance();this.W.ha("WordEditor.ICurrentPageManager",()=>new Ik(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageLevelDeltaMetric",()=>new Zc(new $b.a(()=>Pe.App.ya.jb.xc),this.W.resolve("Box4.ITextMetricsAdapter"),pe.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightDeltaMetric",
()=>new na(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),pe.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PaginationDeltaMetric",()=>new Jg(pe.a.instance,this.W.Sa("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightStorage",()=>new qb(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightDOMHelper",
()=>new Pq(new $b.a(()=>Pe.App.ya.jb.xc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new io(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightRenderer",()=>new Pn(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),
this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new Qr(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),this.W.We("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();
this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new Oi(new $b.a(()=>Pe.App.ya.jb.xc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),
Pe.App.jk.Kl)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManagerFactory",()=>new vm(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageHeightStorage"),so.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).singleInstance();
this.W.ha("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new tp(this.W.resolve("Common.IZoomManager"),pe.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").singleInstance();this.W.ha("WordEditor.Pagination.PaginationActor",()=>new ig(l.AFrameworkApplication.xa,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),l.AFrameworkApplication.ta,this.W.resolve("WordEditor.IPageNumberFinder"),
this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.W.ha("WordEditor.Pagination.DocumentSizeManager",()=>new zr(new $b.a(()=>Pe.App.ya.jb.xc),Nq.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.W.ha("WordEditor.Pagination.CurrentPageCalculator",()=>new uo(l.AFrameworkApplication.xa,Ge.a.instance,ai.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new $b.a(()=>Pe.App.ya.jb.xc),this.W.Ma("Box4.CpConversionManagerImpl"),
this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkers",()=>this.Ft=new Am(new $b.a(()=>Pe.App.ya.jb.xc),new $b.a(()=>Pe.App.ya.jb.Wc.ud),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),
this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),to.a.PNc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),ai.a.instance,Am.RQl,this.W.resolve("Box4.ContentEditableViewEventSource"),new gp.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.W.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.Pagination.IPageEndMarkers").as("Box4.IPaginationRefreshHelper").singleInstance();
this.W.ha("WordEditor.Pagination.PageEndDOMHelper",()=>new em(this.W.Sa("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Pe.App.instance&&Pe.App.instance.wC)).singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new On(l.AFrameworkApplication.oc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentContentManager",()=>new Wk(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").singleInstance();
this.W.ha("WordEditor.Pagination.PageAdornmentManager",()=>this.r$=new Dk(new $b.a(()=>Pe.App.ya.jb.xc),vb.a.instance,sp.a.instance,Ei.a.instance,l.AFrameworkApplication.xa,xq.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),ai.a.instance,l.AFrameworkApplication.K,!!Pe.App.instance&&Pe.App.instance.wC,!!Pe.App.instance&&Pe.App.instance.Nna)).as("WordEditor.Pagination.IPageAdornmentManager").singleInstance()}init(){this.jd.Ip.continueWith(()=>
{this.$m()})}$m(){const Q=Pe.App.ya.jb;Q.Sva?this.Moh():Q.sea(this.Xvk)}Moh(){this.Tra||(this.Tra=!0,this.xSb=pa.a.instance.resolve("WordEditor.ICurrentPageManager"),this.NY=pa.a.instance.resolve("Common.ICurrentPageCalculator"),this.mv=pa.a.instance.resolve("WordEditor.IPaginationReplicator"),pa.a.instance.resolve("WordEditor.Pagination.PaginationActor").Ub())}dispose(){this.r$&&(this.r$.dispose(),this.r$=null);this.Ft&&(this.Ft.dispose(),this.Ft=null);this.mv&&(this.mv.dispose(),this.mv=null);this.NY&&
(this.NY.disable(),this.NY=null);this.xSb&&(this.xSb=null)}}Object(e.a)(Yi,"PackageManager",null,[1,2]);class sk{constructor(){this.W=null}yc(Q){this.W=Q||pa.a.instance}dispose(){}}Object(e.a)(sk,"TellMePackage",null,[1,2]);var pg=c(1483),Bm=c(1485),Jo=c(289),nl=c(1482),Hn=c(1380);class gq{constructor(Q=null,za=null,hb=null,Tb,zc=null){this.rqe=null;this.zHg=!1;this.KRg=this.oRb=null;this.Qck=this.jch=this.zPj=this.LRg=!1;this.Qed=null;this.NPj=null==za?l.AFrameworkApplication.Cyb:za;this.q0j=null==
hb?l.AFrameworkApplication.m_:hb;this.zdk=null==zc?l.AFrameworkApplication.g6a:zc;this.RZj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.jfk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.Yho(!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.afk=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob.HUc;this.bfk=!nl.a.Hna()&&!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");
this.$ek=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.UWj=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob.FNb;this.cfk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.vck=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.O7j=this.v6c||this.u6c;this.M7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");
this.N7j=this.cCf;this.B2j=!!l.AFrameworkApplication.K&&this.fTa&&l.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.sYj=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.YYj=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.gYj=l.AFrameworkApplication.K?parseFloat(l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold",
"-0.6")):-.6;this.y2j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.N0j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenSerpletActionAIFromTellMe",!1)&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableActionAITab",!1)&&nl.a.Dga();
this.itd=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.iek=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.bZj=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",
""):"";this.wck=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.jdk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.Mck=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||this.QO;this.L2j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.$1j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.r2j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===l.AFrameworkApplication.uiCulture;this.I2j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.W2j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.APj=this.fTa&&!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.zZj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",
!1);this.pdk=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==l.AFrameworkApplication.K.kb("Application"));this.dRj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.Xgk=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",
!1)||l.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled"));this.Q0j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.U0j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.XYj=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",
0):0;this.K2j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.sLm;this.S0j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.T0j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.R0j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",
!1);this.dWj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.eWj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.dfk=this.lyi&&(this.QTf||this.RTf||this.JZc||this.fTa&&nl.a.Dga()&&!!l.AFrameworkApplication.K&&(this.sic||this.LNb||this.MNb||this.NNb||this.PNb||l.AFrameworkApplication.K.$("ShowAnswerSearchResults")||
l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||l.AFrameworkApplication.K.$("ShowEntitySearchResults")||l.AFrameworkApplication.K.$("ShowWolframSearchResults")));this.BOj=!!l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&l.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&l.AFrameworkApplication.PBa;this.COj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.zqm(Q||{});this.ZOe=
"2918242107";this.YOe="1454393937";this.kvb={};this.mcb=[];this.ZZk=[nl.a.Yke]}get application(){return this.oRb}get Cyb(){return this.NPj}get s5n(){return this.ZOe}get r5n(){return this.YOe}get Phf(){return this.KRg}get gWh(){return this.LRg}get m_(){return this.q0j}get g6a(){return this.zdk}get yyb(){return this.zPj}get dkm(){return this.RZj}get TAo(){return this.jfk}get lyi(){return!0}get JAo(){return this.dfk}get Vko(){return this.jch}Yho(Q){this.jch=Q}get fTa(){return this.afk}get y8c(){return this.bfk}get w8c(){return this.$ek}get jtl(){return this.UWj}get HAo(){return this.cfk}get Cke(){return!1}get JZc(){return this.O7j}get QTf(){return this.M7j}get RTf(){return this.N7j}get H2a(){return!1}get $Yd(){return!1}get SDf(){return this.B2j}get rge(){return this.Qck}get sic(){return!1}get wmo(){return!1}get PQm(){return""}get wpf(){return 2}get l2l(){return 4}get m2l(){return 5}get fci(){return""}get sOl(){return this.sYj}get wci(){return this.YYj}get hci(){return 1E3}get gci(){return 1E-6}get dxo(){return this.iek}get Jdg(){return!1}get jqj(){return!1}get hJm(){return this.r2j}get JYd(){return!1}get KYd(){return!1}get Rui(){return!1}get Qui(){return!1}get sLm(){return!1}get myi(){return!1}get HKd(){return!1}get Nnb(){return!1}get LNb(){return!1}get MNb(){return!1}get NNb(){return!1}get PNb(){return!1}get v6c(){return this.vck}get mic(){return this.wck}get u6c(){return!1}get Bmf(){return null}get DYd(){return!1}get kge(){return this.Mck}get o9h(){return 0}get oIl(){return this.gYj}get adi(){return this.bZj}get lKm(){return this.y2j}get HVd(){return this.N0j}get qag(){return this.itd}get $Wl(){return-3.9}get QO(){return this.jdk}get IUc(){return this.L2j}get oCf(){return this.$1j}get kEf(){return this.I2j}get Zcb(){return this.APj}get uNm(){return this.W2j}get wva(){return this.zZj}get hnj(){return this.pdk}get ZEk(){return this.dRj}get Ame(){return this.Xgk}get LVd(){return this.Q0j}get mxm(){return this.U0j}get Ru(){return this.XYj}get tjb(){return this.K2j}get kxm(){return this.S0j}get lxm(){return this.T0j}get jxm(){return this.R0j}get Osk(){return this.BOj}get Psk(){return this.COj}get qfa(){return this.dWj}get DId(){return this.eWj}get QGb(){return!!l.AFrameworkApplication.ta&&
l.AFrameworkApplication.ta.Ob.rq}get rq(){return!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob.rq}get SFm(){return!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob.qic}get uan(){return Te.getImageClass("OfficeAssistant_32x32x32")}MNd(){return Promise.reject("GetFindMatchCount method is not overridden")}oZd(Q){return Array.contains(appChrome.selectors.getVisibleControlIds(),Q)}uWd(){return!1}get RXd(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get Vrj(){return l.AFrameworkApplication.K?
l.AFrameworkApplication.K.kb("TellMeServiceHelpClassifierModelName"):""}get cCf(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get JEb(){return"NoOpHeaderUi"}get SZk(){return this.Qed}get parameterData(){return this.kvb}get SHo(){return this.mcb}Sol(){if(this.rqe&&!this.zHg&&(this.zHg=!0,this.Cnb(this.rqe),this.rq)){var Q=pa.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Q=(new Hn.a(Q)).fMd(this.rqe.AG);appChrome.api.dispatch(Q)}}get u6f(){return""}Cnb(){}Qel(Q){const za=
[];for(let hb=0;hb<Q.length;++hb)Q[hb].sno?za.push(new Jo.a(Q[hb].alternate,nl.a.qwj+hb.toString())):za.push(new Jo.a(Q[hb].standard,nl.a.Yke+hb.toString()));return za}zqm(Q){const za={};for(let hb in Q){const Tb=hb,zc=Q[hb];for(let kd in zc){const ce=kd,df=zc[kd];(za[ce]||(za[ce]={}))[Tb]=df}}this.Qed=za}get Wrj(){return""}get Zlj(){return!1}}Object(e.a)(gq,"TellMeApplicationData",null,[1227]);class Aj{constructor(Q,za=null,hb=!1){this.standard=Q;this.alternate=za;this.sno=hb}}Object(e.a)(Aj,"TryQuerySet",
null,[]);class wg{constructor(){this.u3g=this.v3g=null}get X8m(){return this.u3g}efa(Q){this.v3g=Q;return this.J9e(Q)}Dbn(){this.u3g=this.v3g}HOd(Q){return 8===Q.type?String.format(CommonUIStrings.l_FindInDocumentText,Q.BC):Q.BC}amf(Q){return Q.BC}}Object(e.a)(wg,"ParameterizedCommand",null,[]);class Ko extends wg{constructor(Q){super();this.rUc=Q}get commandId(){return this.rUc?"DefinitionsParameterized":"DefinitionButton"}get lVf(){return"Definition"}J9e(Q){const za=db.a.Af(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
Q.BC));return sj.a(nl.a.y$e(Q.value),m.a.abf.toString(),za,nl.a.tyf,null,db.a.Af(nl.a.uAb(Q.BC)),za,null,null)}HOd(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.BC)}amf(Q){return nl.a.uAb(Q.BC)}}Object(e.a)(Ko,"DefinitionsParameterizedCommand",wg,[]);class hp extends wg{constructor(Q){super();this.rUc=Q}get commandId(){return this.rUc?l.AFrameworkApplication.ta.Ob.kCm?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get lVf(){return"Find"}J9e(Q){const za=
db.a.Af(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,Q.BC));return sj.a(nl.a.y$e(Q.value),m.a.findInDocument.toString(),za,"Find_16x16x32",null,db.a.Af(Q.BC),za,null,null)}HOd(Q){return String.format(CommonUIStrings.l_TextWithQuotation,Q.BC)}}Object(e.a)(hp,"FindParameterizedCommand",wg,[]);class Rr extends wg{constructor(Q){super();this.rUc=Q}get commandId(){return this.rUc?"SynonymsParameterized":"SynonymButton"}get lVf(){return"Synonym"}J9e(Q){const za=db.a.Af(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
Q.BC));return sj.a(nl.a.y$e(Q.value),m.a.abf.toString(),za,nl.a.tyf,null,db.a.Af(nl.a.uAb(Q.BC)),za,null,null)}HOd(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.BC)}amf(Q){return nl.a.uAb(Q.BC)}}Object(e.a)(Rr,"SynonymsParameterizedCommand",wg,[]);var Yq=c(2009),Um=c(1925),Kp=c(2036),Ka=c(2004),Bb=c(2005),lc=c(1566);class Kc extends Yq.a{constructor(){super(...arguments);this.uS=null;this.GXa=Um.FindManager.createInstance(this,Kp.a.instance,lc.a.instance,
!0,!0)}static get instance(){return Kc._instance}e5b(){this.uS(this.GXa.Jj.Cia);this.GXa.RYa(!0)}MNd(Q){const za=new Promise((hb,Tb)=>{this.uS=hb;setTimeout(()=>{Tb("Find manager execution timed out");this.GXa.RYa(!0)},500)});Q=Ka.a.createQuery(Q,Bb.a.none);this.GXa.find(Q);return za}}Kc._instance=new Kc;Object(e.a)(Kc,"TellMeFindStatusSpy",Yq.a,[]);class gd extends gq{constructor(Q){super({});this.oRb="Word";this.FYj=Q;l.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.LRg=!0,this.KRg=
this.HKd?"FindWithMatchesParameterized":"FindParameterized");Q=new Ko(this.QGb);const za=new Rr(this.QGb);this.parameterData[Q.commandId]=Q;this.parameterData[za.commandId]=za;Q=new hp(this.QGb);this.parameterData[Q.commandId]=Q;l.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(Q=[new Aj(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new Aj(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new Aj(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new Aj(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,
"",!1),new Aj(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.mcb=this.Qel(Q))}MNd(Q){return Kc.instance.MNd(Q)}get l5a(){return Tp.AppFrame.upa}get JEb(){return Tp.AppFrame.TOa}get u6f(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}Cnb(Q){var za=l.AFrameworkApplication.K;Q=Q.AG;Q.WordCountFlyout=!this.FYj();Q.SelectAllButton=!za.$("TellMeSelectAllResultIsEnabled");const hb=za.$("TellMeDesktopUpSellIsEnabled");let Tb=l.AFrameworkApplication.lEf;
appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Tb));Tb=!1;Q.TextBoxUpSellButton=!hb||Tb;Q.TableOfContentsUpSellButton=!hb||Tb;Q.SmartArtUpSellButton=!hb||Tb;Q.WordArtUpSellButton=!hb||Tb;Q.MultiColumnLayoutUpSellButton=!hb||Tb;Q.InsertEquationUpSellButton=!hb||Tb;Q.TrackChangesUpSellButton=!hb||Tb;Q.ShapesUpSellButton=!hb||Tb;Q.LabelsUpSellButton=!hb||Tb;Q.InsertCitationUpSellButton=!hb||Tb;Q.TextBoxUpSellButtonEnterprise=!hb||!Tb;Q.TableOfContentsUpSellButtonEnterprise=
!hb||!Tb;Q.SmartArtUpSellButtonEnterprise=!hb||!Tb;Q.WordArtUpSellButtonEnterprise=!hb||!Tb;Q.MultiColumnLayoutUpSellButtonEnterprise=!hb||!Tb;Q.InsertEquationUpSellButtonEnterprise=!hb||!Tb;Q.TrackChangesUpSellButtonEnterprise=!hb||!Tb;Q.ShapesUpSellButtonEnterprise=!hb||!Tb;Q.LabelsUpSellButtonEnterprise=!hb||!Tb;Q.InsertCitationUpSellButtonEnterprise=!hb||!Tb;za=!za.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!l.AFrameworkApplication.m_;Q.SynonymButton=za;Q.DefinitionButton=za}get Wrj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName",
"")}get Jdg(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get Vrj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get sic(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get cCf(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",
!1)}get wpf(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get Zlj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get $Yd(){return l.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get RXd(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",
!1)}get JYd(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get KYd(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get hci(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get gci(){return 1E-6*l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",
1)}get Rui(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get Qui(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get fci(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get myi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",
!1)}get o9h(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get lyi(){return l.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get Cke(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get H2a(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get rge(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",
!1)}get jqj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get DYd(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get LNb(){return l.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get MNb(){return l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get NNb(){return l.AFrameworkApplication.K.$("ShowEntitySearchResults")}get PNb(){return l.AFrameworkApplication.K.$("ShowWolframSearchResults")}get Bmf(){return l.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(e.a)(gd,"WordEditorTellMeApplicationData",gq,[]);var Wd=c(1519),af;(function(Q){Q[Q.none=0]="none";Q[Q.waitAll=1]="waitAll";Q[Q.synchronizeFast=2]="synchronizeFast";Q[Q.synchronizeSlow=3]="synchronizeSlow"})(af||(af={}));Object(e.b)("ProviderSynchronizationType",af);var Ce;(function(Q){Q[Q.immediate=0]="immediate";Q[Q.waitAll=1]="waitAll";Q[Q.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";Q[Q.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(Ce||
(Ce={}));Object(e.b)("MenuUpdatePolicy",Ce);var ef=c(1489),Ff=c(1486),di=c(1622),Bg=c(1490),Na=c(1513),$a=c(93),wb=c(250);class qc extends Yq.a{constructor(Q){super();this.Xhk=Q}e5b(){this.Xhk.update()}}Object(e.a)(qc,"TellMeFindStatusManager",Yq.a,[]);class Ic{constructor(Q){this.fcb=this.cKg=null;this.Bi=0;this.ckd="TellMeWAC.";const za=Q.Phf;this.kc=Q;this.rhd=za;this.zGe=Object.assign(new Wd.a,{landingTab:"Indoc",data:null});Q=new qc(this);this.GXa=Um.FindManager.createInstance(Q,Kp.a.instance,
lc.a.instance,!0,!0)}BK(){return"WordFindInDocument"}KT(){return this.kc.wpf?this.kc.wpf===Ce.waitAll?af.waitAll:af.synchronizeSlow:af.none}xH(Q,za){this.HMm(Q)?(this.fcb=Q,this.cKg=za,Q=Ka.a.createQuery(Q.Eg,Bb.a.none),this.Bi=window.performance.now(),this.GXa.find(Q)):za.resultsUpdated(new ef.a(Q))}update(){this.m8n(Math.round(window.performance.now()-this.Bi));var Q=String.format(CommonUIStrings.l_TextWithQuotation,this.fcb.Eg);var za=l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob.Nnb?
nl.a.mNa(this.fcb.Eg,15,this.zGe):db.a.Af(this.fcb.Eg);const hb=[];hb.push(appChrome.actions.setControlLabel(this.rhd,Q));hb.push(appChrome.actions.setCompoundButtonCommandValueId(this.rhd,za));hb.push(appChrome.actions.updateCompoundButtonDescription(this.rhd,this.Nsf()));appChrome.api.dispatch(hb);Q=new Ff.a(this.rhd,di.a.FindInDocument,this.fcb.Eg,this.GXa.Jj.Cia.toString());za=new Bg.a(Na.a.FindInDocument);za.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;za.ww(Q);const Tb=new ef.a(this.fcb);
Tb.Lu(za);window.requestAnimationFrame(()=>{this.cKg.resultsUpdated(Tb)});this.GXa.RYa(!0);this.n8n(Math.round(window.performance.now()-this.Bi))}Nsf(){const Q=this.GXa.Jj.Cia.toString();return"1"===Q?String.format(CommonUIStrings.l_SearchResultText,Q):String.format(CommonUIStrings.l_SearchResultsText,Q)}HMm(Q){return!!Q&&!!Q.Eg&&""!==Q.Eg.trim()}m8n(Q){const za={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",
["QueryLength"]:this.fcb.Eg.length};this.sendActivityEvent(za,Q)}n8n(Q){const za={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.fcb.Eg.length};this.sendActivityEvent(za,Q)}sendActivityEvent(Q,za){Q=$a.a.hC(Q);Si.a.XGa(Object.assign(new wb.a,{name:"Latency",dataFields:Q,durationMs:za}),this.ckd)}}Object(e.a)(Ic,"WordFindInDocumentWithMatchesProvider",null,[1258]);class ed{constructor(Q,za){this.rc=Q;this.jVd=
za}G1a(Q,za,hb){return this.jVd.G1a(0,Q,za,hb)}insertHtmlText(Q){return Q?32===this.Vxf(Q):!1}Vxf(Q){return this.executeCommand(uh.a.MBa,Q)}executeCommand(Q,za){const hb=new tj.DictionaryPropertySet;hb.setValue(Mi.a.EO,za);hb.setValue(Mi.a.Yha,!1);za=this.rc.processAction(Q,1);32===za&&(za=this.rc.Rb(Q,2,hb));return za}}Object(e.a)(ed,"WordInsertContentHandler",null,[1878]);class Ed extends sk{constructor(){super();this.zx=()=>{if(l.AFrameworkApplication.kfg){var Q=Pe.App.ya.Ob.Grf(m.a.tellMe);Q.wSc?
this.vWi():Q.tZ(this.a5n);var za=new gd(()=>!1);pg.TellMeActor.instance.initialize(za,null,null,null,null,null,Object(a.a)(Pe.App.ya,Pe.App.ya.NLd,"forceUpdateRibbonControls"),l.AFrameworkApplication.K,this.W.Sa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.Sa("Common.IActionContextProvider"),this.W.Sa("Common.ISystemInitiatedFeedback"));pg.TellMeActor.instance.hNn(Q);pg.TellMeActor.instance.jPn(new ed(l.AFrameworkApplication.xa,this.W.Ma("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));
za.gWh&&za.HKd&&pg.TellMeActor.instance.lE(new Ic(za),Bm.a.tellMe)}};this.a5n=()=>{this.vWi()}}get name(){return"WordEditor.TellMe"}init(){l.AFrameworkApplication.K.Wo(this.zx)}vWi(){Pe.App.ya.updateCommandUI()}}Object(e.a)(Ed,"WordEditorTellMePackage",sk,[]);class Qd{constructor(){this.W=null;this.Yrj=(Q,za,hb)=>{2===hb&&(Q=new Sb.StandardDialog,Q.zd=0,Q.nia(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>
{this.$m()})}dispose(){}$m(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(126)){l.AFrameworkApplication.xa.gb(Vh.a.wordTestFeature,Rj.a.view,this.Yrj,96);var Q=ci.FocusManager.instance().fe(Tp.AppFrame.xE);kh.AFrame.zi(Q,Db.KeyInputManager.mc(Zd.a.Z7a,5|Db.KeyInputManager.Ph),Vh.a.wordTestFeature)}}yc(Q){this.W=Q}static main(){K.a.instance.Gc(new Qd)}}Object(e.a)(Qd,"WordEditorTestFeaturePackage",null,[1,2]);var Re=c(115);class of{constructor(Q,za){this.A$i=Q;this.rc=za;this.Rde=(hb,
Tb,zc,kd,ce)=>{if(1===zc)return 32;this.A$i.LO(9,ce,!1);return 32};this.S_=(hb,Tb)=>{if(9===Tb.type){var zc;(hb=Tb.dL)?("string"===typeof hb?zc=hb:"data"===hb.type&&(zc=Re.a.fJh(hb.Tzn,hb.newState,hb.aio)),zc&&of.BCc(zc)):ya.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.h2c()}h2c(){this.rc.pa(Vh.a.Rde,y.a.frame,this.Rde);this.A$i.t2(this.S_)}dispose(){}static BCc(Q){Q=Pe.App.ya.notificationBar.Jla(Q,!1);Q.image=5;Q.ona="CoAuth_AuthorStatus_16x16x32";
Pe.App.ya.notificationBar.Kz(Q)}}Object(e.a)(of,"TrackChangeNotificationActor",null,[]);class Fh{constructor(){this.nj=this.FTe=this.W=null;this.AZc=()=>{if(this.nj=Pe.App.uRd().result)this.W.ha("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new of(this.nj,l.AFrameworkApplication.xa)).singleInstance(),this.FTe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}yc(Q){this.W=Q}init(){this.W.resolve("Box4.IFeatureHelper").Ip.continueWith(()=>
{this.$m()})}$m(){Pe.App.uRd().continueWith(this.AZc)}dispose(){this.FTe&&this.FTe.dispose()}}Object(e.a)(Fh,"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var Nj=c(78),Ig=c(1465),Zi=c(1998);class Kh{}Kh.mig="UnsavedChanges";Kh.nig="UnsavedChangesThemed";Kh.s4n="SavedChanges";Kh.xxj="UnsavedChangesOpenPipe";Kh.SKo="UnsavedChangesOpenPipeCssClassNameThemed";Kh.wxj="UnsavedChangesClosePipe";Kh.PKo="UnsavedChangesClosePipeThemed";Kh.QKo="UnsavedChanges";Kh.RKo="UnsavedChangesThemed";
Kh.oig="UnsavedChangesIndicatorPositionRef";Object(e.a)(Kh,"UnsavedChangesHighlightUtils",null,[]);class ik extends Ig.a{constructor(Q,za){super();this.yda=Q;this.Xw=za;this.L1=[this.Xw?new Zi.a(Kh.nig,Kh.RKo):new Zi.a(Kh.mig,Kh.QKo)]}get Xaa(){return!0}get Jhb(){return 4}get m1a(){return this.L1}ZFa(Q,za){if(this.yda){var hb=this.yda.QKf;if(hb&&hb.count&&hb.contains(Q.id))for(Q=za.uGa("span"),za=0;za<Q.length;za++)hb=Q[za],za||hb.classList.add(this.Xw?Kh.SKo:Kh.xxj),za===Q.length-1&&hb.classList.add(this.Xw?
Kh.PKo:Kh.wxj),hb.classList.add(this.Xw?Kh.nig:Kh.mig)}}D0a(){}}Object(e.a)(ik,"UnsavedChangesHighlightActor",Ig.a,[]);var xf=c(1032);class Ye{constructor(Q){this.kve=null;this.yda=Q;this.FDe=!1}get key(){return"UnsavedChangesHighlight"}get zw(){return"UnsavedChanges"}reset(Q){if(this.yda){Q=Q.node;if(Be.ParagraphReader.Yb(Q)){const za=this.yda.QKf;if(za&&za.contains(Q.id)){this.FDe=!0;this.kve=Q.id;return}}this.FDe=!1;this.kve=gj.a.nil}}YHa(){let Q=null;return this.FDe?(Q=Object.assign(new xf.a,
{rG:this.key,contentObject:this.kve,description:null}),{returnValue:!0,xF:Q}):{returnValue:!1,xF:Q}}}Object(e.a)(Ye,"UnsavedChangesHighlightCpContentDetailsProvider",null,[376,59]);class rf{constructor(Q,za,hb,Tb,zc,kd,ce){this.s3g=null;this.p5=Q;this.ff=za;this.$V=hb;this.T5=Tb;this.yfh=zc;this.yXb=kd;this.Xw=ce;this.ff.tMa(this.gY.bind(this))}get QKf(){return this.s3g}Ukm(){if(this.p5){if(1===this.p5.e6e){if(0===this.p5.QFf&&this.p5.lSi()){this.s3g=this.p5.M2d;const Q=this.p5.Z9c;this.p5.t4n.forEach(this.Nfl.bind(this));
Q.forEach(this.Vkm.bind(this));0<Q.length&&this.vhl(this.$V);return 0}return this.VIn(this.p5.QFf)}return 2}return 1}VIn(Q){switch(Q){case 0:return this.p5.Sii()?5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}Nji(Q,za,hb){if(za)if(hb){hb=za.querySelectorAll("span");for(let Tb=0;Tb<hb.length;Tb++){const zc=hb[Tb];Tb||zc.classList.add(Kh.xxj);Tb===hb.length-1&&zc.classList.add(Kh.wxj);zc.classList.add(this.Xw?Kh.nig:Kh.mig)}za.classList.add(Kh.oig);Q&&this.T5.nlc(Q)}else za.classList.add(Kh.s4n)}t8b(Q,
za){const hb=this.t9l(Q);if(Q&&(Q=Q.Ee(Ad.App.ya.jb.xc.jc)))if(Q.Rg&&Q.Rg.Pi&&0!==Q.Rg.Pi.count)for(const Tb of Q.Rg.Pi)this.Nji(hb,Tb,za);else this.Nji(hb,Q.htmlElement,za)}t9l(Q){return this.yfh&&(Q=this.yfh.FOc(Q))&&Q&&(Q=Q.Ee(Ad.App.ya.jb.xc.jc))?Q:null}Vkm(Q){this.t8b(Q,!0);return!0}Nfl(Q){this.t8b(Q,!1);return!0}vhl(Q){Q&&Q.continueWith(()=>{Q.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}gY(Q,za){za===Sys.EventArgs.Empty?ya.ULS.sendTraceTag(572364513,
306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):za&&za.errorCode?this.yXb.JQ||(Q=this.Ukm(),ya.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",Q),Oa.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==Q&&4!==Q&&this.GEo(Q)):ya.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",za?"Error Code":"Kickout Event Args")}GEo(Q){let za;const hb=new ch.a;hb.extendedProperties=new Map;hb.extendedProperties.set("HighlightUnsavedChangesResult",
Q.toString());hb.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(Q){case 1:case 2:case 6:za="HighlightInternalError";break;case 5:za="ChangeOutsideCanvas"}6!==Q&&5!==Q||hb.extendedProperties.set("UnsavedChangesCollectionResult",this.p5.QFf.toString());za&&(Oa.Health.instance.recordQosError(za,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,hb),Oa.Health.instance.recordKpiFailure("UnsavedChangesHighlight",za,!0,!0,hb))}dispose(){this.ff.RLb(this.gY.bind(this))}}Object(e.a)(rf,"UnsavedChangesHighlighter",
null,[9]);var xg=c(531),Lg=c(498),Tk=c(1463);class Ii extends Tk.a{constructor(Q,za){super();this.yda=Q;this.Xw=za}Lnb(Q){if(!this.yda)return!1;const za=this.yda.QKf;return za?za.contains(Q.Cb.id)||Q.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}ZJk(Q,za){za=Q.Lva?Q.Lva[za]?Q.Lva[za].style?Q.Lva[za].style.marginLeft:null:null:null;var hb=Q.leftMargin;Q=1440<=hb?-(hb/1440*96):Q.xdb(0,96,this.zoom);hb=0;za&&(za=za.match(/^(\d+)px/))&&za[1]&&(hb=Number(za[1]));return Q-hb}DKk(Q,za,hb){return Sys.UI.DomElement.getBounds(Q).y-
hb.cba[za].y}PJk(Q){return Sys.UI.DomElement.getBounds(Q).height}BIh(Q,za,hb,Tb){let zc;zc=this.ZJk(hb,za);za=this.DKk(Q,za,hb);Q=this.PJk(Q);Tb=xg.a.createElement(Tb,Lg.a.div);Tb.className=this.Xw?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Tb.style.left=zc+"px";Tb.style.top=za+"px";Tb.style.height=Q+"px";return Tb}RHh(Q,za,hb,Tb){const zc=[],kd=Q.querySelectorAll("."+Kh.oig);if(0===kd.length&&Q.classList.contains(Kh.oig))hb=this.BIh(Q,za,hb,Tb),hb.Uea=za,zc.push(hb);else for(Q=0;Q<
kd.length;Q++){const ce=this.BIh(kd[Q],za,hb,Tb);ce.Uea=za;zc.push(ce)}return zc}reb(Q){let za=[];var hb=Q.b4;const Tb=hb.Og.ownerDocument;if(hb.yj){let zc=0;for(const kd of hb.Rg.Pi)(hb=this.RHh(kd,zc,Q,Tb))&&(za=za.concat(hb)),zc+=1}else za=this.RHh(hb.htmlElement,0,Q,Tb);return za}}Object(e.a)(Ii,"UnsavedChangesIndicatorActor",Tk.a,[]);class $i{constructor(){this.FV=this.lv=this.ZJa=this.T5=this.Ojd=this.yda=null}get name(){return"WordEditor.UnsavedChangesHighlight"}yc(){}init(){this.T5=pa.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;
this.yda=new rf(pa.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),Pd.SessionStatusManager.instance,Tm.a.xp(pa.a.instance.Sa("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.T5,pa.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),pa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!Pe.App.instance&&Pe.App.instance.Nna);this.ZJa=pa.a.instance.Sa("Box4.Accessibility.IAccessibilityContextManager");this.FV=pa.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;
this.Ojd=new Ii(this.yda,!!Pe.App.instance&&Pe.App.instance.Nna);this.T5.Q4a(this.Ojd);this.ZJa&&this.ZJa.execute(Q=>{Q.g4(new Ye(this.yda))});this.lv=new ik(this.yda,!!Pe.App.instance&&Pe.App.instance.Nna);this.FV.P4a(this.lv)}dispose(){this.T5&&this.Ojd&&this.T5.Ale(this.Ojd);this.FV&&this.lv&&this.FV.hig(this.lv);Nj.a.zB(this.yda)}static main(){K.a.instance.Gc(new $i)}}Object(e.a)($i,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,9]);var cl=c(415);class dk{constructor(Q,za,hb,Tb){hb=new wordVersionHistory.AppBootSettings;
hb.logger=new cl.a;hb.forcePdfDevEnv=!1;hb.userSessionId=l.AFrameworkApplication.userSessionId;hb.documentId=Q.xne?l.AFrameworkApplication.fm:"";hb.wacCluster=Tb;hb.publicScriptPath=l.AFrameworkApplication.I4;hb.userType=l.AFrameworkApplication.userType;hb.isStaticVersionDisplayEnabled=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VersionHistoryStaticDisplay",!1);hb.disableVhsFileCache=Q.xne;this.Tme=new wordVersionHistory.AppVersionControllerImpl(hb,za)}onVersionSelected(Q,
za,hb,Tb){this.Tme.onVersionSelected(Q,za,hb,Tb)}onDownloadTokenReady(Q,za){this.Tme.onDownloadTokenReady(Q,za)}getRenderFailureEvent(){return this.Tme.getRenderFailureEvent()}getLoadFinishEvent(){return this.Tme.getLoadFinishEvent()}}Object(e.a)(dk,"AppVersionControllerImplWrapper",null,[1979]);class es{create(Q,za,hb,Tb){return new dk(Q,za,hb,Tb)}}Object(e.a)(es,"AppVersionControllerImplWrapperFactory",null,[1946]);class fs{getVersionHistoryControllerInstance(Q){return versionHistory?versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Q):
null}}Object(e.a)(fs,"VersionHistoryControllerFactory",null,[1945]);class kr{static addAppPLTEventToLog(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Q)}catch(za){}}static setIsPageLoadForFirstTime(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Q)}catch(za){}}}Object(e.a)(kr,"VersionHistoryLogConnector",null,[]);var ao=c(534),St=c(1449),ct=c(1666);class lu{constructor(){this.revisionId=null;this.F4f=0}}Object(e.a)(lu,"ForceSaveData",
null,[]);class cv extends fh.a{constructor(){super();this.ExclusiveLockId=this.VersionToken=this.FileId=null}Cl(){return 106}static construct(Q,za,hb){const Tb=new cv;Tb.FileId=Q;Tb.VersionToken=za;Tb.ExclusiveLockId=Uj.a(hb);return Tb}}Object(e.a)(cv,"RestoreVersionRequest",fh.a,[]);class jo{static $ma(){return(new Date).getTime()}static cYk(Q){const za=new ch.a;za.durationMs=Q;za.extendedProperties=new Map;return za}}Object(e.a)(jo,"VersionHistoryUtils",null,[]);var dv=c(314);class lr{constructor(Q,
za,hb,Tb,zc,kd,ce,df,bf,Vf,rh,ij,vi,ti,nk){this.rc=Q;this.tg=za;this.zE=hb;this.Pzl=Tb;this.Zs=zc;this.JCi=kd;this.imc=ce;this.NAd=df;this.rVo=bf;this.K=Vf;this.kwk=rh;this.T0e=ij;this.Jpb=vi;this.Qe=ti;this.Ukg=nk;this.KTa=this.VKc=this.N6c=this.Tge=this.sbg=this.Qhg=this.perfTelemetryInfos=this.baseVersion=this.currentVersion=this.controller=null;this.jde=0;this.T_b=this.Sme=null;this.Wkg=St.b.None;this.jac=!1;this.Ykg="";this.prl={0:"GeneralSaveError",1:"InvalidFileName",2:"EmptyFileName",3:"InvalidPermission",
4:"OverwriteTarget",5:"TargetFileLocked",6:"InvalidFileNameDisallowPercentOctothorpe"};this.zmj=(Wj,Dm,ek)=>{if(1===ek)return Pd.SessionStatusManager.instance.xj?8:32;if(2===ek){this.Sme=Nc.a.create().toString();ya.ULS.sendTraceTag(592196993,3005,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.Sme);l.AFrameworkApplication.An("Microsoft.Office.Web.SessionSettings.IDocsWordVersionHistorySaveACopyOverFlowMenuSettings");l.AFrameworkApplication.loa("WoVer882;WoVer882cf");
Object(ct.a)();this.Qe.logKpiUsage("WordVersionHistory",0,{isForAlertableKpi:!0});this.Qe.hy(Vh.a.vqn,{succeeded:!0});this.Krj.ShowVersionHistoryDialog=(new Date).getTime().toString();this.Eu.VersionHistoryLaunchSessionId=this.Sme;this.perfTelemetryInfos=[];this.controller||(this.Ykg=this.K.kb("WacCluster"),this.controller=this.rVo.getVersionHistoryControllerInstance({ulsLogger:new cl.a,serviceBase:this.K.appSettings.VersionHistoryWebServiceBase,docId:l.AFrameworkApplication.fm,appSettings:{appName:St.a.Word,
wdEnableDownloadTokens:this.imc.bFj,wdEnableSaveACopy:!0,wdEnableRestore:this.imc.$Ej,userSessionId:l.AFrameworkApplication.userSessionId,wacCluster:this.Ykg,uiLocale:l.AFrameworkApplication.uiCulture?l.AFrameworkApplication.uiCulture:"en-us",wdEnableHiddenButtonsUntilVersionLoadComplete:!0,wdEnableShowVersionChanges:!0,disabledChangeGates:l.AFrameworkApplication.K.kb("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.imc.aFj,isRtl:l.AFrameworkApplication.isRtl,wdEnableAppColorUpdate:this.K.$("AppColorUpdateIsEnabled"),
useXhr:!1,retryCount:0,wdEnableDeleteVersions:!1,wdEnableIterator:!1,viewerRootPositionRelative:!1,disableSaveACopy:!1,wdDisableSPOFileCache:this.imc.xne},perfTelemetryInfos:this.perfTelemetryInfos}));if(!this.controller)return this.Qe.logKpiFailure("WordVersionHistory","scriptDependencyUnavailable",{isIntentional:!1},{name:lr.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1}),8;this.controller.setDisableSaveACopy(this.bko()||this.Zjo());this.Rqo()}return 32};this.IYn=(Wj,
Dm,ek)=>{if(1===ek)return Pd.SessionStatusManager.instance.vH?32:8;2===ek&&(Wj=this.aeb(this.jde),this.Qe.logKpiSuccess("WordVersionHistorySaveACopy",{additionalValues:Wj}),this.x0f());return 32};this.HYn=(Wj,Dm,ek,co,Sr)=>{var xo,Zl,Vm;if(1===ek)return Pd.SessionStatusManager.instance.vH?32:8;2===ek&&(Wj="Unknown",Dm="",Sr&&(Wj=null!==(xo=Sr.FailureReason)&&void 0!==xo?xo:Wj,Sr=null!==(Zl=Sr.ExtraInfo)&&void 0!==Zl?Zl:"",Dm=null!==(Vm=this.prl[Sr])&&void 0!==Vm?Vm:Sr),Zl=this.aeb(this.jde),""!==
Dm&&Zl.extendedProperties.set("ExtraInfo",Dm),Vm=this.Jpb.ghb(Wj,3,Dm),this.Qe.logKpiFailure("WordVersionHistorySaveACopy",Wj,{isIntentional:Vm.isIntentional,additionalValues:Zl},Vm),ya.ULS.sendTraceTag(592197004,3005,10,"Save failed with {0} {1}",Wj,Dm));return 32};this.c_d=()=>{this.lLi();this.x0f();this.Zs&&this.Zs.refreshDocument({Fno:!0})};this.Rzl=Wj=>{ya.ULS.sendTraceTag(592197010,3005,50,"DocumentSavedSuccessfully");var Dm=Wj.revisionId;const ek=gj.a.create();Dm=cv.construct(l.AFrameworkApplication.rootQuerySignature,
Dm,ek);const co=Object.assign(new Af.a,{Jr:Dm,status:1,FH:"RestoreVersion"});Dm=this.T0e.Ifa(0,()=>{this.mgm(co,Wj.F4f)});Dm.pI(co);Dm.jT()};this.GYh=(Wj,Dm)=>{this.jac=!1;const ek=this.aeb(Wj.F4f);ek.extendedProperties.set("status",ao.a[Dm]);const co=this.Jpb.ghb("ForceSaveFailed",5);this.Qe.logKpiFailure("WordVersionHistoryRestore","forceSaveFailed",{isIntentional:co.isIntentional,additionalValues:ek},co);this.Qe.hy(Vh.a.pFc,{succeeded:!1});ya.ULS.sendTraceTag(592197011,3005,10,"ForceSaveFailed with status"+
ao.a[Dm]+" for version "+Wj);this.controller.setRestoreFailedAtServer(this.c_d)};this.Krj={};this.Eu={};this.Qqo=!1;this.uO=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Ob.uO}dCd(){null===this.VKc&&(this.VKc=jo.$ma())}aeb(Q){const za=new ch.a;null===Q?ya.ULS.sendTraceTag(541693581,3005,10,"constructKpiAdditionalValuesWithDurationFromStartTime called with null startTime"):(za.durationMs=jo.$ma()-Q,za.extendedProperties=new Map);return za}asm(){null===this.KTa&&(this.KTa=jo.$ma());this.Qe.logKpiUsage("WordVersionHistorySelectVersion",
0,{isForAlertableKpi:!0})}x0f(){const Q=[],za=Object.assign(new ch.a,{extendedProperties:new Map});if(null!=this.Tge&&null!=this.sbg){var hb=this.Tge-this.sbg;Q.push(Object.assign(new ii.a,{name:"showPaneDuration",string:hb.toString()}));za.extendedProperties.set("showPaneDuration",hb.toString())}null!=this.VKc&&null!=this.N6c&&(hb=this.VKc-this.N6c,Q.push(Object.assign(new ii.a,{name:"firstActionDuration",string:hb.toString()})),za.extendedProperties.set("firstActionDuration",hb.toString()));(hb=
this.Wkg===St.b.None)?this.Qe.logKpiSuccess("WordVersionHistory",{additionalValues:za}):this.Qe.logKpiFailure("WordVersionHistory",St.b[this.Wkg],{isIntentional:!1,additionalValues:za},{name:lr.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1});this.Qe.hy(Vh.a.iTk,{succeeded:hb,customData:Q})}Ub(){this.rc.pa(m.a.ehe,y.a.frame,this.zmj);this.rc.pa(m.a.u3c,y.a.frame,this.IYn);this.rc.pa(m.a.ace,y.a.frame,this.HYn)}Rqo(){this.sbg=jo.$ma();this.VKc=this.N6c=this.Tge=null;if(document.getElementById("VersionHistoryOverlay"))this.nI();
else{this.EOn();this.DOn();this.nOn();this.sOn();this.BOn();this.rOn();this.imc.cFj&&this.qOn();this.AOn();this.COn();const Q=document.createElement("div");let za=Q.id="VersionHistoryOverlay",hb=null;this.tOn(Q);if(this.uO&&(hb=Object(dv.a)("Header"))){const Tb=document.getElementById("AppHeaderPanel");za=Tb&&"none"===Tb.style.display?String.format("{0} {1} {2}",za,"RegionComposer","NoAppHeader"):String.format("{0} {1}",za,"RegionComposer")}hb||(hb=document.getElementById("WACInnerFrame"));Q.className=
za;hb.appendChild(Q);this.Qhg=this.controller.createVersionHistoryDialog(Q);this.lia()}document.getElementById("VersionHistoryOverlay").style.display="block";this.controller.getVersions("")}bko(){if(l.AFrameworkApplication.qG)return ya.ULS.sendTraceTag(570770272,3005,15,"Version History is disabling Save a Copy because this is a protected file."),!0;const Q=32==this.rc.processAction(m.a.Sgc,1),za=32==this.rc.processAction(m.a.Ugc,1);return Q||za?!1:(ya.ULS.sendTraceTag(545403476,3005,15,"Version History is disabling Save a Copy because the save commands are disabled."),
!0)}Zjo(){return l.AFrameworkApplication.qG?(ya.ULS.sendTraceTag(545387291,3005,15,"Version History is disabling download version because this is a protected file."),!0):32!=this.rc.processAction(m.a.downloadACopy,1)?(ya.ULS.sendTraceTag(545403477,3005,15,"Version History is disabling download version because the download command is disabled."),!0):!1}sOn(){this.controller.getFullAppErrorEvent().addListener(Q=>{const za=Q?St.b[Q]:"";this.Eu[lr.BAo]=za;this.Wkg=Q;ya.ULS.sendTraceTag(592196994,3005,
10,"Full App Error Event: {0}, VersionHistoryLaunchSessionId: {1}",za,this.Sme)})}EOn(){this.controller.getVersionsReadyEvent().addListener(Q=>{this.Tge=jo.$ma();this.vZn(Q.containerDiv);this.Ukg.initialize(this.T_b);this.nI()})}DOn(){this.controller.getVersionSelectedEvent().addListener(Q=>{null===this.KTa&&(this.KTa=jo.$ma());this.Ukg.display(Q)})}qOn(){this.controller.getDownloadTokenReadyEvent().addListener(Q=>{try{ya.ULS.sendTraceTag(592196998,3005,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),
this.Zem(Q)}catch(za){ya.ULS.sendTraceTag(592197002,3005,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",za)}})}Zem(Q){Q&&Q.versionSelected?(this.currentVersion=Q.versionSelected.currentVersion,this.baseVersion=Q.versionSelected.baseVersion,this.asm(),this.T_b.onVersionSelected(this.currentVersion,this.baseVersion,this.Krj,!this.Qqo)):ya.ULS.sendTraceTag(591697922,3005,10,"handleGetDownloadTokenReadyEvent: downloadTokenReadyObject.versionSelected was null")}nOn(){this.controller.getCloseSelectedEvent().addListener(()=>
{this.jTk();this.pQm()})}trm(Q){const za={};za.FileDownloadUrl=Q;za.SaveEntryPoint="VersionHistory";return za}h4l(Q){let za="Dialog Failure - ActionResponse "+Q.toString();2===Q?za="DialogNotHandled":8===Q&&(za="DialogFailed");return za}BOn(){this.controller.getSaveACopySelectedEvent().addListener(Q=>{this.jde=jo.$ma();this.Qe.logKpiUsage("WordVersionHistorySaveACopy",0);this.dCd();ya.ULS.sendTraceTag(592197003,3005,50,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent");this.lLi();var za=
this.trm(Q);Q=32==this.rc.processAction(m.a.Sgc,1);za=this.rc.Rb(Q?m.a.Sgc:m.a.Ugc,2,za);const hb=this.aeb(this.jde),Tb=32===za;if(!Tb){const zc=this.h4l(za),kd=this.Jpb.ghb(zc,2);this.Qe.logKpiFailure("WordVersionHistorySaveACopy",zc,{isIntentional:kd.isIntentional,additionalValues:hb},kd);ya.ULS.sendTraceTag(578033103,3005,10,Q?"SaveACopy":"SaveToSharePoint failed with ActionResponse: "+za.toString())}this.Qe.hy(Vh.a.fSk,{succeeded:Tb})})}rOn(){this.controller.getDownloadVersionSelectedEvent().addListener(Q=>
{var za=jo.$ma();this.Qe.logKpiUsage("WordVersionHistoryDownloadVersion",0);this.dCd();Q=new gl.QueryStringBuilder(Q);Q.De("fn",l.AFrameworkApplication.fileName);Q=this.rc.Rb(m.a.downloadACopy,2,{["FileDownloadUrl"]:Q.toString()});za=this.aeb(za);const hb=32===Q;hb?this.Qe.logKpiSuccess("WordVersionHistoryDownloadVersion",{additionalValues:za}):(this.Qe.logKpiFailure("WordVersionHistoryDownloadVersion",Q.toString(),{isIntentional:!1,additionalValues:za},{name:lr.vetoName,errorNameOverride:"DownloadVersionFailed"}),
ya.ULS.sendTraceTag(592197005,3005,10,"Download version failed with result: "+Q.toString()));this.Qe.hy(Vh.a.eSk,{succeeded:hb})})}mgm(Q,za){this.jac=!1;if(2===Q.statusCode&&Q.Ij&&0<Q.Ij.length&&Q.Ij[0])if(Q=Q.Ij[0],za=this.aeb(za),this.JCi&&Q.ShouldAvoidLockRelease&&this.JCi.inb(!1,"VersionHistory"),191===Q.StatusCode)Q=this.Jpb.ghb("MultipleClientsInCoauthSession",5),this.Qe.logKpiFailure("WordVersionHistoryRestore","multipleClientsInCoauthSession",{isIntentional:!0,additionalValues:za},Q),this.Qe.hy(Vh.a.pFc,
{succeeded:!1}),ya.ULS.sendTraceTag(592197006,3005,10,"RestoreVersionRequest failed with MultipleClientsInCoauthSession"),this.controller.setCoauthRestoreError(),lr.qQm();else if(Q.StatusCode){za.extendedProperties.set("status",ao.a[Q.StatusCode]);const hb=this.Jpb.ghb("ServerOperationFailed",5);this.Qe.logKpiFailure("WordVersionHistoryRestore","restoreVersionResponseFailed",{isIntentional:!1,additionalValues:za},hb);this.Qe.hy(Vh.a.pFc,{succeeded:!1});ya.ULS.sendTraceTag(592197007,3005,10,"RestoreVersionRequest failed with "+
ao.a[Q.StatusCode]);this.controller.setRestoreFailedAtServer(this.c_d)}else this.Qe.logKpiSuccess("WordVersionHistoryRestore",{additionalValues:za}),this.Qe.hy(Vh.a.pFc,{succeeded:!0}),ya.ULS.sendTraceTag(592197008,3005,50,"Restore Version Successful."),this.c_d();else za=this.Jpb.ghb("ServerOperationFailed",5),this.Qe.logKpiFailure("WordVersionHistoryRestore","serverOperationFailed",{isIntentional:za.isIntentional},za),ya.ULS.sendTraceTag(592197009,3005,10,"serverOperation failed with "+Sn.a[Q.statusCode]),
this.controller.setRestoreFailedAtServer(this.c_d)}AOn(){this.controller.getRestoreVersionSelectedEvent().addListener(Q=>{if(this.jac)ya.ULS.sendTraceTag(536998742,3005,50,"restore already in progress");else{this.jac=!0;this.dCd();var za=jo.$ma();this.Qe.logKpiUsage("WordVersionHistoryRestore",0);var hb=null;Q&&(hb=Q.split("-")[0]);hb&&""!==hb?(Q=Object.assign(new lu,{revisionId:hb,F4f:za}),ya.ULS.sendTraceTag(592197013,3005,50,"VersionHistoryPaneActor: RegisterForRestoreVersionSelectedEvent: {0}",
hb),this.controller.setRestoreInProgress(),this.Pzl(19,!1,this.Rzl,this.GYh,Q,null,null)):(hb=this.Jpb.ghb("InvalidRevisionId",5),this.Qe.logKpiFailure("WordVersionHistoryRestore","invalidRevisionId",{isIntentional:hb.isIntentional},hb),this.Qe.hy(Vh.a.pFc,{succeeded:!1}),ya.ULS.shipAssertTag(592197012,3005,!1),this.jac=!1)}})}FOn(){this.T_b.getRenderFailureEvent().addListener(Q=>{const za=this.Jpb.ghb(Q,1),hb=this.aeb(this.KTa);this.KTa=null;this.Qe.logKpiFailure("WordVersionHistorySelectVersion",
Q,{isIntentional:za.isIntentional,additionalValues:hb},za);try{this.Eu.ViewerErrorCode="ViewerErrorCode"in this.Eu?this.Eu.ViewerErrorCode+("; "+Q):Q,this.controller.setViewerError(!0),ya.ULS.sendTraceTag(592197014,3005,10,"Versions viewer error code: {0}",Q)}catch(Tb){ya.ULS.sendTraceTag(592197015,3005,10,"Failed to set viewer error: {0}",Tb)}})}uOn(){this.T_b.getLoadFinishEvent().addListener(()=>{null==this.N6c&&(this.N6c=jo.$ma());const Q=this.aeb(this.KTa);this.KTa=null;this.Qe.logKpiSuccess("WordVersionHistorySelectVersion",
{additionalValues:Q});this.controller.setVersionLoadComplete()})}COn(){this.controller.getShowVersionChangesToggledEvent().addListener(()=>{null===this.KTa&&(this.KTa=jo.$ma());this.Ukg.qDo()})}allowKeytips(Q){F.a("allowKeytips")&&appChrome.api.allowKeytips(Q)}nI(){this.zE.nx(Tp.AppFrame.upa);this.allowKeytips(!1);this.zE.nx(kh.AFrame.$n);this.zE.nx(Tp.AppFrame.Vpa);this.tg.TK("VersionHistoryViewer",!1);this.zE.nI("VersionHistoryViewer");this.tg.TK("VersionHistoryHeader",!0);this.zE.nI("VersionHistoryHeader");
this.tg.TK("VersionHistoryOverlay",!0);this.zE.nI("VersionHistoryOverlay")}nx(){this.zE.nI(Tp.AppFrame.upa);this.allowKeytips(!0);this.zE.nI(kh.AFrame.$n);this.zE.nI(Tp.AppFrame.Vpa);this.zE.nx("VersionHistoryOverlay");this.tg.cR("VersionHistoryOverlay");this.zE.nx("VersionHistoryHeader");this.tg.cR("VersionHistoryHeader");this.zE.nx("VersionHistoryViewer");this.tg.cR("VersionHistoryViewer")}jTk(){this.jac&&ya.ULS.sendTraceTag(536998743,3005,10,"restore did not complete!");this.x0f();document.getElementById("VersionHistoryOverlay").style.display=
"none";this.Eu.browser=Ta.a.GF;Ta.a.u3&&(this.Eu.electronBrowserVersion=Ta.a.vll);this.nx();ya.ULS.sendTraceTag(592197017,3005,50,Xa.c(this.Eu))}vZn(Q){try{if(this.T_b)kr.setIsPageLoadForFirstTime(!1);else{kr.setIsPageLoadForFirstTime(!0);const za=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryBadGatewayFixEnabled",!1)?this.Ykg:"";this.T_b=this.kwk.create(this.imc,Q,this.NAd,za);this.FOn();this.uOn()}}catch(za){ya.ULS.sendTraceTag(592197018,3005,10,"WordVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",
za)}}jAb(Q){const za=this.tg.fe(Q);za.parent=kh.AFrame.qp;this.zE.nea(Q);za.zH=!0;return za}lia(){this.jAb("VersionHistoryOverlay").E6((Q,za)=>{try{null!=Q&&"dialog/modal"==Q.name?this.controller.setSaveACopyCanceled():"VersionHistoryOverlay"===za.name&&this.Qhg.then(hb=>{hb.enterFocusTrapZone();return null})}catch(hb){ya.ULS.sendTraceTag(592197019,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",hb)}});this.jAb("VersionHistoryHeader").E6((Q,za)=>{try{"VersionHistoryHeader"===
za.name&&this.Qhg.then(hb=>{hb.enterHeaderFocusTrapZone();return null})}catch(hb){ya.ULS.sendTraceTag(592197020,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",hb)}});this.jAb("VersionHistoryViewer").E6((Q,za)=>{try{"VersionHistoryViewer"===za.name&&ci.FocusManager.zJ(document.getElementById("vhViewer"))}catch(hb){ya.ULS.sendTraceTag(592197021,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",hb)}})}pQm(){const Q=pa.a.instance.Ma("Common.ISystemInitiatedFeedback");
Q?(Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"),Q.logActivity("VersionHistoryCheckExited","WordVersionHistoryFGIsEnabled")):ya.ULS.sendTraceTag(592197022,3005,10,"ISystemInitiatedFeedback was null")}lLi(){const Q=pa.a.instance.Ma("Common.ISystemInitiatedFeedback");Q?Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"):ya.ULS.sendTraceTag(592197023,3005,10,"ISystemInitiatedFeedback was null")}static qQm(){const Q=pa.a.instance.Ma("Common.ISystemInitiatedFeedback");
Q?Q.logActivity("VersionHistoryRestoreCoauthFailed","VersionHistoryRestoreSurveyEnabled"):ya.ULS.sendTraceTag(578359496,3005,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}tOn(Q){Q&&Q.addEventListener("keydown",za=>{za.ctrlKey&&"KeyC"===za.code&&(this.dCd(),this.Qe.logKpiUsage("WordVersionHistoryCopyText",0),!l.AFrameworkApplication.protectFile&&!l.AFrameworkApplication.qG||l.AFrameworkApplication.BBb||za.preventDefault());za.ctrlKey&&"KeyF"===za.code&&this.Qe.logKpiUsage("WordVersionHistorySearchText",
0)})}}lr.BAo="ErrorCode";lr.vetoName="VersionHistoryExperienceDegraded";Object(e.a)(lr,"VersionHistoryPaneActor",null,[1943]);class mu{constructor(){this.xne=this.aFj=this.$Ej=this.cFj=this.bFj=!1}}Object(e.a)(mu,"WordVersionHistorySettings",null,[]);class Ju{ghb(Q,za,hb){const Tb={name:"VersionHistoryExperienceDegraded",isIntentional:!1};0==za?Tb.errorNameOverride="VersionHistoryLaunchFailed":1==za?Q.includes("Failed to fetch")?Tb.errorNameOverride="SelectVersionFailedBecauseFetchFailed":Q.includes("Unexpected server response (500) while retrieving PDF")?
Tb.errorNameOverride="SelectVersionFailedServerResponseInternalError":Q.includes("Unexpected server response (502) while retrieving PDF")?Tb.errorNameOverride="SelectVersionFailedServerResponseBadGateway":Q.includes("Unexpected server response (415) while retrieving PDF")?(Tb.errorNameOverride="SelectVersionFailedServerResponseUnsupportedMediaType",Tb.isIntentional=!0):Q.includes("Unexpected server response (408) while retrieving PDF")?Tb.errorNameOverride="SelectVersionFailedServerResponseRequestTimeout":
Q.includes("Unexpected server response (400) while retrieving PDF")?Tb.errorNameOverride="SelectVersionFailedServerResponseBadRequest":Q.includes("Unexpected server response (413) while retrieving PDF")?(Tb.errorNameOverride="SelectVersionFailedServerResponseRequestEntityTooLarge",Tb.isIntentional=!0):Tb.errorNameOverride="SelectVersionFailed":5==za?(Tb.errorNameOverride="RestoreVersionFailed"+Q,Tb.isIntentional="MultipleClientsInCoauthSession"===Q):4==za?Tb.errorNameOverride="DownloadVersionFailed"+
Q:2==za?Tb.errorNameOverride=Ju.V5f+Q:3==za&&(hb?(Tb.errorNameOverride=Ju.V5f+hb,Tb.isIntentional="OverwriteTarget"===hb||"TargetFileLocked"===hb):(Q=this.PRl(Q),Tb.errorNameOverride=Q?"SaveVersionFailedServerResponse"+Q:Ju.V5f));return Tb}PRl(Q){switch(Q){case "400":return"BadRequest";case "401":return"Unauthorized";case "403":return"Forbidden";case "404":return"NotFound";case "408":return"Timeout";case "500":return"InternalError";default:return""}}}Ju.V5f="SaveVersionFailed";Object(e.a)(Ju,"WordVersionHistoryVetoHelper",
null,[1944]);var Gj=c(1035),Fv=c(1027);class fw{constructor(Q,za){this.ene=Q;this.Qe=za;this.SZe=null;this.oUc=!0}initialize(Q){this.SZe=Q}qDo(){this.oUc=!this.oUc;this.display(this.ddf)}display(Q){this.ddf=Q;this.BIf(Q);if(this.SZe){var za=this.ene.Vam(Q,this.oUc);if(2==za)this.ene.$on(Q.currentVersion.RevisionID);else{1==za&&this.Qe.logKpiFailure("WordVersionHistoryShowChanges","BaseNotAvailable",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});this.ene.Ygn(Q.currentVersion.RevisionID);
try{this.SZe.onVersionSelected(this.ddf.currentVersion,this.ddf.baseVersion,null,this.oUc)}catch(hb){ya.ULS.sendTraceTag(524957267,3005,10,"Exception thrown by onVersionSelected: {0}",hb)}}}else this.q1m()}BIf(Q){this.ene.Zxm(Q.currentVersion.RevisionID)||(this.Qe.logKpiUsage("WordVersionHistorySelectVersion",0,{isForAlertableKpi:!0}),this.oUc&&!Q.noBaseToCompareTo&&this.Qe.logKpiUsage("WordVersionHistoryShowChanges",0))}q1m(){this.Qe.logKpiFailure("WordVersionHistorySelectVersion","VersionDisplayActorUninitialized",
{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});ya.ULS.sendTraceTag(524957266,3005,10,"AppVersionController was not initialized!")}}Object(e.a)(fw,"VersionDisplayActor",null,[1942]);var Zq;(function(Q){Q[Q.notStarted=0]="notStarted";Q[Q.inProgress=1]="inProgress";Q[Q.complete=2]="complete"})(Zq||(Zq={}));Object(e.b)("WaitForBaseState",Zq);class $q{constructor(Q,za){this.revisionId=Q;this.Qe=za;this.state=Zq.notStarted}get d$k(){return this.revisionId}begin(){this.state==Zq.notStarted&&
(this.startTime=jo.$ma(),this.state=Zq.inProgress,this.Qe.logKpiUsage("WordVersionHistoryWaitForBase",1),ya.ULS.sendTraceTag(524957265,3005,50,"WaitForBaseOperation.begin"))}end(Q){if(this.state==Zq.inProgress){this.state=Zq.complete;this.endTime=jo.$ma();const za=jo.cYk(this.endTime-this.startTime);this.revisionId==Q?this.Qe.logKpiSuccess("WordVersionHistoryWaitForBase",{additionalValues:za}):this.Qe.logKpiFailure("WordVersionHistoryWaitForBase","WaitForBaseTimedOut",{additionalValues:za},{name:"VersionHistoryExperienceDegraded"})}}}
Object(e.a)($q,"WaitForBaseOperation",null,[]);class nu{constructor(Q){this.Qe=Q}Vam(Q,za){return Q.noBaseToCompareTo||!za?0:Q.baseVersion?Q.baseVersion.DownloadUrl&&0<Q.baseVersion.DownloadUrl.length?0:void 0===Q.baseVersion.DownloadUrl||null===Q.baseVersion.DownloadUrl?1:0==Q.baseVersion.DownloadUrl.length?2:1:1}Zxm(Q){return this.eQb?this.eQb.d$k==Q:!1}Ygn(Q){this.eQb&&this.Bpj(Q)}$on(Q){this.eQb&&this.Bpj(Q);this.eQb=new $q(Q,this.Qe);this.eQb.begin()}Bpj(Q){this.eQb.end(Q);this.eQb=null}}Object(e.a)(nu,
"WaitForBaseController",null,[1882]);class yt{constructor(){this.$So={crewAlias:"webasynccollabeng",featureName:"VersionHistory",topLevelKpiName:"VersionHistoryFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.VersionHistory"}init(){l.AFrameworkApplication.sZd()?(ya.ULS.sendTraceTag(39966528,3005,50,"WordVersionHistoryPackage:init - Initializing the React VersionHistory package"),bb.a.get_instance().Vk(7,()=>{const Q=this.container.resolve("Common.IDynamicScriptLoaderProvider").HA;(l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("wordVersionHistory"):Q.loadScript("wordVersionHistory")).catch(za=>ya.ULS.sendTraceTag(39966529,3005,10,"Failed to load the resources for the versionHistory feature: {0}",za)).then(()=>this.Son()).catch(za=>ya.ULS.sendTraceTag(39966530,3005,10,"Failed to initialize the versionHistory feature: {0}",za))})):ya.ULS.sendTraceTag(39966498,3005,50,"WordVersionHistoryPackage:init - Not initializing the React VersionHistory package because the feature is disabled")}Son(){ya.ULS.sendTraceTag(541942913,
3005,50,"Finished loading resources for the versionHistory feature");this.container.resolve("IVersionHistoryPaneActor").Ub();return null}dispose(){}yc(Q){this.container=Q;this.K=this.container.resolve("Common.IAppSettingsManager");if(this.K.$("AppSupportsVersionHistory")){var za=this.container.resolve("Common.IBrowserUtils"),hb=new mu;hb.bFj=this.K.$("WordWdDownloadTokenIsEnabled");hb.cFj=this.K.$("WordWdDownloadTokenRegisterIsEnabled");hb.$Ej=this.K.$("WordVersionHistoryEnableRestore");hb.aFj=this.K.$("WordVersionHistorySaveACopyOverFlowMenuIsEnabled");
hb.xne=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableVhsFileCache",!1);this.container.ha("IFeatureUsageAndHealthLogger",()=>new Gj.a(Oa.Health.instance,new Fv.a,this.$So)).singleInstance();this.container.ha("IWaitForBaseController",()=>new nu(this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("IVersionDisplayActor",()=>new fw(this.container.resolve("IWaitForBaseController"),this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();
this.container.ha("IVersionHistoryPaneActor",()=>new lr(l.AFrameworkApplication.xa,ci.FocusManager.instance(),Fc.a.instance,Wi.a.jQ,Pe.App.ya,Pe.App.A0,hb,za,new fs,l.AFrameworkApplication.K,new es,new Gn.a,new Ju,this.container.resolve("IFeatureUsageAndHealthLogger"),this.container.resolve("IVersionDisplayActor"))).singleInstance()}}static main(){let Q=!1;l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("IsOnDemandVersionHistoryEnabled")&&l.AFrameworkApplication.sZd()&&(Q=!0);K.a.instance.Gc(new yt,
0,Q)}}Object(e.a)(yt,"WordVersionHistoryPackage",null,[1,2]);var Jk=c(107);class Tt{constructor(Q,za,hb){this.ga=Q;this.Um=za;this.Na=hb}Ub(){this.Na.$("ZoomPopupDialogIsEnabled")&&(this.ga.pa(m.a.Qic,y.a.frame,Object(a.a)(this.Um,this.Um.Qic,"showZoomDialog")),this.ga.gb(m.a.SFn,y.a.frame,Object(a.a)(this.Um,this.Um.iQi,"onQueryZoomText"),96),this.ga.pa(m.a.Vad,y.a.frame,Object(a.a)(this.Um,this.Um.qFj,"zoomDialogTabFocusHandler")),this.ga.pa(m.a.Uad,y.a.frame,Object(a.a)(this.Um,this.Um.qFj,"zoomDialogTabFocusHandler")));
this.Na.$("ZoomSliderIsEnabled")&&(this.ga.gb(m.a.s_i,y.a.frame,Object(a.a)(this.Um,this.Um.Bln,"onQueryZoomPercentage"),96),this.ga.gb(m.a.tFj,y.a.frame,Object(a.a)(this.Um,this.Um.mpn,"onZoomToPercentage"),96),this.ga.pa(m.a.l0o,y.a.frame,Jk.ActionManager.Kf))}}Object(e.a)(Tt,"CommonZoomActor",null,[953]);class ys extends Tt{constructor(Q,za,hb){super(Q,za,hb);this.kea=za}Ub(){super.Ub();this.Na.$("ZoomPopupDialogIsEnabled")&&(this.ga.pa(Vh.a.Cmg,y.a.frame,Jk.ActionManager.Kf),this.ga.pa(Vh.a.Mne,
y.a.frame,Object(a.a)(this.kea,this.kea.k0o,"zoomTo100")));this.ga.pa(Vh.a.zoomToPageWidth,y.a.frame,Object(a.a)(this.kea,this.kea.zoomToPageWidth,"zoomToPageWidth"));this.ga.pa(m.a.Yhb,y.a.frame,Object(a.a)(this.kea,this.kea.Yhb,"increaseZoom"));this.ga.pa(m.a.Geb,y.a.frame,Object(a.a)(this.kea,this.kea.Geb,"decreaseZoom"));this.ga.pa(Vh.a.J6f,y.a.frame,Object(a.a)(this.kea,this.kea.Mho,"setZoomLevelFromRibbon"));this.ga.gb(Vh.a.hmb,y.a.frame,Object(a.a)(this.kea,this.kea.iQi,"onQueryZoomText"),
96);this.ga.gb(Vh.a.$$d,Rj.a.application,Object(a.a)(this.kea,this.kea.Aln,"onQueryZoomLevelLabelText"),96);this.ga.pa(uh.a.gKh,y.a.frame,Jk.ActionManager.Kf);this.ga.pa(uh.a.fKh,y.a.frame,Jk.ActionManager.Kf);this.ga.pa(uh.a.kKh,y.a.frame,Jk.ActionManager.Kf);this.ga.pa(uh.a.hKh,y.a.frame,Jk.ActionManager.Kf);this.ga.pa(Vh.a.Qia,y.a.frame,Jk.ActionManager.Kf)}}Object(e.a)(ys,"WordEditorZoomActor",Tt,[]);class ev{constructor(Q,za){this.zoom=Q;this.Kuk=za}}Object(e.a)(ev,"SetCustomZoomArgs",null,[]);
var ly=c(1152);class bo{constructor(Q,za){this.oal=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.pal=[bo.$bf,bo.oHd,"200","150","100","75","50"];this.Rla=3;this.aN=0;this.delta=.1;this.MGf=0;this.kd=new M.a;this.$h=null;this.K=Q;this.rc=za;this.Yhj(1)}get ij(){return this.aN}Yhj(Q){this.aN=Q}get FHc(){return Math.round(100*this.ij)}get fan(){return Math.floor(this.FHc/10)/10+this.delta}get ean(){return Math.ceil(this.FHc/10)/10-this.delta}get ga(){return l.AFrameworkApplication.xa}Ask(Q){this.kd.addHandler("ZoomChanged",
Q)}QVn(Q){this.kd.removeHandler("ZoomChanged",Q)}i4(Q){this.Ask(Q)}zmb(Q){this.QVn(Q)}Z2i(){}T4i(){}Y2i(){}S4i(){}Wad(Q){this.rFj(Q,this.ij)}rFj(Q,za){null!==Q&&Io.a.Ggj(Q,za)}a$f(Q,za=!0){let hb=Q*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(hb=new ev(Q,za));this.wej(hb)}Lho(Q,za=!1){this.Qia(Q,3|(za?0:4))}kpn(Q,za,hb){if(1===Q)return 32;Q=hb/100;Q<this.EXc?Q=this.EXc:Q>this.jXc&&(Q=this.jXc);this.Qia(Q,1);za&&(za.Ur=Math.floor(100*Q));return 32}iQi(Q,za,hb,Tb,zc){if(1===hb)return 32;
Q=db.a.ADa(this.FHc,6,l.AFrameworkApplication.numberFormat);zc.Value=Q;zc.LabelText=Q;return 32}mpn(Q,za,hb,Tb,zc){return 1===hb?32:this.kpn(hb,Tb,zc.value)}Bln(Q,za,hb,Tb,zc){zc.MinValue=100*this.EXc;zc.MaxValue=100*this.jXc;zc.value=this.FHc;return 32}Efi(){return this.oal}Ffi(){return this.pal}ALl(){let Q=Math.floor(100*this.ij).toString();1===this.Rla?Q=bo.$bf:2===this.Rla&&(Q=bo.oHd);return Q}Yhb(Q,za,hb){if(1===hb)return 32;this.JWc(this.rc?this.rc.iD:0,"IncreaseZoom");this.Rla=0;this.Qia(this.fan);
return 32}Geb(Q,za,hb){if(1===hb)return 32;this.JWc(this.rc?this.rc.iD:0,"DecreaseZoom");this.Rla=0;this.Qia(this.ean);return 32}Mho(Q,za,hb,Tb,zc){if(1===hb)return 32;this.JWc(this.rc?this.rc.iD:0,"SetZoomLevelFromRibbon");Q=zc.Value;if(Q.toLowerCase().startsWith("fit"))return Q=new Uc.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),ai.a.instance.Wb(Q),32;Q=parseInt(Q)/100;if(isNaN(Q))return 2;this.Rla=0;this.Qia(Q);return 32}JWc(Q,za){ya.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",
Q,za,l.AFrameworkApplication.ta.Ob.rq)}Qic(Q,za,hb){if(1===hb)return 32;ya.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const Q=this.ALl();this.$h=new ly.a(this.Efi(),this.Ffi(),Object(a.a)(this,this.mhm,"handleZoomDialogResult"),ci.FocusManager.instance(),!0);this.$h.Qic(CommonUIStrings.l_ZoomDialogTitle,Q)}WAm(Q){return Q.toLowerCase()===bo.$bf.toLowerCase()}XAm(Q){return Q.toLowerCase()===bo.oHd.toLowerCase()}mhm(Q){if(Q){if(this.WAm(Q)){this.Rla=
1;var za=32}else if(this.XAm(Q))this.Rla=2,za=this.zoomToPageWidth(0,null,2,null,null);else if(za=Number.parseInvariant(Q)){this.Rla=0;let hb=za;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(hb=new ev(za,!0));za=this.wej(hb)}else za=8;32===za?ya.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:Q}):ya.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}else ya.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}UHn(){this.kd.raiseEvent("ZoomChanged",
null)}W_i(){}K_f(){}qFj(Q){if(!this.$h)return 2;var za=this.$h.tg.Hs().Xj.R2;if(za===this.$h.rz&&Q===m.a.Vad||za===this.$h.GG&&Q===m.a.Uad)this.$h.Vxb||this.$h.Z5n(),this.$h.tg.Hs().Xj.wy(this.$h.Vxb);else if(za.id.startsWith(this.$h.I1c)||za.className.startsWith(this.$h.A_i))za=null,Q===m.a.Vad?za=this.$h.GG:Q===m.a.Uad&&(za=this.$h.rz),this.$h.tg.Hs().Xj.wy(za),Sys.UI.DomElement.removeCssClass(this.$h.Vxb.parentNode,this.$h.A_f);else if(Q===m.a.Vad)this.$h.tg.Hs().Icc();else if(Q===m.a.Uad)this.$h.tg.Hs().Gcc();
else return 2;return 32}}bo.$bf="FullPage";bo.oHd="PageWidth";Object(e.a)(bo,"ZoomManager",null,[31]);var zt;(function(Q){Q[Q.manual=0]="manual";Q[Q.fitToFullPage=1]="fitToFullPage";Q[Q.fitWidth=2]="fitWidth";Q[Q.onBoot=3]="onBoot"})(zt||(zt={}));Object(e.b)("ZoomStatus",zt);c(1057);var dn;(function(Q){Q[Q.normal=0]="normal";Q[Q.quiet=1]="quiet";Q[Q.disableScrollUpdate=2]="disableScrollUpdate";Q[Q.disableUiControlUpdate=4]="disableUiControlUpdate"})(dn||(dn={}));Object(e.b)("ZoomUpdateFlags",dn);
var Qq=c(257),Cm=c(355),fv=c(1201);class gv extends bo{constructor(Q,za,hb,Tb,zc,kd,ce){super(Q,za);this.NXo=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.OXo=[bo.oHd,"200","150","125","100","75","50"];this.xUe=this.E8i=!1;this.OIg="AutoFitForAdaptiveLayout";this.sXj="FitPageWidthFailure";this.Ngk="UpdateZoomFailure";this.jik="wwf";this.OVe=null;this.a2i=()=>{this.Rla===zt.fitWidth&&this.rif()};this.E9k=df=>{if(df.ctrlKey){l.AFrameworkApplication.xa.processAction(uh.a.hKh,
2);df=df.TWo;if(!df)return!1;this.Qia(this.ij-(0<df?.1:-.1));this.JWc(6,"CtrlScroll");return!0}return!1};this.lpn=()=>{ya.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.qW=hb;this.nk=Tb;this.Vb=zc;this.hg=kd;this.usc=ce;this.p_g=Q.$("KeepViewAfterZoomIsEnabled");this.kik=Q.$("ZoomShortCutIsEnabled");this.ahk=Q.$("DoNotAutoScrollAfterPinchIsEnabled");this.a1j=(this.ICe=Q.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&Q.$("AutoFitForSmallScreenModeIsEnabled");
this.yVj=Q.$("DoNotProcessUpdateZoomActionIsEnabled");this.lik=Q.$("ZoomSliderIsEnabled");this.gz()}get appName(){return"WordEditor"}get jXc(){return 4}get EXc(){return.1}get F9k(){return wacBoot.CtrlWheelMetrics}Prk(Q){this.kd.addHandler("PinchStart",Q)}GVn(Q){this.kd.removeHandler("PinchStart",Q)}Ork(Q){this.kd.addHandler("PinchEnd",Q)}FVn(Q){this.kd.removeHandler("PinchEnd",Q)}get tJ(){return null!=this.rDg?this.rDg:this.rDg=pa.a.instance.Ma("WordEditor.IStatusBarUser")}vBj(Q){Q=!(Q&dn.disableUiControlUpdate);
const za=bb.a.get_instance().isCompleted(7);return Q&&za?(Q={SelectZoomOption:"ComboBoxModel"},Pe.App.ya&&Pe.App.ya.CG(Q),this.oSo(),!0):!1}Qia(Q,za=dn.normal){let hb=!0;this.yVj||l.AFrameworkApplication.xa.processAction(Vh.a.Qia,2);if(this.ij===Q)return this.xUe||(this.xUe=this.vBj(za)),hb;Q>this.jXc?Q=this.jXc:Q<this.EXc&&(Q=this.EXc);var Tb=!!(za&dn.quiet);1===Q||Tb||l.AFrameworkApplication.xa.processAction(Vh.a.Cmg,2);try{Tb=null;Pe.App.ya&&Object(Xb.a)(fv.PageView,Pe.App.ya.jb.xc)&&(Tb=Pe.App.ya.jb.xc);
let zc=-1,kd=-1,ce=-1;const df=!(za&dn.disableScrollUpdate);this.p_g&&df&&(zc=Uh.SelectionEditor.yam(Ge.a.instance.hb.lb,Tb),kd=Tb.VK.scrollLeft,ce=Tb.VK.scrollTop);const bf=this.ij;this.Yhj(Q);this.UHn();this.xUe=this.vBj(za);df&&this.RQo(Tb,zc,kd,ce,bf)}catch(zc){hb=!1,ya.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",zc)}return hb}RQo(Q,za,hb,Tb,zc){Q&&Q.isActive?this.p_g?0<=za&&100>=za?Q.Cs.p4(100-za,!0,!0):Q.Cs.nOm(hb,Tb,zc,this.ij):Q.Cs.p4():ya.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}k0o(Q,
za,hb){2===hb&&(this.JWc(this.rc?this.rc.iD:0,"ZoomTo100"),this.Rla=zt.manual,this.Qia(1));return 32}wej(Q){this.Rla=zt.manual;let za,hb=!0;if(this.ahk){if(!Object(Xb.a)(ev,Q))return ya.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;za=Q.zoom/100;hb=Q.Kuk}else za=Number.parseInvariant(String.format("{0}",Q))/100;ya.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",za);Q=dn.normal;hb||(Q=dn.disableScrollUpdate);this.Qia(za,Q);return 32}zoomToPageWidth(Q,
za,hb){if(1===hb)return 32;ya.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(vf.a)("ZoomToPageWidth",!0);this.Rla=zt.fitWidth;this.wol();return this.rif()}Aln(Q,za,hb,Tb,zc){if(1===hb)return 32;Q=db.a.ADa(this.FHc,6,l.AFrameworkApplication.numberFormat);zc[Qq.a.labelText]=Q;return 32}Efi(){return this.NXo}Ffi(){return this.OXo}wol(){this.E8i||(Pe.App.ya?(Pe.App.ya.uZ(this.a2i),this.E8i=!0):ya.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}rif(){var Q=
Pe.App.ya?Pe.App.ya.jb.xc:null;if(Q&&Pe.App.ya.QC){var za=null;(Q=this.wLl(Q))&&(za=this.qW.gJ(Q));za||(za=this.qW.Nnf());if(null!==za)return za=$n.a.instance.Ot(za),za=jr.a.Ki(za,0),Q=this.usc(),za+=Q&&Q.Xfe()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0,za+=2*Cm.a.$lg,this.Qia(Pe.App.ya.QC.offsetWidth/za),32;ya.ULS.sendTraceTag(7185433,353,10,"Zoom to page width: cannot find word section node.")}else ya.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");
return 8}wLl(Q){return Q&&Q.nb&&Q.nb.hb.lb&&Q.nb.hb.lb.Qa&&Q.nb.hb.lb.Qa.node?Q.nb.hb.lb.Qa.node:null}oSo(){this.tJ&&(this.lik?(this.tJ.yU(Or.a.f0o),this.tJ.yU(Or.a.h0o)):this.tJ.yU(Or.a.i0o))}Pvo(Q){Q||(Q=window.self.CtrlWheelMetrics);if(Q){var za=Q.ctrlWheelOccurred;if("boolean"!==typeof za)ya.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");else{ya.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",za);try{Q.stop()}catch(hb){ya.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",
hb)}}}else ya.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}gz(){this.Pvo(this.F9k);if(this.nk){var Q=document.getElementById(Tp.AppFrame.THd);Q&&this.nk.mb(W.a.tkb,Q,this.E9k)}this.Vb&&(Q=this.Vb.fe(Tp.AppFrame.xE),this.kik&&(Q.bindAction(Db.KeyInputManager.mc(Zd.a.Hlc,Db.KeyInputManager.Ph),m.a.Yhb),Q.bindAction(Db.KeyInputManager.mc(Zd.a.ead,Db.KeyInputManager.Ph),m.a.Yhb),Q.bindAction(Db.KeyInputManager.mc(Zd.a.Ilc,Db.KeyInputManager.Ph),m.a.Geb),Q.bindAction(Db.KeyInputManager.mc(Zd.a.Klc,
Db.KeyInputManager.Ph),m.a.Geb),Q.bindAction(Db.KeyInputManager.mc(Zd.a.Sbd,Db.KeyInputManager.Ph),Vh.a.Mne)));this.hg&&(this.OVe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.hg.mb(W.a.click,this.OVe,this.lpn);this.a1j&&(Pe.App.ya.oI.registerLayoutBreakpointChanged("canvas",za=>{this.B0e(za)}),Pe.App.ya.oI.registerBoundingWindowRectsChanged("canvas",()=>{this.B0e(Pe.App.ya.oI.getLayoutBreakpoint())}))}B0e(Q){let za=!0,hb="";if(this.Rla!==zt.onBoot)return za;Oa.Health.instance.recordKpiUsage(this.OIg,
0,this.jik,null);switch(Q){case "Small":8===this.rif()&&(hb=this.sXj,za=!1);break;default:1===this.ij||this.Qia(1)||(hb=this.Ngk,za=!1)}za||Oa.Health.instance.recordKpiFailure(this.OIg,hb,!0,!0,null);return za}Z2i(Q){this.Prk(Q)}T4i(Q){this.GVn(Q)}Y2i(Q){this.Ork(Q)}S4i(Q){this.FVn(Q)}W_i(){this.kd.raiseEvent("PinchStart",null)}K_f(){this.kd.raiseEvent("PinchEnd",null)}}Object(e.a)(gv,"WordEditorZoomManager",bo,[1853,31]);class up{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const Q=
this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),za=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");Q.Ub();Sys.UI.DomElement.overrideGetBounds=!0;l.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&l.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&za&&bb.a.get_instance().Vk(4,()=>{za.B0e(Pe.App.ya.oI.getLayoutBreakpoint())||ya.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}yc(Q){this.W=Q;l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&
(this.W.ha("WordEditor.Zoom.WordEditorZoomManager",()=>new gv(l.AFrameworkApplication.K,l.AFrameworkApplication.xa,so.WordSectionNavigator.instance,xq.a.instance,ci.FocusManager.instance(),vb.a.instance,()=>Q.Ma("Box4.IFloatingObjectUpdater"))).singleInstance().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),this.W.ha("WordEditor.Zoom.WordEditorZoomActor",()=>new ys(l.AFrameworkApplication.xa,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),l.AFrameworkApplication.K)).singleInstance())}static main(){K.a.instance.Gc(new up)}}
Object(e.a)(up,"ZoomPackage",null,[1,2]);var In=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",
ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",
Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},
children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",
attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",
attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",
LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",
QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",
MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",
attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},
children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]};Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");
Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Type.registerNamespace("Common.App.VersionHistory");
Type.registerNamespace("WordEditor.VersionHistory");K.a.instance.Gc(new yt);rl.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");N;Type.registerNamespace("CACPU");Ma.main();Type.registerNamespace("CAEventTimingMeter");jb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");pb.main();Type.registerNamespace("Common.App.GestureInput");Va.main();Type.registerNamespace("Common.App.GestureManager");Fb.main();Type.registerNamespace("Common.ModernFontPicker");
null==l.AFrameworkApplication.K||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",!1)||(Type.registerNamespace("Common.App.OfflineLogger"),K.a.instance.Gc(new tf));Type.registerNamespace("Common.App.O365Shell");Gb.main();Type.registerNamespace("Common.App.PhoneLink");Kf.main();Type.registerNamespace("Common.App.SensitiveLogging");zj.main();Type.registerNamespace("Common.App.Rename");K.a.instance.Gc(new Zk,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");
K.a.instance.Gc(new de);Type.registerNamespace("Common.App.SaveAsToHost");dg.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Fe.main();Type.registerNamespace("Common.App.SaveACopy");kn.main();Type.registerNamespace("Common.App.SaveToSharePoint");ri.main();Type.registerNamespace("Common.App.SharedFilePicker");Pf.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");
Type.registerNamespace("CATypingSpeedMeter");Dh.main();cp;K.a.instance.Gc(new Yi);$e.main();In;Ue.main();K.a.instance.Gc(new Rf);Xq.main();Co.a.prototype.toString=Zm.a.prototype.toString;Jq.a.Agi=new dp.a;K.a.instance.Gc(new Ni);up.main();K.a.instance.Gc(new qk);K.a.instance.Gc(new Tf);K.a.instance.Gc(new Ed);Qd.main();tl.main();Bk.main();$i.main();Type.registerNamespace("NLRT");K.a.instance.Gc(new Kn);Type.registerNamespace("Common.App.AccessibilitySettings");P.main();K.a.instance.Gc(new Fh);go.main();
pn.main();bl.main();window.EventTiming={EventTimingMeter:Fi,FrameTimingMeter:Ri}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/19334779/wdjs/WordEditorDSVersionHistoryNotRemoved.box4.dll2.js.map